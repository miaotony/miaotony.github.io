<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="CTF | DASCTF May &amp; BJDCTF3rd 部分WriteUp, MiaoTony,blog">
    <meta name="description" content="又是划划水~前两天水了一下DASCTF五月赛 &amp; BJDCTF3rd，这次不是新生赛了，难度大的亚批，打得都自闭了。">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-159946730-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'UA-159946730-1');
</script>


    <title>CTF | DASCTF May &amp; BJDCTF3rd 部分WriteUp | MiaoTony&#39;s小窝</title>
    <link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/favicon.ico">

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/css/matery.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/css/my.css">
	
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/jquery/jquery.min.js"></script>
    <script>
        //来个特效玩玩喵 20200123
        var titleTime;
        var OriginTitile = document.title;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = '|ω·) 喵~快回来呀！';
                clearTimeout(titleTime);
            } else {
                document.title = '(/≧▽≦)/ Meow！';
                titleTime = setTimeout(function() {
        	    document.title = OriginTitile;
        }, 800);
    }
        });
    </script>
<meta name="generator" content="Hexo 5.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="MiaoTony's小窝" type="application/atom+xml">
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">MiaoTony&#39;s小窝</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友链</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">MiaoTony&#39;s小窝</div>
        <div class="logo-desc">
            
            喵~欢迎各位大佬的来访呀！
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友链
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/miaotony" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/miaotony" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/medias/featureimages/23.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">CTF | DASCTF May &amp; BJDCTF3rd 部分WriteUp</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        min-width: 240px;
        padding-left: 15px;
        padding-bottom: 30px;
    }

    .toc-widget .toc-title {
        padding: 30px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
	    max-height: 450px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/CTF/">
                                <span class="chip bg-color">CTF</span>
                            </a>
                        
                            <a href="/tags/WriteUp/">
                                <span class="chip bg-color">WriteUp</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/CTF/" class="post-category">
                                CTF
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-05-24
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    5.8k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    25 分
                </div>
                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p><img src="/2020/05/24/CTF_BJDCTF3rd/poster.jpg" alt="poster"></p>
<p>哇呜，转眼间一个月又过去了。这个月事情挺多的，当然也比较懒，一直咕着没来更新博客。</p>
<p>前两天水了一下 DASCTF 五月赛 &amp; BJDCTF3rd，这次不是新生赛了，还是和企业合办的，于是难度大的亚批，打得都自闭了。（没理由吹新生赛了嘤嘤嘤。</p>
<p>有一种好久没打 CTF 的感觉，这次上手挺生疏的（？</p>
<p>题目看上去挺多的，确实也是，然而就不怎么会做嘛。（摊手</p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/8VHqaqGQuOoT84iw.png" alt="题目"></p>
<p>官方问题汇总文档<a target="_blank" rel="noopener" href="https://shimo.im/docs/KJypgTpQgRdxQ6tY/read">见这里</a>。（包括 hint 等）</p>
<p>这次主要来看看 Misc 题吧，其他的随意看看好了。<small><del>（反正也不会做</del></small></p>
<p>比赛结束后题目环境已经关了，随便写写8.</p>
<br>

<hr>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="blink"><a href="#blink" class="headerlink" title="blink"></a>blink</h3><blockquote>
<p>一闪一闪亮晶晶~(请将flag经过md5后提交) </p>
<p>hint1: 完整的图案可以扫一扫 </p>
<p>hint2: <a target="_blank" rel="noopener" href="http://taqini.space/2020/04/30/shell-output-control-code">http://taqini.space/2020/04/30/shell-output-control-code</a></p>
<p>hint3: 此题有多种解法，不一定要硬把flag逆出来</p>
</blockquote>
<p>这题本来是想逆向解的，就是他用了不少输出控制码，看了一下挺复杂的。</p>
<p>可以扫一扫，明确就是二维码之类的了。</p>
<p>一闪一闪的，突然想到截图然后叠加就好了呀！</p>
<p>断开连接后再一看，他的实现是一屏一屏刷的，每一次记录都保留在终端里，<strong>直接终端里复制结果，再写个 jio 本就好了呀！</strong></p>
<p><strong>Exp：</strong></p>
<p>python大法好呀！</p>
<p>我这里分别复制了10次闪烁的结果到文件里，考虑10次应该够了。</p>
<p>图形是25*25的，用一个矩阵来存是0还是1.</p>
<p>之后再转换到 [0, 255] uint8 类型，用 PIL 作图好了。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

table <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">)</span>
<span class="token comment"># print(table)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'{}.txt'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fin<span class="token punctuation">:</span>
        row <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">while</span> row <span class="token operator">&lt;</span> <span class="token number">25</span><span class="token punctuation">:</span>
            line <span class="token operator">=</span> fin<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> line<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'x'</span><span class="token punctuation">:</span>
                    table<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
            row <span class="token operator">+=</span> <span class="token number">1</span>


a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">255</span> <span class="token keyword">for</span> b <span class="token keyword">in</span> row<span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> table<span class="token punctuation">]</span>
qrcode <span class="token operator">=</span> Image<span class="token punctuation">.</span>fromarray<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
qrcode<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
qrcode<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'qrcode.png'</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里图片反色了还有点小啊哈哈哈。问题不大，放大来扫就是了。</p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/qrcode.png" alt="qrcode"></p>
<p>扫码得到</p>
<p><code>BJD{TW1NKLE_TW1NKLE_L1TTLE_5TAR}</code></p>
<p>真是一闪一闪亮晶晶~</p>
<p>MD5 后得到</p>
<p><code>e1eded5a7f630a2d02d3fe17b786919a</code></p>
<p>哇好耶，这题好难得啊，是 17 个做出来的之一唉。</p>
<br>

<hr>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Questionnaire"><a href="#Questionnaire" class="headerlink" title="Questionnaire"></a>Questionnaire</h3><blockquote>
<p> 叮~ 您有一份调查问卷~ 请查收~  <a target="_blank" rel="noopener" href="https://forms.gle/Vmzt99LazrtXsRLM9">https://forms.gle/Vmzt99LazrtXsRLM9</a></p>
</blockquote>
<blockquote>
<p>flag格式：32位字符串</p>
<p>关于问卷问题答案：请使用英文或拼音作答。</p>
<p>问卷第七题hint</p>
<p>离中国科学院大学最近的长城</p>
<p>答案为长城名字的拼音，例如:</p>
<p>Badaling</p>
<p>答对每题都会提示flag的一部分</p>
<p>Flag一共7部分</p>
<p>除了大学和公园外</p>
<p>其余题目都是拼音</p>
</blockquote>
<p>这是什么签到题？？？</p>
<p>最开始以为是填了之后放flag的，发现并不是。</p>
<p>填了几个发现错误提示，和 TaQini 师傅 py 了一下，果然是一个题给一部分 flag，最后连起来。（不过到最后也放 hint 了哈哈哈</p>
<p>借助百度识图、搜狗识图、谷歌识图，好不容易才整明白是啥。。（感觉找个老北京人要快得多呢2333</p>
<p>图片分别对应着：</p>
<blockquote>
<p>BIT 北理工 d41d</p>
<p>好邻居 8cd9</p>
<p>稻香村 8f00b2</p>
<p>jingweizhai 04e9</p>
<p>Jingshan Park 景山公园 8009</p>
<p>chaoyang 朝阳 98ecf8</p>
<p>hefangkou 河防口 427e </p>
</blockquote>
<p><em>（最后这个长城查了半天，搜索引擎告诉我怀柔区的长城是慕田峪（确实）。。后来和 TaQini 师傅聊到说这是个鲜为人知的长城……</em></p>
<p>连起来得到 flag：</p>
<p><code>d41d8cd98f00b204e9800998ecf8427e</code></p>
<p>P.S.: 后面查不出来在网页里一搜，发现还是谷歌的套路，是用 JavaScript 传入的数据。里面就有匹配的逻辑了。</p>
<p>（还是 F12 大法好呀！</p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522231643959.png" alt="js"></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token constant">FB_PUBLIC_LOAD_DATA_</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Let's see how well you know our Capital."</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1790362738</span><span class="token punctuation">,</span><span class="token string">"What is the name of this university?"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">336510603</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">302</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Beijing Institute of Technology|BIT"</span><span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token string">"d41d"</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"1vV5T8FOS13NOQDji-xYIynLwsUMXcV8aatxUWP6ljvfz-w"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">740</span><span class="token punctuation">,</span><span class="token number">416</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">603160739</span><span class="token punctuation">,</span><span class="token string">"What is the name of the store?"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">539054317</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">302</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Haolinju|haolinju"</span><span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token string">"8cd9"</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"1x4dT2M6J3EbaiVZ37ssMVunsnsB2UMCM6g4LCHyhlHJu-Q"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">740</span><span class="token punctuation">,</span><span class="token number">416</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">488094967</span><span class="token punctuation">,</span><span class="token string">" What BRAND is this food?"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1465781074</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">302</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Daoxiangcun|daoxiangcun"</span><span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token string">"8f00b2"</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"1lH3bwgs28QoVKcUYhtzoqAcacmh4n4CHyWjGQen4RiE3Jw"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">375</span><span class="token punctuation">,</span><span class="token number">458</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1097246628</span><span class="token punctuation">,</span><span class="token string">"Which RESTAURANT are the ducks coming from? "</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">353762320</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">302</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Jingweizhai|jingweizhai"</span><span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token string">"04e9"</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"11ym4QgB0WEymoJXlmFy7FTC5Eyd5rV1adBbw6vWN5PmXvw"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">740</span><span class="token punctuation">,</span><span class="token number">555</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1916058196</span><span class="token punctuation">,</span><span class="token string">"Which PARK is this?"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">901636349</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">302</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Jingshan|jingshan"</span><span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token string">"8009"</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"16pfH3k5-5kDo-Rb9BxeKRvx0S-Qy4IgUdlX8iJ0AUOBIwQ"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">740</span><span class="token punctuation">,</span><span class="token number">554</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1044111735</span><span class="token punctuation">,</span><span class="token string">"Which DISTRICT is the No.3 of Beijing?"</span><span class="token punctuation">,</span><span class="token string">"The restaurant in question4 is in this Distric"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1620980704</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">302</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Chaoyang|chaoyang"</span><span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token string">"98ecf8"</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"1VbfGqSSHlM9D_HY1TsENa6rle3axBYbtKdyHS_klYDLG5g"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">740</span><span class="token punctuation">,</span><span class="token number">371</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1877231084</span><span class="token punctuation">,</span><span class="token string">"Which part of the Great Wall is this?"</span><span class="token punctuation">,</span><span class="token string">"In Huairou Distric"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1337434564</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">302</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Hefangkou|hefangkou"</span><span class="token punctuation">]</span>
<span class="token punctuation">,</span><span class="token string">"427e"</span><span class="token punctuation">]</span> <span class="token comment">//...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<br>

<hr>
<h3 id="bin-cat-2"><a href="#bin-cat-2" class="headerlink" title="/bin/cat 2"></a>/bin/cat 2</h3><blockquote>
<p>[CAUTION] cats as numerous as stars are coming… 解出的答案经md5后提交~</p>
</blockquote>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/2005205ec4f1a07a3e9.gif" alt="2005205ec4f1a07a3e9"></p>
<p>有两种喵喵，还是动图唉，远着看就是二维码嘛！<em>（果然是 TaQini 师傅出的题</em></p>
<p>首先把宽度压缩到原来一半，本来想 python 写个jio本的，PIL 感觉有点麻烦还不大会。</p>
<p>于是一波骚操作重新上个色好了。（你肯定想不到我是在 word 中处理的吧，嘿嘿嘿</p>
<p>PS 也行，Stegsolve 里 gif 截取一帧然后丢去取某通道某 bit 信息/随机上色/etc. 都行。</p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522212913109.png" alt="重新上色"></p>
<p>扫码得到</p>
<p><code>m1ao~miao~mi@o~Mia0~m!aO~m1a0~~~</code></p>
<p>喵喵喵喵喵喵~</p>
<p>md5加密得到32位flag。</p>
<p><code>9b84eb9e7107ffafebeb1000e8c05322</code></p>
<p><em>（看到还真有手搓二维码的 tql</em></p>
<br>

<hr>
<h3 id="test-your-nc"><a href="#test-your-nc" class="headerlink" title="test your nc"></a>test your nc</h3><blockquote>
<p> 183.129.189.60:10118,10119,10120,10121,10122,10123</p>
</blockquote>
<blockquote>
<p>hint1: /f1a9.bak 你看到了嘛? </p>
<p>hint2: 用df命令看看硬盘总共多大，再看看flag多大。</p>
<p>hint3: 系统命令不够使？试试万能的python</p>
</blockquote>
<p>先来看看 <code>/f1a9.bak</code>。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">cat</span> /f1a9.bak
<span class="token comment">#!/usr/bin/python</span>
<span class="token comment">#coding=utf-8</span>

from random <span class="token function">import</span> randint
from uuid <span class="token function">import</span> uuid4

flag <span class="token operator">=</span> <span class="token punctuation">[</span>hex<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span>:-1<span class="token punctuation">]</span> <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span>.fields<span class="token punctuation">]</span>

<span class="token assign-left variable">f</span><span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">'/home/ctf/flag'</span>,<span class="token string">'w'</span><span class="token punctuation">)</span>
f.write<span class="token punctuation">(</span><span class="token string">'🐀'</span><span class="token punctuation">)</span>
f.seek<span class="token punctuation">(</span><span class="token number">1024</span>*1024*1024<span class="token punctuation">)</span>
f.write<span class="token punctuation">(</span><span class="token string">'flag{'</span><span class="token punctuation">)</span>
offset <span class="token operator">=</span> <span class="token number">1024</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> flag:
    f.seek<span class="token punctuation">(</span><span class="token number">1024</span>*1024*1024*randint<span class="token punctuation">(</span>offset,offset+2048<span class="token punctuation">))</span>
    offset <span class="token operator">+=</span> <span class="token number">2048</span>
    f.write<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
f.write<span class="token punctuation">(</span><span class="token string">'}'</span><span class="token punctuation">)</span>
f.seek<span class="token punctuation">(</span><span class="token number">1024</span>*1024*1024*randint<span class="token punctuation">(</span>offset,offset+2048<span class="token punctuation">))</span>
f.write<span class="token punctuation">(</span><span class="token string">'good job!'</span><span class="token punctuation">)</span>
f.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里的<code>uuid</code>正好就查了一下。</p>
<blockquote>
<p>UUID: 通用唯一标识符 ( Universally Unique Identifier ),  对于所有的UUID它可以保证在空间和时间上的唯一性. 它是通过MAC地址, 时间戳, 命名空间, 随机数,  伪随机数来保证生成ID的唯一性, 有着固定的大小( 128 bit ).  它的唯一性和一致性特点使得可以无需注册过程就能够产生一个新的UUID. UUID可以被用作多种用途, 既可以用来短时间内标记一个对象,  也可以可靠的辨别网络中的持久性对象.</p>
</blockquote>
<blockquote>
<p>python 的 uuid 模块提供UUID类和函数uuid1(), uuid3(), uuid4(), uuid5() 来生成1, 3,  4, 5各个版本的UUID ( 需要注意的是: python中没有uuid2()这个函数). 对uuid模块中最常用的几个函数总结如下: </p>
<ol>
<li><p>uuid.uuid1([node[, clock_seq]]) : 基于时间戳</p>
<p>使用主机ID, 序列号, 和当前时间来生成UUID, 可保证全球范围的唯一性. 但由于使用该方法生成的UUID中包含有主机的网络地址, 因此可能危及隐私. 该函数有两个参数, 如果 node 参数未指定, 系统将会自动调用 getnode() 函数来获取主机的硬件地址.  如果 clock_seq  参数未指定系统会使用一个随机产生的14位序列号来代替. </p>
</li>
<li><p>uuid.uuid3(namespace, name) : 基于名字的MD5散列值</p>
<p>通过计算命名空间和名字的MD5散列值来生成UUID, 可以保证同一命名空间中不同名字的唯一性和不同命名空间的唯一性, 但同一命名空间的同一名字生成的UUID相同.</p>
</li>
<li><p>uuid.uuid4() : 基于随机数</p>
<p>通过随机数来生成UUID. 使用的是伪随机数有一定的重复概率. </p>
</li>
<li><p>uuid.uuid5(namespace, name) : 基于名字的SHA-1散列值</p>
<p>通过计算命名空间和名字的SHA-1散列值来生成UUID, 算法与 uuid.uuid3() 相同.</p>
</li>
</ol>
<p>（来自网络）</p>
</blockquote>
<p>看来是在 <code>1024*1024*1024*randint(offset,offset+2048)</code> 的随机位置写入了flag。</p>
<p>再来看看硬盘大小和文件大小。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">df</span>
Filesystem     1K-blocks    Used Available Use% Mounted on
overlay         <span class="token number">16197544</span> <span class="token number">2011556</span>  <span class="token number">14169604</span>  <span class="token number">13</span>% /
tmpfs              <span class="token number">65536</span>       <span class="token number">0</span>     <span class="token number">65536</span>   <span class="token number">0</span>% /dev
tmpfs             <span class="token number">507956</span>       <span class="token number">0</span>    <span class="token number">507956</span>   <span class="token number">0</span>% /sys/fs/cgroup
/dev/vda1       <span class="token number">16197544</span> <span class="token number">2011556</span>  <span class="token number">14169604</span>  <span class="token number">13</span>% /etc/hosts
shm                <span class="token number">65536</span>       <span class="token number">0</span>     <span class="token number">65536</span>   <span class="token number">0</span>% /dev/shm
tmpfs             <span class="token number">507956</span>       <span class="token number">0</span>    <span class="token number">507956</span>   <span class="token number">0</span>% /proc/acpi
tmpfs             <span class="token number">507956</span>       <span class="token number">0</span>    <span class="token number">507956</span>   <span class="token number">0</span>% /proc/scsi
tmpfs             <span class="token number">507956</span>       <span class="token number">0</span>    <span class="token number">507956</span>   <span class="token number">0</span>% /sys/firmware
$ <span class="token function">ls</span> -al
total <span class="token number">64</span>
drwxr-x--- <span class="token number">1</span> root ctf            <span class="token number">4096</span> May <span class="token number">22</span> 06:40 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root root           <span class="token number">4096</span> May <span class="token number">19</span> 03:09 <span class="token punctuation">..</span>
-rwxr-x--- <span class="token number">1</span> root ctf             <span class="token number">220</span> May  <span class="token number">5</span>  <span class="token number">2019</span> .bash_logout
-rwxr-x--- <span class="token number">1</span> root ctf            <span class="token number">3771</span> May  <span class="token number">5</span>  <span class="token number">2019</span> .bashrc
-rwxr-x--- <span class="token number">1</span> root ctf             <span class="token number">807</span> May  <span class="token number">5</span>  <span class="token number">2019</span> .profile
-rw-r----- <span class="token number">1</span> root ctf  <span class="token number">16150150774793</span> May <span class="token number">22</span> 06:40 flag
-rw-r----- <span class="token number">1</span> root ctf              <span class="token number">23</span> May <span class="token number">19</span> <span class="token number">11</span>:05 readme<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>硬盘这么小，怎么<code>flag</code>文件这么大（16TB+ ？？？），佛了。</p>
<p>这个 nc 有15s的时间限制，还有执行内存限制之类的。</p>
<p>试了一下没有<code>strings</code>，<code>grep</code> 出不来 flag。（被kill了？</p>
<p>考虑到 hint 中提示可以用py来整。环境中只有py2.</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">python <span class="token operator">-</span>c <span class="token string">"open('./flag','r').read()"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>这样会炸内存。</p>
<p>考虑分块读取，然而好像又有限制。佛了。</p>
<hr>
<p><strong>20200605 更新：</strong></p>
<p>看了看出题的 TaQini 师傅的<a target="_blank" rel="noopener" href="http://taqini.space/2020/05/28/bjd3rd-testyournc/#Test-your-nc">出题笔记</a>，这里顺便参考一下。</p>
<p>之所以生成的 flag 如此之大，是因为生成的脚本中的 <code>seek</code> 函数在将文件偏移的指针往后移动一段之后，在写入的有效数据（flag）之间留下了一个个由 <code>\x00</code> 组成的空洞（hole），这些 hole 是不占用（不分配）磁盘空间的。因此题目中用<code>df</code>看硬盘空间还是很小的。</p>
<p>而用<code>lseek</code>函数能跳过 hole 去读取数据。</p>
<p>可以用 <code>man lseek</code> 来看看函数手册。</p>
<blockquote>
<p><strong>off_t lseek</strong> (int fd, off_t offset, int whence);</p>
<p>The lseek() function repositions the offset of the open file associated with the file descriptor <u>fd</u> to the argument <u>offset</u> according to the directive <u>whence</u>.</p>
<p>fd：文件描述符； </p>
<p>offset: 移动文件位置的偏移数，以字节为单位；</p>
<p>whence 为系统定义的常量，可能的值有<strong>SEEK_SET</strong>、<strong>SEEK_CUR</strong>、<strong>SEEK_END</strong>、<strong>SEEK_DATA</strong>、<strong>SEEK_HOLE</strong>。</p>
<p><strong>SEEK_SET</strong><br>       The offset is set to offset bytes.    文件读写位置从<strong>文件开始</strong>往后移动offset个字节。</p>
<p><strong>SEEK_CUR</strong><br>       The offset is set to its current location plus offset bytes.  文件读写位置从<strong>当前位置</strong>开始移动offset个字节。offset可以为负值。</p>
<p><strong>SEEK_END</strong><br>       The offset is set to the size of the file plus offset bytes.  文件读写位置从<strong>文件结尾</strong>移动offset个字节。offset可以为负值。</p>
</blockquote>
<p>这里要用到的是 <code>whence</code> 参数为 <code>SEEK_DATA</code>，man 中还对空洞（hole）的原理作了解释。</p>
<blockquote>
<p>Seeking file data and holes</p>
<p>​       Since version 3.1, Linux supports the following additional values for whence:</p>
<p><strong>SEEK_DATA</strong><br>          Adjust the file offset to the next location in the file greater than or equal to offset containing data.  If offset points  to  data,  then the file offset is set to offset.</p>
<p><strong>SEEK_HOLE</strong><br>          Adjust  the file offset to the next hole in the file greater than or equal to offset.  If offset points into the middle of a hole, then the file offset is set to offset.  If there is no hole past offset, then the file offset is adjusted to the end of the file (i.e., there is  an implicit hole at the end of any file).</p>
<p>   In both of the above cases, lseek() fails if offset points past the end of the file.</p>
<p>   These  operations  allow  applications  to map holes in a sparsely allocated file.  This can be useful for applications such as file backup tools, which can save space when creating backups and preserve holes, if they have a mechanism for discovering holes.</p>
<p>   For the purposes of these operations, a hole is a sequence of zeros that (normally) has not been allocated in the underlying file storage. However, a filesystem is not obliged to report holes, so these operations are not a guaranteed mechanism for mapping the storage space actually allocated to a file.  (Furthermore, a sequence of zeros that actually has been written to the underlying storage may not be reported as a  hole.) In the simplest implementation, a filesystem can support the operations by making SEEK_HOLE always return the offset of the end of the file, and making SEEK_DATA always return offset (i.e., even if the location referred to by offset is a hole, it can be considered to consist of data that is a sequence of zeros).</p>
</blockquote>
<p>大概也就是说，这些空洞是零序列，它们通常在底层文件存储中没有分配空间。</p>
<p><code>SEEK_DATA</code> 是跳过 hole 寻找下一个数据，<code>SEEK_HOLE</code>是跳过数据寻找下一个 hole。</p>
<p>在 python 中的 os 模块也有<code>lseek</code>这个函数，于是可以用来写exp了。</p>
<p>考虑到没有环境了，这里利用<code>/f1a9.bak</code>中的内容在本地生成了一个 flag，而后参照 TaQini 师傅的脚本来读取 flag。</p>
<p>首先看一下 flag 有多大。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># ls -al</span>
total <span class="token number">56</span>
drwxr-xr-x <span class="token number">2</span> root root           <span class="token number">4096</span> <span class="token number">6</span>月   <span class="token number">5</span> <span class="token number">22</span>:06 ./
drwxr-xr-x <span class="token number">8</span> root root           <span class="token number">4096</span> <span class="token number">6</span>月   <span class="token number">5</span> <span class="token number">21</span>:48 <span class="token punctuation">..</span>/
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">15007689474057</span> <span class="token number">6</span>月   <span class="token number">5</span> <span class="token number">21</span>:48 flag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>在命令行可以用 <code>python -c &lt;command&gt;</code> 来执行 py 语句，多行的话用三个引号引起来就完事了<em>（我也才知道命令行也可以这样多行的嘤嘤嘤）</em>。</p>
<p><strong>Exp：</strong>（在命令行执行）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python -c <span class="token string">""</span>"
<span class="token function">import</span> os
fd <span class="token operator">=</span> os.open<span class="token punctuation">(</span><span class="token string">'/home/ctf/flag'</span>,0<span class="token punctuation">)</span>
off <span class="token operator">=</span> <span class="token number">0</span>
flag <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">while</span> off <span class="token operator">&lt;</span> <span class="token number">15007689474057</span>:
    off <span class="token operator">=</span> os.lseek<span class="token punctuation">(</span>fd,off,3<span class="token punctuation">)</span> <span class="token comment"># SEEK_DATA</span>
    off <span class="token operator">+=</span> <span class="token number">1</span>
    a <span class="token operator">=</span> os.read<span class="token punctuation">(</span>fd,1<span class="token punctuation">)</span>
    <span class="token keyword">if</span> a <span class="token operator">!=</span> <span class="token string">'<span class="token entity" title="\x00">\x00</span>'</span><span class="token builtin class-name">:</span>
        flag <span class="token operator">+=</span> a
print flag
<span class="token string">""</span>"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200605234912255.png" alt="nc_flag"></p>
<p>即可得到flag了！</p>
<hr>
<p>这里还有<strong>另一种方法</strong>，那就是利用 <strong>grep 大法</strong>！</p>
<p>看到有师傅说，用 <code>grep -z</code> 可以单行语句出 flag，不过没有具体给出如何实现，于是就自己试了一下。</p>
<p>看了看 <code>grep --help</code> 和 <code>man grep</code>：</p>
<blockquote>
<p> -z, –null-data           一个 0 字节的数据行，但不是空行</p>
<p> -z, –null-data<br>              Treat the input as a set of lines, each terminated by <strong>a zero byte</strong> (the ASCII NUL character) instead of a newline.  Like the  -Z  or  –null option, this option can be used with commands like sort -z to process arbitrary file names.</p>
</blockquote>
<p><code>-z</code>就是说把零字符看成是输入的分行标志，可以理解是把 <code>\x00 </code> 当成分行符，正好就符合这题的意思了，妙呀！</p>
<p>试了一阵子，发现可以这样来读取 flag 文件：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">grep</span> -z <span class="token string">".\+"</span> flag
<span class="token comment"># Or</span>
<span class="token function">grep</span> -z <span class="token string">"."</span> flag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200605235717591.png" alt="nc_flag2"></p>
<p>想不到吧，grep 还能这么用呢。</p>
<br>

<hr>
<h3 id="babyweb"><a href="#babyweb" class="headerlink" title="babyweb"></a>babyweb</h3><blockquote>
<p>flag格式：把BJD{this_is_flag}转md5，提交md5值(小写)</p>
<p><strong>hint:</strong> 第三组密码中的某一位，以下图的解密结果为准：</p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/jPqgz2GTi46qq5it.png"></p>
<p>百度图片搜出来的密码表是Q，以原著为准 改成w，再根据图片的提示改成W；如果还提交失败就是其他位有解错的。</p>
</blockquote>
<p>有个<code>flag.zip</code>，里面有个图片密码加密了。</p>
<p>这题网页上看到那个 <code>pass</code> 和 <code>word_is_here</code> 之间的空字符还觉得奇怪，做题的时候就没想到是<strong>零宽度字符隐写</strong>（Zero-Width Space Steganography）……原来还有用到网页上的。</p>
<blockquote>
<p><strong>解密网站</strong>参考：</p>
<p><a target="_blank" rel="noopener" href="http://zero.rovelast.com/">http://zero.rovelast.com/</a></p>
<p><a target="_blank" rel="noopener" href="https://offdev.net/demos/zwsp-steg-js">https://offdev.net/demos/zwsp-steg-js</a></p>
</blockquote>
<blockquote>
<p><strong>GitHub 仓库</strong>参考：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/enodari/zwsp-steg-py">zwsp-steg-py</a> （基于 python 实现）</p>
<p><a target="_blank" rel="noopener" href="https://github.com/offdev/zwsp-steg-js">zwsp-steg-js</a>  （基于 JavaScript 实现）</p>
</blockquote>
<p>解出来密码是<code>zerowidthcharactersinvisible</code>。</p>
<p>拿去解压图片，发现文件倒序了。</p>
<p><em>（留坑，后面接着复现）</em></p>
<br>

<hr>
<h3 id="manual"><a href="#manual" class="headerlink" title="manual"></a>manual</h3><blockquote>
<p>请使用ssh连接靶机（用户名为ctf，密码详见欢迎信息）———— 歡迎使用BJD3rd帮助手册————「manual一下，你就知道」</p>
<p>183.129.189.60:10125,10126,10127,10128,10129,10130</p>
<p>hint0 试试limux的man命令，看看与本题的man文档有何不同</p>
<p>hint0.5 关于登录密码，试试<a target="_blank" rel="noopener" href="http://emoji.taqini.space/">emoji</a>网站的分享功能</p>
<p>hint1 本题无需提权，请仔细看看根目录下的文件</p>
<p>hint2 据说会ps的师傅都做出来了</p>
<p>hint3 f1a9.py的独白：我的真实身份是web server</p>
</blockquote>
<p>这题有毒，做了一天没做出来……大概写写吧。</p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522204639089.png" alt="ssh login"></p>
<pre class="line-numbers language-none"><code class="language-none">% ssh ctf@183.129.189.60 -p 10128

Welcome to BJD3rd Games ~

🐀🐾🌴🚜🍋🐊🍇🐂🍓🎑🐈🐟💁🚟🍗

The above login passwd is encrypted.

leads:
 - http://emoji.taqini.space
 - suika

Try to figure out where is your

         #           #####   #####  
######  ##     ##   #     # #     #
#      # #    #  #  #     #       #
#####    #   #    #  ######    ###  
#        #   ######       #    #    
#        #   #    # #     #         
#      ##### #    #  #####     #    
                                    
p.s. Maybe you have lots of xiaowenhao after login,
     I will help u look up the manual pages of flag.

Now, input passwd to start the game:<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p><a target="_blank" rel="noopener" href="http://emoji.taqini.space/">http://emoji.taqini.space</a> 是 TaQini 师傅部署的 codemoji 加解密网站。</p>
<p><code>suika</code>在日语中是 <strong>西瓜</strong> 的意思，看来这就是 key 了。</p>
<p>随意试着加密了一个，在分享界面浏览器抓包得到分享链接形式为</p>
<p><a target="_blank" rel="noopener" href="http://taqini.space/codemoji/share.html?data=eyJtZXNzYWdlIjoi8J+Ni/Cfjonwn4y38J+OkfCfjYvwn46J8J+Mt/CfjpHwn42L8J+OifCfjLfwn46RIiwia2V5Ijoi8J+NiSJ9">http://taqini.space/codemoji/share.html?data=eyJtZXNzYWdlIjoi8J%2BNi%2FCfjonwn4y38J%2BOkfCfjYvwn46J8J%2BMt%2FCfjpHwn42L8J%2BOifCfjLfwn46RIiwia2V5Ijoi8J%2BNiSJ9</a></p>
<p><code>data</code> 参数 urldecode + base64 解码后得到</p>
<pre class="line-numbers language-none"><code class="language-none">{"message":"🍋🎉🌷🎑🍋🎉🌷🎑🍋🎉🌷🎑","key":"🍉"}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>于是想到修改<code>message</code>参数构造 payload 如下。</p>
<pre class="line-numbers language-none"><code class="language-none">{"message":"🐀🐾🌴🚜🍋🐊🍇🐂🍓🎑🐈🐟💁🚟🍗","key":"🍉"}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>base64 encode + urlencode:</p>
<pre class="line-numbers language-none"><code class="language-none">eyJtZXNzYWdlIjoi8J%2BQgPCfkL7wn4y08J%2BanPCfjYvwn5CK8J%2BNh%2FCfkILwn42T8J%2BOkfCfkIjwn5Cf8J%2BSgfCfmp%2Fwn42XIiwia2V5Ijoi8J%2BNiSJ9<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>构造分享链接得到：</p>
<p><a target="_blank" rel="noopener" href="http://taqini.space/codemoji/share.html?data=eyJtZXNzYWdlIjoi8J+QgPCfkL7wn4y08J+anPCfjYvwn5CK8J+Nh/CfkILwn42T8J+OkfCfkIjwn5Cf8J+SgfCfmp/wn42XIiwia2V5Ijoi8J+NiSJ9">http://taqini.space/codemoji/share.html?data=eyJtZXNzYWdlIjoi8J%2BQgPCfkL7wn4y08J%2BanPCfjYvwn5CK8J%2BNh%2FCfkILwn42T8J%2BOkfCfkIjwn5Cf8J%2BSgfCfmp%2Fwn42XIiwia2V5Ijoi8J%2BNiSJ9</a></p>
<p>拿去解码。</p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522204126571.png" alt="codemoji"></p>
<p>得到ssh连接密码：</p>
<p><code>C0dEmOj!so4UnNy</code></p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522204720852.png" alt="man flag"></p>
<p>还别说，挺好看的233.</p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522203813777.png" alt="flag"></p>
<p>看了 Help 才发现这是 w3m。还带右键菜单的哇！</p>
<blockquote>
<p>w3m是个开放源代码的文字式网页浏览器。</p>
<p>w3m支持表格、框架、SSL连线、颜色。如果是在适当的terminal上，甚至还支持“inline image”。 这个软件通常尽量呈现出网页本来的编排。</p>
<p>“w3m”这名字是来自“WWW-wo-Miru”，就是日文的“看WWW”之义。</p>
</blockquote>
<p>哇是真的浏览器唉，还可以上我博客（雾），虽然解析不了中文嘤嘤嘤。</p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522211921981.png" alt="blog"></p>
<p>借助快捷键<code>U</code>分别访问<code>givemeflag</code>和 <code>getflag</code>。</p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522211122635.png" alt="givemeflag"></p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522211335220.png" alt="getflag"></p>
<p>HISTORY 里给了个网址 <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ac26b4506a38">https://www.jianshu.com/p/ac26b4506a38</a></p>
<p>讲的是<strong>自定义man手册</strong>。</p>
<p>查看<code>/etc/manpath.config</code>文件。</p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200523125052333.png" alt="manpath.config"></p>
<p>对比一下好像并没有什么区别（？？？</p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200523125551959.png" alt="manpath"></p>
<p>用 <code>V</code> 可以查看文件，但是找不到  <code>f1a9.py</code>？</p>
<p>Option 里可以改配置用外部浏览器打开，考虑是反弹 shell。</p>
<p>（不过么有 curl，不会了……嘤嘤嘤</p>
<p>（看大佬们是用 perl 整的。</p>
<p>这题后面还有好几步……有空再复现8.</p>
<p>最后是一个 <a target="_blank" rel="noopener" href="http://999.taqini.space/">http://999.taqini.space</a> 太极？会玩。</p>
<br>

<hr>
<h3 id="PY-me"><a href="#PY-me" class="headerlink" title="PY me"></a>PY me</h3><blockquote>
<p>请提交md5(“BJD{xxxx}”)； </p>
<p>使用nc连接； 尽量用后面的端口，10020端口不太稳定</p>
<p>183.129.189.60:10020,10021,10022,10023,10024,10026</p>
</blockquote>
<blockquote>
<p>flag格式为md5（BJD{.*}）上交md5值</p>
<p>使用nc连接靶机，建议用后面端口号</p>
<p>hint1: 所有没有使用hint()中给出的函数做出题目的方法都是非预期，如果您是非预期请报告我们，所以 从哪里入手应该懂了吧？</p>
<p>hint2: if( #s#o#m#e#t#h#i#n#g#<em>#I#</em>#w#o#n#t#<em>#t#e#l#l#</em>#y#o#u# )  这过滤了全部字母和数字，当然还过滤了其他符号，需要自己fuzz（socket pwntool等)</p>
<p>hint3: python几？</p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/X1T9NYXZ6Zyt9xKQ.png"></p>
<p>打错字了，是result，不影响做题</p>
</blockquote>
<p>题目给了 hint 说<strong>过滤了全部字母和数字，当然还过滤了其他符号</strong>。</p>
<p>试了发现不仅仅如此，常用的一下函数也被过滤了，比如 <code>os</code>，<code>sys</code>，<code>open</code>，<code>lambda</code>，<code>system</code>，<code>exec</code>，<code>eval</code>，<code>builtins</code>等等。</p>
<p>函数名称用字符串拼接可以绕过，但不知道用什么方法能绕过来调用函数了。</p>
<p>看了下 <code>dir()</code>，大概有这几个 <code>False</code>, <code>__builtins__</code> , <code>hint</code>, <code>rceMe</code>。</p>
<p>题目中的 <code>if False</code>，直接令 <code>False=True</code> 就行，毕竟 python 里都是对象 object 2333.</p>
<p>本来想改 <code>str</code> 的，但怎么样都绕不过 <code>if( #s#o#m#e#t#h#i#n#g#_#I#_#w#o#n#t#_#t#e#l#l#_#y#o#u# )</code> 这部分判断。</p>
<p>利用报错知道了源码文件名称为 <code>bjdpyjail.py</code>，不过好像没啥用。</p>
<p>考虑用字符来绕过，手动试验发现包括但不限于 <code>^.;</code> 被过滤了。</p>
<blockquote>
<p>说到这难受死了，有空得学学 <code>pwntools</code>，直接控制台手码代码太jr难受了，还不能快捷调用上一条执行命令，无法接受。</p>
</blockquote>
<p>这么说来，异或 <code>^</code> 不行，但取反 <code>~</code> 可以，<code>&lt;</code>  <code>&gt;</code>也可。</p>
<p>查了一下网上有关于 PHP 的字符绕过，然而在 python 里不能直接对字符本身取反，要先取<code>ord</code>，然后想了半天都想不到该怎么绕了……</p>
<p><em>（摊手，等复现</em></p>
<p>赛后看到大佬找到了奇妙的绕过方法，把源码读取出来了。（详见 <a target="_blank" rel="noopener" href="https://ytoworld.tk/index.php/archives/100/#PY%20me(%E9%9D%9E%E9%A2%84%E6%9C%9F)">这里</a> ）</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">vars</span><span class="token punctuation">(</span><span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'_'</span><span class="token operator">+</span><span class="token string">'_buil'</span><span class="token operator">+</span><span class="token string">'tins_'</span><span class="token operator">+</span><span class="token string">'_'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"op"</span><span class="token operator">+</span><span class="token string">"en"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'bjdpyjail.py'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200524132730843.png" alt="读取源码"></p>
<p>预期解详见出题师傅 Y1ng 师傅的这一篇：</p>
<p><a target="_blank" rel="noopener" href="https://www.gem-love.com/ctf/2345.html">[译]PlaidCTF中一道PyJail逃逸题目分析</a></p>
<br>

<hr>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="TaQiniOJ-0"><a href="#TaQiniOJ-0" class="headerlink" title="TaQiniOJ-0"></a>TaQiniOJ-0</h3><blockquote>
<p>欢迎来到TaQini的C语言新手训练营</p>
<p>（没有附件，盲打）</p>
<p>183.129.189.60:10075,10076,10077,10078,10079,10080</p>
</blockquote>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200523215022417.png" alt="taqinioj"></p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200523215138676.png" alt="oj2"></p>
<p>这里告诉了flag所在目录为 <code>/home/ctf/flag</code>。</p>
<p>好久没写C了，突然都忘记文件操作了。被 python 的<code>open</code>惯坏了唉。</p>
<p>试了一下，还有 defender 唉。<code>flag</code>被过滤了。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   
	FILE <span class="token operator">*</span>fp<span class="token punctuation">;</span>
	<span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"/home/ctf/fl"</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> tmp<span class="token punctuation">[</span><span class="token number">1000</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello TaQini"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">strcat</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token string">"ag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span> 
	fp<span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">fscanf</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> <span class="token string">"%s"</span><span class="token punctuation">,</span> tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
@<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200523220959266.png" alt="defender"></p>
<p>发现好像敏感词不仅仅是<code>flag</code>，还有<code>home</code>啥的……然而赛后才发现，气死我了。</p>
<p>可以<code>sprintf</code>来拼接字符串。</p>
<p>（想起来某次做项目给单片机编程就靠这玩意拼接字符串，被 python 惯坏的我写的难受死了。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>name<span class="token punctuation">,</span> <span class="token string">"%s%s%s%s%s"</span><span class="token punctuation">,</span> <span class="token string">"/hom"</span><span class="token punctuation">,</span> <span class="token string">"e"</span><span class="token punctuation">,</span><span class="token string">"/ct"</span><span class="token punctuation">,</span> <span class="token string">"f/f"</span><span class="token punctuation">,</span> <span class="token string">"lag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>当然还可以直接用字符数组赋值的方法。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">'/'</span><span class="token punctuation">,</span><span class="token string">'h'</span><span class="token punctuation">,</span><span class="token string">'o'</span><span class="token punctuation">,</span><span class="token string">'m'</span><span class="token punctuation">,</span><span class="token string">'e'</span><span class="token punctuation">,</span><span class="token string">'/'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'t'</span><span class="token punctuation">,</span><span class="token string">'f'</span><span class="token punctuation">,</span><span class="token string">'/'</span><span class="token punctuation">,</span><span class="token string">'f'</span><span class="token punctuation">,</span><span class="token string">'l'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'g'</span><span class="token punctuation">,</span><span class="token string">'\0'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>赛后群里有大佬给出了如下的<strong>非预期解</strong>，太佩服了！</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token expression">"<span class="token operator">/</span>home<span class="token operator">/</span>ctf<span class="token operator">/</span>fl\\</span></span>
ag"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200524013637088.png" alt="非预期解"></p>
<p>哇呜，用报错来弹flag！虽然之前写错语法也报错了，但这脑洞真没想到。果然是 OJ 大佬。</p>
<p>同样漏洞可用于另一个 OJ 题。</p>
<br>

<hr>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="bbcrypto"><a href="#bbcrypto" class="headerlink" title="bbcrypto"></a>bbcrypto</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding:utf-8 -*-</span>
<span class="token keyword">import</span> A<span class="token punctuation">,</span>SALT
<span class="token keyword">from</span> itertools <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> a<span class="token punctuation">,</span> si<span class="token punctuation">)</span><span class="token punctuation">:</span>
    c<span class="token operator">=</span><span class="token string">""</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        c<span class="token operator">+=</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> a <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>si<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> c
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    m <span class="token operator">=</span> <span class="token string">'flag{********************************}'</span>
    a <span class="token operator">=</span> A
    salt <span class="token operator">=</span> SALT
    <span class="token keyword">assert</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>salt<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">assert</span><span class="token punctuation">(</span>salt<span class="token punctuation">.</span>isalpha<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    si <span class="token operator">=</span> cycle<span class="token punctuation">(</span>salt<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"明文内容为："</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"加密后的密文为："</span><span class="token punctuation">)</span>
    c<span class="token operator">=</span>encrypt<span class="token punctuation">(</span>m<span class="token punctuation">,</span> a<span class="token punctuation">,</span> si<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
    <span class="token comment">#加密后的密文为：</span>
    <span class="token comment">#177401504b0125272c122743171e2c250a602e3a7c206e014a012703273a3c0160173a73753d</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>通过<code>assert</code>可以知道<code>salt</code>是三个字母组成的。</p>
<p><code>cycle</code>返回一个迭代器 iterator，每一次调用 <code>next</code> 返回下一个字符。</p>
<p>需要根据 <code>flag{</code>和 <code>}</code> 解出<code>A</code>和<code>SALT</code>，然后再代回去反解 flag 中的字符。取模的话想不到别的方法应该也是爆破解。</p>
<p>考虑是爆破来解<code>A</code>&amp; <code>SALT</code>，然而我<code>a</code>的爆破范围太大了设到了 1000 然后就没整出来……（（</p>
<p>赛后看人家大佬解出来<code>A</code>是57，<code>salt</code>是<code>ahh</code>。</p>
<p><em>（之后再复现8</em></p>
<br>

<hr>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>最终的解题情况如下。</p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200524011922656.png" alt="解题情况"></p>
<p>Web 的小红花这么多人解出来，啊是我太菜了。题目把出网流量封了，弹不了shell，赛后看群里大佬们是用时间盲注怼出来的。</p>
<p>总之，这次题目质量感觉挺高的，难度是真的大得亚批，两天打下来每天都在自闭……</p>
<p>这次做题思路比较乱，可能也比较佛系，一下看这题一下看那题，噢原来都不会做。<em>（群里萌新又做出来了？？？打扰了。</em></p>
<p>然后还有大佬两周学会 pwn 然后做出了一堆题，这么容易入门的嘛，心动了。<em>（算了8）</em></p>
<br>

<hr>
<h2 id="CyberChef"><a href="#CyberChef" class="headerlink" title="CyberChef"></a>CyberChef</h2><p>为了便于打 CTF，前天晚上做题途中自己搭了个 CyberChef，我才不会说之前一直想搭但一直没整呢。</p>
<p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200524144909214.png" alt="CyberChef"></p>
<p>网址在这里：<a target="_blank" rel="noopener" href="https://chef.miaotony.xyz/">https://chef.miaotony.xyz/</a></p>
<p><strong>不带各种页面统计，不收集隐私信息，欢迎来玩来 BAKE 呀！</strong></p>
<p>简而言之，它就是可以处理包括但不限于各种编码各种加密各种转换的一个在线工具，可以把一系列处理流程放进 菜谱 Recipe 里，然后 BAKE 就出结果啦！</p>
<p>下面是官方的介绍。</p>
<blockquote>
<p>The Cyber Swiss Army Knife - a web app for encryption, encoding, compression and data analysis</p>
<p><em><strong>The Cyber Swiss Army Knife</strong></em></p>
<p>CyberChef is a simple, intuitive web app for carrying out all manner  of “cyber” operations within a web browser. These operations include  simple encoding like XOR or Base64, more complex encryption like AES,  DES and Blowfish, creating binary and hexdumps, compression and  decompression of data, calculating hashes and checksums, IPv6 and X.509  parsing, changing character encodings, and much more.</p>
<p>The tool is designed to enable both technical and non-technical  analysts to manipulate data in complex ways without having to deal with  complex tools or algorithms. It was conceived, designed, built and  incrementally improved by an analyst in their 10% innovation time over  several years.</p>
<p>官方 GitHub 仓库<a target="_blank" rel="noopener" href="https://github.com/gchq/CyberChef">在这里</a>。</p>
</blockquote>
<p>大概就这样了8</p>
<p>（溜</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://miaotony.xyz" rel="external nofollow noreferrer">MiaoTony</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://miaotony.xyz/2020/05/24/CTF_BJDCTF3rd/">https://miaotony.xyz/2020/05/24/CTF_BJDCTF3rd/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特别声明外，均采用
                    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a>
                    许可协议。转载请注明来源
                    <a href="https://miaotony.xyz" target="_blank">MiaoTony</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/CTF/">
                                    <span class="chip bg-color">CTF</span>
                                </a>
                            
                                <a href="/tags/WriteUp/">
                                    <span class="chip bg-color">WriteUp</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="qq,qzone,wechat,weibo,twitter,facebook,google,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">打赏一下让我来点好吃好玩的呗~</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <!-- 
                            <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li> 
                        -->
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <!-- 
                        <div id="alipay">
                        <img src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/" class="reward-img" alt="支付宝打赏二维码">
                        </div> 
                -->
                    <div id="wechat">
                        <img src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/gitalk/gitalk.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '116343b4650fce4789b6',
        clientSecret: '3e9be2ad6c9b693af1753290c7c059b1e4f34d5d',
        repo: 'miaotony.github.io',
        owner: 'miaotony',
        admin: "miaotony",
        id: '2020-05-24T11-30-00',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2020/05/30/CTF_2020NUAACTF/">
                    <div class="card-image">
                        
                        
                        <img src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/medias/featureimages/0.jpg" class="responsive-img" alt="CTF | 2020 NUAACTF 吸喵喵队 Writeup">
                        
                        <span class="card-title">CTF | 2020 NUAACTF 吸喵喵队 Writeup</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            期待已久的NUAACTF终于来了呀！玩(头)耍(秃)了一个下午，整体而言难度还好，感觉好棒啊！
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2020-05-30
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/CTF/" class="post-category">
                                    CTF
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/CTF/">
                        <span class="chip bg-color">CTF</span>
                    </a>
                    
                    <a href="/tags/WriteUp/">
                        <span class="chip bg-color">WriteUp</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2020/05/04/CTF_2020De1CTF/">
                    <div class="card-image">
                        
                        
                        <img src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/medias/featureimages/16.jpg" class="responsive-img" alt="CTF | 2020 De1CTF Misc Chowder WriteUp">
                        
                        <span class="card-title">CTF | 2020 De1CTF Misc Chowder WriteUp</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            这几天有个 De1CTF，结束前来看了一眼题目，做了个Misc杂烩题，还是挺有意思的。顺便来总结一下关于 NTFS 交换数据流的相关应用吧。
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-05-04
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/CTF/" class="post-category">
                                    CTF
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/CTF/">
                        <span class="chip bg-color">CTF</span>
                    </a>
                    
                    <a href="/tags/WriteUp/">
                        <span class="chip bg-color">WriteUp</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('200')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: MiaoTony&#39;s小窝<br />'
            + '文章作者: MiaoTony<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者MiaoTony所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('1'),
            headingSelector: 'h2, h3, h4, h5'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4, h5').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
        <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2021</span>
            
            <a href="/about" target="_blank">MiaoTony</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
                        &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">314k</span>&nbsp;字
                                                                                    <span id="busuanzi_container_site_pv">
			|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
                                    <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
                        <br>
                        <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2019";
                    var startMonth = "11";
                    var startDate = "28";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
                        <br>
                    </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://t.me/MiaoTonyChannel" class="tooltipped" target="_blank" data-tooltip="关注我的TelegramChannel: @MiaoTonyChannel" data-position="top" data-delay="50">
        <i class="fab fa-telegram"></i>
    </a>



    <a href="https://github.com/miaotony" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:miaotony@outlook.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    var cnt = 1;
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var content_index = [];
                        var data_title_origin = data.title.trim();
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + String(cnt) + ". " + data_title_origin + "</a>";
                            cnt += 1;
    
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 300 characters
                                var start = first_occur - 30;
                                if (start < 0) {
                                    start = 0;
                                }
                                var match_content = content.substr(start, 300);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });
    
                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    str = "<p class=\"search-result-summary\">共找到 " + String(cnt-1) + " 条结果</p>"  + str;
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/materialize/materialize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/aos/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/js/matery.min.js"></script>

    

    
<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?40e312a1eec109cf96e30988cf3bfe70";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    
    
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    
    

    

    

    
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
